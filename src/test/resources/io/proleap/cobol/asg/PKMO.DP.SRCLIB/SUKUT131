000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.   SUKUT131.                                          00050000
000600 AUTHOR.       CLARK SCHWENN.                                     00060000
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070000
000800 DATE-WRITTEN. NOVEMBER, 2008.                                    00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS EXTRACT PROGRAM WILL BE USED TO PULL TRAILER/CARTON DATA *00120000
001300*  FROM SUT_TRIP_MTCH_LVL FOR THE NEW DUAL FEED PRINT AND APPLY  *00130000
001400*  WITH AUTOMATED CONVEYOR PROCESS.  THIS WILL BE A DAILY, WEEKLY*00140000
001401*  OR MONTHLY JOB DEPENDING ON THE CONTROL CARD AND WILL         *00150000
001402*  PASS THE EXTRACT FILE TO PGM SUKRP058 FOR REPORTING OF TRAILER*00160000
001403*  CARTON UNLOADS.                                               *00170000
      *  IF PC-MATCH-FUNC-TXT-X IS SELECTED ON THE TKRPRPM TABLE -      00171000
      *  VENDOR - PO - AND FIRST TRAILER ARE SELECTED FOR THE OUTPUT    00172000
      *  FILE.                                                          00173000
      *  IF PC-MATCH-FUNC-TXT-A IS SELECTED ON THE TKRPRPM TABLE -      00174000
      *  VENDOR - PO - FIRST TRAILER - AND ALL ARE SELECTED FOR THE     00175000
      *  OUTPUT FILE.                                                   00176000
001404******************************************************************00177000
001405******************************************************************00178000
001406 ENVIRONMENT DIVISION.                                            00179000
001407******************************************************************00180000
001408                                                                  00190000
001409 CONFIGURATION SECTION.                                           00200000
001410                                                                  00210000
001420 SOURCE-COMPUTER.        IBM-3090.                                00220000
001430 OBJECT-COMPUTER.        IBM-3090.                                00230000
001440                                                                  00240000
001450 INPUT-OUTPUT SECTION.                                            00250000
001460                                                                  00260000
001470 FILE-CONTROL.                                                    00270000
001480                                                                  00280000
001490     SELECT SURD032-CONTROL-FILE                                  00290000
001500         ASSIGN TO INP01.                                         00300000
001600                                                                  00310000
001700     SELECT SURD087-EXTRACT-FILE                                  00320000
001800         ASSIGN TO OUT01.                                         00330000
001900                                                                  00340000
002200                                                                  00350000
002300******************************************************************00360000
002400 DATA DIVISION.                                                   00370000
002500******************************************************************00380000
002600                                                                  00390000
002700 FILE SECTION.                                                    00400000
002800                                                                  00410000
002900 FD  SURD032-CONTROL-FILE                                         00420000
003000     RECORDING MODE IS F                                          00430000
003100     LABEL RECORDS ARE STANDARD                                   00440000
003200     BLOCK CONTAINS 0 RECORDS.                                    00450000
003300                                                                  00460000
003400 01  SURD032-CONTROL-RECORD         PIC X(80).                    00470000
003500                                                                  00480000
003600 FD  SURD087-EXTRACT-FILE                                         00490000
003700     RECORDING MODE IS F                                          00500000
003800     LABEL RECORDS ARE STANDARD                                   00510000
003900     BLOCK CONTAINS 0 RECORDS.                                    00520000
004000                                                                  00530000
004100 01  SURD087-EXTRACT-RECORD         PIC X(137).                   00540000
004200                                                                  00550000
004414                                                                  00560000
004415******************************************************************00570000
004416 WORKING-STORAGE SECTION.                                         00580000
004417******************************************************************00590000
007900 01  AC-ABEND-CODE                    PIC S9(04) VALUE +4008.     00600000
022940                                                                  00610000
022950 01  ABEND-CODE                      PIC S9(04)    VALUE +0       00620000
022960                                                   COMP SYNC.     00630000
                                                                        00640000
022970 01  PA-PROGRAM-ACCUMULATORS.                                     00650000
022980     05  PA-TOTALS.                                               00660000
022990         10 PA-CNTRL-RECS-READ        PIC  S9(13)  VALUE +0       00670000
023000                                                     COMP-3.      00680000
               10 PA-WRITTEN                                            00690000
022990                                      PIC  S9(13)  VALUE +0       00700000
023000                                                     COMP-3.      00710000
               10 PA-ALT-TRIP-COUNT         PIC  S9(03)  VALUE +0       00720000
025700                                                     COMP-3.      00730000
               10 PA-FETCH                                              00740000
022990                                      PIC  S9(13)  VALUE +0       00750000
023000                                                     COMP-3.      00760000
               10 PA-ALT-TRIPS              PIC  S9(03)  VALUE +0.      00770000
                                                                        00780000
               10 PA-RECITM-NOT-FOUND       PIC  S9(03)  VALUE +0       00790000
025700                                                     COMP-3.      00800000
               10 PA-RECITM-FOUND           PIC  S9(03)  VALUE +0       00810000
025700                                                     COMP-3.      00820000
                                                                        00830000
025800 01  PS-PROGRAM-SWITCHES.                                         00840000
025900     05  PS-END-OF-CNTRL-SW           PIC  X(01)   VALUE 'N'.     00850000
026000         88  PS-END-OF-CNTRL                       VALUE 'Y'.     00860000
026100         88  PS-END-OF-CNTRL-NO                    VALUE 'N'.     00870000
023400     05  PS-NO-MORE-WEEKMNT-SW         PIC  X(01)    VALUE 'N'.   00880000
023500         88  PS-NO-MORE-WEEKMNT                      VALUE 'Y'.   00890000
023600         88  PS-MORE-WEEKMNT                         VALUE 'N'.   00900000
023400     05  PS-NO-MORE-DAILY-SW           PIC  X(01)    VALUE 'N'.   00910000
023500         88  PS-NO-MORE-DAILY                        VALUE 'Y'.   00920000
023600         88  PS-MORE-DAILY                           VALUE 'N'.   00930000
023400     05  PS-NO-MORE-ALT-TRIP-SW        PIC  X(01)    VALUE 'N'.   00940000
023500         88  PS-NO-MORE-ALT-TRIP                     VALUE 'Y'.   00950000
023600         88  PS-MORE-ALT-TRIP                        VALUE 'N'.   00960000
031300     05  PS-ROW-FOUND-SW             PIC  X(01)    VALUE 'N'.     00970000
031400         88  PS-ROW-FOUND                          VALUE 'Y'.     00980000
031500         88  PS-ROW-FOUND-NO                       VALUE 'N'.     00990000
031300     05  PS-ROW-FOUND-ITEM-BC-SW     PIC  X(01)    VALUE 'N'.     01000000
031500         88  PS-ROW-FOUND-ITEM-BC-NO               VALUE 'Y'.     01010000
031400         88  PS-ROW-FOUND-ITEM-BC                  VALUE 'N'.     01020000
031300     05  PS-ROW-FOUND-ITEM-MI-SW     PIC  X(01)    VALUE 'N'.     01030000
031500         88  PS-ROW-FOUND-ITEM-MI-NO               VALUE 'Y'.     01040000
031400         88  PS-ROW-FOUND-ITEM-MI                  VALUE 'N'.     01050000
031300     05  PS-ROW-FOUND-RECEIV-SW      PIC  X(01)    VALUE 'N'.     01060000
031500         88  PS-ROW-FOUND-RECEIV-NO                VALUE 'N'.     01070000
031400         88  PS-ROW-FOUND-RECEIV                   VALUE 'Y'.     01080000
031300     05  PS-ROW-FOUND-PKSLIP-SW      PIC  X(01)    VALUE 'N'.     01081000
031500         88  PS-ROW-FOUND-PKSLIP-NO                VALUE 'N'.     01082000
031400         88  PS-ROW-FOUND-PKSLIP                   VALUE 'Y'.     01083000
031300     05  PS-ROW-FOUND-SHUUPC-SW     PIC  X(01)    VALUE 'N'.      01084000
031500         88  PS-ROW-FOUND-SHUUPC-NO                VALUE 'N'.     01085000
031400         88  PS-ROW-FOUND-SHUUPC                   VALUE 'Y'.     01086000
                                                                        01087000
032300 01  PC-PROGRAM-CONSTANTS.                                        01088000
032400     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)     VALUE          01089000
032500         'SUKUT131'.                                              01090000
037700     05  PC-DAILY                    PIC X(01)     VALUE 'D'.     01100000
037700     05  PC-WEEKLY                   PIC X(01)     VALUE 'W'.     01110000
037700     05  PC-MONTHLY                  PIC X(01)     VALUE 'M'.     01120000
037700     05  PC-REC-PACK-BY-ST-IND-YES   PIC X(01)     VALUE 'Y'.     01130000
037700     05  PC-REC-PKGNG-CDE-B          PIC X(01)     VALUE 'B'.     01140000
037700     05  PC-REC-PKGNG-CDE-C          PIC X(01)     VALUE 'C'.     01150000
037700     05  PC-REC-PKGNG-CDE-M          PIC X(01)     VALUE 'M'.     01160000
037700     05  PC-REC-PKGNG-CDE-I          PIC X(01)     VALUE 'I'.     01170000
037700     05  PC-LINE-OR-PCK-ID-PBS       PIC X(04)     VALUE ' PBS'.  01180000
037700     05  PC-LINE-OR-PCK-ID-INVL      PIC X(04)     VALUE 'INVL'.  01190000
037700     05  PC-VERFY-NOT-VE-DATE        PIC X(06)     VALUE 'NOT VE'.01200000
037700     05  PC-LINE-PCK-TYP-X           PIC X(01)     VALUE 'X'.     01210000
037700     05  PC-CART-MTCH-CDE-FST        PIC X(03)     VALUE 'FST'.   01220000
037700     05  PC-CART-MTCH-CDE-VND        PIC X(03)     VALUE 'VND'.   01230000
037700     05  PC-CART-MTCH-CDE-PO         PIC X(03)     VALUE 'POL'.   01240000
037700     05  PC-CART-MTCH-CDE-ALL        PIC X(03)     VALUE 'ALL'.   01250000
037700     05  PC-MATCH-FUNC-TXT-X         PIC X(01)     VALUE 'X'.     01260000
037700     05  PC-MATCH-FUNC-TXT-A         PIC X(01)     VALUE 'A'.     01270000
037700     05  PC-STATUS-VERFYD-VE         PIC X(02)     VALUE 'VE'.    01280007
037700     05  PC-RECEIVR-FREE-ASTRAY      PIC X(04)     VALUE '  FA'.  01290000
037700     05  PC-RECEIVR-NOT-TRNSCRBD     PIC X(04)     VALUE 'NTRN'.  01300000
           05  PC-BLANK                    PIC X(01)     VALUE ' '.     01310000
                                                                        01320000
004300     05  PV-MATCH-CODES.                                          01330000
004400         10  PV-MATCH-FST               PIC X(03) VALUE 'FST'.    01340000
004500         10  PV-MATCH-VND               PIC X(03) VALUE 'VND'.    01350000
004600         10  PV-MATCH-PO                PIC X(03) VALUE 'POL'.    01360000
004700         10  PV-MATCH-ALL               PIC X(03) VALUE 'ALL'.    01370000
004700         10  PV-MATCH-SPACE             PIC X(03) VALUE '   '.    01380000
037700                                                                  01390000
037800 01  PV-PROGRAM-VARIABLES.                                        01400000
000800     05  CNTRL-OPER-ID               PIC S9(04)  VALUE +0         01410000
023000                                                     COMP.        01420000
001400     05  CNTRL-BEGIN-TMST            PIC X(26)     VALUE SPACES.  01430000
001400     05  CNTRL-END-TMST              PIC X(26)     VALUE SPACES.  01440000
048100     05  PV-INBD-TRIP-ID             PIC 9(09)     VALUE ZEROS    01450000
                                                         COMP.          01460000
048100     05  PV-ACM-LBL-STA-NBR          PIC 9(09)     VALUE ZEROS    01470000
                                                         COMP.          01480000
           05  PV-SHIPT-UNT-ID             PIC S9(18)V   VALUE ZEROS    01490000
                                                         COMP-3.        01500000
           05  PV-CURRENT-TMST             PIC X(26)     VALUE SPACES.  01510000
048100     05  PV-MATCH-PARM               PIC X(24)     VALUE SPACES.  01520000
                                                                        01530000
           05  PV-HEADER-FROM-DATE.                                     01540000
               10 PV-HEADER-FROM-MM        PIC X(02)     VALUE SPACES.  01550000
               10 PV-HEADER-FROM-DD        PIC X(02)     VALUE SPACES.  01560000
               10 PV-HEADER-FROM-YY        PIC X(02)     VALUE SPACES.  01570000
                                                                        01580000
           05  PV-HEADER-TO-DATE.                                       01590000
               10 PV-HEADER-TO-MM          PIC X(02)     VALUE SPACES.  01600000
               10 PV-HEADER-TO-DD          PIC X(02)     VALUE SPACES.  01610000
               10 PV-HEADER-TO-YY          PIC X(02)     VALUE SPACES.  01620000
048700                                                                  01630000
           05  PV-DETAIL-VERFY-DTE.                                     01640000
               10 PV-DETAIL-VERFY-CC       PIC X(02)     VALUE SPACES.  01650000
               10 PV-DETAIL-VERFY-YY       PIC X(02)     VALUE SPACES.  01660000
               10 PV-DETAIL-VERFY-MM       PIC X(02)     VALUE SPACES.  01670000
               10 PV-DETAIL-VERFY-DD       PIC X(02)     VALUE SPACES.  01680000
                                                                        01690000
048800     05  PV-FORMAT-TMST.                                          01700000
048900         10  PV-FORMAT-TMST-DTE.                                  01710000
049000             15  PV-FORMAT-TMST-DTE-CC  PIC X(02)  VALUE SPACES.  01720000
049000             15  PV-FORMAT-TMST-DTE-YY  PIC X(02)  VALUE SPACES.  01730000
049100             15  PV-FORMAT-TMST-DTE-D1  PIC X(01)  VALUE '-'.     01740000
049200             15  PV-FORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.  01750000
049300             15  PV-FORMAT-TMST-DTE-D2  PIC X(01)  VALUE '-'.     01760000
049400             15  PV-FORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.  01770000
049500             15  PV-FORMAT-TMST-DTE-D3  PIC X(01)  VALUE '-'.     01780000
049600         10  PV-FORMAT-TMST-TM.                                   01790000
049700             15  PV-FORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.  01800000
049800             15  PV-FORMAT-TMST-TM-D1   PIC X(01)  VALUE '.'.     01810000
049900             15  PV-FORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.  01820000
049800             15  PV-FORMAT-TMST-TM-D2   PIC X(01)  VALUE '.'.     01830000
049900             15  PV-FORMAT-TMST-TM-SS   PIC X(02)  VALUE SPACES.  01840000
049800             15  PV-FORMAT-TMST-TM-D3   PIC X(01)  VALUE '.'.     01850000
050000             15  PV-FORMAT-TMST-TM-NS   PIC X(07)  VALUE          01860000
050100                                                     '000000'.    01870000
034300     05  PV-CONTROL-BEG-DATE.                                     01880000
034310         10  PV-CNTRL-BEGIN.                                      01890000
034400             15  PV-CNTRL-CENTURY-BEG        PIC  X(02).          01900000
034500             15  PV-CNTRL-YEAR-BEG           PIC  X(02).          01910000
030800             15  FILLER                      PIC  X(01) VALUE '-'.01920000
034700             15  PV-CNTRL-MONTH-BEG          PIC  X(02).          01930000
030800             15  FILLER                      PIC  X(01) VALUE '-'.01940000
034900             15  PV-CNTRL-DAY-BEG            PIC  X(02).          01950000
034300     05  PV-CONTROL-END-DATE.                                     01960000
034902         10  PV-CNTRL-END.                                        01970000
034400             15  PV-CNTRL-CENTURY-END        PIC  X(02).          01980000
034500             15  PV-CNTRL-YEAR-END           PIC  X(02).          01990000
030800             15  FILLER                      PIC  X(01) VALUE '-'.02000000
034700             15  PV-CNTRL-MONTH-END          PIC  X(02).          02010000
030800             15  FILLER                      PIC  X(01) VALUE '-'.02020000
034900             15  PV-CNTRL-DAY-END            PIC  X(02).          02030000
052600                                                                  02040000
034300     05  PV-VERIFIED-DATE.                                        02050000
034310         10  PV-VERFYD-DATE.                                      02060000
034400             15  PV-VERFY-CENTURY-DTE        PIC  X(02).          02070000
034500             15  PV-VERFY-YEAR-DTE           PIC  X(02).          02080000
030800             15  FILLER                      PIC  X(01) VALUE '-'.02090000
034700             15  PV-VERFY-MONTH-DTE          PIC  X(02).          02100000
030800             15  FILLER                      PIC  X(01) VALUE '-'.02110000
034900             15  PV-VERFY-DAY-DTE            PIC  X(02).          02120000
                   15  FILLER                      PIC  X(16).          02130000
                                                                        02140000
           05  PV-ALT-TRIP-ID          PIC X(09).                       02150000
010300     05  PV-PARAGRAPH-NAME       PIC X(30)  VALUE SPACES.         02160000
011300     05  PV-OPERATION-MSG-1      PIC X(40)  VALUE SPACES.         02170000
011400     05  PV-OPERATION-MSG-2      PIC X(40)  VALUE SPACES.         02180000
      ******************************************************************02190000
      *                              TABLES                             02200000
      ******************************************************************02210000
       01  PT-TRIP-TABLE.                                               02220000
          05  PT-ALT-TRIP-TABLE.                                        02230000
              10  PT-ALT-TRIP-TABLE-VALUES OCCURS 9999 TIMES            02240000
                                           INDEXED BY SA-INDX.          02250000
                  15  PT-ALT-TRIP-DATA.                                 02260000
                      20 PT-ALT-CARR-SCAC          PIC  X(04).          02270000
                      20 PT-ALT-VEH-NBR            PIC  X(10).          02280000
                      20 PT-ALT-TRIP-ID            PIC  X(09).          02290000
006400******************************************************************02300000
006500*  IMPUT CONTROL CARD W/REPORT TYPE AND TIME PERIOD - DAILY,      02310000
006500*  WEEKLY, OR MONTHLY LAYOUT.                                     02320000
006600******************************************************************02330000
006700     COPY SURD032.                                                02340000
006800 EJECT                                                            02350000
006900                                                                  02360000
007000******************************************************************02370000
007100*  OUTPUT TRAILER/CARTON LAYOUT                                   02380000
007200******************************************************************02390000
00  00     COPY SURD087.                                                02400000
007400 EJECT                                                            02410000
                                                                        02420000
004419******************************************************************02430000
004420*  DB2 FORMATTED MESSAGE AREA                                     02440000
004430******************************************************************02450000
004440     COPY DPWS004.                                                02460000
                                                                        02470000
004460******************************************************************02480000
004470*  COMMUNICATIONS AREA FOR DB2                                    02490000
004480******************************************************************02500000
004490     EXEC SQL                                                     02510000
004500          INCLUDE SQLCA                                           02520000
004600     END-EXEC.                                                    02530000
005500                                                                  02540000
015900******************************************************************02550000
001235*  DB2 DECLARATION - TRIP CARTON MATCH LEVEL                      02560000
001236*      TABLE (SUT_TRIP_MTCH_LVL)                                  02570000
016200******************************************************************02580000
016300     EXEC SQL                                                     02590000
016400         INCLUDE SUT00112                                         02600000
016500     END-EXEC.                                                    02610000
001250                                                                  02620000
015900******************************************************************02630000
001235*  DB2 DECLARATION - TRIP CARTON MATCH LEVEL                      02640000
001236*      TABLE (SUT_PNA_TRIP_ASGMT)                                 02650000
016200******************************************************************02660000
016300     EXEC SQL                                                     02670000
016400         INCLUDE SUT00110                                         02680000
016500     END-EXEC.                                                    02690000
001250                                                                  02700000
005600******************************************************************02710000
005700*  DB2 TABLE DECLARATION -  PURCHASE TABLE.                       02720000
005800*      (TPURCHS)                                                  02730000
005900******************************************************************02740000
006000     EXEC SQL                                                     02750000
006100          INCLUDE TPURCHS                                         02760000
006200     END-EXEC.                                                    02770000
                                                                        02780000
005600******************************************************************02790000
005700*  DB2 TABLE DECLARATION -  RECEIVING TABLE.                      02800000
005800*      (TRECEIV)                                                  02810000
005900******************************************************************02820000
006000     EXEC SQL                                                     02830000
006100          INCLUDE TRECEIV                                         02840000
006200     END-EXEC.                                                    02850000
                                                                        02860000
005600******************************************************************02870000
005700*  DB2 TABLE DECLARATION.                                         02880000
005800*      (TENTNME)                                                  02890000
005900******************************************************************02900000
006000     EXEC SQL                                                     02910000
006100          INCLUDE TENTNME                                         02920000
006200     END-EXEC.                                                    02930000
                                                                        02940000
005600******************************************************************02950000
005700*  DB2 TABLE DECLARATION.                                         02960000
005800*      (TVHTRIP)                                                  02970000
005900******************************************************************02980000
006000     EXEC SQL                                                     02990000
006100          INCLUDE TVHTRIP                                         03000000
006200     END-EXEC.                                                    03010000
                                                                        03020000
005600******************************************************************03030000
005700*  DB2 TABLE DECLARATION.                                         03040000
005800*      (TPKSLIP)                                                  03050000
005900******************************************************************03060000
006000     EXEC SQL                                                     03070000
006100          INCLUDE TPKSLIP                                         03080000
006200     END-EXEC.                                                    03090000
                                                                        03100000
005600******************************************************************03110000
005700*  DB2 TABLE DECLARATION.                                         03120000
005800*      (TINPKSU)                                                  03130000
005900******************************************************************03140000
006000     EXEC SQL                                                     03150000
006100          INCLUDE TINPKSU                                         03160000
006200     END-EXEC.                                                    03170000
                                                                        03180000
005600******************************************************************03190000
005700*  DB2 TABLE DECLARATION.                                         03200000
005800*      (TSHPUNT)                                                  03210000
005900******************************************************************03220000
006000     EXEC SQL                                                     03230000
006100          INCLUDE TSHPUNT                                         03240000
 06200     END-EXEC.                                                    03250000
                                                                        03260000
005600******************************************************************03270000
005700*  DB2 TABLE DECLARATION.                                         03280000
005800*      (TPURITM)                                                  03290000
005900******************************************************************03300000
006000     EXEC SQL                                                     03310000
006100          INCLUDE TPURITM                                         03320000
 06200     END-EXEC.                                                    03330000
005600******************************************************************03340000
005700*  DB2 TABLE DECLARATION.                                         03350000
005800*      (TSHUUPC)                                                  03360000
005900******************************************************************03370000
006000     EXEC SQL                                                     03380000
006100          INCLUDE TSHUUPC                                         03390000
 06200     END-EXEC.                                                    03400000
005600******************************************************************03410000
005700*  DB2 TABLE DECLARATION.                                         03420000
005800*      (TRECITM)                                                  03430000
005900******************************************************************03440000
006000     EXEC SQL                                                     03450000
006100          INCLUDE TRECITM                                         03460000
 06200     END-EXEC.                                                    03470000
                                                                        03480000
005600******************************************************************03490000
005700*  DB2 TABLE DECLARATION.                                         03500000
005800*      (TKRPRPM)                                                  03510000
005900******************************************************************03520000
045200     EXEC SQL                                                     03530000
045300          INCLUDE TKRPRPM                                         03540000
045400     END-EXEC.                                                    03550000
                                                                        03560000
005600******************************************************************03570000
005700*  DB2 TABLE DECLARATION.                                         03580000
005800*      (TKRPRCD)                                                  03590000
005900******************************************************************03600000
045200     EXEC SQL                                                     03610000
045300          INCLUDE TKRPRCD                                         03620000
045400     END-EXEC.                                                    03630000
                                                                        03640000
005600******************************************************************03650000
005700*  DB2 TABLE DECLARATION -  XLT_LOC  TABLE.                       03660000
005800*      (XLT_LOC)                                                  03670000
005900******************************************************************03680000
006000     EXEC SQL                                                     03690000
                INCLUDE XLT00010                                        03700000
           END-EXEC.                                                    03710000
                                                                        03720000
005600******************************************************************03730000
      ****THIS IS THE DRIVING CURSOR FOR WEEKLY OR MONTHLY CNTRL CARDS *03740000
005600******************************************************************03750000
           EXEC SQL                                                     03760000
               DECLARE WEEK_MONTH_CRTN_CSR CURSOR WITH HOLD FOR         03770000
               SELECT  DISTINCT                                         03780000
                        H.OPER_UNT_ID                                   03790000
                       ,H.INBD_TRIP_ID                                  03800000
                       ,H.CRE_MTCH_TMST                                 03810000
                       ,A.OWNER_SCAC_ID                                 03820000
                       ,A.VEH_NBR                                       03830000
                       ,H.CART_MTCH_CDE                                 03840000
                       ,H.DOOR_ID                                       03850000
                       ,H.ACM_LBL_STA_NBR                               03860000
                       ,H.SHIPT_UNT_ID                                  03870000
                 FROM TVHTRIP A,                                        03880000
                      SUT_TRIP_MTCH_LVL H                               03890000
                 WHERE A.TRIP_ID        =   H.INBD_TRIP_ID              03900000
                 AND   H.CART_MTCH_CDE  IN (:PV-MATCH-FST,              03910000
                                            :PV-MATCH-VND,              03920000
                                            :PV-MATCH-PO,               03930000
                                            :PV-MATCH-ALL)              03940000
                 AND   H.CRE_MTCH_TMST  BETWEEN :CNTRL-BEGIN-TMST       03950000
                                            AND :CNTRL-END-TMST         03960000
                 ORDER BY H.OPER_UNT_ID, H.CART_MTCH_CDE,               03970000
                 H.INBD_TRIP_ID, H.ACM_LBL_STA_NBR                      03980000
           END-EXEC.                                                    03990000
005600******************************************************************04000000
      ****THIS IS THE DRIVING CURSOR FOR DAILY CNTRL CARDS *************04010000
005600******************************************************************04020000
           EXEC SQL                                                     04030000
               DECLARE DAILY_CRTN_CSR CURSOR WITH HOLD FOR              04040000
               SELECT  DISTINCT                                         04050000
                        H.OPER_UNT_ID                                   04060000
                       ,H.INBD_TRIP_ID                                  04070000
                       ,H.CRE_MTCH_TMST                                 04080000
                       ,A.OWNER_SCAC_ID                                 04090000
                       ,A.VEH_NBR                                       04100000
                       ,H.CART_MTCH_CDE                                 04110000
                       ,H.DOOR_ID                                       04120000
                       ,H.ACM_LBL_STA_NBR                               04130000
                       ,H.SHIPT_UNT_ID                                  04140000
                 FROM TVHTRIP A,                                        04150000
                      SUT_TRIP_MTCH_LVL H                               04160000
                 WHERE A.TRIP_ID        =   H.INBD_TRIP_ID              04170000
                 AND   H.CART_MTCH_CDE  IN (:PV-MATCH-FST,              04180000
                                            :PV-MATCH-VND,              04190000
                                            :PV-MATCH-PO,               04200000
                                            :PV-MATCH-ALL)              04210000
                 AND   DATE(H.CRE_MTCH_TMST)  =  :SU032-FROM-DATE       04220000
                 ORDER BY H.OPER_UNT_ID, H.CART_MTCH_CDE,               04230000
                 H.INBD_TRIP_ID, H.ACM_LBL_STA_NBR                      04240000
           END-EXEC.                                                    04250000
005600******************************************************************04260000
      ****THIS IS THE CURSOR FOR GET ALTERNATE TRIP ID(S) FOR OUTPUT   *04270000
005600******************************************************************04280000
           EXEC SQL                                                     04290000
               DECLARE ALT_TRIP_ID_CSR CURSOR WITH HOLD FOR             04300000
               SELECT  A.INBD_TRIP_ID                                   04310000
                      ,C.OWNER_SCAC_ID                                  04320000
                      ,C.VEH_NBR                                        04330000
                  FROM SUT_PNA_TRIP_ASGMT A                             04340000
                     , TVHTRIP C                                        04350000
                  WHERE A.OPER_UNT_ID      =   :SUT00112-OPER-UNT-ID    04360000
                  AND   A.ACM_LBL_STA_NBR  =   :SUT00112-ACM-LBL-STA-NBR04370000
                  AND   A.DOOR_ID          <>  :SUT00112-DOOR-ID        04380000
                  AND   A.INBD_TRIP_ID     <>  :SUT00112-INBD-TRIP-ID   04390000
                  AND   A.INBD_TRIP_ID     =   C.TRIP_ID                04400000
                  AND :SUT00112-CRE-MTCH-TMST BETWEEN                   04410000
                                A.ASGD_STRT_TMST AND                    04420000
                                   A.ASGD_END_TMST                      04430000
           END-EXEC.                                                    04440000
005600******************************************************************04450000
      ****THIS IS THE TRECITM AND TSHUUPC CURSOR FOR FOR PACKING CODES *04460000
      ****OR 'B' OR 'C'.                                               *04470000
005600******************************************************************04480000
           EXEC SQL                                                     04490000
               DECLARE RECITMBC_CSR CURSOR WITH HOLD FOR                04500000
                SELECT DISTINCT I.ORD_LNE_NBR                           04510000
                               ,I.ORD_NBR                               04520000
                               ,I.REC_SEQ_NBR                           04530000
                  FROM TRECITM I                                        04540000
                      ,TSHUUPC H                                        04550000
                  WHERE I.ORD_NBR          =   H.TRN_NBR                04560000
                  AND   I.ORD_LNE_NBR      =   H.TRN_LNE_NBR            04570000
      *           AND   I.REC_SEQ_NBR      =   H.RCVR_SEQ_NBR           04580000
                  AND   H.SHIPT_UNT_ID     =   :SUT00112-SHIPT-UNT-ID   04590000
                  AND   I.OPER_UNT_ID      =   :SUT00112-OPER-UNT-ID    04600000
                  AND   I.ORD_NBR          =   :PKSLIP-PO-NBR           04610000
                  AND   I.REC_SEQ_NBR      =   :PKSLIP-REC-SEQ-NBR      04620000
                  AND   I.VER_STATUS_CDE   =   'A'                      04630000
               ORDER BY I.ORD_NBR, I.ORD_LNE_NBR, I.REC_SEQ_NBR         04640000
           END-EXEC.                                                    04650000
005600******************************************************************04660000
      ****THIS IS THE TRECITM AND TSHUUPC CURSOR FOR FOR PACKING CODES *04670000
      ****OR 'M' OR 'I'.                                               *04680000
005600******************************************************************04690000
           EXEC SQL                                                     04700000
               DECLARE RECITMMI_CSR CURSOR WITH HOLD FOR                04710000
                SELECT DISTINCT D.PREPK_ID                              04720000
                  FROM TSHUUPC A                                        04730000
                      ,TINPKSU B                                        04740000
                      ,TPKSLIP C                                        04750000
                      ,TRECITM D                                        04760000
                      ,TPURITM E                                        04770000
                      ,TSHPUNT F                                        04780000
                  WHERE A.SHIPT_UNT_ID     =   :SUT00112-SHIPT-UNT-ID   04790000
                  AND   A.SHIPT_UNT_ID     =   B.SHIPT_UNT_ID           04800000
                  AND   A.SHIPT_UNT_ID     =   F.SHIPT_UNT_ID           04810000
                  AND   A.TRN_NBR          =   :PKSLIP-PO-NBR           04820000
                  AND   A.TRN_NBR          =   B.PO_NBR                 04830000
                  AND   B.PO_NBR           =   C.PO_NBR                 04840000
                  AND   B.SEQ_NBR          =   C.SEQ_NBR                04850000
                  AND   C.VER_STAT_CDE     =   'A'                      04860000
                  AND   C.PO_NBR           =   D.ORD_NBR                04870000
                  AND   C.REC_SEQ_NBR      =   D.REC_SEQ_NBR            04880000
                  AND   A.TRN_LNE_NBR      =   D.ORD_LNE_NBR            04890000
                  AND   D.ORD_NBR          =   E.PO_NBR                 04900000
                  AND   D.ORD_LNE_NBR      =   E.APP_PO_LNE_NBR         04910000
                  AND   D.PO_VER_NBR       =   E.VER_NBR                04920000
           END-EXEC.                                                    04930000
053100******************************************************************04940000
053200 PROCEDURE DIVISION.                                              04950000
053300******************************************************************04960000
053400******************************************************************04970000
053500*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *04980000
053600******************************************************************04990000
053700 0000-PROGRAM-MAINLINE.                                           05000000
053800                                                                  05010000
053900     PERFORM 1000-INITIALIZE.                                     05020000
054000                                                                  05030000
054100     PERFORM 2000-PROCESS-INPUT                                   05040000
026000            UNTIL PS-END-OF-CNTRL.                                05050000
054300                                                                  05060000
054400     PERFORM 9000-EOJ-ROUTINE.                                    05070000
054500     STOP RUN.                                                    05080000
054600                                                                  05090000
054700******************************************************************05100000
054800*  OPENS INPUT FILES AND DOES PRIMING READ OF THE CONTROL FILE.  *05110000
055000******************************************************************05120000
055100 1000-INITIALIZE.                                                 05130000
                                                                        05140000
055300     OPEN INPUT SURD032-CONTROL-FILE.                             05150000
055600                                                                  05160000
      ****PRIMING READ LOGIC FOR CONTROL FILE***************************05170000
056100     PERFORM 6000-READ-CONTROL-FILE.                              05180000
           IF PS-END-OF-CNTRL                                           05190000
435800         DISPLAY '**********************************'             05200000
435900         DISPLAY '** NO RECORDS ON CONTROL FILE'                  05210000
435800         DISPLAY '**********************************'             05220000
054400         PERFORM 9000-EOJ-ROUTINE                                 05230000
400500     ELSE                                                         05240000
001700         OPEN OUTPUT SURD087-EXTRACT-FILE                         05250000
001700         PERFORM 3000-RETRIEVE-PARM-MTCH-CDES                     05260005
               IF KRPRPM-FUNC-TXT = PC-MATCH-FUNC-TXT-X                 05270005
                   MOVE SPACE  TO PV-MATCH-ALL                          05280005
037700         ELSE                                                     05290005
037700             IF KRPRPM-FUNC-TXT = PC-MATCH-FUNC-TXT-A             05300005
037700                 MOVE 'ALL' TO PV-MATCH-ALL                       05310000
037700             ELSE                                                 05320005
435800                 DISPLAY '**********************************'     05330005
435900                 DISPLAY '** THIS IS NOT A VALID FUNC CODE**'     05340005
435900                 DISPLAY '** KRPRPM-FUNC-TXT' KRPRPM-FUNC-TXT     05350005
435800                 DISPLAY '**********************************'     05360005
638908                 DISPLAY '** ABEND **'                            05370005
638909                 DISPLAY '** PROGRAM = SUKUT131 **'               05380005
638910                 DISPLAY '** PARAGRAPH = 1000-INITIALIZE'         05390005
399400                 PERFORM 9100-SQL-ABEND                           05400005
                   END-IF                                               05410005
               END-IF                                                   05420005
           END-IF.                                                      05430000
056800                                                                  05440000
                                                                        05450000
056900 EJECT                                                            05460000
057000******************************************************************05470000
057100* MAIN PROCESSING PARAGRAPH.                                     *05480000
062700******************************************************************05490000
062800 2000-PROCESS-INPUT.                                              05500000
062900                                                                  05510000
           INITIALIZE CNTRL-BEGIN-TMST                                  05520000
                      CNTRL-END-TMST                                    05530000
                      PV-CNTRL-BEGIN                                    05540000
                      PV-CNTRL-END.                                     05550000
                                                                        05560000
400600     ADD +1 TO PA-CNTRL-RECS-READ.                                05570000
                                                                        05580000
           IF SU032-RPT-TYPE = PC-DAILY                                 05590000
001400         MOVE SU032-FROM-DATE        TO    PV-CNTRL-BEGIN         05600000
               PERFORM 7000-OPEN-DAILY-CRTN-CSR                         05610000
               SET PS-ROW-FOUND-NO   TO TRUE                            05620000
325400         PERFORM 7050-FETCH-DAILY-CRTN                            05630000
325700             UNTIL PS-NO-MORE-DAILY                               05640000
031500         IF PS-ROW-FOUND-SW = 'N'                                 05650000
435800              DISPLAY '**********************************'        05660000
435900              DISPLAY '** NO DATA FOUND FOR DAY  ********'        05670000
435900              DISPLAY '** SU032-FROM-DATE' SU032-FROM-DATE        05680000
435800              DISPLAY '**********************************'        05690000
                    PERFORM 7880-FORMAT-DAILY-HEADER-LINE               05700000
                    PERFORM 8000-WRITE-OUTPUT-RECORD                    05710000
                    INITIALIZE SU087-REPORT-FILE-DATA                   05720000
                    SET SU087-REPORT-DETAIL  TO TRUE                    05730000
                    MOVE 'NO DLY RPT' TO SU087-VNDR-SHRT-NME            05740000
                    PERFORM 8000-WRITE-OUTPUT-RECORD                    05750000
               ELSE                                                     05760000
                   PERFORM 7880-FORMAT-DAILY-HEADER-LINE                05770000
                   PERFORM 8000-WRITE-OUTPUT-RECORD                     05780000
               END-IF                                                   05790000
325800         PERFORM 7150-CLOSE-DAILY-CRTN-CSR                        05800000
           ELSE                                                         05810000
               IF SU032-RPT-TYPE = PC-WEEKLY                            05820000
               OR SU032-RPT-TYPE = PC-MONTHLY                           05830000
034310             MOVE SU032-FROM-DATE        TO  PV-CNTRL-BEGIN       05840000
034400             MOVE PV-CNTRL-CENTURY-BEG   TO                       05850000
034400                                           PV-FORMAT-TMST-DTE-CC  05860000
034500             MOVE PV-CNTRL-YEAR-BEG      TO                       05870000
034500                                           PV-FORMAT-TMST-DTE-YY  05880000
034700             MOVE PV-CNTRL-MONTH-BEG     TO                       05890000
034700                                           PV-FORMAT-TMST-DTE-MM  05900000
034900             MOVE PV-CNTRL-DAY-BEG       TO                       05910000
034900                                           PV-FORMAT-TMST-DTE-DD  05920000
390600             MOVE ZEROS                  TO  PV-FORMAT-TMST-TM-HH 05930000
390700             MOVE ZEROS                  TO  PV-FORMAT-TMST-TM-MM 05940000
049900             MOVE ZEROS                  TO  PV-FORMAT-TMST-TM-SS 05950000
050000             MOVE ZEROS                  TO  PV-FORMAT-TMST-TM-NS 05960000
048800             MOVE PV-FORMAT-TMST         TO  CNTRL-BEGIN-TMST     05970000
034310             MOVE SU032-TO-DATE          TO  PV-CNTRL-END         05980000
034400             MOVE PV-CNTRL-CENTURY-END   TO                       05990000
034400                                           PV-FORMAT-TMST-DTE-CC  06000000
034500             MOVE PV-CNTRL-YEAR-END      TO                       06010000
034500                                           PV-FORMAT-TMST-DTE-YY  06020000
034700             MOVE PV-CNTRL-MONTH-END     TO                       06030000
034700                                           PV-FORMAT-TMST-DTE-MM  06040000
034900             MOVE PV-CNTRL-DAY-END       TO                       06050000
034900                                           PV-FORMAT-TMST-DTE-DD  06060000
390600             MOVE ZEROS                  TO  PV-FORMAT-TMST-TM-HH 06070000
390700             MOVE ZEROS                  TO  PV-FORMAT-TMST-TM-MM 06080000
049900             MOVE ZEROS                  TO  PV-FORMAT-TMST-TM-SS 06090000
050000             MOVE ZEROS                  TO  PV-FORMAT-TMST-TM-NS 06100000
048800             MOVE PV-FORMAT-TMST         TO  CNTRL-END-TMST       06110000
                   PERFORM 7200-OPEN-WKMNT-CRTN-CSR                     06120000
                   SET PS-ROW-FOUND-NO   TO TRUE                        06130000
325400             PERFORM 7250-FETCH-WKMNT-CRTN                        06140000
325700                 UNTIL PS-NO-MORE-WEEKMNT                         06150000
031500             IF PS-ROW-FOUND-SW = 'N'                             06160000
435800                 DISPLAY '**********************************'     06170000
435900                 DISPLAY '** NO DATA FOUND FOR FISCAL WK/MTH'     06180000
435900                 DISPLAY '** FROM DATE**'   SU032-FROM-DATE       06190000
435900                 DISPLAY '** TO   DATE**'   SU032-TO-DATE         06200000
435800                 DISPLAY '**********************************'     06210000
                    PERFORM 7890-FORMAT-WKMNT-HEADER-LINE               06221002
                    PERFORM 8000-WRITE-OUTPUT-RECORD                    06222002
                    INITIALIZE SU087-REPORT-FILE-DATA                   06223002
                    SET SU087-REPORT-DETAIL  TO TRUE                    06224002
                    MOVE 'NO REPORT ' TO SU087-VNDR-SHRT-NME            06225002
                    PERFORM 8000-WRITE-OUTPUT-RECORD                    06226002
                   ELSE                                                 06230000
                       PERFORM 7890-FORMAT-WKMNT-HEADER-LINE            06240000
                       PERFORM 8000-WRITE-OUTPUT-RECORD                 06250000
                   END-IF                                               06260000
325800             PERFORM 7350-CLOSE-WKMNT-CRTN-CSR                    06270000
               ELSE                                                     06280000
435800             DISPLAY '**********************************'         06290000
435900             DISPLAY '** REPORT TYPE CODE ON CNTL FILE**'         06300000
435900             DISPLAY '** IS NOT VALID*******************'         06310000
436000             DISPLAY 'SU032-RPT-TYPE    = ' SU032-RPT-TYPE        06320000
435800             DISPLAY '**********************************'         06330000
027207             MOVE '2000-PROCESS-INPUT'                            06340000
027207                                        TO PV-PARAGRAPH-NAME      06350000
027209             PERFORM 9999-ABEND                                   06360000
               END-IF                                                   06370000
           END-IF.                                                      06380000
                                                                        06390000
           PERFORM 6000-READ-CONTROL-FILE.                              06400000
                                                                        06410000
           PERFORM 6050-CHECK-CONTROL-EOF.                              06420000
      ***************************************************************** 06430000
W20445* SELECT PARM MTCH CDES FOR DRIVING CURSOR                        06440000
      ***************************************************************** 06450000
       3000-RETRIEVE-PARM-MTCH-CDES.                                    06460000
                                                                        06470000
           INITIALIZE DCLTKRPRPM                                        06480000
                      DCLTKRPRCD.                                       06490000
                                                                        06500000
           EXEC SQL                                                     06510000
               SELECT B.FUNC_TXT                                        06520000
                 INTO :KRPRPM-FUNC-TXT                                  06530000
               FROM TKRPRCD A                                           06540000
                   ,TKRPRPM B                                           06550000
               WHERE A.SYS_PRC_FUNC_CDE = 'MTCHCD'                      06560000
               AND   A.SYS_PRC_FUNC_CDE = B.SYS_PRC_FUNC_CDE            06570000
               AND   B.LOC_ID           = 90                            06580000
               AND   B.INTFC_SYS_CDE    = 'KHL'                         06590000
           END-EXEC.                                                    06600000
                                                                        06610000
           EVALUATE TRUE                                                06620000
               WHEN SQLCODE        = +0                                 06630000
               WHEN SQLCODE        = -305                               06640000
                    CONTINUE                                            06650000
               WHEN OTHER                                               06660000
638908             DISPLAY '** ABEND **'                                06670000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   06680000
638910             DISPLAY '** PARAGRAPH = 3000-RETRIEVE-PARM-MTCH-CDES'06690000
                   DISPLAY '** INBD TRIP ID  =' SUT00112-INBD-TRIP-ID   06700000
685800             PERFORM 9100-SQL-ABEND                               06710000
            END-EVALUATE.                                               06720000
                                                                        06730000
399300******************************************************************06740000
399400* READ A RECORD FROM THE DATE CONTROL FILE                       *06750000
399500******************************************************************06760000
399600 6000-READ-CONTROL-FILE.                                          06770000
399700                                                                  06780000
399800     READ SURD032-CONTROL-FILE                                    06790000
399900         INTO SU032-DATE-CONTROL-REC                              06800000
400000         AT END                                                   06810000
400100           SET PS-END-OF-CNTRL TO TRUE.                           06820000
400200                                                                  06830000
399300******************************************************************06840000
399400* CHECK END OF RECORD FROM THE DATE CONTROL FILE.                *06850000
399500******************************************************************06860000
399600 6050-CHECK-CONTROL-EOF.                                          06870000
399700                                                                  06880000
           IF PS-END-OF-CNTRL                                           06890000
435800         DISPLAY '**********************************'             06900000
435900         DISPLAY '** NORMAL END OF FILE'                          06910000
435800         DISPLAY '**********************************'             06920000
           END-IF.                                                      06930000
400200                                                                  06940000
      ***************************************************************** 06950000
W20445* OPEN CURSOR FOR PULLING ALL TYPES OF EXCEPTIONS FOR EACH CARTON 06960000
W20445* DURING UNLOAD FOR DAILY (FROM DATE ON THE CONTROL CARD)         06970000
      ***************************************************************** 06980000
       7000-OPEN-DAILY-CRTN-CSR.                                        06990000
           EXEC SQL                                                     07000000
               OPEN DAILY_CRTN_CSR                                      07010000
           END-EXEC.                                                    07020000
                                                                        07030000
645260     EVALUATE TRUE                                                07040000
399500         WHEN SQLCODE = +0                                        07050000
                  CONTINUE                                              07060000
               WHEN OTHER                                               07070000
638908             DISPLAY '** ABEND **'                                07080000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   07090000
638910             DISPLAY '** PARAGRAPH = 7000-OPEN-DAILY-CRTN-CSR'    07100000
638911             PERFORM 9100-SQL-ABEND                               07110000
           END-EVALUATE.                                                07120000
                                                                        07130000
      ***************************************************************** 07140000
W20445* PROCESS FETCHED ROW FROM DAILY CARTON CURSOR                    07150000
      ***************************************************************** 07160000
325400 7050-FETCH-DAILY-CRTN.                                           07170000
                                                                        07180000
           PERFORM 7100-FETCH-DAILY-CTRN-CSR.                           07190000
                                                                        07200000
           IF PS-MORE-DAILY                                             07210000
                SET SU087-REPORT-DETAIL  TO TRUE                        07220000
                IF  SUT00112-INBD-TRIP-ID = PV-INBD-TRIP-ID             07230000
                AND SUT00112-ACM-LBL-STA-NBR = PV-ACM-LBL-STA-NBR       07240000
                AND SUT00112-SHIPT-UNT-ID = PV-SHIPT-UNT-ID             07250000
288900              PERFORM 7850-FORMAT-DRIVING-CUR-DETAIL              07260000
                    PERFORM 8000-WRITE-OUTPUT-RECORD                    07270000
                ELSE                                                    07280000
288900              PERFORM 7850-FORMAT-DRIVING-CUR-DETAIL              07290000
                    INITIALIZE  SU087-ALT-TRIP-ID                       07300000
                                SU087-ALT-CARR-SCAC                     07310000
                                SU087-ALT-VEH-NBR                       07320000
                    PERFORM 7500-OPEN-ALT-TRIP-CSR                      07330000
398500              INITIALIZE  PS-NO-MORE-ALT-TRIP-SW                  07340000
                                PA-ALT-TRIPS                            07350000
                                PA-ALT-TRIP-COUNT                       07360000
                                PT-TRIP-TABLE                           07370000
                    SET SA-INDX TO 1                                    07380000
325400              PERFORM 7550-FETCH-ALT-TRIP                         07390000
325700                 UNTIL PS-NO-MORE-ALT-TRIP                        07400000
325800              PERFORM 7650-CLOSE-ALT-TRIP-CSR                     07410000
031300              INITIALIZE PS-ROW-FOUND-PKSLIP-SW                   07430000
                    PERFORM 7360-SELECT-PACKSLIP-DEPT-VNDR              07440000
                    IF PS-ROW-FOUND-PKSLIP                              07450000
                      PERFORM 7860-FORMAT-PKSLIP-DETAIL                 07460000
                      INITIALIZE PS-ROW-FOUND-RECEIV-SW                 07461000
                      PERFORM 7400-SELECT-RECEIVING-LEVEL               07462000
                      IF PS-ROW-FOUND-RECEIV                            07463000
                          INITIALIZE        SU087-LINE-OR-PCK-ID        07464000
                                            SU087-LINE-OR-PCK-ID-X      07465000
                          MOVE SPACES   TO  SU087-LINE-PCK-TYP          07466000
                          PERFORM 7870-FORMAT-RECEIVING-DETAIL          07467000
                          PERFORM 7810-FORMAT-LINE-PCK-DETAIL           07468000
                      ELSE                                              07469000
                          PERFORM 7820-FRMT-LNE-PCK-DTL-NO-RCVR         07480000
                      END-IF                                            07490000
                    ELSE                                                07500000
                        INITIALIZE   SU087-PO-NBR                       07510000
                                     SU087-DEPT-NBR                     07520000
                                     SU087-RCVR-SEQ-NBR                 07530000
                                     SU087-VERFYD-DTE                   07540000
                                     SU087-VNDR-SHRT-NME                07550000
                        PERFORM 8000-WRITE-OUTPUT-RECORD                07560000
                    END-IF                                              07570000
                END-IF                                                  07580000
           END-IF.                                                      07590000
                                                                        07600000
                                                                        07610000
      ***************************************************************** 07620000
W20445* FETCH DAILY CARTON EXCEPTION CURSOR                             07630000
      ***************************************************************** 07640000
325400 7100-FETCH-DAILY-CTRN-CSR.                                       07650000
                                                                        07660000
                                                                        07670000
397500     INITIALIZE DCLSUT00112                                       07680000
                      DCLTVHTRIP                                        07690000
                      PS-NO-MORE-DAILY-SW.                              07700000
                                                                        07710000
397700     EXEC SQL                                                     07720000
397800         FETCH  DAILY_CRTN_CSR                                    07730000
                INTO  :SUT00112-OPER-UNT-ID                             07740000
                   ,  :SUT00112-INBD-TRIP-ID                            07750000
                   ,  :SUT00112-CRE-MTCH-TMST                           07760000
                   ,  :VHTRIP-OWNER-SCAC-ID                             07770000
                   ,  :VHTRIP-VEH-NBR                                   07780000
                   ,  :SUT00112-CART-MTCH-CDE                           07790000
                   ,  :SUT00112-DOOR-ID                                 07800000
                   ,  :SUT00112-ACM-LBL-STA-NBR                         07810000
                   ,  :SUT00112-SHIPT-UNT-ID                            07820000
398100     END-EXEC.                                                    07830000
398200                                                                  07840000
398300     EVALUATE TRUE                                                07850000
399500         WHEN SQLCODE = +0                                        07860000
031400             SET PS-ROW-FOUND          TO TRUE                    07870000
398500             SET PS-MORE-DAILY      TO TRUE                       07880000
                   ADD +1  TO PA-FETCH                                  07890000
398400         WHEN SQLCODE = +100                                      07900000
398500             SET PS-NO-MORE-DAILY   TO TRUE                       07910000
398600         WHEN SQLWARN0 NOT = SPACE                                07920000
398700         WHEN SQLCODE < ZERO                                      07930000
398800         WHEN SQLCODE > ZERO                                      07940000
638908             DISPLAY '** ABEND **'                                07950000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   07960000
638910             DISPLAY '** PARAGRAPH = 7100-FETCH-DAILY-CTRN-CSR'   07970000
399400             PERFORM 9100-SQL-ABEND                               07980000
399700     END-EVALUATE.                                                07990000
                                                                        08000000
                                                                        08010000
      ***************************************************************** 08020000
W20445* CLOSE DAILY EXCEPTION CURSOR                                    08030000
      ***************************************************************** 08040000
684300 7150-CLOSE-DAILY-CRTN-CSR.                                       08050000
                                                                        08060000
684400     EXEC SQL                                                     08070000
684500         CLOSE DAILY_CRTN_CSR                                     08080000
684600     END-EXEC.                                                    08090000
684700                                                                  08100000
684800     EVALUATE TRUE                                                08110000
684900         WHEN SQLCODE = +0                                        08120000
685000             CONTINUE                                             08130000
685100         WHEN SQLWARN0 NOT = SPACE                                08140000
685200         WHEN SQLCODE < ZERO                                      08150000
685300         WHEN SQLCODE > ZERO                                      08160000
638908             DISPLAY '** ABEND **'                                08170000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   08180000
638910             DISPLAY '** PARAGRAPH = 7150-CLOSE-DAILY-CRTN-CSR'   08190000
685800             PERFORM 9100-SQL-ABEND                               08200000
685900     END-EVALUATE.                                                08210000
                                                                        08220000
      ***************************************************************** 08230000
W20445* OPEN CURSOR FOR PULLING ALL TYPES OF EXCEPTIONS FOR EACH CARTON 08240000
W20445* DURING UNLOAD FOR WEEKLY OR MONTHLY DEPENDANT ON CONTROL CARD   08250000
W20445* BETWEEN (FROM DATE AND TO DATE).                                08260000
      ***************************************************************** 08270000
       7200-OPEN-WKMNT-CRTN-CSR.                                        08280000
                                                                        08290000
           EXEC SQL                                                     08300000
               OPEN WEEK_MONTH_CRTN_CSR                                 08310000
           END-EXEC.                                                    08320000
                                                                        08330000
645260     EVALUATE TRUE                                                08340000
399500         WHEN SQLCODE = +0                                        08350000
                  CONTINUE                                              08360000
               WHEN OTHER                                               08370000
638908             DISPLAY '** ABEND **'                                08380000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   08390000
638910             DISPLAY '** PARAGRAPH = 7200-OPEN-WKMNT-CRTN-CSR'    08400000
638911             PERFORM 9100-SQL-ABEND                               08410000
           END-EVALUATE.                                                08420000
                                                                        08430000
      ***************************************************************** 08440000
W20445* PROCESS FETCHED ROW FROM WEEKLY OR MONTHLY CARTON CURSOR        08450000
      ***************************************************************** 08460000
325400 7250-FETCH-WKMNT-CRTN.                                           08470000
                                                                        08480000
           PERFORM 7300-FETCH-WKMNT-CTRN-CSR.                           08490000
                                                                        08500000
           IF PS-MORE-WEEKMNT                                           08510000
                SET SU087-REPORT-DETAIL  TO TRUE                        08520000
                IF  SUT00112-INBD-TRIP-ID = PV-INBD-TRIP-ID             08530000
                AND SUT00112-ACM-LBL-STA-NBR = PV-ACM-LBL-STA-NBR       08540000
                AND SUT00112-SHIPT-UNT-ID = PV-SHIPT-UNT-ID             08550000
288900              PERFORM 7850-FORMAT-DRIVING-CUR-DETAIL              08560000
                    PERFORM 8000-WRITE-OUTPUT-RECORD                    08570000
                ELSE                                                    08580000
288900              PERFORM 7850-FORMAT-DRIVING-CUR-DETAIL              08590000
                    INITIALIZE  SU087-ALT-TRIP-ID                       08600000
                                SU087-ALT-CARR-SCAC                     08610000
                                SU087-ALT-VEH-NBR                       08620000
                    PERFORM 7500-OPEN-ALT-TRIP-CSR                      08630000
398500              INITIALIZE  PS-NO-MORE-ALT-TRIP-SW                  08640000
                                PA-ALT-TRIPS                            08650000
                                PA-ALT-TRIP-COUNT                       08660000
                                PT-TRIP-TABLE                           08670000
                    SET SA-INDX TO 1                                    08680000
325400              PERFORM 7550-FETCH-ALT-TRIP                         08690000
325700                 UNTIL PS-NO-MORE-ALT-TRIP                        08700000
325800              PERFORM 7650-CLOSE-ALT-TRIP-CSR                     08710000
031300              INITIALIZE PS-ROW-FOUND-PKSLIP-SW                   08730000
                    PERFORM 7360-SELECT-PACKSLIP-DEPT-VNDR              08731000
                    IF PS-ROW-FOUND-PKSLIP                              08732000
                      PERFORM 7860-FORMAT-PKSLIP-DETAIL                 08733000
                      INITIALIZE PS-ROW-FOUND-RECEIV-SW                 08734000
                      PERFORM 7400-SELECT-RECEIVING-LEVEL               08735000
                      IF PS-ROW-FOUND-RECEIV                            08736000
                         INITIALIZE        SU087-LINE-OR-PCK-ID         08737000
                                           SU087-LINE-OR-PCK-ID-X       08738000
                         MOVE SPACES   TO  SU087-LINE-PCK-TYP           08739000
                         PERFORM 7870-FORMAT-RECEIVING-DETAIL           08740000
                         PERFORM 7810-FORMAT-LINE-PCK-DETAIL            08750000
                      ELSE                                              08760000
                         PERFORM 7820-FRMT-LNE-PCK-DTL-NO-RCVR          08780000
                      END-IF                                            08790000
                    ELSE                                                08800000
                        INITIALIZE   SU087-PO-NBR                       08810000
                                     SU087-DEPT-NBR                     08820000
                                     SU087-RCVR-SEQ-NBR                 08830000
                                     SU087-VERFYD-DTE                   08840000
                        PERFORM 8000-WRITE-OUTPUT-RECORD                08850000
                    END-IF                                              08860000
                END-IF                                                  08870000
           END-IF.                                                      08880000
                                                                        08890000
W20445* FETCH WEEKLY OR MONTHLY CURSOR                                  08900000
      ***************************************************************** 08910000
325400 7300-FETCH-WKMNT-CTRN-CSR.                                       08920000
                                                                        08930000
397500     INITIALIZE DCLSUT00112                                       08940000
                      DCLTVHTRIP                                        08950000
023400                PS-NO-MORE-WEEKMNT-SW.                            08960000
                                                                        08970000
397700     EXEC SQL                                                     08980000
397800         FETCH  WEEK_MONTH_CRTN_CSR                               08990000
                INTO  :SUT00112-OPER-UNT-ID                             09000000
                   ,  :SUT00112-INBD-TRIP-ID                            09010000
                   ,  :SUT00112-CRE-MTCH-TMST                           09020000
                   ,  :VHTRIP-OWNER-SCAC-ID                             09030000
                   ,  :VHTRIP-VEH-NBR                                   09040000
                   ,  :SUT00112-CART-MTCH-CDE                           09050000
                   ,  :SUT00112-DOOR-ID                                 09060000
                   ,  :SUT00112-ACM-LBL-STA-NBR                         09070000
                   ,  :SUT00112-SHIPT-UNT-ID                            09080000
398100     END-EXEC.                                                    09090000
398200                                                                  09100000
398300     EVALUATE TRUE                                                09110000
399500         WHEN SQLCODE = +0                                        09120000
031400             SET PS-ROW-FOUND          TO TRUE                    09130000
398500             SET PS-MORE-WEEKMNT    TO TRUE                       09140000
                   ADD +1  TO PA-FETCH                                  09150000
398400         WHEN SQLCODE = +100                                      09160000
398500             SET PS-NO-MORE-WEEKMNT    TO TRUE                    09170000
398600         WHEN SQLWARN0 NOT = SPACE                                09180000
398700         WHEN SQLCODE < ZERO                                      09190000
398800         WHEN SQLCODE > ZERO                                      09200000
638908             DISPLAY '** ABEND **'                                09210000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   09220000
638910             DISPLAY '** PARAGRAPH = 7300-FETCH-WKMNT-CTRN-CSR'   09230000
399400             PERFORM 9100-SQL-ABEND                               09240000
399700     END-EVALUATE.                                                09250000
                                                                        09260000
                                                                        09270000
      ***************************************************************** 09280000
W20445* CLOSE WEEKLY/MONTHLY EXCEPTION CURSOR                           09290000
      ***************************************************************** 09300000
684300 7350-CLOSE-WKMNT-CRTN-CSR.                                       09310000
                                                                        09320000
684400     EXEC SQL                                                     09330000
684500         CLOSE WEEK_MONTH_CRTN_CSR                                09340000
684600     END-EXEC.                                                    09350000
684700                                                                  09360000
684800     EVALUATE TRUE                                                09370000
684900         WHEN SQLCODE = +0                                        09380000
685000             CONTINUE                                             09390000
685100         WHEN SQLWARN0 NOT = SPACE                                09400000
685200         WHEN SQLCODE < ZERO                                      09410000
685300         WHEN SQLCODE > ZERO                                      09420000
638908             DISPLAY '** ABEND **'                                09430000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   09440000
638910             DISPLAY '** PARAGRAPH = 7350-CLOSE-WKMNT-CRTN-CSR'   09450000
685800             PERFORM 9100-SQL-ABEND                               09460000
685900     END-EVALUATE.                                                09470000
      ***************************************************************** 09480000
W20445* SELECT PACKSLIP, DEPT AND VENDOR DATA FOR OUTPUT FILE           09490000
      ***************************************************************** 09500000
397400 7360-SELECT-PACKSLIP-DEPT-VNDR.                                  09510000
                                                                        09520000
           INITIALIZE DCLTPURCHS                                        09530000
                      DCLTENTNME                                        09540000
                      DCLTPKSLIP                                        09550000
                      DCLTINPKSU                                        09560000
                      DCLTSHPUNT.                                       09570000
                                                                        09580000
           EXEC SQL                                                     09590000
               SELECT  DISTINCT                                         09600000
                        E.PO_NBR                                        09610000
                       ,E.REC_SEQ_NBR                                   09620000
                       ,A.DEPT_NBR                                      09630000
                       ,A.PKGNG_CDE                                     09640000
                       ,B.ENT_NAME_DESC                                 09650000
                 INTO :PKSLIP-PO-NBR                                    09660000
                     ,:PKSLIP-REC-SEQ-NBR                               09670000
                     ,:PURCHS-DEPT-NBR                                  09680000
                     ,:PURCHS-PKGNG-CDE                                 09690000
                     ,:ENTNME-ENT-NAME-DESC                             09700000
                 FROM TPURCHS A,                                        09710000
                      TENTNME B,                                        09720000
                      TPKSLIP E,                                        09730000
                      TINPKSU F,                                        09740000
                      TSHPUNT G                                         09750000
                 WHERE A.ENT_ID         =   B.ENT_ID                    09760000
                 AND   A.PO_NBR         =   E.PO_NBR                    09770000
                 AND   A.VER_STATUS_CDE =   'A'                         09780000
                 AND   E.VER_STAT_CDE   =   'A'                         09790000
                 AND   B.TYPE_CDE       =   '04'                        09800000
                 AND   E.PO_NBR         =   F.PO_NBR                    09810000
                 AND   E.SEQ_NBR        =   F.SEQ_NBR                   09820000
                 AND   F.SHIPT_UNT_ID   =   G.SHIPT_UNT_ID              09830000
                 AND   G.SHIPT_UNT_ID   =   :SUT00112-SHIPT-UNT-ID      09840000
                 ORDER BY E.PO_NBR, E.REC_SEQ_NBR                       09850000
           END-EXEC.                                                    09860000
                                                                        09870000
           EVALUATE TRUE                                                09880000
               WHEN SQLCODE        = +0                                 09890000
398500             SET PS-ROW-FOUND-PKSLIP    TO TRUE                   09900000
               WHEN SQLCODE        = +100                               09910000
398500             SET PS-ROW-FOUND-PKSLIP-NO TO TRUE                   09920000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   09930000
638910           DISPLAY '** PARAGRAPH = 7360-SELECT-PACKSLIP-DEPT-VNDR'09940000
638910             DISPLAY '** +100 CANNOT FIND ROW ******************' 09950000
                   DISPLAY '**SUT00112-SHIPT-UNT-ID = '                 09960000
                   DISPLAY SUT00112-SHIPT-UNT-ID                        09970000
                   DISPLAY '**SUT00110-INBD-TRIP-ID = '                 09980000
                   DISPLAY SUT00110-INBD-TRIP-ID                        09990000
               WHEN OTHER                                               10000000
638908             DISPLAY '** ABEND **'                                10010000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   10020000
638910           DISPLAY '** PARAGRAPH = 7360-SELECT-PACKSLIP-DEPT-VNDR'10030000
                   DISPLAY '**:SUT00112-SHIPT-UNT-ID = '                10040000
                   DISPLAY SUT00112-SHIPT-UNT-ID                        10050000
685800             PERFORM 9100-SQL-ABEND                               10060000
           END-EVALUATE.                                                10070000
398200                                                                  10080000
      ***************************************************************** 10090000
W20445* SELECT RECEIVING DATA FOR OUTPUT FILE                           10100000
      ***************************************************************** 10110000
397400 7400-SELECT-RECEIVING-LEVEL.                                     10120000
                                                                        10130000
                                                                        10140000
           INITIALIZE DCLTRECEIV.                                       10150000
                                                                        10160000
           EXEC SQL                                                     10170000
               SELECT  DISTINCT                                         10180000
                        D.VERFYD_TMST                                   10190000
                       ,D.STATUS_CDE                                    10200000
                       ,D.PACK_BY_ST_IND                                10210000
                       ,D.PKGNG_CDE                                     10220000
                       ,D.CRE_UID                                       10230000
                 INTO                                                   10240000
                      :RECEIV-VERFYD-TMST                               10250000
                     ,:RECEIV-STATUS-CDE                                10260000
                     ,:RECEIV-PACK-BY-ST-IND                            10261000
                     ,:RECEIV-PKGNG-CDE                                 10261100
                     ,:RECEIV-CRE-UID                                   10261200
                 FROM                                                   10261300
                      TRECEIV D                                         10261400
                 WHERE                                                  10261500
                       D.ORD_NBR        = :PKSLIP-PO-NBR                10261600
                 AND   D.REC_SEQ_NBR    = :PKSLIP-REC-SEQ-NBR           10261700
           END-EXEC.                                                    10261800
                                                                        10261900
           EVALUATE TRUE                                                10262000
               WHEN SQLCODE        = +0                                 10263000
398500             SET PS-ROW-FOUND-RECEIV    TO TRUE                   10263100
               WHEN SQLCODE        = +100                               10263200
398500             SET PS-ROW-FOUND-RECEIV-NO TO TRUE                   10263300
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   10263400
638910             DISPLAY '** PARAGRAPH = 7400-SELECT-RECEIVING-LEVEL' 10263500
638910             DISPLAY '** +100 CANNOT FIND ROW ******************' 10263600
                   DISPLAY '**SUT00112-SHIPT-UNT-ID = '                 10263700
                   DISPLAY SUT00112-SHIPT-UNT-ID                        10263800
                   DISPLAY '**PKSLIP-PO-NBR = '                         10263900
                   DISPLAY PKSLIP-PO-NBR                                10264000
                   DISPLAY '**PKSLIP-REC-SEQ-NBR = '                    10264100
                   DISPLAY PKSLIP-REC-SEQ-NBR                           10264200
               WHEN OTHER                                               10264300
638908             DISPLAY '** ABEND **'                                10264400
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   10264500
638910             DISPLAY '** PARAGRAPH = 7400-SELECT-RECEIVING-LEVEL' 10264600
                   DISPLAY '**:SUT00112-SHIPT-UNT-ID = '                10264700
                   DISPLAY SUT00112-SHIPT-UNT-ID                        10264800
685800             PERFORM 9100-SQL-ABEND                               10264900
           END-EVALUATE.                                                10265000
398200                                                                  10265100
      ***************************************************************** 10265200
W20445* OPEN CURSOR FOR PULLING ALTERNATE TAILERS AND THE CORRESPONDING 10265300
W20445* TRIP IDS.                                                       10265400
      ***************************************************************** 10265500
       7500-OPEN-ALT-TRIP-CSR.                                          10265600
           EXEC SQL                                                     10265700
               OPEN ALT_TRIP_ID_CSR                                     10265800
           END-EXEC.                                                    10265900
                                                                        10266000
645260     EVALUATE TRUE                                                10267000
399500         WHEN SQLCODE = +0                                        10268000
                  CONTINUE                                              10269000
               WHEN OTHER                                               10270000
638908             DISPLAY '** ABEND **'                                10280000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   10290000
638910             DISPLAY '** PARAGRAPH = 7500-OPEN-ALT-TRIP-CSR'      10300000
638911             PERFORM 9100-SQL-ABEND                               10310000
           END-EVALUATE.                                                10320000
      ***************************************************************** 10330000
W20445* PROCESS FETCHED ROW FROM ALTERNATE TRIP CURSOR                  10340000
      ***************************************************************** 10350000
                                                                        10360000
325400 7550-FETCH-ALT-TRIP.                                             10370000
                                                                        10380000
                                                                        10390000
           PERFORM 7600-FETCH-ALT-TRIP-CSR.                             10400000
                                                                        10410000
                                                                        10420000
           IF PS-MORE-ALT-TRIP                                          10430000
              IF PA-ALT-TRIP-COUNT > 1                                  10440000
                  PERFORM 7560-LOAD-ALT-TRIP-TABLE                      10450000
              ELSE                                                      10460000
                  MOVE SUT00110-INBD-TRIP-ID TO PV-ALT-TRIP-ID          10470000
                  MOVE PV-ALT-TRIP-ID        TO SU087-ALT-TRIP-ID       10480000
                  MOVE VHTRIP-OWNER-SCAC-ID  TO SU087-ALT-CARR-SCAC     10490000
                  MOVE VHTRIP-VEH-NBR        TO SU087-ALT-VEH-NBR       10500000
              END-IF                                                    10510000
           END-IF.                                                      10520000
                                                                        10530000
      ***************************************************************** 10540000
W20445* PROCESS FETCHED ROW FROM ALTERNATE TRIP CURSOR AND LOAD         10550000
W20445* INTO INTERNAL TABLE IF MORE THAN ONE FOR EXTRACT FILE.          10560000
      ***************************************************************** 10570000
                                                                        10580000
325400 7560-LOAD-ALT-TRIP-TABLE.                                        10590000
                                                                        10600000
                                                                        10610000
           MOVE SUT00110-INBD-TRIP-ID TO PT-ALT-TRIP-ID (SA-INDX).      10620000
           MOVE VHTRIP-OWNER-SCAC-ID  TO PT-ALT-CARR-SCAC (SA-INDX).    10630000
           MOVE VHTRIP-VEH-NBR        TO PT-ALT-VEH-NBR (SA-INDX).      10640000
           SET SA-INDX UP BY 1.                                         10650000
           ADD +1 TO PA-ALT-TRIPS.                                      10660000
                                                                        10670000
      ***************************************************************** 10680000
W20445* UNLOAD ALTERNATE TRIP DETAIL FOR OUTPUT DETAIL FILE             10690000
      ***************************************************************** 10700000
       7570-UNLOAD-ALT-TRIP-ROWS.                                       10710000
                                                                        10720000
           PERFORM UNTIL SA-INDX > PA-ALT-TRIPS                         10730000
               MOVE PT-ALT-TRIP-ID (SA-INDX)   TO SU087-ALT-TRIP-ID     10740000
               MOVE PT-ALT-VEH-NBR (SA-INDX)   TO SU087-ALT-VEH-NBR     10750000
               MOVE PT-ALT-CARR-SCAC (SA-INDX) TO SU087-ALT-CARR-SCAC   10760000
               SET SA-INDX UP BY 1                                      10770000
               PERFORM 8000-WRITE-OUTPUT-RECORD                         10780000
           END-PERFORM.                                                 10790000
                                                                        10800000
      ***************************************************************** 10810000
W20445* FETCH ALTERNATE TRIP ROW FROM CURSOR                            10820000
      ***************************************************************** 10830000
325400 7600-FETCH-ALT-TRIP-CSR.                                         10840000
                                                                        10850000
397500     INITIALIZE DCLTVHTRIP                                        10860000
397500                PS-NO-MORE-ALT-TRIP-SW.                           10870000
                                                                        10880000
397700     EXEC SQL                                                     10890000
397800         FETCH  ALT_TRIP_ID_CSR                                   10900000
                INTO  :SUT00110-INBD-TRIP-ID                            10910000
                   ,  :VHTRIP-OWNER-SCAC-ID                             10920000
                   ,  :VHTRIP-VEH-NBR                                   10930000
398100     END-EXEC.                                                    10940000
398200                                                                  10950000
398300     EVALUATE TRUE                                                10960000
399500         WHEN SQLCODE = +0                                        10970000
398500             SET PS-MORE-ALT-TRIP      TO TRUE                    10980000
                   ADD +1                    TO PA-ALT-TRIP-COUNT       10990000
398400         WHEN SQLCODE = +100                                      11000000
398500             SET PS-NO-MORE-ALT-TRIP   TO TRUE                    11010000
398600         WHEN SQLWARN0 NOT = SPACE                                11020000
398700         WHEN SQLCODE < ZERO                                      11030000
398800         WHEN SQLCODE > ZERO                                      11040000
638908             DISPLAY '** ABEND **'                                11050000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   11060000
638910             DISPLAY '** PARAGRAPH = 7600-FETCH-ALT-TRIP-CSR'     11070000
399400             PERFORM 9100-SQL-ABEND                               11080000
399700     END-EVALUATE.                                                11090000
                                                                        11100000
      ***************************************************************** 11110000
W20445* CLOSE ALTERNATE TRIP CURSOR                                     11120000
      ***************************************************************** 11130000
684300 7650-CLOSE-ALT-TRIP-CSR.                                         11140000
                                                                        11150000
684400     EXEC SQL                                                     11160000
684500         CLOSE ALT_TRIP_ID_CSR                                    11170000
684600     END-EXEC.                                                    11180000
684700                                                                  11190000
684800     EVALUATE TRUE                                                11200000
684900         WHEN SQLCODE = +0                                        11210000
685000             CONTINUE                                             11220000
685100         WHEN SQLWARN0 NOT = SPACE                                11230000
685200         WHEN SQLCODE < ZERO                                      11240000
685300         WHEN SQLCODE > ZERO                                      11250000
638908             DISPLAY '** ABEND **'                                11260000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   11270000
638910             DISPLAY '** PARAGRAPH = 7650-CLOSE-ALT-TRIP-CSR'     11280000
685800             PERFORM 9100-SQL-ABEND                               11290000
685900     END-EVALUATE.                                                11300000
                                                                        11310000
      ***************************************************************** 11320000
W20445* OPEN CURSOR FOR PULLING MULTIPLE LINES ORD LINE NBR FROM THE    11330000
W20445* TRECITM TABLE FOR 'B' OR 'C' PACKING CODES.                     11340000
      ***************************************************************** 11350000
       7700-OPEN-ITEM-LEVELBC-CSR.                                      11360000
                                                                        11370000
           EXEC SQL                                                     11380000
               OPEN RECITMBC_CSR                                        11390000
           END-EXEC.                                                    11400000
                                                                        11410000
645260     EVALUATE TRUE                                                11420000
399500         WHEN SQLCODE = +0                                        11430000
                  CONTINUE                                              11440000
               WHEN OTHER                                               11450000
638908             DISPLAY '** ABEND **'                                11460000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   11470000
638910             DISPLAY '** PARAGRAPH = 7700-OPEN-ITEM-LEVELBC-CSR'  11480000
638911             PERFORM 9100-SQL-ABEND                               11490000
           END-EVALUATE.                                                11500000
      ***************************************************************** 11510000
W20445* PROCESS FETCHED ROW FROM TRECITM BC CURSOR                      11520000
      ***************************************************************** 11530000
325400 7750-FETCH-ITEM-LEVELBC.                                         11540000
                                                                        11550000
           PERFORM 7770-FETCH-TRECITM-BC-CSR.                           11560000
                                                                        11570000
           IF PS-ROW-FOUND-ITEM-BC                                      11580000
                MOVE RECEIV-PKGNG-CDE     TO SU087-LINE-PCK-TYP         11590000
                MOVE RECITM-ORD-LNE-NBR   TO SU087-LINE-OR-PCK-ID       11600000
                PERFORM 8000-WRITE-OUTPUT-RECORD                        11610000
                IF PA-ALT-TRIP-COUNT > 1                                11630000
                    SET SA-INDX TO 1                                    11640000
                    PERFORM 7570-UNLOAD-ALT-TRIP-ROWS                   11650000
                    INITIALIZE  PA-ALT-TRIP-COUNT                       11660000
                END-IF                                                  11670000
           ELSE IF PA-RECITM-FOUND = 0                                  11680000
                  IF PS-ROW-FOUND-RECEIV-NO                             11690000
                    MOVE SPACE     TO SU087-LINE-PCK-TYP                11700000
                    MOVE PC-RECEIVR-NOT-TRNSCRBD TO                     11710000
                           SU087-LINE-OR-PCK-ID-X                       11720000
                    IF PURCHS-PKGNG-CDE = PC-BLANK                      11730000
                       MOVE PC-LINE-OR-PCK-ID-PBS TO                    11740000
                             SU087-LINE-OR-PCK-ID-X                     11750000
                    ELSE                                                11760000
                       MOVE PURCHS-PKGNG-CDE TO SU087-LINE-OR-PCK-ID-X  11770000
                    END-IF                                              11780000
                  ELSE                                                  11790000
                    MOVE RECEIV-PKGNG-CDE     TO SU087-LINE-PCK-TYP     11791000
                    IF RECEIV-CRE-UID = 'F/A SYTM'                      11793000
                      MOVE PC-RECEIVR-FREE-ASTRAY TO                    11794000
                            SU087-LINE-OR-PCK-ID-X                      11795000
                    ELSE                                                11796000
                      MOVE PC-RECEIVR-NOT-TRNSCRBD TO                   11797000
                            SU087-LINE-OR-PCK-ID-X                      11798000
                    END-IF                                              11799000
                  END-IF                                                11810000
      *         MOVE SPACES               TO SU087-LINE-PCK-TYP         11820000
      *         MOVE SPACES               TO SU087-LINE-OR-PCK-ID-X     11830000
                ADD +1 TO PA-RECITM-NOT-FOUND                           11840000
638909          DISPLAY '** PROGRAM = SUKUT131 **'                      11850000
638908          DISPLAY '** RECITM ROW NOT FOUND FOR RECEIV BC*'        11860000
                DISPLAY 'SUT00112-OPER-UNT-ID' SUT00112-OPER-UNT-ID     11870000
                DISPLAY 'PKSLIP-PO-NBR'       PKSLIP-PO-NBR             11880000
                DISPLAY 'PKSLIP-REC-SEQ-NBR'   PKSLIP-REC-SEQ-NBR       11890000
                PERFORM 8000-WRITE-OUTPUT-RECORD                        11900000
                END-IF                                                  11910000
           END-IF.                                                      11920000
                                                                        11930000
      ***************************************************************** 11940000
W20445* FETCH TRECITM ROW FROM BC CURSOR                                11950000
      ***************************************************************** 11960000
325400 7770-FETCH-TRECITM-BC-CSR.                                       11970000
                                                                        11980000
397500     INITIALIZE DCLTRECITM                                        11990000
397500                DCLTSHUUPC.                                       12000000
                                                                        12010000
397700     EXEC SQL                                                     12020000
397800         FETCH  RECITMBC_CSR                                      12030000
                INTO  :RECITM-ORD-LNE-NBR                               12040000
                     ,:RECITM-ORD-NBR                                   12050000
                     ,:RECITM-REC-SEQ-NBR                               12060000
398100     END-EXEC.                                                    12070000
398200                                                                  12080000
398300     EVALUATE TRUE                                                12090000
399500         WHEN SQLCODE = +0                                        12100000
                   SET PS-ROW-FOUND-ITEM-BC  TO TRUE                    12110000
                   ADD +1 TO PA-RECITM-FOUND                            12120000
398400         WHEN SQLCODE = +100                                      12130000
                   SET PS-ROW-FOUND-ITEM-BC-NO TO TRUE                  12140000
398600         WHEN SQLWARN0 NOT = SPACE                                12150000
398700         WHEN SQLCODE < ZERO                                      12160000
398800         WHEN SQLCODE > ZERO                                      12170000
638908             DISPLAY '** ABEND **'                                12180000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   12190000
638910             DISPLAY '** PARAGRAPH = 7770-FETCH-TRECITM-BC-CSR'   12200000
399400             PERFORM 9100-SQL-ABEND                               12210000
399700     END-EVALUATE.                                                12220000
                                                                        12230000
      ***************************************************************** 12240000
W20445* CLOSE TRECITM BC CURSOR                                         12250000
      ***************************************************************** 12260000
684300 7800-CLOSE-ITEM-LEVELBC-CSR.                                     12270000
                                                                        12280000
684400     EXEC SQL                                                     12290000
684500         CLOSE RECITMBC_CSR                                       12300000
684600     END-EXEC.                                                    12310000
684700                                                                  12320000
684800     EVALUATE TRUE                                                12330000
684900         WHEN SQLCODE = +0                                        12340000
685000             CONTINUE                                             12350000
685100         WHEN SQLWARN0 NOT = SPACE                                12360000
685200         WHEN SQLCODE < ZERO                                      12370000
685300         WHEN SQLCODE > ZERO                                      12380000
638908             DISPLAY '** ABEND **'                                12390000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   12400000
638910             DISPLAY '** PARAGRAPH = 7800-CLOSE-ITEM-LEVELBC-CSR' 12410000
685800             PERFORM 9100-SQL-ABEND                               12420000
685900     END-EVALUATE.                                                12430000
                                                                        12440000
289000******************************************************************12450000
W20445* FORMAT OUTPUT DETAIL RECORD SU087-REPORT-FILE-DATA (LIN PCK TYP 12460000
W20445* AND LINE OR PCK ID) IN COPYBOOK SURD087 FOR INPUT TO SUKRP058.  12470000
289000******************************************************************12480000
288900 7810-FORMAT-LINE-PCK-DETAIL.                                     12490000
           IF RECEIV-PACK-BY-ST-IND = PC-REC-PACK-BY-ST-IND-YES         12500000
               MOVE SPACE                    TO SU087-LINE-PCK-TYP      12510000
               MOVE PC-LINE-OR-PCK-ID-PBS    TO SU087-LINE-OR-PCK-ID-X  12520000
               PERFORM 8000-WRITE-OUTPUT-RECORD                         12530000
               IF PA-ALT-TRIP-COUNT > 1                                 12540000
                    SET SA-INDX TO 1                                    12550000
                    PERFORM 7570-UNLOAD-ALT-TRIP-ROWS                   12560000
                    INITIALIZE  PA-ALT-TRIP-COUNT                       12570000
               END-IF                                                   12580000
           ELSE                                                         12590000
312400        IF PURCHS-PKGNG-CDE =  PC-REC-PKGNG-CDE-B                 12600000
312400        OR PURCHS-PKGNG-CDE =  PC-REC-PKGNG-CDE-C                 12610000
                   PERFORM 7700-OPEN-ITEM-LEVELBC-CSR                   12620000
031300             INITIALIZE PS-ROW-FOUND-ITEM-BC-SW                   12630000
                   MOVE ZEROS TO PA-RECITM-FOUND                        12640000
325400             PERFORM 7750-FETCH-ITEM-LEVELBC                      12650000
325700                 UNTIL PS-ROW-FOUND-ITEM-BC-NO                    12660000
325800             PERFORM 7800-CLOSE-ITEM-LEVELBC-CSR                  12670000
              ELSE                                                      12680000
312400            IF PURCHS-PKGNG-CDE =  PC-REC-PKGNG-CDE-M             12690000
312400            OR PURCHS-PKGNG-CDE =  PC-REC-PKGNG-CDE-I             12700000
                     PERFORM 8100-OPEN-ITEM-LEVELMI-CSR                 12710000
031300               INITIALIZE PS-ROW-FOUND-ITEM-MI-SW                 12720000
                     MOVE ZEROS TO PA-RECITM-FOUND                      12730000
325400               PERFORM 8200-FETCH-ITEM-LEVELMI                    12740000
325700                   UNTIL PS-ROW-FOUND-ITEM-MI-NO                  12750000
325800                PERFORM 8400-CLOSE-ITEM-LEVELMI-CSR               12760000
                  ELSE                                                  12770000
                      MOVE PC-LINE-PCK-TYP-X     TO SU087-LINE-PCK-TYP  12780000
                      MOVE PC-LINE-OR-PCK-ID-INVL                       12790000
                                                 TO SU087-LINE-OR-PCK-ID12800000
435800                DISPLAY '**********************************'      12810000
435900                DISPLAY '** TPURCHS PACKING CODE IS NOT ***'      12820000
435900                DISPLAY '** VALID *************************'      12830000
436000                DISPLAY 'PURCHS-PKGNG-CDE  = ' PURCHS-PKGNG-CDE   12840000
435800                DISPLAY '**********************************'      12850000
                  END-IF                                                12860000
              END-IF                                                    12870000
           END-IF.                                                      12880000
289000******************************************************************12890000
W20445* FORMAT OUTPUT DETAIL RECORD SU087-REPORT-FILE-DATA (LIN PCK TYP 12900000
W20445* AND LINE OR PCK ID) IN COPYBOOK SURD087 FOR INPUT TO SUKRP058.  12910000
W20445* USEDED IN PLACE OF 7810- WHEN NO RECEIVER IS AVAILABLE.         12911000
289000******************************************************************12912000
288900 7820-FRMT-LNE-PCK-DTL-NO-RCVR.                                   12913000
                                                                        12914000
           IF PURCHS-PKGNG-CDE = PC-BLANK                               12915000
              MOVE ' PBS' TO SU087-LINE-PCK-TYP                         12915100
           ELSE                                                         12915200
              MOVE PURCHS-PKGNG-CDE TO SU087-LINE-PCK-TYP               12915300
           END-IF.                                                      12915400
                                                                        12915500
           INITIALIZE SU087-VERFYD-DTE.                                 12915600
           SET  SU087-NOT-VERFYD         TO TRUE.                       12915700
                                                                        12915800
           INITIALIZE        SU087-LINE-OR-PCK-ID                       12916200
                             SU087-LINE-OR-PCK-ID-X.                    12916300
                                                                        12916400
           IF PURCHS-PKGNG-CDE =  PC-REC-PKGNG-CDE-B                    12916500
              OR PURCHS-PKGNG-CDE =  PC-REC-PKGNG-CDE-C                 12916600
              INITIALIZE PS-ROW-FOUND-SHUUPC-SW                         12916700
              PERFORM 7830-SELECT-LINE-WHEN-NO-RCVR                     12916800
                IF PS-ROW-FOUND-SHUUPC                                  12916900
                   MOVE SHUUPC-TRN-LNE-NBR TO SU087-LINE-OR-PCK-ID      12917000
                ELSE                                                    12917100
                   INITIALIZE        SU087-LINE-OR-PCK-ID               12917200
                                     SU087-LINE-OR-PCK-ID-X             12917300
                END-IF                                                  12917400
           END-IF.                                                      12917500
                                                                        12917600
           PERFORM 8000-WRITE-OUTPUT-RECORD                             12917700
                                                                        12917800
           IF PA-ALT-TRIP-COUNT > 1                                     12917900
               SET SA-INDX TO 1                                         12918000
               PERFORM 7570-UNLOAD-ALT-TRIP-ROWS                        12919000
               INITIALIZE  PA-ALT-TRIP-COUNT                            12919100
           END-IF.                                                      12919200
                                                                        12919300
      ***************************************************************** 12919400
      *GET LINE NUMBER WHEN NO RECEIVER AVAILABLE AND PACKAGING CODE    12919500
      *IS 'B' OR 'C'.                                                   12919600
      ***************************************************************** 12919700
288900 7830-SELECT-LINE-WHEN-NO-RCVR.                                   12919800
                                                                        12919900
           INITIALIZE DCLTSHUUPC.                                       12920000
                                                                        12921000
           EXEC SQL                                                     12922000
             SELECT DISTINCT H.TRN_LNE_NBR                              12922100
                 INTO :SHUUPC-TRN-LNE-NBR                               12922200
               FROM                                                     12922300
                    TSHUUPC H                                           12922400
               WHERE                                                    12922500
                     H.SHIPT_UNT_ID     =   :SUT00112-SHIPT-UNT-ID      12922600
           END-EXEC.                                                    12922700
                                                                        12922800
           EVALUATE TRUE                                                12922900
               WHEN SQLCODE        = +0                                 12923000
398500             SET PS-ROW-FOUND-SHUUPC    TO TRUE                   12923100
               WHEN SQLCODE        = +100                               12923200
398500             SET PS-ROW-FOUND-SHUUPC-NO TO TRUE                   12923300
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   12923400
638910           DISPLAY '** PARAGRAPH = 7830-SELECT-LINE-WHEN-NO-RCVR' 12923500
638910             DISPLAY '** +100 CANNOT FIND ROW ******************' 12923600
                   DISPLAY '**SUT00112-SHIPT-UNT-ID = '                 12923700
                   DISPLAY SUT00112-SHIPT-UNT-ID                        12923800
               WHEN SQLCODE        = -811                               12923906
      **HAPPEN WHEN CASE PACK HAS MULTIPLE ROWS AND DC FIXES-CASE PACK  12924006
      **SHOULD ONLY HAVE ONE ROW                                        12924106
398500             SET PS-ROW-FOUND-SHUUPC-NO TO TRUE                   12924206
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   12924306
638910           DISPLAY '** PARAGRAPH = 7830-SELECT-LINE-WHEN-NO-RCVR' 12924406
638910             DISPLAY '** -811 MULTIPLE ROWS   ******************' 12924506
                   DISPLAY '**SUT00112-SHIPT-UNT-ID = '                 12924606
                   DISPLAY SUT00112-SHIPT-UNT-ID                        12924706
               WHEN OTHER                                               12924806
638908             DISPLAY '** ABEND **'                                12924906
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   12925006
638910           DISPLAY '** PARAGRAPH = 7830-SELECT-LINE-WHEN-NO-RCVR' 12925106
                   DISPLAY '**:SUT00112-SHIPT-UNT-ID = '                12925206
                   DISPLAY SUT00112-SHIPT-UNT-ID                        12925306
685800             PERFORM 9100-SQL-ABEND                               12925406
           END-EVALUATE.                                                12925506
                                                                        12925606
289000******************************************************************12925706
W20445* FORMAT OUTPUT DETAIL RECORD SU087-REPORT-FILE-DATA FROM         12925806
W20445* THE DRIVING CURSOR.                                             12925906
289000******************************************************************12926000
288900 7850-FORMAT-DRIVING-CUR-DETAIL.                                  12927000
                                                                        12928000
                                                                        12929000
           MOVE VHTRIP-OWNER-SCAC-ID     TO SU087-CARR-SCAC             12930000
           MOVE VHTRIP-VEH-NBR           TO SU087-VEH-NBR               12940000
           MOVE SUT00112-INBD-TRIP-ID    TO PV-INBD-TRIP-ID             12950000
           MOVE SUT00112-INBD-TRIP-ID    TO SU087-TRIP-ID               12960000
           MOVE SUT00112-OPER-UNT-ID     TO SU087-OPER-UNT-ID.          12970000
           MOVE SUT00112-ACM-LBL-STA-NBR TO PV-ACM-LBL-STA-NBR          12980000
           MOVE SUT00112-ACM-LBL-STA-NBR TO SU087-ACM-LBL-STA-NBR.      12990000
           MOVE SUT00112-SHIPT-UNT-ID    TO SU087-SHIPT-UNT-ID.         13000000
           MOVE SUT00112-SHIPT-UNT-ID    TO PV-SHIPT-UNT-ID.            13010000
                                                                        13020000
           IF SUT00112-CART-MTCH-CDE = PC-CART-MTCH-CDE-FST             13030000
               SET SU087-CART-MTCH-FIRST-TRLR TO TRUE                   13040000
           END-IF.                                                      13050000
           IF SUT00112-CART-MTCH-CDE = PC-CART-MTCH-CDE-VND             13060000
               SET SU087-CART-MTCH-VNDR  TO TRUE                        13070000
           END-IF.                                                      13080000
           IF SUT00112-CART-MTCH-CDE = PC-CART-MTCH-CDE-PO              13090000
               SET SU087-CART-MTCH-PO    TO TRUE                        13100000
           END-IF.                                                      13110000
           IF SUT00112-CART-MTCH-CDE = PC-CART-MTCH-CDE-ALL             13120000
               SET SU087-CART-MTCH-ALL   TO TRUE                        13130000
           END-IF.                                                      13140000
312400                                                                  13150000
289000******************************************************************13160000
W20445* FORMAT OUTPUT DETAIL RECORD SU087-REPORT-FILE-DATA FROM         13170000
W20445* THE PACK SLIP, DEPT, VENDOR SELECT.                             13180000
289000******************************************************************13190000
288900 7860-FORMAT-PKSLIP-DETAIL.                                       13200000
                                                                        13210000
           MOVE PKSLIP-PO-NBR           TO SU087-PO-NBR.                13220000
           MOVE PKSLIP-REC-SEQ-NBR      TO SU087-RCVR-SEQ-NBR.          13230000
           MOVE PURCHS-DEPT-NBR         TO SU087-DEPT-NBR.              13240000
           MOVE ENTNME-ENT-NAME-DESC    TO SU087-VNDR-SHRT-NME.         13250000
312400                                                                  13260000
289000******************************************************************13270000
W20445* FORMAT OUTPUT DETAIL RECORD SU087-REPORT-FILE-DATA FROM         13280000
W20445* THE RECEIVING SELECT.                                           13290000
289000******************************************************************13300000
288900 7870-FORMAT-RECEIVING-DETAIL.                                    13310000
                                                                        13320000
055200     INITIALIZE PV-VERFYD-DATE                                    13330000
034310                PV-DETAIL-VERFY-DTE.                              13340000
                                                                        13350000
           IF RECEIV-STATUS-CDE = PC-STATUS-VERFYD-VE                   13360007
               MOVE RECEIV-VERFYD-TMST       TO PV-VERFYD-DATE          13370000
034400         MOVE PV-VERFY-CENTURY-DTE     TO PV-DETAIL-VERFY-CC      13380000
034500         MOVE PV-VERFY-YEAR-DTE        TO PV-DETAIL-VERFY-YY      13390000
034700         MOVE PV-VERFY-MONTH-DTE       TO PV-DETAIL-VERFY-MM      13400000
034900         MOVE PV-VERFY-DAY-DTE         TO PV-DETAIL-VERFY-DD      13410000
               MOVE PV-DETAIL-VERFY-DTE      TO SU087-VERFYD-DTE        13420000
           ELSE                                                         13430000
               SET  SU087-NOT-VERFYD         TO TRUE                    13440000
           END-IF.                                                      13450000
312400                                                                  13460000
      ***************************************************************** 13470000
W20445* FORMAT OUTPUT HEADER DAILY RECORD SU087-REPORT-FILE-DATA        13480000
W20445* COPUBOOK SURD087 FOR INPUT TO SUKRP058.                         13490000
289000******************************************************************13500000
288900 7880-FORMAT-DAILY-HEADER-LINE.                                   13510000
                                                                        13520000
055200     INITIALIZE SU087-REPORT-FILE-DATA.                           13530000
                                                                        13540000
           SET SU087-REPORT-HEADING    TO TRUE.                         13550000
                                                                        13560000
           SET SU087-DAILY             TO TRUE.                         13570000
           MOVE  PV-CNTRL-YEAR-BEG     TO PV-HEADER-FROM-YY.            13580000
           MOVE  PV-CNTRL-MONTH-BEG    TO PV-HEADER-FROM-MM.            13590000
           MOVE  PV-CNTRL-DAY-BEG      TO PV-HEADER-FROM-DD.            13600000
                                                                        13610000
           MOVE  PV-HEADER-FROM-DATE   TO SU087-FROM-MATCH-DATE.        13620000
                                                                        13630000
      ***************************************************************** 13640000
W20445* FORMAT OUTPUT HEADER WEEKLY OR MONTHLY SU087-REPORT-FILE-DATA   13650000
W20445* COPUBOOK SURD087 FOR INPUT TO SUKRP058.                         13660000
289000******************************************************************13670000
288900 7890-FORMAT-WKMNT-HEADER-LINE.                                   13680000
                                                                        13690000
055200     INITIALIZE SU087-REPORT-FILE-DATA.                           13700000
                                                                        13710000
           SET SU087-REPORT-HEADING    TO TRUE.                         13720000
                                                                        13730000
           IF SU032-RPT-TYPE = PC-WEEKLY                                13740000
               SET SU087-WEEKLY            TO TRUE                      13750000
           END-IF.                                                      13760000
                                                                        13770000
           IF SU032-RPT-TYPE = PC-MONTHLY                               13780000
               SET SU087-MONTHLY           TO TRUE                      13790000
           END-IF.                                                      13800000
                                                                        13810000
           MOVE  PV-CNTRL-YEAR-BEG     TO PV-HEADER-FROM-YY.            13820000
           MOVE  PV-CNTRL-MONTH-BEG    TO PV-HEADER-FROM-MM.            13830000
           MOVE  PV-CNTRL-DAY-BEG      TO PV-HEADER-FROM-DD.            13840000
                                                                        13850000
           MOVE  PV-HEADER-FROM-DATE   TO SU087-FROM-MATCH-DATE.        13860000
                                                                        13870000
           MOVE  PV-CNTRL-YEAR-END     TO PV-HEADER-TO-YY.              13880000
           MOVE  PV-CNTRL-MONTH-END    TO PV-HEADER-TO-MM.              13890000
           MOVE  PV-CNTRL-DAY-END      TO PV-HEADER-TO-DD.              13900000
                                                                        13910000
           MOVE  PV-HEADER-TO-DATE     TO SU087-TO-MATCH-DATE.          13920000
                                                                        13930000
      ***************************************************************** 13940000
W20445* WRITE OUTPUT RECORD SU087-REPORT-FILE-DATA (SURD087)            13950000
W20445* FOR INPUT TO SUKRP058.                                          13960000
289000******************************************************************13970000
288900 8000-WRITE-OUTPUT-RECORD.                                        13980000
                                                                        13990000
                                                                        14000000
00348      WRITE SURD087-EXTRACT-RECORD                                 14010000
00349          FROM SU087-REPORT-FILE-DATA.                             14020000
                                                                        14030000
           ADD +1                        TO PA-WRITTEN.                 14040000
      ***************************************************************** 14050000
W20445* OPEN CURSOR FOR PULLING MULTIPLE LINES ORD LINE NBR FROM THE    14060000
W20445* TRECITM TABLE FOR 'M' OR 'I' PACKING CODES.                     14070000
      ***************************************************************** 14080000
       8100-OPEN-ITEM-LEVELMI-CSR.                                      14090000
                                                                        14100000
           EXEC SQL                                                     14110000
               OPEN RECITMMI_CSR                                        14120000
           END-EXEC.                                                    14130000
                                                                        14140000
645260     EVALUATE TRUE                                                14150000
399500         WHEN SQLCODE = +0                                        14160000
                  CONTINUE                                              14170000
               WHEN OTHER                                               14180000
638908             DISPLAY '** ABEND **'                                14190000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   14200000
638910             DISPLAY '** PARAGRAPH = 8100-OPEN-ITEM-LEVELMI-CSR'  14210000
638911             PERFORM 9100-SQL-ABEND                               14220000
           END-EVALUATE.                                                14230000
      ***************************************************************** 14240000
W20445* PROCESS FETCHED ROWS FOR 'M' OR 'I' PACKING CODE                14250000
      ***************************************************************** 14260000
325400 8200-FETCH-ITEM-LEVELMI.                                         14270000
                                                                        14280000
           PERFORM 8300-FETCH-TRECITM-MI-CSR.                           14290000
                                                                        14300000
           IF PS-ROW-FOUND-ITEM-MI                                      14310000
                MOVE RECEIV-PKGNG-CDE     TO SU087-LINE-PCK-TYP         14320000
                MOVE RECITM-PREPK-ID      TO SU087-LINE-OR-PCK-ID       14330000
                PERFORM 8000-WRITE-OUTPUT-RECORD                        14340000
                IF PA-ALT-TRIP-COUNT > 1                                14350000
                    SET SA-INDX TO 1                                    14360000
                    PERFORM 7570-UNLOAD-ALT-TRIP-ROWS                   14370000
                    INITIALIZE  PA-ALT-TRIP-COUNT                       14380000
                END-IF                                                  14390000
           ELSE IF PA-RECITM-FOUND = 0                                  14400000
                MOVE RECEIV-PKGNG-CDE     TO SU087-LINE-PCK-TYP         14410000
                IF RECEIV-CRE-UID = 'F/A SYTM'                          14430000
                 MOVE PC-RECEIVR-FREE-ASTRAY TO SU087-LINE-OR-PCK-ID-X  14440000
                ELSE                                                    14450000
                 MOVE PC-RECEIVR-NOT-TRNSCRBD TO SU087-LINE-OR-PCK-ID-X 14460000
                END-IF                                                  14470000
                ADD +1 TO PA-RECITM-NOT-FOUND                           14480000
638909          DISPLAY '** PROGRAM = SUKUT131 **'                      14490000
638908          DISPLAY '** RECITM ROW NOT FOUND FOR RECEIV -MI*'       14500000
                DISPLAY 'SUT00112-SHIPT-UNT-ID' SUT00112-SHIPT-UNT-ID   14510000
                DISPLAY 'PKSLIP-PO-NBR'       PKSLIP-PO-NBR             14520000
                PERFORM 8000-WRITE-OUTPUT-RECORD                        14530000
           END-IF.                                                      14540000
                                                                        14550000
      ***************************************************************** 14560000
W20445* FETCH TRECITM ROW FROM MI CURSOR                                14570000
      ***************************************************************** 14580000
325400 8300-FETCH-TRECITM-MI-CSR.                                       14590000
                                                                        14600000
397500     INITIALIZE DCLTRECITM                                        14610000
397500                DCLTSHUUPC.                                       14620000
                                                                        14630000
397700     EXEC SQL                                                     14640000
397800         FETCH  RECITMMI_CSR                                      14650000
                INTO  :RECITM-PREPK-ID                                  14660000
398100     END-EXEC.                                                    14670000
398200                                                                  14680000
398300     EVALUATE TRUE                                                14690000
399500         WHEN SQLCODE = +0                                        14700000
                   SET PS-ROW-FOUND-ITEM-MI  TO TRUE                    14710000
                   ADD +1 TO PA-RECITM-FOUND                            14720000
398400         WHEN SQLCODE = +100                                      14730000
                   SET PS-ROW-FOUND-ITEM-MI-NO TO TRUE                  14740000
398600         WHEN SQLWARN0 NOT = SPACE                                14750000
398700         WHEN SQLCODE < ZERO                                      14760000
398800         WHEN SQLCODE > ZERO                                      14770000
638908             DISPLAY '** ABEND **'                                14780000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   14790000
638910             DISPLAY '** PARAGRAPH = 8300-FETCH-TRECITM-MI-CSR'   14800000
399400             PERFORM 9100-SQL-ABEND                               14810000
399700     END-EVALUATE.                                                14820000
                                                                        14830000
      ***************************************************************** 14840000
W20445* CLOSE TRECITM MI CURSORE                                        14850000
      ***************************************************************** 14860000
684300 8400-CLOSE-ITEM-LEVELMI-CSR.                                     14870000
                                                                        14880000
684400     EXEC SQL                                                     14890000
684500         CLOSE RECITMMI_CSR                                       14900000
684600     END-EXEC.                                                    14910000
684700                                                                  14920000
684800     EVALUATE TRUE                                                14930000
684900         WHEN SQLCODE = +0                                        14940000
685000             CONTINUE                                             14950000
685100         WHEN SQLWARN0 NOT = SPACE                                14960000
685200         WHEN SQLCODE < ZERO                                      14970000
685300         WHEN SQLCODE > ZERO                                      14980000
638908             DISPLAY '** ABEND **'                                14990000
638909             DISPLAY '** PROGRAM = SUKUT131 **'                   15000000
638910             DISPLAY '** PARAGRAPH = 8400-CLOSE-ITEM-LEVELMI-CSR' 15010000
685800             PERFORM 9100-SQL-ABEND                               15020000
685900     END-EVALUATE.                                                15030000
                                                                        15040000
432100******************************************************************15050000
432200* CLOSE THE INPUT AND OUTPUT FILES AND DISPLAY MISCELLANEOUS     *15060000
432300* JOB SUMMARY INFORMATION.                                       *15070000
432900******************************************************************15080000
433000 9000-EOJ-ROUTINE.                                                15090000
           CLOSE SURD032-CONTROL-FILE.                                  15100000
001700     CLOSE SURD087-EXTRACT-FILE.                                  15110000
435700                                                                  15120000
435800     DISPLAY '**********************************'.                15130000
435900     DISPLAY '** SUKUT131 SUMMARY **'.                            15140000
436000     DISPLAY 'CONTROL RECORD READ     = ' PA-CNTRL-RECS-READ.     15150000
435800     DISPLAY '**********************************'.                15160000
436100     DISPLAY 'RECORDS WRITTEN TO FILE = ' PA-WRITTEN.             15170000
436100     DISPLAY 'RECORDS FETCHED FROM DRIVING CURSOR  = ' PA-FETCH.  15180000
           DISPLAY 'RECITM NOT FOUND        = ' PA-RECITM-NOT-FOUND.    15190000
437100     DISPLAY '**********************************'.                15200000
437200                                                                  15210000
437300 EJECT                                                            15220000
437400                                                                  15230000
437500******************************************************************15240000
437600* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *15250000
437700* ERROR OR WARNING CODE OCCURS.                                  *15260000
437800******************************************************************15270000
438000******************************************************************15280000
438100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *15290000
438200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *15300000
438300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *15310000
438400* FORMAT.                                                        *15320000
438500******************************************************************15330000
437900 9100-SQL-ABEND.                                                  15340000
438600                                                                  15350000
438700     COPY DPPD004.                                                15360000
438800                                                                  15370000
439600     MOVE +4013 TO ABEND-CODE.                                    15380000
439700     CALL 'ILBOABN0' USING ABEND-CODE.                            15390000
118410******************************************************************15400000
118500* 9999-ABEND                                                      15410000
118600*     ABEND PROGRAM WHEN AN ERROR OCCURS.                         15420000
118700******************************************************************15430000
118800 9999-ABEND.                                                      15440000
118900                                                                  15450000
119000     DISPLAY '** ABEND           **'.                             15460000
119100     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  15470000
119200     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        15480000
119500     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         15490000
