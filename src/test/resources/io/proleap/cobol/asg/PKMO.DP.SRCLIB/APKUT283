000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.     APKUT283.                                        00020001
000300 AUTHOR.         NANCY EILBES.                                    00030001
000400 DATE-WRITTEN.   MAY 2022.                                        00040003
000500 DATE-COMPILED.                                                   00050001
000600******************************************************************00060001
000700*    COBOL 2                                                     *00070001
000800*     REFORMATS STORE EXTRACT FILE TO TEXT FORMAT                *00080001
000900*                                                                *00090001
001000* INPUT:                                                         *00100001
001100*  1. STORE EXTRACT FILE           COPYBOOK STOREEXT             *00110001
001200*                                                                *00120001
001300* OUTPUT:                                                        *00130001
001400*  1. AMOUNT TEXT FILE                                           *00140001
001500*                                                                *00150001
001600*----------------------------------------------------------------*00160001
001610* CHANGE LOG:                                                    *00161001
001611* DATE  05/09/2022                                               *00161102
001612*     CHANGE MADE: INITIAL IMPLEMENTATION.                       *00161201
001620*     MADE BY: NANCY EILBES            WR/IR #: CHG0269842       *00162002
001621******************************************************************00162101
001700   EJECT                                                          00170001
001800 ENVIRONMENT DIVISION.                                            00180001
001900 CONFIGURATION SECTION.                                           00190001
002000 SOURCE-COMPUTER.    IBM-3090.                                    00200001
002100 OBJECT-COMPUTER.    IBM-3090.                                    00210001
002200                                                                  00220001
002300 INPUT-OUTPUT SECTION.                                            00230001
002400 FILE-CONTROL.                                                    00240001
002500     SELECT IN-FILE       ASSIGN TO UT-S-INP01.                   00250001
002600     SELECT OUT-FILE      ASSIGN TO UT-S-OUT01.                   00260001
002700                                                                  00270001
002800 DATA DIVISION.                                                   00280001
002900 FILE SECTION.                                                    00290001
003000                                                                  00300001
003100 FD  IN-FILE                                                      00310001
003200     RECORDING MODE IS F                                          00320001
003300     LABEL RECORDS ARE STANDARD                                   00330001
003400     BLOCK CONTAINS 0 RECORDS                                     00340001
003500     DATA RECORD IS VERFYD-IN-REC.                                00350001
003600 01  IN-REC.                                                      00360001
003700     05  FILLER                       PIC  X(300).                00370001
003800                                                                  00380001
003900 FD  OUT-FILE                                                     00390001
004000     RECORDING MODE IS F                                          00400001
004100     LABEL RECORDS ARE STANDARD                                   00410001
004200     BLOCK CONTAINS 0 RECORDS                                     00420001
004300     DATA RECORD IS VERFYD-OUT-REC.                               00430001
004400 01  OUT-REC.                                                     00440001
004500     05  FILLER                       PIC  X(80).                 00450001
004600                                                                  00460001
004700 EJECT                                                            00470001
004800 WORKING-STORAGE SECTION.                                         00480001
004900                                                                  00490001
005000 01  EOF-SW                           PIC X     VALUE 'N'.        00500001
005100     88  IN-EOF                                 VALUE 'Y'.        00510001
005200 01  TEXT-RECORD.                                                 00520001
005300     05  OUT-PO-NUMBER                PIC 9(8).                   00530001
005302     05  FILLER                       PIC X(1)  VALUE SPACES.     00530201
005303     05  OUT-RCV-QTY                  PIC ZZZZZ9.                 00530301
005304     05  FILLER                       PIC X(1)  VALUE SPACES.     00530401
005305     05  OUT-TOTAL-COST               PIC ---------.99.           00530501
005306     05  FILLER                       PIC X(1)  VALUE SPACES.     00530601
005307     05  OUT-FIRST-COST               PIC ---------.99.           00530701
005308     05  FILLER                       PIC X(1) VALUE SPACES.      00530801
005320     05  OUT-PO-TYP-CDE               PIC X(2).                   00532001
005330     05  FILLER                       PIC X(30) VALUE SPACES.     00533001
005340                                                                  00534001
005350     COPY STOREEXT.                                               00535001
005360                                                                  00536001
005370 EJECT                                                            00537001
005380 PROCEDURE DIVISION.                                              00538001
005390 A100-MAIN.                                                       00539001
005400                                                                  00540001
005500     PERFORM B100-INITIALIZE.                                     00550001
005600                                                                  00560001
005700     PERFORM B200-PROCESS                                         00570001
005800         UNTIL IN-EOF.                                            00580001
005900                                                                  00590001
006000     GOBACK.                                                      00600001
006100 EJECT                                                            00610001
006200*----------------------------------------------------------------*00620001
006300*    INITIALIZATION PROCESSING                                   *00630001
006400*    CALLED FROM A100-MAIN                                       *00640001
006500*----------------------------------------------------------------*00650001
006600 B100-INITIALIZE.                                                 00660001
006700                                                                  00670001
006800     OPEN INPUT  IN-FILE                                          00680001
006900          OUTPUT OUT-FILE.                                        00690001
007000                                                                  00700001
007100     PERFORM R100-READ-INPUT.                                     00710001
007200                                                                  00720001
007300 B200-PROCESS.                                                    00730001
007400                                                                  00740001
007500     MOVE SE-PO                 TO  OUT-PO-NUMBER.                00750001
007600     MOVE SE-RETAIL-UNITS-MARK  TO  OUT-RCV-QTY.                  00760001
007700     MOVE SE-COST-EXTENSION     TO  OUT-TOTAL-COST.               00770001
007800     MOVE SE-1ST-COST-EXTENSION TO  OUT-FIRST-COST.               00780001
008000     MOVE SE-PO-TYP-CDE         TO  OUT-PO-TYP-CDE.               00800001
008100     PERFORM W100-WRITE-OUTPUT.                                   00810001
008200                                                                  00820001
008300     PERFORM R100-READ-INPUT.                                     00830001
008400                                                                  00840001
008500 R100-READ-INPUT.                                                 00850001
008600                                                                  00860001
008700                                                                  00870001
008800     READ IN-FILE INTO STORE-EXTRACT-LINE                         00880001
008900         AT END SET IN-EOF TO TRUE.                               00890001
009000                                                                  00900001
009100                                                                  00910001
009200 W100-WRITE-OUTPUT.                                               00920001
009300                                                                  00930001
009400     WRITE OUT-REC FROM TEXT-RECORD.                              00940001
009500                                                                  00950001
