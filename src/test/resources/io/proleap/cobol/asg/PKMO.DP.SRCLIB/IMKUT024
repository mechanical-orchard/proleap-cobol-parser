000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.    IMKUT024.                                         00040000
000500 AUTHOR.        COGNIZANT.                                        00050099
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   JUNE, 2014.                                       00070099
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090099
001000* IMKUT024 - COMPRESS THE IM STYLE DELCAN FILE                    00100099
001100*                                                                 00110000
001200* THIS PROGRAM CONVERTS THE NUMERIC FORMAT RECORDS TO BINARY AND  00120099
001300* PACKED DECIMAL FORMAT                                           00130099
001400*                                                                 00140000
001600******************************************************************00160099
001700* CHANGE DESCRIPTION                                              00170000
001800******************************************************************00180099
001900* DATE  06/20/2014                                                00190099
002000*  CHANGE MADE: INITIAL VERSION.                                  00200000
002100* MADE BY: VENKATSUBBU T (COGNIZANT)    TKID: TKMAGJ8             00210099
002100* CR NO : CHG0090773                                              00211099
002200***************************************************************** 00220000
002300 ENVIRONMENT DIVISION.                                            00230000
002310 CONFIGURATION SECTION.                                           00231000
002320 SOURCE-COMPUTER.        IBM-3090.                                00232000
002330 OBJECT-COMPUTER.        IBM-3090.                                00233000
002400 INPUT-OUTPUT SECTION.                                            00240000
002500*                                                                 00250000
002600 FILE-CONTROL.                                                    00260000
002700*                                                                 00270000
002800     SELECT INPUT-DECOMP-FILE                                     00280000
002900         ASSIGN TO INP01.                                         00290000
003000*                                                                 00300000
003400     SELECT OUTPUT-STYLE-FILE                                     00340000
003500         ASSIGN TO OUT01.                                         00350000
003600*                                                                 00360000
003700***************************************************************** 00370000
003800 DATA DIVISION.                                                   00380000
003900***************************************************************** 00390000
004000 FILE SECTION.                                                    00400000
004100*                                                                 00410000
004200 FD  INPUT-DECOMP-FILE                                            00420000
004300     RECORDING MODE IS F                                          00430000
004400     BLOCK CONTAINS 0 RECORDS                                     00440000
004500     LABEL RECORDS ARE STANDARD.                                  00450000
004600*                                                                 00460000
004700 01  IM-DECOMP-REC                  PIC X(139).                   00470099
004800*                                                                 00480000
005600 FD  OUTPUT-STYLE-FILE                                            00560000
005700     RECORDING MODE IS F                                          00570000
005800     BLOCK CONTAINS 0 RECORDS                                     00580000
005900     LABEL RECORDS ARE STANDARD.                                  00590000
006000*                                                                 00600000
006100 01  STYLE-OUT-REC                   PIC X(100).                  00610000
006200*                                                                 00620000
006300***************************************************************** 00630000
006400 WORKING-STORAGE SECTION.                                         00640000
006500*                                                                 00650000
006600 01  PS-PROGRAM-SWITCHES.                                         00660000
007000     05  PS-EOF-DECOMP-SW             PIC X(01)  VALUE 'N'.       00700000
007100         88  PS-EOF-DECOMP-YES                   VALUE 'Y'.       00710000
007200         88  PS-EOF-DECOMP-NO                    VALUE 'N'.       00720000
007900*                                                                 00790000
008000 01  PC-PROGRAM-CONSTANTS.                                        00800000
008100     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'IMKUT024'.00810000
008400*                                                                 00840000
008500 01  PV-PROGRAM-VARIABLES.                                        00850000
008400     05  PV-INTR-UPC-ID               PIC  S9(10) COMP            00851099
008400                                                 VALUE  0.        00852099
008600     05  PV-RECS-READ-DECOMP          PIC  9(09) VALUE  0.        00860000
008800     05  PV-RECS-WRITE-STYLE          PIC  9(09) VALUE  0.        00880000
009800*                                                                 00980000
009900 01  PV-ABEND-FIELDS.                                             00990000
010000     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'IMKUT024'.01000000
010100     05  FILLER                       PIC  X(01) VALUE SPACES.    01010000
010200     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01020000
010300     05  FILLER                       PIC  X(01) VALUE SPACES.    01030000
010400     05  PV-ABEND-MESSAGE             PIC  X(50) VALUE SPACES.    01040000
010500     05  FILLER                       PIC  X(01) VALUE SPACES.    01050000
010600     05  PV-OPERATION-ATTEMPTED       PIC  X(50) VALUE SPACE.     01060000
010700     05  FILLER                       PIC  X(01) VALUE SPACES.    01070000
010800     05  PV-ABEND-CODE                PIC  S9(04) VALUE +0  COMP. 01080000
010900*                                                                 01090000
013410***************************************************************** 01341000
013420*  RECORD LAYOUT FOR STYLE OUTPUT FILE                          * 01342000
013430***************************************************************** 01343000
013560 01  WS020-STYLE-DELETE-REC.                                      01356199
013560     05  WS020-SUB-CL-MDSEAR-ID  PIC S9(06)    COMP-3             01356299
013560                                               VALUE ZERO.        01356399
013560     05  WS020-VS-ID             PIC S9(09)    COMP               01356499
013560                                               VALUE ZERO.        01356599
013560     05  WS020-INTR-UPC-ID       PIC S9(09)    COMP               01356699
013560                                               VALUE ZERO.        01356799
013560     05  WS020-ITM-NBR           PIC S9(15)    COMP-3.            01356899
013560     05  WS020-SKU               PIC S9(08)V   COMP-3             01356999
013560                                               VALUE ZERO.        01357099
013560     05  WS020-SKU-STAT          PIC X(02).                       01357199
013560     05  WS020-SKU-CNTR          PIC 9(08)     COMP               01357299
013560                                               VALUE ZERO.        01357399
013560     05  WS020-FILLER            PIC X(02)     VALUE SPACES.      01357499
013560     05  WS020-TWEBITM-IND       PIC X(01).                       01357599
013560     05  WS020-RMS-STYL-ID       PIC S9(08)    COMP-3             01357699
013560                                               VALUE ZERO.        01357799
013560     05  WS020-ENT-ID            PIC S9(9)     COMP               01357899
013560                                               VALUE ZERO.        01357999
013560     05  WS020-LAST-SALES-DTE    PIC X(08)     VALUE SPACES.      01358099
013560     05  WS020-LAST-RECEIPT-DTE  PIC X(08)     VALUE SPACES.      01358199
013560     05  WS020-VS-NBR            PIC X(20).                       01358299
013560     05  FILLER                  PIC X(21)     VALUE SPACES.      01358399
013560*                                                                 01358599
013570***************************************************************** 01358699
013580*  RECORD LAYOUT FOR DE-COMP INPUT FILE                         * 01358799
013590***************************************************************** 01359000
013591 01  WS-STYLE-DELETE-REC.                                         01359100
013593     05  WS-SUB-CL-MDSEAR-ID          PIC 9(06)  VALUE ZEROES.    01359300
013594     05  WS-VS-ID                     PIC 9(10)  VALUE ZEROES.    01359400
013595     05  WS-INTR-UPC-ID               PIC 9(10)  VALUE ZEROES.    01359500
013595     05  WS-ITM-NBR                   PIC 9(15)  VALUE ZEROES.    01359600
013595     05  WS-SKU                       PIC 9(08)  VALUE ZEROES.    01359700
013595     05  WS-SKU-STAT                  PIC X(02)  VALUE SPACES.    01359800
013595     05  WS-SKU-CNTR                  PIC 9(10)  VALUE ZEROES.    01359900
013595     05  WS-FILLER                    PIC X(02)  VALUE SPACES.    01360099
013595     05  WS-TWEBITM-IND               PIC X(01)  VALUE SPACES.    01360100
013595     05  WS-RMS-STYL-ID               PIC 9(08)  VALUE ZEROES.    01360200
013595     05  WS-ENT-ID                    PIC 9(10)  VALUE ZEROES.    01360300
013595     05  WS-LAST-SALES-DTE            PIC X(08)  VALUE SPACES.    01360400
013595     05  WS-LAST-RECEIPT-DTE          PIC X(08)  VALUE SPACES.    01360500
013595     05  WS-VS-NBR                    PIC X(20)  VALUE SPACES.    01360600
013597     05  FILLER                       PIC X(21)  VALUE SPACES.    01361000
013600*                                                                 01370000
013591 01  WS-STYLE-DELETE-REC-X.                                       01380000
013593     05  WS-SUB-CL-MDSEAR-ID-X        PIC X(06)  VALUE ZEROES.    01390000
013594     05  WS-VS-ID-X                   PIC X(10)  VALUE ZEROES.    01400000
013595     05  WS-INTR-UPC-ID-X             PIC X(10)  VALUE ZEROES.    01410000
013595     05  WS-ITM-NBR-X                 PIC X(15)  VALUE ZEROES.    01420000
013595     05  WS-SKU-X                     PIC X(08)  VALUE ZEROES.    01430000
013595     05  WS-SKU-STAT-X                PIC X(02)  VALUE SPACES.    01440000
013595     05  WS-SKU-CNTR-X                PIC X(10)  VALUE ZEROES.    01450000
013595     05  WS-FILLER-X                  PIC X(02)  VALUE SPACES.    01460099
013595     05  WS-TWEBITM-IND-X             PIC X(01)  VALUE SPACES.    01470000
013595     05  WS-RMS-STYL-ID-X             PIC X(08)  VALUE ZEROES.    01480000
013595     05  WS-ENT-ID-X                  PIC X(10)  VALUE ZEROES.    01490000
013595     05  WS-LAST-SALES-DTE-X          PIC X(08)  VALUE SPACES.    01500000
013595     05  WS-LAST-RECEIPT-DTE-X        PIC X(08)  VALUE SPACES.    01510000
013595     05  WS-VS-NBR-X                  PIC X(20)  VALUE SPACES.    01520000
013597     05  FILLER                       PIC X(21)  VALUE SPACES.    01530000
013600*                                                                 01540000
017100***************************************************************** 01710000
017200 PROCEDURE DIVISION.                                              01720000
017300***************************************************************** 01730000
017400     DISPLAY '**** BEGINNING IMKUT024 ****'.                      01740000
017500     DISPLAY ' '.                                                 01750000
017600*                                                                 01760000
017700 0000-MAIN-PARA.                                                  01770000
017800     PERFORM 1000-INITIALIZATION.                                 01780000
017900     PERFORM 2000-MAIN-PROCESS.                                   01790000
018000     PERFORM 9000-EOJ.                                            01800000
018100*                                                                 01810000
018200        STOP RUN.                                                 01820000
018300*                                                                 01830000
018400***************************************************************** 01840000
018500*  INITIALIZE PARA                                                01850000
018600***************************************************************** 01860000
018700 1000-INITIALIZATION.                                             01870000
018800*                                                                 01880000
018900     MOVE '1000-INITIALIZATION ' TO PV-ABEND-PARAGRAPH.           01890000
019000*                                                                 01900000
019300     OPEN INPUT  INPUT-DECOMP-FILE                                01930000
019500          OUTPUT OUTPUT-STYLE-FILE.                               01950000
019600*                                                                 01960000
019700     INITIALIZE PV-PROGRAM-VARIABLES.                             01970000
020000     INITIALIZE WS020-STYLE-DELETE-REC.                           02000099
020000     INITIALIZE WS-STYLE-DELETE-REC-X.                            02001099
020100*                                                                 02010000
020200***************************************************************** 02020000
020300*  MAIN PROCESS PARA                                              02030000
020400***************************************************************** 02040000
020500 2000-MAIN-PROCESS.                                               02050000
020600*                                                                 02060000
020700     MOVE '2000-MAIN-PROCESS ' TO PV-ABEND-PARAGRAPH.             02070000
020800*                                                                 02080000
020900      PERFORM 2100-READ-DECOMP-FILE                               02090000
021000        UNTIL PS-EOF-DECOMP-YES.                                  02100000
021010*                                                                 02101000
022100*                                                                 02210000
027600***************************************************************** 02760000
027700*  READ DECOMP INPUT FILE                                         02770099
027800***************************************************************** 02780000
027900 2100-READ-DECOMP-FILE.                                           02790000
028000*                                                                 02800000
028100     MOVE '2100-READ-DECOMP-FILE ' TO PV-ABEND-PARAGRAPH.         02810000
028200*                                                                 02820000
028300       READ INPUT-DECOMP-FILE                                     02830000
028400          INTO WS-STYLE-DELETE-REC-X                              02840000
028500       AT END                                                     02850000
028600          SET PS-EOF-DECOMP-YES      TO TRUE                      02860000
028700       END-READ.                                                  02870000
028800*                                                                 02880000
028900       IF PS-EOF-DECOMP-NO                                        02890000
029000            ADD 1                   TO PV-RECS-READ-DECOMP        02900000
029100            PERFORM 2200-WRITE-STYLE-FILE                         02901000
029100       END-IF.                                                    02910000
029100                                                                  02911000
029200*                                                                 02920000
029307***************************************************************** 02930700
029308* WRITE STYLE OUTPUT FILE                                         02930899
029309***************************************************************** 02930900
029310 2200-WRITE-STYLE-FILE.                                           02931000
029311*                                                                 02931100
029312     MOVE '2200-WRITE-STYLE-FILE'   TO PV-ABEND-PARAGRAPH.        02931200
029313*                                                                 02931300
029314     MOVE WS-SUB-CL-MDSEAR-ID-X  TO WS-SUB-CL-MDSEAR-ID           02931400
029314     MOVE WS-VS-ID-X             TO WS-VS-ID                      02931500
029314     MOVE WS-INTR-UPC-ID-X       TO WS-INTR-UPC-ID                02931600
029314     MOVE WS-ITM-NBR-X           TO WS-ITM-NBR                    02931700
029314     MOVE WS-SKU-X               TO WS-SKU                        02931800
029314     MOVE WS-SKU-STAT-X          TO WS-SKU-STAT                   02931900
029314     MOVE WS-SKU-CNTR-X          TO WS-SKU-CNTR                   02932000
029314     MOVE WS-FILLER-X            TO WS-FILLER                     02932199
029314     MOVE WS-TWEBITM-IND-X       TO WS-TWEBITM-IND                02932200
029314     MOVE WS-RMS-STYL-ID-X       TO WS-RMS-STYL-ID                02932300
029314     MOVE WS-ENT-ID-X            TO WS-ENT-ID                     02932400
029314     MOVE WS-LAST-SALES-DTE-X    TO WS-LAST-SALES-DTE             02932500
029314     MOVE WS-LAST-RECEIPT-DTE-X  TO WS-LAST-RECEIPT-DTE           02932600
029314     MOVE WS-VS-NBR-X            TO WS-VS-NBR                     02932700
029323*                                                                 02932800
029323     MOVE WS-SUB-CL-MDSEAR-ID TO WS020-SUB-CL-MDSEAR-ID           02932999
029323     MOVE WS-VS-ID            TO WS020-VS-ID                      02933099
029323     MOVE WS-INTR-UPC-ID      TO PV-INTR-UPC-ID                   02933199
029323     MOVE PV-INTR-UPC-ID      TO WS020-INTR-UPC-ID                02933299
029323     MOVE WS-ITM-NBR          TO WS020-ITM-NBR                    02933499
029323     MOVE WS-SKU              TO WS020-SKU                        02933599
029323     MOVE WS-SKU-STAT         TO WS020-SKU-STAT                   02933699
029323     MOVE WS-SKU-CNTR         TO WS020-SKU-CNTR                   02933799
029314     MOVE WS-FILLER           TO WS020-FILLER                     02933899
029323     MOVE WS-TWEBITM-IND      TO WS020-TWEBITM-IND                02933999
029323     MOVE WS-RMS-STYL-ID      TO WS020-RMS-STYL-ID                02934099
029323     MOVE WS-ENT-ID           TO WS020-ENT-ID                     02934199
029323     MOVE WS-LAST-SALES-DTE   TO WS020-LAST-SALES-DTE             02934299
029323     MOVE WS-LAST-RECEIPT-DTE TO WS020-LAST-RECEIPT-DTE           02934399
029323     MOVE WS-VS-NBR           TO WS020-VS-NBR                     02934499
029323*                                                                 02935199
029323     WRITE STYLE-OUT-REC FROM WS020-STYLE-DELETE-REC              02935299
029323     ADD 1                       TO PV-RECS-WRITE-STYLE.          02935399
029323*                                                                 02936099
039700***************************************************************** 03970000
039800*  END OF JOB OPERATIONS                                        * 03980000
039900***************************************************************** 03990000
040000 9000-EOJ.                                                        04000000
040100*                                                                 04010000
040200     MOVE '9000-EOJ ' TO PV-ABEND-PARAGRAPH.                      04020000
040300*                                                                 04030000
040400     CLOSE INPUT-DECOMP-FILE                                      04040000
040600           OUTPUT-STYLE-FILE.                                     04060000
040700*                                                                 04070000
041114*                                                                 04111400
041200      DISPLAY 'DECOMP REC READ COUNT  : ' PV-RECS-READ-DECOMP.    04120000
041300      DISPLAY 'STYLE REC WRITE COUNT  : ' PV-RECS-WRITE-STYLE.    04130000
041700*                                                                 04170000
044400******************************************************************04440000
044500*  THIS ROUTINE FORCES AN ABEND                                   04450000
044600******************************************************************04460000
044700 9999-ABEND.                                                      04470000
044800                                                                  04480000
044900     MOVE +4013 TO PV-ABEND-CODE.                                 04490000
044910     DISPLAY 'PARA : ' PV-ABEND-PARAGRAPH.                        04491000
044920     DISPLAY 'CODE : ' PV-ABEND-CODE.                             04492000
044930     DISPLAY 'ERROR: ' PV-ABEND-MESSAGE.                          04493000
045000     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         04500000
