      ***************************************************************** 00010000
       IDENTIFICATION DIVISION.                                         00020000
      ***************************************************************** 00030000
                                                                        00040000
       PROGRAM-ID.             TCKRP005.                                00050000
       AUTHOR.                 J MYERS.                                 00060000
       INSTALLATION.           KOHLS.                                   00070000
       DATE-WRITTEN            04/2002.                                 00080000
       DATE-COMPILED.                                                   00090000
                                                                        00100000
      ***************************************************************** 00110000
      *  PURPOSE:                                                       00120000
      *  CREATE DAILY DEBIT TOTAL APPROVE ADJUSTMENT REPORT             00130000
      ***************************************************************** 00150000
003510*----------------------------------------------------------------*00151011
003520*                                                                *00152011
003530*  CHANGES: JIM MYERS - SAFENET CONSULTING  5-13-2002            *00153011
003540*       ADD THE LAST RECORD INTO TOTALS FOR FINAL TOTALS LINE ON *00154011
003550*       REPORT.   PITS#  468203                                  *00155011
003560*                                                                *00156011
       ENVIRONMENT DIVISION.                                            00160000
      ***************************************************************** 00170000
                                                                        00180000
       CONFIGURATION SECTION.                                           00190000
                                                                        00200000
       SOURCE-COMPUTER.        IBM-3090.                                00210000
                                                                        00220000
       OBJECT-COMPUTER.        IBM-3090.                                00230000
                                                                        00240000
       INPUT-OUTPUT SECTION.                                            00250000
                                                                        00260000
       FILE-CONTROL.                                                    00270000
                                                                        00280000
           SELECT CONTROL-DATE-FILE                                     00290000
               ASSIGN TO INP01.                                         00300000
                                                                        00310000
           SELECT ADJ-INPUT-FILE                                        00320000
               ASSIGN TO INP02.                                         00320100
                                                                        00320200
           SELECT ADJUSTMENT-REPORT                                     00320300
               ASSIGN TO RPT01.                                         00320400
                                                                        00320500
      ******************************************************************00320900
       DATA DIVISION.                                                   00321000
      ******************************************************************00322000
                                                                        00323000
       FILE SECTION.                                                    00324000
                                                                        00325000
       FD  CONTROL-DATE-FILE                                            00326000
           RECORDING MODE IS F                                          00327000
           BLOCK CONTAINS 0 RECORDS                                     00328000
           LABEL RECORDS ARE OMITTED.                                   00329000
                                                                        00330000
       01  CONTROL-DATE-RECORD         PIC X(80).                       00340000
                                                                        00350000
       FD  ADJ-INPUT-FILE                                               00360000
           RECORDING MODE IS F                                          00370000
           BLOCK CONTAINS 0 RECORDS.                                    00380000
                                                                        00390000
       01  ADJ-INPUT-RECORD            PIC X(258).                      00400000
                                                                        00410000
                                                                        00420000
       FD  ADJUSTMENT-REPORT                                            00430000
           RECORDING MODE IS F                                          00440000
           BLOCK CONTAINS 0 RECORDS.                                    00450000
                                                                        00460000
       01  ADJUSTMENT-REPT-RECORD        PIC X(132).                    00470000
                                                                        00480000
      ******************************************************************00550000
       WORKING-STORAGE SECTION.                                         00560000
      ******************************************************************00570000
       01  FILLER                            PIC X(50)  VALUE           00580000
           ' *** WORKING STORAGE STARTS HERE FOR TCKRP005 *** '.        00590000
                                                                        00600000
      ******************************************************************00610000
      * RECORD LAYOUT FOR INPUT DATE CARD (POS DATE)                   *00620000
      ******************************************************************00630000
       01  CC-CONTROL-CARD.                                             00640000
           05  CC-CONTROL-CARD-DISPLAY.                                 00650000
               10  CC-CONTROL-NAME     PIC X(14)    VALUE SPACE.        00660000
                   88  CC-VALID-CONTROL-NAME        VALUE               00670000
                      'P.O.S. DATE = '.                                 00680000
               10  CC-POS-DATE-MMDDYY  PIC 9(6)     VALUE ZERO.         00690000
          05  FILLER                  PIC X(60)    VALUE SPACE.         00700000
                                                                        00710000
      ******************************************************************00720000
      *  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)            *00730000
      ******************************************************************00740000
           COPY DPWS500.                                                00750000
                                                                        00760000
       01  AC-ABEND-CODE                      PIC S9(04) VALUE ZERO     00770000
                                                        COMP SYNC.      00780000
           88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    00790000
           88  AC-DB2-ERROR                             VALUE +4013.    00800000
           88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    00810000
                                                                        00820000
        01  PS-PROGRAM-SWITCHES.                                        00830000
           05  PS-END-OF-CONTROL-FILE-SW     PIC X(01)  VALUE 'N'.      00840000
               88  PS-END-OF-CONTROL-FILE               VALUE 'Y'.      00850000
           05  PS-END-OF-ADJ-SW              PIC X(01)  VALUE 'N'.      00860000
               88  PS-NOT-END-OF-ADJ-FILE               VALUE 'N'.      00870000
               88  PS-END-OF-ADJ-FILE                   VALUE 'Y'.      00880000
           05  PS-INPUT-TODAY-SW             PIC X(01)  VALUE 'N'.      00881008
               88  NO-INPUT-TODAY                       VALUE 'N'.      00882008
               88  INPUT-TODAY                          VALUE 'Y'.      00883008
      ******************************************************************00890000
      *   PROGRAM CONSTANTS                                            *00900000
      ******************************************************************00910000
       01  PC-CONSTANTS.                                                00920000
           05  PC-LINE-LIMIT                 PIC S9(04) VALUE +60.      00930000
           05  PC-PROGRAM-NAME               PIC  X(08) VALUE           00940000
                                                       'TCKRP005'.      00950000
           05  PC-REPORT-NBR-1             PIC 9(01)     VALUE 1.       00960000
                                                                        00980000
       01  PV-PROGRAM-VARIABLES.                                        01020000
           05  PV-MISC-COUNT-FIELDS                         COMP-3.     01030000
                10  PV-R1-LINE-CNT           PIC S9(05) VALUE ZERO.     01040000
                10  PV-R1-PAGE-CNT           PIC S9(05) VALUE ZERO.     01060000
           05  PV-SV-TRAN-DATE               PIC  X(06) VALUE SPACE.    01080001
           05  PV-PARAGRAPH-NAME             PIC  X(30) VALUE SPACE.    01090000
           05  PV-OPERATION-MSG-1            PIC  X(40) VALUE SPACE.    01100000
           05  PV-OPERATION-MSG-2            PIC  X(40) VALUE SPACE.    01110000
           05  PV-DB2-OPERATION              PIC  X(30) VALUE SPACE.    01120000
           05  PV-POS-CCYY-MM-DD             PIC  X(10).                01130000
           05  PV-L110-ORIG-TOT              PIC  S9(09)V99 VALUE ZERO. 01171001
           05  PV-L110-ADJ-TOT               PIC  S9(09)V99 VALUE ZERO. 01171101
           05  PV-L111-ORIG-TOT              PIC  S9(09)V99 VALUE ZERO. 01171201
           05  PV-L111-ADJ-TOT               PIC  S9(09)V99 VALUE ZERO. 01171301
           05  PV-L112-ORIG-TOT              PIC  S9(09)V99 VALUE ZERO. 01171401
           05  PV-L112-ADJ-TOT               PIC  S9(09)V99 VALUE ZERO. 01171501
           05  PV-LCOM-ORIG-TOT              PIC  S9(09)V99 VALUE ZERO. 01171601
           05  PV-LCOM-ADJ-TOT               PIC  S9(09)V99 VALUE ZERO. 01171701
           05  PV-R110-ORIG-TOT              PIC  S9(09)V99 VALUE ZERO. 01171801
           05  PV-R110-ADJ-TOT               PIC  S9(09)V99 VALUE ZERO. 01171901
           05  PV-R111-ORIG-TOT              PIC  S9(09)V99 VALUE ZERO. 01172001
           05  PV-R111-ADJ-TOT               PIC  S9(09)V99 VALUE ZERO. 01172101
           05  PV-R112-ORIG-TOT              PIC  S9(09)V99 VALUE ZERO. 01172201
           05  PV-R112-ADJ-TOT               PIC  S9(09)V99 VALUE ZERO. 01172301
           05  PV-RCOM-ORIG-TOT              PIC  S9(09)V99 VALUE ZERO. 01172401
           05  PV-RCOM-ADJ-TOT               PIC  S9(09)V99 VALUE ZERO. 01172501
                                                                        01180000
      ******************************************************************01190000
      *   DATE AND TIME FIELDS.                                        *01200000
      ******************************************************************01210000
       01  PV-DATE-AND-TIME-FIELDS.                                     01220000
           05  PV-MMDDYY-DATE.                                          01230000
               10  PV-MMDDYY-MM            PIC X(02).                   01240000
               10  PV-MMDDYY-DD            PIC X(02).                   01250000
               10  PV-MMDDYY-YY            PIC X(02).                   01260000
           05  PV-YYMMDD-DATE.                                          01270000
               10  PV-YYMMDD-YY            PIC X(02).                   01280000
               10  PV-YYMMDD-MM            PIC X(02).                   01290000
               10  PV-YYMMDD-DD            PIC X(02).                   01300000
           05  PV-CURR-DATE-CCYYMMDD.                                   01310000
               10  PV-CURR-DATE-CCYY       PIC  9(04).                  01311000
               10  PV-CURR-DATE-MM         PIC  9(02).                  01311100
               10  PV-CURR-DATE-DD         PIC  9(02).                  01311200
           05  PV-CURR-TIME.                                            01311300
               10  PV-CURR-TIME-HH         PIC  9(02)    VALUE ZERO.    01311400
               10  PV-CURR-TIME-MM         PIC  9(02)    VALUE ZERO.    01311500
               10  PV-CURR-TIME-SS         PIC  9(02)    VALUE ZERO.    01311600
           05  PV-FMT-DATE.                                             01311700
               10  PV-FMT-MM               PIC  9(02)    VALUE ZERO.    01311800
               10  PV-SLASH-1              PIC  X(01)    VALUE '/'.     01311900
               10  PV-FMT-DD               PIC  9(02)    VALUE ZERO.    01312000
               10  PV-SLASH-2              PIC  X(01)    VALUE '/'.     01313000
               10  PV-FMT-CC               PIC  9(02)    VALUE ZERO.    01314000
               10  PV-FMT-YY               PIC  9(02)    VALUE ZERO.    01315000
                                                                        01316000
      ******************************************************************01316700
      *  TOP OF PAGE HEADING LINE FOR PRINTING A 132 CHARACTER REPORT. *01316800
      ******************************************************************01316900
           COPY DPWS132.                                                01317000
                                                                        01318000
      ***************************************************************** 01319000
      *  ADJUSTMENT INPUT FILE                                          01320000
      ******************************************************************01330000
           COPY TCWS005.                                                01340000
                                                                        01350000
      ******************************************************************01360000
      *  HEADING LINES DEBIT ADJUSTMENT REPORTS                        *01370000
      ******************************************************************01380000
       01  R1-TITLE-LINE-1.                                             01390000
           05  FILLER                      PIC  X(40)    VALUE SPACES.  01400000
           05  T1-TITLE                    PIC  X(43)    VALUE          01410000
               'DAILY DEBIT APPROVED ADJUSTMENT REPORT FOR '.           01420000
           05  T1-PROCESS-DTE              PIC  X(10)    VALUE SPACES.  01430000
           05  FILLER                      PIC  X(39)    VALUE SPACES.  01440000
                                                                        01450000
       01  SPACE-REPORT-LINE.                                           01530000
           05  FILLER                      PIC  X(132)   VALUE SPACES.  01540000
                                                                        01550000
       01  H1-COLUMN-HEADING.                                           01650000
           05  FILLER                      PIC  X(03)    VALUE SPACES.  01660000
           05  FILLER                      PIC  X(04)    VALUE          01670000
               'DATE'.                                                  01680000
           05  FILLER                      PIC  X(07)    VALUE SPACES.  01690000
           05  FILLER                      PIC  X(09)    VALUE          01700002
               'ADJ TOTAL'.                                             01710003
           05  FILLER                      PIC  X(07)    VALUE SPACES.  01711002
           05  FILLER                      PIC  X(10)    VALUE          01712002
               'ORIG TOTAL'.                                            01713003
           05  FILLER                      PIC  X(08)    VALUE SPACES.  01714000
       01  H1-COLUMN-HEADING-2.                                         01714107
           05  FILLER                      PIC  X(07)    VALUE          01715002
               'ADJ 110'.                                               01716003
           05  FILLER                      PIC  X(07)    VALUE SPACES.  01716102
           05  FILLER                      PIC  X(08)    VALUE          01716202
               'ORIG 110'.                                              01716303
           05  FILLER                      PIC  X(07)    VALUE SPACES.  01716402
           05  FILLER                      PIC  X(07)    VALUE          01716502
               'ADJ 111'.                                               01716603
           05  FILLER                      PIC  X(08)    VALUE SPACES.  01716702
           05  FILLER                      PIC  X(08)    VALUE          01716802
               'ORIG 111'.                                              01716903
           05  FILLER                      PIC  X(08)    VALUE SPACES.  01717002
           05  FILLER                      PIC  X(07)    VALUE          01717102
               'ADJ 112'.                                               01717203
           05  FILLER                      PIC  X(08)    VALUE SPACES.  01717302
           05  FILLER                      PIC  X(08)    VALUE          01717402
               'ORIG 112'.                                              01717503
           05  FILLER                      PIC  X(02)    VALUE SPACES.  01718002
      ******************************************************************02270000
      *  DETAIL LINE.                                                   02280000
      ******************************************************************02290000
       01  D1-DETAIL-LINE-1.                                            02300000
           05  D1-TRAN-DATE                PIC  X(10).                  02301003
           05  FILLER                      PIC  X(03)    VALUE SPACES.  02302003
           05  D1-ADJ-TOTAL                PIC  ZZZZZZZZ9.99.           02304002
           05  FILLER                      PIC  X(04)    VALUE SPACES.  02305003
           05  D1-ORIG-TOTAL               PIC  ZZZZZZZZ9.99.           02307002
           05  FILLER                      PIC  X(93)    VALUE SPACES.  02308006
       01  D1-DETAIL-LINE-2.                                            02309006
           05  D1-ADJ-T110                 PIC  ZZZZZZZZ9.99.           02309106
           05  FILLER                      PIC  X(03)    VALUE SPACES.  02309206
           05  D1-ORIG-T110                PIC  ZZZZZZZZ9.99.           02309406
           05  FILLER                      PIC  X(03)    VALUE SPACES.  02309506
           05  D1-ADJ-T111                 PIC  ZZZZZZZZ9.99.           02309606
           05  FILLER                      PIC  X(03)    VALUE SPACES.  02309706
           05  D1-ORIG-T111                PIC  ZZZZZZZZ9.99.           02309806
           05  FILLER                      PIC  X(03)    VALUE SPACES.  02309906
           05  D1-ADJ-T112                 PIC  ZZZZZZZZ9.99.           02310006
           05  FILLER                      PIC  X(03)    VALUE SPACES.  02310106
           05  D1-ORIG-T112                PIC  ZZZZZZZZ9.99.           02310206
                                                                        02320002
       01  NO-INPUT-LINE.                                               02330008
           05  FILLER                      PIC  X(27)    VALUE          02340008
               'NO ADJUSTMENT RECORDS TODAY'.                           02350008
           05  FILLER                      PIC  X(105)   VALUE SPACES.  02370008
                                                                        02380008
       PROCEDURE DIVISION.                                              02470000
                                                                        02480000
      ******************************************************************02490000
      * 0000-MAINLINE-PARAGRAPH                                         02500000
      ******************************************************************02510000
       0000-MAINLINE-PARAGRAPH.                                         02520000
                                                                        02530000
           PERFORM 1000-INITIALIZE-PROGRAM.                             02540000
                                                                        02550000
           PERFORM 2000-READ-ADJ-FILE.                                  02560000
                                                                        02570000
      ******************************************************************02580000
      * SET SAVE DATE ON FIRST READ                                     02590001
      ******************************************************************02600000
           MOVE TC005-ORIG-TRAN-DTE    TO  PV-SV-TRAN-DATE.             02610001
                                                                        02620000
           IF PS-END-OF-ADJ-FILE                                        02621008
               SET NO-INPUT-TODAY      TO TRUE                          02622008
           ELSE                                                         02623008
               PERFORM 3000-PROCESS                                     02630008
                   UNTIL PS-END-OF-ADJ-FILE                             02640008
           END-IF.                                                      02650008
                                                                        02650108
           IF NO-INPUT-TODAY                                            02651008
               WRITE ADJUSTMENT-REPT-RECORD                             02651108
               FROM NO-INPUT-LINE                                       02651208
               AFTER ADVANCING 2 LINE                                   02651308
           ELSE                                                         02653008
               PERFORM 4000-WRITE-FINAL-LINES                           02660009
           END-IF.                                                      02661008
                                                                        02670000
           CLOSE CONTROL-DATE-FILE                                      02680000
                 ADJ-INPUT-FILE                                         02690000
                 ADJUSTMENT-REPORT.                                     02700000
                                                                        02720000
           GOBACK.                                                      02730000
                                                                        02740000
      ******************************************************************02750000
      * 1000-INITIALIZE-PROGRAM                                         02760000
      *     OPEN FILES, PROCESS CONTROL CARD                            02770000
      ******************************************************************02780000
       1000-INITIALIZE-PROGRAM.                                         02790000
                                                                        02800000
           OPEN INPUT  CONTROL-DATE-FILE                                02810000
                       ADJ-INPUT-FILE                                   02820000
                OUTPUT ADJUSTMENT-REPORT.                               02830000
                                                                        02850000
           READ CONTROL-DATE-FILE INTO CC-CONTROL-CARD                  02860000
              AT END                                                    02870000
                 SET PS-END-OF-CONTROL-FILE TO TRUE.                    02880000
                                                                        02890000
           IF PS-END-OF-CONTROL-FILE                                    02900000
              DISPLAY 'DATE CARD MISSING '                              02910000
              MOVE '1000-INITIALIZE-PROGRAM ' TO PV-PARAGRAPH-NAME      02920000
              SET AC-CONTROL-CARD-ERROR TO TRUE                         02930000
              PERFORM 9999-ABEND                                        02940000
           ELSE                                                         02950000
              DISPLAY PC-PROGRAM-NAME ' CONTROL DATE:  '                02960000
                   CC-POS-DATE-MMDDYY                                   02970000
              MOVE CC-POS-DATE-MMDDYY TO PV-MMDDYY-DATE                 02980000
              MOVE 20              TO PV-FMT-CC                         02990000
              MOVE PV-MMDDYY-YY    TO PV-FMT-YY                         03000000
              MOVE PV-MMDDYY-MM    TO PV-FMT-MM                         03010000
              MOVE PV-MMDDYY-DD    TO PV-FMT-DD                         03020000
              MOVE PV-FMT-DATE     TO T1-PROCESS-DTE                    03030000
           END-IF.                                                      03050000
                                                                        03060000
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03070000
                                                                        03080000
           SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   03090000
           SET  DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                   03100000
           SET  DPG52-LK-DTE-GREG            TO TRUE.                   03110000
           MOVE CC-POS-DATE-MMDDYY           TO DPG52-LK-DATE-INPUT.    03120000
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    03130000
                                                   DPG54 DPG55 DPG56.   03140000
           EVALUATE TRUE                                                03150000
               WHEN DPG54-SEVERE-ERROR                                  03160000
               WHEN DPG54-DATE-INVALID                                  03170000
                   MOVE '1000-PROCESS-DATE-CARD'                        03180000
                                                 TO PV-PARAGRAPH-NAME   03190000
                   MOVE 'ERROR CONVERTING INPUT CARD DATE'              03200000
                                                 TO PV-OPERATION-MSG-1  03210000
                   SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                03211000
                   MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  03212000
                   PERFORM 9999-ABEND                                   03213000
           END-EVALUATE.                                                03214000
                                                                        03214100
           MOVE DPG55-DB2-ISO-DATE-FMT       TO PV-POS-CCYY-MM-DD.      03214200
                                                                        03214300
           PERFORM 1400-FORMAT-HEADINGS.                                03214400
                                                                        03214500
           SET INPUT-TODAY             TO TRUE.                         03214608
           MOVE 0                      TO PV-L110-ORIG-TOT.             03214702
           MOVE 0                      TO PV-L111-ORIG-TOT.             03214802
           MOVE 0                      TO PV-L112-ORIG-TOT.             03214902
           MOVE 0                      TO PV-L110-ADJ-TOT.              03215002
           MOVE 0                      TO PV-L111-ADJ-TOT.              03215102
           MOVE 0                      TO PV-L112-ADJ-TOT.              03215202
           MOVE 0                      TO PV-LCOM-ORIG-TOT.             03215302
           MOVE 0                      TO PV-LCOM-ADJ-TOT.              03215402
           MOVE 0                      TO PV-R110-ORIG-TOT.             03215502
           MOVE 0                      TO PV-R111-ORIG-TOT.             03215602
           MOVE 0                      TO PV-R112-ORIG-TOT.             03215702
           MOVE 0                      TO PV-R110-ADJ-TOT.              03215802
           MOVE 0                      TO PV-R111-ADJ-TOT.              03215902
           MOVE 0                      TO PV-R112-ADJ-TOT.              03216002
           MOVE 0                      TO PV-RCOM-ORIG-TOT.             03216102
           MOVE 0                      TO PV-RCOM-ADJ-TOT.              03216202
      ******************************************************************03216302
      * 1400-FORMAT-HEADINGS                                            03216402
      *     GET CURRENT DATE AND TIME FROM SYSTEM.                      03216502
      *     FORMAT REPORT FIELDS IN THE TOP PAGE HEADING LINE.          03216602
      *     FORMAT HEADING LINE 2 WITH CONVERTED POS DATE.              03216702
      ******************************************************************03216802
       1400-FORMAT-HEADINGS.                                            03217000
                                                                        03218000
           MOVE FUNCTION CURRENT-DATE (1:8) TO PV-CURR-DATE-CCYYMMDD.   03219000
           ACCEPT PV-CURR-TIME FROM TIME.                               03219100
                                                                        03219200
           MOVE PV-CURR-DATE-MM             TO DP132-RUN-MONTH.         03219300
           MOVE PV-CURR-DATE-DD             TO DP132-RUN-DAY.           03219400
           MOVE PV-CURR-DATE-CCYY           TO DP132-RUN-YEAR.          03219500
                                                                        03219600
           MOVE PV-CURR-TIME-HH             TO DP132-RUN-HOUR.          03219700
           MOVE PV-CURR-TIME-MM             TO DP132-RUN-MINUTE.        03219800
           MOVE PC-PROGRAM-NAME             TO DP132-PROGRAM-NAME.      03219900
                                                                        03220000
           PERFORM 1450-WRITE-REPORT1-HEADING.                          03221000
                                                                        03221200
      ******************************************************************03221300
      * 1450 WRITE-REPORT1-HEADING.                                     03221400
      *     WRITE THE REPORT HEADINGS FOR REPORT ONE                    03221500
      * TITLE = 'DAILY DEBIT ADJUSTMENT REPORT FOR'                     03221600
      *                                                                 03221700
      ******************************************************************03221800
       1450-WRITE-REPORT1-HEADING.                                      03221900
                                                                        03222000
           MOVE +5 TO PV-R1-LINE-CNT.                                   03222101
           ADD  +1 TO PV-R1-PAGE-CNT.                                   03222200
                                                                        03222300
           MOVE PC-REPORT-NBR-1        TO DP132-REPORT-NUMBER.          03222400
           MOVE PV-R1-PAGE-CNT         TO DP132-PAGE-NUMBER.            03222500
                                                                        03222600
            WRITE ADJUSTMENT-REPT-RECORD                                03222700
             FROM DP132-STANDRD-HEADER-132-COLS                         03222800
             AFTER ADVANCING PAGE.                                      03222900
                                                                        03223000
            WRITE ADJUSTMENT-REPT-RECORD                                03223100
             FROM R1-TITLE-LINE-1                                       03223200
             AFTER ADVANCING 1 LINE.                                    03223300
                                                                        03223400
            WRITE ADJUSTMENT-REPT-RECORD                                03223500
             FROM  H1-COLUMN-HEADING                                    03223601
             AFTER ADVANCING 2 LINE.                                    03223700
                                                                        03223800
            WRITE ADJUSTMENT-REPT-RECORD                                03225100
             FROM  SPACE-REPORT-LINE                                    03225200
             AFTER ADVANCING 1 LINE.                                    03225300
                                                                        03225400
      ******************************************************************03233000
      * 2000-READ-INPUT-FILE                                            03233100
      *     READ THE ADJUSTMENT INPUT FILE                              03233200
      ******************************************************************03233300
       2000-READ-ADJ-FILE.                                              03233400
                                                                        03233500
           READ ADJ-INPUT-FILE  INTO TC005-ADJUSTMENT-FILE              03233600
               AT END                                                   03233700
                   SET PS-END-OF-ADJ-FILE TO TRUE                       03233800
           END-READ.                                                    03233900
                                                                        03234000
      ***************************************************************** 03235000
      * 3000-PROCESS                                                    03236000
      *        PROCESS THROUGH THE ADJUSTMENT INPUT RECORDS WITH        03237000
      * CONTROL BREAKS ON DATE.                                         03238002
      * NO DETAIL LINES ARE CREATED ONLY TOTALS OF TYPES 110/111/112    03239002
      * AND THE TOTAL COMBINE OF ALL REC TYPES                          03240002
      ***************************************************************** 03250000
       3000-PROCESS.                                                    03260000
                                                                        03270000
           IF TC005-ORIG-TRAN-DTE   NOT = PV-SV-TRAN-DATE               03280001
               PERFORM 3100-WRITE-DALIY-LINE                            03290001
               ADD PV-LCOM-ORIG-TOT    TO PV-RCOM-ORIG-TOT              03291002
               ADD PV-LCOM-ADJ-TOT     TO PV-RCOM-ADJ-TOT               03291102
               ADD PV-L110-ORIG-TOT    TO PV-R110-ORIG-TOT              03292001
               ADD PV-L110-ADJ-TOT     TO PV-R110-ADJ-TOT               03294002
               ADD PV-L111-ORIG-TOT    TO PV-R111-ORIG-TOT              03299001
               ADD PV-L111-ADJ-TOT     TO PV-R111-ADJ-TOT               03300002
               ADD PV-L112-ORIG-TOT    TO PV-R112-ORIG-TOT              03321001
               ADD PV-L112-ADJ-TOT     TO PV-R112-ADJ-TOT               03322002
               MOVE 0                  TO PV-L110-ORIG-TOT              03330001
               MOVE 0                  TO PV-L111-ORIG-TOT              03331001
               MOVE 0                  TO PV-L112-ORIG-TOT              03332001
               MOVE 0                  TO PV-L110-ADJ-TOT               03340001
               MOVE 0                  TO PV-L111-ADJ-TOT               03341001
               MOVE 0                  TO PV-L112-ADJ-TOT               03342001
               MOVE 0                  TO PV-LCOM-ORIG-TOT              03343002
               MOVE 0                  TO PV-LCOM-ADJ-TOT               03344002
               MOVE  TC005-ORIG-TRAN-DTE                                03345004
                                       TO  PV-SV-TRAN-DATE              03346004
           END-IF.                                                      03350000
                                                                        03360000
           EVALUATE TC005-TRAN-DISP                                     03370001
                WHEN '110'                                              03389301
                   ADD TC005-ORIG-TRANS-AMT                             03389401
                                       TO PV-L110-ORIG-TOT              03389501
                   ADD TC005-ADJUST-AMT                                 03389601
                                       TO PV-L110-ADJ-TOT               03389701
                   ADD TC005-ORIG-TRANS-AMT                             03389801
                                       TO PV-LCOM-ORIG-TOT              03389901
                   ADD TC005-ADJUST-AMT                                 03390001
                                       TO PV-LCOM-ADJ-TOT               03390101
                WHEN '111'                                              03390201
                   ADD TC005-ORIG-TRANS-AMT                             03390301
                                       TO PV-L111-ORIG-TOT              03390401
                   ADD TC005-ADJUST-AMT                                 03390501
                                       TO PV-L111-ADJ-TOT               03390601
                   ADD TC005-ORIG-TRANS-AMT                             03390701
                                       TO PV-LCOM-ORIG-TOT              03390801
                   ADD TC005-ADJUST-AMT                                 03390901
                                       TO PV-LCOM-ADJ-TOT               03391001
                WHEN '112'                                              03391501
                   ADD TC005-ORIG-TRANS-AMT                             03391601
                                       TO PV-L112-ORIG-TOT              03391701
                   ADD TC005-ADJUST-AMT                                 03391801
                                       TO PV-L112-ADJ-TOT               03391901
                   ADD TC005-ORIG-TRANS-AMT                             03392001
                                       TO PV-LCOM-ORIG-TOT              03392101
                   ADD TC005-ADJUST-AMT                                 03392201
                                       TO PV-LCOM-ADJ-TOT               03392301
           END-EVALUATE.                                                03393001
                                                                        03410000
           PERFORM 2000-READ-ADJ-FILE.                                  03420000
                                                                        03430000
      ******************************************************************03810000
      *  WRITE THE DAILY TOTALS OF REC TYPE 110/111/112 AND THE COMBINE 03820002
      * TOTAL OF ALL THREE                                              03830002
      ******************************************************************03870000
       3100-WRITE-DALIY-LINE.                                           03880001
                                                                        03890000
            MOVE PV-SV-TRAN-DATE       TO PV-YYMMDD-DATE.               03900005
            MOVE 20                    TO PV-FMT-CC.                    03910000
            MOVE PV-YYMMDD-YY          TO PV-FMT-YY.                    03920000
            MOVE PV-YYMMDD-MM          TO PV-FMT-MM.                    03930000
            MOVE PV-YYMMDD-DD          TO PV-FMT-DD.                    03940000
            MOVE PV-FMT-DATE           TO D1-TRAN-DATE.                 03950001
            MOVE PV-L110-ORIG-TOT      TO D1-ORIG-T110.                 03960002
            MOVE PV-L110-ADJ-TOT       TO D1-ADJ-T110.                  03961002
            MOVE PV-L111-ORIG-TOT      TO D1-ORIG-T111.                 03990002
            MOVE PV-L111-ADJ-TOT       TO D1-ADJ-T111.                  04000002
            MOVE PV-L112-ORIG-TOT      TO D1-ORIG-T112.                 04030002
            MOVE PV-L112-ADJ-TOT       TO D1-ADJ-T112.                  04040002
            MOVE PV-LCOM-ORIG-TOT      TO D1-ORIG-TOTAL.                04050002
            MOVE PV-LCOM-ADJ-TOT       TO D1-ADJ-TOTAL.                 04060002
                                                                        04070001
            IF PV-R1-LINE-CNT   >  56                                   04490002
                PERFORM 1450-WRITE-REPORT1-HEADING                      04500000
            END-IF.                                                     04510000
                                                                        04520000
            WRITE ADJUSTMENT-REPT-RECORD                                04530000
             FROM D1-DETAIL-LINE-1                                      04540000
             AFTER ADVANCING 1 LINE.                                    04550000
                                                                        04560000
            WRITE ADJUSTMENT-REPT-RECORD                                04650000
             FROM SPACE-REPORT-LINE                                     04660000
             AFTER ADVANCING 1 LINE.                                    04670000
                                                                        04680000
            ADD  +2                    TO PV-R1-LINE-CNT.               04690001
                                                                        04700000
      ******************************************************************04710000
      * 4000-WRITE-FINAL-LINES.                                         04720002
      *     WRITE THE LAST CONTROL BREAK (DATE)  LINE                   04730002
      *      WRITES THE TOTAL LINE OF REPORT                            04740002
      ******************************************************************04750000
       4000-WRITE-FINAL-LINES.                                          04760002
                                                                        04770000
            PERFORM 3100-WRITE-DALIY-LINE.                              04771002
                                                                        04772002
            MOVE '  TOTALS  '          TO D1-TRAN-DATE.                 04780002
            ADD PV-LCOM-ORIG-TOT       TO PV-RCOM-ORIG-TOT              04781010
            ADD PV-LCOM-ADJ-TOT        TO PV-RCOM-ADJ-TOT               04782010
            ADD PV-L110-ORIG-TOT       TO PV-R110-ORIG-TOT              04783010
            ADD PV-L110-ADJ-TOT        TO PV-R110-ADJ-TOT               04784010
            ADD PV-L111-ORIG-TOT       TO PV-R111-ORIG-TOT              04785010
            ADD PV-L111-ADJ-TOT        TO PV-R111-ADJ-TOT               04786010
            ADD PV-L112-ORIG-TOT       TO PV-R112-ORIG-TOT              04787010
            ADD PV-L112-ADJ-TOT        TO PV-R112-ADJ-TOT               04788010
            MOVE PV-R110-ORIG-TOT      TO D1-ORIG-T110.                 04790002
            MOVE PV-R110-ADJ-TOT       TO D1-ADJ-T110.                  04800002
            MOVE PV-R111-ORIG-TOT      TO D1-ORIG-T111.                 04810002
            MOVE PV-R111-ADJ-TOT       TO D1-ADJ-T111.                  04820002
            MOVE PV-R112-ORIG-TOT      TO D1-ORIG-T112.                 04830002
            MOVE PV-R112-ADJ-TOT       TO D1-ADJ-T112.                  04840002
            MOVE PV-RCOM-ORIG-TOT      TO D1-ORIG-TOTAL.                04850002
            MOVE PV-RCOM-ADJ-TOT       TO D1-ADJ-TOTAL.                 04860002
                                                                        04861002
            WRITE ADJUSTMENT-REPT-RECORD                                04862002
             FROM D1-DETAIL-LINE-1                                      04863002
             AFTER ADVANCING 2 LINE.                                    04864002
                                                                        04865002
      ******************************************************************04950000
      * 9999-ABEND                                                      04960000
      *     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  04970000
      ******************************************************************04980000
       9999-ABEND.                                                      04990000
           DISPLAY '** ABEND           **'.                             05000000
           DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          05010000
           DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        05020000
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       05030000
           DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       05040000
           CALL 'ILBOABN0' USING AC-ABEND-CODE.                         05050000
