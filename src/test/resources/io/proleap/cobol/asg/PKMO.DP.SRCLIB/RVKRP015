00001 ******************************************************************01/03/96
00002  IDENTIFICATION DIVISION.                                         RVKRP005
00003 ******************************************************************   LV001
00004                                                                   RVKRP005
00005  PROGRAM-ID.             RVKRP015.                                RVKRP005
00006  AUTHOR.                 MICHAEL WALTERS.                         RVKRP005
00007  INSTALLATION.           KOHLS.                                   RVKRP005
00008  DATE-WRITTEN            AUGUST, 1995.                            RVKRP005
00009  DATE-COMPILED.                                                   RVKRP005
00010                                                                   RVKRP005
00011 ******************************************************************RVKRP005
00012 *  THIS PROGRAM WILL REPORT ON ALL THE VENDOR RETURN AGREEMENTS   RVKRP005
00014 ******************************************************************RVKRP005
00015                                                                   RVKRP005
00016 ******************************************************************RVKRP005
00017  ENVIRONMENT DIVISION.                                            RVKRP005
00018 ******************************************************************RVKRP005
00019                                                                   RVKRP005
00020  CONFIGURATION SECTION.                                           RVKRP005
00021                                                                   RVKRP005
00022  SOURCE-COMPUTER.        IBM-3090.                                RVKRP005
00023  OBJECT-COMPUTER.        IBM-3090.                                RVKRP005
00024                                                                   RVKRP005
00025  INPUT-OUTPUT SECTION.                                            RVKRP005
00026                                                                   RVKRP005
00027  FILE-CONTROL.                                                    RVKRP005
00028                                                                   RVKRP005
00029      SELECT RTV-REPORT-EXTRACT                                    RVKRP005
00030          ASSIGN TO IN01.                                          RVKRP005
00031                                                                   RVKRP005
00032      SELECT DI-DEFECT-ITEM-REPORT                                 RVKRP005
00033          ASSIGN TO RPT01.                                         RVKRP005
00034                                                                   RVKRP005
00035 ******************************************************************RVKRP005
00036  DATA DIVISION.                                                   RVKRP005
00037 ******************************************************************RVKRP005
00038                                                                   RVKRP005
00039  FILE SECTION.                                                    RVKRP005
00040                                                                   RVKRP005
00041  FD  RTV-REPORT-EXTRACT                                           RVKRP005
00042      RECORDING MODE IS F                                          RVKRP005
00043      LABEL RECORDS ARE STANDARD                                   RVKRP005
00044      BLOCK CONTAINS 0 RECORDS.                                    RVKRP005
00045                                                                   RVKRP005
00046  01  RTV-REPORT-EXTRACT-RECORD       PIC  X(300).                 RVKRP005
00047                                                                   RVKRP005
00048  FD  DI-DEFECT-ITEM-REPORT                                        RVKRP005
00049      RECORDING MODE IS F                                          RVKRP005
00050      LABEL RECORDS ARE STANDARD                                   RVKRP005
00051      BLOCK CONTAINS 0 RECORDS.                                    RVKRP005
00052                                                                   RVKRP005
00053  01  DI-DEFECT-ITEM-LINE             PIC  X(132).                 RVKRP005
00054                                                                   RVKRP005
00055 ******************************************************************RVKRP005
00056  WORKING-STORAGE SECTION.                                         RVKRP005
00057 ******************************************************************RVKRP005
00058                                                                   RVKRP005
00059 *                                                                 RVKRP005
00060 *  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                RVKRP005
00061 *                                                                 RVKRP005
00062      COPY DPWS132O.                                               RVKRP005
                                                                                
00067                                                                   RVKRP005
00068 *                                                                 RVKRP005
00069 *  RECORD LAYOUT OF THE RTV EXTRACT FILE.                         RVKRP005
00070 *                                                                 RVKRP005
00071      COPY RVRD003.                                                RVKRP005
00072                                                                   RVKRP005
00073                                                                   RVKRP005
00074  01  ABEND-CODE                          PIC S9(04) VALUE +0      RVKRP005
00075                                                      COMP SYNC.   RVKRP005
00076  01  PH2-PAGE-HEADING.                                            RVKRP005
00077      05  FILLER                          PIC  X(47)  VALUE SPACE. RVKRP005
00078      05  FILLER                          PIC  X(38)  VALUE        RVKRP005
00079          'VENDOR RETURN-AGREEMENT REPORT BY TYPE'.                      05
00080      05  FILLER                          PIC  X(48)  VALUE SPACE. RVKRP005
00081                                                                   RVKRP005
00088  01  PH4-GMM-PAGE-HEADING-4.                                      RVKRP005
           05 FILLER                           PIC  X(08)  VALUE        RVKRP005
               '  GMM:  '.                                                      
00095      05 PH4-GMM-NBR                      PIC  X(02)  VALUE SPACE. RVKRP005
00090      05 FILLER                           PIC  X(03)  VALUE        RVKRP005
00091          ' - '.                                                         05
00092      05 PH4-GMM-NAME                     PIC  X(30) VALUE SPACE.        05
                                                                                
00088  01  PH5-DMM-PAGE-HEADING-5.                                      RVKRP005
           05 FILLER                           PIC  X(08)  VALUE        RVKRP005
               '  DMM:  '.                                                      
00095      05 PH5-DMM-NBR                      PIC  X(02)  VALUE SPACE. RVKRP005
00090      05 FILLER                           PIC  X(03)  VALUE        RVKRP005
00091          ' - '.                                                         05
00092      05 PH5-DMM-NAME                     PIC  X(30) VALUE SPACE.        05
                                                                                
00088  01  PH6-BUYER-PAGE-HEADING-6.                                    RVKRP005
           05 FILLER                           PIC  X(07)  VALUE        RVKRP005
               'BUYER: '.                                                       
00095      05 PH6-BUYER-NBR                    PIC  X(03)  VALUE SPACE. RVKRP005
00090      05 FILLER                           PIC  X(03)  VALUE        RVKRP005
00091          ' - '.                                                         05
00092      05 PH6-BUYER-NAME                   PIC  X(30) VALUE SPACE.        05
00151                                                                   RVKRP005
00151                                                                   RVKRP005
00152  01  DH1-DETAIL-HEADING.                                                05
00184      05  FILLER                          PIC  X(25) VALUE SPACES. RVKRP005
00183      05  FILLER                          PIC  X(02) VALUE SPACES.       05
           05  FILLER                          PIC  X(05) VALUE SPACES.       05
00185      05  FILLER                          PIC  X(02) VALUE SPACES.       05
00186      05  FILLER                          PIC  X(03) VALUE 'DPT'.        05
 0187      05  FILLER                          PIC  X(02) VALUE SPACES.       05
00188      05  FILLER                          PIC  X(25) VALUE               05
               ' DEPARTMENT              '.                                     
00189      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00190      05  FILLER                          PIC  X(03) VALUE SPACES. RVKRP005
00191      05  FILLER                          PIC  X(02) VALUE SPACES.       05
00190      05  FILLER                          PIC  X(04) VALUE 'PERM'. RVKRP005
00191      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00190      05  FILLER                          PIC  X(03) VALUE SPACES. RVKRP005
00191      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00190      05  FILLER                          PIC  X(03) VALUE SPACES. RVKRP005
00191      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00188      05  FILLER                          PIC  X(25) VALUE SPACES.       05
00189      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00188      05  FILLER                          PIC  X(10) VALUE SPACES. RVKRP005
00151                                                                   RVKRP005
00152  01  DH2-DETAIL-HEADING.                                          RVKRP005
00184      05  FILLER                          PIC  X(25) VALUE               05
               ' VENDOR NAME             '.                                     
00183      05  FILLER                          PIC  X(02) VALUE SPACES.       05
           05  FILLER                          PIC  X(05) VALUE               05
               ' RANK'.                                                         
00185      05  FILLER                          PIC  X(02) VALUE SPACES.       05
00186      05  FILLER                          PIC  X(03) VALUE               05
               'NBR'.                                                           
 0187      05  FILLER                          PIC  X(02) VALUE SPACES.       05
00188      05  FILLER                          PIC  X(25) VALUE               05
               ' DESCRIPTION             '.                                     
00189      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00190      05  FILLER                          PIC  X(03) VALUE               05
               'D&R'.                                                           
00191      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00190      05  FILLER                          PIC  X(03) VALUE               05
               'RA '.                                                           
00191      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00190      05  FILLER                          PIC  X(03) VALUE               05
               'D&D'.                                                           
00191      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00190      05  FILLER                          PIC  X(03) VALUE               05
               'MOS'.                                                           
00191      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00188      05  FILLER                          PIC  X(25) VALUE               05
               '   LAST UPDATED BY       '.                                     
00189      05  FILLER                          PIC  X(02) VALUE SPACES.       05
00188      05  FILLER                          PIC  X(11) VALUE               05
               'UPDATE DATE'.                                                   
00151                                                                   RVKRP005
00152  01  DHD-DETAIL-HEADING-DASHES.                                   RVKRP005
00184      05  FILLER                          PIC  X(25) VALUE ALL '_'.RVKRP005
00183      05  FILLER                          PIC  X(02) VALUE SPACES.       05
           05  FILLER                          PIC  X(05) VALUE ALL '_'.RVKRP005
00185      05  FILLER                          PIC  X(02) VALUE SPACES.       05
00186      05  FILLER                          PIC  X(03) VALUE ALL '_'.RVKRP005
 0187      05  FILLER                          PIC  X(02) VALUE SPACES.       05
00188      05  FILLER                          PIC  X(25) VALUE ALL '_'.RVKRP005
00189      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00190      05  FILLER                          PIC  X(03) VALUE ALL '_'.RVKRP005
00191      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00190      05  FILLER                          PIC  X(03) VALUE ALL '_'.RVKRP005
00191      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00190      05  FILLER                          PIC  X(03) VALUE ALL '_'.RVKRP005
00191      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00190      05  FILLER                          PIC  X(03) VALUE ALL '_'.RVKRP005
00191      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00188      05  FILLER                          PIC  X(25) VALUE ALL '_'.RVKRP005
00189      05  FILLER                          PIC  X(03) VALUE SPACES.       05
00188      05  FILLER                          PIC  X(10) VALUE ALL '_'.RVKRP005
                                                                                
00182  01  DL-DETAIL-LINE.                                              RVKRP005
00184      05  DL-VND-NAME                     PIC  X(25).              RVKRP005
00183      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00184      05  DL-RANK-X.                                               RVKRP005
               10  DL-RANK                     PIC  ZZZZ9.              RVKRP005
00185      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00186      05  DL-DPT-NBR                      PIC  X(03).              RVKRP005
 0187      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00188      05  DL-DPT-DESC                     PIC  X(25).              RVKRP005
00189      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00190      05  DL-DEBIT-AND-RETURN-IND         PIC  X(03)  VALUE SPACES.RVKRP005
00191      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00190      05  DL-PERM-RA-IND                  PIC  X(03)  VALUE SPACES.RVKRP005
00191      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00190      05  DL-DEBIT-AND-DISPOSE-IND        PIC  X(03)  VALUE SPACES.RVKRP005
00191      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00190      05  DL-MARK-OUT-OF-STOCK-IND        PIC  X(03)  VALUE SPACES.RVKRP005
00191      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00188      05  DL-LAST-UPDATE-NAME             PIC  X(25).              RVKRP005
00189      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00188      05  DL-LAST-UPDATE-DATE             PIC  X(10).              RVKRP005
00191                                                                         05
00202  01  TL-TOTAL-LINE-DASHES.                                        RVKRP005
00184      05  FILLER                          PIC  X(25)  VALUE SPACES.RVKRP005
00183      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
           05  FILLER                          PIC  X(05)  VALUE SPACES.RVKRP005
00185      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00186      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
 0187      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00188      05  FILLER                          PIC  X(25)  VALUE SPACES.RVKRP005
00189      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00190      05  FILLER                          PIC  X(03)  VALUE '___'.       05
00191      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00190      05  FILLER                          PIC  X(03)  VALUE '___'.       05
00191      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00190      05  FILLER                          PIC  X(03)  VALUE '___'.       05
00191      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00190      05  FILLER                          PIC  X(03)  VALUE '___'.       05
00191      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00188      05  FILLER                          PIC  X(25)  VALUE SPACES.RVKRP005
00189      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00188      05  FILLER                          PIC  X(10)  VALUE SPACES.RVKRP005
00225                                                                   RVKRP005
00226  01  TL-TOTAL-LINE.                                                     05
00184      05  FILLER                          PIC  X(25)  VALUE SPACES.RVKRP005
00183      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
           05  FILLER                          PIC  X(05)  VALUE SPACES.RVKRP005
00185      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00186      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
 0187      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00188      05  TL-TOTAL-DESCRIPTION            PIC  X(25)  VALUE SPACES.RVKRP005
00189      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP005
00190      05  TL-DEBIT-AND-RETURN-TOT         PIC  Z,ZZ9.                    05
00191      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP005
00190      05  TL-PERM-RA-TOT                  PIC  Z,ZZ9.                    05
00191      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP005
00190      05  TL-DEBIT-AND-DISPOSE-TOT        PIC  Z,ZZ9.                    05
00191      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP005
00190      05  TL-MARK-OUT-OF-STOCK-TOT        PIC  Z,ZZ9.                    05
00191      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00188      05  FILLER                          PIC  X(25)  VALUE SPACES.RVKRP005
00189      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00188      05  FILLER                          PIC  X(10)  VALUE SPACES.RVKRP005
00245                                                                   RVKRP005
00246  01  BLANK-LINE.                                                  RVKRP005
00247      05  FILLER                          PIC  X(132) VALUE SPACE. RVKRP005
00248                                                                   RVKRP005
00249  01  END-OF-REPORT-LINE.                                          RVKRP005
00250      05  FILLER                          PIC  X(88)  VALUE SPACE. RVKRP005
00251      05  FILLER                          PIC  X(25)  VALUE        RVKRP005
00252          '***** END OF REPORT *****'.                             RVKRP005
00253      05  FILLER                          PIC  X(87)  VALUE SPACE. RVKRP005
00254                                                                   RVKRP005
00255  01  ER-EMPTY-REPORT-LINE.                                        RVKRP005
00256      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP005
00257      05  FILLER                          PIC  X(48)  VALUE        RVKRP005
00258          '*** NO DATA SATISFIES THE SELECTION CRITERIA ***'.      RVKRP005
00259      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP005
00260                                                                   RVKRP005
00148  01  PA-PROGRAM-ACCUMULATORS.                                     RVKUT002
00149      05  PA-GRAND-TOTALS.                                         RVKUT002
00150          10 PA-DR-RA-GRAND-QTY           PIC S9(05)  VALUE +0     RVKUT002
00151                                                      COMP-3.      RVKUT002
00155          10 PA-DR-PERM-RA-GRAND-QTY      PIC S9(05)  VALUE +0     RVKUT002
00156                                                      COMP-3.      RVKUT002
00155          10 PA-DD-GRAND-QTY              PIC S9(05)  VALUE +0     RVKUT002
00156                                                      COMP-3.      RVKUT002
00160          10 PA-MO-GRAND-QTY              PIC S9(05)  VALUE +0     RVKUT002
00161                                                      COMP-3.      RVKUT002
00149      05  PA-GMM-TOTALS.                                           RVKUT002
00150          10 PA-DR-RA-GMM-QTY             PIC S9(05)  VALUE +0     RVKUT002
00151                                                      COMP-3.      RVKUT002
00155          10 PA-DR-PERM-RA-GMM-QTY        PIC S9(05)  VALUE +0     RVKUT002
00156                                                      COMP-3.      RVKUT002
00155          10 PA-DD-GMM-QTY                PIC S9(05)  VALUE +0     RVKUT002
00156                                                      COMP-3.      RVKUT002
00160          10 PA-MO-GMM-QTY                PIC S9(05)  VALUE +0     RVKUT002
00161                                                      COMP-3.      RVKUT002
00149      05  PA-DMM-TOTALS.                                           RVKUT002
00150          10 PA-DR-RA-DMM-QTY             PIC S9(05)  VALUE +0     RVKUT002
00151                                                      COMP-3.      RVKUT002
00155          10 PA-DR-PERM-RA-DMM-QTY        PIC S9(05)  VALUE +0     RVKUT002
00156                                                      COMP-3.      RVKUT002
00155          10 PA-DD-DMM-QTY                PIC S9(05)  VALUE +0     RVKUT002
00156                                                      COMP-3.      RVKUT002
00160          10 PA-MO-DMM-QTY                PIC S9(05)  VALUE +0     RVKUT002
00161                                                      COMP-3.      RVKUT002
00149      05  PA-BUYER-TOTALS.                                         RVKUT002
00150          10 PA-DR-RA-BUYER-QTY           PIC S9(05)  VALUE +0     RVKUT002
00151                                                      COMP-3.      RVKUT002
00155          10 PA-DR-PERM-RA-BUYER-QTY      PIC S9(05)  VALUE +0     RVKUT002
00156                                                      COMP-3.      RVKUT002
00155          10 PA-DD-BUYER-QTY              PIC S9(05)  VALUE +0     RVKUT002
00156                                                      COMP-3.      RVKUT002
00160          10 PA-MO-BUYER-QTY              PIC S9(05)  VALUE +0     RVKUT002
00161                                                      COMP-3.      RVKUT002
00326                                                                   RVKRP005
00327  01  PC-CONSTANTS.                                                RVKRP005
00328      05  PC-COMMIT-INTERVAL              PIC  9(02)  VALUE 10.    RVKRP005
00329      05  PC-MAX-REFERRAL-CODES           PIC S9(04)  VALUE +7     RVKRP005
00330                                                      COMP SYNC.   RVKRP005
00331 * 6 LPI -- 14 X 8.5 PAPER (6 * 8.5 = 51)                          RVKRP005
00332      05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +60    RVKRP005
00333                                                      COMP SYNC.   RVKRP005
00334      05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   RVKRP005
00335                                                      COMP SYNC.   RVKRP005
00336      05  PC-ZERO                         PIC  9(01)  VALUE 0.     RVKRP005
00337      05  PC-ONE                          PIC  9(01)  VALUE 1.     RVKRP005
00338      05  PC-TWO                          PIC  9(01)  VALUE 2.     RVKRP005
00339      05  PC-THREE                        PIC  9(01)  VALUE 3.     RVKRP005
00340      05  PC-FOUR                         PIC  9(01)  VALUE 4.     RVKRP005
00341      05  PC-EIGHT                        PIC  9(01)  VALUE 8.     RVKRP005
00342      05  PC-NINE                         PIC  9(01)  VALUE 9.     RVKRP005
00343      05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  RVKRP005
00344      05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        RVKRP005
00345          'RVKRP015'.                                              RVKRP005
00346      05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE        RVKRP005
00347          'RVK905  '.                                              RVKRP005
00348      05  PC-SKU-DESC-ZERO                PIC  X(15)  VALUE        RVKRP005
00349          'V E N D O R    '.                                       RVKRP005
00352      05  PC-MBS-SYSTEM-CODE-RV           PIC  X(02)  VALUE 'RV'.  RVKRP005
00353      05  PC-MBS-OP-CO-03                 PIC  X(02)  VALUE '03'.  RVKRP005
00354      05  PC-PGM-DPKUT039                 PIC  X(08)               RVKRP005
00355                                          VALUE 'DPKUT039'.        RVKRP005
00356                                                                   RVKRP005
00357  01  PS-PROGRAM-SWITCHES.                                         RVKRP005
00358      05  PS-END-OF-EXTRACT-FILE-IND      PIC  X(01)  VALUE 'N'.   RVKRP005
00359          88  PS-END-OF-EXTRACT-FILE                  VALUE 'Y'.   RVKRP005
00360          88  PS-NOT-END-OF-EXTRACT-FILE              VALUE 'N'.   RVKRP005
00361                                                                   RVKRP005
00362      05  PS-TOT-LINE-IND                 PIC  X(01)  VALUE 'N'.   RVKRP005
00363          88  PS-TOT-LINE-NEEDED                      VALUE 'Y'.   RVKRP005
00364          88  PS-NO-TOT-LINE-NEEDED                   VALUE 'N'.   RVKRP005
00365                                                                   RVKRP005
00370      05  PS-TOTAL-TYPE-IND               PIC  X(01)  VALUE ' '.   RVKRP005
00371          88  PS-DMM-TOTAL                            VALUE '1'.   RVKRP005
00372          88  PS-FCLTY-TOTAL                          VALUE '2'.   RVKRP005
00373          88  PS-GRAND-TOTAL                          VALUE '3'.   RVKRP005
00374                                                                   RVKRP005
00375  01  PV-PROGRAM-VARIABLES.                                        RVKRP005
00376      05  PV-PERCENT                      PIC S9(06)V9(5)                05
00376                                                      VALUE +0           05
00377                                                      COMP.              05
00376      05  PV-PAGE-COUNT                   PIC S9(04)  VALUE +0     RVKRP005
00377                                                      COMP.              05
00378      05  PV-LINE-COUNT                   PIC S9(04)  VALUE +0     RVKRP005
00379                                                      COMP.              05
00192      05  PV-RETURN-COST                  PIC S9(11)V99                  05
00376                                                      VALUE +0           05
00377                                                      COMP.              05
00192      05  PV-PURCHS-COST                  PIC S9(11)V99                  05
00376                                                      VALUE +0           05
00377                                                      COMP.              05
00381      05  PV-FIELD-NAME                   PIC  X(30)  VALUE SPACES.RVKRP005
00381      05  PV-HOLD-DMM-NBR                 PIC  X(02).              RVKRP005
00381      05  PV-HOLD-DMM-NAME                PIC  X(30).              RVKRP005
00381      05  PV-HOLD-GMM-NBR                 PIC  X(02).              RVKRP005
00381      05  PV-HOLD-GMM-NAME                PIC  X(30).              RVKRP005
00381      05  PV-HOLD-BUYER-NBR               PIC  X(03).              RVKRP005
00381      05  PV-HOLD-BUYER-NAME              PIC  X(30).              RVKRP005
00381      05  PV-HOLD-VND-NAME                PIC  X(25).              RVKRP005
00184      05  PV-HOLD-RANK-X.                                          RVKRP005
               10  PV-HOLD-RANK                PIC  9(05).              RVKRP005
00389 *                                                                 RVKRP005
00404      05  PV-REPORT-LINE                 PIC X(132).               RVKRP005
00408      05  PV-TIMESTAMP.                                            RVKRP005
               10  PV-TMST-DATE.                                              05
                   15  PV-TMST-DATE-YYYY       PIC  X(04).                    05
                   15  FILLER                  PIC  X(01).                      
                   15  PV-TMST-DATE-MM         PIC  X(02).                    05
                   15  FILLER                  PIC  X(01).                      
                   15  PV-TMST-DATE-DD         PIC  X(02).                    05
                   15  FILLER                  PIC  X(01).                      
               10  PV-TMST-TIME.                                              05
                   15  PV-TMST-TIME-HH         PIC  X(02).                    05
                   15  FILLER                  PIC  X(01).                      
                   15  PV-TMST-TIME-MM         PIC  X(02).                    05
                   15  FILLER                  PIC  X(01).                      
                   15  PV-TMST-TIME-SS         PIC  X(02).                    05
                   15  FILLER                  PIC  X(01).                      
                   15  PV-TMST-TIME-NS         PIC  X(06).                    05
           05  PV-DISPLAY-DATE.                                               05
               10  PV-DISP-DATE-MM             PIC  X(02).                    05
               10  FILLER                      PIC  X(01) VALUE '/'.            
               10  PV-DISP-DATE-DD             PIC  X(02).                    05
               10  FILLER                      PIC  X(01) VALUE '/'.            
               10  PV-DSIP-DATE-YYYY           PIC  X(04).                    05
00414                                                                   RVKRP005
00415  01  SD-SYSTEM-DATE.                                              RVKRP005
00416      05  SD-SYSTEM-YEAR                  PIC  9(02)  VALUE ZEROS. RVKRP005
00417      05  ST-SYSTEM-MONTH                 PIC  9(02)  VALUE ZEROS. RVKRP005
00417      05  ST-SYSTEM-DAY                   PIC  9(02)  VALUE ZEROS. RVKRP005
00418                                                                   RVKRP005
00415  01  ST-SYSTEM-TIME.                                              RVKRP005
00416      05  ST-SYSTEM-HOUR                  PIC  9(02)  VALUE ZEROS. RVKRP005
00417      05  ST-SYSTEM-MINUTE                PIC  9(02)  VALUE ZEROS. RVKRP005
00417      05  FILLER                          PIC  9(04)  VALUE ZEROS. RVKRP005
00418                                                                   RVKRP005
00419 *                                                                 RVKRP005
00420 ******************************************************************RVKRP005
00421 *  WORK FIELDS FOR THE MBS SUBROUTINE                             RVKRP005
00422 ******************************************************************RVKRP005
00423      COPY DPWS003.                                                RVKRP005
00424                                                                   RVKRP005
00425 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * RVKRP005
00426  PROCEDURE DIVISION.                                              RVKRP005
00427 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * RVKRP005
00428                                                                   RVKRP005
00429 ******************************************************************RVKRP005
00430 *  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    RVKRP005
00431 ******************************************************************RVKRP005
00432  0000-PROGRAM-MAINLINE.                                           RVKRP005
00433                                                                   RVKRP005
00434      PERFORM 1000-INITIALIZE.                                     RVKRP005
00435                                                                   RVKRP005
00436      PERFORM 2000-CREATE-REPORT                                         05
00521          UNTIL PS-END-OF-EXTRACT-FILE.                                  05
00437                                                                   F 200005
00438      PERFORM 9000-EOJ-ROUTINE.                                    RVKRP005
00439      STOP RUN.                                                    RVKRP005
00440 *0000-EXIT.                                                       RVKRP005
00441                                                                   RVKRP005
00442 ******************************************************************RVKRP005
00443 *  1000-INITIALIZE -  OPENS ALL THE REPORT FILE, ACCEPTS, EDITS,  RVKRP005
00444 *  AND DISPLAYS CONTROL CARD INFORMATION, OPENS AND FETCHES FIRST RVKRP005
00445 *  OCCURANCE OF DB2 CURSOR, PRINTS INITIAL PAGE HEADING TO REPORT RVKRP005
00446 *  FILE.                                                          RVKRP005
00447 ******************************************************************RVKRP005
00448  1000-INITIALIZE.                                                 RVKRP005
00449                                                                   RVKRP005
00450      OPEN OUTPUT DI-DEFECT-ITEM-REPORT                            RVKRP005
00451           INPUT  RTV-REPORT-EXTRACT.                              RVKRP005
00452                                                                   RVKRP005
           ACCEPT ST-SYSTEM-TIME  FROM TIME.                                    
           ACCEPT SD-SYSTEM-DATE  FROM DATE.                                    
                                                                                
      *    SET-UP PAGE HEADINGS                                                 
           MOVE PC-CURRENT-PROGRAM-NAME TO DP132O-PROGRAM-NAME.                 
           MOVE +1                      TO DP132O-REPORT-NUMBER.                
                                                                                
00416      MOVE SD-SYSTEM-YEAR          TO DP132O-RUN-YEAR              RVKRP005
00417      MOVE ST-SYSTEM-MONTH         TO DP132O-RUN-MONTH             RVKRP005
00417      MOVE ST-SYSTEM-DAY           TO DP132O-RUN-DAY               RVKRP005
00418                                                                   RVKRP005
00416      MOVE ST-SYSTEM-HOUR          TO DP132O-RUN-HOUR              RVKRP005
00417      MOVE ST-SYSTEM-MINUTE        TO DP132O-RUN-MINUTE            RVKRP005
                                                                                
           MOVE PC-MAX-REPORT-LINES     TO PV-LINE-COUNT.               RVKRP005
           MOVE +0                      TO PV-PAGE-COUNT.                       
                                                                                
00453      SET PS-NOT-END-OF-EXTRACT-FILE TO TRUE.                            05
00455      PERFORM 7000-READ-EXTRACT-FILE.                              RVKRP005
00456                                                                   RVKRP005
00457      IF PS-END-OF-EXTRACT-FILE                                    RVKRP005
00522          MOVE ER-EMPTY-REPORT-LINE  TO PV-REPORT-LINE             RVKRP005
00523          PERFORM 8000-PRINT-REPORT-LINE                           RVKRP005
00459      ELSE                                                         RVKRP005
00505          INITIALIZE DL-DETAIL-LINE                                      05
00506                     PA-PROGRAM-ACCUMULATORS                             05
                                                                                
00525          MOVE RV003-VND-NAME          TO DL-VND-NAME              RVKRP005
                                               PV-HOLD-VND-NAME                 
               MOVE RV003-BUYER-NAME        TO PV-HOLD-BUYER-NAME               
00092                                          PH6-BUYER-NAME                 05
               MOVE RV003-BUYER-NBR         TO PV-HOLD-BUYER-NBR                
00095                                          PH6-BUYER-NBR                  05
               MOVE RV003-DMM-NAME          TO PV-HOLD-DMM-NAME                 
00092                                          PH5-DMM-NAME                   05
               MOVE RV003-DMM-NBR           TO PV-HOLD-DMM-NBR                  
00095                                          PH5-DMM-NBR                    05
               MOVE RV003-GMM-NAME          TO PV-HOLD-GMM-NAME                 
00092                                          PH4-GMM-NAME                   05
               MOVE RV003-GMM-NBR           TO PV-HOLD-GMM-NBR                  
00095                                          PH4-GMM-NBR                    05
               MOVE RV003-VND-RANK          TO DL-RANK                          
00525                                          PV-HOLD-RANK             RVKRP005
00509      END-IF.                                                      RVKRP005
00510                                                                   RVKRP005
00511                                                                   RVKRP005
00512 *1000-EXIT.                                                       RVKRP005
00513                                                                   RVKRP005
00514 ******************************************************************RVKRP005
00515 * 2000-CREATE-REPORT                                              RVKRP005
00516 * PROCESS:  THIS PARAGRAPH WILL SET UP THE WORKING STORAGE INTERNARVKRP005
00517 * SORT FILE.                                                      RVKRP005
00518 ******************************************************************RVKRP005
00519  2000-CREATE-REPORT.                                              RVKRP005
00520                                                                   RVKRP005
           IF  RV003-GMM-NBR                = PV-HOLD-GMM-NBR                   
              IF  RV003-DMM-NBR             = PV-HOLD-DMM-NBR                   
                 IF  RV003-BUYER-NBR        = PV-HOLD-BUYER-NBR                 
                    IF  RV003-VND-NAME      = PV-HOLD-VND-NAME                  
                       PERFORM 2100-PRINT-REPORT-DETAIL                         
                    ELSE                                                        
                       PERFORM 2200-VENDOR-BREAK                                
                       PERFORM 2100-PRINT-REPORT-DETAIL                         
                    END-IF                                                      
                 ELSE                                                           
                    PERFORM 2300-BUYER-BREAK                                    
                    PERFORM 2100-PRINT-REPORT-DETAIL                            
                 END-IF                                                         
              ELSE                                                              
                 PERFORM 2400-DMM-BREAK                                         
                 PERFORM 2100-PRINT-REPORT-DETAIL                               
              END-IF                                                            
           ELSE                                                                 
              PERFORM 2500-GMM-BREAK                                            
              PERFORM 2100-PRINT-REPORT-DETAIL                                  
           END-IF.                                                              
                                                                                
00546      PERFORM 7000-READ-EXTRACT-FILE.                                    05
00513                                                                   RVKRP005
00514 ******************************************************************RVKRP005
00515 * 2100-PRINT-REPORT-DETAIL                                        RVKRP005
00516 * PROCESS:  THIS PARAGRAPH PRINT THE DETAIL LINES FOR THE REPORT  RVKRP005
00518 ******************************************************************RVKRP005
00519  2100-PRINT-REPORT-DETAIL.                                        RVKRP005
00796                                                                   RVKRP005
00526      MOVE RV003-DEPT-NBR             TO DL-DPT-NBR.               RVKRP005
00526      MOVE RV003-DEPT-DESC            TO DL-DPT-DESC.              RVKRP005
                                                                                
00527      IF RV003-DR-RA-IND = 'Y'                                           05
00528          MOVE ' X '                  TO DL-DEBIT-AND-RETURN-IND   RVKRP005
               ADD +1                      TO PA-DR-RA-BUYER-QTY                
00529      ELSE                                                               05
00528          MOVE '   '                  TO DL-DEBIT-AND-RETURN-IND   RVKRP005
00529      END-IF.                                                            05
00530 *                                                                 RVKRP005
00527      IF RV003-DR-PERM-RA-IND = 'Y'                                      05
00528          MOVE ' X '                  TO DL-PERM-RA-IND            RVKRP005
00190          ADD +1                      TO PA-DR-PERM-RA-BUYER-QTY         05
00529      ELSE                                                               05
00528          MOVE '   '                  TO DL-PERM-RA-IND            RVKRP005
00529      END-IF.                                                            05
00530 *                                                                 RVKRP005
00527      IF RV003-DD-IND = 'Y'                                              05
00528          MOVE ' X '                  TO DL-DEBIT-AND-DISPOSE-IND  RVKRP005
00190          ADD +1                      TO PA-DD-BUYER-QTY                 05
00529      ELSE                                                               05
00528          MOVE '   '                  TO DL-DEBIT-AND-DISPOSE-IND  RVKRP005
00529      END-IF.                                                            05
00530 *                                                                 RVKRP005
00527      IF RV003-MOS-IND = 'Y'                                             05
00528          MOVE ' X '                  TO DL-MARK-OUT-OF-STOCK-IND  RVKRP005
               ADD +1                      TO PA-MO-BUYER-QTY                   
00529      ELSE                                                               05
00528          MOVE '   '                  TO DL-MARK-OUT-OF-STOCK-IND  RVKRP005
00529      END-IF.                                                            05
00530 *                                                                 RVKRP005
           MOVE RV003-LAST-UPDT-NAME       TO DL-LAST-UPDATE-NAME.              
                                                                                
           MOVE RV003-LAST-UPDT-TMST       TO PV-TIMESTAMP.                     
           MOVE PV-TMST-DATE-YYYY          TO PV-DSIP-DATE-YYYY.              05
           MOVE PV-TMST-DATE-MM            TO PV-DISP-DATE-MM.                05
           MOVE PV-TMST-DATE-DD            TO PV-DISP-DATE-DD.                05
           MOVE PV-DISPLAY-DATE            TO DL-LAST-UPDATE-DATE.            05
      *                                                                         
00702      PERFORM 8000-PRINT-REPORT-LINE.                                    05
                                                                                
           MOVE SPACES                     TO DL-VND-NAME                       
                                              DL-RANK-X.                RVKRP005
00513                                                                   RVKRP005
00514 ******************************************************************RVKRP005
00515 * 2200-VENDOR-BREAK.                                              RVKRP005
00516 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC NEEDED FOR A    RVKRP005
00516 *           BREAK IN VENDOR                                             05
00518 ******************************************************************RVKRP005
00519  2200-VENDOR-BREAK.                                               RVKRP005
00520                                                                   RVKRP005
00525      MOVE RV003-VND-NAME             TO DL-VND-NAME               RVKRP005
                                              PV-HOLD-VND-NAME.                 
           MOVE RV003-VND-RANK             TO DL-RANK                           
                                              PV-HOLD-RANK.                     
                                                                                
00514 ******************************************************************      05
00515 * 2300-BUYER-BREAK.                                              *      05
00516 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC NEEDED FOR A   *      05
00516 *           BREAK IN BUYER NUMBER                                *      05
      *           1. PRINT THE TOTALS FOR THE BUYER                    *        
      *           2. ADD THE BUYER TOTALS TO THE DMM TOTALS            *        
      *           3. INITIALIZE THE BUYER TOTALS FOR NEW BUYER         *        
00518 ******************************************************************      05
00519  2300-BUYER-BREAK.                                                RVKRP005
00520                                                                   RVKRP005
00190      MOVE  PA-DR-RA-BUYER-QTY        TO  TL-DEBIT-AND-RETURN-TOT.       05
00190      MOVE  PA-DR-PERM-RA-BUYER-QTY   TO  TL-PERM-RA-TOT.                05
00190      MOVE  PA-DD-BUYER-QTY           TO  TL-DEBIT-AND-DISPOSE-TOT.      05
00190      MOVE  PA-MO-BUYER-QTY           TO  TL-MARK-OUT-OF-STOCK-TOT.      05
           MOVE 'BUYER TOTALS: '           TO  TL-TOTAL-DESCRIPTION.            
                                                                                
           PERFORM 8100-WRITE-TOTAL-LINE.                                       
                                                                                
           MOVE 'PA-DR-RA-DMM-QTY'         TO PV-FIELD-NAME.                    
           COMPUTE PA-DR-RA-DMM-QTY   =                                         
                 ( PA-DR-RA-DMM-QTY   + PA-DR-RA-BUYER-QTY)                     
           ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                           
                                                                                
           MOVE 'PA-DR-PERM-RA-DMM-QTY'    TO PV-FIELD-NAME.                    
           COMPUTE PA-DR-PERM-RA-DMM-QTY =                                      
                 ( PA-DR-PERM-RA-DMM-QTY + PA-DR-PERM-RA-BUYER-QTY)             
           ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                           
                                                                                
           MOVE 'PA-DD-DMM-QTY'    TO PV-FIELD-NAME.                            
           COMPUTE PA-DD-DMM-QTY =                                              
                 ( PA-DD-DMM-QTY + PA-DD-BUYER-QTY)                             
           ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                           
                                                                                
           MOVE 'PA-MO-DMM-QTY'    TO PV-FIELD-NAME.                            
           COMPUTE PA-MO-DMM-QTY =                                              
                 ( PA-MO-DMM-QTY + PA-MO-BUYER-QTY)                             
           ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                           
                                                                                
00502      MOVE PC-MAX-REPORT-LINES        TO PV-LINE-COUNT.            RVKRP005
                                                                                
00192      INITIALIZE PA-BUYER-TOTALS.                                        05
                                                                                
           MOVE RV003-BUYER-NAME           TO PV-HOLD-BUYER-NAME                
00092                                         PH6-BUYER-NAME.                 05
           MOVE RV003-BUYER-NBR            TO PV-HOLD-BUYER-NBR                 
00095                                         PH6-BUYER-NBR.                  05
                                                                                
00519      PERFORM 2200-VENDOR-BREAK.                                         05
                                                                                
00520                                                                   RVKRP005
00514 ******************************************************************RVKRP005
00515 * 2400-DMM-BREAK.                                                 RVKRP005
00516 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC NEEDED FOR A    RVKRP005
00516 *           BREAK IN DMM NUMBER                                   RVKRP005
      *           1. CALL BUYER BREAK TO PRINT BUYER TOTALS                     
      *           2. PRINT DMM TOTALS                                           
      *           3. INITIALIZE DMM VARIABLES FOR NEXT DMM                      
00518 ******************************************************************RVKRP005
00519  2400-DMM-BREAK.                                                  RVKRP005
00520                                                                   RVKRP005
00519      PERFORM 2300-BUYER-BREAK.                                          05
                                                                                
00190      MOVE  PA-DR-RA-DMM-QTY          TO  TL-DEBIT-AND-RETURN-TOT.       05
00190      MOVE  PA-DR-PERM-RA-DMM-QTY     TO  TL-PERM-RA-TOT.                05
00190      MOVE  PA-DD-DMM-QTY             TO  TL-DEBIT-AND-DISPOSE-TOT.      05
00190      MOVE  PA-MO-DMM-QTY             TO  TL-MARK-OUT-OF-STOCK-TOT.      05
           MOVE 'DMM TOTALS: '             TO  TL-TOTAL-DESCRIPTION.            
                                                                                
           PERFORM 8100-WRITE-TOTAL-LINE.                                       
                                                                                
           MOVE 'PA-DR-RA-GMM-QTY'         TO PV-FIELD-NAME.                    
           COMPUTE PA-DR-RA-GMM-QTY   =                                         
                 ( PA-DR-RA-GMM-QTY   + PA-DR-RA-DMM-QTY)                       
           ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                           
                                                                                
           MOVE 'PA-DR-PERM-RA-GMM-QTY'    TO PV-FIELD-NAME.                    
           COMPUTE PA-DR-PERM-RA-GMM-QTY =                                      
                 ( PA-DR-PERM-RA-GMM-QTY + PA-DR-PERM-RA-DMM-QTY)               
           ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                           
                                                                                
           MOVE 'PA-DD-GMM-QTY'    TO PV-FIELD-NAME.                            
           COMPUTE PA-DD-GMM-QTY =                                              
                 ( PA-DD-GMM-QTY + PA-DD-DMM-QTY)                               
           ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                           
                                                                                
           MOVE 'PA-MO-GMM-QTY'    TO PV-FIELD-NAME.                            
           COMPUTE PA-MO-GMM-QTY =                                              
                 ( PA-MO-GMM-QTY + PA-MO-DMM-QTY)                               
           ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                           
                                                                                
00192      INITIALIZE PA-DMM-TOTALS.                                          05
                                                                                
00502      MOVE PC-MAX-REPORT-LINES        TO PV-LINE-COUNT.            RVKRP005
                                                                                
           MOVE RV003-DMM-NAME             TO PV-HOLD-DMM-NAME                  
00092                                         PH5-DMM-NAME.                   05
           MOVE RV003-DMM-NBR              TO PV-HOLD-DMM-NBR                   
00095                                         PH5-DMM-NBR.                    05
                                                                                
00520                                                                   RVKRP005
00514 ******************************************************************RVKRP005
00515 * 2500-GMM-BREAK.                                                 RVKRP005
00516 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC NEEDED FOR A    RVKRP005
00516 *           BREAK IN GMM NUMBER                                   RVKRP005
00518 ******************************************************************RVKRP005
00519  2500-GMM-BREAK.                                                        05
00520                                                                   RVKRP005
00519      PERFORM 2400-DMM-BREAK.                                            05
00520                                                                   RVKRP005
00190      MOVE  PA-DR-RA-GMM-QTY          TO  TL-DEBIT-AND-RETURN-TOT.       05
00190      MOVE  PA-DR-PERM-RA-GMM-QTY     TO  TL-PERM-RA-TOT.                05
00190      MOVE  PA-DD-GMM-QTY             TO  TL-DEBIT-AND-DISPOSE-TOT.      05
00190      MOVE  PA-MO-GMM-QTY             TO  TL-MARK-OUT-OF-STOCK-TOT.      05
           MOVE 'GMM TOTALS: '             TO  TL-TOTAL-DESCRIPTION.            
                                                                                
           PERFORM 8100-WRITE-TOTAL-LINE.                                       
                                                                                
           MOVE 'PA-DR-RA-GRAND-QTY'       TO PV-FIELD-NAME.                    
           COMPUTE PA-DR-RA-GRAND-QTY =                                         
                 ( PA-DR-RA-GRAND-QTY + PA-DR-RA-GMM-QTY)                       
           ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                           
                                                                                
           MOVE 'PA-DR-PERM-RA-GRAND-QTY'  TO PV-FIELD-NAME.                    
           COMPUTE PA-DR-PERM-RA-GRAND-QTY =                                    
                 ( PA-DR-PERM-RA-GRAND-QTY + PA-DR-PERM-RA-GMM-QTY)             
           ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                           
                                                                                
           MOVE 'PA-DD-GRAND-QTY'  TO PV-FIELD-NAME.                            
           COMPUTE PA-DD-GRAND-QTY =                                            
                 ( PA-DD-GRAND-QTY + PA-DD-GMM-QTY)                             
           ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                           
                                                                                
           MOVE 'PA-MO-GRAND-QTY'  TO PV-FIELD-NAME.                            
           COMPUTE PA-MO-GRAND-QTY =                                            
                 ( PA-MO-GRAND-QTY + PA-MO-GMM-QTY)                             
           ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                           
                                                                                
00192      INITIALIZE PA-GMM-TOTALS.                                          05
                                                                                
00502      MOVE PC-MAX-REPORT-LINES        TO PV-LINE-COUNT.            RVKRP005
                                                                                
           MOVE RV003-GMM-NAME             TO PV-HOLD-GMM-NAME                  
00092                                         PH4-GMM-NAME.                   05
           MOVE RV003-GMM-NBR              TO PV-HOLD-GMM-NBR                   
00095                                         PH4-GMM-NBR.                    05
00685 *                                                                 RVKRP005
00686 ******************************************************************RVKRP005
00687 * 7000-READ-EXTRACT-FILE.                                        *RVKRP005
00688 *  THIS PROCEDURE WILL READ ONE EXTRACT RECORD FROM THE EXTRACT  *RVKRP005
00689 *  FLAT FILE.                                                    *RVKRP005
00690 ******************************************************************RVKRP005
00691  7000-READ-EXTRACT-FILE.                                          RVKRP005
00692 *                                                                 RVKRP005
00693      READ RTV-REPORT-EXTRACT                                      RVKRP005
00011          INTO RV003-EXTRACT-RECORD                                      0 
00695          AT END SET PS-END-OF-EXTRACT-FILE TO TRUE.               RVKRP005
00696                                                                   RVKRP005
00697 ******************************************************************RVKRP005
00698 * 8000-PRINT-REPORT-LINE - CHECKS IF THE PAGE SIZE HAS BEEN EX-   RVKRP005
00699 * CEEDED.  IF SO, THE HEADING LINES ARE WRITTEN AND THE LINE COUNTRVKRP005
00700 * INITIALIZED.  THE DETAIL LINE IS THEN WRITTEN.                  RVKRP005
00701 ******************************************************************RVKRP005
00702  8000-PRINT-REPORT-LINE.                                          RVKRP005
00703                                                                   RVKRP005
00704      ADD +1 TO PV-LINE-COUNT.                                     RVKRP005
00705                                                                   RVKRP005
00706      IF PV-LINE-COUNT >= PC-MAX-REPORT-LINES                      RVKRP005
00707          PERFORM 8300-WRITE-PAGE-HEADING                          RVKRP005
00708          PERFORM 8400-WRITE-COLUMN-HEADING                        RVKRP005
               MOVE PV-HOLD-VND-NAME        TO DL-VND-NAME                      
00525          MOVE PV-HOLD-RANK            TO DL-RANK                        05
00709      END-IF.                                                      RVKRP005
00726                                                                   RVKRP005
00727      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP005
00728          FROM DL-DETAIL-LINE                                      RVKRP005
00729          AFTER ADVANCING 1 LINES.                                 RVKRP005
00730                                                                   RVKRP005
00731 *8000-EXIT.                                                       RVKRP005
00732                                                                   RVKRP005
00803                                                                   RVKRP005
00804 ******************************************************************RVKRP005
00805 * 8100-WRITE-TOTAL-LINE - PRINTS A TOTAL LINE TO THE REPORT.      RVKRP005
00806 ******************************************************************RVKRP005
00807  8100-WRITE-TOTAL-LINE.                                           RVKRP005
                                                                                
00789      WRITE DI-DEFECT-ITEM-LINE                                          05
00790          FROM TL-TOTAL-LINE-DASHES                                      05
00791          AFTER ADVANCING 0 LINES.                                       05
                                                                                
00793      WRITE DI-DEFECT-ITEM-LINE                                          05
00794          FROM TL-TOTAL-LINE                                             05
00795          AFTER ADVANCING 1 LINES.                                       05
                                                                                
00704      ADD +1 TO PV-LINE-COUNT.                                           05
                                                                                
00807      PERFORM 8200-WRITE-BLANK-LINE.                                     05
                                                                                
00803                                                                   RVKRP005
00804 ******************************************************************RVKRP005
00805 * 8200-WRITE-BLANK-LINE - WRITES A BLANK LINE TO THE REPORT.      RVKRP005
00806 ******************************************************************RVKRP005
00807  8200-WRITE-BLANK-LINE.                                           RVKRP005
00808                                                                   RVKRP005
00809      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP005
00810          FROM BLANK-LINE                                          RVKRP005
00811          AFTER ADVANCING 1 LINES.                                 RVKRP005
00812                                                                   RVKRP005
00813      ADD +1                        TO PV-LINE-COUNT.              RVKRP005
00814                                                                   RVKRP005
00815                                                                   RVKRP005
00816 *8200-EXIT.                                                       RVKRP005
00817 ******************************************************************RVKRP005
00818 * 8300-WRITE-PAGE-HEADING - WRITE THE PAGE AND DETAIL HEADINGS FORRVKRP005
00819 * THE DEFECTIVE ITEM REPORT.                                      RVKRP005
00820 ******************************************************************RVKRP005
00821  8300-WRITE-PAGE-HEADING.                                         RVKRP005
00822                                                                   RVKRP005
00823      ADD +1 TO PV-PAGE-COUNT.                                     RVKRP005
00824      MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    RVKRP005
00825                                                                   RVKRP005
00826      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP005
00827          FROM DP132O-STANDRD-HEADER-132-COLS                      RVKRP005
00828          AFTER ADVANCING PAGE.                                    RVKRP005
00829                                                                   RVKRP005
00831      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP005
00832          FROM PH2-PAGE-HEADING                                    RVKRP005
00833          AFTER ADVANCING 1 LINES.                                 RVKRP005
00839                                                                   RVKRP005
00840      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP005
00841          FROM PH4-GMM-PAGE-HEADING-4                              RVKRP005
00842          AFTER ADVANCING 1 LINES.                                 RVKRP005
00839                                                                   RVKRP005
00840      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP005
00841          FROM PH5-DMM-PAGE-HEADING-5                              RVKRP005
00842          AFTER ADVANCING 1 LINES.                                 RVKRP005
00843                                                                   RVKRP005
00840      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP005
00841          FROM PH6-BUYER-PAGE-HEADING-6                            RVKRP005
00842          AFTER ADVANCING 1 LINES.                                 RVKRP005
00843                                                                   RVKRP005
00850      MOVE +6     TO PV-LINE-COUNT.                                RVKRP005
00853                                                                   RVKRP005
00854 *8300-EXIT.                                                       RVKRP005
00855                                                                   RVKRP005
00856 ******************************************************************RVKRP005
00857 * 8400-WRITE-COLUMN-HEADING - WRITE THE COLUMN HEADINGS FOR       RVKRP005
00858 * THE DEFECTIVE ITEM REPORT.                                      RVKRP005
00859 ******************************************************************RVKRP005
00860  8400-WRITE-COLUMN-HEADING.                                       RVKRP005
00861                                                                   RVKRP005
00862      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP005
00863          FROM DH1-DETAIL-HEADING                                  RVKRP005
00864          AFTER ADVANCING 2 LINES.                                 RVKRP005
00865                                                                   RVKRP005
00866      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP005
00867          FROM DH2-DETAIL-HEADING                                  RVKRP005
00868          AFTER ADVANCING 1 LINES.                                 RVKRP005
00869                                                                   RVKRP005
00870      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP005
00871          FROM DHD-DETAIL-HEADING-DASHES                           RVKRP005
00872          AFTER ADVANCING 0 LINES.                                 RVKRP005
00873                                                                   RVKRP005
00874      ADD +3       TO PV-LINE-COUNT.                               RVKRP005
00875 *8400-EXIT.                                                       RVKRP005
00876                                                                   RVKRP005
00877 ******************************************************************RVKRP005
00878 * 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER  RVKRP005
00879 * CURSOR AND THE REPORT FILE.                                     RVKRP005
00880 ******************************************************************RVKRP005
00881  9000-EOJ-ROUTINE.                                                RVKRP005
00882                                                                   RVKRP005
           PERFORM 2500-GMM-BREAK.                                              
00520                                                                   RVKRP005
00190      MOVE  PA-DR-RA-GRAND-QTY        TO  TL-DEBIT-AND-RETURN-TOT.       05
00190      MOVE  PA-DR-PERM-RA-GRAND-QTY   TO  TL-PERM-RA-TOT.                05
00190      MOVE  PA-DD-GRAND-QTY           TO  TL-DEBIT-AND-DISPOSE-TOT.      05
00190      MOVE  PA-MO-GRAND-QTY           TO  TL-MARK-OUT-OF-STOCK-TOT.      05
           MOVE 'GRAND TOTALS: '           TO  TL-TOTAL-DESCRIPTION.            
                                                                                
           PERFORM 8100-WRITE-TOTAL-LINE.                                       
                                                                                
00889      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP005
00890          FROM END-OF-REPORT-LINE                                  RVKRP005
00891          AFTER ADVANCING 1 LINES.                                 RVKRP005
00892                                                                   RVKRP005
00893      CLOSE DI-DEFECT-ITEM-REPORT                                  RVKRP005
00894            RTV-REPORT-EXTRACT.                                    RVKRP005
00895                                                                   RVKRP005
02835 ******************************************************************RVKRP002
02836 * 9100-OVERFLOW-ERROR - IF ON OF THE ACCUMULATOR FIELDS           RVKRP002
      * ROLLS OVER (IE THE NUMBER IS TOO BIG TO FIT) THIS PARAGRAPH     RVKRP002
      * WILL ABEND THE PROGRAM                                          RVKRP002
02838 ******************************************************************RVKRP002
02839  9100-OVERFLOW-ERROR.                                             RVKRP002
02840      DISPLAY '** ABEND     **'.                                   RVKRP002
02841      DISPLAY '** PROGRAM   ** = RVKRP015'.                        RVKRP002
02842      DISPLAY '** PROGRAM ACCUMULATOR OVERFLOW ERROR **'.          RVKRP002
02843      DISPLAY '** THE DATA CREATES A TOTALS VALUE LARGER THAN '.   RVKRP002
02843      DISPLAY '** THE FIELD SET-UP TO HANDLE IT.  INCREASE THE'.   RVKRP002
           DISPLAY '** THE FOLLOWING FIELD WAS TOO SMALL: '.                    
           DISPLAY PV-FIELD-NAME.                                               
02854      MOVE +4004 TO ABEND-CODE.                                    RVKRP002
02855      CALL 'ILBOABN0' USING ABEND-CODE.                            RVKRP002
00896 ******************************************************************RVKRP005
00897 **************************** END OF RVKRP015 *********************RVKRP005
00898 ******************************************************************RVKRP005
