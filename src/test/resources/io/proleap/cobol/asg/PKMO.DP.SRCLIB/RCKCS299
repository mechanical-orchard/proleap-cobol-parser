000100 IDENTIFICATION DIVISION.                                         00010005
000200 PROGRAM-ID.    RCKCS299.                                         00020005
000300 AUTHOR.        DENNIS STEFFEN.                                   00030005
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040005
000500 DATE-WRITTEN.  JULY  1998.                                       00050005
000600 DATE-COMPILED.                                                   00060005
000700                                                                  00070005
000800*---------------------------------------------------------------* 00080005
000900*    E299 - SUSPENDED VERIFICATION LIST                           00090005
001000*                                                                 00100005
001100*    THIS PROGRAM GENERATES A LIST RECEIVERS THAT WERE UNABLE TO  00110005
001200*    BE AUTOMATICALLY VERIFIED.  IT SHOWS THE NUMBER OF LINES THAT00120005
001300*    ARE SUSPENDED, THE NUMBER OF LINES THAT ARE READY TO BE      00130005
001400*    VERIFIED, THE NUMBER OF LINES THAT ARE ALREADY VERIFIED, AND 00140005
001500*    THE TOTAL NUMBER OF LINES FOR THE RECEIVER.  FROM THIS SCREEN00150005
001600*    A USER CAN GO TO THE LINE LEVEL SCREEN TO ATTEMPT TO VERIFY  00160005
001700*    THE LINE.                                                    00170005
001800*---------------------------------------------------------------* 00180005
001810* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00181022
001820* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00182023
001830* MAKING THE CALL DYNAMIC VS STATIC.                              00183023
001840*---------------------------------------------------------------* 00184023
001900                                                                  00190005
002000 ENVIRONMENT DIVISION.                                            00200005
002100 DATA DIVISION.                                                   00210005
002200/                                                                 00220005
002300 WORKING-STORAGE SECTION.                                         00230005
002400                                                                  00240005
002500 01  DK-DB2-KEYS.                                                 00250005
002600     05  DK-OPER-UNT-ID               PIC S9(04) COMP.            00260005
002700     05  DK-FCLTY-ID                  PIC S9(04) COMP.            00270005
002800     05  DK-PO-NBR                    PIC S9(09) COMP.            00280005
002900     05  DK-REC-SEQ-NBR               PIC S9(09) COMP.            00290005
003000     05  DK-PO-LNE-NBR                PIC S9(09) COMP.            00300005
003100     05  DK-TRIP-ID                   PIC S9(09) COMP.            00310011
003200                                                                  00320011
003300 01  DN-NULL-INDICATORS.                                          00330011
003400     05  DN-VEH-NBR                 PIC S9(04) COMP VALUE ZEROES. 00340011
003500                                                                  00350011
003600                                                                  00360011
003700 01  PC-PROGRAM-CONSTANTS.                                        00370011
003800     05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE            00380011
003900                                                    'RC299A  '.   00390011
004000     05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE            00400011
004100                                                    'RCKM299 '.   00410011
004200     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE            00420011
004300                                                    'RCKCS299'.   00430011
004400     05  PC-RCKUT124                  PIC X(08)  VALUE            00440011
004500                                                    'RCKUT124'.   00450011
004600     05  PC-LIST-QUEUE-SEQ            PIC 9(01)  VALUE 1.         00460011
004700     05  PC-SEL-QUEUE-SEQ             PIC 9(01)  VALUE 2.         00470011
004800     05  PC-INTER-APPL-CODES.                                     00480011
004900         10  PC-INTER-APPL-CRIT-SPEC                              00490011
005000                                  PIC  X(01)  VALUE '1'.          00500011
005100         10  PC-INTER-APPL-LIST   PIC  X(01)  VALUE '2'.          00510011
005200     05  PC-ITEMS-PER-PANEL           PIC S9(04)  VALUE +12       00520011
005300                                                    COMP SYNC.    00530011
005400     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(04)  VALUE +2        00540011
005500                                                    COMP SYNC.    00550011
005600     05  PC-MAX-ITEMS                 PIC S9(09)  VALUE           00560011
005700                                                    +1000000      00570011
005800                                                    COMP-3.       00580011
005900     05  PC-MSG-NUMBER-LENGTH         PIC S9(04)  VALUE +7        00590011
006000                                                    COMP SYNC.    00600011
006100     05  PC-INQ                       PIC X(03)  VALUE 'INQ'.     00610011
006200     05  PC-UPD                       PIC X(03)  VALUE 'UPD'.     00620011
006300     05  PC-DEL                       PIC X(03)  VALUE 'DEL'.     00630011
006400     05  PC-ERR                       PIC X(03)  VALUE 'ERR'.     00640011
006500     05  PC-SPACES                    PIC  X(22)  VALUE SPACES.   00650011
006600     05  PC-DEFAULT-TMST              PIC  X(26)  VALUE           00660011
006700         '9999-09-09-09.09.09.999999'.                            00670011
006800                                                                  00680011
006900*----------------------------------------------------------------*00690011
007000*  SYSTEM MESSAGES                                               *00700011
007100*----------------------------------------------------------------*00710011
007200*   00005 = INVALID VALUE                                         00720011
007300*   00008 = MUST BE NUMERIC                                       00730011
007400*   00050 = NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED   00740011
007500*   00051 = NO END OF RANGE HAS BEEN SPECIFIED                    00750011
007600*   00052 = END OF RANGE PRECEDES START OF RANGE                  00760011
007700*   00053 = NO START OF RANGE HAS BEEN SPECIFIED                  00770011
007800*   00054 = ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED    00780011
007900*   00055 = ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED      00790011
008000*   00057 = A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION        00800011
008100*   00069 = TOP OF LIST                                           00810011
008200*   00070 = BOTTOM OF LIST                                        00820011
008300*   00101 = VALUE MUST BE GREATER THAN ZERO AND LESS THAN 1,000,0000830011
008400*   00279 = MORE ITEMS TO DISPLAY                                 00840011
008500*   00551 = WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL 00850011
008600*   01692 = ONE STORE ZONE MUST BE SELECTED                       00860011
008700*   03305 = TRLR MAINT ONLY VALID IF TRLR NOT ARRIVED             00870011
008800*   99901 = INVALID COMMAND WAS ENTERED                           00880011
008900*----------------------------------------------------------------*00890011
009000     05  PC-TSYMSG-NUMBERS.                                       00900011
009100         10  PC-TSYMSG-00005          PIC 9(05)  VALUE 00005.     00910011
009200         10  PC-TSYMSG-00008          PIC 9(05)  VALUE 00008.     00920011
009300         10  PC-TSYMSG-00050          PIC 9(05)  VALUE 00050.     00930011
009400         10  PC-TSYMSG-00051          PIC 9(05)  VALUE 00051.     00940011
009500         10  PC-TSYMSG-00052          PIC 9(05)  VALUE 00052.     00950011
009600         10  PC-TSYMSG-00053          PIC 9(05)  VALUE 00053.     00960011
009700         10  PC-TSYMSG-00054          PIC 9(05)  VALUE 00054.     00970011
009800         10  PC-TSYMSG-00055          PIC 9(05)  VALUE 00055.     00980011
009900         10  PC-TSYMSG-00057          PIC 9(05)  VALUE 00057.     00990011
010000         10  PC-TSYMSG-00069          PIC 9(05)  VALUE 00069.     01000011
010100         10  PC-TSYMSG-00070          PIC 9(05)  VALUE 00070.     01010011
010200         10  PC-TSYMSG-00101          PIC 9(05)  VALUE 00101.     01020011
010300         10  PC-TSYMSG-00148          PIC 9(05)  VALUE 00148.     01030011
010400         10  PC-TSYMSG-00279          PIC 9(05)  VALUE 00279.     01040011
010500         10  PC-TSYMSG-00302          PIC 9(05)  VALUE 00302.     01050011
010600         10  PC-TSYMSG-00551          PIC 9(05)  VALUE 00551.     01060011
010700         10  PC-TSYMSG-00984          PIC 9(05)  VALUE 00984.     01070011
010800         10  PC-TSYMSG-01692          PIC 9(05)  VALUE 01692.     01080011
010900         10  PC-TSYMSG-03138          PIC 9(05)  VALUE 03138.     01090011
011000         10  PC-TSYMSG-03305          PIC 9(05)  VALUE 03305.     01100011
011100         10  PC-TSYMSG-99901          PIC 9(05)  VALUE 99901.     01110011
011200                                                                  01120011
011300 01  PS-PROGRAM-SWITCHES.                                         01130011
011400     05  PS-ERROR-SW                  PIC X(01)  VALUE 'Y'.       01140011
011500         88  PS-NO-ERROR                         VALUE 'Y'.       01150011
011600         88  PS-ERROR                            VALUE 'N'.       01160011
011700     05  PS-DTL-ERROR-SW              PIC X(01)  VALUE 'N'.       01170011
011800         88  PS-NO-DTL-ERROR                     VALUE 'N'.       01180011
011900         88  PS-DTL-ERROR                        VALUE 'Y'.       01190011
012000     05  PS-COMMAREA-SW               PIC X(01)  VALUE 'N'.       01200011
012100         88  PS-COMMAREA-VALID                   VALUE 'Y'.       01210011
012200         88  PS-COMMAREA-NOT-VALID               VALUE 'N'.       01220011
012300     05  PS-NEXT-SCREEN-SW            PIC X(01)  VALUE 'N'.       01230011
012400         88  PS-NO-NEXT-SCREEN                   VALUE 'N'.       01240011
012500         88  PS-NEXT-SCREEN                      VALUE 'Y'.       01250011
012600     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01260011
012700         88  PS-LIST-END                            VALUE  'Y'.   01270011
012800         88  PS-NO-LIST-END                         VALUE  'N'.   01280011
012900     05  PS-TWKORIN-CSR-SW            PIC X(01) VALUE 'N'.        01290011
013000         88  PS-EOF-TWKORIN-CSR                 VALUE 'Y'.        01300011
013100         88  PS-NOT-EOF-TWKORIN-CSR             VALUE 'N'.        01310011
013200     05  PS-TWKORIN-ZERO-CSR-SW       PIC X(01) VALUE 'N'.        01320011
013300         88  PS-EOF-TWKORIN-ZERO-CSR            VALUE 'Y'.        01330011
013400         88  PS-NOT-EOF-TWKORIN-ZERO-CSR        VALUE 'N'.        01340011
013500                                                                  01350011
013600*    IF ANY UNVERIFIED LINES ARE FOUND THEN THE RECIEVER IS SHOWN 01360011
013700     05  PS-SHOW-RCVR-SW              PIC X(01) VALUE 'N'.        01370011
013800         88  PS-SHOW-RCVR-YES                   VALUE 'Y'.        01380011
013900         88  PS-SHOW-RCVR-NO                    VALUE 'N'.        01390011
014000                                                                  01400011
014100                                                                  01410011
014200*  RECEIVER LEVEL SWITCHES                                        01420011
014300 01  PS-RECEIVER-ERROR-SWITCHES.                                  01430011
014400                                                                  01440011
014500     05  PS-OPEN-SYSTEM-AUDIT-ERROR-SW                            01450011
014600                                      PIC X(01)  VALUE 'N'.       01460011
014700         88  PS-OPEN-SYSTEM-AUDIT-ERROR          VALUE 'Y'.       01470011
014800     05  PS-OPEN-AUDIT-SUSPND-CNFRM-SW                            01480011
014900                                      PIC X(01)  VALUE 'N'.       01490011
015000         88  PS-OPEN-AUDIT-SUSPND-CNFRM          VALUE 'Y'.       01500011
015100     05  PS-DISTRO-NO-MATCH-ERROR-SW  PIC X(01)  VALUE 'N'.       01510011
015200         88  PS-DISTRO-NO-MATCH-ERROR            VALUE 'Y'.       01520011
015300     05  PS-NO-PRO-ERROR-SW           PIC X(01)  VALUE 'N'.       01530011
015400         88  PS-NO-PRO-ERROR                     VALUE 'Y'.       01540011
015500     05  PS-STORE-INVENTORY-ERROR-SW  PIC X(01)  VALUE 'N'.       01550011
015600         88  PS-STORE-INVENTORY-ERROR            VALUE 'Y'.       01560011
015700     05  PS-RCVR-NOT-ACTIVE-ERROR-SW  PIC X(01)  VALUE 'N'.       01570011
015800         88  PS-RCVR-NOT-ACTIVE-ERROR            VALUE 'Y'.       01580011
015900     05  PS-RCVR-NOT-FOUND-SW         PIC X(01)  VALUE 'N'.       01590011
016000         88  PS-RCVR-NOT-FOUND-ERROR             VALUE 'Y'.       01600011
016100     05  PS-LINE-NOT-FOUND-SW         PIC X(01)  VALUE 'N'.       01610011
016200         88  PS-LINE-NOT-FOUND-ERROR             VALUE 'Y'.       01620011
016300     05  PS-NOT-ARRIVED-ERROR-SW      PIC X(01)  VALUE 'N'.       01630011
016400         88  PS-NOT-ARRIVED-ERROR                VALUE 'Y'.       01640011
016500     05  PS-RCVR-ALREADY-VE-ERROR-SW  PIC X(01)  VALUE 'N'.       01650011
016600         88  PS-RCVR-ALREADY-VE-ERROR            VALUE 'Y'.       01660011
016700     05  PS-RCVR-TROUBLE-SUSP-CNFRM-SW PIC X(01) VALUE 'N'.       01670011
016800         88  PS-RCVR-TROUBLE-SUSP-CNFRM          VALUE 'Y'.       01680011
016900     05  PS-LINE-TROUBLE-SUSP-CNFRM-SW PIC X(01) VALUE 'N'.       01690011
017000         88  PS-LINE-TROUBLE-SUSP-CNFRM          VALUE 'Y'.       01700011
017100     05  PS-RCVR-IN-TROUBLE-ERROR-SW  PIC X(01)  VALUE 'N'.       01710011
017200         88  PS-RCVR-IN-TROUBLE-ERROR            VALUE 'Y'.       01720011
017300     05  PS-LINE-ALREADY-VE-ERROR-SW  PIC X(01)  VALUE 'N'.       01730011
017400         88  PS-LINE-ALREADY-VE-ERROR            VALUE 'Y'.       01740011
017500     05  PS-LINE-IN-TROUBLE-ERROR-SW  PIC X(01)  VALUE 'N'.       01750011
017600         88  PS-LINE-IN-TROUBLE-ERROR            VALUE 'Y'.       01760011
017700     05  PS-LINE-NOT-VE-ERROR-SW      PIC X(01)  VALUE 'N'.       01770011
017800         88  PS-LINE-NOT-VE-ERROR                VALUE 'Y'.       01780011
017900     05  PS-CASEPK-NOT-PERF-ERROR-SW  PIC X(01)  VALUE 'N'.       01790011
018000         88  PS-CASEPK-NOT-PERF-ERROR            VALUE 'Y'.       01800011
018100     05  PS-P2L-PRCG-INCOMP-ERROR-SW  PIC X(01)  VALUE 'N'.       01810011
018200         88  PS-P2L-PRCG-INCOMP-ERROR            VALUE 'Y'.       01820011
018300     05  PS-CONFIRM-NEEDED-ERROR-SW   PIC X(01)  VALUE 'N'.       01830011
018400         88  PS-CONFIRM-NEEDED-ERROR             VALUE 'Y'.       01840011
018500     05  PS-NOT-MULT-OF-RATIO-ERROR-SW PIC X(01)  VALUE 'N'.      01850011
018600         88  PS-NOT-MULT-OF-RATIO-ERROR          VALUE 'Y'.       01860011
018700     05  PS-CARTON-NOT-MNFSTD-ERROR-SW PIC X(01)  VALUE 'N'.      01870011
018800         88  PS-CARTON-NOT-MNFSTD-ERROR          VALUE 'Y'.       01880011
018900                                                                  01890011
019000 01  PV-PROGRAM-VARIABLES.                                        01900011
019100     05  PV-NULL1                     PIC S9(04)  COMP            01910011
019200                                                  VALUE ZERO.     01920011
019300     05  PV-NULL2                     PIC S9(04)  COMP            01930011
019400                                                  VALUE ZERO.     01940011
019500     05  PV-SUB                       PIC S9(04)  VALUE ZERO      01950011
019600                                                    COMP SYNC.    01960011
019700     05  PV-REMAINDER                 PIC S9(04)  VALUE ZERO      01970011
019800                                                    COMP SYNC.    01980011
019900     05  PV-READ-COUNT                PIC S9(09)  VALUE ZERO      01990011
020000                                                    COMP-3.       02000011
020100     05  PV-ITEMS-PROCESSED           PIC S9(09)  VALUE ZERO      02010011
020200                                                    COMP-3.       02020011
020300     05  PV-HOLD-SELECTED-ITEMS       PIC S9(09)  VALUE ZERO      02030011
020400                                                    COMP-3.       02040011
020500     05  PV-ITEM-IN-USE               PIC S9(09)  VALUE ZERO      02050011
020600                                                    COMP-3.       02060011
020700     05  PV-TOP-ITEM                  PIC S9(09)  VALUE ZERO      02070011
020800                                                    COMP-3.       02080011
020900     05  PV-BOTTOM-ITEM               PIC S9(09)  VALUE ZERO      02090011
021000                                                    COMP-3.       02100011
021100     05  PV-BLOCK-NUMBER              PIC S9(04)  VALUE ZERO      02110011
021200                                                    COMP SYNC.    02120011
021300     05  PV-CICS-RESP                 PIC S9(04)  VALUE ZERO      02130011
021400                                                    COMP SYNC.    02140011
021500     05  PV-ITEM                      PIC S9(04)  VALUE ZERO      02150011
021600                                                    COMP SYNC.    02160011
021700     05  PV-SEL-QUEUE-ITEM            PIC S9(04)  VALUE ZERO      02170011
021800                                                    COMP SYNC.    02180011
021900     05  PV-SAVE-ITEM                 PIC S9(04)  VALUE ZERO      02190011
022000                                                    COMP SYNC.    02200011
022100     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(04)  VALUE ZERO      02210011
022200                                                    COMP SYNC.    02220011
022300     05  PV-LIST-ITEM-NUMBER          PIC S9(04)  VALUE ZERO      02230011
022400                                                    COMP SYNC.    02240011
022500     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(04)  VALUE ZERO      02250011
022600                                                    COMP SYNC.    02260011
022700     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(04)  VALUE ZERO      02270011
022800                                                    COMP SYNC.    02280011
022900     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(04)  VALUE ZERO      02290011
023000                                                    COMP SYNC.    02300011
023100     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(04)  VALUE ZERO      02310011
023200                                                    COMP SYNC.    02320011
023300     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(04)  VALUE ZERO      02330011
023400                                                    COMP SYNC.    02340011
023500     05  PV-START-OF-SELECTED-RANGE   PIC S9(04)  VALUE ZERO      02350011
023600                                                    COMP SYNC.    02360011
023700     05  PV-END-OF-SELECTED-RANGE     PIC S9(04)  VALUE ZERO      02370011
023800                                                    COMP SYNC.    02380011
023900     05  PV-GLOBAL-INV-COUNT          PIC S9(09) VALUE ZERO       02390011
024000                                                    COMP SYNC.    02400011
024100     05  PV-VERIFIED-LINE-COUNT       PIC S9(09) VALUE ZERO       02410011
024200                                                    COMP SYNC.    02420011
024300     05  PV-TOTAL-LINE-COUNT          PIC S9(09) VALUE ZERO       02430011
024400                                                    COMP SYNC.    02440011
024500     05  PV-PRC-FCLTY-AREA-ID         PIC X(06) VALUE SPACES.     02450011
024600                                                                  02460011
024700     05  PV-STATUS-COUNTERS.                                      02470011
024800         10 PV-FREIGHT-COUNT          PIC S9(04) VALUE ZERO       02480011
024900                                                    COMP SYNC.    02490011
025000         10 PV-TROUBLE-COUNT          PIC S9(04) VALUE ZERO       02500011
025100                                                    COMP SYNC.    02510011
025200         10 PV-INVENTORY-COUNT        PIC S9(04) VALUE ZERO       02520011
025300                                                    COMP SYNC.    02530011
025400         10 PV-VERIFIED-COUNT         PIC S9(04) VALUE ZERO       02540011
025500                                                    COMP SYNC.    02550011
025600         10 PV-SUSPEND-COUNT          PIC S9(04) VALUE ZERO       02560011
025700                                                    COMP SYNC.    02570011
025800         10 PV-READY-COUNT            PIC S9(04) VALUE ZERO       02580011
025900                                                    COMP SYNC.    02590011
026000         10 PV-ERROR-COUNT            PIC S9(04) VALUE ZERO       02600011
026100                                                    COMP SYNC.    02610011
026200         10 PV-ROWS-FETCHED           PIC S9(07) VALUE ZERO       02620011
026300                                                    COMP SYNC.    02630011
026400     05  PV-CONTROL-COLUMNS.                                      02640011
026500         10  PV-SAVE-PO-NBR           PIC S9(9) VALUE ZERO        02650011
026600                                                    COMP SYNC.    02660011
026700         10  PV-SAVE-REC-SEQ-NBR      PIC S9(9) VALUE ZERO        02670011
026800                                                    COMP SYNC.    02680011
026900         10  PV-SAVE-PO-LNE-NBR       PIC S9(9) VALUE ZERO        02690011
027000                                                    COMP SYNC.    02700011
027100         10 PV-SAVE-ARRIVE-DTE        PIC X(08) VALUE SPACE.      02710011
027200     05  PV-SAVE-PKGNG-CDE            PIC X(01) VALUE SPACE.      02720011
027300     05  PV-SAVE-DEPT-NBR             PIC X(03) VALUE SPACE.      02730011
027400     05  PV-SAVE-PACK-BY-ST-IND       PIC X(01) VALUE SPACE.      02740011
027500     05  PV-ARRIVE-DTE                PIC X(08) VALUE SPACES.     02750011
027600     05  PV-ARRIVE-DATE               PIC X(08) VALUE SPACES.     02760011
027700     05  PV-MESSAGE-TEXT              PIC X(79) VALUE SPACES.     02770011
027800     05  PV-COMMAREA-LENGTH           PIC S9(04) VALUE ZERO       02780011
027900                                                    COMP SYNC.    02790011
028000     05  PV-CICS-MSG-AREA             PIC X(100) VALUE SPACE.     02800011
028100     05  PV-PO-RECEIVER.                                          02810011
028200         10  PV-PO-NBR                PIC  9(08).                 02820011
028300         10  FILLER                   PIC  X(01) VALUE SPACE.     02830011
028400         10  PV-REC-SEQ-NBR           PIC  9(04).                 02840011
028500                                                                  02850011
028600     05  PV-ERROR-MSG.                                            02860011
028700         10  FILLER                     PIC X(4) VALUE 'PO= '.    02870011
028800         10  PV-ERROR-PO                PIC Z(8)9.                02880011
028900         10  FILLER                     PIC X(6) VALUE ' RCVR='.  02890011
029000         10  PV-ERROR-SEQ               PIC Z(8)9.                02900011
029100         10  FILLER                     PIC X(6) VALUE ' OPER='.  02910011
029200         10  PV-ERROR-OPER-UNT-ID       PIC Z(3)9.                02920011
029300         10  FILLER                     PIC X(7) VALUE ' FCLTY='. 02930011
029400         10  PV-ERROR-FCLTY-ID          PIC Z(3)9.                02940011
029500                                                                  02950011
029600     05  PV-VEM-MSG.                                              02960011
029700         10  FILLER                     PIC X(4) VALUE 'PO= '.    02970011
029800         10  PV-VEM-PO                  PIC Z(8)9.                02980011
029900         10  FILLER                     PIC X(6) VALUE ' RCVR='.  02990011
030000         10  PV-VEM-SEQ                 PIC Z(8)9.                03000011
030100         10  FILLER                     PIC X(5) VALUE ' LNE='.   03010011
030200         10  PV-VEM-LINE-NBR            PIC Z(3)9.                03020011
030300         10  FILLER                     PIC X(7) VALUE ' PREPK='. 03030011
030400         10  PV-VEM-PREPK-ID            PIC Z(3)9.                03040011
030500         10  FILLER                     PIC X(6) VALUE ' OPER='.  03050011
030600         10  PV-VEM-OPER                PIC Z(3)9.                03060011
030700         10  FILLER                     PIC X(7) VALUE ' FCLTY='. 03070011
030800         10  PV-VEM-FCLTY-ID            PIC Z(3)9.                03080011
030900         10  FILLER                     PIC X(5) VALUE ' PKG='.   03090011
031000         10  PV-VEM-PKG-IND             PIC X(01).                03100011
031100         10  FILLER                     PIC X(5) VALUE ' PBS='.   03110011
031200         10  PV-VEM-PBS-IND             PIC X(01).                03120011
031300         10  FILLER                     PIC X(5) VALUE ' ERR='.   03130011
031400         10  PV-VEM-ERROR-CDE           PIC X(01).                03140011
031500                                                                  03150011
031600                                                                  03160011
031700*---------------------------------------------------------------* 03170011
031800*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 03180011
031900*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 03190011
032000*   APPLICATION-SPECIFIC COMMAREA.                              * 03200011
032100*---------------------------------------------------------------* 03210011
032200 01  LQW-LIST-QUEUE-WORK-AREA.                                    03220011
032300     05  LQW-BLOCK-MODIFIED           PIC X(01)   VALUE SPACE.    03230011
032400     05  LQW-ITEM-ENTRIES               OCCURS 12 TIMES           03240011
032500                                        INDEXED BY LQW-IDX.       03250011
032600         10  LQW-LIST-ITEM-NUMBER     PIC S9(09)  COMP-3.         03260011
032700         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  03270011
032800         10  LQW-SELECTED-SW          PIC X(01).                  03280011
032900             88  LQW-SELECT                         VALUE 'S'.    03290011
033000             88  LQW-DESELECT                       VALUE ' '.    03300011
033100         10  LQW-ACTION               PIC X(03).                  03310011
033200             88  LQW-NULL-ACTION                    VALUE SPACES. 03320011
033300             88  LQW-ERROR                          VALUE 'ERR'.  03330011
033400             88  LQW-INQUIRE                        VALUE 'INQ'.  03340011
033500             88  LQW-UPDATE                         VALUE 'UPD'.  03350011
033600         10  LQW-AREA                 PIC X(06).                  03360011
033700         10  LQW-PO-RCVR.                                         03370011
033800** CHG0094517  CHANGED PO-NBR LENGTH TO 8 FROM 7                  03380020
033900             15  LQW-PO-NBR           PIC 9(8).                   03390023
034000             15  LQW-DASH             PIC X(01).                  03400011
034100             15  LQW-REC-SEQ-NBR      PIC 9(4).                   03410011
034200         10  LQW-DEPT                 PIC 9(03).                  03420011
034300         10  LQW-VENDNAME             PIC X(15).                  03430011
034400         10  LQW-PKG                  PIC X(01).                  03440011
034500         10  LQW-ARRIVE-DTE           PIC X(08).                  03450011
034600         10  LQW-STATUS               PIC X(12).                  03460011
034700         10  LQW-SUSPEND-COUNT        PIC 9(9).                   03470011
034800         10  LQW-TRIP-ID              PIC S9(09) COMP.            03480011
034900         10  LQW-SCAC-ID              PIC  X(04).                 03490011
035000         10  LQW-VEH-NBR              PIC  X(10).                 03500011
035100         10  LQW-TRIP-STAT-CDE        PIC  X(02).                 03510011
035200         10  LQW-ARRIVED-ST           PIC  X(01).                 03520011
035300             88 LQW-TRIP-NOT-ARRIVED       VALUE 'N'.             03530011
035400/                                                                 03540011
035500*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 03550011
035600     COPY RCWS013.                                                03560011
035700                                                                  03570011
035800*    SELECT QUEUE FOR RCKCS816                                    03580011
035900     COPY RCWS817.                                                03590011
036000                                                                  03600011
036100*    SELECT QUEUE FOR SUKCS589 AUDIT LIST                         03610011
036200     COPY SUWS025.                                                03620011
036300                                                                  03630011
036400*    SELECT QUEUE FOR SUKCS555 CARTON LIST                        03640011
036500*    ADDED DMH 7/13/04                                            03650011
036600     COPY SUWS004.                                                03660011
036700                                                                  03670011
036800*    SELECT QUEUE FOR TRKCS111 TRAILER UPDATE                     03680011
036900*    ADDED DMH 7/13/04                                            03690011
037000     COPY TRWS006.                                                03700011
037100                                                                  03710011
037200*    MAP LAYOUT                                                 * 03720011
037300     COPY RCKM299.                                                03730011
037400                                                                  03740011
037500 01  MR-OCCURS-LAYOUT                   REDEFINES  RC299AO.       03750011
037600     02  MR-HEADER-INFO.                                          03760011
037700     05  FILLER                       PIC X(12).                  03770011
037800                                                                  03780011
037900     05  MR-OPERL                     PIC S9(04) COMP.            03790011
038000     05  MR-OPERA                     PIC X(01).                  03800011
038100     05  MR-OPERC                     PIC X(01).                  03810011
038200     05  MR-OPERH                     PIC X(01).                  03820011
038300     05  MR-OPER                      PIC X(04).                  03830011
038400                                                                  03840011
038500     05  MR-LOC-NML                   PIC S9(04) COMP.            03850011
038600     05  MR-LOC-NMA                   PIC X(01).                  03860011
038700     05  MR-LOC-NMC                   PIC X(01).                  03870011
038800     05  MR-LOC-NM-H                  PIC X(01).                  03880011
038900     05  MR-LOC-NM                    PIC X(30).                  03890011
039000                                                                  03900011
039100     05  FILLER                       PIC X(30).                  03910011
039200                                                                  03920011
039300     05  MR-SEQ-MSGL                  PIC S9(04) COMP.            03930011
039400     05  MR-SEQ-MSGA                  PIC X(01).                  03940011
039500     05  MR-SEQ-MSGC                  PIC X(01).                  03950011
039600     05  MR-SEQ-MSG-H                 PIC X(01).                  03960011
039700     05  MR-SEQ-MSG                   PIC X(24).                  03970011
039800         88  MR-PO-SEQUENCE           VALUE                       03980011
039900                                     'PO/RCVR SEQUENCE      '.    03990011
040000         88  MR-ARRIVAL-SEQUENCE      VALUE                       04000011
040100                                     'ARRIVAL DATE SEQUENCE '.    04010011
040200                                                                  04020011
040300     02  MR-DETAIL-LINES.                                         04030011
040400     05  MR-SCROLL-AREA                 OCCURS 12 TIMES.          04040011
040500         10  MR-SELECTL               PIC S9(04) COMP.            04050011
040600         10  MR-SELECTA               PIC X(01).                  04060011
040700         10  MR-SELECTC               PIC X(01).                  04070011
040800         10  MR-SELECTH               PIC X(01).                  04080011
040900         10  MR-SELECT                PIC X(01).                  04090011
041000                                                                  04100011
041100         10  MR-ACTIONL               PIC S9(04) COMP.            04110011
041200         10  MR-ACTIONA               PIC X(01).                  04120011
041300         10  MR-ACTIONC               PIC X(01).                  04130011
041400         10  MR-ACTIONH               PIC X(01).                  04140011
041500         10  MR-ACTION                PIC X(03).                  04150011
041600                                                                  04160011
041700         10  MR-AREAL                 PIC S9(04) COMP.            04170011
041800         10  MR-AREAA                 PIC X(01).                  04180011
041900         10  MR-AREAC                 PIC X(01).                  04190011
042000         10  MR-AREAH                 PIC X(01).                  04200011
042100         10  MR-AREA                  PIC X(06).                  04210011
042200                                                                  04220011
042300         10  MR-PO-RCVR-L             PIC S9(04) COMP.            04230011
042400         10  MR-PO-RCVR-A             PIC X(01).                  04240011
042500         10  MR-PO-RCVR-C             PIC X(01).                  04250011
042600         10  MR-PO-RCVR-H             PIC X(01).                  04260011
042700         10  MR-PO-RCVR.                                          04270011
042800             15  MR-PO-NBR-X.                                     04280011
042900** CHG0094517  CHANGED PO-NBR LENGTH TO 8 FROM 7                  04290020
043000                 20 MR-PO-NBR         PIC 9(8).                   04300020
043100             15  MR-DASH              PIC X(01).                  04310011
043200             15  MR-REC-SEQ-NBR-X.                                04320011
043300                 20 MR-REC-SEQ-NBR    PIC 9(4).                   04330011
043400                                                                  04340011
043500         10  MR-DEPTL                 PIC S9(04) COMP.            04350011
043600         10  MR-DEPTA                 PIC X(01).                  04360011
043700         10  MR-DEPTC                 PIC X(01).                  04370011
043800         10  MR-DEPTH                 PIC X(01).                  04380011
043900         10  MR-DEPT-X.                                           04390011
044000             15 MR-DEPT               PIC 9(03).                  04400011
044100                                                                  04410011
044200         10  MR-VENDNAMEL             PIC S9(04) COMP.            04420011
044300         10  MR-VENDNAMEA             PIC X(01).                  04430011
044400         10  MR-VENDNAMEC             PIC X(01).                  04440011
044500         10  MR-VENDNAMEH             PIC X(01).                  04450011
044600** CHG0094517  CHANGED VENDNAME LENGTH TO 14 FROM 15              04460021
044700         10  MR-VENDNAME              PIC X(14).                  04470021
044800                                                                  04480011
044900         10  MR-PKGL                  PIC S9(04) COMP.            04490011
045000         10  MR-PKGA                  PIC X(01).                  04500011
045100         10  MR-PKGC                  PIC X(01).                  04510011
045200         10  MR-PKGH                  PIC X(01).                  04520011
045300         10  MR-PKG                   PIC X(01).                  04530011
045400                                                                  04540011
045500         10  MR-ARRIVE-DTEL           PIC S9(04) COMP.            04550011
045600         10  MR-ARRIVE-DTEA           PIC X(01).                  04560011
045700         10  MR-ARRIVE-DTEC           PIC X(01).                  04570011
045800         10  MR-ARRIVE-DTEH           PIC X(01).                  04580011
045900         10  MR-ARRIVE-DTE            PIC X(08).                  04590011
046000                                                                  04600011
046100         10  MR-STATUSL               PIC S9(04) COMP.            04610011
046200         10  MR-STATUSA               PIC X(01).                  04620011
046300         10  MR-STATUSC               PIC X(01).                  04630011
046400         10  MR-STATUSH               PIC X(01).                  04640011
046500         10  MR-STATUS                PIC X(12).                  04650011
046600                                                                  04660011
046700         10  MR-SUSPEND-COUNTL        PIC S9(04) COMP.            04670011
046800         10  MR-SUSPEND-COUNTA        PIC X(01).                  04680011
046900         10  MR-SUSPEND-COUNTC        PIC X(01).                  04690011
047000         10  MR-SUSPEND-COUNTH        PIC X(01).                  04700011
047100         10  MR-SUSPEND-COUNT-X.                                  04710011
047200             15 MR-SUSPEND-COUNT      PIC ZZZ9.                   04720011
047300/                                                                 04730011
047400     COPY DPWS015.                                                04740011
047500/                                                                 04750011
047600     COPY DPWS016.                                                04760011
047700/                                                                 04770011
047800     COPY DPWS010I.                                               04780011
047900/                                                                 04790011
047910******************************************************************04791023
047920** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **04792023
047930** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **04793023
047940******************************************************************04794023
048000     COPY DPWS030.                                                04800011
048010     COPY DPWS930.                                                04801023
048100/                                                                 04810011
048200*---------------------------------------------------------------* 04820011
048300*    STANDARD COMMAREA.                                         * 04830011
048400*---------------------------------------------------------------* 04840011
048500     COPY DPWS020.                                                04850011
048600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04860011
048700                                                                  04870011
048800*---------------------------------------------------------------* 04880011
048900* INTER-APPLICATION COMMAREA.                                   * 04890011
049000*   CNWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04900011
049100*             SPEC SCREEN.                                      * 04910011
049200*   CNWS003 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04920011
049300*             THIS LIST PROGRAM FOR A LOCAL-GO FUNCTION.        * 04930011
049400*---------------------------------------------------------------* 04940011
049500                                                                  04950011
049600         10  INTER-APPL-COMM-AREA     PIC X(200).                 04960011
049700     COPY RCWS015.                                                04970011
049800     COPY SUWS024.                                                04980011
049900     COPY RCWS815.                                                04990011
050000     COPY SUWS003.                                                05000011
050100     COPY TRWS007.                                                05010011
050200*---------------------------------------------------------------* 05020011
050300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05030011
050400*---------------------------------------------------------------* 05040011
050500         10  ASC-SPECIFIC-COMMAREA.                               05050011
050600             15  ASC-LIST-KEYS.                                   05060011
050700*  THESE ARE THE KEYS PASSED FROM THE CRIT SPEC SCREEN            05070011
050800                 20  ASC-KEY-OPER-UNT-ID                          05080011
050900                                      PIC S9(04) COMP.            05090011
051000                 20  ASC-KEY-FCLTY-ID                             05100011
051100                                      PIC S9(04) COMP.            05110011
051200                 20  ASC-KEY-PO-NBR                               05120011
051300                                      PIC S9(08) COMP.            05130011
051400                 20  ASC-KEY-REC-SEQ-NBR                          05140011
051500                                      PIC S9(08) COMP.            05150011
051600                 20  ASC-KEY-TRIP-ID                              05160011
051700                                      PIC S9(09) COMP.            05170011
051800             15  ASC-BLOCK-ENTRIES      OCCURS 2 TIMES.           05180005
051900                 20  ASC-BLOCK-MODIFIED-SW                        05190011
052000                                      PIC  X(01).                 05200011
052100                     88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     05210011
052200                     88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     05220011
052300                                                                  05230011
052400                 20  ASC-ITEM-ARRAY.                              05240011
052500                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        05250011
052600                         30  ASC-LIST-ITEM-NUMBER                 05260011
052700                                      PIC S9(09) COMP-3.          05270011
052800                         30  ASC-TEMP-SELECTED-SW                 05280011
052900                                      PIC X(01).                  05290011
053000                             88  ASC-VALID-SELECT  VALUE ' '      05300011
053100                                                         'S'      05310011
053200                                                         'B'      05320011
053300                                                         'E'.     05330011
053400                             88  ASC-TEMP-NO-SELECT               05340011
053500                                                   VALUE ' '.     05350011
053600                             88  ASC-TEMP-SELECT   VALUE 'S'.     05360011
053700                             88  ASC-TEMP-BEGIN    VALUE 'B'.     05370011
053800                             88  ASC-TEMP-END      VALUE 'E'.     05380011
053900                         30  ASC-SELECTED-SW                      05390011
054000                                      PIC X(01).                  05400011
054100                             88  ASC-NO-SELECT     VALUE ' '.     05410011
054200                             88  ASC-SELECT        VALUE 'S'.     05420011
054300                             88  ASC-BEGIN         VALUE 'B'.     05430011
054400                             88  ASC-END           VALUE 'E'.     05440011
054500                         30  ASC-ACTION          PIC X(03).       05450011
054600                         30  ASC-AREA         PIC X(06).          05460011
054700                         30  ASC-PO-RCVR.                         05470011
054800** CHG0094517  CHANGED PO-NBR LENGTH TO 8 FROM 7                  05480020
054900                             35  ASC-PO-NBR           PIC 9(8).   05490020
055000                             35  ASC-DASH             PIC X(01).  05500011
055100                             35  ASC-REC-SEQ-NBR      PIC 9(4).   05510011
055200                         30  ASC-DEPT.                            05520011
055300                             35  ASC-DEPT-N   PIC 999.            05530011
055400                         30  ASC-VENDNAME     PIC X(15).          05540011
055500                         30  ASC-PKG          PIC X(01).          05550011
055600                         30  ASC-ARRIVE-DTE   PIC X(08).          05560011
055700                         30  ASC-STATUS       PIC X(12).          05570011
055800                         30  ASC-SUSPEND-COUNT PIC 9(9).          05580011
055900                         30  ASC-TRIP-ID       PIC S9(09) COMP.   05590011
056000                         30  ASC-SCAC-ID       PIC  X(04).        05600011
056100                         30  ASC-VEH-NBR       PIC  X(10).        05610011
056200                         30  ASC-TRIP-STAT-CDE PIC  X(02).        05620011
056300                         30  ASC-ARRIVED-ST    PIC  X(01).        05630011
056400                             88 ASC-TRIP-NOT-ARRIVED  VALUE 'N'.  05640011
056500                             88 ASC-TRIP-ARRIVED      VALUE 'Y'.  05650011
056600                                                                  05660011
056700             15  ASC-BLK-SUB          PIC S9(04) COMP SYNC.       05670011
056800             15  ASC-ITEM-SUB         PIC S9(04) COMP SYNC.       05680011
056900             15  ASC-NUMBER-OF-ITEMS-READ                         05690011
057000                                      PIC S9(09) COMP-3.          05700011
057100             15  ASC-NUMBER-OF-SELECTED-ITEMS                     05710011
057200                                      PIC S9(09) COMP-3.          05720011
057300             15  ASC-ITEMS-DISPLAYED  PIC S9(03) COMP-3.          05730011
057400             15  ASC-ITEM-AT-TOP-OF-PANEL                         05740011
057500                                      PIC S9(09) COMP-3.          05750011
057600             15  ASC-ITEM-AT-BOT-OF-PANEL                         05760011
057700                                      PIC S9(09) COMP-3.          05770011
057800             15  ASC-HIGHEST-BLOCK-WRITTEN                        05780011
057900                                      PIC S9(04) COMP SYNC.       05790011
058000             15  ASC-START-OF-SELECTED-RANGE                      05800011
058100                                      PIC S9(09) COMP-3.          05810011
058200             15  ASC-END-OF-SELECTED-RANGE                        05820011
058300                                      PIC S9(09) COMP-3.          05830011
058400             15  ASC-ITEMS-LEFT-INDICATOR                         05840011
058500                                      PIC X(01).                  05850011
058600                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05860011
058700                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05870011
058800             15  ASC-TEMP-QUEUE-UPDATE-SW                         05880011
058900                                      PIC X(01).                  05890011
059000                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05900011
059100                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05910011
059200             15  ASC-LIST-QUEUE-NAME.                             05920011
059300                 20  ASC-LIST-TERM-ID PIC X(04).                  05930011
059400                 20  ASC-LIST-TASK-NUMBER                         05940011
059500                                      PIC S9(05) COMP-3.          05950011
059600                 20  ASC-LIST-SEQ     PIC 9(01).                  05960011
059700             15  ASC-SEL-QUEUE-NAME.                              05970011
059800                 20  ASC-SEL-TERM-ID  PIC X(04).                  05980011
059900                 20  ASC-SEL-TASK-NUMBER                          05990011
060000                                      PIC S9(05) COMP-3.          06000011
060100                 20  ASC-SEL-SEQ      PIC 9(01).                  06010011
060200                                                                  06020011
060300             15  ASC-SEL-QUEUE-NAME-IN.                           06030011
060400                 20  ASC-SEL-TERM-ID-IN  PIC X(04).               06040011
060500                 20  ASC-SEL-TASK-NUMBER-IN                       06050011
060600                                      PIC S9(05) COMP-3.          06060011
060700                 20  ASC-SEL-SEQ-IN      PIC 9(01).               06070011
060800                                                                  06080011
060900             15  ASC-USE-SELECTION-QUEUE-IND                      06090011
061000                                           PIC  X(01).            06100011
061100                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 06110011
061200             15  ASC-START-ITEM-REQUEST.                          06120011
061300                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  06130011
061400             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    06140011
061500             15  ASC-SEL-SUB               PIC S9(04)  COMP.      06150011
061600             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      06160011
061700             15  ASC-LOC-NM           PIC X(40).                  06170011
061800*    SET ACCORDING TO THE KEYS PASSED FROM THE CRIT SPEC          06180011
061900             15 ASC-CSR-SW            PIC X(01).                  06190011
062000                 88  ASC-OPER-CSR                 VALUE 'O'.      06200011
062100                 88  ASC-PO-CSR                   VALUE 'P'.      06210011
062200                 88  ASC-RCVR-CSR                 VALUE 'R'.      06220011
062300                 88  ASC-TRIP-CSR                 VALUE 'T'.      06230011
062400             15 ASC-SEQ-SW            PIC X(01).                  06240011
062500                 88  ASC-PO-SEQ                   VALUE 'P', ' '. 06250011
062600                 88  ASC-ARRIVAL-SEQ              VALUE 'A'.      06260011
062700*  THIS SWITCH IS SET ON BEFORE LEAVING FOR SUKCS589              06270011
062800             15  ASC-FUNC04-RETURN-FLAG       PIC  X(1).          06280011
062900                 88  ASC-FUNC04-RETURN-NO   VALUE 'N'.            06290011
063000                 88  ASC-FUNC04-RETURN-YES  VALUE 'Y'.            06300011
063100*  THIS SWITCH IS SET ON BEFORE LEAVING FOR RCKCS816              06310011
063200             15  ASC-FUNC06-RETURN-FLAG       PIC  X(1).          06320011
063300                 88  ASC-FUNC06-RETURN-NO   VALUE 'N'.            06330011
063400                 88  ASC-FUNC06-RETURN-YES  VALUE 'Y'.            06340011
063500*  THIS SWITCH IS SET ON BEFORE LEAVING FOR SUKCS555              06350011
063600             15  ASC-FUNC08-RETURN-FLAG       PIC  X(1).          06360011
063700                 88  ASC-FUNC08-RETURN-NO   VALUE 'N'.            06370011
063800                 88  ASC-FUNC08-RETURN-YES  VALUE 'Y'.            06380011
063900*  THIS SWITCH IS SET ON BEFORE LEAVING FOR TRKCS112              06390011
064000             15  ASC-FUNC09-RETURN-FLAG       PIC  X(1).          06400011
064100                 88  ASC-FUNC09-RETURN-NO   VALUE 'N'.            06410011
064200                 88  ASC-FUNC09-RETURN-YES  VALUE 'Y'.            06420011
064300*  THIS SWITCH IS SET IN 4000-BUILD-INITIAL-PANEL BY RCKUT127     06430011
064400             15  ASC-AUTO-VE-SW                  PIC X(01).       06440011
064500                 88  ASC-AUTO-VE-YES                VALUE 'Y'.    06450011
064600                 88  ASC-AUTO-VE-NO                 VALUE 'N'.    06460011
064700                                                                  06470011
064800/                                                                 06480011
064900     COPY DPWS013.                                                06490011
065000/                                                                 06500011
065100*    COMMAREA FOR VEM                                             06510011
065200     COPY RCWS038.                                                06520011
065300/                                                                 06530011
065400***************************************************************** 06540011
065500*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 06550011
065600*             AUTOVERIFY (AUTOVE) MODULE (RCKUT127).            * 06560011
065700***************************************************************** 06570011
065800     COPY RCWS040.                                                06580011
065900/                                                                 06590005
066000     EXEC SQL                                                     06600011
066100          INCLUDE TDISTHD                                         06610011
066200     END-EXEC.                                                    06620011
066300/                                                                 06630011
066400*    XLT_LOC                                                      06640011
066500     EXEC SQL                                                     06650011
066600          INCLUDE XLT00010                                        06660011
066700     END-EXEC.                                                    06670011
066800/                                                                 06680011
066900     EXEC SQL                                                     06690011
067000          INCLUDE TENTNME                                         06700011
067100     END-EXEC.                                                    06710011
067200/                                                                 06720011
067300     EXEC SQL                                                     06730011
067400          INCLUDE TEXTENT                                         06740011
067500     END-EXEC.                                                    06750011
067600/                                                                 06760011
067700     EXEC SQL                                                     06770011
067800          INCLUDE TPURCHS                                         06780011
067900     END-EXEC.                                                    06790011
068000/                                                                 06800011
068100     EXEC SQL                                                     06810011
068200          INCLUDE TRECEIV                                         06820011
068300     END-EXEC.                                                    06830011
068400/                                                                 06840011
068500     EXEC SQL                                                     06850011
068600          INCLUDE TSHPTPO                                         06860011
068700     END-EXEC.                                                    06870011
068800/                                                                 06880011
068900     EXEC SQL                                                     06890011
069000          INCLUDE TSHIPMT                                         06900011
069100     END-EXEC.                                                    06910011
069200/                                                                 06920011
069300     EXEC SQL                                                     06930011
069400          INCLUDE TRECITM                                         06940011
069500     END-EXEC.                                                    06950011
069600/                                                                 06960011
069700     EXEC SQL                                                     06970011
069800          INCLUDE TWKORIN                                         06980011
069900     END-EXEC.                                                    06990011
070000/                                                                 07000011
070100     EXEC SQL                                                     07010011
070200          INCLUDE TVHTRIP                                         07020011
070300     END-EXEC.                                                    07030011
070400/                                                                 07040011
070500     EXEC SQL                                                     07050011
070600          INCLUDE TTRIPST                                         07060011
070700     END-EXEC.                                                    07070011
070800/                                                                 07080011
070900     EXEC SQL                                                     07090011
071000          INCLUDE TTRSTYP                                         07100011
071100     END-EXEC.                                                    07110011
071200/                                                                 07120011
071300     EXEC SQL                                                     07130011
071400          INCLUDE SQLCA                                           07140011
071500     END-EXEC.                                                    07150011
071600                                                                  07160011
071700/                                                                 07170011
071800*---------------------------------------------------------------* 07180011
071900*    DRIVING CURSORS                                              07190011
072000*---------------------------------------------------------------* 07200011
072100                                                                  07210011
072200     EXEC SQL                                                     07220011
072300          DECLARE SUSPEND1-CSR CURSOR FOR                         07230011
072400           SELECT                                                 07240011
072500                  A.ORD_NBR                                       07250011
072600                , A.RCVR_SEQ_NBR                                  07260011
072700                , A.ORD_LNE_NBR                                   07270011
072800                , A.PRCG_STAT_CDE                                 07280011
072900                , A.RSLTS_RCVD_TMST                               07290011
073000                , A.FCSE_CNFRMN_TMST                              07300011
073100                                                                  07310011
073200              ,   CASE                                            07320011
073300                  WHEN                                            07330011
073400                  (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)   07340011
073500                  ||                                              07350011
073600                  SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))   07360011
073700                          = '09/09/99'                            07370011
073800                  THEN 'ENROUTE '                                 07380011
073900                  ELSE                                            07390011
074000                  (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)   07400011
074100                  ||                                              07410011
074200                  SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))   07420011
074300                  END AS USA                                      07430011
074400                                                                  07440011
074500             ,   CASE                                             07450011
074600                 WHEN                                             07460011
074700                  RCV.REC_TMST = '9999-09-09-09.09.09.999999'     07470011
074800                 THEN                                             07480011
074900                     '0001-01-01-01.01.01.000000'                 07490011
075000                 ELSE                                             07500011
075100                      RCV.REC_TMST                                07510011
075200                 END  AS TMST                                     07520011
075300                                                                  07530011
075400                , RCV.PKGNG_CDE                                   07540011
075500                , PACK_BY_ST_IND                                  07550011
075600                , PO.DEPT_NBR                                     07560011
075700                , A.P2L_CART_CNT                                  07570016
075800                                                                  07580017
075900             FROM TDISTHD A                                       07590017
076000             ,    TRECEIV RCV                                     07600017
076100             ,    TPURCHS PO                                      07610017
076200            WHERE A.OPER_UNT_ID    = :DK-OPER-UNT-ID              07620017
076300                                                                  07630017
076400*             AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D', 'B')    07640017
076500              AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D')         07650017
076600                                                                  07660017
076700              AND RCV.FCLTY_ID             = 1                    07670017
076800              AND RCV.VER_STATUS_CDE       = 'A'                  07680017
076900                                                                  07690017
077000              AND A.ORD_NBR                = RCV.ORD_NBR          07700017
077100              AND A.RCVR_SEQ_NBR           = RCV.REC_SEQ_NBR      07710017
077200                                                                  07720017
077300              AND A.ORD_NBR                = PO.PO_NBR            07730017
077400              AND PO.VER_STATUS_CDE        = 'A'                  07740017
077500                                                                  07750017
077600                                                                  07760017
077700              ORDER BY A.ORD_NBR                                  07770017
077800                 ,     A.RCVR_SEQ_NBR                             07780017
077900                 ,     A.ORD_LNE_NBR                              07790017
078000                                                                  07800017
078100     END-EXEC.                                                    07810017
078200                                                                  07820017
078300     EXEC SQL                                                     07830017
078400          DECLARE SUSPEND1-DATE-CSR CURSOR FOR                    07840017
078500           SELECT                                                 07850017
078600                  A.ORD_NBR                                       07860017
078700                , A.RCVR_SEQ_NBR                                  07870017
078800                , A.ORD_LNE_NBR                                   07880017
078900                , A.PRCG_STAT_CDE                                 07890017
079000                , A.RSLTS_RCVD_TMST                               07900017
079100                , A.FCSE_CNFRMN_TMST                              07910017
079200                                                                  07920017
079300                                                                  07930017
079400              ,   CASE                                            07940017
079500                  WHEN                                            07950017
079600                  (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)   07960017
079700                  ||                                              07970017
079800                  SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))   07980017
079900                          = '09/09/99'                            07990017
080000                  THEN 'ENROUTE '                                 08000017
080100                  ELSE                                            08010017
080200                  (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)   08020017
080300                  ||                                              08030017
080400                  SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))   08040017
080500                  END AS USA                                      08050017
080600                                                                  08060017
080700             ,   CASE                                             08070017
080800                 WHEN                                             08080017
080900                  RCV.REC_TMST = '9999-09-09-09.09.09.999999'     08090017
081000                 THEN                                             08100017
081100                     '0001-01-01-01.01.01.000000'                 08110017
081200                 ELSE                                             08120017
081300                      RCV.REC_TMST                                08130017
081400                 END  AS TMST                                     08140017
081500                                                                  08150017
081600                , RCV.PKGNG_CDE                                   08160017
081700                , PACK_BY_ST_IND                                  08170017
081800                , PO.DEPT_NBR                                     08180017
081900                , A.P2L_CART_CNT                                  08190017
082000                                                                  08200017
082100             FROM TDISTHD A                                       08210017
082200             ,    TRECEIV RCV                                     08220017
082300             ,    TPURCHS PO                                      08230017
082400            WHERE A.OPER_UNT_ID    = :DK-OPER-UNT-ID              08240017
082500                                                                  08250017
082600*             AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D', 'B')    08260017
082700              AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D')         08270017
082800                                                                  08280017
082900              AND RCV.FCLTY_ID             = 1                    08290017
083000              AND RCV.VER_STATUS_CDE       = 'A'                  08300017
083100                                                                  08310017
083200              AND A.ORD_NBR                = RCV.ORD_NBR          08320017
083300              AND A.RCVR_SEQ_NBR           = RCV.REC_SEQ_NBR      08330017
083400                                                                  08340017
083500              AND A.ORD_NBR                = PO.PO_NBR            08350017
083600              AND PO.VER_STATUS_CDE        = 'A'                  08360017
083700                                                                  08370017
083800              ORDER BY                                            08380017
083900                       TMST                                       08390017
084000                 ,     A.ORD_NBR                                  08400017
084100                 ,     A.RCVR_SEQ_NBR                             08410017
084200                 ,     A.ORD_LNE_NBR                              08420017
084300                                                                  08430017
084400     END-EXEC.                                                    08440017
084500                                                                  08450017
084600*    USE THIS IF PO IS ENTERED ON CRIT SPEC RCKCS296              08460017
084700     EXEC SQL                                                     08470017
084800          DECLARE SUSPEND2-CSR CURSOR FOR                         08480017
084900           SELECT DISTINCT                                        08490017
085000                  A.ORD_NBR                                       08500017
085100                , A.RCVR_SEQ_NBR                                  08510017
085200                , A.ORD_LNE_NBR                                   08520017
085300                , A.PRCG_STAT_CDE                                 08530017
085400                , A.RSLTS_RCVD_TMST                               08540017
085500                , A.FCSE_CNFRMN_TMST                              08550017
085600                                                                  08560017
085700              ,   CASE                                            08570017
085800                  WHEN                                            08580017
085900                  (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)   08590017
086000                  ||                                              08600017
086100                  SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))   08610017
086200                          = '09/09/99'                            08620017
086300                  THEN 'ENROUTE '                                 08630017
086400                  ELSE                                            08640017
086500                  (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)   08650017
086600                  ||                                              08660017
086700                  SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))   08670017
086800                  END AS USA                                      08680017
086900                                                                  08690017
087000             ,   CASE                                             08700017
087100                 WHEN                                             08710017
087200                  RCV.REC_TMST = '9999-09-09-09.09.09.999999'     08720017
087300                 THEN                                             08730017
087400                     '0001-01-01-01.01.01.000000'                 08740017
087500                 ELSE                                             08750017
087600                      RCV.REC_TMST                                08760017
087700                 END  AS TMST                                     08770017
087800                                                                  08780017
087900                , RCV.PKGNG_CDE                                   08790017
088000                , PACK_BY_ST_IND                                  08800017
088100                , PO.DEPT_NBR                                     08810017
088200                , A.P2L_CART_CNT                                  08820017
088300                                                                  08830017
088400             FROM TDISTHD A                                       08840017
088500             ,    TRECEIV RCV                                     08850017
088600             ,    TPURCHS PO                                      08860017
088700            WHERE A.OPER_UNT_ID    = :DK-OPER-UNT-ID              08870017
088800              AND A.ORD_NBR        = :DK-PO-NBR                   08880017
088900*             AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D', 'B')    08890017
089000              AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D')         08900017
089100                                                                  08910017
089200              AND RCV.FCLTY_ID             = 1                    08920017
089300              AND RCV.VER_STATUS_CDE       = 'A'                  08930017
089400                                                                  08940017
089500              AND A.ORD_NBR                = RCV.ORD_NBR          08950017
089600              AND A.RCVR_SEQ_NBR           = RCV.REC_SEQ_NBR      08960017
089700                                                                  08970017
089800              AND A.ORD_NBR                = PO.PO_NBR            08980017
089900              AND PO.VER_STATUS_CDE        = 'A'                  08990017
090000                                                                  09000017
090100              ORDER BY A.ORD_NBR                                  09010017
090200                 ,     A.RCVR_SEQ_NBR                             09020017
090300                 ,     A.ORD_LNE_NBR                              09030017
090400                                                                  09040017
090500     END-EXEC.                                                    09050017
090600                                                                  09060017
090700     EXEC SQL                                                     09070017
090800          DECLARE SUSPEND2-DATE-CSR CURSOR FOR                    09080017
090900           SELECT DISTINCT                                        09090017
091000                  A.ORD_NBR                                       09100017
091100                , A.RCVR_SEQ_NBR                                  09110017
091200                , A.ORD_LNE_NBR                                   09120017
091300                , A.PRCG_STAT_CDE                                 09130017
091400                , A.RSLTS_RCVD_TMST                               09140017
091500                , A.FCSE_CNFRMN_TMST                              09150017
091600                                                                  09160017
091700                                                                  09170017
091800              ,   CASE                                            09180017
091900                  WHEN                                            09190017
092000                  (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)   09200017
092100                  ||                                              09210017
092200                  SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))   09220017
092300                          = '09/09/99'                            09230017
092400                  THEN 'ENROUTE '                                 09240017
092500                  ELSE                                            09250017
092600                  (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)   09260017
092700                  ||                                              09270017
092800                  SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))   09280017
092900                  END AS USA                                      09290017
093000                                                                  09300017
093100             ,   CASE                                             09310017
093200                 WHEN                                             09320017
093300                  RCV.REC_TMST = '9999-09-09-09.09.09.999999'     09330017
093400                 THEN                                             09340017
093500                     '0001-01-01-01.01.01.000000'                 09350017
093600                 ELSE                                             09360017
093700                      RCV.REC_TMST                                09370017
093800                 END  AS TMST                                     09380017
093900                                                                  09390017
094000                , RCV.PKGNG_CDE                                   09400017
094100                , PACK_BY_ST_IND                                  09410017
094200                , PO.DEPT_NBR                                     09420017
094300                , A.P2L_CART_CNT                                  09430017
094400                                                                  09440017
094500             FROM TDISTHD A                                       09450017
094600             ,    TRECEIV RCV                                     09460017
094700             ,    TPURCHS PO                                      09470017
094800            WHERE A.OPER_UNT_ID    = :DK-OPER-UNT-ID              09480017
094900              AND A.ORD_NBR        = :DK-PO-NBR                   09490017
095000*             AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D', 'B')    09500017
095100              AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D')         09510017
095200                                                                  09520017
095300              AND RCV.FCLTY_ID             = 1                    09530017
095400              AND RCV.VER_STATUS_CDE       = 'A'                  09540017
095500                                                                  09550017
095600              AND A.ORD_NBR                = RCV.ORD_NBR          09560017
095700              AND A.RCVR_SEQ_NBR           = RCV.REC_SEQ_NBR      09570017
095800                                                                  09580017
095900              AND A.ORD_NBR                = PO.PO_NBR            09590017
096000              AND PO.VER_STATUS_CDE        = 'A'                  09600017
096100                                                                  09610017
096200              ORDER BY                                            09620017
096300                       TMST                                       09630017
096400                 ,     A.ORD_NBR                                  09640017
096500                 ,     A.RCVR_SEQ_NBR                             09650017
096600                 ,     A.ORD_LNE_NBR                              09660017
096700                                                                  09670017
096800     END-EXEC.                                                    09680017
096900                                                                  09690017
097000*    USE THIS IF PO AND RCVR ARE ENTERED ON CRIT SPEC RCKCS296    09700017
097100     EXEC SQL                                                     09710017
097200          DECLARE SUSPEND3-CSR CURSOR FOR                         09720017
097300           SELECT DISTINCT                                        09730017
097400                  A.ORD_NBR                                       09740017
097500                , A.RCVR_SEQ_NBR                                  09750017
097600                , A.ORD_LNE_NBR                                   09760017
097700                , A.PRCG_STAT_CDE                                 09770017
097800                , A.RSLTS_RCVD_TMST                               09780017
097900                , A.FCSE_CNFRMN_TMST                              09790017
098000                                                                  09800017
098100              ,   CASE                                            09810017
098200                  WHEN                                            09820017
098300                  (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)   09830017
098400                  ||                                              09840017
098500                  SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))   09850017
098600                          = '09/09/99'                            09860017
098700                  THEN 'ENROUTE '                                 09870017
098800                  ELSE                                            09880017
098900                  (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)   09890017
099000                  ||                                              09900017
099100                  SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))   09910017
099200                  END AS USA                                      09920017
099300                                                                  09930017
099400             ,   CASE                                             09940017
099500                 WHEN                                             09950017
099600                  RCV.REC_TMST = '9999-09-09-09.09.09.999999'     09960017
099700                 THEN                                             09970017
099800                     '0001-01-01-01.01.01.000000'                 09980017
099900                 ELSE                                             09990017
100000                      RCV.REC_TMST                                10000017
100100                 END  AS TMST                                     10010017
100200                                                                  10020017
100300                , RCV.PKGNG_CDE                                   10030017
100400                , PACK_BY_ST_IND                                  10040017
100500                , PO.DEPT_NBR                                     10050017
100600                , A.P2L_CART_CNT                                  10060017
100700                                                                  10070017
100800             FROM TDISTHD A                                       10080017
100900             ,    TRECEIV RCV                                     10090017
101000             ,    TPURCHS PO                                      10100017
101100            WHERE A.OPER_UNT_ID    = :DK-OPER-UNT-ID              10110017
101200              AND A.ORD_NBR        = :DK-PO-NBR                   10120017
101300              AND A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR              10130017
101400*             AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D', 'B')    10140017
101500              AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D')         10150017
101600                                                                  10160017
101700              AND RCV.FCLTY_ID             = 1                    10170017
101800              AND RCV.VER_STATUS_CDE       = 'A'                  10180017
101900                                                                  10190017
102000              AND A.ORD_NBR                = RCV.ORD_NBR          10200017
102100              AND A.RCVR_SEQ_NBR           = RCV.REC_SEQ_NBR      10210017
102200                                                                  10220017
102300              AND A.ORD_NBR                = PO.PO_NBR            10230017
102400              AND PO.VER_STATUS_CDE        = 'A'                  10240017
102500                                                                  10250017
102600              ORDER BY A.ORD_NBR                                  10260017
102700                 ,     A.RCVR_SEQ_NBR                             10270017
102800                 ,     A.ORD_LNE_NBR                              10280017
102900                                                                  10290017
103000     END-EXEC.                                                    10300017
103100                                                                  10310017
103200     EXEC SQL                                                     10320017
103300          DECLARE SUSPEND3-DATE-CSR CURSOR FOR                    10330017
103400           SELECT DISTINCT                                        10340017
103500                  A.ORD_NBR                                       10350017
103600                , A.RCVR_SEQ_NBR                                  10360017
103700                , A.ORD_LNE_NBR                                   10370017
103800                , A.PRCG_STAT_CDE                                 10380017
103900                , A.RSLTS_RCVD_TMST                               10390017
104000                , A.FCSE_CNFRMN_TMST                              10400017
104100                                                                  10410017
104200              ,   CASE                                            10420017
104300                  WHEN                                            10430017
104400                  (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)   10440017
104500                  ||                                              10450017
104600                  SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))   10460017
104700                          = '09/09/99'                            10470017
104800                  THEN 'ENROUTE '                                 10480017
104900                  ELSE                                            10490017
105000                  (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)   10500017
105100                  ||                                              10510017
105200                  SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))   10520017
105300                  END AS USA                                      10530017
105400                                                                  10540017
105500             ,   CASE                                             10550017
105600                 WHEN                                             10560017
105700                  RCV.REC_TMST = '9999-09-09-09.09.09.999999'     10570017
105800                 THEN                                             10580017
105900                     '0001-01-01-01.01.01.000000'                 10590017
106000                 ELSE                                             10600017
106100                      RCV.REC_TMST                                10610017
106200                 END  AS TMST                                     10620017
106300                                                                  10630017
106400                , RCV.PKGNG_CDE                                   10640017
106500                , PACK_BY_ST_IND                                  10650017
106600                , PO.DEPT_NBR                                     10660017
106700                , A.P2L_CART_CNT                                  10670017
106800                                                                  10680017
106900             FROM TDISTHD A                                       10690017
107000             ,    TRECEIV RCV                                     10700017
107100             ,    TPURCHS PO                                      10710017
107200            WHERE A.OPER_UNT_ID    = :DK-OPER-UNT-ID              10720017
107300              AND A.ORD_NBR        = :DK-PO-NBR                   10730017
107400              AND A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR              10740017
107500*             AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D', 'B')    10750017
107600              AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D')         10760017
107700                                                                  10770017
107800              AND RCV.FCLTY_ID             = 1                    10780017
107900              AND RCV.VER_STATUS_CDE       = 'A'                  10790017
108000                                                                  10800017
108100              AND A.ORD_NBR                = RCV.ORD_NBR          10810017
108200              AND A.RCVR_SEQ_NBR           = RCV.REC_SEQ_NBR      10820017
108300                                                                  10830017
108400              AND A.ORD_NBR                = PO.PO_NBR            10840017
108500              AND PO.VER_STATUS_CDE        = 'A'                  10850017
108600                                                                  10860017
108700              ORDER BY                                            10870017
108800                       TMST                                       10880017
108900                 ,     A.ORD_NBR                                  10890017
109000                 ,     A.RCVR_SEQ_NBR                             10900017
109100                 ,     A.ORD_LNE_NBR                              10910017
109200                                                                  10920017
109300     END-EXEC.                                                    10930017
109400                                                                  10940017
109500     EXEC SQL                                                     10950017
109600     DECLARE SUSPEND4-CSR CURSOR FOR                              10960017
109700     SELECT                                                       10970017
109800            A.ORD_NBR                                             10980017
109900          , A.RCVR_SEQ_NBR                                        10990017
110000          , A.ORD_LNE_NBR                                         11000017
110100          , A.PRCG_STAT_CDE                                       11010017
110200          , A.RSLTS_RCVD_TMST                                     11020017
110300          , A.FCSE_CNFRMN_TMST                                    11030017
110400                                                                  11040017
110500        ,   CASE                                                  11050017
110600            WHEN                                                  11060017
110700            (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)         11070017
110800            ||                                                    11080017
110900            SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))         11090017
111000                    = '09/09/99'                                  11100017
111100            THEN 'ENROUTE '                                       11110017
111200            ELSE                                                  11120017
111300            (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)         11130017
111400            ||                                                    11140017
111500            SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))         11150017
111600            END AS USA                                            11160017
111700                                                                  11170017
111800       ,   CASE                                                   11180017
111900           WHEN                                                   11190017
112000            RCV.REC_TMST = '9999-09-09-09.09.09.999999'           11200017
112100           THEN                                                   11210017
112200               '0001-01-01-01.01.01.000000'                       11220017
112300           ELSE                                                   11230017
112400                RCV.REC_TMST                                      11240017
112500           END  AS TMST                                           11250017
112600                                                                  11260017
112700          , RCV.PKGNG_CDE                                         11270017
112800          , PACK_BY_ST_IND                                        11280017
112900          , PO.DEPT_NBR                                           11290017
113000          , A.P2L_CART_CNT                                        11300017
113100                                                                  11310017
113200      FROM TVHTRIP TRP                                            11320017
113300      ,    TSHPTPO TPO                                            11330017
113400      ,    TSHIPMT SHP                                            11340017
113500      ,    TDISTHD A                                              11350017
113600       ,   TRECEIV RCV                                            11360017
113700       ,   TPURCHS PO                                             11370017
113800                                                                  11380017
113900      WHERE                                                       11390017
114000           TRP.TRIP_ID               = :DK-TRIP-ID                11400017
114100        AND SHP.TRIP_ID              = TRP.TRIP_ID                11410017
114200        AND SHP.SHIPT_ID             = TPO.SHIPT_ID               11420017
114300        AND TPO.PO_NBR               = RCV.ORD_NBR                11430017
114400        AND TPO.REC_SEQ_NBR          = RCV.REC_SEQ_NBR            11440017
114500        AND TPO.PRIM_SHIPT_IND       = 'Y'                        11450017
114600*       AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D', 'B')          11460017
114700        AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D')               11470017
114800                                                                  11480017
114900        AND RCV.FCLTY_ID             = 1                          11490017
115000        AND RCV.VER_STATUS_CDE       = 'A'                        11500017
115100                                                                  11510017
115200        AND A.ORD_NBR                = TPO.PO_NBR                 11520017
115300        AND A.ORD_NBR                = RCV.ORD_NBR                11530017
115400        AND A.RCVR_SEQ_NBR           = RCV.REC_SEQ_NBR            11540017
115500        AND A.ORD_NBR                = PO.PO_NBR                  11550017
115600        AND PO.VER_STATUS_CDE        = 'A'                        11560017
115700                                                                  11570017
115800        ORDER BY A.ORD_NBR                                        11580017
115900           ,     A.RCVR_SEQ_NBR                                   11590017
116000           ,     A.ORD_LNE_NBR                                    11600017
116100                                                                  11610017
116200      WITH UR                                                     11620017
116300     END-EXEC.                                                    11630017
116400                                                                  11640017
116500     EXEC SQL                                                     11650017
116600     DECLARE SUSPEND4-DATE-CSR CURSOR FOR                         11660017
116700     SELECT                                                       11670017
116800            A.ORD_NBR                                             11680017
116900          , A.RCVR_SEQ_NBR                                        11690017
117000          , A.ORD_LNE_NBR                                         11700017
117100          , A.PRCG_STAT_CDE                                       11710017
117200          , A.RSLTS_RCVD_TMST                                     11720017
117300          , A.FCSE_CNFRMN_TMST                                    11730017
117400                                                                  11740017
117500        ,   CASE                                                  11750017
117600            WHEN                                                  11760017
117700            (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)         11770017
117800            ||                                                    11780017
117900            SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))         11790017
118000                    = '09/09/99'                                  11800017
118100            THEN 'ENROUTE '                                       11810017
118200            ELSE                                                  11820017
118300            (SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),1,6)         11830017
118400            ||                                                    11840017
118500            SUBSTR (CHAR ( DATE (RCV.REC_TMST),USA),9,2))         11850017
118600            END AS USA                                            11860017
118700                                                                  11870017
118800       ,   CASE                                                   11880017
118900           WHEN                                                   11890017
119000            RCV.REC_TMST = '9999-09-09-09.09.09.999999'           11900017
119100           THEN                                                   11910017
119200               '0001-01-01-01.01.01.000000'                       11920017
119300           ELSE                                                   11930017
119400                RCV.REC_TMST                                      11940017
119500           END  AS TMST                                           11950017
119600                                                                  11960017
119700          , RCV.PKGNG_CDE                                         11970017
119800          , PACK_BY_ST_IND                                        11980017
119900          , PO.DEPT_NBR                                           11990017
120000          , A.P2L_CART_CNT                                        12000017
120100                                                                  12010017
120200      FROM TVHTRIP TRP                                            12020017
120300      ,    TSHPTPO TPO                                            12030017
120400      ,    TSHIPMT SHP                                            12040017
120500      ,    TDISTHD A                                              12050017
120600       ,   TRECEIV RCV                                            12060017
120700       ,   TPURCHS PO                                             12070017
120800                                                                  12080017
120900      WHERE                                                       12090017
121000           TRP.TRIP_ID               = :DK-TRIP-ID                12100017
121100        AND SHP.TRIP_ID              = TRP.TRIP_ID                12110017
121200        AND SHP.SHIPT_ID             = TPO.SHIPT_ID               12120017
121300        AND TPO.PO_NBR               = RCV.ORD_NBR                12130017
121400        AND TPO.REC_SEQ_NBR          = RCV.REC_SEQ_NBR            12140017
121500        AND TPO.PRIM_SHIPT_IND       = 'Y'                        12150017
121600*       AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D', 'B')          12160017
121700        AND A.PRCG_STAT_CDE  NOT IN ('P', 'V', 'D')               12170017
121800                                                                  12180017
121900        AND RCV.FCLTY_ID             = 1                          12190017
122000        AND RCV.VER_STATUS_CDE       = 'A'                        12200017
122100                                                                  12210017
122200        AND A.ORD_NBR                = TPO.PO_NBR                 12220017
122300        AND A.ORD_NBR                = RCV.ORD_NBR                12230017
122400        AND A.RCVR_SEQ_NBR           = RCV.REC_SEQ_NBR            12240017
122500        AND A.ORD_NBR                = PO.PO_NBR                  12250017
122600        AND PO.VER_STATUS_CDE        = 'A'                        12260017
122700        ORDER BY                                                  12270017
122800                 TMST                                             12280017
122900           ,     A.ORD_NBR                                        12290017
123000           ,     A.RCVR_SEQ_NBR                                   12300017
123100           ,     A.ORD_LNE_NBR                                    12310017
123200                                                                  12320017
123300      WITH UR                                                     12330017
123400     END-EXEC.                                                    12340017
123500                                                                  12350017
123600                                                                  12360017
123700     EXEC SQL                                                     12370017
123800          DECLARE WORK-ORDER-CSR CURSOR FOR                       12380017
123900             SELECT  STRT_TMST                                    12390017
124000                 ,   PRC_FCLTY_AREA_ID                            12400017
124100               FROM  TWKORIN                                      12410017
124200             WHERE   ORD_NBR            =  :DK-PO-NBR             12420017
124300               AND   RCVR_SEQ_NBR       =  :DK-REC-SEQ-NBR        12430017
124400               AND   ORD_LNE_NBR        =  0                      12440017
124500               AND   WORK_ORD_SEQ_NBR   =  1                      12450017
124600               AND   VER_STATUS_CDE     = 'A'                     12460017
124700           ORDER BY  STRT_TMST                                    12470017
124800     END-EXEC.                                                    12480017
124900/                                                                 12490017
125000 LINKAGE SECTION.                                                 12500017
125100                                                                  12510017
125200 01  DFHCOMMAREA.                                                 12520017
125300     05  FILLER                         OCCURS  1 TO 4072 TIMES   12530017
125400                                        DEPENDING ON EIBCALEN.    12540017
125500         10  FILLER                   PIC X.                      12550017
125600                                                                  12560017
125700/                                                                 12570017
125800 PROCEDURE DIVISION.                                              12580017
125900*---------------------------------------------------------------* 12590017
126000*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 12600017
126100*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 12610017
126200*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 12620017
126300*---------------------------------------------------------------* 12630017
126400 0000-MAIN-MODULE.                                                12640017
126500                                                                  12650017
126600     INITIALIZE DP030-CICS-API-FIELDS.                            12660017
126700                                                                  12670017
126800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       12680017
126900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          12690017
127000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         12700017
127100                                                                  12710017
127200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       12720017
127300                                                                  12730017
127400     MOVE LENGTH OF RC299AI        TO DP030-MAP-LENGTH (1).       12740017
127500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     12750017
127600                                                                  12760017
127700     PERFORM 0001-CALL-CICS-ARCH-API.                             12770017
127800     PERFORM 1000-CONTROL-PROCESSING                              12780017
127900                                                                  12790017
128000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     12800017
128100     PERFORM 0001-CALL-CICS-ARCH-API.                             12810017
128200                                                                  12820017
128300*---------------------------------------------------------------* 12830017
128400*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 12840017
128500*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 12850017
128600*---------------------------------------------------------------* 12860017
128700 0001-CALL-CICS-ARCH-API.                                         12870017
128810     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      12881023
128900                                    DFHCOMMAREA                   12890023
129000                                    DP030-CICS-API-FIELDS         12900023
129100                                    DP020-STANDARD-COMMAREA       12910023
129200                                    RC299AI.                      12920023
129300                                                                  12930017
129400     IF  DP030-RC-CALL-SUCCESSFUL                                 12940017
129500         CONTINUE                                                 12950017
129600     ELSE                                                         12960017
129700         SET DP013-NO-ROLLBACK                                    12970017
129800             DP013-XCTL-DISPLAY-RESTART                           12980017
129900             DP013-CICS-ABEND      TO TRUE                        12990017
130000         MOVE '0001-CALL-CICS-ARCH-API'                           13000017
130100                                   TO DP013-PARAGRAPH             13010017
130120         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O13012023
130130-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      13013023
130400         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      13040017
130500         PERFORM DP013-0000-PROCESS-ABEND                         13050017
130600     END-IF.                                                      13060017
130700                                                                  13070017
130800*----------------------------------------------------------------*13080017
130900* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *13090017
131000* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *13100017
131100*                                                                *13110017
131200* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *13120017
131300*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *13130017
131400*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *13140017
131500*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *13150017
131600*----------------------------------------------------------------*13160017
131700                                                                  13170017
131800 1000-CONTROL-PROCESSING.                                         13180017
131900                                                                  13190017
132000                                                                  13200017
132100     EVALUATE TRUE                                                13210017
132200         WHEN DP020-NEXT-ACT-INITIAL                              13220017
132300             INITIALIZE ASC-SPECIFIC-COMMAREA                     13230017
132400*            EXEC CICS                                            13240017
132500*                ASSIGN APPLID (ASC-CICS-SYSTEM)                  13250017
132600*            END-EXEC                                             13260017
132700             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            13270017
132800                                      ASC-SEL-TERM-ID             13280017
132900             MOVE DP020-SRC-TASK-NUMBER                           13290017
133000                                   TO ASC-LIST-TASK-NUMBER        13300017
133100                                      ASC-SEL-TASK-NUMBER         13310017
133200             MOVE PC-LIST-QUEUE-SEQ                               13320017
133300                                   TO ASC-LIST-SEQ                13330017
133400             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 13340017
133500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 13350017
133600                                                                  13360017
133700             PERFORM 3200-RESET-ATTRIBUTES                        13370017
133800             PERFORM 4000-BUILD-INITIAL-PANEL                     13380017
133900                                                                  13390017
134000         WHEN DP020-NEXT-ACT-READ-MAP                             13400017
134100             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        13410017
134200                                   TO PV-TOP-ITEM                 13420017
134300             PERFORM 2000-PROCESS-PANEL                           13430017
134400                                                                  13440017
134500         WHEN DP020-NEXT-ACT-RETURN                               13450017
134600             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        13460017
134700                                   TO PV-TOP-ITEM                 13470017
134800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    13480017
134900                                                                  13490017
135000             EVALUATE TRUE                                        13500017
135100             WHEN ASC-FUNC04-RETURN-YES                           13510017
135200                 PERFORM 6001-REFRESH-PANEL-FROM-TEMP             13520017
135300                 SET ASC-FUNC04-RETURN-NO TO TRUE                 13530017
135400             WHEN ASC-FUNC06-RETURN-YES                           13540017
135500                 PERFORM 6002-REFRESH-PANEL-FROM-TEMP             13550017
135600             WHEN ASC-FUNC08-RETURN-YES                           13560017
135700                 PERFORM 6003-REFRESH-PANEL-FROM-TEMP             13570017
135800                 SET ASC-FUNC08-RETURN-NO TO TRUE                 13580017
135900             WHEN ASC-FUNC09-RETURN-YES                           13590017
136000                 PERFORM 6004-REFRESH-PANEL-FROM-TEMP             13600017
136100                 SET ASC-FUNC09-RETURN-NO TO TRUE                 13610017
136200             WHEN OTHER                                           13620017
136300                 PERFORM 6000-REFRESH-PANEL-FROM-TEMP             13630017
136400             END-EVALUATE                                         13640017
136500                                                                  13650017
136600*            PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13660017
136700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13670017
136800                                                                  13680017
136900         WHEN OTHER                                               13690017
137000             SET DP013-LOGIC-ABEND TO TRUE                        13700017
137100             SET DP013-NO-ROLLBACK TO TRUE                        13710017
137200             MOVE '1000-CONTROL-PROCESSING'                       13720017
137300                                   TO DP013-PARAGRAPH             13730017
137400             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    13740017
137500                                   TO DP013-MESSAGE-TEXT(1)       13750017
137600             PERFORM DP013-0000-PROCESS-ABEND                     13760017
137700     END-EVALUATE.                                                13770017
137800                                                                  13780017
137900/                                                                 13790017
138000*----------------------------------------------------------------*13800017
138100* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *13810017
138200*----------------------------------------------------------------*13820017
138300                                                                  13830017
138400 1100-PROCESS-INTER-APPL-COMM.                                    13840017
138500                                                                  13850017
138600     SET PS-COMMAREA-VALID         TO TRUE.                       13860017
138700     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     13870017
138800     EVALUATE DP020-INT-APPL-FORMAT-IND                           13880017
138900         WHEN PC-INTER-APPL-CRIT-SPEC                             13890017
139000             CONTINUE                                             13900017
139100         WHEN PC-INTER-APPL-LIST                                  13910017
139200             SET ASC-USE-SELECTION-QUEUE TO TRUE                  13920017
139300             MOVE RC015-NUMBER-OF-SELECTED-ITEMS                  13930017
139400                                   TO ASC-NUMBER-OF-SELECTED-ITEMS13940017
139500             MOVE RC015-NUMBER-OF-TS-ITEMS                        13950017
139600                                   TO ASC-NUMBER-OF-TS-ITEMS      13960017
139700             MOVE RC015-SEL-QUEUE-NAME                            13970017
139800                                   TO ASC-SEL-QUEUE-NAME-IN       13980017
139900             PERFORM 1120-PREPARE-LIST-ENTRY                      13990017
140000                                                                  14000017
140100         WHEN OTHER                                               14010017
140200*            IF  DP020-NAV-KEY-DATA > SPACE                       14020017
140300*                PERFORM 1110-EDIT-NAV-KEY                        14030017
140400*            ELSE                                                 14040017
140500                 MOVE PC-TSYMSG-00148                             14050017
140600                                   TO DP020-MSG-NUMBER            14060017
140700                 SET DP020-MSG-FATAL                              14070017
140800                     DP020-NEXT-ACT-APPL-ERROR                    14080017
140900                                   TO TRUE                        14090017
141000*            END-IF                                               14100017
141100     END-EVALUATE.                                                14110017
141200                                                                  14120017
141300******************************************************************14130017
141400** EDIT THE KEY ENTERED BY THE USER INTO THE KEY FIELD OF THE   **14140017
141500** COMMAND LINE.  A VALID MESSAGE NUMBER IS THE ONLY KEY        **14150017
141600** ACCEPTED.                                                    **14160017
141700******************************************************************14170017
141800*1110-EDIT-NAV-KEY.                                               14180017
141900*    IF  ASC-ENT-ID > SPACE                                       14190017
142000*        MOVE DP020-NAV-KEY-DATA   TO DP010I-UNEDITED-FIELD       14200017
142100*        MOVE LENGTH OF ASC-ENT-ID                                14210017
142200*                                  TO DP010I-MAXIMUM-DIGITS       14220017
142300*        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     14230017
142400*        SET DP010I-NEGATIVE-NOT-ALLOWED                          14240017
142500*                                  TO TRUE                        14250017
142610*        CALL DP010I-NUMERIC-EDIT-ROUTINE                         14261022
142620*             USING DP010I-NUMERIC-EDIT-AREA                      14262022
142700*        IF  DP010I-ERROR-DETECTED                                14270017
142800*            SET PS-ERROR                                         14280017
142900*                DP020-MSG-FATAL   TO TRUE                        14290017
143000**           -- INVALID DATA IN KEY FIELD ---                     14300017
143100*            MOVE PC-TSYMSG-00302  TO DP020-MSG-NUMBER            14310017
143200*            SET DP020-NEXT-ACT-APPL-ERROR                        14320017
143300*                                  TO TRUE                        14330017
143400*        ELSE                                                     14340017
143500*            MOVE DP010I-NUMERIC-FIELD                            14350017
143600*                                  TO ASC-ENT-ID-N                14360017
143700*        END-IF                                                   14370017
143800*    END-IF.                                                      14380017
143900                                                                  14390017
144000 1120-PREPARE-LIST-ENTRY.                                         14400017
144100     MOVE RC013-MAX-ITEMS          TO ASC-SEL-SUB.                14410017
144200     MOVE ZERO                     TO ASC-SEL-ITEM.               14420017
144300     PERFORM 2300-GET-NEXT-RECORD.                                14430017
144400                                                                  14440017
144500/                                                                 14450017
144600*----------------------------------------------------------------*14460017
144700* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *14470017
144800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *14480017
144900* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *14490017
145000* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *14500017
145100* FUNCTION KEYS CAN GET THIS FAR.                                *14510017
145200*----------------------------------------------------------------*14520017
145300                                                                  14530017
145400 2000-PROCESS-PANEL.                                              14540017
145500     SET PS-NEXT-SCREEN TO TRUE.                                  14550017
145600     EVALUATE TRUE                                                14560017
145700         WHEN DP020-SRC-AID = DP016-CLEAR                         14570017
145800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    14580017
145900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14590017
146000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14600017
146100                                                                  14610017
146200         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    14620017
146300             MOVE ASC-KEY-OPER-UNT-ID                             14630017
146400                                   TO DK-OPER-UNT-ID              14640017
146500             MOVE ASC-KEY-FCLTY-ID TO DK-FCLTY-ID                 14650017
146600             MOVE ASC-KEY-PO-NBR      TO DK-PO-NBR                14660017
146700             MOVE ASC-KEY-REC-SEQ-NBR TO DK-REC-SEQ-NBR           14670017
146800             MOVE ASC-KEY-TRIP-ID     TO DK-TRIP-ID               14680017
146900             PERFORM 2050-DELETE-LIST-QUEUE                       14690017
147000             PERFORM 3200-RESET-ATTRIBUTES                        14700017
147100             PERFORM 4000-BUILD-INITIAL-PANEL                     14710017
147200                                                                  14720017
147300         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    14730017
147400             PERFORM 2140-DESELECT-ALL-ITEMS                      14740017
147500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14750017
147600                                                                  14760017
147700         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  14770017
147800             PERFORM 2150-SELECT-ALL-ITEMS                        14780017
147900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14790017
148000                                                                  14800017
148100         WHEN OTHER                                               14810017
148200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 14820017
148300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14830017
148400             IF  PS-NO-ERROR                                      14840017
148500                 SET DP030-CONTINUE-GO TO TRUE                    14850017
148600                 PERFORM 2100-CHECK-FUNCTION-KEY                  14860017
148700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14870017
148800             ELSE                                                 14880017
148900                 SET DP030-OVERRIDE-GO TO TRUE                    14890017
149000             END-IF                                               14900017
149100     END-EVALUATE.                                                14910017
149200                                                                  14920017
149300/                                                                 14930017
149400*----------------------------------------------------------------*14940017
149500*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *14950017
149600*----------------------------------------------------------------*14960017
149700 2050-DELETE-LIST-QUEUE.                                          14970017
149800                                                                  14980017
149900     EXEC CICS                                                    14990017
150000         DELETEQ TS                                               15000017
150100           QUEUE (ASC-LIST-QUEUE-NAME)                            15010017
150200            RESP (PV-CICS-RESP)                                   15020017
150300     END-EXEC.                                                    15030017
150400                                                                  15040017
150500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       15050017
150600        (PV-CICS-RESP = DFHRESP(QIDERR))                          15060017
150700         CONTINUE                                                 15070017
150800     ELSE                                                         15080017
150900         SET DP013-CICS-ABEND      TO TRUE                        15090017
151000         SET DP013-NO-ROLLBACK     TO TRUE                        15100017
151100                                                                  15110017
151200         MOVE '2050-DELETE-LIST-QUEUE'                            15120017
151300                                   TO DP013-PARAGRAPH             15130017
151400         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    15140017
151500                                   TO DP013-MESSAGE-TEXT (1)      15150017
151600         PERFORM DP013-0000-PROCESS-ABEND                         15160017
151700     END-IF.                                                      15170017
151800                                                                  15180017
151900     MOVE ZERO                     TO ASC-HIGHEST-BLOCK-WRITTEN.  15190017
152000                                                                  15200017
152100/                                                                 15210017
152200*----------------------------------------------------------------*15220017
152300* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*15230017
152400* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *15240017
152500* CICS ARCHITECTURE API.                                         *15250017
152600*----------------------------------------------------------------*15260017
152700 2100-CHECK-FUNCTION-KEY.                                         15270017
152800                                                                  15280017
152900     SET PS-NEXT-SCREEN TO TRUE.                                  15290017
153000     EVALUATE TRUE                                                15300017
153100         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               15310017
153200             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              15320017
153300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                15330017
153400                                 TO RC015-NUMBER-OF-SELECTED-ITEMS15340017
153500                 MOVE ASC-KEY-OPER-UNT-ID                         15350017
153600                                 TO RC015-OPER-UNT-ID             15360017
153700                 MOVE ASC-KEY-FCLTY-ID                            15370017
153800                                 TO RC015-FCLTY-ID                15380017
153900                 SET ASC-FUNC04-RETURN-NO                         15390017
154000                     ASC-FUNC06-RETURN-NO                         15400017
154100                     ASC-FUNC08-RETURN-NO                         15410017
154200                     ASC-FUNC09-RETURN-NO TO TRUE                 15420017
154300                 PERFORM 5000-PREPARE-SEL-QUEUE                   15430017
154400             ELSE                                                 15440017
154500                 SET ASC-FUNC04-RETURN-NO                         15450017
154600                     ASC-FUNC06-RETURN-NO                         15460017
154700                     ASC-FUNC08-RETURN-NO                         15470017
154800                     ASC-FUNC09-RETURN-NO TO TRUE                 15480017
154900                 MOVE -1               TO MR-SELECTL (1)          15490017
155000                 SET PS-ERROR          TO TRUE                    15500017
155100                 SET ASC-NO-TSQ-UPDATE TO TRUE                    15510017
155200                 SET DP030-OVERRIDE-GO TO TRUE                    15520017
155300                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        15530017
155400                 SET DP020-MSG-WARNING TO TRUE                    15540017
155500             END-IF                                               15550017
155600                                                                  15560017
155700         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  15570017
155800         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               15580017
155900         WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               15590017
156000*        WHEN DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)               15600017
156100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              15610017
156200                 SET ASC-FUNC04-RETURN-NO                         15620017
156300                     ASC-FUNC06-RETURN-NO                         15630017
156400                     ASC-FUNC08-RETURN-NO                         15640017
156500                     ASC-FUNC09-RETURN-NO TO TRUE                 15650017
156600                 INITIALIZE RC015-INTER-APPL-COMMAREA             15660017
156700                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                15670017
156800                                 TO RC015-NUMBER-OF-SELECTED-ITEMS15680017
156900                 MOVE ASC-KEY-OPER-UNT-ID                         15690017
157000                                 TO RC015-OPER-UNT-ID             15700017
157100                 MOVE ASC-KEY-FCLTY-ID                            15710017
157200                                 TO RC015-FCLTY-ID                15720017
157300                 SET ASC-NO-TSQ-UPDATE TO TRUE                    15730017
157400                 PERFORM 5000-PREPARE-SEL-QUEUE                   15740017
157500             ELSE                                                 15750017
157600                 SET ASC-FUNC04-RETURN-NO                         15760017
157700                     ASC-FUNC06-RETURN-NO                         15770017
157800                     ASC-FUNC08-RETURN-NO                         15780017
157900                     ASC-FUNC09-RETURN-NO TO TRUE                 15790017
158000                 MOVE -1                   TO MR-SELECTL (1)      15800017
158100                 SET ASC-NO-TSQ-UPDATE TO TRUE                    15810017
158200                 SET PS-ERROR          TO TRUE                    15820017
158300                 SET ASC-NO-TSQ-UPDATE TO TRUE                    15830017
158400                 SET DP030-OVERRIDE-GO TO TRUE                    15840017
158500                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        15850017
158600                 SET DP020-MSG-WARNING TO TRUE                    15860017
158700             END-IF                                               15870017
158800                                                                  15880017
158900         WHEN DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)               15890017
159000             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              15900017
159100                 SET ASC-FUNC04-RETURN-YES                        15910017
159200                     ASC-FUNC06-RETURN-NO                         15920017
159300                     ASC-FUNC08-RETURN-NO                         15930017
159400                     ASC-FUNC09-RETURN-NO TO TRUE                 15940017
159500                 INITIALIZE SU024-INTER-APPL-COMMAREA             15950017
159600                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                15960017
159700                                 TO SU024-NUMBER-OF-SELECTED-ITEMS15970017
159800                 MOVE ASC-KEY-OPER-UNT-ID                         15980017
159900                                 TO SU024-OPER-UNIT-ID            15990017
160000                 SET ASC-NO-TSQ-UPDATE TO TRUE                    16000017
160100                 PERFORM 5001-PREPARE-SEL-QUEUE                   16010017
160200             ELSE                                                 16020017
160300                 SET ASC-FUNC04-RETURN-NO                         16030017
160400                     ASC-FUNC06-RETURN-NO                         16040017
160500                     ASC-FUNC08-RETURN-NO                         16050017
160600                     ASC-FUNC09-RETURN-NO TO TRUE                 16060017
160700                 MOVE -1                   TO MR-SELECTL (1)      16070017
160800                 SET ASC-NO-TSQ-UPDATE TO TRUE                    16080017
160900                 SET PS-ERROR          TO TRUE                    16090017
161000                 SET ASC-NO-TSQ-UPDATE TO TRUE                    16100017
161100                 SET DP030-OVERRIDE-GO TO TRUE                    16110017
161200                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        16120017
161300                 SET DP020-MSG-WARNING TO TRUE                    16130017
161400             END-IF                                               16140017
161500                                                                  16150017
161600         WHEN DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)               16160017
161700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              16170017
161800                 SET ASC-FUNC06-RETURN-YES                        16180017
161900                     ASC-FUNC04-RETURN-NO                         16190017
162000                     ASC-FUNC08-RETURN-NO                         16200017
162100                     ASC-FUNC09-RETURN-NO TO TRUE                 16210017
162200                 INITIALIZE RC815-INTER-APPL-COMMAREA             16220017
162300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                16230017
162400                                 TO RC815-NUMBER-OF-SELECTED-ITEMS16240017
162500                 MOVE ASC-KEY-OPER-UNT-ID                         16250017
162600                                 TO RC815-OPER-UNT-ID             16260017
162700                 SET ASC-NO-TSQ-UPDATE TO TRUE                    16270017
162800                 PERFORM 5002-PREPARE-SEL-QUEUE                   16280017
162900             ELSE                                                 16290017
163000                 SET ASC-FUNC06-RETURN-NO                         16300017
163100                     ASC-FUNC04-RETURN-NO                         16310017
163200                     ASC-FUNC08-RETURN-NO                         16320017
163300                     ASC-FUNC09-RETURN-NO TO TRUE                 16330017
163400                 MOVE -1                   TO MR-SELECTL (1)      16340017
163500                 SET ASC-NO-TSQ-UPDATE TO TRUE                    16350017
163600                 SET PS-ERROR          TO TRUE                    16360017
163700                 SET ASC-NO-TSQ-UPDATE TO TRUE                    16370017
163800                 SET DP030-OVERRIDE-GO TO TRUE                    16380017
163900                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        16390017
164000                 SET DP020-MSG-WARNING TO TRUE                    16400017
164100             END-IF                                               16410017
164200         WHEN DP020-FK-LOCAL-FUNC-07(DP020-SRC-AID)               16420017
164300             SET ASC-FUNC06-RETURN-NO                             16430017
164400                 ASC-FUNC04-RETURN-NO                             16440017
164500                 ASC-FUNC08-RETURN-NO                             16450017
164600                 ASC-FUNC09-RETURN-NO TO TRUE                     16460017
164700             IF ASC-PO-SEQ                                        16470017
164800                 SET ASC-ARRIVAL-SEQ  TO TRUE                     16480017
164900             ELSE                                                 16490017
165000                 SET ASC-PO-SEQ       TO TRUE                     16500017
165100             END-IF                                               16510017
165200                                                                  16520017
165300             MOVE ASC-KEY-OPER-UNT-ID                             16530017
165400                                   TO DK-OPER-UNT-ID              16540017
165500             MOVE ASC-KEY-FCLTY-ID TO DK-FCLTY-ID                 16550017
165600             MOVE ASC-KEY-PO-NBR      TO DK-PO-NBR                16560017
165700             MOVE ASC-KEY-REC-SEQ-NBR TO DK-REC-SEQ-NBR           16570017
165800             MOVE ASC-KEY-TRIP-ID     TO DK-TRIP-ID               16580017
165900             PERFORM 2050-DELETE-LIST-QUEUE                       16590017
166000             PERFORM 3200-RESET-ATTRIBUTES                        16600017
166100             PERFORM 4000-BUILD-INITIAL-PANEL                     16610017
166200                                                                  16620017
166300* DMH 7/13/04 - ADDED - BEGIN                                     16630017
166400         WHEN DP020-FK-LOCAL-FUNC-08(DP020-SRC-AID)               16640017
166500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              16650017
166600                 SET ASC-FUNC08-RETURN-YES                        16660017
166700                     ASC-FUNC04-RETURN-NO                         16670017
166800                     ASC-FUNC06-RETURN-NO                         16680017
166900                     ASC-FUNC09-RETURN-NO TO TRUE                 16690017
167000                  INITIALIZE SU003-INTER-APPL-COMMAREA            16700017
167100                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               16710017
167200                                 TO SU003-NUMBER-OF-SELECTED-ITEMS16720017
167300                  MOVE ASC-KEY-OPER-UNT-ID                        16730017
167400                                 TO SU003-OPER-UNT-ID             16740017
167500                  MOVE ASC-KEY-FCLTY-ID                           16750017
167600                                 TO SU003-FCLTY-ID                16760017
167700                 SET ASC-NO-TSQ-UPDATE TO TRUE                    16770017
167800                 PERFORM 5001-PREPARE-SEL-QUEUE-CRTN              16780017
167900             ELSE                                                 16790017
168000                 SET ASC-FUNC04-RETURN-NO                         16800017
168100                     ASC-FUNC06-RETURN-NO                         16810017
168200                     ASC-FUNC08-RETURN-NO                         16820017
168300                     ASC-FUNC09-RETURN-NO TO TRUE                 16830017
168400                 MOVE -1                   TO MR-SELECTL (1)      16840017
168500                 SET ASC-NO-TSQ-UPDATE TO TRUE                    16850017
168600                 SET PS-ERROR          TO TRUE                    16860017
168700                 SET ASC-NO-TSQ-UPDATE TO TRUE                    16870017
168800                 SET DP030-OVERRIDE-GO TO TRUE                    16880017
168900                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        16890017
169000                 SET DP020-MSG-WARNING TO TRUE                    16900017
169100             END-IF                                               16910017
169200* DMH 7/13/04 - ADDED - END                                       16920017
169300                                                                  16930017
169400* DMH 7/13/04 - ADDED - BEGIN                                     16940017
169500         WHEN DP020-FK-LOCAL-FUNC-09(DP020-SRC-AID)               16950017
169600         WHEN DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)               16960017
169700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              16970017
169800                 SET ASC-FUNC09-RETURN-YES                        16980017
169900                     ASC-FUNC04-RETURN-NO                         16990017
170000                     ASC-FUNC06-RETURN-NO                         17000017
170100                     ASC-FUNC08-RETURN-NO TO TRUE                 17010017
170200                  INITIALIZE TR007-INTER-APPL-COMMAREA            17020017
170300                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               17030017
170400                                 TO TR007-NUMBER-OF-SELECTED-ITEMS17040017
170500******            MOVE ASC-KEY-OPER-UNT-ID                        17050017
170600******                           TO SU003-OPER-UNT-ID             17060017
170700******            MOVE ASC-KEY-FCLTY-ID                           17070017
170800******                           TO SU003-FCLTY-ID                17080017
170900                 SET ASC-NO-TSQ-UPDATE TO TRUE                    17090017
171000                 PERFORM 5002-PREPARE-SEL-QUEUE-TRLR              17100017
171100             ELSE                                                 17110017
171200                 SET ASC-FUNC04-RETURN-NO                         17120017
171300                     ASC-FUNC06-RETURN-NO                         17130017
171400                     ASC-FUNC08-RETURN-NO                         17140017
171500                     ASC-FUNC09-RETURN-NO TO TRUE                 17150017
171600                 MOVE -1                   TO MR-SELECTL (1)      17160017
171700                 SET ASC-NO-TSQ-UPDATE TO TRUE                    17170017
171800                 SET PS-ERROR          TO TRUE                    17180017
171900                 SET ASC-NO-TSQ-UPDATE TO TRUE                    17190017
172000                 SET DP030-OVERRIDE-GO TO TRUE                    17200017
172100                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        17210017
172200                 SET DP020-MSG-WARNING TO TRUE                    17220017
172300             END-IF                                               17230017
172400* DMH 7/13/04 - ADDED - END                                       17240017
172500                                                                  17250017
172600                                                                  17260017
172700         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             17270017
172800             IF ASC-USE-SELECTION-QUEUE                           17280017
172900                 PERFORM 2300-GET-NEXT-RECORD                     17290017
173000                 IF PS-LIST-END                                   17300017
173100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         17310017
173200                     SET PS-NO-LIST-END TO TRUE                   17320017
173300                 ELSE                                             17330017
173400                     PERFORM 2050-DELETE-LIST-QUEUE               17340017
173500                     PERFORM 3200-RESET-ATTRIBUTES                17350017
173600                     PERFORM 4000-BUILD-INITIAL-PANEL             17360017
173700                 END-IF                                           17370017
173800              ELSE                                                17380017
173900*                --- BOTTOM OF LIST ---                           17390017
174000                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         17400017
174100                 SET DP020-MSG-INFORMATIONAL TO TRUE              17410017
174200             END-IF                                               17420017
174300                                                                  17430017
174400         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             17440017
174500             IF ASC-USE-SELECTION-QUEUE                           17450017
174600                 PERFORM 2310-GET-PREV-RECORD                     17460017
174700                 IF PS-LIST-END                                   17470017
174800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         17480017
174900                     SET PS-NO-LIST-END TO TRUE                   17490017
175000                 ELSE                                             17500017
175100                     PERFORM 2050-DELETE-LIST-QUEUE               17510017
175200                     PERFORM 3200-RESET-ATTRIBUTES                17520017
175300                     PERFORM 4000-BUILD-INITIAL-PANEL             17530017
175400                 END-IF                                           17540017
175500             ELSE                                                 17550017
175600                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         17560017
175700                 SET DP020-MSG-INFORMATIONAL TO TRUE              17570017
175800             END-IF                                               17580017
175900                                                                  17590017
176000         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  17600017
176100             MOVE +1               TO PV-TOP-ITEM                 17610017
176200             PERFORM 3200-RESET-ATTRIBUTES                        17620017
176300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17630017
176400                                                                  17640017
176500         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   17650017
176600             PERFORM 2110-BROWSE-BACKWARD                         17660017
176700             PERFORM 3200-RESET-ATTRIBUTES                        17670017
176800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17680017
176900                                                                  17690017
177000         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   17700017
177100             PERFORM 2120-BROWSE-FORWARD                          17710017
177200             PERFORM 3200-RESET-ATTRIBUTES                        17720017
177300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17730017
177400                                                                  17740017
177500         WHEN DP020-SRC-AID = DP016-ENTER                         17750017
177600             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   17760017
177700             IF  PS-NO-ERROR                                      17770017
177800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17780017
177900             END-IF                                               17790017
178000                                                                  17800017
178100         WHEN OTHER                                               17810017
178200             SET DP013-NO-ROLLBACK                                17820017
178300                 DP013-XCTL-DISPLAY-RESTART                       17830017
178400                 DP013-CICS-ABEND  TO TRUE                        17840017
178500             MOVE '2100-CHECK-FUNCTION-KEY'                       17850017
178600                                   TO DP013-PARAGRAPH             17860017
178700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      17870017
178800                                   TO DP013-MESSAGE-TEXT (1)      17880017
178900             PERFORM DP013-0000-PROCESS-ABEND                     17890017
179000     END-EVALUATE.                                                17900017
179100                                                                  17910017
179200/                                                                 17920017
179300*----------------------------------------------------------------*17930017
179400*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *17940017
179500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *17950017
179600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *17960017
179700*    MESSAGE.                                                    *17970017
179800*----------------------------------------------------------------*17980017
179900                                                                  17990017
180000 2110-BROWSE-BACKWARD.                                            18000017
180100                                                                  18010017
180200     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    18020017
180300         GIVING PV-TOP-ITEM.                                      18030017
180400                                                                  18040017
180500     IF  ((PV-TOP-ITEM < +1)                                      18050017
180600       OR (PV-TOP-ITEM = +1))                                     18060017
180700         MOVE +1                   TO PV-TOP-ITEM                 18070017
180800*        -- TOP OF LIST --                                        18080017
180900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            18090017
181000         SET DP020-MSG-INFORMATIONAL                              18100017
181100                                   TO TRUE                        18110017
181200     END-IF.                                                      18120017
181300                                                                  18130017
181400/                                                                 18140017
181500*----------------------------------------------------------------*18150017
181600*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *18160017
181700*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *18170017
181800*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *18180017
181900*----------------------------------------------------------------*18190017
182000                                                                  18200017
182100 2120-BROWSE-FORWARD.                                             18210017
182200                                                                  18220017
182300     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              18230017
182400         GIVING PV-TOP-ITEM.                                      18240017
182500                                                                  18250017
182600     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   18260017
182700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            18270017
182800                                   TO PV-TOP-ITEM                 18280017
182900*        -- BOTTOM OF LIST --                                     18290017
183000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            18300017
183100         SET DP020-MSG-INFORMATIONAL                              18310017
183200                                   TO TRUE                        18320017
183300     ELSE                                                         18330017
183400         COMPUTE PV-BOTTOM-ITEM =                                 18340017
183500             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 18350017
183600         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            18360017
183700*            -- BOTTOM OF LIST --                                 18370017
183800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            18380017
183900             SET DP020-MSG-INFORMATIONAL                          18390017
184000                                   TO TRUE                        18400017
184100         END-IF                                                   18410017
184200     END-IF.                                                      18420017
184300                                                                  18430017
184400/                                                                 18440017
184500*----------------------------------------------------------------*18450017
184600*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *18460017
184700*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *18470017
184800*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *18480017
184900*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *18490017
185000*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *18500017
185100*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *18510017
185200*----------------------------------------------------------------*18520017
185300                                                                  18530017
185400 2130-CHECK-FOR-JUMP-BROWSE.                                      18540017
185500                                                                  18550017
185600     SET PS-NO-ERROR               TO TRUE.                       18560017
185700     IF (ASC-START-ITEM-REQUEST = SPACE)                          18570017
185800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            18580017
185900                                   TO PV-TOP-ITEM                 18590017
186000     ELSE                                                         18600017
186100         MOVE ASC-START-ITEM-REQUEST                              18610017
186200                                   TO DP010I-UNEDITED-FIELD       18620017
186300         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       18630017
186400         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     18640017
186500         SET DP010I-NEGATIVE-NOT-ALLOWED                          18650017
186600                                   TO TRUE                        18660017
186710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18671022
186720              USING DP010I-NUMERIC-EDIT-AREA                      18672022
186800                                                                  18680017
186900         IF  NOT DP010I-ERROR-DETECTED                            18690017
187000             MOVE DP010I-NUMERIC-FIELD                            18700017
187100                                   TO ASC-START-ITEM-REQUEST-N    18710017
187200             IF  ASC-START-ITEM-REQUEST-N > ZERO                  18720017
187300                 IF  ASC-START-ITEM-REQUEST-N >                   18730017
187400                                          ASC-NUMBER-OF-ITEMS-READ18740017
187500                     MOVE SPACE TO ASC-START-ITEM-REQUEST         18750017
187600                     COMPUTE PV-TOP-ITEM =                        18760017
187700                             ASC-NUMBER-OF-ITEMS-READ             18770017
187800                             - PC-ITEMS-PER-PANEL + 1             18780017
187900                     IF  PV-TOP-ITEM < +1                         18790017
188000                         MOVE +1   TO PV-TOP-ITEM                 18800017
188100                         MOVE PC-TSYMSG-00070                     18810017
188200                                   TO DP020-MSG-NUMBER            18820017
188300                         SET DP020-MSG-INFORMATIONAL              18830017
188400                                   TO TRUE                        18840017
188500                     END-IF                                       18850017
188600                 ELSE                                             18860017
188700                     MOVE ASC-START-ITEM-REQUEST-N                18870017
188800                                   TO PV-TOP-ITEM                 18880017
188900                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      18890017
189000                     COMPUTE PV-BOTTOM-ITEM =                     18900017
189100                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     18910017
189200                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ18920017
189300*                        -- BOTTOM OF LIST --                     18930017
189400                         MOVE PC-TSYMSG-00070                     18940017
189500                                   TO DP020-MSG-NUMBER            18950017
189600                         SET DP020-MSG-INFORMATIONAL              18960017
189700                                   TO TRUE                        18970017
189800                     END-IF                                       18980017
189900                 END-IF                                           18990017
190000             ELSE                                                 19000017
190100*                --- VALUE OUT OF RANGE ----                      19010017
190200                 MOVE PC-TSYMSG-00101                             19020017
190300                                   TO DP020-MSG-NUMBER            19030017
190400                 MOVE -1           TO ASTRTITL                    19040017
190500                 SET DP030-SET-CURSOR-APPL-1                      19050017
190600                                   TO TRUE                        19060017
190700                 MOVE DP015-REVERSE                               19070017
190800                                   TO ASTRTITH                    19080017
190900                 MOVE DP015-RED    TO ASTRTITC                    19090017
191000                 MOVE DP015-UNP-NUM-BRT-MDT                       19100017
191100                                   TO ASTRTITA                    19110017
191200                 SET DP020-MSG-FATAL                              19120017
191300                                   TO TRUE                        19130017
191400                 SET PS-ERROR      TO TRUE                        19140017
191500             END-IF                                               19150017
191600                                                                  19160017
191700         ELSE                                                     19170017
191800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            19180017
191900             MOVE -1               TO ASTRTITL                    19190017
192000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  19200017
192100             MOVE DP015-REVERSE    TO ASTRTITH                    19210017
192200             MOVE DP015-RED        TO ASTRTITC                    19220017
192300             MOVE DP015-UNP-NUM-BRT-MDT                           19230017
192400                                   TO ASTRTITA                    19240017
192500             SET DP020-MSG-FATAL   TO TRUE                        19250017
192600             SET PS-ERROR          TO TRUE                        19260017
192700         END-IF                                                   19270017
192800     END-IF.                                                      19280017
192900                                                                  19290017
193000/                                                                 19300017
193100*----------------------------------------------------------------*19310017
193200*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *19320017
193300*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *19330017
193400*----------------------------------------------------------------*19340017
193500 2140-DESELECT-ALL-ITEMS.                                         19350017
193600                                                                  19360017
193700     MOVE +1                       TO ASC-BLK-SUB.                19370017
193800                                                                  19380017
193900     PERFORM 2141-CLEAR-SELECTED-INDS                             19390017
194000         VARYING ASC-ITEM-SUB                                     19400017
194100         FROM 1 BY 1                                              19410017
194200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19420017
194300                                                                  19430017
194400     ADD +1                        TO ASC-BLK-SUB.                19440017
194500                                                                  19450017
194600     PERFORM 2141-CLEAR-SELECTED-INDS                             19460017
194700         VARYING ASC-ITEM-SUB                                     19470017
194800         FROM 1 BY 1                                              19480017
194900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19490017
195000                                                                  19500017
195100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19510017
195200                                   TO PV-LIST-ITEM-NUMBER.        19520017
195300                                                                  19530017
195400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19540017
195500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    19550017
195600                                                                  19560017
195700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     19570017
195800        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      19580017
195900         MOVE +1                   TO ASC-BLK-SUB                 19590017
196000                                                                  19600017
196100         PERFORM 5100-WRITE-TEMP-STORAGE                          19610017
196200                                                                  19620017
196300         MOVE +1                   TO PV-BLOCK-NUMBER             19630017
196400                                                                  19640017
196500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19650017
196600             PV-FIRST-BLOCK-IN-ARRAY - 1                          19660017
196700                                                                  19670017
196800         PERFORM                                                  19680017
196900             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       19690017
197000                                                                  19700017
197100             PERFORM 4410-READ-TEMP-STORAGE                       19710017
197200                                                                  19720017
197300             PERFORM 2141-CLEAR-SELECTED-INDS                     19730017
197400                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 19740017
197500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19750017
197600                                                                  19760017
197700             PERFORM 5100-WRITE-TEMP-STORAGE                      19770017
197800                                                                  19780017
197900             ADD +1                TO PV-BLOCK-NUMBER             19790017
198000                                                                  19800017
198100         END-PERFORM                                              19810017
198200                                                                  19820017
198300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19830017
198400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19840017
198500                                                                  19850017
198600         PERFORM                                                  19860017
198700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19870017
198800                   ASC-HIGHEST-BLOCK-WRITTEN                      19880017
198900                                                                  19890017
199000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19900017
199100                                   TO PV-BLOCK-NUMBER             19910017
199200                                                                  19920017
199300             PERFORM 4410-READ-TEMP-STORAGE                       19930017
199400                                                                  19940017
199500             PERFORM 2141-CLEAR-SELECTED-INDS                     19950017
199600                 VARYING ASC-ITEM-SUB                             19960017
199700                 FROM 1 BY 1                                      19970017
199800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19980017
199900                                                                  19990017
200000             PERFORM 5100-WRITE-TEMP-STORAGE                      20000017
200100                                                                  20010017
200200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      20020017
200300                                                                  20030017
200400         END-PERFORM                                              20040017
200500                                                                  20050017
200600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             20060017
200700                                   TO PV-BLOCK-NUMBER             20070017
200800                                                                  20080017
200900         PERFORM 4410-READ-TEMP-STORAGE                           20090017
201000     END-IF.                                                      20100017
201100                                                                  20110017
201200                                                                  20120017
201300     MOVE ZERO                     TO ASC-NUMBER-OF-SELECTED-ITEMS20130017
201400     MOVE ZERO                     TO ASC-START-OF-SELECTED-RANGE.20140017
201500     MOVE ZERO                     TO ASC-END-OF-SELECTED-RANGE.  20150017
201600                                                                  20160017
201700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        20170017
201800                                                                  20180017
201900/                                                                 20190017
202000*----------------------------------------------------------------*20200017
202100*    MARK EACH ITEM AS BEING NOT SELECTED.                       *20210017
202200*----------------------------------------------------------------*20220017
202300                                                                  20230017
202400 2141-CLEAR-SELECTED-INDS.                                        20240017
202500                                                                  20250017
202600     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          20260017
202700             NOT EQUAL ZERO                                       20270017
202800         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          20280017
202900             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          20290017
203000                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    20300017
203100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  20310017
203200                                   TO TRUE                        20320017
203300         END-IF                                                   20330017
203400     END-IF.                                                      20340017
203500                                                                  20350017
203600/                                                                 20360017
203700*----------------------------------------------------------------*20370017
203800*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *20380017
203900*  FOR ALL ITEMS.                                                *20390017
204000*----------------------------------------------------------------*20400017
204100                                                                  20410017
204200 2150-SELECT-ALL-ITEMS.                                           20420017
204300                                                                  20430017
204400     MOVE +1                       TO ASC-BLK-SUB.                20440017
204500                                                                  20450017
204600     PERFORM 2151-SET-SELECTED-INDS                               20460017
204700         VARYING ASC-ITEM-SUB                                     20470017
204800         FROM 1 BY 1                                              20480017
204900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20490017
205000                                                                  20500017
205100     ADD +1                        TO ASC-BLK-SUB.                20510017
205200                                                                  20520017
205300     PERFORM 2151-SET-SELECTED-INDS                               20530017
205400         VARYING ASC-ITEM-SUB                                     20540017
205500         FROM 1 BY 1                                              20550017
205600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20560017
205700                                                                  20570017
205800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               20580017
205900                                   TO PV-LIST-ITEM-NUMBER.        20590017
206000                                                                  20600017
206100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            20610017
206200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    20620017
206300                                                                  20630017
206400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     20640017
206500        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    20650017
206600         MOVE +1                   TO ASC-BLK-SUB                 20660017
206700                                                                  20670017
206800         PERFORM 5100-WRITE-TEMP-STORAGE                          20680017
206900                                                                  20690017
207000         MOVE +1                   TO PV-BLOCK-NUMBER             20700017
207100                                                                  20710017
207200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         20720017
207300             PV-FIRST-BLOCK-IN-ARRAY - 1                          20730017
207400                                                                  20740017
207500         PERFORM                                                  20750017
207600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       20760017
207700                                                                  20770017
207800             PERFORM 4410-READ-TEMP-STORAGE                       20780017
207900                                                                  20790017
208000             PERFORM 2151-SET-SELECTED-INDS                       20800017
208100                 VARYING ASC-ITEM-SUB                             20810017
208200                 FROM 1 BY 1                                      20820017
208300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20830017
208400                                                                  20840017
208500             PERFORM 5100-WRITE-TEMP-STORAGE                      20850017
208600                                                                  20860017
208700             ADD +1                TO PV-BLOCK-NUMBER             20870017
208800         END-PERFORM                                              20880017
208900                                                                  20890017
209000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         20900017
209100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     20910017
209200                                                                  20920017
209300         PERFORM                                                  20930017
209400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       20940017
209500                   ASC-HIGHEST-BLOCK-WRITTEN                      20950017
209600                                                                  20960017
209700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          20970017
209800                                   TO PV-BLOCK-NUMBER             20980017
209900                                                                  20990017
210000             PERFORM 4410-READ-TEMP-STORAGE                       21000017
210100                                                                  21010017
210200             PERFORM 2151-SET-SELECTED-INDS                       21020017
210300                 VARYING ASC-ITEM-SUB                             21030017
210400                 FROM 1 BY 1                                      21040017
210500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21050017
210600                                                                  21060017
210700             PERFORM 5100-WRITE-TEMP-STORAGE                      21070017
210800                                                                  21080017
210900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21090017
211000         END-PERFORM                                              21100017
211100                                                                  21110017
211200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21120017
211300                                   TO PV-BLOCK-NUMBER             21130017
211400                                                                  21140017
211500         PERFORM 4410-READ-TEMP-STORAGE                           21150017
211600     END-IF.                                                      21160017
211700                                                                  21170017
211800                                                                  21180017
211900     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             21190017
212000          ASC-NUMBER-OF-SELECTED-ITEMS.                           21200017
212100                                                                  21210017
212200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        21220017
212300                                                                  21230017
212400/                                                                 21240017
212500*----------------------------------------------------------------*21250017
212600*    MARK EACH ITEM AS BEING SELECTED.                           *21260017
212700*----------------------------------------------------------------*21270017
212800                                                                  21280017
212900 2151-SET-SELECTED-INDS.                                          21290017
213000                                                                  21300017
213100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           21310017
213200             NOT EQUAL ZERO                                       21320017
213300         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             21330017
213400             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             21340017
213500                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        21350017
213600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  21360017
213700                                   TO TRUE                        21370017
213800         END-IF                                                   21380017
213900     END-IF.                                                      21390017
214000                                                                  21400017
214100/                                                                 21410017
214200*----------------------------------------------------------------*21420017
214300*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *21430017
214400*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *21440017
214500*----------------------------------------------------------------*21450017
214600 2200-MOVE-SCREEN-TO-COMMAREA.                                    21460017
214700                                                                  21470017
214800     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             21480017
214900     MOVE +1                       TO PV-SUB.                     21490017
215000                                                                  21500017
215100     PERFORM 3100-SET-SUBSCRIPTS.                                 21510017
215200                                                                  21520017
215300     IF  ASTRTITL > ZERO                                          21530017
215400         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      21540017
215500     ELSE                                                         21550017
215600         IF  ASTRTITF = DP015-ERASE-EOF                           21560017
215700             INITIALIZE ASC-START-ITEM-REQUEST                    21570017
215800         END-IF                                                   21580017
215900     END-IF.                                                      21590017
216000                                                                  21600017
216100     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          21610017
216200         VARYING PV-SUB                                           21620017
216300         FROM 1 BY 1                                              21630017
216400         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      21640017
216500                                                                  21650017
216600/                                                                 21660017
216700*----------------------------------------------------------------*21670017
216800*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *21680017
216900*----------------------------------------------------------------*21690017
217000 2210-MOVE-LINES-TO-COMMAREA.                                     21700017
217100                                                                  21710017
217200     IF  MR-SELECTL (PV-SUB) > ZERO                               21720017
217300         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     21730017
217400                                   TO TRUE                        21740017
217500         MOVE MR-SELECT (PV-SUB)   TO ASC-TEMP-SELECTED-SW        21750017
217600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      21760017
217700     ELSE                                                         21770017
217800         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                21780017
217900             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         21790017
218000             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        21800017
218100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      21810017
218200         END-IF                                                   21820017
218300     END-IF.                                                      21830017
218400                                                                  21840017
218500     MOVE ASC-ACTION (ASC-BLK-SUB, ASC-ITEM-SUB)                  21850017
218600                                 TO MR-ACTION (PV-SUB)            21860017
218700     MOVE ASC-PO-NBR (ASC-BLK-SUB, ASC-ITEM-SUB)                  21870017
218800                                 TO MR-PO-NBR (PV-SUB)            21880017
218900     MOVE '-'                    TO MR-DASH (PV-SUB)              21890017
219000     MOVE ASC-REC-SEQ-NBR (ASC-BLK-SUB, ASC-ITEM-SUB)             21900017
219100                                 TO MR-REC-SEQ-NBR (PV-SUB)       21910017
219200                                                                  21920017
219300     MOVE ASC-DEPT (ASC-BLK-SUB, ASC-ITEM-SUB)                    21930017
219400                                 TO MR-DEPT-X (PV-SUB)            21940017
219500     MOVE ASC-VENDNAME  (ASC-BLK-SUB, ASC-ITEM-SUB)               21950017
219600                                 TO MR-VENDNAME (PV-SUB)          21960017
219700     MOVE ASC-PKG       (ASC-BLK-SUB, ASC-ITEM-SUB)               21970017
219800                                 TO MR-PKG      (PV-SUB)          21980017
219900     MOVE ASC-ARRIVE-DTE (ASC-BLK-SUB, ASC-ITEM-SUB)              21990017
220000                                 TO MR-ARRIVE-DTE (PV-SUB)        22000017
220100     MOVE ASC-STATUS  (ASC-BLK-SUB, ASC-ITEM-SUB)                 22010017
220200                                 TO MR-STATUS (PV-SUB)            22020017
220300     MOVE ASC-SUSPEND-COUNT  (ASC-BLK-SUB, ASC-ITEM-SUB)          22030017
220400                                 TO MR-SUSPEND-COUNT (PV-SUB)     22040017
220500                                                                  22050017
220600     ADD +1                        TO ASC-ITEM-SUB.               22060017
220700                                                                  22070017
220800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        22080017
220900         ADD +1                    TO ASC-BLK-SUB                 22090017
221000         MOVE +1                   TO ASC-ITEM-SUB                22100017
221100     END-IF.                                                      22110017
221200                                                                  22120017
221300/                                                                 22130017
221400 2300-GET-NEXT-RECORD.                                            22140017
221500         ADD +1                    TO ASC-SEL-SUB                 22150017
221600         IF ASC-SEL-SUB > RC013-MAX-ITEMS                         22160017
221700             ADD +1                TO ASC-SEL-ITEM                22170017
221800             MOVE +1               TO ASC-SEL-SUB                 22180017
221900         END-IF                                                   22190017
222000         IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS             22200017
222100             PERFORM 9100-READ-SEL-QUEUE                          22210017
222200             IF RC013-ITEM (ASC-SEL-SUB) > ZERO                   22220017
222300                 MOVE RC013-PO-NBR (ASC-SEL-SUB)                  22230017
222400                                      TO ASC-KEY-PO-NBR           22240017
222500                 MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)             22250017
222600                                      TO ASC-KEY-REC-SEQ-NBR      22260017
222700                 MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)             22270017
222800                                      TO ASC-KEY-OPER-UNT-ID      22280017
222900                 MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                22290017
223000                                      TO ASC-KEY-FCLTY-ID         22300017
223100                 SET RC013-INQ (ASC-SEL-SUB)                      22310017
223200                                       TO TRUE                    22320017
223300                 PERFORM 9200-REWRITE-LIST-QUEUE                  22330017
223400             ELSE                                                 22340017
223500                 SUBTRACT +1 FROM ASC-SEL-SUB                     22350017
223600*                --- BOTTOM OF LIST ---                           22360017
223700                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         22370017
223800                 SET DP020-MSG-INFORMATIONAL                      22380017
223900                                       TO TRUE                    22390017
224000             END-IF                                               22400017
224100         ELSE                                                     22410017
224200             SUBTRACT +1 FROM ASC-SEL-ITEM                        22420017
224300             MOVE RC013-MAX-ITEMS  TO ASC-SEL-SUB                 22430017
224400             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            22440017
224500             SET DP020-MSG-INFORMATIONAL                          22450017
224600                                       TO TRUE                    22460017
224700         END-IF.                                                  22470017
224800                                                                  22480017
224900 2310-GET-PREV-RECORD.                                            22490017
225000     SUBTRACT +1                 FROM ASC-SEL-SUB.                22500017
225100     IF ASC-SEL-SUB < +1                                          22510017
225200         SUBTRACT +1             FROM ASC-SEL-ITEM                22520017
225300         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 22530017
225400     END-IF.                                                      22540017
225500                                                                  22550017
225600     MOVE RC015-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN       22560017
225700     IF ASC-SEL-ITEM > ZERO                                       22570017
225800         PERFORM 9100-READ-SEL-QUEUE                              22580017
225900         SET RC013-INQ (ASC-SEL-SUB)  TO TRUE                     22590017
226000         PERFORM 9200-REWRITE-LIST-QUEUE                          22600017
226100     ELSE                                                         22610017
226200             MOVE +1 TO  ASC-SEL-SUB                              22620017
226300                         ASC-SEL-ITEM                             22630017
226400*            --- TOP OF LIST ---                                  22640017
226500             MOVE PC-TSYMSG-00069  TO DP020-MSG-NUMBER            22650017
226600             SET DP020-MSG-INFORMATIONAL                          22660017
226700                                   TO TRUE                        22670017
226800     END-IF.                                                      22680017
226900                                                                  22690017
227000/                                                                 22700017
227100*----------------------------------------------------------------*22710017
227200*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *22720017
227300*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *22730017
227400*----------------------------------------------------------------*22740017
227500 3000-EDIT-DATA-IN-COMMAREA.                                      22750017
227600                                                                  22760017
227700     SET PS-NO-ERROR               TO TRUE.                       22770017
227800                                                                  22780017
227900     PERFORM 3200-RESET-ATTRIBUTES.                               22790017
228000                                                                  22800017
228100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     22810017
228200**                                                                22820017
228300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              22830017
228400* EDITING IS DONE FROM THE BOTTOM UP.                             22840017
228500**                                                                22850017
228600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       22860017
228700         ASC-ITEMS-DISPLAYED - 1.                                 22870017
228800                                                                  22880017
228900     PERFORM 3100-SET-SUBSCRIPTS.                                 22890017
229000     PERFORM 3300-EDIT-SELECTIONS                                 22900017
229100         VARYING PV-SUB                                           22910017
229200         FROM PV-SUB BY -1                                        22920017
229300         UNTIL PV-SUB < +1                                        22930017
229400                                                                  22940017
229500     IF  PS-NO-ERROR                                              22950017
229600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        22960017
229700     END-IF.                                                      22970017
229800                                                                  22980017
229900     IF  ((PS-NO-ERROR)                                           22990017
230000       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   23000017
230100       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    23010017
230200             PERFORM 3500-MARK-RANGE-AS-SELECTED                  23020017
230300     END-IF.                                                      23030017
230400                                                                  23040017
230500/                                                                 23050017
230600*----------------------------------------------------------------*23060017
230700*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *23070017
230800*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*23080017
230900*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *23090017
231000*                                                                *23100017
231100*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *23110017
231200*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *23120017
231300*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *23130017
231400*    US IN THE 2ND BLOCK OF THE ARRAY.                           *23140017
231500*----------------------------------------------------------------*23150017
231600                                                                  23160017
231700 3100-SET-SUBSCRIPTS.                                             23170017
231800                                                                  23180017
231900     COMPUTE ASC-ITEM-SUB =                                       23190017
232000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        23200017
232100                                                                  23210017
232200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         23220017
232300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            23230017
232400                                                                  23240017
232500         MOVE PC-MAX-BLOCKS-IN-ARRAY                              23250017
232600                                   TO ASC-BLK-SUB                 23260017
232700     ELSE                                                         23270017
232800         MOVE +1                   TO ASC-BLK-SUB                 23280017
232900     END-IF.                                                      23290017
233000                                                                  23300017
233100*----------------------------------------------------------------*23310017
233200*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *23320017
233300*----------------------------------------------------------------*23330017
233400                                                                  23340017
233500 3200-RESET-ATTRIBUTES.                                           23350017
233600                                                                  23360017
233700     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA                    23370017
233800     MOVE DP015-GREEN              TO ASTRTITC                    23380017
233900     MOVE DP015-UNDERLINE          TO ASTRTITH.                   23390017
234000                                                                  23400017
234100     PERFORM VARYING PV-SUB  FROM 1 BY 1                          23410017
234200         UNTIL   PV-SUB > PC-ITEMS-PER-PANEL                      23420017
234300             MOVE DP015-UNP-ALP-NOR-OFF                           23430017
234400                                 TO MR-SELECTA (PV-SUB)           23440017
234500             MOVE DP015-GREEN                                     23450017
234600                                 TO MR-SELECTC (PV-SUB)           23460017
234700                                    MR-ARRIVE-DTEC(PV-SUB)        23470017
234800             MOVE DP015-UNDERLINE                                 23480017
234900                                 TO MR-SELECTH (PV-SUB)           23490017
235000             MOVE DP015-HL-OFF   TO MR-ARRIVE-DTEH(PV-SUB)        23500017
235100     END-PERFORM.                                                 23510017
235200                                                                  23520017
235300                                                                  23530017
235400*----------------------------------------------------------------*23540017
235500*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *23550017
235600*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *23560017
235700*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *23570017
235800*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *23580017
235900*----------------------------------------------------------------*23590017
236000 3300-EDIT-SELECTIONS.                                            23600017
236100                                                                  23610017
236200     MOVE SPACES                   TO ASC-ACTION                  23620017
236300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23630017
236400                                      MR-ACTION (PV-SUB)          23640017
236500                                                                  23650017
236600     EVALUATE TRUE                                                23660017
236700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     23670017
236800             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         23680017
236900                 CONTINUE                                         23690017
237000                                                                  23700017
237100         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         23710017
237200             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        23720017
237300                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS23730017
237400                 MOVE ASC-TEMP-SELECTED-SW                        23740017
237500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23750017
237600                                   TO ASC-SELECTED-SW             23760017
237700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23770017
237800             END-IF                                               23780017
237900                                                                  23790017
238000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     23800017
238100                 = SPACE                                          23810017
238200             EVALUATE TRUE                                        23820017
238300                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       23830017
238400                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS23840017
238500                     MOVE SPACE    TO ASC-SELECTED-SW             23850017
238600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23860017
238700                                                                  23870017
238800                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        23880017
238900                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 23890017
239000                     MOVE SPACE    TO ASC-SELECTED-SW             23900017
239100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23910017
239200                                                                  23920017
239300                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          23930017
239400                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   23940017
239500                     MOVE SPACE    TO ASC-SELECTED-SW             23950017
239600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23960017
239700             END-EVALUATE                                         23970017
239800                                                                  23980017
239900         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           23990017
240000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24000017
240100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    24010017
240200             END-IF                                               24020017
240300             PERFORM 3310-EDIT-RANGE                              24030017
240400                                                                  24040017
240500         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             24050017
240600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24060017
240700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    24070017
240800             END-IF                                               24080017
240900             PERFORM 3310-EDIT-RANGE                              24090017
241000                                                                  24100017
241100         WHEN OTHER                                               24110017
241200             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            24120017
241300             SET DP020-MSG-FATAL   TO TRUE                        24130017
241400             MOVE -1               TO MR-SELECTL (PV-SUB)         24140017
241500             SET DP030-SET-CURSOR-APPL-1                          24150017
241600                                   TO TRUE                        24160017
241700             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         24170017
241800             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         24180017
241900             SET PS-ERROR          TO TRUE                        24190017
242000             MOVE PC-ERR           TO ASC-ACTION                  24200017
242100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24210017
242200                                      MR-ACTION (PV-SUB)          24220017
242300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24230017
242400                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     24240017
242500                 MOVE SPACE        TO ASC-SELECTED-SW             24250017
242600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24260017
242700             END-IF                                               24270017
242800     END-EVALUATE.                                                24280017
242900                                                                  24290017
243000     IF DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)                    24300017
243100        IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                  24310017
243200           IF  ASC-TRIP-NOT-ARRIVED                               24320017
243300                  (ASC-BLK-SUB ASC-ITEM-SUB)                      24330017
243400               CONTINUE                                           24340017
243500           ELSE                                                   24350017
243600                 MOVE PC-TSYMSG-03305 TO DP020-MSG-NUMBER         24360017
243700                 SET DP020-MSG-FATAL  TO TRUE                     24370017
243800                 MOVE -1              TO MR-SELECTL(PV-SUB)       24380017
243900                 SET DP030-SET-CURSOR-APPL-1                      24390017
244000                                      TO TRUE                     24400017
244100                 MOVE DP015-RED       TO MR-ARRIVE-DTEC(PV-SUB)   24410017
244200                 MOVE DP015-REVERSE   TO MR-ARRIVE-DTEH(PV-SUB)   24420017
244300                 SET PS-ERROR  TO  TRUE                           24430017
244400           END-IF                                                 24440017
244500        END-IF                                                    24450017
244600     END-IF.                                                      24460017
244700                                                                  24470017
244800     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             24480017
244900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               24490017
245000                                                                  24500017
245100     IF  ASC-ITEM-SUB < 1                                         24510017
245200         SUBTRACT +1 FROM ASC-BLK-SUB                             24520017
245300         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                24530017
245400     END-IF.                                                      24540017
245500                                                                  24550017
245600                                                                  24560017
245700*----------------------------------------------------------------*24570017
245800*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *24580017
245900*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *24590017
246000*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *24600017
246100*  THE ENDING.                                                   *24610017
246200*----------------------------------------------------------------*24620017
246300 3310-EDIT-RANGE.                                                 24630017
246400                                                                  24640017
246500     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                24650017
246600         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   24660017
246700             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)24670017
246800                                   TO ASC-SELECTED-SW             24680017
246900                                        (ASC-BLK-SUB ASC-ITEM-SUB)24690017
247000             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 24700017
247100         ELSE                                                     24710017
247200             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     24720017
247300                 CONTINUE                                         24730017
247400             ELSE                                                 24740017
247500*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        24750017
247600                 MOVE PC-TSYMSG-00054                             24760017
247700                                   TO DP020-MSG-NUMBER            24770017
247800                 SET DP020-MSG-FATAL                              24780017
247900                                   TO TRUE                        24790017
248000                 MOVE -1           TO MR-SELECTL (PV-SUB)         24800017
248100                 SET DP030-SET-CURSOR-APPL-1                      24810017
248200                                   TO TRUE                        24820017
248300                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         24830017
248400                 MOVE DP015-UNDERLINE                             24840017
248500                                   TO MR-SELECTH (PV-SUB)         24850017
248600                 SET PS-ERROR      TO TRUE                        24860017
248700             END-IF                                               24870017
248800         END-IF                                                   24880017
248900     ELSE                                                         24890017
249000         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     24900017
249100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 24910017
249200                                   TO ASC-SELECTED-SW             24920017
249300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24930017
249400             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   24940017
249500         ELSE                                                     24950017
249600             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       24960017
249700                 CONTINUE                                         24970017
249800             ELSE                                                 24980017
249900*                -- ONLY ONE END-OF-RANGE ALLOWED --              24990017
250000                 MOVE PC-TSYMSG-00055                             25000017
250100                                   TO DP020-MSG-NUMBER            25010017
250200                 SET DP020-MSG-FATAL                              25020017
250300                                   TO TRUE                        25030017
250400                 MOVE -1           TO MR-SELECTL (PV-SUB)         25040017
250500                 SET DP030-SET-CURSOR-APPL-1                      25050017
250600                                   TO TRUE                        25060017
250700                 SET PS-ERROR      TO TRUE                        25070017
250800             END-IF                                               25080017
250900         END-IF                                                   25090017
251000     END-IF.                                                      25100017
251100                                                                  25110017
251200*----------------------------------------------------------------*25120017
251300*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *25130017
251400*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *25140017
251500*----------------------------------------------------------------*25150017
251600 3400-CHECK-RANGE-SEQUENCE.                                       25160017
251700                                                                  25170017
251800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       25180017
251900       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      25190017
252000       AND  ASC-START-OF-SELECTED-RANGE >                         25200017
252100                                         ASC-END-OF-SELECTED-RANGE25210017
252200*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                25220017
252300         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            25230017
252400         SET DP020-MSG-FATAL       TO TRUE                        25240017
252500         SET PS-ERROR              TO TRUE                        25250017
252600         PERFORM 3410-POSITION-AT-ERROR                           25260017
252700     END-IF.                                                      25270017
252800                                                                  25280017
252900*----------------------------------------------------------------*25290017
253000*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *25300017
253100*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *25310017
253200*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *25320017
253300*----------------------------------------------------------------*25330017
253400 3410-POSITION-AT-ERROR.                                          25340017
253500                                                                  25350017
253600     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       25360017
253700                                                                  25370017
253800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 25380017
253900                    - PV-TOP-ITEM + 1.                            25390017
254000                                                                  25400017
254100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25410017
254200         CONTINUE                                                 25420017
254300     ELSE                                                         25430017
254400         MOVE -1                   TO MR-SELECTL (PV-SUB)         25440017
254500         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25450017
254600         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         25460017
254700     END-IF.                                                      25470017
254800                                                                  25480017
254900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   25490017
255000                    - PV-TOP-ITEM + 1.                            25500017
255100                                                                  25510017
255200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25520017
255300         CONTINUE                                                 25530017
255400     ELSE                                                         25540017
255500         MOVE -1                   TO MR-SELECTL (PV-SUB)         25550017
255600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25560017
255700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         25570017
255800     END-IF.                                                      25580017
255900                                                                  25590017
256000/                                                                 25600017
256100*----------------------------------------------------------------*25610017
256200*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *25620017
256300*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *25630017
256400*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *25640017
256500*----------------------------------------------------------------*25650017
256600                                                                  25660017
256700 3500-MARK-RANGE-AS-SELECTED.                                     25670017
256800                                                                  25680017
256900     MOVE +1                       TO ASC-BLK-SUB.                25690017
257000                                                                  25700017
257100     PERFORM 3510-MARK-SELECTED-INDS                              25710017
257200         VARYING ASC-ITEM-SUB                                     25720017
257300         FROM 1 BY 1                                              25730017
257400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 25740017
257500                                                                  25750017
257600     ADD +1                        TO ASC-BLK-SUB.                25760017
257700                                                                  25770017
257800     PERFORM 3510-MARK-SELECTED-INDS                              25780017
257900         VARYING ASC-ITEM-SUB                                     25790017
258000         FROM 1 BY 1                                              25800017
258100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 25810017
258200                                                                  25820017
258300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               25830017
258400                                   TO PV-LIST-ITEM-NUMBER.        25840017
258500                                                                  25850017
258600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            25860017
258700         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         25870017
258800               PC-ITEMS-PER-PANEL).                               25880017
258900                                                                  25890017
259000     MOVE ASC-START-OF-SELECTED-RANGE                             25900017
259100                                   TO PV-START-OF-SELECTED-RANGE. 25910017
259200                                                                  25920017
259300     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            25930017
259400         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  25940017
259500               PC-ITEMS-PER-PANEL).                               25950017
259600                                                                  25960017
259700     MOVE ASC-END-OF-SELECTED-RANGE                               25970017
259800                                   TO PV-END-OF-SELECTED-RANGE.   25980017
259900                                                                  25990017
260000     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             26000017
260100         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    26010017
260200               PC-ITEMS-PER-PANEL).                               26020017
260300                                                                  26030017
260400     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             26040017
260500         PV-FIRST-BLOCK-IN-ARRAY + 1.                             26050017
260600                                                                  26060017
260700     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    26070017
260800        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        26080017
260900         MOVE +1                   TO ASC-BLK-SUB                 26090017
261000         PERFORM 5100-WRITE-TEMP-STORAGE                          26100017
261100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         26110017
261200             PV-FIRST-BLOCK-IN-ARRAY - 1                          26120017
261300                                                                  26130017
261400         PERFORM                                                  26140017
261500             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      26150017
261600                   PV-PREV-BLOCK-IN-ARRAY                         26160017
261700             MOVE PV-FIRST-BLOCK-IN-RANGE                         26170017
261800                                   TO PV-BLOCK-NUMBER             26180017
261900             PERFORM 4410-READ-TEMP-STORAGE                       26190017
262000             PERFORM 3510-MARK-SELECTED-INDS                      26200017
262100                 VARYING ASC-ITEM-SUB                             26210017
262200                 FROM 1 BY 1                                      26220017
262300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          26230017
262400             PERFORM 5100-WRITE-TEMP-STORAGE                      26240017
262500             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     26250017
262600         END-PERFORM                                              26260017
262700                                                                  26270017
262800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         26280017
262900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     26290017
263000         PERFORM                                                  26300017
263100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       26310017
263200                   PV-LAST-BLOCK-IN-RANGE                         26320017
263300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          26330017
263400                                   TO PV-BLOCK-NUMBER             26340017
263500             PERFORM 4410-READ-TEMP-STORAGE                       26350017
263600             PERFORM 3510-MARK-SELECTED-INDS                      26360017
263700                 VARYING ASC-ITEM-SUB                             26370017
263800                 FROM 1 BY 1                                      26380017
263900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          26390017
264000             PERFORM 5100-WRITE-TEMP-STORAGE                      26400017
264100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      26410017
264200         END-PERFORM                                              26420017
264300                                                                  26430017
264400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             26440017
264500                                   TO PV-BLOCK-NUMBER             26450017
264600         PERFORM 4410-READ-TEMP-STORAGE                           26460017
264700     END-IF.                                                      26470017
264800                                                                  26480017
264900     MOVE ZERO                     TO ASC-START-OF-SELECTED-RANGE 26490017
265000                                      ASC-END-OF-SELECTED-RANGE.  26500017
265100                                                                  26510017
265200/                                                                 26520017
265300*----------------------------------------------------------------*26530017
265400* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *26540017
265500*----------------------------------------------------------------*26550017
265600                                                                  26560017
265700 3510-MARK-SELECTED-INDS.                                         26570017
265800                                                                  26580017
265900     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         26590017
266000         ASC-START-OF-SELECTED-RANGE)                             26600017
266100     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         26610017
266200         ASC-START-OF-SELECTED-RANGE)                             26620017
266300                                                                  26630017
266400         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     26640017
266500             ASC-END-OF-SELECTED-RANGE)                           26650017
266600         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     26660017
266700             ASC-END-OF-SELECTED-RANGE)                           26670017
266800                                                                  26680017
266900             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          26690017
267000                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   26700017
267100                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   26710017
267200                                   TO TRUE                        26720017
267300                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              26730017
267400                                   TO TRUE                        26740017
267500                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS26750017
267600             END-IF                                               26760017
267700         END-IF                                                   26770017
267800     END-IF.                                                      26780017
267900                                                                  26790017
268000/                                                                 26800017
268100*----------------------------------------------------------------*26810017
268200*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *26820017
268300*    INITIALIZE ALL COUNTERS AND FLAGS.                          *26830017
268400*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *26840017
268500*    DISPLAY THE PANEL TO USER.                                  *26850017
268600*----------------------------------------------------------------*26860017
268700                                                                  26870017
268800 4000-BUILD-INITIAL-PANEL.                                        26880017
268900                                                                  26890017
269000     INITIALIZE ASC-BLOCK-ENTRIES (1)                             26900017
269100                ASC-BLOCK-ENTRIES (2).                            26910017
269200                                                                  26920017
269300     MOVE +1                       TO ASC-BLK-SUB.                26930017
269400                                                                  26940017
269500     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       26950017
269600                                                                  26960017
269700     MOVE ZERO                     TO ASC-ITEM-SUB                26970017
269800                                      ASC-NUMBER-OF-ITEMS-READ    26980017
269900                                      ASC-NUMBER-OF-SELECTED-ITEMS26990017
270000                                      ASC-HIGHEST-BLOCK-WRITTEN   27000017
270100                                      ASC-START-OF-SELECTED-RANGE 27010017
270200                                      ASC-END-OF-SELECTED-RANGE   27020017
270300                                      ASC-ITEM-AT-TOP-OF-PANEL.   27030017
270400                                                                  27040017
270500*    PERFORM 4301-GLOBAL-INVENTORY                                27050017
270600                                                                  27060017
270700     PERFORM 4100-PREPARE-CURSOR.                                 27070017
270800                                                                  27080017
270900     PERFORM 7010-LOCATION-NAME.                                  27090017
271000                                                                  27100017
271100     PERFORM 4010-OPEN-CURSOR.                                    27110017
271200     MOVE ZERO                        TO PV-ROWS-FETCHED          27120017
271300                                                                  27130017
271400     PERFORM 4310-FETCH                                           27140017
271500     IF ASC-NO-ITEMS-LEFT-ON-DB                                   27150017
271600             SET DP020-NEXT-ACT-APPL-ERROR                        27160017
271700                                      TO TRUE                     27170017
271800             SET DP020-MSG-FATAL      TO TRUE                     27180017
271900             MOVE PC-TSYMSG-00050     TO DP020-MSG-NUMBER         27190017
272000     ELSE                                                         27200017
272100         PERFORM 4000A-PROCESS-CURSOR                             27210017
272200     END-IF.                                                      27220017
272300/                                                                 27230017
272400 4000A-PROCESS-CURSOR.                                            27240017
272500     MOVE DISTHD-ORD-NBR              TO PV-SAVE-PO-NBR           27250017
272600                                         DK-PO-NBR                27260017
272700     MOVE DISTHD-RCVR-SEQ-NBR         TO PV-SAVE-REC-SEQ-NBR      27270017
272800                                         DK-REC-SEQ-NBR           27280017
272900     MOVE PV-ARRIVE-DTE               TO PV-SAVE-ARRIVE-DTE       27290017
273000     MOVE PURCHS-DEPT-NBR             TO PV-SAVE-DEPT-NBR         27300017
273100                                                                  27310017
273200     PERFORM 8400-CHECK-AUTOVE                                    27320017
273300                                                                  27330017
273400     PERFORM 4300-READ-ITEMS-FROM-DB                              27340017
273500             VARYING PV-READ-COUNT                                27350017
273600             FROM 1 BY 1                                          27360017
273700             UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                27370017
273800                OR (ASC-NO-ITEMS-LEFT-ON-DB))                     27380017
273900                                                                  27390017
274000     PERFORM 4020-CLOSE-CURSOR                                    27400017
274100                                                                  27410017
274200*    IF  PV-ROWS-FETCHED > ZERO                                   27420017
274300                                                                  27430017
274400         IF PS-SHOW-RCVR-YES                                      27440017
274500             PERFORM 4300A-BLOCK-SUBSCRIPTS                       27450017
274600             PERFORM 4306-CONTROL-BREAK                           27460017
274700             SET PS-SHOW-RCVR-NO      TO TRUE                     27470017
274800         END-IF                                                   27480017
274900                                                                  27490017
275000         MOVE +1                   TO ASC-BLK-SUB                 27500017
275100         PERFORM 5100-WRITE-TEMP-STORAGE                          27510017
275200         ADD +1                    TO ASC-BLK-SUB                 27520017
275300         PERFORM 5100-WRITE-TEMP-STORAGE                          27530017
275400                                                                  27540017
275500         MOVE 1                    TO ASC-BLK-SUB                 27550017
275600                                      PV-BLOCK-NUMBER             27560017
275700         PERFORM 4410-READ-TEMP-STORAGE                           27570017
275800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             27580017
275900             MOVE 2                TO ASC-BLK-SUB                 27590017
276000                                      PV-BLOCK-NUMBER             27600017
276100             PERFORM 4410-READ-TEMP-STORAGE                       27610017
276200         END-IF.                                                  27620017
276300*    END-IF.                                                      27630017
276400                                                                  27640017
276500     MOVE +1                          TO PV-TOP-ITEM.             27650017
276600                                                                  27660017
276700     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          27670017
276800         IF DP020-NEXT-ACT-INITIAL                                27680017
276900             SET DP020-NEXT-ACT-APPL-ERROR                        27690017
277000                                      TO TRUE                     27700017
277100             SET DP020-MSG-FATAL      TO TRUE                     27710017
277200             MOVE PC-TSYMSG-00050     TO DP020-MSG-NUMBER         27720017
277300         ELSE                                                     27730017
277400             SET DP020-MSG-FATAL      TO TRUE                     27740017
277500             MOVE PC-TSYMSG-00050     TO DP020-MSG-NUMBER         27750017
277600             SET ASC-BLOCK-MODIFIED (1)                           27760017
277700                 ASC-BLOCK-MODIFIED (2)                           27770017
277800                                   TO TRUE                        27780017
277900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 27790017
278000         END-IF                                                   27800017
278100     ELSE                                                         27810017
278200         MOVE -1                   TO MR-SELECTL (1)              27820017
278300         SET DP030-SET-CURSOR-APPL-1                              27830017
278400                                   TO TRUE                        27840017
278500         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     27850017
278600     END-IF.                                                      27860017
278700/                                                                 27870017
278800 4010-OPEN-CURSOR.                                                27880017
278900                                                                  27890017
279000     EVALUATE TRUE                                                27900017
279100     WHEN ASC-OPER-CSR                                            27910017
279200         IF ASC-ARRIVAL-SEQ                                       27920017
279300             MOVE 'SUSPEND1-DATE-CSR'          TO PV-MESSAGE-TEXT 27930017
279400             EXEC SQL                                             27940017
279500                 OPEN SUSPEND1-DATE-CSR                           27950017
279600             END-EXEC                                             27960017
279700         ELSE                                                     27970017
279800             MOVE 'SUSPEND1-CSR'          TO PV-MESSAGE-TEXT      27980017
279900             EXEC SQL                                             27990017
280000                 OPEN SUSPEND1-CSR                                28000017
280100             END-EXEC                                             28010017
280200         END-IF                                                   28020017
280300     WHEN ASC-PO-CSR                                              28030017
280400         IF ASC-ARRIVAL-SEQ                                       28040017
280500             MOVE 'SUSPEND2-DATE-CSR' TO PV-MESSAGE-TEXT          28050017
280600             EXEC SQL                                             28060017
280700                 OPEN SUSPEND2-DATE-CSR                           28070017
280800             END-EXEC                                             28080017
280900         ELSE                                                     28090017
281000             MOVE 'SUSPEND2-CSR'      TO PV-MESSAGE-TEXT          28100017
281100             EXEC SQL                                             28110017
281200                 OPEN SUSPEND2-CSR                                28120017
281300             END-EXEC                                             28130017
281400         END-IF                                                   28140017
281500                                                                  28150017
281600     WHEN ASC-RCVR-CSR                                            28160017
281700         IF ASC-ARRIVAL-SEQ                                       28170017
281800             MOVE 'SUSPEND3-DATE-CSR' TO PV-MESSAGE-TEXT          28180017
281900             EXEC SQL                                             28190017
282000                 OPEN SUSPEND3-DATE-CSR                           28200017
282100             END-EXEC                                             28210017
282200         ELSE                                                     28220017
282300             MOVE 'SUSPEND3-CSR'      TO PV-MESSAGE-TEXT          28230017
282400             EXEC SQL                                             28240017
282500                 OPEN SUSPEND3-CSR                                28250017
282600             END-EXEC                                             28260017
282700         END-IF                                                   28270017
282800     WHEN ASC-TRIP-CSR                                            28280017
282900     IF ASC-ARRIVAL-SEQ                                           28290017
283000         MOVE 'SUSPEND4-DATE-CSR'  TO PV-MESSAGE-TEXT             28300017
283100         EXEC SQL                                                 28310017
283200             OPEN SUSPEND4-DATE-CSR                               28320017
283300         END-EXEC                                                 28330017
283400     ELSE                                                         28340017
283500         MOVE 'SUSPEND4-CSR'   TO PV-MESSAGE-TEXT                 28350017
283600         EXEC SQL                                                 28360017
283700             OPEN SUSPEND4-CSR                                    28370017
283800         END-EXEC                                                 28380017
283900     END-IF                                                       28390017
284000                                                                  28400017
284100     END-EVALUATE                                                 28410017
284200                                                                  28420017
284300     EVALUATE TRUE                                                28430017
284400         WHEN SQLCODE = ZERO                                      28440017
284500              CONTINUE                                            28450017
284600         WHEN SQLCODE = -904                                      28460017
284700         WHEN SQLCODE = -911                                      28470017
284800         WHEN SQLCODE = -913                                      28480017
284900             PERFORM 9900-SOFT-ABORT                              28490017
285000         WHEN SQLWARN0 NOT = SPACE                                28500017
285100         WHEN SQLCODE  NOT = ZERO                                 28510017
285200             MOVE '4010-OPEN-CURSOR'  TO DP013-PARAGRAPH          28520017
285300             MOVE 'OPEN SUSPEND-CSR CURSOR'                       28530017
285400                                      TO DP013-MESSAGE-TEXT (1)   28540017
285500             MOVE PV-MESSAGE-TEXT     TO DP013-MESSAGE-TEXT (2)   28550017
285600             MOVE SQLCA               TO DP013-SQLCA              28560017
285700             MOVE 'TDISTHD'           TO DP013-DB2-TABLE-NAME (1) 28570017
285800             SET DP013-DB2-ABEND                                  28580017
285900                                   TO TRUE                        28590017
286000             PERFORM DP013-0000-PROCESS-ABEND                     28600017
286100     END-EVALUATE.                                                28610017
286200/                                                                 28620017
286300 4020-CLOSE-CURSOR.                                               28630017
286400                                                                  28640017
286500     EVALUATE TRUE                                                28650017
286600     WHEN ASC-OPER-CSR                                            28660017
286700         IF ASC-ARRIVAL-SEQ                                       28670017
286800             MOVE 'SUSPEND1-DATE-CSR' TO PV-MESSAGE-TEXT          28680017
286900             EXEC SQL                                             28690017
287000                 CLOSE SUSPEND1-DATE-CSR                          28700017
287100             END-EXEC                                             28710017
287200         ELSE                                                     28720017
287300             MOVE 'SUSPEND1-CSR'      TO PV-MESSAGE-TEXT          28730017
287400             EXEC SQL                                             28740017
287500                 CLOSE SUSPEND1-CSR                               28750017
287600             END-EXEC                                             28760017
287700         END-IF                                                   28770017
287800                                                                  28780017
287900     WHEN ASC-PO-CSR                                              28790017
288000         IF ASC-ARRIVAL-SEQ                                       28800017
288100             MOVE 'SUSPEND2-DATE-CSR' TO PV-MESSAGE-TEXT          28810017
288200             EXEC SQL                                             28820017
288300                 CLOSE SUSPEND2-DATE-CSR                          28830017
288400             END-EXEC                                             28840017
288500         ELSE                                                     28850017
288600             MOVE 'SUSPEND2-CSR'      TO PV-MESSAGE-TEXT          28860017
288700             EXEC SQL                                             28870017
288800                 CLOSE SUSPEND2-CSR                               28880017
288900             END-EXEC                                             28890017
289000         END-IF                                                   28900017
289100     WHEN ASC-RCVR-CSR                                            28910017
289200         IF ASC-ARRIVAL-SEQ                                       28920017
289300             MOVE 'SUSPEND3-DATE-CSR'      TO PV-MESSAGE-TEXT     28930017
289400             EXEC SQL                                             28940017
289500                 CLOSE SUSPEND3-DATE-CSR                          28950017
289600             END-EXEC                                             28960017
289700         ELSE                                                     28970017
289800             MOVE 'SUSPEND3-CSR'      TO PV-MESSAGE-TEXT          28980017
289900             EXEC SQL                                             28990017
290000                 CLOSE SUSPEND3-CSR                               29000017
290100             END-EXEC                                             29010017
290200         END-IF                                                   29020017
290300         WHEN ASC-TRIP-CSR                                        29030017
290400     IF ASC-ARRIVAL-SEQ                                           29040017
290500         MOVE 'SUSPEND4-DATE-CSR'   TO PV-MESSAGE-TEXT            29050017
290600         EXEC SQL                                                 29060017
290700             CLOSE SUSPEND4-DATE-CSR                              29070017
290800         END-EXEC                                                 29080017
290900     ELSE                                                         29090017
291000         MOVE 'SUSPEND4-CSR'  TO PV-MESSAGE-TEXT                  29100017
291100         EXEC SQL                                                 29110017
291200             CLOSE SUSPEND4-CSR                                   29120017
291300         END-EXEC                                                 29130017
291400     END-IF                                                       29140017
291500                                                                  29150017
291600     END-EVALUATE                                                 29160017
291700                                                                  29170017
291800                                                                  29180017
291900     EVALUATE TRUE                                                29190017
292000         WHEN SQLCODE = ZERO                                      29200017
292100              CONTINUE                                            29210017
292200         WHEN SQLWARN0 NOT = SPACE                                29220017
292300         WHEN SQLCODE  NOT = ZERO                                 29230017
292400              MOVE '4020-CLOSE-CURSOR'                            29240017
292500                                      TO DP013-PARAGRAPH          29250017
292600              MOVE 'CLOSE SUSPEND-CSR CURSOR'                     29260017
292700                                      TO DP013-MESSAGE-TEXT (1)   29270017
292800             MOVE PV-MESSAGE-TEXT     TO DP013-MESSAGE-TEXT (2)   29280017
292900              MOVE SQLCA              TO DP013-SQLCA              29290017
293000              MOVE 'TDISTHD'          TO DP013-DB2-TABLE-NAME (1) 29300017
293100              SET DP013-DB2-ABEND     TO TRUE                     29310017
293200              PERFORM DP013-0000-PROCESS-ABEND                    29320017
293300     END-EVALUATE.                                                29330017
293400/                                                                 29340017
293500*----------------------------------------------------------------*29350017
293600*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *29360017
293700*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSOR.                *29370017
293800*----------------------------------------------------------------*29380017
293900                                                                  29390017
294000 4100-PREPARE-CURSOR.                                             29400017
294100     IF ASC-USE-SELECTION-QUEUE                                   29410017
294200         MOVE ASC-KEY-OPER-UNT-ID TO RC015-OPER-UNT-ID            29420017
294300         MOVE ASC-KEY-FCLTY-ID    TO RC015-FCLTY-ID               29430017
294400         MOVE ASC-KEY-PO-NBR      TO RC015-PO-NBR                 29440017
294500         MOVE ASC-KEY-REC-SEQ-NBR TO RC015-REC-SEQ-NBR            29450017
294600     END-IF                                                       29460017
294700                                                                  29470017
294800     EVALUATE TRUE                                                29480017
294900     WHEN DP020-NEXT-ACT-READ-MAP                                 29490017
295000        MOVE ASC-KEY-OPER-UNT-ID      TO DK-OPER-UNT-ID           29500017
295100                                                                  29510017
295200        MOVE ASC-KEY-FCLTY-ID         TO DK-FCLTY-ID              29520017
295300        MOVE ASC-KEY-PO-NBR           TO DK-PO-NBR                29530017
295400        MOVE ASC-KEY-REC-SEQ-NBR      TO DK-REC-SEQ-NBR           29540017
295500     WHEN OTHER                                                   29550017
295600         MOVE RC015-OPER-UNT-ID       TO DK-OPER-UNT-ID           29560017
295700                                         ASC-KEY-OPER-UNT-ID      29570017
295800                                                                  29580017
295900         MOVE RC015-FCLTY-ID          TO DK-FCLTY-ID              29590017
296000                                         ASC-KEY-FCLTY-ID         29600017
296100                                                                  29610017
296200*        DEFAULT CURSOR IS BY OPER-UNT-ID                         29620017
296300         SET ASC-OPER-CSR             TO TRUE                     29630017
296400         IF RC015-PO-NBR > ZERO                                   29640017
296500             SET ASC-PO-CSR           TO TRUE                     29650017
296600             MOVE RC015-PO-NBR        TO DK-PO-NBR                29660017
296700                                         ASC-KEY-PO-NBR           29670017
296800         END-IF                                                   29680017
296900                                                                  29690017
297000         IF RC015-REC-SEQ-NBR > ZERO                              29700017
297100             SET ASC-RCVR-CSR         TO TRUE                     29710017
297200             MOVE RC015-REC-SEQ-NBR   TO DK-REC-SEQ-NBR           29720017
297300                                         ASC-KEY-REC-SEQ-NBR      29730017
297400         END-IF                                                   29740017
297500                                                                  29750017
297600         IF RC015-TRIP-ID > ZERO                                  29760017
297700             SET ASC-TRIP-CSR         TO TRUE                     29770017
297800             MOVE RC015-TRIP-ID       TO DK-TRIP-ID               29780017
297900                                           ASC-KEY-TRIP-ID        29790017
298000         END-IF                                                   29800017
298100     END-EVALUATE.                                                29810017
298200/                                                                 29820017
298300*----------------------------------------------------------------*29830017
298400*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *29840017
298500*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *29850017
298600*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *29860017
298700*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *29870017
298800*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *29880017
298900*                                                                *29890017
299000*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *29900017
299100*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *29910017
299200*    UPON INITIALIZATION.                                        *29920017
299300*----------------------------------------------------------------*29930017
299400                                                                  29940017
299500 4300-READ-ITEMS-FROM-DB.                                         29950017
299600                                                                  29960017
299700* 4300A-BLOCK-SUBSCRIPTS ADVANCES TO A NEW LINE ON THE SCREEN.    29970017
299800* WE ARE ONLY MOVING UNIQUE PO/RECEIVERS SO EVERY CURSOR ROW      29980017
299900* THAT IS FETCHED WILL NOT ALWAYS BE SHOWN ON THE SCREEN.         29990017
300000* THEREFORE THIS IS DONE ONLY ON A PO/REVCEIVER CONTROL BREAK     30000017
300100* OR ARRIVAL DATE CONTROL BREAK.                                  30010017
300200                                                                  30020017
300300                                                                  30030017
300400     IF ASC-ARRIVAL-SEQ                                           30040017
300500         IF PV-ARRIVE-DTE           =  PV-SAVE-ARRIVE-DTE AND     30050017
300600            DISTHD-ORD-NBR          =  PV-SAVE-PO-NBR AND         30060017
300700             DISTHD-RCVR-SEQ-NBR    =  PV-SAVE-REC-SEQ-NBR        30070017
300800             PERFORM 4305-PROCESS-UNIQUE-RVCR                     30080017
300900         ELSE                                                     30090017
301000             IF PS-SHOW-RCVR-YES                                  30100017
301100                 PERFORM 4300A-BLOCK-SUBSCRIPTS                   30110017
301200                 PERFORM 4306-CONTROL-BREAK                       30120017
301300                 SET PS-SHOW-RCVR-NO  TO TRUE                     30130017
301400             END-IF                                               30140017
301500*             SET THE ERROR SWITCHES TO 'N'                       30150017
301600             INITIALIZE PS-RECEIVER-ERROR-SWITCHES                30160017
301700                 REPLACING ALPHANUMERIC DATA BY 'N'               30170017
301800                                                                  30180017
301900             INITIALIZE PV-STATUS-COUNTERS                        30190017
302000             MOVE ZERO                TO PV-ERROR-COUNT           30200017
302100                                                                  30210017
302200             MOVE DISTHD-ORD-NBR      TO PV-SAVE-PO-NBR           30220017
302300                                         DK-PO-NBR                30230017
302400             MOVE DISTHD-RCVR-SEQ-NBR TO PV-SAVE-REC-SEQ-NBR      30240017
302500                                         DK-REC-SEQ-NBR           30250017
302600             MOVE PV-ARRIVE-DTE       TO PV-SAVE-ARRIVE-DTE       30260017
302700             MOVE PURCHS-DEPT-NBR     TO PV-SAVE-DEPT-NBR         30270017
302800             MOVE ZERO                TO PV-SUSPEND-COUNT         30280017
302900                                                                  30290017
303000             PERFORM 8400-CHECK-AUTOVE                            30300017
303100             PERFORM 4305-PROCESS-UNIQUE-RVCR                     30310017
303200         END-IF                                                   30320017
303300                                                                  30330017
303400     ELSE                                                         30340017
303500                                                                  30350017
303600         IF DISTHD-ORD-NBR          =  PV-SAVE-PO-NBR AND         30360017
303700             DISTHD-RCVR-SEQ-NBR    =  PV-SAVE-REC-SEQ-NBR        30370017
303800                 PERFORM 4305-PROCESS-UNIQUE-RVCR                 30380017
303900         ELSE                                                     30390017
304000             IF PS-SHOW-RCVR-YES                                  30400017
304100                 PERFORM 4300A-BLOCK-SUBSCRIPTS                   30410017
304200                 PERFORM 4306-CONTROL-BREAK                       30420017
304300                 SET PS-SHOW-RCVR-NO  TO TRUE                     30430017
304400             END-IF                                               30440017
304500*             SET THE ERROR SWITCHES TO 'N'                       30450017
304600             INITIALIZE PS-RECEIVER-ERROR-SWITCHES                30460017
304700                 REPLACING ALPHANUMERIC DATA BY 'N'               30470017
304800                                                                  30480017
304900             INITIALIZE PV-STATUS-COUNTERS                        30490017
305000             MOVE ZERO                TO PV-ERROR-COUNT           30500017
305100                                                                  30510017
305200             MOVE ZERO                TO PV-SUSPEND-COUNT         30520017
305300             MOVE DISTHD-ORD-NBR      TO PV-SAVE-PO-NBR           30530017
305400                                         DK-PO-NBR                30540017
305500             MOVE DISTHD-RCVR-SEQ-NBR TO PV-SAVE-REC-SEQ-NBR      30550017
305600                                         DK-REC-SEQ-NBR           30560017
305700             MOVE PURCHS-DEPT-NBR     TO PV-SAVE-DEPT-NBR         30570017
305800             PERFORM 8400-CHECK-AUTOVE                            30580017
305900             PERFORM 4305-PROCESS-UNIQUE-RVCR                     30590017
306000                                                                  30600017
306100         END-IF                                                   30610017
306200     END-IF                                                       30620017
306300                                                                  30630017
306400     PERFORM 4310-FETCH.                                          30640017
306500                                                                  30650017
306600 4300A-BLOCK-SUBSCRIPTS.                                          30660017
306700                                                                  30670017
306800     IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                        30680017
306900         ADD +1            TO ASC-ITEM-SUB                        30690017
307000     ELSE                                                         30700017
307100         ADD +1            TO ASC-BLK-SUB                         30710017
307200         MOVE +1           TO ASC-ITEM-SUB                        30720017
307300                                                                  30730017
307400         IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY                 30740017
307500             MOVE +1       TO ASC-BLK-SUB                         30750017
307600             SET ASC-BLOCK-MODIFIED (1)                           30760017
307700                                   TO TRUE                        30770017
307800             PERFORM 5100-WRITE-TEMP-STORAGE                      30780017
307900             MOVE ASC-BLOCK-ENTRIES                               30790017
308000                               (PC-MAX-BLOCKS-IN-ARRAY)           30800017
308100                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 30810017
308200             ADD +1        TO ASC-BLK-SUB                         30820017
308300             INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           30830017
308400             SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)              30840017
308500                                   TO TRUE                        30850017
308600         END-IF                                                   30860017
308700     END-IF.                                                      30870017
308800                                                                  30880017
308900     ADD +1                TO ASC-NUMBER-OF-ITEMS-READ            30890017
309000     MOVE ASC-NUMBER-OF-ITEMS-READ                                30900017
309100                                   TO ASC-LIST-ITEM-NUMBER        30910017
309200                                      (ASC-BLK-SUB ASC-ITEM-SUB). 30920017
309300                                                                  30930017
309400/                                                                 30940017
309500 4305-PROCESS-UNIQUE-RVCR.                                        30950017
309600                                                                  30960017
309700     IF PV-SAVE-PACK-BY-ST-IND = 'Y'                              30970017
309800         SET PS-SHOW-RCVR-YES         TO TRUE                     30980017
309900     ELSE                                                         30990017
310000         IF PS-SHOW-RCVR-NO                                       31000017
310100             PERFORM 7215-GET-RECITM-STATUS                       31010017
310200         END-IF                                                   31020017
310300                                                                  31030017
310400     END-IF                                                       31040017
310500                                                                  31050017
310600     MOVE PV-ARRIVE-DTE               TO PV-SAVE-ARRIVE-DTE       31060017
310700     PERFORM 8000-VEM-MODULE.                                     31070017
310800                                                                  31080017
310900     PERFORM 4305A-DETERMINE-STATUS.                              31090017
311000/                                                                 31100017
311100 4305A-DETERMINE-STATUS.                                          31110017
311200                                                                  31120017
311300     SET PS-NO-DTL-ERROR              TO TRUE                     31130017
311400     EVALUATE TRUE                                                31140017
311500         WHEN RC038-OPEN-SYSTEM-AUDIT                             31150017
311600             SET PS-DTL-ERROR TO TRUE                             31160017
311700             IF  DISTHD-PRCG-STAT-CDE = 'K'                       31170017
311800                 SET PS-OPEN-AUDIT-SUSPND-CNFRM                   31180017
311900                                      TO TRUE                     31190017
312000             ELSE                                                 31200017
312100                 SET PS-OPEN-SYSTEM-AUDIT-ERROR                   31210017
312200                                      TO TRUE                     31220017
312300             END-IF                                               31230017
312400         WHEN RC038-DISTRO-NO-MATCH                               31240017
312500             SET PS-DTL-ERROR                                     31250017
312600                 PS-DISTRO-NO-MATCH-ERROR                         31260017
312700                                      TO TRUE                     31270017
312800         WHEN RC038-NO-PRO                                        31280017
312900             SET PS-DTL-ERROR                                     31290017
313000                 PS-NO-PRO-ERROR      TO TRUE                     31300017
313100         WHEN RC038-STORE-INVENTORY                               31310017
313200             SET PS-DTL-ERROR                                     31320017
313300                 PS-STORE-INVENTORY-ERROR                         31330017
313400                                      TO TRUE                     31340017
313500         WHEN RC038-RCVR-NOT-ACTIVE                               31350017
313600             SET PS-DTL-ERROR                                     31360017
313700                 PS-RCVR-NOT-ACTIVE-ERROR                         31370017
313800                                      TO TRUE                     31380017
313900         WHEN RC038-RCVR-NOT-FOUND                                31390017
314000             SET PS-DTL-ERROR                                     31400017
314100                 PS-RCVR-NOT-FOUND-ERROR                          31410017
314200                                      TO TRUE                     31420017
314300         WHEN RC038-LINE-NOT-FOUND                                31430017
314400             SET PS-DTL-ERROR                                     31440017
314500                 PS-LINE-NOT-FOUND-ERROR                          31450017
314600                                      TO TRUE                     31460017
314700         WHEN RC038-NOT-ARRIVED                                   31470017
314800             SET PS-DTL-ERROR                                     31480017
314900                 PS-NOT-ARRIVED-ERROR                             31490017
315000                                      TO TRUE                     31500017
315100         WHEN RC038-RECEIVER-ALREADY-VE                           31510017
315200             SET PS-DTL-ERROR                                     31520017
315300                 PS-RCVR-ALREADY-VE-ERROR                         31530017
315400                                      TO TRUE                     31540017
315500         WHEN RC038-LINE-ALREADY-VE                               31550017
315600             SET PS-DTL-ERROR                                     31560017
315700                 PS-LINE-ALREADY-VE-ERROR                         31570017
315800                                      TO TRUE                     31580017
315900                                                                  31590017
316000         WHEN RC038-RECV-TROUBLE                                  31600017
316100             SET PS-DTL-ERROR TO TRUE                             31610017
316200             IF  DISTHD-PRCG-STAT-CDE = 'L'                       31620017
316300                 SET PS-RCVR-TROUBLE-SUSP-CNFRM                   31630017
316400                                      TO TRUE                     31640017
316500             ELSE                                                 31650017
316600                 SET PS-RCVR-IN-TROUBLE-ERROR                     31660017
316700                                      TO TRUE                     31670017
316800             END-IF                                               31680017
316900         WHEN RC038-LINE-TROUBLE                                  31690017
317000             SET PS-DTL-ERROR TO TRUE                             31700017
317100             IF  DISTHD-PRCG-STAT-CDE = 'L'                       31710017
317200                 SET PS-LINE-TROUBLE-SUSP-CNFRM                   31720017
317300                                      TO TRUE                     31730017
317400             ELSE                                                 31740017
317500                 SET PS-LINE-IN-TROUBLE-ERROR                     31750017
317600                                      TO TRUE                     31760017
317700             END-IF                                               31770017
317800         WHEN RC038-LINE-NOT-VE                                   31780017
317900             SET PS-DTL-ERROR                                     31790017
318000                 PS-LINE-NOT-VE-ERROR TO TRUE                     31800017
318100                                                                  31810017
318200         WHEN RC038-CASEPACK-NOT-PERFORMED                        31820017
318300             SET PS-DTL-ERROR                                     31830017
318400                 PS-CASEPK-NOT-PERF-ERROR                         31840017
318500                                      TO TRUE                     31850017
318600         WHEN RC038-NOT-MANIFESTD                                 31860017
318700             SET PS-DTL-ERROR                                     31870017
318800                 PS-CARTON-NOT-MNFSTD-ERROR                       31880017
318900                                      TO TRUE                     31890017
319000     END-EVALUATE.                                                31900017
319100                                                                  31910017
319200                                                                  31920017
319300     EVALUATE DISTHD-PRCG-STAT-CDE                                31930017
319400     WHEN 'B'                                                     31940017
319500         SET PS-DTL-ERROR             TO TRUE                     31950017
319600         IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST              31960017
319700             SET PS-P2L-PRCG-INCOMP-ERROR                         31970017
319800                                      TO TRUE                     31980017
319900         END-IF                                                   31990017
320000         IF DISTHD-FCSE-CNFRMN-TMST = PC-DEFAULT-TMST             32000017
320100             SET PS-CONFIRM-NEEDED-ERROR                          32010017
320200                                      TO TRUE                     32020017
320300         END-IF                                                   32030017
320400     WHEN 'A'                                                     32040017
320500         SET PS-DTL-ERROR                                         32050017
320600             PS-NOT-MULT-OF-RATIO-ERROR                           32060017
320700                                      TO TRUE                     32070017
320800     END-EVALUATE.                                                32080017
320900                                                                  32090017
321000     IF PS-DTL-ERROR                                              32100017
321100         ADD 1                        TO PV-SUSPEND-COUNT         32110017
321200     ELSE                                                         32120017
321300         IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST              32130017
321400                 AND DISTHD-P2L-CART-CNT > 0                      32140017
321500             SET PS-P2L-PRCG-INCOMP-ERROR                         32150017
321600                 PS-DTL-ERROR         TO TRUE                     32160017
321700             ADD 1                    TO PV-SUSPEND-COUNT         32170011
321800         END-IF                                                   32180017
321900         IF DISTHD-FCSE-CNFRMN-TMST = PC-DEFAULT-TMST AND         32190017
322000            PV-SAVE-PACK-BY-ST-IND NOT = 'Y'                      32200017
322100             SET PS-DTL-ERROR                                     32210017
322200                 PS-CONFIRM-NEEDED-ERROR                          32220017
322300                                      TO TRUE                     32230017
322400             ADD 1                    TO PV-SUSPEND-COUNT         32240011
322500         END-IF                                                   32250017
322600     END-IF.                                                      32260017
322700/                                                                 32270017
322800 4306-CONTROL-BREAK.                                              32280017
322900                                                                  32290017
323000     MOVE PV-SAVE-PO-NBR      TO ASC-PO-NBR                       32300017
323100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32310017
323200     MOVE '-'                 TO ASC-DASH                         32320017
323300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32330017
323400     MOVE PV-SAVE-REC-SEQ-NBR TO ASC-REC-SEQ-NBR                  32340017
323500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32350017
323600                                                                  32360017
323700     PERFORM 7000-GET-VENDOR-NAME                                 32370017
323800     MOVE ENTNME-ENT-NAME-DESC        TO ASC-VENDNAME             32380017
323900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32390017
324000     MOVE PV-SAVE-DEPT-NBR            TO ASC-DEPT                 32400017
324100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32410017
324200                                                                  32420017
324300     MOVE PV-SAVE-ARRIVE-DTE          TO ASC-ARRIVE-DTE           32430017
324400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32440017
324500     IF PV-SAVE-ARRIVE-DTE = 'ENROUTE'                            32450017
324600         SET ASC-TRIP-NOT-ARRIVED (ASC-BLK-SUB ASC-ITEM-SUB)      32460017
324700                                      TO TRUE                     32470017
324800     ELSE                                                         32480017
324900         SET ASC-TRIP-ARRIVED (ASC-BLK-SUB ASC-ITEM-SUB)          32490017
325000                                      TO TRUE                     32500017
325100     END-IF                                                       32510017
325200                                                                  32520017
325300     MOVE PV-SAVE-PKGNG-CDE           TO ASC-PKG                  32530017
325400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32540017
325500                                                                  32550017
325600     PERFORM 4307-GET-PRCS-AREA.                                  32560017
325700                                                                  32570017
325800*    THE STATUS OF THE RECEIVER IS DETERMINED BY WHETHER OR       32580017
325900*    NOT ERRORS HAVE BEEN FOUND IN ANY OF ITS LINES.              32590017
326000                                                                  32600017
326100     INSPECT PS-RECEIVER-ERROR-SWITCHES                           32610017
326200             TALLYING PV-ERROR-COUNT FOR ALL 'Y'                  32620017
326300*    THIS SWITCH CONTROLS ACCESS TO TRAILER MAINT.                32630017
326400*    CANNOT DO MAINT IF THE TRAILER IS ARRIVED                    32640017
326500     IF PS-NOT-ARRIVED-ERROR                                      32650017
326600         SET ASC-TRIP-NOT-ARRIVED (ASC-BLK-SUB, ASC-ITEM-SUB)     32660017
326700                                       TO TRUE                    32670017
326800     END-IF                                                       32680017
326900                                                                  32690017
327000     EVALUATE TRUE                                                32700017
327100     WHEN PV-ERROR-COUNT > 1                                      32710017
327200         MOVE 'MULT   '               TO ASC-STATUS               32720017
327300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32730017
327400                                                                  32740017
327500     WHEN PS-OPEN-SYSTEM-AUDIT-ERROR                              32750017
327600         MOVE 'OPN SYS AUDIT'         TO ASC-STATUS               32760017
327700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32770017
327800     WHEN PS-OPEN-AUDIT-SUSPND-CNFRM                              32780017
327900         MOVE 'CNFM SUSP AU '         TO ASC-STATUS               32790017
328000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32800017
328100     WHEN PS-DISTRO-NO-MATCH-ERROR                                32810017
328200         MOVE 'STR MISMATCH '         TO ASC-STATUS               32820017
328300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32830017
328400     WHEN PS-NO-PRO-ERROR                                         32840017
328500         MOVE 'NO PRO NBR   '         TO ASC-STATUS               32850017
328600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32860017
328700     WHEN PS-STORE-INVENTORY-ERROR                                32870017
328800         MOVE 'STR INVENTORY'         TO ASC-STATUS               32880017
328900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32890017
329000     WHEN PS-RCVR-NOT-ACTIVE-ERROR                                32900017
329100         MOVE 'RCVR NOT ACTV'         TO ASC-STATUS               32910017
329200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32920017
329300     WHEN PS-RCVR-NOT-FOUND-ERROR                                 32930017
329400         MOVE 'RCVR NOT FND '         TO ASC-STATUS               32940017
329500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32950017
329600     WHEN PS-LINE-NOT-FOUND-ERROR                                 32960017
329700         MOVE 'LINE NOT FND '         TO ASC-STATUS               32970017
329800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32980017
329900     WHEN PS-NOT-ARRIVED-ERROR                                    32990017
330000         MOVE 'NOT ARRIVED  '         TO ASC-STATUS               33000017
330100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33010017
330200         PERFORM 7205-GET-TRIP-ID                                 33020017
330300         MOVE  VHTRIP-TRIP-ID         TO ASC-TRIP-ID              33030017
330400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33040017
330500         MOVE  VHTRIP-OWNER-SCAC-ID   TO ASC-SCAC-ID              33050017
330600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33060017
330700         MOVE  VHTRIP-VEH-NBR         TO ASC-VEH-NBR              33070017
330800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33080017
330900         MOVE  TRIPST-TRIP-STATUS-CDE TO ASC-TRIP-STAT-CDE        33090017
331000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33100017
331100         SET   ASC-TRIP-NOT-ARRIVED   (ASC-BLK-SUB ASC-ITEM-SUB)  33110017
331200                                      TO  TRUE                    33120017
331300                                                                  33130017
331400     WHEN PS-RCVR-ALREADY-VE-ERROR                                33140017
331500         MOVE 'RCVR VERIFIED'         TO ASC-STATUS               33150017
331600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33160017
331700     WHEN PS-LINE-ALREADY-VE-ERROR                                33170017
331800         MOVE 'LINE VERIFIED'         TO ASC-STATUS               33180017
331900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33190017
332000     WHEN PS-RCVR-IN-TROUBLE-ERROR                                33200017
332100         MOVE 'RCVR TROUBLE '         TO ASC-STATUS               33210017
332200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33220017
332300     WHEN PS-LINE-IN-TROUBLE-ERROR                                33230017
332400         MOVE 'LINE TROUBLE '         TO ASC-STATUS               33240017
332500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33250017
332600     WHEN PS-RCVR-TROUBLE-SUSP-CNFRM                              33260017
332700     WHEN PS-LINE-TROUBLE-SUSP-CNFRM                              33270017
332800         MOVE 'CNFM SUSP TR '         TO ASC-STATUS               33280017
332900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33290017
333000     WHEN PS-LINE-NOT-VE-ERROR                                    33300017
333100         MOVE 'LINE VERIFIED'         TO ASC-STATUS               33310017
333200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33320017
333300     WHEN PS-CASEPK-NOT-PERF-ERROR                                33330017
333400         MOVE 'CSPK NOT DONE'         TO ASC-STATUS               33340017
333500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33350017
333600     WHEN PS-P2L-PRCG-INCOMP-ERROR                                33360017
333700         MOVE 'P2L INCOMPLET'         TO ASC-STATUS               33370017
333800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33380017
333900     WHEN PS-CONFIRM-NEEDED-ERROR                                 33390017
334000         MOVE 'CNFRMN NEEDED'         TO ASC-STATUS               33400017
334100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33410017
334200     WHEN PS-NOT-MULT-OF-RATIO-ERROR                              33420017
334300         MOVE 'RATIO ERROR  '         TO ASC-STATUS               33430017
334400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33440017
334500     WHEN PS-CARTON-NOT-MNFSTD-ERROR                              33450017
334600         MOVE 'NOT MANIFESTD'         TO ASC-STATUS               33460017
334700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33470017
334800                                                                  33480017
334900     WHEN  OTHER                                                  33490017
335000         MOVE 'READY'                 TO ASC-STATUS               33500017
335100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33510017
335200     END-EVALUATE.                                                33520017
335300                                                                  33530017
335400     MOVE PV-SUSPEND-COUNT            TO ASC-SUSPEND-COUNT        33540017
335500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33550017
335600                                                                  33560017
335700     MOVE DISTHD-ORD-NBR      TO PV-SAVE-PO-NBR                   33570017
335800     MOVE DISTHD-RCVR-SEQ-NBR TO PV-SAVE-REC-SEQ-NBR              33580017
335900                                                                  33590017
336000* SET THE ERROR SWITCHES TO 'N'                                   33600017
336100     INITIALIZE PS-RECEIVER-ERROR-SWITCHES                        33610017
336200             REPLACING ALPHANUMERIC DATA BY 'N'                   33620017
336300                                                                  33630017
336400     INITIALIZE PV-STATUS-COUNTERS                                33640017
336500     MOVE ZERO                        TO PV-ERROR-COUNT.          33650017
336600                                                                  33660017
336700/                                                                 33670017
336800 4307-GET-PRCS-AREA.                                              33680017
336900     MOVE PV-SAVE-PO-NBR              TO DK-PO-NBR                33690017
337000     MOVE PV-SAVE-REC-SEQ-NBR         TO DK-REC-SEQ-NBR           33700017
337100                                                                  33710017
337200     MOVE SPACES                      TO PV-PRC-FCLTY-AREA-ID     33720017
337300     MOVE PC-DEFAULT-TMST             TO WKORIN-STRT-TMST         33730017
337400     SET PS-NOT-EOF-TWKORIN-CSR       TO TRUE                     33740017
337500     PERFORM 7300-OPEN-WORK-ORDER-CSR.                            33750017
337600     PERFORM 7305-FETCH-WORK-ORDER-CSR.                           33760017
337700     IF PS-EOF-TWKORIN-CSR                                        33770017
337800         CONTINUE                                                 33780017
337900     ELSE                                                         33790017
338000         MOVE WKORIN-PRC-FCLTY-AREA-ID TO PV-PRC-FCLTY-AREA-ID    33800017
338100     END-IF                                                       33810017
338200                                                                  33820017
338300     IF WKORIN-STRT-TMST = PC-DEFAULT-TMST                        33830017
338400         CONTINUE                                                 33840017
338500     ELSE                                                         33850017
338600         PERFORM UNTIL PS-EOF-TWKORIN-CSR                         33860017
338700             PERFORM 7305-FETCH-WORK-ORDER-CSR                    33870017
338800                                                                  33880017
338900             IF WKORIN-STRT-TMST = PC-DEFAULT-TMST                33890017
339000                 SET PS-EOF-TWKORIN-CSR TO TRUE                   33900017
339100             ELSE                                                 33910017
339200                 MOVE WKORIN-PRC-FCLTY-AREA-ID                    33920017
339300                                      TO PV-PRC-FCLTY-AREA-ID     33930017
339400             END-IF                                               33940017
339500                                                                  33950017
339600         END-PERFORM                                              33960017
339700     END-IF                                                       33970017
339800                                                                  33980017
339900     PERFORM 7310-CLOSE-WORK-ORDER-CSR.                           33990017
340000     MOVE PV-PRC-FCLTY-AREA-ID        TO ASC-AREA                 34000017
340100                                   (ASC-BLK-SUB, ASC-ITEM-SUB).   34010017
340200/                                                                 34020017
340300 4310-FETCH.                                                      34030017
340400                                                                  34040017
340500     EVALUATE TRUE                                                34050017
340600                                                                  34060017
340700     WHEN ASC-OPER-CSR                                            34070017
340800         IF ASC-ARRIVAL-SEQ                                       34080017
340900             MOVE 'SUSPEND1-DATE-CSR'     TO PV-MESSAGE-TEXT      34090017
341000             EXEC SQL                                             34100017
341100                 FETCH SUSPEND1-DATE-CSR                          34110017
341200             INTO                                                 34120017
341300                  :DISTHD-ORD-NBR                                 34130017
341400                , :DISTHD-RCVR-SEQ-NBR                            34140017
341500                , :DISTHD-ORD-LNE-NBR                             34150017
341600                , :DISTHD-PRCG-STAT-CDE                           34160017
341700                , :DISTHD-RSLTS-RCVD-TMST                         34170017
341800                , :DISTHD-FCSE-CNFRMN-TMST                        34180017
341900                , :PV-ARRIVE-DTE                                  34190017
342000                , :RECEIV-REC-TMST                                34200017
342100                , :RECEIV-PKGNG-CDE                               34210017
342200                , :PV-SAVE-PACK-BY-ST-IND                         34220017
342300                , :PURCHS-DEPT-NBR                                34230017
342400                , :DISTHD-P2L-CART-CNT                            34240017
342500             END-EXEC                                             34250017
342600         ELSE                                                     34260017
342700         MOVE 'SUSPEND1-CSR'          TO PV-MESSAGE-TEXT          34270017
342800         EXEC SQL                                                 34280017
342900             FETCH SUSPEND1-CSR                                   34290017
343000             INTO                                                 34300017
343100                  :DISTHD-ORD-NBR                                 34310017
343200                , :DISTHD-RCVR-SEQ-NBR                            34320017
343300                , :DISTHD-ORD-LNE-NBR                             34330017
343400                , :DISTHD-PRCG-STAT-CDE                           34340017
343500                , :DISTHD-RSLTS-RCVD-TMST                         34350017
343600                , :DISTHD-FCSE-CNFRMN-TMST                        34360017
343700                , :PV-ARRIVE-DTE                                  34370017
343800                , :RECEIV-REC-TMST                                34380017
343900                , :RECEIV-PKGNG-CDE                               34390017
344000                , :PV-SAVE-PACK-BY-ST-IND                         34400017
344100                , :PURCHS-DEPT-NBR                                34410017
344200                , :DISTHD-P2L-CART-CNT                            34420017
344300         END-EXEC                                                 34430017
344400         END-IF                                                   34440017
344500                                                                  34450017
344600     WHEN ASC-PO-CSR                                              34460017
344700         IF ASC-ARRIVAL-SEQ                                       34470017
344800             MOVE 'SUSPEND2-DATE-CSR'      TO PV-MESSAGE-TEXT     34480017
344900             EXEC SQL                                             34490017
345000                 FETCH SUSPEND2-DATE-CSR                          34500017
345100                 INTO                                             34510017
345200                      :DISTHD-ORD-NBR                             34520017
345300                    , :DISTHD-RCVR-SEQ-NBR                        34530017
345400                    , :DISTHD-ORD-LNE-NBR                         34540017
345500                    , :DISTHD-PRCG-STAT-CDE                       34550017
345600                    , :DISTHD-RSLTS-RCVD-TMST                     34560017
345700                    , :DISTHD-FCSE-CNFRMN-TMST                    34570017
345800                    , :PV-ARRIVE-DTE                              34580017
345900                    , :RECEIV-REC-TMST                            34590017
346000                    , :RECEIV-PKGNG-CDE                           34600017
346100                    , :PV-SAVE-PACK-BY-ST-IND                     34610017
346200                    , :PURCHS-DEPT-NBR                            34620017
346300                    , :DISTHD-P2L-CART-CNT                        34630017
346400             END-EXEC                                             34640017
346500         ELSE                                                     34650017
346600             MOVE 'SUSPEND2-CSR'      TO PV-MESSAGE-TEXT          34660017
346700             EXEC SQL                                             34670017
346800                 FETCH SUSPEND2-CSR                               34680017
346900                 INTO                                             34690017
347000                      :DISTHD-ORD-NBR                             34700017
347100                    , :DISTHD-RCVR-SEQ-NBR                        34710017
347200                    , :DISTHD-ORD-LNE-NBR                         34720017
347300                    , :DISTHD-PRCG-STAT-CDE                       34730017
347400                    , :DISTHD-RSLTS-RCVD-TMST                     34740017
347500                    , :DISTHD-FCSE-CNFRMN-TMST                    34750017
347600                    , :PV-ARRIVE-DTE                              34760017
347700                    , :RECEIV-REC-TMST                            34770017
347800                    , :RECEIV-PKGNG-CDE                           34780017
347900                    , :PV-SAVE-PACK-BY-ST-IND                     34790017
348000                    , :PURCHS-DEPT-NBR                            34800017
348100                    , :DISTHD-P2L-CART-CNT                        34810017
348200             END-EXEC                                             34820017
348300         END-IF                                                   34830017
348400                                                                  34840017
348500     WHEN ASC-RCVR-CSR                                            34850017
348600         IF ASC-ARRIVAL-SEQ                                       34860017
348700         MOVE 'SUSPEND3-DATE-CSR'     TO PV-MESSAGE-TEXT          34870017
348800         EXEC SQL                                                 34880017
348900             FETCH SUSPEND3-DATE-CSR                              34890017
349000             INTO                                                 34900017
349100                  :DISTHD-ORD-NBR                                 34910017
349200                , :DISTHD-RCVR-SEQ-NBR                            34920017
349300                , :DISTHD-ORD-LNE-NBR                             34930017
349400                , :DISTHD-PRCG-STAT-CDE                           34940017
349500                , :DISTHD-RSLTS-RCVD-TMST                         34950017
349600                , :DISTHD-FCSE-CNFRMN-TMST                        34960017
349700                , :PV-ARRIVE-DTE                                  34970017
349800                , :RECEIV-REC-TMST                                34980017
349900                , :RECEIV-PKGNG-CDE                               34990017
350000                , :PV-SAVE-PACK-BY-ST-IND                         35000017
350100                , :PURCHS-DEPT-NBR                                35010017
350200                , :DISTHD-P2L-CART-CNT                            35020017
350300         END-EXEC                                                 35030017
350400     ELSE                                                         35040017
350500         MOVE 'SUSPEND3-CSR'          TO PV-MESSAGE-TEXT          35050017
350600         EXEC SQL                                                 35060017
350700             FETCH SUSPEND3-CSR                                   35070017
350800             INTO                                                 35080017
350900                  :DISTHD-ORD-NBR                                 35090017
351000                , :DISTHD-RCVR-SEQ-NBR                            35100017
351100                , :DISTHD-ORD-LNE-NBR                             35110017
351200                , :DISTHD-PRCG-STAT-CDE                           35120017
351300                , :DISTHD-RSLTS-RCVD-TMST                         35130017
351400                , :DISTHD-FCSE-CNFRMN-TMST                        35140017
351500                , :PV-ARRIVE-DTE                                  35150017
351600                , :RECEIV-REC-TMST                                35160017
351700                , :RECEIV-PKGNG-CDE                               35170017
351800                , :PV-SAVE-PACK-BY-ST-IND                         35180017
351900                , :PURCHS-DEPT-NBR                                35190017
352000                , :DISTHD-P2L-CART-CNT                            35200017
352100         END-EXEC                                                 35210017
352200         END-IF                                                   35220017
352300                                                                  35230017
352400     WHEN ASC-TRIP-CSR                                            35240017
352500         IF ASC-ARRIVAL-SEQ                                       35250017
352600         MOVE 'SUSPEND4-DATE-CSR'   TO PV-MESSAGE-TEXT            35260017
352700         EXEC SQL                                                 35270017
352800             FETCH SUSPEND4-DATE-CSR                              35280017
352900             INTO                                                 35290017
353000                  :DISTHD-ORD-NBR                                 35300017
353100                , :DISTHD-RCVR-SEQ-NBR                            35310017
353200                , :DISTHD-ORD-LNE-NBR                             35320017
353300                , :DISTHD-PRCG-STAT-CDE                           35330017
353400                , :DISTHD-RSLTS-RCVD-TMST                         35340017
353500                , :DISTHD-FCSE-CNFRMN-TMST                        35350017
353600                , :PV-ARRIVE-DTE                                  35360017
353700                , :RECEIV-REC-TMST                                35370017
353800                , :RECEIV-PKGNG-CDE                               35380017
353900                , :PV-SAVE-PACK-BY-ST-IND                         35390017
354000                , :PURCHS-DEPT-NBR                                35400017
354100                , :DISTHD-P2L-CART-CNT                            35410017
354200         END-EXEC                                                 35420017
354300     ELSE                                                         35430017
354400         MOVE 'SUSPEND4-CSR'  TO PV-MESSAGE-TEXT                  35440017
354500         EXEC SQL                                                 35450017
354600             FETCH SUSPEND4-CSR                                   35460017
354700             INTO                                                 35470017
354800                  :DISTHD-ORD-NBR                                 35480017
354900                , :DISTHD-RCVR-SEQ-NBR                            35490017
355000                , :DISTHD-ORD-LNE-NBR                             35500017
355100                , :DISTHD-PRCG-STAT-CDE                           35510017
355200                , :DISTHD-RSLTS-RCVD-TMST                         35520017
355300                , :DISTHD-FCSE-CNFRMN-TMST                        35530017
355400                , :PV-ARRIVE-DTE                                  35540017
355500                , :RECEIV-REC-TMST                                35550017
355600                , :RECEIV-PKGNG-CDE                               35560017
355700                , :PV-SAVE-PACK-BY-ST-IND                         35570017
355800                , :PURCHS-DEPT-NBR                                35580017
355900                , :DISTHD-P2L-CART-CNT                            35590017
356000         END-EXEC                                                 35600017
356100         END-IF                                                   35610017
356200     END-EVALUATE                                                 35620017
356300                                                                  35630017
356400     EVALUATE TRUE                                                35640017
356500         WHEN SQLCODE = ZERO                                      35650017
356600             ADD 1                    TO PV-ROWS-FETCHED          35660017
356700         WHEN SQLCODE = +100                                      35670017
356800              SET ASC-NO-ITEMS-LEFT-ON-DB                         35680017
356900                                      TO TRUE                     35690017
357000*            FORCE A CONTROL BREAK TO SHOW THE LAST ITEM          35700017
357100             MOVE 999999999           TO DISTHD-ORD-NBR           35710017
357200         WHEN SQLCODE = -904                                      35720017
357300         WHEN SQLCODE = -911                                      35730017
357400         WHEN SQLCODE = -913                                      35740017
357500             PERFORM 9900-SOFT-ABORT                              35750017
357600         WHEN SQLWARN0 NOT = SPACE                                35760017
357700         WHEN SQLCODE < ZERO                                      35770017
357800         WHEN SQLCODE > ZERO                                      35780017
357900              MOVE '4310-FETCH-CURSOR'                            35790017
358000                                      TO DP013-PARAGRAPH          35800017
358100              MOVE 'FETCH SUSPEND CURSOR'                         35810017
358200                                      TO DP013-MESSAGE-TEXT (1)   35820017
358300              MOVE PV-MESSAGE-TEXT    TO DP013-MESSAGE-TEXT (2)   35830017
358400              MOVE SQLCA              TO DP013-SQLCA              35840017
358500              MOVE 'TDISTHD'          TO DP013-DB2-TABLE-NAME (1) 35850017
358600              SET DP013-DB2-ABEND     TO TRUE                     35860017
358700              PERFORM DP013-0000-PROCESS-ABEND                    35870017
358800     END-EVALUATE.                                                35880017
358900/                                                                 35890017
359000 4400-MOVE-COMMAREA-TO-SCREEN.                                    35900017
359100                                                                  35910017
359200     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             35920017
359300         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          35930017
359400         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          35940017
359500             MOVE +1               TO ASC-BLK-SUB                 35950017
359600                                                                  35960017
359700             PERFORM 5100-WRITE-TEMP-STORAGE                      35970017
359800                                                                  35980017
359900             ADD +1                TO ASC-BLK-SUB                 35990017
360000             PERFORM 5100-WRITE-TEMP-STORAGE                      36000017
360100                                                                  36010017
360200             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             36020017
360300                 GIVING PV-BLOCK-NUMBER                           36030017
360400                 REMAINDER PV-REMAINDER                           36040017
360500             IF  PV-REMAINDER > ZERO                              36050017
360600                 ADD +1            TO PV-BLOCK-NUMBER             36060017
360700             END-IF                                               36070017
360800                                                                  36080017
360900             MOVE +1               TO ASC-BLK-SUB                 36090017
361000             PERFORM 4410-READ-TEMP-STORAGE                       36100017
361100                                                                  36110017
361200             ADD +1                TO ASC-BLK-SUB                 36120017
361300                                      PV-BLOCK-NUMBER             36130017
361400             PERFORM 4410-READ-TEMP-STORAGE                       36140017
361500     END-IF.                                                      36150017
361600                                                                  36160017
361700     MOVE +1                       TO ASC-BLK-SUB.                36170017
361800                                                                  36180017
361900     COMPUTE ASC-ITEM-SUB =                                       36190017
362000         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              36200017
362100         + PC-ITEMS-PER-PANEL).                                   36210017
362200                                                                  36220017
362300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        36230017
362400         ADD +1                    TO ASC-BLK-SUB                 36240017
362500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            36250017
362600     END-IF.                                                      36260017
362700                                                                  36270017
362800     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           36280017
362900         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                36290017
363000                                                                  36300017
363100     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        36310017
363200                                                                  36320017
363300     PERFORM 4420-FORMAT-LIST-LINES                               36330017
363400         VARYING PV-SUB                                           36340017
363500         FROM PC-ITEMS-PER-PANEL BY -1                            36350017
363600         UNTIL PV-SUB < +1.                                       36360017
363700                                                                  36370017
363800     COMPUTE ASC-ITEMS-DISPLAYED =                                36380017
363900         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          36390017
364000                                                                  36400017
364100     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    36410017
364200                                      ASTRTITO.                   36420017
364300                                                                  36430017
364400     IF ASC-ARRIVAL-SEQ                                           36440017
364500         SET MR-ARRIVAL-SEQUENCE      TO TRUE                     36450017
364600     ELSE                                                         36460017
364700         SET MR-PO-SEQUENCE           TO TRUE                     36470017
364800     END-IF                                                       36480017
364900                                                                  36490017
365000     MOVE ASC-KEY-OPER-UNT-ID         TO MR-OPER.                 36500017
365100     MOVE ASC-LOC-NM                  TO MR-LOC-NM                36510017
365200                                                                  36520017
365300     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    36530017
365400     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    36540017
365500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            36550017
365600                                   TO ASELITO.                    36560017
365700                                                                  36570017
365800     IF  DP020-MSG-NUMBER-X = SPACE                               36580017
365900         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  36590017
366000*            --- MORE ITEMS TO DISPLAY ----                       36600017
366100             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            36610017
366200             SET DP020-MSG-INFORMATIONAL                          36620017
366300                                   TO TRUE                        36630017
366400         END-IF                                                   36640017
366500     END-IF.                                                      36650017
366600                                                                  36660017
366700*----------------------------------------------------------------*36670017
366800*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *36680017
366900*----------------------------------------------------------------*36690017
367000                                                                  36700017
367100 4410-READ-TEMP-STORAGE.                                          36710017
367200                                                                  36720017
367300     EXEC CICS                                                    36730017
367400         READQ TS                                                 36740017
367500             QUEUE (ASC-LIST-QUEUE-NAME)                          36750017
367600             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               36760017
367700             ITEM  (PV-BLOCK-NUMBER)                              36770017
367800             RESP  (PV-CICS-RESP)                                 36780017
367900     END-EXEC.                                                    36790017
368000                                                                  36800017
368100     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       36810017
368200       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     36820017
368300         CONTINUE                                                 36830017
368400     ELSE                                                         36840017
368500         SET DP013-CICS-ABEND      TO TRUE                        36850017
368600         SET DP013-NO-ROLLBACK     TO TRUE                        36860017
368700         MOVE '4410-READ-TEMP-STORAGE'                            36870017
368800                                   TO DP013-PARAGRAPH             36880017
368900         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      36890017
369000                                   TO DP013-MESSAGE-TEXT(1)       36900017
369100         PERFORM DP013-0000-PROCESS-ABEND                         36910017
369200     END-IF.                                                      36920017
369300                                                                  36930017
369400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      36940017
369500                                   TO TRUE.                       36950017
369600                                                                  36960017
369700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         36970017
369800         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               36980017
369900     END-IF.                                                      36990017
370000                                                                  37000017
370100/                                                                 37010017
370200*----------------------------------------------------------------*37020017
370300*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *37030017
370400*----------------------------------------------------------------*37040017
370500                                                                  37050017
370600 4420-FORMAT-LIST-LINES.                                          37060017
370700                                                                  37070017
370800     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      37080017
370900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                37090017
371000         MOVE DP015-ASK-DRK-OFF    TO MR-SELECTA (PV-SUB)         37100017
371100                                      MR-ACTIONA (PV-SUB)         37110017
371200         MOVE DP015-HL-OFF         TO MR-SELECTH (PV-SUB)         37120017
371300         MOVE SPACE                TO MR-SELECT  (PV-SUB)         37130017
371400                                      MR-ACTION  (PV-SUB)         37140017
371500                                      MR-AREA    (PV-SUB)         37150017
371600                                      MR-PO-RCVR   (PV-SUB)       37160017
371700                                      MR-DEPT-X (PV-SUB)          37170017
371800                                      MR-VENDNAME (PV-SUB)        37180017
371900                                      MR-PKG (PV-SUB)             37190017
372000                                      MR-ARRIVE-DTE (PV-SUB)      37200017
372100                                      MR-STATUS (PV-SUB)          37210017
372200                                      MR-SUSPEND-COUNT-X (PV-SUB) 37220017
372300     ELSE                                                         37230017
372400         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      37240017
372500                                                   > SPACE        37250017
372600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 37260017
372700                                   TO MR-SELECT  (PV-SUB)         37270017
372800         ELSE                                                     37280017
372900             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      37290017
373000                                   TO MR-SELECT  (PV-SUB)         37300017
373100         END-IF                                                   37310017
373200                                                                  37320017
373300         IF  DP030-SET-CURSOR-TRAILER                             37330017
373400             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)37340017
373500                 > SPACE)                                         37350017
373600               OR (PV-SUB = 1))                                   37360017
373700                SET DP030-SET-CURSOR-APPL-1 TO TRUE               37370017
373800                MOVE -1            TO MR-SELECTL (PV-SUB)         37380017
373900             END-IF                                               37390017
374000         END-IF                                                   37400017
374100                                                                  37410017
374200         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           37420017
374300             IF ASC-PO-NBR (ASC-BLK-SUB, ASC-ITEM-SUB) > ZERO     37430017
374400                 MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)       37440017
374500                                   TO MR-ACTION (PV-SUB)          37450017
374600                                                                  37460017
374700                 MOVE ASC-PO-NBR (ASC-BLK-SUB, ASC-ITEM-SUB)      37470017
374800                                   TO MR-PO-NBR (PV-SUB)          37480017
374900                 MOVE '-'              TO MR-DASH (PV-SUB)        37490017
375000                 MOVE ASC-REC-SEQ-NBR (ASC-BLK-SUB, ASC-ITEM-SUB) 37500017
375100                                   TO MR-REC-SEQ-NBR (PV-SUB)     37510017
375200                                                                  37520017
375300                 MOVE ASC-DEPT (ASC-BLK-SUB, ASC-ITEM-SUB)        37530017
375400                                   TO MR-DEPT-X (PV-SUB)          37540017
375500                 MOVE ASC-VENDNAME  (ASC-BLK-SUB, ASC-ITEM-SUB)   37550017
375600                                   TO MR-VENDNAME (PV-SUB)        37560017
375700                 MOVE ASC-PKG  (ASC-BLK-SUB, ASC-ITEM-SUB)        37570017
375800                                   TO MR-PKG (PV-SUB)             37580017
375900                 MOVE ASC-AREA (ASC-BLK-SUB, ASC-ITEM-SUB)        37590017
376000                                   TO MR-AREA (PV-SUB)            37600017
376100                 MOVE ASC-ARRIVE-DTE (ASC-BLK-SUB, ASC-ITEM-SUB)  37610017
376200                                 TO MR-ARRIVE-DTE (PV-SUB)        37620017
376300                 MOVE ASC-STATUS  (ASC-BLK-SUB, ASC-ITEM-SUB)     37630017
376400                                   TO MR-STATUS (PV-SUB)          37640017
376500                MOVE ASC-SUSPEND-COUNT (ASC-BLK-SUB, ASC-ITEM-SUB)37650017
376600                                   TO MR-SUSPEND-COUNT (PV-SUB)   37660017
376700*                ADD +1            TO ASC-ITEM-SUB                37670017
376800             END-IF                                               37680017
376900         END-IF                                                   37690017
377000     END-IF.                                                      37700017
377100                                                                  37710017
377200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               37720017
377300                                                                  37730017
377400     IF  ASC-ITEM-SUB < + 1                                       37740017
377500         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                37750017
377600         MOVE +1                   TO ASC-BLK-SUB                 37760017
377700     END-IF.                                                      37770017
377800                                                                  37780017
377900/                                                                 37790017
378000*----------------------------------------------------------------*37800017
378100*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *37810017
378200*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *37820017
378300*  ISSUE A WARNING.                                              *37830017
378400*----------------------------------------------------------------*37840017
378500 4430-CHECK-FOR-BEGIN-AND-END.                                    37850017
378600                                                                  37860017
378700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       37870017
378800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     37880017
378900*            -- NO END-OF-RANGE SPECFIED ---                      37890017
379000             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            37900017
379100             SET DP020-MSG-WARNING TO TRUE                        37910017
379200             PERFORM 4431-POSITION-AT-WARNING                     37920017
379300         END-IF                                                   37930017
379400     ELSE                                                         37940017
379500         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     37950017
379600*            -- NO BEGINNING-OF-RANGE SPECFIED ---                37960017
379700             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            37970017
379800             SET DP020-MSG-WARNING TO TRUE                        37980017
379900             PERFORM 4431-POSITION-AT-WARNING                     37990017
380000         END-IF                                                   38000017
380100     END-IF.                                                      38010017
380200                                                                  38020017
380300/                                                                 38030017
380400*----------------------------------------------------------------*38040017
380500*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *38050017
380600*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *38060017
380700*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *38070017
380800*  POSITION THE CURSOR THERE.                                    *38080017
380900*----------------------------------------------------------------*38090017
381000 4431-POSITION-AT-WARNING.                                        38100017
381100                                                                  38110017
381200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 38120017
381300                    - PV-TOP-ITEM + 1.                            38130017
381400                                                                  38140017
381500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      38150017
381600         CONTINUE                                                 38160017
381700     ELSE                                                         38170017
381800         SET DP030-SET-CURSOR-APPL-1                              38180017
381900                                   TO TRUE                        38190017
382000         MOVE -1                   TO MR-SELECTL (PV-SUB)         38200017
382100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         38210017
382200         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         38220017
382300     END-IF.                                                      38230017
382400                                                                  38240017
382500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   38250017
382600                    - PV-TOP-ITEM + 1.                            38260017
382700                                                                  38270017
382800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      38280017
382900         CONTINUE                                                 38290017
383000     ELSE                                                         38300017
383100         SET DP030-SET-CURSOR-APPL-1                              38310017
383200                                   TO TRUE                        38320017
383300         MOVE -1                   TO MR-SELECTL (PV-SUB)         38330017
383400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         38340017
383500         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         38350017
383600     END-IF.                                                      38360017
383700/                                                                 38370017
383800*----------------------------------------------------------------*38380017
383900* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *38390017
384000* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *38400017
384100* FOR THE SELECTED ITEMS QUEUE.                                  *38410017
384200*                                                                *38420017
384300* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *38430017
384400* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *38440017
384500* THE ARRAY IS FULL.                                             *38450017
384600*----------------------------------------------------------------*38460017
384700                                                                  38470017
384800 5000-PREPARE-SEL-QUEUE.                                          38480017
384900                                                                  38490017
385000     MOVE +1                       TO ASC-BLK-SUB.                38500017
385100     PERFORM 5100-WRITE-TEMP-STORAGE.                             38510017
385200     ADD +1                        TO ASC-BLK-SUB.                38520017
385300     PERFORM 5100-WRITE-TEMP-STORAGE.                             38530017
385400                                                                  38540017
385500     MOVE ASC-SEL-QUEUE-NAME       TO RC015-SEL-QUEUE-NAME.       38550017
385600     PERFORM 6010-DELETE-SEL-QUEUE.                               38560017
385700                                                                  38570017
385800     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                      38580017
385900         SET ASC-UPDATE-TSQ        TO TRUE                        38590017
386000     END-IF.                                                      38600017
386100                                                                  38610017
386200     SET RC013-IDX                 TO 1.                          38620017
386300     MOVE ZERO                     TO RC015-NUMBER-OF-TS-ITEMS.   38630017
386400     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        38640017
386500                                                                  38650017
386600                                                                  38660017
386700     EVALUATE TRUE                                                38670017
386800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              38680017
386900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              38690017
387000         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              38700017
387100*        WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              38710017
387200             PERFORM 5200-FILL-SEL-QUEUE-RECORD                   38720017
387300                 VARYING PV-ITEM  FROM 1 BY 1                     38730017
387400                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      38740017
387500                                                                  38750017
387600     END-EVALUATE.                                                38760017
387700                                                                  38770017
387800                                                                  38780017
387900     IF  RC013-IDX > 1                                            38790017
388000         PERFORM 5205-WRITE-SEL-QUEUE                             38800017
388100         ADD +1                    TO RC015-NUMBER-OF-TS-ITEMS    38810017
388200     END-IF.                                                      38820017
388300                                                                  38830017
388400 5001-PREPARE-SEL-QUEUE.                                          38840017
388500                                                                  38850017
388600     MOVE +1                       TO ASC-BLK-SUB.                38860017
388700     PERFORM 5100-WRITE-TEMP-STORAGE.                             38870017
388800     ADD +1                        TO ASC-BLK-SUB.                38880017
388900     PERFORM 5100-WRITE-TEMP-STORAGE.                             38890017
389000                                                                  38900017
389100     MOVE ASC-SEL-QUEUE-NAME       TO SU024-SEL-QUEUE-NAME.       38910017
389200     PERFORM 6010-DELETE-SEL-QUEUE.                               38920017
389300                                                                  38930017
389400     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                      38940017
389500         SET ASC-UPDATE-TSQ        TO TRUE                        38950017
389600     END-IF.                                                      38960017
389700                                                                  38970017
389800     SET SU025-IDX                 TO 1.                          38980017
389900     MOVE ZERO                     TO SU024-NUMBER-OF-TS-ITEMS.   38990017
390000     INITIALIZE SU025-SELECTED-ITEM-ARRAY.                        39000017
390100                                                                  39010017
390200                                                                  39020017
390300     PERFORM 5201-FILL-SEL-QUEUE-RECORD                           39030017
390400         VARYING PV-ITEM  FROM 1 BY 1                             39040017
390500         UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN.             39050017
390600                                                                  39060017
390700                                                                  39070017
390800     IF  SU025-IDX > 1                                            39080017
390900         PERFORM 5206-WRITE-SEL-QUEUE                             39090017
391000         ADD +1                    TO RC015-NUMBER-OF-TS-ITEMS    39100017
391100     END-IF.                                                      39110017
391200                                                                  39120017
391300*----------------------------------------------------------------*39130017
391400*                                                                *39140017
391500* THIS QUEUE IS USED FOR CARTON ASSIGNED LIST                    *39150017
391600*                                                                *39160017
391700* ADDED DMH 7/13/04                                              *39170017
391800*----------------------------------------------------------------*39180017
391900 5001-PREPARE-SEL-QUEUE-CRTN.                                     39190017
392000     MOVE +1                       TO ASC-BLK-SUB.                39200017
392100     PERFORM 5100-WRITE-TEMP-STORAGE.                             39210017
392200     ADD +1                        TO ASC-BLK-SUB.                39220017
392300     PERFORM 5100-WRITE-TEMP-STORAGE.                             39230017
392400                                                                  39240017
392500     MOVE ASC-SEL-QUEUE-NAME       TO SU003-SEL-QUEUE-NAME.       39250017
392600     PERFORM 6010-DELETE-SEL-QUEUE.                               39260017
392700                                                                  39270017
392800     SET ASC-UPDATE-TSQ      TO TRUE.                             39280017
392900     SET SU004-IDX           TO 1.                                39290017
393000     MOVE ZERO               TO SU003-NUMBER-OF-TS-ITEMS.         39300017
393100                                                                  39310017
393200     INITIALIZE SU004-SELECTED-ITEM-ARRAY.                        39320017
393300                                                                  39330017
393400     PERFORM 5203-FILL-SEL-QUEUE-RECORD                           39340017
393500             VARYING PV-ITEM                                      39350017
393600             FROM 1 BY 1                                          39360017
393700             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     39370017
393800                                                                  39380017
393900     IF  SU004-IDX > 1                                            39390017
394000         PERFORM 5209-WRITE-SEL-QUEUE-CRTNASGN                    39400017
394100             ADD +1              TO SU003-NUMBER-OF-TS-ITEMS.     39410017
394200                                                                  39420017
394300                                                                  39430017
394400*----------------------------------------------------------------*39440017
394500*                                                                *39450017
394600* THIS QUEUE IS USED FOR TRAILER MAINTENANCE                     *39460017
394700*                                                                *39470017
394800* ADDED DMH 7/13/04                                              *39480017
394900*----------------------------------------------------------------*39490017
395000 5002-PREPARE-SEL-QUEUE-TRLR.                                     39500017
395100     MOVE +1                       TO ASC-BLK-SUB.                39510017
395200     PERFORM 5100-WRITE-TEMP-STORAGE.                             39520017
395300     ADD +1                        TO ASC-BLK-SUB.                39530017
395400     PERFORM 5100-WRITE-TEMP-STORAGE.                             39540017
395500                                                                  39550017
395600     MOVE ASC-SEL-QUEUE-NAME       TO TR007-SEL-QUEUE-NAME.       39560017
395700     PERFORM 6010-DELETE-SEL-QUEUE.                               39570017
395800                                                                  39580017
395900     SET ASC-UPDATE-TSQ      TO TRUE.                             39590017
396000     SET TR006-IDX           TO 1.                                39600017
396100     MOVE ZERO               TO TR007-NUMBER-OF-TS-ITEMS.         39610017
396200                                                                  39620017
396300     INITIALIZE TR006-SELECTED-ITEM-ARRAY.                        39630017
396400                                                                  39640017
396500     PERFORM 5204-FILL-SEL-QUEUE-RECORD                           39650017
396600             VARYING PV-ITEM                                      39660017
396700             FROM 1 BY 1                                          39670017
396800             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     39680017
396900                                                                  39690017
397000     IF  TR006-IDX > 1                                            39700017
397100         PERFORM 5210-WRITE-SEL-QUEUE-CRTNASGN                    39710017
397200             ADD +1              TO TR007-NUMBER-OF-TS-ITEMS.     39720017
397300                                                                  39730017
397400                                                                  39740017
397500 5002-PREPARE-SEL-QUEUE.                                          39750017
397600                                                                  39760017
397700     MOVE +1                       TO ASC-BLK-SUB.                39770017
397800     PERFORM 5100-WRITE-TEMP-STORAGE.                             39780017
397900     ADD +1                        TO ASC-BLK-SUB.                39790017
398000     PERFORM 5100-WRITE-TEMP-STORAGE.                             39800017
398100                                                                  39810017
398200     MOVE ASC-SEL-QUEUE-NAME       TO RC815-SEL-QUEUE-NAME.       39820017
398300     PERFORM 6010-DELETE-SEL-QUEUE.                               39830017
398400                                                                  39840017
398500     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                      39850017
398600         SET ASC-UPDATE-TSQ        TO TRUE                        39860017
398700     END-IF.                                                      39870017
398800                                                                  39880017
398900     SET RC817-IDX                 TO 1.                          39890017
399000     MOVE ZERO                     TO RC815-NUMBER-OF-TS-ITEMS.   39900017
399100     INITIALIZE RC817-SELECTED-ITEM-ARRAY.                        39910017
399200                                                                  39920017
399300                                                                  39930017
399400     PERFORM 5202-FILL-SEL-QUEUE-RECORD                           39940017
399500         VARYING PV-ITEM  FROM 1 BY 1                             39950017
399600         UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN.             39960017
399700                                                                  39970017
399800                                                                  39980017
399900     IF  RC817-IDX > 1                                            39990017
400000         PERFORM 5207-WRITE-SEL-QUEUE                             40000017
400100         ADD +1                    TO RC815-NUMBER-OF-TS-ITEMS    40010017
400200     END-IF.                                                      40020017
400300                                                                  40030017
400400/                                                                 40040017
400500*----------------------------------------------------------------*40050017
400600*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *40060017
400700*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *40070017
400800*----------------------------------------------------------------*40080017
400900                                                                  40090017
401000 5100-WRITE-TEMP-STORAGE.                                         40100017
401100                                                                  40110017
401200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     40120017
401300                                   TO PV-LIST-ITEM-NUMBER.        40130017
401400     COMPUTE PV-BLOCK-NUMBER =                                    40140017
401500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    40150017
401600                                                                  40160017
401700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             40170017
401800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             40180017
401900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      40190017
402000             PERFORM 5105-REWRITE-ASC-LISTQ                       40200017
402100         END-IF                                                   40210017
402200     ELSE                                                         40220017
402300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       40230017
402400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            40240017
402500         PERFORM 5110-WRITE-ASC-LISTQ                             40250017
402600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   40260017
402700     END-IF.                                                      40270017
402800                                                                  40280017
402900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      40290017
403000                                   TO TRUE.                       40300017
403100                                                                  40310017
403200/                                                                 40320017
403300*----------------------------------------------------------------*40330017
403400*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *40340017
403500*  SPECIFIC COMMAREA.                                            *40350017
403600*----------------------------------------------------------------*40360017
403700 5105-REWRITE-ASC-LISTQ.                                          40370017
403800                                                                  40380017
403900     EXEC CICS                                                    40390017
404000         WRITEQ TS                                                40400017
404100             QUEUE (ASC-LIST-QUEUE-NAME)                          40410017
404200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               40420017
404300             ITEM  (PV-BLOCK-NUMBER)                              40430017
404400             REWRITE                                              40440017
404500             RESP  (PV-CICS-RESP)                                 40450017
404600     END-EXEC.                                                    40460017
404700                                                                  40470017
404800     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           40480017
404900         CONTINUE                                                 40490017
405000     ELSE                                                         40500017
405100         SET DP013-CICS-ABEND      TO TRUE                        40510017
405200         SET DP013-NO-ROLLBACK     TO TRUE                        40520017
405300         MOVE '5105-REWRITE-ASC-LISTQ'                            40530017
405400                                   TO DP013-PARAGRAPH             40540017
405500         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     40550017
405600                                   TO DP013-MESSAGE-TEXT(1)       40560017
405700         PERFORM DP013-0000-PROCESS-ABEND                         40570017
405800     END-IF.                                                      40580017
405900                                                                  40590017
406000/                                                                 40600017
406100*----------------------------------------------------------------*40610017
406200*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *40620017
406300*  SPECIFIC COMMAREA.                                            *40630017
406400*----------------------------------------------------------------*40640017
406500 5110-WRITE-ASC-LISTQ.                                            40650017
406600                                                                  40660017
406700     EXEC CICS                                                    40670017
406800         WRITEQ TS                                                40680017
406900             QUEUE (ASC-LIST-QUEUE-NAME)                          40690017
407000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               40700017
407100             ITEM  (PV-BLOCK-NUMBER)                              40710017
407200             RESP  (PV-CICS-RESP)                                 40720017
407300     END-EXEC.                                                    40730017
407400                                                                  40740017
407500     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      40750017
407600         SET DP013-CICS-ABEND      TO TRUE                        40760017
407700         SET DP013-NO-ROLLBACK     TO TRUE                        40770017
407800         MOVE '5110-WRITE-ASC-LISTQ'                              40780017
407900                                   TO DP013-PARAGRAPH             40790017
408000         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           40800017
408100                                   TO DP013-MESSAGE-TEXT(1)       40810017
408200         PERFORM DP013-0000-PROCESS-ABEND                         40820017
408300     END-IF.                                                      40830017
408400                                                                  40840017
408500/                                                                 40850017
408600*----------------------------------------------------------------*40860017
408700* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *40870017
408800* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *40880017
408900*----------------------------------------------------------------*40890017
409000                                                                  40900017
409100 5200-FILL-SEL-QUEUE-RECORD.                                      40910017
409200                                                                  40920017
409300     PERFORM 6112-READ-LIST-QUEUE.                                40930017
409400                                                                  40940017
409500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       40950017
409600         PERFORM                                                  40960017
409700         VARYING LQW-IDX                                          40970017
409800         FROM 1 BY 1                                              40980017
409900         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            40990017
410000           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          41000017
410100                                                                  41010017
410200             IF  LQW-SELECT (LQW-IDX)                             41020017
410300                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              41030017
410400                                   TO RC013-ITEM      (RC013-IDX) 41040017
410500                 MOVE SPACE        TO RC013-ACTION-SW (RC013-IDX) 41050017
410600                 MOVE LQW-PO-NBR   (LQW-IDX)                      41060017
410700                                   TO RC013-PO-NBR (RC013-IDX)    41070017
410800                 MOVE LQW-REC-SEQ-NBR (LQW-IDX)                   41080017
410900                                   TO RC013-REC-SEQ-NBR           41090017
411000                                      (RC013-IDX)                 41100017
411100                 MOVE RC015-OPER-UNT-ID                           41110017
411200                                 TO RC013-OPER-UNT-ID(RC013-IDX)  41120017
411300                 MOVE RC015-FCLTY-ID                              41130017
411400                                 TO RC013-FCLTY-ID(RC013-IDX)     41140017
411500*  DRS           IF DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)         41150017
411600*                    PERFORM 5200-FUNC05                          41160017
411700*  RDS           END-IF                                           41170017
411800                                                                  41180017
411900                 SET LQW-DESELECT (LQW-IDX)                       41190017
412000                     LQW-INQUIRE  (LQW-IDX)                       41200017
412100                                   TO  TRUE                       41210017
412200                 SET RC013-IDX UP BY 1                            41220017
412300                 IF  RC013-IDX > RC013-MAX-ITEMS                  41230017
412400                     PERFORM 5205-WRITE-SEL-QUEUE                 41240017
412500                     ADD +1        TO RC015-NUMBER-OF-TS-ITEMS    41250017
412600                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         41260017
412700                     SET RC013-IDX TO 1                           41270017
412800                 END-IF                                           41280017
412900             END-IF                                               41290017
413000         END-PERFORM                                              41300017
413100     END-IF.                                                      41310017
413200                                                                  41320017
413300 5201-FILL-SEL-QUEUE-RECORD.                                      41330017
413400                                                                  41340017
413500     PERFORM 6112-READ-LIST-QUEUE.                                41350017
413600                                                                  41360017
413700     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       41370017
413800         PERFORM                                                  41380017
413900         VARYING LQW-IDX                                          41390017
414000         FROM 1 BY 1                                              41400017
414100         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            41410017
414200           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          41420017
414300                                                                  41430017
414400             IF  LQW-SELECT (LQW-IDX)                             41440017
414500                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              41450017
414600                                   TO SU025-ITEM      (SU025-IDX) 41460017
414700                 MOVE SPACE        TO SU025-ACTION-SW (SU025-IDX) 41470017
414800                                                                  41480017
414900                 INITIALIZE PV-PO-RECEIVER                        41490017
415000                 MOVE LQW-PO-NBR   (LQW-IDX)                      41500017
415100                                      TO PV-PO-NBR                41510017
415200                 MOVE LQW-REC-SEQ-NBR (LQW-IDX)                   41520017
415300                                      TO PV-REC-SEQ-NBR           41530017
415400                 MOVE PV-PO-RECEIVER  TO SU025-PO-RECEIVER        41540017
415500                                         (SU025-IDX)              41550017
415600                                                                  41560017
415700                 MOVE SU024-OPER-UNIT-ID                          41570017
415800                                 TO SU025-OPER-UNIT(SU025-IDX)    41580017
415900                                                                  41590017
416000                 SET LQW-DESELECT (LQW-IDX)                       41600017
416100                     LQW-INQUIRE  (LQW-IDX)                       41610017
416200                                   TO  TRUE                       41620017
416300                 SET SU025-IDX UP BY 1                            41630017
416400                 IF  SU025-IDX > SU025-MAX-ITEMS                  41640017
416500                     PERFORM 5206-WRITE-SEL-QUEUE                 41650017
416600                     ADD +1        TO SU024-NUMBER-OF-TS-ITEMS    41660017
416700                     INITIALIZE SU025-SELECTED-ITEM-ARRAY         41670017
416800                     SET SU025-IDX TO 1                           41680017
416900                 END-IF                                           41690017
417000             END-IF                                               41700017
417100         END-PERFORM                                              41710017
417200     END-IF.                                                      41720017
417300                                                                  41730017
417400 5202-FILL-SEL-QUEUE-RECORD.                                      41740017
417500                                                                  41750017
417600     PERFORM 6112-READ-LIST-QUEUE.                                41760017
417700                                                                  41770017
417800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       41780017
417900         PERFORM                                                  41790017
418000         VARYING LQW-IDX                                          41800017
418100         FROM 1 BY 1                                              41810017
418200         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            41820017
418300           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          41830017
418400                                                                  41840017
418500             IF  LQW-SELECT (LQW-IDX)                             41850017
418600                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              41860017
418700                                   TO RC817-ITEM      (RC817-IDX) 41870017
418800                 MOVE SPACE        TO RC817-ACTION-SW (RC817-IDX) 41880017
418900                                                                  41890017
419000                 INITIALIZE PV-PO-RECEIVER                        41900017
419100                 MOVE LQW-PO-NBR   (LQW-IDX)                      41910017
419200                                      TO RC817-PO-NBR(RC817-IDX)  41920017
419300                                         DK-PO-NBR                41930017
419400                 MOVE LQW-REC-SEQ-NBR (LQW-IDX)                   41940017
419500                                      TO RC817-RCVR-NBR(RC817-IDX)41950017
419600                                         DK-REC-SEQ-NBR           41960017
419700                                                                  41970017
419800                 MOVE LQW-VENDNAME (LQW-IDX)                      41980017
419900                                      TO RC817-VENDOR(RC817-IDX)  41990017
420000                 MOVE LQW-PKG (LQW-IDX)                           42000017
420100                                      TO RC817-PKG-CODE(RC817-IDX)42010017
420200                                                                  42020017
420300                 PERFORM 7205-GET-TRIP-ID                         42030017
420400                 MOVE VHTRIP-TRIP-ID  TO RC817-TRIP-ID(RC817-IDX) 42040017
420500                 MOVE VHTRIP-VEH-NBR  TO RC817-TRLR-NBR(RC817-IDX)42050017
420600                 MOVE VHTRIP-OWNER-SCAC-ID                        42060017
420700                                      TO RC817-SCAC-CDE(RC817-IDX)42070017
420800                                                                  42080017
420900                 SET LQW-DESELECT (LQW-IDX)                       42090017
421000                     LQW-INQUIRE  (LQW-IDX)                       42100017
421100                                   TO  TRUE                       42110017
421200                 SET RC817-IDX UP BY 1                            42120017
421300                 IF  RC817-IDX > RC817-MAX-ITEMS                  42130017
421400                     PERFORM 5207-WRITE-SEL-QUEUE                 42140017
421500                     ADD +1        TO RC815-NUMBER-OF-TS-ITEMS    42150017
421600                     INITIALIZE RC817-SELECTED-ITEM-ARRAY         42160017
421700                     SET RC817-IDX TO 1                           42170017
421800                 END-IF                                           42180017
421900             END-IF                                               42190017
422000         END-PERFORM                                              42200017
422100     END-IF.                                                      42210017
422200                                                                  42220017
422300*----------------------------------------------------------------*42230017
422400* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *42240017
422500* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *42250017
422600* CARTON ASSIGN LIST - QUEUE                                     *42260017
422700* CMH ADDED 7/13/04                                              *42270017
422800*----------------------------------------------------------------*42280017
422900 5203-FILL-SEL-QUEUE-RECORD.                                      42290017
423000                                                                  42300017
423100     PERFORM 6112-READ-LIST-QUEUE.                                42310017
423200                                                                  42320017
423300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       42330017
423400         PERFORM                                                  42340017
423500         VARYING LQW-IDX                                          42350017
423600         FROM 1 BY 1                                              42360017
423700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            42370017
423800           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          42380017
423900                                                                  42390017
424000             IF  LQW-SELECT (LQW-IDX)                             42400017
424100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              42410017
424200                                  TO SU004-ITEM        (SU004-IDX)42420017
424300                 MOVE ASC-KEY-OPER-UNT-ID                         42430017
424400                                  TO SU004-OPER-UNT-ID (SU004-IDX)42440017
424500                 MOVE ASC-KEY-FCLTY-ID                            42450017
424600                                  TO SU004-FCLTY-ID    (SU004-IDX)42460017
424700                 MOVE LQW-PO-NBR (LQW-IDX)                        42470017
424800                                  TO SU004-PO-NBR      (SU004-IDX)42480017
424900                 MOVE LQW-REC-SEQ-NBR (LQW-IDX)                   42490017
425000                                  TO SU004-REC-SEQ-NBR (SU004-IDX)42500017
425100                 MOVE ZEROES      TO SU004-LINE-NO     (SU004-IDX)42510017
425200                                                                  42520017
425300                 MOVE SPACES      TO SU004-ACTION-SW   (SU004-IDX)42530017
425400                                     SU004-SCAC-CDE    (SU004-IDX)42540017
425500                                     SU004-VEH-NBR     (SU004-IDX)42550017
425600                                     SU004-CSR-IND     (SU004-IDX)42560017
425700                                                                  42570017
425800                 MOVE ZEROES      TO SU004-TRIP-ID     (SU004-IDX)42580017
425900                                     SU004-SHIPT-UNT-ID(SU004-IDX)42590017
426000                                                                  42600017
426100                 SET SU004-IDX UP BY 1                            42610017
426200                 IF  SU004-IDX > SU004-MAX-ITEMS                  42620017
426300                     PERFORM 5209-WRITE-SEL-QUEUE-CRTNASGN        42630017
426400                     ADD  +1  TO  SU003-NUMBER-OF-TS-ITEMS        42640017
426500                     INITIALIZE SU004-SELECTED-ITEM-ARRAY         42650017
426600                     SET SU004-IDX TO  1                          42660017
426700                 END-IF                                           42670017
426800             END-IF                                               42680017
426900         END-PERFORM                                              42690017
427000     END-IF.                                                      42700017
427100                                                                  42710017
427200                                                                  42720017
427300*----------------------------------------------------------------*42730017
427400* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *42740017
427500* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *42750017
427600* TRAILER UPDATE     - QUEUE                                     *42760017
427700* DMH ADDED 7/13/04                                              *42770017
427800*----------------------------------------------------------------*42780017
427900 5204-FILL-SEL-QUEUE-RECORD.                                      42790017
428000                                                                  42800017
428100     PERFORM 6112-READ-LIST-QUEUE.                                42810017
428200                                                                  42820017
428300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       42830017
428400         PERFORM                                                  42840017
428500         VARYING LQW-IDX                                          42850017
428600         FROM 1 BY 1                                              42860017
428700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            42870017
428800           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          42880017
428900                                                                  42890017
429000             IF  LQW-SELECT (LQW-IDX)                             42900017
429100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              42910017
429200                              TO TR006-ITEM         (TR006-IDX)   42920017
429300                 MOVE ASC-KEY-OPER-UNT-ID                         42930017
429400                              TO TR006-OPER-UNT-ID  (TR006-IDX)   42940017
429500                 MOVE ASC-KEY-FCLTY-ID                            42950017
429600                              TO TR006-FCLTY-ID     (TR006-IDX)   42960017
429700                 MOVE LQW-PO-NBR (LQW-IDX)                        42970017
429800                              TO DK-PO-NBR                        42980017
429900                 MOVE LQW-REC-SEQ-NBR (LQW-IDX)                   42990017
430000                              TO DK-REC-SEQ-NBR                   43000017
430100                 PERFORM 7205-GET-TRIP-ID                         43010017
430200                 MOVE VHTRIP-TRIP-ID                              43020017
430300                              TO LQW-TRIP-ID (LQW-IDX)            43030017
430400                                 TR006-TRIP-ID      (TR006-IDX)   43040017
430500                 MOVE VHTRIP-OWNER-SCAC-ID                        43050017
430600                               TO LQW-SCAC-ID (LQW-IDX)           43060017
430700                                  TR006-OWNER-SCAC-ID(TR006-IDX)  43070017
430800                 MOVE VHTRIP-VEH-NBR                              43080017
430900                              TO LQW-VEH-NBR (LQW-IDX)            43090017
431000                                 TR006-VEH-NBR      (TR006-IDX)   43100017
431100                 MOVE TRIPST-TRIP-STATUS-CDE                      43110017
431200                              TO LQW-TRIP-STAT-CDE (LQW-IDX)      43120017
431300                                 TR006-STATUS-CDE   (TR006-IDX)   43130017
431400                 MOVE SHIPMT-SHIPT-ID                             43140017
431500                              TO TR006-SHIPT-ID     (TR006-IDX)   43150017
431600                                                                  43160017
431700                                                                  43170017
431800                 SET TR006-IDX UP BY 1                            43180017
431900                 IF  TR006-IDX > SU004-MAX-ITEMS                  43190017
432000                     PERFORM 5210-WRITE-SEL-QUEUE-CRTNASGN        43200017
432100                     ADD  +1  TO  TR007-NUMBER-OF-TS-ITEMS        43210017
432200                     INITIALIZE TR006-SELECTED-ITEM-ARRAY         43220017
432300                     SET TR006-IDX TO  1                          43230017
432400                 END-IF                                           43240017
432500             END-IF                                               43250017
432600         END-PERFORM                                              43260017
432700     END-IF.                                                      43270017
432800                                                                  43280017
432900                                                                  43290017
433000                                                                  43300017
433100 5200-FUNC05.                                                     43310017
433200     PERFORM 7200-GET-SHIPMT-INFO.                                43320017
433300     MOVE SHIPMT-SHIPT-ID             TO RC013-SHIPT-ID(RC013-IDX)43330017
433400     MOVE SHIPMT-PRO-NBR              TO RC013-PRO-NBR (RC013-IDX)43340017
433500     MOVE SHIPMT-BOL-NBR              TO RC013-BOL-NBR (RC013-IDX)43350017
433600     MOVE SHIPMT-PRO-SCAC-ID          TO RC013-OWNER-SCAC-ID      43360017
433700                                           (RC013-IDX).           43370017
433800/                                                                 43380017
433900*----------------------------------------------------------------*43390017
434000*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *43400017
434100*----------------------------------------------------------------*43410017
434200                                                                  43420017
434300 5205-WRITE-SEL-QUEUE.                                            43430017
434400                                                                  43440017
434500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            43450017
434600                                   TO RC013-SELECTED-ITEMS.       43460017
434700                                                                  43470017
434800     EXEC CICS                                                    43480017
434900          WRITEQ TS                                               43490017
435000              QUEUE (ASC-SEL-QUEUE-NAME)                          43500017
435100              FROM  (RC013-DC-SELECT-RECORD)                      43510017
435200              ITEM  (PV-SEL-QUEUE-ITEM)                           43520017
435300              RESP  (PV-CICS-RESP)                                43530017
435400     END-EXEC.                                                    43540017
435500                                                                  43550017
435600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          43560017
435700         CONTINUE                                                 43570017
435800     ELSE                                                         43580017
435900         SET DP013-CICS-ABEND      TO TRUE                        43590017
436000         SET DP013-NO-ROLLBACK     TO TRUE                        43600017
436100         MOVE '5205-WRITE-SEL-QUEUE'                              43610017
436200                                   TO DP013-PARAGRAPH             43620017
436300         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          43630017
436400                                   TO DP013-MESSAGE-TEXT(1)       43640017
436500         PERFORM DP013-0000-PROCESS-ABEND                         43650017
436600     END-IF.                                                      43660017
436700                                                                  43670017
436800 5206-WRITE-SEL-QUEUE.                                            43680017
436900                                                                  43690017
437000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            43700017
437100                                   TO SU025-SELECTED-ITEMS.       43710017
437200                                                                  43720017
437300     EXEC CICS                                                    43730017
437400          WRITEQ TS                                               43740017
437500              QUEUE (ASC-SEL-QUEUE-NAME)                          43750017
437600              FROM  (SU025-SELECT-RECORD)                         43760017
437700              ITEM  (PV-SEL-QUEUE-ITEM)                           43770017
437800              RESP  (PV-CICS-RESP)                                43780017
437900     END-EXEC.                                                    43790017
438000                                                                  43800017
438100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          43810017
438200         CONTINUE                                                 43820017
438300     ELSE                                                         43830017
438400         SET DP013-CICS-ABEND      TO TRUE                        43840017
438500         SET DP013-NO-ROLLBACK     TO TRUE                        43850017
438600         MOVE '5205-WRITE-SEL-QUEUE'                              43860017
438700                                   TO DP013-PARAGRAPH             43870017
438800         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          43880017
438900                                   TO DP013-MESSAGE-TEXT(1)       43890017
439000         PERFORM DP013-0000-PROCESS-ABEND                         43900017
439100     END-IF.                                                      43910017
439200                                                                  43920017
439300 5207-WRITE-SEL-QUEUE.                                            43930017
439400                                                                  43940017
439500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            43950017
439600                                   TO RC817-SELECTED-ITEMS.       43960017
439700                                                                  43970017
439800     EXEC CICS                                                    43980017
439900          WRITEQ TS                                               43990017
440000              QUEUE (ASC-SEL-QUEUE-NAME)                          44000017
440100              FROM  (RC817-SELECT-RECORD)                         44010017
440200              ITEM  (PV-SEL-QUEUE-ITEM)                           44020017
440300              RESP  (PV-CICS-RESP)                                44030017
440400     END-EXEC.                                                    44040017
440500                                                                  44050017
440600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          44060017
440700         CONTINUE                                                 44070017
440800     ELSE                                                         44080017
440900         SET DP013-CICS-ABEND      TO TRUE                        44090017
441000         SET DP013-NO-ROLLBACK     TO TRUE                        44100017
441100         MOVE '5207-WRITE-SEL-QUEUE'                              44110017
441200                                   TO DP013-PARAGRAPH             44120017
441300         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          44130017
441400                                   TO DP013-MESSAGE-TEXT(1)       44140017
441500         PERFORM DP013-0000-PROCESS-ABEND                         44150017
441600     END-IF.                                                      44160017
441700                                                                  44170017
441800                                                                  44180017
441900*----------------------------------------------------------------*44190017
442000*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *44200017
442100*                                                                *44210017
442200* THIS QUEUE IS USED FOR CARTON ASSIGN LIST                      *44220017
442300* DMH ADDED - 7/13/04                                            *44230017
442400*----------------------------------------------------------------*44240017
442500 5209-WRITE-SEL-QUEUE-CRTNASGN.                                   44250017
442600                                                                  44260017
442700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            44270017
442800                                   TO SU004-SELECTED-ITEMS.       44280017
442900                                                                  44290017
443000     EXEC CICS                                                    44300017
443100          WRITEQ TS                                               44310017
443200              QUEUE (ASC-SEL-QUEUE-NAME)                          44320017
443300              FROM  (SU004-DC-SELECT-RECORD)                      44330017
443400              ITEM  (PV-SEL-QUEUE-ITEM)                           44340017
443500              RESP  (PV-CICS-RESP)                                44350017
443600     END-EXEC.                                                    44360017
443700                                                                  44370017
443800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          44380017
443900         CONTINUE                                                 44390017
444000     ELSE                                                         44400017
444100         SET DP013-CICS-ABEND      TO TRUE                        44410017
444200         SET DP013-NO-ROLLBACK     TO TRUE                        44420017
444300         MOVE '5209-WRITE-SEL-QUEUE-CRTNASGN'                     44430017
444400                                   TO DP013-PARAGRAPH             44440017
444500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          44450017
444600                                   TO DP013-MESSAGE-TEXT(1)       44460017
444700         PERFORM DP013-0000-PROCESS-ABEND                         44470017
444800     END-IF.                                                      44480017
444900                                                                  44490017
445000                                                                  44500017
445100                                                                  44510017
445200*----------------------------------------------------------------*44520017
445300*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *44530017
445400*                                                                *44540017
445500* THIS QUEUE IS USED FOR TRAILER UPDATE                          *44550017
445600* DMH ADDED - 7/13/04                                            *44560017
445700*----------------------------------------------------------------*44570017
445800 5210-WRITE-SEL-QUEUE-CRTNASGN.                                   44580017
445900                                                                  44590017
446000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            44600017
446100                                   TO TR006-SELECTED-ITEMS.       44610017
446200                                                                  44620017
446300     EXEC CICS                                                    44630017
446400          WRITEQ TS                                               44640017
446500              QUEUE (ASC-SEL-QUEUE-NAME)                          44650017
446600              FROM  (TR006-DOCK-SCHEDULE-REC)                     44660017
446700              ITEM  (PV-SEL-QUEUE-ITEM)                           44670017
446800              RESP  (PV-CICS-RESP)                                44680017
446900     END-EXEC.                                                    44690017
447000                                                                  44700017
447100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          44710017
447200         CONTINUE                                                 44720017
447300     ELSE                                                         44730017
447400         SET DP013-CICS-ABEND      TO TRUE                        44740017
447500         SET DP013-NO-ROLLBACK     TO TRUE                        44750017
447600         MOVE '5209-WRITE-SEL-QUEUE-CRTNASGN'                     44760017
447700                                   TO DP013-PARAGRAPH             44770017
447800         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          44780017
447900                                   TO DP013-MESSAGE-TEXT(1)       44790017
448000         PERFORM DP013-0000-PROCESS-ABEND                         44800017
448100     END-IF.                                                      44810017
448200                                                                  44820017
448300                                                                  44830017
448400*----------------------------------------------------------------*44840017
448500*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *44850017
448600*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *44860017
448700*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *44870017
448800*  THE USER.                                                     *44880017
448900*----------------------------------------------------------------*44890017
449000 6000-REFRESH-PANEL-FROM-TEMP.                                    44900017
449100                                                                  44910017
449200     IF  ASC-UPDATE-TSQ                                           44920017
449300         SET ASC-NO-TSQ-UPDATE     TO TRUE                        44930017
449400         MOVE ZERO                 TO PV-SAVE-ITEM                44940017
449500                                      PV-SEL-QUEUE-ITEM           44950017
449600         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        44960017
449700                                   TO PV-HOLD-SELECTED-ITEMS      44970017
449800         MOVE +1                   TO PV-ITEMS-PROCESSED          44980017
449900         PERFORM 6100-UPDATE-TSQ                                  44990017
450000             UNTIL PV-ITEMS-PROCESSED >                           45000017
450100                                     PV-HOLD-SELECTED-ITEMS       45010017
450200         PERFORM 6010-DELETE-SEL-QUEUE                            45020017
450300         INITIALIZE ASC-BLOCK-ENTRIES (1)                         45030017
450400                    ASC-BLOCK-ENTRIES (2)                         45040017
450500                                                                  45050017
450600* 6/30                                                            45060017
450700         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 45070017
450800                GIVING    PV-BLOCK-NUMBER                         45080017
450900                REMAINDER PV-REMAINDER                            45090017
451000                                                                  45100017
451100         IF PV-REMAINDER > ZERO                                   45110017
451200             ADD +1              TO PV-BLOCK-NUMBER               45120017
451300         END-IF                                                   45130017
451400                                                                  45140017
451500         MOVE +1                 TO ASC-BLK-SUB                   45150017
451600                                                                  45160017
451700         PERFORM 4410-READ-TEMP-STORAGE                           45170017
451800                                                                  45180017
451900         ADD +1                  TO ASC-BLK-SUB                   45190017
452000                            PV-BLOCK-NUMBER                       45200017
452100         PERFORM 4410-READ-TEMP-STORAGE                           45210017
452200                                                                  45220017
452300     END-IF.                                                      45230017
452400* 6/30                                                            45240017
452500                                                                  45250017
452600 6001-REFRESH-PANEL-FROM-TEMP.                                    45260017
452700                                                                  45270017
452800     IF  ASC-UPDATE-TSQ                                           45280017
452900         SET ASC-NO-TSQ-UPDATE     TO TRUE                        45290017
453000         MOVE ZERO                 TO PV-SAVE-ITEM                45300017
453100                                      PV-SEL-QUEUE-ITEM           45310017
453200         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        45320017
453300                                   TO PV-HOLD-SELECTED-ITEMS      45330017
453400         PERFORM 6101-UPDATE-TSQ                                  45340017
453500             UNTIL PV-ITEMS-PROCESSED >                           45350017
453600                                     PV-HOLD-SELECTED-ITEMS       45360017
453700         PERFORM 6010-DELETE-SEL-QUEUE                            45370017
453800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         45380017
453900                    ASC-BLOCK-ENTRIES (2)                         45390017
454000                                                                  45400017
454100* 6/30                                                            45410017
454200         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 45420017
454300                GIVING    PV-BLOCK-NUMBER                         45430017
454400                REMAINDER PV-REMAINDER                            45440017
454500                                                                  45450017
454600         IF PV-REMAINDER > ZERO                                   45460017
454700             ADD +1              TO PV-BLOCK-NUMBER               45470017
454800         END-IF                                                   45480017
454900                                                                  45490017
455000         MOVE +1                 TO ASC-BLK-SUB                   45500017
455100                                                                  45510017
455200         PERFORM 4410-READ-TEMP-STORAGE                           45520017
455300                                                                  45530017
455400         ADD +1                  TO ASC-BLK-SUB                   45540017
455500                            PV-BLOCK-NUMBER                       45550017
455600         PERFORM 4410-READ-TEMP-STORAGE                           45560017
455700                                                                  45570017
455800     END-IF.                                                      45580017
455900                                                                  45590017
456000     SET ASC-FUNC04-RETURN-NO         TO TRUE.                    45600017
456100                                                                  45610017
456200 6002-REFRESH-PANEL-FROM-TEMP.                                    45620017
456300                                                                  45630017
456400     IF  ASC-UPDATE-TSQ                                           45640017
456500         SET ASC-NO-TSQ-UPDATE     TO TRUE                        45650017
456600         MOVE ZERO                 TO PV-SAVE-ITEM                45660017
456700                                      PV-SEL-QUEUE-ITEM           45670017
456800         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        45680017
456900                                   TO PV-HOLD-SELECTED-ITEMS      45690017
457000         PERFORM 6102-UPDATE-TSQ                                  45700017
457100             UNTIL PV-ITEMS-PROCESSED >                           45710017
457200                                     PV-HOLD-SELECTED-ITEMS       45720017
457300         PERFORM 6010-DELETE-SEL-QUEUE                            45730017
457400         INITIALIZE ASC-BLOCK-ENTRIES (1)                         45740017
457500                    ASC-BLOCK-ENTRIES (2)                         45750017
457600                                                                  45760017
457700* 6/30                                                            45770017
457800         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 45780017
457900                GIVING    PV-BLOCK-NUMBER                         45790017
458000                REMAINDER PV-REMAINDER                            45800017
458100                                                                  45810017
458200         IF PV-REMAINDER > ZERO                                   45820017
458300             ADD +1              TO PV-BLOCK-NUMBER               45830017
458400         END-IF                                                   45840017
458500                                                                  45850017
458600         MOVE +1                 TO ASC-BLK-SUB                   45860017
458700                                                                  45870017
458800         PERFORM 4410-READ-TEMP-STORAGE                           45880017
458900                                                                  45890017
459000         ADD +1                  TO ASC-BLK-SUB                   45900017
459100                            PV-BLOCK-NUMBER                       45910017
459200         PERFORM 4410-READ-TEMP-STORAGE                           45920017
459300     END-IF.                                                      45930017
459400                                                                  45940017
459500     SET ASC-FUNC04-RETURN-NO         TO TRUE.                    45950017
459600                                                                  45960017
459700 6003-REFRESH-PANEL-FROM-TEMP.                                    45970017
459800                                                                  45980017
459900     IF  ASC-UPDATE-TSQ                                           45990017
460000         SET ASC-NO-TSQ-UPDATE     TO TRUE                        46000017
460100         MOVE ZERO                 TO PV-SAVE-ITEM                46010017
460200                                      PV-SEL-QUEUE-ITEM           46020017
460300         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        46030017
460400                                   TO PV-HOLD-SELECTED-ITEMS      46040017
460500         PERFORM 6103-UPDATE-TSQ                                  46050017
460600             UNTIL PV-ITEMS-PROCESSED >                           46060017
460700                                     PV-HOLD-SELECTED-ITEMS       46070017
460800         PERFORM 6010-DELETE-SEL-QUEUE                            46080017
460900         INITIALIZE ASC-BLOCK-ENTRIES (1)                         46090017
461000                    ASC-BLOCK-ENTRIES (2)                         46100017
461100                                                                  46110017
461200                                                                  46120017
461300         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 46130017
461400                GIVING    PV-BLOCK-NUMBER                         46140017
461500                REMAINDER PV-REMAINDER                            46150017
461600                                                                  46160017
461700         IF PV-REMAINDER > ZERO                                   46170017
461800             ADD +1              TO PV-BLOCK-NUMBER               46180017
461900         END-IF                                                   46190017
462000                                                                  46200017
462100         MOVE +1                 TO ASC-BLK-SUB                   46210017
462200                                                                  46220017
462300         PERFORM 4410-READ-TEMP-STORAGE                           46230017
462400                                                                  46240017
462500         ADD +1                  TO ASC-BLK-SUB                   46250017
462600                            PV-BLOCK-NUMBER                       46260017
462700         PERFORM 4410-READ-TEMP-STORAGE                           46270017
462800                                                                  46280017
462900     END-IF.                                                      46290017
463000                                                                  46300017
463100     SET ASC-FUNC08-RETURN-NO         TO TRUE.                    46310017
463200                                                                  46320017
463300                                                                  46330017
463400 6004-REFRESH-PANEL-FROM-TEMP.                                    46340017
463500                                                                  46350017
463600     IF  ASC-UPDATE-TSQ                                           46360017
463700         SET ASC-NO-TSQ-UPDATE     TO TRUE                        46370017
463800         MOVE ZERO                 TO PV-SAVE-ITEM                46380017
463900                                      PV-SEL-QUEUE-ITEM           46390017
464000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        46400017
464100                                   TO PV-HOLD-SELECTED-ITEMS      46410017
464200         PERFORM 6104-UPDATE-TSQ                                  46420017
464300             UNTIL PV-ITEMS-PROCESSED >                           46430017
464400                                     PV-HOLD-SELECTED-ITEMS       46440017
464500         PERFORM 6010-DELETE-SEL-QUEUE                            46450017
464600         INITIALIZE ASC-BLOCK-ENTRIES (1)                         46460017
464700                    ASC-BLOCK-ENTRIES (2)                         46470017
464800                                                                  46480017
464900                                                                  46490017
465000         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 46500017
465100                GIVING    PV-BLOCK-NUMBER                         46510017
465200                REMAINDER PV-REMAINDER                            46520017
465300                                                                  46530017
465400         IF PV-REMAINDER > ZERO                                   46540017
465500             ADD +1              TO PV-BLOCK-NUMBER               46550017
465600         END-IF                                                   46560017
465700                                                                  46570017
465800         MOVE +1                 TO ASC-BLK-SUB                   46580017
465900                                                                  46590017
466000         PERFORM 4410-READ-TEMP-STORAGE                           46600017
466100                                                                  46610017
466200         ADD +1                  TO ASC-BLK-SUB                   46620017
466300                            PV-BLOCK-NUMBER                       46630017
466400         PERFORM 4410-READ-TEMP-STORAGE                           46640017
466500                                                                  46650017
466600     END-IF.                                                      46660017
466700                                                                  46670017
466800     SET ASC-FUNC09-RETURN-NO         TO TRUE.                    46680017
466900                                                                  46690017
467000*----------------------------------------------------------------*46700017
467100*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *46710017
467200*----------------------------------------------------------------*46720017
467300 6010-DELETE-SEL-QUEUE.                                           46730017
467400                                                                  46740017
467500     EXEC CICS                                                    46750017
467600         DELETEQ TS                                               46760017
467700             QUEUE (ASC-SEL-QUEUE-NAME)                           46770017
467800             RESP  (PV-CICS-RESP)                                 46780017
467900     END-EXEC.                                                    46790017
468000                                                                  46800017
468100     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      46810017
468200         (PV-CICS-RESP = DFHRESP(QIDERR)))                        46820017
468300         CONTINUE                                                 46830017
468400     ELSE                                                         46840017
468500         SET DP013-CICS-ABEND      TO TRUE                        46850017
468600         SET DP013-NO-ROLLBACK     TO TRUE                        46860017
468700         MOVE '6010-DELETE-SEL-QUEUE'                             46870017
468800                                   TO DP013-PARAGRAPH             46880017
468900         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         46890017
469000                                   TO DP013-MESSAGE-TEXT (1)      46900017
469100         PERFORM DP013-0000-PROCESS-ABEND                         46910017
469200     END-IF.                                                      46920017
469300                                                                  46930017
469400/                                                                 46940017
469500*----------------------------------------------------------------*46950017
469600*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *46960017
469700*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *46970017
469800*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *46980017
469900*    THE TEMP QUEUE.                                             *46990017
470000*----------------------------------------------------------------*47000017
470100                                                                  47010017
470200 6100-UPDATE-TSQ.                                                 47020017
470300                                                                  47030017
470400     ADD 1                         TO PV-SEL-QUEUE-ITEM.          47040017
470500     PERFORM 6105-READ-SEL-QUEUE.                                 47050017
470600                                                                  47060017
470700     PERFORM                                                      47070017
470800         VARYING RC013-IDX                                        47080017
470900         FROM 1 BY 1                                              47090017
471000         UNTIL ((PV-ITEMS-PROCESSED >                             47100017
471100                              PV-HOLD-SELECTED-ITEMS)             47110017
471200         OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))             47120017
471300         IF  RC013-ACTION-SW (RC013-IDX) > SPACE                  47130017
471400             PERFORM 6110-PROCESS-ITEMS                           47140017
471500         END-IF                                                   47150017
471600         ADD +1                    TO PV-ITEMS-PROCESSED          47160017
471700     END-PERFORM.                                                 47170017
471800                                                                  47180017
471900     PERFORM 6111-WRITE-LIST-QUEUE.                               47190017
472000                                                                  47200017
472100 6101-UPDATE-TSQ.                                                 47210017
472200                                                                  47220017
472300     ADD 1                         TO PV-SEL-QUEUE-ITEM.          47230017
472400     PERFORM 6106-READ-SEL-QUEUE.                                 47240017
472500                                                                  47250017
472600     PERFORM                                                      47260017
472700         VARYING SU025-IDX                                        47270017
472800         FROM 1 BY 1                                              47280017
472900         UNTIL ((PV-ITEMS-PROCESSED >                             47290017
473000                              PV-HOLD-SELECTED-ITEMS)             47300017
473100         OR (SU025-IDX GREATER THAN SU025-MAX-ITEMS))             47310017
473200         IF  SU025-ACTION-SW (SU025-IDX) > SPACE                  47320017
473300             PERFORM 6110A-PROCESS-ITEMS                          47330017
473400         END-IF                                                   47340017
473500         ADD +1                    TO PV-ITEMS-PROCESSED          47350017
473600     END-PERFORM.                                                 47360017
473700                                                                  47370017
473800     PERFORM 6111-WRITE-LIST-QUEUE.                               47380017
473900                                                                  47390017
474000 6102-UPDATE-TSQ.                                                 47400017
474100                                                                  47410017
474200     ADD 1                         TO PV-SEL-QUEUE-ITEM.          47420017
474300     PERFORM 6107-READ-SEL-QUEUE.                                 47430017
474400                                                                  47440017
474500     PERFORM                                                      47450017
474600         VARYING RC817-IDX                                        47460017
474700         FROM 1 BY 1                                              47470017
474800         UNTIL ((PV-ITEMS-PROCESSED >                             47480017
474900                              PV-HOLD-SELECTED-ITEMS)             47490017
475000         OR (RC817-IDX GREATER THAN RC817-MAX-ITEMS))             47500017
475100         IF  RC817-ACTION-SW (RC817-IDX) > SPACE                  47510017
475200             PERFORM 6110B-PROCESS-ITEMS                          47520017
475300         END-IF                                                   47530017
475400         ADD +1                    TO PV-ITEMS-PROCESSED          47540017
475500     END-PERFORM.                                                 47550017
475600                                                                  47560017
475700     PERFORM 6111-WRITE-LIST-QUEUE.                               47570017
475800                                                                  47580017
475900                                                                  47590017
476000 6103-UPDATE-TSQ.                                                 47600017
476100                                                                  47610017
476200     ADD 1                         TO PV-SEL-QUEUE-ITEM.          47620017
476300     PERFORM 6108-READ-SEL-QUEUE.                                 47630017
476400                                                                  47640017
476500     PERFORM                                                      47650017
476600         VARYING SU004-IDX                                        47660017
476700         FROM 1 BY 1                                              47670017
476800         UNTIL ((PV-ITEMS-PROCESSED >                             47680017
476900                              PV-HOLD-SELECTED-ITEMS)             47690017
477000         OR (SU004-IDX GREATER THAN SU004-MAX-ITEMS))             47700017
477100         IF  SU004-ACTION-SW (SU004-IDX) > SPACE                  47710017
477200             PERFORM 6110C-PROCESS-ITEMS                          47720017
477300         END-IF                                                   47730017
477400         ADD +1                    TO PV-ITEMS-PROCESSED          47740017
477500     END-PERFORM.                                                 47750017
477600                                                                  47760017
477700     PERFORM 6111-WRITE-LIST-QUEUE.                               47770017
477800                                                                  47780017
477900                                                                  47790017
478000 6104-UPDATE-TSQ.                                                 47800017
478100                                                                  47810017
478200     ADD 1                         TO PV-SEL-QUEUE-ITEM.          47820017
478300     PERFORM 6109-READ-SEL-QUEUE.                                 47830017
478400                                                                  47840017
478500     PERFORM                                                      47850017
478600         VARYING TR006-IDX                                        47860017
478700         FROM 1 BY 1                                              47870017
478800         UNTIL ((PV-ITEMS-PROCESSED >                             47880017
478900                              PV-HOLD-SELECTED-ITEMS)             47890017
479000         OR (TR006-IDX GREATER THAN TR006-MAX-ITEMS))             47900017
479100         IF  TR006-ACTION-SW (TR006-IDX) > SPACE                  47910017
479200             PERFORM 6110D-PROCESS-ITEMS                          47920017
479300         END-IF                                                   47930017
479400         ADD +1                    TO PV-ITEMS-PROCESSED          47940017
479500     END-PERFORM.                                                 47950017
479600                                                                  47960017
479700     PERFORM 6111-WRITE-LIST-QUEUE.                               47970017
479800                                                                  47980017
479900*----------------------------------------------------------------*47990017
480000*    READ THE LIST QUEUE RECORD.                                 *48000017
480100*----------------------------------------------------------------*48010017
480200                                                                  48020017
480300 6105-READ-SEL-QUEUE.                                             48030017
480400                                                                  48040017
480500     EXEC CICS                                                    48050017
480600          READQ TS                                                48060017
480700              QUEUE (ASC-SEL-QUEUE-NAME)                          48070017
480800              INTO  (RC013-DC-SELECT-RECORD)                      48080017
480900              ITEM  (PV-SEL-QUEUE-ITEM)                           48090017
481000              RESP  (PV-CICS-RESP)                                48100017
481100     END-EXEC.                                                    48110017
481200                                                                  48120017
481300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          48130017
481400         CONTINUE                                                 48140017
481500     ELSE                                                         48150017
481600         SET DP013-CICS-ABEND      TO TRUE                        48160017
481700         SET DP013-NO-ROLLBACK     TO TRUE                        48170017
481800         MOVE '6105-READ-SEL-QUEUE'                               48180017
481900                                   TO DP013-PARAGRAPH             48190017
482000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           48200017
482100                                   TO DP013-MESSAGE-TEXT(1)       48210017
482200         PERFORM DP013-0000-PROCESS-ABEND                         48220017
482300     END-IF.                                                      48230017
482400                                                                  48240017
482500 6106-READ-SEL-QUEUE.                                             48250017
482600                                                                  48260017
482700     EXEC CICS                                                    48270017
482800          READQ TS                                                48280017
482900              QUEUE (ASC-SEL-QUEUE-NAME)                          48290017
483000              INTO  (SU025-SELECT-RECORD)                         48300017
483100              ITEM  (PV-SEL-QUEUE-ITEM)                           48310017
483200              RESP  (PV-CICS-RESP)                                48320017
483300     END-EXEC.                                                    48330017
483400                                                                  48340017
483500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          48350017
483600         CONTINUE                                                 48360017
483700     ELSE                                                         48370017
483800         SET DP013-CICS-ABEND      TO TRUE                        48380017
483900         SET DP013-NO-ROLLBACK     TO TRUE                        48390017
484000         MOVE '6106-READ-SEL-QUEUE'                               48400017
484100                                   TO DP013-PARAGRAPH             48410017
484200         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           48420017
484300                                   TO DP013-MESSAGE-TEXT(1)       48430017
484400         PERFORM DP013-0000-PROCESS-ABEND                         48440017
484500     END-IF.                                                      48450017
484600                                                                  48460017
484700 6107-READ-SEL-QUEUE.                                             48470017
484800                                                                  48480017
484900     EXEC CICS                                                    48490017
485000          READQ TS                                                48500017
485100              QUEUE (ASC-SEL-QUEUE-NAME)                          48510017
485200              INTO  (RC817-SELECT-RECORD)                         48520017
485300              ITEM  (PV-SEL-QUEUE-ITEM)                           48530017
485400              RESP  (PV-CICS-RESP)                                48540017
485500     END-EXEC.                                                    48550017
485600                                                                  48560017
485700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          48570017
485800         CONTINUE                                                 48580017
485900     ELSE                                                         48590017
486000         SET DP013-CICS-ABEND      TO TRUE                        48600017
486100         SET DP013-NO-ROLLBACK     TO TRUE                        48610017
486200         MOVE '6107-READ-SEL-QUEUE'                               48620017
486300                                   TO DP013-PARAGRAPH             48630017
486400         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           48640017
486500                                   TO DP013-MESSAGE-TEXT(1)       48650017
486600         PERFORM DP013-0000-PROCESS-ABEND                         48660017
486700     END-IF.                                                      48670017
486800                                                                  48680017
486900                                                                  48690017
487000 6108-READ-SEL-QUEUE.                                             48700017
487100                                                                  48710017
487200     EXEC CICS                                                    48720017
487300          READQ TS                                                48730017
487400              QUEUE (ASC-SEL-QUEUE-NAME)                          48740017
487500              INTO  (SU004-DC-SELECT-RECORD)                      48750017
487600              ITEM  (PV-SEL-QUEUE-ITEM)                           48760017
487700              RESP  (PV-CICS-RESP)                                48770017
487800     END-EXEC.                                                    48780017
487900                                                                  48790017
488000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          48800017
488100         CONTINUE                                                 48810017
488200     ELSE                                                         48820017
488300         SET DP013-CICS-ABEND      TO TRUE                        48830017
488400         SET DP013-NO-ROLLBACK     TO TRUE                        48840017
488500         MOVE '6108-READ-SEL-QUEUE'                               48850017
488600                                   TO DP013-PARAGRAPH             48860017
488700         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           48870017
488800                                   TO DP013-MESSAGE-TEXT(1)       48880017
488900         PERFORM DP013-0000-PROCESS-ABEND                         48890017
489000     END-IF.                                                      48900017
489100                                                                  48910017
489200                                                                  48920017
489300 6109-READ-SEL-QUEUE.                                             48930017
489400                                                                  48940017
489500     EXEC CICS                                                    48950017
489600          READQ TS                                                48960017
489700              QUEUE (ASC-SEL-QUEUE-NAME)                          48970017
489800              INTO  (TR006-DOCK-SCHEDULE-REC)                     48980017
489900              ITEM  (PV-SEL-QUEUE-ITEM)                           48990017
490000              RESP  (PV-CICS-RESP)                                49000017
490100     END-EXEC.                                                    49010017
490200                                                                  49020017
490300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          49030017
490400         CONTINUE                                                 49040017
490500     ELSE                                                         49050017
490600         SET DP013-CICS-ABEND      TO TRUE                        49060017
490700         SET DP013-NO-ROLLBACK     TO TRUE                        49070017
490800         MOVE '6109-READ-SEL-QUEUE'                               49080017
490900                                   TO DP013-PARAGRAPH             49090017
491000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           49100017
491100                                   TO DP013-MESSAGE-TEXT(1)       49110017
491200         PERFORM DP013-0000-PROCESS-ABEND                         49120017
491300     END-IF.                                                      49130017
491400                                                                  49140017
491500                                                                  49150017
491600*----------------------------------------------------------------*49160017
491700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*49170017
491800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*49180017
491900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *49190017
492000*----------------------------------------------------------------*49200017
492100                                                                  49210017
492200 6110-PROCESS-ITEMS.                                              49220017
492300                                                                  49230017
492400     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          49240017
492500                     / PC-ITEMS-PER-PANEL).                       49250017
492600                                                                  49260017
492700     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           49270017
492800         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          49280017
492900             PERFORM 6111-WRITE-LIST-QUEUE                        49290017
493000         END-IF                                                   49300017
493100         MOVE PV-ITEM              TO PV-SAVE-ITEM                49310017
493200                                                                  49320017
493300         PERFORM 6112-READ-LIST-QUEUE                             49330017
493400         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               49340017
493500             CONTINUE                                             49350017
493600         END-IF                                                   49360017
493700     END-IF.                                                      49370017
493800                                                                  49380017
493900     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     49390017
494000                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              49400017
494100                                                                  49410017
494200     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       49420017
494300     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        49430017
494400                                     (PV-SUB).                    49440017
494500     EVALUATE TRUE                                                49450017
494600         WHEN RC013-INQ (RC013-IDX)                               49460017
494700              MOVE PC-INQ          TO LQW-ACTION (PV-SUB)         49470017
494800                                                                  49480017
494900         WHEN RC013-UPD (RC013-IDX)                               49490017
495000              MOVE PC-UPD          TO LQW-ACTION (PV-SUB)         49500017
495100                                                                  49510017
495200         WHEN RC013-DEL (RC013-IDX)                               49520017
495300              MOVE PC-DEL          TO LQW-ACTION (PV-SUB)         49530017
495400                                                                  49540017
495500         WHEN RC013-ERR (RC013-IDX)                               49550017
495600              MOVE PC-ERR          TO LQW-ACTION (PV-SUB)         49560017
495700     END-EVALUATE.                                                49570017
495800                                                                  49580017
495900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                49590017
496000                                                                  49600017
496100 6110A-PROCESS-ITEMS.                                             49610017
496200                                                                  49620017
496300     COMPUTE PV-ITEM = 1 + ((SU025-ITEM (SU025-IDX) - 1)          49630017
496400                     / PC-ITEMS-PER-PANEL).                       49640017
496500                                                                  49650017
496600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           49660017
496700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          49670017
496800             PERFORM 6111-WRITE-LIST-QUEUE                        49680017
496900         END-IF                                                   49690017
497000         MOVE PV-ITEM              TO PV-SAVE-ITEM                49700017
497100                                                                  49710017
497200         PERFORM 6112-READ-LIST-QUEUE                             49720017
497300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               49730017
497400             CONTINUE                                             49740017
497500         END-IF                                                   49750017
497600     END-IF.                                                      49760017
497700                                                                  49770017
497800     COMPUTE PV-SUB = (SU025-ITEM (SU025-IDX)                     49780017
497900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              49790017
498000                                                                  49800017
498100     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       49810017
498200     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        49820017
498300                                     (PV-SUB).                    49830017
498400     EVALUATE TRUE                                                49840017
498500         WHEN SU025-INQ (SU025-IDX)                               49850017
498600              MOVE PC-INQ          TO LQW-ACTION (PV-SUB)         49860017
498700                                                                  49870017
498800         WHEN SU025-UPD (SU025-IDX)                               49880017
498900              MOVE PC-UPD          TO LQW-ACTION (PV-SUB)         49890017
499000                                                                  49900017
499100         WHEN SU025-DEL (SU025-IDX)                               49910017
499200              MOVE PC-DEL          TO LQW-ACTION (PV-SUB)         49920017
499300                                                                  49930017
499400         WHEN SU025-ERR (SU025-IDX)                               49940017
499500              MOVE PC-ERR          TO LQW-ACTION (PV-SUB)         49950017
499600     END-EVALUATE.                                                49960017
499700                                                                  49970017
499800     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                49980017
499900                                                                  49990017
500000 6110B-PROCESS-ITEMS.                                             50000017
500100                                                                  50010017
500200     COMPUTE PV-ITEM = 1 + ((RC817-ITEM (RC817-IDX) - 1)          50020017
500300                     / PC-ITEMS-PER-PANEL).                       50030017
500400                                                                  50040017
500500     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           50050017
500600         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          50060017
500700             PERFORM 6111-WRITE-LIST-QUEUE                        50070017
500800         END-IF                                                   50080017
500900         MOVE PV-ITEM              TO PV-SAVE-ITEM                50090017
501000                                                                  50100017
501100         PERFORM 6112-READ-LIST-QUEUE                             50110017
501200         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               50120017
501300             CONTINUE                                             50130017
501400         END-IF                                                   50140017
501500     END-IF.                                                      50150017
501600                                                                  50160017
501700     COMPUTE PV-SUB = (RC817-ITEM (RC817-IDX)                     50170017
501800                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              50180017
501900                                                                  50190017
502000     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       50200017
502100     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        50210017
502200                                     (PV-SUB).                    50220017
502300     EVALUATE TRUE                                                50230017
502400         WHEN RC817-INQ (RC817-IDX)                               50240017
502500              MOVE PC-INQ          TO LQW-ACTION (PV-SUB)         50250017
502600                                                                  50260017
502700         WHEN RC817-UPD (RC817-IDX)                               50270017
502800              MOVE PC-UPD          TO LQW-ACTION (PV-SUB)         50280017
502900                                                                  50290017
503000         WHEN RC817-DEL (RC817-IDX)                               50300017
503100              MOVE PC-DEL          TO LQW-ACTION (PV-SUB)         50310017
503200                                                                  50320017
503300         WHEN RC817-ERR (RC817-IDX)                               50330017
503400              MOVE PC-ERR          TO LQW-ACTION (PV-SUB)         50340017
503500     END-EVALUATE.                                                50350017
503600                                                                  50360017
503700     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                50370017
503800                                                                  50380017
503900 6110C-PROCESS-ITEMS.                                             50390017
504000                                                                  50400017
504100     COMPUTE PV-ITEM = 1 + ((SU004-ITEM (SU004-IDX) - 1)          50410017
504200                     / PC-ITEMS-PER-PANEL).                       50420017
504300                                                                  50430017
504400     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           50440017
504500         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          50450017
504600             PERFORM 6111-WRITE-LIST-QUEUE                        50460017
504700         END-IF                                                   50470017
504800         MOVE PV-ITEM              TO PV-SAVE-ITEM                50480017
504900                                                                  50490017
505000         PERFORM 6112-READ-LIST-QUEUE                             50500017
505100         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               50510017
505200             CONTINUE                                             50520017
505300         END-IF                                                   50530017
505400     END-IF.                                                      50540017
505500                                                                  50550017
505600     COMPUTE PV-SUB = (SU004-ITEM (SU004-IDX)                     50560017
505700                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              50570017
505800                                                                  50580017
505900     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       50590017
506000     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        50600017
506100                                     (PV-SUB).                    50610017
506200     EVALUATE TRUE                                                50620017
506300         WHEN SU004-INQ (SU004-IDX)                               50630017
506400              MOVE PC-INQ          TO LQW-ACTION (PV-SUB)         50640017
506500                                                                  50650017
506600         WHEN SU004-UPD (SU004-IDX)                               50660017
506700              MOVE PC-UPD          TO LQW-ACTION (PV-SUB)         50670017
506800                                                                  50680017
506900         WHEN SU004-DEL (SU004-IDX)                               50690017
507000              MOVE PC-DEL          TO LQW-ACTION (PV-SUB)         50700017
507100                                                                  50710017
507200         WHEN SU004-ERR (SU004-IDX)                               50720017
507300              MOVE PC-ERR          TO LQW-ACTION (PV-SUB)         50730017
507400     END-EVALUATE.                                                50740017
507500                                                                  50750017
507600     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                50760017
507700                                                                  50770017
507800                                                                  50780017
507900 6110D-PROCESS-ITEMS.                                             50790017
508000                                                                  50800017
508100     COMPUTE PV-ITEM = 1 + ((TR006-ITEM (TR006-IDX) - 1)          50810017
508200                     / PC-ITEMS-PER-PANEL).                       50820017
508300                                                                  50830017
508400     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           50840017
508500         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          50850017
508600             PERFORM 6111-WRITE-LIST-QUEUE                        50860017
508700         END-IF                                                   50870017
508800         MOVE PV-ITEM              TO PV-SAVE-ITEM                50880017
508900                                                                  50890017
509000         PERFORM 6112-READ-LIST-QUEUE                             50900017
509100         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               50910017
509200             CONTINUE                                             50920017
509300         END-IF                                                   50930017
509400     END-IF.                                                      50940017
509500                                                                  50950017
509600     COMPUTE PV-SUB = (TR006-ITEM (TR006-IDX)                     50960017
509700                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              50970017
509800                                                                  50980017
509900     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       50990017
510000     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        51000017
510100                                     (PV-SUB).                    51010017
510200     EVALUATE TRUE                                                51020017
510300         WHEN TR006-INQ (TR006-IDX)                               51030017
510400              MOVE PC-INQ          TO LQW-ACTION (PV-SUB)         51040017
510500                                                                  51050017
510600         WHEN TR006-UPD (TR006-IDX)                               51060017
510700              MOVE PC-UPD          TO LQW-ACTION (PV-SUB)         51070017
510800              MOVE LQW-PO-NBR (PV-SUB)      TO  DK-PO-NBR         51080017
510900              MOVE LQW-REC-SEQ-NBR (PV-SUB) TO  DK-REC-SEQ-NBR    51090017
511000              PERFORM 7220-GET-ARRIVE-TMST                        51100017
511100              IF  PV-ARRIVE-DATE =  SPACES OR 'ENROUTE '          51110017
511200                  CONTINUE                                        51120017
511300              ELSE                                                51130017
511400                  MOVE PV-ARRIVE-DATE                             51140017
511500                                   TO LQW-ARRIVE-DTE (PV-SUB)     51150017
511600                  MOVE 'READY'     TO LQW-STATUS     (PV-SUB)     51160017
511700              END-IF                                              51170017
511800                                                                  51180017
511900         WHEN TR006-DEL (TR006-IDX)                               51190017
512000              MOVE PC-DEL          TO LQW-ACTION (PV-SUB)         51200017
512100                                                                  51210017
512200         WHEN TR006-ERR (TR006-IDX)                               51220017
512300              MOVE PC-ERR          TO LQW-ACTION (PV-SUB)         51230017
512400     END-EVALUATE.                                                51240017
512500                                                                  51250017
512600     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                51260017
512700                                                                  51270017
512800*----------------------------------------------------------------*51280017
512900*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *51290017
513000*----------------------------------------------------------------*51300017
513100                                                                  51310017
513200 6111-WRITE-LIST-QUEUE.                                           51320017
513300                                                                  51330017
513400     EXEC CICS                                                    51340017
513500         WRITEQ TS                                                51350017
513600             QUEUE (ASC-LIST-QUEUE-NAME)                          51360017
513700             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     51370017
513800             ITEM  (PV-SAVE-ITEM)                                 51380017
513900             REWRITE                                              51390017
514000             RESP  (PV-CICS-RESP)                                 51400017
514100     END-EXEC.                                                    51410017
514200                                                                  51420017
514300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          51430017
514400         CONTINUE                                                 51440017
514500     ELSE                                                         51450017
514600         SET DP013-CICS-ABEND      TO TRUE                        51460017
514700         SET DP013-NO-ROLLBACK     TO TRUE                        51470017
514800         MOVE '6111-WRITE-LIST-QUEUE'                             51480017
514900                                   TO DP013-PARAGRAPH             51490017
515000         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  51500017
515100                                   TO DP013-MESSAGE-TEXT(1)       51510017
515200         PERFORM DP013-0000-PROCESS-ABEND                         51520017
515300     END-IF.                                                      51530017
515400                                                                  51540017
515500/                                                                 51550017
515600*----------------------------------------------------------------*51560017
515700*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*51570017
515800*----------------------------------------------------------------*51580017
515900                                                                  51590017
516000 6112-READ-LIST-QUEUE.                                            51600017
516100                                                                  51610017
516200     EXEC CICS                                                    51620017
516300         READQ TS                                                 51630017
516400             QUEUE (ASC-LIST-QUEUE-NAME)                          51640017
516500             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     51650017
516600             ITEM  (PV-ITEM)                                      51660017
516700             RESP  (PV-CICS-RESP)                                 51670017
516800     END-EXEC.                                                    51680017
516900                                                                  51690017
517000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          51700017
517100         CONTINUE                                                 51710017
517200     ELSE                                                         51720017
517300         SET DP013-CICS-ABEND      TO TRUE                        51730017
517400         SET DP013-NO-ROLLBACK     TO TRUE                        51740017
517500         MOVE '6112-READ-LIST-QUEUE'                              51750017
517600                                   TO DP013-PARAGRAPH             51760017
517700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    51770017
517800                                   TO DP013-MESSAGE-TEXT(1)       51780017
517900         PERFORM DP013-0000-PROCESS-ABEND                         51790017
518000     END-IF.                                                      51800017
518100/                                                                 51810017
518200 7000-GET-VENDOR-NAME.                                            51820017
518300     INITIALIZE DCLTENTNME                                        51830017
518400                                                                  51840017
518500     MOVE ASC-PO-NBR (ASC-BLK-SUB ASC-ITEM-SUB)                   51850017
518600                                      TO DK-PO-NBR                51860017
518700                                                                  51870017
518800     EXEC SQL                                                     51880017
518900     SELECT                                                       51890017
519000         ENT_NAME_DESC                                            51900017
519100*      , DEPT_NBR                                                 51910017
519200     INTO                                                         51920017
519300         :ENTNME-ENT-NAME-DESC                                    51930017
519400*      , :PURCHS-DEPT-NBR                                         51940017
519500     FROM                                                         51950017
519600         TENTNME A                                                51960017
519700       , TEXTENT B                                                51970017
519800       , TPURCHS C                                                51980017
519900     WHERE                                                        51990017
520000         C.PO_NBR = :DK-PO-NBR                                    52000017
520100     AND                                                          52010017
520200         C.VER_STATUS_CDE = 'A'                                   52020017
520300     AND A.SEQ_NBR =                                              52030017
520400         (SELECT MAX(SEQ_NBR)                                     52040017
520500             FROM TENTNME                                         52050017
520600             WHERE ENT_ID = C.ENT_ID                              52060017
520700             AND TYPE_CDE = '01')                                 52070017
520800     AND A.ENT_ID = B.ENT_ID                                      52080017
520900     AND B.ENT_ID = C.ENT_ID                                      52090017
521000     WITH UR                                                      52100019
521100     END-EXEC.                                                    52110017
521200                                                                  52120017
521300     EVALUATE TRUE                                                52130017
521400         WHEN SQLCODE = ZERO                                      52140017
521500         WHEN SQLCODE = +100                                      52150017
521600              CONTINUE                                            52160017
521700         WHEN SQLCODE = -904                                      52170017
521800         WHEN SQLCODE = -911                                      52180017
521900         WHEN SQLCODE = -913                                      52190017
522000             PERFORM 9900-SOFT-ABORT                              52200017
522100                                                                  52210017
522200         WHEN SQLWARN0 NOT = SPACE                                52220017
522300         WHEN SQLCODE < ZERO                                      52230017
522400         WHEN SQLCODE > ZERO                                      52240017
522500              MOVE '7000-GET-VENDOR-NAME'                         52250017
522600                                   TO DP013-PARAGRAPH             52260017
522700              MOVE 'SELECT VENDOR NAME'                           52270017
522800                                   TO DP013-MESSAGE-TEXT (1)      52280017
522900              MOVE SQLCA           TO DP013-SQLCA                 52290017
523000              MOVE 'TENTNME'       TO DP013-DB2-TABLE-NAME (1)    52300017
523100              MOVE 'TEXTENT'       TO DP013-DB2-TABLE-NAME (2)    52310017
523200              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (3)    52320017
523300              SET DP013-DB2-ABEND  TO TRUE                        52330017
523400              PERFORM DP013-0000-PROCESS-ABEND                    52340017
523500     END-EVALUATE.                                                52350017
523600/                                                                 52360017
523700 7010-LOCATION-NAME.                                              52370017
523800     EXEC SQL                                                     52380017
523900         SELECT                                                   52390017
524000             LOC_NM                                               52400017
524100         INTO                                                     52410017
524200             :XLT00010-LOC-NM                                     52420017
524300         FROM XLT_LOC                                             52430017
524400         WHERE                                                    52440017
524500             LOC_NBR                  = :DK-OPER-UNT-ID           52450017
524600     END-EXEC.                                                    52460017
524700                                                                  52470017
524800     EVALUATE TRUE                                                52480017
524900         WHEN SQLCODE = ZERO                                      52490017
525000             MOVE XLT00010-LOC-NM     TO ASC-LOC-NM               52500017
525100         WHEN SQLCODE = +100                                      52510017
525200             MOVE SPACES              TO ASC-LOC-NM               52520017
525300         WHEN SQLCODE = -904                                      52530017
525400         WHEN SQLCODE = -911                                      52540017
525500         WHEN SQLCODE = -913                                      52550017
525600             PERFORM 9900-SOFT-ABORT                              52560017
525700                                                                  52570017
525800         WHEN SQLWARN0 NOT = SPACE                                52580017
525900         WHEN SQLCODE < ZERO                                      52590017
526000         WHEN SQLCODE > ZERO                                      52600017
526100              MOVE '7010-LOCATION-NAME'                           52610017
526200                                   TO DP013-PARAGRAPH             52620017
526300              MOVE 'SELECT LOCATION NAME'                         52630017
526400                                   TO DP013-MESSAGE-TEXT (1)      52640017
526500              MOVE SQLCA           TO DP013-SQLCA                 52650017
526600              MOVE 'XLT_LOC'       TO DP013-DB2-TABLE-NAME (1)    52660017
526700              SET DP013-DB2-ABEND  TO TRUE                        52670017
526800              PERFORM DP013-0000-PROCESS-ABEND                    52680017
526900     END-EVALUATE.                                                52690017
527000/                                                                 52700017
527100/                                                                 52710017
527200 7200-GET-SHIPMT-INFO.                                            52720017
527300                                                                  52730017
527400     INITIALIZE DCLTSHPTPO                                        52740017
527500                DCLTSHIPMT                                        52750017
527600                                                                  52760017
527700     MOVE RC013-PO-NBR (RC013-IDX)    TO SHPTPO-PO-NBR            52770017
527800     MOVE RC013-REC-SEQ-NBR (RC013-IDX)                           52780017
527900                                      TO SHPTPO-REC-SEQ-NBR       52790017
528000     EXEC SQL                                                     52800017
528100                                                                  52810017
528200         SELECT                                                   52820017
528300             SH.SHIPT_ID                                          52830017
528400         ,   SH.PRO_NBR                                           52840017
528500         ,   SH.BOL_NBR                                           52850017
528600         ,   SH.PRO_SCAC_ID                                       52860017
528700         INTO                                                     52870017
528800            :SHIPMT-SHIPT-ID                                      52880017
528900         ,  :SHIPMT-PRO-NBR                                       52890017
529000         ,  :SHIPMT-BOL-NBR                                       52900017
529100         ,  :SHIPMT-PRO-SCAC-ID                                   52910017
529200         FROM                                                     52920017
529300             TSHPTPO PO                                           52930017
529400         ,   TSHIPMT SH                                           52940017
529500       WHERE                                                      52950017
529600               PO.PO_NBR         = :SHPTPO-PO-NBR                 52960017
529700           AND PO.REC_SEQ_NBR    = :SHPTPO-REC-SEQ-NBR            52970017
529800           AND PO.PRIM_SHIPT_IND = 'Y'                            52980017
529900           AND PO.SHIPT_ID       = SH.SHIPT_ID                    52990017
530000     END-EXEC                                                     53000017
530100                                                                  53010017
530200     EVALUATE TRUE                                                53020017
530300         WHEN SQLCODE = ZERO                                      53030017
530400         WHEN SQLCODE = +100                                      53040017
530500             CONTINUE                                             53050017
530600         WHEN SQLCODE = -904                                      53060017
530700         WHEN SQLCODE = -911                                      53070017
530800         WHEN SQLCODE = -913                                      53080017
530900             PERFORM 9900-SOFT-ABORT                              53090017
531000                                                                  53100017
531100         WHEN SQLWARN0 NOT = SPACE                                53110017
531200         WHEN SQLCODE < ZERO                                      53120017
531300         WHEN SQLCODE > ZERO                                      53130017
531400              MOVE '7200-GET-SHIPMT-INFO'                         53140017
531500                                   TO DP013-PARAGRAPH             53150017
531600              MOVE 'SELECT PREPACK ID'                            53160017
531700                                   TO DP013-MESSAGE-TEXT (1)      53170017
531800              MOVE SQLCA           TO DP013-SQLCA                 53180017
531900              MOVE 'TSHPTPO'       TO DP013-DB2-TABLE-NAME (1)    53190017
532000              MOVE 'TSHIPMT'       TO DP013-DB2-TABLE-NAME (2)    53200017
532100              SET DP013-DB2-ABEND  TO TRUE                        53210017
532200              PERFORM DP013-0000-PROCESS-ABEND                    53220017
532300     END-EVALUATE.                                                53230017
532400/                                                                 53240017
532500 7205-GET-TRIP-ID.                                                53250017
532600                                                                  53260017
532700     EXEC SQL                                                     53270017
532800          SELECT A.TRIP_ID                                        53280017
532900                ,A.OWNER_SCAC_ID                                  53290017
533000                ,A.VEH_NBR                                        53300017
533100                ,B.TRIP_STATUS_CDE                                53310017
533200                ,E.SHIPT_ID                                       53320017
533300          INTO  :VHTRIP-TRIP-ID                                   53330017
533400               ,:VHTRIP-OWNER-SCAC-ID                             53340017
533500               ,:VHTRIP-VEH-NBR :DN-VEH-NBR                       53350017
533600               ,:TRIPST-TRIP-STATUS-CDE                           53360017
533700               ,:SHIPMT-SHIPT-ID                                  53370017
533800           FROM TVHTRIP A                                         53380017
533900               ,TTRIPST B                                         53390017
534000               ,TTRSTYP C                                         53400017
534100               ,TSHIPMT E                                         53410017
534200               ,TSHPTPO F                                         53420017
534300          WHERE F.PO_NBR           = :DK-PO-NBR                   53430017
534400            AND F.REC_SEQ_NBR      = :DK-REC-SEQ-NBR              53440017
534500            AND A.TRIP_ID          = B.TRIP_ID                    53450017
534600            AND B.TRIP_STATUS_CDE  = C.TRIP_STATUS_CDE            53460017
534700            AND A.TRIP_ID          = E.TRIP_ID                    53470017
534800            AND E.SHIPT_ID         = F.SHIPT_ID                   53480017
534900            AND F.PRIM_SHIPT_IND   = 'Y'                          53490017
535000            AND C.PRTY_CDE         =                              53500017
535100              (SELECT MAX(E.PRTY_CDE)                             53510017
535200                FROM TTRIPST D                                    53520017
535300                    ,TTRSTYP E                                    53530017
535400               WHERE D.TRIP_ID         = A.TRIP_ID                53540017
535500                 AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)       53550017
535600     END-EXEC.                                                    53560017
535700                                                                  53570017
535800     EVALUATE TRUE                                                53580017
535900         WHEN SQLCODE = ZERO                                      53590017
536000              IF DN-VEH-NBR = -1                                  53600017
536100                 MOVE SPACES       TO   VHTRIP-VEH-NBR            53610017
536200              END-IF                                              53620017
536300         WHEN SQLCODE = +100                                      53630017
536400             CONTINUE                                             53640017
536500         WHEN SQLCODE = -811                                      53650017
536600         WHEN SQLWARN0 NOT = SPACE                                53660017
536700         WHEN SQLCODE NOT = ZERO                                  53670017
536800              MOVE '7205-GET-TRIP-ID'                             53680017
536900                                      TO DP013-PARAGRAPH          53690017
537000              MOVE 'FETCH MESSAGE CURSOR'                         53700017
537100                                      TO DP013-MESSAGE-TEXT (1)   53710017
537200              MOVE DK-PO-NBR          TO PV-ERROR-PO              53720017
537300              MOVE DK-REC-SEQ-NBR     TO PV-ERROR-SEQ             53730017
537400              MOVE DK-OPER-UNT-ID     TO PV-ERROR-OPER-UNT-ID     53740017
537500              MOVE DK-FCLTY-ID        TO PV-ERROR-FCLTY-ID        53750017
537600              MOVE PV-ERROR-MSG       TO DP013-MESSAGE-TEXT (2)   53760017
537700              MOVE SQLCA              TO DP013-SQLCA              53770017
537800              SET DP013-DB2-ABEND     TO TRUE                     53780017
537900              PERFORM DP013-0000-PROCESS-ABEND                    53790017
538000     END-EVALUATE.                                                53800017
538100                                                                  53810017
538200/                                                                 53820017
538300 7210-GET-PREPK-ID.                                               53830017
538400                                                                  53840017
538500     MOVE ZEROES                      TO RECITM-PREPK-ID          53850017
538600     EXEC SQL                                                     53860017
538700         SELECT                                                   53870017
538800             PREPK_ID                                             53880017
538900         INTO                                                     53890017
539000             :RECITM-PREPK-ID                                     53900017
539100         FROM TRECITM                                             53910017
539200         WHERE                                                    53920017
539300             ORD_NBR                  = :DISTHD-ORD-NBR           53930017
539400         AND ORD_LNE_NBR              = :DISTHD-ORD-LNE-NBR       53940017
539500         AND REC_SEQ_NBR              = :DISTHD-RCVR-SEQ-NBR      53950017
539600         AND OPER_UNT_ID              = :ASC-KEY-OPER-UNT-ID      53960017
539700         AND FCLTY_ID                 = 1                         53970017
539800         AND VER_STATUS_CDE           = 'A'                       53980017
539900     END-EXEC                                                     53990017
540000                                                                  54000017
540100     EVALUATE TRUE                                                54010017
540200         WHEN SQLCODE = ZERO                                      54020017
540300             CONTINUE                                             54030017
540400         WHEN SQLCODE = +100                                      54040017
540500             CONTINUE                                             54050017
540600         WHEN SQLCODE = -904                                      54060017
540700         WHEN SQLCODE = -911                                      54070017
540800         WHEN SQLCODE = -913                                      54080017
540900             PERFORM 9900-SOFT-ABORT                              54090017
541000                                                                  54100017
541100         WHEN SQLWARN0 NOT = SPACE                                54110017
541200         WHEN SQLCODE < ZERO                                      54120017
541300         WHEN SQLCODE > ZERO                                      54130017
541400              MOVE '7210-GET-PREPK-ID'                            54140017
541500                                   TO DP013-PARAGRAPH             54150017
541600              MOVE 'SELECT PREPACK ID'                            54160017
541700                                   TO DP013-MESSAGE-TEXT (1)      54170017
541800              MOVE SQLCA           TO DP013-SQLCA                 54180017
541900              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (1)    54190017
542000              SET DP013-DB2-ABEND  TO TRUE                        54200017
542100              PERFORM DP013-0000-PROCESS-ABEND                    54210017
542200     END-EVALUATE.                                                54220017
542300/                                                                 54230017
542400 7215-GET-RECITM-STATUS.                                          54240017
542500                                                                  54250017
542600*  WHEN WE FIND A NON-VERIFIED LINE IT QUALIFIES THE RECEIVER     54260017
542700*  TO BE SHOWN                                                    54270017
542800                                                                  54280017
542900     EXEC SQL                                                     54290017
543000         SELECT                                                   54300017
543100             'Y'                                                  54310017
543200         INTO                                                     54320017
543300             :PS-SHOW-RCVR-SW                                     54330017
543400         FROM TRECITM                                             54340017
543500         WHERE                                                    54350017
543600             ORD_NBR                  = :DISTHD-ORD-NBR           54360017
543700         AND ORD_LNE_NBR              = :DISTHD-ORD-LNE-NBR       54370017
543800         AND REC_SEQ_NBR              = :DISTHD-RCVR-SEQ-NBR      54380017
543900         AND VER_STATUS_CDE           = 'A'                       54390017
544000         AND STATUS_CDE               <> 'VE'                     54400017
544100     END-EXEC                                                     54410017
544200                                                                  54420017
544300     EVALUATE TRUE                                                54430017
544400         WHEN SQLCODE = ZERO                                      54440017
544500             CONTINUE                                             54450017
544600         WHEN SQLCODE = +100                                      54460017
544700             CONTINUE                                             54470017
544800         WHEN SQLCODE = -904                                      54480017
544900         WHEN SQLCODE = -911                                      54490017
545000         WHEN SQLCODE = -913                                      54500017
545100             PERFORM 9900-SOFT-ABORT                              54510017
545200                                                                  54520017
545300         WHEN SQLWARN0 NOT = SPACE                                54530017
545400         WHEN SQLCODE < ZERO                                      54540017
545500         WHEN SQLCODE > ZERO                                      54550017
545600              MOVE '7215-GET-RECITM-STATUS'                       54560017
545700                                   TO DP013-PARAGRAPH             54570017
545800              MOVE 'SELECT STATUS'                                54580017
545900                                   TO DP013-MESSAGE-TEXT (1)      54590017
546000              MOVE SQLCA           TO DP013-SQLCA                 54600017
546100              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (1)    54610017
546200              SET DP013-DB2-ABEND  TO TRUE                        54620017
546300              PERFORM DP013-0000-PROCESS-ABEND                    54630017
546400     END-EVALUATE.                                                54640017
546500                                                                  54650017
546600 7220-GET-ARRIVE-TMST.                                            54660017
546700     EXEC SQL                                                     54670017
546800           SELECT                                                 54680017
546900                  CASE                                            54690017
547000                  WHEN                                            54700017
547100                  (SUBSTR (CHAR ( DATE (REC_TMST),USA),1,6)       54710017
547200                  ||                                              54720017
547300                  SUBSTR (CHAR ( DATE (REC_TMST),USA),9,2))       54730017
547400                          = '09/09/99'                            54740017
547500                  THEN 'ENROUTE '                                 54750017
547600                  ELSE                                            54760017
547700                  (SUBSTR (CHAR ( DATE (REC_TMST),USA),1,6)       54770017
547800                  ||                                              54780017
547900                  SUBSTR (CHAR ( DATE (REC_TMST),USA),9,2))       54790017
548000                  END AS USA                                      54800017
548100                                                                  54810017
548200             INTO :PV-ARRIVE-DATE                                 54820017
548300             FROM TRECEIV                                         54830017
548400            WHERE                                                 54840017
548500                  ORD_NBR         = :DK-PO-NBR                    54850017
548600              AND REC_SEQ_NBR     = :DK-REC-SEQ-NBR               54860017
548700     END-EXEC.                                                    54870017
548800                                                                  54880017
548900     EVALUATE TRUE                                                54890017
549000         WHEN SQLCODE = ZERO                                      54900017
549100         WHEN SQLCODE = +100                                      54910017
549200             CONTINUE                                             54920017
549300         WHEN SQLCODE = -904                                      54930017
549400         WHEN SQLCODE = -911                                      54940017
549500         WHEN SQLCODE = -913                                      54950017
549600             PERFORM 9900-SOFT-ABORT                              54960017
549700                                                                  54970017
549800         WHEN SQLWARN0 NOT = SPACE                                54980017
549900         WHEN SQLCODE < ZERO                                      54990017
550000         WHEN SQLCODE > ZERO                                      55000017
550100              MOVE '7220-GET-ARRIVE-TMST  '                       55010017
550200                                   TO DP013-PARAGRAPH             55020017
550300              MOVE 'SELECT STATUS'                                55030017
550400                                   TO DP013-MESSAGE-TEXT (1)      55040017
550500              MOVE SQLCA           TO DP013-SQLCA                 55050017
550600              MOVE 'TRECEIV'       TO DP013-DB2-TABLE-NAME (1)    55060017
550700              SET DP013-DB2-ABEND  TO TRUE                        55070017
550800              PERFORM DP013-0000-PROCESS-ABEND                    55080017
550900     END-EVALUATE.                                                55090017
551000                                                                  55100017
551100/                                                                 55110017
551200 7300-OPEN-WORK-ORDER-CSR.                                        55120017
551300     EXEC SQL                                                     55130017
551400         OPEN WORK-ORDER-CSR                                      55140017
551500     END-EXEC.                                                    55150017
551600                                                                  55160017
551700     EVALUATE TRUE                                                55170017
551800         WHEN SQLCODE = ZERO                                      55180017
551900             CONTINUE                                             55190017
552000         WHEN SQLCODE = -904                                      55200017
552100         WHEN SQLCODE = -911                                      55210017
552200         WHEN SQLCODE = -913                                      55220017
552300             PERFORM 9900-SOFT-ABORT                              55230017
552400                                                                  55240017
552500         WHEN SQLWARN0 NOT = SPACE                                55250017
552600         WHEN SQLCODE < ZERO                                      55260017
552700         WHEN SQLCODE > ZERO                                      55270017
552800              MOVE '7300-OPEN-WORK-ORDER-CSR'                     55280017
552900                                   TO DP013-PARAGRAPH             55290017
553000              MOVE 'SELECT PREPACK ID'                            55300017
553100                                   TO DP013-MESSAGE-TEXT (1)      55310017
553200              MOVE SQLCA           TO DP013-SQLCA                 55320017
553300              MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)    55330017
553400              SET DP013-DB2-ABEND  TO TRUE                        55340017
553500              PERFORM DP013-0000-PROCESS-ABEND                    55350017
553600     END-EVALUATE.                                                55360017
553700                                                                  55370017
553800 7305-FETCH-WORK-ORDER-CSR.                                       55380017
553900                                                                  55390017
554000     EXEC SQL                                                     55400017
554100         FETCH WORK-ORDER-CSR                                     55410017
554200         INTO                                                     55420017
554300             :WKORIN-STRT-TMST                                    55430017
554400         ,   :WKORIN-PRC-FCLTY-AREA-ID                            55440017
554500                                                                  55450017
554600     END-EXEC.                                                    55460017
554700                                                                  55470017
554800     EVALUATE TRUE                                                55480017
554900         WHEN SQLCODE = ZERO                                      55490017
555000             CONTINUE                                             55500017
555100         WHEN SQLCODE = +100                                      55510017
555200             SET PS-EOF-TWKORIN-CSR   TO TRUE                     55520017
555300         WHEN SQLCODE = -904                                      55530017
555400         WHEN SQLCODE = -911                                      55540017
555500         WHEN SQLCODE = -913                                      55550017
555600             PERFORM 9900-SOFT-ABORT                              55560017
555700                                                                  55570017
555800         WHEN SQLWARN0 NOT = SPACE                                55580017
555900         WHEN SQLCODE < ZERO                                      55590017
556000         WHEN SQLCODE > ZERO                                      55600017
556100              MOVE '7305-FETCH-WORK-ORDER-CSR'                    55610017
556200                                   TO DP013-PARAGRAPH             55620017
556300              MOVE 'SELECT PREPACK ID'                            55630017
556400                                   TO DP013-MESSAGE-TEXT (1)      55640017
556500              MOVE SQLCA           TO DP013-SQLCA                 55650017
556600              MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)    55660017
556700              SET DP013-DB2-ABEND  TO TRUE                        55670017
556800              PERFORM DP013-0000-PROCESS-ABEND                    55680017
556900     END-EVALUATE.                                                55690017
557000                                                                  55700017
557100 7310-CLOSE-WORK-ORDER-CSR.                                       55710017
557200                                                                  55720017
557300     EXEC SQL                                                     55730017
557400         CLOSE WORK-ORDER-CSR                                     55740017
557500     END-EXEC.                                                    55750017
557600                                                                  55760017
557700     EVALUATE TRUE                                                55770017
557800         WHEN SQLCODE = ZERO                                      55780017
557900             CONTINUE                                             55790017
558000         WHEN SQLCODE = +100                                      55800017
558100             CONTINUE                                             55810017
558200         WHEN SQLCODE = -904                                      55820017
558300         WHEN SQLCODE = -911                                      55830017
558400         WHEN SQLCODE = -913                                      55840017
558500             PERFORM 9900-SOFT-ABORT                              55850017
558600                                                                  55860017
558700         WHEN SQLWARN0 NOT = SPACE                                55870017
558800         WHEN SQLCODE < ZERO                                      55880017
558900         WHEN SQLCODE > ZERO                                      55890017
559000              MOVE '7310-CLOSE-WORK-ORDER-CSR'                    55900017
559100                                   TO DP013-PARAGRAPH             55910017
559200              MOVE 'SELECT PREPACK ID'                            55920017
559300                                   TO DP013-MESSAGE-TEXT (1)      55930017
559400              MOVE SQLCA           TO DP013-SQLCA                 55940017
559500              MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)    55950017
559600              SET DP013-DB2-ABEND  TO TRUE                        55960017
559700              PERFORM DP013-0000-PROCESS-ABEND                    55970017
559800     END-EVALUATE.                                                55980017
559900/                                                                 55990017
560000 8000-VEM-MODULE.                                                 56000017
560100                                                                  56010017
560200     INITIALIZE RC038-FIELDS.                                     56020017
560300     MOVE DISTHD-ORD-NBR              TO RC038-PO-NBR             56030017
560400     MOVE DISTHD-RCVR-SEQ-NBR         TO RC038-REC-SEQ-NBR        56040017
560500     MOVE DISTHD-ORD-LNE-NBR          TO RC038-PO-LNE-NBR         56050017
560600     MOVE ASC-KEY-OPER-UNT-ID         TO RC038-OPER-UNT-ID        56060017
560700                                         RC038-RCVR-OPER-UNT-ID   56070017
560800     MOVE 1                           TO RC038-FCLTY-ID           56080017
560900                                                                  56090017
561000     PERFORM 7210-GET-PREPK-ID                                    56100017
561100     MOVE RECITM-PREPK-ID             TO RC038-PREPACK-ID         56110017
561200                                                                  56120017
561300*    PACKAGING CODE FROM 7151-GET-PKGNG-CDE                       56130017
561400     MOVE RECEIV-PKGNG-CDE            TO RC038-PKGNG-CDE          56140017
561500                                         PV-SAVE-PKGNG-CDE        56150017
561600                                                                  56160017
561700     MOVE 'N'                         TO RC038-PBS-IND            56170017
561800     MOVE DP020-USERID                TO RC038-USER-ID            56180017
561900     MOVE 'RCKCS299'                  TO RC038-PROGRAM-NAME       56190017
562000     SET RC038-VERIFY                 TO TRUE                     56200017
562100                                                                  56210017
562200     IF PV-SAVE-PACK-BY-ST-IND = 'Y'                              56220017
562300         SET RC038-PBS                TO TRUE                     56230017
562400     END-IF                                                       56240017
562500                                                                  56250017
562600     MOVE ASC-AUTO-VE-SW              TO RC038-AUTOVE-PO-SW       56260017
562700                                                                  56270017
562800     SET RC038-PROCESS-NO-UPDATE      TO TRUE                     56280017
562900                                                                  56290017
563000     MOVE LENGTH OF RC038-FIELDS      TO PV-COMMAREA-LENGTH.      56300017
563100                                                                  56310017
563200     EXEC CICS                                                    56320017
563300         LINK PROGRAM  (PC-RCKUT124)                              56330017
563400              COMMAREA (RC038-FIELDS)                             56340017
563500              LENGTH   (PV-COMMAREA-LENGTH)                       56350017
563600              RESP     (PV-CICS-RESP)                             56360017
563700         END-EXEC.                                                56370017
563800                                                                  56380017
563900*    PERFORM 8001-SHOW-MSG.                                       56390017
564000                                                                  56400017
564100     EVALUATE TRUE                                                56410017
564200         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     56420017
564300             IF  RC038-INVALID-SQL                                56430017
564400                 MOVE RC038-SQLCA     TO SQLCA                    56440017
564500                 MOVE '8000-VEM-MODULE'                           56450017
564600                                      TO DP013-PARAGRAPH          56460017
564700                 STRING ' RCKUT124 - '                            56470017
564800                    '8000-VEM-MODULE  '                           56480017
564900                   ' RETURN MESSAGE - '                           56490017
565000                    RC038-SUCCESS-IND     DELIMITED BY SIZE       56500017
565100                                    INTO DP013-MESSAGE-TEXT (1)   56510017
565200                                                                  56520017
565300                 MOVE SQLCA           TO DP013-SQLCA              56530017
565400                 MOVE 'VARIOUS '      TO DP013-DB2-TABLE-NAME (1) 56540017
565500                 SET DP013-DB2-ABEND                              56550017
565600                     DP013-NO-ROLLBACK                            56560017
565700                                      TO TRUE                     56570017
565800                 PERFORM DP013-0000-PROCESS-ABEND                 56580017
565900             ELSE                                                 56590017
566000                 IF RC038-DATABASE-BUSY                           56600017
566100                     MOVE RC038-SQLCA TO SQLCA                    56610017
566200                     PERFORM 9900-SOFT-ABORT                      56620017
566300                 END-IF                                           56630017
566400             END-IF                                               56640017
566500                                                                  56650017
566600         WHEN OTHER                                               56660017
566700             STRING ' RCKUT124 (OTHER) -'                         56670017
566800                    '8000-VEM-MODULE  '                           56680017
566900                    ' RETURN MESSAGE - '                          56690017
567000                     RC038-SUCCESS-IND     DELIMITED BY SIZE      56700017
567100                                      INTO RC038-CRA-RET-MSG      56710017
567200             PERFORM 9999-WRITE-TO-CSSL                           56720017
567300             SET RC038-NOT-SUCCESSFUL TO TRUE                     56730017
567400                                                                  56740017
567500     END-EVALUATE.                                                56750017
567600                                                                  56760017
567700 8001-SHOW-MSG.                                                   56770017
567800     INITIALIZE PV-CICS-MSG-AREA                                  56780017
567900     MOVE RC038-PO-NBR                TO  PV-VEM-PO               56790017
568000     MOVE RC038-REC-SEQ-NBR           TO  PV-VEM-SEQ              56800017
568100     MOVE RC038-PO-LNE-NBR            TO  PV-VEM-LINE-NBR         56810017
568200     MOVE RC038-PREPACK-ID            TO  PV-VEM-PREPK-ID         56820017
568300     MOVE RC038-OPER-UNT-ID           TO  PV-VEM-OPER             56830017
568400     MOVE RC038-FCLTY-ID              TO  PV-VEM-FCLTY-ID         56840017
568500     MOVE RC038-PKGNG-CDE             TO  PV-VEM-PKG-IND          56850017
568600     MOVE RC038-PBS-IND               TO  PV-VEM-PBS-IND          56860017
568700     MOVE RC038-NO-VERIFY-REASON      TO  PV-VEM-ERROR-CDE        56870017
568800     MOVE PV-VEM-MSG                  TO PV-CICS-MSG-AREA         56880017
568900     PERFORM  9999-WRITE-TO-CSSL.                                 56890017
569000     INITIALIZE PV-CICS-MSG-AREA                                  56900017
569100     MOVE ALL '_'                     TO PV-CICS-MSG-AREA         56910017
569200     PERFORM  9999-WRITE-TO-CSSL.                                 56920017
569300/                                                                 56930017
569400*----------------------------------------------------------------*56940017
569500*    CALL (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)             56950017
569600*    TO SEE IF THIS IS AN AUTOVE PO                               56960017
569700*----------------------------------------------------------------*56970017
569800 8400-CHECK-AUTOVE.                                               56980017
569900                                                                  56990017
570000     INITIALIZE RC040-FIELDS.                                     57000017
570100     MOVE ASC-KEY-OPER-UNT-ID TO RC040-SIGNON-LOCATION.           57010017
570200     MOVE DISTHD-ORD-NBR      TO RC040-PO-NBR.                    57020017
570300     MOVE DISTHD-RCVR-SEQ-NBR TO RC040-PO-RCVR.                   57030017
570400     SET  RC040-RCVR-EXISTS   TO TRUE.                            57040017
570500     MOVE PURCHS-DEPT-NBR     TO RC040-DEPT                       57050017
570600     MOVE DP020-USERID        TO RC040-USER-ID.                   57060017
570700     MOVE 'RCKCS299'          TO RC040-CALLING-PROGRAM.           57070017
570800                                                                  57080017
570900     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  57090017
571000                                        RC040-COMMAREA            57100017
571100                                        RC040-FIELDS.             57110017
571200     EVALUATE TRUE                                                57120017
571300         WHEN RC040-SUCCESSFUL                                    57130017
571400              MOVE RC040-AUTO-VE-SW     TO ASC-AUTO-VE-SW         57140017
571500         WHEN RC040-DATABASE-BUSY OR                              57150017
571600              RC040-INVALID-SQL                                   57160017
571700                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       57170017
571800                  SET DP020-MSG-WARNING TO TRUE                   57180017
571900                  SET DP030-OVERRIDE-GO TO TRUE                   57190017
572000                  SET PS-ERROR          TO TRUE                   57200017
572100             MOVE RC040-CRA-RET-MSG     TO PV-CICS-MSG-AREA       57210017
572200             PERFORM 9999-WRITE-TO-CSSL                           57220017
572300         WHEN RC040-NOT-SUCCESSFUL                                57230017
572400                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       57240017
572500                  SET DP020-MSG-WARNING TO TRUE                   57250017
572600                  SET DP030-OVERRIDE-GO TO TRUE                   57260017
572700                  SET PS-ERROR          TO TRUE                   57270017
572800             MOVE RC040-CRA-RET-MSG     TO PV-CICS-MSG-AREA       57280017
572900             PERFORM 9999-WRITE-TO-CSSL                           57290017
573000         WHEN OTHER                                               57300017
573100             MOVE RC040-CRA-RET-MSG      TO PV-CICS-MSG-AREA      57310017
573200             PERFORM 9999-WRITE-TO-CSSL                           57320017
573300             MOVE '8400-CHECK-AUTOVE ' TO DP013-PARAGRAPH         57330017
573400             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              57340017
573500                                         TO DP013-MESSAGE-TEXT (1)57350017
573600             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)57360017
573700             MOVE RC040-SQLCA            TO DP013-SQLCA           57370017
573800             SET DP013-DB2-ABEND                                  57380017
573900                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              57390017
574000             SET PS-ERROR                    TO TRUE              57400017
574100             PERFORM DP013-0000-PROCESS-ABEND                     57410017
574200     END-EVALUATE.                                                57420017
574300                                                                  57430017
574400/                                                                 57440017
574500 9100-READ-SEL-QUEUE.                                             57450017
574600     EXEC CICS                                                    57460017
574700         READQ TS                                                 57470017
574800             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        57480017
574900             INTO  (RC013-DC-SELECT-RECORD)                       57490017
575000             ITEM  (ASC-SEL-ITEM)                                 57500017
575100             RESP  (PV-CICS-RESP)                                 57510017
575200     END-EXEC.                                                    57520017
575300                                                                  57530017
575400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       57540017
575500         CONTINUE                                                 57550017
575600     ELSE                                                         57560017
575700         SET DP013-LOGIC-ABEND                                    57570017
575800             DP013-NO-ROLLBACK     TO TRUE                        57580017
575900         MOVE '9100-READ-SEL-QUEUE'                               57590017
576000                                   TO DP013-PARAGRAPH             57600017
576100         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   57610017
576200                                   TO DP013-MESSAGE-TEXT (1)      57620017
576300         PERFORM DP013-0000-PROCESS-ABEND                         57630017
576400     END-IF.                                                      57640017
576500                                                                  57650017
576600 9200-REWRITE-LIST-QUEUE.                                         57660017
576700     EXEC CICS                                                    57670017
576800          WRITEQ TS                                               57680017
576900              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      57690017
577000              FROM   (RC013-DC-SELECT-RECORD)                     57700017
577100              ITEM   (ASC-SEL-ITEM)                               57710017
577200              RESP   (PV-CICS-RESP)                               57720017
577300              REWRITE                                             57730017
577400     END-EXEC.                                                    57740017
577500                                                                  57750017
577600     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   57760017
577700         SET DP013-CICS-ABEND                                     57770017
577800             DP013-NO-ROLLBACK     TO TRUE                        57780017
577900         MOVE '9200-REWRITE-LIST-QUEUE'                           57790017
578000                                   TO DP013-PARAGRAPH             57800017
578100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   57810017
578200                                   TO DP013-MESSAGE-TEXT (1)      57820017
578300         PERFORM DP013-0000-PROCESS-ABEND                         57830017
578400     END-IF.                                                      57840017
578500                                                                  57850017
578600/                                                                 57860017
578700 9900-SOFT-ABORT.                                                 57870017
578800     SET PS-ERROR         TO TRUE.                                57880017
578900     SET DP020-MSG-FATAL  TO TRUE.                                57890017
579000     MOVE 'THROUGH SOFT-ABORT PARA'                               57900017
579100                      TO DP013-MESSAGE-TEXT (1)                   57910017
579200     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    57920017
579300     IF PS-NO-NEXT-SCREEN                                         57930017
579400        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     57940017
579500     END-IF.                                                      57950017
579600     PERFORM 9901-BACKUP.                                         57960017
579700     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          57970017
579800     PERFORM 0001-CALL-CICS-ARCH-API.                             57980017
579900                                                                  57990017
580000 9901-BACKUP.                                                     58000017
580100     EXEC CICS SYNCPOINT                                          58010017
580200          ROLLBACK                                                58020017
580300     END-EXEC.                                                    58030017
580400                                                                  58040017
580500 9999-WRITE-TO-CSSL.                                              58050017
580600                                                                  58060017
580700     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      58070017
580800                                                                  58080017
580900     EXEC CICS                                                    58090017
581000          WRITEQ TD                                               58100017
581100           QUEUE   ('CSSL')                                       58110017
581200            FROM   (PV-CICS-MSG-AREA)                             58120017
581300          LENGTH   (PV-COMMAREA-LENGTH)                           58130017
581400            RESP   (PV-CICS-RESP)                                 58140017
581500     END-EXEC.                                                    58150017
581600                                                                  58160017
581700/                                                                 58170017
581800*----------------------------------------------------------------*58180017
581900*    ABEND PROCESSOR MODULE                                      *58190017
582000*----------------------------------------------------------------*58200017
582100                                                                  58210017
582200     COPY DPPD013.                                                58220017
