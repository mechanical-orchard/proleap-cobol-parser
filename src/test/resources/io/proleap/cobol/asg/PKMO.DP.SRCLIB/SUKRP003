000100***************************************************************** 00010038
000200 IDENTIFICATION DIVISION.                                         00020038
000300***************************************************************** 00030038
000400                                                                  00040038
000500 PROGRAM-ID.             SUKRP003.                                00050038
000600 AUTHOR.                 LARRY SCHLEICHER - STRATAGEM.            00060038
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070038
000800 DATE-WRITTEN            JUNE, 1996.                              00080038
000900 DATE-COMPILED.                                                   00090038
001000***************************************************************** 00100038
001100***************************************************************** 00110038
001200*                                                               * 00120038
001300*  THIS PROGRAM WILL PRINT THE CARTONS NOT RECEIVED REPORT.     * 00130038
001400*  THIS IS PRODUCED FOLLOWING THE CHECK-IN OF A TRAILER         * 00140038
001500*  WHICH HAS HAD THE CARTONS SCANNED USING THE LRT TERMINAL.    * 00150038
001600*                                                               * 00160038
001700*  THE TOTAL CARTONS NOT RECEIVED WILL PRINT AND A PAGE BREAK   * 00170038
001800*  WILL OCCUR WHENEVER THERE IS A CHANGE IN THE PO/RECEIVER.    * 00180038
001900***************************************************************** 00190038
002000*  CHANGED 10/25/02 BY ALBERT A VINOD                           * 00200038
002100*   WR# 21361 THE REFERENCES TO TSK TABLE IS REMOVED AND DEPT,  * 00210038
002200*             CLASS AND 8 DIGIT SKU NUMBER IS RETRIVED BY       * 00220038
002300*             CALLING XLKUT001. REPORT LAYOUT WAS MODIFIED TO   * 00230038
002400*             ACCOMODATE 8 DIGIT SKU NUMBER.                    * 00240038
001900***************************************************************** 00251045
002000*  CHANGED 09/30/14 BY CHERI PARMLEY                            * 00252045
002100*   CHG#0094517  EXPANDED PO FROM 7 TO 8 DIGITS                 * 00253046
002500***************************************************************** 00255045
002600*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00260038
002700*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00270038
002800*                                                               * 00280038
002900***************************************************************** 00290038
003000***************************************************************** 00300038
003100 ENVIRONMENT DIVISION.                                            00310038
003200***************************************************************** 00320038
003300                                                                  00330038
003400 CONFIGURATION SECTION.                                           00340038
003500                                                                  00350038
003600 SOURCE-COMPUTER.        IBM-3090.                                00360038
003700 OBJECT-COMPUTER.        IBM-3090.                                00370038
003800                                                                  00380038
003900 INPUT-OUTPUT SECTION.                                            00390038
004000                                                                  00400038
004100 FILE-CONTROL.                                                    00410038
004200*                                                                 00420038
004300     SELECT EXTRACT-FILE                                          00430038
004400         ASSIGN TO INP01.                                         00440038
004500                                                                  00450038
004600     SELECT SU-CARTON-NOT-RCVD-FILE                               00460038
004700         ASSIGN TO RPT01.                                         00470038
004800*                                                                 00480038
004900***************************************************************** 00490038
005000 DATA DIVISION.                                                   00500038
005100***************************************************************** 00510038
005200*                                                                 00520038
005300 FILE SECTION.                                                    00530038
005400*                                                                 00540038
005500 FD  EXTRACT-FILE                                                 00550038
005600     LABEL RECORDS ARE STANDARD                                   00560038
005700     RECORDING MODE IS F                                          00570038
005800     BLOCK CONTAINS 0 RECORDS                                     00580038
005900     RECORD CONTAINS 200 CHARACTERS.                              00590038
006000 01  EXTRACT-RECORD                  PIC X(200).                  00600038
006100                                                                  00610038
006200 FD  SU-CARTON-NOT-RCVD-FILE                                      00620038
006300     RECORDING MODE IS F                                          00630038
006400     BLOCK CONTAINS 0  RECORDS.                                   00640038
006500 01  SU-CARTON-NOT-RCVD-RECORD       PIC  X(132).                 00650038
006600*                                                                 00660038
006700                                                                  00670038
006800 WORKING-STORAGE SECTION.                                         00680038
006900**************************************************************    00690038
007000* FORMAT OF THE CONTROL CARD INFORMATION PASSED INTO THE PGM *    00700038
007100**************************************************************    00710038
007200 01  CC-CONTROL-CARD.                                             00720038
007300     05  CC-PRINTER-ID                PIC  X(08).                 00730038
007400     05  CC-PRTR-CNTL-IND             PIC  X(01).                 00740038
007500     05  CC-TRACK-NBR                 PIC  9(01).                 00750038
007600     05  FILLER                       PIC  X(01).                 00760038
007700     05  CC-CUT-REPORT                PIC  X(01).                 00770038
007800         88 CC-CUT-REPORT-AT-END                   VALUE 'C'.     00780038
007900     05  CC-REQUESTOR-ID              PIC  X(08).                 00790038
008000     05  CC-PRINT-SUKRP002-IND        PIC  X(01).                 00800038
008100         88 CC-PRINT-SUKRP002                      VALUE 'Y'.     00810038
008200     05  CC-PRINT-SUKRP003-IND        PIC  X(01).                 00820038
008300         88 CC-PRINT-SUKRP003                      VALUE 'Y'.     00830038
008400     05  CC-PRINT-SUKRP004-IND        PIC  X(01).                 00840038
008500         88 CC-PRINT-SUKRP004                      VALUE 'Y'.     00850038
008600     05  CC-PRINT-SUKRP005-IND        PIC  X(01).                 00860038
008700         88 CC-PRINT-SUKRP005                      VALUE 'Y'.     00870038
008800     05  CC-PRINT-SUKRP006-IND        PIC  X(01).                 00880038
008900         88 CC-PRINT-SUKRP006                      VALUE 'Y'.     00890038
009000     05  CC-PRINT-SUKRP007-IND        PIC  X(01).                 00900038
009100         88 CC-PRINT-SUKRP007                      VALUE 'Y'.     00910038
009200     05  CC-PRINT-SUKRP008-IND        PIC  X(01).                 00920038
009300         88 CC-PRINT-SUKRP008                      VALUE 'Y'.     00930038
009400*JPL                                                              00940038
009500     05  CC-PRINT-SUKRP023-IND        PIC  X(01).                 00950038
009600         88 CC-PRINT-SUKRP023                      VALUE 'Y'.     00960038
009700     05  FILLER                       PIC  X(01).                 00970038
009800     05  CC-PRINT-ALL-PO-IND          PIC  X(01).                 00980038
009900         88 CC-PRINT-ENTIRE-TRIP                   VALUE 'Y'.     00990038
010000         88 CC-PRINT-SELECTED-PO                   VALUE 'N'.     01000038
010100*                                                                 01010038
010200 01  PROGRAM-SWITCHES.                                            01020038
010300     05  PS-EOF-INPUT-SW             PIC  X(03)    VALUE 'BOF'.   01030038
010400         88  PS-EOF-INPUT                          VALUE 'EOF'.   01040038
010500     05  PS-END-OF-CURSOR-SW         PIC  X(01)    VALUE 'N'.     01050038
010600         88  PS-END-OF-CURSOR                      VALUE 'Y'.     01060038
010700         88  PS-NOT-END-OF-CURSOR                  VALUE 'N'.     01070038
010800     05  PS-HDR-PROCESSED-SW         PIC  X(01)    VALUE 'N'.     01080038
010900         88  PS-HDR-PROCESSED                      VALUE 'Y'.     01090038
011000     05  PS-INPUT-STATUS-SW          PIC  X(01)    VALUE 'N'.     01100038
011100         88  PS-INPUT-STATUS-NO-ASN-INPUT          VALUE 'Y'.     01110038
011200         88  PS-INPUT-STATUS-NO-ASN-ERRORS         VALUE 'N'.     01120038
011300         88  PS-INPUT-STATUS-ASN-WRITTEN           VALUE 'X'.     01130038
011400     05  PS-END-OF-EXTRACT-SW        PIC  X(01)    VALUE 'N'.     01140038
011500         88  PS-END-OF-EXTRACT                     VALUE 'Y'.     01150038
011600     05  PS-STATUS-FOUND-SW          PIC  X(01)    VALUE 'N'.     01160038
011700         88  PS-STATUS-FOUND                       VALUE 'Y'.     01170038
011800         88  PS-STATUS-NOT-FOUND                   VALUE 'N'.     01180038
011900     05  PS-FIRST-LINE-SW            PIC  X(01)    VALUE 'Y'.     01190038
012000         88  PS-FIRST-LINE                         VALUE 'Y'.     01200038
012100         88  PS-NOT-FIRST-LINE                     VALUE 'N'.     01210038
012200     05  PS-PRT-HEADING-SW           PIC  X(01)    VALUE 'Y'.     01220038
012300         88  PS-PRT-HEADING                        VALUE 'Y'.     01230038
012400         88  PS-NOT-PRT-HEADING                    VALUE 'N'.     01240038
012500     05  PS-SCANNED-IND              PIC  X(01)    VALUE 'N'.     01250038
012600         88  PS-SCANNED                            VALUE 'Y'.     01260038
012700         88  PS-NOT-SCANNED                        VALUE 'N'.     01270038
012800     05  PS-RECORD-TYPE-SW           PIC  X(01)    VALUE 'B'.     01280038
012900         88  PS-ERROR-RECORD                       VALUE 'A'.     01290038
013000         88  PS-DETAIL-RECORD                      VALUE 'B'.     01300038
013100*                                                                 01310038
013200 01  PC-CONSTANTS.                                                01320038
013300     05  PC-1                        PIC S9(03)    VALUE +1       01330038
013400                                                   COMP-3.        01340038
013500     05  PC-2                        PIC S9(03)    VALUE +2       01350038
013600                                                   COMP-3.        01360038
013700     05  PC-3                        PIC S9(03)    VALUE +3       01370038
013800                                                   COMP-3.        01380038
013900     05  PC-7                        PIC S9(01)    VALUE +7.      01390038
014000     05  PC-11                       PIC S9(03)    VALUE +11      01400038
014100                                                   COMP-3.        01410038
014200     05  PC-60                       PIC S9(03)    VALUE +60      01420038
014300                                                   COMP-3.        01430038
014400     05  PC-DASH                     PIC  X(01)    VALUE '-'.     01440038
014500     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01450038
014600     05  PC-00                       PIC  X(02)    VALUE '00'.    01460038
014700     05  PC-UG                       PIC  X(02)    VALUE 'UG'.    01470038
014800     05  PC-UN                       PIC  X(02)    VALUE 'UN'.    01480038
014900     05  PC-AR                       PIC  X(02)    VALUE 'AR'.    01490038
015000     05  PC-A                        PIC  X(01)    VALUE 'A'.     01500038
015100     05  PC-SUKRP003                 PIC  X(08)    VALUE          01510038
015200         'SUKRP003'.                                              01520038
015300     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01530038
015400     05  PC-NO-SKU                   PIC  X(11)    VALUE          01540038
015500         '  NO SKU'.                                              01550038
015600                                                                  01560038
015700 01  DN-DB2-NULL-INDICATORS.                                      01570038
015800     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   01580038
015900*                                                                 01590038
016000 01  PV-MISC-FIELDS.                                              01600038
016100     05  PV-LINE-SUB                 PIC S9(03)    VALUE +0       01610038
016200                                                   COMP-3.        01620038
016300     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01630038
016400                                                   COMP-3.        01640038
016500     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01650038
016600                                                   COMP-3.        01660038
016700     05  PV-CART-MISSING             PIC S9(04)    VALUE ZERO     01670038
016800                                                   COMP-3.        01680038
016900     05  PV-EXPTED-QTY               PIC S9(05)    VALUE ZERO     01690038
017000                                                   COMP-3.        01700038
017100     05  PV-LINE-TOT-QTY             PIC S9(05)    VALUE ZERO     01710038
017200                                                   COMP-3.        01720038
017300     05  PV-STATUS                   PIC  X(02).                  01730038
017400     05  PV-STR-NBR-NUMERIC          PIC  9(4).                   01740038
017500     05  PV-STR-NBR REDEFINES PV-STR-NBR-NUMERIC.                 01750038
017600         10  PV-STR-NBR-1            PIC  X(01).                  01760038
017700         10  PV-STR-NBR-2-4          PIC  X(03).                  01770038
      *CLP 09/30/14                                                     01771045
017800     05  PV-SAVE-PO-RECEIVER         PIC  X(12).                  01780045
017900     05  PV-SAVE-SCANNED-IND         PIC  X(01).                  01790038
018000     05  PV-SAVE-SHIP-CODE           PIC  9(18).                  01800038
018100     05  PV-SAVE-LINE-NBR            PIC  X(04).                  01810038
018200     05  PV-TRIP-ID                  PIC  9(09).                  01820038
018300     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01830038
018400                                                   COMP SYNC.     01840038
018500     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01850038
018600     05  PV-UPC-NBR                  PIC  9(15)    VALUE ZERO.    01860038
018700******************************************************************01870038
018800*  REMOVED VARIABLE PV-SKU-SEQ AND ADDED NEW           WR# 21361 *01880038
018900*  VARIABLE PV-SKU-NBR 9(8). CHANGED THE VALUES OF FILLERS TO    *01890039
019000*  SPACES.*                                                       01900039
019100******************************************************************01910038
019200     05  PV-SKU.                                                  01920038
019300         10  PV-SKU-DEPT             PIC  X(03)    VALUE SPACES.  01930038
019400         10  FILLER                  PIC  X(01)    VALUE SPACES.  01940038
019500         10  PV-SKU-CLASS            PIC  X(02)    VALUE SPACES.  01950038
019600         10  FILLER                  PIC  X(01)    VALUE SPACES.  01960038
019800         10  PV-SKU-NBR              PIC  9(08)    VALUE ZEROS.   01980038
019900******************************************************************01990038
020000*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *02000041
020100******************************************************************02010038
020200     05  PV-PO-RECEIVER.                                          02020038
      *CLP 09/30/14                                                     02021045
020300         10  PV-PO                   PIC  9(08)    VALUE ZERO.    02030045
020400         10  FILLER                  PIC  X(01)    VALUE '-'.     02040038
020500         10  PV-RECEIVER             PIC  9(03)    VALUE ZERO.    02050038
020600     05  PV-STORE-NBR-CHAR           PIC  X(03)    VALUE SPACES.  02060038
020700     05  PV-TODAYS-DATE.                                          02070038
020800         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    02080038
020900         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    02090038
021000         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    02100038
021100     05  PV-TODAYS-TIME.                                          02110038
021200         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    02120038
021300         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    02130038
021400         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    02140038
021500         10  FILLER                  PIC  9(02)    VALUE ZERO.    02150038
021600     05  PV-DB2-DATE.                                             02160038
021700         10  PV-DB2-DATE-CC          PIC  X(02)    VALUE ZERO.    02170038
021800         10  PV-DB2-DATE-YY          PIC  X(02)    VALUE ZERO.    02180038
021900         10  FILLER                  PIC  X(01)    VALUE ZERO.    02190038
022000         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE ZERO.    02200038
022100         10  FILLER                  PIC  X(01)    VALUE ZERO.    02210038
022200         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE ZERO.    02220038
022300     05  PV-SERIAL-SHIP-CODE          PIC  9(18).                 02230038
022400     05  FILLER REDEFINES PV-SERIAL-SHIP-CODE.                    02240038
022500         10  PV-SERIAL-SHIP-CODE-1    PIC  X(01).                 02250038
022600         10  PV-SERIAL-SHIP-CODE-2-8  PIC  X(07).                 02260038
022700         10  PV-SERIAL-SHIP-CODE-9-17 PIC  X(09).                 02270038
022800         10  PV-SERIAL-SHIP-CODE-18   PIC  X(01).                 02280038
022900     05  PV-OUT-SERIAL-SHIP-CODE.                                 02290038
023000         10  FILLER                   PIC  X(05)    VALUE '(00) '.02300038
023100         10  PV-OUT-S-S-C-1           PIC  X(01).                 02310038
023200         10  FILLER                   PIC  X(01) VALUE SPACES.    02320038
023300         10  PV-OUT-S-S-C-2-8         PIC  X(07).                 02330038
023400         10  FILLER                   PIC  X(01) VALUE SPACES.    02340038
023500         10  PV-OUT-S-S-C-9-17        PIC  X(09).                 02350038
023600         10  FILLER                   PIC  X(01) VALUE SPACES.    02360038
023700         10  PV-OUT-S-S-C-18          PIC  X(01).                 02370038
023800     05  PV-SAVE-TRN-LNE-NBR          PIC S9(09) COMP.            02380038
023900     05  PV-SAVE-MERCH-DEPT-NMBR      PIC  X(03).                 02390038
024000     05  PV-SAVE-MERCH-CLASS-NMBR     PIC  X(02).                 02400038
024100******************************************************************02410038
024200*  REMOVED VARIABLE PV-SAVE-SEQ-NMBR AND ADDED NEW     WR# 21361 *02420038
024300*  VARIABLE PV-SAVE-SKU-NBR S9(8) COMP-3.                        *02430041
024400******************************************************************02440038
024600     05  PV-SAVE-SKU-NBR              PIC  S9(08) COMP-3.         02460038
024700******************************************************************02470038
024800*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *02480041
024900******************************************************************02490038
025000*                                                                 02500038
025100     COPY DPWS024.                                                02510045
025200*                                                                 02520038
025300     COPY SURD001.                                                02530045
025400 EJECT                                                            02540038
025500*                                                                 02550038
025600******************************************************************02560038
025700*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02570038
025800******************************************************************02580038
025900     COPY DPWS132O.                                               02590045
026000*                                                                 02600038
026100*                                                                 02610038
026200 01  HEADING-LINES.                                               02620038
026300     05  HEADING-LINE-0.                                          02630038
026400         10  FILLER                  PIC  X(50)    VALUE SPACES.  02640038
026500         10  FILLER                  PIC  X(32)    VALUE          02650038
026600             'CHECK-IN COMPLETION - EXCEPTIONS'.                  02660038
026700         10  FILLER                  PIC  X(50)    VALUE SPACES.  02670038
026800*                                                                 02680038
026900     05  HEADING-LINE-1.                                          02690038
027000         10  FILLER                  PIC  X(05)    VALUE SPACES.  02700038
027100         10  FILLER                  PIC  X(40)    VALUE          02710038
027200             '****************************************'.          02720038
027300         10  FILLER                  PIC  X(11)    VALUE SPACES.  02730038
027400         10  FILLER                  PIC  X(20)    VALUE          02740038
027500             'CARTONS NOT RECEIVED'.                              02750038
027600         10  FILLER                  PIC  X(56)    VALUE SPACES.  02760038
027700*                                                                 02770038
027800     05  HEADING-LINE-1A.                                         02780038
027900         10  FILLER                  PIC  X(05)    VALUE SPACES.  02790038
028000         10  FILLER                  PIC  X(03)    VALUE '*  '.   02800038
028100         10  HL1A-CC-IND-DESC        PIC  X(36)    VALUE SPACES.  02810038
028200         10  FILLER                  PIC  X(01)    VALUE '*'.     02820038
028300         10  FILLER                  PIC  X(87)    VALUE SPACES.  02830038
028400*                                                                 02840038
028500     05  HEADING-LINE-1B.                                         02850038
028600         10  FILLER                  PIC  X(05)    VALUE SPACES.  02860038
028700         10  FILLER                  PIC  X(40)    VALUE          02870038
028800             '****************************************'.          02880038
028900         10  FILLER                  PIC  X(87)    VALUE SPACES.  02890038
029000*                                                                 02900038
029100     05  HEADING-LINE-2.                                          02910038
029200         10  FILLER                  PIC  X(03)    VALUE SPACE.   02920038
029300         10  FILLER                  PIC  X(09)    VALUE          02930038
029400             'CARRIER: '.                                         02940038
029500         10  HL2-SCAC                PIC  X(04)    VALUE SPACES.  02950038
029600         10  FILLER                  PIC  X(03)    VALUE SPACE.   02960038
029700         10  FILLER                  PIC  X(09)    VALUE          02970038
029800             'TRAILER: '.                                         02980038
029900         10  HL2-TRAILER             PIC  X(10)    VALUE SPACES.  02990038
030000         10  FILLER                  PIC  X(04)    VALUE SPACE.   03000038
030100         10  FILLER                  PIC  X(09)    VALUE          03010038
030200             'TRIP ID: '.                                         03020038
030300         10  HL2-TRIP-ID             PIC  X(11)    VALUE SPACES.  03030038
030400         10  FILLER                  PIC  X(14)    VALUE SPACE.   03040038
030500         10  FILLER                  PIC  X(16)    VALUE          03050038
030600             'TRAILER STATUS: '.                                  03060038
030700         10  HL2-TRAILER-STAT        PIC  X(02)    VALUE SPACES.  03070038
030800         10  FILLER                  PIC  X(38)    VALUE SPACES.  03080038
030900*                                                                 03090038
031000     05  HEADING-LINE-3.                                          03100038
031100         10  FILLER                  PIC  X(03)    VALUE SPACES.  03110038
031200         10  FILLER                  PIC  X(16)    VALUE          03120038
031300             'ARRIVAL DATE:   '.                                  03130038
031400         10  HL3-ARRIVAL-DATE.                                    03140038
031500             15  HL3-ARRIVAL-DATE-MM                              03150038
031600                                     PIC  X(02)    VALUE SPACES.  03160038
031700             15  FILLER              PIC  X(01)    VALUE '/'.     03170038
031800             15  HL3-ARRIVAL-DATE-DD                              03180038
031900                                     PIC  X(02)    VALUE SPACES.  03190038
032000             15  FILLER              PIC  X(01)    VALUE '/'.     03200038
032100             15  HL3-ARRIVAL-DATE-CC                              03210038
032200                                     PIC  X(02)    VALUE SPACES.  03220038
032300             15  HL3-ARRIVAL-DATE-YY                              03230038
032400                                     PIC  X(02)    VALUE SPACES.  03240038
032500         10  FILLER                  PIC  X(11)    VALUE SPACES.  03250038
032600         10  FILLER                  PIC  X(23)    VALUE          03260038
032700             'BEGIN UNLOADING DATE:  '.                           03270038
032800         10  HL3-BEG-UNLOAD-DATE.                                 03280038
032900             15  HL3-BEG-UNLOAD-DATE-MM                           03290038
033000                                     PIC  X(02)    VALUE SPACES.  03300038
033100             15  FILLER              PIC  X(01)    VALUE '/'.     03310038
033200             15  HL3-BEG-UNLOAD-DATE-DD                           03320038
033300                                     PIC  X(02)    VALUE SPACES.  03330038
033400             15  FILLER              PIC  X(01)    VALUE '/'.     03340038
033500             15  HL3-BEG-UNLOAD-DATE-CC                           03350038
033600                                     PIC  X(02)    VALUE SPACES.  03360038
033700             15  HL3-BEG-UNLOAD-DATE-YY                           03370038
033800                                     PIC  X(02)    VALUE SPACES.  03380038
033900         10  FILLER                  PIC  X(03)    VALUE SPACES.  03390038
034000         10  FILLER                  PIC  X(15)    VALUE          03400038
034100             'UNLOADED DATE: '.                                   03410038
034200         10  HL3-UNLOADED-DATE.                                   03420038
034300             15  HL3-UNLOADED-DATE-MM                             03430038
034400                                     PIC  X(02)    VALUE SPACES.  03440038
034500             15  FILLER              PIC  X(01)    VALUE '/'.     03450038
034600             15  HL3-UNLOADED-DATE-DD                             03460038
034700                                     PIC  X(02)    VALUE SPACES.  03470038
034800             15  FILLER              PIC  X(01)    VALUE '/'.     03480038
034900             15  HL3-UNLOADED-DATE-CC                             03490038
035000                                     PIC  X(02)    VALUE SPACES.  03500038
035100             15  HL3-UNLOADED-DATE-YY                             03510038
035200                                     PIC  X(02)    VALUE SPACES.  03520038
035300         10  FILLER                  PIC  X(31)    VALUE SPACES.  03530038
035400*                                                                 03540038
035500******************************************************************03550038
035600*  INCREASED THE SIZE OF FILLER X(18) TO X(22) AND     WR# 21361 *03560038
035700*  REDUCED THE SIZE OF LAST FILLER TO 4.                         *03570038
035800******************************************************************03580038
035900     05  HEADING-LINE-4.                                          03590038
036000         10  FILLER                  PIC  X(47)    VALUE SPACES.  03600038
036100         10  FILLER                  PIC  X(09)    VALUE          03610038
036200             'STR   LNE'.                                         03620038
036400         10  FILLER                  PIC  X(22)    VALUE SPACES.  03640038
036500         10  FILLER                  PIC  X(05)    VALUE          03650038
036600             'EXPTD'.                                             03660038
036700         10  FILLER                  PIC  X(06)    VALUE SPACES.  03670038
036800         10  FILLER                  PIC  X(04)    VALUE          03680038
036900             'LINE'.                                              03690038
037000         10  FILLER                  PIC  X(05)    VALUE SPACES.  03700038
037100         10  FILLER                  PIC  X(30)    VALUE          03710038
037200             '** FREE ASTRAY RECEIPT INFO **'.                    03720038
037400         10  FILLER                  PIC  X(04)    VALUE SPACES.  03740038
037500*                                                                 03750038
037600******************************************************************03760038
037700*  REDUCED THE SIZE OF FILLER AFTER FILLER VALUE       WR# 21361 *03770038
037800*  'NBR NBR' TO 5 AND ADDED NEW FILLER VALUE 'DPT CL', FILLER    *03780038
037900*  X(2) AND REDUCED THE SIZE OF LAST FILLER TO 3.                *03790040
038000******************************************************************03800038
038100     05  HEADING-LINE-5.                                          03810038
038200         10  FILLER                  PIC  X(03)    VALUE SPACES.  03820038
038300         10  FILLER                  PIC  X(11)    VALUE          03830038
038400             'PO/RECEIVER'.                                       03840038
038500         10  FILLER                  PIC  X(08)    VALUE SPACES.  03850038
038600         10  FILLER                  PIC  X(16)    VALUE          03860038
038700             'SERIAL SHIP CODE'.                                  03870038
038800         10  FILLER                  PIC  X(09)    VALUE SPACES.  03880038
038900         10  FILLER                  PIC  X(09)    VALUE          03890038
039000             'NBR   NBR'.                                         03900038
039200         10  FILLER                  PIC  X(05)    VALUE SPACES.  03920038
039300         10  FILLER                  PIC  X(06)    VALUE          03930038
039400             'DPT CL'.                                            03940038
039500         10  FILLER                  PIC  X(02)    VALUE SPACES.  03950038
039600         10  FILLER                  PIC  X(03)    VALUE          03960038
039700             'SKU'.                                               03970038
039800         10  FILLER                  PIC  X(07)    VALUE SPACES.  03980038
039900         10  FILLER                  PIC  X(03)    VALUE          03990038
040000             'QTY'.                                               04000038
040100         10  FILLER                  PIC  X(05)    VALUE SPACES.  04010038
040200         10  FILLER                  PIC  X(07)    VALUE          04020038
040300             'TOT QTY'.                                           04030038
040400         10  FILLER                  PIC  X(04)    VALUE SPACES.  04040038
040500         10  FILLER                  PIC  X(30)    VALUE          04050038
040600             'TRAILER      SCAC    SCAN DATE'.                    04060038
040800         10  FILLER                  PIC  X(03)    VALUE SPACES.  04080038
040900******************************************************************04090038
041000*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *04100041
041100******************************************************************04110038
041200*                                                                 04120038
041300     05  RECEIVER-TOT-LNE.                                        04130038
041400         10  FILLER                  PIC  X(01)    VALUE SPACES.  04140038
041500         10  FILLER                  PIC  X(28)    VALUE          04150038
041600             'TOTAL CARTONS NOT RECEIVED '.                       04160038
041700         10  FILLER                  PIC  X(08)    VALUE SPACES.  04170038
041800         10  TOT-CART-MISSING        PIC  ZZZZZ9   VALUE ZEROES.  04180038
041900*                                                                 04190038
042000     05  BLANK-LNE.                                               04200038
042100         10  FILLER                  PIC  X(130)   VALUE SPACES.  04210038
042200*                                                                 04220038
042300*                                                                 04230038
042400 01  MISCELLANEOUS-LINES.                                         04240038
042500     05  END-OF-REPORT-LINE.                                      04250038
042600         10  FILLER                  PIC  X(44)    VALUE SPACES.  04260038
042700         10  FILLER                  PIC  X(45)    VALUE          04270038
042800             '*******   E N D   O F   R E P O R T   *******'.     04280038
042900         10  FILLER                  PIC  X(43)    VALUE SPACES.  04290038
043000*                                                                 04300038
043100******************************************************************04310038
043200*  INCREASED THE SIZE OF DL1-SKU TO 15. REDUCED THE    WR# 21361 *04320038
043300*  SIZE OF LAST FILLER TO 4.                                     *04330038
043400******************************************************************04340038
043500 01  DETAIL-LINES.                                                04350038
043600     05  DETAIL-LINE1.                                            04360038
043700         10  FILLER                  PIC  X(03)    VALUE SPACES.  04370038
      *CLP 09/30/14                                                     04371045
043800         10  DL1-PO-RECEIVER         PIC  X(12)    VALUE SPACES.  04380045
043900         10  FILLER                  PIC  X(02)    VALUE SPACES.  04390045
044000         10  DL1-SERIAL-SHIP-CODE    PIC  X(26)    VALUE SPACES.  04400038
044100         10  FILLER                  PIC  X(03)    VALUE SPACES.  04410038
044200         10  DL1-STORE-NBR           PIC  X(04)    VALUE SPACES.  04420038
044300         10  FILLER                  PIC  X(03)    VALUE SPACES.  04430038
044400         10  DL1-LINE-NBR            PIC  ZZZ9.                   04440038
044500         10  DL1-LINE-NBR-RDF REDEFINES DL1-LINE-NBR              04450038
044600                                     PIC  X(04).                  04460038
044700         10  FILLER                  PIC  X(04)    VALUE SPACES.  04470038
044900         10  DL1-SKU                 PIC  X(15)    VALUE SPACES.  04490038
045000         10  FILLER                  PIC  X(02)    VALUE SPACES.  04500038
045100         10  DL1-EXPTED-QTY          PIC  ZZZZ9    VALUE ZERO.    04510038
045200         10  FILLER                  PIC  X(05)    VALUE SPACES.  04520038
045300         10  DL1-LINE-TOT-QTY        PIC  ZZZZZ    VALUE ZERO.    04530038
045400         10  FILLER                  PIC  X(06)    VALUE SPACES.  04540038
045500         10  DL1-TRAILER             PIC  X(10)    VALUE SPACES.  04550038
045600         10  FILLER                  PIC  X(02)    VALUE SPACES.  04560038
045700         10  DL1-SCAC                PIC  X(04)    VALUE SPACES.  04570038
045800         10  FILLER                  PIC  X(03)    VALUE SPACES.  04580038
045900         10  DL1-SCAN-DATE           PIC  X(10)    VALUE SPACES.  04590038
046100         10  FILLER                  PIC  X(04)    VALUE SPACES.  04610038
046200******************************************************************04620038
046300*  CHANGES MADE FOR WR# 21361 ENDS HERE                          *04630041
046400******************************************************************04640038
046500                                                                  04650038
046600 01  EL1-ERROR-LINE-1F.                                           04660038
046700     05  FILLER                      PIC  X(02)     VALUE SPACES. 04670038
046800     05  FILLER                      PIC  X(48)     VALUE         04680038
046900         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      04690038
047000     05  FILLER                      PIC  X(49)     VALUE         04700038
047100         'CREATING YOUR REPORTS.  YOUR REQUEST COULD NOT BE'.     04710038
047200     05  FILLER                      PIC  X(33)     VALUE         04720038
047300         ' COMPLETED.                      '.                     04730038
047400                                                                  04740038
047500 01  EL1-ERROR-LINE-1P.                                           04750038
047600     05  FILLER                      PIC  X(02)     VALUE SPACES. 04760038
047700     05  FILLER                      PIC  X(48)     VALUE         04770038
047800         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      04780038
047900     05  FILLER                      PIC  X(49)     VALUE         04790038
048000         'CREATING YOUR REPORTS.  THIS REPORT COULD NOT BE '.     04800038
048100     05  FILLER                      PIC  X(33)     VALUE         04810038
048200         'COMPLETED.                       '.                     04820038
048300                                                                  04830038
048400 01  EL2-ERROR-LINE-2F.                                           04840038
048500     05  FILLER                      PIC  X(02)     VALUE SPACES. 04850038
048600     05  FILLER                      PIC  X(36)     VALUE         04860038
048700         'NONE OF YOUR REPORTS WERE CREATED.  '.                  04870038
048800     05  FILLER                      PIC  X(36)     VALUE         04880038
048900         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  04890038
049000     05  FILLER                      PIC  X(58)     VALUE SPACES. 04900038
049100                                                                  04910038
049200 01  EL2-ERROR-LINE-2P.                                           04920038
049300     05  FILLER                      PIC  X(02)     VALUE SPACES. 04930038
049400     05  FILLER                      PIC  X(49)     VALUE         04940038
049500         'PLEASE RE-SUBMIT A REQUEST TO CREATE THIS REPORT '.     04950038
049600     05  FILLER                      PIC  X(41)     VALUE         04960038
049700         '(YOUR OTHER REPORTS SHOULD BE CHECKED TO '.             04970038
049800     05  FILLER                      PIC  X(40)     VALUE         04980038
049900         'DETERMINE IF THEY NEED TO BE CREATED).  '.              04990038
050000                                                                  05000038
050100 01  EL3-ERROR-LINE-3.                                            05010038
050200     05  FILLER                      PIC  X(02)     VALUE SPACES. 05020038
050300     05  FILLER                      PIC  X(50)     VALUE         05030038
050400         'YOUR REQUEST WAS AS FOLLOWS:                      '.    05040038
050500     05  FILLER                      PIC  X(81)     VALUE SPACES. 05050038
050600                                                                  05060038
050700 01  EL4-ERROR-LINE-4.                                            05070038
050800     05  FILLER                      PIC  X(07)     VALUE SPACES. 05080038
050900     05  FILLER                      PIC  X(12)     VALUE         05090038
051000         'REQUESTOR:  '.                                          05100038
051100     05  EL4-REQUESTOR-ID            PIC  X(08)     VALUE SPACES. 05110038
051200     05  FILLER                      PIC  X(10)     VALUE SPACES. 05120038
051300     05  FILLER                      PIC  X(22)     VALUE         05130038
051400         'PRINTER DESTINATION:  '.                                05140038
051500     05  EL4-PRINTER-ID              PIC  X(08)     VALUE SPACES. 05150038
051600     05  FILLER                      PIC  X(65)     VALUE SPACES. 05160038
051700                                                                  05170038
051800 01  EL5-ERROR-LINE-5.                                            05180038
051900     05  FILLER                      PIC  X(07)     VALUE SPACES. 05190038
052000     05  FILLER                      PIC  X(20)     VALUE         05200038
052100         'REQUESTED REPORTS:  '.                                  05210038
052200*JPL                                                              05220038
052300     05  FILLER                      PIC  X(105)    VALUE SPACES. 05230038
052400*JPL 05  FILLER                      PIC  X(08)     VALUE         05240038
052500*JPL     'STATS   '.                                              05250038
052600*JPL 05  FILLER                      PIC  X(18)     VALUE         05260038
052700*JPL     'PO/STR WRKSHEET   '.                                    05270038
052800*JPL 05  FILLER                      PIC  X(17)     VALUE         05280038
052900*JPL     'CRTNS NOT RCVD   '.                                     05290038
053000*JPL 05  FILLER                      PIC  X(14)     VALUE         05300038
053100*JPL     'FREE ASTRAY   '.                                        05310038
053200*JPL 05  FILLER                      PIC  X(12)     VALUE         05320038
053300*JPL     'MISDIRECT   '.                                          05330038
053400*JPL 05  FILLER                      PIC  X(17)     VALUE         05340038
053500*JPL     'DUPLICATE SCAN   '.                                     05350038
053600*JPL 05  FILLER                      PIC  X(14)     VALUE         05360038
053700*JPL     'SCAN NOT FOUND'.                                        05370038
053800*JPL 05  FILLER                      PIC  X(05)     VALUE SPACES. 05380038
053900                                                                  05390038
054000 01  EL5-ERROR-LINE-5B.                                           05400038
054100     05  FILLER                      PIC  X(07)     VALUE SPACES. 05410038
054200     05  FILLER                      PIC  X(04)     VALUE SPACES. 05420038
054300     05  FILLER                      PIC  X(08)     VALUE         05430038
054400         'STATS   '.                                              05440038
054500     05  FILLER                      PIC  X(18)     VALUE         05450038
054600         'PO/STR UNT ADJ    '.                                    05460038
054700     05  FILLER                      PIC  X(17)     VALUE         05470038
054800         'CRTNS NOT RCVD   '.                                     05480038
054900     05  FILLER                      PIC  X(14)     VALUE         05490038
055000         'FREE ASTRAY   '.                                        05500038
055100     05  FILLER                      PIC  X(12)     VALUE         05510038
055200         'MISDIRECT   '.                                          05520038
055300     05  FILLER                      PIC  X(17)     VALUE         05530038
055400         'DUPLICATE SCAN   '.                                     05540038
055500     05  FILLER                      PIC  X(18)     VALUE         05550038
055600         'SCAN NOT FOUND    '.                                    05560038
055700     05  FILLER                      PIC  X(17)     VALUE         05570038
055800         'UNUSED LABELS    '.                                     05580038
055900*JPL                                                              05590038
056000*01  EL6-ERROR-LINE-6.                                            05600038
056100*    05  FILLER                      PIC  X(29)     VALUE SPACES. 05610038
056200*    05  EL6-SUKRP002-IND            PIC  X(01)     VALUE SPACES. 05620038
056300*    05  FILLER                      PIC  X(12)     VALUE SPACES. 05630038
056400*    05  EL6-SUKRP007-IND            PIC  X(01)     VALUE SPACES. 05640038
056500*    05  FILLER                      PIC  X(16)     VALUE SPACES. 05650038
056600*    05  EL6-SUKRP003-IND            PIC  X(01)     VALUE SPACES. 05660038
056700*    05  FILLER                      PIC  X(15)     VALUE SPACES. 05670038
056800*    05  EL6-SUKRP005-IND            PIC  X(01)     VALUE SPACES. 05680038
056900*    05  FILLER                      PIC  X(12)     VALUE SPACES. 05690038
057000*    05  EL6-SUKRP004-IND            PIC  X(01)     VALUE SPACES. 05700038
057100*    05  FILLER                      PIC  X(13)     VALUE SPACES. 05710038
057200*    05  EL6-SUKRP006-IND            PIC  X(01)     VALUE SPACES. 05720038
057300*    05  FILLER                      PIC  X(16)     VALUE SPACES. 05730038
057400*    05  EL6-SUKRP008-IND            PIC  X(01)     VALUE SPACES. 05740038
057500*    05  FILLER                      PIC  X(12)     VALUE SPACES. 05750038
057600                                                                  05760038
057700 01  EL6-ERROR-LINE-6B.                                           05770038
057800     05  FILLER                      PIC  X(13)     VALUE SPACES. 05780038
057900     05  EL6-SUKRP002-IND            PIC  X(01)     VALUE SPACES. 05790038
058000     05  FILLER                      PIC  X(12)     VALUE SPACES. 05800038
058100     05  EL6-SUKRP007-IND            PIC  X(01)     VALUE SPACES. 05810038
058200     05  FILLER                      PIC  X(16)     VALUE SPACES. 05820038
058300     05  EL6-SUKRP003-IND            PIC  X(01)     VALUE SPACES. 05830038
058400     05  FILLER                      PIC  X(15)     VALUE SPACES. 05840038
058500     05  EL6-SUKRP005-IND            PIC  X(01)     VALUE SPACES. 05850038
058600     05  FILLER                      PIC  X(12)     VALUE SPACES. 05860038
058700     05  EL6-SUKRP004-IND            PIC  X(01)     VALUE SPACES. 05870038
058800     05  FILLER                      PIC  X(13)     VALUE SPACES. 05880038
058900     05  EL6-SUKRP006-IND            PIC  X(01)     VALUE SPACES. 05890038
059000     05  FILLER                      PIC  X(16)     VALUE SPACES. 05900038
059100     05  EL6-SUKRP008-IND            PIC  X(01)     VALUE SPACES. 05910038
059200     05  FILLER                      PIC  X(17)     VALUE SPACES. 05920038
059300*JPL                                                              05930038
059400     05  EL6-SUKRP023-IND            PIC  X(01)     VALUE SPACES. 05940038
059500     05  FILLER                      PIC  X(10)     VALUE SPACES. 05950038
059600******************************************************************05960038
059700*  ADDED COPYBOOK FOR XLKUT001                         WR# 21361 *05970038
059800******************************************************************05980038
059900     COPY XLWS001.                                                05990038
060000                                                                  06000038
060100******************************************************************06010038
060200*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *06020041
060300******************************************************************06030038
060400*                                                                 06040038
060500*  COPY BOOK FOR SHIPMENT TABLE                                   06050038
060600*                                                                 06060038
060700     EXEC SQL                                                     06070038
060800          INCLUDE TSHIPMT                                         06080038
060900     END-EXEC.                                                    06090038
061000******************************************************************06100038
061100*  REMOVED REFERENCES OF DB2 TABLE TSHPTPO             WR# 21361 *06110038
061200******************************************************************06120038
061900******************************************************************06190038
062000*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *06200041
062100******************************************************************06210038
062200*                                                                 06220038
062300*  COPY BOOK FOR SHIPMENT UNIT/UPC ASSOCIATION                    06230038
062400*                                                                 06240038
062500     EXEC SQL                                                     06250038
062600          INCLUDE TSHUUPC                                         06260038
062700     END-EXEC.                                                    06270038
062800*                                                                 06280038
062900*  COPY BOOK FOR PACKSLIP TABLE                                   06290038
063000*                                                                 06300038
063100     EXEC SQL                                                     06310038
063200          INCLUDE TPKSLIP                                         06320038
063300     END-EXEC.                                                    06330038
063400*                                                                 06340038
063500*  COPY BOOK FOR SHIPMENT UNIT TABLE                              06350038
063600*                                                                 06360038
063700     EXEC SQL                                                     06370038
063800          INCLUDE TSHPUNT                                         06380038
063900     END-EXEC.                                                    06390038
064000*                                                                 06400038
064100*  COPY BOOK FOR SHIPMENT UNIT LOCATION                           06410038
064200*                                                                 06420038
064300     EXEC SQL                                                     06430038
064400          INCLUDE TSHUNLO                                         06440038
064500     END-EXEC.                                                    06450038
064600******************************************************************06460038
064700*  REMOVED REFERENCES OF DB2 TABLE TSK                 WR# 21361 *06470038
064800******************************************************************06480038
065500******************************************************************06550038
065600*  REMOVED REFERENCES OF DB2 TABLE TUPCSKU             WR# 21361 *06560038
065700******************************************************************06570038
066400******************************************************************06640038
066500*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *06650041
066600******************************************************************06660038
066700*                                                                 06670038
066800*  COPY BOOK FOR THE VEHICLE TRIP TABLE                           06680038
066900*                                                                 06690038
067000     EXEC SQL                                                     06700038
067100          INCLUDE TVHTRIP                                         06710038
067200     END-EXEC.                                                    06720038
067300*                                                                 06730038
067400*  COPY BOOK FOR TRIP STATUS TABLE                                06740038
067500*                                                                 06750038
067600     EXEC SQL                                                     06760038
067700          INCLUDE TTRIPST                                         06770038
067800     END-EXEC.                                                    06780038
067900*                                                                 06790038
068000*  COPY BOOK FOR TRIP STATUS TYPE TABLE                           06800038
068100*                                                                 06810038
068200     EXEC SQL                                                     06820038
068300          INCLUDE TTRSTYP                                         06830038
068400     END-EXEC.                                                    06840038
068500 EJECT                                                            06850038
068600*  DB2 COMMUNICATION AREA                                         06860038
068700*                                                                 06870038
068800     EXEC SQL                                                     06880038
068900         INCLUDE SQLCA                                            06890038
069000     END-EXEC.                                                    06900038
069100 EJECT                                                            06910038
069200*  DB2 COMMUNICATION AREA2                                        06920038
069300*                                                                 06930038
069400     COPY SQLCA2.                                                 06940045
069500 EJECT                                                            06950038
069600     EXEC SQL                                                     06960038
069700        DECLARE UPC-CSR CURSOR FOR                                06970038
069800        SELECT  A.TRN_LNE_NBR                                     06980038
069900              , A.UPC_NBR                                         06990038
070000              , A.SHPD_QTY                                        07000038
070100          FROM  TSHUUPC A                                         07010038
070200          WHERE A.SHIPT_UNT_ID  = :SHUUPC-SHIPT-UNT-ID            07020038
070300     END-EXEC.                                                    07030038
070400                                                                  07040038
070500                                                                  07050038
070600*                                                                 07060038
070700 PROCEDURE DIVISION.                                              07070038
070800*                                                                 07080038
070900 0000-MAINLINE-PROCESSING.                                        07090038
071000******************************************************************07100038
071100* THIS IS THE MAIN DRIVER FOR THE PROGRAM.                        07110038
071200* IF CONTROL CARD DOES NOT REQUEST THIS REPORT - END PROGRAM      07120038
071300* IMMEDIATELY - DO NOT EVEN CREATE HEADINGS.                      07130038
071400******************************************************************07140038
071500     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           07150038
071600     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   07160038
071700                                                                  07170038
071800     IF CC-PRINT-SUKRP003                                         07180038
071900         PERFORM 0100-INITIALIZATION                              07190038
072000         IF SU001-DETAIL-RECORD                                   07200038
072100             PERFORM 1000-PROCESS-EXTRACT-FILE                    07210038
072200             IF PS-ERROR-RECORD                                   07220038
072300                 PERFORM 7000-WRITE-ERROR-REPORT                  07230038
072400             END-IF                                               07240038
072500         ELSE                                                     07250038
072600             IF CC-PRINT-SUKRP002                                 07260038
072700                 CONTINUE                                         07270038
072800             ELSE                                                 07280038
072900                 PERFORM 7000-WRITE-ERROR-REPORT                  07290038
073000             END-IF                                               07300038
073100         END-IF                                                   07310038
073200                                                                  07320038
073300         CLOSE EXTRACT-FILE                                       07330038
073400               SU-CARTON-NOT-RCVD-FILE                            07340038
073500     END-IF.                                                      07350038
073600                                                                  07360038
073700     GOBACK.                                                      07370038
073800*                                                                 07380038
073900*                                                                 07390038
074000 0100-INITIALIZATION.                                             07400038
074100******************************************************************07410038
074200**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               07420038
074300******************************************************************07430038
074400     ACCEPT PV-TODAYS-DATE                                        07440038
074500       FROM DATE.                                                 07450038
074600                                                                  07460038
074700     ACCEPT PV-TODAYS-TIME                                        07470038
074800       FROM TIME.                                                 07480038
074900                                                                  07490038
075000     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         07500038
075100     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             07510038
075200     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               07520038
075300     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              07530038
075400                                                                  07540038
075500     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              07550038
075600     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            07560038
075700     MOVE PC-SUKRP003            TO DP132O-PROGRAM-NAME.          07570038
075800                                                                  07580038
075900******************************************************************07590038
076000**  CHECK PO IND ON CONTROL CARD AND MOVE DESCRIPTION TO HEADER.  07600038
076100******************************************************************07610038
076200     IF CC-PRINT-ENTIRE-TRIP                                      07620038
076300        STRING 'ENTIRE TRIP-REQUESTED BY '                        07630038
076400               CC-REQUESTOR-ID  DELIMITED BY SIZE                 07640038
076500               INTO HL1A-CC-IND-DESC                              07650038
076600     ELSE                                                         07660038
076700        STRING 'SELECTED PO''S REQUESTED BY '                     07670038
076800               CC-REQUESTOR-ID  DELIMITED BY SIZE                 07680038
076900               INTO HL1A-CC-IND-DESC.                             07690038
077000                                                                  07700038
077100     OPEN INPUT  EXTRACT-FILE                                     07710038
077200          OUTPUT SU-CARTON-NOT-RCVD-FILE.                         07720038
077300                                                                  07730038
077400     PERFORM 2200-READ-EXTRACT.                                   07740038
077500                                                                  07750038
077600     MOVE SU001-MANIFEST-NBR     TO PV-TRIP-ID                    07760038
077700                                    VHTRIP-TRIP-ID.               07770038
077800                                                                  07780038
077900     SET PS-DETAIL-RECORD        TO TRUE.                         07790038
078000                                                                  07800038
078100     PERFORM 1100-SELECT-TRAILER.                                 07810038
078200                                                                  07820038
078300     MOVE VHTRIP-OWNER-SCAC-ID   TO HL2-SCAC.                     07830038
078400     MOVE PV-TRIP-ID             TO HL2-TRIP-ID.                  07840038
078500     MOVE TRIPST-TRIP-STATUS-CDE TO HL2-TRAILER-STAT.             07850038
078600                                                                  07860038
078700     IF DN-VEH-NBR = -1                                           07870038
078800         MOVE SPACES             TO HL2-TRAILER                   07880038
078900     ELSE                                                         07890038
079000         MOVE VHTRIP-VEH-NBR     TO HL2-TRAILER                   07900038
079100     END-IF.                                                      07910038
079200*                                                                 07920038
079300*                                                                 07930038
079400 1000-PROCESS-EXTRACT-FILE.                                       07940038
079500******************************************************************07950038
079600**  PERFORM THE PROCESSING FOR THE PROGRAM.                       07960038
079700******************************************************************07970038
079800     IF PS-DETAIL-RECORD                                          07980038
079900         MOVE PC-AR TO PV-STATUS                                  07990038
080000         SET PS-STATUS-NOT-FOUND TO TRUE                          08000038
080100         PERFORM 1200-SELECT-STATUS                               08010038
080200     END-IF.                                                      08020038
080300                                                                  08030038
080400     IF PS-DETAIL-RECORD                                          08040038
080500         IF PS-STATUS-FOUND                                       08050038
080600             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              08060038
080700             MOVE PV-DB2-DATE-CC TO HL3-ARRIVAL-DATE-CC           08070038
080800             MOVE PV-DB2-DATE-YY TO HL3-ARRIVAL-DATE-YY           08080038
080900             MOVE PV-DB2-DATE-MM TO HL3-ARRIVAL-DATE-MM           08090038
081000             MOVE PV-DB2-DATE-DD TO HL3-ARRIVAL-DATE-DD           08100038
081100         ELSE                                                     08110038
081200             MOVE PC-00          TO HL3-ARRIVAL-DATE-CC           08120038
081300             MOVE PC-00          TO HL3-ARRIVAL-DATE-YY           08130038
081400             MOVE PC-00          TO HL3-ARRIVAL-DATE-MM           08140038
081500             MOVE PC-00          TO HL3-ARRIVAL-DATE-DD           08150038
081600         END-IF                                                   08160038
081700         MOVE PC-UG    TO PV-STATUS                               08170038
081800         SET PS-STATUS-NOT-FOUND TO TRUE                          08180038
081900         PERFORM 1200-SELECT-STATUS                               08190038
082000     END-IF.                                                      08200038
082100                                                                  08210038
082200     IF PS-DETAIL-RECORD                                          08220038
082300         IF PS-STATUS-FOUND                                       08230038
082400             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              08240038
082500             MOVE PV-DB2-DATE-CC TO HL3-BEG-UNLOAD-DATE-CC        08250038
082600             MOVE PV-DB2-DATE-YY TO HL3-BEG-UNLOAD-DATE-YY        08260038
082700             MOVE PV-DB2-DATE-MM TO HL3-BEG-UNLOAD-DATE-MM        08270038
082800             MOVE PV-DB2-DATE-DD TO HL3-BEG-UNLOAD-DATE-DD        08280038
082900         ELSE                                                     08290038
083000             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-CC        08300038
083100             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-YY        08310038
083200             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-MM        08320038
083300             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-DD        08330038
083400         END-IF                                                   08340038
083500         MOVE PC-UN    TO PV-STATUS                               08350038
083600         SET PS-STATUS-NOT-FOUND TO TRUE                          08360038
083700         PERFORM 1200-SELECT-STATUS                               08370038
083800     END-IF.                                                      08380038
083900                                                                  08390038
084000     IF PS-DETAIL-RECORD                                          08400038
084100         IF PS-STATUS-FOUND                                       08410038
084200             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              08420038
084300             MOVE PV-DB2-DATE-CC TO HL3-UNLOADED-DATE-CC          08430038
084400             MOVE PV-DB2-DATE-YY TO HL3-UNLOADED-DATE-YY          08440038
084500             MOVE PV-DB2-DATE-MM TO HL3-UNLOADED-DATE-MM          08450038
084600             MOVE PV-DB2-DATE-DD TO HL3-UNLOADED-DATE-DD          08460038
084700         ELSE                                                     08470038
084800             MOVE PC-00          TO HL3-UNLOADED-DATE-CC          08480038
084900             MOVE PC-00          TO HL3-UNLOADED-DATE-YY          08490038
085000             MOVE PC-00          TO HL3-UNLOADED-DATE-MM          08500038
085100             MOVE PC-00          TO HL3-UNLOADED-DATE-DD          08510038
085200         END-IF                                                   08520038
085300         PERFORM 8000-WRITE-REPORT-HEADERS                        08530038
085400         PERFORM 2200-READ-EXTRACT                                08540038
085500         PERFORM 2000-PROCESS-SU                                  08550038
085600     END-IF.                                                      08560038
085700                                                                  08570038
085800     IF PS-DETAIL-RECORD                                          08580038
085900         PERFORM 8500-PRINT-RCVR-TOT                              08590038
086000*                                                                 08600038
086100         WRITE SU-CARTON-NOT-RCVD-RECORD                          08610038
086200           FROM END-OF-REPORT-LINE                                08620038
086300             AFTER ADVANCING 2 LINES                              08630038
086400     END-IF.                                                      08640038
086500*                                                                 08650038
086600 1100-SELECT-TRAILER.                                             08660038
086700     MOVE '1100-SELECT-TRAILER '                                  08670038
086800                                 TO PV-ABEND-PARAGRAPH.           08680038
086900     EXEC SQL                                                     08690038
087000       SELECT A.OWNER_SCAC_ID                                     08700038
087100             ,A.VEH_NBR                                           08710038
087200             ,B.TRIP_STATUS_CDE                                   08720038
087300       INTO  :VHTRIP-OWNER-SCAC-ID                                08730038
087400            ,:VHTRIP-VEH-NBR :DN-VEH-NBR                          08740038
087500            ,:TRIPST-TRIP-STATUS-CDE                              08750038
087600       FROM   TVHTRIP A                                           08760038
087700             ,TTRIPST B                                           08770038
087800             ,TTRSTYP C                                           08780038
087900       WHERE  A.TRIP_ID          = :VHTRIP-TRIP-ID                08790038
088000         AND  B.TRIP_STATUS_CDE ^= 'DE'                           08800038
088100         AND  C.PRTY_CDE =                                        08810038
088200              (SELECT MAX(E.PRTY_CDE)                             08820038
088300                 FROM TTRIPST D                                   08830038
088400                     ,TTRSTYP E                                   08840038
088500                WHERE D.TRIP_ID         = A.TRIP_ID               08850038
088600                  AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)      08860038
088700         AND  A.TRIP_ID         = B.TRIP_ID                       08870038
088800         AND  B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE               08880038
088900     END-EXEC.                                                    08890038
089000                                                                  08900038
089100     EVALUATE TRUE                                                08910038
089200       WHEN SQLCODE = ZEROS                                       08920038
089300         CONTINUE                                                 08930038
089400       WHEN SQLCODE = +100                                        08940038
089500         MOVE SPACES TO VHTRIP-VEH-NBR                            08950038
089600                        VHTRIP-OWNER-SCAC-ID                      08960038
089700                        TRIPST-TRIP-STATUS-CDE                    08970038
089800       WHEN SQLCODE = -904                                        08980038
089900       WHEN SQLCODE = -911                                        08990038
090000       WHEN SQLCODE = -913                                        09000038
090100         SET PS-ERROR-RECORD TO TRUE                              09010038
090200         MOVE SPACES TO VHTRIP-VEH-NBR                            09020038
090300                        VHTRIP-OWNER-SCAC-ID                      09030038
090400                        TRIPST-TRIP-STATUS-CDE                    09040038
090500       WHEN OTHER                                                 09050038
090600         DISPLAY PV-ABEND-PARAGRAPH                               09060038
090700         PERFORM Z999-SQL-ERROR                                   09070038
090800     END-EVALUATE.                                                09080038
090900                                                                  09090038
091000 1200-SELECT-STATUS.                                              09100038
091100     MOVE '1200-SELECT-STATUS  '                                  09110038
091200                                 TO PV-ABEND-PARAGRAPH.           09120038
091300     EXEC SQL                                                     09130038
091400       SELECT STATUS_DTE                                          09140038
091500       INTO  :TRIPST-STATUS-DTE                                   09150038
091600       FROM   TTRIPST                                             09160038
091700       WHERE  TRIP_ID            = :VHTRIP-TRIP-ID                09170038
091800         AND  TRIP_STATUS_CDE    = :PV-STATUS                     09180038
091900     END-EXEC.                                                    09190038
092000                                                                  09200038
092100     EVALUATE TRUE                                                09210038
092200       WHEN SQLCODE = ZEROS                                       09220038
092300         SET PS-STATUS-FOUND TO TRUE                              09230038
092400       WHEN SQLCODE = +100                                        09240038
092500         SET PS-STATUS-NOT-FOUND TO TRUE                          09250038
092600       WHEN SQLCODE = -904                                        09260038
092700       WHEN SQLCODE = -911                                        09270038
092800       WHEN SQLCODE = -913                                        09280038
092900         SET PS-ERROR-RECORD TO TRUE                              09290038
093000       WHEN OTHER                                                 09300038
093100         DISPLAY PV-ABEND-PARAGRAPH                               09310038
093200         PERFORM Z999-SQL-ERROR                                   09320038
093300     END-EVALUATE.                                                09330038
093400                                                                  09340038
093500*                                                                 09350038
093600 2000-PROCESS-SU.                                                 09360038
093700******************************************************************09370038
093800*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *09380038
093900*  CARTONS NOT RECEIVED REPORT.                                  *09390038
094000******************************************************************09400038
094100     MOVE PV-TRIP-ID   TO SHIPMT-TRIP-ID.                         09410038
094200     SET PS-NOT-SCANNED TO TRUE.                                  09420038
094300     PERFORM 2100-PROCESS-EXTRACT                                 09430038
094400         UNTIL PS-END-OF-EXTRACT                                  09440038
094500            OR PS-ERROR-RECORD.                                   09450038
094600                                                                  09460038
094700 2100-PROCESS-EXTRACT.                                            09470038
094800     IF SU001-SCANNED-IND = PC-Y                                  09480038
094900         SET PS-SCANNED TO TRUE                                   09490038
095000     END-IF.                                                      09500038
095100     MOVE SU001-PO-NUMBER        TO PV-PO.                        09510038
095200     MOVE SU001-REC-SEQ-NBR      TO PV-RECEIVER.                  09520038
095300     MOVE SU001-SHIPT-UNT-ID     TO PV-SERIAL-SHIP-CODE.          09530038
095400     MOVE SU001-SCANNED-IND      TO PV-SAVE-SCANNED-IND.          09540038
095500     PERFORM 2200-READ-EXTRACT.                                   09550038
095600     IF SU001-SHIPT-UNT-ID NOT = PV-SERIAL-SHIP-CODE AND          09560038
095700        PS-NOT-SCANNED                                            09570038
095800         PERFORM 2300-PROCESS-NOT-FOUND                           09580038
095900     ELSE                                                         09590038
096000         IF SU001-SHIPT-UNT-ID NOT = PV-SERIAL-SHIP-CODE          09600038
096100             SET PS-NOT-SCANNED TO TRUE                           09610038
096200         END-IF                                                   09620038
096300     END-IF.                                                      09630038
096400                                                                  09640038
096500     IF PS-DETAIL-RECORD                                          09650038
096600         IF PS-END-OF-EXTRACT                                     09660038
096700             IF PV-SAVE-SCANNED-IND NOT = PC-Y                    09670038
096800                 PERFORM 2300-PROCESS-NOT-FOUND                   09680038
096900             END-IF                                               09690038
097000         END-IF                                                   09700038
097100     END-IF.                                                      09710038
097200                                                                  09720038
097300 2200-READ-EXTRACT.                                               09730038
097400     MOVE '2200-READ-EXTRACT   '                                  09740038
097500                                 TO PV-ABEND-PARAGRAPH.           09750038
097600     READ EXTRACT-FILE INTO SU001-EXTRACT-RECORD                  09760038
097700        AT END                                                    09770038
097800           SET PS-END-OF-EXTRACT TO TRUE.                         09780038
097900                                                                  09790038
098000 2300-PROCESS-NOT-FOUND.                                          09800038
098100     MOVE PV-PO-RECEIVER         TO DL1-PO-RECEIVER               09810038
098200     MOVE PV-SERIAL-SHIP-CODE    TO SHUNLO-SHIPT-UNT-ID           09820038
098300                                    SHPUNT-SHIPT-UNT-ID           09830038
098400                                    SHUUPC-SHIPT-UNT-ID.          09840038
098500     MOVE PV-SERIAL-SHIP-CODE-1    TO PV-OUT-S-S-C-1              09850038
098600     MOVE PV-SERIAL-SHIP-CODE-2-8  TO PV-OUT-S-S-C-2-8            09860038
098700     MOVE PV-SERIAL-SHIP-CODE-9-17 TO PV-OUT-S-S-C-9-17           09870038
098800     MOVE PV-SERIAL-SHIP-CODE-18   TO PV-OUT-S-S-C-18             09880038
098900     MOVE PV-OUT-SERIAL-SHIP-CODE TO DL1-SERIAL-SHIP-CODE.        09890038
099000     PERFORM 2400-SELECT-SHPUNT.                                  09900038
099100                                                                  09910038
099200     IF PS-DETAIL-RECORD                                          09920038
099300         MOVE SHPUNT-DEST-OPER-UNT-ID TO PV-STR-NBR-NUMERIC       09930038
099400         MOVE PV-STR-NBR              TO DL1-STORE-NBR            09940038
099500         SET PS-NOT-END-OF-CURSOR     TO TRUE                     09950038
099600         MOVE ZERO                    TO PV-EXPTED-QTY            09960038
099700         MOVE ZERO                    TO PV-LINE-TOT-QTY          09970038
099800         PERFORM 2500-OPEN-CURSOR                                 09980038
099900     END-IF.                                                      09990038
100000                                                                  10000038
100100     IF PS-DETAIL-RECORD                                          10010038
100200         PERFORM 2510-FETCH-CURSOR                                10020038
100300     END-IF.                                                      10030038
100400******************************************************************10040038
100500*  CALL TO 3000-SELECT-SKU IS REPLACED WITH CALL TO    WR# 21361 *10050038
100600*  3000-CALL-XLKUT-DOMAIN-PGM.                                   *10060038
100700******************************************************************10070038
100800     IF PS-DETAIL-RECORD                                          10080038
101000         PERFORM 3000-CALL-XLKUT-DOMAIN-PGM                       10100038
101100     END-IF.                                                      10110038
101200                                                                  10120038
101300******************************************************************10130038
101400*  REPLACED TSK VARAIBLES WITH XLKUT001 VARAIBLES      WR# 21361 *10140038
101500*  AND PV-SAVE-SEQ-NMBR IS REPLACED WITH VARIABLE                *10150038
101600*  PV-SAVE-SKU-NBR.                                              *10160038
101700******************************************************************10170038
101800     IF PS-DETAIL-RECORD                                          10180038
101900         MOVE SHUUPC-TRN-LNE-NBR     TO PV-SAVE-TRN-LNE-NBR       10190038
102300         MOVE XL001-DEPT-NBR-3CH     TO PV-SAVE-MERCH-DEPT-NMBR   10230038
102400         MOVE XL001-SUB-CL-NBR-2CH   TO PV-SAVE-MERCH-CLASS-NMBR  10240038
102500         MOVE XL001-SKU-NBR          TO PV-SAVE-SKU-NBR           10250038
102600         PERFORM 2520-PROCESS-CURSOR                              10260038
102700             UNTIL PS-END-OF-CURSOR                               10270038
102800                OR PS-ERROR-RECORD                                10280038
102900     END-IF.                                                      10290038
103000******************************************************************10300038
103100*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *10310041
103200******************************************************************10320038
103300                                                                  10330038
103400     IF PS-DETAIL-RECORD                                          10340038
103500         PERFORM 2530-CLOSE-CURSOR                                10350038
103600     END-IF.                                                      10360038
103700                                                                  10370038
103800 2400-SELECT-SHPUNT.                                              10380038
103900     MOVE '2400-SELECT-SHPUNT '                                   10390038
104000                                 TO PV-ABEND-PARAGRAPH.           10400038
104100     EXEC SQL                                                     10410038
104200         SELECT A.DEST_OPER_UNT_ID                                10420038
104300           INTO :SHPUNT-DEST-OPER-UNT-ID                          10430038
104400          FROM  TSHPUNT A                                         10440038
104500          WHERE A.SHIPT_UNT_ID      = :SHPUNT-SHIPT-UNT-ID        10450038
104600     END-EXEC.                                                    10460038
104700     EVALUATE TRUE                                                10470038
104800       WHEN SQLCODE = ZEROS                                       10480038
104900         CONTINUE                                                 10490038
105000       WHEN SQLCODE = -904                                        10500038
105100       WHEN SQLCODE = -911                                        10510038
105200       WHEN SQLCODE = -913                                        10520038
105300         SET PS-ERROR-RECORD TO TRUE                              10530038
105400       WHEN OTHER                                                 10540038
105500         DISPLAY PV-ABEND-PARAGRAPH                               10550038
105600         PERFORM Z999-SQL-ERROR                                   10560038
105700     END-EVALUATE.                                                10570038
105800                                                                  10580038
105900 2500-OPEN-CURSOR.                                                10590038
106000     MOVE '2500-OPEN-CURSOR   '                                   10600038
106100                                 TO PV-ABEND-PARAGRAPH.           10610038
106200     EXEC SQL                                                     10620038
106300         OPEN UPC-CSR                                             10630038
106400     END-EXEC.                                                    10640038
106500     EVALUATE TRUE                                                10650038
106600       WHEN SQLCODE = ZEROS                                       10660038
106700         CONTINUE                                                 10670038
106800       WHEN SQLCODE = -904                                        10680038
106900       WHEN SQLCODE = -911                                        10690038
107000       WHEN SQLCODE = -913                                        10700038
107100         SET PS-ERROR-RECORD TO TRUE                              10710038
107200       WHEN OTHER                                                 10720038
107300         DISPLAY PV-ABEND-PARAGRAPH                               10730038
107400         PERFORM Z999-SQL-ERROR                                   10740038
107500     END-EVALUATE.                                                10750038
107600                                                                  10760038
107700 2510-FETCH-CURSOR.                                               10770038
107800     MOVE '2510-FETCH-CURSOR   '                                  10780038
107900                                 TO PV-ABEND-PARAGRAPH.           10790038
108000     EXEC SQL                                                     10800038
108100          FETCH UPC-CSR                                           10810038
108200          INTO  :SHUUPC-TRN-LNE-NBR                               10820038
108300              , :SHUUPC-UPC-NBR                                   10830038
108400              , :SHUUPC-SHPD-QTY                                  10840038
108500     END-EXEC.                                                    10850038
108600                                                                  10860038
108700     EVALUATE TRUE                                                10870038
108800       WHEN SQLCODE = ZEROS                                       10880038
108900         CONTINUE                                                 10890038
109000       WHEN SQLCODE = +100                                        10900038
109100           SET PS-END-OF-CURSOR TO TRUE                           10910038
109200       WHEN SQLCODE = -904                                        10920038
109300       WHEN SQLCODE = -911                                        10930038
109400       WHEN SQLCODE = -913                                        10940038
109500         SET PS-ERROR-RECORD TO TRUE                              10950038
109600       WHEN OTHER                                                 10960038
109700         DISPLAY PV-ABEND-PARAGRAPH                               10970038
109800         PERFORM Z999-SQL-ERROR                                   10980038
109900     END-EVALUATE.                                                10990038
110000                                                                  11000038
110100 2520-PROCESS-CURSOR.                                             11010038
110200     MOVE PV-PO-RECEIVER         TO DL1-PO-RECEIVER               11020038
110300     MOVE SHUUPC-TRN-LNE-NBR     TO DL1-LINE-NBR.                 11030038
110400     ADD SHUUPC-SHPD-QTY         TO PV-EXPTED-QTY.                11040038
110500     ADD SHUUPC-SHPD-QTY         TO PV-LINE-TOT-QTY.              11050038
110600     PERFORM 2510-FETCH-CURSOR.                                   11060038
110700                                                                  11070038
110800******************************************************************11080038
110900*  REPLACED TSK VARAIBLES WITH XLKUT001 VARAIBLES      WR# 21361 *11090038
111000*  AND PV-SAVE-SEQ-NMBR IS REPLACED WITH VARIABLE                *11100038
111100*  PV-SAVE-SKU-NBR.                                              *11110038
111200******************************************************************11120038
111300     IF PS-DETAIL-RECORD                                          11130038
111400         IF SHUUPC-TRN-LNE-NBR   NOT = PV-SAVE-TRN-LNE-NBR        11140038
111800         OR XL001-DEPT-NBR-3CH   NOT = PV-SAVE-MERCH-DEPT-NMBR    11180038
111900         OR XL001-SUB-CL-NBR-2CH NOT = PV-SAVE-MERCH-CLASS-NMBR   11190038
112000         OR XL001-SKU-NBR        NOT = PV-SAVE-SKU-NBR            11200038
112100         OR PS-END-OF-CURSOR                                      11210038
112200             IF PV-LINE-CNT > PC-60                               11220038
112300                 PERFORM 8000-WRITE-REPORT-HEADERS                11230038
112400             END-IF                                               11240038
112500             IF SHUUPC-TRN-LNE-NBR NOT = PV-SAVE-TRN-LNE-NBR      11250038
112600             OR PS-END-OF-CURSOR                                  11260038
112700                 MOVE PV-LINE-TOT-QTY TO DL1-LINE-TOT-QTY         11270038
112800                 MOVE ZERO            TO PV-LINE-TOT-QTY          11280038
112900             ELSE                                                 11290038
113000                 MOVE ZERO            TO DL1-LINE-TOT-QTY         11300038
113100             END-IF                                               11310038
113200             MOVE PV-EXPTED-QTY       TO DL1-EXPTED-QTY           11320038
113300             MOVE ZERO                TO PV-EXPTED-QTY            11330038
113400             PERFORM 8400-WRITE-DETAIL-LINES                      11340038
113500         END-IF                                                   11350038
113600     END-IF.                                                      11360038
113700                                                                  11370038
113800******************************************************************11380038
113900*  REPLACED CALL TO 3000-SELECT-SKU WITH CALL TO       WR# 21361 *11390038
114000*  3000-CALL-XLKUT-DOMAIN-PGM.                                   *11400038
114100******************************************************************11410038
114200     IF PS-DETAIL-RECORD                                          11420038
114400         PERFORM 3000-CALL-XLKUT-DOMAIN-PGM                       11440038
114500     END-IF.                                                      11450038
114600                                                                  11460038
114700******************************************************************11470038
114800*  REPLACED TSK VARAIBLES WITH XLKUT001 VARAIBLES      WR# 21361 *11480038
114900*  AND PV-SAVE-SEQ-NMBR IS REPLACED WITH VARIABLE                *11490038
115000*  PV-SAVE-SKU-NBR.                                              *11500038
115100******************************************************************11510038
115200     IF PS-DETAIL-RECORD                                          11520038
115300         MOVE SHUUPC-TRN-LNE-NBR   TO PV-SAVE-TRN-LNE-NBR         11530038
115700         MOVE XL001-DEPT-NBR-3CH   TO PV-SAVE-MERCH-DEPT-NMBR     11570038
115800         MOVE XL001-SUB-CL-NBR-2CH TO PV-SAVE-MERCH-CLASS-NMBR    11580038
115900         MOVE XL001-SKU-NBR        TO PV-SAVE-SKU-NBR             11590038
116000     END-IF.                                                      11600038
116100******************************************************************11610038
116200*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *11620041
116300******************************************************************11630038
116400                                                                  11640038
116500 2530-CLOSE-CURSOR.                                               11650038
116600     MOVE '2530-CLOSE-CURSOR   '                                  11660038
116700                                 TO PV-ABEND-PARAGRAPH.           11670038
116800     EXEC SQL                                                     11680038
116900         CLOSE UPC-CSR                                            11690038
117000     END-EXEC.                                                    11700038
117100     EVALUATE TRUE                                                11710038
117200       WHEN SQLCODE = ZEROS                                       11720038
117300         CONTINUE                                                 11730038
117400       WHEN SQLCODE = -904                                        11740038
117500       WHEN SQLCODE = -911                                        11750038
117600       WHEN SQLCODE = -913                                        11760038
117700         SET PS-ERROR-RECORD TO TRUE                              11770038
117800       WHEN OTHER                                                 11780038
117900         DISPLAY PV-ABEND-PARAGRAPH                               11790038
118000         PERFORM Z999-SQL-ERROR                                   11800038
118100     END-EVALUATE.                                                11810038
118200                                                                  11820038
118300 2600-SELECT-SHUNLO.                                              11830038
118400     MOVE '2600-SELECT-SHUNLO'                                    11840038
118500                                 TO PV-ABEND-PARAGRAPH.           11850038
118600                                                                  11860038
118700     EXEC SQL                                                     11870038
118800         SELECT B.OWNER_SCAC_ID                                   11880038
118900               ,B.VEH_NBR                                         11890038
119000               ,A.CRE_TMST                                        11900038
119100           INTO :VHTRIP-OWNER-SCAC-ID                             11910038
119200               ,:VHTRIP-VEH-NBR :DN-VEH-NBR                       11920038
119300               ,:SHUNLO-CRE-TMST                                  11930038
119400           FROM TSHUNLO A,                                        11940038
119500                TVHTRIP B                                         11950038
119600          WHERE A.SHIPT_UNT_ID   = :SHUNLO-SHIPT-UNT-ID           11960038
119700            AND A.TRIP_ID        = B.TRIP_ID                      11970038
119800            AND A.SCN_LOC_ID     = 'RECV'                         11980038
119900            AND A.ACTV_CDE       = 'A'                            11990038
120000     END-EXEC.                                                    12000038
120100     EVALUATE TRUE                                                12010038
120200       WHEN SQLCODE = ZEROS                                       12020038
120300       WHEN SQLCODE = -811                                        12030038
120400         MOVE VHTRIP-OWNER-SCAC-ID TO DL1-SCAC                    12040038
120500         IF DN-VEH-NBR = -1                                       12050038
120600            MOVE SPACES   TO DL1-TRAILER                          12060038
120700         ELSE                                                     12070038
120800            MOVE VHTRIP-VEH-NBR       TO DL1-TRAILER              12080038
120900         END-IF                                                   12090038
121000         MOVE SHUNLO-CRE-TMST      TO DL1-SCAN-DATE               12100038
121100       WHEN SQLCODE = +100                                        12110038
121200         MOVE SPACES               TO DL1-TRAILER                 12120038
121300                                      DL1-SCAC                    12130038
121400                                      DL1-SCAN-DATE               12140038
121500       WHEN SQLCODE = -904                                        12150038
121600       WHEN SQLCODE = -911                                        12160038
121700       WHEN SQLCODE = -913                                        12170038
121800         SET PS-ERROR-RECORD TO TRUE                              12180038
121900       WHEN OTHER                                                 12190038
122000         DISPLAY PV-ABEND-PARAGRAPH                               12200038
122100         PERFORM Z999-SQL-ERROR                                   12210038
122200     END-EVALUATE.                                                12220038
122300                                                                  12230038
122400******************************************************************12240038
122500*  REMOVED PARAGRAPH 3000-SELECT-SKU                   WR# 21361 *12250038
122600******************************************************************12260038
126400******************************************************************12640038
126500*  ADDED NEW PARAGRAPH 3000-CALL-XLKUT-DOMAIN-PGM      WR# 21361 *12650038
126600******************************************************************12660038
126700 3000-CALL-XLKUT-DOMAIN-PGM.                                      12670038
126800     MOVE '3000-CALL-XLKUT-DOMAIN-PGM'                            12680038
126900                                 TO PV-ABEND-PARAGRAPH.           12690038
127000     INITIALIZE XL001-ITEM-COMMAREA.                              12700038
127100                                                                  12710038
127200     MOVE SHUUPC-UPC-NBR  TO XL001-KEY-UPC-NBR.                   12720038
127300                                                                  12730038
127400     SET XL001-BY-UPC-NBR TO TRUE.                                12740038
127500                                                                  12750038
127600     SET XL001-SELECT-SKU                                         12760038
127700         XL001-SELECT-VND-STYL                                    12770038
127800         XL001-SELECT-UPC TO TRUE.                                12780038
127900                                                                  12790038
128000     CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA.                12800038
128100                                                                  12810038
128300                                                                  12830038
128400     EVALUATE TRUE                                                12840038
128500       WHEN XL001-UPC-SQLCODE = ZEROS                             12850043
128600         PERFORM 3100-INTERROGATE-SKU-SQLCODE                     12860038
128700       WHEN XL001-UPC-SQLCODE = +100                              12870043
128800         MOVE '000'      TO XL001-DEPT-NBR-3CH                    12880038
128900         MOVE '00'       TO XL001-SUB-CL-NBR-2CH                  12890038
129000         MOVE ZEROS      TO XL001-SKU-NBR                         12900038
129100         MOVE PC-NO-SKU            TO DL1-SKU                     12910038
129200       WHEN XL001-UPC-SQLCODE = -904                              12920043
129300       WHEN XL001-UPC-SQLCODE = -911                              12930043
129400       WHEN XL001-UPC-SQLCODE = -913                              12940043
129500         SET PS-ERROR-RECORD TO TRUE                              12950038
129600       WHEN OTHER                                                 12960038
129700         DISPLAY PV-ABEND-PARAGRAPH                               12970038
129800         PERFORM Z999-SQL-ERROR                                   12980038
129900     END-EVALUATE.                                                12990038
130000                                                                  13000038
130100 3100-INTERROGATE-SKU-SQLCODE.                                    13010038
130200     MOVE '3100-INTERROGATE-SKU-SQLCODE'                          13020038
130300                                 TO PV-ABEND-PARAGRAPH.           13030038
130400                                                                  13040038
130600                                                                  13060038
130700     EVALUATE TRUE                                                13070038
130800       WHEN XL001-SKU-SQLCODE = ZEROS                             13080043
130810         MOVE XL001-SKU-NBR        TO PV-SKU-NBR                  13081043
130900         PERFORM 3200-INTERROGATE-VND-SQLCODE                     13090038
130910         MOVE PV-SKU               TO DL1-SKU                     13091044
131000       WHEN XL001-SKU-SQLCODE = +100                              13100043
131100         MOVE '000'      TO XL001-DEPT-NBR-3CH                    13110038
131200         MOVE '00'       TO XL001-SUB-CL-NBR-2CH                  13120038
131300         MOVE ZEROS      TO XL001-SKU-NBR                         13130038
131400         MOVE PC-NO-SKU            TO DL1-SKU                     13140038
131500       WHEN XL001-SKU-SQLCODE = -904                              13150043
131600       WHEN XL001-SKU-SQLCODE = -911                              13160043
131700       WHEN XL001-SKU-SQLCODE = -913                              13170043
131800         SET PS-ERROR-RECORD TO TRUE                              13180038
131900       WHEN OTHER                                                 13190038
132000         DISPLAY PV-ABEND-PARAGRAPH                               13200038
132100         PERFORM Z999-SQL-ERROR                                   13210038
132200     END-EVALUATE.                                                13220038
132300                                                                  13230038
132400 3200-INTERROGATE-VND-SQLCODE.                                    13240038
132500     MOVE '3200-INTERROGATE-VND-SQLCODE'                          13250038
132600                                 TO PV-ABEND-PARAGRAPH.           13260038
132700                                                                  13270038
133000     EVALUATE TRUE                                                13300038
133100       WHEN XL001-VND-STYL-SQLCODE = ZEROS                        13310043
133200         MOVE XL001-DEPT-NBR-3CH   TO PV-SKU-DEPT                 13320038
133300         MOVE XL001-SUB-CL-NBR-2CH TO PV-SKU-CLASS                13330038
133600       WHEN XL001-VND-STYL-SQLCODE = +100                         13360043
133700         MOVE '000'                TO XL001-DEPT-NBR-3CH          13370038
133800         MOVE '00'                 TO XL001-SUB-CL-NBR-2CH        13380038
134100       WHEN XL001-VND-STYL-SQLCODE = -904                         13410043
134200       WHEN XL001-VND-STYL-SQLCODE = -911                         13420043
134300       WHEN XL001-VND-STYL-SQLCODE = -913                         13430043
134400         SET PS-ERROR-RECORD TO TRUE                              13440038
134500       WHEN OTHER                                                 13450038
134600         DISPLAY PV-ABEND-PARAGRAPH                               13460038
134700         PERFORM Z999-SQL-ERROR                                   13470038
134800     END-EVALUATE.                                                13480038
134900******************************************************************13490038
135000*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *13500041
135100******************************************************************13510038
135200                                                                  13520038
135300*                                                                 13530038
135400 7000-WRITE-ERROR-REPORT.                                         13540038
135500******************************************************************13550038
135600*  PRINT THE ERROR REPORT WHEN THE EXTRACT FILE HAS AN ERROR REC *13560038
135700******************************************************************13570038
135800     PERFORM 8200-WRITE-TOP-LINE.                                 13580038
135900*                                                                 13590038
136000     WRITE SU-CARTON-NOT-RCVD-RECORD                              13600038
136100       FROM HEADING-LINE-0                                        13610038
136200         AFTER ADVANCING 1 LINE.                                  13620038
136300*                                                                 13630038
136400     WRITE SU-CARTON-NOT-RCVD-RECORD                              13640038
136500       FROM HEADING-LINE-1                                        13650038
136600         AFTER ADVANCING 1 LINE.                                  13660038
136700*                                                                 13670038
136800     WRITE SU-CARTON-NOT-RCVD-RECORD                              13680038
136900       FROM HEADING-LINE-1A                                       13690038
137000         AFTER ADVANCING 1 LINE.                                  13700038
137100*                                                                 13710038
137200     WRITE SU-CARTON-NOT-RCVD-RECORD                              13720038
137300       FROM HEADING-LINE-1B                                       13730038
137400         AFTER ADVANCING 1 LINE.                                  13740038
137500*                                                                 13750038
137600     WRITE SU-CARTON-NOT-RCVD-RECORD                              13760038
137700       FROM HEADING-LINE-2                                        13770038
137800         AFTER ADVANCING 4 LINES.                                 13780038
137900*                                                                 13790038
138000     IF SU001-DETAIL-RECORD                                       13800038
138100         WRITE SU-CARTON-NOT-RCVD-RECORD                          13810038
138200           FROM EL1-ERROR-LINE-1P                                 13820038
138300             AFTER ADVANCING 3 LINES                              13830038
138400                                                                  13840038
138500         WRITE SU-CARTON-NOT-RCVD-RECORD                          13850038
138600           FROM EL2-ERROR-LINE-2P                                 13860038
138700             AFTER ADVANCING 2 LINES                              13870038
138800     ELSE                                                         13880038
138900         WRITE SU-CARTON-NOT-RCVD-RECORD                          13890038
139000           FROM EL1-ERROR-LINE-1F                                 13900038
139100             AFTER ADVANCING 3 LINES                              13910038
139200                                                                  13920038
139300         WRITE SU-CARTON-NOT-RCVD-RECORD                          13930038
139400           FROM EL2-ERROR-LINE-2F                                 13940038
139500             AFTER ADVANCING 2 LINES                              13950038
139600     END-IF.                                                      13960038
139700*                                                                 13970038
139800     WRITE SU-CARTON-NOT-RCVD-RECORD                              13980038
139900       FROM EL3-ERROR-LINE-3                                      13990038
140000         AFTER ADVANCING 2 LINES.                                 14000038
140100*                                                                 14010038
140200     MOVE CC-REQUESTOR-ID TO EL4-REQUESTOR-ID                     14020038
140300     MOVE CC-PRINTER-ID   TO EL4-PRINTER-ID.                      14030038
140400     WRITE SU-CARTON-NOT-RCVD-RECORD                              14040038
140500       FROM EL4-ERROR-LINE-4                                      14050038
140600         AFTER ADVANCING 3 LINES.                                 14060038
140700*                                                                 14070038
140800     WRITE SU-CARTON-NOT-RCVD-RECORD                              14080038
140900       FROM EL5-ERROR-LINE-5                                      14090038
141000         AFTER ADVANCING 2 LINE.                                  14100038
141100*JPL                                                              14110038
141200     WRITE SU-CARTON-NOT-RCVD-RECORD                              14120038
141300       FROM EL5-ERROR-LINE-5B                                     14130038
141400         AFTER ADVANCING 2 LINE.                                  14140038
141500*                                                                 14150038
141600     MOVE CC-PRINT-SUKRP002-IND TO EL6-SUKRP002-IND.              14160038
141700     MOVE CC-PRINT-SUKRP003-IND TO EL6-SUKRP003-IND.              14170038
141800     MOVE CC-PRINT-SUKRP004-IND TO EL6-SUKRP004-IND.              14180038
141900     MOVE CC-PRINT-SUKRP005-IND TO EL6-SUKRP005-IND.              14190038
142000     MOVE CC-PRINT-SUKRP006-IND TO EL6-SUKRP006-IND.              14200038
142100     MOVE CC-PRINT-SUKRP007-IND TO EL6-SUKRP007-IND.              14210038
142200     MOVE CC-PRINT-SUKRP008-IND TO EL6-SUKRP008-IND.              14220038
142300*JPL                                                              14230038
142400     MOVE CC-PRINT-SUKRP023-IND TO EL6-SUKRP023-IND.              14240038
142500                                                                  14250038
142600*JPL WRITE SU-CARTON-NOT-RCVD-RECORD                              14260038
142700*JPL   FROM EL6-ERROR-LINE-6                                      14270038
142800*JPL     AFTER ADVANCING 1 LINE.                                  14280038
142900*JPL                                                              14290038
143000     WRITE SU-CARTON-NOT-RCVD-RECORD                              14300038
143100       FROM EL6-ERROR-LINE-6B                                     14310038
143200         AFTER ADVANCING 1 LINE.                                  14320038
143300*                                                                 14330038
143400     WRITE SU-CARTON-NOT-RCVD-RECORD                              14340038
143500       FROM END-OF-REPORT-LINE                                    14350038
143600         AFTER ADVANCING 6 LINES.                                 14360038
143700*                                                                 14370038
143800 8000-WRITE-REPORT-HEADERS.                                       14380038
143900******************************************************************14390038
144000*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.  SEBSEQUENT   *14400038
144100*  PAGES FOR THE SAME ASN DO NOT REPEAT ALL OF THE HEADING INFO. *14410038
144200******************************************************************14420038
144300     SET PS-PRT-HEADING TO TRUE.                                  14430038
144400                                                                  14440038
144500     PERFORM 8200-WRITE-TOP-LINE.                                 14450038
144600*                                                                 14460038
144700     WRITE SU-CARTON-NOT-RCVD-RECORD                              14470038
144800       FROM HEADING-LINE-0                                        14480038
144900         AFTER ADVANCING 1 LINE.                                  14490038
145000*                                                                 14500038
145100     WRITE SU-CARTON-NOT-RCVD-RECORD                              14510038
145200       FROM HEADING-LINE-1                                        14520038
145300         AFTER ADVANCING 1 LINE.                                  14530038
145400*                                                                 14540038
145500     WRITE SU-CARTON-NOT-RCVD-RECORD                              14550038
145600       FROM HEADING-LINE-1A                                       14560038
145700         AFTER ADVANCING 1 LINE.                                  14570038
145800*                                                                 14580038
145900     WRITE SU-CARTON-NOT-RCVD-RECORD                              14590038
146000       FROM HEADING-LINE-1B                                       14600038
146100         AFTER ADVANCING 1 LINE.                                  14610038
146200*                                                                 14620038
146300     WRITE SU-CARTON-NOT-RCVD-RECORD                              14630038
146400       FROM HEADING-LINE-2                                        14640038
146500         AFTER ADVANCING 1 LINE.                                  14650038
146600*                                                                 14660038
146700     WRITE SU-CARTON-NOT-RCVD-RECORD                              14670038
146800       FROM HEADING-LINE-3                                        14680038
146900         AFTER ADVANCING 2 LINES.                                 14690038
147000*                                                                 14700038
147100     WRITE SU-CARTON-NOT-RCVD-RECORD                              14710038
147200       FROM HEADING-LINE-4                                        14720038
147300         AFTER ADVANCING 2 LINES.                                 14730038
147400*                                                                 14740038
147500     WRITE SU-CARTON-NOT-RCVD-RECORD                              14750038
147600       FROM HEADING-LINE-5                                        14760038
147700         AFTER ADVANCING 1 LINE.                                  14770038
147800*                                                                 14780038
147900     MOVE PC-11                   TO PV-LINE-CNT.                 14790038
148000*                                                                 14800038
148100*                                                                 14810038
148200 8200-WRITE-TOP-LINE.                                             14820038
148300******************************************************************14830038
148400*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *14840038
148500*     NEEDED FOR AN ASN NUMBER.                                  *14850038
148600******************************************************************14860038
148700     ADD 1                        TO PV-PAGE-CNT.                 14870038
148800*                                                                 14880038
148900     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          14890038
149000*                                                                 14900038
149100     WRITE SU-CARTON-NOT-RCVD-RECORD                              14910038
149200       FROM DP132O-STANDRD-HEADER-132-COLS                        14920038
149300         AFTER ADVANCING PAGE.                                    14930038
149400*                                                                 14940038
149500*                                                                 14950038
149600 8400-WRITE-DETAIL-LINES.                                         14960038
149700******************************************************************14970038
149800*     WRITES THE DETAIL LINE INFORMATION.                        *14980038
149900******************************************************************14990038
150000     IF DL1-PO-RECEIVER = PV-SAVE-PO-RECEIVER                     15000038
150100         MOVE SPACES TO DL1-PO-RECEIVER                           15010038
150200         IF PV-SERIAL-SHIP-CODE = PV-SAVE-SHIP-CODE               15020038
150300             MOVE SPACES TO DL1-SCAC                              15030038
150400             MOVE SPACES TO DL1-TRAILER                           15040038
150500             MOVE SPACES TO DL1-SCAN-DATE                         15050038
150600             MOVE PC-1 TO PV-LINE-SUB                             15060038
150700             MOVE SPACES TO DL1-SERIAL-SHIP-CODE                  15070038
150800             MOVE SPACES TO DL1-STORE-NBR                         15080038
150900             IF DL1-LINE-NBR-RDF   = PV-SAVE-LINE-NBR             15090038
151000                MOVE SPACES TO DL1-LINE-NBR-RDF                   15100038
151100             ELSE                                                 15110038
151200                MOVE DL1-LINE-NBR-RDF   TO PV-SAVE-LINE-NBR       15120038
151300             END-IF                                               15130038
151400         ELSE                                                     15140038
151500             PERFORM 2600-SELECT-SHUNLO                           15150038
151600             IF PS-DETAIL-RECORD                                  15160038
151700                 MOVE PC-2 TO PV-LINE-SUB                         15170038
151800                 MOVE PV-SERIAL-SHIP-CODE  TO PV-SAVE-SHIP-CODE   15180038
151900                 MOVE DL1-LINE-NBR-RDF     TO PV-SAVE-LINE-NBR    15190038
152000                 ADD +1 TO PV-CART-MISSING                        15200038
152100             END-IF                                               15210038
152200         END-IF                                                   15220038
152300     ELSE                                                         15230038
152400         IF PS-FIRST-LINE                                         15240038
152500            SET PS-NOT-FIRST-LINE TO TRUE                         15250038
152600         ELSE                                                     15260038
152700            PERFORM 8500-PRINT-RCVR-TOT                           15270038
152800            PERFORM 8000-WRITE-REPORT-HEADERS                     15280038
152900         END-IF                                                   15290038
153000         PERFORM 2600-SELECT-SHUNLO                               15300038
153100         IF PS-DETAIL-RECORD                                      15310038
153200             MOVE PC-2 TO PV-LINE-SUB                             15320038
153300             MOVE DL1-PO-RECEIVER      TO PV-SAVE-PO-RECEIVER     15330038
153400             MOVE PV-SERIAL-SHIP-CODE  TO PV-SAVE-SHIP-CODE       15340038
153500             MOVE DL1-LINE-NBR-RDF     TO PV-SAVE-LINE-NBR        15350038
153600             ADD +1 TO PV-CART-MISSING                            15360038
153700         END-IF                                                   15370038
153800     END-IF.                                                      15380038
153900                                                                  15390038
154000     IF PS-DETAIL-RECORD                                          15400038
154100         IF PS-PRT-HEADING                                        15410038
154200            MOVE PV-SAVE-PO-RECEIVER TO DL1-PO-RECEIVER           15420038
154300            SET PS-NOT-PRT-HEADING TO TRUE                        15430038
154400         END-IF                                                   15440038
154500         WRITE SU-CARTON-NOT-RCVD-RECORD                          15450038
154600           FROM DETAIL-LINE1                                      15460038
154700             AFTER ADVANCING PV-LINE-SUB LINES                    15470038
154800         ADD PV-LINE-SUB                 TO PV-LINE-CNT           15480038
154900     END-IF.                                                      15490038
155000*                                                                 15500038
155100 8500-PRINT-RCVR-TOT.                                             15510038
155200******************************************************************15520038
155300*     WRITES RECEIVER TOTAL LINE WHICH DISPLAY NUMBER OF CARTONS *15530038
155400*     MISSING FOR THE RECEIVER.                                   15540038
155500******************************************************************15550038
155600*                                                                 15560038
155700     MOVE PV-CART-MISSING TO TOT-CART-MISSING.                    15570038
155800                                                                  15580038
155900     WRITE SU-CARTON-NOT-RCVD-RECORD                              15590038
156000       FROM RECEIVER-TOT-LNE                                      15600038
156100         AFTER ADVANCING 2 LINES.                                 15610038
156200                                                                  15620038
156300     ADD 2 TO PV-LINE-CNT.                                        15630038
156400                                                                  15640038
156500     INITIALIZE PV-CART-MISSING.                                  15650038
156600                                                                  15660038
156700     WRITE SU-CARTON-NOT-RCVD-RECORD                              15670038
156800       FROM BLANK-LNE                                             15680038
156900         AFTER ADVANCING 1 LINES.                                 15690038
157000                                                                  15700038
157100     ADD 1 TO PV-LINE-CNT.                                        15710038
157200                                                                  15720038
157300******************************************************************15730038
157400*     SQL WARNING OR ERROR PROCESSING                            *15740038
157500*                                                                *15750038
157600******************************************************************15760038
157700                                                                  15770038
157800*                                                                 15780038
157900 Z999-SQL-ERROR.                                                  15790038
158000*---------------                                                  15800038
158100                                                                  15810038
158200     MOVE SQLCODE    TO SQLCODE2.                                 15820038
158300     MOVE SQLERRD(3) TO SQLERRD3.                                 15830038
158400     DISPLAY '** ABEND **       ** = SQLERROR'.                   15840038
158500     DISPLAY '** PROGRAM        ** = SUKRP003'.                   15850038
158600     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  15860038
158700     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  15870038
158800     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   15880038
158900     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  15890038
159000     EXEC SQL                                                     15900038
159100         COMMIT                                                   15910038
159200     END-EXEC.                                                    15920038
159300     MOVE +4013 TO PV-ABEND-CODE.                                 15930038
159400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         15940038
