000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKUT703.                                00050000
000600 AUTHOR.                 LARRY SCHLEICHER.                        00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            MAY, 2003.                               00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS PROGRAM WILL CREATE A NEW RECEIVER FOR A FREE-ASTRAY       00120000
001300* CARTON.                                                         00130000
001400******************************************************************00140000
001410* CHANGED 12-19-2011 CHRISTINE TWIEHAUS    WR40574                00141038
001420*         ADDED CARR-AUTH-ID (CAN) TO TAUSHIP AND TSHIPMT         00142037
001500*                                                                 00150037
001600******************************************************************00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800******************************************************************00180000
001900                                                                  00190000
002000******************************************************************00200000
002100 DATA DIVISION.                                                   00210000
002200******************************************************************00220000
002300                                                                  00230000
002400******************************************************************00240000
002500 WORKING-STORAGE SECTION.                                         00250000
002600******************************************************************00260000
002700                                                                  00270000
002800                                                                  00280000
002900*----------------------------------------------------------------*00290000
003000*    COPYBOOK FOR THE FIELDS PASSED TO THE TROUBLE SUBROUTINE     00300000
003100*----------------------------------------------------------------*00310000
003200     COPY TMWS500.                                                00320000
003300                                                                  00330000
003400*----------------------------------------------------------------*00340000
003500*  COPYBOOK FOR RANDOM NUMBER GENERATOR DPKUT902                 *00350074
003600*----------------------------------------------------------------*00360000
003700     COPY DPWS902.                                                00370073
003800                                                                  00380000
003900*----------------------------------------------------------------*00390000
004000*  WORK AREA PASSED IN CALL TO DPKUT500                          *00400000
004100*----------------------------------------------------------------*00410000
004200     COPY DPWS500.                                                00420000
004300                                                                  00430000
004400*----------------------------------------------------------------*00440000
004500*    ABEND PROCESSING COPYBOOK.                                  *00450000
004600*----------------------------------------------------------------*00460000
004700     COPY DPWS013.                                                00470000
004800                                                                  00480000
004900***************************************************************** 00490000
005000*    STANDARD COMMAREA.                                           00500000
005100***************************************************************** 00510000
005200                                                                  00520000
005300     COPY DPWS020.                                                00530000
005400                                                                  00540000
005500     COPY RCWS031.                                                00550000
005600                                                                  00560000
005700     COPY DPWS017.                                                00570000
005800*----------------------------------------------------------------*00580000
005900*    COPY BOOK FOR CALENDAR SUBROUTINE (DPKUT500)                 00590000
006000*----------------------------------------------------------------*00600000
006100                                                                  00610000
006200     COPY DPWS500.                                                00620000
006300                                                                  00630000
006400******************************************************************00640000
006500*  COMMAREA LAYOUT FROM THE FREE ASTRAY HANDLER (SUKUT705)       *00650000
006600******************************************************************00660000
006700     COPY SUWS044.                                                00670000
006800******************************************************************00680000
006900 01  DN-DB2-NULL-INDICATORS.                                      00690000
007000     05  DN-TRIP-ID                   PIC S9(04) COMP VALUE +0.   00700000
007100     05  DN-EST-AR-TMST               PIC S9(04) COMP VALUE +0.   00710000
007200*                                                                 00720000
007300 01  DK-DB2-KEYS.                                                 00730000
007400     05  DK-PO-NBR                    PIC S9(09) COMP VALUE +0.   00740000
007500     05  DK-REC-SEQ-NBR               PIC S9(09) COMP VALUE +0.   00750000
007600     05  DK-SCAC-ID                   PIC X(04)  VALUE SPACES.    00760000
007700     05  DK-VEH-NBR                   PIC X(10)  VALUE SPACES.    00770000
007800     05  DK-OPER-UNT-ID               PIC S9(04) COMP VALUE +0.   00780000
007801* RPK - 5/31/2018 - START                                         00780172
007810     05  DK-FAOPER-UNT-ID             PIC S9(04) COMP VALUE +0.   00781070
007820* RPK - 5/31/2018 - END                                           00782072
007900     05  DK-FCLTY-ID                  PIC S9(04) COMP VALUE +0.   00790000
008000     05  DK-SHIPT-UNT-ID              PIC S9(18) COMP-3.          00800000
008100     05  DK-CURR-SHIPT-ID             PIC S9(09) VALUE +0         00810000
008200                                              COMP.               00820000
008300     05  DK-OPER-SET-ID               PIC S9(04) COMP VALUE +0.   00830000
008400     05  DK-AGRMT-TYP-ID              PIC X(01)  VALUE SPACES.    00840000
008500     05  DK-TYP-CDE                   PIC S9(04) COMP VALUE +0.   00850000
008600     05  DK-DEPT-NBR                  PIC X(03)  VALUE SPACES.    00860000
008700                                                                  00870000
008800 01  PC-PROGRAM-CONSTANTS.                                        00880000
008900     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3 COMP.     00890000
009000     05  PC-TMKCS520               PIC X(08)  VALUE  'TMKCS520'.  00900000
009100     05  PC-RANDNBR-PGM           PIC  X(08)  VALUE  'DPKUT902'.  00910073
009200     05  PC-TROUBLE-RTN           PIC X(08)   VALUE  'TMKCS520'.  00920000
009300     05  PC-TROUBLE-RTN-LENGTH    PIC S9(04)  VALUE +600 COMP.    00930000
009400     05  PC-DEFAULT-TMST           PIC X(26)  VALUE               00940000
009500                                  '9999-09-09-09.09.09.999999'.   00950000
009600     05  PC-PCKCS756               PIC X(08)  VALUE 'PCKCS756'.   00960000
009700     05  PC-AUDIT-RTN              PIC X(08)  VALUE 'RCKCS290'.   00970000
009800     05  PC-CALENDAR-ROUTINE       PIC X(08)  VALUE 'RCKCS290'.   00980000
009900     05  PC-CURRENT-PROGRAM-NAME   PIC X(08)  VALUE 'SUKUT703'.   00990000
010000     05  PC-AUDIT-RTN-LENGTH       PIC S9(4)  VALUE  +300         01000000
010100                                                COMP SYNC.        01010000
010200     05  PC-DEFAULT-DATE           PIC X(10)  VALUE '0001-01-01'. 01020000
010300     05  PC-DEFAULT-9DATE          PIC X(10)  VALUE '9999-09-09'. 01030000
010400     05  PC-DEFAULT-TIME           PIC X(08)  VALUE '00.00.00'.   01040000
010500     05  PC-RECV-CRE-UID           PIC X(08)  VALUE 'F/A SYTM'.   01050014
010600     05  PC-RECV-CRE-UID-CKIN      PIC X(08)  VALUE 'CHECK-IN'.   01060000
010700                                                                  01070000
010800                                                                  01080000
010900 01  PS-PROGRAM-SWITCHES.                                         01090000
011000     05  PS-TRECVER-CURSOR-SW     PIC  X(01)  VALUE 'N'.          01100000
011100         88  PS-EOF-TRECVER-CSR               VALUE 'Y'.          01110000
011200*    05  PS-MULT-TROUBLE-SW       PIC  X(01)  VALUE 'N'.          01120000
011300*        88  PS-MULT-TROUBLE                  VALUE 'Y'.          01130000
011400*        88  PS-SINGLE-TROUBLE                VALUE 'N'.          01140000
011500     05  PS-RCVR-FOUND-SW         PIC  X(01)  VALUE 'N'.          01150000
011600         88  PS-RCVR-FOUND                    VALUE 'Y'.          01160000
011700         88  PS-NO-RCVR-FOUND                 VALUE 'N'.          01170000
011800     05  PS-TOSOPFA-CURSOR-SW     PIC  X(01)  VALUE 'N'.          01180000
011900         88  PS-EOF-TOSOPFA-CSR               VALUE 'Y'.          01190000
012000     05  PS-INSTRUCTION-SW        PIC  X(01)  VALUE 'N'.          01200000
012100         88  PS-FIRST-INSTRUCTION             VALUE 'Y'.          01210000
012200     05  PS-LOG-MESSAGE-SW              PIC  X       VALUE 'N'.   01220018
012300         88  PS-LOG-MESSAGE                          VALUE 'Y'.   01230016
012400         88  PS-NO-LOG-MESSAGE                       VALUE 'N'.   01240016
012500                                                                  01250000
012600                                                                  01260000
012700     05  PS-BEFORE-ONLY-LOGGING-SW      PIC  X       VALUE 'N'.   01270000
012800         88  PS-BEFORE-ONLY-LOGGING                  VALUE 'Y'.   01280000
012900         88  PS-NOT-BEFORE-ONLY-LOGGING              VALUE 'N'.   01290000
013000     05  PS-TRBL-EXISTS-SW              PIC  X       VALUE 'Y'.   01300000
013100         88  PS-NO-TRBL-EXISTS                       VALUE 'N'.   01310000
013200         88  PS-TRBL-EXISTS                          VALUE 'Y'.   01320000
013300     05  PS-NOT-VERIFIED-STATUS-SW      PIC  X       VALUE 'Y'.   01330000
013400         88  PS-NOT-VERIFIED-STATUS                  VALUE 'N'.   01340000
013500         88  PS-VERIFIED-STATUS                      VALUE 'Y'.   01350000
013600     05  PS-OUTBND-CART-FOUND-SW        PIC  X       VALUE 'Y'.   01360000
013700         88  PS-NO-OUTBND-CART-FOUND                 VALUE 'N'.   01370000
013800         88  PS-OUTBND-CART-FOUND                    VALUE 'Y'.   01380000
013900     05  PS-PRE-RECVR-STAT-SW           PIC  X       VALUE 'Y'.   01390000
014000         88  PS-NOT-PRE-RECVR-STAT                   VALUE 'N'.   01400000
014100         88  PS-PRE-RECVR-STAT                       VALUE 'Y'.   01410000
014200     05  PS-DISTHD-FOUND-SW             PIC  X       VALUE 'Y'.   01420000
014300         88  PS-NO-DISTHD-FOUND                      VALUE 'N'.   01430000
014400         88  PS-DISTHD-FOUND                         VALUE 'Y'.   01440000
014500     05  PS-DISTDT-FOUND-SW             PIC  X       VALUE 'Y'.   01450000
014600         88  PS-NO-DISTDT-FOUND                      VALUE 'N'.   01460000
014700         88  PS-DISTDT-FOUND                         VALUE 'Y'.   01470000
014800     05  PS-AUTO-APPLY-SW               PIC  X       VALUE 'Y'.   01480000
014900         88  PS-NO-AUTO-APPLY                        VALUE 'N'.   01490000
015000         88  PS-AUTO-APPLY                           VALUE 'Y'.   01500000
015100     05  PS-USE-EXPECTED-QTY-SW         PIC  X       VALUE 'N'.   01510000
015200         88  PS-DONT-USE-EXPECTED-QTY                VALUE 'N'.   01520000
015300         88  PS-USE-EXPECTED-QTY                     VALUE 'Y'.   01530000
015400     05  PS-ERROR-SW                    PIC  X       VALUE 'N'.   01540000
015500         88  PS-NO-ERROR                             VALUE 'N'.   01550000
015600         88  PS-ERROR                                VALUE 'Y'.   01560000
015700     05  PS-UPDATE-STORE-SW             PIC X(01).                01570000
015800         88  PS-UPDATE-YES                           VALUE 'Y'.   01580000
015900         88  PS-UPDATE-NO                            VALUE 'N'.   01590000
016000     05  PS-STORE-TYPE-SW               PIC  X(01).               01600000
016100         88  PS-NOT-DC-STORE-TYPE                    VALUE 'N'.   01610000
016200         88  PS-DC-STORE-TYPE                        VALUE 'D'.   01620000
016300     05  PS-RECEIVER-FOUND-SW           PIC  X(01)   VALUE 'N'.   01630000
016400         88  PS-RECEIVER-FOUND                       VALUE 'Y'.   01640000
016500         88  PS-RECEIVER-NOT-FOUND                   VALUE 'N'.   01650000
016600     05  PS-LINE-FOUND-SW               PIC  X(01)   VALUE 'N'.   01660000
016700         88  PS-LINE-FOUND                           VALUE 'Y'.   01670000
016800         88  PS-LINE-NOT-FOUND                       VALUE 'N'.   01680000
016900     05  PS-AUDIT-EXISTS-SW             PIC X(01)    VALUE 'N'.   01690000
017000         88  PS-AUDIT-EXISTS                         VALUE 'Y'.   01700000
017100         88  PS-AUDIT-NOT-EXISTS                     VALUE 'N'.   01710000
017200     05  PS-CARTON-FIRST-PASS-SW        PIC X(01)    VALUE 'N'.   01720000
017300         88  PS-CARTON-FIRST-PASS                    VALUE 'Y'.   01730000
017400         88  PS-NOT-CARTON-FIRST-PASS                VALUE 'N'.   01740000
017500     05  PS-AUDIT-FIRST-PASS-SW         PIC X(01)    VALUE 'N'.   01750000
017600         88  PS-AUDIT-FIRST-PASS                     VALUE 'Y'.   01760000
017700         88  PS-NOT-AUDIT-FIRST-PASS                 VALUE 'N'.   01770000
017800     05  PS-SYSTEM-AUDIT-FOUND-SW       PIC X(01)    VALUE 'N'.   01780000
017900         88  PS-SYSTEM-AUDIT-NOT-FOUND               VALUE 'N'.   01790000
018000         88  PS-SYSTEM-AUDIT-FOUND                   VALUE 'Y'.   01800000
018100     05  PS-OVER-SHORT-IND               PIC  X(01)  VALUE 'N'.   01810000
018200         88  PS-OVER-SHORT-ERROR                     VALUE 'Y'.   01820000
018300         88  PS-NO-OVER-SHORT-ERROR                  VALUE 'N'.   01830000
018400     05  PS-CARTON-ITEM-CURSOR-IND       PIC  X(01)  VALUE 'N'.   01840000
018500         88  PS-NOT-EOC-CARTON-ITEM-CURSOR           VALUE 'N'.   01850000
018600         88  PS-EOC-CARTON-ITEM-CURSOR               VALUE 'Y'.   01860000
018700     05  PS-AUDIT-ITEM-CURSOR-IND        PIC  X(01)  VALUE 'N'.   01870000
018800         88  PS-NOT-EOC-AUDIT-ITEM-CURSOR            VALUE 'N'.   01880000
018900         88  PS-EOC-AUDIT-ITEM-CURSOR                VALUE 'Y'.   01890000
019000     05  PS-CARTON-UPC-CURSOR-IND        PIC  X(01)  VALUE 'N'.   01900000
019100         88  PS-NOT-EOC-CARTON-UPC-CURSOR            VALUE 'N'.   01910000
019200         88  PS-EOC-CARTON-UPC-CURSOR                VALUE 'Y'.   01920000
019300     05  PS-AUDIT-UPC-CURSOR-IND         PIC  X(01)  VALUE 'N'.   01930000
019400         88  PS-NOT-EOC-AUDIT-UPC-CURSOR             VALUE 'N'.   01940000
019500         88  PS-EOC-AUDIT-UPC-CURSOR                 VALUE 'Y'.   01950000
019600     05  PS-CARTON-UPC-CHANGE-IND        PIC  X(01)  VALUE 'N'.   01960000
019700         88  PS-CARTON-UPC-CHANGE                    VALUE 'Y'.   01970000
019800         88  PS-NO-CARTON-UPC-CHANGE                 VALUE 'N'.   01980000
019900     05  PS-AUDIT-UPC-CHANGE-IND         PIC  X(01)  VALUE 'N'.   01990000
020000         88  PS-AUDIT-UPC-CHANGE                     VALUE 'Y'.   02000000
020100         88  PS-NO-AUDIT-UPC-CHANGE                  VALUE 'N'.   02010000
020200     05  PS-PRO-BOL-SCAC-EXISTS-SW       PIC  X(01)  VALUE 'N'.   02020004
020300         88  PS-PRO-BOL-SCAC-EXISTS                  VALUE 'Y'.   02030004
020400         88  PS-PRO-BOL-SCAC-NOT-EXISTS              VALUE 'N'.   02040004
020410     05  PS-BLD-INTERNAL-TABLE-SW     PIC  X(01) VALUE 'N'.       02041040
020420         88  PS-BLD-INTERNAL-TABLE-YES           VALUE 'Y'.       02042040
020430         88  PS-BLD-INTERNAL-TABLE-NO            VALUE 'N'.       02043040
020431* RPK - 5/31/2018 - START                                         02043172
020440     05  PS-FREE-ASTRAY-OPER-SW          PIC  X(01)  VALUE 'N'.   02044070
020450         88  PS-FREE-ASTRAY-OPER-NEW                 VALUE 'Y'.   02045070
020460         88  PS-FREE-ASTRAY-OPER-OLD                 VALUE 'N'.   02046070
020470* RPK - 5/31/2018 - END                                           02047072
020500                                                                  02050000
020600 01  PV-PROGRAM-VARIABLES.                                        02060000
020700     05  PV-TRN-CDE               PIC X(1)    VALUE SPACES.       02070000
020800     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            02080000
020900                                              COMP SYNC.          02090000
021000     05  PV-SHIPMT-COUNT          PIC S9(09)  VALUE +0            02100000
021100                                              COMP-3.             02110000
021200     05  PV-DISP-SQLCODE          PIC -9(03) VALUE ZEROES.        02120046
021300     05  PV-DISP-PO-NBR           PIC  9(09).                     02130000
021400     05  PV-DISP-TYP-CDE          PIC  9(04).                     02140000
021500     05  PV-DISP-WO-SEQ-NBR       PIC  9(04).                     02150000
021600     05  PV-DISP-WO-INSTR-SEQ-NBR PIC  9(04).                     02160000
021700     05  PV-DISP-SHIPT-ID         PIC  9(18).                     02170000
021800     05  PV-DISP-TRIP-ID          PIC  9(09).                     02180000
021900     05  PV-DISP-REC-SEQ          PIC  9(09).                     02190000
022000     05  PV-DISP-OPER-UNT-ID      PIC  9(04).                     02200000
022100     05  PV-DISP-FCLTY-ID         PIC  9(04).                     02210000
022200     05  PV-DISP-OPER-SET         PIC  9(04).                     02220000
022300     05  PV-DISP-FINCL-ADJ-ID            PIC  9(09) VALUE ZEROES. 02230000
022400     05  PV-DISPLAY-UPC-NBR              PIC   9(15).             02240000
022500     05  PV-DISPLAY-INTR-UPC             PIC   9(9).              02250000
022600     05  PV-DISPLAY-ADJ-ERR-CDE          PIC   9(04).             02260000
022700     05  PV-DISP-SHIPT-UNT-ID            PIC 9(18).               02270000
022800     05  PV-DISP-RCVR-SEQ-NBR            PIC 9(09).               02280000
022900     05  PV-DISP-LNE-NBR                 PIC 9(09).               02290000
023000     05  PV-DISP-TRN-TYP-CDE             PIC X(02).               02300000
023100     05  PV-DISP-UPC-NBR                 PIC 9(15).               02310000
023200     05  PV-DISP-STR-NBR                 PIC 9(04).               02320000
023210     05  PV-DISP-DEST-STR                PIC 9(04).               02321049
023300     05  PV-DISPLAY-CICS-RESP            PIC 999999999-           02330000
023400                                                 VALUE ZEROS.     02340000
023500     05  PV-REC-SEQ-NBR           PIC S9(09) COMP VALUE +0.       02350000
023600     05  PV-CURR-SHIPT-ID         PIC S9(09)  VALUE +0            02360000
023700                                              COMP.               02370000
023800     05  PV-TROUBLE-DESC-ALL.                                     02380000
023900         10  PV-TROUBLE-DESC      PIC X(09).                      02390000
024000         10  PV-TROUBLE-ASTERICK  PIC X(01)   VALUE '*'.          02400000
024100     05  PV-COUNT                 PIC S9(09)  VALUE +0            02410000
024200                                              COMP-3.             02420000
024300     05  PV-PKGNG-CDE            PIC X(01).                       02430000
024400     05  PV-PACK-BY-ST-IND       PIC X(01).                       02440000
024500     05  PV-PRE-TICKET-IND       PIC X(01).                       02450000
024600     05  PV-HANGER-IND           PIC X(01).                       02460000
024700     05  PV-DB2-COUNT             PIC S9(09)  VALUE +0            02470000
024800                                              COMP-3.             02480000
024900     05  PV-WO-INSTR-SEQ-NBR      PIC S9(04)  VALUE +0 COMP.      02490000
025000     05  PV-OPER-SET-ID           PIC S9(04) COMP VALUE +0.       02500000
025100     05  PV-VER-NBR               PIC S9(09) COMP.                02510000
025200                                                                  02520000
025500     05  PV-BOL-NBR               PIC  X(30).                     02550000
025600     05  PV-NOTIF-NBR                    PIC S9(9) VALUE ZERO     02560000
025700                                                COMP SYNC.        02570000
025800     05  PV-CYC-ADJ-NBR                  PIC S9(9) VALUE ZERO     02580000
025900                                                COMP SYNC.        02590000
026000     05  PV-ARRVD-TIMESTAMP              PIC X(26)   VALUE SPACES.02600010
026010                                                                  02601053
026100     05  PV-CURRENT-TIMESTAMP            PIC X(26)   VALUE SPACES.02610010
026101**                                                                02610153
026107**   05  PV-CURRENT-TIME                 PIC  X(08).              02610753
026108**   05  FILLER REDEFINES PV-CURRENT-TIME.                        02610853
026109**       10  PV-CURRENT-TIME-HH          PIC  9(02).              02610953
026110**       10  PV-CURRENT-TIME-FILL-1      PIC  X(01).              02611053
026111**       10  PV-CURRENT-TIME-MM          PIC  9(02).              02611153
026112**       10  PV-CURRENT-TIME-FILL-2      PIC  X(01).              02611253
026113**       10  PV-CURRENT-TIME-SS          PIC  9(02).              02611353
026114**   05  PV-FORMAT-DATE.                                          02611453
026115**       10  PV-FORMAT-DATE-YY           PIC  9(02).              02611553
026116**       10  PV-FORMAT-DATE-MM           PIC  9(02).              02611653
026117**       10  PV-FORMAT-DATE-DD           PIC  9(02).              02611753
026118**   05  PV-CURRENT-DATE                 PIC  X(10).              02611853
026119**   05  FILLER REDEFINES PV-CURRENT-DATE.                        02611953
026120**       10  PV-CURRENT-DATE-CC          PIC  9(02).              02612053
026121**       10  PV-CURRENT-DATE-YY          PIC  9(02).              02612153
026122**       10  PV-CURRENT-DATE-FILL-1      PIC  X(01).              02612253
026123**       10  PV-CURRENT-DATE-MM          PIC  9(02).              02612353
026124**       10  PV-CURRENT-DATE-FILL-2      PIC  X(01).              02612453
026125**       10  PV-CURRENT-DATE-DD          PIC  9(02).              02612553
026200**   05  PV-FORMAT-TIME                  PIC X(06).               02620053
026300**   05  FILLER REDEFINES PV-FORMAT-TIME.                         02630053
026400**       10  PV-FORMAT-TIME-HH           PIC  9(02).              02640053
026500**       10  PV-FORMAT-TIME-MM           PIC  9(02).              02650053
026600**       10  PV-FORMAT-TIME-SS           PIC  9(02).              02660053
028501**                                                                02850153
028510     05  PV-CURRENT-TIMESTAMP-1          PIC X(26)   VALUE SPACES.02851053
028511     05  PV-CURRENT-TIMESTAMP-r redefines PV-CURRENT-TIMESTAMP-1. 02851153
028512         10  PV-CURRENT-DATE-CC          PIC  9(02).              02851253
028513         10  PV-CURRENT-DATE-YY          PIC  9(02).              02851353
028514         10  filler                      PIC  X(01).              02851453
028515         10  PV-CURRENT-DATE-MM          PIC  9(02).              02851553
028516         10  filler                      PIC  X(01).              02851653
028517         10  PV-CURRENT-DATE-DD          PIC  9(02).              02851753
028518         10  filler                      pic  x(01).              02851853
028519         10  PV-CURRENT-TIME-HH          PIC  9(02).              02851953
028520         10  filler                      PIC  X(01).              02852053
028521         10  PV-CURRENT-TIME-MM          PIC  9(02).              02852153
028522         10  filler                      PIC  X(01).              02852253
028523         10  PV-CURRENT-TIME-SS          PIC  9(02).              02852353
028524         10  filler                      PIC  X(01).              02852453
028525         10  PV-CURRENT-TIME-HS          PIC  9(02).              02852553
028526         10  filler                      PIC  X(04).              02852653
028530                                                                  02853053
028531     05  PV-FORMAT-DATE                  pic  9(06).              02853153
028532     05  PV-FORMAT-DATE-redef redefines pv-format-date.           02853253
028533         10  PV-FORMAT-DATE-YY           PIC  9(02).              02853353
028534         10  PV-FORMAT-DATE-MM           PIC  9(02).              02853453
028535         10  PV-FORMAT-DATE-DD           PIC  9(02).              02853553
028536                                                                  02853653
028540     05  PV-FORMAT-TIME                  PIC  9(08).              02854053
028550     05  pv-format-time-redef rEDEFINES PV-FORMAT-TIME.           02855053
028560         10  PV-FORMAT-TIME-HH           PIC  9(02).              02856053
028570         10  PV-FORMAT-TIME-MM           PIC  9(02).              02857053
028580         10  PV-FORMAT-TIME-SS           PIC  9(02).              02858053
028581         10  PV-FORMAT-TIME-HS           PIC  9(02).              02858153
028590                                                                  02859053
028591* RPK - 5/31/2018 - START                                         02859172
028592     05  PV-PARM-TEXT-CORP-FAOPER        PIC X(01)   VALUE SPACE. 02859270
028593     05  PV-PARM-TEXT-DC-FAOPER          PIC X(01)   VALUE SPACE. 02859370
028594* RPK - 5/31/2018 - END                                           02859472
028600     05  PV-CASEPACK-DELETED-IND         PIC X(01)   VALUE 'N'.   02860000
028700     05  PV-LK-DTE-ISO.                                           02870000
028800         10  PV-LK-DTE-CCYY              PIC  X(04)  VALUE SPACE. 02880000
028900         10  PV-LK-DTE-MO                PIC  X(02)  VALUE SPACE. 02890000
029000         10  PV-LK-DTE-DD                PIC  X(02)  VALUE SPACE. 02900000
029100     05  PV-ACTL-CTOFF-YYYYMMDD          PIC  X(08).              02910000
029200     05  PV-VERIFY-DTE-YYYYMMDD          PIC  X(08).              02920000
029300     05  PV-CURRENT-DTE-YYYYMMDD         PIC  X(08).              02930000
029400     05  PV-RECEIPT-DTE-YYYYMMDD        PIC  X(08).               02940000
029500     05  PV-DB2-INV-FORMAT               PIC X(10).               02950000
029600     05  PV-BEFORE-QTY                   PIC  S9(9) COMP.         02960000
029700     05  PV-AFTER-QTY                    PIC  S9(9) COMP.         02970000
029800     05  PV-ADJUST-QTY                   PIC  S9(9) COMP.         02980000
029900     05  PV-PO-LNE-NBR                   PIC  S9(9) COMP.         02990000
030000     05  PV-ITM-QTY                      PIC  S9(9) COMP.         03000000
030100     05  PV-ITEM-COUNT-CARTON            PIC S9(09)  VALUE ZERO   03010000
030200                                                     COMP SYNC.   03020000
030300     05  PV-ITEM-COUNT-AUDIT             PIC S9(09)  VALUE ZERO   03030000
030400                                                     COMP SYNC.   03040000
030500     05  PV-AUDIT-INTR-UPC               PIC  S9(9)  COMP.        03050000
030600     05  PV-EXPECT-INTR-UPC              PIC  S9(9)  COMP.        03060000
030700     05  PV-SCND-UNT-QTY                 PIC  S9(9)  COMP.        03070000
030800     05  PV-DIFF-UNT-QTY                 PIC  S9(9)  COMP.        03080000
030900     05  PV-AUDIT-UPC-NBR                PIC  S9(15)V COMP-3.     03090000
031000     05  PV-AUDIT-SHPD-QTY               PIC  S9(9)V COMP-3.      03100000
031100     05  PV-CARTON-UPC-NBR               PIC  S9(15)V COMP-3.     03110000
031200     05  PV-CARTON-SHPD-QTY              PIC  S9(9)V COMP-3.      03120000
031300     05  PV-TODAYS-FISCAL-PERIOD         PIC  9(2).               03130000
031400     05  PV-VERIFY-FISCAL-PERIOD         PIC  9(2).               03140000
031500     05  PV-INPUT-DATE.                                           03150000
031600         10  PV-INPUT-DATE-MM            PIC 9(2)  VALUE ZEROES.  03160000
031700         10  FILLER                      PIC X(1)  VALUE SPACES.  03170000
031800         10  PV-INPUT-DATE-DD            PIC 9(2)  VALUE ZEROES.  03180000
031900         10  FILLER                      PIC X(1)  VALUE SPACES.  03190000
032000         10  PV-INPUT-DATE-CCY           PIC 9(4)  VALUE ZEROES.  03200000
032100     05  PV-COMP-DATE-JULIAN             PIC X(08).               03210000
032200     05  PV-END-DATE-JULIAN              PIC X(08).               03220000
032300     05  PV-VFY-DATE-JULIAN              PIC X(08).               03230000
032400     05  PV-FROM-PARAGRAPH               PIC X(35) VALUE SPACES.  03240000
032500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03250000
032600                                                COMP SYNC.        03260000
032700     05  PV-CICS-RESPONSE                PIC S9(04)  VALUE +0     03270000
032800                                                COMP SYNC.        03280000
032900     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 03290000
033000     05  PV-MISDIRECT-OPER-ID            PIC  9(04) VALUE ZEROES. 03300000
033100     05  PV-MISDIRECT-FA-CREATE-SRCE.                             03310000
033200         10  PV-MIS-FA-CRE-OPER       PIC  X(04)  VALUE SPACE.    03320000
033300         10  PV-MIS-FA-CRE-SYST       PIC  X(04)  VALUE 'PBSM'.   03330026
033400     05  PV-WORK-TMST.                                            03340000
033500         10  PV-WORK-TMST-1.                                      03350000
033600             15  PV-WK-CCYY           PIC  X(04)  VALUE SPACE.    03360000
033700             15  FILLER                   PIC  X(01)  VALUE SPACE.03370000
033800             15  PV-WK-MO                 PIC  X(02)  VALUE SPACE.03380000
033900             15  FILLER                   PIC  X(01)  VALUE SPACE.03390000
034000             15  PV-WK-DA                 PIC  X(02)  VALUE SPACE.03400000
034100         10  PV-WORK-TMST-2.                                      03410000
034200             15  FILLER                   PIC  X(01)  VALUE SPACE.03420000
034300             15  PV-WK-HH                 PIC  X(02)  VALUE SPACE.03430000
034400             15  FILLER                   PIC  X(01)  VALUE SPACE.03440000
034500             15  PV-WK-MM                 PIC  X(02)  VALUE SPACE.03450000
034600             15  FILLER                   PIC  X(01)  VALUE SPACE.03460000
034700             15  PV-WK-SS                 PIC  X(02)  VALUE SPACE.03470000
034800             15  FILLER                   PIC  X(01)  VALUE SPACE.03480000
034900             15  FILLER                   PIC  X(06)  VALUE ZERO. 03490000
035000     05  PV-TMST                      PIC X(26).                  03500000
035100     05  FILLER REDEFINES PV-TMST.                                03510000
035200         10  PV-CCYY                  PIC X(04).                  03520000
035300         10  FILLER                   PIC X(01).                  03530000
035400         10  PV-MM                    PIC X(02).                  03540000
035500         10  FILLER                   PIC X(01).                  03550000
035600         10  PV-DD                    PIC X(02).                  03560000
035700         10  FILLER                   PIC X(01).                  03570000
035800         10  PV-HH                    PIC X(02).                  03580000
035900         10  FILLER                   PIC X(01).                  03590000
036000         10  PV-MIN                   PIC X(02).                  03600000
036100         10  FILLER                   PIC X(01).                  03610000
036200         10  PV-SEC                   PIC X(02).                  03620000
036300         10  FILLER                   PIC X(01).                  03630000
036400         10  FILLER                   PIC X(06).                  03640000
036500*                                                                 03650000
036600     05  PV-22-CURR-PRO-NBR          PIC X(22).                   03660002
036700     05  FILLER REDEFINES PV-22-CURR-PRO-NBR.                     03670002
036800         10  PV-22-CURR-CHAR OCCURS 22 TIMES                      03680002
036900                               INDEXED BY PV-PRO-INDEX.           03690002
037000             15  PV-CURR-CHAR-PRO     PIC X(01).                  03700002
037100*                                                                 03710000
037200     05  PV-VERIFY-CHAR               PIC X(01).                  03720003
037300         88  PV-VALID-CHARACTER      VALUE '0' THRU '9',          03730003
037400                                           'A' THRU 'Z'.          03740003
037500     05  PV-CHAR-COUNT                PIC S9(04)  VALUE ZEROS     03750000
037600                                                    COMP SYNC.    03760000
037700     05  PV-SHIPMT-PRO-NBR               PIC  X(22).              03770000
037800     05  PV-PV-PRO-NBR-22 REDEFINES PV-SHIPMT-PRO-NBR.            03780000
037900         10  PV-PRO-NBR-1                PIC  X(01).              03790000
038000         10  PV-PRO-NBR-2                PIC  X(01).              03800000
038100         10  PV-PRO-NBR-3                PIC  X(01).              03810000
038200         10  PV-PRO-NBR-4                PIC  X(01).              03820000
038300         10  PV-PRO-NBR-5                PIC  X(01).              03830000
038400         10  PV-PRO-NBR-6                PIC  X(01).              03840000
038500         10  PV-PRO-NBR-7                PIC  X(01).              03850000
038600         10  PV-PRO-NBR-8                PIC  X(01).              03860000
038700         10  PV-PRO-NBR-9                PIC  X(01).              03870000
038800         10  PV-PRO-NBR-10               PIC  X(01).              03880000
038900         10  PV-PRO-NBR-11               PIC  X(01).              03890000
039000         10  PV-PRO-NBR-12               PIC  X(01).              03900000
039100         10  PV-PRO-NBR-13               PIC  X(01).              03910000
039200         10  PV-PRO-NBR-14               PIC  X(01).              03920000
039300         10  PV-PRO-NBR-15               PIC  X(01).              03930000
039400         10  PV-PRO-NBR-16               PIC  X(01).              03940000
039500         10  PV-PRO-NBR-17               PIC  X(01).              03950000
039600         10  PV-PRO-NBR-18               PIC  X(01).              03960000
039700         10  PV-PRO-NBR-19               PIC  X(01).              03970000
039800         10  PV-PRO-NBR-20               PIC  X(01).              03980000
039900         10  PV-PRO-NBR-21               PIC  X(01).              03990000
040000         10  PV-PRO-NBR-22               PIC  X(01).              04000000
040100                                                                  04010002
040102     05  PV-CSSL-PARA                    PIC  X(04) VALUE SPACES. 04010241
040103     05  PV-PARM-SECONDS                 PIC S9(09) COMP VALUE 0. 04010341
040104     05  PV-RECEIVE-RQST-TMST            PIC X(26).               04010441
040105     05  PV-RECEIVE-RQST-TMST-R REDEFINES PV-RECEIVE-RQST-TMST.   04010541
040106         10  FILLER                      PIC  X(11).              04010641
040107         10  PV-INIT-HH                  PIC  9(02).              04010741
040108         10  FILLER                      PIC  X(01).              04010841
040109         10  PV-INIT-MM                  PIC  9(02).              04010941
040110         10  FILLER                      PIC  X(01).              04011041
040111         10  PV-INIT-SS                  PIC  9(02).              04011141
040112         10  FILLER                      PIC  X(07).              04011241
040113     05  PV-INIT-TIME-KEY.                                        04011341
040114         10  PV-INIT-KEY-HH              PIC  9(02).              04011441
040115         10  PV-INIT-KEY-MM              PIC  9(02).              04011541
040116         10  PV-INIT-KEY-SS              PIC  9(02).              04011641
040117     05  PV-DURATION-SEC                 PIC S9(09) COMP VALUE 0. 04011741
040118     05  PV-DISP-DURATION                PIC  9(09)   VALUE ZEROS.04011841
040119     05  PV-DISP-PARM-SECONDS            PIC  9(09)   VALUE ZEROS.04011941
040120     05  PV-DURATION-NANO-SEC            PIC S9(10) COMP VALUE 0. 04012041
040121     05  PV-WORK-NANO-SEC                PIC  9(10) VALUE ZEROES. 04012141
040122     05  PV-WORK-NANO-SEC-REDEF REDEFINES PV-WORK-NANO-SEC.       04012241
040123         10  PV-WORK-NANO-MIN-1-2        PIC  9(02).              04012341
040124         10  PV-WORK-NANO-SEC-3-4        PIC  9(02).              04012441
040125         10  PV-WORK-NANO-MICRO-5-10     PIC  9(06).              04012541
040126     05  PV-DISP-NANO-SEC                PIC  X(12).              04012641
040127     05  PV-DISP-NANO-SEC-REDEF REDEFINES PV-DISP-NANO-SEC.       04012741
040128         10  PV-DISP-NANO-MIN-1-2        PIC  9(02).              04012841
040129         10  PV-DISP-NANO-DASH-1         PIC  X(01).              04012941
040130         10  PV-DISP-NANO-SEC-3-4        PIC  9(02).              04013041
040131         10  PV-DISP-NANO-DASH-2         PIC  X(01).              04013141
040132         10  PV-DISP-NANO-MICRO-5-10     PIC  9(06).              04013241
040133     05  PV-CURRENT-PARA-TMST            PIC  X(26).              04013341
040134     05  PV-CICS-MSG-AREA-3              PIC  X(125) VALUE SPACE. 04013441
040135     05  PV-DISP-OPER                    pIC  9(04)  VALUE zeros. 04013546
040136     05  PV-DISP-CRTN-OPER               pIC  9(04)  VALUE zeros. 04013646
040137     05  PV-DISP-sscc                    pIC  9(18)  VALUE zeros. 04013746
040138     05  PV-DISP-PO                      pIC  9(09)  VALUE zeros. 04013846
040139     05  PV-DISP-ORIG-RCVR               pIC  9(04)  VALUE zeros. 04013946
040140     05  PV-DISP-NEW-RCVR                pIC  9(04)  VALUE zeros. 04014046
040141     05  PV-DISP-FCLTY                   pIC  9(04)  VALUE zeros. 04014146
040142     05  PV-DISP-TRIP                    pIC  9(09)  VALUE zeros. 04014246
040144     05  PV-DISP-ORIG-SHIP               pIC  9(09)  VALUE zeros. 04014446
040145     05  PV-DISP-new-ship                pIC  9(09)  VALUE zeros. 04014546
040147     05  PV-DISP-ORIG-PKSL               pIC  9(04)  VALUE zeros. 04014746
040148     05  PV-DISP-new-pksl                pIC  9(04)  VALUE zeros. 04014846
040149                                                                  04014976
040150     05  PV-PRIM-SHIPT-IND               PIC  X(01)  VALUE SPACE. 04015078
040151                                                                  04015176
040152                                                                  04015276
040153*----------------------------------------------------------------*04015376
040154* PARAGRAPH TRACKING TABLE - USED FOR DEBUGGING                  *04015476
040155* WILL TRACK PARAGRAPHS IN THIS TABLE - IF WE SEE TRANSACTION    *04015576
040156* IF TAKING LONGER THEN X SECONDS TO RESPOND, WILL DUMP THE      *04015676
040157* TABLE TO CSSL                                                  *04015776
040158* PARM PATIM4                                                    *04015876
040159*----------------------------------------------------------------*04015976
040160 01  PT-PARA-TRACKING-TABLE.                                      04016076
040161     05  PT-ENTRIES               OCCURS 1500 TIMES               04016176
040162                                  INDEXED BY PT-TRACK-IDX.        04016276
040163         10 FILLER                PIC  X(01) VALUE SPACE.         04016376
040164         10 PT-PROGRAM            PIC  X(08) VALUE 'SUKCS771'.    04016476
040165         10 FILLER                PIC  X(01) VALUE SPACE.         04016576
040166         10 pt-dc                 PIC  9(04) VALUE zeroes.        04016676
040167         10 filler                PIC  X(01) VALUE '-'.           04016776
040168         10 PT-crtn-oper          PIC  9(04) VALUE zeroes.        04016876
040169         10 filler                PIC  X(01) VALUE '-'.           04016976
040170         10 pt-start-hhmmss       PIC  9(06) VALUE zeroes.        04017076
040171         10 FILLER                PIC  X(01) VALUE SPACE.         04017176
040172         10 PT-INDEX-NBR          PIC  9(05) VALUE ZEROES.        04017276
040173         10 FILLER                PIC  X(01) VALUE SPACE.         04017376
040174         10 PT-paragraph          PIC  X(04) VALUE SPACE.         04017476
040175         10 FILLER                PIC  X(01) VALUE SPACE.         04017576
040176         10 PT-TIMESTAMP          PIC  X(26) VALUE SPACE.         04017676
040177         10 FILLER                PIC  X(01) VALUE SPACE.         04017776
040178         10 PT-DURATION           PIC  9(09) VALUE ZEROES.        04017876
040179         10 FILLER                PIC  X(01) VALUE SPACE.         04017976
040180         10 PT-nano-sec           PIC  x(12) VALUE ZEROES.        04018076
040181     05  PT-MAX-PARA-ENTRIES      PIC  9(04) VALUE 1500.          04018176
040182     05  PT-CURR-ENTRIES          PIC  9(04) VALUE ZEROES.        04018276
040183     05  PT-CURR-PARA             PIC  X(04) VALUE SPACES.        04018376
040184                                                                  04018476
040185                                                                  04018576
040190                                                                  04019046
040200 01  ALPHABET-TABLE-VALUES.                                       04020002
040300     05  FILLER                      PIC X(01) VALUE 'A'.         04030002
040400     05  FILLER                      PIC X(01) VALUE 'B'.         04040002
040500     05  FILLER                      PIC X(01) VALUE 'C'.         04050002
040600     05  FILLER                      PIC X(01) VALUE 'D'.         04060002
040700     05  FILLER                      PIC X(01) VALUE 'E'.         04070002
040800     05  FILLER                      PIC X(01) VALUE 'F'.         04080002
040900     05  FILLER                      PIC X(01) VALUE 'G'.         04090002
041000     05  FILLER                      PIC X(01) VALUE 'H'.         04100002
041100     05  FILLER                      PIC X(01) VALUE 'I'.         04110002
041200     05  FILLER                      PIC X(01) VALUE 'J'.         04120002
041300     05  FILLER                      PIC X(01) VALUE 'K'.         04130002
041400     05  FILLER                      PIC X(01) VALUE 'L'.         04140002
041500     05  FILLER                      PIC X(01) VALUE 'M'.         04150002
041600     05  FILLER                      PIC X(01) VALUE 'N'.         04160002
041700     05  FILLER                      PIC X(01) VALUE 'O'.         04170002
041800     05  FILLER                      PIC X(01) VALUE 'P'.         04180002
041900     05  FILLER                      PIC X(01) VALUE 'Q'.         04190002
042000     05  FILLER                      PIC X(01) VALUE 'R'.         04200002
042100     05  FILLER                      PIC X(01) VALUE 'S'.         04210002
042200     05  FILLER                      PIC X(01) VALUE 'T'.         04220002
042300     05  FILLER                      PIC X(01) VALUE 'U'.         04230002
042400     05  FILLER                      PIC X(01) VALUE 'V'.         04240002
042500     05  FILLER                      PIC X(01) VALUE 'W'.         04250002
042600     05  FILLER                      PIC X(01) VALUE 'X'.         04260002
042700     05  FILLER                      PIC X(01) VALUE 'Y'.         04270002
042800     05  FILLER                      PIC X(01) VALUE 'Z'.         04280002
042900                                                                  04290002
043000 01  ALPHABET-TABLE REDEFINES ALPHABET-TABLE-VALUES.              04300002
043100     05  ALPHABET-CHAR                PIC X(01)                   04310003
043200                               OCCURS 26 TIMES                    04320002
043300                               INDEXED BY ALPHA-INDEX.            04330002
043400                                                                  04340002
043500                                                                  04350002
043600 01  PW-PROGRAM-WORKAREA.                                         04360002
043700     05  PW-CONTROL-REC.                                          04370002
043800         10  PW-CONTROL-KEYREC.                                   04380000
043900             20  PW-CONTROL-PANL-NBR.                             04390000
044000                 30  PW-CONTROL-PANEL    PIC 9(05)  VALUE ZERO.   04400000
044100                 30  PW-CONTROL-KEYREC-NBR                        04410000
044200                                         PIC 9(02)  VALUE ZERO.   04420000
044300             20  PW-CONTROL-PANL-NBR-9 REDEFINES                  04430000
044400                                       PW-CONTROL-PANL-NBR        04440000
044500                                         PIC 9(7).                04450000
044600             20  PW-CONTROL-CEHCK-DIG    PIC 9(01)  VALUE ZERO.   04460000
044700         10  PW-CONTROL-KEYREC-9 REDEFINES PW-CONTROL-KEYREC      04470000
044800                                         PIC 9(08).               04480000
044900         10  PW-CONTROL-FILLER           PIC X(73)  VALUE SPACE.  04490000
045000                                                                  04500000
045100     05  PW-SAVE-PANEL-NBR               PIC X(7)   VALUE SPACES. 04510000
045200                                                                  04520000
045300     05  PW-QUOTIENT                     PIC S9(7)  VALUE ZERO.   04530000
045400     05  PW-REMAINDER                    PIC S9     VALUE ZERO.   04540000
045500                                                                  04550000
045600*---------------------------------------------------------------* 04560000
045700*    DB2 AREA FOR SHIPMENT PO AUDIT TABLE                       * 04570000
045800*---------------------------------------------------------------* 04580000
045900     EXEC SQL                                                     04590000
046000          INCLUDE TAUSHPO                                         04600000
046100     END-EXEC.                                                    04610000
046200                                                                  04620000
046300*----------------------------------------------------------------*04630000
046400*    DB2 AREA FOR WORK ORDER INSTRUCTION TABLE                   *04640000
046500*----------------------------------------------------------------*04650000
046600                                                                  04660000
046700     EXEC SQL                                                     04670000
046800          INCLUDE TWKORIN                                         04680000
046900     END-EXEC.                                                    04690000
047000                                                                  04700000
047100*---------------------------------------------------------------* 04710000
047200*    DB2 AREA FOR THE ENTERPRISE NAME TABLE                     * 04720000
047300*---------------------------------------------------------------* 04730000
047400     EXEC SQL                                                     04740000
047500          INCLUDE TENTNME                                         04750000
047600     END-EXEC.                                                    04760000
047700*---------------------------------------------------------------* 04770000
047800*    DB2 AREA FOR SHIPMENT TABLE                                * 04780000
047900*---------------------------------------------------------------* 04790000
048000     EXEC SQL                                                     04800000
048100          INCLUDE TSHIPMT                                         04810000
048200     END-EXEC.                                                    04820000
048300                                                                  04830000
048400*---------------------------------------------------------------* 04840000
048500*    DB2 AREA FOR SHIPMENT STATUS TABLE                         * 04850000
048600*---------------------------------------------------------------* 04860000
048700     EXEC SQL                                                     04870000
048800          INCLUDE TSHIPST                                         04880000
048900     END-EXEC.                                                    04890000
049000                                                                  04900000
049100*---------------------------------------------------------------* 04910000
049200*    DB2 AREA FOR SHIPMENT AUDIT TABLE                          * 04920000
049300*---------------------------------------------------------------* 04930000
049400     EXEC SQL                                                     04940000
049500          INCLUDE TAUSHIP                                         04950000
049600     END-EXEC.                                                    04960000
049700                                                                  04970000
049800*----------------------------------------------------------------*04980000
049900*    DB2 AREA FOR OPERATION SET/FACILITY TABLE                   *04990000
050000*----------------------------------------------------------------*05000000
050100                                                                  05010000
050200     EXEC SQL                                                     05020000
050300          INCLUDE TOSOPFA                                         05030000
050400     END-EXEC.                                                    05040000
050500                                                                  05050000
050600*----------------------------------------------------------------*05060000
050700*    DB2 DCLGEN FOR PO AGREEMENT TABLE                            05070000
050800*----------------------------------------------------------------*05080000
050900     EXEC SQL                                                     05090000
051000          INCLUDE TPOAGMT                                         05100000
051100     END-EXEC.                                                    05110000
051200                                                                  05120000
051300*---------------------------------------------------------------* 05130000
051400*    DB2 AREA FOR PURCHASE ORDER TABLE                          * 05140000
051500*---------------------------------------------------------------* 05150000
051600     EXEC SQL                                                     05160000
051700          INCLUDE TPURCHS                                         05170000
051800     END-EXEC.                                                    05180000
051900                                                                  05190000
052000*----------------------------------------------------------------*05200000
052100*    DB2 AREA FOR WORK ORDER TABLE                               *05210000
052200*----------------------------------------------------------------*05220000
052300                                                                  05230000
052400     EXEC SQL                                                     05240000
052500          INCLUDE TWRKORD                                         05250000
052600     END-EXEC.                                                    05260000
052700                                                                  05270000
052800*----------------------------------------------------------------*05280000
052900*    DB2 AREA FOR OPERATION SET TABLE                            *05290000
053000*----------------------------------------------------------------*05300000
053100                                                                  05310000
053200     EXEC SQL                                                     05320000
053300          INCLUDE TOPRSET                                         05330000
053400     END-EXEC.                                                    05340000
053500                                                                  05350000
053600*---------------------------------------------------------------* 05360000
053700*    DB2 AREA FOR THE COMPANY CONTROL TABLE                     * 05370000
053800*---------------------------------------------------------------* 05380000
053900     EXEC SQL                                                     05390000
054000          INCLUDE TCOCNTL                                         05400000
054100     END-EXEC.                                                    05410000
054200                                                                  05420000
054300*----------------------------------------------------------------*05430000
054400*    DB2 AREA FOR TDCFAAS  DEPT/CLASS FACILITY LOC. ASSIGNMENTS  *05440000
054500*----------------------------------------------------------------*05450000
054600                                                                  05460000
054700     EXEC SQL                                                     05470000
054800          INCLUDE TDCFAAS                                         05480000
054900     END-EXEC.                                                    05490000
055000                                                                  05500000
055100*---------------------------------------------------------------* 05510000
055200*    DB2 AREA FOR PURCHASE ORDER LINE ITEM TABLE                * 05520000
055300*---------------------------------------------------------------* 05530000
055400     EXEC SQL                                                     05540000
055500          INCLUDE TPURITM                                         05550000
055600     END-EXEC.                                                    05560000
055700                                                                  05570000
055800*---------------------------------------------------------------* 05580000
055900*    DB2 AREA FOR RECEIVER TABLE                                * 05590000
056000*---------------------------------------------------------------* 05600000
056100     EXEC SQL                                                     05610000
056200          INCLUDE TRECEIV                                         05620000
056300     END-EXEC.                                                    05630000
056400                                                                  05640000
056500*---------------------------------------------------------------* 05650000
056600*    DB2 AREA FOR SHIPMENT PO TABLE                             * 05660000
056700*---------------------------------------------------------------* 05670000
056800     EXEC SQL                                                     05680000
056900          INCLUDE TSHPTPO                                         05690000
057000     END-EXEC.                                                    05700000
057100                                                                  05710000
057200*---------------------------------------------------------------* 05720000
057300*    DB2 AREA FOR PACKING SLIP TABLE                            * 05730000
057400*---------------------------------------------------------------* 05740000
057500     EXEC SQL                                                     05750000
057600          INCLUDE TPKSLIP                                         05760000
057700     END-EXEC.                                                    05770000
057800                                                                  05780000
057900*---------------------------------------------------------------* 05790000
058000*    DB2 AREA FOR PACKING SLIP TABLE                            * 05800000
058100*---------------------------------------------------------------* 05810000
058200     EXEC SQL                                                     05820000
058300          INCLUDE TINPKSU                                         05830000
058400     END-EXEC.                                                    05840000
058500                                                                  05850000
058600*----------------------------------------------------------------*05860000
058700*    DB2 DCLGEN FOR THE RECEIVER NUMBER TABLE                     05870000
058800*----------------------------------------------------------------*05880000
058900     EXEC SQL                                                     05890000
059000          INCLUDE TRECVER                                         05900000
059100     END-EXEC.                                                    05910000
059200                                                                  05920000
059300     EXEC SQL                                                     05930000
059400          INCLUDE TPOSYNC                                         05940000
059500     END-EXEC.                                                    05950000
059600                                                                  05960000
059700*----------------------------------------------------------------*05970000
059800*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                05980000
059900*----------------------------------------------------------------*05990000
060000     EXEC SQL                                                     06000000
060100          INCLUDE TTRBNTF                                         06010000
060200     END-EXEC.                                                    06020000
060300/                                                                 06030000
060400*----------------------------------------------------------------*06040000
060500*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      06050000
060600*----------------------------------------------------------------*06060000
060700     EXEC SQL                                                     06070000
060800          INCLUDE TTRBRSN                                         06080000
060900     END-EXEC.                                                    06090000
061000*                                                                 06100000
061100******************************************************************06110000
061200*  SQL AND COBOL DECLARATIONS FOR THE KOHLS/RETEK PARMS (TKRPRPM) 06120000
061300******************************************************************06130000
061400     EXEC SQL                                                     06140000
061500          INCLUDE TKRPRPM                                         06150000
061600     END-EXEC.                                                    06160000
061700******************************************************************06170011
061800*  SQL AND COBOL DECLARATIONS FOR THE TRIP STATUS TABLE           06180011
061900******************************************************************06190011
062000     EXEC SQL                                                     06200011
062100          INCLUDE TTRIPST                                         06210011
062200     END-EXEC.                                                    06220011
062300******************************************************************06230000
062400*  COMMUNICATIONS AREA FOR DB2                                    06240000
062500******************************************************************06250000
062600     EXEC SQL                                                     06260000
062700         INCLUDE SQLCA                                            06270000
062800     END-EXEC.                                                    06280000
062900                                                                  06290000
063000******************************************************************06300000
063100 LINKAGE SECTION.                                                 06310000
063200 01  DFHCOMMAREA.                                                 06320000
063300     05  FILLER                         OCCURS  1 TO 4072 TIMES   06330000
063400                                      DEPENDING ON EIBCALEN.      06340000
063500         10  FILLER                   PIC X.                      06350000
063600******************************************************************06360000
063700******************************************************************06370000
063800 PROCEDURE DIVISION.                                              06380000
063900******************************************************************06390000
064000 0000-PROGRAM-MAINLINE.                                           06400000
064100     INITIALIZE                        SU044-COMM-AREA.           06410000
064200     MOVE DFHCOMMAREA              TO  SU044-COMM-AREA.           06420000
064300     MOVE SU044-OPER-UNT-ID        TO  DK-OPER-UNT-ID.            06430064
064311                                                                  06431167
064312     INITIALIZE PV-PROGRAM-VARIABLES                              06431267
064313                PS-PROGRAM-SWITCHES.                              06431367
064314                                                                  06431467
064321     SET PS-BLD-INTERNAL-TABLE-NO  TO  TRUE.                      06432142
064322     MOVE 999999999                TO  PV-PARM-SECONDS.           06432247
064323                                                                  06432357
064324     EXEC SQL                                                     06432457
064325          SET :PV-CURRENT-PARA-TMST = CURRENT TIMESTAMP           06432557
064326     END-EXEC.                                                    06432657
064327                                                                  06432757
064331     move  pv-current-para-tmst  to  PV-RECEIVE-RQST-TMST.        06433157
064332                                                                  06433263
064333     MOVE  PV-INIT-HH            TO  PV-INIT-KEY-HH.              06433363
064334     MOVE  PV-INIT-MM            TO  PV-INIT-KEY-MM.              06433463
064335     MOVE  PV-INIT-SS            TO  PV-INIT-KEY-SS.              06433563
064340                                                                  06434042
064400     PERFORM 8000-CHECK-FOR-LOGGING.                              06440016
064500     IF PS-LOG-MESSAGE                                            06450016
064600         MOVE SU044-PO               TO PV-DISP-PO-NBR            06460017
064700         MOVE SU044-ORIG-REC-SEQ-NBR TO  PV-DISP-RCVR-SEQ-NBR     06470016
064800         MOVE SU044-SHIPT-UNT-ID     TO  PV-DISP-SHIPT-UNT-ID     06480016
064900         STRING   ' SUKUT703 PROGRAM STARTED -'                   06490052
065000                  ' CALLED BY-'                                   06500016
065100                  SU044-PROGRAM-NAME                              06510016
065200                  ' PO='                                          06520016
065300                  PV-DISP-PO-NBR                                  06530017
065400                  ' RCVR='                                        06540016
065500                  PV-DISP-RCVR-SEQ-NBR                            06550016
065600                  ' CARTON='                                      06560016
065700                  PV-DISP-SHIPT-UNT-ID                            06570016
065800                  DELIMITED BY SIZE                               06580016
065900                                  INTO PV-CICS-MSG-AREA           06590016
066000         MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG          06600016
066100         PERFORM 9999-WRITE-TO-CSSL                               06610016
066200     END-IF.                                                      06620016
066210                                                                  06621055
066220     perform 8100-CHECK-PARA-TRACK-SEC.                           06622055
066500     SET PS-NO-ERROR TO TRUE.                                     06650000
066600     PERFORM 1000-CREATE-RECEIVER.                                06660000
066700                                                                  06670000
066800     MOVE SU044-COMM-AREA               TO DFHCOMMAREA.           06680000
066837                                                                  06683765
066838* 02/01/15 begin                                                  06683843
066839     IF  PS-BLD-INTERNAL-TABLE-YES  and                           06683943
066840         PV-DURATION-SEC     >=  PV-PARM-SECONDS                  06684043
066850                                                                  06685043
066860         move spaces to  pv-ciCS-MSG-AREA-3                       06686065
066870         PERFORM 9997-WRITE-TO-CSSL                               06687051
066880                                                                  06688043
066881         move '0000'  to  PV-CSSL-PARA                            06688162
066890         perform 8110-WRITE-suws044-TO-CSSL                       06689043
066891                                                                  06689143
066892         move spaces to  pv-ciCS-MSG-AREA-3                       06689265
066893         pERFORM 9997-WRITE-TO-CSSL                               06689365
066894                                                                  06689443
066895         STRING ' SUKUT703-DID NOT MEET SLA'                      06689544
066896                ' DC:'        PV-DISP-OPER                        06689643
066897                ' CRTN OPER:' PV-DISP-CRTN-OPER                   06689743
066898                ' SSCC:'      PV-DISP-SSCC                        06689843
066899                              DELIMITED BY SIZE                   06689943
066900                         INTO PV-CICS-MSG-AREA-3                  06690065
066901         PERFORM 9997-WRITE-TO-CSSL                               06690143
066902                                                                  06690262
066903         INITIALIZE PV-CICS-MSG-AREA-3                            06690365
066904         STRING ' SUKUT703 '                                      06690462
066905                ' START:'     PV-RECEIVE-RQST-TMST                06690562
066906                ' END:'       PV-CURRENT-PARA-TMST                06690662
066907                ' KEY:'       PV-INIT-TIME-KEY                    06690762
066908                ' DURATION:'  PV-DISP-NANO-SEC                    06690862
066909                              DELIMITED BY SIZE                   06690962
066910                         INTO PV-CICS-MSG-AREA-3                  06691065
066911         PERFORM 9997-WRITE-TO-CSSL                               06691162
066912                                                                  06691262
066913                                                                  06691343
066914         PERFORM 8140-DUMP-TABLE-TO-CSSL                          06691443
066915         VARYING PT-TRACK-IDX                                     06691543
066916            FROM 1 BY 1                                           06691643
066917           UNTIL PT-TRACK-IDX >   PT-CURR-ENTRIES                 06691765
066918              OR PT-TRACK-IDX >   PT-MAX-PARA-ENTRIES             06691865
066919                                                                  06691943
066920         PERFORM 8150-CLEAR-TABLE                                 06692043
066921         VARYING PT-TRACK-IDX                                     06692143
066922            FROM 1 BY 1                                           06692243
066923            UNTIL PT-TRACK-IDX >   PT-CURR-ENTRIES                06692365
066924               OR PT-TRACK-IDX >   PT-MAX-PARA-ENTRIES            06692465
066925                                                                  06692543
066926         MOVE ZEROES TO PT-CURR-ENTRIES                           06692643
066927         SET  PT-TRACK-IDX  to  PT-CURR-ENTRIES                   06692743
066928                                                                  06692843
066929         INITIALIZE PV-CICS-MSG-AREA-3                            06692965
066930         MOVE PV-DURATION-SEC TO  PV-DISP-DURATION                06693043
066931         STRING ' SUKUT703-DID NOT MEET SLA'                      06693144
066932                ' DC:'        PV-DISP-OPER                        06693243
066933                ' CRTN OPER:' PV-DISP-CRTN-OPER                   06693343
066934                ' SSCC:'      PV-DISP-SSCC                        06693443
066935                ' DONE'                                           06693543
066936                              DELIMITED BY SIZE                   06693643
066937                         INTO PV-CICS-MSG-AREA-3                  06693765
066938         PERFORM 9997-WRITE-TO-CSSL                               06693843
066939                                                                  06693943
066942     end-if.                                                      06694248
066943                                                                  06694343
066944* 02/01/15 end                                                    06694443
066945                                                                  06694543
066950     GOBACK.                                                      06695000
067000                                                                  06700000
067100 1000-CREATE-RECEIVER.                                            06710000
067110                                                                  06711061
067120     IF  PS-BLD-INTERNAL-TABLE-YES                                06712061
067130         MOVE  '1000'  TO  PT-CURR-PARA                           06713061
067140         PERFORM 8120-INTERNAL-TABLE                              06714061
067150     END-IF.                                                      06715061
067200                                                                  06720000
067300     SET  PS-RECEIVER-NOT-FOUND                                   06730000
067400          PS-LINE-NOT-FOUND                                       06740000
067500          PS-AUTO-APPLY           TO TRUE.                        06750000
067600                                                                  06760000
067700     PERFORM 1100-MOVE-DEFAULT-TO-COMMAREA.                       06770000
067800     PERFORM 4000-GET-ENT-NAME-DESC.                              06780000
067900     PERFORM 2000-CREATE-NEW-SHIPMENT.                            06790000
068000     IF PS-NO-ERROR                                               06800000
068100        PERFORM 1200-ADD-RECEIVER                                 06810000
068200        IF PS-NO-ERROR                                            06820000
068300            MOVE SU044-NEW-REC-SEQ-NBR TO SHPTPO-REC-SEQ-NBR      06830000
068400            MOVE ZEROES          TO SHPTPO-EXPTED-CART-CNT        06840000
068500            PERFORM 6000-INSERT-TSHPTPO                           06850000
068600        END-IF                                                    06860000
068700     END-IF.                                                      06870000
068800                                                                  06880000
068900                                                                  06890000
069000 1100-MOVE-DEFAULT-TO-COMMAREA.                                   06900000
069010                                                                  06901061
069020     IF  PS-BLD-INTERNAL-TABLE-YES                                06902061
069030         MOVE  '1100'  TO  PT-CURR-PARA                           06903061
069040         PERFORM 8120-INTERNAL-TABLE                              06904061
069050     END-IF.                                                      06905061
069100                                                                  06910000
069200* SET PRE TICKET INDICATOR                                        06920000
069300     INITIALIZE PV-DB2-COUNT.                                     06930000
069400     MOVE 4                      TO DK-AGRMT-TYP-ID.              06940000
069500     MOVE 1                      TO DK-TYP-CDE.                   06950000
069600                                                                  06960000
069700     PERFORM 4100-CHECK-PO-SERVICE-INFO.                          06970000
069800                                                                  06980000
069900     IF  PV-DB2-COUNT > +0                                        06990000
070000         MOVE 'Y'                TO PV-PRE-TICKET-IND             07000000
070100     ELSE                                                         07010000
070200         MOVE 'N'                TO PV-PRE-TICKET-IND             07020000
070300     END-IF.                                                      07030000
070400                                                                  07040000
070500                                                                  07050000
070600* SET GARMENT ON HANGER (GOH) INDICATOR                           07060000
070700     INITIALIZE PV-DB2-COUNT.                                     07070000
070800     MOVE 4                      TO DK-AGRMT-TYP-ID.              07080000
070900     MOVE 2                      TO DK-TYP-CDE.                   07090000
071000                                                                  07100000
071100     PERFORM 4100-CHECK-PO-SERVICE-INFO.                          07110000
071200                                                                  07120000
071300     IF  PV-DB2-COUNT > +0                                        07130000
071400         MOVE 'Y'                TO PV-HANGER-IND                 07140000
071500     ELSE                                                         07150000
071600         MOVE 'N'                TO PV-HANGER-IND                 07160000
071700     END-IF.                                                      07170000
071800                                                                  07180000
071900* SET PACK BY STORE INDICATOR                                     07190000
072000     INITIALIZE PV-DB2-COUNT.                                     07200000
072100     MOVE 4                      TO DK-AGRMT-TYP-ID.              07210000
072200     MOVE 4                      TO DK-TYP-CDE.                   07220000
072300                                                                  07230000
072400     PERFORM 4100-CHECK-PO-SERVICE-INFO.                          07240000
072500                                                                  07250000
072600     IF  PV-DB2-COUNT > +0                                        07260000
072700         MOVE 'Y'                TO PV-PACK-BY-ST-IND             07270000
072800     ELSE                                                         07280000
072900         MOVE 'N'                TO PV-PACK-BY-ST-IND             07290000
073000     END-IF.                                                      07300000
073001                                                                  07300128
073010     IF SU044-ORIG-REC-SEQ-NBR > 0                                07301028
073020        PERFORM 4550-PKGNG-CDE-FROM-ORIG-RCVR                     07302028
073030     END-IF                                                       07303028
073100                                                                  07310000
073200     IF PV-PACK-BY-ST-IND NOT = 'Y'                               07320000
073300        PERFORM 4600-PKGNG-CDE-FROM-PO                            07330028
073400     ELSE                                                         07340000
073500         MOVE SPACES                   TO PV-PKGNG-CDE            07350000
073600     END-IF.                                                      07360000
073700                                                                  07370000
073800 1200-ADD-RECEIVER.                                               07380000
073810                                                                  07381061
073820     IF  PS-BLD-INTERNAL-TABLE-YES                                07382061
073830         MOVE  '1200'  TO  PT-CURR-PARA                           07383061
073840         PERFORM 8120-INTERNAL-TABLE                              07384061
073850     END-IF.                                                      07385061
073900                                                                  07390000
074000     MOVE SU044-PO           TO DK-PO-NBR.                        07400000
074100     MOVE SU044-NEW-REC-SEQ-NBR TO DK-REC-SEQ-NBR.                07410000
074200     MOVE SU044-VEH-NBR      TO DK-VEH-NBR.                       07420000
074300     MOVE SU044-SCAC-ID      TO DK-SCAC-ID.                       07430000
074400     MOVE SU044-OPER-UNT-ID  TO DK-OPER-UNT-ID.                   07440000
074500     MOVE SU044-FCLTY-ID     TO DK-FCLTY-ID.                      07450000
074600                                                                  07460000
074700     IF  PS-NO-ERROR                                              07470000
074800         PERFORM 4700-GET-MAX-SEQ-NBR                             07480000
074900         PERFORM 1300-BUILD-RECEIVER-INFO                         07490000
075000         IF  PS-NO-ERROR                                          07500000
075100             PERFORM 1400-BUILD-ZERO-LINE-WORK-ORD                07510000
075200         END-IF                                                   07520000
075300     END-IF.                                                      07530000
075400                                                                  07540000
075500     IF  PS-NO-ERROR                                              07550000
075600         IF TM500-NO-TROUBLE                                      07560000
075700             MOVE 391                TO DP020-MSG-NUMBER          07570000
075800             MOVE SU044-NEW-REC-SEQ-NBR TO DP020-MSG-TEXT         07580000
075900         ELSE                                                     07590000
076000             MOVE 847                TO DP020-MSG-NUMBER          07600000
076100             MOVE SU044-NEW-REC-SEQ-NBR TO DP020-MSG-TEXT         07610000
076200                                        DK-REC-SEQ-NBR            07620000
077000         END-IF                                                   07700000
077100         SET DP020-MSG-INFORMATIONAL                              07710000
077200                                 TO TRUE                          07720000
077300     END-IF.                                                      07730000
077400                                                                  07740000
077500*---------------------------------------------------------------* 07750000
077600*  LOAD THE RECEIV FIELDS, PERFORM THE INSERT TO THE TRECEIV    * 07760000
077700*  TABLE, AND CHECK FOR TROUBLE.                                * 07770000
077800*---------------------------------------------------------------* 07780000
077900 1300-BUILD-RECEIVER-INFO.                                        07790000
077910                                                                  07791061
077920     IF  PS-BLD-INTERNAL-TABLE-YES                                07792061
077930         MOVE  '1300'  TO  PT-CURR-PARA                           07793061
077940         PERFORM 8120-INTERNAL-TABLE                              07794061
077950     END-IF.                                                      07795061
078000                                                                  07800000
078100     INITIALIZE DCLTRECEIV.                                       07810000
078200                                                                  07820000
078300     MOVE SU044-PO               TO RECEIV-ORD-NBR.               07830000
078400     MOVE PV-REC-SEQ-NBR         TO RECEIV-REC-SEQ-NBR            07840000
078500                                    RECEIV-REFER-BACK-SEQ-NBR     07850013
078600                                    SU044-NEW-REC-SEQ-NBR.        07860013
078700     MOVE PV-VER-NBR             TO RECEIV-PO-VER-NBR.            07870000
078800                                                                  07880000
079000     MOVE SU044-FCLTY-ID         TO RECEIV-FCLTY-ID.              07900000
079100     MOVE 'IP'                   TO RECEIV-STATUS-CDE.            07910000
079200     MOVE 'P'                    TO RECEIV-SYST-CRE-CDE.          07920000
079300     MOVE 'MR'                   TO RECEIV-REC-TYP-CDE.           07930000
079400     MOVE 'A'                    TO RECEIV-VER-STATUS-CDE.        07940000
079500     MOVE PV-HANGER-IND          TO RECEIV-GOH-IND.               07950000
079600     MOVE PV-PRE-TICKET-IND      TO RECEIV-PRE-TKT-IND.           07960000
079700     MOVE PV-PACK-BY-ST-IND      TO RECEIV-PACK-BY-ST-IND.        07970000
079800     MOVE ZERO                   TO RECEIV-EXPTED-CART-CNT.       07980000
079900     MOVE ZERO                   TO RECEIV-ACTL-CART-CNT.         07990000
080000     MOVE '9999-09-09'           TO RECEIV-AP-PRC-DTE.            08000000
080100     MOVE '9999-09-09-09.09.09.999999'                            08010000
080200                                 TO RECEIV-ML-POST-TMST           08020000
080300                                    RECEIV-FS-POST-TMST           08030000
080400                                    RECEIV-IN-TRBL-TMST           08040000
080500                                    RECEIV-VERFYD-TMST            08050000
080600                                    RECEIV-MKNG-APRN-PRT-TMST.    08060000
080700     PERFORM 3000-SEL-ARRVD-TRIP-TMST.                            08070010
080800     MOVE PV-ARRVD-TIMESTAMP      TO RECEIV-REC-TMST.             08080010
081000                                                                  08100000
081100* RPK - 5/31/2018 - START                                         08110072
081110     MOVE SU044-OPER-UNT-ID       TO RECEIV-CURR-OPER-UNT-ID.     08111069
081120* RPK - 5/31/2018 - END                                           08112072
081200     IF SU044-OPER-UNT-ID     = SU044-CRTN-OPER-UNT-ID            08120000
081201        MOVE SU044-OPER-UNT-ID       TO RECEIV-OPER-UNT-ID        08120123
081210                                        RECEIV-CRE-OPER-UNT-ID    08121023
081300        IF SU044-CREATE-FA-RCVR                                   08130015
081400           MOVE PC-RECV-CRE-UID      TO RECEIV-CRE-UID            08140015
081500        ELSE                                                      08150015
081600           MOVE PC-RECV-CRE-UID-CKIN TO RECEIV-CRE-UID            08160000
081700        END-IF                                                    08170015
081800     ELSE                                                         08180000
081900        IF SU044-RCVR-PBS                                         08190033
082000           MOVE SU044-CRTN-OPER-UNT-ID TO PV-MISDIRECT-OPER-ID    08200033
082010                                          RECEIV-OPER-UNT-ID      08201033
082020                                          RECEIV-CRE-OPER-UNT-ID  08202033
082100           MOVE PV-MISDIRECT-OPER-ID   TO PV-MIS-FA-CRE-OPER      08210033
082200           MOVE 'PBSM'                 TO PV-MIS-FA-CRE-SYST      08220033
082300           MOVE PV-MISDIRECT-FA-CREATE-SRCE TO RECEIV-CRE-UID     08230033
082310        ELSE                                                      08231033
082311* RPK - 5/31/2018 - START                                         08231172
082312           MOVE PC-RECV-CRE-UID        TO RECEIV-CRE-UID          08231270
082313           PERFORM 8200-CHECK-OPER-HANDLING                       08231370
082314           IF PS-FREE-ASTRAY-OPER-NEW                             08231470
082315              MOVE SU044-CRTN-OPER-UNT-ID TO                      08231570
082316                   RECEIV-OPER-UNT-ID                             08231670
082317              MOVE SU044-OPER-UNT-ID      TO                      08231770
082318                   RECEIV-CRE-OPER-UNT-ID                         08231870
082319           ELSE                                                   08231970
082320              MOVE SU044-OPER-UNT-ID     TO                       08232070
082321                   RECEIV-OPER-UNT-ID                             08232170
082322                   RECEIV-CRE-OPER-UNT-ID                         08232270
082323           END-IF                                                 08232370
082324* RPK - 5/31/2018 - END                                           08232472
082330        END-IF                                                    08233033
082400     END-IF.                                                      08240070
082500                                                                  08250000
082600     MOVE SU044-FCLTY-ID          TO RECEIV-CURR-FCLTY-ID.        08260000
082700     MOVE SU044-FCLTY-ID          TO RECEIV-CRE-FCLTY-ID.         08270000
082800     MOVE PC-CURRENT-PROGRAM-NAME TO RECEIV-UPD-PGM-ID            08280000
082900                                     RECEIV-UPD-UID.              08290000
083000     MOVE PV-PKGNG-CDE            TO RECEIV-PKGNG-CDE.            08300000
083100                                                                  08310000
083200     MOVE SPACES                 TO RECEIV-RCVG-CLERK-INIT-ID.    08320000
083300     IF SU044-CREATE-FA-RCVR                                      08330000
083400        MOVE 'Y'                    TO RECEIV-FRE-ASTRA-IND       08340000
083500     ELSE                                                         08350000
083600        MOVE 'N'                    TO RECEIV-FRE-ASTRA-IND       08360000
083700     END-IF.                                                      08370000
083800                                                                  08380000
083900     SET PS-RCVR-FOUND TO TRUE.                                   08390000
084000     PERFORM VARYING PV-COUNT FROM 1 BY 1 UNTIL                   08400000
084100          PV-COUNT > 10 OR PS-NO-RCVR-FOUND                       08410000
084200         PERFORM 5000-OPEN-TRECVER-CSR                            08420000
084300         PERFORM 5020-FETCH-TRECVER-CSR                           08430000
084400                                                                  08440000
084500         MOVE RECVER-MAX-RCVR-NBR  TO PW-CONTROL-PANL-NBR-9       08450000
084600         DIVIDE PW-CONTROL-PANL-NBR-9 BY 9 GIVING PW-QUOTIENT     08460000
084700                                       REMAINDER  PW-REMAINDER    08470000
084800         COMPUTE PW-CONTROL-CEHCK-DIG = ( 9 - PW-REMAINDER )      08480000
084900         COMPUTE RECEIV-RCVR-NBR = PW-CONTROL-KEYREC-9 * 1        08490000
085000         ADD +1                    TO RECVER-MAX-RCVR-NBR         08500000
085100         PERFORM 5040-DELETE-TRECVER-CSR                          08510000
085200         PERFORM 5060-INSERT-TRECVER                              08520000
085300         PERFORM 5080-CLOSE-TRECVER-CSR                           08530000
085400     END-PERFORM.                                                 08540000
085500                                                                  08550000
085600     IF  PS-NO-ERROR                                              08560000
085700         PERFORM 4800-INSERT-TRECEIV                              08570000
085800         IF SQLCODE = ZERO                                        08580000
085900             PERFORM 4900-INSERT-TPOSYNC                          08590000
086000         END-IF                                                   08600000
086100         PERFORM 5100-CHECK-FOR-TROUBLE                           08610000
086200     END-IF.                                                      08620000
086300                                                                  08630000
086400                                                                  08640000
086500 1400-BUILD-ZERO-LINE-WORK-ORD.                                   08650000
086510                                                                  08651061
086520     IF  PS-BLD-INTERNAL-TABLE-YES                                08652061
086530         MOVE  '1400'  TO  PT-CURR-PARA                           08653061
086540         PERFORM 8120-INTERNAL-TABLE                              08654061
086550     END-IF.                                                      08655061
086600                                                                  08660000
086700     INITIALIZE DCLTWRKORD.                                       08670000
086701                                                                  08670129
086702****  IF THIS IS A MISDIRECT THE SU044-OPER-UNT-ID IS THE         08670231
086703****  CURRENT OPER AND THE CARTON OPER IS THE ORIGINAL            08670331
086704****  THE DK-OPER CONTAINS THE CURRENT OPER                       08670431
086705                                                                  08670531
086706*** 10/15/08 - DMH BEGIN                                          08670635
086710***  IF SU044-OPER-UNT-ID     = SU044-CRTN-OPER-UNT-ID            08671035
086720***     MOVE SU044-OPER-UNT-ID      TO WRKORD-OPER-UNT-ID         08672035
086740***  ELSE                                                         08674035
086750***     MOVE SU044-CRTN-OPER-UNT-ID TO WRKORD-OPER-UNT-ID         08675035
086770***  END-IF                                                       08677035
086771                                                                  08677135
086772     MOVE SU044-OPER-UNT-ID         TO WRKORD-OPER-UNT-ID.        08677236
086780*** 10/15/08 - DMH END                                            08678035
086800                                                                  08680000
086900     IF  PV-OPER-SET-ID  = ZERO                                   08690000
087000         PERFORM 5300-GET-OPER-SET-INFO                           08700000
087100         IF  SQLCODE = +0                                         08710000
087200             MOVE DCFAAS-OPER-SET-ID   TO PV-OPER-SET-ID          08720000
087300                                          DK-OPER-SET-ID          08730000
087400         ELSE                                                     08740000
087500             PERFORM 5500-GET-OPER-SET-ID                         08750000
087600                MOVE COCNTL-DFLT-OPER-SET-ID                      08760000
087700                                       TO PV-OPER-SET-ID          08770000
087800                                          DK-OPER-SET-ID          08780000
087900             PERFORM 5200-VALIDATE-OPER-SET-ID                    08790000
088000         END-IF                                                   08800000
088100     ELSE                                                         08810000
088200         MOVE PV-OPER-SET-ID   TO DK-OPER-SET-ID                  08820000
088300     END-IF.                                                      08830000
088400                                                                  08840000
088500     MOVE SU044-PO               TO WRKORD-ORD-NBR.               08850000
088600     MOVE SU044-NEW-REC-SEQ-NBR  TO WRKORD-RCVR-SEQ-NBR.          08860000
088730                                                                  08873029
088800     MOVE SU044-FCLTY-ID         TO WRKORD-FCLTY-ID.              08880000
088900     MOVE +1                     TO WRKORD-WORK-ORD-SEQ-NBR.      08890000
089000     MOVE ZERO                   TO WRKORD-ACTL-CART-CNT.         08900000
089100     MOVE +1                     TO WRKORD-EXPTED-CART-CNT.       08910000
089200     MOVE 'A'                    TO WRKORD-VER-STATUS-CDE.        08920000
089300     MOVE 'IP'                   TO WRKORD-STAT-CDE.              08930000
089400     MOVE 'N'                    TO WRKORD-WORK-ORD-DISTR-IND.    08940000
089500     MOVE PV-OPER-SET-ID         TO WRKORD-OPER-SET-ID.           08950000
089600                                                                  08960000
089700     PERFORM 5600-INACTIVATE-TWRKORD.                             08970000
089800     PERFORM 5700-INSERT-TWRKORD.                                 08980000
089900                                                                  08990000
090000     MOVE +0                     TO PV-WO-INSTR-SEQ-NBR.          09000000
090100     MOVE 'N'                    TO PS-TOSOPFA-CURSOR-SW.         09010000
090200     MOVE 'Y'                    TO PS-INSTRUCTION-SW.            09020000
090300                                                                  09030000
090400     PERFORM 5800-OPEN-TOSOPFA-CSR.                               09040000
090500     PERFORM 5820-FETCH-TOSOPFA-CSR.                              09050000
090600                                                                  09060000
090700     PERFORM UNTIL PS-EOF-TOSOPFA-CSR                             09070000
090800        PERFORM 5900-BUILD-WORK-ORDER-INSTR                       09080000
090900        PERFORM 5820-FETCH-TOSOPFA-CSR                            09090000
091000     END-PERFORM.                                                 09100000
091100                                                                  09110000
091200     PERFORM 5840-CLOSE-TOSOPFA-CSR.                              09120000
091300                                                                  09130000
091400                                                                  09140000
091500 2000-CREATE-NEW-SHIPMENT.                                        09150000
091510                                                                  09151061
091520     IF  PS-BLD-INTERNAL-TABLE-YES                                09152061
091530         MOVE  '2000'  TO  PT-CURR-PARA                           09153061
091540         PERFORM 8120-INTERNAL-TABLE                              09154061
091550     END-IF.                                                      09155061
091560                                                                  09156061
091600     PERFORM 2100-GET-RANDOM-NUMBER.                              09160000
091700     PERFORM 4200-READ-DUPL-TSHIPMT                               09170000
091800          WITH TEST AFTER                                         09180000
091900          UNTIL PV-SHIPMT-COUNT = 0.                              09190000
092000                                                                  09200000
092100     MOVE SU044-SHIPT-UNT-ID    TO DK-SHIPT-UNT-ID.               09210000
092200     PERFORM 4300-SELECT-SHIP-DATE.                               09220024
092300     MOVE SU044-PO              TO DK-PO-NBR.                     09230000
092400     MOVE SU044-ORIG-REC-SEQ-NBR                                  09240000
092500                                TO DK-REC-SEQ-NBR.                09250000
092600     MOVE SU044-ORIG-PRO-NBR TO SHIPMT-PRO-NBR.                   09260007
092700     PERFORM 4450-CHK-SCAC-PRO-BOL.                               09270004
092800     IF PS-PRO-BOL-SCAC-EXISTS                                    09280004
092900        PERFORM 4460-CREATE-NEW-PRO                               09290004
093000     END-IF.                                                      09300007
093100     MOVE DK-CURR-SHIPT-ID      TO PV-CURR-SHIPT-ID.              09310000
093200                                                                  09320000
093300     PERFORM 4500-INSERT-TSHIPMT.                                 09330000
093400                                                                  09340000
093500 2100-GET-RANDOM-NUMBER.                                          09350000
093510                                                                  09351061
093520     IF  PS-BLD-INTERNAL-TABLE-YES                                09352061
093530         MOVE  '2100'  TO  PT-CURR-PARA                           09353061
093540         PERFORM 8120-INTERNAL-TABLE                              09354061
093550     END-IF.                                                      09355061
093560                                                                  09356061
093600     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     09360073
093700                                                                  09370000
095700     CALL PC-RANDNBR-PGM USING DFHEIBLK                           09570075
095710                               DFHCOMMAREA                        09571075
095720                               DP902-RANDNBR-ROUTINE-FIELDS.      09572075
095800                                                                  09580000
095900     IF  DP902-SUCCESSFUL                                         09590073
096000         NEXT SENTENCE                                            09600000
096100     ELSE                                                         09610000
096200         STRING                                                   09620000
096300              ' 2100-  RET CDE = '                                09630000
096400              DP902-RETURN-CODE                                   09640073
096500                         DELIMITED BY SIZE                        09650000
096600                       INTO SU044-CRA-RET-MSG                     09660000
096700         MOVE SQLCA     TO SU044-SQLCA                            09670000
096800         SET SU044-INVALID-SQL TO TRUE                            09680000
096900     END-IF.                                                      09690000
097000  EJECT                                                           09700000
097100                                                                  09710000
097200 3000-SEL-ARRVD-TRIP-TMST.                                        09720010
097210                                                                  09721061
097220     IF  PS-BLD-INTERNAL-TABLE-YES                                09722061
097230         MOVE  '3000'  TO  PT-CURR-PARA                           09723061
097240         PERFORM 8120-INTERNAL-TABLE                              09724061
097250     END-IF.                                                      09725061
097300                                                                  09730010
097400       EXEC SQL                                                   09740010
097500         SELECT TIMESTAMP(STATUS_DTE,STATUS_TME)                  09750010
097600           INTO :PV-ARRVD-TIMESTAMP                               09760010
097700           FROM TTRIPST A                                         09770010
097800          WHERE A.TRIP_ID            =  :SU044-TRIP-ID            09780010
097900            AND A.TRIP_STATUS_CDE    =  'AR'                      09790010
097910           with ur                                                09791056
098000       END-EXEC                                                   09800010
098100                                                                  09810010
098200       EVALUATE TRUE                                              09820010
098300           WHEN SQLCODE = +0                                      09830010
098400                CONTINUE                                          09840010
098500           WHEN SQLCODE = +100                                    09850010
098600                MOVE PC-DEFAULT-TMST TO PV-ARRVD-TIMESTAMP        09860010
098700           WHEN SQLWARN0 NOT = SPACES                             09870010
098800           WHEN SQLCODE < +0                                      09880010
098900           WHEN SQLCODE > +0                                      09890010
098910                                                                  09891058
098912                MOVE '3000'  TO  PV-CSSL-PARA                     09891258
098920                perform 8110-WRITE-suws044-TO-CSSL                09892058
098940                                                                  09894058
099000               MOVE DK-PO-NBR       TO PV-DISP-PO-NBR             09900010
099010               MOVE SU044-TRIP-ID   TO PV-DISP-TRIP               09901058
099100               MOVE SQLCODE TO PV-DISP-SQLCODE                    09910010
099200               STRING                                             09920010
099300                    ' SUKUT703 - 3000- '                          09930058
099310                    ' SQL:'            PV-DISP-SQLCODE            09931072
099400                    ' TRIP:'           PV-DISP-TRIP               09940058
099500                    ' PO:'             PV-DISP-PO-NBR             09950058
099700                                       DELIMITED BY SIZE          09970058
099800                                  INTO SU044-CRA-RET-MSG          09980058
099900               MOVE SQLCA           TO SU044-SQLCA                09990058
100000               SET SU044-INVALID-SQL TO TRUE                      10000010
100100       END-EVALUATE.                                              10010010
100200                                                                  10020010
100300 4000-GET-ENT-NAME-DESC.                                          10030010
100310                                                                  10031061
100320     IF  PS-BLD-INTERNAL-TABLE-YES                                10032061
100330         MOVE  '4000'  TO  PT-CURR-PARA                           10033061
100340         PERFORM 8120-INTERNAL-TABLE                              10034061
100350     END-IF.                                                      10035061
100400                                                                  10040000
100500     PERFORM                                                      10050000
100600         WITH TEST AFTER                                          10060000
100700         VARYING PV-RETRY-COUNTER                                 10070000
100800         FROM 1 BY 1                                              10080000
100900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10090000
101000             OR (SQLCODE = +0)                                    10100000
101100             OR (SQLCODE = +100))                                 10110000
101200                                                                  10120000
101300         EXEC SQL                                                 10130000
101400              SELECT A.DEPT_NBR                                   10140000
101500                 ,   A.VER_NBR                                    10150000
101600                 ,   B.ENT_NAME_DESC                              10160000
101700                 ,   B.ENT_ID                                     10170000
101800                INTO :PURCHS-DEPT-NBR                             10180000
101900                 ,   :PURCHS-VER-NBR                              10190000
102000                 ,   :ENTNME-ENT-NAME-DESC                        10200000
102100                 ,   :ENTNME-ENT-ID                               10210000
102200                FROM TPURCHS A                                    10220000
102300                    ,TENTNME B                                    10230000
102400               WHERE A.PO_NBR         = :DK-PO-NBR                10240000
102500                 AND A.VER_STATUS_CDE = 'A'                       10250000
102600                 AND B.TYPE_CDE       = '01'                      10260000
102700                 AND A.ENT_ID = B.ENT_ID                          10270000
102710                with ur                                           10271056
102800         END-EXEC                                                 10280000
102900                                                                  10290000
103000         EVALUATE TRUE                                            10300000
103100             WHEN SQLCODE = +0                                    10310000
103200                  MOVE PURCHS-DEPT-NBR                            10320000
103300                                  TO DK-DEPT-NBR                  10330000
103400                  MOVE PURCHS-VER-NBR                             10340000
103500                                  TO PV-VER-NBR                   10350000
103600             WHEN SQLCODE = +100                                  10360000
103700                  MOVE SPACES     TO DK-DEPT-NBR                  10370000
103800                  MOVE +1         TO PV-VER-NBR                   10380000
103900                                                                  10390000
104000             WHEN SQLCODE = -904                                  10400000
104100             WHEN SQLCODE = -913                                  10410000
104200                  CONTINUE                                        10420000
104300                                                                  10430000
104400             WHEN SQLWARN0 NOT = SPACES                           10440000
104500             WHEN SQLCODE < +0                                    10450000
104600             WHEN SQLCODE > +0                                    10460000
104610                                                                  10461058
104611                  MOVE '4000'  TO  PV-CSSL-PARA                   10461158
104620                  perform 8110-WRITE-suws044-TO-CSSL              10462058
104630                                                                  10463058
104700                 MOVE DK-PO-NBR     TO PV-DISP-PO-NBR             10470058
104800                 MOVE SQLCODE    TO PV-DISP-SQLCODE               10480058
104900                 STRING                                           10490000
105000                      ' SUKUT703 - 4000- '                        10500058
105100                      ' SQL:'       PV-DISP-SQLCODE               10510058
105200                      ' PO:'        PV-DISP-PO-NBR                10520058
105400                                    DELIMITED BY SIZE             10540058
105500                               INTO SU044-CRA-RET-MSG             10550000
105600                 MOVE SQLCA     TO SU044-SQLCA                    10560000
105700                 SET SU044-INVALID-SQL TO TRUE                    10570000
105800         END-EVALUATE                                             10580000
105900     END-PERFORM.                                                 10590000
106000                                                                  10600000
106100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES  and                   10610059
106200         (SQLCODE NOT = +0)                                       10620059
106410         MOVE DK-PO-NBR     TO PV-DISP-PO-NBR                     10641059
106420         MOVE SQLCODE    TO PV-DISP-SQLCODE                       10642059
106430         STRING                                                   10643059
106440              ' SUKUT703 - 4000- '                                10644059
106441              ' MAX RETRY '                                       10644159
106450              ' SQL:'       PV-DISP-SQLCODE                       10645059
106460              ' PO:'        PV-DISP-PO-NBR                        10646059
106470                            DELIMITED BY SIZE                     10647059
106480                       INTO SU044-CRA-RET-MSG                     10648059
107200         MOVE SQLCA      TO SU044-SQLCA                           10720059
107300         SET SU044-INVALID-SQL TO TRUE                            10730000
107400     END-IF.                                                      10740000
107500                                                                  10750000
107600*----------------------------------------------------------------*10760000
107700*    CHECK TO SEE WHAT TYPES OF SERVICES THIS PO HAS             *10770000
107800*----------------------------------------------------------------*10780000
107900 4100-CHECK-PO-SERVICE-INFO.                                      10790000
107910                                                                  10791061
107920     IF  PS-BLD-INTERNAL-TABLE-YES                                10792061
107930         MOVE  '4100'  TO  PT-CURR-PARA                           10793061
107940         PERFORM 8120-INTERNAL-TABLE                              10794061
107950     END-IF.                                                      10795061
107960                                                                  10796061
108000     MOVE SU044-PO           TO DK-PO-NBR.                        10800000
108100                                                                  10810000
108200     PERFORM                                                      10820000
108300         WITH TEST AFTER                                          10830000
108400         VARYING PV-RETRY-COUNTER                                 10840000
108500         FROM 1 BY 1                                              10850000
108600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10860000
108700             OR (SQLCODE = +0)                                    10870000
108800             OR (SQLCODE = +100))                                 10880000
108900                                                                  10890000
109000         EXEC SQL                                                 10900000
109100              SELECT COUNT(*)                                     10910000
109200                INTO :PV-DB2-COUNT                                10920000
109300                FROM TPOAGMT                                      10930000
109400               WHERE PO_NBR         = :DK-PO-NBR                  10940000
109500                 AND AGRMT_TYP_ID   = :DK-AGRMT-TYP-ID            10950000
109600                 AND VER_STATUS_CDE = 'A'                         10960000
109700                 AND TYP_CDE        = :DK-TYP-CDE                 10970000
109710                with ur                                           10971056
109800         END-EXEC                                                 10980000
109900                                                                  10990000
110000         EVALUATE TRUE                                            11000000
110100             WHEN SQLCODE = +0                                    11010000
110200             WHEN SQLCODE = +100                                  11020000
110300             WHEN SQLCODE = -904                                  11030000
110400             WHEN SQLCODE = -913                                  11040000
110500                  CONTINUE                                        11050000
110600                                                                  11060000
110700             WHEN SQLWARN0 NOT = SPACES                           11070000
110800             WHEN SQLCODE < +0                                    11080000
110900             WHEN SQLCODE > +0                                    11090000
110910                                                                  11091058
110911                  MOVE '4100'  TO  PV-CSSL-PARA                   11091158
110920                  perform 8110-WRITE-suws044-TO-CSSL              11092058
110930                                                                  11093058
111000                 MOVE SQLCODE TO PV-DISP-SQLCODE                  11100000
111100                 MOVE DK-PO-NBR        TO PV-DISP-PO-NBR          11110000
111200                 MOVE DK-TYP-CDE       TO PV-DISP-TYP-CDE         11120000
111300                 STRING                                           11130000
111400                      ' SUKUT703 - 4100- '                        11140058
111500                      ' SQL:'             PV-DISP-SQLCODE         11150058
111600                      ' PO:'              PV-DISP-PO-NBR          11160058
111800                      ' AGRMT TYP:'       DK-AGRMT-TYP-ID         11180058
112000                      ' TYP CDE:'         PV-DISP-TYP-CDE         11200058
112200                                          DELIMITED BY SIZE       11220058
112300                                     INTO SU044-CRA-RET-MSG       11230058
112400                 MOVE SQLCA            TO SU044-SQLCA             11240058
112500                 SET SU044-INVALID-SQL TO TRUE                    11250000
112600         END-EVALUATE                                             11260000
112700     END-PERFORM.                                                 11270000
112800                                                                  11280000
112900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11290000
113000             AND (SQLCODE NOT = +0)                               11300000
113010                 MOVE SQLCODE TO PV-DISP-SQLCODE                  11301059
113020                 MOVE DK-PO-NBR        TO PV-DISP-PO-NBR          11302059
113030                 MOVE DK-TYP-CDE       TO PV-DISP-TYP-CDE         11303059
113040                 STRING                                           11304059
113050                      ' SUKUT703 - 4100- '                        11305059
113051                      ' MAX RETRY '                               11305159
113060                      ' SQL:'             PV-DISP-SQLCODE         11306059
113070                      ' PO:'              PV-DISP-PO-NBR          11307059
113080                      ' AGRMT TYP:'       DK-AGRMT-TYP-ID         11308059
113090                      ' TYP CDE:'         PV-DISP-TYP-CDE         11309059
113091                                          DELIMITED BY SIZE       11309159
113092                                     INTO SU044-CRA-RET-MSG       11309259
114500         MOVE SQLCA     TO SU044-SQLCA                            11450000
114600         SET SU044-INVALID-SQL TO TRUE                            11460000
114700     END-IF.                                                      11470000
114800                                                                  11480000
114900 4200-READ-DUPL-TSHIPMT.                                          11490000
114910                                                                  11491061
114920     IF  PS-BLD-INTERNAL-TABLE-YES                                11492061
114930         MOVE  '4200'  TO  PT-CURR-PARA                           11493061
114940         PERFORM 8120-INTERNAL-TABLE                              11494061
114950     END-IF.                                                      11495061
115000                                                                  11500000
115100     MOVE DP902-RANDOM-NUMBER   TO DK-CURR-SHIPT-ID.              11510073
115200                                                                  11520000
115300     PERFORM                                                      11530000
115400         WITH TEST AFTER                                          11540000
115500         VARYING PV-RETRY-COUNTER                                 11550000
115600         FROM 1 BY 1                                              11560000
115700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11570000
115800             OR (SQLCODE = +0))                                   11580000
115900                                                                  11590000
116000         EXEC SQL                                                 11600000
116100              SELECT COUNT(*)                                     11610000
116200               INTO :PV-SHIPMT-COUNT                              11620000
116300                FROM  TSHIPMT                                     11630000
116400               WHERE (SHIPT_ID        = :DK-CURR-SHIPT-ID)        11640000
116500         END-EXEC                                                 11650000
116600                                                                  11660000
116700         EVALUATE TRUE                                            11670000
116800             WHEN SQLCODE = +0                                    11680000
116900             WHEN SQLCODE = -904                                  11690000
117000             WHEN SQLCODE = -913                                  11700000
117100                 CONTINUE                                         11710000
117200                                                                  11720000
117300             WHEN SQLWARN0 NOT = SPACES                           11730000
117400             WHEN SQLCODE < +0                                    11740000
117500             WHEN SQLCODE > +0                                    11750000
117510                                                                  11751058
117511                  MOVE '4200'  TO  PV-CSSL-PARA                   11751158
117520                  perform 8110-WRITE-suws044-TO-CSSL              11752058
117530                                                                  11753058
117600                 MOVE DK-CURR-SHIPT-ID TO PV-DISP-SHIPT-ID        11760000
117700                 MOVE SQLCODE          TO PV-DISP-SQLCODE         11770058
117800                 STRING                                           11780000
117900                      ' SUKUT703 - 4200- '                        11790058
118000                      ' SQL:'             PV-DISP-SQLCODE         11800058
118100                      ' SHIPT ID:'        PV-DISP-SHIPT-ID        11810058
118300                                          DELIMITED BY SIZE       11830058
118400                                     INTO SU044-CRA-RET-MSG       11840058
118500                 MOVE SQLCA            TO SU044-SQLCA             11850058
118600                 SET SU044-INVALID-SQL TO TRUE                    11860000
118700         END-EVALUATE                                             11870000
118800     END-PERFORM.                                                 11880000
118900                                                                  11890000
119000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11900000
119100             AND (SQLCODE NOT = +0)                               11910000
119110                 MOVE DK-CURR-SHIPT-ID TO PV-DISP-SHIPT-ID        11911059
119120                 MOVE SQLCODE          TO PV-DISP-SQLCODE         11912059
119130                 STRING                                           11913059
119140                      ' SUKUT703 - 4200- '                        11914059
119141                      ' MAX RETRY '                               11914159
119150                      ' SQL:'             PV-DISP-SQLCODE         11915059
119160                      ' SHIPT ID:'        PV-DISP-SHIPT-ID        11916059
119170                                          DELIMITED BY SIZE       11917059
119180                                     INTO SU044-CRA-RET-MSG       11918059
120100         MOVE SQLCA     TO SU044-SQLCA                            12010000
120200         SET SU044-INVALID-SQL TO TRUE                            12020000
120300     END-IF.                                                      12030000
120400                                                                  12040000
120500     IF PV-SHIPMT-COUNT > 0                                       12050000
120600         PERFORM 2100-GET-RANDOM-NUMBER                           12060000
120700     END-IF.                                                      12070000
120800/                                                                 12080000
120900                                                                  12090000
121000 4300-SELECT-SHIP-DATE.                                           12100024
121010                                                                  12101061
121020     IF  PS-BLD-INTERNAL-TABLE-YES                                12102061
121030         MOVE  '4300'  TO  PT-CURR-PARA                           12103061
121040         PERFORM 8120-INTERNAL-TABLE                              12104061
121050     END-IF.                                                      12105061
121100                                                                  12110000
121200     EXEC SQL                                                     12120000
121300          SELECT  DISTINCT B.VEND_SHIP_DTE                        12130025
121500            INTO  :PKSLIP-VEND-SHIP-DTE                           12150024
121700            FROM  TINPKSU A                                       12170000
121800              ,   TPKSLIP B                                       12180000
121900           WHERE  A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID             12190000
122000             AND  A.PO_NBR         = B.PO_NBR                     12200000
122100             AND  A.SEQ_NBR        = B.SEQ_NBR                    12210000
122200             AND  B.VER_STAT_CDE   = 'A'                          12220000
122300            with ur                                               12230056
122400     END-EXEC.                                                    12240000
122500                                                                  12250000
122600     EVALUATE TRUE                                                12260000
122700         WHEN SQLCODE = ZERO                                      12270000
122800              CONTINUE                                            12280000
122900         WHEN SQLWARN0 NOT = SPACES                               12290000
123000         WHEN SQLCODE < ZERO                                      12300000
123100         WHEN SQLCODE > ZERO                                      12310000
123110                                                                  12311058
123111              MOVE '4300'  TO  PV-CSSL-PARA                       12311158
123120              perform 8110-WRITE-suws044-TO-CSSL                  12312058
123130                                                                  12313058
123200              MOVE DK-SHIPT-UNT-ID  TO PV-DISP-SSCC               12320058
123300              MOVE SQLCODE TO PV-DISP-SQLCODE                     12330000
123400              STRING                                              12340000
123500                   ' SUKUT703 - 4300- '                           12350058
123600                   ' SQL:'             PV-DISP-SQLCODE            12360058
123700                   ' SSCC:'            PV-DISP-SSCC               12370058
123900                                       DELIMITED BY SIZE          12390058
124000                                  INTO SU044-CRA-RET-MSG          12400058
124100              MOVE SQLCA            TO SU044-SQLCA                12410058
124200              SET SU044-INVALID-SQL TO TRUE                       12420000
124300     END-EVALUATE.                                                12430000
124400                                                                  12440000
124500 4450-CHK-SCAC-PRO-BOL.                                           12450000
124518                                                                  12451861
124520     IF  PS-BLD-INTERNAL-TABLE-YES                                12452061
124530         MOVE  '4450'  TO  PT-CURR-PARA                           12453061
124540         PERFORM 8120-INTERNAL-TABLE                              12454061
124550     END-IF.                                                      12455061
124600                                                                  12460000
124700     EXEC SQL                                                     12470000
124800      SELECT  B.PRO_NBR                                           12480000
124900         INTO :SHIPMT-PRO-NBR                                     12490000
125000      FROM    TSHPTPO A                                           12500000
125100             ,TSHIPMT B                                           12510000
125200      WHERE A.PO_NBR         = :DK-PO-NBR                         12520000
125300        AND A.PRIM_SHIPT_IND = 'Y'                                12530000
125400        AND A.SHIPT_ID       = B.SHIPT_ID                         12540000
125500        AND B.BOL_NBR        = :SU044-ORIG-BOL-NBR                12550000
125600        AND B.PRO_NBR        = :SHIPMT-PRO-NBR                    12560006
125700        AND B.TRIP_ID        = :SU044-TRIP-ID                     12570000
125710       with ur                                                    12571056
125800     END-EXEC.                                                    12580000
125900                                                                  12590000
126000     EVALUATE TRUE                                                12600000
126100         WHEN SQLCODE = +0                                        12610000
126110         WHEN SQLCODE = -811                                      12611088
126200             SET PS-PRO-BOL-SCAC-EXISTS TO TRUE                   12620004
126210                                                                  12621088
126300         WHEN SQLCODE = +100                                      12630000
126400             SET PS-PRO-BOL-SCAC-NOT-EXISTS TO TRUE               12640005
126500             MOVE SHIPMT-PRO-NBR TO SU044-NEW-PRO-NBR             12650008
126600         WHEN SQLWARN0 NOT = SPACE                                12660000
126700         WHEN SQLCODE < +0                                        12670000
126800         WHEN SQLCODE > +0                                        12680000
126810                                                                  12681058
126811              MOVE '4450'  TO  PV-CSSL-PARA                       12681158
126820              perform 8110-WRITE-suws044-TO-CSSL                  12682060
126830                                                                  12683058
126900             MOVE DK-PO-NBR       TO PV-DISP-PO                   12690058
127000             MOVE SQLCODE         TO PV-DISP-SQLCODE              12700058
127100             STRING                                               12710000
127200                  ' SUKUT703 - 4450- '                            12720058
127300                  ' SQL:'            PV-DISP-SQLCODE              12730058
127400                  ' PO:'             PV-DISP-PO                   12740058
127600                                     DELIMITED BY SIZE            12760058
127700                                INTO SU044-CRA-RET-MSG            12770058
127800             MOVE SQLCA           TO SU044-SQLCA                  12780058
127900             SET SU044-INVALID-SQL TO TRUE                        12790000
128000     END-EVALUATE.                                                12800000
128100                                                                  12810000
128110                                                                  12811082
128201                                                                  12820182
128288                                                                  12828887
128289 4460-CREATE-NEW-PRO.                                             12828982
128290                                                                  12829061
128307     IF  PS-BLD-INTERNAL-TABLE-YES                                12830761
128308         MOVE  '4460'  TO  PT-CURR-PARA                           12830861
128309         PERFORM 8120-INTERNAL-TABLE                              12830961
128310     END-IF.                                                      12831061
128320                                                                  12832000
128400     MOVE SU044-ORIG-PRO-NBR  TO  PV-22-CURR-PRO-NBR              12840004
128500     SET PV-PRO-INDEX  TO 1.                                      12850003
128600     PERFORM 4470-PROCESS-PRO-CHARACTERS                          12860000
128700         VARYING PV-PRO-INDEX FROM 1 BY 1                         12870002
128800         UNTIL PV-PRO-INDEX > 22 OR                               12880002
128900         PS-PRO-BOL-SCAC-NOT-EXISTS.                              12890004
129000                                                                  12900001
129098                                                                  12909884
129099                                                                  12909984
129100 4470-PROCESS-PRO-CHARACTERS.                                     12910000
129110                                                                  12911061
129120     IF  PS-BLD-INTERNAL-TABLE-YES                                12912061
129130         MOVE  '4470'  TO  PT-CURR-PARA                           12913061
129140         PERFORM 8120-INTERNAL-TABLE                              12914061
129150     END-IF.                                                      12915061
129160                                                                  12916061
129200     MOVE PV-CURR-CHAR-PRO (PV-PRO-INDEX) TO PV-VERIFY-CHAR.      12920002
129300     IF PV-VALID-CHARACTER                                        12930003
129400         CONTINUE                                                 12940006
129500     ELSE                                                         12950001
129600       PERFORM 4480-CHECK-FOR-EXISTING-PRO                        12960002
129700           VARYING ALPHA-INDEX FROM 1 BY 1                        12970002
129800           UNTIL ALPHA-INDEX  > 26 OR                             12980002
129900           PS-PRO-BOL-SCAC-NOT-EXISTS                             12990004
130000     END-IF.                                                      13000000
130100                                                                  13010000
130200 4480-CHECK-FOR-EXISTING-PRO.                                     13020002
130210                                                                  13021061
130220     IF  PS-BLD-INTERNAL-TABLE-YES                                13022061
130230         MOVE  '4480'  TO  PT-CURR-PARA                           13023061
130240         PERFORM 8120-INTERNAL-TABLE                              13024061
130250     END-IF.                                                      13025061
130260                                                                  13026061
130300      MOVE ALPHABET-CHAR (ALPHA-INDEX) TO                         13030002
130400                        PV-CURR-CHAR-PRO (PV-PRO-INDEX)           13040002
130500                                                                  13050002
130600      MOVE PV-22-CURR-PRO-NBR TO SHIPMT-PRO-NBR.                  13060002
130700      PERFORM 4450-CHK-SCAC-PRO-BOL.                              13070002
130800                                                                  13080002
130900                                                                  13090002
131000 4500-INSERT-TSHIPMT.                                             13100000
131010                                                                  13101061
131020     IF  PS-BLD-INTERNAL-TABLE-YES                                13102061
131030         MOVE  '4500'  TO  PT-CURR-PARA                           13103061
131040         PERFORM 8120-INTERNAL-TABLE                              13104061
131050     END-IF.                                                      13105061
131100                                                                  13110000
131200     INITIALIZE DCLTSHIPMT.                                       13120000
131300                                                                  13130000
131400     MOVE SU044-TRIP-ID            TO SHIPMT-TRIP-ID.             13140000
131500     MOVE PV-CURR-SHIPT-ID         TO SHIPMT-SHIPT-ID.            13150000
131600     MOVE 'PA'                     TO SHIPMT-CRT-SRC-CDE.         13160000
131700     MOVE SU044-SCAC-ID            TO SHIPMT-PRO-SCAC-ID          13170000
131800                                      SHIPMT-ORIG-SCAC-ID.        13180000
131900     MOVE SU044-NEW-PRO-NBR        TO SHIPMT-PRO-NBR              13190008
132000                                      SHIPMT-COMPLETE-PRO-NBR.    13200008
132100     MOVE SU044-ORIG-BOL-NBR       TO SHIPMT-BOL-NBR              13210008
132200                                      SHIPMT-COMPLETE-BOL-NBR.    13220008
132210* START   12-19-2011 CHRISTINE TWIEHAUS    WR40574                13221038
132220     MOVE SU044-CARR-AUTH-ID       TO SHIPMT-CARR-AUTH-ID.        13222038
132230* END     12-19-2011 CHRISTINE TWIEHAUS    WR40574                13223038
132300     MOVE +1                       TO SHIPMT-SHIPT-TYP-CDE.       13230000
132400     MOVE 'CTN'                    TO SHIPMT-PKG-TYP-CDE          13240000
132500     MOVE SPACES                   TO SHIPMT-FRGT-TERMS-CDE       13250000
132600     MOVE +1                       TO SHIPMT-EXPTED-PKG-QTY.      13260000
132700     MOVE ZEROES                   TO SHIPMT-FRGT-CHG-AMT         13270000
132800                                      SHIPMT-EXPTED-PLT-QTY       13280000
132900     MOVE PKSLIP-VEND-SHIP-DTE     TO SHIPMT-VEND-SHIP-DTE.       13290024
133000                                                                  13300000
133100     MOVE PC-CURRENT-PROGRAM-NAME  TO SHIPMT-LAST-UPD-PGM-ID.     13310000
133200     MOVE '0001-01-01'             TO SHIPMT-CARR-LAST-UPD-DTE    13320000
133300                                      SHIPMT-CONFIRM-DTE          13330000
133400                                      SHIPMT-PROCESSED-DTE        13340000
133500                                      SHIPMT-VEND-LAST-UPD-DTE.   13350000
133600     MOVE '00.00.00'               TO SHIPMT-CARR-LAST-UPD-TIME   13360000
133700                                      SHIPMT-CONFIRM-TIME         13370000
133800                                      SHIPMT-VEND-LAST-UPD-TIME.  13380000
133900     MOVE ZEROES                   TO SHIPMT-CARR-CART-CT         13390000
134000                                      SHIPMT-VEND-CART-CT.        13400000
134100     MOVE SU044-VEH-NBR            TO SHIPMT-VEH-NBR.             13410000
134200     MOVE SPACES                   TO SHIPMT-AUTH-NBR.            13420000
134300     MOVE '0001-01-01'             TO SHIPMT-AUTH-DTE.            13430000
134400                                                                  13440000
134500     PERFORM                                                      13450000
134600         WITH TEST AFTER                                          13460000
134700         VARYING PV-RETRY-COUNTER                                 13470000
134800         FROM 1 BY 1                                              13480000
134900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13490000
135000             OR (SQLCODE = +0))                                   13500000
135100                                                                  13510000
135110* 12-19-2011 CHRISTINE TWIEHAUS WR40574 ADDED CARR AUTH ID BELOW  13511038
135200         EXEC SQL                                                 13520000
135300             INSERT  INTO TSHIPMT                                 13530000
135400                   ( TRIP_ID                                      13540000
135500                    ,SHIPT_ID                                     13550000
135600                    ,CRT_SRC_CDE                                  13560000
135700                    ,LAST_UPD_UID                                 13570000
135800                    ,PRO_SCAC_ID                                  13580000
135900                    ,PRO_NBR                                      13590000
136000                    ,BOL_NBR                                      13600000
136100                    ,SHIPPER_NME                                  13610000
136200                    ,SHIPT_TYP_CDE                                13620000
136300                    ,PKG_TYP_CDE                                  13630000
136400                    ,EXPTED_PKG_QTY                               13640000
136500                    ,FRGT_CHG_AMT                                 13650000
136600                    ,FRGT_TERMS_CDE                               13660000
136700                    ,EXPTED_PLT_QTY                               13670000
136800                    ,VEND_SHIP_DTE                                13680000
136900                    ,EST_AR_TMST                                  13690000
137000                    ,ORIG_SCAC_ID                                 13700000
137100                    ,LAST_UPD_PGM_ID                              13710000
137200                    ,CRE_USER_ID                                  13720000
137300                    ,CARR_CART_CT                                 13730000
137400                    ,CARR_LAST_UPD_DTE                            13740000
137500                    ,CARR_LAST_UPD_TIME                           13750000
137600                    ,VEND_CART_CT                                 13760000
137700                    ,VEND_LAST_UPD_DTE                            13770000
137800                    ,VEND_LAST_UPD_TIME                           13780000
137900                    ,VEH_NBR                                      13790000
138000                    ,AUTH_NBR                                     13800000
138100                    ,AUTH_DTE                                     13810000
138200                    ,CONFIRM_DTE                                  13820000
138300                    ,CONFIRM_TIME                                 13830000
138400                    ,COMPLETE_PRO_NBR                             13840000
138500                    ,COMPLETE_BOL_NBR                             13850000
138600                    ,PROCESSED_DTE                                13860038
138610                    ,CARR_AUTH_ID  )                              13861038
138700             VALUES                                               13870000
138800                   ( :SHIPMT-TRIP-ID                              13880000
138900                    ,:SHIPMT-SHIPT-ID                             13890000
139000                    ,:SHIPMT-CRT-SRC-CDE                          13900000
139100                    ,:DP020-USERID                                13910000
139200                    ,:SHIPMT-PRO-SCAC-ID                          13920000
139300                    ,:SHIPMT-PRO-NBR                              13930000
139400                    ,:SHIPMT-BOL-NBR                              13940000
139500                    ,:SHIPMT-SHIPPER-NME                          13950000
139600                    ,:SHIPMT-SHIPT-TYP-CDE                        13960000
139700                    ,:SHIPMT-PKG-TYP-CDE                          13970000
139800                    ,:SHIPMT-EXPTED-PKG-QTY                       13980000
139900                    ,:SHIPMT-FRGT-CHG-AMT                         13990000
140000                    ,:SHIPMT-FRGT-TERMS-CDE                       14000000
140100                    ,:SHIPMT-EXPTED-PLT-QTY                       14010000
140200                    ,:SHIPMT-VEND-SHIP-DTE                        14020000
140300                    ,CURRENT TIMESTAMP                            14030000
140400                    ,:SHIPMT-ORIG-SCAC-ID                         14040000
140500                    ,:PC-CURRENT-PROGRAM-NAME                     14050000
140600                    ,:DP020-USERID                                14060000
140700                    ,:SHIPMT-CARR-CART-CT                         14070000
140800                    ,:PC-DEFAULT-DATE                             14080000
140900                    ,:PC-DEFAULT-TIME                             14090000
141000                    ,:SHIPMT-VEND-CART-CT                         14100000
141100                    ,:PC-DEFAULT-DATE                             14110000
141200                    ,:PC-DEFAULT-TIME                             14120000
141300                    ,:SHIPMT-VEH-NBR                              14130000
141400                    ,:SHIPMT-AUTH-NBR                             14140000
141500                    ,:SHIPMT-AUTH-DTE                             14150000
141600                    ,:PC-DEFAULT-DATE                             14160000
141700                    ,:PC-DEFAULT-TIME                             14170000
141800                    ,:SHIPMT-COMPLETE-PRO-NBR                     14180000
141900                    ,:SHIPMT-COMPLETE-BOL-NBR                     14190000
142000                    ,:SHIPMT-PROCESSED-DTE                        14200038
142010                    ,:SHIPMT-CARR-AUTH-ID )                       14201038
142100         END-EXEC                                                 14210000
142200                                                                  14220000
142300         EVALUATE TRUE                                            14230000
142400             WHEN SQLCODE = +0                                    14240000
142500             WHEN SQLCODE = -904                                  14250000
142600             WHEN SQLCODE = -913                                  14260000
142700                 CONTINUE                                         14270000
142800                                                                  14280000
142900             WHEN SQLWARN0 NOT = SPACES                           14290000
143000             WHEN SQLCODE < +0                                    14300000
143100             WHEN SQLCODE > +0                                    14310000
143110                                                                  14311058
143111                  MOVE '4500'  TO  PV-CSSL-PARA                   14311158
143120                  perform 8110-WRITE-suws044-TO-CSSL              14312058
143130                                                                  14313058
143200                 MOVE SHIPMT-SHIPT-ID TO PV-DISP-SHIPT-ID         14320000
143300                 MOVE SHIPMT-TRIP-ID  TO PV-DISP-TRIP-ID          14330000
143400                 MOVE SQLCODE         TO PV-DISP-SQLCODE          14340058
143500                 STRING                                           14350000
143600                      ' SUKUT703 - 4500- '                        14360058
143700                      ' SQL:'            PV-DISP-SQLCODE          14370058
143800                      ' SHIPMT:'         PV-DISP-SHIPT-ID         14380058
144000                      ' TRIP:'           PV-DISP-TRIP-ID          14400058
144200                                         DELIMITED BY SIZE        14420058
144300                                    INTO SU044-CRA-RET-MSG        14430058
144400                 MOVE SQLCA           TO SU044-SQLCA              14440058
144500                 SET SU044-INVALID-SQL TO TRUE                    14450000
144600         END-EVALUATE                                             14460000
144700     END-PERFORM.                                                 14470000
144800                                                                  14480000
144900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14490000
145000             AND (SQLCODE NOT = +0)                               14500000
145010                 MOVE SHIPMT-SHIPT-ID TO PV-DISP-SHIPT-ID         14501059
145020                 MOVE SHIPMT-TRIP-ID  TO PV-DISP-TRIP-ID          14502059
145030                 MOVE SQLCODE         TO PV-DISP-SQLCODE          14503059
145040                 STRING                                           14504059
145050                      ' SUKUT703 - 4500- '                        14505059
145051                      ' MAX RETRY '                               14505159
145060                      ' SQL:'            PV-DISP-SQLCODE          14506059
145070                      ' SHIPMT:'         PV-DISP-SHIPT-ID         14507059
145080                      ' TRIP:'           PV-DISP-TRIP-ID          14508059
145090                                         DELIMITED BY SIZE        14509059
145091                                    INTO SU044-CRA-RET-MSG        14509159
146300         MOVE SQLCA     TO SU044-SQLCA                            14630000
146400         SET SU044-INVALID-SQL TO TRUE                            14640000
146500     END-IF.                                                      14650000
146600                                                                  14660000
146700     EVALUATE TRUE                                                14670000
146800         WHEN SQLCODE = ZERO                                      14680000
146900              PERFORM 6100-INSERT-TSHIPST                         14690000
147000              PERFORM 6200-INSERT-TAUSHIP                         14700000
147100     END-EVALUATE.                                                14710000
147200                                                                  14720000
147300 4550-PKGNG-CDE-FROM-ORIG-RCVR.                                   14730027
147310                                                                  14731027
147330     IF  PS-BLD-INTERNAL-TABLE-YES                                14733061
147340         MOVE  '4550'  TO  PT-CURR-PARA                           14734061
147350         PERFORM 8120-INTERNAL-TABLE                              14735061
147360     END-IF.                                                      14736061
147370                                                                  14737061
147400     MOVE SU044-PO           TO DK-PO-NBR.                        14740000
147410                                                                  14741027
147500     PERFORM                                                      14750000
147600         WITH TEST AFTER                                          14760000
147700         VARYING PV-RETRY-COUNTER                                 14770000
147800         FROM 1 BY 1                                              14780000
147900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14790000
148000             OR (SQLCODE = +0)                                    14800000
148100             OR (SQLCODE = +100))                                 14810000
148200                                                                  14820000
148300         EXEC SQL                                                 14830000
148400             SELECT PACK_BY_ST_IND                                14840028
148500               INTO :PV-PACK-BY-ST-IND                            14850028
148600               FROM TRECEIV                                       14860027
148700               WHERE ORD_NBR        = :DK-PO-NBR                  14870027
148800                 AND REC_SEQ_NBR    = :SU044-ORIG-REC-SEQ-NBR     14880027
148810                 AND VER_STATUS_CDE = 'A'                         14881027
148820                with ur                                           14882056
148900         END-EXEC                                                 14890000
149000                                                                  14900000
149100         EVALUATE TRUE                                            14910000
149200             WHEN SQLCODE = +0                                    14920000
149500             WHEN SQLCODE = +100                                  14950000
149510                 CONTINUE                                         14951027
149700             WHEN SQLCODE = -904                                  14970000
149800             WHEN SQLCODE = -913                                  14980000
149900                 CONTINUE                                         14990000
150000             WHEN SQLWARN0 NOT = SPACES                           15000000
150100             WHEN SQLCODE < +0                                    15010000
150200             WHEN SQLCODE > +0                                    15020000
150210                                                                  15021058
150211                  MOVE '4550'  TO  PV-CSSL-PARA                   15021158
150220                  perform 8110-WRITE-suws044-TO-CSSL              15022058
150230                                                                  15023058
150300                 MOVE SQLCODE TO PV-DISP-SQLCODE                  15030000
150400                 MOVE DK-PO-NBR        TO PV-DISP-PO-NBR          15040000
150500                 STRING                                           15050000
150600                      ' SUKUT703 - 4550- '                        15060058
150700                      ' SQL:'             PV-DISP-SQLCODE         15070058
150800                      ' PO:'              PV-DISP-PO-NBR          15080058
151000                                          DELIMITED BY SIZE       15100058
151100                                     INTO SU044-CRA-RET-MSG       15110058
151200                 MOVE SQLCA            TO SU044-SQLCA             15120058
151300                 SET SU044-INVALID-SQL TO TRUE                    15130000
151400         END-EVALUATE                                             15140000
151500     END-PERFORM.                                                 15150000
151600                                                                  15160000
151700                                                                  15170000
151710 4600-PKGNG-CDE-FROM-PO.                                          15171027
151711                                                                  15171161
151712     IF  PS-BLD-INTERNAL-TABLE-YES                                15171261
151713         MOVE  '4600'  TO  PT-CURR-PARA                           15171361
151714         PERFORM 8120-INTERNAL-TABLE                              15171461
151715     END-IF.                                                      15171561
151716                                                                  15171661
151720     MOVE SU044-PO           TO DK-PO-NBR.                        15172027
151730     PERFORM                                                      15173027
151740         WITH TEST AFTER                                          15174027
151750         VARYING PV-RETRY-COUNTER                                 15175027
151760         FROM 1 BY 1                                              15176027
151770         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15177027
151780             OR (SQLCODE = +0)                                    15178027
151790             OR (SQLCODE = +100))                                 15179027
151791                                                                  15179127
151792         EXEC SQL                                                 15179227
151793             SELECT PKGNG_CDE                                     15179327
151794               INTO :PURCHS-PKGNG-CDE                             15179427
151795               FROM TPURCHS A                                     15179527
151796               WHERE A.PO_NBR = :DK-PO-NBR                        15179627
151797                   AND VER_STATUS_CDE = 'A'                       15179727
151798                 with ur                                          15179856
151799         END-EXEC                                                 15179927
151800                                                                  15180027
151801         EVALUATE TRUE                                            15180127
151802             WHEN SQLCODE = +0                                    15180227
151803                 MOVE PURCHS-PKGNG-CDE                            15180327
151804                          TO PV-PKGNG-CDE                         15180427
151805             WHEN SQLCODE = +100                                  15180527
151806                 MOVE SPACES TO PV-PKGNG-CDE                      15180627
151807             WHEN SQLCODE = -904                                  15180727
151808             WHEN SQLCODE = -913                                  15180827
151809                 CONTINUE                                         15180927
151810             WHEN SQLWARN0 NOT = SPACES                           15181027
151811             WHEN SQLCODE < +0                                    15181127
151812             WHEN SQLCODE > +0                                    15181227
151813                                                                  15181358
151814                  MOVE '4600'  TO  PV-CSSL-PARA                   15181458
151815                  perform 8110-WRITE-suws044-TO-CSSL              15181558
151816                                                                  15181658
151817                 MOVE SQLCODE          TO PV-DISP-SQLCODE         15181758
151818                 MOVE DK-PO-NBR        TO PV-DISP-PO-NBR          15181827
151819                 STRING                                           15181927
151820                      ' SUKUT703 - 4600- '                        15182058
151821                      ' SQL:'             PV-DISP-SQLCODE         15182158
151822                      ' PO:'              PV-DISP-PO-NBR          15182258
151824                                          DELIMITED BY SIZE       15182458
151825                                     INTO SU044-CRA-RET-MSG       15182558
151826                 MOVE SQLCA            TO SU044-SQLCA             15182658
151827                 SET SU044-INVALID-SQL TO TRUE                    15182727
151828         END-EVALUATE                                             15182827
151829     END-PERFORM.                                                 15182927
151830                                                                  15183027
151831                                                                  15183127
151840*----------------------------------------------------------------*15184027
151900* GET THE NEXT HIGHEST RECEIVER SEQ NBR                          *15190000
152000*----------------------------------------------------------------*15200000
152100 4700-GET-MAX-SEQ-NBR.                                            15210000
152110                                                                  15211061
152120     IF  PS-BLD-INTERNAL-TABLE-YES                                15212061
152130         MOVE  '4700'  TO  PT-CURR-PARA                           15213061
152140         PERFORM 8120-INTERNAL-TABLE                              15214061
152150     END-IF.                                                      15215061
152200                                                                  15220000
152300     PERFORM                                                      15230000
152400         WITH TEST AFTER                                          15240000
152500         VARYING PV-RETRY-COUNTER                                 15250000
152600         FROM 1 BY 1                                              15260000
152700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15270000
152800            OR (SQLCODE = +0)                                     15280000
152900            OR (SQLCODE = +100)                                   15290000
153000            OR (SQLCODE = -305))                                  15300000
153100                                                                  15310000
153200         EXEC SQL                                                 15320000
153300           SELECT MAX(REC_SEQ_NBR)                                15330000
153400           INTO  :RECEIV-REC-SEQ-NBR                              15340000
153500           FROM   TRECEIV                                         15350000
153600           WHERE  ORD_NBR = :DK-PO-NBR                            15360000
153700         END-EXEC                                                 15370000
153800                                                                  15380000
153900         EVALUATE TRUE                                            15390000
154000             WHEN SQLCODE = +0                                    15400000
154100                 MOVE RECEIV-REC-SEQ-NBR                          15410000
154200                                 TO PV-REC-SEQ-NBR                15420000
154300                 ADD +1          TO PV-REC-SEQ-NBR                15430000
154400                 MOVE PV-REC-SEQ-NBR TO SU044-NEW-REC-SEQ-NBR     15440000
154500             WHEN SQLCODE = +100                                  15450000
154600             WHEN SQLCODE = -305                                  15460000
154700                 MOVE +1         TO PV-REC-SEQ-NBR                15470000
154800                                                                  15480000
154900             WHEN SQLCODE = -904                                  15490000
155000             WHEN SQLCODE = -913                                  15500000
155100                 CONTINUE                                         15510000
155200                                                                  15520000
155300             WHEN SQLWARN0 NOT = SPACE                            15530000
155400             WHEN SQLCODE < +0                                    15540000
155500             WHEN SQLCODE > +0                                    15550000
155510                                                                  15551058
155511                  MOVE '4700'  TO  PV-CSSL-PARA                   15551158
155520                  perform 8110-WRITE-suws044-TO-CSSL              15552058
155530                                                                  15553058
155600                 MOVE DK-PO-NBR       TO PV-DISP-PO-NBR           15560000
155700                 MOVE SQLCODE         TO PV-DISP-SQLCODE          15570058
155800                 STRING                                           15580000
155900                      ' SUKUT703 - 4700- '                        15590058
156000                      ' SQL:'            PV-DISP-SQLCODE          15600058
156100                      ' PO:'             PV-DISP-PO-NBR           15610058
156300                                         DELIMITED BY SIZE        15630058
156400                                    INTO SU044-CRA-RET-MSG        15640058
156500                 MOVE SQLCA           TO SU044-SQLCA              15650058
156600                 SET SU044-INVALID-SQL TO TRUE                    15660000
156700         END-EVALUATE                                             15670000
156800     END-PERFORM.                                                 15680000
156900                                                                  15690000
157000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15700000
157100             AND (SQLCODE NOT = +0)                               15710000
157110                 MOVE DK-PO-NBR       TO PV-DISP-PO-NBR           15711059
157120                 MOVE SQLCODE         TO PV-DISP-SQLCODE          15712059
157130                 STRING                                           15713059
157140                      ' SUKUT703 - 4700- '                        15714059
157141                      ' MAX RETRY '                               15714159
157150                      ' SQL:'            PV-DISP-SQLCODE          15715059
157160                      ' PO:'             PV-DISP-PO-NBR           15716059
157170                                         DELIMITED BY SIZE        15717059
157180                                    INTO SU044-CRA-RET-MSG        15718059
158100         MOVE SQLCA     TO SU044-SQLCA                            15810000
158200         SET SU044-INVALID-SQL TO TRUE                            15820000
158300     END-IF.                                                      15830000
158400                                                                  15840000
158500/                                                                 15850000
158600*---------------------------------------------------------------* 15860000
158700*  PERFORMS THE ACTUAL INSERT TO THE TRECEIV TABLE.             * 15870000
158800*---------------------------------------------------------------* 15880000
158900 4800-INSERT-TRECEIV.                                             15890000
158910                                                                  15891061
158920     IF  PS-BLD-INTERNAL-TABLE-YES                                15892061
158930         MOVE  '4800'  TO  PT-CURR-PARA                           15893061
158940         PERFORM 8120-INTERNAL-TABLE                              15894061
158950     END-IF.                                                      15895061
159000                                                                  15900000
159100     PERFORM                                                      15910000
159200         WITH TEST AFTER                                          15920000
159300         VARYING PV-RETRY-COUNTER                                 15930000
159400         FROM 1 BY 1                                              15940000
159500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15950000
159600             OR (SQLCODE = +0))                                   15960000
159700                                                                  15970000
159800         EXEC SQL                                                 15980000
159900              INSERT INTO TRECEIV                                 15990000
160000                     ( ORD_NBR                                    16000000
160100                      ,REC_SEQ_NBR                                16010000
160200                      ,CRE_TMST                                   16020000
160300                      ,CRE_UID                                    16030000
160400                      ,PO_VER_NBR                                 16040000
160500                      ,OPER_UNT_ID                                16050000
160600                      ,FCLTY_ID                                   16060000
160700                      ,STATUS_CDE                                 16070000
160800                      ,SYST_CRE_CDE                               16080000
160900                      ,REC_TYP_CDE                                16090000
161000                      ,VER_STATUS_CDE                             16100000
161100                      ,PACK_BY_ST_IND                             16110000
161200                      ,REC_TMST                                   16120000
161300                      ,EXPTED_CART_CNT                            16130000
161400                      ,ACTL_CART_CNT                              16140000
161500                      ,EXPTED_ITM_QTY                             16150000
161600                      ,ACTL_ITM_QTY                               16160000
161700                      ,RCVR_NBR                                   16170000
161800                      ,ML_POST_TMST                               16180000
161900                      ,FS_POST_TMST                               16190000
162000                      ,PRE_TKT_IND                                16200000
162100                      ,AD_INFO_DESC                               16210000
162200                      ,IN_TRBL_TMST                               16220000
162300                      ,IN_TRBL_MIN_CNT                            16230000
162400                      ,IN_TRBL_HOUR_CNT                           16240000
162500                      ,VERFYD_TMST                                16250000
162600                      ,RCVG_CLERK_INIT_ID                         16260000
162700                      ,REFER_BACK_SEQ_NBR                         16270000
162800                      ,AP_PRC_CDE                                 16280000
162900                      ,AP_PRC_DTE                                 16290000
163000                      ,MIS_DIRECT_IND                             16300000
163100                      ,IMPRT_IND                                  16310000
163200                      ,CRE_OPER_UNT_ID                            16320000
163300                      ,CRE_FCLTY_ID                               16330000
163400                      ,CURR_OPER_UNT_ID                           16340000
163500                      ,CURR_FCLTY_ID                              16350000
163600                      ,UPD_TMST                                   16360000
163700                      ,UPD_UID                                    16370000
163800                      ,UPD_PGM_ID                                 16380000
163900                      ,MKNG_APRN_PRT_TMST                         16390000
164000                      ,GOH_IND                                    16400000
164100                      ,AP_RVRSL_DTE                               16410000
164200                      ,PKGNG_CDE                                  16420000
164300                      ,FRE_ASTRA_IND                              16430000
164400                      )                                           16440000
164500             VALUES ( :RECEIV-ORD-NBR                             16450000
164600                     ,:RECEIV-REC-SEQ-NBR                         16460000
164700                     ,CURRENT TIMESTAMP                           16470000
164800                     ,:RECEIV-CRE-UID                             16480000
164900                     ,:RECEIV-PO-VER-NBR                          16490000
165000                     ,:RECEIV-OPER-UNT-ID                         16500000
165100                     ,:RECEIV-FCLTY-ID                            16510000
165200                     ,:RECEIV-STATUS-CDE                          16520000
165300                     ,:RECEIV-SYST-CRE-CDE                        16530000
165400                     ,:RECEIV-REC-TYP-CDE                         16540000
165500                     ,:RECEIV-VER-STATUS-CDE                      16550000
165600                     ,:RECEIV-PACK-BY-ST-IND                      16560000
165700                     ,:RECEIV-REC-TMST                            16570000
165800                     ,:RECEIV-EXPTED-CART-CNT                     16580000
165900                     ,:RECEIV-ACTL-CART-CNT                       16590000
166000                     ,:RECEIV-EXPTED-ITM-QTY                      16600000
166100                     ,:RECEIV-ACTL-ITM-QTY                        16610000
166200                     ,:RECEIV-RCVR-NBR                            16620000
166300                     ,:RECEIV-ML-POST-TMST                        16630000
166400                     ,:RECEIV-FS-POST-TMST                        16640000
166500                     ,:RECEIV-PRE-TKT-IND                         16650000
166600                     ,:RECEIV-AD-INFO-DESC                        16660000
166700                     ,:RECEIV-IN-TRBL-TMST                        16670000
166800                     ,:RECEIV-IN-TRBL-MIN-CNT                     16680000
166900                     ,:RECEIV-IN-TRBL-HOUR-CNT                    16690000
167000                     ,:RECEIV-VERFYD-TMST                         16700000
167100                     ,:RECEIV-RCVG-CLERK-INIT-ID                  16710000
167200                     ,:RECEIV-REFER-BACK-SEQ-NBR                  16720000
167300                     ,:RECEIV-AP-PRC-CDE                          16730000
167400                     ,:RECEIV-AP-PRC-DTE                          16740000
167500                     ,:RECEIV-MIS-DIRECT-IND                      16750000
167600                     ,:RECEIV-IMPRT-IND                           16760000
167700                     ,:RECEIV-CRE-OPER-UNT-ID                     16770000
167800                     ,:RECEIV-CRE-FCLTY-ID                        16780000
167900                     ,:RECEIV-CURR-OPER-UNT-ID                    16790000
168000                     ,:RECEIV-CURR-FCLTY-ID                       16800000
168100                     ,CURRENT TIMESTAMP                           16810000
168200                     ,:RECEIV-UPD-UID                             16820000
168300                     ,:RECEIV-UPD-PGM-ID                          16830000
168400                     ,:RECEIV-MKNG-APRN-PRT-TMST                  16840000
168500                     ,:RECEIV-GOH-IND                             16850000
168600                     ,:PC-DEFAULT-9DATE                           16860000
168700                     ,:RECEIV-PKGNG-CDE                           16870000
168800                     ,:RECEIV-FRE-ASTRA-IND                       16880000
168900                     )                                            16890000
169000         END-EXEC                                                 16900000
169100                                                                  16910000
169200         EVALUATE TRUE                                            16920000
169300             WHEN SQLCODE = +0                                    16930000
169400             WHEN SQLCODE = -904                                  16940000
169500             WHEN SQLCODE = -913                                  16950000
169600                 CONTINUE                                         16960000
169700                                                                  16970000
169800             WHEN SQLWARN0 NOT = SPACE                            16980000
169900             WHEN SQLCODE < +0                                    16990000
170000             WHEN SQLCODE > +0                                    17000000
170010                                                                  17001058
170011                  MOVE '4800'  TO  PV-CSSL-PARA                   17001158
170020                  perform 8110-WRITE-suws044-TO-CSSL              17002058
170030                                                                  17003058
170100                 MOVE RECEIV-ORD-NBR     TO PV-DISP-PO-NBR        17010058
170200                 MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-REC-SEQ       17020000
170300                 MOVE SQLCODE            TO PV-DISP-SQLCODE       17030058
170400                 STRING                                           17040000
170500                      ' SUKUT703 - 4800- '                        17050058
170600                      ' SQL:'               PV-DISP-SQLCODE       17060058
170700                      ' PO:'                PV-DISP-PO-NBR        17070058
171000                      '-'                   PV-DISP-REC-SEQ       17100058
171100                                            DELIMITED BY SIZE     17110058
171200                                       INTO SU044-CRA-RET-MSG     17120058
171300                 MOVE SQLCA              TO SU044-SQLCA           17130058
171400                 SET SU044-INVALID-SQL TO TRUE                    17140000
171500         END-EVALUATE                                             17150000
171600     END-PERFORM.                                                 17160000
171700                                                                  17170000
171800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17180000
171900             AND (SQLCODE NOT = +0)                               17190000
171910                 MOVE RECEIV-ORD-NBR     TO PV-DISP-PO-NBR        17191059
171920                 MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-REC-SEQ       17192059
171930                 MOVE SQLCODE            TO PV-DISP-SQLCODE       17193059
171940                 STRING                                           17194059
171950                      ' SUKUT703 - 4800- '                        17195059
171951                      ' MAX RETRY '                               17195159
171960                      ' SQL:'               PV-DISP-SQLCODE       17196059
171970                      ' PO:'                PV-DISP-PO-NBR        17197059
171980                      '-'                   PV-DISP-REC-SEQ       17198059
171990                                            DELIMITED BY SIZE     17199059
171991                                       INTO SU044-CRA-RET-MSG     17199159
173200         MOVE SQLCA     TO SU044-SQLCA                            17320000
173300         SET SU044-INVALID-SQL TO TRUE                            17330000
173400     END-IF.                                                      17340000
173500                                                                  17350000
173600 4900-INSERT-TPOSYNC.                                             17360000
173610                                                                  17361061
173620     IF  PS-BLD-INTERNAL-TABLE-YES                                17362061
173630         MOVE  '4900'  TO  PT-CURR-PARA                           17363061
173640         PERFORM 8120-INTERNAL-TABLE                              17364061
173650     END-IF.                                                      17365061
173660                                                                  17366061
173700     EXEC SQL                                                     17370000
173800         INSERT INTO TPOSYNC                                      17380000
173900           ( PO_NBR                                               17390000
174000            ,LAST_SYNC_TMST                                       17400000
174100            ,SYNC_STAT_CDE                                        17410000
174200           )                                                      17420000
174300         VALUES                                                   17430000
174400           ( :RECEIV-ORD-NBR                                      17440000
174500           , CURRENT TIMESTAMP                                    17450000
174600           , 'N'                                                  17460000
174700           )                                                      17470000
174800     END-EXEC.                                                    17480000
174900                                                                  17490000
175000     EVALUATE TRUE                                                17500000
175100         WHEN SQLCODE = ZERO                                      17510000
175200         WHEN SQLCODE = -803                                      17520000
175300                 CONTINUE                                         17530000
175400         WHEN SQLCODE = -904                                      17540000
175500         WHEN SQLCODE = -913                                      17550000
175600         WHEN SQLCODE = -911                                      17560000
175610                                                                  17561058
175620              MOVE '4900'  TO  PV-CSSL-PARA                       17562058
175630              perform 8110-WRITE-suws044-TO-CSSL                  17563058
175640                                                                  17564058
175700             MOVE RECEIV-ORD-NBR  TO PV-DISP-PO-NBR               17570000
175800             MOVE SQLCODE         TO PV-DISP-SQLCODE              17580058
175900             STRING                                               17590000
176000                  ' SUKUT703 - 4900- '                            17600058
176100                  ' SQL:'            PV-DISP-SQLCODE              17610058
176200                  ' PO:'             PV-DISP-PO-NBR               17620058
176400                                     DELIMITED BY SIZE            17640058
176500                                INTO SU044-CRA-RET-MSG            17650058
176600             MOVE SQLCA     TO SU044-SQLCA                        17660000
176700             SET SU044-INVALID-SQL TO TRUE                        17670000
176800                                                                  17680000
176900         WHEN SQLWARN0 NOT = SPACE                                17690000
177000         WHEN SQLCODE < ZERO                                      17700000
177100         WHEN SQLCODE > ZERO                                      17710000
177110                                                                  17711058
177111              MOVE '4900'  TO  PV-CSSL-PARA                       17711158
177120              perform 8110-WRITE-suws044-TO-CSSL                  17712058
177130                                                                  17713058
177140             MOVE RECEIV-ORD-NBR  TO PV-DISP-PO-NBR               17714058
177150             MOVE SQLCODE         TO PV-DISP-SQLCODE              17715058
177160             STRING                                               17716058
177170                  ' SUKUT703 - 4900- '                            17717058
177180                  ' SQL:'            PV-DISP-SQLCODE              17718058
177190                  ' PO:'             PV-DISP-PO-NBR               17719058
177191                                     DELIMITED BY SIZE            17719158
177192                                INTO SU044-CRA-RET-MSG            17719258
177193             MOVE SQLCA     TO SU044-SQLCA                        17719358
178200             SET SU044-INVALID-SQL TO TRUE                        17820000
178300     END-EVALUATE.                                                17830000
178400/                                                                 17840000
178500*----------------------------------------------------------------*17850000
178600* OPEN THE TRECVER CURSOR                                        *17860000
178700*----------------------------------------------------------------*17870000
178800                                                                  17880000
178900 5000-OPEN-TRECVER-CSR.                                           17890000
178910                                                                  17891061
178920     IF  PS-BLD-INTERNAL-TABLE-YES                                17892061
178930         MOVE  '5000'  TO  PT-CURR-PARA                           17893061
178940         PERFORM 8120-INTERNAL-TABLE                              17894061
178950     END-IF.                                                      17895061
179000                                                                  17900000
179100     EXEC SQL                                                     17910000
179200          DECLARE TRECVER-CSR CURSOR FOR                          17920000
179300           SELECT MAX_RCVR_NBR                                    17930000
179400           FROM   TRECVER                                         17940000
179500           WHERE  OPERCO_NBR = '03'                               17950000
179600           FOR UPDATE OF MAX_RCVR_NBR                             17960000
179700     END-EXEC.                                                    17970000
179800                                                                  17980000
179900     PERFORM                                                      17990000
180000         WITH TEST AFTER                                          18000000
180100         VARYING PV-RETRY-COUNTER                                 18010000
180200         FROM 1 BY 1                                              18020000
180300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               18030000
180400            OR (SQLCODE = +0))                                    18040000
180500                                                                  18050000
180600         EXEC SQL                                                 18060000
180700              OPEN TRECVER-CSR                                    18070000
180800         END-EXEC                                                 18080000
180900                                                                  18090000
181000         EVALUATE TRUE                                            18100000
181100             WHEN SQLCODE = +0                                    18110000
181200                  CONTINUE                                        18120000
181300             WHEN SQLCODE = -904                                  18130000
181400             WHEN SQLCODE = -913                                  18140000
181500                  CONTINUE                                        18150000
181600             WHEN SQLWARN0 NOT = SPACE                            18160000
181700             WHEN SQLCODE  NOT = +0                               18170000
181710                                                                  18171058
181711                  MOVE '5000'  TO  PV-CSSL-PARA                   18171158
181720                  perform 8110-WRITE-suws044-TO-CSSL              18172058
181730                                                                  18173058
181800                 MOVE SQLCODE  TO PV-DISP-SQLCODE                 18180058
181900                 STRING                                           18190000
182000                      ' SUKUT703 - 5000- '                        18200058
182100                      ' SQL:'     PV-DISP-SQLCODE                 18210058
182200                      ' OPEN CURSOR '                             18220000
182300                                  DELIMITED BY SIZE               18230058
182400                             INTO SU044-CRA-RET-MSG               18240058
182500                 MOVE SQLCA    TO SU044-SQLCA                     18250058
182600                 SET SU044-INVALID-SQL TO TRUE                    18260000
182700         END-EVALUATE                                             18270000
182800     END-PERFORM.                                                 18280000
182900                                                                  18290000
183000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        18300000
183100             AND (SQLCODE NOT = +0)                               18310000
183110                 MOVE SQLCODE  TO PV-DISP-SQLCODE                 18311059
183120                 STRING                                           18312059
183130                      ' SUKUT703 - 5000- '                        18313059
183131                      ' MAX RETRY '                               18313159
183140                      ' SQL:'     PV-DISP-SQLCODE                 18314059
183150                      ' OPEN CURSOR '                             18315059
183160                                  DELIMITED BY SIZE               18316059
183170                             INTO SU044-CRA-RET-MSG               18317059
183900         MOVE SQLCA     TO SU044-SQLCA                            18390000
184000         SET SU044-INVALID-SQL TO TRUE                            18400000
184100     END-IF.                                                      18410000
184200                                                                  18420000
184300/                                                                 18430000
184400*----------------------------------------------------------------*18440000
184500*    FETCH A TRECVER ROW                                         *18450000
184600*----------------------------------------------------------------*18460000
184700                                                                  18470000
184800 5020-FETCH-TRECVER-CSR.                                          18480000
184810                                                                  18481061
184820     IF  PS-BLD-INTERNAL-TABLE-YES                                18482061
184830         MOVE  '5020'  TO  PT-CURR-PARA                           18483061
184840         PERFORM 8120-INTERNAL-TABLE                              18484061
184850     END-IF.                                                      18485061
184900                                                                  18490000
185000     EXEC SQL                                                     18500000
185100          FETCH TRECVER-CSR                                       18510000
185200          INTO :RECVER-MAX-RCVR-NBR                               18520000
185300     END-EXEC                                                     18530000
185400                                                                  18540000
185500     EVALUATE TRUE                                                18550000
185600         WHEN SQLCODE = +0                                        18560000
185700              CONTINUE                                            18570000
185800                                                                  18580000
185900         WHEN SQLCODE = +100                                      18590000
186000              SET PS-EOF-TRECVER-CSR TO TRUE                      18600000
186100                                                                  18610000
186200         WHEN SQLWARN0 NOT = SPACE                                18620000
186300         WHEN SQLCODE < +0                                        18630000
186400         WHEN SQLCODE > +0                                        18640000
186410                                                                  18641058
186411              MOVE '5020'  TO  PV-CSSL-PARA                       18641158
186420              perform 8110-WRITE-suws044-TO-CSSL                  18642058
186430                                                                  18643058
186500             MOVE SQLCODE     TO PV-DISP-SQLCODE                  18650058
186600             STRING                                               18660000
186700                  ' SUKUT703 - 5020- '                            18670058
186800                  ' SQL:'        PV-DISP-SQLCODE                  18680058
186900                  ' FETCH CURSOR '                                18690000
187000                                 DELIMITED BY SIZE                18700058
187100                            INTO SU044-CRA-RET-MSG                18710058
187200             MOVE SQLCA      TO SU044-SQLCA                       18720058
187300             SET SU044-INVALID-SQL TO TRUE                        18730000
187400     END-EVALUATE.                                                18740000
187500                                                                  18750000
187600/                                                                 18760000
187700*----------------------------------------------------------------*18770000
187800*    UDPATE CURRENT CURSOR                                       *18780000
187900*----------------------------------------------------------------*18790000
188000                                                                  18800000
188100 5040-DELETE-TRECVER-CSR.                                         18810000
188110                                                                  18811061
188120     IF  PS-BLD-INTERNAL-TABLE-YES                                18812061
188130         MOVE  '5040'  TO  PT-CURR-PARA                           18813061
188140         PERFORM 8120-INTERNAL-TABLE                              18814061
188150     END-IF.                                                      18815061
188200                                                                  18820000
188300     EXEC SQL                                                     18830000
188400          DELETE FROM TRECVER                                     18840000
188500            WHERE CURRENT OF TRECVER-CSR                          18850000
188600     END-EXEC                                                     18860000
188700                                                                  18870000
188800     EVALUATE TRUE                                                18880000
188900         WHEN SQLCODE = +0                                        18890000
189000              CONTINUE                                            18900000
189100                                                                  18910000
189200         WHEN SQLWARN0 NOT = SPACE                                18920000
189300         WHEN SQLCODE < +0                                        18930000
189400         WHEN SQLCODE > +0                                        18940000
189410                                                                  18941058
189420              MOVE '5040'  TO  PV-CSSL-PARA                       18942058
189430              perform 8110-WRITE-suws044-TO-CSSL                  18943058
189440                                                                  18944058
189500             MOVE SQLCODE    TO PV-DISP-SQLCODE                   18950058
189600             STRING                                               18960000
189700                  ' SUKUT703 - 5040- '                            18970058
189800                  ' SQL:'       PV-DISP-SQLCODE                   18980058
189900                  ' DELETE FROM CURSOR '                          18990000
190000                                DELIMITED BY SIZE                 19000058
190100                           INTO SU044-CRA-RET-MSG                 19010000
190200             MOVE SQLCA      TO SU044-SQLCA                       19020058
190300             SET SU044-INVALID-SQL TO TRUE                        19030000
190400     END-EVALUATE.                                                19040000
190500                                                                  19050000
190600/                                                                 19060000
190700*----------------------------------------------------------------*19070000
190800* INSERT THE TRECVER ROW                                         *19080000
190900*----------------------------------------------------------------*19090000
191000                                                                  19100000
191100 5060-INSERT-TRECVER.                                             19110000
191110                                                                  19111061
191120     IF  PS-BLD-INTERNAL-TABLE-YES                                19112061
191130         MOVE  '5060'  TO  PT-CURR-PARA                           19113061
191140         PERFORM 8120-INTERNAL-TABLE                              19114061
191150     END-IF.                                                      19115061
191200                                                                  19120000
191300     PERFORM                                                      19130000
191400         WITH TEST AFTER                                          19140000
191500         VARYING PV-RETRY-COUNTER                                 19150000
191600         FROM 1 BY 1                                              19160000
191700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19170000
191800             OR (SQLCODE = +0))                                   19180000
191900                                                                  19190000
192000         EXEC SQL                                                 19200000
192100              INSERT INTO TRECVER                                 19210000
192200                     ( OPERCO_NBR                                 19220000
192300                      ,MAX_RCVR_NBR )                             19230000
192400              VALUES ( '03'                                       19240000
192500                      ,:RECVER-MAX-RCVR-NBR )                     19250000
192600         END-EXEC                                                 19260000
192700                                                                  19270000
192800         EVALUATE TRUE                                            19280000
192900             WHEN SQLCODE = +0                                    19290000
193000             WHEN SQLCODE = -904                                  19300000
193100             WHEN SQLCODE = -913                                  19310000
193200                 CONTINUE                                         19320000
193300                                                                  19330000
193400             WHEN SQLWARN0 NOT = SPACE                            19340000
193500             WHEN SQLCODE < +0                                    19350000
193600             WHEN SQLCODE > +0                                    19360000
193610                                                                  19361058
193611                  MOVE '5060'  TO  PV-CSSL-PARA                   19361158
193620                  perform 8110-WRITE-suws044-TO-CSSL              19362058
193630                                                                  19363058
193700                 MOVE SQLCODE   TO PV-DISP-SQLCODE                19370058
193800                 STRING                                           19380000
193900                      ' SUKUT703 - 5060- '                        19390058
194000                      ' SQL:'      PV-DISP-SQLCODE                19400058
194100                      ' INSERT '                                  19410000
194200                                   DELIMITED BY SIZE              19420058
194300                              INTO SU044-CRA-RET-MSG              19430058
194400                 MOVE SQLCA     TO SU044-SQLCA                    19440000
194500                 SET SU044-INVALID-SQL TO TRUE                    19450000
194600         END-EVALUATE                                             19460000
194700     END-PERFORM.                                                 19470000
194800                                                                  19480000
194900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19490000
195000             AND (SQLCODE NOT = +0)                               19500000
195010                                                                  19501059
195020                 MOVE SQLCODE   TO PV-DISP-SQLCODE                19502059
195030                 STRING                                           19503059
195040                      ' SUKUT703 - 5060- '                        19504059
195041                      ' MAX RETRY '                               19504159
195050                      ' SQL:'      PV-DISP-SQLCODE                19505059
195060                      ' INSERT '                                  19506059
195070                                   DELIMITED BY SIZE              19507059
195080                              INTO SU044-CRA-RET-MSG              19508059
195800         MOVE SQLCA     TO SU044-SQLCA                            19580000
195900         SET SU044-INVALID-SQL TO TRUE                            19590000
196000     END-IF.                                                      19600000
196100                                                                  19610000
196200/                                                                 19620000
196300*----------------------------------------------------------------*19630000
196400* CLOSE THE TRECVER CURSOR                                       *19640000
196500*----------------------------------------------------------------*19650000
196600                                                                  19660000
196700 5080-CLOSE-TRECVER-CSR.                                          19670000
196710                                                                  19671061
196720     IF  PS-BLD-INTERNAL-TABLE-YES                                19672061
196730         MOVE  '5080'  TO  PT-CURR-PARA                           19673061
196740         PERFORM 8120-INTERNAL-TABLE                              19674061
196750     END-IF.                                                      19675061
196800                                                                  19680000
196900     EXEC SQL                                                     19690000
197000          CLOSE TRECVER-CSR                                       19700000
197100     END-EXEC                                                     19710000
197200                                                                  19720000
197300     EVALUATE TRUE                                                19730000
197400         WHEN SQLCODE = +0                                        19740000
197500              CONTINUE                                            19750000
197600         WHEN SQLWARN0 NOT = SPACE                                19760000
197700         WHEN SQLCODE  NOT = +0                                   19770000
197710                                                                  19771058
197711              MOVE '5080'  TO  PV-CSSL-PARA                       19771158
197720              perform 8110-WRITE-suws044-TO-CSSL                  19772058
197730                                                                  19773058
197800             MOVE SQLCODE   TO PV-DISP-SQLCODE                    19780058
197900             STRING                                               19790000
198000                  ' SUKUT703 - 5080- '                            19800058
198100                  ' SQL:'      PV-DISP-SQLCODE                    19810058
198200                  ' CLOSE CURSOR'                                 19820000
198300                               DELIMITED BY SIZE                  19830058
198400                          INTO SU044-CRA-RET-MSG                  19840058
198500             MOVE SQLCA     TO SU044-SQLCA                        19850000
198600             SET SU044-INVALID-SQL TO TRUE                        19860000
198700     END-EVALUATE.                                                19870000
198800                                                                  19880000
198900/                                                                 19890000
199000 5100-CHECK-FOR-TROUBLE.                                          19900000
199010                                                                  19901061
199020     IF  PS-BLD-INTERNAL-TABLE-YES                                19902061
199030         MOVE  '5100'  TO  PT-CURR-PARA                           19903061
199040         PERFORM 8120-INTERNAL-TABLE                              19904061
199050     END-IF.                                                      19905061
199100                                                                  19910000
199200     INITIALIZE TM500-FIELDS.                                     19920000
199300                                                                  19930000
199400     SET  TM500-CREATE-AUTO        TO TRUE.                       19940000
199500     SET  TM500-PO-LEVEL           TO TRUE.                       19950000
199600     SET  TM500-NO-DETAILS         TO TRUE.                       19960000
199700                                                                  19970000
199800     MOVE RECEIV-ORD-NBR           TO TM500-PO-NBR.               19980000
199900     MOVE RECEIV-OPER-UNT-ID       TO TM500-OPER-UNT-ID.          19990000
200000     MOVE RECEIV-FCLTY-ID          TO TM500-FCLTY-ID.             20000000
200100     MOVE PC-CURRENT-PROGRAM-NAME  TO TM500-NOTIF-UID.            20010000
200200     MOVE '0001-01-01'             TO TM500-VEND-SHIP-DTE.        20020000
200300     MOVE RECEIV-REC-SEQ-NBR       TO TM500-REC-SEQ-NBR.          20030000
200400                                                                  20040000
200500     EXEC CICS                                                    20050000
200600         LINK PROGRAM  (PC-TROUBLE-RTN)                           20060000
200700              COMMAREA (TM500-FIELDS)                             20070000
200800              LENGTH   (PC-TROUBLE-RTN-LENGTH)                    20080000
200900     END-EXEC.                                                    20090000
201000                                                                  20100000
201100     IF TM500-CALL-SUCCESSFUL        OR                           20110000
201200        TM500-TPURCHS-SELECT-NOT-FND OR                           20120000
201300        TM500-DUPLICATE-TROUBLE      OR                           20130000
201400        TM500-TTRBNTF-UPDATE-NOT-FND                              20140000
201500         CONTINUE                                                 20150000
201600     ELSE                                                         20160000
201700         STRING                                                   20170000
201800              ' 5100- RET MSG = '                                 20180000
201900              TM500-RETURN-MSG                                    20190000
202000              ' CLOSE CURSOR'                                     20200000
202100                         DELIMITED BY SIZE                        20210000
202200                       INTO SU044-CRA-RET-MSG                     20220000
202300         MOVE TM500-SQLCA      TO SU044-SQLCA                     20230000
202400         SET SU044-INVALID-SQL TO TRUE                            20240000
202500     END-IF.                                                      20250000
202600                                                                  20260000
202700 5200-VALIDATE-OPER-SET-ID.                                       20270000
202710                                                                  20271061
202720     IF  PS-BLD-INTERNAL-TABLE-YES                                20272061
202730         MOVE  '5200'  TO  PT-CURR-PARA                           20273061
202740         PERFORM 8120-INTERNAL-TABLE                              20274061
202750     END-IF.                                                      20275061
202800                                                                  20280000
202900     PERFORM                                                      20290000
203000         WITH TEST AFTER                                          20300000
203100         VARYING PV-RETRY-COUNTER                                 20310000
203200         FROM 1 BY 1                                              20320000
203300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20330000
203400                   OR (SQLCODE = +0)                              20340000
203500                   OR (SQLCODE = +100))                           20350000
203600                                                                  20360000
203700         EXEC SQL                                                 20370000
203800            SELECT  OPER_SET_DESC                                 20380000
203900              INTO :OPRSET-OPER-SET-DESC                          20390000
204000              FROM  TOPRSET                                       20400000
204100             WHERE  OPER_SET_ID    = :DK-OPER-SET-ID              20410000
204200               AND  VER_STATUS_CDE = 'A'                          20420000
204300               AND  OPER_UNT_ID    = :DK-OPER-UNT-ID              20430030
204400               AND  FCLTY_ID       = :DK-FCLTY-ID                 20440000
204410              with ur                                             20441056
204500         END-EXEC                                                 20450000
204600                                                                  20460000
204700         EVALUATE TRUE                                            20470000
204800             WHEN SQLCODE = +0                                    20480000
204900             WHEN SQLCODE = +100                                  20490000
205000             WHEN SQLCODE = -904                                  20500000
205100             WHEN SQLCODE = -913                                  20510000
205200                 CONTINUE                                         20520000
205300                                                                  20530000
205400             WHEN SQLWARN0 NOT = SPACES                           20540000
205500             WHEN SQLCODE < +0                                    20550000
205600             WHEN SQLCODE > +0                                    20560000
205610                                                                  20561058
205611                  MOVE '5200'  TO  PV-CSSL-PARA                   20561158
205620                  perform 8110-WRITE-suws044-TO-CSSL              20562058
205630                                                                  20563058
205700                 MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET         20570000
205800                 MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID      20580000
205900                 MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID         20590000
206000                 MOVE SQLCODE         TO PV-DISP-SQLCODE          20600058
206100                 STRING                                           20610000
206200                      ' SUKUT703 - 5200- '                        20620058
206300                      ' SQL:'            PV-DISP-SQLCODE          20630058
206400                      ' OPER SET:'       PV-DISP-OPER-SET         20640060
206500                      ' OPER:'           PV-DISP-OPER-UNT-ID      20650060
206510                      '-'                PV-DISP-FCLTY-ID         20651060
206600                                         DELIMITED BY SIZE        20660058
206700                                    INTO SU044-CRA-RET-MSG        20670058
206800                 MOVE SQLCA           TO SU044-SQLCA              20680058
206900                 SET SU044-INVALID-SQL TO TRUE                    20690000
207000         END-EVALUATE                                             20700000
207100     END-PERFORM.                                                 20710000
207200                                                                  20720000
207300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20730000
207400             AND (SQLCODE NOT = +0)                               20740000
207410                 MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET         20741059
207420                 MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID      20742059
207430                 MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID         20743059
207440                 MOVE SQLCODE         TO PV-DISP-SQLCODE          20744059
207450                 STRING                                           20745059
207460                      ' SUKUT703 - 5200- '                        20746059
207461                      ' MAX RETRY '                               20746159
207470                      ' SQL:'            PV-DISP-SQLCODE          20747059
207480                      ' OPER SET:'       PV-DISP-OPER-SET         20748060
207490                      ' OPER:'           PV-DISP-OPER-UNT-ID      20749060
207491                      '-'                PV-DISP-FCLTY-ID         20749160
207492                                         DELIMITED BY SIZE        20749259
207493                                    INTO SU044-CRA-RET-MSG        20749359
208600         MOVE SQLCA     TO SU044-SQLCA                            20860000
208700         SET SU044-INVALID-SQL TO TRUE                            20870000
208800     END-IF.                                                      20880000
208900                                                                  20890000
208901                                                                  20890161
208902****************************************************************  20890261
208910*  THIS IS THE OPER SET DEFAULT THAT IS ASSIGNED IN CNUDCLOC      20891061
208920*  BY OPER-UNIT, FACILTY, DEPT, AND CLASS.                        20892061
208930****************************************************************  20893061
209000 5300-GET-OPER-SET-INFO.                                          20900000
209010                                                                  20901061
209020     IF  PS-BLD-INTERNAL-TABLE-YES                                20902061
209030         MOVE  '5300'  TO  PT-CURR-PARA                           20903061
209040         PERFORM 8120-INTERNAL-TABLE                              20904061
209050     END-IF.                                                      20905061
209300                                                                  20930000
209400     PERFORM 5400-GET-MIN-LNE-NBR.                                20940000
209500                                                                  20950000
209600     IF SQLCODE = 0                                               20960000
209700        PERFORM                                                   20970000
209800            WITH TEST AFTER                                       20980000
209900            VARYING PV-RETRY-COUNTER                              20990000
210000            FROM 1 BY 1                                           21000000
210100            UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)            21010000
210200                OR (SQLCODE = +0)                                 21020000
210300                OR (SQLCODE = +100))                              21030000
210400                                                                  21040000
210500            EXEC SQL                                              21050000
210600                 SELECT A.OPER_SET_ID                             21060000
210700                       ,A.CL_NBR                                  21070000
210800                       ,B.OPER_SET_DESC                           21080000
210900                   INTO :DCFAAS-OPER-SET-ID                       21090000
211000                       ,:DCFAAS-CL-NBR                            21100000
211100                       ,:OPRSET-OPER-SET-DESC                     21110000
211200                   FROM TDCFAAS A                                 21120000
211300                       ,TOPRSET B                                 21130000
211400                  WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID     21140030
211500                    AND A.FCLTY_ID          = :DK-FCLTY-ID        21150000
211600                    AND A.DEPT_NBR          = :DK-DEPT-NBR        21160000
211700                    AND A.FCLTY_LOC_TYP_CDE = 'PA'                21170000
211800                    AND A.RANK_NBR          = 1                   21180000
211900                    AND B.VER_STATUS_CDE    = 'A'                 21190000
212000                    AND A.CL_NBR            = :PURITM-CL-NBR      21200000
212100                    AND A.OPER_SET_ID       = B.OPER_SET_ID       21210019
212200                    AND A.OPER_UNT_ID       = B.OPER_UNT_ID       21220019
212210                   with ur                                        21221056
212300            END-EXEC                                              21230000
212400                                                                  21240000
212500            EVALUATE TRUE                                         21250000
212600                WHEN SQLCODE = +0                                 21260000
212700                WHEN SQLCODE = +100                               21270000
212800                WHEN SQLCODE = -904                               21280000
212900                WHEN SQLCODE = -913                               21290000
213000                     CONTINUE                                     21300000
213100                                                                  21310000
213200                WHEN SQLWARN0 NOT = SPACES                        21320000
213300                WHEN SQLCODE < +0                                 21330000
213400                WHEN SQLCODE > +0                                 21340000
213410                                                                  21341058
213411                     MOVE '5300'  TO  PV-CSSL-PARA                21341158
213420                     perform 8110-WRITE-suws044-TO-CSSL           21342058
213430                                                                  21343058
213500                    MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID   21350000
213600                    MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID      21360000
213700                    MOVE SQLCODE         TO PV-DISP-SQLCODE       21370058
213800                    STRING                                        21380000
213900                         ' SUKUT703 - 5300- '                     21390058
214000                         ' SQL:'            PV-DISP-SQLCODE       21400058
214100                         ' DPT:'            DK-DEPT-NBR           21410058
214300                         ' OPER:'           PV-DISP-OPER-UNT-ID   21430058
214500                         '-'                PV-DISP-FCLTY-ID      21450058
214600                         ' CL:'             PURITM-CL-NBR         21460058
214700                                            DELIMITED BY SIZE     21470058
214800                                       INTO SU044-CRA-RET-MSG     21480058
214900                    MOVE SQLCA           TO SU044-SQLCA           21490058
215000                    SET SU044-INVALID-SQL TO TRUE                 21500000
215100            END-EVALUATE                                          21510000
215200        END-PERFORM                                               21520000
215300                                                                  21530000
215400        IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                     21540000
215500                AND (SQLCODE NOT = +0)                            21550000
215510                    MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID   21551059
215520                    MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID      21552059
215530                    MOVE SQLCODE         TO PV-DISP-SQLCODE       21553059
215540                    STRING                                        21554059
215550                         ' SUKUT703 - 5300- '                     21555059
215551                         ' MAX RETRY '                            21555159
215560                         ' SQL:'            PV-DISP-SQLCODE       21556059
215570                         ' DPT:'            DK-DEPT-NBR           21557059
215580                         ' OPER:'           PV-DISP-OPER-UNT-ID   21558059
215590                         '-'                PV-DISP-FCLTY-ID      21559059
215591                         ' CL:'             PURITM-CL-NBR         21559159
215592                                            DELIMITED BY SIZE     21559259
215593                                       INTO SU044-CRA-RET-MSG     21559359
217000            MOVE SQLCA     TO SU044-SQLCA                         21700000
217100            SET SU044-INVALID-SQL TO TRUE                         21710000
217200        END-IF                                                    21720000
217300     END-IF.                                                      21730000
217400                                                                  21740000
217500 5400-GET-MIN-LNE-NBR.                                            21750000
217510                                                                  21751061
217520     IF  PS-BLD-INTERNAL-TABLE-YES                                21752061
217530         MOVE  '5400'  TO  PT-CURR-PARA                           21753061
217540         PERFORM 8120-INTERNAL-TABLE                              21754061
217550     END-IF.                                                      21755061
217560                                                                  21756061
217600     PERFORM                                                      21760000
217700         WITH TEST AFTER                                          21770000
217800         VARYING PV-RETRY-COUNTER                                 21780000
217900         FROM 1 BY 1                                              21790000
218000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21800000
218100             OR (SQLCODE = +0)                                    21810000
218200             OR (SQLCODE = +100))                                 21820000
218300                                                                  21830000
218400         EXEC SQL                                                 21840000
218500              SELECT                                              21850000
218600                     A.CL_NBR                                     21860000
218700                INTO :PURITM-CL-NBR                               21870000
218800                FROM TPURITM A                                    21880000
218900               WHERE A.PO_NBR        = :DK-PO-NBR                 21890000
219000                 AND A.VER_STATUS_CDE = 'A'                       21900000
219100                 AND A.PO_LNE_NBR =                               21910000
219200                   (SELECT MIN(B.PO_LNE_NBR)                      21920000
219300                      FROM TPURITM B                              21930000
219400                      WHERE B.PO_NBR = A.PO_NBR                   21940000
219500                        AND B.VER_STATUS_CDE = 'A'                21950000
219600                        AND B.STATUS_CDE IN ('AP','AC'))          21960000
219610                with ur                                           21961056
219700         END-EXEC                                                 21970000
219800                                                                  21980000
219900         EVALUATE TRUE                                            21990000
220000             WHEN SQLCODE = +0                                    22000000
220100             WHEN SQLCODE = +100                                  22010000
220200             WHEN SQLCODE = -904                                  22020000
220300             WHEN SQLCODE = -913                                  22030000
220400                  CONTINUE                                        22040000
220500                                                                  22050000
220600             WHEN SQLWARN0 NOT = SPACES                           22060000
220700             WHEN SQLCODE < +0                                    22070000
220800             WHEN SQLCODE > +0                                    22080000
220810                                                                  22081058
220811                  MOVE '5400'  TO  PV-CSSL-PARA                   22081158
220820                  perform 8110-WRITE-suws044-TO-CSSL              22082058
220830                                                                  22083058
220900                 MOVE DK-PO-NBR       TO PV-DISP-PO-NBR           22090000
221000                 MOVE SQLCODE         TO PV-DISP-SQLCODE          22100058
221100                 STRING                                           22110000
221200                      ' SUKUT703 - 5400- '                        22120058
221300                      ' SQL:'            PV-DISP-SQLCODE          22130058
221400                      ' PO:'             PV-DISP-PO-NBR           22140058
221600                                         DELIMITED BY SIZE        22160058
221700                                    INTO SU044-CRA-RET-MSG        22170058
221800                 MOVE SQLCA           TO SU044-SQLCA              22180058
221900                 SET SU044-INVALID-SQL TO TRUE                    22190000
222000         END-EVALUATE                                             22200000
222100     END-PERFORM.                                                 22210000
222200                                                                  22220000
222300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22230000
222400             AND (SQLCODE = -904 OR -913)                         22240000
222410                 MOVE DK-PO-NBR       TO PV-DISP-PO-NBR           22241059
222420                 MOVE SQLCODE         TO PV-DISP-SQLCODE          22242059
222430                 STRING                                           22243059
222440                      ' SUKUT703 - 5400- '                        22244059
222441                      ' MAX RETRY '                               22244159
222450                      ' SQL:'            PV-DISP-SQLCODE          22245059
222460                      ' PO:'             PV-DISP-PO-NBR           22246059
222470                                         DELIMITED BY SIZE        22247059
222480                                    INTO SU044-CRA-RET-MSG        22248059
223400         MOVE SQLCA     TO SU044-SQLCA                            22340000
223500         SET SU044-INVALID-SQL TO TRUE                            22350000
223600     END-IF.                                                      22360000
223700                                                                  22370000
223800/                                                                 22380000
223900*----------------------------------------------------------------*22390000
224000*  GET OPER-SET-ID FROM TCOCNTL                                  *22400000
224100*----------------------------------------------------------------*22410000
224200 5500-GET-OPER-SET-ID.                                            22420000
224210                                                                  22421061
224220     IF  PS-BLD-INTERNAL-TABLE-YES                                22422061
224230         MOVE  '5500'  TO  PT-CURR-PARA                           22423061
224240         PERFORM 8120-INTERNAL-TABLE                              22424061
224250     END-IF.                                                      22425061
224300                                                                  22430000
224400     EXEC SQL                                                     22440000
224500          SELECT  DFLT_OPER_SET_ID                                22450000
224600            INTO :COCNTL-DFLT-OPER-SET-ID                         22460000
224700            FROM  TCOCNTL                                         22470000
224800           WHERE  OPER_UNT_ID    = :DK-OPER-UNT-ID                22480030
224900             AND  FCLTY_ID       = :DK-FCLTY-ID                   22490000
224910            with ur                                               22491056
225000     END-EXEC.                                                    22500000
225100                                                                  22510000
225200     EVALUATE TRUE                                                22520000
225300         WHEN SQLCODE = +0                                        22530000
225400              CONTINUE                                            22540000
225500                                                                  22550000
225600         WHEN SQLCODE = +100                                      22560000
225700              MOVE  ZEROES  TO  COCNTL-DFLT-OPER-SET-ID           22570000
225800                                                                  22580000
225900         WHEN SQLWARN0 NOT = SPACES                               22590000
226000         WHEN SQLCODE < +0                                        22600000
226100         WHEN SQLCODE > +0                                        22610000
226110                                                                  22611058
226111              MOVE '5500'  TO  PV-CSSL-PARA                       22611158
226120              perform 8110-WRITE-suws044-TO-CSSL                  22612058
226130                                                                  22613058
226200             MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID          22620000
226300             MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID             22630000
226400             MOVE SQLCODE         TO PV-DISP-SQLCODE              22640058
226500             STRING                                               22650000
226600                  ' SUKUT703 - 5500- '                            22660058
226700                  ' SQL:'            PV-DISP-SQLCODE              22670058
226800                  ' OPER:'           PV-DISP-OPER-UNT-ID          22680058
227100                  '-'                PV-DISP-FCLTY-ID             22710058
227200                                     DELIMITED BY SIZE            22720058
227300                                INTO SU044-CRA-RET-MSG            22730058
227400             MOVE SQLCA           TO SU044-SQLCA                  22740058
227500             SET SU044-INVALID-SQL TO TRUE                        22750000
227600     END-EVALUATE.                                                22760000
227700                                                                  22770000
227800 5600-INACTIVATE-TWRKORD.                                         22780000
227810                                                                  22781061
227820     IF  PS-BLD-INTERNAL-TABLE-YES                                22782061
227830         MOVE  '5600'  TO  PT-CURR-PARA                           22783061
227840         PERFORM 8120-INTERNAL-TABLE                              22784061
227850     END-IF.                                                      22785061
227900                                                                  22790000
228000         EXEC SQL                                                 22800000
228100           UPDATE TWRKORD                                         22810000
228200              SET VER_STATUS_CDE   =  'I'                         22820000
228300           WHERE                                                  22830000
228400                 ORD_NBR           = :WRKORD-ORD-NBR              22840000
228500            AND  RCVR_SEQ_NBR      = :WRKORD-RCVR-SEQ-NBR         22850000
228600            AND  ORD_LNE_NBR       = :WRKORD-ORD-LNE-NBR          22860000
228700            AND  WORK_ORD_SEQ_NBR  = :WRKORD-WORK-ORD-SEQ-NBR     22870000
228800            AND  OPER_UNT_ID       = :WRKORD-OPER-UNT-ID          22880000
228900            AND  FCLTY_ID          = :WRKORD-FCLTY-ID             22890000
229000         END-EXEC.                                                22900000
229100                                                                  22910000
229200         EVALUATE TRUE                                            22920000
229300             WHEN SQLCODE = +0                                    22930000
229400             WHEN SQLCODE = +100                                  22940000
229500                 CONTINUE                                         22950000
229600                                                                  22960000
229700             WHEN SQLWARN0 NOT = SPACES                           22970000
229800             WHEN SQLCODE < +0                                    22980000
229900             WHEN SQLCODE > +0                                    22990000
229910                                                                  22991058
229911                  MOVE '5600'  TO  PV-CSSL-PARA                   22991158
229920                  perform 8110-WRITE-suws044-TO-CSSL              22992058
229930                                                                  22993058
230000                 MOVE WRKORD-ORD-NBR      TO PV-DISP-PO-NBR       23000058
230100                 MOVE WRKORD-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ      23010058
230300                 MOVE WRKORD-ORD-LNE-NBR  TO PV-DISP-LNE-NBR      23030058
230500                 MOVE WRKORD-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID  23050058
230700                 MOVE WRKORD-FCLTY-ID     TO PV-DISP-FCLTY-ID     23070058
230800                 MOVE SQLCODE             TO PV-DISP-SQLCODE      23080058
230900                 STRING                                           23090000
231000                      ' SUKUT703 - 5600- '                        23100058
231100                      ' SQL:'                PV-DISP-SQLCODE      23110058
231200                      ' PO:'                 PV-DISP-PO-NBR       23120058
231500                      '-'                    PV-DISP-REC-SEQ      23150058
231700                      '-'                    PV-DISP-LNE-NBR      23170058
231900                      ' OPER:'               PV-DISP-OPER-UNT-ID  23190058
232100                      '-'                    PV-DISP-FCLTY-ID     23210058
232200                                             DELIMITED BY SIZE    23220058
232300                                        INTO SU044-CRA-RET-MSG    23230058
232400                 MOVE SQLCA               TO SU044-SQLCA          23240058
232500                 SET SU044-INVALID-SQL TO TRUE                    23250000
232600         END-EVALUATE.                                            23260000
232700/                                                                 23270000
232800 5700-INSERT-TWRKORD.                                             23280000
232810                                                                  23281061
232820     IF  PS-BLD-INTERNAL-TABLE-YES                                23282061
232830         MOVE  '5700'  TO  PT-CURR-PARA                           23283061
232840         PERFORM 8120-INTERNAL-TABLE                              23284061
232850     END-IF.                                                      23285061
232900                                                                  23290000
233000     PERFORM                                                      23300000
233100         WITH TEST AFTER                                          23310000
233200         VARYING PV-RETRY-COUNTER                                 23320000
233300         FROM 1 BY 1                                              23330000
233400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23340000
233500             OR (SQLCODE = +0))                                   23350000
233600                                                                  23360000
233700         EXEC SQL                                                 23370000
233800              INSERT INTO TWRKORD                                 23380000
233900                     ( ORD_NBR                                    23390000
234000                      ,RCVR_SEQ_NBR                               23400000
234100                      ,ORD_LNE_NBR                                23410000
234200                      ,WORK_ORD_SEQ_NBR                           23420000
234300                      ,OPER_UNT_ID                                23430000
234400                      ,FCLTY_ID                                   23440000
234500                      ,CRE_TMST                                   23450000
234600                      ,VER_STATUS_CDE                             23460000
234700                      ,CRE_UID_ID                                 23470000
234800                      ,EXPTED_CART_CNT                            23480000
234900                      ,ACTL_CART_CNT                              23490000
235000                      ,EXPTED_ITM_CNT                             23500000
235100                      ,ACTL_ITM_CNT                               23510000
235200                      ,STAT_CDE                                   23520000
235300                      ,WORK_ORD_DISTR_IND                         23530000
235400                      ,OPER_SET_ID )                              23540000
235500              VALUES ( :WRKORD-ORD-NBR                            23550000
235600                      ,:WRKORD-RCVR-SEQ-NBR                       23560000
235700                      ,:WRKORD-ORD-LNE-NBR                        23570000
235800                      ,:WRKORD-WORK-ORD-SEQ-NBR                   23580000
235900                      ,:WRKORD-OPER-UNT-ID                        23590000
236000                      ,:WRKORD-FCLTY-ID                           23600000
236100                      ,CURRENT TIMESTAMP                          23610000
236200                      ,:WRKORD-VER-STATUS-CDE                     23620000
236300                      ,:DP020-USERID                              23630000
236400                      ,:WRKORD-EXPTED-CART-CNT                    23640000
236500                      ,:WRKORD-ACTL-CART-CNT                      23650000
236600                      ,:WRKORD-EXPTED-ITM-CNT                     23660000
236700                      ,:WRKORD-ACTL-ITM-CNT                       23670000
236800                      ,:WRKORD-STAT-CDE                           23680000
236900                      ,:WRKORD-WORK-ORD-DISTR-IND                 23690000
237000                      ,:WRKORD-OPER-SET-ID )                      23700000
237100         END-EXEC                                                 23710000
237200                                                                  23720000
237300         EVALUATE TRUE                                            23730000
237400             WHEN SQLCODE = +0                                    23740000
237500             WHEN SQLCODE = -904                                  23750000
237600             WHEN SQLCODE = -913                                  23760000
237700                 CONTINUE                                         23770000
237800                                                                  23780000
237900             WHEN SQLWARN0 NOT = SPACE                            23790000
238000             WHEN SQLCODE < +0                                    23800000
238100             WHEN SQLCODE > +0                                    23810000
238110                                                                  23811058
238111                  MOVE '5700'  TO  PV-CSSL-PARA                   23811158
238120                  perform 8110-WRITE-suws044-TO-CSSL              23812058
238130                                                                  23813058
238200                 MOVE WRKORD-ORD-NBR      TO PV-DISP-PO-NBR       23820058
238300                 MOVE WRKORD-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ      23830058
238500                 MOVE WRKORD-ORD-LNE-NBR  TO PV-DISP-LNE-NBR      23850058
238700                 MOVE WRKORD-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID  23870058
238900                 MOVE WRKORD-FCLTY-ID     TO PV-DISP-FCLTY-ID     23890058
239000                 MOVE SQLCODE             TO PV-DISP-SQLCODE      23900058
239100                 STRING                                           23910000
239200                      ' SUKUT703 - 5700- '                        23920058
239300                      ' SQL:'                PV-DISP-SQLCODE      23930058
239400                      ' PO:'                 PV-DISP-PO-NBR       23940058
239700                      '-'                    PV-DISP-REC-SEQ      23970058
239900                      '-'                    PV-DISP-LNE-NBR      23990058
240100                      ' oper-'               PV-DISP-OPER-UNT-ID  24010058
240300                      '-'                    PV-DISP-FCLTY-ID     24030058
240400                                             DELIMITED BY SIZE    24040058
240500                                        INTO SU044-CRA-RET-MSG    24050058
240600                 MOVE SQLCA               TO SU044-SQLCA          24060058
240700                 SET SU044-INVALID-SQL TO TRUE                    24070000
240800         END-EVALUATE                                             24080000
240900     END-PERFORM.                                                 24090000
241000                                                                  24100000
241100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24110000
241200             AND (SQLCODE NOT = +0)                               24120000
241210                 MOVE WRKORD-ORD-NBR      TO PV-DISP-PO-NBR       24121059
241220                 MOVE WRKORD-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ      24122059
241230                 MOVE WRKORD-ORD-LNE-NBR  TO PV-DISP-LNE-NBR      24123059
241240                 MOVE WRKORD-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID  24124059
241250                 MOVE WRKORD-FCLTY-ID     TO PV-DISP-FCLTY-ID     24125059
241260                 MOVE SQLCODE             TO PV-DISP-SQLCODE      24126059
241270                 STRING                                           24127059
241280                      ' SUKUT703 - 5700- '                        24128059
241281                      ' MAX RETRY '                               24128159
241290                      ' SQL:'                PV-DISP-SQLCODE      24129059
241291                      ' PO:'                 PV-DISP-PO-NBR       24129159
241292                      '-'                    PV-DISP-REC-SEQ      24129259
241293                      '-'                    PV-DISP-LNE-NBR      24129359
241294                      ' OPER-'               PV-DISP-OPER-UNT-ID  24129459
241295                      '-'                    PV-DISP-FCLTY-ID     24129559
241296                                             DELIMITED BY SIZE    24129659
241297                                        INTO SU044-CRA-RET-MSG    24129759
243700         MOVE SQLCA     TO SU044-SQLCA                            24370000
243800         SET SU044-INVALID-SQL TO TRUE                            24380000
243900     END-IF.                                                      24390000
244000                                                                  24400000
244100/                                                                 24410000
244200*----------------------------------------------------------------*24420000
244300* OPEN THE TOSOPFA CURSOR                                        *24430000
244400*----------------------------------------------------------------*24440000
244500                                                                  24450000
244600 5800-OPEN-TOSOPFA-CSR.                                           24460000
244610                                                                  24461061
244620     IF  PS-BLD-INTERNAL-TABLE-YES                                24462061
244630         MOVE  '5800'  TO  PT-CURR-PARA                           24463061
244640         PERFORM 8120-INTERNAL-TABLE                              24464061
244650     END-IF.                                                      24465061
244700                                                                  24470000
244800     EXEC SQL                                                     24480000
244900          DECLARE TOSOPFA-CSR CURSOR FOR                          24490000
245000           SELECT OPER_SET_ID                                     24500000
245100                 ,OPER_ID                                         24510000
245200                 ,OPER_UNT_ID                                     24520000
245300                 ,FCLTY_ID                                        24530000
245400                 ,FCLTY_AREA_ID                                   24540000
245500                 ,PRC_FCLTY_AREA_ID                               24550000
245600                 ,SCRN_SEQ_NBR                                    24560000
245700           FROM   TOSOPFA                                         24570000
245800           WHERE  OPER_SET_ID    = :DK-OPER-SET-ID                24580000
245900             AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                24590031
246000             AND  FCLTY_ID       = :DK-FCLTY-ID                   24600020
246100             AND  VER_STATUS_CDE = 'A'                            24610000
246200           ORDER BY SCRN_SEQ_NBR                                  24620000
246210            with ur                                               24621056
246300     END-EXEC.                                                    24630000
246400                                                                  24640000
246500     PERFORM                                                      24650000
246600         WITH TEST AFTER                                          24660000
246700         VARYING PV-RETRY-COUNTER                                 24670000
246800         FROM 1 BY 1                                              24680000
246900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24690000
247000            OR (SQLCODE = +0))                                    24700000
247100                                                                  24710000
247200         EXEC SQL                                                 24720000
247300              OPEN TOSOPFA-CSR                                    24730000
247400         END-EXEC                                                 24740000
247500                                                                  24750000
247600         EVALUATE TRUE                                            24760000
247700             WHEN SQLCODE = +0                                    24770000
247800                  CONTINUE                                        24780000
247900             WHEN SQLCODE = -904                                  24790000
248000             WHEN SQLCODE = -913                                  24800000
248100                  CONTINUE                                        24810000
248200             WHEN SQLWARN0 NOT = SPACE                            24820000
248300             WHEN SQLCODE  NOT = +0                               24830000
248310                                                                  24831058
248311                  MOVE '5800'  TO  PV-CSSL-PARA                   24831158
248320                  perform 8110-WRITE-suws044-TO-CSSL              24832058
248330                                                                  24833058
248400                 MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET         24840000
248500                 MOVE SQLCODE         TO PV-DISP-SQLCODE          24850058
248600                 STRING                                           24860000
248700                      ' SUKUT703 - 5800- '                        24870059
248800                      ' SQL:'            PV-DISP-SQLCODE          24880058
249000                      ' OPER SET:'       PV-DISP-OPER-SET         24900058
249100                                         DELIMITED BY SIZE        24910058
249200                                    INTO SU044-CRA-RET-MSG        24920058
249300                 MOVE SQLCA           TO SU044-SQLCA              24930058
249400                 SET SU044-INVALID-SQL TO TRUE                    24940000
249500         END-EVALUATE                                             24950000
249600     END-PERFORM.                                                 24960000
249700                                                                  24970000
249800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24980000
249900             AND (SQLCODE NOT = +0)                               24990000
249910                 MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET         24991059
249920                 MOVE SQLCODE         TO PV-DISP-SQLCODE          24992059
249930                 STRING                                           24993059
249940                      ' SUKUT703 - 5800- '                        24994059
249941                      ' MAX RETRY '                               24994159
249950                      ' SQL:'            PV-DISP-SQLCODE          24995059
249960                      ' OPER SET:'       PV-DISP-OPER-SET         24996059
249970                                         DELIMITED BY SIZE        24997059
249980                                    INTO SU044-CRA-RET-MSG        24998059
250900         MOVE SQLCA     TO SU044-SQLCA                            25090000
251000         SET SU044-INVALID-SQL TO TRUE                            25100000
251100     END-IF.                                                      25110000
251200                                                                  25120000
251300/                                                                 25130000
251400*----------------------------------------------------------------*25140000
251500*    FETCH A TOSOPFA ROW                                         *25150000
251600*----------------------------------------------------------------*25160000
251700                                                                  25170000
251800 5820-FETCH-TOSOPFA-CSR.                                          25180000
251810                                                                  25181061
251820     IF  PS-BLD-INTERNAL-TABLE-YES                                25182061
251830         MOVE  '5820'  TO  PT-CURR-PARA                           25183061
251840         PERFORM 8120-INTERNAL-TABLE                              25184061
251850     END-IF.                                                      25185061
251900                                                                  25190000
252000     EXEC SQL                                                     25200000
252100          FETCH TOSOPFA-CSR                                       25210000
252200          INTO :OSOPFA-OPER-SET-ID                                25220000
252300              ,:OSOPFA-OPER-ID                                    25230000
252400              ,:OSOPFA-OPER-UNT-ID                                25240000
252500              ,:OSOPFA-FCLTY-ID                                   25250000
252600              ,:OSOPFA-FCLTY-AREA-ID                              25260000
252700              ,:OSOPFA-PRC-FCLTY-AREA-ID                          25270000
252800              ,:OSOPFA-SCRN-SEQ-NBR                               25280000
252900     END-EXEC                                                     25290000
253000                                                                  25300000
253100     EVALUATE TRUE                                                25310000
253200         WHEN SQLCODE = +0                                        25320000
253300              CONTINUE                                            25330000
253400                                                                  25340000
253500         WHEN SQLCODE = +100                                      25350000
253600              SET PS-EOF-TOSOPFA-CSR TO TRUE                      25360000
253700                                                                  25370000
253800         WHEN SQLWARN0 NOT = SPACE                                25380000
253900         WHEN SQLCODE < +0                                        25390000
254000         WHEN SQLCODE > +0                                        25400000
254010                                                                  25401058
254011              MOVE '5820'  TO  PV-CSSL-PARA                       25401158
254020              perform 8110-WRITE-suws044-TO-CSSL                  25402058
254030                                                                  25403058
254100             MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET             25410000
254200             MOVE SQLCODE         TO PV-DISP-SQLCODE              25420058
254300             STRING                                               25430000
254400                  ' SUKUT703 - 5820- '                            25440058
254500                  ' SQL:'            PV-DISP-SQLCODE              25450058
254700                  ' OPER SET:'       PV-DISP-OPER-SET             25470058
254800                                     DELIMITED BY SIZE            25480058
254900                                INTO SU044-CRA-RET-MSG            25490058
255000             MOVE SQLCA           TO SU044-SQLCA                  25500058
255100             SET SU044-INVALID-SQL TO TRUE                        25510000
255200     END-EVALUATE.                                                25520000
255300                                                                  25530000
255400/                                                                 25540000
255500*----------------------------------------------------------------*25550000
255600* CLOSE THE TOSOPFA CURSOR                                       *25560000
255700*----------------------------------------------------------------*25570000
255800                                                                  25580000
255900 5840-CLOSE-TOSOPFA-CSR.                                          25590000
255910                                                                  25591061
255920     IF  PS-BLD-INTERNAL-TABLE-YES                                25592061
255930         MOVE  '5840'  TO  PT-CURR-PARA                           25593061
255940         PERFORM 8120-INTERNAL-TABLE                              25594061
255950     END-IF.                                                      25595061
256000                                                                  25600000
256100     EXEC SQL                                                     25610000
256200          CLOSE TOSOPFA-CSR                                       25620000
256300     END-EXEC                                                     25630000
256400                                                                  25640000
256500     EVALUATE TRUE                                                25650000
256600         WHEN SQLCODE = +0                                        25660000
256700              CONTINUE                                            25670000
256800         WHEN SQLWARN0 NOT = SPACE                                25680000
256900         WHEN SQLCODE  NOT = +0                                   25690000
256910                                                                  25691058
256911              MOVE '5840'  TO  PV-CSSL-PARA                       25691158
256920              perform 8110-WRITE-suws044-TO-CSSL                  25692058
256930                                                                  25693058
257000             MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET             25700000
257100             MOVE SQLCODE         TO PV-DISP-SQLCODE              25710058
257200             STRING                                               25720000
257300                  ' SUKUT703 - 5840- '                            25730058
257400                  ' SQL:'            PV-DISP-SQLCODE              25740058
257600                  ' OPER SET:'       PV-DISP-OPER-SET             25760058
257700                                     DELIMITED BY SIZE            25770058
257800                                INTO SU044-CRA-RET-MSG            25780058
257900             MOVE SQLCA           TO SU044-SQLCA                  25790058
258000             SET SU044-INVALID-SQL TO TRUE                        25800000
258100     END-EVALUATE.                                                25810000
258200                                                                  25820000
265100                                                                  26510000
265200 5900-BUILD-WORK-ORDER-INSTR.                                     26520000
265210                                                                  26521061
265220     IF  PS-BLD-INTERNAL-TABLE-YES                                26522061
265230         MOVE  '5900'  TO  PT-CURR-PARA                           26523061
265240         PERFORM 8120-INTERNAL-TABLE                              26524061
265250     END-IF.                                                      26525061
265300                                                                  26530000
265400     INITIALIZE DCLTWKORIN.                                       26540000
265500                                                                  26550000
265600     MOVE SU044-PO               TO WKORIN-ORD-NBR.               26560000
265700     MOVE SU044-NEW-REC-SEQ-NBR  TO WKORIN-RCVR-SEQ-NBR.          26570000
265800     MOVE +1                     TO WKORIN-WORK-ORD-SEQ-NBR.      26580000
265900     ADD +1                      TO PV-WO-INSTR-SEQ-NBR.          26590000
266000     MOVE PV-WO-INSTR-SEQ-NBR    TO WKORIN-WO-INSTR-SEQ-NBR.      26600000
266100     MOVE 'A'                    TO WKORIN-VER-STATUS-CDE.        26610000
266200     MOVE WRKORD-OPER-UNT-ID     TO WKORIN-OPER-UNT-ID.           26620031
266300     MOVE SU044-FCLTY-ID         TO WKORIN-FCLTY-ID.              26630000
266400     MOVE OSOPFA-OPER-ID         TO WKORIN-OPER-ID.               26640000
266500     MOVE OSOPFA-FCLTY-AREA-ID   TO WKORIN-FCLTY-AREA-ID.         26650000
266600     MOVE OSOPFA-PRC-FCLTY-AREA-ID                                26660000
266700                                 TO WKORIN-PRC-FCLTY-AREA-ID.     26670000
266800     MOVE OSOPFA-SCRN-SEQ-NBR    TO WKORIN-SCREEN-SEQ-NBR.        26680000
266900     MOVE 'N'                    TO PS-INSTRUCTION-SW.            26690000
267000     MOVE 1                      TO WKORIN-EXPTED-CART-CNT.       26700000
267100     MOVE ZERO                   TO WKORIN-ACTL-CART-CNT.         26710000
267200     MOVE 'N'                    TO WKORIN-ALLOC-IND              26720000
267300                                    WKORIN-REPACK-IND.            26730000
267400     MOVE '9999-09-09-09.09.09.000000'                            26740000
267500                                 TO WKORIN-STRT-TMST              26750000
267600                                    WKORIN-STOP-TMST.             26760000
267700                                                                  26770000
267800     PERFORM 5920-INACTIVATE-TWKORIN.                             26780000
267900     PERFORM 5940-INSERT-TWKORIN.                                 26790000
268000                                                                  26800000
268100 5920-INACTIVATE-TWKORIN.                                         26810000
268110                                                                  26811061
268120     IF  PS-BLD-INTERNAL-TABLE-YES                                26812061
268130         MOVE  '5920'  TO  PT-CURR-PARA                           26813061
268140         PERFORM 8120-INTERNAL-TABLE                              26814061
268150     END-IF.                                                      26815061
268200                                                                  26820000
268300     EXEC SQL                                                     26830000
268400          UPDATE                                                  26840000
268500                 TWKORIN                                          26850000
268600             SET                                                  26860000
268700                 VER_STATUS_CDE      =  'I'                       26870000
268800           WHERE                                                  26880000
268900                 ORD_NBR             =  :WKORIN-ORD-NBR           26890000
269000             AND RCVR_SEQ_NBR        =  :WKORIN-RCVR-SEQ-NBR      26900000
269100             AND ORD_LNE_NBR         =  :WKORIN-ORD-LNE-NBR       26910000
269200             AND WORK_ORD_SEQ_NBR    =  :WKORIN-WORK-ORD-SEQ-NBR  26920000
269300             AND WO_INSTR_SEQ_NBR    =  :WKORIN-WO-INSTR-SEQ-NBR  26930000
269400             AND VER_STATUS_CDE      =  'A'                       26940000
269500     END-EXEC.                                                    26950000
269600                                                                  26960000
269700     EVALUATE TRUE                                                26970000
269800         WHEN SQLCODE = ZERO                                      26980000
269900         WHEN SQLCODE = +100                                      26990000
270000              CONTINUE                                            27000000
270100         WHEN SQLWARN0 NOT = SPACES                               27010000
270200         WHEN SQLCODE NOT EQUAL ZERO                              27020000
270210                                                                  27021058
270211              MOVE '5920'  TO  PV-CSSL-PARA                       27021158
270220              perform 8110-WRITE-suws044-TO-CSSL                  27022058
270230                                                                  27023058
270300             MOVE WKORIN-ORD-NBR      TO PV-DISP-PO-NBR           27030000
270400             MOVE WKORIN-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ          27040000
270500             MOVE WKORIN-ORD-LNE-NBR  TO PV-DISP-LNE-NBR          27050000
270600             MOVE WKORIN-WORK-ORD-SEQ-NBR                         27060000
270700                                      TO PV-DISP-WO-SEQ-NBR       27070000
270800             MOVE WKORIN-WO-INSTR-SEQ-NBR                         27080000
270900                                      TO PV-DISP-WO-INSTR-SEQ-NBR 27090000
271000             MOVE SQLCODE TO PV-DISP-SQLCODE                      27100000
271100             STRING                                               27110000
271200                  ' SUKUT703 - 5920- '                            27120059
271300                  ' SQL:'                PV-DISP-SQLCODE          27130059
271500                  ' PO:'                 PV-DISP-PO-NBR           27150059
271700                  '-'                    PV-DISP-REC-SEQ          27170059
271900                  '-'                    PV-DISP-LNE-NBR          27190059
272100                  ' WO SEQ:'             PV-DISP-WO-SEQ-NBR       27210059
272300                  ' INSTR SEQ:'          PV-DISP-WO-INSTR-SEQ-NBR 27230059
272400                                         DELIMITED BY SIZE        27240059
272500                                    INTO SU044-CRA-RET-MSG        27250059
272600             MOVE SQLCA               TO SU044-SQLCA              27260059
272700             SET SU044-INVALID-SQL TO TRUE                        27270000
272800     END-EVALUATE.                                                27280000
272900/                                                                 27290000
273000 5940-INSERT-TWKORIN.                                             27300000
273010                                                                  27301061
273020     IF  PS-BLD-INTERNAL-TABLE-YES                                27302061
273030         MOVE  '5940'  TO  PT-CURR-PARA                           27303061
273040         PERFORM 8120-INTERNAL-TABLE                              27304061
273050     END-IF.                                                      27305061
273100                                                                  27310000
273200     PERFORM                                                      27320000
273300         WITH TEST AFTER                                          27330000
273400         VARYING PV-RETRY-COUNTER                                 27340000
273500         FROM 1 BY 1                                              27350000
273600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27360000
273700             OR (SQLCODE = +0))                                   27370000
273800                                                                  27380000
273900         EXEC SQL                                                 27390000
274000              INSERT INTO TWKORIN                                 27400000
274100                     ( ORD_NBR                                    27410000
274200                      ,RCVR_SEQ_NBR                               27420000
274300                      ,ORD_LNE_NBR                                27430000
274400                      ,WORK_ORD_SEQ_NBR                           27440000
274500                      ,OPER_UNT_ID                                27450000
274600                      ,FCLTY_ID                                   27460000
274700                      ,WO_INSTR_SEQ_NBR                           27470000
274800                      ,CRE_TMST                                   27480000
274900                      ,VER_STATUS_CDE                             27490000
275000                      ,CRE_UID_ID                                 27500000
275100                      ,OPER_ID                                    27510000
275200                      ,FCLTY_AREA_ID                              27520000
275300                      ,PRC_FCLTY_AREA_ID                          27530000
275400                      ,EXPTED_CART_CNT                            27540000
275500                      ,ACTL_CART_CNT                              27550000
275600                      ,ALLOC_IND                                  27560000
275700                      ,REPACK_IND                                 27570000
275800                      ,STRT_TMST                                  27580000
275900                      ,STOP_TMST                                  27590000
276000                      ,SCREEN_SEQ_NBR                             27600000
276100                      ,LNE_LOC_CDE                                27610000
276200                      ,REC_SEL_IND )                              27620000
276300              VALUES ( :WKORIN-ORD-NBR                            27630000
276400                      ,:WKORIN-RCVR-SEQ-NBR                       27640000
276500                      ,:WKORIN-ORD-LNE-NBR                        27650000
276600                      ,:WKORIN-WORK-ORD-SEQ-NBR                   27660000
276700                      ,:WKORIN-OPER-UNT-ID                        27670000
276800                      ,:WKORIN-FCLTY-ID                           27680000
276900                      ,:WKORIN-WO-INSTR-SEQ-NBR                   27690000
277000                      ,CURRENT TIMESTAMP                          27700000
277100                      ,:WKORIN-VER-STATUS-CDE                     27710000
277200                      ,:DP020-USERID                              27720000
277300                      ,:WKORIN-OPER-ID                            27730000
277400                      ,:WKORIN-FCLTY-AREA-ID                      27740000
277500                      ,:WKORIN-PRC-FCLTY-AREA-ID                  27750000
277600                      ,:WKORIN-EXPTED-CART-CNT                    27760000
277700                      ,:WKORIN-ACTL-CART-CNT                      27770000
277800                      ,:WKORIN-ALLOC-IND                          27780000
277900                      ,:WKORIN-REPACK-IND                         27790000
278000                      ,:WKORIN-STRT-TMST                          27800000
278100                      ,:WKORIN-STOP-TMST                          27810000
278200                      ,:WKORIN-SCREEN-SEQ-NBR                     27820000
278300                      ,:WKORIN-LNE-LOC-CDE                        27830000
278400                      ,:WKORIN-REC-SEL-IND )                      27840000
278500         END-EXEC                                                 27850000
278600                                                                  27860000
278700         EVALUATE TRUE                                            27870000
278800             WHEN SQLCODE = +0                                    27880000
278900             WHEN SQLCODE = -904                                  27890000
279000             WHEN SQLCODE = -913                                  27900000
279100                 CONTINUE                                         27910000
279200                                                                  27920000
279300             WHEN SQLWARN0 NOT = SPACE                            27930000
279400             WHEN SQLCODE < +0                                    27940000
279500             WHEN SQLCODE > +0                                    27950000
279510                                                                  27951058
279511                  MOVE '5940'  TO  PV-CSSL-PARA                   27951158
279520                  perform 8110-WRITE-suws044-TO-CSSL              27952058
279530                                                                  27953058
279600                 MOVE WKORIN-ORD-NBR      TO PV-DISP-PO-NBR       27960000
279700                 MOVE WKORIN-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ      27970000
279800                 MOVE WKORIN-ORD-LNE-NBR  TO PV-DISP-LNE-NBR      27980000
279900                 MOVE WKORIN-WORK-ORD-SEQ-NBR                     27990000
280000                                      TO PV-DISP-WO-SEQ-NBR       28000000
280100                 MOVE WKORIN-WO-INSTR-SEQ-NBR                     28010000
280200                                      TO PV-DISP-WO-INSTR-SEQ-NBR 28020000
280300                 MOVE SQLCODE TO PV-DISP-SQLCODE                  28030000
280400                 STRING                                           28040000
280500                      ' SUKUT703 - 5940- '                        28050059
280600                      ' SQL:'            PV-DISP-SQLCODE          28060059
280800                      ' PO:'             PV-DISP-PO-NBR           28080059
281000                      '-'                PV-DISP-REC-SEQ          28100059
281200                      '-'                PV-DISP-LNE-NBR          28120059
281400                      ' WO SEQ:'         PV-DISP-WO-SEQ-NBR       28140059
281600                      ' INSTR SEQ:'      PV-DISP-WO-INSTR-SEQ-NBR 28160059
281700                                         DELIMITED BY SIZE        28170059
281800                                    INTO SU044-CRA-RET-MSG        28180059
281900                 MOVE SQLCA           TO SU044-SQLCA              28190059
282000                 SET SU044-INVALID-SQL TO TRUE                    28200000
282100         END-EVALUATE                                             28210000
282200     END-PERFORM.                                                 28220000
282300                                                                  28230000
282400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28240000
282500             AND (SQLCODE NOT = +0)                               28250000
282510                 MOVE WKORIN-ORD-NBR      TO PV-DISP-PO-NBR       28251059
282520                 MOVE WKORIN-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ      28252059
282530                 MOVE WKORIN-ORD-LNE-NBR  TO PV-DISP-LNE-NBR      28253059
282540                 MOVE WKORIN-WORK-ORD-SEQ-NBR                     28254059
282550                                      TO PV-DISP-WO-SEQ-NBR       28255059
282560                 MOVE WKORIN-WO-INSTR-SEQ-NBR                     28256059
282570                                      TO PV-DISP-WO-INSTR-SEQ-NBR 28257059
282580                 MOVE SQLCODE TO PV-DISP-SQLCODE                  28258059
282590                 STRING                                           28259059
282591                      ' SUKUT703 - 5940- '                        28259159
282592                      ' MAX RETRY '                               28259259
282593                      ' SQL:'            PV-DISP-SQLCODE          28259359
282594                      ' PO:'             PV-DISP-PO-NBR           28259459
282595                      '-'                PV-DISP-REC-SEQ          28259559
282596                      '-'                PV-DISP-LNE-NBR          28259659
282597                      ' WO SEQ:'         PV-DISP-WO-SEQ-NBR       28259759
282598                      ' INSTR SEQ:'      PV-DISP-WO-INSTR-SEQ-NBR 28259859
282599                                         DELIMITED BY SIZE        28259959
282600                                    INTO SU044-CRA-RET-MSG        28260059
283100         MOVE SQLCA     TO SU044-SQLCA                            28310000
283200         SET SU044-INVALID-SQL TO TRUE                            28320000
283300     END-IF.                                                      28330000
283400                                                                  28340000
283500*----------------------------------------------------------------*28350000
283600*  INSERT THE PO TO THE SHIPEMENT PO ASSOCIATION TABLE            28360000
283700*----------------------------------------------------------------*28370000
283800 6000-INSERT-TSHPTPO.                                             28380000
283810                                                                  28381061
283820     IF  PS-BLD-INTERNAL-TABLE-YES                                28382061
283830         MOVE  '6000'  TO  PT-CURR-PARA                           28383061
283840         PERFORM 8120-INTERNAL-TABLE                              28384061
283850     END-IF.                                                      28385061
283900                                                                  28390000
284000     INITIALIZE DCLTSHPTPO.                                       28400000
284100                                                                  28410000
284200     MOVE DK-CURR-SHIPT-ID         TO SHPTPO-SHIPT-ID             28420000
284300                                      SU044-NEW-SHIP.             28430000
284400     MOVE SU044-PO                 TO SHPTPO-PO-NBR               28440000
284500                                      DK-PO-NBR.                  28450000
284600     MOVE SU044-NEW-REC-SEQ-NBR    TO SHPTPO-REC-SEQ-NBR.         28460000
284700     MOVE ZEROES                   TO SHPTPO-EXPTED-CART-CNT.     28470000
284800     MOVE ZEROES                   TO SHPTPO-ACTL-CART-CNT        28480000
284900                                      SHPTPO-DMG-CART-CNT.        28490000
285000     MOVE 'N'                      TO SHPTPO-PKSL-IND.            28500000
285100     MOVE ENTNME-ENT-NAME-DESC     TO SHPTPO-VEND-NAME.           28510000
285200     MOVE ZEROES                   TO SHPTPO-FRGT-CHG-AMT.        28520000
285210                                                                  28521076
285220     PERFORM 6010-CHECK-PRIM-EXISTS.                              28522076
285230                                                                  28523076
285240     IF  PV-PRIM-SHIPT-IND  = 'Y'                                 28524078
285300         MOVE 'N'                  TO SHPTPO-PRIM-SHIPT-IND       28530076
285301     ELSE                                                         28530176
285310         MOVE 'Y'                  TO SHPTPO-PRIM-SHIPT-IND       28531076
285320     END-IF.                                                      28532076
285400                                                                  28540000
285500     PERFORM                                                      28550000
285600         WITH TEST AFTER                                          28560000
285700         VARYING PV-RETRY-COUNTER                                 28570000
285800         FROM 1 BY 1                                              28580000
285900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28590000
286000             OR (SQLCODE = +0))                                   28600000
286100                                                                  28610000
286200         EXEC SQL                                                 28620000
286300             INSERT  INTO TSHPTPO                                 28630000
286400                    (SHIPT_ID                                     28640000
286500                    ,PO_NBR                                       28650000
286600                    ,REC_SEQ_NBR                                  28660000
286700                    ,EXPTED_CART_CNT                              28670000
286800                    ,ACTL_CART_CNT                                28680000
286900                    ,DMG_CART_CNT                                 28690000
287000                    ,PKSL_IND                                     28700000
287100                    ,VEND_NAME                                    28710000
287200                    ,FRGT_CHG_AMT                                 28720000
287300                    ,LAST_UPD_PGM_ID                              28730000
287400                    ,CRE_USER_ID                                  28740000
287500                    ,CARR_LAST_UPD_DTE                            28750000
287600                    ,CARR_LAST_UPD_TIME                           28760000
287700                    ,VEND_LAST_UPD_DTE                            28770000
287800                    ,VEND_LAST_UPD_TIME                           28780000
287900                    ,LAST_UPD_USER_ID                             28790000
288000                    ,PRIM_SHIPT_IND                               28800000
288100                    ,SPLT_XMIT_IND                                28810000
288200                    ,SPLT_XMIT_DTE                                28820000
288300                    ,SPLT_XMIT_TM )                               28830000
288400             VALUES                                               28840000
288500                    (:SHPTPO-SHIPT-ID                             28850000
288600                    ,:SHPTPO-PO-NBR                               28860000
288700                    ,:SHPTPO-REC-SEQ-NBR                          28870000
288800                    ,:SHPTPO-EXPTED-CART-CNT                      28880000
288900                    ,:SHPTPO-ACTL-CART-CNT                        28890000
289000                    ,:SHPTPO-DMG-CART-CNT                         28900000
289100                    ,:SHPTPO-PKSL-IND                             28910000
289200                    ,:SHPTPO-VEND-NAME                            28920000
289300                    ,:SHPTPO-FRGT-CHG-AMT                         28930000
289400                    ,:PC-CURRENT-PROGRAM-NAME                     28940000
289500                    ,:DP020-USERID                                28950000
289600                    ,:PC-DEFAULT-DATE                             28960000
289700                    ,:PC-DEFAULT-TIME                             28970000
289800                    ,:PC-DEFAULT-DATE                             28980000
289900                    ,:PC-DEFAULT-TIME                             28990000
290000                    ,:DP020-USERID                                29000000
290100                    ,:SHPTPO-PRIM-SHIPT-IND                       29010000
290200                    ,:SHPTPO-SPLT-XMIT-IND                        29020000
290300                    ,:PC-DEFAULT-DATE                             29030000
290400                    ,:PC-DEFAULT-TIME )                           29040000
290500         END-EXEC                                                 29050000
290600*                                                                 29060000
290700         EVALUATE TRUE                                            29070000
290800             WHEN SQLCODE = +0                                    29080000
290900             WHEN SQLCODE = -904                                  29090000
291000             WHEN SQLCODE = -913                                  29100000
291100                 CONTINUE                                         29110000
291200                                                                  29120000
291300             WHEN SQLWARN0 NOT = SPACES                           29130000
291400             WHEN SQLCODE < +0                                    29140000
291500             WHEN SQLCODE > +0                                    29150000
291510                                                                  29151058
291511                  MOVE '6000'  TO  PV-CSSL-PARA                   29151158
291520                  perform 8110-WRITE-suws044-TO-CSSL              29152058
291530                                                                  29153058
291600                 MOVE SHPTPO-SHIPT-ID    TO PV-DISP-SHIPT-ID      29160059
291700                 MOVE SHPTPO-PO-NBR      TO PV-DISP-PO-NBR        29170059
291800                 MOVE SHPTPO-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR  29180059
291900                                                                  29190059
292000                 MOVE SQLCODE            TO PV-DISP-SQLCODE       29200059
292100                 STRING                                           29210000
292200                      ' SUKUT703 - 6000- '                        29220059
292300                      ' SQL:'               PV-DISP-SQLCODE       29230059
292500                      ' SHIPMT:'            PV-DISP-SHIPT-ID      29250059
292700                      ' PO:'                PV-DISP-PO-NBR        29270059
292900                      '-'                   PV-DISP-RCVR-SEQ-NBR  29290059
293000                                            DELIMITED BY SIZE     29300059
293100                                       INTO SU044-CRA-RET-MSG     29310059
293200                 MOVE SQLCA              TO SU044-SQLCA           29320059
293300                 SET SU044-INVALID-SQL TO TRUE                    29330000
293400         END-EVALUATE                                             29340000
293500     END-PERFORM.                                                 29350000
293600                                                                  29360000
293700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29370000
293800             AND (SQLCODE NOT = +0)                               29380000
293810                 MOVE SHPTPO-SHIPT-ID    TO PV-DISP-SHIPT-ID      29381059
293820                 MOVE SHPTPO-PO-NBR      TO PV-DISP-PO-NBR        29382059
293830                 MOVE SHPTPO-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR  29383059
293840                                                                  29384059
293850                 MOVE SQLCODE            TO PV-DISP-SQLCODE       29385059
293860                 STRING                                           29386059
293870                      ' SUKUT703 - 6000- '                        29387059
293871                      ' MAX RETRY '                               29387159
293880                      ' SQL:'               PV-DISP-SQLCODE       29388059
293890                      ' SHIPMT:'            PV-DISP-SHIPT-ID      29389059
293891                      ' PO:'                PV-DISP-PO-NBR        29389159
293892                      '-'                   PV-DISP-RCVR-SEQ-NBR  29389259
293893                                            DELIMITED BY SIZE     29389359
293894                                       INTO SU044-CRA-RET-MSG     29389459
294400         MOVE SQLCA     TO SU044-SQLCA                            29440000
294500         SET SU044-INVALID-SQL TO TRUE                            29450000
294600     END-IF.                                                      29460000
294700                                                                  29470000
294800     EVALUATE TRUE                                                29480000
294900         WHEN SQLCODE = ZERO                                      29490000
295000              MOVE 'A'  TO PV-TRN-CDE                             29500000
295100              PERFORM 6050-INSERT-TAUSHPO                         29510000
295200     END-EVALUATE.                                                29520000
295300                                                                  29530000
295301*----------------------------------------------------------------*29530176
295302*  check if a primary shipment already exists for the             29530276
295303*  PO-PRO-BOL on the trip                                         29530376
295304*----------------------------------------------------------------*29530476
295310 6010-CHECK-PRIM-EXISTS.                                          29531076
295311                                                                  29531183
295312     IF  PS-BLD-INTERNAL-TABLE-YES                                29531283
295313         MOVE  '6010'  TO  PT-CURR-PARA                           29531383
295314         PERFORM 8120-INTERNAL-TABLE                              29531483
295315     END-IF.                                                      29531583
295316                                                                  29531683
295317                                                                  29531776
295318     MOVE SPACE  TO  PV-PRIM-SHIPT-IND.                           29531881
295319                                                                  29531981
295336                                                                  29533681
295337     EXEC SQL                                                     29533781
295338         SELECT  A.PRIM_SHIPT_IND                                 29533881
295340           INTO :PV-PRIM-SHIPT-IND                                29534081
295370           FROM TSHPTPO A                                         29537079
295371              , TSHIPMT B                                         29537177
295372          WHERE A.PO_NBR         = :SHPTPO-PO-NBR                 29537276
295373            AND A.PRIM_SHIPT_IND = 'Y'                            29537376
295374            AND A.SHIPT_ID       = B.SHIPT_ID                     29537476
295375            AND B.BOL_NBR        = :SHIPMT-BOL-NBR                29537576
295376            AND B.PRO_NBR        = :SHIPMT-PRO-NBR                29537676
295377            AND B.TRIP_ID        = :SHIPMT-TRIP-ID                29537776
295381     END-EXEC.                                                    29538176
295382                                                                  29538276
295383     EVALUATE TRUE                                                29538376
295384         WHEN SQLCODE = ZERO                                      29538476
295385         WHEN SQLCODE = -811                                      29538576
295386              continue                                            29538676
295387         WHEN SQLCODE = +100                                      29538776
295388         WHEN SQLCODE = -305                                      29538876
295389              MOVE SPACE  TO PV-PRIM-SHIPT-IND                    29538980
295391                                                                  29539176
295392         WHEN SQLWARN0 NOT = SPACE                                29539276
295393         WHEN SQLCODE  NOT = +0                                   29539376
295394                                                                  29539476
295395              MOVE '6010'  TO  PV-CSSL-PARA                       29539576
295396              perform 8110-WRITE-suws044-TO-CSSL                  29539676
295397                                                                  29539776
295399             MOVE SHPTPO-PO-NBR      TO PV-DISP-PO-NBR            29539976
295401             MOVE SQLCODE            TO PV-DISP-SQLCODE           29540176
295402             STRING                                               29540276
295403                  ' SUKUT703 - 6010- '                            29540376
295404                  ' SQL:'               PV-DISP-SQLCODE           29540476
295406                  ' PO:'                PV-DISP-PO-NBR            29540676
295407                  ' PRO:'               SHIPMT-PRO-NBR            29540776
295408                  ' BOL:'               SHIPMT-BOL-NBR            29540876
295410                                        DELIMITED BY SIZE         29541076
295411                                   INTO SU044-CRA-RET-MSG         29541176
295412             MOVE SQLCA              TO SU044-SQLCA               29541276
295413             SET SU044-INVALID-SQL TO TRUE                        29541376
295414     END-EVALUATE.                                                29541476
295415                                                                  29541576
295442                                                                  29544281
295450*----------------------------------------------------------------*29545076
295500*  INSERT THE PO TO THE SHIPMENT PO ASSOCIATION AUDIT TABLE       29550000
295600*----------------------------------------------------------------*29560000
295700                                                                  29570000
295800 6050-INSERT-TAUSHPO.                                             29580000
295810                                                                  29581061
295820     IF  PS-BLD-INTERNAL-TABLE-YES                                29582061
295830         MOVE  '6050'  TO  PT-CURR-PARA                           29583061
295840         PERFORM 8120-INTERNAL-TABLE                              29584061
295850     END-IF.                                                      29585061
295900                                                                  29590000
296000     PERFORM                                                      29600000
296100         WITH TEST AFTER                                          29610000
296200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     29620000
296300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            29630000
296400                (SQLCODE = ZERO)   OR                             29640000
296500                (SQLCODE = +100)                                  29650000
296600*                                                                 29660000
296700         EXEC SQL                                                 29670000
296800             SELECT SHIPT_ID,                                     29680000
296900                    PO_NBR,                                       29690000
297000                    REC_SEQ_NBR,                                  29700000
297100                    EXPTED_CART_CNT,                              29710000
297200                    ACTL_CART_CNT,                                29720000
297300                    DMG_CART_CNT,                                 29730000
297400                    PKSL_IND,                                     29740000
297500                    VEND_NAME,                                    29750000
297600                    FRGT_CHG_AMT,                                 29760000
297700                    LAST_UPD_PGM_ID,                              29770000
297800                    CRE_USER_ID,                                  29780000
297900                    CARR_CART_CT,                                 29790000
298000                    CARR_LAST_UPD_DTE,                            29800000
298100                    CARR_LAST_UPD_TIME,                           29810000
298200                    VEND_CART_CT,                                 29820000
298300                    VEND_LAST_UPD_DTE,                            29830000
298400                    VEND_LAST_UPD_TIME,                           29840000
298500                    CRE_TMST,                                     29850000
298600                    LAST_UPD_DTE,                                 29860000
298700                    LAST_UPD_TIME,                                29870000
298800                    LAST_UPD_USER_ID,                             29880000
298900                    PRIM_SHIPT_IND                                29890000
299000                   ,SPLT_XMIT_IND                                 29900000
299100                   ,SPLT_XMIT_DTE                                 29910000
299200                   ,SPLT_XMIT_TM                                  29920000
299300               INTO :SHPTPO-SHIPT-ID,                             29930000
299400                    :SHPTPO-PO-NBR,                               29940000
299500                    :SHPTPO-REC-SEQ-NBR,                          29950000
299600                    :SHPTPO-EXPTED-CART-CNT,                      29960000
299700                    :SHPTPO-ACTL-CART-CNT,                        29970000
299800                    :SHPTPO-DMG-CART-CNT,                         29980000
299900                    :SHPTPO-PKSL-IND,                             29990000
300000                    :SHPTPO-VEND-NAME,                            30000000
300100                    :SHPTPO-FRGT-CHG-AMT,                         30010000
300200                    :SHPTPO-LAST-UPD-PGM-ID,                      30020000
300300                    :SHPTPO-CRE-USER-ID,                          30030000
300400                    :SHPTPO-CARR-CART-CT,                         30040000
300500                    :SHPTPO-CARR-LAST-UPD-DTE,                    30050000
300600                    :SHPTPO-CARR-LAST-UPD-TIME,                   30060000
300700                    :SHPTPO-VEND-CART-CT,                         30070000
300800                    :SHPTPO-VEND-LAST-UPD-DTE,                    30080000
300900                    :SHPTPO-VEND-LAST-UPD-TIME,                   30090000
301000                    :SHPTPO-CRE-TMST,                             30100000
301100                    :SHPTPO-LAST-UPD-DTE,                         30110000
301200                    :SHPTPO-LAST-UPD-TIME,                        30120000
301300                    :SHPTPO-LAST-UPD-USER-ID,                     30130000
301400                    :SHPTPO-PRIM-SHIPT-IND                        30140000
301500                   ,:SHPTPO-SPLT-XMIT-IND                         30150000
301600                   ,:SHPTPO-SPLT-XMIT-DTE                         30160000
301700                   ,:SHPTPO-SPLT-XMIT-TM                          30170000
301800               FROM TSHPTPO                                       30180000
301900              WHERE SHIPT_ID = :DK-CURR-SHIPT-ID                  30190000
302000                AND PO_NBR   = :DK-PO-NBR                         30200000
302100         END-EXEC                                                 30210000
302200*                                                                 30220000
302300         EVALUATE TRUE                                            30230000
302400             WHEN SQLCODE = ZERO                                  30240000
302500             WHEN SQLCODE = +100                                  30250000
302600             WHEN SQLCODE = -904                                  30260000
302700             WHEN SQLCODE = -913                                  30270000
302800                 CONTINUE                                         30280000
302900                                                                  30290000
303000             WHEN SQLWARN0 NOT = SPACE                            30300000
303100             WHEN SQLCODE  NOT = +0                               30310000
303110                                                                  30311058
303111                  MOVE '6050'  TO  PV-CSSL-PARA                   30311158
303120                  perform 8110-WRITE-suws044-TO-CSSL              30312058
303130                                                                  30313058
303200                 MOVE SHPTPO-SHIPT-ID    TO PV-DISP-SHIPT-ID      30320059
303300                 MOVE SHPTPO-PO-NBR      TO PV-DISP-PO-NBR        30330059
303400                 MOVE SHPTPO-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR  30340059
303600                 MOVE SQLCODE            TO PV-DISP-SQLCODE       30360059
303700                 STRING                                           30370000
303800                      ' SUKUT703 - 6050- '                        30380059
303900                      ' SQL:'               PV-DISP-SQLCODE       30390059
304100                      ' SHIPMT:'            PV-DISP-SHIPT-ID      30410059
304300                      ' PO:'                PV-DISP-PO-NBR        30430059
304500                      '-'                   PV-DISP-RCVR-SEQ-NBR  30450059
304600                                            DELIMITED BY SIZE     30460059
304700                                       INTO SU044-CRA-RET-MSG     30470059
304800                 MOVE SQLCA              TO SU044-SQLCA           30480059
304900                 SET SU044-INVALID-SQL TO TRUE                    30490000
305000         END-EVALUATE                                             30500000
305100                                                                  30510000
305200     END-PERFORM.                                                 30520000
305300                                                                  30530000
305400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30540000
305500             AND (SQLCODE NOT = +0)                               30550000
305510                 MOVE SHPTPO-SHIPT-ID    TO PV-DISP-SHIPT-ID      30551059
305520                 MOVE SHPTPO-PO-NBR      TO PV-DISP-PO-NBR        30552059
305530                 MOVE SHPTPO-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR  30553059
305540                 MOVE SQLCODE            TO PV-DISP-SQLCODE       30554059
305550                 STRING                                           30555059
305560                      ' SUKUT703 - 6050- '                        30556059
305561                      ' MAX RETRY '                               30556159
305570                      ' SQL:'               PV-DISP-SQLCODE       30557059
305580                      ' SHIPMT:'            PV-DISP-SHIPT-ID      30558059
305590                      ' PO:'                PV-DISP-PO-NBR        30559059
305591                      '-'                   PV-DISP-RCVR-SEQ-NBR  30559159
305592                                            DELIMITED BY SIZE     30559259
305593                                       INTO SU044-CRA-RET-MSG     30559359
306100         MOVE SQLCA     TO SU044-SQLCA                            30610000
306200         SET SU044-INVALID-SQL TO TRUE                            30620000
306300     END-IF.                                                      30630000
306400                                                                  30640000
306410                                                                  30641061
306420     IF  PS-BLD-INTERNAL-TABLE-YES                                30642061
306430         MOVE  '605b'  TO  PT-CURR-PARA                           30643061
306440         PERFORM 8120-INTERNAL-TABLE                              30644061
306450     END-IF.                                                      30645061
306460                                                                  30646061
306500     MOVE PV-TRN-CDE               TO AUSHPO-TRN-CDE              30650000
306600     PERFORM                                                      30660000
306700         WITH TEST AFTER                                          30670000
306800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     30680000
306900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            30690000
307000                 SQLCODE = ZERO                                   30700000
307100*                                                                 30710000
307200         EXEC SQL                                                 30720000
307300             INSERT INTO TAUSHPO                                  30730000
307400                   (SHIPT_ID,                                     30740000
307500                    PO_NBR,                                       30750000
307600                    REC_SEQ_NBR,                                  30760000
307700                    EXPTED_CART_CNT,                              30770000
307800                    ACTL_CART_CNT,                                30780000
307900                    DMG_CART_CNT,                                 30790000
308000                    PKSL_IND,                                     30800000
308100                    VEND_NAME,                                    30810000
308200                    FRGT_CHG_AMT,                                 30820000
308300                    LAST_UPD_PGM_ID,                              30830000
308400                    CRE_USER_ID,                                  30840000
308500                    CARR_CART_CT,                                 30850000
308600                    CARR_LAST_UPD_DTE,                            30860000
308700                    CARR_LAST_UPD_TIME,                           30870000
308800                    VEND_CART_CT,                                 30880000
308900                    VEND_LAST_UPD_DTE,                            30890000
309000                    VEND_LAST_UPD_TIME,                           30900000
309100                    CRE_TMST,                                     30910000
309200                    LAST_UPD_DTE,                                 30920000
309300                    LAST_UPD_TIME,                                30930000
309400                    LAST_UPD_USER_ID,                             30940000
309500                    PRIM_SHIPT_IND                                30950000
309600                   ,SPLT_XMIT_IND                                 30960000
309700                   ,SPLT_XMIT_DTE                                 30970000
309800                   ,SPLT_XMIT_TM                                  30980000
309900                   ,TRN_CDE )                                     30990000
310000             VALUES                                               31000000
310100                  (:SHPTPO-SHIPT-ID,                              31010000
310200                   :SHPTPO-PO-NBR,                                31020000
310300                   :SHPTPO-REC-SEQ-NBR,                           31030000
310400                   :SHPTPO-EXPTED-CART-CNT,                       31040000
310500                   :SHPTPO-ACTL-CART-CNT,                         31050000
310600                   :SHPTPO-DMG-CART-CNT,                          31060000
310700                   :SHPTPO-PKSL-IND,                              31070000
310800                   :SHPTPO-VEND-NAME,                             31080000
310900                   :SHPTPO-FRGT-CHG-AMT,                          31090000
311000                   :SHPTPO-LAST-UPD-PGM-ID,                       31100000
311100                   :SHPTPO-CRE-USER-ID,                           31110000
311200                   :SHPTPO-CARR-CART-CT,                          31120000
311300                   :SHPTPO-CARR-LAST-UPD-DTE,                     31130000
311400                   :SHPTPO-CARR-LAST-UPD-TIME,                    31140000
311500                   :SHPTPO-VEND-CART-CT,                          31150000
311600                   :SHPTPO-VEND-LAST-UPD-DTE,                     31160000
311700                   :SHPTPO-VEND-LAST-UPD-TIME,                    31170000
311800                   :SHPTPO-CRE-TMST,                              31180000
311900                   :SHPTPO-LAST-UPD-DTE,                          31190000
312000                   :SHPTPO-LAST-UPD-TIME,                         31200000
312100                   :SHPTPO-LAST-UPD-USER-ID,                      31210000
312200                   :SHPTPO-PRIM-SHIPT-IND                         31220000
312300                  ,:SHPTPO-SPLT-XMIT-IND                          31230000
312400                  ,:SHPTPO-SPLT-XMIT-DTE                          31240000
312500                  ,:SHPTPO-SPLT-XMIT-TM                           31250000
312600                  ,:AUSHPO-TRN-CDE )                              31260000
312700         END-EXEC                                                 31270000
312800*                                                                 31280000
312900         EVALUATE TRUE                                            31290000
313000             WHEN SQLCODE = +0                                    31300000
313100             WHEN SQLCODE = -904                                  31310000
313200             WHEN SQLCODE = -913                                  31320000
313300                 CONTINUE                                         31330000
313400                                                                  31340000
313500             WHEN SQLWARN0 NOT = SPACES                           31350000
313600             WHEN SQLCODE < +0                                    31360000
313700             WHEN SQLCODE > +0                                    31370000
313710                                                                  31371058
313711                  MOVE '605B'  TO  PV-CSSL-PARA                   31371158
313720                  perform 8110-WRITE-suws044-TO-CSSL              31372058
313730                                                                  31373058
313800                 MOVE SHPTPO-SHIPT-ID    TO PV-DISP-SHIPT-ID      31380059
313900                 MOVE SHPTPO-PO-NBR      TO PV-DISP-PO-NBR        31390059
314000                 MOVE SHPTPO-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR  31400059
314200                 MOVE SQLCODE            TO PV-DISP-SQLCODE       31420059
314300                 STRING                                           31430000
314400                      ' SUKUT703 - 605B- '                        31440059
314500                      ' SQL:'               PV-DISP-SQLCODE       31450059
314700                      ' SHIPMT:'            PV-DISP-SHIPT-ID      31470059
314900                      ' PO:'                PV-DISP-PO-NBR        31490059
315100                      '-'                   PV-DISP-RCVR-SEQ-NBR  31510059
315200                                            DELIMITED BY SIZE     31520059
315300                                       INTO SU044-CRA-RET-MSG     31530059
315400                 MOVE SQLCA              TO SU044-SQLCA           31540059
315500                 SET SU044-INVALID-SQL TO TRUE                    31550000
315600         END-EVALUATE                                             31560000
315700     END-PERFORM.                                                 31570000
315800                                                                  31580000
315900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31590000
316000             AND (SQLCODE NOT = +0)                               31600000
316010                 MOVE SHPTPO-SHIPT-ID    TO PV-DISP-SHIPT-ID      31601059
316020                 MOVE SHPTPO-PO-NBR      TO PV-DISP-PO-NBR        31602059
316030                 MOVE SHPTPO-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR  31603059
316040                 MOVE SQLCODE            TO PV-DISP-SQLCODE       31604059
316050                 STRING                                           31605059
316060                      ' SUKUT703 - 605B- '                        31606059
316061                      ' MAX RETRY '                               31606159
316070                      ' SQL:'               PV-DISP-SQLCODE       31607059
316080                      ' SHIPMT:'            PV-DISP-SHIPT-ID      31608059
316090                      ' PO:'                PV-DISP-PO-NBR        31609059
316091                      '-'                   PV-DISP-RCVR-SEQ-NBR  31609159
316092                                            DELIMITED BY SIZE     31609259
316093                                       INTO SU044-CRA-RET-MSG     31609359
316700         MOVE SQLCA     TO SU044-SQLCA                            31670000
316800         SET SU044-INVALID-SQL TO TRUE                            31680000
316900     END-IF.                                                      31690000
317000                                                                  31700000
317100                                                                  31710000
317200*----------------------------------------------------------------*31720000
317300*  INSERT A ROW TO THE SHIPMENT STATUS TABLE                      31730000
317400*                                                                 31740000
317500*----------------------------------------------------------------*31750000
317600 6100-INSERT-TSHIPST.                                             31760000
317610                                                                  31761061
317620     IF  PS-BLD-INTERNAL-TABLE-YES                                31762061
317630         MOVE  '6100'  TO  PT-CURR-PARA                           31763061
317640         PERFORM 8120-INTERNAL-TABLE                              31764061
317650     END-IF.                                                      31765061
317700                                                                  31770000
317800     INITIALIZE DCLTSHIPST.                                       31780000
317900                                                                  31790000
318000     PERFORM 6150-SELECT-MAX-TRIPST.                              31800018
318100                                                                  31810018
318200     MOVE PV-CURR-SHIPT-ID         TO SHIPST-SHIPT-ID.            31820000
318300     MOVE 'FASYSTEM'               TO SHIPST-STATUS-UID.          31830000
318400                                                                  31840000
318500     PERFORM                                                      31850000
318600         WITH TEST AFTER                                          31860000
318700         VARYING PV-RETRY-COUNTER                                 31870000
318800         FROM 1 BY 1                                              31880000
318900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31890000
319000             OR (SQLCODE = +0))                                   31900000
319100                                                                  31910000
319200         EXEC SQL                                                 31920000
319300             INSERT  INTO TSHIPST                                 31930000
319400                   ( SHIPT_ID                                     31940000
319500                    ,SHIPT_STATUS_CDE                             31950000
319600                    ,STATUS_UID )                                 31960000
319700             VALUES                                               31970000
319800                   ( :SHIPST-SHIPT-ID                             31980000
319900                    ,:SHIPST-SHIPT-STATUS-CDE                     31990000
320000                    ,:SHIPST-STATUS-UID)                          32000000
320100         END-EXEC                                                 32010000
320200                                                                  32020000
320300         EVALUATE TRUE                                            32030000
320400             WHEN SQLCODE = +0                                    32040000
320500             WHEN SQLCODE = -904                                  32050000
320600             WHEN SQLCODE = -913                                  32060000
320700                 CONTINUE                                         32070000
320800                                                                  32080000
320900             WHEN SQLWARN0 NOT = SPACES                           32090000
321000             WHEN SQLCODE < +0                                    32100000
321100             WHEN SQLCODE > +0                                    32110000
321110                                                                  32111058
321111                  MOVE '6100'  TO  PV-CSSL-PARA                   32111158
321120                  perform 8110-WRITE-suws044-TO-CSSL              32112058
321130                                                                  32113058
321200                 MOVE SHIPST-SHIPT-ID TO PV-DISP-SHIPT-ID         32120000
321300                 MOVE SQLCODE         TO PV-DISP-SQLCODE          32130059
321400                 STRING                                           32140000
321500                      ' SUKUT703 - 6100- '                        32150059
321600                      ' SQL:'            PV-DISP-SQLCODE          32160059
321800                      ' SHIPMT:'         PV-DISP-SHIPT-ID         32180059
321900                                         DELIMITED BY SIZE        32190059
322000                                    INTO SU044-CRA-RET-MSG        32200059
322100                 MOVE SQLCA           TO SU044-SQLCA              32210059
322200                 SET SU044-INVALID-SQL TO TRUE                    32220000
322300         END-EVALUATE                                             32230000
322400     END-PERFORM.                                                 32240000
322500                                                                  32250000
322600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32260000
322700             AND (SQLCODE NOT = +0)                               32270000
322710                 MOVE SHIPST-SHIPT-ID TO PV-DISP-SHIPT-ID         32271059
322720                 MOVE SQLCODE         TO PV-DISP-SQLCODE          32272059
322730                 STRING                                           32273059
322740                      ' SUKUT703 - 6100- '                        32274059
322741                      ' MAX RETRY '                               32274159
322750                      ' SQL:'            PV-DISP-SQLCODE          32275059
322760                      ' SHIPMT:'         PV-DISP-SHIPT-ID         32276059
322770                                         DELIMITED BY SIZE        32277059
322780                                    INTO SU044-CRA-RET-MSG        32278059
323700         MOVE SQLCA     TO SU044-SQLCA                            32370000
323800         SET SU044-INVALID-SQL TO TRUE                            32380000
323900     END-IF.                                                      32390000
324000                                                                  32400000
324100                                                                  32410000
324200 6150-SELECT-MAX-TRIPST.                                          32420018
324210                                                                  32421061
324220     IF  PS-BLD-INTERNAL-TABLE-YES                                32422061
324230         MOVE  '6150'  TO  PT-CURR-PARA                           32423061
324240         PERFORM 8120-INTERNAL-TABLE                              32424061
324250     END-IF.                                                      32425061
324300                                                                  32430018
324400      MOVE SU044-TRIP-ID TO TRIPST-TRIP-ID.                       32440018
324500                                                                  32450018
324600      EXEC SQL                                                    32460018
324700           SELECT TRIP_STATUS_CDE                                 32470018
324800              INTO  :TRIPST-TRIP-STATUS-CDE                       32480018
324900             FROM   TTRIPST B                                     32490018
325000        WHERE                                                     32500018
325100             B.TRIP_ID     = :TRIPST-TRIP-ID                      32510018
325200          AND                                                     32520018
325300                TIMESTAMP(B.STATUS_DTE, B.STATUS_TME)             32530018
325400            IN                                                    32540018
325500                (SELECT                                           32550018
325600                       MAX(TIMESTAMP(A.STATUS_DTE, A.STATUS_TME)) 32560018
325700                 FROM   TTRIPST A                                 32570018
325800                 WHERE  A.TRIP_ID     = B.TRIP_ID )               32580018
325900       END-EXEC.                                                  32590018
326000                                                                  32600018
326100       EVALUATE TRUE                                              32610018
326200           WHEN SQLCODE = +0                                      32620018
326300                MOVE TRIPST-TRIP-STATUS-CDE TO                    32630018
326400                                  SHIPST-SHIPT-STATUS-CDE         32640018
326500           WHEN SQLCODE = +100                                    32650018
326600                MOVE 'EN'    TO SHIPST-SHIPT-STATUS-CDE           32660018
326700           WHEN SQLWARN0 NOT = SPACES                             32670018
326800           WHEN SQLCODE < +0                                      32680018
326900           WHEN SQLCODE > +0                                      32690018
326910                                                                  32691058
326911                MOVE '6150'  TO  PV-CSSL-PARA                     32691158
326920                perform 8110-WRITE-suws044-TO-CSSL                32692058
326930                                                                  32693058
327000               MOVE TRIPST-TRIP-ID  TO PV-DISP-TRIP-ID            32700018
327100               MOVE SQLCODE         TO PV-DISP-SQLCODE            32710059
327200               STRING                                             32720018
327300                    ' SUKUT703 - 6150- '                          32730059
327400                    ' SQL:'            PV-DISP-SQLCODE            32740059
327600                    ' TRIP:'           PV-DISP-TRIP-ID            32760059
327700                                       DELIMITED BY SIZE          32770059
327800                                  INTO SU044-CRA-RET-MSG          32780059
327900               MOVE SQLCA           TO SU044-SQLCA                32790059
328000               SET SU044-INVALID-SQL TO TRUE                      32800018
328100       END-EVALUATE.                                              32810018
328200                                                                  32820018
328300*----------------------------------------------------------------*32830000
328400*  INSERT A ROW TO THE SHIPTMENT AUDIT TABLE                      32840000
328500*----------------------------------------------------------------*32850000
328600 6200-INSERT-TAUSHIP.                                             32860000
328610                                                                  32861061
328620     IF  PS-BLD-INTERNAL-TABLE-YES                                32862061
328630         MOVE  '6200'  TO  PT-CURR-PARA                           32863061
328640         PERFORM 8120-INTERNAL-TABLE                              32864061
328650     END-IF.                                                      32865061
328700                                                                  32870000
328800     INITIALIZE DCLTAUSHIP.                                       32880000
328900                                                                  32890000
329000     PERFORM                                                      32900000
329100         WITH TEST AFTER                                          32910000
329200         VARYING PV-RETRY-COUNTER                                 32920000
329300         FROM 1 BY 1                                              32930000
329400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32940000
329500             OR (SQLCODE = +0))                                   32950000
329600                                                                  32960000
329610* 12-19-2011 CHRISTINE TWIEHAUS WR40574 ADDED CARR AUTH ID BELOW  32961038
329700         EXEC SQL                                                 32970000
329800             SELECT  A.TRIP_ID                                    32980000
329900                    ,A.SHIPT_ID                                   32990000
330000                    ,A.CRT_SRC_CDE                                33000000
330100                    ,A.LAST_UPD_DTE                               33010000
330200                    ,A.LAST_UPD_TME                               33020000
330300                    ,A.LAST_UPD_UID                               33030000
330400                    ,A.PRO_SCAC_ID                                33040000
330500                    ,A.PRO_NBR                                    33050000
330600                    ,A.BOL_NBR                                    33060000
330700                    ,A.SHIPPER_NME                                33070000
330800                    ,A.SHIPT_TYP_CDE                              33080000
330900                    ,A.EXPTED_GRO_WGHT                            33090000
331000                    ,A.PKG_TYP_CDE                                33100000
331100                    ,A.EXPTED_PKG_QTY                             33110000
331200                    ,A.FRGT_CHG_AMT                               33120000
331300                    ,A.FRGT_TERMS_CDE                             33130000
331400                    ,A.EXPTED_PLT_QTY                             33140000
331500                    ,A.VEND_SHIP_DTE                              33150000
331600                    ,A.EST_AR_TMST                                33160000
331700                    ,A.ORIG_SCAC_ID                               33170000
331800                    ,A.LAST_UPD_PGM_ID                            33180000
331900                    ,A.CRE_USER_ID                                33190000
332000                    ,A.CARR_CART_CT                               33200000
332100                    ,A.CARR_LAST_UPD_DTE                          33210000
332200                    ,A.CARR_LAST_UPD_TIME                         33220000
332300                    ,A.VEND_CART_CT                               33230000
332400                    ,A.VEND_LAST_UPD_DTE                          33240000
332500                    ,A.VEND_LAST_UPD_TIME                         33250000
332600                    ,A.VEH_NBR                                    33260000
332700                    ,A.AUTH_NBR                                   33270000
332800                    ,A.AUTH_DTE                                   33280000
332900                    ,A.CONFIRM_DTE                                33290000
333000                    ,A.CONFIRM_TIME                               33300000
333100                    ,A.COMPLETE_PRO_NBR                           33310000
333200                    ,A.COMPLETE_BOL_NBR                           33320000
333300                    ,A.PROCESSED_DTE                              33330000
333400                    ,A.INVC_NBR                                   33340000
333410                    ,A.CARR_AUTH_ID                               33341038
333500            INTO     :SHIPMT-TRIP-ID                              33350000
333600                       :DN-TRIP-ID                                33360000
333700                    ,:SHIPMT-SHIPT-ID                             33370000
333800                    ,:SHIPMT-CRT-SRC-CDE                          33380000
333900                    ,:SHIPMT-LAST-UPD-DTE                         33390000
334000                    ,:SHIPMT-LAST-UPD-TME                         33400000
334100                    ,:SHIPMT-LAST-UPD-UID                         33410000
334200                    ,:SHIPMT-PRO-SCAC-ID                          33420000
334300                    ,:SHIPMT-PRO-NBR                              33430000
334400                    ,:SHIPMT-BOL-NBR                              33440000
334500                    ,:SHIPMT-SHIPPER-NME                          33450000
334600                    ,:SHIPMT-SHIPT-TYP-CDE                        33460000
334700                    ,:SHIPMT-EXPTED-GRO-WGHT                      33470000
334800                    ,:SHIPMT-PKG-TYP-CDE                          33480000
334900                    ,:SHIPMT-EXPTED-PKG-QTY                       33490000
335000                    ,:SHIPMT-FRGT-CHG-AMT                         33500000
335100                    ,:SHIPMT-FRGT-TERMS-CDE                       33510000
335200                    ,:SHIPMT-EXPTED-PLT-QTY                       33520000
335300                    ,:SHIPMT-VEND-SHIP-DTE                        33530000
335400                    ,:SHIPMT-EST-AR-TMST                          33540000
335500                       :DN-EST-AR-TMST                            33550000
335600                    ,:SHIPMT-ORIG-SCAC-ID                         33560000
335700                    ,:SHIPMT-LAST-UPD-PGM-ID                      33570000
335800                    ,:SHIPMT-CRE-USER-ID                          33580000
335900                    ,:SHIPMT-CARR-CART-CT                         33590000
336000                    ,:SHIPMT-CARR-LAST-UPD-DTE                    33600000
336100                    ,:SHIPMT-CARR-LAST-UPD-TIME                   33610000
336200                    ,:SHIPMT-VEND-CART-CT                         33620000
336300                    ,:SHIPMT-VEND-LAST-UPD-DTE                    33630000
336400                    ,:SHIPMT-VEND-LAST-UPD-TIME                   33640000
336500                    ,:SHIPMT-VEH-NBR                              33650000
336600                    ,:SHIPMT-AUTH-NBR                             33660000
336700                    ,:SHIPMT-AUTH-DTE                             33670000
336800                    ,:SHIPMT-CONFIRM-DTE                          33680000
336900                    ,:SHIPMT-CONFIRM-TIME                         33690000
337000                    ,:SHIPMT-COMPLETE-PRO-NBR                     33700000
337100                    ,:SHIPMT-COMPLETE-BOL-NBR                     33710000
337200                    ,:SHIPMT-PROCESSED-DTE                        33720000
337300                    ,:SHIPMT-INVC-NBR                             33730000
337310                    ,:SHIPMT-CARR-AUTH-ID                         33731038
337400           FROM   TSHIPMT A                                       33740000
337500           WHERE  A.SHIPT_ID         = :SHIPMT-SHIPT-ID           33750000
337600         END-EXEC                                                 33760000
337700                                                                  33770000
337800         EVALUATE TRUE                                            33780000
337900             WHEN SQLCODE = +0                                    33790000
338000             WHEN SQLCODE = -904                                  33800000
338100             WHEN SQLCODE = -913                                  33810000
338200                 CONTINUE                                         33820000
338300                                                                  33830000
338400             WHEN SQLWARN0 NOT = SPACES                           33840000
338500             WHEN SQLCODE < +0                                    33850000
338600             WHEN SQLCODE > +0                                    33860000
338610                                                                  33861058
338611                  MOVE '6200'  TO  PV-CSSL-PARA                   33861158
338620                  perform 8110-WRITE-suws044-TO-CSSL              33862058
338630                                                                  33863058
338700                 MOVE SHIPMT-SHIPT-ID TO PV-DISP-SHIPT-ID         33870000
338800                 MOVE SQLCODE         TO PV-DISP-SQLCODE          33880059
338900                 STRING                                           33890000
339000                      ' SUKUT703 - 6200- '                        33900059
339100                      ' SQL:'            PV-DISP-SQLCODE          33910059
339300                      ' SHIPMT:'         PV-DISP-SHIPT-ID         33930059
339400                                         DELIMITED BY SIZE        33940059
339500                                    INTO SU044-CRA-RET-MSG        33950059
339600                 MOVE SQLCA           TO SU044-SQLCA              33960059
339700                 SET SU044-INVALID-SQL TO TRUE                    33970000
339800         END-EVALUATE                                             33980000
339900     END-PERFORM.                                                 33990000
340000                                                                  34000000
340100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        34010000
340200             AND (SQLCODE NOT = +0)                               34020000
340210                 MOVE SHIPMT-SHIPT-ID TO PV-DISP-SHIPT-ID         34021059
340220                 MOVE SQLCODE         TO PV-DISP-SQLCODE          34022059
340230                 STRING                                           34023059
340240                      ' SUKUT703 - 6200- '                        34024059
340241                      ' MAX RETRY '                               34024159
340250                      ' SQL:'            PV-DISP-SQLCODE          34025059
340260                      ' SHIPMT:'         PV-DISP-SHIPT-ID         34026059
340270                                         DELIMITED BY SIZE        34027059
340280                                    INTO SU044-CRA-RET-MSG        34028059
341200         MOVE SQLCA     TO SU044-SQLCA                            34120000
341300         SET SU044-INVALID-SQL TO TRUE                            34130000
341400     END-IF.                                                      34140000
341500                                                                  34150000
341520     IF  PS-BLD-INTERNAL-TABLE-YES                                34152061
341530         MOVE  '620B'  TO  PT-CURR-PARA                           34153061
341540         PERFORM 8120-INTERNAL-TABLE                              34154061
341550     END-IF.                                                      34155061
341560                                                                  34156061
341600     PERFORM                                                      34160000
341700         WITH TEST AFTER                                          34170000
341800         VARYING PV-RETRY-COUNTER                                 34180000
341900         FROM 1 BY 1                                              34190000
342000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34200000
342100             OR (SQLCODE = +0))                                   34210000
342200                                                                  34220000
342210* 12-19-2011 CHRISTINE TWIEHAUS WR40574 ADDED CARR AUTH ID BELOW  34221038
342300         EXEC SQL                                                 34230000
342400             INSERT  INTO TAUSHIP                                 34240000
342500                    (TRIP_ID                                      34250000
342600                    ,SHIPT_ID                                     34260000
342700                    ,CRT_SRC_CDE                                  34270000
342800                    ,LAST_UPD_DTE                                 34280000
342900                    ,LAST_UPD_TME                                 34290000
343000                    ,LAST_UPD_UID                                 34300000
343100                    ,PRO_SCAC_ID                                  34310000
343200                    ,PRO_NBR                                      34320000
343300                    ,BOL_NBR                                      34330000
343400                    ,SHIPPER_NME                                  34340000
343500                    ,SHIPT_TYP_CDE                                34350000
343600                    ,EXPTED_GRO_WGHT                              34360000
343700                    ,PKG_TYP_CDE                                  34370000
343800                    ,EXPTED_PKG_QTY                               34380000
343900                    ,FRGT_CHG_AMT                                 34390000
344000                    ,FRGT_TERMS_CDE                               34400000
344100                    ,EST_AR_TMST                                  34410000
344200                    ,VEND_SHIP_DTE                                34420000
344300                    ,EXPTED_PLT_QTY                               34430000
344400                    ,ORIG_SCAC_ID                                 34440000
344500                    ,LAST_UPD_PGM_ID                              34450000
344600                    ,CRE_USER_ID                                  34460000
344700                    ,CARR_CART_CT                                 34470000
344800                    ,CARR_LAST_UPD_DTE                            34480000
344900                    ,CARR_LAST_UPD_TIME                           34490000
345000                    ,VEND_CART_CT                                 34500000
345100                    ,VEND_LAST_UPD_DTE                            34510000
345200                    ,VEND_LAST_UPD_TIME                           34520000
345300                    ,VEH_NBR                                      34530000
345400                    ,AUTH_NBR                                     34540000
345500                    ,AUTH_DTE                                     34550000
345600                    ,CONFIRM_DTE                                  34560000
345700                    ,CONFIRM_TIME                                 34570000
345800                    ,AUD_STATUS_CDE                               34580000
345900                    ,PROCESSED_DTE                                34590000
346000                    ,INVC_NBR                                     34600038
346010                    ,CARR_AUTH_ID)                                34601038
346100            VALUES  (:SHIPMT-TRIP-ID                              34610000
346200                       :DN-TRIP-ID                                34620000
346300                    ,:SHIPMT-SHIPT-ID                             34630000
346400                    ,:SHIPMT-CRT-SRC-CDE                          34640000
346500                    ,:SHIPMT-LAST-UPD-DTE                         34650000
346600                    ,:SHIPMT-LAST-UPD-TME                         34660000
346700                    ,:SHIPMT-LAST-UPD-UID                         34670000
346800                    ,:SHIPMT-PRO-SCAC-ID                          34680000
346900                    ,:SHIPMT-COMPLETE-PRO-NBR                     34690000
347000                    ,:SHIPMT-COMPLETE-BOL-NBR                     34700000
347100                    ,:SHIPMT-SHIPPER-NME                          34710000
347200                    ,:SHIPMT-SHIPT-TYP-CDE                        34720000
347300                    ,:SHIPMT-EXPTED-GRO-WGHT                      34730000
347400                    ,:SHIPMT-PKG-TYP-CDE                          34740000
347500                    ,:SHIPMT-EXPTED-PKG-QTY                       34750000
347600                    ,:SHIPMT-FRGT-CHG-AMT                         34760000
347700                    ,:SHIPMT-FRGT-TERMS-CDE                       34770000
347800                    ,:SHIPMT-EST-AR-TMST                          34780000
347900                       :DN-EST-AR-TMST                            34790000
348000                    ,:SHIPMT-VEND-SHIP-DTE                        34800000
348100                    ,:SHIPMT-EXPTED-PLT-QTY                       34810000
348200                    ,:SHIPMT-ORIG-SCAC-ID                         34820000
348300                    ,:SHIPMT-LAST-UPD-PGM-ID                      34830000
348400                    ,:SHIPMT-CRE-USER-ID                          34840000
348500                    ,:SHIPMT-CARR-CART-CT                         34850000
348600                    ,:SHIPMT-CARR-LAST-UPD-DTE                    34860000
348700                    ,:SHIPMT-CARR-LAST-UPD-TIME                   34870000
348800                    ,:SHIPMT-VEND-CART-CT                         34880000
348900                    ,:SHIPMT-VEND-LAST-UPD-DTE                    34890000
349000                    ,:SHIPMT-VEND-LAST-UPD-TIME                   34900000
349100                    ,:SHIPMT-VEH-NBR                              34910000
349200                    ,:SHIPMT-AUTH-NBR                             34920000
349300                    ,:SHIPMT-AUTH-DTE                             34930000
349400                    ,:SHIPMT-CONFIRM-DTE                          34940000
349500                    ,:SHIPMT-CONFIRM-TIME                         34950000
349600                    ,:SHIPST-SHIPT-STATUS-CDE                     34960000
349700                    ,:SHIPMT-PROCESSED-DTE                        34970000
349800                    ,:SHIPMT-INVC-NBR                             34980038
349810                    ,:SHIPMT-CARR-AUTH-ID)                        34981039
349900         END-EXEC                                                 34990000
350000                                                                  35000000
350100                                                                  35010000
350200         EVALUATE TRUE                                            35020000
350300             WHEN SQLCODE = +0                                    35030000
350400             WHEN SQLCODE = -904                                  35040000
350500             WHEN SQLCODE = -913                                  35050000
350600                 CONTINUE                                         35060000
350700                                                                  35070000
350800             WHEN SQLWARN0 NOT = SPACES                           35080000
350900             WHEN SQLCODE < +0                                    35090000
351000             WHEN SQLCODE > +0                                    35100000
351010                                                                  35101058
351011                  MOVE '620B'  TO  PV-CSSL-PARA                   35101158
351020                  perform 8110-WRITE-suws044-TO-CSSL              35102058
351030                                                                  35103058
351100                 MOVE SHIPMT-SHIPT-ID TO PV-DISP-SHIPT-ID         35110000
351200                 MOVE SHIPMT-TRIP-ID  TO PV-DISP-TRIP-ID          35120000
351300                 MOVE SQLCODE         TO PV-DISP-SQLCODE          35130059
351400                 STRING                                           35140000
351500                      ' SUKUT703 - 6200-INSERT '                  35150059
351600                      ' SQL:'            PV-DISP-SQLCODE          35160059
351800                      ' SHIPMT:'         PV-DISP-SHIPT-ID         35180059
352000                      ' TRIP:'           PV-DISP-TRIP-ID          35200059
352100                                         DELIMITED BY SIZE        35210059
352200                                    INTO SU044-CRA-RET-MSG        35220059
352300                 MOVE SQLCA           TO SU044-SQLCA              35230059
352400                 SET SU044-INVALID-SQL TO TRUE                    35240000
352500         END-EVALUATE                                             35250000
352600     END-PERFORM.                                                 35260000
352700                                                                  35270000
352800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35280000
352900             AND (SQLCODE NOT = +0)                               35290000
352910                 MOVE SHIPMT-SHIPT-ID TO PV-DISP-SHIPT-ID         35291059
352920                 MOVE SHIPMT-TRIP-ID  TO PV-DISP-TRIP-ID          35292059
352930                 MOVE SQLCODE         TO PV-DISP-SQLCODE          35293059
352940                 STRING                                           35294059
352950                      ' SUKUT703 - 6200-INSERT '                  35295059
352951                      ' MAX RETRY '                               35295159
352960                      ' SQL:'            PV-DISP-SQLCODE          35296059
352970                      ' SHIPMT:'         PV-DISP-SHIPT-ID         35297059
352980                      ' TRIP:'           PV-DISP-TRIP-ID          35298059
352990                                         DELIMITED BY SIZE        35299059
352991                                    INTO SU044-CRA-RET-MSG        35299159
354200         MOVE SQLCA     TO SU044-SQLCA                            35420000
354300         SET SU044-INVALID-SQL TO TRUE                            35430000
354400     END-IF.                                                      35440000
354500                                                                  35450000
354600                                                                  35460016
354700 8000-CHECK-FOR-LOGGING.                                          35470016
354710                                                                  35471061
354720     IF  PS-BLD-INTERNAL-TABLE-YES                                35472061
354730         MOVE  '8000'  TO  PT-CURR-PARA                           35473061
354740         PERFORM 8120-INTERNAL-TABLE                              35474061
354750     END-IF.                                                      35475061
354800                                                                  35480016
354900     EXEC SQL                                                     35490016
355000          SELECT FUNC_TXT                                         35500016
355100            INTO :KRPRPM-FUNC-TXT                                 35510016
355200            FROM TKRPRPM                                          35520016
355300           WHERE LOC_ID            = :DK-OPER-UNT-ID              35530016
355400             AND INTFC_SYS_CDE    = 'KHL'                         35540016
355500             AND SYS_PRC_FUNC_CDE = 'SU703D'                      35550016
355600             AND FUNC_PRC_STAT_CDE = 'AC'                         35560016
355610            with ur                                               35561056
355700     END-EXEC.                                                    35570016
355800                                                                  35580016
355900     EVALUATE TRUE                                                35590016
356000         WHEN SQLCODE = ZERO                                      35600016
356100             IF KRPRPM-FUNC-TXT = 'Y'                             35610016
356200                 SET PS-LOG-MESSAGE  TO TRUE                      35620016
356300             ELSE                                                 35630016
356400                 SET PS-NO-LOG-MESSAGE  TO TRUE                   35640016
356500             END-IF                                               35650016
356600         WHEN SQLCODE = +100                                      35660016
356700             SET PS-NO-LOG-MESSAGE  TO TRUE                       35670016
356800         WHEN SQLWARN0 NOT = SPACES                               35680016
356900         WHEN SQLCODE NOT EQUAL ZERO                              35690016
356910                                                                  35691058
356911              MOVE '8000'  TO  PV-CSSL-PARA                       35691158
356920              perform 8110-WRITE-suws044-TO-CSSL                  35692058
356930                                                                  35693058
357000             SET PS-ERROR                                         35700016
357100                 SU044-INVALID-SQL    TO TRUE                     35710016
357200             MOVE  SQLCODE            TO PV-DISP-SQLCODE          35720017
357210             MOVE  DK-OPER-UNT-ID     TO PV-DISP-OPER             35721059
357300             STRING   ' SUKUT703 - 8000- '                        35730059
357400                      ' CALLED BY:'      SU044-PROGRAM-NAME       35740059
357700                      ' SQL:'            PV-DISP-SQLCODE          35770059
357800                      ' OPER:'           PV-DISP-OPER             35780059
357900                                         DELIMITED BY SIZE        35790059
358000                                    INTO PV-CICS-MSG-AREA         35800059
358100             PERFORM 9999-WRITE-TO-CSSL                           35810016
358200             MOVE PV-CICS-MSG-AREA    TO SU044-CRA-RET-MSG        35820059
358300             MOVE SQLCA               TO SU044-SQLCA              35830059
358400             SET SU044-INVALID-SQL TO TRUE                        35840016
358500     END-EVALUATE.                                                35850016
358600                                                                  35860016
358610*---------------------------------------------------------------* 35861045
358620* check parm table (TKRPRPM) to check for logging to CSSL       * 35862045
358630* IF PROGRAM IS TAKING TOO LONG TO RESPOND.  THE VALUE WILL     * 35863045
358640* BE seconds AND WILL BE USED TO DETERMINE IF WE SHOULD WRITE   * 35864045
358650* pt-pARA-tRACKING TABLE TO CSSL                                * 35865045
358660* check parm table (TKRPRPM) to check if will be building the   * 35866045
358670* internal table during processing.  this will be used when     * 35867045
358680* dc's report long resonse times                                * 35868045
358690*  2015-01-29 - DMH                                             * 35869045
358691*---------------------------------------------------------------* 35869145
358692 8100-CHECK-PARA-TRACK-SEC.                                       35869245
358693                                                                  35869345
358699     EXEC SQL                                                     35869945
358700          SELECT  FUNC_QTY                                        35870045
358701               ,  FUNC_txt                                        35870145
358702            INTO :PV-PARM-seconds                                 35870245
358703               , :PS-BLD-INTERNAL-TABLE-SW                        35870345
358704            FROM  TKRPRPM                                         35870445
358705           WHERE  LOC_ID            = :DK-OPER-UNT-ID             35870545
358706             AND  INTFC_SYS_CDE     = 'ACM'                       35870645
358707             AND  SYS_PRC_FUNC_CDE  = 'PATIM4'                    35870745
358708             AND  FUNC_PRC_STAT_CDE = 'AC'                        35870845
358709             AND  fUNC_BEG_TMST    <=  current timestamp          35870945
358710             AND  fUNC_END_TMST    >=  current timestamp          35871045
358711            WITH UR                                               35871145
358712     END-EXEC.                                                    35871245
358713                                                                  35871345
358714     EVALUATE TRUE                                                35871445
358715         WHEN SQLCODE = ZERO                                      35871545
358716              CONTINUE                                            35871645
358717                                                                  35871745
358718         WHEN SQLCODE = +100                                      35871845
358719              MOVE 999999999  TO  PV-PARM-SECONDS                 35871945
358720              SET  PS-BLD-INTERNAL-TABLE-NO   TO TRUE             35872045
358721                                                                  35872145
358722         WHEN SQLWARN0 NOT = SPACES                               35872245
358723         WHEN SQLCODE NOT EQUAL ZERO                              35872345
358726                                                                  35872658
358727              move '8100'  to  PV-CSSL-PARA                       35872745
358728              perform 8110-WRITE-suws044-TO-CSSL                  35872845
358732                                                                  35873245
358733             SET PS-ERROR                                         35873349
358734                 SU044-INVALID-SQL    TO TRUE                     35873449
358735             MOVE  SQLCODE            TO PV-DISP-SQLCODE          35873549
358736             MOVE  DK-OPER-UNT-ID     TO PV-DISP-OPER             35873659
358737             STRING   ' SUKUT703 - 8100- '                        35873759
358738                      ' CALLED BY:'      SU044-PROGRAM-NAME       35873849
358739                      ' SQL:'            PV-DISP-SQLCODE          35873959
358740                      ' OPER:'           PV-DISP-OPER             35874059
358741                                         DELIMITED BY SIZE        35874159
358742                                    INTO PV-CICS-MSG-AREA         35874259
358743             PERFORM 9999-WRITE-TO-CSSL                           35874359
358744             MOVE PV-CICS-MSG-AREA    TO SU044-CRA-RET-MSG        35874459
358745             MOVE SQLCA               TO SU044-SQLCA              35874559
358746             SET SU044-INVALID-SQL TO TRUE                        35874659
358761                                                                  35876145
358762     END-EVALUATE.                                                35876245
358763                                                                  35876345
358764                                                                  35876445
358765*---------------------------------------------------------------* 35876545
358766* WRITE COMMAREA TO CSSL                                        * 35876645
358767* DMH - 01/29/15                                                * 35876745
358768*---------------------------------------------------------------* 35876845
358769 8110-WRITE-suws044-TO-CSSL.                                      35876945
358770                                                                  35877045
358771     IF  PS-BLD-INTERNAL-TABLE-YES                                35877145
358772         MOVE  '8110'  TO  PT-CURR-PARA                           35877245
358773         PERFORM 8120-INTERNAL-TABLE                              35877345
358774     END-IF.                                                      35877445
358775                                                                  35877545
358776     INITIALIZE PV-CICS-MSG-AREA-3                                35877645
358777     MOVE SU044-SHIPT-UNT-ID       TO PV-DISP-SSCC                35877745
358778     MOVE SU044-PO                 TO PV-DISP-PO                  35877845
358779     MOVE SU044-ORIG-REC-SEQ-NBR   TO PV-DISP-ORIG-RCVR           35877945
358780     MOVE SU044-NEW-REC-SEQ-NBR    TO PV-DISP-NEW-RCVR            35878045
358781     MOVE SU044-OPER-UNT-ID        TO PV-DISP-OPER                35878145
358782     MOVE SU044-CRTN-OPER-UNT-ID   TO PV-DISP-CRTN-OPER           35878245
358783     MOVE SU044-FCLTY-ID           TO PV-DISP-FCLTY               35878345
358784     MOVE SU044-TRIP-ID            TO PV-DISP-TRIP                35878445
358785     MOVE SU044-DEST-STR-NBR       TO PV-DISP-DEST-STR            35878545
358786     MOVE SU044-ORIG-SHIP          TO PV-DISP-ORIG-SHIP           35878645
358787     MOVE SU044-NEW-SHIP           TO PV-DISP-NEW-SHIP            35878745
358788     MOVE SU044-ORIG-PKSL-SEQ-NBR  TO PV-DISP-ORIG-PKSL           35878845
358789     MOVE SU044-NEW-PKSL-SEQ-NBR   TO PV-DISP-NEW-PKSL            35878945
358790     MOVE SQLCODE                  TO PV-DISP-SQLCODE             35879045
358791                                                                  35879145
358792     STRING  ' SUKUT703 '  PV-CSSL-PARA                           35879245
358793             ' SSCC:'      PV-DISP-SSCC                           35879345
358794             ' PO:'        PV-DISP-PO                             35879445
358795             ' ORIG RCVR:' PV-DISP-ORIG-RCVR                      35879545
358796             ' NEW RCVR:'  PV-DISP-NEW-RCVR                       35879645
358797             ' TYPE:'      SU044-RCVR-TYPE-CDE                    35879745
358798             ' OPER:'      PV-DISP-OPER                           35879845
358799             ' CRTN OPER:' PV-DISP-CRTN-OPER                      35879945
358800             ' FCLTY:'     PV-DISP-FCLTY                          35880045
358801                           DELIMITED BY SIZE                      35880145
358802                      INTO PV-CICS-MSG-AREA-3                     35880245
358803                                                                  35880345
358804     PERFORM 9997-WRITE-TO-CSSL                                   35880445
358805                                                                  35880545
358806     INITIALIZE PV-CICS-MSG-AREA-3                                35880645
358807     STRING  ' SUKUT703 '                                         35880745
358808             ' SCAC:'      SU044-SCAC-ID                          35880845
358809             ' TRLR:'      SU044-VEH-NBR                          35880945
358810             ' DEST:'      PV-DISP-DEST-STR                       35881045
358811             ' ORIG SHIP:' PV-DISP-ORIG-SHIP                      35881145
358812             ' NEW SHIP:'  PV-DISP-NEW-SHIP                       35881245
358813             ' ORIG BOL:'  SU044-ORIG-BOL-NBR                     35881345
358814                           DELIMITED BY SIZE                      35881445
358815                      INTO PV-CICS-MSG-AREA-3                     35881545
358816                                                                  35881645
358817     PERFORM 9997-WRITE-TO-CSSL                                   35881745
358818                                                                  35881845
358819     INITIALIZE PV-CICS-MSG-AREA-3                                35881945
358820     STRING  ' SUKUT703 '                                         35882045
358821             ' ORIG PKSL:' PV-DISP-ORIG-PKSL                      35882145
358822             ' NEW PKSL:'  PV-DISP-NEW-PKSL                       35882245
358823             ' FUNC:'      SU044-FUNCTION-SWITCH                  35882345
358824             ' SRC:'       SU044-CALL-SOURCE-SWITCH               35882445
358825             ' PKSL:'      SU044-UPDATE-PKSLIP-SW                 35882545
358826             ' PGRM:'      SU044-PROGRAM-NAME                     35882645
358827             ' SUCC:'      SU044-SUCCESS-IND                      35882745
358828             ' PKSL CRE:'  SU044-PKSLIP-CRE-SRCE                  35882845
358829             ' RCVR CRE:'  SU044-RECEIVER-CREATE-SRC              35882945
358830                           DELIMITED BY SIZE                      35883045
358831                      INTO PV-CICS-MSG-AREA-3                     35883145
358832                                                                  35883245
358833     PERFORM 9997-WRITE-TO-CSSL.                                  35883345
358834                                                                  35883445
358835     INITIALIZE PV-CICS-MSG-AREA-3                                35883545
358836     STRING  ' SUKUT703 '                                         35883645
358837             ' ORIG PRO:'  SU044-ORIG-PRO-NBR                     35883772
358838             ' NEW PRO:'   SU044-NEW-PRO-NBR                      35883872
358839             ' USRID:'     SU044-SIGNON-USER-ID                   35883972
358840             ' SQL:'       PV-DISP-SQLCODE                        35884045
358841             ' TRIP:'      PV-DISP-TRIP                           35884169
358842                           DELIMITED BY SIZE                      35884269
358843                      INTO PV-CICS-MSG-AREA-3                     35884369
358844                                                                  35884469
358845     PERFORM 9997-WRITE-TO-CSSL.                                  35884569
358846                                                                  35884669
358847                                                                  35884769
358848*---------------------------------------------------------------* 35884869
358849* BUILD INTERNAL TABLE WITN PARAGRAPH TRACKING                  * 35884969
358850* DMH - 01/29/15                                                * 35885069
358851*---------------------------------------------------------------* 35885169
358852 8120-INTERNAL-TABLE.                                             35885269
358853                                                                  35885369
358854     PERFORM 8130-GET-CURRENT-TMST.                               35885469
358855     ADD  +1  TO  PT-CURR-ENTRIES.                                35885569
358856     SET  PT-TRACK-IDX to PT-CURR-ENTRIES                         35885669
358857                                                                  35885769
358858     MOVE 'SUKUT703'           TO PT-PROGRAM(PT-TRACK-IDX).       35885869
358859     MOVE PT-CURR-ENTRIES      TO PT-INDEX-NBR(PT-TRACK-IDX).     35885969
358860     MOVE PT-CURR-PARA         TO PT-PARAGRAPH(PT-TRACK-IDX).     35886069
358861     MOVE PV-CURRENT-PARA-TMST TO PT-TIMESTAMP(PT-TRACK-IDX).     35886169
358862     MOVE PV-DURATION-SEC      TO PT-DURATION(PT-TRACK-IDX).      35886269
358863                                                                  35886369
358864     MOVE PV-DURATION-NANO-SEC    TO PV-WORK-NANO-SEC.            35886469
358865     MOVE PV-WORK-NANO-MIN-1-2    TO PV-DISP-NANO-MIN-1-2.        35886569
358866     MOVE '-'                     TO PV-DISP-NANO-DASH-1.         35886669
358867     MOVE PV-WORK-NANO-SEC-3-4    TO PV-DISP-NANO-SEC-3-4.        35886769
358868     MOVE '-'                     TO PV-DISP-NANO-DASH-2.         35886869
358869     MOVE PV-WORK-NANO-MICRO-5-10 TO PV-DISP-NANO-MICRO-5-10.     35886969
358870     MOVE PV-DISP-NANO-SEC     TO PT-NANO-SEC(PT-TRACK-IDX).      35887069
358871                                                                  35887169
358872     MOVE SU044-OPER-UNT-ID      tO PT-DC(PT-TRACK-IDX).          35887269
358873     MOVE SU044-CRTN-OPER-UNT-ID tO PT-crtn-oper(PT-TRACK-IDX).   35887369
358874     MOVE PV-INIT-TIME-KEY      TO PT-START-HHMMSS(PT-TRACK-IDX). 35887469
358875                                                                  35887569
358876     IF  PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES                     35887669
358877         MOVE ZEROES TO PT-CURR-ENTRIES                           35887769
358878         SET  PT-TRACK-IDX  TO PT-CURR-ENTRIES                    35887869
358879     END-IF.                                                      35887969
358880                                                                  35888069
358881                                                                  35888169
358882*---------------------------------------------------------------* 35888269
358883*                                                               * 35888369
358884* DMH - 01/29/15                                                * 35888469
358885*---------------------------------------------------------------* 35888569
358886 8130-GET-CURRENT-TMST.                                           35888669
358887     EXEC SQL                                                     35888769
358888          SET :PV-CURRENT-PARA-TMST = CURRENT TIMESTAMP           35888869
358889     END-EXEC.                                                    35888969
358890                                                                  35889069
358891     EXEC SQL                                                     35889169
358892          SELECT                                                  35889269
358893                 TIMESTAMPDIFF( 2 ,CHAR(:PV-CURRENT-PARA-TMST     35889369
358894                   - TIMESTAMP(:PV-RECEIVE-RQST-TMST)))           35889469
358895               , TIMESTAMPDIFF( 1 ,CHAR(:PV-CURRENT-PARA-TMST     35889569
358896                   - TIMESTAMP(:PV-RECEIVE-RQST-TMST)))           35889669
358897            INTO :PV-DURATION-SEC                                 35889769
358898               , :PV-DURATION-nano-sec                            35889869
358899            FROM  SYSIBM.SYSDUMMY1                                35889969
358900     END-EXEC.                                                    35890069
358901                                                                  35890169
358902                                                                  35890269
358903*---------------------------------------------------------------* 35890369
358904*                                                               * 35890469
358905* DMH - 01/29/15                                                * 35890569
358906*---------------------------------------------------------------* 35890669
358907 8140-DUMP-TABLE-TO-CSSL.                                         35890769
358908                                                                  35890869
358909     INITIALIZE PV-CICS-MSG-AREA                                  35890969
358910                                                                  35891069
358911     MOVE PT-ENTRIES(PT-TRACK-IDX)  TO PV-CICS-MSG-AREA-3         35891169
358912                                                                  35891269
358913     PERFORM 9997-WRITE-TO-CSSL.                                  35891369
358914                                                                  35891469
358915                                                                  35891569
358916*---------------------------------------------------------------* 35891669
358917*                                                               * 35891769
358918* DMH - 01/29/15                                                * 35891869
358919*---------------------------------------------------------------* 35891969
358920 8150-CLEAR-TABLE.                                                35892069
358921                                                                  35892169
358922     MOVE  SPACES  TO  PT-PROGRAM(PT-TRACK-IDX).                  35892269
358923     MOVE  ZEROES  TO  PT-INDEX-NBR(PT-TRACK-IDX).                35892369
358924     MOVE  SPACES  TO  PT-PARAGRAPH(PT-TRACK-IDX).                35892469
358925     MOVE  SPACES  TO  PT-TIMESTAMP(PT-TRACK-IDX).                35892569
358926     MOVE  ZEROES  TO  PT-DURATION(PT-TRACK-IDX).                 35892669
358927                                                                  35892769
358928* RPK - 5/31/2018 - START                                         35892872
358929*---------------------------------------------------------------* 35892971
358930* THIS PARAGRAPH WILL READ THE TKRPRPM TABLE TO CHECK PARM      * 35893071
358931* FAOPER TO DETERMINE WHAT LOGIC IN THE 1300 PARAGRAPH SHOULD   * 35893171
358932* BE USED TO LOAD UP THE OPER_UNT_ID AND CRE_OPER_UNT_ID        * 35893271
358933* FIELDS ON TRECEIV FOR THE FREE ASTRAY RECEIVER.               * 35893371
358934* THIS PARAGRAPH WILL READ THE 090 ENTRY FOR THE PARM, IF THE   * 35893471
358935* TEXT VALUE IS Y, THEN 1300 WOULD USE THE NEW CODE, IF TEXT    * 35893571
358936* VALUE IS N, THEN 1300 WOULD USE THE OLD CODE AND IF TEXT      * 35893671
358937* VALUE IS D, THEN PARAGRAPH 8300 WOULD BE CHECKED USING THE    * 35893771
358938* DC NUMBER THAT IS PROCESSING THE MERCHANDISE TO SEE IF FOR    * 35893871
358939* THAT DC, THE OLD OR NEW CODE IN 1300 SHOULD BE USED.          * 35893971
358940*---------------------------------------------------------------* 35894071
358941 8200-CHECK-OPER-HANDLING.                                        35894171
358942                                                                  35894271
358943     MOVE SPACES TO PV-PARM-TEXT-CORP-FAOPER.                     35894371
358944     SET PS-FREE-ASTRAY-OPER-OLD TO TRUE.                         35894471
358945                                                                  35894571
358946     IF  PS-BLD-INTERNAL-TABLE-YES                                35894671
358947         MOVE  '8200'  TO  PT-CURR-PARA                           35894771
358948         PERFORM 8120-INTERNAL-TABLE                              35894871
358949     END-IF.                                                      35894971
358950                                                                  35895071
358951     EXEC SQL                                                     35895171
358952          SELECT FUNC_TXT                                         35895271
358953            INTO :PV-PARM-TEXT-CORP-FAOPER                        35895371
358954            FROM TKRPRPM                                          35895471
358955           WHERE LOC_ID            = 090                          35895571
358956             AND INTFC_SYS_CDE     = 'KHL'                        35895671
358957             AND SYS_PRC_FUNC_CDE  = 'FAOPER'                     35895771
358958             AND FUNC_PRC_STAT_CDE = 'AC'                         35895871
358959            WITH UR                                               35895971
358960     END-EXEC.                                                    35896071
358961                                                                  35896171
358962     EVALUATE TRUE                                                35896271
358963         WHEN SQLCODE = ZERO                                      35896371
358964             IF  PV-PARM-TEXT-CORP-FAOPER = 'Y'                   35896471
358965                 SET PS-FREE-ASTRAY-OPER-NEW TO TRUE              35896571
358966             ELSE                                                 35896671
358967                 IF  PV-PARM-TEXT-CORP-FAOPER = 'N'               35896771
358968                     SET PS-FREE-ASTRAY-OPER-OLD TO TRUE          35896871
358969                 ELSE                                             35896971
358970                     IF  PV-PARM-TEXT-CORP-FAOPER = 'D'           35897071
358971                         PERFORM 8300-CHECK-DC-OPER-HANDLING      35897171
358972                     ELSE                                         35897271
358973                         SET PS-FREE-ASTRAY-OPER-OLD TO TRUE      35897371
358974                     END-IF                                       35897471
358975                 END-IF                                           35897571
358976             END-IF                                               35897671
358977         WHEN SQLCODE = +100                                      35897771
358978             SET PS-FREE-ASTRAY-OPER-OLD TO TRUE                  35897871
358979         WHEN SQLWARN0 NOT = SPACES                               35897971
358980         WHEN SQLCODE NOT EQUAL ZERO                              35898071
358981                                                                  35898171
358982              MOVE '8200'  TO  PV-CSSL-PARA                       35898271
358983              PERFORM 8110-WRITE-SUWS044-TO-CSSL                  35898371
358984                                                                  35898471
358985             SET PS-ERROR                                         35898571
358986                 SU044-INVALID-SQL    TO TRUE                     35898671
358987             MOVE  SQLCODE            TO PV-DISP-SQLCODE          35898771
358988             MOVE  DK-OPER-UNT-ID     TO PV-DISP-OPER             35898871
358989             STRING   ' SUKUT703 - 8200- '                        35898971
358990                      ' CALLED BY:'      SU044-PROGRAM-NAME       35899071
358991                      ' SQL:'            PV-DISP-SQLCODE          35899171
358992                      ' OPER:'           PV-DISP-OPER             35899271
358993                                         DELIMITED BY SIZE        35899371
358994                                    INTO PV-CICS-MSG-AREA         35899471
358995             PERFORM 9999-WRITE-TO-CSSL                           35899571
358996             MOVE PV-CICS-MSG-AREA    TO SU044-CRA-RET-MSG        35899671
358997             MOVE SQLCA               TO SU044-SQLCA              35899771
358998             SET SU044-INVALID-SQL TO TRUE                        35899871
358999     END-EVALUATE.                                                35899971
359000                                                                  35900071
359001*---------------------------------------------------------------* 35900171
359002* THIS PARAGRAPH WILL READ THE TKRPRPM TABLE TO CHECK PARM      * 35900271
359003* FAOPER TO DETERMINE WHAT LOGIC IN THE 1300 PARAGRAPH SHOULD   * 35900371
359004* BE USED TO LOAD UP THE OPER_UNT_ID AND CRE_OPER_UNT_ID        * 35900471
359005* FIELDS ON TRECEIV FOR THE FREE ASTRAY RECEIVER.               * 35900571
359006* THIS PARAGRAPH WILL ATTEMPT TO READ THE PARM USING THE DC     * 35900671
359007* NUMBER PROCESSING THE MERCHANDISE.  IF NO ENTRY FOUND FOR     * 35900771
359008* THE DC, THEN THE OLD CODE WOULD BE USED IN 1300.  IF THERE    * 35900871
359009* IS AN ENTRY, THEN A Y IN THE TEXT WOULD CAUSE THE 1300        * 35900971
359010* PARAGRAPH TO USE THE NEW CODE AND AN N IN THE TEXT WOULD      * 35901071
359011* CAUSE THE 1300 PARAGRAPH TO USE THE OLD CODE.                 * 35901171
359012*---------------------------------------------------------------* 35901271
359013 8300-CHECK-DC-OPER-HANDLING.                                     35901371
359014                                                                  35901471
359015     MOVE SPACES TO PV-PARM-TEXT-DC-FAOPER.                       35901571
359016     SET PS-FREE-ASTRAY-OPER-OLD TO TRUE.                         35901671
359017     MOVE SU044-OPER-UNT-ID TO DK-FAOPER-UNT-ID.                  35901771
359018                                                                  35901871
359019     IF  PS-BLD-INTERNAL-TABLE-YES                                35901971
359020         MOVE  '8300'  TO  PT-CURR-PARA                           35902071
359021         PERFORM 8120-INTERNAL-TABLE                              35902171
359022     END-IF.                                                      35902271
359023                                                                  35902371
359024     EXEC SQL                                                     35902471
359025          SELECT FUNC_TXT                                         35902571
359026            INTO :PV-PARM-TEXT-DC-FAOPER                          35902671
359027            FROM TKRPRPM                                          35902771
359028           WHERE LOC_ID            = :DK-FAOPER-UNT-ID            35902871
359029             AND INTFC_SYS_CDE     = 'KHL'                        35902971
359030             AND SYS_PRC_FUNC_CDE  = 'FAOPER'                     35903071
359031             AND FUNC_PRC_STAT_CDE = 'AC'                         35903171
359032            WITH UR                                               35903271
359033     END-EXEC.                                                    35903371
359034                                                                  35903471
359035     EVALUATE TRUE                                                35903571
359036         WHEN SQLCODE = ZERO                                      35903671
359037             IF  PV-PARM-TEXT-DC-FAOPER = 'Y'                     35903771
359038                 SET PS-FREE-ASTRAY-OPER-NEW TO TRUE              35903871
359039             ELSE                                                 35903971
359040                 SET PS-FREE-ASTRAY-OPER-OLD TO TRUE              35904071
359041             END-IF                                               35904171
359042         WHEN SQLCODE = +100                                      35904271
359043             SET PS-FREE-ASTRAY-OPER-OLD TO TRUE                  35904371
359044         WHEN SQLWARN0 NOT = SPACES                               35904471
359045         WHEN SQLCODE NOT EQUAL ZERO                              35904571
359046                                                                  35904671
359047              MOVE '8300'  TO  PV-CSSL-PARA                       35904771
359048              PERFORM 8110-WRITE-SUWS044-TO-CSSL                  35904871
359049                                                                  35904971
359050             SET PS-ERROR                                         35905071
359051                 SU044-INVALID-SQL    TO TRUE                     35905171
359052             MOVE  SQLCODE            TO PV-DISP-SQLCODE          35905271
359053             MOVE  DK-OPER-UNT-ID     TO PV-DISP-OPER             35905371
359054             STRING   ' SUKUT703 - 8300- '                        35905471
359055                      ' CALLED BY:'      SU044-PROGRAM-NAME       35905571
359056                      ' SQL:'            PV-DISP-SQLCODE          35905671
359057                      ' OPER:'           PV-DISP-OPER             35905771
359058                                         DELIMITED BY SIZE        35905871
359059                                    INTO PV-CICS-MSG-AREA         35905971
359060             PERFORM 9999-WRITE-TO-CSSL                           35906071
359061             MOVE PV-CICS-MSG-AREA    TO SU044-CRA-RET-MSG        35906171
359062             MOVE SQLCA               TO SU044-SQLCA              35906271
359063             SET SU044-INVALID-SQL TO TRUE                        35906371
359064     END-EVALUATE.                                                35906471
359067                                                                  35906772
359068* RPK - 5/31/2018 - END                                           35906872
359069*-----------------------------------------------------------------35906971
359070 9997-WRITE-TO-CSSL.                                              35907071
359071*-----------------------------------------------------------------35907171
359072     MOVE LENGTH OF PV-CICS-MSG-AREA-3  TO PV-COMMAREA-LENGTH.    35907271
359073                                                                  35907371
359074     EXEC CICS                                                    35907471
359075          WRITEQ TD                                               35907571
359076           QUEUE   ('CSSL')                                       35907671
359077            FROM   (PV-CICS-MSG-AREA-3)                           35907771
359078          LENGTH   (PV-COMMAREA-LENGTH)                           35907871
359079            RESP   (PV-CICS-RESPONSE)                             35907971
359080     END-EXEC.                                                    35908071
359081                                                                  35908171
359082                                                                  35908271
359083 9999-WRITE-TO-CSSL.                                              35908371
359084                                                                  35908471
359085     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      35908571
359090                                                                  35909071
359100     EXEC CICS                                                    35910016
359200          WRITEQ TD                                               35920016
359300           QUEUE   ('CSSL')                                       35930016
359400            FROM   (PV-CICS-MSG-AREA)                             35940016
359500          LENGTH   (PV-COMMAREA-LENGTH)                           35950016
359600            RESP   (PV-CICS-RESPONSE)                             35960016
359700     END-EXEC.                                                    35970016
359800                                                                  35980016
