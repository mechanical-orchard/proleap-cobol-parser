000010***************************************************************** 00001000
000020 IDENTIFICATION DIVISION.                                         00002000
000030***************************************************************** 00003000
000040                                                                  00004000
000050 PROGRAM-ID.             TCKUT019.                                00005000
000060 AUTHOR.                 BARB SCHULTZ.                            00006000
000070 INSTALLATION.           KOHLS.                                   00007000
000080 DATE-WRITTEN            03/2019.                                 00008000
000090 DATE-COMPILED.                                                   00009000
000091                                                                  00009100
000092***************************************************************** 00009200
000093*  PURPOSE:                                                       00009300
000094*  CREATE A FLAT FILE FROM THE SQL THAT WAS COPIED FROM           00009400
000095*  PKMO.PROCLIB(TCSI001).                                         00009500
000096***************************************************************** 00009600
SHIP2 * DATE:        01/21/2020                                        *00009900
SHIP2 * WR/IR#:      CHG0233046                                        *00010000
SHIP2 * PROGRAMMER:  BARB SCHULTZ                                      *00010200
SHIP2 * DESCRIPTION: DELETED OUT THE MC FIELDS BECAUSE THEY WILL NOW   *00010300
SHIP2 *              USE THE VISA FIELDS. BOTH VISA AND MC ARE GOING   *00010400
SHIP2 *              TO BE USING THE SAME MULT CLEARING FIELDS FROM THE*00010500
SHIP2 *              DATABASE.                                         *00010600
052523***************************************************************** 00010700
052523*  CHANGE MADE: ADD CHANGES FOR NEW COBRAND TENDER TYPE           00010800
052523*               ADD CHANGES FOR COBRAND PAYMENTS                  00010900
052523*  DATE: 05/25/2023                                               00011000
052523*  MADE BY: DAN PAYNTER              WR/IR #: CHG0289014          00011100
052523***************************************************************** 00011200
062223*  CHANGE MADE: BLOCK TRAILING TRANSACTIONS FROM FLOWING          00011300
062223*               TO CAP ONE SETTLEMENT                             00011400
062223*  DATE: 06/22/2023                                               00011700
062223*  MADE BY: DAN PAYNTER              WR/IR #: CHG0290003          00011800
062223***************************************************************** 00011900
062623*  CHANGE MADE: UNBLOCK TRAILING TRANSACTIONS FROM FLOWING        00012000
062623*               TO CAP ONE SETTLEMENT                             00012100
062623*  DATE: 06/26/2023                                               00012200
062623*  MADE BY: DAN PAYNTER              WR/IR #: CHG0290079          00012300
062623***************************************************************** 00012400
000109 ENVIRONMENT DIVISION.                                            00012500
000110***************************************************************** 00012600
000111                                                                  00012700
000112 CONFIGURATION SECTION.                                           00012800
000113                                                                  00012900
000114 SOURCE-COMPUTER.        IBM-3090.                                00013000
000115                                                                  00013100
000116 OBJECT-COMPUTER.        IBM-3090.                                00013200
000117                                                                  00013300
000118 INPUT-OUTPUT SECTION.                                            00013400
000119                                                                  00013500
000120 FILE-CONTROL.                                                    00013600
000121                                                                  00013700
000122     SELECT DATE-CARD-FILE                                        00013800
000123         ASSIGN TO INP01.                                         00013900
000124                                                                  00014000
000125     SELECT COSA-EXTRACT-FILE                                     00014100
000126         ASSIGN TO OUT01.                                         00014200
000127                                                                  00014300
000128                                                                  00014400
000129******************************************************************00014500
000130 DATA DIVISION.                                                   00014600
000131******************************************************************00014700
000132                                                                  00014800
000133 FILE SECTION.                                                    00014900
000134                                                                  00015000
000135 FD  DATE-CARD-FILE                                               00015100
000136     RECORDING MODE IS F                                          00015200
000137     BLOCK CONTAINS 0 RECORDS                                     00015300
000138     LABEL RECORDS ARE STANDARD.                                  00015400
000139                                                                  00015500
000140 01  DATE-CARD-RECORD              PIC X(80).                     00015600
000141                                                                  00015700
000142 FD  COSA-EXTRACT-FILE                                            00015800
000143     RECORDING MODE IS F                                          00015900
000144     LABEL RECORDS ARE STANDARD                                   00016000
000145     BLOCK CONTAINS 0 RECORDS.                                    00016100
000146                                                                  00016200
000147 01  COSA-EXTRACT-RECORD           PIC X(191).                    00016300
000148                                                                  00016400
000149                                                                  00016500
000150******************************************************************00016600
000151 WORKING-STORAGE SECTION.                                         00016700
000152******************************************************************00016800
000153 01  FILLER                            PIC X(50)  VALUE           00016900
000154     ' *** WORKING STORAGE STARTS HERE FOR TCKUT019 *** '.        00017000
000155                                                                  00017100
000156******************************************************************00017200
000157* RECORD LAYOUT FOR INPUT DATE CARD (POS DATE)                   *00017300
000158******************************************************************00017400
000159 01  CC-CONTROL-CARD.                                             00017500
000160     05  CC-CONTROL-CARD-DISPLAY.                                 00017600
000161         10  CC-CONTROL-NAME     PIC X(14)    VALUE SPACE.        00017700
000162             88  CC-VALID-CONTROL-NAME        VALUE               00017800
000163                 'P.O.S. DATE = '.                                00017900
000164         10  CC-POS-DATE-MMDDYY  PIC 9(6)     VALUE ZERO.         00018000
000165     05  FILLER                  PIC X(60)    VALUE SPACE.        00018100
000166                                                                  00018200
000167******************************************************************00018300
000168*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)            *00018400
000169******************************************************************00018500
000170     COPY DPWS500.                                                00018600
000171                                                                  00018700
000172 01  AC-ABEND-CODE                      PIC S9(04) VALUE ZERO     00018800
000173                                                  COMP SYNC.      00018900
000174     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    00019000
000175     88  AC-DB2-ERROR                             VALUE +4013.    00019100
000176     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    00019200
000177                                                                  00019300
000178  01  PS-PROGRAM-SWITCHES.                                        00019400
000179     05  PS-END-OF-EXTRACT-SW          PIC X(01)  VALUE 'N'.      00019500
000180         88  PS-NOT-END-OF-EXTRACT                VALUE 'N'.      00019600
000181         88  PS-END-OF-EXTRACT                    VALUE 'Y'.      00019700
052523     05  PS-END-OF-PAYMENT-SW          PIC X(01)  VALUE 'N'.      00019800
052523         88  PS-NOT-END-OF-PAYMENT                VALUE 'N'.      00019900
052523         88  PS-END-OF-PAYMENT                    VALUE 'Y'.      00020000
000185     05  PS-END-OF-DATE-FILE-SW        PIC X(01)  VALUE 'N'.      00020100
000186         88  PS-END-OF-DATE-FILE                  VALUE 'Y'.      00020200
000187                                                                  00020300
000188 01  PC-CONSTANTS.                                                00020400
000189     05  PC-ROW-NOT-FOUND              PIC S9(04) VALUE +100      00020500
000190                                                  COMP SYNC.      00020600
000191     05  PC-CURRENT-PROGRAM-NAME       PIC  X(08) VALUE           00020700
000192                                                 'TCKUT019'.      00020800
000193 01  PV-PROGRAM-VARIABLES.                                        00020900
000194     05  PV-PARAGRAPH-NAME             PIC  X(30) VALUE SPACE.    00021000
000195     05  PV-OPERATION-MSG-1            PIC  X(40) VALUE SPACE.    00021100
000196     05  PV-OPERATION-MSG-2            PIC  X(40) VALUE SPACE.    00021200
000197     05  PV-DB2-OPERATION              PIC  X(30) VALUE SPACE.    00021300
000198     05  PV-POS-CCYY-MM-DD             PIC  X(10).                00021400
000199     05  PV-TNDR-AMT                   PIC S9(7)V99 VALUE ZERO.   00021500
000200     05  PV-TAX-AMT                    PIC S9(7)V99 VALUE ZERO.   00021600
000201                                                                  00021700
000202     05  PV-CRD-LVL-RSLT-CDE.                                     00021800
000203         10  PV-CRD-LVL-RSLT-CDE-1     PIC X(01)  VALUE SPACES.   00021900
000204         10  PV-CRD-LVL-RSLT-CDE-2     PIC X(01)  VALUE SPACES.   00022000
000205                                                                  00022100
SHIP       05  PV-VISA-MULT-CLR-SEQ-NBR      PIC 9(04)  VALUE ZEROES.   00022200
SHIP       05  PV-VISA-TOT-SHP-NBR           PIC 9(04)  VALUE ZEROES.   00022300
000205                                                                  00022400
000206***************************************************************** 00022500
000207*  COSA EXTRACT FLAT FILE LAYOUT                                  00022600
000208******************************************************************00022700
000209     COPY TCRD004.                                                00022800
000210                                                                  00022900
000211***************************************************************** 00023000
000212*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            00023100
000213******************************************************************00023200
000214     COPY DPWS004.                                                00023300
000215                                                                  00023400
000216******************************************************************00023500
000217*  DB2 COMMUNICATION AREA.                                        00023600
000218******************************************************************00023700
000219     EXEC SQL                                                     00023800
000220          INCLUDE SQLCA                                           00023900
000221     END-EXEC.                                                    00024000
000222                                                                  00024100
000223******************************************************************00024200
000224*  DB2 TABLE DB2PDBA.TEPPART - PARTITION CONTROL TABLE            00024300
000225******************************************************************00024400
000226     EXEC SQL                                                     00024500
000227          INCLUDE TEPPART                                         00024600
000228     END-EXEC.                                                    00024700
000229                                                                  00024800
000230******************************************************************00024900
000231*  DB2 TABLE DB2PDBA.TEPDKEY         PROCESING DAY KEY TABLE      00025000
000232******************************************************************00025100
000233*    EXEC SQL                                                     00025200
000234*         INCLUDE TEPDKEY                                         00025300
000235*    END-EXEC.                                                    00025400
000236*                                                                 00025500
000237******************************************************************00025600
000238*  DB2 TABLE DB2PDBA.TEPCRD  - CREDIT CARD TABLE                  00025700
000239******************************************************************00025800
000240     EXEC SQL                                                     00025900
000241          INCLUDE TEPCRD                                          00026000
000242     END-EXEC.                                                    00026100
000243                                                                  00026200
052523******************************************************************00026300
052523*  DB2 TABLE DB2PDBA.TEPPAY  - CC PAYMENT TABLE                   00026400
052523******************************************************************00026500
052523     EXEC SQL                                                     00026600
052523          INCLUDE TEPPAY                                          00026700
052523     END-EXEC.                                                    00026800
052523                                                                  00026900
000244******************************************************************00027000
000245*  DB2 TABLE DB2PDBA.EPT_CR_CRD_VRFN TABLE                        00027100
000246******************************************************************00027200
000247     EXEC SQL                                                     00027300
000248          INCLUDE EPT00056                                        00027400
000249     END-EXEC.                                                    00027500
000250                                                                  00027600
000251******************************************************************00027700
000252*  DB2 TABLE DB2PDBA.TEPTND - TENDER TABLE                        00027800
000253******************************************************************00027900
000254     EXEC SQL                                                     00028000
000255          INCLUDE TEPTND                                          00028100
000256     END-EXEC.                                                    00028200
000257                                                                  00028300
000258******************************************************************00028400
000259*  DB2 TABLE DB2PDBA.TEPTRN - TRANSACTION TABLE                   00028500
000260******************************************************************00028600
000261     EXEC SQL                                                     00028700
000262          INCLUDE TEPTRN                                          00028800
000263     END-EXEC.                                                    00028900
000264                                                                  00029000
000265******************************************************************00029100
000266*  DB2 TABLE DB2PDBA.TEPVDA - VOID TABLE                          00029200
000267******************************************************************00029300
000268*    EXEC SQL                                                     00029400
000269*         INCLUDE TEPVDA                                          00029500
000270*    END-EXEC.                                                    00029600
000271*                                                                 00029700
000272******************************************************************00029800
000273*  CREATE CURSOR FOR EXTRACT                                      00029900
000274******************************************************************00030000
000275     EXEC SQL                                                     00030100
000276         DECLARE EXTRACT-CURSOR  CURSOR                           00031000
000333                                                                  00033300
000334         FOR SELECT A.PARTN_NBR                                   00033400
000336             ,A.STR_NBR                                           00033600
000337             ,A.RGST_ID                                           00033700
000338             ,A.TRN_NBR                                           00033800
000339             ,A.STRT_TM                                           00033900
000341             ,A.SLS_CORR_SEQ_NBR                                  00034100
000342             ,A.TRN_TYP_CDE                                       00034200
000343             ,A.SLS_DTE                                           00034300
000344             ,A.TRN_DTE                                           00034400
000346             ,B.TNDR_SEQ_NBR                                      00034600
000347             ,B.TNDR_TYP_CDE                                      00034700
000348             ,B.TNDR_ID                                           00034800
000349             ,B.TNDR_AMT                                          00034900
000350             ,B.TNDR_ID_SRC_CDE                                   00035000
000351             ,C.AUTH_NBR                                          00035100
000352             ,C.AUTH_SRC_CDE                                      00035200
000353             ,C.CPS_TRN_ID                                        00035300
000354             ,C.MC_CMPLIN_CDE                                     00035400
000355             ,C.VIP_SRC_CDE                                       00035500
000356             ,C.VIP_RSPN_CDE                                      00035600
000357             ,C.BNKNET_NBR                                        00035700
000358             ,A.VISA_MULT_CLR_SEQ_NBR                             00035800
000360             ,COALESCE(E.AVS_RSPN_CDE,' ')                        00036000
000361             ,A.SLS_TX_AMT                                        00036100
000362             ,A.VISA_TOT_SHP_NBR                                  00036300
000364             ,COALESCE(C.CRD_LVL_RSLT_CDE,'  ')                   00036400
000367             ,COALESCE(E.CVV_RSPN_CDE,' ')                        00036700
000368             ,C.NETWK_REF_ID                                      00036800
000369             ,COALESCE(C.TRSM_TMST,'2008-01-01-01.00.00.000000')  00036900
000370             ,C.SYS_TRC_AUD_NBR                                   00037000
000371             ,COALESCE(C.TRK_DAT_CND_CDE,'  ')                    00037100
000372             ,COALESCE(A.OMNI_CHNL_FFLMT_TYP_CDE,'   ')           00037200
052523             ,C.TRLING_TRN_IND                                    00037300
000373          FROM TEPPART D                                          00037400
000374              ,TEPTRN A                                           00037500
000375              ,TEPTND B                                           00037600
000376              ,TEPCRD C                                           00037700
000377          LEFT OUTER JOIN                                         00037800
000378               EPT_CR_CRD_VRFN E                                  00037900
000379          ON  C.PARTN_NBR  = E.PARTN_NBR                          00038000
000380             AND C.STR_NBR = E.STR_NBR                            00038100
000381             AND C.RGST_ID = E.RGST_ID                            00038200
000382             AND C.TRN_NBR = E.TRN_NBR                            00038300
000383             AND C.STRT_TM = E.STRT_TM                            00038400
000384             AND C.SLS_CORR_SEQ_NBR = E.SLS_CORR_SEQ_NBR          00038500
000385             AND C.TNDR_SEQ_NBR = E.TNDR_SEQ_NBR                  00038600
000386          WHERE D.SLS_DTE = :PV-POS-CCYY-MM-DD                    00038700
000387          AND D.PARTN_NBR = A.PARTN_NBR                           00038800
000388          AND D.PARTN_NBR = B.PARTN_NBR                           00038900
000389          AND D.PARTN_NBR = C.PARTN_NBR                           00039000
000390          AND A.STR_NBR = B.STR_NBR                               00039100
000391          AND A.STR_NBR = C.STR_NBR                               00039200
000392          AND A.RGST_ID = B.RGST_ID                               00039300
000393          AND A.RGST_ID = C.RGST_ID                               00039400
000394          AND A.TRN_NBR = B.TRN_NBR                               00039500
000395          AND A.TRN_NBR = C.TRN_NBR                               00039600
000396          AND A.STRT_TM = B.STRT_TM                               00039700
000397          AND A.STRT_TM = C.STRT_TM                               00039800
000398          AND A.SLS_CORR_SEQ_NBR = B.SLS_CORR_SEQ_NBR             00039900
000399          AND A.SLS_CORR_SEQ_NBR = C.SLS_CORR_SEQ_NBR             00040000
000400          AND B.TNDR_SEQ_NBR = C.TNDR_SEQ_NBR                     00040100
000401          AND A.VOID_ABRT_CDE = 'N'                               00040200
000402          AND A.TRN_STAT_CDE = 'Z'                                00040300
000403          AND B.TNDR_VOID_IND = 'N'                               00040400
062623          AND (B.TNDR_TYP_CDE IN ('05', '06', '07', '08', '24')   00040600
062623               OR (B.TNDR_TYP_CDE = '04'                          00040700
062623                   AND C.TRLING_TRN_IND = 'Y'))                   00040800
000405          AND D.DB_STRUC_CDE = 'O'                                00040900
000406          AND D.STR_GP_CDE       = 'A'                            00041000
000407          AND C.STTLMNT_PRCD_CDE = 'U'                            00041100
000408          AND ((A.POS_TYP_CDE <> '001')                           00041200
000409           OR  (A.POS_TYP_CDE IS NULL))                           00041300
000410      WITH UR                                                     00049800
000420     END-EXEC.                                                    00050000
000576                                                                  00057600
052523******************************************************************00057700
052523*  CREATE CURSOR FOR COBRAND PAYMENTS EXTRACT                     00057800
052523******************************************************************00057900
052523     EXEC SQL                                                     00058000
052523         DECLARE PAYMENT-CURSOR  CURSOR                           00059000
052523                                                                  00060000
052523         FOR SELECT A.PARTN_NBR                                   00061000
052523             ,A.STR_NBR                                           00062000
052523             ,A.RGST_ID                                           00063000
052523             ,A.TRN_NBR                                           00064000
052523             ,A.STRT_TM                                           00065000
052523             ,A.SLS_CORR_SEQ_NBR                                  00066000
052523             ,A.TRN_TYP_CDE                                       00066100
052523             ,A.SLS_DTE                                           00066200
052523             ,A.TRN_DTE                                           00066300
052523             ,B.TNDR_SEQ_NBR                                      00067100
052523             ,B.TNDR_TYP_CDE                                      00067200
052523             ,B.TNDR_ID                                           00067300
052523             ,B.TNDR_AMT                                          00067400
052523             ,B.TNDR_ID_SRC_CDE                                   00067500
052523             ,0.00                                                00068300
052523             ,' '                                                 00068400
052523             ,' '                                                 00068500
052523             ,' '                                                 00068600
052523             ,' '                                                 00068700
052523             ,1                                                   00068800
052523             ,' '                                                 00068900
052523             ,A.SLS_TX_AMT                                        00069000
052523             ,A.VISA_TOT_SHP_NBR                                  00069100
052523             ,'  '                                                00069200
052523             ,' '                                                 00069300
052523             ,' '                                                 00069400
052523             ,'2008-01-01-01.00.00.000000'                        00069500
052523             ,0.00                                                00069600
052523             ,'  '                                                00069700
052523             ,'   '                                               00069800
052523             ,P.TRLING_TRN_IND                                    00069900
052523             ,P.COBRND_IND                                        00070000
052523             ,P.PAYT_AMT                                          00070100
052523             ,P.KC_ACCT_NBR                                       00070200
052523             ,P.KC_ACCT_SRC_CDE                                   00070300
052523             ,P.AUTH_NBR                                          00070400
052523             ,P.AUTH_SRC_CDE                                      00070500
052523          FROM TEPPART D                                          00070600
052523              ,TEPTRN A                                           00070700
052523              ,TEPTND B                                           00070800
052523              ,TEPPAY P                                           00071000
052523          WHERE D.SLS_DTE = :PV-POS-CCYY-MM-DD                    00071100
052523          AND D.DB_STRUC_CDE = 'O'                                00071200
052523          AND D.STR_GP_CDE       = 'A'                            00071300
052523          AND D.PARTN_NBR = A.PARTN_NBR                           00071400
052523          AND D.PARTN_NBR = B.PARTN_NBR                           00071500
052523          AND D.PARTN_NBR = P.PARTN_NBR                           00071600
052523          AND A.STR_NBR = B.STR_NBR                               00071700
052523          AND A.STR_NBR = P.STR_NBR                               00071800
052523          AND A.RGST_ID = B.RGST_ID                               00071900
052523          AND A.RGST_ID = P.RGST_ID                               00072000
052523          AND A.TRN_NBR = B.TRN_NBR                               00072100
052523          AND A.TRN_NBR = P.TRN_NBR                               00072200
052523          AND A.STRT_TM = B.STRT_TM                               00072300
052523          AND A.STRT_TM = P.STRT_TM                               00072400
052523          AND A.SLS_CORR_SEQ_NBR = B.SLS_CORR_SEQ_NBR             00072500
052523          AND A.SLS_CORR_SEQ_NBR = P.SLS_CORR_SEQ_NBR             00072600
052523          AND A.TRN_TYP_CDE     = '30'                            00072700
052523          AND A.VOID_ABRT_CDE = 'N'                               00072800
052523          AND A.TRN_STAT_CDE = 'Z'                                00072900
052523          AND ((A.POS_TYP_CDE <> '001')                           00073000
052523           OR  (A.POS_TYP_CDE IS NULL))                           00073100
052523          AND B.TNDR_VOID_IND = 'N'                               00073200
052523          AND P.STTLMNT_PRCD_CDE = 'U'                            00073300
062623          AND (P.COBRND_IND     = 'Y'                             00073800
062623               OR P.TRLING_TRN_IND = 'Y')                         00073900
052523      WITH UR                                                     00079200
052523     END-EXEC.                                                    00079300
000661                                                                  00079500
000662 PROCEDURE DIVISION.                                              00079600
000663                                                                  00079700
000664 0000-MAINLINE-PARAGRAPH.                                         00079800
000665                                                                  00079900
000666     PERFORM 1000-INITIALIZE-PROGRAM.                             00080000
000667                                                                  00080100
052523     PERFORM 3001-OPEN-PAYMENT-CURSOR.                            00080300
052523     PERFORM 3101-FETCH-PAYMENT-CURSOR.                           00080400
052523                                                                  00080500
052523     PERFORM 2001-PROCESS-PAYMENT                                 00080600
052523           UNTIL PS-END-OF-PAYMENT.                               00080700
052523                                                                  00080800
052523     PERFORM 3301-CLOSE-PAYMENT-CURSOR.                           00080900
052523                                                                  00081000
000670     PERFORM 3000-OPEN-EXTRACT-CURSOR.                            00081200
000671     PERFORM 3100-FETCH-EXTRACT-CURSOR.                           00081300
000672                                                                  00081400
000673     PERFORM 2000-PROCESS                                         00081500
000674           UNTIL PS-END-OF-EXTRACT.                               00081600
000675                                                                  00081700
000676     PERFORM 3300-CLOSE-EXTRACT-CURSOR.                           00081800
000677                                                                  00081900
000688     CLOSE DATE-CARD-FILE                                         00082000
000689           COSA-EXTRACT-FILE.                                     00082100
000690                                                                  00082200
000691     GOBACK.                                                      00082300
000692                                                                  00082400
000693******************************************************************00082500
000694* 1000-INITIALIZE-PROGRAM                                         00082600
000695*     OPEN FILES, PROCESS CONTROL CARD                            00082700
000696******************************************************************00082800
000697 1000-INITIALIZE-PROGRAM.                                         00082900
000698                                                                  00083000
000699     OPEN INPUT  DATE-CARD-FILE                                   00083100
000700          OUTPUT COSA-EXTRACT-FILE.                               00083200
000701                                                                  00083300
000702     PERFORM 1300-PROCESS-DATE-CARD.                              00083400
000703                                                                  00083500
000704     SET PS-NOT-END-OF-EXTRACT              TO TRUE.              00083600
052523     SET PS-NOT-END-OF-PAYMENT              TO TRUE.              00083700
000705                                                                  00083800
000706******************************************************************00083900
000707* 1300-PROCESS-DATE-CARD                                          00084000
000708******************************************************************00084100
000709 1300-PROCESS-DATE-CARD.                                          00084200
000710                                                                  00084300
000711     READ DATE-CARD-FILE INTO CC-CONTROL-CARD                     00084400
000712         AT END                                                   00084500
000713             SET PS-END-OF-DATE-FILE TO TRUE.                     00084600
000714                                                                  00084700
000715     IF PS-END-OF-DATE-FILE                                       00084800
000716         MOVE '1300-PROCESS-DATE-CARD'  TO PV-PARAGRAPH-NAME      00084900
000717         MOVE 'DATE CARD MISSING      ' TO PV-OPERATION-MSG-1     00085000
000718         SET AC-CONTROL-CARD-ERROR TO TRUE                        00085100
000719         PERFORM 9999-ABEND                                       00085200
000720     END-IF.                                                      00085300
000721                                                                  00085400
000722     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              00085500
000723                                                                  00085600
000724     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   00085700
000725     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                   00085800
000726     SET  DPG52-LK-DTE-GREG            TO TRUE.                   00085900
000727     MOVE CC-POS-DATE-MMDDYY           TO DPG52-LK-DATE-INPUT.    00086000
000728     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    00086100
000729                                             DPG54 DPG55 DPG56.   00086200
000730     EVALUATE TRUE                                                00086300
000731         WHEN DPG54-SEVERE-ERROR                                  00086400
000732         WHEN DPG54-DATE-INVALID                                  00086500
000733             MOVE '1300-PROCESS-DATE-CARD'                        00086600
000734                                           TO PV-PARAGRAPH-NAME   00086700
000735             MOVE 'ERROR CONVERTING INPUT CARD DATE'              00086800
000736                                           TO PV-OPERATION-MSG-1  00086900
000737             SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                00087000
000738             MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  00087100
000739             PERFORM 9999-ABEND                                   00087200
000740     END-EVALUATE.                                                00087300
000741                                                                  00087400
000742     MOVE DPG55-DB2-ISO-DATE-FMT       TO PV-POS-CCYY-MM-DD.      00087500
000743                                                                  00087600
000744***************************************************************** 00087700
000745* 2000-PROCESS                                                    00087800
000746*      PROCESS THE CURSOR TO BUILD THE EXTRACT RECORD             00087900
000747***************************************************************** 00088000
000748  2000-PROCESS.                                                   00088100
000749                                                                  00088200
000753     MOVE EPTND-TNDR-AMT   TO PV-TNDR-AMT.                        00088300
000754     MOVE EPTRN-SLS-TX-AMT TO PV-TAX-AMT.                         00088400
000755     PERFORM 4000-WRITE-EXTRACT-FILE.                             00088500
000757                                                                  00088600
000758     PERFORM 3100-FETCH-EXTRACT-CURSOR.                           00088700
000759                                                                  00088800
052523***************************************************************** 00088900
052523* 2001-PROCESS-PAYMENT                                            00089000
052523*      PROCESS THE CURSOR TO BUILD THE PAYMENT EXTRACT RECORD     00089100
052523***************************************************************** 00089200
052523  2001-PROCESS-PAYMENT.                                           00089300
052523                                                                  00089400
052523     MOVE EPTND-TNDR-AMT   TO PV-TNDR-AMT.                        00089500
052523     MOVE EPTRN-SLS-TX-AMT TO PV-TAX-AMT.                         00089600
052523     PERFORM 4000-WRITE-EXTRACT-FILE.                             00089700
052523                                                                  00090800
052523     PERFORM 3101-FETCH-PAYMENT-CURSOR.                           00090900
052523                                                                  00091000
000760******************************************************************00091100
000761* 3000-OPEN-EXTRACT-CURSOR.                                       00091200
000762*     OPEN EXTRACT CURSOR                                         00091300
000763******************************************************************00091400
000764 3000-OPEN-EXTRACT-CURSOR.                                        00091500
000765                                                                  00091600
000766     EXEC SQL                                                     00091700
000767          OPEN EXTRACT-CURSOR                                     00091800
000768     END-EXEC.                                                    00091900
000769                                                                  00092000
000770     EVALUATE TRUE                                                00092100
000771         WHEN SQLCODE = ZERO                                      00092200
000772              CONTINUE                                            00092300
000773         WHEN SQLWARN0 NOT EQUAL SPACE                            00092400
000774         WHEN SQLCODE NOT EQUAL ZERO                              00092500
000775             MOVE '3000-OPEN-EXTRACT-CURSOR'                      00092600
000776                                            TO PV-PARAGRAPH-NAME  00092700
000777             MOVE 'ERROR ON OPEN OF EXTRACT-CURSOR'               00092800
000778                                            TO PV-DB2-OPERATION   00092900
000779             PERFORM 9100-SQL-ABEND                               00093000
000780     END-EVALUATE.                                                00093100
000781                                                                  00093200
052523******************************************************************00093300
052523* 3001-OPEN-PAYMENT-CURSOR.                                       00093400
052523*     OPEN PAYMENT CURSOR                                         00093500
052523******************************************************************00093600
052523 3001-OPEN-PAYMENT-CURSOR.                                        00093700
052523                                                                  00093800
052523     EXEC SQL                                                     00093900
052523          OPEN PAYMENT-CURSOR                                     00094000
052523     END-EXEC.                                                    00094100
052523                                                                  00094200
052523     EVALUATE TRUE                                                00094300
052523         WHEN SQLCODE = ZERO                                      00094400
052523              CONTINUE                                            00094500
052523         WHEN SQLWARN0 NOT EQUAL SPACE                            00094600
052523         WHEN SQLCODE NOT EQUAL ZERO                              00094700
052523             MOVE '3001-OPEN-PAYMENT-CURSOR'                      00094800
052523                                            TO PV-PARAGRAPH-NAME  00094900
052523             MOVE 'ERROR ON OPEN OF PAYMENT-CURSOR'               00095000
052523                                            TO PV-DB2-OPERATION   00095100
052523             PERFORM 9100-SQL-ABEND                               00095200
052523     END-EVALUATE.                                                00095300
052523                                                                  00095400
000782******************************************************************00095500
000783* 3100-FETCH-EXTRACT-CURSOR                                       00095600
000784******************************************************************00095700
000785 3100-FETCH-EXTRACT-CURSOR.                                       00095800
000786                                                                  00095900
000787     EXEC SQL                                                     00096000
000788          FETCH EXTRACT-CURSOR                                    00096100
000789           INTO :EPTND-PARTN-NBR                                  00096200
000790               ,:EPTND-STR-NBR                                    00096300
000791               ,:EPTND-RGST-ID                                    00096400
000792               ,:EPTND-TRN-NBR                                    00096500
000793               ,:EPTND-STRT-TM                                    00096600
000794               ,:EPTND-SLS-CORR-SEQ-NBR                           00096700
000795               ,:EPTRN-TRN-TYP-CDE                                00096800
000796               ,:EPPART-SLS-DTE                                   00096900
000797               ,:EPTRN-TRN-DTE                                    00097000
000798               ,:EPTND-TNDR-SEQ-NBR                               00097100
000799               ,:EPTND-TNDR-TYP-CDE                               00097200
000800               ,:EPTND-TNDR-ID                                    00097300
000801               ,:EPTND-TNDR-AMT                                   00097400
000802               ,:EPTND-TNDR-ID-SRC-CDE                            00097500
000803               ,:EPCRD-AUTH-NBR                                   00097600
000804               ,:EPCRD-AUTH-SRC-CDE                               00097700
000805               ,:EPCRD-CPS-TRN-ID                                 00097800
000806               ,:EPCRD-MC-CMPLIN-CDE                              00097900
000807               ,:EPCRD-VIP-SRC-CDE                                00098000
000808               ,:EPCRD-VIP-RSPN-CDE                               00098100
000809               ,:EPCRD-BNKNET-NBR                                 00098200
000810               ,:EPTRN-VISA-MULT-CLR-SEQ-NBR                      00098300
000811               ,:EPT00056-AVS-RSPN-CDE                            00098400
000812               ,:EPTRN-SLS-TX-AMT                                 00098500
000813               ,:EPTRN-VISA-TOT-SHP-NBR                           00098600
000814               ,:EPCRD-CRD-LVL-RSLT-CDE                           00098700
000816               ,:EPT00056-CVV-RSPN-CDE                            00098800
000817               ,:EPCRD-NETWK-REF-ID                               00098900
000818               ,:EPCRD-TRSM-TMST                                  00099000
000819               ,:EPCRD-SYS-TRC-AUD-NBR                            00099100
000820               ,:EPCRD-TRK-DAT-CND-CDE                            00099200
000821               ,:EPTRN-OMNI-CHNL-FFLMT-TYP-CDE                    00099300
052523               ,:EPCRD-TRLING-TRN-IND                             00099400
000822     END-EXEC.                                                    00099500
000856                                                                  00099600
000857     EVALUATE TRUE                                                00099700
000858         WHEN SQLCODE = ZERO                                      00099800
000859              CONTINUE                                            00099900
000860                                                                  00100000
000861         WHEN SQLCODE = -305                                      00100100
000862              CONTINUE                                            00100200
000863                                                                  00100300
000864         WHEN SQLCODE = PC-ROW-NOT-FOUND                          00100400
000865             SET PS-END-OF-EXTRACT          TO TRUE               00100500
000866         WHEN SQLWARN0 NOT EQUAL SPACE                            00100600
000867         WHEN SQLCODE NOT EQUAL ZERO                              00100700
000868             MOVE '3100-FETCH-EXTRACT-CURSOR'                     00100800
000869                                            TO PV-PARAGRAPH-NAME  00100900
000870             MOVE 'ERROR ON FETCH OF EXTRACT-CURSOR'              00101000
000871                                            TO PV-DB2-OPERATION   00101100
000872             PERFORM 9100-SQL-ABEND                               00101200
000873     END-EVALUATE.                                                00101300
000874                                                                  00101400
052523******************************************************************00101500
052523* 3101-FETCH-PAYMENT-CURSOR                                       00101600
052523******************************************************************00101700
052523 3101-FETCH-PAYMENT-CURSOR.                                       00101800
052523                                                                  00101900
052523     EXEC SQL                                                     00102000
052523          FETCH PAYMENT-CURSOR                                    00102100
052523           INTO :EPTND-PARTN-NBR                                  00102200
052523               ,:EPTND-STR-NBR                                    00102300
052523               ,:EPTND-RGST-ID                                    00102400
052523               ,:EPTND-TRN-NBR                                    00102500
052523               ,:EPTND-STRT-TM                                    00102600
052523               ,:EPTND-SLS-CORR-SEQ-NBR                           00102700
052523               ,:EPTRN-TRN-TYP-CDE                                00102800
052523               ,:EPPART-SLS-DTE                                   00102900
052523               ,:EPTRN-TRN-DTE                                    00103000
052523               ,:EPTND-TNDR-SEQ-NBR                               00103100
052523               ,:EPTND-TNDR-TYP-CDE                               00103200
052523               ,:EPTND-TNDR-ID                                    00103300
052523               ,:EPTND-TNDR-AMT                                   00103400
052523               ,:EPTND-TNDR-ID-SRC-CDE                            00103500
052523               ,:EPCRD-CPS-TRN-ID                                 00104000
052523               ,:EPCRD-MC-CMPLIN-CDE                              00104100
052523               ,:EPCRD-VIP-SRC-CDE                                00104200
052523               ,:EPCRD-VIP-RSPN-CDE                               00104300
052523               ,:EPCRD-BNKNET-NBR                                 00104400
052523               ,:EPTRN-VISA-MULT-CLR-SEQ-NBR                      00104500
052523               ,:EPT00056-AVS-RSPN-CDE                            00104600
052523               ,:EPTRN-SLS-TX-AMT                                 00104700
052523               ,:EPTRN-VISA-TOT-SHP-NBR                           00104800
052523               ,:EPCRD-CRD-LVL-RSLT-CDE                           00104900
052523               ,:EPT00056-CVV-RSPN-CDE                            00105000
052523               ,:EPCRD-NETWK-REF-ID                               00105100
052523               ,:EPCRD-TRSM-TMST                                  00105200
052523               ,:EPCRD-SYS-TRC-AUD-NBR                            00105300
052523               ,:EPCRD-TRK-DAT-CND-CDE                            00105400
052523               ,:EPTRN-OMNI-CHNL-FFLMT-TYP-CDE                    00105500
052523               ,:EPPAY-TRLING-TRN-IND                             00105600
052523               ,:EPPAY-COBRND-IND                                 00105700
052523               ,:EPPAY-PAYT-AMT                                   00105800
052523               ,:EPPAY-KC-ACCT-NBR                                00105900
052523               ,:EPPAY-KC-ACCT-SRC-CDE                            00106000
052523               ,:EPPAY-AUTH-NBR                                   00106100
052523               ,:EPPAY-AUTH-SRC-CDE                               00106200
052523     END-EXEC.                                                    00106400
052523                                                                  00106500
052523     EVALUATE TRUE                                                00106600
052523         WHEN SQLCODE = ZERO                                      00106700
052523             MOVE EPPAY-KC-ACCT-NBR     TO EPTND-TNDR-ID          00108800
052523             MOVE EPPAY-KC-ACCT-SRC-CDE TO EPTND-TNDR-ID-SRC-CDE  00108900
052523             MOVE EPPAY-AUTH-NBR        TO EPCRD-AUTH-NBR         00109000
052523             MOVE EPPAY-AUTH-SRC-CDE    TO EPCRD-AUTH-SRC-CDE     00109100
052523             MOVE EPPAY-TRLING-TRN-IND  TO EPCRD-TRLING-TRN-IND   00109200
052523                                                                  00109300
052523         WHEN SQLCODE = -305                                      00109400
052523              CONTINUE                                            00109500
052523                                                                  00109600
052523         WHEN SQLCODE = PC-ROW-NOT-FOUND                          00109700
052523             SET PS-END-OF-PAYMENT          TO TRUE               00109800
052523         WHEN SQLWARN0 NOT EQUAL SPACE                            00109900
052523         WHEN SQLCODE NOT EQUAL ZERO                              00110000
052523             MOVE '3101-FETCH-PAYMENT-CURSOR'                     00110100
052523                                            TO PV-PARAGRAPH-NAME  00110200
052523             MOVE 'ERROR ON FETCH OF PAYMENT-CURSOR'              00110300
052523                                            TO PV-DB2-OPERATION   00110400
052523             PERFORM 9100-SQL-ABEND                               00110500
052523     END-EVALUATE.                                                00110600
052523                                                                  00110700
000875***************************************************************** 00117900
000876* 3300-CLOSE-EXTRACT-CURSOR                                       00118000
000877*      CLOSE CURSOR                                               00118100
000878***************************************************************** 00118200
000879 3300-CLOSE-EXTRACT-CURSOR.                                       00118300
000880                                                                  00118400
000881     EXEC SQL                                                     00118500
000882          CLOSE EXTRACT-CURSOR                                    00118600
000883     END-EXEC.                                                    00118700
000884                                                                  00118800
000885     EVALUATE TRUE                                                00118900
000886         WHEN SQLCODE = ZERO                                      00119000
000887              CONTINUE                                            00119100
000888         WHEN SQLWARN0 NOT EQUAL SPACE                            00119200
000889         WHEN SQLCODE NOT EQUAL ZERO                              00119300
000890             MOVE '3300-CLOSE-EXTRACT-CURSOR'                     00119400
000891                                            TO PV-PARAGRAPH-NAME  00119500
000892             MOVE 'ERROR ON CLOSE OF EXTRACT-CURSOR'              00119600
000893                                            TO PV-DB2-OPERATION   00119700
000894             PERFORM 9100-SQL-ABEND                               00119800
000895     END-EVALUATE.                                                00119900
000896                                                                  00120000
052523***************************************************************** 00120100
052523* 3301-CLOSE-PAYMENT-CURSOR                                       00120200
052523*      CLOSE CURSOR                                               00120300
052523***************************************************************** 00120400
052523 3301-CLOSE-PAYMENT-CURSOR.                                       00120500
052523                                                                  00120600
052523     EXEC SQL                                                     00120700
052523          CLOSE PAYMENT-CURSOR                                    00120800
052523     END-EXEC.                                                    00120900
052523                                                                  00121000
052523     EVALUATE TRUE                                                00121100
052523         WHEN SQLCODE = ZERO                                      00121200
052523              CONTINUE                                            00121300
052523         WHEN SQLWARN0 NOT EQUAL SPACE                            00121400
052523         WHEN SQLCODE NOT EQUAL ZERO                              00121500
052523             MOVE '3301-CLOSE-PAYMENT-CURSOR'                     00121600
052523                                            TO PV-PARAGRAPH-NAME  00121700
052523             MOVE 'ERROR ON CLOSE OF PAYMENT-CURSOR'              00121800
052523                                            TO PV-DB2-OPERATION   00121900
052523             PERFORM 9100-SQL-ABEND                               00122000
052523     END-EVALUATE.                                                00122100
052523     MOVE 'N'                    TO EPPAY-COBRND-IND.             00122200
052523                                                                  00122300
000897******************************************************************00122400
000898* 4000-WRITE-EXTRACT-FILE                                         00122500
000899*     FORMAT THE OUTPUT RECORD AND WRITE IT OUT.                  00122600
000900*     WRITE THE EXTRACT FILE FROM COPYBOOK TCRD004                00122700
000901******************************************************************00122800
000902 4000-WRITE-EXTRACT-FILE.                                         00122900
000903                                                                  00123000
000904     INITIALIZE TC004-EXTRACT-RECORD.                             00123100
000905     MOVE EPTND-PARTN-NBR        TO TC004-PARTN-NBR.              00123200
000906     MOVE EPTND-STR-NBR          TO TC004-STR-NBR.                00123300
000907     MOVE EPTND-RGST-ID          TO TC004-RGST-ID.                00123400
000908     MOVE EPTND-TRN-NBR          TO TC004-TRN-NBR.                00123500
000909     MOVE EPTND-STRT-TM          TO TC004-STRT-TM.                00123600
000910     MOVE EPTND-SLS-CORR-SEQ-NBR TO TC004-SLS-CORR-SEQ-NBR.       00123700
000911     MOVE EPTND-TNDR-SEQ-NBR     TO TC004-TNDR-SEQ-NBR.           00123800
000912     MOVE EPTND-TNDR-ID          TO TC004-TNDR-ID.                00123900
000913     MOVE PV-TNDR-AMT            TO TC004-TNDR-AMT.               00124000
000914     MOVE PV-TAX-AMT             TO TC004-SLS-TX-AMT.             00124100
052523     IF EPTND-TNDR-TYP-CDE = '04'                                 00124200
052523         MOVE '24'               TO EPTND-TNDR-TYP-CDE            00124300
052523     END-IF.                                                      00124400
000915     MOVE EPTND-TNDR-TYP-CDE     TO TC004-TNDR-TYP-CDE.           00124500
000916     MOVE EPTND-TNDR-ID-SRC-CDE  TO TC004-TNDR-ID-SRC-CDE.        00124600
000917     MOVE EPPART-SLS-DTE         TO TC004-SLS-DTE.                00124700
000918     MOVE EPTRN-TRN-DTE          TO TC004-TRN-DTE.                00124800
000919     MOVE EPCRD-AUTH-NBR         TO TC004-AUTH-NBR.               00124900
000920     MOVE EPCRD-AUTH-SRC-CDE     TO TC004-AUTH-SRC-CDE.           00125000
000921     MOVE EPCRD-CPS-TRN-ID       TO TC004-CPS-TRN-ID.             00125100
000922     MOVE EPCRD-MC-CMPLIN-CDE    TO TC004-MC-CMPLIN-CDE.          00125200
000923     MOVE EPCRD-VIP-SRC-CDE      TO TC004-VIP-SRC-CDE.            00125300
000924     MOVE EPCRD-VIP-RSPN-CDE     TO TC004-VIP-RSPN-CDE.           00125400
000925     MOVE EPCRD-BNKNET-NBR       TO TC004-BNKNET-NBR.             00125500
000926     MOVE EPT00056-AVS-RSPN-CDE  TO TC004-AVS-RSPN-CDE.           00125600
000927     MOVE EPTRN-TRN-TYP-CDE      TO TC004-TRN-TYP-CDE.            00125700
000928                                                                  00125800
000929     MOVE SPACES                 TO PV-CRD-LVL-RSLT-CDE.          00125900
000930     MOVE EPCRD-CRD-LVL-RSLT-CDE TO PV-CRD-LVL-RSLT-CDE.          00126000
000931     IF PV-CRD-LVL-RSLT-CDE-1 = SPACES AND                        00126100
000932        PV-CRD-LVL-RSLT-CDE-2 NOT = SPACES                        00126200
000933       MOVE PV-CRD-LVL-RSLT-CDE-2 TO PV-CRD-LVL-RSLT-CDE-1        00126300
000934       MOVE SPACES                TO PV-CRD-LVL-RSLT-CDE-2        00126400
000935       MOVE PV-CRD-LVL-RSLT-CDE  TO TC004-CRD-LVL-RSLT-CDE        00126500
000936     ELSE                                                         00126600
000937       MOVE PV-CRD-LVL-RSLT-CDE  TO TC004-CRD-LVL-RSLT-CDE        00126700
000938     END-IF.                                                      00126800
000939                                                                  00126900
000940     MOVE EPT00056-CVV-RSPN-CDE  TO TC004-CVV-RSPN-CDE.           00127000
000941     MOVE EPCRD-NETWK-REF-ID     TO TC004-NETWK-REF-ID.           00127100
000942     MOVE EPCRD-TRSM-TMST        TO TC004-TRSM-TMST.              00127200
000943     MOVE EPCRD-SYS-TRC-AUD-NBR  TO TC004-SYS-TRC-AUD-NBR.        00127300
000944     MOVE EPCRD-TRK-DAT-CND-CDE  TO TC004-TRK-DAT-CND-CDE.        00127400
000945     MOVE EPTRN-OMNI-CHNL-FFLMT-TYP-CDE TO                        00127500
000946                                  TC004-OMNI-CHNL-FFLMT-TYP-CDE.  00127600
000947     MOVE EPTRN-VISA-MULT-CLR-SEQ-NBR TO PV-VISA-MULT-CLR-SEQ-NBR.00127700
000947     MOVE PV-VISA-MULT-CLR-SEQ-NBR TO                             00127800
000948                                  TC004-VISA-MULT-CLR-SEQ-NBR.    00127900
000949     MOVE EPTRN-VISA-TOT-SHP-NBR TO PV-VISA-TOT-SHP-NBR.          00128000
000949     MOVE PV-VISA-TOT-SHP-NBR    TO TC004-VISA-TOT-SHP-NBR.       00128100
052523     MOVE EPCRD-TRLING-TRN-IND   TO TC004-TRLING-TRN-IND.         00128200
052523     MOVE EPPAY-COBRND-IND       TO TC004-COBRAND-PYMT-IND.       00128300
000952     WRITE COSA-EXTRACT-RECORD  FROM TC004-EXTRACT-RECORD.        00128400
000960                                                                  00128500
001056******************************************************************00128600
001057* 9100-SQL-ABEND                                                  00128700
001058*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.00128800
001059******************************************************************00128900
001060 9100-SQL-ABEND.                                                  00129000
001061     DISPLAY '** ABEND     **'.                                   00129100
001062     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        00129200
001063     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              00129300
001064     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               00129400
001065                                                                  00129500
001066******************************************************************00129600
001067* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     00129700
001068* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      00129800
001069******************************************************************00129900
001070     COPY DPPD004.                                                00130000
001071                                                                  00130100
001072     SET AC-DB2-ERROR TO TRUE.                                    00130200
001073     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         00130300
001074                                                                  00130400
001075******************************************************************00130500
001076* 9999-ABEND                                                      00130600
001077*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  00130700
001078******************************************************************00130800
001079 9999-ABEND.                                                      00130900
001080                                                                  00131000
001081     DISPLAY '** ABEND           **'.                             00131100
001082     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  00131200
001083     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        00131300
001084     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       00131400
001090     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       00132000
001100     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         00140000
