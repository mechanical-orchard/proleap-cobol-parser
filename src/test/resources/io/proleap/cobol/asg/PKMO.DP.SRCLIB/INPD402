      ********************!!! ATTENTION !!!*****************************00010008
W31475*  INPD402 - COMMON PRICE LOOKUP MODULE. THIS IS CLONE OF INPD400.00020007
W31475*            ANY CHANGES HERE NEEDS TO REFLECT IN INPD400 ALSO AND00030008
W31475*            VICE-VERSA.                                          00031007
28545 *-----------------------------------------------------------------00040001
28545 *CHANGE HISTORY:                                                  00050001
28545 * WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES           00060001
28545 * ------- ---------- ----------- -------------------------------- 00070001
28545 * W28545  03-08-2006 ROD JANSSEN CYCLE INVENTORY SKU/STYLE DELETE 00080001
BV    * W28545  04-11-2006 ROD JANSSEN TEMP REMOVE BV COPY CODE CALLS.  00090001
D28545* W28545  04-11-2006 ROD JANSSEN DUMMY SKU/UPC & RETURN CODE LOGIC00100001
D28545*                                RENUMBER SKUS & ATTRIBUTES.      00110001
A28545* W28545  04-21-2006 ROD JANSSEN VSM ATTRIBUTE LOOKUP ISSUE, -811.00120001
B28545* W28545  04-25-2006 ROD JANSSEN VSM LOOKUP BY ITEM ISSUE         00130001
E28545* W28545  04-26-2006 ROD JANSSEN PASS BACK RENUMBER STATUS TO HOST00131001
F28545* W28545  05-22-2006 ROD JANSSEN MBS LOOKUP EFFICIENCIES....      00132001
H28545* W28545  07-04-2006 ROD JANSSEN RENUMBER SKU ISSUE & UPC_ID LOOK.00133001
I28545* W28545  07-07-2006 ROD JANSSEN BUILD IN PERFORMANCE EFFICIENCIES00134001
J28545* W28545  07-24-2006 ROD JANSSEN INVENTORY RECLASS                00134101
Z28545* W28545  08-07-2006 ROD JANSSEN  IN402-***-SKU-OUT LOGIC NEEDS TO00134210
Z28545*                                USE THE RESULTANT SKU RATHER THAN00134301
Z28545*                                CREATE A SKU BASED ON UPC_NBR.   00134401
Z28545*                                 IN402-***-UPC-OUT LOGIC NEEDS TO00134510
Z28545*                                RETAIN THE PASSED IN UPC_NBR IF  00134601
Z28545*                                PRESENT; OTHERWISE, PASS BACK THE00134701
Z28545*                                KOHLS UPC_NBR.                   00134801
RONNA * W28545  10-22-2006 RONNA M.    USE THE BV UTILITY TO GET DEPT   00134901
RONNA *                                BRAND VENDOR ATTRIBUTES.         00135001
RONNA *                                MODIFY EDITING TO ALLOW 0000     00135101
RONNA *                                VALUE IN THE STORE NUMBER WHEN   00135201
RONNA *                                DOING AN ATTRIBUTE LOOKUP.       00135301
RONNA *                                ADDED RETURN CODES TO DETERMINE  00135401
RONNA *                                THE STATUS OF GETTING THE DEPT,  00135501
RONNA *                                BRAND, VENDOR ATTRIBUTES.        00135601
RONNA *                                IF DEPT BRAND VENDOR ATTRIBUTES  00135701
RONNA *                                ARE NEEDED, THE PRICING MODULE   00135801
RONNA *                                IS THE UTILITY TO USE            00135901
RONNA5* W28545  11-30-2006 RONNA M     DEFAULT BRAND VENDOR DATALESS KEY00136001
RONNA5*                                TO UNKOWNS WHEN THE SKY/ITEM/UPC 00136101
RONNA5*                                /UPC ID IS NOT FOUND ANY WHERE   00136201
JAS   * W28582  02-13-2007 JOHN S.     DEFAULT ENT-ID TO UNKNOWN WHEN   00136301
JAS   *                                VSM ATTRIBUTES ARE NOT FOUND.    00136401
X28542* W28542  02-22-2007 ROD JANSSEN INTR UPCID SKU/STYL DELETE       00136501
X28542*                                LOOKUP WAS USING THE SKU         00136601
X28542*                                SKU/STYL DELETE LOOKUP ON THE    00136701
X28542*                                INITIAL CURSOR FETCH.            00136801
S28582* W28582  03-05-2007 JOHN S.     USE ENT-ID IF PASSED INSTEAD OF  00136901
S28582*                                ASSIGNING UNKNOWN VENDOR.        00137001
RONNAQ* W28582  03-25-2007 RONNA M.    FIXED PROGRAM LOOPING.           00137101
RONNAQ*                                INVALID KEY LOOKUP WAS NOT       00137201
RONNAQ*                                GETTING SET WHEN SQLCODE DROPPED 00137301
RONNAQ*                                IN THE 'OTHER' LOGIC.            00137401
W34517* W34517  09-15-2008 JOHN S.     IF DKEY IS NOT ASSIGNED DUE TO   00137502
W34517*                                MBS ATTRIBUTE LOOKUP ERROR,      00137602
W34517*                                ASSIGN KNOWN VENDOR/UNKNOWN BRAND00137702
W34517*                                OR UNKNOWN VENDOR/UNKNOWN BRAND. 00137802
W34517*                                IF DEPT-NBR IS DIFFERENT THAN    00137905
W34517*                                SKU (1:3), USE DEPT-NBR TO LOOKUP00138005
W34517*                                BV RELATIONSHIP.                 00138105
W31475* W31475  05-20-2009 COGNIZANT   ML BATCH PERFORMANCE TUNING      00138207
28545 *                                                                 00138307
28545 *-----------------------------------------------------------------00138407
28545 *PURPOSE: COMMON PRICE LOOKUP MODULE COPY CODE.                   00138507
28545 *                                                                 00138607
28545 *NOTE:    REFER TO MODULE INWS400 FOR PROCESSING OPTIONS.         00138707
28545 *           THE INPUT FIELDS WILL BE INITIALIZED AFTER EACH       00138807
28545 *           CALL TO THE ROUTINE.                                  00138907
28545 *                                                                 00139007
28545 *-----------------------------------------------------------------00139107
28545 *  HOW TO USE THIS COPYBOOK WITH INPD400:                         00139207
28545 *-----------------------------------------------------------------00139307
28545 *  1.  DETERMINE IF WE CAN USE VSM PRICING TABLES OR HISTORICAL   00139407
28545 *      PHYSICAL INVENTORY STYLE DELETION TABLES.                  00139507
28545 *                                                                 00139607
28545 *  2.  PRICE LOOKUP.                                              00139707
28545 *      A.  INPUT(S) BUILD.                                        00139807
      *      - THE MINIMUM INPUT REQUIRED TO RETRIEVE CURRENT RETAIL ARE00139907
      *        KEY DATES, LOCATION, AND VALID IDENTIFIER PV-LOOKUP-TYPE 00140007
      *      - SET THE APPROPRIATE PV-LOOKUP-TYPE INDICATOR, BY SETTING 00140107
      *        THE 88 LEVEL TO TRUE: SKU, UPC, UPCID, ITM.              00140207
      *        IF NOTHING IS SET HERE, IT WILL SEARCH UNTIL IT FINDS    00140307
      *        SKU, UPC-NBR, UPC-ID, ITM-NBR THE PROCESS CAN UTILIZE    00140407
      *      - PRIOR TO ENTERING PROCEDURE DIVISION, MOVE DATA TO THE   00140507
      *        APPROPRIATE FIELD CORRESPNDING TO THE SWITCH THAT WAS SET00140607
      *      - IF ADDITIONAL DATA IS AVAILABLE (ITM_NBR FOR SKU LOOKUP) 00140707
      *        INCLUDE THIS AS WELL IN CASE THE FIRST CALL FAILED       00141002
      *      - IF THE LOOKUP AT THE SPECIFIED LEVEL OR THE FIRST        00150001
      *        ASSUMPTION LEVEL FAIL, THIS PROCESS WILL TRY AGAIN USING 00160001
      *        THE ADDITIONAL DATA FIELD UNTIL ATTEMPTS ARE EXHAUSTED.  00170001
      *                                                                 00180001
      *      - ENTRY PROCEDURE: IN402-LOOKUP-RETAIL                     00190010
      *                                                                 00200001
28545 *      B.  RESULTS.                                               00210001
28545 *      - PRICE LOOKUP RETURN CODE VARIABLES ARE DEFINED HERE.     00220001
28545 *        (IN402-PV-COMMON-AREA)                                   00230010
28545 *         - RETURN STATUS CODE                                    00240001
28545 *         - RETURN STATUS CODE REASON TEXT                        00250001
28545 *                                                                 00260001
28545 *      - ON A SUCCESSFUL EXECUTION AND RETURN TO THE CALLING      00270001
28545 *        PROGRAM, THE FOLLOWING DATA WILL BE RETURNED TO THE      00280001
28545 *        FOLLOWING WORKING STORAGE FIELD                          00290001
28545 *        (IN402-PRICE-RESULT-AREA)                                00300010
28545 *         - EFF BEGIN DATE                                        00310001
28545 *         - EFF END DATE                                          00320001
28545 *         - SKU                        (TSKXREF)                  00330001
28545 *         - INTERNAL UPC ID            (TSKXREF)                  00340001
28545 *         - UPC NUMBER                 (TUPC)                     00350001
28545 *         - ITEM NUMBER                (TSKXREF)                  00360001
28545 *         - STATUS CODE                (TSKXREF)                  00370001
28545 *         - UPC CHANGE DATE            (TUPCPLS)                  00380001
28545 *         - STATUS CHANGE DATE         (TUPCPLS)                  00390001
28545 *         - GROUP PRICE NUMBER         (TMEITGP)                  00400001
28545 *         - GROUP PRICE QUANTITY       (TMITGPL)                  00410001
28545 *         - GROUP PRICE RETAIL AMOUNT  (TMITGPL)                  00420001
28545 *         - UNIT RETAIL AMOUNT         (TUPCPLS)                  00430001
28545 *         - EXTENDED UNIT RETAIL AMOUNT                           00440001
28545 *                                                                 00450001
28545 *      - ON A SUCCESSFUL EXECUTION AND RETURN TO THE CALLING      00460001
28545 *        PROGRAM, THE FOLLOWING DATA WILL BE RETURNED TO THE      00470001
28545 *        FOLLOWING WORKING STORAGE FIELD.                         00480001
28545 *        (IN402-ATTRIB-RESULT-AREA)                               00490010
28545 *         -  SKU                                                  00500001
28545 *         -  INTERNAL UPC ID                                      00510001
28545 *         -  UPC                                                  00520001
28545 *         -  ITEM NUMBER                                          00530001
28545 *         -  DEPARTMENT                                           00540001
28545 *         -  MAJOR CLASS                                          00550001
28545 *         -  SUB CLASS                                            00560001
28545 *         -  SKU STATUS CODE                                      00570001
28545 *         -  MDSEAR ID                                            00580001
28545 *         -  RMS STYLE ID                                         00590001
28545 *         -  VENDOR STYLE ID                                      00600001
28545 *         -  VENDOR STYLE NUMBER                                  00610001
28545 *                                                                 00620001
      *      - ON A SUCCESSFUL EXECUTION AND RETURN TO THE CALLING      00630001
      *        PROGRAM, THE FOLLOWING DATA WILL BE RETURNED TO THE      00640001
28545 *        FOLLOWING WORKING STORAGE FIELD.                         00650001
28545 *        (IN402-VENDOR-RESULT-AREA)                               00660010
28545 *         -  SKU                                                  00670001
28545 *         -  INTERNAL UPC ID                                      00680001
28545 *         -  UPC                                                  00690001
28545 *         -  ITEM NUMBER                                          00700001
28545 *         -  DEPARTMENT                                           00710001
28545 *         -  VENDOR ENT_ID                                        00720001
28545 *         -  VENDOR DUNS NUMBER                                   00730001
28545 *         -  VENDOR INHOUSE NUMBER                                00740001
28545 *         -  BRAND                                                00750001
28545 *                                                                 00760001
28545 *-----------------------------------------------------------------00770001
28545 *  3.  ATTRIBUTES LOOKUP.                                         00780001
28545 *      A.  ATTRIBUTES INPUT(S) BUILD.                             00790001
28545 *      - BOTH THE ITEM ATTRIBUTES AND BRAND/VENDOR ATTRIBUTES ARE 00800001
28545 *        BUILT DURING THIS PROCESS.                               00810001
28545 *      - THE MINIMUM INPUT REQUIRED TO RETRIEVE CURRENT RETAIL ARE00820001
28545 *        KEY DATES AND VALID IDENTIFIER PV-LOOKUP-TYPE            00830001
28545 *      - SET THE APPROPRIATE PV-LOOKUP-TYPE INDICATOR, BY SETTING 00840001
28545 *        THE 88 LEVEL TO TRUE: ASKU, AUPC, AUPCID, AITM.          00850001
28545 *        IF NOTHING IS SET HERE, IT WILL SEARCH UNTIL IT FINDS    00860001
28545 *        SKU, UPC-NBR, UPC-ID, ITM-NBR THE PROCESS CAN UTILIZE    00870001
28545 *      - PRIOR TO ENTERING PROCEDURE DIVISION, MOVE DATA TO THE   00880001
28545 *        APPROPRIATE FIELD CORRESPNDING TO THE SWITCH THAT WAS SET00890001
28545 *      - IF ADDITIONAL DATA IS AVAILABLE (ITM_NBR FOR SKU LOOKUP) 00900001
28545 *        INCLUDE THIS AS WELL IN CASE THE FIRST CALL FAILED       00910001
28545 *      - IF THE LOOKUP AT THE SPECIFIED LEVEL OR THE FIRST        00920001
28545 *        ASSUMPTION LEVEL FAIL, THIS PROCESS WILL TRY AGAIN USING 00930001
28545 *        THE ADDITIONAL DATA FIELD UNTIL ATTEMPTS ARE EXHAUSTED.  00940001
28545 *                                                                 00950001
28545 *      - ENTRY PROCEDURE: IN402-LOOKUP-ATTRIBUTES                 00960010
28545 *                                                                 00970001
28545 *      B.  ATTRIBUTES RESULTS.                                    00980001
28545 *      - ON A SUCCESSFUL EXECUTION AND RETURN TO THE CALLING      00990001
28545 *        PROGRAM, THE FOLLOWING DATA WILL BE RETURNED TO THE      01000001
28545 *        FOLLOWING WORKING STORAGE FIELD.                         01010001
28545 *        (IN402-ATTRIB-RESULT-AREA)                               01020010
28545 *         -  SKU                                                  01030001
28545 *         -  INTERNAL UPC ID                                      01040001
28545 *         -  UPC                                                  01050001
28545 *         -  ITEM NUMBER                                          01060001
28545 *         -  DEPARTMENT                                           01070001
28545 *         -  MAJOR CLASS                                          01080001
28545 *         -  SUB CLASS                                            01090001
28545 *         -  SKU STATUS CODE                                      01100001
28545 *         -  MDSEAR ID                                            01110001
28545 *         -  RMS STYLE ID                                         01120001
28545 *     -  VENDOR STYLE ID                                          01130001
28545 *         -  VENDOR STYLE NUMBER                                  01140001
28545 *         -  INHOUSE NUMBER                                       01150001
28545 *         -  DUNS NUMBER                                          01160001
28545 *         -  VENDOR ENT_ID (TVNDSTL)                              01170001
28545 *                                                                 01180001
28545 *      C.  VENDOR ATTRIBUTES INPUT(S) BUILD.                      01190001
28545 *      - AT AN INTERNAL UPC ID LEVEL, CAPTURE THE BRAND/VENDOR    01200001
28545 *        LEVEL ATTRIBUTES. USE OF THE ITEM ATTRIBUTES INTR_UPC_ID 01210001
28545 *        TO BUILD BRAND/VENDOR INFORMATION.                       01220001
28545 *      - INPUT DATA REQUIREMENTS. (EFFECTIVE DATE/DEPARTMENT/VEND/01230001
28545 *        INTR_UPC_ID)                                             01240001
28545 *      - VENDOR ATTRIBUTES ARE BASED ON THE COPYCODE BVWS003 &    01250009
28545 *        BVPD003.                                                 01260009
28545 *                                                                 01270001
28545 *      - ENTRY PROCEDURE: BV003-LOOKUP-MAIN                       01280011
28545 *                                                                 01290001
28545 *      D.  VENDOR ATTRIBUTES RESULTS.                             01300001
28545 *      - ON A SUCCESSFUL EXECUTION AND RETURN TO THE CALLING      01310001
28545 *        PROGRAM, THE FOLLOWING DATA WILL BE RETURNED TO THE      01320001
28545 *        FOLLOWING WORKING STORAGE FIELD.                         01330001
28545 *        (IN402-VENDOR-RESULT-AREA)                               01340010
28545 *         -  SKU                                                  01350001
28545 *         -  INTERNAL UPC ID                                      01360001
28545 *         -  UPC                                                  01370001
28545 *         -  ITEM NUMBER                                          01380001
28545 *         -  DEPARTMENT                                           01390001
28545 *         -  VENDOR ENT_ID                                        01400001
28545 *         -  MDSE_LO_LVL_ID                                       01410001
28545 *         -  LBL_SEQ_NBR                                          01420001
28545 *                                                                 01430001
28545 *IN ALL PRICE SCENARIOS, THE FOLLOWING HOLDS TRUE.                01440001
28545 *                                                                 01450001
28545 *I.  PRICE LOOKUP RULES (PRICE LEVEL DETERMINATION)               01460001
28545 *  1.  VARIABLES TO PASS TO THE PRICE MODULE FOR PRICE LOOKUP.    01470001
28545 *      A.  AT THE SOURCE MODULE LEVEL PASS EITHER THE SKU, UPC_NBR01480001
28545 *          INTR_UPC_ID, OR ITM_NBR.                               01490001
28545 *      B.  THE LOCATION NUMBER.                                   01500001
28545 *      C.  EFFECTIVE DATE. INVENTORY - USE THE SOURCE MODULE DATE 01510001
28545 *          REQUIREMENTS OR THE TINVPAR PLANNED INVENTORY DATE.    01520001
28545 *          THE DEFAULT IS SYSTEM DATE)                            01530001
28545 *      D.  THE TYPE OF LOOKUP TO BE PERFORMED. IN INWS400, SEE THE01540001
28545 *          INPUT VARIABLE IN402-PV-LOOKUP-TYPE-IN FOR MORE DETAILS01550010
28545 *          VALID PRICE LEVEL LOOKUPS INCLUDE:                     01560001
28545 *          I.   SKU     - IN402-PV-SKU-LOOKUP                     01570010
28545 *          II.  UPC_NBR - IN402-PV-UPC-NBR-LOOKUP                 01580010
28545 *          III. UPC_ID  - IN402-PV-INTR-UPC-ID-LOOKUP             01590010
28545 *          IV.  ITM_NBR - IN402-PV-ITM-NBR-LOOKUP                 01600010
28545 *          V.   IF NOT DEFINED THE PRICE MODULE WILL ATTEMPT TO   01610001
28545 *               LOCATE RICE BASED ON ITEM I.1.A. IF NOT FOUND,    01620001
28545 *               ABEND....                                         01630001
28545 *                                                                 01640001
28545 *  2.  USE VSM TABLES OR INVENTORY SKU/STYLE DELETE TABLE?        01650001
28545 *                                                                 01660001
28545 *  **** VSM -                                                     01670001
28545 *  3.  VSM TABLE LOOKUP, STORE SPECIFIC - VALID SKU/UPC/UPC_ID/   01680001
28545 *      ITM_NBR, STORE, EFF BEG/END DATE RANGE.                    01690001
28545 *  4.  VSM TABLE LOOKUP, CORPORATE - VALID SKU/UPC/UPC_ID/ITEM,   01700001
28545 *      STORE, EFF BEG/END DATE RANGE.                             01710001
28545 *  5.  NO MATCH VSM TABLE LOOKUP, PERM HISTORY, STORE SPECIFIC -  01720001
28545 *      VALID ITEM, LOCATION.                                      01730001
28545 *  6.  NO MATCH VSM TABLE LOOKUP, PERM HISTORY, CORPORATE - VALID 01740001
28545 *      ITEM, LOCATION.                                            01750001
28545 *  7.  ATTRIBUTE LOOKUP INCLUDES:                                 01760001
28545 *      A.  VSM ATTRIBUTES.                                        01770001
28545 *      B.  MBS ATTRIBUTES.                                        01780001
28545 *      C.  BRAND/VENDOR ATTRIBUTES.                               01790001
28545 *                                                                 01800001
28545 *  **** INVENTORY SKU/STYLE DELETE -                              01810001
28545 *  8.  INVENTORY SKU/STYLE DELETE TABLE, STORE SPECIFIC - VALID   01820001
28545 *      SKU/UPC_ID/UPC_NBR/ITEM, STORE, EFF BEG/END DATE RANGE.    01830001
28545 *  9.  INVENTORY SKU/STYLE DELETE TABLE, CORPORATE - VALID SKU/   01840001
28545 *      UPC_NBR/UPC_ID/ITEM, STORE, EFF BEG/END DATE RANGE.        01850001
28545 *  10. BOTH PRICE AND ATTRIBUTE LOOKUP IS CAPTURED WHEN USING THE 01860001
28545 *      INVENTORY SKU/STYLE DELETE.                                01870001
28545 *      A.  VSM ATTRIBUTES.                                        01880001
28545 *      B.  MBS ATTRIBUTES.                                        01890001
28545 *      C.  BRAND/VENDOR ATTRIBUTES.                               01900001
28545 *                                                                 01910001
28545 *  11. ERROR HANDLING PASSED TO THE SOURCE MODULE.                01920001
28545 *                                                                 01930001
28545 *II. ATTRIBUTE LOOKUP RULES (PRICE LEVEL DETERMINATION)           01940001
28545 *  1.  VARIABLES TO PASS TO THE PRICE MODULE FOR ATTRIBUTE LOOKUP.01950001
28545 *      A.  AT THE SOURCE MODULE LEVEL PASS EITHER THE SKU, UPC_NBR01960001
28545 *          INTR_UPC_ID, OR ITM_NBR.                               01970001
28545 *      B.  THE LOCATION NUMBER.                                   01980001
28545 *      C.  EFFECTIVE DATE. INVENTORY - USE THE SOURCE MODULE DATE 01990001
28545 *          REQUIREMENTS OR THE TINVPAR PLANNED INVENTORY DATE.    02000001
28545 *          THE DEFAULT IS SYSTEM DATE)                            02010001
28545 *      D.  THE TYPE OF LOOKUP TO BE PERFORMED. IN INWS400, SEE THE02020001
28545 *          INPUT VARIABLE IN402-PV-LOOKUP-TYPE-IN FOR MORE DETAILS02030010
28545 *          VALID ATTRIBUTE LEVEL LOOKUPS INCLUDE:                 02040001
28545 *          I.   SKU     - IN402-PV-SKU-ATTRIB-LOOK                02050010
28545 *          II.  UPC_NBR - IN402-PV-UPC-NBR-ATTRIB-LOOK            02060010
28545 *          III. UPC_ID  - IN402-PV-INTUPCID-ATTRIB-LOOK           02070010
28545 *          IV.  ITM_NBR - IN402-PV-ITEM-ATTRIB-LOOK               02080010
28545 *          V.   IF NOT DEFINED THE PRICE MODULE WILL ATTEMPT TO   02090001
28545 *               LOCATE, ATTRIBUTES BASED ON ITEM II.1.A. IF NOT   02100001
28545 *               FOUND, ABEND.....                                 02110001
28545 *                                                                 02120001
28545 *  2.  USE VSM TABLES OR INVENTORY SKU/STYLE DELETE TABLE?        02130001
28545 *                                                                 02140001
28545 *  **** VSM -                                                     02150001
28545 *  3.  VSM TABLE LOOKUP - VALID SKU/UPC/UPC_ID/ITEM,              02160001
28545 *      STORE, DATE RANGES.                                        02170001
28545 *  4.  NO MATCH VSM TABLE LOOKUP - ZERO OUT ATTRIBUTES AND PERFORM02180001
28545 *      ERROR HANDLING.                                            02190001
28545 *  5.  ATTRIBUTE LOOKUP INCLUDES:                                 02200001
28545 *      A.  VSM ATTRIBUTES.                                        02210001
28545 *      B.  MBS ATTRIBUTES.                                        02220001
28545 *      C.  BRAND/VENDOR ATTRIBUTES.                               02230001
28545 *                                                                 02240001
28545 *  **** INVENTORY SKU/STYLE DELETE -                              02250001
28545 *  6.  INVENTORY SKU/STYLE DELETE TABLE, STORE SPECIFIC - VALID   02260001
28545 *      SKU/UPC_NBR/UPC_ID/ITEM, STORE, EFF BEG/END DATE RANGE.    02270001
28545 *  7.  INVENTORY SKU/STYLE DELETE TABLE, CORPORATE - VALID SKU/   02280001
28545 *      IPC_NBR/UPC_ID/ITEM, STORE, EFF BEG/END DATE RANGE.        02290001
28545 *  8.  BOTH PRICE AND ATTRIBUTE LOOKUP IS CAPTURED WHEN USING THE 02300001
28545 *      INVENTORY SKU/STYLE DELETE.                                02310001
28545 *      A.  VSM ATTRIBUTES.                                        02320001
28545 *      B.  MBS ATTRIBUTES.                                        02330001
28545 *      C.  BRAND/VENDOR ATTRIBUTES.                               02340001
28545 *                                                                 02350001
28545 *  9.  ERROR HANDLING PASSED TO THE SOURCE MODULE.                02360001
28545 *                                                                 02370001
28545 ******************************************************************02380001
                                                                        02390001
28545 ******************************************************************02400001
28545 ******************************************************************02410001
      ******************************************************************02420001
      * IN402-LOOKUP-RETAIL. START LOOKING UP UNIT RETAIL.              02430010
      *  - INITIALIZE ALL OUTPUT VALUES BEFORE EXECUTING ANY CALLS      02440001
      *  - INITIALIZE ALL INPUT VALUES BEFORE RETURNING TO CALL MODULE  02450001
      ******************************************************************02460001
       IN402-LOOKUP-RETAIL.                                             02470010
                                                                        02480001
28545      INITIALIZE IN402-PV-COMMON-AREA.                             02490010
RONNA      SET IN402-PV-DBV-NOT-FOUND TO TRUE.                          02500010
28545      INITIALIZE IN402-PRICE-RESULT-AREA.                          02510010
28545      INITIALIZE IN402-ATTRIB-RESULT-AREA.                         02520010
28545      INITIALIZE IN402-VENDOR-RESULT-AREA.                         02530010
RONNA      INITIALIZE IN402-PV-WORK-AREA.                               02540010
28545                                                                   02550001
           MOVE ZEROES         TO SQLCODE.                              02560001
                                                                        02570001
RONNA      IF IN402-PV-ENT-ID-IN = SPACES                               02580010
RONNA         NEXT SENTENCE                                             02590001
RONNA      ELSE                                                         02600001
RONNA         ADD +2               TO IN402-PS-DBV-ASSUMP-SW            02610010
RONNA      END-IF.                                                      02620001
RONNA      IF IN402-PV-DEPT-IN = SPACES                                 02630010
RONNA         NEXT SENTENCE                                             02640001
RONNA      ELSE                                                         02650001
RONNA         ADD +1               TO IN402-PS-DBV-ASSUMP-SW            02660010
RONNA      END-IF.                                                      02670001
RONNA                                                                   02680001
28545      PERFORM IN402-SET-DATE.                                      02690010
28545      IF IN402-PV-INVALID-EFF-BEG-DTE                              02700010
28545          NEXT SENTENCE                                            02710001
28545      ELSE                                                         02720001
           IF (IN402-PV-LOC-IN = SPACES OR                              02730010
RONNA         (IN402-PV-LOC-IN-NUM = 0  AND                             02740010
RONNA         IN402-PV-PRICE-LOOKUP)    OR                              02750010
RONNA         IN402-PV-LOC-IN-NUM < 0)                                  02760010
RONNA *       IN402-PV-LOC-IN-NUM <= 0                                  02770010
               SET IN402-PV-INVALID-LOCATION TO TRUE                    02780010
28545          SET IN402-PV-SQL-ERROR        TO TRUE                    02790010
28545          SET IN402-PV-ATT-SQL-ERROR    TO TRUE                    02800010
D28545         STRING '  PARA: IN402-LOOKUP-RETAIL - '                  02801010
D28545                                       DELIMITED BY SIZE          02802001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             02803010
D28545                    '  ' DELIMITED BY SIZE                        02804001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         02805010
D28545                    '  ' DELIMITED BY SIZE                        02806001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        02807010
D28545                    '  ' DELIMITED BY SIZE                        02808001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         02809010
D28545                    '  ' DELIMITED BY SIZE                        02810001
D28545                              INTO IN402-PV-PARAGRAPH             02820010
           ELSE                                                         02830001
               PERFORM IN402-PROCESS-INPUT                              02840010
           END-IF.                                                      02850001
                                                                        02860001
W34517     IF IN402-PV-SKU-ATTRIB-LOOK OR                               02860110
W34517        IN402-PV-ITEM-ATTRIB-LOOK                                 02860210
W34517         IF IN402-VND-ML-LO-MDSE-LVL-ID = ZEROS                   02860310
W34517             PERFORM IN402-INV-UNKN-VEND-ATT-LOOKUP               02860410
W34517             PERFORM IN402-INV-UNKN-VEND-OUTPUT                   02860510
W34517         END-IF                                                   02860602
W34517     END-IF.                                                      02860702
W34517                                                                  02860802
28545 ******************************************************************02861001
28545 * CHECK THAT THE DATE FIELD MEETS INITIAL REQUIREMENTS            02862001
28545 * IF NO DATE IS PROVIDED, SET TO CURRENT DATE.                    02863001
28545 ******************************************************************02864001
28545  IN402-SET-DATE.                                                  02865010
28545                                                                   02866001
28545       IF IN402-PV-EFF-DTE-IN = SPACES OR                          02867010
28545          IN402-PV-EFF-DTE-IN = ZEROES                             02868010
28545           EXEC SQL                                                02869001
28545              SELECT CURRENT DATE                                  02870001
28545              INTO :IN402-PV-EFF-DTE-IN                            02880010
28545              FROM SYSIBM.SYSDUMMY1                                02890001
28545              WITH UR                                              02900001
28545           END-EXEC                                                02910001
28545                                                                   02920001
28545           EVALUATE TRUE                                           02930001
28545             WHEN SQLCODE = 0                                      02940001
28545                 MOVE IN402-PV-EFF-DTE-IN                          02950010
28545                               TO IN402-PV-EFF-BEG-DTE-IN          02960010
28545                                  IN402-PV-EFF-BEG-DTE             02970010
D28545                SET IN402-PV-FOUND-AS-REQUESTED TO TRUE           02980010
D28545                SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE           02990010
D28545                MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE           03000010
D28545                MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE           03010010
D28545                MOVE SPACES      TO IN402-PV-PARAGRAPH            03020010
28545             WHEN OTHER                                            03030001
28545                 SET IN402-PV-INVALID-EFF-BEG-DTE TO TRUE          03040010
28545                 SET IN402-PV-SQL-ERROR           TO TRUE          03050010
28545                 SET IN402-PV-ATT-SQL-ERROR       TO TRUE          03060010
RONNA                 SET IN402-PV-DBV-SQL-ERROR       TO TRUE          03070010
D28545                MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE           03080010
D28545                MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE           03090010
D28545                STRING '  PARA: IN402-SET-DATE - '                03100010
D28545                                       DELIMITED BY SIZE          03110001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             03120010
D28545                    '  ' DELIMITED BY SIZE                        03130001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         03140010
D28545                    '  ' DELIMITED BY SIZE                        03150001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        03160010
D28545                    '  ' DELIMITED BY SIZE                        03170001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         03180010
D28545                    '  ' DELIMITED BY SIZE                        03190001
D28545                              INTO IN402-PV-PARAGRAPH             03200010
28545           END-EVALUATE                                            03210001
28545      ELSE                                                         03220001
28545          MOVE IN402-PV-EFF-DTE-IN TO IN402-PV-EFF-BEG-DTE-IN      03230010
28545                                      IN402-PV-EFF-BEG-DTE         03240010
28545          IF IN402-PV-EFF-DTE-IN  = SPACES                         03250010
28545             OR IN402-PV-EFF-BEG-DTE-CCYY > '2100'                 03260010
28545             OR IN402-PV-EFF-BEG-DTE-CCYY < '1980'                 03270010
28545             OR IN402-PV-EFF-BEG-DTE-MM   <   '01'                 03280010
28545             OR IN402-PV-EFF-BEG-DTE-MM   >   '12'                 03290010
28545             OR IN402-PV-EFF-BEG-DTE-DD   <   '01'                 03300010
28545             OR IN402-PV-EFF-BEG-DTE-DD   >   '31'                 03310010
28545              SET IN402-PV-INVALID-EFF-BEG-DTE TO TRUE             03320010
D28545             SET IN402-PV-SQL-ERROR           TO TRUE             03330010
D28545             SET IN402-PV-ATT-SQL-ERROR       TO TRUE             03340010
RONNA              SET IN402-PV-DBV-SQL-ERROR       TO TRUE             03350010
D28545             STRING '  PARA: IN402-SET-DATE - '                   03360010
D28545                                       DELIMITED BY SIZE          03370001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             03380010
D28545                    '  ' DELIMITED BY SIZE                        03390001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         03400010
D28545                    '  ' DELIMITED BY SIZE                        03410001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        03420010
D28545                    '  ' DELIMITED BY SIZE                        03430001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         03440010
D28545                    '  ' DELIMITED BY SIZE                        03450001
D28545                              INTO IN402-PV-PARAGRAPH             03460010
28545          ELSE                                                     03470001
28545          IF IN402-PV-EFF-BEG-DTE-CCYY NOT NUMERIC OR              03480010
28545             IN402-PV-EFF-BEG-DTE-MM   NOT NUMERIC OR              03490010
28545             IN402-PV-EFF-BEG-DTE-DD   NOT NUMERIC                 03500010
28545              SET IN402-PV-INVALID-EFF-BEG-DTE TO TRUE             03510010
D28545             SET IN402-PV-SQL-ERROR           TO TRUE             03520010
D28545             SET IN402-PV-ATT-SQL-ERROR       TO TRUE             03530010
RONNA              SET IN402-PV-DBV-SQL-ERROR       TO TRUE             03540010
D28545             STRING '  PARA: IN402-SET-DATE - '                   03550010
D28545                                       DELIMITED BY SIZE          03560001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             03570010
D28545                    '  ' DELIMITED BY SIZE                        03580001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         03590010
D28545                    '  ' DELIMITED BY SIZE                        03600001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        03610010
D28545                    '  ' DELIMITED BY SIZE                        03620001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         03630010
D28545                    '  ' DELIMITED BY SIZE                        03640001
D28545                              INTO IN402-PV-PARAGRAPH             03650010
28545      ELSE                                                         03660001
28545          MOVE IN402-PV-EFF-DTE-IN TO IN402-PV-EFF-BEG-DTE-IN      03670010
28545                                      IN402-PV-EFF-BEG-DTE         03680010
D28545         SET IN402-PV-FOUND-AS-REQUESTED TO TRUE                  03690010
D28545         SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE                  03700010
D28545         MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE                  03710010
D28545         MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE                  03720010
D28545         MOVE SPACES      TO IN402-PV-PARAGRAPH                   03730010
28545      END-IF.                                                      03740001
28545                                                                   03750001
      ******************************************************************03760001
      * IN402-PROCESS-INPUT                                             03770010
      *   BEGIN THE VALIDATION PROCESS.                                 03780001
      *   - STEP 1) VALIDATE THE KEY INPUT IS VALID                     03790001
      *   - STEP 2) RESOLVE INPUT TO VARIOUS CORRESPONDING OUTPUTS      03800001
      *   - STEP 3) RETRIEVE RETAIL                                     03810001
      ******************************************************************03820001
       IN402-PROCESS-INPUT.                                             03830010
                                                                        03840001
           EVALUATE TRUE                                                03850001
D28545*** PRICE LOOKUP.....                                             03860001
RONNA *** PRICE AND ATTRIBUTE LOOKUP (CURRENT                           03870001
RONNA *        WHEN IN402-PV-SKU-LOOKUP                                 03880010
RONNA          WHEN IN402-PV-SKU-ASKU-LOOK                              03890010
                   IF IN402-PV-SKU-IN = SPACES    OR                    03900010
                      IN402-PV-SKU-IN NOT NUMERIC OR                    03910010
                      IN402-PV-SKU-IN = ZEROES                          03920010
D28545                 PERFORM IN402-LOOKUP-DEFAULT                     03930010
D28545             ELSE                                                 03940001
D28545             IF IN402-PV-DUMMY-SKU                                03950010
D28545                 MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-WORK-SKU    03960010
D28545                 MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-DUMB-SKU    03970010
D28545                 PERFORM IN402-DUMMY-SKU-LOOKUP                   03980010
D28545             ELSE                                                 03990001
                       MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-WORK-SKU    04000010
                       PERFORM IN402-LOOKUP-BY-SKU                      04010010
                   END-IF                                               04020001
                   END-IF                                               04030001
RONNA *        WHEN IN402-PV-UPC-NBR-LOOKUP                             04040010
RONNA          WHEN IN402-PV-UPC-AUPC-LOOK                              04050010
                   IF IN402-PV-UPC-NBR-IN = SPACES    OR                04060010
                      IN402-PV-UPC-NBR-IN NOT NUMERIC OR                04070010
                      IN402-PV-UPC-NBR-IN = ZEROES                      04080010
D28545                 PERFORM IN402-LOOKUP-DEFAULT                     04090010
D28545             ELSE                                                 04100001
I28545             IF (IN402-PV-KOHLS-UPC AND IN402-PV-DUMMY-UPC)       04110010
D28545                 MOVE IN402-PV-UPC-SKU-9 TO IN402-PV-WORK-SKU     04120010
D28545                 MOVE IN402-PV-UPC-SKU-9 TO IN402-PV-DUMB-SKU     04130010
D28545                 PERFORM IN402-DUMMY-SKU-LOOKUP                   04140010
                   ELSE                                                 04150001
                       MOVE IN402-PV-UPC-NBR-IN-NUM                     04160010
                                              TO IN402-PV-WORK-UPC-NBR  04170010
                       PERFORM IN402-LOOKUP-BY-UPC                      04180010
                   END-IF                                               04190001
                   END-IF                                               04200001
RONNA *        WHEN IN402-PV-INTR-UPC-ID-LOOKUP                         04210010
RONNA          WHEN IN402-PV-UPCID-AUPCID-LOOK                          04220010
                   IF IN402-PV-UPC-ID-SPC <= ZEROES                     04230010
D28545                 PERFORM IN402-LOOKUP-DEFAULT                     04240010
                   ELSE                                                 04250001
                       MOVE IN402-PV-UPC-ID-SPC    TO                   04260010
                            IN402-PV-WORK-UPC-ID                        04270010
                       PERFORM IN402-LOOKUP-BY-UPC-ID                   04280010
                   END-IF                                               04290001
RONNA *        WHEN IN402-PV-ITM-NBR-LOOKUP                             04300010
RONNA          WHEN IN402-PV-ITM-AITM-LOOK                              04310010
                   IF IN402-PV-ITM-NBR-IN = SPACES                      04320010
                       OR IN402-PV-ITM-NBR-IN NOT NUMERIC               04330010
                       OR IN402-PV-ITM-NBR-IN = ZEROES                  04340010
                       PERFORM IN402-LOOKUP-DEFAULT                     04350010
                   ELSE                                                 04360001
                       MOVE IN402-PV-ITM-NBR-IN-NUM                     04370010
                           TO IN402-PV-WORK-ITM-NBR                     04380010
                       PERFORM IN402-LOOKUP-BY-ITM-NBR                  04390010
                   END-IF                                               04400001
D28545*** ATTRIBUTE LOOKUP.....                                         04410001
RONNA * THE FOLLOWING HAS BEEN COMMENTED OUT BECAUSE THE LOGIC IS       04420001
RONNA * EXECUTED ABOVE                                                  04430001
28545 *        WHEN IN402-PV-SKU-ATTRIB-LOOK                            04440010
28545 *            IF IN402-PV-SKU-IN = SPACES                          04450010
28545 *              OR IN402-PV-SKU-IN NOT NUMERIC                     04460010
28545 *              OR IN402-PV-SKU-IN = ZEROES                        04470010
D28545*                PERFORM IN402-LOOKUP-DEFAULT                     04480010
D28545*            ELSE                                                 04490001
D28545*            IF IN402-PV-DUMMY-SKU                                04500010
D28545*                MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-WORK-SKU    04510010
D28545*                MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-DUMB-SKU    04520010
D28545*                PERFORM IN402-DUMMY-SKU-LOOKUP                   04530010
D28545*            ELSE                                                 04540001
28545 *                MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-WORK-SKU    04550010
28545 *                PERFORM IN402-LOOKUP-BY-SKU                      04560010
28545 *            END-IF                                               04570001
28545 *            END-IF                                               04580001
28545 *        WHEN IN402-PV-UPC-NBR-ATTRIB-LOOK                        04590010
28545 *            IF IN402-PV-UPC-NBR-IN = SPACES                      04600010
28545 *              OR IN402-PV-UPC-NBR-IN NOT NUMERIC                 04601010
28545 *              OR IN402-PV-UPC-NBR-IN = ZEROES                    04602010
D28545*                PERFORM IN402-LOOKUP-DEFAULT                     04603010
D28545*            ELSE                                                 04604001
I28545*            IF (IN402-PV-KOHLS-UPC AND IN402-PV-DUMMY-UPC)       04605010
D28545*                MOVE IN402-PV-UPC-SKU-9 TO IN402-PV-WORK-SKU     04606010
D28545*                MOVE IN402-PV-UPC-SKU-9 TO IN402-PV-DUMB-SKU     04607010
D28545*                PERFORM IN402-DUMMY-SKU-LOOKUP                   04608010
28545 *            ELSE                                                 04609001
28545 *                MOVE IN402-PV-UPC-NBR-IN-NUM                     04610010
28545 *                                        TO IN402-PV-WORK-UPC-NBR 04620010
28545 *                PERFORM IN402-LOOKUP-BY-UPC                      04630010
28545 *            END-IF                                               04640001
28545 *            END-IF                                               04650001
28545 *        WHEN IN402-PV-INTUPCID-ATTRIB-LOOK                       04660010
28545 *            IF IN402-PV-UPC-ID-SPC <= ZEROES                     04670010
D28545*                PERFORM IN402-LOOKUP-DEFAULT                     04680010
28545 *            ELSE                                                 04690001
28545 *                MOVE IN402-PV-UPC-ID-SPC                         04700010
28545 *                                     TO IN402-PV-WORK-UPC-ID     04710010
28545 *                PERFORM IN402-LOOKUP-BY-UPC-ID                   04720010
28545 *            END-IF                                               04730001
28545 *        WHEN IN402-PV-ITEM-ATTRIB-LOOK                           04740010
28545 *            IF IN402-PV-ITM-NBR-IN = SPACES                      04750010
28545 *                OR IN402-PV-ITM-NBR-IN NOT NUMERIC               04760010
28545 *                OR IN402-PV-ITM-NBR-IN = ZEROES                  04770010
D28545*                PERFORM IN402-LOOKUP-DEFAULT                     04780010
28545 *            ELSE                                                 04790001
28545 *                MOVE IN402-PV-ITM-NBR-IN-NUM                     04800010
28545 *                                     TO IN402-PV-WORK-ITM-NBR    04810010
28545 *                PERFORM IN402-LOOKUP-BY-ITM-NBR                  04820010
28545 *            END-IF                                               04830001
RONNA *  THE ABOVE WAS COMMENTED OUT WITH CHANGES MADE TO THE           04840001
RONNA *  PREVIOUS SET OF WHEN'S                                         04850001
D28545*** LOOKUP BASED ON THE PASSED PARAMETERS......                   04860001
               WHEN OTHER                                               04870001
                   PERFORM IN402-LOOKUP-DEFAULT                         04880010
           END-EVALUATE.                                                04890001
                                                                        04900001
28545 ******************************************************************04910001
28545 ** VSM LOOKUP.                                                    04920001
28545 ** RETRIEVE SKU/UPC/UPC_ID/ITEM INFORMATION USING VSM TABLES      04930001
28545 ** TABLES SEARCH ORDER - VSM/PERM/INVENTORY STYLE DELETION.       04940001
28545 ******************************************************************04950001
D28545     IF (NOT IN402-PV-INVALID-KEY-INPUT)                          04960010
             IF IN402-PV-FOUND                                          04970010
D28545**** VSM - DUMMY SKU....                                          04980001
D28545         IF IN402-PS-DUMMY-SKU                                    04990010
D28545           PERFORM IN402-DUMMY-SKU-ATT-LOOKUP                     05000010
D28545           PERFORM IN402-DUMMY-SKU-LOOKUP-ATT-OUT                 05010010
BV               PERFORM IN402-DUMMY-SKU-VEND-ATT-LOOK                  05020010
BV               PERFORM IN402-DUMMY-SKU-VEND-OUTPUT                    05030010
D28545         ELSE                                                     05040001
28545 **** VSM - PRICE LOOKUP....                                       05050001
28545          IF IN402-PV-PRICE-LOOKUP                                 05060010
                 MOVE 'N'                TO IN402-PS-STR-ROW-FOUND-SW   05070010
                 MOVE 'N'                TO IN402-PS-RETAIL-FOUND-SW    05080010
                 MOVE IN402-PV-LOC-IN-NUM   TO UPCPLS-STR-NBR           05090010
28545            PERFORM IN402-VSM-PROCEED-WITH-LOOKUP                  05100010
                     UNTIL IN402-PS-STR-FOUND                           05110010
                        OR IN402-PV-INVALID-KEY-INPUT                   05120010
28545            IF IN402-PS-STR-FOUND                                  05130010
28545                PERFORM IN402-VSM-PRICE-OUTPUT                     05140010
28545                PERFORM IN402-VSM-ATTRIBUTES-LOOKUP                05150010
J28545               PERFORM IN402-INVENTORY-RECLASS                    05160010
D28545               PERFORM IN402-VSM-PLU-DWNLD-LOOKUP                 05170010
28545                PERFORM IN402-VSM-MBS-LOOKUP                       05180010
28545                PERFORM IN402-VSM-ATTRIB-OUTPUT                    05190010
28545                PERFORM IN402-VSM-VENDOR-ATTRIB-LOOKUP             05200010
28545                PERFORM IN402-VSM-VENDOR-OUTPUT                    05210010
28545            ELSE                                                   05220001
28545 ****     STR PRICE NOT FOUND @ VSM AND TPPCPRC LEVEL(S) - TRY     05230001
28545 **** INVENTORY STYLE DELETION LOOKUP...                           05240001
28545              MOVE 'N'           TO IN402-PS-STR-ROW-FOUND-SW      05250010
28545              MOVE 'N'           TO IN402-PS-RETAIL-FOUND-SW       05260010
28545              PERFORM IN402-INV-PROCEED-WITH-LOOKUP                05270010
28545                  UNTIL IN402-PS-STR-FOUND                         05280010
28545                     OR IN402-PV-INVALID-KEY-INPUT                 05290010
28545              IF IN402-PS-STR-FOUND                                05300010
28545                  PERFORM IN402-INV-PRICE-OUTPUT                   05310010
28545                  PERFORM IN402-INV-ATTRIBUTES-LOOKUP              05320010
RONNA                  PERFORM IN402-INVENTORY-RECLASS                  05330010
28545                  PERFORM IN402-INV-MBS-LOOKUP                     05340010
28545                  PERFORM IN402-INV-ATTRIB-OUTPUT                  05350010
28545                  PERFORM IN402-INV-VENDOR-ATTRIB-LOOKUP           05360010
28545                  PERFORM IN402-INV-VENDOR-OUTPUT                  05370010
RONNA5             ELSE                                                 05380001
RONNA5                 PERFORM IN402-INV-UNKN-VEND-ATT-LOOKUP           05390010
RONNA5                 PERFORM IN402-INV-UNKN-VEND-OUTPUT               05400010
28545              END-IF                                               05410001
28545            END-IF                                                 05420001
28545          ELSE                                                     05421001
28545 **** VSM - SKU/UPC/UPC_ID/ITEM ATTRIBUTE LOOKUP....               05422001
28545 **** VSM - VENDOR ATTRIBUTE LOOKUP....                            05423001
28545          IF IN402-PV-ATTRIBUTE-LOOKUP                             05424010
28545            PERFORM IN402-VSM-ATTRIBUTES-LOOKUP                    05425010
J28545           PERFORM IN402-INVENTORY-RECLASS                        05426010
D28545           PERFORM IN402-VSM-PLU-DWNLD-LOOKUP                     05427010
28545            PERFORM IN402-VSM-MBS-LOOKUP                           05427110
28545            PERFORM IN402-VSM-ATTRIB-OUTPUT                        05427210
28545            PERFORM IN402-VSM-VENDOR-ATTRIB-LOOKUP                 05427310
28545            PERFORM IN402-VSM-VENDOR-OUTPUT                        05427410
28545          ELSE                                                     05427501
28545 **** VSM - DEFAULT - PRICE LOOKUP IF NOT DEFINED...               05427601
28545            MOVE 'N'                TO IN402-PS-STR-ROW-FOUND-SW   05427710
28545            MOVE 'N'                TO IN402-PS-RETAIL-FOUND-SW    05427810
28545            MOVE IN402-PV-LOC-IN-NUM   TO UPCPLS-STR-NBR           05427910
28545            PERFORM IN402-VSM-PROCEED-WITH-LOOKUP                  05428010
28545                UNTIL IN402-PS-STR-FOUND                           05429010
28545                   OR IN402-PV-INVALID-KEY-INPUT                   05429110
28545            IF IN402-PS-STR-FOUND                                  05429210
28545                PERFORM IN402-VSM-PRICE-OUTPUT                     05429310
28545                PERFORM IN402-VSM-ATTRIBUTES-LOOKUP                05429410
J28545               PERFORM IN402-INVENTORY-RECLASS                    05429510
D28545               PERFORM IN402-VSM-PLU-DWNLD-LOOKUP                 05429610
28545                PERFORM IN402-VSM-MBS-LOOKUP                       05429710
28545                PERFORM IN402-VSM-ATTRIB-OUTPUT                    05429810
28545                PERFORM IN402-VSM-VENDOR-ATTRIB-LOOKUP             05429910
28545                PERFORM IN402-VSM-VENDOR-OUTPUT                    05430010
28545            ELSE                                                   05440001
28545 ****     ATTRIBUTES NOT FOUND @ VSM AND TPPCPRC LEVEL(S) - TRY    05450001
28545 **** INVENTORY STYLE DELETION LOOKUP...                           05460001
28545              MOVE 'N'           TO IN402-PS-STR-ROW-FOUND-SW      05470010
28545              MOVE 'N'           TO IN402-PS-RETAIL-FOUND-SW       05480010
28545              PERFORM IN402-INV-PROCEED-WITH-LOOKUP                05490010
28545                  UNTIL IN402-PS-STR-FOUND                         05500010
28545                     OR IN402-PV-INVALID-KEY-INPUT                 05510010
28545              IF IN402-PS-STR-FOUND                                05520010
28545                  PERFORM IN402-INV-PRICE-OUTPUT                   05530010
28545                  PERFORM IN402-INV-ATTRIBUTES-LOOKUP              05540010
J28545                 PERFORM IN402-INVENTORY-RECLASS                  05550010
28545                  PERFORM IN402-INV-MBS-LOOKUP                     05560010
28545                  PERFORM IN402-INV-ATTRIB-OUTPUT                  05570010
28545                  PERFORM IN402-INV-VENDOR-ATTRIB-LOOKUP           05580010
28545                  PERFORM IN402-INV-VENDOR-OUTPUT                  05590010
RONNA5             ELSE                                                 05600001
RONNA5                 PERFORM IN402-INV-UNKN-VEND-ATT-LOOKUP           05610010
RONNA5                 PERFORM IN402-INV-UNKN-VEND-OUTPUT               05620010
28545              END-IF                                               05630001
28545            END-IF                                                 05640001
28545          END-IF                                                   05650001
28545 ******************************************************************05660001
28545 ** INVENTORY STYLE DELETION LOOKUP.                               05670001
28545 ** RETRIEVE SKU/UPC/UPC_ID/ITEM INFORMATION USING INVENTORY       05680001
28545 ** STYLE DELETION TABLES.                                         05690001
28545 ******************************************************************05691001
28545        ELSE                                                       05691101
28545 **** INVENTORY STYLE DELETION - DUMMY SKU....                     05691201
28545 **** INVENTORY STYLE DELETION - PRICE LOOKUP....                  05691301
28545 **** INVENTORY STYLE DELETION - SKU/UPC/UPC_ID/ITEM ATTRIB LOOKUP 05691401
28545 **** INVENTORY STYLE DELETION - VENDOR ATTRIBUTE LOOKUP....       05691501
28545          MOVE 'N'                 TO IN402-PS-STR-ROW-FOUND-SW    05691610
28545          MOVE 'N'                 TO IN402-PS-RETAIL-FOUND-SW     05691710
28545          PERFORM IN402-INV-PROCEED-WITH-LOOKUP                    05691810
28545              UNTIL IN402-PS-STR-FOUND                             05691910
28545                 OR IN402-PV-INVALID-KEY-INPUT                     05692010
28545          IF IN402-PS-STR-FOUND                                    05693010
28545              PERFORM IN402-INV-PRICE-OUTPUT                       05694010
J28545             PERFORM IN402-INVENTORY-RECLASS                      05695010
28545              PERFORM IN402-INV-ATTRIBUTES-LOOKUP                  05696010
28545              PERFORM IN402-INV-MBS-LOOKUP                         05697010
28545              PERFORM IN402-INV-ATTRIB-OUTPUT                      05698010
28545              PERFORM IN402-INV-VENDOR-ATTRIB-LOOKUP               05699010
28545              PERFORM IN402-INV-VENDOR-OUTPUT                      05700010
RONNA5         ELSE                                                     05710001
RONNA5             PERFORM IN402-INV-UNKN-VEND-ATT-LOOKUP               05720010
RONNA5             PERFORM IN402-INV-UNKN-VEND-OUTPUT                   05730010
28545          END-IF                                                   05740001
D28545       END-IF                                                     05750001
           END-IF.                                                      05760001
                                                                        05770001
      ******************************************************************05780001
      *                    LOOKUP BY SKU INPUT                          05790001
      ******************************************************************05800001
      * 1) BEGIN BY CONVERTING SKU TO INTR_UPC_ID. THIS ENSURES THE     05810001
      *    MOST-CURRENT ATTRIBUTES ARE RETRIEVED (IE. RENUMS CONVERTED) 05820001
      * 2) JOIN TUPC.UPC_ID WITH TSKXREF.INTR_UPC_ID. THIS ENSURES THE  05830001
      *    CURRENT ACTIVE UPC_NBR WILL BE RETRIEVED.                    05840001
      * 3) THE KOHLS UPC-NBR (IE. 400...) WILL CONTAIN THE CURRENT SKU  05850001
      *    EMBEDDED WITHIN THE UPC.                                     05860001
      *                                                                 05870001
      * SAMPLE SKU INPUT - 74411184  >>>  TUPC.UPC_NBR 400044871848     05880001
      *                   (RENUMBER)     CURRENT SKU = ---04487184-     05890001
      ******************************************************************05900001
       IN402-LOOKUP-BY-SKU.                                             05910010
                                                                        05920001
           EXEC SQL                                                     05930001
               SELECT INTR_UPC_ID,                                      05940001
                      ITM_NBR,                                          05950001
E28545                SKU_STAT_CDE                                      05960001
                 INTO :SKXREF-INTR-UPC-ID                               05970001
                     ,:SKXREF-ITM-NBR                                   05980001
E28545               ,:SKXREF-SKU-STAT-CDE                              05990001
                 FROM TSKXREF                                           06000001
               WHERE SKU = :IN402-PV-WORK-SKU                           06010010
               WITH UR                                                  06020001
           END-EXEC.                                                    06030001
                                                                        06040001
           EVALUATE TRUE                                                06050001
               WHEN SQLCODE = 0                                         06060001
D28545             SET IN402-PV-NOT-FOUND     TO TRUE                   06070010
D28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   06080010
E28545             PERFORM IN402-RENUMBER-SKU                           06090010
               WHEN SQLCODE = +100                                      06100001
28545              MOVE ZEROS  TO SKXREF-INTR-UPC-ID                    06110001
28545              MOVE ZEROS  TO SKXREF-ITM-NBR                        06120001
E28545             PERFORM IN402-RENUMBER-SKU                           06130010
D28545             SET IN402-PV-NOT-FOUND     TO TRUE                   06140010
D28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   06150010
               WHEN OTHER                                               06160001
28545              MOVE ZEROS  TO SKXREF-INTR-UPC-ID                    06170001
28545              MOVE ZEROS  TO SKXREF-ITM-NBR                        06180001
E28545             PERFORM IN402-RENUMBER-SKU                           06190010
D28545             SET IN402-PV-SQL-ERROR          TO TRUE              06200010
D28545             SET IN402-PV-ATT-SQL-ERROR TO TRUE                   06210010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   06220010
D28545             SET IN402-PV-TRY-SKU-LOOKUP     TO TRUE              06230010
D28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              06240010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              06250010
D28545             STRING '  PARA: IN402-LOOKUP-BY-SKU - '              06260010
D28545                                       DELIMITED BY SIZE          06270001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             06280010
D28545                    '  ' DELIMITED BY SIZE                        06290001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         06291010
D28545                    '  ' DELIMITED BY SIZE                        06292001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        06293010
D28545                    '  ' DELIMITED BY SIZE                        06294001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         06295010
D28545                    '  ' DELIMITED BY SIZE                        06296001
D28545                              INTO IN402-PV-PARAGRAPH             06297010
           END-EVALUATE                                                 06298001
                                                                        06299001
           IF IN402-PV-NOT-FOUND                                        06300010
               EXEC SQL                                                 06310001
                   SELECT SKU                                           06320001
                         ,UPC_NBR                                       06330001
                         ,ITM_NBR                                       06340001
                         ,A.INTR_UPC_ID                                 06350001
                         ,DEPT                                          06360001
                         ,CLASS                                         06370001
                         ,SUBCLASS                                      06380001
                     INTO :SKXREF-SKU                                   06390001
                         ,:UPC-UPC-NBR                                  06400001
                         ,:SKXREF-ITM-NBR                               06410001
                         ,:SKXREF-INTR-UPC-ID                           06420001
                         ,:SKXREF-DEPT                                  06430001
                         ,:SKXREF-CLASS                                 06440001
                         ,:SKXREF-SUBCLASS                              06450001
                     FROM                                               06460001
                          TSKXREF A                                     06470001
                         ,TUPC    B                                     06480001
                    WHERE A.INTR_UPC_ID = :SKXREF-INTR-UPC-ID           06490001
                      AND A.INTR_UPC_ID = UPC_ID                        06500001
                      AND SKU_STAT_CDE NOT IN ('00','98')               06510001
                    WITH UR                                             06520001
               END-EXEC                                                 06530001
                                                                        06540001
               EVALUATE TRUE                                            06550001
                   WHEN SQLCODE = 0                                     06560001
D28545                 SET IN402-PV-FOUND-AS-REQUESTED TO TRUE          06570010
D28545                 SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE          06580010
D28545                 MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE          06590010
D28545                 MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE          06600010
D28545                 MOVE SPACES      TO IN402-PV-PARAGRAPH           06610010
                   WHEN SQLCODE = +100                                  06620001
                       SET IN402-PV-NOT-FOUND TO TRUE                   06630010
                       SET IN402-PV-ATT-NOT-FOUND TO TRUE               06640010
D28545                 SET IN402-PV-TRY-SKU-LOOKUP     TO TRUE          06650010
D28545                 MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE          06660010
D28545                 MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE          06670010
D28545                 STRING '  PARA: IN402-LOOKUP-BY-SKU - '          06680010
D28545                                       DELIMITED BY SIZE          06690001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             06700010
D28545                    '  ' DELIMITED BY SIZE                        06710001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         06720010
D28545                    '  ' DELIMITED BY SIZE                        06730001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        06740010
D28545                    '  ' DELIMITED BY SIZE                        06750001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         06760010
D28545                    '  ' DELIMITED BY SIZE                        06770001
D28545                              INTO IN402-PV-PARAGRAPH             06780010
                   WHEN OTHER                                           06790001
D28545                 SET IN402-PV-SQL-ERROR          TO TRUE          06800010
D28545                 SET IN402-PV-ATT-SQL-ERROR TO TRUE               06810010
RONNA                  SET IN402-PV-DBV-SQL-ERROR TO TRUE               06820010
D28545                 SET IN402-PV-TRY-SKU-LOOKUP     TO TRUE          06830010
D28545                 MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE          06840010
D28545                 MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE          06850010
D28545                 STRING '  PARA: IN402-LOOKUP-BY-SKU - '          06860010
D28545                                       DELIMITED BY SIZE          06870001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             06880010
D28545                    '  ' DELIMITED BY SIZE                        06890001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         06900010
D28545                    '  ' DELIMITED BY SIZE                        06910001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        06920010
D28545                    '  ' DELIMITED BY SIZE                        06930001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         06940010
D28545                    '  ' DELIMITED BY SIZE                        06950001
D28545                              INTO IN402-PV-PARAGRAPH             06960010
               END-EVALUATE                                             06970001
           ELSE                                                         06980001
D28545         SET IN402-PV-FOUND-AS-REQUESTED TO TRUE                  06990010
D28545         SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE                  07000010
D28545         MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE                  07010010
D28545         MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE                  07020010
D28545         MOVE SPACES      TO IN402-PV-PARAGRAPH                   07030010
           END-IF.                                                      07040001
                                                                        07050001
E28545******************************************************************07060001
E28545* IN402-RENUMBER-SKU.                                             07070010
E28545******************************************************************07080001
E28545 IN402-RENUMBER-SKU.                                              07090010
E28545                                                                  07100001
E28545      IF SKXREF-SKU-STAT-CDE EQUAL '98'                           07110001
E28545          MOVE SKXREF-SKU-STAT-CDE                                07120001
E28545                            TO IN402-PV-ATT-RENUM-STAT-CDE        07130010
E28545          MOVE SKXREF-SKU-STAT-CDE                                07140001
E28545                            TO IN402-PV-PRC-RENUM-STAT-CDE        07150010
E28545          SET IN402-PS-RENUMBER-SKU TO TRUE                       07160010
E28545          SET IN402-PV-RENUMBER-SKU TO TRUE                       07170010
E28545      ELSE                                                        07180001
E28545          MOVE SPACES TO IN402-PV-PRC-RENUM-STAT-CDE              07190010
E28545          MOVE SPACES TO IN402-PV-ATT-RENUM-STAT-CDE              07200010
E28545      END-IF.                                                     07210001
E28545                                                                  07220001
D28545******************************************************************07230001
D28545* IN402-DUMMY-SKU-LOOKUP.                                         07240010
D28545******************************************************************07250001
D28545 IN402-DUMMY-SKU-LOOKUP.                                          07260010
D28545                                                                  07270001
W34517*    MOVE IN402-PV-DUMB-SKU-X (1:3) TO MDSEAR-DEPT-NBR.           07280010
W34517     IF IN402-PV-DEPT-IN = SPACES                                 07280110
W34517         MOVE IN402-PV-DUMB-SKU-X (1:3) TO MDSEAR-DEPT-NBR        07280310
W34517     ELSE                                                         07280405
W34517         MOVE IN402-PV-DEPT-IN-3X       TO MDSEAR-DEPT-NBR        07280610
W34517     END-IF.                                                      07280705
D28545                                                                  07290001
D28545     STRING IN402-PV-DUMB-SKU-X (4:1) DELIMITED BY SIZE           07300010
D28545            '0' DELIMITED BY SIZE                                 07310001
D28545                                    INTO MDSEAR-MAJ-CL-NBR.       07320001
D28545                                                                  07320101
D28545     STRING '0' DELIMITED BY SIZE                                 07320201
D28545            IN402-PV-DUMB-SKU-X (4:2) DELIMITED BY SIZE           07320310
D28545                                    INTO MDSEAR-SUB-CL-NBR.       07320401
D28545                                                                  07320501
D28545     EXEC SQL                                                     07320601
D28545         SELECT A.DEPT_NBR                                        07320701
D28545               ,A.MAJ_CL_NBR                                      07320801
D28545               ,A.SUB_CL_NBR                                      07320901
D28545               ,A.MDSEAR_DKEY                                     07321001
D28545         INTO :MDSEAR-DEPT-NBR                                    07322001
D28545             ,:MDSEAR-MAJ-CL-NBR                                  07323001
D28545             ,:MDSEAR-SUB-CL-NBR                                  07324001
D28545             ,:MDSEAR-DKEY                                        07325001
D28545         FROM TMDSEAR A                                           07326001
D28545             ,TAPLAVL B                                           07327001
D28545         WHERE (A.DEPT_NBR    = :MDSEAR-DEPT-NBR)                 07328001
D28545           AND (A.MAJ_CL_NBR  = :MDSEAR-MAJ-CL-NBR)               07329001
D28545           AND (A.SUB_CL_NBR  = :MDSEAR-SUB-CL-NBR)               07330001
D28545           AND (A.MDSELV_CDE  = 'SCL')                            07340001
D28545           AND (A.OPERCO_NBR  = '03')                             07350001
D28545           AND (B.APLSYS_CDE  = 'IN')                             07360001
D28545           AND (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)                   07370001
D28545           AND (CURRENT DATE     BETWEEN                          07380001
D28545                CHAR(B.MDSEAR_STRT_DTE,ISO)  AND                  07390001
D28545                CHAR(B.MDSEAR_END_DTE,ISO))                       07400001
D28545           AND (CURRENT DATE     BETWEEN                          07410001
D28545                CHAR(A.STRT_DTE,ISO)         AND                  07420001
D28545                CHAR(A.END_DTE,ISO))                              07430001
D28545          WITH UR                                                 07440001
D28545     END-EXEC.                                                    07450001
D28545                                                                  07460001
D28545     EVALUATE TRUE                                                07470001
D28545         WHEN SQLCODE = 0                                         07480001
D28545           SET IN402-PS-DUMMY-SKU          TO TRUE                07490010
D28545           SET IN402-PV-FOUND-AS-REQUESTED TO TRUE                07500010
D28545           SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE                07510010
D28545           MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE                07520010
D28545           MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE                07530010
D28545           IF IN402-PV-DUMMY-SKU                                  07540010
D28545             SET IN402-PV-DUMMY-SKU-VALID  TO TRUE                07550010
D28545           ELSE                                                   07560001
D28545             SET IN402-PV-DUMMY-UPC-VALID  TO TRUE                07570010
D28545           END-IF                                                 07580001
D28545           MOVE SPACES      TO IN402-PV-PARAGRAPH                 07590010
A28545                                                                  07600001
A28545           MOVE MDSEAR-MAJ-CL-NBR       TO IN402-PV-WORK-MCL-2X   07610010
A28545           MOVE IN402-PV-WORK-MCL-2X-9  TO SKXREF-CLASS           07620010
A28545                                                                  07630001
A28545           MOVE MDSEAR-DEPT-NBR         TO IN402-PV-WORK-DEPT-3X  07640010
A28545           MOVE IN402-PV-WORK-DEPT-3X-9 TO SKXREF-DEPT            07650010
A28545                                                                  07660001
A28545           MOVE MDSEAR-SUB-CL-NBR       TO IN402-PV-WORK-SCL-3X   07670010
A28545           MOVE IN402-PV-WORK-SCL-3X-9  TO SKXREF-SUBCLASS        07680010
A28545                                                                  07690001
A28545           PERFORM IN402-VSM-MBS-LOOKUP                           07700010
A28545                                                                  07710001
D28545         WHEN SQLCODE = +100                                      07720001
D28545           SET IN402-PV-NOT-FOUND       TO TRUE                   07730010
D28545           SET IN402-PV-ATT-NOT-FOUND   TO TRUE                   07740010
D28545           MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE                07750010
D28545           MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE                07760010
D28545           IF IN402-PV-DUMMY-SKU                                  07770010
D28545             SET IN402-PV-DUMMY-SKU-ERR    TO TRUE                07780010
D28545           ELSE                                                   07790001
D28545             SET IN402-PV-DUMMY-UPC-ERR    TO TRUE                07800010
D28545           END-IF                                                 07810001
D28545           STRING '  PARA: IN402-DUMMY-SKU-LOOKUP - '             07820010
D28545                                   DELIMITED BY SIZE              07830001
D28545                IN402-PV-SKU-IN DELIMITED BY SIZE                 07840010
D28545                '  ' DELIMITED BY SIZE                            07850001
D28545                IN402-PV-UPC-NBR-IN DELIMITED BY SIZE             07860010
D28545                '  ' DELIMITED BY SIZE                            07870001
D28545                IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE            07880010
D28545                '  ' DELIMITED BY SIZE                            07890001
D28545                IN402-PV-ITM-NBR-IN DELIMITED BY SIZE             07900010
D28545                '  ' DELIMITED BY SIZE                            07910001
D28545                          INTO IN402-PV-PARAGRAPH                 07920010
D28545         WHEN SQLCODE = -904                                      07930001
D28545         WHEN SQLCODE = -913                                      07940001
D28545           SET IN402-PV-DEADLOCK-PRICE  TO TRUE                   07950010
D28545           SET IN402-PV-DEADLOCK-ATTRIB TO TRUE                   07960010
D28545           MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE                07970010
D28545           MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE                07980010
D28545           STRING '  PARA: IN402-DUMMY-SKU-LOOKUP - '             07990010
D28545                                   DELIMITED BY SIZE              08000001
D28545                IN402-PV-SKU-IN DELIMITED BY SIZE                 08010010
D28545                '  ' DELIMITED BY SIZE                            08020001
D28545                IN402-PV-UPC-NBR-IN DELIMITED BY SIZE             08030010
D28545                '  ' DELIMITED BY SIZE                            08040001
D28545                IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE            08050010
D28545                '  ' DELIMITED BY SIZE                            08060001
D28545                IN402-PV-ITM-NBR-IN DELIMITED BY SIZE             08070010
D28545                '  ' DELIMITED BY SIZE                            08080001
D28545                          INTO IN402-PV-PARAGRAPH                 08090010
D28545         WHEN SQLWARN NOT = SPACE                                 08100001
D28545         WHEN SQLCODE NOT = ZERO                                  08110001
D28545           SET IN402-PV-SQL-ERROR TO TRUE                         08120010
D28545           SET IN402-PV-ATT-SQL-ERROR TO TRUE                     08130010
RONNA            SET IN402-PV-DBV-SQL-ERROR TO TRUE                     08140010
D28545           MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE                08150010
D28545           MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE                08160010
D28545           IF IN402-PV-DUMMY-SKU                                  08170010
D28545             SET IN402-PV-DUMMY-SKU-ERR    TO TRUE                08180010
D28545           ELSE                                                   08190001
D28545             SET IN402-PV-DUMMY-UPC-ERR    TO TRUE                08200010
D28545           END-IF                                                 08210001
D28545           STRING '  PARA: IN402-DUMMY-SKU-LOOKUP - '             08220010
D28545                                   DELIMITED BY SIZE              08230001
D28545                IN402-PV-SKU-IN DELIMITED BY SIZE                 08240010
D28545                '  ' DELIMITED BY SIZE                            08250001
D28545                IN402-PV-UPC-NBR-IN DELIMITED BY SIZE             08260010
D28545                '  ' DELIMITED BY SIZE                            08270001
D28545                IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE            08280010
D28545                '  ' DELIMITED BY SIZE                            08290001
D28545                IN402-PV-ITM-NBR-IN DELIMITED BY SIZE             08300010
D28545                '  ' DELIMITED BY SIZE                            08310001
D28545                          INTO IN402-PV-PARAGRAPH                 08320010
D28545     END-EVALUATE.                                                08330001
D28545                                                                  08340001
D28545******************************************************************08350001
D28545* IN402-DUMMY-SKU-ATT-LOOKUP.                                     08360010
D28545******************************************************************08370001
D28545 IN402-DUMMY-SKU-ATT-LOOKUP.                                      08380010
D28545                                                                  08390001
D28545     MOVE MDSEAR-DEPT-NBR         TO VNDDPT-DEPT-NBR.             08400001
RONNA      IF IN402-PV-ENT-ID-IN = SPACES                               08410010
D28545        MOVE 5161                 TO VNDDPT-ENT-ID                08420001
RONNA      ELSE                                                         08430001
RONNA         MOVE IN402-PV-ENT-ID-IN-9 TO VNDDPT-ENT-ID                08440010
RONNA      END-IF.                                                      08450001
D28545                                                                  08460001
D28545     EXEC SQL                                                     08470001
D28545         SELECT F.DEPT_NBR                                        08480001
D28545               ,F.INHOUSE_NBR                                     08490001
D28545               ,E.DUN_NBR                                         08500001
D28545         INTO :VNDDPT-DEPT-NBR                                    08510001
D28545             ,:VNDDPT-INHOUSE-NBR                                 08520001
D28545             ,:EXTENT-DUN-NBR                                     08530001
D28545         FROM TVNDDPT F                                           08540001
D28545             ,TEXTENT E                                           08550001
D28545         WHERE F.ENT_ID = E.ENT_ID                                08560001
D28545           AND F.ENT_ID = :VNDDPT-ENT-ID                          08570001
D28545           AND F.DEPT_NBR = :VNDDPT-DEPT-NBR                      08580001
D28545         WITH UR                                                  08590001
D28545     END-EXEC.                                                    08600001
D28545                                                                  08610001
D28545     EVALUATE TRUE                                                08620001
D28545         WHEN SQLCODE = 0                                         08630001
D28545             SET IN402-PV-FOUND-AS-REQUESTED TO TRUE              08640010
D28545             SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE              08650010
RONNA              SET IN402-PV-DBV-FOUND-WITH-ASSMPT TO TRUE           08660010
D28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              08670010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              08680010
RONNA              MOVE SQLCODE     TO IN402-PV-DBV-SQLCDE              08690010
D28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               08700010
D28545         WHEN SQLCODE = +100                                      08710001
D28545             MOVE ZEROS       TO VNDDPT-DEPT-NBR                  08720001
D28545             MOVE ZEROS       TO VNDDPT-INHOUSE-NBR               08730001
D28545             MOVE ZEROS       TO EXTENT-DUN-NBR                   08740001
I28545             SET IN402-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           08750010
I28545             SET IN402-PV-FOUND-WITH-ASSUMPTION TO TRUE           08760010
RONNA              SET IN402-PV-DBV-FOUND-WITH-ASSMPT TO TRUE           08770010
D28545             STRING '  PARA: IN402-DUMMY-SKU-ATT-LOOKUP - '       08780010
D28545                                       DELIMITED BY SIZE          08790001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             08800010
D28545                    '  ' DELIMITED BY SIZE                        08810001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         08820010
D28545                    '  ' DELIMITED BY SIZE                        08830001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        08840010
D28545                    '  ' DELIMITED BY SIZE                        08850001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         08851010
D28545                    '  ' DELIMITED BY SIZE                        08852001
D28545                              INTO IN402-PV-PARAGRAPH             08853010
D28545         WHEN OTHER                                               08854001
D28545             MOVE ZEROS       TO VNDDPT-DEPT-NBR                  08855001
D28545             MOVE ZEROS       TO VNDDPT-INHOUSE-NBR               08856001
D28545             MOVE ZEROS       TO EXTENT-DUN-NBR                   08857001
I28545             SET IN402-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           08858010
I28545             SET IN402-PV-FOUND-WITH-ASSUMPTION TO TRUE           08859010
D28545             STRING '  PARA: IN402-DUMMY-SKU-ATT-LOOKUP - '       08860010
D28545                                       DELIMITED BY SIZE          08870001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             08880010
D28545                    '  ' DELIMITED BY SIZE                        08890001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         08900010
D28545                    '  ' DELIMITED BY SIZE                        08910001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        08920010
D28545                    '  ' DELIMITED BY SIZE                        08930001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         08940010
D28545                    '  ' DELIMITED BY SIZE                        08950001
D28545                              INTO IN402-PV-PARAGRAPH             08960010
D28545     END-EVALUATE.                                                08970001
D28545                                                                  08980001
D28545******************************************************************08990001
D28545* IN402-DUMMY-SKU-LOOKUP-ATT-OUT.                                 09000010
D28545******************************************************************09010001
D28545 IN402-DUMMY-SKU-LOOKUP-ATT-OUT.                                  09020010
D28545                                                                  09030001
D28545     MOVE IN402-PV-WORK-SKU       TO IN402-ATT-SKU-OUT.           09040010
D28545     MOVE IN402-PV-UPC-NBR-IN-NUM TO IN402-ATT-UPC-OUT.           09050010
D28545     MOVE IN402-PV-UPC-ID-IN      TO IN402-ATT-UPCID-OUT.         09060010
D28545     MOVE IN402-PV-ITM-NBR-IN-NUM TO IN402-ATT-ITM-NBR-OUT.       09070010
D28545                                                                  09080001
D28545     MOVE MDSEAR-DEPT-NBR         TO IN402-ATT-DEPT-OUT.          09090010
D28545     MOVE MDSEAR-MAJ-CL-NBR       TO IN402-ATT-MCL-OUT.           09100010
D28545     MOVE MDSEAR-SUB-CL-NBR       TO IN402-ATT-SCL-OUT.           09110010
D28545     MOVE '20'                    TO IN402-ATT-STATUS-OUT.        09120010
D28545                                                                  09130001
D28545     MOVE MDSEAR-DKEY             TO IN402-ATT-MDEAR-ID-OUT.      09140010
D28545     MOVE ZEROS                   TO IN402-ATT-STYL-ID-OUT.       09150010
D28545     MOVE ZEROS                   TO IN402-ATT-VS-ID-OUT.         09160010
D28545     MOVE ZEROS                   TO IN402-ATT-VS-NBR-OUT.        09170010
D28545                                                                  09180001
D28545     MOVE VNDDPT-ENT-ID           TO IN402-ATT-ENT-ID-OUT.        09190010
RONNA      MOVE 2230                    TO IN402-ATT-LBL-SEQ-NBR-OUT.   09200010
D28545     MOVE EXTENT-DUN-NBR          TO IN402-ATT-DUNS-NBR-OUT.      09210010
D28545     MOVE VNDDPT-INHOUSE-NBR      TO IN402-ATT-INHSE-NBR-OUT.     09220010
D28545     MOVE 'Y'                     TO IN402-ATT-PLU-DWNLD-IND.     09230010
D28545                                                                  09240001
BV    ******************************************************************09250001
BV    * IN402-DUMMY-SKU-VEND-ATT-LOOK.                                  09260010
BV    ******************************************************************09270001
BV     IN402-DUMMY-SKU-VEND-ATT-LOOK.                                   09280010
BV                                                                      09290001
RONNA *    SET BV003-PV-SKU-DEPT-LOOKUP TO TRUE.                        09300011
RONNA *    DUMMY SKU IS ALWAYS AN UNKNOWN BRAND.                        09310001
RONNA      SET BV003-PV-BRND-VND-DPT-LOOKUP TO TRUE.                    09320011
BV                                                                      09330001
BV         MOVE IN402-PV-EFF-DTE-IN   TO BV003-PV-EFF-DTE-IN.           09340011
RONNA *    MOVE IN402-PV-WORK-SKU     TO BV003-PV-SKU-IN-9.             09350011
RONNA      IF IN402-PV-ENT-ID-IN = SPACES                               09360010
BV            MOVE 5161               TO BV003-PV-ENT-ID-IN-9           09370011
RONNA      ELSE                                                         09380001
RONNA         MOVE IN402-PV-ENT-ID-IN-9                                 09390010
RONNA                                 TO BV003-PV-ENT-ID-IN-9           09400011
RONNA      END-IF.                                                      09410001
RONNA                                                                   09420001
BV         MOVE MDSEAR-DEPT-NBR       TO BV003-PV-DEPT-IN-9.            09430011
RONNA      MOVE 2230                  TO BV003-PV-BRAND-IN-9.           09440011
BV                                                                      09450001
BV         PERFORM BV003-LOOKUP-MAIN.                                   09460011
BV         IF BV003-PV-FOUND-REL-OR-UNK    OR                           09470011
RONNA         BV003-PAST-OR-FUT-DBV-REL-FND                             09480011
BV             SET IN402-PS-ATTR-FOUND   TO TRUE                        09490010
RONNA          SET IN402-PV-DBV-FOUND    TO TRUE                        09491010
RONNA          SET IN402-PS-BVUTIL-FOUND TO TRUE                        09492010
RONNA         IF IN402-PS-DBV-NO-ASSUMP                                 09493010
RONNA            SET IN402-PV-DBV-FOUND-AS-RQSTD TO TRUE                09494010
RONNA         ELSE                                                      09495001
RONNA            SET IN402-PV-DBV-FOUND-WITH-ASSMPT TO TRUE             09496010
RONNA         END-IF                                                    09497001
BV         ELSE                                                         09498001
BV             MOVE ZEROS       TO BV003-PV-DEPT-OUT                    09499011
BV             MOVE ZEROS       TO BV003-PV-ENT-ID-OUT                  09500011
BV             MOVE ZEROS       TO BV003-PV-RLTNSHP-ID-OUT              09500111
BV             MOVE ZEROS       TO BV003-PV-BRAND-OUT                   09500211
BV             SET IN402-PV-ATT-NOT-FOUND TO TRUE                       09500310
BV             SET IN402-PV-BRAND-LOOKUP  TO TRUE                       09500410
BV             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                      09500510
RONNA          SET IN402-PV-DBV-NOT-FOUND TO TRUE                       09500610
BV             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE                  09500710
RONNA                              IN402-PV-DBV-SQLCDE                  09500810
BV             STRING '  PARA: IN402-DUMMY-SKU-VEND-ATT-LOOK - '        09500910
BV                                       DELIMITED BY SIZE              09501001
BV                    IN402-PV-SKU-IN DELIMITED BY SIZE                 09501110
BV                    '  ' DELIMITED BY SIZE                            09501201
BV                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE             09501310
BV                    '  ' DELIMITED BY SIZE                            09501401
BV                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE            09501510
BV                    '  ' DELIMITED BY SIZE                            09501601
BV                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE             09501710
BV                    '  ' DELIMITED BY SIZE                            09501801
BV                              INTO IN402-PV-PARAGRAPH                 09501910
BV         END-IF.                                                      09502001
BV                                                                      09502101
BV    ******************************************************************09502201
BV    * IN402-DUMMY-SKU-VEND-OUTPUT.                                    09502310
BV    ******************************************************************09502401
BV     IN402-DUMMY-SKU-VEND-OUTPUT.                                     09502510
BV                                                                      09502601
BV         MOVE IN402-PV-WORK-SKU       TO IN402-VND-SKU-OUT.           09502710
BV         MOVE IN402-PV-UPC-NBR-IN-NUM TO IN402-VND-UPC-OUT.           09502810
BV         MOVE IN402-PV-UPC-ID-IN      TO IN402-VND-UPCID-OUT.         09502910
BV         MOVE IN402-PV-ITM-NBR-IN-NUM TO IN402-VND-ITM-NBR-OUT.       09503010
BV                                                                      09503101
BV         MOVE BV003-PV-DEPT-OUT       TO IN402-VND-DEPT-OUT.          09503211
BV         MOVE BV003-PV-ENT-ID-OUT     TO IN402-VND-ENT-ID-OUT.        09503311
BV         MOVE BV003-PV-RLTNSHP-ID-OUT TO IN402-VND-ML-LO-MDSE-LVL-ID. 09503411
BV         MOVE BV003-PV-BRAND-OUT      TO IN402-VND-LBL-SEQ-NBR.       09503511
BV                                                                      09503601
      ******************************************************************09503701
      * LOOKUP BY UPC-NBR INPUT                                         09503801
      * 1) GET CURRENT INTR_UPC_ID AND UPC NUMBER                       09503901
      * 2) IF SUCCESSFUL, GET SKU ATTR AND CURRENT ITEM-NBR             09504001
      ******************************************************************09504101
       IN402-LOOKUP-BY-UPC.                                             09504210
                                                                        09504301
           PERFORM IN402-LOOKUP-UPC-NBR.                                09504410
                                                                        09504501
           EVALUATE TRUE                                                09504601
           WHEN SQLCODE = 0                                             09504701
               MOVE UPC-INTR-UPC-ID TO IN402-PV-WORK-UPC-ID             09504810
               PERFORM IN402-LOOKUP-BY-UPC-ID                           09504910
D28545     WHEN SQLCODE = +100                                          09505001
D28545         SET IN402-PV-NOT-FOUND          TO TRUE                  09505110
D28545         SET IN402-PV-ATT-NOT-FOUND      TO TRUE                  09505210
D28545         SET IN402-PV-TRY-UPC-NBR-LOOKUP TO TRUE                  09505310
D28545         MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE                  09505410
D28545         MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE                  09505510
D28545         STRING '  PARA: IN402-LOOKUP-BY-UPC - '                  09505610
D28545                                   DELIMITED BY SIZE              09505701
D28545                IN402-PV-SKU-IN DELIMITED BY SIZE                 09505810
D28545                '  ' DELIMITED BY SIZE                            09505901
D28545                IN402-PV-UPC-NBR-IN DELIMITED BY SIZE             09506010
D28545                '  ' DELIMITED BY SIZE                            09507001
D28545                IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE            09508010
D28545                '  ' DELIMITED BY SIZE                            09509001
D28545                IN402-PV-ITM-NBR-IN DELIMITED BY SIZE             09510010
D28545                '  ' DELIMITED BY SIZE                            09520001
D28545                          INTO IN402-PV-PARAGRAPH                 09530010
D28545     WHEN OTHER                                                   09540001
D28545         SET IN402-PV-SQL-ERROR          TO TRUE                  09550010
D28545         SET IN402-PV-ATT-SQL-ERROR      TO TRUE                  09560010
RONNA          SET IN402-PV-DBV-SQL-ERROR TO TRUE                       09570010
D28545         SET IN402-PV-TRY-UPC-NBR-LOOKUP TO TRUE                  09580010
D28545         MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE                  09590010
D28545         MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE                  09600010
D28545         STRING '  PARA: IN402-LOOKUP-BY-UPC - '                  09610010
D28545                                   DELIMITED BY SIZE              09620001
D28545                IN402-PV-SKU-IN DELIMITED BY SIZE                 09630010
D28545                '  ' DELIMITED BY SIZE                            09640001
D28545                IN402-PV-UPC-NBR-IN DELIMITED BY SIZE             09650010
D28545                '  ' DELIMITED BY SIZE                            09660001
D28545                IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE            09670010
D28545                '  ' DELIMITED BY SIZE                            09680001
D28545                IN402-PV-ITM-NBR-IN DELIMITED BY SIZE             09690010
D28545                '  ' DELIMITED BY SIZE                            09700001
D28545                          INTO IN402-PV-PARAGRAPH                 09710010
           END-EVALUATE.                                                09720001
                                                                        09730001
      ******************************************************************09740001
      * LOOKUP CURRENT UPC NUMBER & INTERNAL UPC-ID                     09750001
      * - FIRST CALL CHANGES ANY RENUMBERED UPCS TO CURRENT KOHLS UPC   09760001
      *   AND RETRIEVES TO CURRENT INTR_UPC_ID TO USE AGAINST TSKXREF   09770001
      ******************************************************************09780001
       IN402-LOOKUP-UPC-NBR.                                            09790010
                                                                        09800001
           EXEC SQL                                                     09810001
I28545          SELECT B.UPC_NBR ,                                      09820001
I28545                 A.INTR_UPC_ID                                    09830001
I28545           INTO :UPC-UPC-NBR                                      09840001
I28545               ,:UPC-INTR-UPC-ID                                  09850001
I28545           FROM TSKXREF A,                                        09860001
I28545                TUPCSKU B                                         09870001
I28545           WHERE B.UPC_NBR = :IN402-PV-WORK-UPC-NBR               09880010
I28545             AND B.ITEM_NBR = A.ITM_NBR                           09890001
I28545         WITH UR                                                  09900001
           END-EXEC.                                                    09910001
                                                                        09920001
D28545     EVALUATE TRUE                                                09930001
D28545         WHEN SQLCODE = 0                                         09940001
D28545             SET IN402-PV-FOUND-AS-REQUESTED TO TRUE              09950010
D28545             SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE              09960010
D28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              09970010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              09980010
D28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               09990010
D28545         WHEN SQLCODE = +100                                      10000001
D28545             SET IN402-PV-NOT-FOUND          TO TRUE              10010010
D28545             SET IN402-PV-ATT-NOT-FOUND      TO TRUE              10020010
D28545             SET IN402-PV-TRY-UPC-NBR-LOOKUP TO TRUE              10030010
D28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              10040010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              10050010
D28545             STRING '  PARA: IN402-LOOKUP-UPC-NBR - '             10060010
D28545                                       DELIMITED BY SIZE          10070001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             10080010
D28545                    '  ' DELIMITED BY SIZE                        10090001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         10100010
D28545                    '  ' DELIMITED BY SIZE                        10110001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        10120010
D28545                    '  ' DELIMITED BY SIZE                        10130001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         10140010
D28545                    '  ' DELIMITED BY SIZE                        10150001
D28545                              INTO IN402-PV-PARAGRAPH             10160010
D28545         WHEN OTHER                                               10170001
D28545             SET IN402-PV-SQL-ERROR          TO TRUE              10180010
D28545             SET IN402-PV-ATT-SQL-ERROR      TO TRUE              10190010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   10200010
D28545             SET IN402-PV-TRY-UPC-NBR-LOOKUP TO TRUE              10210010
D28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              10220010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              10230010
D28545             STRING '  PARA: IN402-LOOKUP-UPC-NBR - '             10240010
D28545                                       DELIMITED BY SIZE          10250001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             10260010
D28545                    '  ' DELIMITED BY SIZE                        10270001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         10280010
D28545                    '  ' DELIMITED BY SIZE                        10290001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        10300010
D28545                    '  ' DELIMITED BY SIZE                        10310001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         10320010
D28545                    '  ' DELIMITED BY SIZE                        10330001
D28545                              INTO IN402-PV-PARAGRAPH             10340010
D28545     END-EVALUATE.                                                10350001
D28545                                                                  10360001
      ******************************************************************10370001
      * LOOKUP BY INTERNAL UPC-ID INPUT                                 10380001
      ******************************************************************10390001
       IN402-LOOKUP-BY-UPC-ID.                                          10400010
                                                                        10410001
E28545*** CHECK THE UPC-ID STATUS. (IS THE ITEM RENUMBERD?)             10420001
E28545     EXEC SQL                                                     10430001
H28545         SELECT DISTINCT INTR_UPC_ID,                             10440001
E28545                SKU_STAT_CDE                                      10450001
E28545           INTO :SKXREF-INTR-UPC-ID                               10460001
E28545               ,:SKXREF-SKU-STAT-CDE                              10470001
E28545           FROM TSKXREF                                           10480001
E28545         WHERE INTR_UPC_ID = :IN402-PV-WORK-UPC-ID                10490010
E28545           AND SKU_STAT_CDE = '98'                                10500001
E28545         WITH UR                                                  10510001
E28545     END-EXEC.                                                    10520001
E28545                                                                  10530001
E28545     EVALUATE TRUE                                                10540001
E28545         WHEN SQLCODE = 0                                         10550001
E28545             SET IN402-PV-NOT-FOUND     TO TRUE                   10560010
E28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   10570010
E28545             PERFORM IN402-RENUMBER-SKU                           10580010
E28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              10590010
E28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              10600010
E28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               10610010
E28545         WHEN SQLCODE = +100                                      10620001
E28545             SET IN402-PV-NOT-FOUND     TO TRUE                   10630010
E28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   10640010
E28545             PERFORM IN402-RENUMBER-SKU                           10650010
E28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              10660010
E28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              10661010
E28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               10662010
E28545         WHEN OTHER                                               10663001
E28545             SET IN402-PV-SQL-ERROR          TO TRUE              10664010
E28545             SET IN402-PV-ATT-SQL-ERROR TO TRUE                   10665010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   10666010
E28545             SET IN402-PV-TRY-SKU-LOOKUP     TO TRUE              10667010
E28545             PERFORM IN402-RENUMBER-SKU                           10668010
E28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              10669010
E28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              10670010
E28545             STRING '  PARA: IN402-LOOKUP-BY-UPC-ID (1) - '       10671010
E28545                                       DELIMITED BY SIZE          10671101
E28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             10671210
E28545                    '  ' DELIMITED BY SIZE                        10671301
E28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         10671410
E28545                    '  ' DELIMITED BY SIZE                        10671501
E28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        10671610
E28545                    '  ' DELIMITED BY SIZE                        10671701
E28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         10671810
E28545                    '  ' DELIMITED BY SIZE                        10671901
E28545                              INTO IN402-PV-PARAGRAPH             10672010
E28545     END-EVALUATE                                                 10673001
E28545                                                                  10674001
E28545*** VALIDATE UPC-ID.....                                          10674101
E28545     IF IN402-PV-NOT-FOUND                                        10674210
             EXEC SQL                                                   10674301
                 SELECT SKU                                             10674401
                       ,UPC_NBR                                         10674501
                       ,ITM_NBR                                         10674601
                       ,A.INTR_UPC_ID                                   10674701
                       ,DEPT                                            10674801
                       ,CLASS                                           10674901
                       ,SUBCLASS                                        10675001
                   INTO :SKXREF-SKU                                     10675101
                       ,:UPC-UPC-NBR                                    10675201
                       ,:SKXREF-ITM-NBR                                 10675301
                       ,:SKXREF-INTR-UPC-ID                             10675401
                       ,:SKXREF-DEPT                                    10675501
                       ,:SKXREF-CLASS                                   10675601
                       ,:SKXREF-SUBCLASS                                10675701
                   FROM                                                 10675801
                        TSKXREF A                                       10675901
                       ,TUPC    B                                       10676001
                  WHERE                                                 10677001
                        A.INTR_UPC_ID = :IN402-PV-WORK-UPC-ID           10678010
                    AND B.UPC_ID = A.INTR_UPC_ID                        10679001
                    AND SKU_STAT_CDE NOT IN ('00','98')                 10680001
                  WITH UR                                               10690001
             END-EXEC                                                   10700001
                                                                        10710001
             EVALUATE TRUE                                              10720001
                 WHEN SQLCODE = 0                                       10730001
D28545               SET IN402-PV-FOUND-AS-REQUESTED TO TRUE            10740010
D28545               SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE            10750010
D28545               MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE            10760010
D28545               MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE            10770010
D28545               MOVE SPACES      TO IN402-PV-PARAGRAPH             10780010
                 WHEN SQLCODE = +100                                    10790001
                     SET IN402-PV-NOT-FOUND          TO TRUE            10800010
D28545               SET IN402-PV-ATT-NOT-FOUND      TO TRUE            10810010
D28545               SET IN402-PV-TRY-UPC-ID-LOOKUP  TO TRUE            10820010
D28545               MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE            10830010
D28545               MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE            10840010
D28545               STRING '  PARA: IN402-LOOKUP-BY-UPC-ID (2) - '     10850010
D28545                                         DELIMITED BY SIZE        10860001
D28545                      IN402-PV-SKU-IN DELIMITED BY SIZE           10870010
D28545                      '  ' DELIMITED BY SIZE                      10880001
D28545                      IN402-PV-UPC-NBR-IN DELIMITED BY SIZE       10890010
D28545                      '  ' DELIMITED BY SIZE                      10900001
D28545                      IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE      10910010
D28545                      '  ' DELIMITED BY SIZE                      10920001
D28545                      IN402-PV-ITM-NBR-IN DELIMITED BY SIZE       10930010
D28545                      '  ' DELIMITED BY SIZE                      10940001
D28545                                INTO IN402-PV-PARAGRAPH           10950010
                 WHEN OTHER                                             10960001
                     SET IN402-PV-SQL-ERROR          TO TRUE            10970010
D28545               SET IN402-PV-ATT-SQL-ERROR      TO TRUE            10980010
RONNA                SET IN402-PV-DBV-SQL-ERROR TO TRUE                 10990010
D28545               SET IN402-PV-TRY-UPC-ID-LOOKUP  TO TRUE            11000010
D28545               MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE            11010010
D28545               MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE            11020010
D28545               STRING '  PARA: IN402-LOOKUP-BY-UPC-ID (2) - '     11030010
D28545                                         DELIMITED BY SIZE        11040001
D28545                      IN402-PV-SKU-IN DELIMITED BY SIZE           11050010
D28545                      '  ' DELIMITED BY SIZE                      11060001
D28545                      IN402-PV-UPC-NBR-IN DELIMITED BY SIZE       11070010
D28545                      '  ' DELIMITED BY SIZE                      11080001
D28545                      IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE      11090010
D28545                      '  ' DELIMITED BY SIZE                      11100001
D28545                      IN402-PV-ITM-NBR-IN DELIMITED BY SIZE       11110010
D28545                      '  ' DELIMITED BY SIZE                      11120001
D28545                                INTO IN402-PV-PARAGRAPH           11130010
             END-EVALUATE                                               11140001
E28545     END-IF.                                                      11150001
                                                                        11160001
      ******************************************************************11170001
      * LOOKUP BY ITEM NUMBER INPUT                                     11180001
      ******************************************************************11190001
       IN402-LOOKUP-BY-ITM-NBR.                                         11200010
                                                                        11210001
           EXEC SQL                                                     11220001
               SELECT SKU                                               11230001
                     ,ITM_NBR                                           11240001
                     ,INTR_UPC_ID                                       11250001
                     ,DEPT                                              11260001
                     ,CLASS                                             11270001
                     ,SUBCLASS                                          11280001
                 INTO :SKXREF-SKU                                       11290001
                     ,:SKXREF-ITM-NBR                                   11300001
                     ,:SKXREF-INTR-UPC-ID                               11310001
                     ,:SKXREF-DEPT                                      11320001
                     ,:SKXREF-CLASS                                     11330001
                     ,:SKXREF-SUBCLASS                                  11340001
                 FROM                                                   11350001
                      TSKXREF                                           11360001
                WHERE                                                   11370001
                      ITM_NBR = :IN402-PV-WORK-ITM-NBR                  11380010
                WITH UR                                                 11390001
           END-EXEC.                                                    11400001
                                                                        11410001
           EVALUATE TRUE                                                11420001
               WHEN SQLCODE = 0                                         11430001
B28545             MOVE SKXREF-INTR-UPC-ID TO IN402-PV-WORK-UPC-ID      11440010
B28545             PERFORM IN402-LOOKUP-BY-UPC-ID                       11450010
               WHEN SQLCODE = +100                                      11460001
                   SET IN402-PV-NOT-FOUND          TO TRUE              11470010
D28545             SET IN402-PV-ATT-NOT-FOUND      TO TRUE              11480010
D28545             SET IN402-PV-TRY-ITM-NBR-LOOKUP TO TRUE              11490010
D28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              11500010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              11510010
D28545             STRING '  PARA: IN402-LOOKUP-BY-ITM-NBR - '          11520010
D28545                                       DELIMITED BY SIZE          11530001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             11540010
D28545                    '  ' DELIMITED BY SIZE                        11550001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         11560010
D28545                    '  ' DELIMITED BY SIZE                        11570001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        11580010
D28545                    '  ' DELIMITED BY SIZE                        11590001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         11600010
D28545                    '  ' DELIMITED BY SIZE                        11610001
D28545                              INTO IN402-PV-PARAGRAPH             11620010
               WHEN OTHER                                               11630001
                   SET IN402-PV-SQL-ERROR          TO TRUE              11640010
D28545             SET IN402-PV-ATT-SQL-ERROR      TO TRUE              11650010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   11660010
D28545             SET IN402-PV-TRY-ITM-NBR-LOOKUP TO TRUE              11670010
D28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              11680010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              11690010
D28545             STRING '  PARA: IN402-LOOKUP-BY-ITM-NBR - '          11700010
D28545                                       DELIMITED BY SIZE          11710001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             11720010
D28545                    '  ' DELIMITED BY SIZE                        11730001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         11740010
D28545                    '  ' DELIMITED BY SIZE                        11750001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        11760010
D28545                    '  ' DELIMITED BY SIZE                        11770001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         11780010
D28545                    '  ' DELIMITED BY SIZE                        11790001
D28545                              INTO IN402-PV-PARAGRAPH             11800010
           END-EVALUATE.                                                11810001
                                                                        11820001
      ******************************************************************11830001
      * IN402-LOOKUP-DEFAULT. DEFAULT INFORMATION LOOKUP                11840010
      * - THIS ROUTINE IS EXECUTED IF EITHER A VALID SWITCH WAS NOT SET 11850001
      *   OR THE SWITCH THAT WAS SET FAILED TO FIND ENOUGH TO PROCEED   11860001
      * - THIS ROUTINE WILL CHECK FOR A NON-ZERO / NON-SPACE CONDITION  11870001
      *   IN EACH OF THE PRIMARY SEARCH PARAMETERS (ITEM,UPC,SKU,UPCID).11880001
      * - IF ONE OF THE PARAMETERS WAS DETERMINED TO HAVE A VALUE OTHER 11890001
      *   THAN THE DEFAULT, PROCESSING WILL MAKE A FINAL ATTEMPT TO     11900001
      *   DETERMINE THE RETAIL BASED ON THESE VALUES.                   11910001
      * - FAILURE FROM THESE ATTEMPTS WILL RESULT IN A NOT FOUND        11920001
      *   CONDITION BEING RETURNED.                                     11930001
      ******************************************************************11940001
       IN402-LOOKUP-DEFAULT.                                            11950010
                                                                        11960001
           SET IN402-PV-FOUND-WITH-ASSUMPTION TO TRUE.                  11970010
                                                                        11980001
      *       IS SKU INPUT PROVIDED ???                                 11990001
           IF IN402-PV-SKU-IN = SPACES                                  12000010
               OR IN402-PV-SKU-IN NOT NUMERIC                           12010010
               OR IN402-PV-SKU-IN = ZEROES                              12020010
D28545*****    OR IN402-PV-DUMMY-SKU                                    12030010
      *           IS UPC INPUT PROVIDED ???                             12040001
               IF IN402-PV-UPC-NBR-IN = SPACES                          12050010
                   OR IN402-PV-UPC-NBR-IN NOT NUMERIC                   12060010
                   OR IN402-PV-UPC-NBR-IN = ZEROES                      12070010
      *               IS INTR-UPC-ID INPUT PROVIDED ???                 12080001
                   IF IN402-PV-UPC-ID-SPC = ZEROES                      12090010
      *                   IS ITEM NUMBER INPUT PROVIDED ???             12100001
                       IF IN402-PV-ITM-NBR-IN = SPACES                  12110010
                           OR IN402-PV-ITM-NBR-IN NOT NUMERIC           12120010
                           OR IN402-PV-ITM-NBR-IN = ZEROES              12130010
                               SET IN402-PV-NO-LOOKUP-TYPE    TO TRUE   12140010
                       ELSE                                             12150001
                           SET IN402-PV-TRY-ITM-NBR-LOOKUP TO TRUE      12160010
                           SET IN402-PV-ITM-NBR-LOOKUP    TO TRUE       12170010
                       END-IF                                           12180001
                   ELSE                                                 12190001
                       SET IN402-PV-TRY-UPC-ID-LOOKUP  TO TRUE          12200010
                       SET IN402-PV-INTR-UPC-ID-LOOKUP TO TRUE          12210010
                   END-IF                                               12220001
               ELSE                                                     12230001
                   SET IN402-PV-TRY-UPC-NBR-LOOKUP TO TRUE              12240010
                   SET IN402-PV-UPC-NBR-LOOKUP    TO TRUE               12250010
               END-IF                                                   12260001
           ELSE                                                         12270001
               SET IN402-PV-TRY-SKU-LOOKUP    TO TRUE                   12280010
               SET IN402-PV-SKU-LOOKUP        TO TRUE                   12290010
           END-IF.                                                      12300001
                                                                        12310001
           EVALUATE TRUE                                                12320001
               WHEN IN402-PV-SKU-LOOKUP                                 12330010
D28545           IF IN402-PV-DUMMY-SKU                                  12340010
D28545             MOVE IN402-PV-SKU-IN-NUM     TO IN402-PV-WORK-SKU    12350010
D28545             MOVE IN402-PV-SKU-IN-NUM     TO IN402-PV-DUMB-SKU    12360010
D28545             PERFORM IN402-DUMMY-SKU-LOOKUP                       12370010
D28545           ELSE                                                   12380001
                   MOVE IN402-PV-SKU-IN-NUM     TO IN402-PV-WORK-SKU    12390010
                   PERFORM IN402-LOOKUP-BY-SKU                          12400010
D28545           END-IF                                                 12410001
               WHEN IN402-PV-UPC-NBR-LOOKUP                             12420010
I28545           IF (IN402-PV-KOHLS-UPC AND IN402-PV-DUMMY-UPC)         12430010
D28545             MOVE IN402-PV-SKU-IN-NUM     TO IN402-PV-WORK-SKU    12440010
D28545             MOVE IN402-PV-SKU-IN-NUM     TO IN402-PV-DUMB-SKU    12450010
D28545             PERFORM IN402-DUMMY-SKU-LOOKUP                       12460010
D28545           ELSE                                                   12470001
                   MOVE IN402-PV-UPC-NBR-IN-NUM TO IN402-PV-WORK-UPC-NBR12480010
                   PERFORM IN402-LOOKUP-UPC-NBR                         12490010
D28545           END-IF                                                 12500001
               WHEN IN402-PV-INTR-UPC-ID-LOOKUP                         12510010
                   MOVE IN402-PV-UPC-ID-SPC     TO IN402-PV-WORK-UPC-ID 12520010
                   PERFORM IN402-LOOKUP-BY-UPC-ID                       12530010
               WHEN IN402-PV-ITM-NBR-LOOKUP                             12540010
                   MOVE IN402-PV-ITM-NBR-IN-NUM TO IN402-PV-WORK-ITM-NBR12550010
                   PERFORM IN402-LOOKUP-BY-ITM-NBR                      12560010
               WHEN OTHER                                               12570001
                   SET IN402-PV-NOT-FOUND        TO TRUE                12580010
D28545             SET IN402-PV-ATT-NOT-FOUND    TO TRUE                12590010
D28545             SET IN402-PV-MISSING-KEY-DATA TO TRUE                12600010
D28545             STRING '  PARA: IN402-LOOKUP-DEFAULT - '             12610010
D28545                                       DELIMITED BY SIZE          12620001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             12630010
D28545                    '  ' DELIMITED BY SIZE                        12640001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         12650010
D28545                    '  ' DELIMITED BY SIZE                        12660001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        12670010
D28545                    '  ' DELIMITED BY SIZE                        12680001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         12690010
D28545                    '  ' DELIMITED BY SIZE                        12700001
D28545                              INTO IN402-PV-PARAGRAPH             12710010
           END-EVALUATE.                                                12720001
                                                                        12730001
28545 ******************************************************************12740001
28545 ******************************************************************12750001
      ******************************************************************12760001
      * IN402-VSM-PROCEED-WITH-LOOKUP.                                  12770010
      *     INITIAL CALL WAS SUCCESSFUL - NOW FIND THE RETAIL           12780001
      ******************************************************************12790001
       IN402-VSM-PROCEED-WITH-LOOKUP.                                   12800010
                                                                        12810001
           MOVE SKXREF-INTR-UPC-ID     TO UPCPLS-UPC-ID.                12820001
28545      MOVE IN402-PV-EFF-BEG-DTE-TMST                               12830010
                                       TO UPCPLS-EFF-BEG-TMST           12840001
                                          UPCPLS-EFF-END-TMST.          12850001
                                                                        12860001
           MOVE ZEROES                TO UPCPLS-UNT-RTL-AMT             12870001
                                         UPCPLS-MEITGP-NBR.             12880001
           MOVE SPACES                TO UPCPLS-UPC-STAT-CDE            12890001
                                         UPCPLS-UPC-STAT-CHG-DTE        12900001
                                         UPCPLS-UNT-RTL-CHG-DTE.        12910001
           MOVE ZEROS               TO IN402-PV-SQL-SUB.                12920010
                                                                        12930001
           PERFORM                                                      12940001
               WITH TEST AFTER                                          12950001
               VARYING IN402-PV-SQL-SUB FROM 1 BY 1                     12960010
               UNTIL (IN402-PV-SQL-SUB > IN402-PV-MAX-RETRIES)          12970010
                   OR (SQLCODE = 0)                                     12980001
                   OR (SQLCODE = +100)                                  12990001
                                                                        13000001
               EXEC SQL                                                 13010001
28545            SELECT EFF_BEG_TMST                                    13020001
28545                  ,EFF_END_TMST                                    13030001
28545                  ,UNT_RTL_AMT                                     13040001
                       ,MEITGP_NBR                                      13050001
                       ,UPC_STAT_CDE                                    13060001
                       ,UPC_STAT_CHG_DTE                                13070001
                       ,UNT_RTL_CHG_DTE                                 13080001
28545                  ,ORIG_CLR_DTE                                    13090001
28545                  ,MKDN_CDE                                        13100001
28545            INTO :UPCPLS-EFF-BEG-TMST                              13110001
28545                ,:UPCPLS-EFF-END-TMST :IN402-PV-NULL-EFF-END-TMST  13120010
28545                ,:UPCPLS-UNT-RTL-AMT  :IN402-PV-NULL-UNT-RTL-AMT   13130010
                     ,:UPCPLS-MEITGP-NBR   :IN402-PV-NULL-MEITGP-NBR    13140010
                     ,:UPCPLS-UPC-STAT-CDE :IN402-PV-NULL-UPC-STAT-CDE  13150010
                     ,:UPCPLS-UPC-STAT-CHG-DTE                          13160001
                     ,:UPCPLS-UNT-RTL-CHG-DTE                           13170001
28545                ,:UPCPLS-ORIG-CLR-DTE :IN402-PV-NULL-ORIG-CLR-DTE  13180010
28545                ,:UPCPLS-MKDN-CDE     :IN402-PV-NULL-MKDN-CDE      13190010
                 FROM  TUPCPLS                                          13200001
                 WHERE UPC_ID        = :UPCPLS-UPC-ID                   13210001
                   AND STR_NBR       = :UPCPLS-STR-NBR                  13220001
                   AND EFF_BEG_TMST <= :UPCPLS-EFF-BEG-TMST             13230001
                   AND (EFF_END_TMST >= :UPCPLS-EFF-END-TMST            13240001
                    OR  EFF_END_TMST IS NULL)                           13250001
28545            WITH UR                                                13260001
               END-EXEC                                                 13270001
                                                                        13280001
               EVALUATE TRUE                                            13290001
                   WHEN SQLCODE = 0                                     13300001
                       SET IN402-PS-STR-FOUND  TO TRUE                  13310010
28545                  MOVE UPCPLS-UNT-RTL-AMT TO IN402-PV-WORK-RETAIL  13320010
28545                                                                   13330001
28545                  IF IN402-PV-NULL-MEITGP-NBR IS LESS THAN ZERO    13340010
28545                      MOVE ZEROS          TO UPCPLS-MEITGP-NBR     13350001
28545                  END-IF                                           13360001
28545                                                                   13370001
28545                  MOVE UPCPLS-MEITGP-NBR  TO MEITGP-MEITGP-NBR     13380001
28545                  PERFORM IN402-VSM-GROUP-PRICING                  13390010
28545                                                                   13400001
D28545                 SET IN402-PV-FOUND      TO TRUE                  13410010
D28545                 MOVE SQLCODE            TO IN402-PV-PRC-SQLCDE   13420010
                   WHEN SQLCODE = +100                                  13430001
                       IF UPCPLS-STR-NBR NOT EQUAL 0                    13440001
                           MOVE 0 TO UPCPLS-STR-NBR                     13450001
                       ELSE                                             13460001
                           PERFORM IN402-TPPCPRC-LOOKUP                 13470010
                       END-IF                                           13480001
                   WHEN SQLCODE = -904                                  13490001
                   WHEN SQLCODE = -911                                  13500001
D28545                 MOVE SQLCODE            TO IN402-PV-PRC-SQLCDE   13510010
                   WHEN OTHER                                           13520001
D28545                 SET IN402-PV-SQL-ERROR  TO TRUE                  13530010
RONNAQ                 SET IN402-PV-INVALID-KEY-INPUT TO TRUE           13540010
RONNAQ                 SET IN402-PV-NOT-FOUND    TO TRUE                13550010
D28545                 MOVE SQLCODE            TO IN402-PV-PRC-SQLCDE   13560010
RONNAQ                 STRING                                           13570001
RONNAQ             '  PARA: MAX RETRY IN402-VSM-PROCEED-WITH-LOOKUP - ' 13580010
RONNAQ                                   DELIMITED BY SIZE              13590001
RONNAQ                 IN402-PV-SKU-IN DELIMITED BY SIZE                13591010
RONNAQ                 '  ' DELIMITED BY SIZE                           13592001
RONNAQ                 IN402-PV-UPC-NBR-IN DELIMITED BY SIZE            13593010
RONNAQ                 '  ' DELIMITED BY SIZE                           13594001
RONNAQ                 IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE           13595010
RONNAQ                 '  ' DELIMITED BY SIZE                           13596001
RONNAQ                 IN402-PV-ITM-NBR-IN DELIMITED BY SIZE            13597010
RONNAQ                 '  ' DELIMITED BY SIZE                           13598001
RONNAQ                              INTO IN402-PV-PARAGRAPH             13599010
               END-EVALUATE                                             13600001
           END-PERFORM.                                                 13610001
                                                                        13620001
           IF IN402-PV-SQL-SUB > IN402-PV-MAX-RETRIES                   13630010
D28545         SET IN402-PV-SQL-ERROR    TO TRUE                        13640010
D28545         SET IN402-PV-NOT-FOUND    TO TRUE                        13650010
D28545         MOVE SQLCODE              TO IN402-PV-PRC-SQLCDE         13660010
D28545         STRING                                                   13670001
D28545             '  PARA: MAX RETRY IN402-VSM-PROCEED-WITH-LOOKUP - ' 13680010
D28545                                   DELIMITED BY SIZE              13690001
D28545             IN402-PV-SKU-IN DELIMITED BY SIZE                    13700010
D28545             '  ' DELIMITED BY SIZE                               13710001
D28545             IN402-PV-UPC-NBR-IN DELIMITED BY SIZE                13720010
D28545             '  ' DELIMITED BY SIZE                               13730001
D28545             IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE               13740010
D28545             '  ' DELIMITED BY SIZE                               13750001
D28545             IN402-PV-ITM-NBR-IN DELIMITED BY SIZE                13760010
D28545             '  ' DELIMITED BY SIZE                               13770001
D28545                              INTO IN402-PV-PARAGRAPH             13780010
D28545     END-IF.                                                      13790001
D28545                                                                  13800001
      ******************************************************************13810001
      * IN402-VSM-GROUP-PRICING.                                        13820010
      *     IF THE ITEM IS PART OF A GROUP-PRICING RETAIL, RESOLVE TO   13830001
      *     AN INDIVIDUAL PRICE BEFORE RETURNING RETAIL TO OUTPUT FIELD 13840001
      ******************************************************************13850001
       IN402-VSM-GROUP-PRICING.                                         13860010
                                                                        13870001
            IF UPCPLS-MEITGP-NBR EQUAL 0                                13880001
28545           MOVE ZEROS     TO IN402-PV-MITGPL-QTY                   13890010
28545           MOVE ZEROS     TO IN402-PV-MITGPL-GP-AMT                13900010
                SET IN402-PS-RTL-FOUND TO TRUE                          13910010
            ELSE                                                        13920001
                EXEC SQL                                                13930001
                    SELECT MITGPL_QTY                                   13940001
                          ,GP_AMT                                       13950001
                    INTO :MITGPL-MITGPL-QTY                             13960001
                        ,:MITGPL-GP-AMT                                 13970001
                    FROM TMITGPL                                        13980001
                    WHERE OPERCO_NBR = '03'                             13990001
28545                 AND MEITGP_NBR = :MEITGP-MEITGP-NBR               14000001
                      AND ADLOC_ID = '   '                              14010001
28545                 AND (:IN402-PV-EFF-BEG-DTE-X                      14020010
28545                              BETWEEN BEG_DTE AND END_DTE)         14030001
28545               WITH UR                                             14040001
                END-EXEC                                                14050001
                                                                        14060001
                EVALUATE TRUE                                           14070001
                  WHEN SQLCODE = ZERO                                   14080001
                    COMPUTE IN402-PV-WORK-RETAIL ROUNDED =              14090010
                              (MITGPL-GP-AMT / MITGPL-MITGPL-QTY )      14100001
28545               MOVE MITGPL-MITGPL-QTY TO IN402-PV-MITGPL-QTY       14110010
28545               MOVE MITGPL-GP-AMT     TO IN402-PV-MITGPL-GP-AMT    14120010
                    SET IN402-PS-RTL-FOUND TO TRUE                      14130010
D28545            WHEN OTHER                                            14140001
D28545              MOVE ZEROS             TO IN402-PV-MITGPL-QTY       14150010
D28545              MOVE ZEROS             TO IN402-PV-MITGPL-GP-AMT    14160010
D28545              SET IN402-PS-RTL-FOUND TO TRUE                      14170010
                END-EVALUATE                                            14180001
            END-IF.                                                     14190001
                                                                        14200001
      ******************************************************************14210001
      * IN402-VSM-PRICE-OUTPUT. MOVE BASE DATA TO OUTPUT LAYOUT         14220010
      * THE OUTPUT SKU MAY NOT NECESSARILY BE THE SAME AS THE INPUT SKU.14230001
      * IF THE INPUT SKU WAS RENUMBERED, THE RENUMBER SKU IS SPEWED OUT 14240001
      * AND IS DERIVED FROM THE TUPC.UPC_NBR (KOHLS INTERNAL UPC NUMBER)14250001
      ******************************************************************14260001
       IN402-VSM-PRICE-OUTPUT.                                          14270010
                                                                        14280001
Z28545     MOVE SKXREF-SKU              TO IN402-PRC-SKU-OUT.           14290010
Z28545                                                                  14300001
Z28545     IF IN402-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   14310010
Z28545         MOVE IN402-PV-UPC-NBR-IN-NUM TO IN402-PRC-UPC-OUT        14320010
Z28545     ELSE                                                         14330001
Z28545         MOVE UPC-UPC-NBR             TO IN402-PRC-UPC-OUT        14340010
Z28545     END-IF.                                                      14350001
28545                                                                   14360001
28545      MOVE SKXREF-INTR-UPC-ID      TO IN402-PRC-UPCID-OUT.         14370010
28545      MOVE SKXREF-ITM-NBR          TO IN402-PRC-ITM-NBR-OUT.       14380010
28545                                                                   14390001
28545      MOVE UPCPLS-EFF-BEG-TMST (1:10)                              14400001
28545                                   TO IN402-PRC-EFF-BEG-DTE-OUT.   14410010
28545                                                                   14420001
28545      IF IN402-PV-NULL-EFF-END-TMST IS LESS THAN ZEROS             14430010
28545          MOVE SPACES              TO IN402-PRC-EFF-END-DTE-OUT    14440010
28545      ELSE                                                         14450001
28545          MOVE UPCPLS-EFF-END-TMST (1:10)                          14460001
28545                                   TO IN402-PRC-EFF-END-DTE-OUT    14470010
28545      END-IF.                                                      14480001
28545                                                                   14490001
28545      IF IN402-PV-NULL-UPC-STAT-CDE IS LESS THAN ZEROS             14500010
28545          MOVE SPACES              TO IN402-PRC-STATUS-OUT         14510010
28545      ELSE                                                         14520001
28545          MOVE UPCPLS-UPC-STAT-CDE TO IN402-PRC-STATUS-OUT         14530010
28545      END-IF.                                                      14540001
28545                                                                   14550001
28545      MOVE UPCPLS-UPC-STAT-CHG-DTE TO IN402-PRC-STAT-CHG-DTE-OUT.  14560010
28545      MOVE UPCPLS-UNT-RTL-CHG-DTE  TO IN402-PRC-UPC-CHG-DTE-OUT.   14570010
28545                                                                   14580001
28545      IF IN402-PV-NULL-ORIG-CLR-DTE IS LESS THAN ZEROS             14590010
28545          MOVE SPACES                TO IN402-PRC-ORIG-CLR-DTE     14600010
28545      ELSE                                                         14610001
28545          MOVE UPCPLS-ORIG-CLR-DTE TO IN402-PRC-ORIG-CLR-DTE       14620010
28545      END-IF.                                                      14630001
28545                                                                   14640001
28545      IF IN402-PV-NULL-MKDN-CDE IS LESS THAN ZEROS                 14650010
28545          MOVE SPACES              TO IN402-PRC-MKDN-CDE           14660010
28545      ELSE                                                         14670001
28545          MOVE UPCPLS-MKDN-CDE     TO IN402-PRC-MKDN-CDE           14680010
28545      END-IF.                                                      14690001
28545                                                                   14700001
28545      IF IN402-PV-NULL-MEITGP-NBR IS LESS THAN ZEROS               14710010
28545          MOVE ZEROS               TO IN402-PRC-MEITGP-NBR         14720010
28545      ELSE                                                         14730001
28545          MOVE UPCPLS-MEITGP-NBR   TO IN402-PRC-MEITGP-NBR         14740010
28545      END-IF.                                                      14750001
28545                                                                   14760001
28545      MOVE IN402-PV-MITGPL-QTY     TO IN402-PRC-MITGPL-QTY.        14770010
28545      MOVE IN402-PV-MITGPL-GP-AMT  TO IN402-PRC-GP-AMT.            14780010
28545                                                                   14790001
28545      MOVE IN402-PV-WORK-RETAIL    TO IN402-PRC-UNIT-RTL-OUT.      14800010
28545      MOVE ZEROS                   TO IN402-PRC-EXTD-RTL-OUT.      14810010
28545                                                                   14820001
28545 ******************************************************************14830001
28545 * IN402-TPPCPRC-LOOKUP                                            14840010
28545 ******************************************************************14850001
28545  IN402-TPPCPRC-LOOKUP.                                            14860010
28545                                                                   14870001
28545 *** STORE SPECIFIC - PERM PRICE TABLE PRICE LOOKUP....            14880001
D28545     MOVE ZEROS            TO IN402-PV-PRC-SQLCDE.                14890010
D28545     MOVE ZEROS            TO IN402-PV-RETURN-CDE.                14900010
D28545     MOVE ZEROS            TO IN402-PV-ATT-SQLCDE.                14910010
D28545     MOVE ZEROS            TO IN402-PV-ATT-RTNCDE.                14920010
D28545     MOVE SPACES           TO IN402-PV-RETURN-RSN.                14930010
28545      MOVE 'N'              TO IN402-PS-PRIOR-FOUND-SW.            14940010
28545      MOVE 'N'              TO IN402-PS-END-TPPCPRC-CSR-SW.        14950010
28545      MOVE IN402-PV-LOC-IN-NUM       TO PPCPRC-STR-NBR.            14960010
28545      MOVE SKXREF-ITM-NBR            TO PPCPRC-TSK-ITM-NBR         14970001
28545      MOVE IN402-PV-EFF-BEG-DTE-TMST TO PPCPRC-STRT-TMST.          14980010
28545      MOVE IN402-PV-EFF-BEG-DTE-TMST TO PPCPRC-END-TMST.           14990010
28545                                                                   15000001
28545      PERFORM IN402-OPEN-TPPCPRC-CSR.                              15010010
28545      PERFORM IN402-FETCH-TPPCPRC-CSR                              15020010
28545        UNTIL IN402-PRIOR-FOUND                                    15030010
28545           OR IN402-PS-END-TPPCPRC-CSR.                            15040010
28545      PERFORM IN402-CLOSE-TPPCPRC-CSR.                             15050010
28545                                                                   15060001
28545 *** CORPORATE - PERM PRICE TABLE PRICE LOOKUP....                 15070001
28545      IF IN402-PRIOR-NOT-FOUND                                     15080010
D28545         MOVE ZEROS            TO IN402-PV-PRC-SQLCDE             15090010
D28545         MOVE ZEROS            TO IN402-PV-RETURN-CDE             15100010
D28545         MOVE ZEROS            TO IN402-PV-ATT-SQLCDE             15110010
D28545         MOVE ZEROS            TO IN402-PV-ATT-RTNCDE             15120010
D28545         MOVE SPACES           TO IN402-PV-RETURN-RSN             15130010
28545          MOVE 'N'              TO IN402-PS-PRIOR-FOUND-SW         15140010
28545          MOVE 'N'              TO IN402-PS-END-TPPCPRC-CSR-SW     15150010
28545          MOVE ZEROS            TO PPCPRC-STR-NBR                  15160001
28545          MOVE SKXREF-ITM-NBR   TO PPCPRC-TSK-ITM-NBR              15170001
28545          MOVE IN402-PV-EFF-BEG-DTE-TMST TO PPCPRC-STRT-TMST       15180010
28545          MOVE IN402-PV-EFF-BEG-DTE-TMST TO PPCPRC-END-TMST        15190010
28545          PERFORM IN402-OPEN-TPPCPRC-CSR                           15200010
28545          PERFORM IN402-FETCH-TPPCPRC-CSR                          15210010
28545            UNTIL IN402-PRIOR-FOUND                                15220010
28545               OR IN402-PS-END-TPPCPRC-CSR                         15230010
28545          PERFORM IN402-CLOSE-TPPCPRC-CSR                          15240010
28545      END-IF.                                                      15250001
28545                                                                   15260001
28545 *** PRICE NOT FOUND....                                           15270001
28545      IF IN402-PRIOR-NOT-FOUND                                     15280010
28545          SET IN402-PS-STR-NOT-FOUND TO TRUE                       15290010
I28545     ELSE                                                         15300001
I28545         SET IN402-PS-STR-FOUND     TO TRUE                       15310010
28545      END-IF.                                                      15320001
28545                                                                   15330001
28545 ******************************************************************15340001
28545 * IN402-OPEN-TPPCPRC-CSR.                                         15350010
28545 ******************************************************************15360001
28545  IN402-OPEN-TPPCPRC-CSR.                                          15370010
28545                                                                   15380001
28545      EXEC SQL                                                     15390001
28545           OPEN TPPCPRC-CSR                                        15400001
28545      END-EXEC.                                                    15410001
28545                                                                   15411001
28545      EVALUATE TRUE                                                15412001
28545          WHEN SQLCODE = +0                                        15413001
D28545             CONTINUE                                             15414001
D28545         WHEN OTHER                                               15415001
D28545             SET IN402-PV-SQL-ERROR     TO TRUE                   15416010
D28545             SET IN402-PV-CURSOR-OPEN   TO TRUE                   15417010
D28545             MOVE SQLCODE      TO IN402-PV-PRC-SQLCDE             15418010
D28545             STRING '  PARA: IN402-OPEN-TPPCPRC-CSR - '           15419010
D28545                                       DELIMITED BY SIZE          15420001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             15430010
D28545                    '  ' DELIMITED BY SIZE                        15440001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         15450010
D28545                    '  ' DELIMITED BY SIZE                        15460001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        15470010
D28545                    '  ' DELIMITED BY SIZE                        15480001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         15490010
D28545                    '  ' DELIMITED BY SIZE                        15500001
D28545                              INTO IN402-PV-PARAGRAPH             15510010
D28545     END-EVALUATE.                                                15520001
D28545                                                                  15530001
28545 ******************************************************************15540001
28545 * IN402-FETCH-TPPCPRC-CSR.                                        15550010
28545 ******************************************************************15560001
28545  IN402-FETCH-TPPCPRC-CSR.                                         15570010
28545                                                                   15580001
28545      EXEC SQL                                                     15590001
28545          FETCH TPPCPRC-CSR                                        15600001
28545          INTO :PPCPRC-RTL-AMT                                     15610001
28545              ,:PPCPRC-MEITGP-NBR                                  15620001
28545              ,:PPCPRC-STATUS-CDE                                  15630001
28545      END-EXEC.                                                    15640001
28545                                                                   15650001
28545      EVALUATE TRUE                                                15660001
28545          WHEN SQLCODE = +0                                        15670001
28545              MOVE PPCPRC-RTL-AMT    TO IN402-PV-WORK-RETAIL       15680010
28545              MOVE PPCPRC-MEITGP-NBR TO MEITGP-MEITGP-NBR          15690001
28545              PERFORM IN402-VSM-GROUP-PRICING                      15700010
28545              SET IN402-PRIOR-FOUND  TO TRUE                       15710010
D28545             SET IN402-PV-FOUND     TO TRUE                       15720010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        15730010
D28545             MOVE SPACES            TO IN402-PV-PARAGRAPH         15740010
28545          WHEN SQLCODE = +100                                      15750001
28545              MOVE ZEROS             TO IN402-PV-WORK-RETAIL       15760010
D28545             SET IN402-PV-CURSOR-FETCH    TO TRUE                 15770010
28545              SET IN402-PS-END-TPPCPRC-CSR TO TRUE                 15780010
D28545             SET IN402-PV-NOT-FOUND       TO TRUE                 15790010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        15800010
D28545             STRING '  PARA: IN402-FETCH-TPPCPRC-CSR - '          15810010
D28545                                       DELIMITED BY SIZE          15820001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             15830010
D28545                    '  ' DELIMITED BY SIZE                        15840001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         15850010
D28545                    '  ' DELIMITED BY SIZE                        15860001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        15870010
D28545                    '  ' DELIMITED BY SIZE                        15880001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         15890010
D28545                    '  ' DELIMITED BY SIZE                        15900001
D28545                              INTO IN402-PV-PARAGRAPH             15910010
28545          WHEN OTHER                                               15920001
28545              MOVE ZEROS             TO IN402-PV-WORK-RETAIL       15930010
28545              SET IN402-PV-SQL-ERROR       TO TRUE                 15940010
D28545             SET IN402-PV-CURSOR-FETCH    TO TRUE                 15950010
28545              SET IN402-PS-END-TPPCPRC-CSR TO TRUE                 15960010
D28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              15970010
D28545             STRING '  PARA: IN402-FETCH-TPPCPRC-CSR - '          15980010
D28545                                       DELIMITED BY SIZE          15990001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             16000010
D28545                    '  ' DELIMITED BY SIZE                        16010001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         16020010
D28545                    '  ' DELIMITED BY SIZE                        16030001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        16040010
D28545                    '  ' DELIMITED BY SIZE                        16050001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         16060010
D28545                    '  ' DELIMITED BY SIZE                        16070001
D28545                              INTO IN402-PV-PARAGRAPH             16080010
28545      END-EVALUATE.                                                16090001
28545                                                                   16100001
28545 ******************************************************************16110001
28545 * IN402-CLOSE-TPPCPRC-CSR.                                        16120010
28545 ******************************************************************16130001
28545  IN402-CLOSE-TPPCPRC-CSR.                                         16140010
28545                                                                   16150001
28545      EXEC SQL                                                     16160001
28545          CLOSE TPPCPRC-CSR                                        16170001
28545      END-EXEC.                                                    16180001
28545                                                                   16190001
28545      EVALUATE TRUE                                                16200001
28545          WHEN SQLCODE = +0                                        16210001
D28545             CONTINUE                                             16220001
28545          WHEN OTHER                                               16230001
D28545             SET IN402-PV-SQL-ERROR     TO TRUE                   16240010
D28545             SET IN402-PV-CURSOR-CLOSE  TO TRUE                   16250010
D28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              16260010
D28545             STRING '  PARA: IN402-CLOSE-TPPCPRC-CSR - '          16270010
D28545                                       DELIMITED BY SIZE          16280001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             16290010
D28545                    '  ' DELIMITED BY SIZE                        16300001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         16310010
D28545                    '  ' DELIMITED BY SIZE                        16320001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        16330010
D28545                    '  ' DELIMITED BY SIZE                        16340001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         16350010
D28545                    '  ' DELIMITED BY SIZE                        16360001
D28545                              INTO IN402-PV-PARAGRAPH             16370010
28545      END-EVALUATE.                                                16380001
28545                                                                   16390001
28545 ******************************************************************16400001
28545 ******************************************************************16410001
28545 ******************************************************************16420001
28545 * IN402-VSM-ATTRIBUTES-LOOKUP.                                    16430010
28545 ******************************************************************16440001
28545  IN402-VSM-ATTRIBUTES-LOOKUP.                                     16450010
28545                                                                   16460001
28545      EXEC SQL                                                     16470001
28545          SELECT A.SKU                                             16480001
28545                ,A.ITM_NBR                                         16490001
28545                ,A.DEPT                                            16500001
28545                ,CLASS                                             16510001
28545                ,SUBCLASS                                          16520001
D28545               ,A.SKU_STAT_CDE                                    16530001
D28545               ,B.UPC_NBR                                         16540001
28545                ,B.SUB_CL_MDSEAR_ID                                16550001
28545                ,B.VS_ID                                           16560001
28545                ,B.INTR_UPC_ID                                     16570001
28545                ,C.ENT_ID                                          16580001
28545                ,C.VS_NBR                                          16590001
28545                ,D.RMS_STYL_ID                                     16600001
RONNA                ,D.LBL_SEQ_NBR                                     16610001
28545                ,E.DUN_NBR                                         16620001
28545                ,F.INHOUSE_NBR                                     16630001
28545          INTO :SKXREF-SKU                                         16640001
28545                ,:SKXREF-ITM-NBR                                   16650001
28545                ,:SKXREF-DEPT                                      16660001
28545                ,:SKXREF-CLASS                                     16670001
28545                ,:SKXREF-SUBCLASS                                  16680001
D28545               ,:SKXREF-SKU-STAT-CDE                              16690001
D28545               ,:UPC-UPC-NBR                                      16700001
28545                ,:UPC-SUB-CL-MDSEAR-ID                             16710001
28545                ,:UPC-VS-ID                                        16720001
28545                ,:UPC-INTR-UPC-ID                                  16730001
28545                ,:VNDSTL-ENT-ID                                    16740001
28545                ,:VNDSTL-VS-NBR                                    16750001
28545                ,:MDARVS-RMS-STYL-ID                               16760001
RONNA                ,:MDARVS-LBL-SEQ-NBR                               16770001
28545                ,:EXTENT-DUN-NBR                                   16780001
28545                ,:VNDDPT-INHOUSE-NBR                               16790001
28545         FROM TSKXREF A                                            16800001
28545             ,TUPC B                                               16810001
28545             ,TVNDSTL C                                            16820001
28545             ,TMDARVS D                                            16830001
28545             ,TEXTENT E                                            16840001
28545             ,TVNDDPT F                                            16850001
28545         WHERE A.INTR_UPC_ID = :SKXREF-INTR-UPC-ID                 16860001
28545             AND A.SKU_STAT_CDE NOT IN ('98', '00')                16870001
28545             AND A.INTR_UPC_ID = B.INTR_UPC_ID                     16880001
28545             AND B.INTR_UPC_ID = B.UPC_ID                          16890001
28545             AND B.VS_ID = C.VS_ID                                 16900001
28545             AND :IN402-PV-EFF-BEG-DTE BETWEEN B.EFF_BEG_DTE       16910010
28545                     AND COALESCE(B.EFF_END_DTE, '9999-12-31')     16920001
A28545            AND B.SUB_CL_MDSEAR_ID = D.SUB_CL_MDSEAR_ID           16930001
28545             AND C.VS_ID = D.VS_ID                                 16940001
28545             AND C.ENT_ID = E.ENT_ID                               16950001
28545             AND C.ENT_ID = F.ENT_ID                               16960001
28545             AND A.DEPT = INTEGER(F.DEPT_NBR)                      16970001
28545         WITH UR                                                   16980001
28545      END-EXEC.                                                    16990001
28545                                                                   17000001
28545      EVALUATE TRUE                                                17010001
28545          WHEN SQLCODE = 0                                         17020001
D28545             SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE              17030010
D28545             SET IN402-PS-ATTR-FOUND TO TRUE                      17040010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              17050010
D28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               17060010
RONNA              IF MDARVS-LBL-SEQ-NBR = ZERO                         17070001
RONNA                 MOVE 2230     TO MDARVS-LBL-SEQ-NBR               17080001
RONNA              END-IF                                               17090001
28545          WHEN SQLCODE = +100                                      17100001
28545              MOVE ZEROS       TO SKXREF-SKU                       17110001
28545              MOVE ZEROS       TO SKXREF-ITM-NBR                   17120001
28545              MOVE ZEROS       TO SKXREF-DEPT                      17130001
28545              MOVE ZEROS       TO SKXREF-CLASS                     17140001
28545              MOVE ZEROS       TO SKXREF-SUBCLASS                  17150001
28545              MOVE ZEROS       TO UPC-SUB-CL-MDSEAR-ID             17160001
28545              MOVE ZEROS       TO UPC-VS-ID                        17170001
28545              MOVE ZEROS       TO UPC-INTR-UPC-ID                  17180001
JAS                MOVE 5161        TO VNDSTL-ENT-ID                    17190001
28545              MOVE ZEROS       TO VNDSTL-VS-NBR                    17191001
28545              MOVE ZEROS       TO MDARVS-RMS-STYL-ID               17192001
RONNA              MOVE 2230        TO MDARVS-LBL-SEQ-NBR               17193001
28545              MOVE ZEROS       TO EXTENT-DUN-NBR                   17194001
28545              MOVE ZEROS       TO VNDDPT-INHOUSE-NBR               17195001
D28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   17196010
D28545             SET IN402-PV-VSM-LOOKUP    TO TRUE                   17197010
D28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  17198010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              17199010
D28545             STRING '  PARA: IN402-VSM-ATTRIBUTES-LOOKUP - '      17200010
D28545                                       DELIMITED BY SIZE          17210001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             17220010
D28545                    '  ' DELIMITED BY SIZE                        17230001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         17240010
D28545                    '  ' DELIMITED BY SIZE                        17250001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        17260010
D28545                    '  ' DELIMITED BY SIZE                        17270001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         17280010
D28545                    '  ' DELIMITED BY SIZE                        17290001
D28545                              INTO IN402-PV-PARAGRAPH             17300010
28545          WHEN OTHER                                               17310001
D28545             MOVE ZEROS       TO SKXREF-SKU                       17320001
D28545             MOVE ZEROS       TO SKXREF-ITM-NBR                   17330001
D28545             MOVE ZEROS       TO SKXREF-DEPT                      17340001
D28545             MOVE ZEROS       TO SKXREF-CLASS                     17350001
D28545             MOVE ZEROS       TO SKXREF-SUBCLASS                  17360001
D28545             MOVE ZEROS       TO UPC-SUB-CL-MDSEAR-ID             17370001
D28545             MOVE ZEROS       TO UPC-VS-ID                        17380001
D28545             MOVE ZEROS       TO UPC-INTR-UPC-ID                  17390001
D28545             MOVE ZEROS       TO VNDSTL-ENT-ID                    17400001
D28545             MOVE ZEROS       TO VNDSTL-VS-NBR                    17410001
D28545             MOVE ZEROS       TO MDARVS-RMS-STYL-ID               17420001
RONNA              MOVE 2230        TO MDARVS-LBL-SEQ-NBR               17430001
D28545             MOVE ZEROS       TO EXTENT-DUN-NBR                   17440001
D28545             MOVE ZEROS       TO VNDDPT-INHOUSE-NBR               17450001
D28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   17460010
D28545             SET IN402-PV-SQL-ERROR     TO TRUE                   17470010
D28545             SET IN402-PV-VSM-LOOKUP    TO TRUE                   17480010
D28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  17490010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              17500010
D28545             STRING '  PARA: IN402-VSM-ATTRIBUTES-LOOKUP - '      17510010
D28545                                       DELIMITED BY SIZE          17520001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             17530010
D28545                    '  ' DELIMITED BY SIZE                        17540001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         17550010
D28545                    '  ' DELIMITED BY SIZE                        17560001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        17570010
D28545                    '  ' DELIMITED BY SIZE                        17580001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         17590010
D28545                    '  ' DELIMITED BY SIZE                        17600001
D28545                              INTO IN402-PV-PARAGRAPH             17610010
28545      END-EVALUATE.                                                17620001
RONNA      MOVE SKXREF-SKU        TO IN402-PV-WORK-SKU.                 17630010
28545                                                                   17640001
J28545******************************************************************17650001
J28545* IN402-INVENTORY-RECLASS.                                        17660010
J28545******************************************************************17670001
J28545 IN402-INVENTORY-RECLASS.                                         17680010
J28545                                                                  17690001
J28545     INITIALIZE DCLIMT00015.                                      17700001
J28545     MOVE ZEROS             TO IN402-PV-NULL-ID.                  17710010
J28545     MOVE ZEROS             TO IN402-PV-PRC-SQLCDE.               17720010
J28545     MOVE ZEROS             TO IN402-PV-RETURN-CDE.               17730010
J28545     MOVE ZEROS             TO IN402-PV-ATT-SQLCDE.               17740010
J28545     MOVE ZEROS             TO IN402-PV-ATT-RTNCDE.               17750010
J28545     MOVE SPACES            TO IN402-PV-RETURN-RSN.               17760010
J28545     MOVE SPACES            TO IN402-PV-MIN-RECLS-TMST.           17770010
J28545     MOVE 'N'               TO IN402-PS-RECLASS-FOUND-SW.         17780010
J28545     MOVE IN402-PV-WORK-SKU TO IMT00015-SKU-NBR.                  17790010
J28545     MOVE IN402-PV-EFF-BEG-DTE-TMST TO IMT00015-RECLS-TMST.       17800010
J28545                                                                  17801001
J28545     EXEC SQL                                                     17802001
J28545         SELECT MIN(RECLS_TMST)                                   17803001
J28545         INTO :IN402-PV-MIN-RECLS-TMST :IN402-PV-NULL-ID          17804010
J28545         FROM IMT_RECLS                                           17805001
J28545         WHERE (RECLS_TMST >= :IMT00015-RECLS-TMST                17806001
J28545           AND RECLS_TMST <= CURRENT_TIMESTAMP)                   17806101
J28545           AND SKU_NBR = :IMT00015-SKU-NBR                        17806201
J28545         WITH UR                                                  17806301
J28545     END-EXEC.                                                    17806401
J28545                                                                  17806501
J28545     EVALUATE TRUE                                                17806601
J28545         WHEN SQLCODE = 0                                         17806701
J28545           IF IN402-PV-NULL-ID IS LESS THAN ZEROS                 17806810
J28545             MOVE 'N'         TO IN402-PS-RECLASS-FOUND-SW        17806910
J28545           ELSE                                                   17807001
J28545           IF IN402-PV-MIN-RECLS-TMST NOT EQUAL SPACES            17807110
J28545             MOVE 'Y'         TO IN402-PS-RECLASS-FOUND-SW        17807210
J28545           ELSE                                                   17807301
J28545             MOVE 'N'         TO IN402-PS-RECLASS-FOUND-SW        17807410
J28545           END-IF                                                 17807501
J28545           END-IF                                                 17807601
J28545         WHEN SQLCODE = +100                                      17807701
J28545             MOVE 'N'         TO IN402-PS-RECLASS-FOUND-SW        17807810
J28545         WHEN OTHER                                               17807901
J28545             MOVE 'N'         TO IN402-PS-RECLASS-FOUND-SW        17808010
J28545     END-EVALUATE.                                                17808101
J28545                                                                  17808201
J28545     IF IN402-PS-RECLASS-FOUND                                    17808310
J28545       INITIALIZE DCLIMT00015                                     17808401
J28545       MOVE IN402-PV-WORK-SKU TO IMT00015-SKU-NBR                 17808510
J28545       MOVE IN402-PV-MIN-RECLS-TMST TO IMT00015-RECLS-TMST        17808610
J28545                                                                  17808701
J28545       EXEC SQL                                                   17808801
J28545         SELECT RECLS_TMST                                        17808901
J28545               ,OLD_DEPT_NBR                                      17809001
J28545               ,OLD_MAJ_CL_NBR                                    17809101
J28545               ,OLD_SUB_CL_NBR                                    17809201
J28545               ,SKU_NBR                                           17809301
J28545               ,NW_DEPT_NBR                                       17809401
J28545               ,NW_MAJ_CL_NBR                                     17809501
J28545               ,NW_SUB_CL_NBR                                     17809601
J28545         INTO :IMT00015-RECLS-TMST                                17809701
J28545             ,:IMT00015-OLD-DEPT-NBR                              17809801
J28545             ,:IMT00015-OLD-MAJ-CL-NBR                            17809901
J28545             ,:IMT00015-OLD-SUB-CL-NBR                            17810001
J28545             ,:IMT00015-SKU-NBR                                   17811001
J28545             ,:IMT00015-NW-DEPT-NBR                               17812001
J28545             ,:IMT00015-NW-MAJ-CL-NBR                             17812101
J28545             ,:IMT00015-NW-SUB-CL-NBR                             17812201
J28545         FROM IMT_RECLS                                           17812301
J28545         WHERE RECLS_TMST = :IMT00015-RECLS-TMST                  17812401
J28545           AND SKU_NBR = :IMT00015-SKU-NBR                        17812501
J28545         WITH UR                                                  17812601
J28545       END-EXEC                                                   17812701
J28545                                                                  17812801
J28545       EVALUATE TRUE                                              17812901
J28545         WHEN SQLCODE = 0                                         17813001
J28545             MOVE IMT00015-OLD-DEPT-NBR   TO SKXREF-DEPT          17813101
J28545             MOVE IMT00015-OLD-MAJ-CL-NBR TO SKXREF-CLASS         17813201
J28545             MOVE IMT00015-OLD-SUB-CL-NBR TO SKXREF-SUBCLASS      17813301
J28545             SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE              17813410
J28545             SET IN402-PS-ATTR-FOUND      TO TRUE                 17813510
J28545             MOVE SQLCODE                 TO IN402-PV-ATT-SQLCDE  17813610
J28545             MOVE SPACES                  TO IN402-PV-PARAGRAPH   17813710
J28545         WHEN SQLCODE = +100                                      17813801
J28545             SET IN402-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           17813910
J28545             SET IN402-PS-ATTR-FOUND TO TRUE                      17814010
J28545             MOVE ZEROS       TO IN402-PV-ATT-SQLCDE              17814110
J28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               17814210
J28545         WHEN OTHER                                               17814301
J28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   17814410
J28545             SET IN402-PV-SQL-ERROR     TO TRUE                   17814510
J28545             SET IN402-PV-INV-RCLSS-LOOKUP TO TRUE                17814610
J28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  17814710
J28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              17814810
J28545             STRING '  PARA: IN402-INVENTORY-RECLASS - '          17814910
J28545                                       DELIMITED BY SIZE          17815001
J28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             17815110
J28545                    '  ' DELIMITED BY SIZE                        17815201
J28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         17815310
J28545                    '  ' DELIMITED BY SIZE                        17815401
J28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        17815510
J28545                    '  ' DELIMITED BY SIZE                        17815601
J28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         17815710
J28545                    '  ' DELIMITED BY SIZE                        17815801
J28545                              INTO IN402-PV-PARAGRAPH             17815910
J28545       END-EVALUATE                                               17816001
J28545     END-IF.                                                      17816101
J28545                                                                  17816201
D28545******************************************************************17816301
D28545* IN402-VSM-PLU-DWNLD-LOOKUP.                                     17816410
D28545******************************************************************17816501
D28545 IN402-VSM-PLU-DWNLD-LOOKUP.                                      17816610
D28545                                                                  17816701
D28545     INITIALIZE DCLTUPCSKU.                                       17816801
D28545                                                                  17816901
D28545     MOVE SKXREF-ITM-NBR    TO TUPCSKU-ITEM-NBR.                  17817001
D28545                                                                  17817101
Z28545     IF IN402-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   17817210
Z28545         MOVE IN402-PV-UPC-NBR-IN-NUM TO TUPCSKU-UPC-NBR          17817310
Z28545     ELSE                                                         17817401
Z28545         MOVE UPC-UPC-NBR             TO TUPCSKU-UPC-NBR          17817501
Z28545     END-IF.                                                      17817601
28545                                                                   17817701
D28545     EXEC SQL                                                     17817801
D28545         SELECT PLU_DWNLD_IND                                     17817901
D28545         INTO :TUPCSKU-PLU-DWNLD-IND                              17818001
D28545         FROM TUPCSKU                                             17819001
D28545         WHERE ITEM_NBR = :TUPCSKU-ITEM-NBR                       17820001
D28545           AND UPC_NBR = :TUPCSKU-UPC-NBR                         17830001
D28545         WITH UR                                                  17840001
D28545     END-EXEC.                                                    17850001
D28545                                                                  17860001
D28545     EVALUATE TRUE                                                17870001
D28545         WHEN SQLCODE = 0                                         17880001
D28545             SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE              17890010
D28545             SET IN402-PS-ATTR-FOUND TO TRUE                      17900010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              17910010
D28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               17920010
D28545         WHEN SQLCODE = +100                                      17930001
D28545             MOVE SPACE       TO TUPCSKU-PLU-DWNLD-IND            17940001
D28545             SET IN402-PV-FOUND-WITH-ASSUMPTION TO TRUE           17950010
D28545             SET IN402-PS-ATTR-FOUND TO TRUE                      17960010
D28545             MOVE ZEROS       TO IN402-PV-ATT-SQLCDE              17970010
D28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               17980010
D28545         WHEN OTHER                                               17990001
D28545             MOVE SPACE       TO TUPCSKU-PLU-DWNLD-IND            18000001
D28545             SET IN402-PV-FOUND-WITH-ASSUMPTION TO TRUE           18010010
D28545             SET IN402-PS-ATTR-FOUND TO TRUE                      18020010
D28545             MOVE ZEROS       TO IN402-PV-ATT-SQLCDE              18030010
D28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               18040010
D28545     END-EVALUATE.                                                18050001
D28545                                                                  18060001
28545 ******************************************************************18070001
28545 * IN402-VSM-MBS-LOOKUP.                                           18071010
28545 ******************************************************************18072001
28545  IN402-VSM-MBS-LOOKUP.                                            18073010
28545                                                                   18074001
28545      MOVE SKXREF-DEPT             TO IN402-CONVERT-DEPT.          18075010
28545      MOVE IN402-CONVERT-DEPT      TO IN402-PV-WORK-DEPT.          18076010
28545                                                                   18077001
28545      EXEC SQL                                                     18078001
I28545       SELECT A.BYR_NBR                                           18079001
I28545             ,A.GMA_NBR                                           18080001
I28545             ,A.DMA_NBR                                           18090001
I28545       INTO :IN402-ATT-BYR-NBR                                    18100010
I28545           ,:IN402-ATT-GMA-NBR                                    18110010
I28545           ,:IN402-ATT-DMA-NBR                                    18120010
I28545       FROM TMDSEAR A                                             18130001
I28545       WHERE A.DEPT_NBR = :IN402-PV-WORK-DEPT-3X                  18140010
I28545         AND A.MDSELV_CDE = 'DPT'                                 18150001
I28545         AND (:IN402-PV-EFF-BEG-DTE-X >= A.STRT_DTE AND           18160010
I28545              :IN402-PV-EFF-BEG-DTE-X <= A.END_DTE)               18170010
I28545       WITH UR                                                    18180001
28545      END-EXEC.                                                    18190001
28545                                                                   18200001
28545      EVALUATE TRUE                                                18210001
28545          WHEN SQLCODE = 0                                         18220001
I28545             PERFORM IN402-VSM-MBS-BYR-LOOKUP                     18230010
I28545             PERFORM IN402-VSM-MBS-DMM-LOOKUP                     18240010
I28545             PERFORM IN402-VSM-MBS-GMM-LOOKUP                     18250010
I28545             PERFORM IN402-VSM-MBS-DESC-LOOKUP                    18260010
28545          WHEN SQLCODE = +100                                      18270001
I28545             MOVE SPACES      TO IN402-ATT-GMA-NBR                18280010
I28545             MOVE SPACES      TO IN402-ATT-DMA-NBR                18290010
I28545             MOVE SPACES      TO IN402-ATT-BYR-NBR                18300010
I28545             MOVE SPACES      TO IN402-ATT-GMM-LAST-NAME          18310010
I28545             MOVE SPACES      TO IN402-ATT-GMM-FIR-NAME           18320010
I28545             MOVE SPACES      TO IN402-ATT-DMM-LAST-NAME          18330010
I28545             MOVE SPACES      TO IN402-ATT-DMM-FIR-NAME           18340010
I28545             MOVE SPACES      TO IN402-ATT-BYR-LAST-NAME          18350010
I28545             MOVE SPACES      TO IN402-ATT-BYR-FIR-NAME           18360010
I28545             MOVE SPACES      TO IN402-ATT-MDSEAR-DESC            18370010
28545              SET IN402-PV-ATT-NOT-FOUND TO TRUE                   18380010
28545              SET IN402-PV-MBS-LOOKUP    TO TRUE                   18390010
28545              SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  18400010
28545              MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              18410010
28545              STRING '  PARA: IN402-VSM-MBS-LOOKUP - '             18420010
28545                                        DELIMITED BY SIZE          18430001
28545                     IN402-PV-SKU-IN DELIMITED BY SIZE             18440010
28545                     '  ' DELIMITED BY SIZE                        18450001
28545                     IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         18460010
28545                     '  ' DELIMITED BY SIZE                        18461001
28545                     IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        18462010
28545                     '  ' DELIMITED BY SIZE                        18463001
28545                     IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         18464010
28545                     '  ' DELIMITED BY SIZE                        18465001
28545                               INTO IN402-PV-PARAGRAPH             18465110
28545          WHEN OTHER                                               18465201
I28545             MOVE SPACES      TO IN402-ATT-GMA-NBR                18465310
I28545             MOVE SPACES      TO IN402-ATT-DMA-NBR                18465410
I28545             MOVE SPACES      TO IN402-ATT-BYR-NBR                18465510
I28545             MOVE SPACES      TO IN402-ATT-GMM-LAST-NAME          18465610
I28545             MOVE SPACES      TO IN402-ATT-GMM-FIR-NAME           18465710
I28545             MOVE SPACES      TO IN402-ATT-DMM-LAST-NAME          18465810
I28545             MOVE SPACES      TO IN402-ATT-DMM-FIR-NAME           18465910
I28545             MOVE SPACES      TO IN402-ATT-BYR-LAST-NAME          18466010
I28545             MOVE SPACES      TO IN402-ATT-BYR-FIR-NAME           18466110
I28545             MOVE SPACES      TO IN402-ATT-MDSEAR-DESC            18466210
28545              SET IN402-PV-ATT-NOT-FOUND TO TRUE                   18466310
28545              SET IN402-PV-ATT-SQL-ERROR TO TRUE                   18466410
28545              SET IN402-PV-MBS-LOOKUP    TO TRUE                   18466510
28545              SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  18466610
28545              MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              18466710
28545              STRING '  PARA: IN402-VSM-MBS-LOOKUP - '             18466810
28545                                        DELIMITED BY SIZE          18466901
28545                     IN402-PV-SKU-IN DELIMITED BY SIZE             18467010
28545                     '  ' DELIMITED BY SIZE                        18467101
28545                     IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         18467210
28545                     '  ' DELIMITED BY SIZE                        18467301
28545                     IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        18467410
28545                     '  ' DELIMITED BY SIZE                        18467501
28545                     IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         18467610
28545                     '  ' DELIMITED BY SIZE                        18467701
28545                               INTO IN402-PV-PARAGRAPH             18467810
28545      END-EVALUATE.                                                18467901
28545                                                                   18468001
I28545******************************************************************18468101
I28545* IN402-VSM-MBS-BYR-LOOKUP.                                       18468210
I28545******************************************************************18468301
I28545 IN402-VSM-MBS-BYR-LOOKUP.                                        18468410
I28545                                                                  18468501
I28545     MOVE SKXREF-DEPT             TO IN402-CONVERT-DEPT.          18468610
I28545     MOVE IN402-CONVERT-DEPT      TO IN402-PV-WORK-DEPT.          18468710
I28545                                                                  18468801
I28545     EXEC SQL                                                     18468901
I28545       SELECT B.WORKER_LAST_NAME                                  18469001
I28545             ,B.WORKER_FIR_NAME                                   18469101
I28545       INTO :IN402-ATT-BYR-LAST-NAME                              18469210
I28545           ,:IN402-ATT-BYR-FIR-NAME                               18469310
I28545       FROM TMDSEAR A,                                            18469401
I28545            TRSPBAR B                                             18469501
I28545       WHERE A.OPERCO_NBR = '03'                                  18469601
I28545         AND GMA_NBR = :IN402-ATT-GMA-NBR                         18469710
I28545         AND DMA_NBR = :IN402-ATT-DMA-NBR                         18469810
I28545         AND DEPT_NBR = :IN402-PV-WORK-DEPT-3X                    18469910
I28545         AND MAJ_CL_NBR = '00'                                    18470001
I28545         AND SUB_CL_NBR = '000'                                   18480001
I28545         AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                        18490001
I28545         AND B.WORKER_NBR > DECIMAL(0)                            18500001
I28545         AND B.RSPLVL_CDE  = 'BYR'                                18510001
I28545         AND (:IN402-PV-EFF-BEG-DTE-X >= B.WORKER_STRT_DTE AND    18520010
I28545              :IN402-PV-EFF-BEG-DTE-X <= B.WORKER_END_DTE)        18530010
I28545       WITH UR                                                    18540001
I28545     END-EXEC.                                                    18550001
I28545                                                                  18560001
I28545     EVALUATE TRUE                                                18570001
I28545         WHEN SQLCODE = 0                                         18580001
I28545             SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE              18590010
I28545             SET IN402-PS-ATTR-FOUND TO TRUE                      18600010
I28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              18610010
I28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               18620010
I28545         WHEN SQLCODE = +100                                      18630001
I28545             MOVE SPACES      TO IN402-ATT-BYR-LAST-NAME          18640010
I28545             MOVE SPACES      TO IN402-ATT-BYR-FIR-NAME           18650010
I28545             SET IN402-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           18660010
I28545             SET IN402-PS-ATTR-FOUND TO TRUE                      18670010
I28545             MOVE ZEROS       TO IN402-PV-ATT-SQLCDE              18680010
I28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               18690010
I28545         WHEN OTHER                                               18700001
I28545             MOVE SPACES      TO IN402-ATT-BYR-LAST-NAME          18710010
I28545             MOVE SPACES      TO IN402-ATT-BYR-FIR-NAME           18720010
I28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   18730010
I28545             SET IN402-PV-ATT-SQL-ERROR TO TRUE                   18740010
I28545             SET IN402-PV-MBS-LOOKUP    TO TRUE                   18750010
I28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  18760010
I28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              18770010
I28545             STRING '  PARA: IN402-VSM-MBS-BYR-LOOKUP - '         18780010
I28545                                       DELIMITED BY SIZE          18790001
I28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             18800010
I28545                    '  ' DELIMITED BY SIZE                        18810001
I28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         18820010
I28545                    '  ' DELIMITED BY SIZE                        18830001
I28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        18840010
I28545                    '  ' DELIMITED BY SIZE                        18850001
I28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         18860010
I28545                    '  ' DELIMITED BY SIZE                        18870001
I28545                              INTO IN402-PV-PARAGRAPH             18880010
I28545     END-EVALUATE.                                                18890001
I28545                                                                  18900001
I28545******************************************************************18910001
I28545* IN402-VSM-MBS-DMM-LOOKUP.                                       18920010
I28545******************************************************************18930001
I28545 IN402-VSM-MBS-DMM-LOOKUP.                                        18940010
I28545                                                                  18950001
I28545     EXEC SQL                                                     18960001
I28545       SELECT B.WORKER_LAST_NAME                                  18970001
I28545             ,B.WORKER_FIR_NAME                                   18980001
I28545       INTO :IN402-ATT-DMM-LAST-NAME                              18990010
I28545           ,:IN402-ATT-DMM-FIR-NAME                               19000010
I28545       FROM TMDSEAR A,                                            19010001
I28545            TRSPBAR B                                             19020001
I28545       WHERE A.OPERCO_NBR = '03'                                  19030001
I28545         AND GMA_NBR = :IN402-ATT-GMA-NBR                         19040010
I28545         AND DMA_NBR = :IN402-ATT-DMA-NBR                         19050010
I28545         AND DEPT_NBR = '000'                                     19060001
I28545         AND MAJ_CL_NBR = '00'                                    19070001
I28545         AND SUB_CL_NBR = '000'                                   19080001
I28545         AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                        19090001
I28545         AND B.WORKER_NBR > DECIMAL(0)                            19100001
I28545         AND B.RSPLVL_CDE  = 'DMM'                                19110001
I28545         AND (:IN402-PV-EFF-BEG-DTE-X >= B.WORKER_STRT_DTE AND    19120010
I28545              :IN402-PV-EFF-BEG-DTE-X <= B.WORKER_END_DTE)        19130010
I28545       WITH UR                                                    19140001
I28545     END-EXEC.                                                    19150001
I28545                                                                  19160001
I28545     EVALUATE TRUE                                                19170001
I28545         WHEN SQLCODE = 0                                         19180001
I28545             SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE              19190010
I28545             SET IN402-PS-ATTR-FOUND TO TRUE                      19200010
I28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              19210010
I28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               19220010
I28545         WHEN SQLCODE = +100                                      19230001
I28545             MOVE SPACES      TO IN402-ATT-DMM-LAST-NAME          19240010
I28545             MOVE SPACES      TO IN402-ATT-DMM-FIR-NAME           19250010
I28545             SET IN402-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           19260010
I28545             SET IN402-PS-ATTR-FOUND TO TRUE                      19270010
I28545             MOVE ZEROS       TO IN402-PV-ATT-SQLCDE              19280010
I28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               19290010
I28545         WHEN OTHER                                               19300001
I28545             MOVE SPACES      TO IN402-ATT-DMM-LAST-NAME          19310010
I28545             MOVE SPACES      TO IN402-ATT-DMM-FIR-NAME           19320010
I28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   19330010
I28545             SET IN402-PV-ATT-SQL-ERROR TO TRUE                   19340010
I28545             SET IN402-PV-MBS-LOOKUP    TO TRUE                   19350010
I28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  19360010
I28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              19370010
I28545             STRING '  PARA: IN402-VSM-MBS-DMM-LOOKUP - '         19380010
I28545                                       DELIMITED BY SIZE          19390001
I28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             19400010
I28545                    '  ' DELIMITED BY SIZE                        19410001
I28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         19420010
I28545                    '  ' DELIMITED BY SIZE                        19430001
I28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        19440010
I28545                    '  ' DELIMITED BY SIZE                        19450001
I28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         19460010
I28545                    '  ' DELIMITED BY SIZE                        19470001
I28545                              INTO IN402-PV-PARAGRAPH             19480010
I28545     END-EVALUATE.                                                19490001
I28545                                                                  19500001
I28545******************************************************************19510001
I28545* IN402-VSM-MBS-GMM-LOOKUP.                                       19520010
I28545******************************************************************19530001
I28545 IN402-VSM-MBS-GMM-LOOKUP.                                        19540010
I28545                                                                  19550001
I28545     EXEC SQL                                                     19560001
I28545       SELECT B.WORKER_LAST_NAME                                  19570001
I28545             ,B.WORKER_FIR_NAME                                   19580001
I28545       INTO :IN402-ATT-GMM-LAST-NAME                              19590010
I28545           ,:IN402-ATT-GMM-FIR-NAME                               19600010
I28545       FROM TMDSEAR A,                                            19610001
I28545            TRSPBAR B                                             19620001
I28545       WHERE A.OPERCO_NBR = '03'                                  19630001
I28545         AND GMA_NBR = :IN402-ATT-GMA-NBR                         19640010
I28545         AND DMA_NBR = '00'                                       19650001
I28545         AND DEPT_NBR = '000'                                     19660001
I28545         AND MAJ_CL_NBR = '00'                                    19670001
I28545         AND SUB_CL_NBR = '000'                                   19680001
I28545         AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                        19690001
I28545         AND B.WORKER_NBR > DECIMAL(0)                            19700001
I28545         AND B.RSPLVL_CDE  = 'GMM'                                19710001
I28545         AND (:IN402-PV-EFF-BEG-DTE-X >= B.WORKER_STRT_DTE AND    19720010
I28545              :IN402-PV-EFF-BEG-DTE-X <= B.WORKER_END_DTE)        19730010
I28545       WITH UR                                                    19740001
I28545     END-EXEC.                                                    19750001
I28545                                                                  19760001
I28545     EVALUATE TRUE                                                19770001
I28545         WHEN SQLCODE = 0                                         19780001
I28545             SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE              19790010
I28545             SET IN402-PS-ATTR-FOUND TO TRUE                      19800010
I28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              19810010
I28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               19820010
I28545         WHEN SQLCODE = +100                                      19830001
I28545             MOVE SPACES      TO IN402-ATT-GMM-LAST-NAME          19840010
I28545             MOVE SPACES      TO IN402-ATT-GMM-FIR-NAME           19850010
I28545             SET IN402-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           19851010
I28545             SET IN402-PS-ATTR-FOUND TO TRUE                      19852010
I28545             MOVE ZEROS       TO IN402-PV-ATT-SQLCDE              19853010
I28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               19854010
I28545         WHEN OTHER                                               19855001
I28545             MOVE SPACES      TO IN402-ATT-GMM-LAST-NAME          19855110
I28545             MOVE SPACES      TO IN402-ATT-GMM-FIR-NAME           19855210
I28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   19855310
I28545             SET IN402-PV-ATT-SQL-ERROR TO TRUE                   19855410
I28545             SET IN402-PV-MBS-LOOKUP    TO TRUE                   19855510
I28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  19855610
I28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              19855710
I28545             STRING '  PARA: IN402-VSM-MBS-GMM-LOOKUP - '         19855810
I28545                                       DELIMITED BY SIZE          19855901
I28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             19856010
I28545                    '  ' DELIMITED BY SIZE                        19857001
I28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         19857110
I28545                    '  ' DELIMITED BY SIZE                        19857201
I28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        19857310
I28545                    '  ' DELIMITED BY SIZE                        19857401
I28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         19857510
I28545                    '  ' DELIMITED BY SIZE                        19857601
I28545                              INTO IN402-PV-PARAGRAPH             19857710
I28545     END-EVALUATE.                                                19857801
I28545                                                                  19857901
F28545******************************************************************19858001
F28545* IN402-VSM-MBS-DESC-LOOKUP.                                      19858110
F28545******************************************************************19858201
F28545 IN402-VSM-MBS-DESC-LOOKUP.                                       19858310
F28545                                                                  19858401
F28545     MOVE SKXREF-DEPT             TO IN402-CONVERT-DEPT.          19858510
F28545     MOVE IN402-CONVERT-DEPT      TO IN402-PV-WORK-DEPT.          19858610
F28545                                                                  19858701
F28545     MOVE SKXREF-CLASS            TO IN402-CONVERT-MCL.           19858810
F28545     MOVE IN402-CONVERT-MCL       TO IN402-PV-WORK-MCL.           19858910
F28545                                                                  19859001
F28545     MOVE SKXREF-SUBCLASS         TO IN402-CONVERT-SCL.           19859110
F28545     MOVE IN402-CONVERT-SCL       TO IN402-PV-WORK-SCL.           19859210
F28545                                                                  19859301
F28545     EXEC SQL                                                     19859401
F28545          SELECT MDSEAR_DESC                                      19859501
F28545          INTO :IN402-ATT-MDSEAR-DESC                             19859610
F28545          FROM TMDSEAR A,                                         19859701
F28545               TAPLAVL B                                          19859801
F28545          WHERE A.OPERCO_NBR = '03'                               19859901
I28545            AND A.GMA_NBR = :IN402-ATT-GMA-NBR                    19860010
I28545            AND A.DMA_NBR = :IN402-ATT-DMA-NBR                    19860110
F28545            AND A.DEPT_NBR = :IN402-PV-WORK-DEPT-3X               19860210
F28545            AND A.MAJ_CL_NBR = :IN402-PV-WORK-MCL-2X              19860310
F28545            AND A.SUB_CL_NBR = :IN402-PV-WORK-SCL-3X              19860410
F28545            AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                     19860501
F28545            AND APLSYS_CDE = 'IN'                                 19860601
F28545        WITH UR                                                   19860701
F28545     END-EXEC.                                                    19860801
F28545                                                                  19860901
F28545     EVALUATE TRUE                                                19861001
F28545         WHEN SQLCODE = 0                                         19861101
F28545             SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE              19861210
F28545             SET IN402-PS-ATTR-FOUND TO TRUE                      19861310
F28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              19861410
F28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               19861510
F28545         WHEN SQLCODE = +100                                      19861601
F28545             MOVE SPACES      TO IN402-ATT-MDSEAR-DESC            19861710
F28545             SET IN402-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           19861810
F28545             SET IN402-PS-ATTR-FOUND TO TRUE                      19861910
F28545             MOVE ZEROS       TO IN402-PV-ATT-SQLCDE              19862010
F28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               19863010
F28545         WHEN OTHER                                               19863101
F28545             MOVE SPACES      TO IN402-ATT-MDSEAR-DESC            19863210
F28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   19863310
F28545             SET IN402-PV-ATT-SQL-ERROR TO TRUE                   19863410
F28545             SET IN402-PV-MBS-LOOKUP    TO TRUE                   19863510
F28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  19863610
F28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              19863710
F28545             STRING '  PARA: IN402-VSM-MBS-DESC-LOOKUP - '        19863810
F28545                                       DELIMITED BY SIZE          19863901
F28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             19864010
F28545                    '  ' DELIMITED BY SIZE                        19864101
F28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         19864210
F28545                    '  ' DELIMITED BY SIZE                        19864301
F28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        19864410
F28545                    '  ' DELIMITED BY SIZE                        19864501
F28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         19864610
F28545                    '  ' DELIMITED BY SIZE                        19864701
F28545                              INTO IN402-PV-PARAGRAPH             19864810
F28545     END-EVALUATE.                                                19864901
F28545                                                                  19865001
28545 ******************************************************************19866001
28545 * IN402-VSM-ATTRIB-OUTPUT.                                        19867010
28545 ******************************************************************19867101
28545  IN402-VSM-ATTRIB-OUTPUT.                                         19867210
28545                                                                   19867301
Z28545     MOVE SKXREF-SKU              TO IN402-ATT-SKU-OUT.           19867410
Z28545                                                                  19867501
Z28545     IF IN402-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   19867610
Z28545         MOVE IN402-PV-UPC-NBR-IN-NUM TO IN402-ATT-UPC-OUT        19867710
Z28545     ELSE                                                         19867801
Z28545         MOVE UPC-UPC-NBR             TO IN402-ATT-UPC-OUT        19867910
Z28545     END-IF.                                                      19868001
28545                                                                   19868101
28545      MOVE SKXREF-INTR-UPC-ID      TO IN402-ATT-UPCID-OUT.         19868210
28545      MOVE SKXREF-ITM-NBR          TO IN402-ATT-ITM-NBR-OUT.       19868310
28545                                                                   19868401
28545      MOVE SKXREF-DEPT             TO IN402-ATT-DEPT-OUT.          19868510
28545      MOVE SKXREF-CLASS            TO IN402-ATT-MCL-OUT.           19868610
28545      MOVE SKXREF-SUBCLASS         TO IN402-ATT-SCL-OUT.           19868710
28545      MOVE SKXREF-SKU-STAT-CDE     TO IN402-ATT-STATUS-OUT.        19868810
28545                                                                   19868901
28545      MOVE UPC-SUB-CL-MDSEAR-ID    TO IN402-ATT-MDEAR-ID-OUT.      19869010
28545      MOVE MDARVS-RMS-STYL-ID      TO IN402-ATT-STYL-ID-OUT.       19870010
RONNA      MOVE MDARVS-LBL-SEQ-NBR      TO IN402-ATT-LBL-SEQ-NBR-OUT.   19880010
28545      MOVE UPC-VS-ID               TO IN402-ATT-VS-ID-OUT.         19890010
28545      MOVE VNDSTL-VS-NBR           TO IN402-ATT-VS-NBR-OUT.        19900010
28545                                                                   19910001
28545      MOVE VNDSTL-ENT-ID           TO IN402-ATT-ENT-ID-OUT.        19920010
28545      MOVE EXTENT-DUN-NBR          TO IN402-ATT-DUNS-NBR-OUT.      19930010
28545      MOVE VNDDPT-INHOUSE-NBR      TO IN402-ATT-INHSE-NBR-OUT.     19940010
D28545     MOVE TUPCSKU-PLU-DWNLD-IND   TO IN402-ATT-PLU-DWNLD-IND.     19950010
28545                                                                   19960001
28545 ******************************************************************19970001
28545 ******************************************************************19980001
28545 ******************************************************************19990001
28545 * IN402-VSM-VENDOR-ATTRIB-LOOKUP.                                 20000010
28545 ******************************************************************20010001
28545  IN402-VSM-VENDOR-ATTRIB-LOOKUP.                                  20020010
BV                                                                      20030001
RONNA *    SET BV003-PV-UPC-ID-LOOKUP TO TRUE.                          20040011
RONNA      SET BV003-PV-BRND-VND-DPT-LOOKUP TO TRUE.                    20050011
BV                                                                      20060001
BV    **** MOVE UPCPLS-EFF-BEG-TMST (1:10) TO BV003-PV-EFF-DTE-IN.      20070011
BV         MOVE IN402-PV-EFF-DTE-IN   TO BV003-PV-EFF-DTE-IN.           20080011
RONNA *    MOVE SKXREF-INTR-UPC-ID    TO BV003-PV-UPC-ID-IN-9.          20090011
RONNA      IF IN402-PV-ENT-ID-IN = SPACES                               20100010
BV            MOVE VNDSTL-ENT-ID      TO BV003-PV-ENT-ID-IN-9           20110011
RONNA      ELSE                                                         20120001
RONNA         MOVE IN402-PV-ENT-ID-IN-9                                 20130010
RONNA                                 TO BV003-PV-ENT-ID-IN-9           20140011
RONNA      END-IF.                                                      20150001
RONNA                                                                   20160001
RONNA      IF IN402-PV-DEPT-IN = SPACES                                 20170010
BV            MOVE SKXREF-DEPT        TO BV003-PV-DEPT-IN-9             20180011
RONNA      ELSE                                                         20190001
RONNA         MOVE IN402-PV-DEPT-IN-9 TO BV003-PV-DEPT-IN-9             20200011
RONNA      END-IF.                                                      20210001
RONNA                                                                   20220001
RONNA      MOVE MDARVS-LBL-SEQ-NBR    TO BV003-PV-BRAND-IN-9.           20230011
RONNA                                                                   20240001
RONNA *    DISPLAY ' IN IN402-INV-VENDOR-ATTRIB-LOOKUP ****'.           20241010
RONNA *    DISPLAY ' BV003-PV-ENT-ID-IN-9: ' BV003-PV-ENT-ID-IN-9.      20242011
RONNA *    DISPLAY ' BV003-PV-BRAND-IN-9 : ' BV003-PV-BRAND-IN-9.       20243011
RONNA *    DISPLAY ' BV003-PV-EFF-DTE-IN : ' BV003-PV-EFF-DTE-IN.       20243111
RONNA *    DISPLAY ' BV003-PV-DEPT-IN-9  : ' BV003-PV-DEPT-IN-9.        20243211
BV                                                                      20243301
BV         PERFORM BV003-LOOKUP-MAIN.                                   20243411
BV         IF BV003-PV-FOUND-REL-OR-UNK  OR                             20243511
RONNA         BV003-PAST-OR-FUT-DBV-REL-FND                             20243611
BV            SET IN402-PS-ATTR-FOUND TO TRUE                           20243710
RONNA         SET IN402-PS-BVUTIL-FOUND TO TRUE                         20243810
RONNA         IF IN402-PS-DBV-NO-ASSUMP                                 20243910
RONNA            SET IN402-PV-DBV-FOUND             TO TRUE             20244010
RONNA         ELSE                                                      20245001
RONNA            SET IN402-PV-DBV-FOUND-WITH-ASSMPT TO TRUE             20246010
RONNA         END-IF                                                    20247001
BV         ELSE                                                         20248001
BV                 MOVE ZEROS       TO BV003-PV-DEPT-OUT                20249011
BV                 MOVE ZEROS       TO BV003-PV-ENT-ID-OUT              20250011
BV                 MOVE ZEROS       TO BV003-PV-RLTNSHP-ID-OUT          20260011
BV                 MOVE ZEROS       TO BV003-PV-BRAND-OUT               20270011
BV                 SET IN402-PV-ATT-NOT-FOUND TO TRUE                   20280010
BV                 SET IN402-PV-BRAND-LOOKUP  TO TRUE                   20290010
BV                 SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  20291010
RONNA              SET IN402-PV-DBV-NOT-FOUND  TO TRUE                  20292010
BV                 MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              20293010
BV                 STRING '  PARA: IN402-VSM-VENDOR-ATTRIB-LOOKUP - '   20294010
BV                                           DELIMITED BY SIZE          20295001
BV                        IN402-PV-SKU-IN DELIMITED BY SIZE             20296010
BV                        '  ' DELIMITED BY SIZE                        20297001
BV                        IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         20298010
BV                        '  ' DELIMITED BY SIZE                        20299001
BV                        IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        20300010
BV                        '  ' DELIMITED BY SIZE                        20310001
BV                        IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         20320010
BV                        '  ' DELIMITED BY SIZE                        20330001
BV                                  INTO IN402-PV-PARAGRAPH             20340010
BV         END-IF.                                                      20350001
BV                                                                      20360001
28545 ******************************************************************20370001
28545 * IN402-VSM-VENDOR-OUTPUT.                                        20380010
28545 ******************************************************************20390001
28545  IN402-VSM-VENDOR-OUTPUT.                                         20400010
28545                                                                   20410001
Z28545     MOVE SKXREF-SKU              TO IN402-VND-SKU-OUT.           20420010
Z28545                                                                  20430001
Z28545     IF IN402-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   20440010
Z28545         MOVE IN402-PV-UPC-NBR-IN-NUM TO IN402-VND-UPC-OUT        20450010
Z28545     ELSE                                                         20460001
Z28545         MOVE UPC-UPC-NBR             TO IN402-VND-UPC-OUT        20470010
Z28545     END-IF.                                                      20480001
28545                                                                   20490001
28545      MOVE SKXREF-INTR-UPC-ID      TO IN402-VND-UPCID-OUT.         20500010
28545      MOVE SKXREF-ITM-NBR          TO IN402-VND-ITM-NBR-OUT.       20510010
28545                                                                   20520001
BV         MOVE BV003-PV-DEPT-OUT       TO IN402-VND-DEPT-OUT.          20530011
BV         MOVE BV003-PV-ENT-ID-OUT     TO IN402-VND-ENT-ID-OUT.        20540011
BV         MOVE BV003-PV-RLTNSHP-ID-OUT TO IN402-VND-ML-LO-MDSE-LVL-ID. 20550011
BV         MOVE BV003-PV-BRAND-OUT      TO IN402-VND-LBL-SEQ-NBR.       20560011
BV                                                                      20570001
28545 ******************************************************************20580001
28545 ******************************************************************20590001
28545 ******************************************************************20600001
28545 * IN402-INV-PROCEED-WITH-LOOKUP.                                  20610010
28545 ******************************************************************20620001
28545  IN402-INV-PROCEED-WITH-LOOKUP.                                   20630010
28545                                                                   20640001
28545      EVALUATE TRUE                                                20650001
D28545*** PRICE LOOKUP.....                                             20660001
RONNA *      WHEN IN402-PV-SKU-LOOKUP                                   20670010
RONNA        WHEN IN402-PV-SKU-ASKU-LOOK                                20680010
28545          IF IN402-PV-SKU-IN = SPACES                              20690010
28545             OR IN402-PV-SKU-IN NOT NUMERIC                        20700010
28545             OR IN402-PV-SKU-IN = ZEROES                           20710010
D28545             PERFORM IN402-INV-LOOKUP-DEFAULT                     20720010
D28545         ELSE                                                     20730001
D28545         IF IN402-PV-DUMMY-SKU                                    20740010
D28545             MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-WORK-SKU        20750010
D28545             MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-DUMB-SKU        20760010
D28545             PERFORM IN402-DUMMY-SKU-LOOKUP                       20770010
D28545         ELSE                                                     20780001
28545              MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-WORK-SKU        20790010
28545              PERFORM IN402-INV-LOOKUP-BY-SKU                      20800010
28545          END-IF                                                   20810001
D28545         END-IF                                                   20820001
RONNA *      WHEN IN402-PV-UPC-NBR-LOOKUP                               20830010
RONNA        WHEN IN402-PV-UPC-AUPC-LOOK                                20840010
28545          IF IN402-PV-UPC-NBR-IN = SPACES                          20850010
28545             OR IN402-PV-UPC-NBR-IN NOT NUMERIC                    20860010
28545             OR IN402-PV-UPC-NBR-IN = ZEROES                       20870010
D28545             PERFORM IN402-INV-LOOKUP-DEFAULT                     20880010
D28545         ELSE                                                     20890001
I28545           IF (IN402-PV-KOHLS-UPC AND IN402-PV-DUMMY-UPC)         20900010
RONNA *            MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-WORK-SKU        20910010
RONNA *            MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-DUMB-SKU        20920010
RONNA              MOVE IN402-PV-UPC-SKU-9  TO IN402-PV-WORK-SKU        20930010
RONNA                                          IN402-PV-DUMB-SKU        20940010
D28545             PERFORM IN402-DUMMY-SKU-LOOKUP                       20950010
28545          ELSE                                                     20960001
28545              MOVE IN402-PV-UPC-NBR-IN-NUM                         20970010
28545                                    TO IN402-PV-WORK-UPC-NBR       20980010
28545              PERFORM IN402-INV-LOOKUP-BY-UPC                      20990010
28545          END-IF                                                   21000001
D28545         END-IF                                                   21010001
RONNA *      WHEN IN402-PV-INTR-UPC-ID-LOOKUP                           21020010
RONNA        WHEN IN402-PV-UPCID-AUPCID-LOOK                            21030010
28545          IF IN402-PV-UPC-ID-SPC <= ZEROES                         21040010
28545              PERFORM IN402-INV-LOOKUP-DEFAULT                     21050010
28545          ELSE                                                     21060001
28545              MOVE IN402-PV-UPC-ID-SPC TO IN402-PV-WORK-UPC-ID     21070010
28545              PERFORM IN402-INV-LOOKUP-BY-UPC-ID                   21080010
28545          END-IF                                                   21090001
RONNA *      WHEN IN402-PV-ITM-NBR-LOOKUP                               21100010
RONNA        WHEN IN402-PV-ITM-AITM-LOOK                                21110010
28545          IF IN402-PV-ITM-NBR-IN = SPACES                          21120010
28545             OR IN402-PV-ITM-NBR-IN NOT NUMERIC                    21130010
28545             OR IN402-PV-ITM-NBR-IN = ZEROES                       21140010
28545              PERFORM IN402-INV-LOOKUP-DEFAULT                     21150010
28545          ELSE                                                     21160001
28545              MOVE IN402-PV-ITM-NBR-IN-NUM                         21170010
28545                                      TO IN402-PV-WORK-ITM-NBR     21180010
28545              PERFORM IN402-INV-LOOKUP-BY-ITM-NBR                  21190010
28545          END-IF                                                   21200001
D28545*** ATTRIBUTE LOOKUP.....                                         21210001
RONNA ****** THE FOLLOWING IS COMMENTED OUT BECAUSE THE WHEN'S HERE     21220001
RONNA ****** HAVE BEEN ADDED ABOVE                                      21221001
28545 *      WHEN IN402-PV-SKU-ATTRIB-LOOK                              21222010
28545 *          IF IN402-PV-SKU-IN = SPACES                            21223010
28545 *            OR IN402-PV-SKU-IN NOT NUMERIC                       21224010
28545 *            OR IN402-PV-SKU-IN = ZEROES                          21225010
D28545*              PERFORM IN402-INV-LOOKUP-DEFAULT                   21226010
D28545*          ELSE                                                   21227001
D28545*          IF IN402-PV-DUMMY-SKU                                  21228010
D28545*              MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-WORK-SKU      21229010
D28545*              MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-DUMB-SKU      21230010
D28545*              PERFORM IN402-DUMMY-SKU-LOOKUP                     21240010
D28545*          ELSE                                                   21250001
28545 *              MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-WORK-SKU      21260010
28545 *              PERFORM IN402-INV-LOOKUP-BY-SKU                    21270010
28545 *          END-IF                                                 21280001
28545 *          END-IF                                                 21290001
28545 *      WHEN IN402-PV-UPC-NBR-ATTRIB-LOOK                          21300010
28545 *          IF IN402-PV-UPC-NBR-IN = SPACES                        21310010
28545 *            OR IN402-PV-UPC-NBR-IN NOT NUMERIC                   21320010
28545 *            OR IN402-PV-UPC-NBR-IN = ZEROES                      21330010
D28545*               PERFORM IN402-INV-LOOKUP-DEFAULT                  21340010
D28545*          ELSE                                                   21350001
I28545*          IF (IN402-PV-KOHLS-UPC AND IN402-PV-DUMMY-UPC)         21360010
D28545*              MOVE IN402-PV-UPC-SKU-9 TO IN402-PV-WORK-SKU       21370010
D28545*              MOVE IN402-PV-UPC-SKU-9 TO IN402-PV-DUMB-SKU       21380010
D28545*              PERFORM IN402-DUMMY-SKU-LOOKUP                     21390010
28545 *          ELSE                                                   21400001
28545 *              MOVE IN402-PV-UPC-NBR-IN-NUM                       21410010
28545 *                                        TO IN402-PV-WORK-UPC-NBR 21420010
28545 *              PERFORM IN402-INV-LOOKUP-BY-UPC                    21430010
28545 *          END-IF                                                 21440001
28545 *          END-IF                                                 21450001
28545 *      WHEN IN402-PV-INTUPCID-ATTRIB-LOOK                         21460010
28545 *          IF IN402-PV-UPC-ID-SPC <= ZEROES                       21470010
D28545*              PERFORM IN402-INV-LOOKUP-DEFAULT                   21480010
28545 *          ELSE                                                   21490001
28545 *              MOVE IN402-PV-UPC-ID-SPC                           21500010
28545 *                                     TO IN402-PV-WORK-UPC-ID     21510010
28545 *                PERFORM IN402-INV-LOOKUP-BY-UPC-ID               21520010
28545 *          END-IF                                                 21530001
28545 *      WHEN IN402-PV-ITEM-ATTRIB-LOOK                             21540010
28545 *          IF IN402-PV-ITM-NBR-IN = SPACES                        21550010
28545 *              OR IN402-PV-ITM-NBR-IN NOT NUMERIC                 21560010
28545 *              OR IN402-PV-ITM-NBR-IN = ZEROES                    21570010
D28545*              PERFORM IN402-INV-LOOKUP-DEFAULT                   21580010
28545 *          ELSE                                                   21590001
28545 *              MOVE IN402-PV-ITM-NBR-IN-NUM                       21600010
28545 *                                     TO IN402-PV-WORK-ITM-NBR    21610010
28545 *              PERFORM IN402-INV-LOOKUP-BY-ITM-NBR                21620010
28545 *          END-IF                                                 21630001
D28545*** LOOKUP BASED ON THE PASSED PARAMETERS......                   21640001
             WHEN OTHER                                                 21650001
                 PERFORM IN402-INV-LOOKUP-DEFAULT                       21660010
28545      END-EVALUATE.                                                21670001
28545                                                                   21680001
28545 ******************************************************************21690001
28545 * IN402-INV-LOOKUP-BY-SKU.                                        21700010
28545 ******************************************************************21710001
28545  IN402-INV-LOOKUP-BY-SKU.                                         21720010
28545                                                                   21730001
28545      INITIALIZE DCLINT00003.                                      21740001
28545      MOVE ZEROS          TO IN402-PV-WORK-RETAIL.                 21750010
28545                                                                   21760001
28545 *** STORE SPECIFIC - SKU_STYLE DELETE TABLE PRICE LOOKUP....      21770001
D28545     MOVE ZEROS            TO IN402-PV-PRC-SQLCDE.                21780010
D28545     MOVE ZEROS            TO IN402-PV-RETURN-CDE.                21790010
D28545     MOVE ZEROS            TO IN402-PV-ATT-SQLCDE.                21800010
D28545     MOVE ZEROS            TO IN402-PV-ATT-RTNCDE.                21810010
D28545     MOVE SPACES           TO IN402-PV-RETURN-RSN.                21820010
28545      MOVE 'N'            TO IN402-PS-PRIOR-FOUND-SW.              21830010
28545      MOVE 'N'            TO IN402-PS-END-SKUSTYL-CSR-SW.          21840010
28545      MOVE IN402-PV-WORK-SKU         TO INT00003-SKU-NBR.          21850010
28545      MOVE IN402-PV-LOC-IN-NUM       TO INT00003-LOC-NBR           21860010
28545      MOVE IN402-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST      21870010
28545                                        INT00003-EFF-END-TMST.     21880001
28545                                                                   21890001
28545      PERFORM IN402-OPEN-SKUSTYL-SKU-CSR.                          21900010
28545      PERFORM IN402-FETCH-SKUSTYL-SKU-CSR                          21910010
28545        UNTIL IN402-PRIOR-FOUND                                    21920010
28545           OR IN402-PS-END-SKUSTYL-CSR.                            21930010
28545      PERFORM IN402-CLOSE-SKUSTYL-SKU-CSR.                         21940010
28545                                                                   21950001
28545 *** CORPORATE - SKU_STYLE DELETE TABLE PRICE LOOKUP....           21960001
28545      IF IN402-PRIOR-NOT-FOUND                                     21970010
D28545         MOVE ZEROS             TO IN402-PV-PRC-SQLCDE            21980010
D28545         MOVE ZEROS             TO IN402-PV-RETURN-CDE            21990010
D28545         MOVE ZEROS             TO IN402-PV-ATT-SQLCDE            22000010
D28545         MOVE ZEROS             TO IN402-PV-ATT-RTNCDE            22010010
D28545         MOVE SPACES            TO IN402-PV-RETURN-RSN            22020010
28545          MOVE 'N'               TO IN402-PS-PRIOR-FOUND-SW        22030010
28545          MOVE 'N'               TO IN402-PS-END-SKUSTYL-CSR-SW    22040010
28545          MOVE IN402-PV-WORK-SKU TO INT00003-SKU-NBR               22050010
28545          MOVE ZEROS             TO INT00003-LOC-NBR               22060001
28545          MOVE IN402-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST  22070010
28545                                            INT00003-EFF-END-TMST  22080001
28545          PERFORM IN402-OPEN-SKUSTYL-SKU-CSR                       22090010
28545          PERFORM IN402-FETCH-SKUSTYL-SKU-CSR                      22100010
28545            UNTIL IN402-PRIOR-FOUND                                22110010
28545               OR IN402-PS-END-SKUSTYL-CSR                         22120010
28545          PERFORM IN402-CLOSE-SKUSTYL-SKU-CSR                      22130010
28545      END-IF.                                                      22140001
28545                                                                   22150001
28545 *** PRICE FOUND....                                               22160001
28545      IF IN402-PRIOR-FOUND                                         22170010
28545          SET IN402-PS-STR-FOUND TO TRUE                           22180010
28545      END-IF.                                                      22190001
28545                                                                   22200001
28545 ******************************************************************22210001
28545 * IN402-OPEN-SKUSTYL-SKU-CSR.                                     22220010
28545 ******************************************************************22230001
28545  IN402-OPEN-SKUSTYL-SKU-CSR.                                      22240010
28545                                                                   22250001
28545      EXEC SQL                                                     22260001
28545           OPEN SKUSTYL-SKU-CSR                                    22270001
28545      END-EXEC.                                                    22280001
28545                                                                   22290001
28545      EVALUATE TRUE                                                22300001
28545          WHEN SQLCODE = +0                                        22310001
D28545             CONTINUE                                             22320001
D28545         WHEN OTHER                                               22330001
D28545             SET IN402-PV-SQL-ERROR     TO TRUE                   22340010
D28545             SET IN402-PV-ATT-SQL-ERROR   TO TRUE                 22350010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   22360010
D28545             SET IN402-PV-CURSOR-OPEN   TO TRUE                   22370010
D28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              22380010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              22390010
D28545             STRING '  PARA: IN402-OPEN-SKUSTYL-SKU-CSR - '       22400010
D28545                                       DELIMITED BY SIZE          22410001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             22420010
D28545                    '  ' DELIMITED BY SIZE                        22430001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         22440010
D28545                    '  ' DELIMITED BY SIZE                        22450001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        22460010
D28545                    '  ' DELIMITED BY SIZE                        22470001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         22480010
D28545                    '  ' DELIMITED BY SIZE                        22490001
D28545                              INTO IN402-PV-PARAGRAPH             22500010
D28545     END-EVALUATE.                                                22510001
28545                                                                   22520001
28545 ******************************************************************22530001
28545 * IN402-FETCH-SKUSTYL-SKU-CSR                                     22540010
28545 ******************************************************************22550001
28545  IN402-FETCH-SKUSTYL-SKU-CSR.                                     22560010
28545                                                                   22570001
28545      EXEC SQL                                                     22580001
28545          FETCH SKUSTYL-SKU-CSR                                    22590001
28545          INTO  :INT00003-UPC-ID                                   22600001
28545               ,:INT00003-LOC-NBR                                  22610001
28545               ,:INT00003-EFF-BEG-TMST                             22620001
28545               ,:INT00003-UPC-NBR                                  22630001
28545               ,:INT00003-EFF-END-TMST :IN402-PV-NULL-EFF-END-TMST 22640010
28545               ,:INT00003-UPC-STAT-CDE :IN402-PV-NULL-UPC-STAT-CDE 22650010
28545               ,:INT00003-UNT-COST-AMT :IN402-PV-NULL-UNT-COST-AMT 22660010
28545               ,:INT00003-UNT-RTL-AMT  :IN402-PV-NULL-UNT-RTL-AMT  22670010
28545               ,:INT00003-MEITGP-NBR   :IN402-PV-NULL-MEITGP-NBR   22680010
28545               ,:INT00003-ITM-NBR                                  22690001
28545               ,:INT00003-INTR-UPC-ID                              22700001
28545               ,:INT00003-UPC-STAT-CHG-DTE                         22710001
28545               ,:INT00003-UNT-RTL-CHG-DTE                          22720001
28545               ,:INT00003-ORIG-CLR-DTE :IN402-PV-NULL-ORIG-CLR-DTE 22730010
28545               ,:INT00003-MKDN-CDE     :IN402-PV-NULL-MKDN-CDE     22740010
28545               ,:INT00003-SUB-CL-MDSEAR-ID                         22750001
28545               ,:INT00003-VS-ID :IN402-PV-NULL-VS-ID               22760010
28545               ,:INT00003-DEPT-NBR                                 22770001
28545               ,:INT00003-MAJ-CL-NBR                               22780001
28545               ,:INT00003-SUB-CL-NBR                               22790001
28545               ,:INT00003-SKU-NBR                                  22800001
28545               ,:INT00003-ENT-ID                                   22810001
28545               ,:INT00003-PLU-DWNLD-IND                            22820001
28545      END-EXEC.                                                    22830001
28545                                                                   22840001
28545      EVALUATE TRUE                                                22850001
28545          WHEN SQLCODE = +0                                        22860001
28545              MOVE INT00003-UNT-RTL-AMT TO IN402-PV-WORK-RETAIL    22870010
28545              PERFORM IN402-INV-GROUP-PRICING                      22880010
28545              SET IN402-PRIOR-FOUND  TO TRUE                       22890010
D28545             SET IN402-PV-FOUND     TO TRUE                       22900010
D28545             SET IN402-PV-ATT-FOUND TO TRUE                       22910010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        22920010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        22930010
D28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               22940010
28545          WHEN SQLCODE = +100                                      22950001
28545              MOVE ZEROS             TO IN402-PV-WORK-RETAIL       22960010
D28545             SET IN402-PV-NOT-FOUND       TO TRUE                 22970010
D28545             SET IN402-PV-ATT-NOT-FOUND   TO TRUE                 22980010
D28545             SET IN402-PV-CURSOR-FETCH    TO TRUE                 22990010
28545              SET IN402-PS-END-SKUSTYL-CSR TO TRUE                 23000010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        23010010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        23020010
D28545             STRING '  PARA: IN402-FETCH-SKUSTYL-SKU-CSR - '      23030010
D28545                                       DELIMITED BY SIZE          23040001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             23050010
D28545                    '  ' DELIMITED BY SIZE                        23060001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         23070010
D28545                    '  ' DELIMITED BY SIZE                        23080001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        23090010
D28545                    '  ' DELIMITED BY SIZE                        23100001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         23110010
D28545                    '  ' DELIMITED BY SIZE                        23120001
D28545                              INTO IN402-PV-PARAGRAPH             23130010
28545          WHEN OTHER                                               23140001
28545              MOVE ZEROS             TO IN402-PV-WORK-RETAIL       23150010
28545              SET IN402-PV-SQL-ERROR TO TRUE                       23160010
D28545             SET IN402-PV-ATT-SQL-ERROR   TO TRUE                 23170010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   23180010
D28545             SET IN402-PV-CURSOR-FETCH    TO TRUE                 23190010
28545              SET IN402-PS-END-SKUSTYL-CSR TO TRUE                 23200010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        23210010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        23220010
D28545             STRING '  PARA: IN402-FETCH-SKUSTYL-SKU-CSR - '      23230010
D28545                                       DELIMITED BY SIZE          23240001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             23250010
D28545                    '  ' DELIMITED BY SIZE                        23260001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         23270010
D28545                    '  ' DELIMITED BY SIZE                        23280001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        23281010
D28545                    '  ' DELIMITED BY SIZE                        23282001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         23283010
D28545                    '  ' DELIMITED BY SIZE                        23284001
D28545                              INTO IN402-PV-PARAGRAPH             23285010
28545      END-EVALUATE.                                                23286001
28545                                                                   23287001
28545 ******************************************************************23288001
28545 * IN402-CLOSE-SKUSTYL-SKU-CSR                                     23289010
28545 ******************************************************************23290001
28545  IN402-CLOSE-SKUSTYL-SKU-CSR.                                     23300010
28545                                                                   23310001
28545      EXEC SQL                                                     23320001
28545          CLOSE SKUSTYL-SKU-CSR                                    23330001
28545      END-EXEC.                                                    23340001
28545                                                                   23350001
28545      EVALUATE TRUE                                                23360001
28545          WHEN SQLCODE = +0                                        23370001
D28545             CONTINUE                                             23380001
28545          WHEN OTHER                                               23390001
D28545             SET IN402-PV-SQL-ERROR     TO TRUE                   23400010
D28545             SET IN402-PV-ATT-SQL-ERROR   TO TRUE                 23410010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   23420010
D28545             SET IN402-PV-CURSOR-CLOSE  TO TRUE                   23430010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        23440010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        23450010
D28545             STRING '  PARA: IN402-CLOSE-SKUSTYL-SKU-CSR - '      23460010
D28545                                       DELIMITED BY SIZE          23470001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             23480010
D28545                    '  ' DELIMITED BY SIZE                        23490001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         23500010
D28545                    '  ' DELIMITED BY SIZE                        23510001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        23520010
D28545                    '  ' DELIMITED BY SIZE                        23530001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         23540010
D28545                    '  ' DELIMITED BY SIZE                        23550001
D28545                              INTO IN402-PV-PARAGRAPH             23560010
28545      END-EVALUATE.                                                23570001
28545                                                                   23580001
28545 ******************************************************************23590001
28545 * IN402-INV-LOOKUP-BY-UPC.                                        23600010
28545 ******************************************************************23610001
28545  IN402-INV-LOOKUP-BY-UPC.                                         23620010
28545                                                                   23630001
28545      INITIALIZE DCLINT00003.                                      23640001
28545      MOVE ZEROS          TO IN402-PV-WORK-RETAIL.                 23650010
28545                                                                   23660001
28545 *** STORE SPECIFIC - SKU_STYLE DELETE TABLE PRICE LOOKUP....      23670001
D28545     MOVE ZEROS            TO IN402-PV-PRC-SQLCDE.                23680010
D28545     MOVE ZEROS            TO IN402-PV-RETURN-CDE.                23690010
D28545     MOVE ZEROS            TO IN402-PV-ATT-SQLCDE.                23700010
D28545     MOVE ZEROS            TO IN402-PV-ATT-RTNCDE.                23710010
D28545     MOVE SPACES           TO IN402-PV-RETURN-RSN.                23720010
28545      MOVE 'N'            TO IN402-PS-PRIOR-FOUND-SW.              23730010
28545      MOVE 'N'            TO IN402-PS-END-SKUSTYL-CSR-SW.          23740010
28545      MOVE IN402-PV-WORK-UPC-NBR     TO INT00003-UPC-NBR.          23750010
28545      MOVE IN402-PV-LOC-IN-NUM       TO INT00003-LOC-NBR           23760010
28545      MOVE IN402-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST      23770010
28545                                        INT00003-EFF-END-TMST.     23780001
28545                                                                   23790001
28545      PERFORM IN402-OPEN-SKUSTYL-UPC-CSR.                          23800010
28545      PERFORM IN402-FETCH-SKUSTYL-UPC-CSR                          23810010
28545        UNTIL IN402-PRIOR-FOUND                                    23820010
28545           OR IN402-PS-END-SKUSTYL-CSR.                            23830010
28545      PERFORM IN402-CLOSE-SKUSTYL-UPC-CSR.                         23840010
28545                                                                   23850001
28545 *** CORPORATE - SKU_STYLE DELETE TABLE PRICE LOOKUP....           23860001
28545      IF IN402-PRIOR-NOT-FOUND                                     23870010
D28545         MOVE ZEROS             TO IN402-PV-PRC-SQLCDE            23880010
D28545         MOVE ZEROS             TO IN402-PV-RETURN-CDE            23890010
D28545         MOVE ZEROS             TO IN402-PV-ATT-SQLCDE            23900010
D28545         MOVE ZEROS             TO IN402-PV-ATT-RTNCDE            23910010
D28545         MOVE SPACES            TO IN402-PV-RETURN-RSN            23920010
28545          MOVE 'N'               TO IN402-PS-PRIOR-FOUND-SW        23930010
28545          MOVE 'N'               TO IN402-PS-END-SKUSTYL-CSR-SW    23940010
28545          MOVE IN402-PV-WORK-UPC-NBR TO INT00003-UPC-NBR           23950010
28545          MOVE ZEROS                 TO INT00003-LOC-NBR           23960001
28545          MOVE IN402-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST  23970010
28545                                            INT00003-EFF-END-TMST  23980001
28545          PERFORM IN402-OPEN-SKUSTYL-UPC-CSR                       23990010
28545          PERFORM IN402-FETCH-SKUSTYL-UPC-CSR                      24000010
28545            UNTIL IN402-PRIOR-FOUND                                24010010
28545               OR IN402-PS-END-SKUSTYL-CSR                         24020010
28545          PERFORM IN402-CLOSE-SKUSTYL-UPC-CSR                      24030010
28545      END-IF.                                                      24040001
28545                                                                   24050001
28545 *** PRICE FOUND....                                               24060001
28545      IF IN402-PRIOR-FOUND                                         24070010
28545          SET IN402-PS-STR-FOUND TO TRUE                           24080010
28545      END-IF.                                                      24090001
28545                                                                   24100001
28545 ******************************************************************24110001
28545 * IN402-OPEN-SKUSTYL-UPC-CSR.                                     24120010
28545 ******************************************************************24130001
28545  IN402-OPEN-SKUSTYL-UPC-CSR.                                      24140010
28545                                                                   24150001
28545      EXEC SQL                                                     24160001
28545           OPEN SKUSTYL-UPC-CSR                                    24170001
28545      END-EXEC.                                                    24180001
28545                                                                   24190001
28545      EVALUATE TRUE                                                24200001
28545          WHEN SQLCODE = +0                                        24210001
D28545             CONTINUE                                             24220001
D28545         WHEN OTHER                                               24230001
D28545             SET IN402-PV-SQL-ERROR     TO TRUE                   24240010
D28545             SET IN402-PV-ATT-SQL-ERROR   TO TRUE                 24250010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   24260010
D28545             SET IN402-PV-CURSOR-OPEN   TO TRUE                   24270010
D28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              24280010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              24290010
D28545             STRING '  PARA: IN402-OPEN-SKUSTYL-UPC-CSR - '       24300010
D28545                                       DELIMITED BY SIZE          24310001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             24320010
D28545                    '  ' DELIMITED BY SIZE                        24330001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         24340010
D28545                    '  ' DELIMITED BY SIZE                        24350001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        24360010
D28545                    '  ' DELIMITED BY SIZE                        24370001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         24380010
D28545                    '  ' DELIMITED BY SIZE                        24390001
D28545                              INTO IN402-PV-PARAGRAPH             24400010
D28545     END-EVALUATE.                                                24410001
28545                                                                   24420001
28545 ******************************************************************24430001
28545 * IN402-FETCH-SKUSTYL-UPC-CSR                                     24440010
28545 ******************************************************************24450001
28545  IN402-FETCH-SKUSTYL-UPC-CSR.                                     24460010
28545                                                                   24470001
28545      EXEC SQL                                                     24480001
28545          FETCH SKUSTYL-UPC-CSR                                    24490001
28545          INTO  :INT00003-UPC-ID                                   24500001
28545               ,:INT00003-LOC-NBR                                  24510001
28545               ,:INT00003-EFF-BEG-TMST                             24520001
28545               ,:INT00003-UPC-NBR                                  24530001
28545               ,:INT00003-EFF-END-TMST :IN402-PV-NULL-EFF-END-TMST 24540010
28545               ,:INT00003-UPC-STAT-CDE :IN402-PV-NULL-UPC-STAT-CDE 24550010
28545               ,:INT00003-UNT-COST-AMT :IN402-PV-NULL-UNT-COST-AMT 24560010
28545               ,:INT00003-UNT-RTL-AMT  :IN402-PV-NULL-UNT-RTL-AMT  24570010
28545               ,:INT00003-MEITGP-NBR   :IN402-PV-NULL-MEITGP-NBR   24580010
28545               ,:INT00003-ITM-NBR                                  24590001
28545               ,:INT00003-INTR-UPC-ID                              24600001
28545               ,:INT00003-UPC-STAT-CHG-DTE                         24610001
28545               ,:INT00003-UNT-RTL-CHG-DTE                          24620001
28545               ,:INT00003-ORIG-CLR-DTE :IN402-PV-NULL-ORIG-CLR-DTE 24630010
28545               ,:INT00003-MKDN-CDE     :IN402-PV-NULL-MKDN-CDE     24640010
28545               ,:INT00003-SUB-CL-MDSEAR-ID                         24650001
28545               ,:INT00003-VS-ID :IN402-PV-NULL-VS-ID               24660010
28545               ,:INT00003-DEPT-NBR                                 24670001
28545               ,:INT00003-MAJ-CL-NBR                               24680001
28545               ,:INT00003-SUB-CL-NBR                               24690001
28545               ,:INT00003-SKU-NBR                                  24700001
28545               ,:INT00003-ENT-ID                                   24710001
28545               ,:INT00003-PLU-DWNLD-IND                            24720001
28545      END-EXEC.                                                    24730001
28545                                                                   24740001
28545      EVALUATE TRUE                                                24750001
28545          WHEN SQLCODE = +0                                        24760001
28545              MOVE INT00003-UNT-RTL-AMT TO IN402-PV-WORK-RETAIL    24770010
28545              PERFORM IN402-INV-GROUP-PRICING                      24780010
28545              SET IN402-PRIOR-FOUND  TO TRUE                       24790010
D28545             SET IN402-PV-FOUND     TO TRUE                       24800010
D28545             SET IN402-PV-ATT-FOUND TO TRUE                       24810010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        24820010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        24830010
D28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               24840010
28545          WHEN SQLCODE = +100                                      24850001
28545              MOVE ZEROS             TO IN402-PV-WORK-RETAIL       24860010
D28545             SET IN402-PV-NOT-FOUND       TO TRUE                 24870010
D28545             SET IN402-PV-ATT-NOT-FOUND   TO TRUE                 24880010
D28545             SET IN402-PV-CURSOR-FETCH    TO TRUE                 24890010
28545              SET IN402-PS-END-SKUSTYL-CSR TO TRUE                 24900010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        24910010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        24920010
D28545             STRING '  PARA: IN402-FETCH-SKUSTYL-UPC-CSR - '      24930010
D28545                                       DELIMITED BY SIZE          24940001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             24950010
D28545                    '  ' DELIMITED BY SIZE                        24960001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         24970010
D28545                    '  ' DELIMITED BY SIZE                        24980001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        24990010
D28545                    '  ' DELIMITED BY SIZE                        24991001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         24992010
D28545                    '  ' DELIMITED BY SIZE                        24993001
D28545                              INTO IN402-PV-PARAGRAPH             24994010
28545          WHEN OTHER                                               24995001
28545              MOVE ZEROS             TO IN402-PV-WORK-RETAIL       24996010
28545              SET IN402-PV-SQL-ERROR TO TRUE                       24997010
28545              SET IN402-PV-ATT-SQL-ERROR   TO TRUE                 24998010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   24999010
D28545             SET IN402-PV-CURSOR-FETCH    TO TRUE                 25000010
28545              SET IN402-PS-END-SKUSTYL-CSR TO TRUE                 25010010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        25020010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        25030010
D28545             STRING '  PARA: IN402-FETCH-SKUSTYL-UPC-CSR - '      25040010
D28545                                       DELIMITED BY SIZE          25050001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             25060010
D28545                    '  ' DELIMITED BY SIZE                        25070001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         25080010
D28545                    '  ' DELIMITED BY SIZE                        25090001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        25100010
D28545                    '  ' DELIMITED BY SIZE                        25110001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         25120010
D28545                    '  ' DELIMITED BY SIZE                        25130001
D28545                              INTO IN402-PV-PARAGRAPH             25140010
28545      END-EVALUATE.                                                25150001
28545                                                                   25160001
28545 ******************************************************************25170001
28545 * IN402-CLOSE-SKUSTYL-UPC-CSR                                     25180010
28545 ******************************************************************25190001
28545  IN402-CLOSE-SKUSTYL-UPC-CSR.                                     25200010
28545                                                                   25210001
28545      EXEC SQL                                                     25220001
28545          CLOSE SKUSTYL-UPC-CSR                                    25230001
28545      END-EXEC.                                                    25240001
28545                                                                   25250001
28545      EVALUATE TRUE                                                25260001
28545          WHEN SQLCODE = +0                                        25270001
D28545             CONTINUE                                             25280001
28545          WHEN OTHER                                               25290001
D28545             SET IN402-PV-SQL-ERROR     TO TRUE                   25300010
D28545             SET IN402-PV-ATT-SQL-ERROR   TO TRUE                 25310010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   25320010
D28545             SET IN402-PV-CURSOR-CLOSE  TO TRUE                   25330010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        25340010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        25350010
D28545             STRING '  PARA: IN402-CLOSE-SKUSTYL-UPC-CSR - '      25360010
D28545                                       DELIMITED BY SIZE          25370001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             25380010
D28545                    '  ' DELIMITED BY SIZE                        25390001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         25400010
D28545                    '  ' DELIMITED BY SIZE                        25410001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        25420010
D28545                    '  ' DELIMITED BY SIZE                        25430001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         25440010
D28545                    '  ' DELIMITED BY SIZE                        25450001
D28545                              INTO IN402-PV-PARAGRAPH             25460010
28545      END-EVALUATE.                                                25470001
28545                                                                   25480001
28545 ******************************************************************25490001
28545 * IN402-INV-LOOKUP-BY-UPC-ID.                                     25500010
28545 ******************************************************************25510001
28545  IN402-INV-LOOKUP-BY-UPC-ID.                                      25520010
28545                                                                   25530001
28545      INITIALIZE DCLINT00003.                                      25540001
28545      MOVE ZEROS          TO IN402-PV-WORK-RETAIL.                 25550010
28545                                                                   25560001
28545 *** STORE SPECIFIC - SKU_STYLE DELETE TABLE PRICE LOOKUP....      25570001
D28545     MOVE ZEROS            TO IN402-PV-PRC-SQLCDE.                25580010
D28545     MOVE ZEROS            TO IN402-PV-RETURN-CDE.                25590010
D28545     MOVE ZEROS            TO IN402-PV-ATT-SQLCDE.                25600010
D28545     MOVE ZEROS            TO IN402-PV-ATT-RTNCDE.                25610010
D28545     MOVE SPACES           TO IN402-PV-RETURN-RSN.                25620010
28545      MOVE 'N'            TO IN402-PS-PRIOR-FOUND-SW.              25630010
28545      MOVE 'N'            TO IN402-PS-END-SKUSTYL-CSR-SW.          25640010
28545      MOVE IN402-PV-WORK-UPC-ID      TO INT00003-INTR-UPC-ID.      25650010
28545      MOVE IN402-PV-LOC-IN-NUM       TO INT00003-LOC-NBR.          25660010
28545      MOVE IN402-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST      25670010
28545                                        INT00003-EFF-END-TMST.     25680001
28545                                                                   25690001
X28542     PERFORM IN402-OPEN-SKUSTYL-IUPC-CSR                          25700010
X28542     PERFORM IN402-FETCH-SKUSTYL-IUPC-CSR                         25710010
X28542       UNTIL IN402-PRIOR-FOUND                                    25720010
X28542          OR IN402-PS-END-SKUSTYL-CSR                             25730010
X28542     PERFORM IN402-CLOSE-SKUSTYL-IUPC-CSR                         25740010
X28542                                                                  25750001
28545 *** CORPORATE - SKU_STYLE DELETE TABLE PRICE LOOKUP....           25760001
28545      IF IN402-PRIOR-NOT-FOUND                                     25770010
D28545         MOVE ZEROS             TO IN402-PV-PRC-SQLCDE            25780010
D28545         MOVE ZEROS             TO IN402-PV-RETURN-CDE            25790010
D28545         MOVE ZEROS             TO IN402-PV-ATT-SQLCDE            25800010
D28545         MOVE ZEROS             TO IN402-PV-ATT-RTNCDE            25810010
D28545         MOVE SPACES            TO IN402-PV-RETURN-RSN            25820010
28545          MOVE 'N'               TO IN402-PS-PRIOR-FOUND-SW        25830010
28545          MOVE 'N'               TO IN402-PS-END-SKUSTYL-CSR-SW    25840010
28545          MOVE IN402-PV-WORK-UPC-ID      TO INT00003-INTR-UPC-ID   25850010
28545          MOVE ZEROS                     TO INT00003-LOC-NBR       25860001
28545          MOVE IN402-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST  25870010
28545                                            INT00003-EFF-END-TMST  25880001
28545          PERFORM IN402-OPEN-SKUSTYL-IUPC-CSR                      25890010
28545          PERFORM IN402-FETCH-SKUSTYL-IUPC-CSR                     25900010
28545            UNTIL IN402-PRIOR-FOUND                                25910010
28545               OR IN402-PS-END-SKUSTYL-CSR                         25920010
28545          PERFORM IN402-CLOSE-SKUSTYL-IUPC-CSR                     25930010
28545      END-IF.                                                      25940001
28545                                                                   25950001
28545 *** PRICE FOUND....                                               25960001
28545      IF IN402-PRIOR-FOUND                                         25970010
28545          SET IN402-PS-STR-FOUND TO TRUE                           25980010
28545      END-IF.                                                      25990001
28545                                                                   26000001
28545 ******************************************************************26010001
28545 * IN402-OPEN-SKUSTYL-IUPC-CSR                                     26020010
28545 ******************************************************************26030001
28545  IN402-OPEN-SKUSTYL-IUPC-CSR.                                     26040010
28545                                                                   26050001
28545      EXEC SQL                                                     26060001
28545           OPEN SKUSTYL-IUPC-CSR                                   26070001
28545      END-EXEC.                                                    26080001
28545                                                                   26090001
28545      EVALUATE TRUE                                                26100001
28545          WHEN SQLCODE = +0                                        26110001
D28545             CONTINUE                                             26120001
D28545         WHEN OTHER                                               26130001
D28545             SET IN402-PV-SQL-ERROR     TO TRUE                   26140010
D28545             SET IN402-PV-ATT-SQL-ERROR   TO TRUE                 26150010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   26160010
D28545             SET IN402-PV-CURSOR-OPEN   TO TRUE                   26170010
D28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              26180010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              26190010
D28545             STRING '  PARA: IN402-OPEN-SKUSTYL-IUPC-CSR - '      26200010
D28545                                       DELIMITED BY SIZE          26210001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             26220010
D28545                    '  ' DELIMITED BY SIZE                        26230001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         26240010
D28545                    '  ' DELIMITED BY SIZE                        26250001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        26260010
D28545                    '  ' DELIMITED BY SIZE                        26270001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         26280010
D28545                    '  ' DELIMITED BY SIZE                        26290001
D28545                              INTO IN402-PV-PARAGRAPH             26300010
D28545     END-EVALUATE.                                                26310001
28545                                                                   26320001
28545 ******************************************************************26330001
28545 * IN402-FETCH-SKUSTYL-IUPC-CSR                                    26340010
28545 ******************************************************************26350001
28545  IN402-FETCH-SKUSTYL-IUPC-CSR.                                    26360010
28545                                                                   26370001
28545      EXEC SQL                                                     26380001
28545          FETCH SKUSTYL-IUPC-CSR                                   26390001
28545          INTO  :INT00003-UPC-ID                                   26400001
28545               ,:INT00003-LOC-NBR                                  26410001
28545               ,:INT00003-EFF-BEG-TMST                             26420001
28545               ,:INT00003-UPC-NBR                                  26430001
28545               ,:INT00003-EFF-END-TMST :IN402-PV-NULL-EFF-END-TMST 26440010
28545               ,:INT00003-UPC-STAT-CDE :IN402-PV-NULL-UPC-STAT-CDE 26450010
28545               ,:INT00003-UNT-COST-AMT :IN402-PV-NULL-UNT-COST-AMT 26460010
28545               ,:INT00003-UNT-RTL-AMT  :IN402-PV-NULL-UNT-RTL-AMT  26470010
28545               ,:INT00003-MEITGP-NBR   :IN402-PV-NULL-MEITGP-NBR   26480010
28545               ,:INT00003-ITM-NBR                                  26490001
28545               ,:INT00003-INTR-UPC-ID                              26500001
28545               ,:INT00003-UPC-STAT-CHG-DTE                         26510001
28545               ,:INT00003-UNT-RTL-CHG-DTE                          26520001
28545               ,:INT00003-ORIG-CLR-DTE :IN402-PV-NULL-ORIG-CLR-DTE 26530010
28545               ,:INT00003-MKDN-CDE     :IN402-PV-NULL-MKDN-CDE     26540010
28545               ,:INT00003-SUB-CL-MDSEAR-ID                         26550001
28545               ,:INT00003-VS-ID :IN402-PV-NULL-VS-ID               26560010
28545               ,:INT00003-DEPT-NBR                                 26570001
28545               ,:INT00003-MAJ-CL-NBR                               26580001
28545               ,:INT00003-SUB-CL-NBR                               26590001
28545               ,:INT00003-SKU-NBR                                  26600001
28545               ,:INT00003-ENT-ID                                   26610001
28545               ,:INT00003-PLU-DWNLD-IND                            26620001
28545      END-EXEC.                                                    26630001
28545                                                                   26640001
28545      EVALUATE TRUE                                                26650001
28545          WHEN SQLCODE = +0                                        26660001
28545              MOVE INT00003-UNT-RTL-AMT TO IN402-PV-WORK-RETAIL    26670010
28545              PERFORM IN402-INV-GROUP-PRICING                      26680010
28545              SET IN402-PRIOR-FOUND  TO TRUE                       26690010
D28545             SET IN402-PV-FOUND     TO TRUE                       26700010
D28545             SET IN402-PV-ATT-FOUND TO TRUE                       26710010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        26720010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        26730010
D28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               26740010
28545          WHEN SQLCODE = +100                                      26750001
28545              MOVE ZEROS             TO IN402-PV-WORK-RETAIL       26760010
D28545             SET IN402-PV-CURSOR-FETCH    TO TRUE                 26770010
28545              SET IN402-PS-END-SKUSTYL-CSR TO TRUE                 26780010
D28545             SET IN402-PV-NOT-FOUND       TO TRUE                 26790010
D28545             SET IN402-PV-ATT-NOT-FOUND   TO TRUE                 26800010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        26810010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        26820010
D28545             STRING '  PARA: IN402-FETCH-SKUSTYL-IUPC-CSR - '     26830010
D28545                                       DELIMITED BY SIZE          26840001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             26850010
D28545                    '  ' DELIMITED BY SIZE                        26860001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         26870010
D28545                    '  ' DELIMITED BY SIZE                        26880001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        26890010
D28545                    '  ' DELIMITED BY SIZE                        26900001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         26901010
D28545                    '  ' DELIMITED BY SIZE                        26902001
D28545                              INTO IN402-PV-PARAGRAPH             26903010
28545          WHEN OTHER                                               26904001
28545              MOVE ZEROS             TO IN402-PV-WORK-RETAIL       26905010
28545              SET IN402-PV-SQL-ERROR TO TRUE                       26906010
D28545             SET IN402-PV-ATT-SQL-ERROR   TO TRUE                 26907010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   26908010
D28545             SET IN402-PV-CURSOR-FETCH    TO TRUE                 26909010
28545              SET IN402-PS-END-SKUSTYL-CSR TO TRUE                 26910010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        26920010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        26930010
D28545             STRING '  PARA: IN402-FETCH-SKUSTYL-IUPC-CSR - '     26940010
D28545                                       DELIMITED BY SIZE          26950001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             26960010
D28545                    '  ' DELIMITED BY SIZE                        26970001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         26980010
D28545                    '  ' DELIMITED BY SIZE                        26990001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        27000010
D28545                    '  ' DELIMITED BY SIZE                        27010001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         27020010
D28545                    '  ' DELIMITED BY SIZE                        27030001
D28545                              INTO IN402-PV-PARAGRAPH             27040010
28545      END-EVALUATE.                                                27050001
28545                                                                   27060001
28545 ******************************************************************27070001
28545 * IN402-CLOSE-SKUSTYL-IUPC-CSR                                    27080010
28545 ******************************************************************27090001
28545  IN402-CLOSE-SKUSTYL-IUPC-CSR.                                    27100010
28545                                                                   27110001
28545      EXEC SQL                                                     27120001
28545          CLOSE SKUSTYL-IUPC-CSR                                   27130001
28545      END-EXEC.                                                    27140001
28545                                                                   27150001
28545      EVALUATE TRUE                                                27160001
28545          WHEN SQLCODE = +0                                        27170001
D28545             CONTINUE                                             27180001
28545          WHEN OTHER                                               27190001
D28545             SET IN402-PV-SQL-ERROR     TO TRUE                   27200010
D28545             SET IN402-PV-ATT-SQL-ERROR   TO TRUE                 27210010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   27220010
D28545             SET IN402-PV-CURSOR-CLOSE  TO TRUE                   27230010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        27240010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        27250010
D28545             STRING '  PARA: IN402-CLOSE-SKUSTYL-IUPC-CSR - '     27260010
D28545                                       DELIMITED BY SIZE          27270001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             27280010
D28545                    '  ' DELIMITED BY SIZE                        27290001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         27300010
D28545                    '  ' DELIMITED BY SIZE                        27310001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        27320010
D28545                    '  ' DELIMITED BY SIZE                        27330001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         27340010
D28545                    '  ' DELIMITED BY SIZE                        27350001
D28545                              INTO IN402-PV-PARAGRAPH             27360010
28545      END-EVALUATE.                                                27370001
28545                                                                   27380001
28545 ******************************************************************27390001
28545 * IN402-INV-LOOKUP-BY-ITM-NBR.                                    27400010
28545 ******************************************************************27410001
28545  IN402-INV-LOOKUP-BY-ITM-NBR.                                     27420010
28545                                                                   27430001
28545      INITIALIZE DCLINT00003.                                      27440001
28545      MOVE ZEROS          TO IN402-PV-WORK-RETAIL.                 27450010
28545                                                                   27460001
28545 *** STORE SPECIFIC - SKU_STYLE DELETE TABLE PRICE LOOKUP....      27470001
D28545     MOVE ZEROS            TO IN402-PV-PRC-SQLCDE.                27480010
D28545     MOVE ZEROS            TO IN402-PV-RETURN-CDE.                27490010
D28545     MOVE ZEROS            TO IN402-PV-ATT-SQLCDE.                27500010
D28545     MOVE ZEROS            TO IN402-PV-ATT-RTNCDE.                27510010
D28545     MOVE SPACES           TO IN402-PV-RETURN-RSN.                27520010
28545      MOVE 'N'            TO IN402-PS-PRIOR-FOUND-SW.              27530010
28545      MOVE 'N'            TO IN402-PS-END-SKUSTYL-CSR-SW.          27540010
28545      MOVE IN402-PV-WORK-ITM-NBR     TO INT00003-ITM-NBR.          27550010
28545      MOVE IN402-PV-LOC-IN-NUM       TO INT00003-LOC-NBR           27560010
28545      MOVE IN402-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST      27570010
28545                                        INT00003-EFF-END-TMST.     27580001
28545                                                                   27590001
28545      PERFORM IN402-OPEN-SKUSTYL-ITM-CSR.                          27600010
28545      PERFORM IN402-FETCH-SKUSTYL-ITM-CSR                          27610010
28545        UNTIL IN402-PRIOR-FOUND                                    27620010
28545           OR IN402-PS-END-SKUSTYL-CSR.                            27630010
28545      PERFORM IN402-CLOSE-SKUSTYL-ITM-CSR.                         27640010
28545                                                                   27650001
28545 *** CORPORATE - SKU_STYLE DELETE TABLE PRICE LOOKUP....           27660001
28545      IF IN402-PRIOR-NOT-FOUND                                     27670010
D28545         MOVE ZEROS             TO IN402-PV-PRC-SQLCDE            27680010
D28545         MOVE ZEROS             TO IN402-PV-RETURN-CDE            27690010
D28545         MOVE ZEROS             TO IN402-PV-ATT-SQLCDE            27700010
D28545         MOVE ZEROS             TO IN402-PV-ATT-RTNCDE            27710010
D28545         MOVE SPACES            TO IN402-PV-RETURN-RSN            27720010
28545          MOVE 'N'               TO IN402-PS-PRIOR-FOUND-SW        27730010
28545          MOVE 'N'               TO IN402-PS-END-SKUSTYL-CSR-SW    27740010
28545          MOVE IN402-PV-WORK-ITM-NBR TO INT00003-ITM-NBR           27750010
28545          MOVE ZEROS                 TO INT00003-LOC-NBR           27760001
28545          MOVE IN402-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST  27770010
28545                                            INT00003-EFF-END-TMST  27780001
28545          PERFORM IN402-OPEN-SKUSTYL-ITM-CSR                       27790010
28545          PERFORM IN402-FETCH-SKUSTYL-ITM-CSR                      27800010
28545            UNTIL IN402-PRIOR-FOUND                                27810010
28545               OR IN402-PS-END-SKUSTYL-CSR                         27820010
28545          PERFORM IN402-CLOSE-SKUSTYL-ITM-CSR                      27830010
28545      END-IF.                                                      27840001
28545                                                                   27850001
28545 *** PRICE FOUND....                                               27860001
28545      IF IN402-PRIOR-FOUND                                         27870010
28545          SET IN402-PS-STR-FOUND TO TRUE                           27880010
28545      END-IF.                                                      27890001
28545                                                                   27900001
28545 ******************************************************************27910001
28545 * IN402-OPEN-SKUSTYL-ITM-CSR.                                     27920010
28545 ******************************************************************27930001
28545  IN402-OPEN-SKUSTYL-ITM-CSR.                                      27940010
28545                                                                   27950001
28545      EXEC SQL                                                     27960001
28545           OPEN SKUSTYL-ITM-CSR                                    27970001
28545      END-EXEC.                                                    27980001
28545                                                                   27990001
28545      EVALUATE TRUE                                                28000001
28545          WHEN SQLCODE = +0                                        28010001
D28545             CONTINUE                                             28020001
D28545         WHEN OTHER                                               28030001
D28545             SET IN402-PV-SQL-ERROR     TO TRUE                   28040010
D28545             SET IN402-PV-ATT-SQL-ERROR   TO TRUE                 28050010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   28060010
D28545             SET IN402-PV-CURSOR-OPEN   TO TRUE                   28070010
D28545             MOVE SQLCODE     TO IN402-PV-PRC-SQLCDE              28080010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              28090010
D28545             STRING '  PARA: IN402-OPEN-SKUSTYL-ITM-CSR - '       28100010
D28545                                       DELIMITED BY SIZE          28110001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             28120010
D28545                    '  ' DELIMITED BY SIZE                        28130001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         28140010
D28545                    '  ' DELIMITED BY SIZE                        28150001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        28160010
D28545                    '  ' DELIMITED BY SIZE                        28170001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         28180010
D28545                    '  ' DELIMITED BY SIZE                        28190001
D28545                              INTO IN402-PV-PARAGRAPH             28200010
D28545     END-EVALUATE.                                                28210001
28545                                                                   28220001
28545 ******************************************************************28230001
28545 * IN402-FETCH-SKUSTYL-ITM-CSR                                     28240010
28545 ******************************************************************28250001
28545  IN402-FETCH-SKUSTYL-ITM-CSR.                                     28260010
28545                                                                   28270001
28545      EXEC SQL                                                     28280001
28545          FETCH SKUSTYL-ITM-CSR                                    28290001
28545          INTO  :INT00003-UPC-ID                                   28300001
28545               ,:INT00003-LOC-NBR                                  28310001
28545               ,:INT00003-EFF-BEG-TMST                             28320001
28545               ,:INT00003-UPC-NBR                                  28330001
28545               ,:INT00003-EFF-END-TMST :IN402-PV-NULL-EFF-END-TMST 28340010
28545               ,:INT00003-UPC-STAT-CDE :IN402-PV-NULL-UPC-STAT-CDE 28350010
28545               ,:INT00003-UNT-COST-AMT :IN402-PV-NULL-UNT-COST-AMT 28360010
28545               ,:INT00003-UNT-RTL-AMT  :IN402-PV-NULL-UNT-RTL-AMT  28370010
28545               ,:INT00003-MEITGP-NBR   :IN402-PV-NULL-MEITGP-NBR   28380010
28545               ,:INT00003-ITM-NBR                                  28390001
28545               ,:INT00003-INTR-UPC-ID                              28400001
28545               ,:INT00003-UPC-STAT-CHG-DTE                         28410001
28545               ,:INT00003-UNT-RTL-CHG-DTE                          28420001
28545               ,:INT00003-ORIG-CLR-DTE :IN402-PV-NULL-ORIG-CLR-DTE 28430010
28545               ,:INT00003-MKDN-CDE     :IN402-PV-NULL-MKDN-CDE     28440010
28545               ,:INT00003-SUB-CL-MDSEAR-ID                         28450001
28545               ,:INT00003-VS-ID :IN402-PV-NULL-VS-ID               28460010
28545               ,:INT00003-DEPT-NBR                                 28470001
28545               ,:INT00003-MAJ-CL-NBR                               28480001
28545               ,:INT00003-SUB-CL-NBR                               28490001
28545               ,:INT00003-SKU-NBR                                  28500001
28545               ,:INT00003-ENT-ID                                   28510001
28545               ,:INT00003-PLU-DWNLD-IND                            28520001
28545      END-EXEC.                                                    28530001
28545                                                                   28540001
28545      EVALUATE TRUE                                                28550001
28545          WHEN SQLCODE = +0                                        28560001
28545              MOVE INT00003-UNT-RTL-AMT TO IN402-PV-WORK-RETAIL    28570010
28545              PERFORM IN402-INV-GROUP-PRICING                      28580010
28545              SET IN402-PRIOR-FOUND  TO TRUE                       28590010
D28545             SET IN402-PV-FOUND     TO TRUE                       28600010
D28545             SET IN402-PV-ATT-FOUND TO TRUE                       28610010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        28620010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        28630010
D28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               28640010
28545          WHEN SQLCODE = +100                                      28650001
28545              MOVE ZEROS             TO IN402-PV-WORK-RETAIL       28660010
D28545             SET IN402-PV-CURSOR-FETCH    TO TRUE                 28670010
28545              SET IN402-PS-END-SKUSTYL-CSR TO TRUE                 28680010
D28545             SET IN402-PV-NOT-FOUND       TO TRUE                 28690010
D28545             SET IN402-PV-ATT-NOT-FOUND   TO TRUE                 28700010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        28710010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        28720010
D28545             STRING '  PARA: IN402-FETCH-SKUSTYL-ITM-CSR - '      28721010
D28545                                       DELIMITED BY SIZE          28722001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             28723010
D28545                    '  ' DELIMITED BY SIZE                        28724001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         28725010
D28545                    '  ' DELIMITED BY SIZE                        28726001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        28727010
D28545                    '  ' DELIMITED BY SIZE                        28728001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         28729010
D28545                    '  ' DELIMITED BY SIZE                        28730001
D28545                              INTO IN402-PV-PARAGRAPH             28740010
28545          WHEN OTHER                                               28750001
28545              MOVE ZEROS             TO IN402-PV-WORK-RETAIL       28760010
28545              SET IN402-PV-SQL-ERROR TO TRUE                       28770010
D28545             SET IN402-PV-ATT-SQL-ERROR   TO TRUE                 28780010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   28790010
D28545             SET IN402-PV-CURSOR-FETCH    TO TRUE                 28800010
28545              SET IN402-PS-END-SKUSTYL-CSR TO TRUE                 28810010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        28820010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        28830010
D28545             STRING '  PARA: IN402-FETCH-SKUSTYL-ITM-CSR - '      28840010
D28545                                       DELIMITED BY SIZE          28850001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             28860010
D28545                    '  ' DELIMITED BY SIZE                        28870001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         28880010
D28545                    '  ' DELIMITED BY SIZE                        28890001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        28900010
D28545                    '  ' DELIMITED BY SIZE                        28910001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         28920010
D28545                    '  ' DELIMITED BY SIZE                        28930001
D28545                              INTO IN402-PV-PARAGRAPH             28940010
28545      END-EVALUATE.                                                28950001
28545                                                                   28960001
28545 ******************************************************************28970001
28545 * IN402-CLOSE-SKUSTYL-ITM-CSR                                     28980010
28545 ******************************************************************28990001
28545  IN402-CLOSE-SKUSTYL-ITM-CSR.                                     29000010
28545                                                                   29010001
28545      EXEC SQL                                                     29020001
28545          CLOSE SKUSTYL-ITM-CSR                                    29030001
28545      END-EXEC.                                                    29040001
28545                                                                   29050001
28545      EVALUATE TRUE                                                29060001
28545          WHEN SQLCODE = +0                                        29070001
D28545             CONTINUE                                             29080001
28545          WHEN OTHER                                               29090001
D28545             SET IN402-PV-SQL-ERROR     TO TRUE                   29100010
D28545             SET IN402-PV-ATT-SQL-ERROR   TO TRUE                 29110010
RONNA              SET IN402-PV-DBV-SQL-ERROR TO TRUE                   29120010
D28545             SET IN402-PV-CURSOR-CLOSE  TO TRUE                   29130010
D28545             MOVE SQLCODE           TO IN402-PV-PRC-SQLCDE        29140010
D28545             MOVE SQLCODE           TO IN402-PV-ATT-SQLCDE        29150010
D28545             STRING '  PARA: IN402-CLOSE-SKUSTYL-ITM-CSR - '      29160010
D28545                                       DELIMITED BY SIZE          29170001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             29180010
D28545                    '  ' DELIMITED BY SIZE                        29190001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         29200010
D28545                    '  ' DELIMITED BY SIZE                        29210001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        29220010
D28545                    '  ' DELIMITED BY SIZE                        29230001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         29240010
D28545                    '  ' DELIMITED BY SIZE                        29250001
D28545                              INTO IN402-PV-PARAGRAPH             29260010
28545      END-EVALUATE.                                                29270001
28545                                                                   29280001
28545 ******************************************************************29290001
28545 * IN402-INV-LOOKUP-DEFAULT. DEFAULT INFORMATION LOOKUP            29300010
28545 * - THIS ROUTINE IS EXECUTED IF EITHER A VALID SWITCH WAS NOT SET 29310001
28545 *   OR THE SWITCH THAT WAS SET FAILED TO FIND ENOUGH TO PROCEED   29320001
28545 * - THIS ROUTINE WILL CHECK FOR A NON-ZERO / NON-SPACE CONDITION  29330001
28545 *   IN EACH OF THE PRIMARY SEARCH PARAMETERS (ITEM,UPC,SKU,UPCID).29340001
28545 * - IF ONE OF THE PARAMETERS WAS DETERMINED TO HAVE A VALUE OTHER 29350001
28545 *   THAN THE DEFAULT, PROCESSING WILL MAKE A FINAL ATTEMPT TO     29360001
28545 *   DETERMINE THE RETAIL BASED ON THESE VALUES.                   29370001
28545 * - FAILURE FROM THESE ATTEMPTS WILL RESULT IN A NOT FOUND        29380001
28545 *   CONDITION BEING RETURNED.                                     29390001
28545 ******************************************************************29400001
28545  IN402-INV-LOOKUP-DEFAULT.                                        29410010
28545                                                                   29420001
28545      SET IN402-PV-FOUND-WITH-ASSUMPTION TO TRUE.                  29430010
28545                                                                   29440001
28545 *       IS SKU INPUT PROVIDED ???                                 29450001
28545      IF IN402-PV-SKU-IN = SPACES                                  29460010
28545          OR IN402-PV-SKU-IN NOT NUMERIC                           29470010
28545          OR IN402-PV-SKU-IN = ZEROES                              29480010
D28545*****    OR IN402-PV-DUMMY-SKU                                    29490010
28545 *           IS UPC INPUT PROVIDED ???                             29500001
28545          IF IN402-PV-UPC-NBR-IN = SPACES                          29510010
28545              OR IN402-PV-UPC-NBR-IN NOT NUMERIC                   29520010
28545              OR IN402-PV-UPC-NBR-IN = ZEROES                      29530010
28545 *               IS INTR-UPC-ID INPUT PROVIDED ???                 29540001
28545              IF IN402-PV-UPC-ID-SPC = ZEROES                      29550010
28545 *                   IS ITEM NUMBER INPUT PROVIDED ???             29560001
28545                  IF IN402-PV-ITM-NBR-IN = SPACES                  29570010
28545                      OR IN402-PV-ITM-NBR-IN NOT NUMERIC           29580010
28545                      OR IN402-PV-ITM-NBR-IN = ZEROES              29590010
28545                          SET IN402-PV-NO-LOOKUP-TYPE    TO TRUE   29600010
28545                  ELSE                                             29610001
28545                      SET IN402-PV-TRY-ITM-NBR-LOOKUP TO TRUE      29620010
28545                      SET IN402-PV-ITM-NBR-LOOKUP    TO TRUE       29630010
28545                  END-IF                                           29640001
28545              ELSE                                                 29650001
28545                  SET IN402-PV-TRY-UPC-ID-LOOKUP  TO TRUE          29660010
28545                  SET IN402-PV-INTR-UPC-ID-LOOKUP TO TRUE          29670010
28545              END-IF                                               29680001
28545          ELSE                                                     29690001
28545              SET IN402-PV-TRY-UPC-NBR-LOOKUP TO TRUE              29700010
28545              SET IN402-PV-UPC-NBR-LOOKUP    TO TRUE               29710010
28545          END-IF                                                   29720001
28545      ELSE                                                         29730001
28545          SET IN402-PV-TRY-SKU-LOOKUP    TO TRUE                   29740010
28545          SET IN402-PV-SKU-LOOKUP        TO TRUE                   29750010
28545      END-IF.                                                      29760001
28545                                                                   29770001
28545      EVALUATE TRUE                                                29780001
28545          WHEN IN402-PV-SKU-LOOKUP                                 29790010
D28545           IF IN402-PV-DUMMY-SKU                                  29800010
D28545             MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-WORK-SKU        29810010
D28545             MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-DUMB-SKU        29820010
D28545             PERFORM IN402-DUMMY-SKU-LOOKUP                       29830010
D28545           ELSE                                                   29840001
28545              MOVE IN402-PV-SKU-IN-NUM     TO IN402-PV-WORK-SKU    29850010
28545              PERFORM IN402-INV-LOOKUP-BY-SKU                      29860010
D28545           END-IF                                                 29870001
28545          WHEN IN402-PV-UPC-NBR-LOOKUP                             29880010
I28545           IF (IN402-PV-KOHLS-UPC AND IN402-PV-DUMMY-UPC)         29890010
D28545             MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-WORK-SKU        29900010
D28545             MOVE IN402-PV-SKU-IN-NUM TO IN402-PV-DUMB-SKU        29910010
D28545             PERFORM IN402-DUMMY-SKU-LOOKUP                       29920010
D28545           ELSE                                                   29930001
28545              MOVE IN402-PV-UPC-NBR-IN-NUM TO IN402-PV-WORK-UPC-NBR29940010
28545              PERFORM IN402-INV-LOOKUP-BY-UPC                      29950010
D28545           END-IF                                                 29960001
28545          WHEN IN402-PV-INTR-UPC-ID-LOOKUP                         29970010
28545              MOVE IN402-PV-UPC-ID-SPC     TO IN402-PV-WORK-UPC-ID 29980010
28545              PERFORM IN402-INV-LOOKUP-BY-UPC-ID                   29990010
28545          WHEN IN402-PV-ITM-NBR-LOOKUP                             30000010
28545              MOVE IN402-PV-ITM-NBR-IN-NUM TO IN402-PV-WORK-ITM-NBR30010010
28545              PERFORM IN402-INV-LOOKUP-BY-ITM-NBR                  30020010
28545          WHEN OTHER                                               30030001
28545              SET IN402-PV-NOT-FOUND        TO TRUE                30040010
D28545             SET IN402-PV-ATT-NOT-FOUND    TO TRUE                30050010
D28545             SET IN402-PV-MISSING-KEY-DATA TO TRUE                30060010
D28545             STRING '  PARA: IN402-INV-LOOKUP-DEFAULT - '         30070010
D28545                                       DELIMITED BY SIZE          30080001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             30090010
D28545                    '  ' DELIMITED BY SIZE                        30100001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         30110010
D28545                    '  ' DELIMITED BY SIZE                        30120001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        30130010
D28545                    '  ' DELIMITED BY SIZE                        30140001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         30150010
D28545                    '  ' DELIMITED BY SIZE                        30160001
D28545                              INTO IN402-PV-PARAGRAPH             30170010
28545      END-EVALUATE.                                                30180001
28545                                                                   30190001
28545 ******************************************************************30200001
28545 * IN402-INV-GROUP-PRICING.                                        30210010
28545 ******************************************************************30220001
28545  IN402-INV-GROUP-PRICING.                                         30230010
28545                                                                   30240001
28545       IF IN402-PV-NULL-MEITGP-NBR IS LESS THAN ZEROS              30250010
28545           MOVE ZEROS     TO INT00003-MEITGP-NBR                   30260001
28545       END-IF.                                                     30270001
28545                                                                   30280001
28545       IF INT00003-MEITGP-NBR IS EQUAL TO ZEROS                    30290001
28545           MOVE ZEROS     TO IN402-PV-MITGPL-QTY                   30300010
28545           MOVE ZEROS     TO IN402-PV-MITGPL-GP-AMT                30310010
28545           SET IN402-PS-RTL-FOUND TO TRUE                          30320010
28545       ELSE                                                        30330001
28545           EXEC SQL                                                30340001
28545               SELECT MITGPL_QTY                                   30350001
28545                     ,GP_AMT                                       30360001
28545               INTO :MITGPL-MITGPL-QTY                             30370001
28545                   ,:MITGPL-GP-AMT                                 30380001
28545               FROM TMITGPL                                        30390001
28545               WHERE OPERCO_NBR = '03'                             30400001
28545                 AND MEITGP_NBR = :INT00003-MEITGP-NBR             30410001
28545                 AND ADLOC_ID = '   '                              30420001
28545                 AND (:IN402-PV-EFF-BEG-DTE-X                      30430010
28545                              BETWEEN BEG_DTE AND END_DTE)         30440001
28545               WITH UR                                             30450001
28545           END-EXEC                                                30460001
28545                                                                   30470001
28545           EVALUATE TRUE                                           30480001
28545             WHEN SQLCODE = ZERO                                   30490001
28545               COMPUTE IN402-PV-WORK-RETAIL ROUNDED =              30500010
28545                         (MITGPL-GP-AMT / MITGPL-MITGPL-QTY )      30510001
28545               MOVE MITGPL-MITGPL-QTY TO IN402-PV-MITGPL-QTY       30520010
28545               MOVE MITGPL-GP-AMT     TO IN402-PV-MITGPL-GP-AMT    30530010
28545               SET IN402-PS-RTL-FOUND TO TRUE                      30540010
D28545            WHEN OTHER                                            30550001
D28545              MOVE ZEROS             TO IN402-PV-MITGPL-QTY       30560010
D28545              MOVE ZEROS             TO IN402-PV-MITGPL-GP-AMT    30570010
D28545              SET IN402-PS-RTL-FOUND TO TRUE                      30580010
28545           END-EVALUATE                                            30590001
28545       END-IF.                                                     30600001
28545                                                                   30610001
28545 ******************************************************************30620001
28545 * IN402-INV-ATTRIBUTES-LOOKUP.                                    30630010
28545 ******************************************************************30640001
28545  IN402-INV-ATTRIBUTES-LOOKUP.                                     30650010
28545                                                                   30660001
28545      MOVE INT00003-DEPT-NBR       TO IN402-CONVERT-DEPT.          30670010
28545      MOVE IN402-CONVERT-DEPT      TO IN402-PV-WORK-DEPT.          30680010
28545                                                                   30690001
28545      EXEC SQL                                                     30700001
28545          SELECT F.DEPT_NBR                                        30710001
28545                ,F.INHOUSE_NBR                                     30720001
28545                ,E.DUN_NBR                                         30730001
28545          INTO :VNDDPT-DEPT-NBR                                    30740001
28545              ,:VNDDPT-INHOUSE-NBR                                 30750001
28545              ,:EXTENT-DUN-NBR                                     30760001
28545          FROM TVNDDPT F                                           30770001
28545              ,TEXTENT E                                           30780001
28545          WHERE F.ENT_ID = E.ENT_ID                                30790001
28545            AND F.ENT_ID = :INT00003-ENT-ID                        30800001
28545            AND F.DEPT_NBR = :IN402-PV-WORK-DEPT-3X                30810010
28545          WITH UR                                                  30820001
28545      END-EXEC.                                                    30830001
28545                                                                   30840001
28545      EVALUATE TRUE                                                30850001
28545          WHEN SQLCODE = 0                                         30860001
D28545             SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE              30870010
D28545             SET IN402-PS-ATTR-FOUND TO TRUE                      30880010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              30890010
D28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               30900010
28545          WHEN SQLCODE = +100                                      30910001
D28545             MOVE ZEROS       TO VNDDPT-DEPT-NBR                  30920001
D28545             MOVE ZEROS       TO VNDDPT-INHOUSE-NBR               30930001
D28545             MOVE ZEROS       TO EXTENT-DUN-NBR                   30940001
D28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  30950010
D28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   30960010
D28545             SET IN402-PV-VSM-LOOKUP    TO TRUE                   30970010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              30980010
D28545             STRING '  PARA: IN402-INV-ATTRIBUTES-LOOKUP - '      30990010
D28545                                       DELIMITED BY SIZE          31000001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             31010010
D28545                    '  ' DELIMITED BY SIZE                        31020001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         31030010
D28545                    '  ' DELIMITED BY SIZE                        31040001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        31050010
D28545                    '  ' DELIMITED BY SIZE                        31060001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         31070010
D28545                    '  ' DELIMITED BY SIZE                        31080001
D28545                              INTO IN402-PV-PARAGRAPH             31090010
28545          WHEN OTHER                                               31100001
D28545             MOVE ZEROS       TO VNDDPT-DEPT-NBR                  31110001
D28545             MOVE ZEROS       TO VNDDPT-INHOUSE-NBR               31120001
D28545             MOVE ZEROS       TO EXTENT-DUN-NBR                   31130001
D28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  31140010
D28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   31150010
D28545             SET IN402-PV-SQL-ERROR     TO TRUE                   31160010
D28545             SET IN402-PV-VSM-LOOKUP    TO TRUE                   31170010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              31180010
D28545             STRING '  PARA: IN402-INV-ATTRIBUTES-LOOKUP - '      31190010
D28545                                       DELIMITED BY SIZE          31200001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             31210010
D28545                    '  ' DELIMITED BY SIZE                        31220001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         31230010
D28545                    '  ' DELIMITED BY SIZE                        31240001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        31250010
D28545                    '  ' DELIMITED BY SIZE                        31260001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         31270010
D28545                    '  ' DELIMITED BY SIZE                        31280001
D28545                              INTO IN402-PV-PARAGRAPH             31290010
28545      END-EVALUATE.                                                31300001
28545                                                                   31310001
28545 ******************************************************************31320001
28545 * IN402-INV-MBS-LOOKUP.                                           31330010
28545 ******************************************************************31340001
28545  IN402-INV-MBS-LOOKUP.                                            31350010
28545                                                                   31360001
28545      MOVE INT00003-DEPT-NBR       TO IN402-CONVERT-DEPT.          31370010
28545      MOVE IN402-CONVERT-DEPT      TO IN402-PV-WORK-DEPT.          31380010
28545                                                                   31390001
28545      EXEC SQL                                                     31400001
I28545       SELECT A.BYR_NBR                                           31410001
I28545             ,A.GMA_NBR                                           31420001
I28545             ,A.DMA_NBR                                           31430001
I28545       INTO :IN402-ATT-BYR-NBR                                    31440010
I28545           ,:IN402-ATT-GMA-NBR                                    31450010
I28545           ,:IN402-ATT-DMA-NBR                                    31460010
I28545       FROM TMDSEAR A                                             31470001
I28545       WHERE A.DEPT_NBR = :IN402-PV-WORK-DEPT-3X                  31480010
I28545         AND A.MDSELV_CDE = 'DPT'                                 31490001
I28545         AND (:IN402-PV-EFF-BEG-DTE-X >= A.STRT_DTE AND           31500010
I28545              :IN402-PV-EFF-BEG-DTE-X <= A.END_DTE)               31510010
I28545       WITH UR                                                    31520001
28545      END-EXEC.                                                    31530001
28545                                                                   31540001
28545      EVALUATE TRUE                                                31550001
28545          WHEN SQLCODE = 0                                         31560001
I28545             PERFORM IN402-INV-MBS-BYR-LOOKUP                     31570010
I28545             PERFORM IN402-INV-MBS-DMM-LOOKUP                     31580010
I28545             PERFORM IN402-INV-MBS-GMM-LOOKUP                     31590010
I28545             PERFORM IN402-INV-MBS-DESC-LOOKUP                    31600010
28545          WHEN SQLCODE = +100                                      31610001
28545              MOVE SPACES      TO IN402-ATT-GMA-NBR                31620010
28545              MOVE SPACES      TO IN402-ATT-DMA-NBR                31630010
28545              MOVE SPACES      TO IN402-ATT-BYR-NBR                31640010
28545              MOVE SPACES      TO IN402-ATT-GMM-LAST-NAME          31650010
28545              MOVE SPACES      TO IN402-ATT-GMM-FIR-NAME           31660010
28545              MOVE SPACES      TO IN402-ATT-DMM-LAST-NAME          31670010
28545              MOVE SPACES      TO IN402-ATT-DMM-FIR-NAME           31680010
28545              MOVE SPACES      TO IN402-ATT-BYR-LAST-NAME          31690010
28545              MOVE SPACES      TO IN402-ATT-BYR-FIR-NAME           31700010
F28545             MOVE SPACES      TO IN402-ATT-MDSEAR-DESC            31710010
D28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   31720010
D28545             SET IN402-PV-MBS-LOOKUP    TO TRUE                   31730010
D28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  31740010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              31750010
D28545             STRING '  PARA: IN402-INV-MBS-LOOKUP - '             31760010
D28545                                       DELIMITED BY SIZE          31770001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             31780010
D28545                    '  ' DELIMITED BY SIZE                        31790001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         31800010
D28545                    '  ' DELIMITED BY SIZE                        31810001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        31820010
D28545                    '  ' DELIMITED BY SIZE                        31830001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         31840010
D28545                    '  ' DELIMITED BY SIZE                        31850001
D28545                              INTO IN402-PV-PARAGRAPH             31860010
28545          WHEN OTHER                                               31870001
D28545             MOVE SPACES      TO IN402-ATT-GMA-NBR                31880010
D28545             MOVE SPACES      TO IN402-ATT-DMA-NBR                31890010
D28545             MOVE SPACES      TO IN402-ATT-BYR-NBR                31900010
D28545             MOVE SPACES      TO IN402-ATT-GMM-LAST-NAME          31910010
D28545             MOVE SPACES      TO IN402-ATT-GMM-FIR-NAME           31920010
D28545             MOVE SPACES      TO IN402-ATT-DMM-LAST-NAME          31930010
D28545             MOVE SPACES      TO IN402-ATT-DMM-FIR-NAME           31940010
D28545             MOVE SPACES      TO IN402-ATT-BYR-LAST-NAME          31950010
D28545             MOVE SPACES      TO IN402-ATT-BYR-FIR-NAME           31960010
F28545             MOVE SPACES      TO IN402-ATT-MDSEAR-DESC            31970010
D28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   31980010
28545              SET IN402-PV-SQL-ERROR     TO TRUE                   31990010
D28545             SET IN402-PV-MBS-LOOKUP    TO TRUE                   32000010
D28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  32010010
D28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              32020010
D28545             STRING '  PARA: IN402-INV-MBS-LOOKUP - '             32030010
D28545                                       DELIMITED BY SIZE          32040001
D28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             32050010
D28545                    '  ' DELIMITED BY SIZE                        32060001
D28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         32070010
D28545                    '  ' DELIMITED BY SIZE                        32080001
D28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        32090010
D28545                    '  ' DELIMITED BY SIZE                        32100001
D28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         32110010
D28545                    '  ' DELIMITED BY SIZE                        32120001
D28545                              INTO IN402-PV-PARAGRAPH             32130010
28545      END-EVALUATE.                                                32140001
28545                                                                   32150001
I28545******************************************************************32160001
I28545* IN402-INV-MBS-BYR-LOOKUP.                                       32170010
I28545******************************************************************32180001
I28545 IN402-INV-MBS-BYR-LOOKUP.                                        32190010
I28545                                                                  32200001
I28545     MOVE INT00003-DEPT-NBR       TO IN402-CONVERT-DEPT.          32210010
I28545     MOVE IN402-CONVERT-DEPT      TO IN402-PV-WORK-DEPT.          32220010
I28545                                                                  32230001
I28545     EXEC SQL                                                     32240001
I28545       SELECT B.WORKER_LAST_NAME                                  32250001
I28545             ,B.WORKER_FIR_NAME                                   32260001
I28545       INTO :IN402-ATT-BYR-LAST-NAME                              32270010
I28545           ,:IN402-ATT-BYR-FIR-NAME                               32280010
I28545       FROM TMDSEAR A,                                            32290001
I28545            TRSPBAR B                                             32300001
I28545       WHERE A.OPERCO_NBR = '03'                                  32310001
I28545         AND GMA_NBR = :IN402-ATT-GMA-NBR                         32320010
I28545         AND DMA_NBR = :IN402-ATT-DMA-NBR                         32330010
I28545         AND DEPT_NBR = :IN402-PV-WORK-DEPT-3X                    32340010
I28545         AND MAJ_CL_NBR = '00'                                    32350001
I28545         AND SUB_CL_NBR = '000'                                   32360001
I28545         AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                        32370001
I28545         AND B.WORKER_NBR > DECIMAL(0)                            32380001
I28545         AND B.RSPLVL_CDE  = 'BYR'                                32390001
I28545         AND (:IN402-PV-EFF-BEG-DTE-X >= B.WORKER_STRT_DTE AND    32400010
I28545              :IN402-PV-EFF-BEG-DTE-X <= B.WORKER_END_DTE)        32410010
I28545       WITH UR                                                    32420001
I28545     END-EXEC.                                                    32430001
I28545                                                                  32440001
I28545     EVALUATE TRUE                                                32450001
I28545         WHEN SQLCODE = 0                                         32460001
I28545             SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE              32470010
I28545             SET IN402-PS-ATTR-FOUND TO TRUE                      32480010
I28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              32490010
I28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               32500010
I28545         WHEN SQLCODE = +100                                      32510001
I28545             MOVE SPACES      TO IN402-ATT-BYR-LAST-NAME          32520010
I28545             MOVE SPACES      TO IN402-ATT-BYR-FIR-NAME           32530010
I28545             SET IN402-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           32540010
I28545             SET IN402-PS-ATTR-FOUND TO TRUE                      32550010
I28545             MOVE ZEROS       TO IN402-PV-ATT-SQLCDE              32560010
I28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               32570010
I28545         WHEN OTHER                                               32580001
I28545             MOVE SPACES      TO IN402-ATT-BYR-LAST-NAME          32590010
I28545             MOVE SPACES      TO IN402-ATT-BYR-FIR-NAME           32600010
I28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   32610010
I28545             SET IN402-PV-ATT-SQL-ERROR TO TRUE                   32620010
I28545             SET IN402-PV-MBS-LOOKUP    TO TRUE                   32630010
I28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  32640010
I28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              32650010
I28545             STRING '  PARA: IN402-INV-MBS-BYR-LOOKUP - '         32660010
I28545                                       DELIMITED BY SIZE          32670001
I28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             32680010
I28545                    '  ' DELIMITED BY SIZE                        32690001
I28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         32700010
I28545                    '  ' DELIMITED BY SIZE                        32710001
I28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        32720010
I28545                    '  ' DELIMITED BY SIZE                        32730001
I28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         32740010
I28545                    '  ' DELIMITED BY SIZE                        32750001
I28545                              INTO IN402-PV-PARAGRAPH             32760010
I28545     END-EVALUATE.                                                32770001
I28545                                                                  32780001
I28545******************************************************************32790001
I28545* IN402-INV-MBS-DMM-LOOKUP.                                       32800010
I28545******************************************************************32810001
I28545 IN402-INV-MBS-DMM-LOOKUP.                                        32820010
I28545                                                                  32830001
I28545     EXEC SQL                                                     32840001
I28545       SELECT B.WORKER_LAST_NAME                                  32850001
I28545             ,B.WORKER_FIR_NAME                                   32860001
I28545       INTO :IN402-ATT-DMM-LAST-NAME                              32861010
I28545           ,:IN402-ATT-DMM-FIR-NAME                               32862010
I28545       FROM TMDSEAR A,                                            32863001
I28545            TRSPBAR B                                             32864001
I28545       WHERE A.OPERCO_NBR = '03'                                  32865001
I28545         AND GMA_NBR = :IN402-ATT-GMA-NBR                         32866010
I28545         AND DMA_NBR = :IN402-ATT-DMA-NBR                         32866110
I28545         AND DEPT_NBR = '000'                                     32866201
I28545         AND MAJ_CL_NBR = '00'                                    32866301
I28545         AND SUB_CL_NBR = '000'                                   32866401
I28545         AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                        32866501
I28545         AND B.WORKER_NBR > DECIMAL(0)                            32866601
I28545         AND B.RSPLVL_CDE  = 'DMM'                                32866701
I28545         AND (:IN402-PV-EFF-BEG-DTE-X >= B.WORKER_STRT_DTE AND    32866810
I28545              :IN402-PV-EFF-BEG-DTE-X <= B.WORKER_END_DTE)        32866910
I28545       WITH UR                                                    32867001
I28545     END-EXEC.                                                    32867101
I28545                                                                  32867201
I28545     EVALUATE TRUE                                                32867301
I28545         WHEN SQLCODE = 0                                         32867401
I28545             SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE              32867510
I28545             SET IN402-PS-ATTR-FOUND TO TRUE                      32867610
I28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              32867710
I28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               32867810
I28545         WHEN SQLCODE = +100                                      32867901
I28545             MOVE SPACES      TO IN402-ATT-DMM-LAST-NAME          32868010
I28545             MOVE SPACES      TO IN402-ATT-DMM-FIR-NAME           32868110
I28545             SET IN402-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           32868210
I28545             SET IN402-PS-ATTR-FOUND TO TRUE                      32868310
I28545             MOVE ZEROS       TO IN402-PV-ATT-SQLCDE              32868410
I28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               32868510
I28545         WHEN OTHER                                               32868601
I28545             MOVE SPACES      TO IN402-ATT-DMM-LAST-NAME          32868710
I28545             MOVE SPACES      TO IN402-ATT-DMM-FIR-NAME           32868810
I28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   32868910
I28545             SET IN402-PV-ATT-SQL-ERROR TO TRUE                   32869010
I28545             SET IN402-PV-MBS-LOOKUP    TO TRUE                   32869110
I28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  32869210
I28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              32869310
I28545             STRING '  PARA: IN402-INV-MBS-DMM-LOOKUP - '         32869410
I28545                                       DELIMITED BY SIZE          32869501
I28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             32869610
I28545                    '  ' DELIMITED BY SIZE                        32869701
I28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         32869810
I28545                    '  ' DELIMITED BY SIZE                        32869901
I28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        32870010
I28545                    '  ' DELIMITED BY SIZE                        32870101
I28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         32870210
I28545                    '  ' DELIMITED BY SIZE                        32870301
I28545                              INTO IN402-PV-PARAGRAPH             32870410
I28545     END-EVALUATE.                                                32870501
I28545                                                                  32870601
I28545******************************************************************32870701
I28545* IN402-INV-MBS-GMM-LOOKUP.                                       32870810
I28545******************************************************************32870901
I28545 IN402-INV-MBS-GMM-LOOKUP.                                        32871010
I28545                                                                  32871101
I28545     EXEC SQL                                                     32871201
I28545       SELECT B.WORKER_LAST_NAME                                  32871301
I28545             ,B.WORKER_FIR_NAME                                   32871401
I28545       INTO :IN402-ATT-GMM-LAST-NAME                              32871510
I28545           ,:IN402-ATT-GMM-FIR-NAME                               32871610
I28545       FROM TMDSEAR A,                                            32871701
I28545            TRSPBAR B                                             32871801
I28545       WHERE A.OPERCO_NBR = '03'                                  32871901
I28545         AND GMA_NBR = :IN402-ATT-GMA-NBR                         32872010
I28545         AND DMA_NBR = '00'                                       32872101
I28545         AND DEPT_NBR = '000'                                     32872201
I28545         AND MAJ_CL_NBR = '00'                                    32872301
I28545         AND SUB_CL_NBR = '000'                                   32872401
I28545         AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                        32872501
I28545         AND B.WORKER_NBR > DECIMAL(0)                            32872601
I28545         AND B.RSPLVL_CDE  = 'GMM'                                32872701
I28545         AND (:IN402-PV-EFF-BEG-DTE-X >= B.WORKER_STRT_DTE AND    32872810
I28545              :IN402-PV-EFF-BEG-DTE-X <= B.WORKER_END_DTE)        32872910
I28545       WITH UR                                                    32873001
I28545     END-EXEC.                                                    32873101
I28545                                                                  32873201
I28545     EVALUATE TRUE                                                32873301
I28545         WHEN SQLCODE = 0                                         32873401
I28545             SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE              32873510
I28545             SET IN402-PS-ATTR-FOUND TO TRUE                      32873610
I28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              32873710
I28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               32873810
I28545         WHEN SQLCODE = +100                                      32873901
I28545             MOVE SPACES      TO IN402-ATT-GMM-LAST-NAME          32874010
I28545             MOVE SPACES      TO IN402-ATT-GMM-FIR-NAME           32874110
I28545             SET IN402-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           32874210
I28545             SET IN402-PS-ATTR-FOUND TO TRUE                      32874310
I28545             MOVE ZEROS       TO IN402-PV-ATT-SQLCDE              32874410
I28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               32874510
I28545         WHEN OTHER                                               32874601
I28545             MOVE SPACES      TO IN402-ATT-GMM-LAST-NAME          32874710
I28545             MOVE SPACES      TO IN402-ATT-GMM-FIR-NAME           32874810
I28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   32874910
I28545             SET IN402-PV-ATT-SQL-ERROR TO TRUE                   32875010
I28545             SET IN402-PV-MBS-LOOKUP    TO TRUE                   32875110
I28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  32875210
I28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              32875310
I28545             STRING '  PARA: IN402-INV-MBS-GMM-LOOKUP - '         32875410
I28545                                       DELIMITED BY SIZE          32875501
I28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             32875610
I28545                    '  ' DELIMITED BY SIZE                        32875701
I28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         32875810
I28545                    '  ' DELIMITED BY SIZE                        32875901
I28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        32876010
I28545                    '  ' DELIMITED BY SIZE                        32876101
I28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         32876210
I28545                    '  ' DELIMITED BY SIZE                        32876301
I28545                              INTO IN402-PV-PARAGRAPH             32876410
I28545     END-EVALUATE.                                                32876501
I28545                                                                  32876601
F28545******************************************************************32876701
F28545* IN402-INV-MBS-DESC-LOOKUP.                                      32876810
F28545******************************************************************32876901
F28545 IN402-INV-MBS-DESC-LOOKUP.                                       32877010
F28545                                                                  32877101
F28545     MOVE INT00003-DEPT-NBR       TO IN402-CONVERT-DEPT.          32877210
F28545     MOVE IN402-CONVERT-DEPT      TO IN402-PV-WORK-DEPT.          32877310
F28545                                                                  32877401
F28545     MOVE INT00003-MAJ-CL-NBR     TO IN402-CONVERT-MCL.           32877510
F28545     MOVE IN402-CONVERT-MCL       TO IN402-PV-WORK-MCL.           32877610
F28545                                                                  32877701
F28545     MOVE INT00003-SUB-CL-NBR     TO IN402-CONVERT-SCL.           32877810
F28545     MOVE IN402-CONVERT-SCL       TO IN402-PV-WORK-SCL.           32877910
F28545                                                                  32878001
F28545     EXEC SQL                                                     32878101
F28545          SELECT MDSEAR_DESC                                      32878201
F28545          INTO :IN402-ATT-MDSEAR-DESC                             32878310
F28545          FROM TMDSEAR A,                                         32878401
F28545               TAPLAVL B                                          32878501
F28545          WHERE A.OPERCO_NBR = '03'                               32878601
F28545            AND A.DEPT_NBR = :IN402-PV-WORK-DEPT-3X               32878710
F28545            AND A.MAJ_CL_NBR = :IN402-PV-WORK-MCL-2X              32878810
F28545            AND A.SUB_CL_NBR = :IN402-PV-WORK-SCL-3X              32878910
F28545            AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                     32879001
F28545            AND MDSELV_CDE = 'SCL'                                32879101
F28545            AND APLSYS_CDE = 'IN'                                 32879201
F28545            AND DATE(CURRENT TIMESTAMP) BETWEEN                   32879301
F28545                                  STRT_DTE AND END_DTE            32879401
F28545            AND DATE(CURRENT TIMESTAMP) BETWEEN                   32879501
F28545                   MDSEAR_STRT_DTE AND MDSEAR_END_DTE             32879601
F28545        WITH UR                                                   32879701
F28545     END-EXEC.                                                    32879801
F28545                                                                  32879901
F28545     EVALUATE TRUE                                                32880001
F28545         WHEN SQLCODE = 0                                         32880101
F28545             SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE              32880210
F28545             SET IN402-PS-ATTR-FOUND TO TRUE                      32880310
F28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              32880410
F28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               32880510
F28545         WHEN SQLCODE = +100                                      32880601
F28545             MOVE SPACES      TO IN402-ATT-MDSEAR-DESC            32880710
F28545             SET IN402-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           32880810
F28545             SET IN402-PS-ATTR-FOUND TO TRUE                      32880910
F28545             MOVE ZEROS       TO IN402-PV-ATT-SQLCDE              32881010
F28545             MOVE SPACES      TO IN402-PV-PARAGRAPH               32881110
F28545         WHEN OTHER                                               32881201
F28545             MOVE SPACES      TO IN402-ATT-MDSEAR-DESC            32881310
F28545             SET IN402-PV-ATT-NOT-FOUND TO TRUE                   32881410
F28545             SET IN402-PV-ATT-SQL-ERROR TO TRUE                   32881510
F28545             SET IN402-PV-MBS-LOOKUP    TO TRUE                   32881610
F28545             SET IN402-PS-ATTR-NOT-FOUND TO TRUE                  32881710
F28545             MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE              32881810
F28545             STRING '  PARA: IN402-INV-MBS-DESC-LOOKUP - '        32881910
F28545                                       DELIMITED BY SIZE          32882001
F28545                    IN402-PV-SKU-IN DELIMITED BY SIZE             32882110
F28545                    '  ' DELIMITED BY SIZE                        32882201
F28545                    IN402-PV-UPC-NBR-IN DELIMITED BY SIZE         32882310
F28545                    '  ' DELIMITED BY SIZE                        32882401
F28545                    IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE        32882510
F28545                    '  ' DELIMITED BY SIZE                        32882601
F28545                    IN402-PV-ITM-NBR-IN DELIMITED BY SIZE         32882710
F28545                    '  ' DELIMITED BY SIZE                        32882801
F28545                              INTO IN402-PV-PARAGRAPH             32882910
F28545     END-EVALUATE.                                                32883001
F28545                                                                  32883101
28545 ******************************************************************32883201
28545 * IN402-INV-VENDOR-ATTRIB-LOOKUP.                                 32883310
28545 ******************************************************************32883401
28545  IN402-INV-VENDOR-ATTRIB-LOOKUP.                                  32883510
BV                                                                      32883601
RONNA *    SET BV003-PV-UPC-ID-LOOKUP TO TRUE.                          32883711
RONNA *    THERE IS NO BRAND IN THE SKU DELETE TABLE AT THIS TIME.      32883801
RONNA *    SO DEFAULT THE BRAND TO UNKNOWN BRAND VALUE 2230             32883901
RONNA      SET BV003-PV-BRND-VND-DPT-LOOKUP TO TRUE.                    32884011
BV                                                                      32884101
RONNA      MOVE 2230                     TO BV003-PV-BRAND-IN-9.        32884211
RONNA                                                                   32884301
BV    **** MOVE INT00003-EFF-BEG-TMST (1:10) TO BV003-PV-EFF-DTE-IN.    32884411
BV         MOVE IN402-PV-EFF-DTE-IN   TO BV003-PV-EFF-DTE-IN.           32884511
RONNA *    MOVE INT00003-INTR-UPC-ID  TO BV003-PV-UPC-ID-IN-9.          32884611
RONNA      IF IN402-PV-ENT-ID-IN = SPACES                               32884710
BV            MOVE INT00003-ENT-ID       TO BV003-PV-ENT-ID-IN-9        32884811
RONNA      ELSE                                                         32884901
RONNA         MOVE IN402-PV-ENT-ID-IN-9  TO BV003-PV-ENT-ID-IN-9        32885011
RONNA      END-IF.                                                      32886001
RONNA                                                                   32887001
RONNA      IF IN402-PV-DEPT-IN = SPACES                                 32888010
BV            MOVE INT00003-DEPT-NBR     TO BV003-PV-DEPT-IN-9          32889011
RONNA      ELSE                                                         32890001
RONNA         MOVE IN402-PV-DEPT-IN-9    TO BV003-PV-DEPT-IN-9          32900011
RONNA      END-IF.                                                      32910001
BV                                                                      32920001
RONNA *    DISPLAY ' IN IN402-INV-VENDOR-ATTRIB-LOOKUP ****'.           32930010
RONNA *    DISPLAY ' BV003-PV-ENT-ID-IN-9: ' BV003-PV-ENT-ID-IN-9.      32940011
RONNA *    DISPLAY ' BV003-PV-BRAND-IN-9 : ' BV003-PV-BRAND-IN-9.       32950011
RONNA *    DISPLAY ' BV003-PV-EFF-DTE-IN : ' BV003-PV-EFF-DTE-IN.       32960011
RONNA *    DISPLAY ' BV003-PV-DEPT-IN-9  : ' BV003-PV-DEPT-IN-9.        32961011
RONNA                                                                   32962001
BV         PERFORM BV003-LOOKUP-MAIN.                                   32963011
BV         IF BV003-PV-FOUND-REL-OR-UNK OR                              32964011
RONNA         BV003-PAST-OR-FUT-DBV-REL-FND                             32965011
BV            SET IN402-PV-ATT-FOUND-AS-RQSTD TO TRUE                   32966010
BV            SET IN402-PS-ATTR-FOUND TO TRUE                           32967010
RONNA         SET IN402-PS-BVUTIL-FOUND TO TRUE                         32968010
RONNA         IF IN402-PS-DBV-NO-ASSUMP                                 32969010
RONNA            SET IN402-PV-DBV-FOUND-AS-RQSTD TO TRUE                32970010
RONNA         ELSE                                                      32980001
RONNA            SET IN402-PV-DBV-FOUND-WITH-ASSMPT TO TRUE             32981010
RONNA         END-IF                                                    32982001
BV         ELSE                                                         32983001
BV            MOVE ZEROS       TO BV003-PV-DEPT-OUT                     32984011
BV            MOVE ZEROS       TO BV003-PV-ENT-ID-OUT                   32985011
BV            MOVE ZEROS       TO BV003-PV-RLTNSHP-ID-OUT               32986011
BV            MOVE ZEROS       TO BV003-PV-BRAND-OUT                    32987011
BV            SET IN402-PV-ATT-NOT-FOUND TO TRUE                        32988010
BV            SET IN402-PV-BRAND-LOOKUP  TO TRUE                        32989010
BV            SET IN402-PS-ATTR-NOT-FOUND TO TRUE                       32990010
RONNA         SET IN402-PV-DBV-NOT-FOUND TO TRUE                        33000010
BV            MOVE SQLCODE     TO IN402-PV-ATT-SQLCDE                   33010010
BV            STRING '  PARA: IN402-INV-VENDOR-ATTRIB-LOOKUP - '        33020010
BV                                      DELIMITED BY SIZE               33021001
BV                   IN402-PV-SKU-IN DELIMITED BY SIZE                  33022010
BV                   '  ' DELIMITED BY SIZE                             33023001
BV                   IN402-PV-UPC-NBR-IN DELIMITED BY SIZE              33024010
BV                   '  ' DELIMITED BY SIZE                             33025001
BV                   IN402-PV-UPC-ID-IN-X DELIMITED BY SIZE             33026010
BV                   '  ' DELIMITED BY SIZE                             33027001
BV                   IN402-PV-ITM-NBR-IN DELIMITED BY SIZE              33028010
BV                   '  ' DELIMITED BY SIZE                             33029001
BV                             INTO IN402-PV-PARAGRAPH                  33030010
BV         END-IF.                                                      33040001
BV                                                                      33050001
RONNA5******************************************************************33060001
RONNA5* IN402-INV-UNKN-VEND-ATT-LOOKUP.                                 33070010
RONNA5******************************************************************33080001
RONNA5 IN402-INV-UNKN-VEND-ATT-LOOKUP.                                  33090010
RONNA5                                                                  33100001
RONNA5*    THIS IS FOR WHEN AN ITEM IS NOT FOUND IN EITHER VSM OR       33101001
RONNA5*    THE SKU DELETE TABLE.   THE VENDOR AND BRAND TO THIS ITEM    33102001
RONNA5*    THE PRICING MODULE WILL DEFAUL THE VENDOR AND BRAND TO       33103001
RONNA5*    UNKNOWN/UNKNOWN 5161/2230, BUT A SWITCH WILL INDICATE THAT   33104001
RONNA5*    THE BRAND VENDOR RELATIONSHIP WAS NOT FOUND.                 33105001
RONNA5*                                                                 33106001
RONNA5*    THE DEPARTMENT NUMBER MUST BE PASSED INTO THE PRICING        33107001
RONNA5*    UTILITY TO BE ABLE TO ASSIGN A DATALESS KEY.                 33108001
RONNA5     IF IN402-PV-DEPT-IN = SPACES                                 33108110
RONNA5        CONTINUE                                                  33108201
RONNA5     ELSE                                                         33108301
RONNA5        SET BV003-PV-BRND-VND-DPT-LOOKUP TO TRUE                  33108411
RONNA5                                                                  33108501
RONNA5        MOVE 2230                     TO BV003-PV-BRAND-IN-9      33108611
S28582        IF IN402-PV-ENT-ID-IN = SPACES                            33108710
S28582            MOVE 5161                 TO BV003-PV-ENT-ID-IN-9     33108811
S28582        ELSE                                                      33108901
S28582            MOVE IN402-PV-ENT-ID-IN-9 TO BV003-PV-ENT-ID-IN-9     33109011
S28582        END-IF                                                    33109101
RONNA5        MOVE IN402-PV-EFF-DTE-IN   TO BV003-PV-EFF-DTE-IN         33109211
RONNA5        MOVE IN402-PV-DEPT-IN-9    TO BV003-PV-DEPT-IN-9          33109311
RONNA5        PERFORM BV003-LOOKUP-MAIN                                 33109411
RONNA5        SET IN402-PV-DBV-NOT-FOUND TO TRUE                        33109510
RONNA5     END-IF.                                                      33109601
RONNA5                                                                  33109701
RONNA5                                                                  33109801
RONNA5******************************************************************33109901
RONNA5* IN402-INV-UNKN-VEND-OUTPUT                                      33110010
RONNA5******************************************************************33111001
RONNA5 IN402-INV-UNKN-VEND-OUTPUT.                                      33112010
RONNA5                                                                  33113001
RONNA5     IF IN402-PV-SKU-IN-NUM     NOT EQUAL ZEROS                   33114010
RONNA5         MOVE IN402-PV-SKU-IN-NUM     TO IN402-VND-SKU-OUT        33115010
RONNA5     ELSE                                                         33115101
RONNA5         MOVE ZEROS                   TO IN402-VND-SKU-OUT        33115210
RONNA5     END-IF.                                                      33115301
RONNA5                                                                  33115401
RONNA5     IF IN402-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   33115510
RONNA5         MOVE IN402-PV-UPC-NBR-IN-NUM TO IN402-VND-UPC-OUT        33115610
RONNA5     ELSE                                                         33115701
RONNA5         MOVE ZEROS                   TO IN402-VND-UPC-OUT        33115810
RONNA5     END-IF.                                                      33115901
RONNA5                                                                  33116001
RONNA5     IF IN402-PV-ITM-NBR-IN     NOT EQUAL ZEROS                   33117010
RONNA5         MOVE IN402-PV-ITM-NBR-IN     TO IN402-VND-ITM-NBR-OUT    33117110
RONNA5     ELSE                                                         33117201
RONNA5         MOVE ZEROS                   TO IN402-VND-ITM-NBR-OUT    33117310
RONNA5     END-IF.                                                      33117401
RONNA5                                                                  33117501
RONNA5     MOVE BV003-PV-DEPT-OUT       TO IN402-VND-DEPT-OUT.          33117611
RONNA5     MOVE BV003-PV-ENT-ID-OUT     TO IN402-VND-ENT-ID-OUT.        33117711
RONNA5     MOVE BV003-PV-RLTNSHP-ID-OUT TO IN402-VND-ML-LO-MDSE-LVL-ID. 33117811
RONNA5     MOVE BV003-PV-BRAND-OUT      TO IN402-VND-LBL-SEQ-NBR.       33117911
RONNA5                                                                  33118001
28545 ******************************************************************33118101
28545 ******************************************************************33118201
28545 * IN402-INV-PRICE-OUTPUT.                                         33118310
28545 ******************************************************************33118401
28545  IN402-INV-PRICE-OUTPUT.                                          33118510
28545                                                                   33118601
28545      MOVE INT00003-SKU-NBR        TO IN402-PRC-SKU-OUT.           33118710
RONNA      MOVE INT00003-SKU-NBR        TO IN402-PV-WORK-SKU.           33118810
Z28545                                                                  33118901
Z28545     IF IN402-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   33119010
Z28545         MOVE IN402-PV-UPC-NBR-IN-NUM TO IN402-PRC-UPC-OUT        33120010
Z28545     ELSE                                                         33130001
Z28545         MOVE INT00003-UPC-NBR        TO IN402-PRC-UPC-OUT        33140010
Z28545     END-IF.                                                      33150001
Z28545                                                                  33160001
28545      MOVE INT00003-INTR-UPC-ID    TO IN402-PRC-UPCID-OUT.         33170010
28545      MOVE INT00003-ITM-NBR        TO IN402-PRC-ITM-NBR-OUT.       33180010
28545                                                                   33190001
28545      MOVE INT00003-EFF-BEG-TMST (1:10)                            33200001
28545                                   TO IN402-PRC-EFF-BEG-DTE-OUT.   33210010
28545                                                                   33220001
28545      IF IN402-PV-NULL-EFF-END-TMST IS LESS THAN ZEROS             33230010
28545          MOVE SPACES              TO IN402-PRC-EFF-END-DTE-OUT    33240010
28545      ELSE                                                         33250001
28545          MOVE INT00003-EFF-END-TMST (1:10)                        33260001
28545                                   TO IN402-PRC-EFF-END-DTE-OUT    33270010
28545      END-IF.                                                      33280001
28545                                                                   33290001
28545      IF IN402-PV-NULL-UPC-STAT-CDE IS LESS THAN ZEROS             33300010
28545          MOVE SPACES                TO IN402-PRC-STATUS-OUT       33310010
28545      ELSE                                                         33320001
28545          MOVE INT00003-UPC-STAT-CDE TO IN402-PRC-STATUS-OUT       33330010
28545      END-IF.                                                      33340001
28545                                                                   33350001
28545      MOVE INT00003-UNT-RTL-CHG-DTE  TO IN402-PRC-UPC-CHG-DTE-OUT. 33360010
28545      MOVE INT00003-UPC-STAT-CHG-DTE TO IN402-PRC-STAT-CHG-DTE-OUT.33370010
28545                                                                   33380001
28545      IF IN402-PV-NULL-ORIG-CLR-DTE IS LESS THAN ZEROS             33390010
28545          MOVE SPACES                TO IN402-PRC-ORIG-CLR-DTE     33400010
28545      ELSE                                                         33410001
28545          MOVE INT00003-ORIG-CLR-DTE TO IN402-PRC-ORIG-CLR-DTE     33420010
28545      END-IF.                                                      33430001
28545                                                                   33440001
28545      IF IN402-PV-NULL-MKDN-CDE IS LESS THAN ZEROS                 33450010
28545          MOVE SPACES              TO IN402-PRC-MKDN-CDE           33460010
28545      ELSE                                                         33470001
28545          MOVE INT00003-MKDN-CDE   TO IN402-PRC-MKDN-CDE           33480010
28545      END-IF.                                                      33490001
28545                                                                   33500001
28545      IF IN402-PV-NULL-MEITGP-NBR IS LESS THAN ZEROS               33510010
28545          MOVE ZEROS               TO IN402-PRC-MEITGP-NBR         33520010
28545      ELSE                                                         33530001
28545          MOVE INT00003-MEITGP-NBR TO IN402-PRC-MEITGP-NBR         33540010
28545      END-IF.                                                      33550001
28545                                                                   33560001
28545      MOVE IN402-PV-MITGPL-QTY     TO IN402-PRC-MITGPL-QTY.        33570010
28545      MOVE IN402-PV-MITGPL-GP-AMT  TO IN402-PRC-GP-AMT.            33580010
28545                                                                   33590001
28545      MOVE IN402-PV-WORK-RETAIL    TO IN402-PRC-UNIT-RTL-OUT.      33600010
28545      MOVE ZEROS                   TO IN402-PRC-EXTD-RTL-OUT.      33610010
28545                                                                   33620001
28545 ******************************************************************33630001
28545 * IN402-INV-ATTRIB-OUTPUT.                                        33640010
28545 ******************************************************************33650001
28545  IN402-INV-ATTRIB-OUTPUT.                                         33660010
28545                                                                   33670001
28545      MOVE INT00003-SKU-NBR        TO IN402-ATT-SKU-OUT.           33680010
Z28545                                                                  33690001
Z28545     IF IN402-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   33700010
Z28545         MOVE IN402-PV-UPC-NBR-IN-NUM TO IN402-ATT-UPC-OUT        33710010
Z28545     ELSE                                                         33720001
Z28545         MOVE INT00003-UPC-NBR        TO IN402-ATT-UPC-OUT        33730010
Z28545     END-IF.                                                      33740001
Z28545                                                                  33750001
28545      MOVE INT00003-INTR-UPC-ID    TO IN402-ATT-UPCID-OUT.         33760010
28545      MOVE INT00003-ITM-NBR        TO IN402-ATT-ITM-NBR-OUT.       33770010
28545                                                                   33780001
28545      MOVE INT00003-DEPT-NBR       TO IN402-ATT-DEPT-OUT.          33790010
28545      MOVE INT00003-MAJ-CL-NBR     TO IN402-ATT-MCL-OUT.           33800010
28545      MOVE INT00003-SUB-CL-NBR     TO IN402-ATT-SCL-OUT.           33810010
28545      MOVE INT00003-UPC-STAT-CDE   TO IN402-ATT-STATUS-OUT.        33820010
28545                                                                   33830001
28545      MOVE INT00003-SUB-CL-MDSEAR-ID TO IN402-ATT-MDEAR-ID-OUT.    33831010
28545      MOVE ZEROS                   TO IN402-ATT-STYL-ID-OUT.       33832010
28545                                                                   33833001
28545      IF IN402-PV-NULL-VS-ID IS LESS THAN ZEROS                    33834010
28545          MOVE ZEROS               TO IN402-ATT-VS-ID-OUT          33835010
28545      ELSE                                                         33836001
28545          MOVE INT00003-VS-ID      TO IN402-ATT-VS-ID-OUT          33837010
28545      END-IF.                                                      33838001
28545                                                                   33839001
28545      MOVE ZEROS                   TO IN402-ATT-VS-NBR-OUT.        33840010
28545                                                                   33850001
28545      MOVE INT00003-ENT-ID         TO IN402-ATT-ENT-ID-OUT.        33860010
28545      MOVE EXTENT-DUN-NBR          TO IN402-ATT-DUNS-NBR-OUT.      33870010
28545      MOVE VNDDPT-INHOUSE-NBR      TO IN402-ATT-INHSE-NBR-OUT.     33880010
D28545     MOVE INT00003-PLU-DWNLD-IND  TO IN402-ATT-PLU-DWNLD-IND.     33890010
28545                                                                   33900001
28545 ******************************************************************33910001
28545 * IN402-INV-VENDOR-OUTPUT.                                        33920010
28545 ******************************************************************33930001
28545  IN402-INV-VENDOR-OUTPUT.                                         33940010
28545                                                                   33950001
28545      MOVE INT00003-SKU-NBR        TO IN402-VND-SKU-OUT.           33960010
Z28545                                                                  33970001
Z28545     IF IN402-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   33980010
Z28545         MOVE IN402-PV-UPC-NBR-IN-NUM TO IN402-VND-UPC-OUT        33990010
Z28545     ELSE                                                         34000001
Z28545         MOVE INT00003-UPC-NBR        TO IN402-VND-UPC-OUT        34010010
Z28545     END-IF.                                                      34020001
Z28545                                                                  34030001
28545      MOVE INT00003-INTR-UPC-ID    TO IN402-VND-UPCID-OUT.         34040010
28545      MOVE INT00003-ITM-NBR        TO IN402-VND-ITM-NBR-OUT.       34050010
28545                                                                   34060001
BV         MOVE BV003-PV-DEPT-OUT       TO IN402-VND-DEPT-OUT.          34070011
BV         MOVE BV003-PV-ENT-ID-OUT     TO IN402-VND-ENT-ID-OUT.        34080011
BV         MOVE BV003-PV-RLTNSHP-ID-OUT TO IN402-VND-ML-LO-MDSE-LVL-ID. 34090011
BV         MOVE BV003-PV-BRAND-OUT      TO IN402-VND-LBL-SEQ-NBR.       34100011
BV                                                                      34110001
28545 ******************************************************************34123002
28545 ******************************************************************34130001
28545 ******************************************************************34140001
28545 * BRAND VENDOR RELATIONSHIP UTILITY FUNCTIONS.                    34141001
28545 ******************************************************************34142001
W31475*    COPY BVPD001.                                                34143007
W31475     COPY BVPD003.                                                34143107
BV                                                                      34144001
