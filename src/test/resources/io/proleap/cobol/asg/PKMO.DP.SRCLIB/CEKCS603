000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    CEKCS603.                                         00040000
000500 AUTHOR.        DENISE HAHN.                                      00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  12-14-1999.                                       00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    S603 - CENTRAL STOCK INTERFACE - PULL ITEM STORE LIST      * 00110000
001200*                                                               * 00120000
001300*---------------------------------------------------------------* 00130000
      *  DAVID KIEFER 04/29/2010 WR#38216                               00130102
      *  CHANGE FOR EFC2 PROJECT                                        00130202
001300*---------------------------------------------------------------* 00131001
263455* CHANGED 10/29/2021    BY JIM HUNTER      WR: CHG0263455         00132008
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00133008
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00134008
263455*----------------------------------------------------------------*00135008
CICS  * CHANGED 10/20/2022    BY JIM HUNTER      WR: CHG0276924         00136010
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00137009
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00138009
CICS  *-----------------------------------------------------------------00139009
001400 EJECT                                                            00140000
001500 ENVIRONMENT DIVISION.                                            00150000
001600                                                                  00160000
001700 DATA DIVISION.                                                   00170000
001800                                                                  00180000
001900 WORKING-STORAGE SECTION.                                         00190000
002000                                                                  00200000
002100 01  DK-DB2-KEYS.                                                 00210000
002200     15  DK-PULL-NUMBER                 PIC S9(09)  VALUE ZERO    00220000
002300                                                    COMP.         00230000
002400     15  DK-REF-NUMBER                  PIC  X(15)  VALUE SPACES. 00240000
002500     15  DK-LINE-NUMBER                 PIC S9(04)  VALUE ZERO    00250000
002600                                                    COMP.         00260000
002700     15  DK-STORE-NUMBER                PIC S9(04)  VALUE ZERO    00270000
002800                                                    COMP.         00280000
002900*LMM                                                              00290000
003000     15  DK-LOC-ID                      PIC S9(04)  VALUE ZERO    00300000
003100                                                    COMP.         00310000
003200     15  DK-LINE-STATUS                 PIC  X(02)  VALUE SPACES. 00320000
003210     15  DK-RDM-PULL-NUMBER             PIC S9(09)  VALUE ZERO    00321000
003220                                                    COMP.         00322000
003230     15  DK-DUMMY-FIELD                 PIC S9(01)  VALUE ZERO    00323000
003240                                                    COMP.         00324000
003250                                                                  00325000
003260                                                                  00326000
003270 01  PC-PROGRAM-CONSTANTS.                                        00327000
003280     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CE603A  '.  00328000
003290     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CEKM603 '.  00329000
003300     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CEKCS603'.  00330000
003400     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00340000
003500     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00350000
003600     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00360000
003700     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00370000
003800*LMM                                                              00380000
003900     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +8           00390000
004000                                               COMP SYNC.         00400000
004100     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00410000
004200                                               COMP SYNC.         00420000
004300     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00430000
004400                                               COMP-3.            00440000
004500     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00450000
004600                                               COMP SYNC.         00460000
004700     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00470000
004800                                               COMP-3.            00480000
004900     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00490000
005000     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00500000
005100     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00510000
005200     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00520000
005300     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00530000
005400     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00540000
005500     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00550000
005600                                               COMP.              00560000
005700     05  PC-CA                     PIC  X(02)  VALUE 'CA'.        00570000
005800     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00580000
005900     05  PC-IP                     PIC  X(02)  VALUE 'IP'.        00590000
006000     05  PC-NW                     PIC  X(02)  VALUE 'NW'.        00600000
006100     05  PC-PD                     PIC  X(02)  VALUE 'PD'.        00610000
006200     05  PC-AD                     PIC  X(02)  VALUE 'AD'.        00620000
006300     05  PC-IN                     PIC  X(02)  VALUE 'IN'.        00630000
006400     05  PC-MA                     PIC  X(02)  VALUE 'MA'.        00640000
006500     05  PC-01                     PIC  X(02)  VALUE '01'.        00650000
006600     05  PC-ONE                    PIC  9(04)  VALUE 0001.        00660000
006700*                                                                 00670000
006800*----------------------------------------------------------------*00680000
006900*  DESCRIPTION CONSTANTS                                         *00690000
007000*----------------------------------------------------------------*00700000
007100     05  PC-ALL-DESC                PIC X(08)  VALUE 'ALL     '.  00710000
007200     05  PC-NEW-DESC                PIC X(08)  VALUE 'NEW     '.  00720000
007300     05  PC-PULL-STATUS-CANCELLED   PIC X(08)  VALUE 'CANCELED'.  00730000
007400     05  PC-IN-PROCESS-DESC         PIC X(08)  VALUE 'IN PROCS'.  00740000
007500     05  PC-DISTRIB-DESC            PIC X(08)  VALUE 'DISTRBTD'.  00750000
007600     05  PC-POSTED-DESC             PIC X(08)  VALUE 'POSTED  '.  00760000
007700     05  PC-ADAM-DESC               PIC X(08)  VALUE 'ADAM    '.  00770000
007800     05  PC-INFOREM-DESC            PIC X(08)  VALUE 'INFOREM '.  00780000
007900     05  PC-MANUAL-DESC             PIC X(08)  VALUE 'MANUAL  '.  00790000
008000     05  PC-UNKNOWN-DESC            PIC X(08)  VALUE 'UNKNOWN '.  00800000
008100     05  PC-PULL-NBR-SEQ-DESC       PIC X(10)  VALUE 'PULL # SEQ'.00810000
008200     05  PC-CRTE-DTE-SEQ-DESC       PIC X(10)  VALUE 'DATE SEQ  '.00820000
008300     05  PC-UNKNOWN-SKU-DESC        PIC X(15)                     00830000
008400                                           VALUE '** UNKNOWN **'. 00840000
008500*                                                                 00850000
008600*----------------------------------------------------------------*00860000
008700*  SYSTEM MESSAGES                                               *00870000
008800*----------------------------------------------------------------*00880000
008900*   00005 = INVALID VALUE                                        *00890000
009000*   00008 = MUST BE NUMERIC                                      *00900000
009100*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00910000
009200*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00920000
009300*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00930000
009400*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00940000
009500*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00950000
009600*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00960000
009700*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00970000
009800*   00069 - TOP OF LIST                                          *00980000
009900*   00070 - BOTTOM OF LIST                                       *00990000
010000*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01000000
010100*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01010000
010200*   00279 - MORE ITEMS TO DISPLAY                                *01020000
010300*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01030000
010400*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01040000
010500*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*01050000
010600*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *01060000
010700*   02245 = CANNOT UPDATE ACTUAL UNITS - PULL LINE ITEM HAS BEEN *01070000
010800*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*01080000
010900*   02229 = YOU DO NOT HAVE AUTHORITY TO ADD STORE DISTRIBUTION   01090000
011000*   02333 = CANNOT ADD STORE DISTRIBUTION - STATUS IS POSTED/DISTR01100000
011100*   02355 = CANNOT ADJUST STORE DISTRIBUTION - LINE STATUS IS NEW 01110000
011200*   02495 = F KEY CANNOT BE USED - DISTR. UNITS MAINTAINED BY RDM 01120000
011300*   02553 = F KEY NOT AVAILABLE - ONLY USED IF USING RDM APPLICAT 01130000
011400*   99901 = INVALID COMMAND WAS ENTERED                          *01140000
011500*----------------------------------------------------------------*01150000
011600     05  PC-TSYMSG-NUMBERS.                                       01160000
011700         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01170000
011800         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01180000
011900         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01190000
012000         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01200000
012100         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01210000
012200         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01220000
012300         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01230000
012400         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01240000
012500         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01250000
012600         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01260000
012700         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01270000
012800         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01280000
012900         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01290000
013000         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01300000
013100         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01310000
013200         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01320000
013300         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01330000
013400         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01340000
013500         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  01350000
013600         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  01360000
013700         10  PC-TSYMSG-02245            PIC  9(05)  VALUE 02245.  01370000
013800         10  PC-TSYMSG-02252            PIC  9(05)  VALUE 02252.  01380000
013900         10  PC-TSYMSG-02329            PIC  9(05)  VALUE 02329.  01390000
014000         10  PC-TSYMSG-02333            PIC  9(05)  VALUE 02333.  01400000
014100         10  PC-TSYMSG-02355            PIC  9(05)  VALUE 02355.  01410000
014200         10  PC-TSYMSG-02495            PIC  9(05)  VALUE 02495.  01420000
014300         10  PC-TSYMSG-02553            PIC  9(05)  VALUE 02553.  01430000
014400         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01440000
014500*                                                                 01450000
014600 01  PS-PROGRAM-SWITCHES.                                         01460000
014700     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01470000
014800         88  PS-NO-ERROR                            VALUE 'Y'.    01480000
014900         88  PS-ERROR                               VALUE 'N'.    01490000
015000     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   01500000
015100         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   01510000
015200         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   01520000
015300     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01530000
015400         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01540000
015500         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01550000
015600     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01560000
015700         88  PS-DONE                                VALUE 'Y'.    01570000
015800         88  PS-NOT-DONE                            VALUE 'N'.    01580000
015900     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01590000
016000         88  PS-LIST-END                            VALUE  'Y'.   01600000
016100         88  PS-NO-LIST-END                         VALUE  'N'.   01610000
016200     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   01620000
016300         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   01630000
016400         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   01640000
016500*                                                                 01650000
016600 01  PV-PROGRAM-VARIABLES.                                        01660000
016700     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01670000
016800                                        COMP SYNC.                01680000
016900     05  PV-DISPLAY-PULL-NBR            PIC  9(09)  VALUE ZEROES. 01690000
017000     05  PV-SUB                         PIC S9(04)  VALUE +0      01700000
017100                                                    COMP SYNC.    01710000
017200     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01720000
017300                                                    COMP SYNC.    01730000
017400     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01740000
017500                                                    COMP-3.       01750000
017600     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01760000
017700                                                    COMP-3.       01770000
017800     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01780000
017900                                                    COMP-3.       01790000
018000     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01800000
018100                                                    COMP-3.       01810000
018200     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01820000
018300                                                    COMP-3.       01830000
018400     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01840000
018500                                                    COMP-3.       01850000
018600     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01860000
018700                                                    COMP-3.       01870000
018800     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01880000
018900                                                    COMP SYNC.    01890000
019000     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01900000
019100                                                    COMP SYNC.    01910000
019200     05  PV-ITEM                        PIC S9(04)  VALUE +0      01920000
019300                                                    COMP SYNC.    01930000
019400     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01940000
019500                                                    COMP SYNC.    01950000
019600     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01960000
019700                                                    COMP SYNC.    01970000
019800     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01980000
019900                                                    COMP SYNC.    01990000
020000     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02000000
020100                                                    COMP SYNC.    02010000
020200     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02020000
020300                                                    COMP SYNC.    02030000
020400     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02040000
020500                                                    COMP SYNC.    02050000
020600     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02060000
020700                                                    COMP SYNC.    02070000
020800     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02080000
020900                                                    COMP SYNC.    02090000
021000     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02100000
021100                                                    COMP SYNC.    02110000
021200     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02120000
021300                                                    COMP SYNC.    02130000
021400     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02140000
021500                                                    COMP SYNC.    02150000
021600     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02160000
021700                                                    COMP SYNC.    02170000
021800     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02180000
021900                                                    COMP SYNC.    02190000
022000     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02200000
022100                                                    COMP.         02210000
022200     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02220000
022300                                                    COMP.         02230000
022400     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02240000
022500                                                    COMP.         02250000
022600     05  PV-SOFT-ABORT-MSG.                                       02260000
022700         10  FILLER            PIC X(12) VALUE ' CEKCS603 - '.    02270000
022800         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02280000
022900         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02290000
023000         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02300000
023100         10  PV-SOFT-PARAGRAPH PIC X(30).                         02310000
023200     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02320000
023300                                                     COMP SYNC.   02330000
023400     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02340000
023500     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02350000
023600     05  PV-CICS-MSG-HOLD.                                        02360000
023700         10  FILLER                      PIC  X(01)  VALUE SPACE. 02370000
023800         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02380000
023900     05  PV-CICS-MSG-HOLD2.                                       02390000
024000         10  FILLER                      PIC  X(01)  VALUE SPACE. 02400000
024100         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02410000
024200                                                                  02420000
024300                                                                  02430000
024400     05  PV-CREATE-TMST                 PIC X(26)   VALUE SPACES. 02440000
024500     05  PV-CREATE-TMST-R REDEFINES  PV-CREATE-TMST.              02450000
024600         10   PV-CREATE-CC              PIC X(02).                02460000
024700         10   PV-CREATE-YY              PIC X(02).                02470000
024800         10   FILLER                    PIC X(01).                02480000
024900         10   PV-CREATE-MM              PIC X(02).                02490000
025000         10   FILLER                    PIC X(01).                02500000
025100         10   PV-CREATE-DD              PIC X(02).                02510000
025200         10   FILLER                    PIC X(16).                02520000
025300     05  PV-CREATE-MMDDYY.                                        02530000
025400         10   PV-CREATE-EDIT-MM         PIC X(02)   VALUE SPACES. 02540000
025500         10   PV-CREATE-SLASH-1         PIC X(01)   VALUE SPACES. 02550000
025600         10   PV-CREATE-EDIT-DD         PIC X(02)   VALUE SPACES. 02560000
025700         10   PV-CREATE-SLASH-2         PIC X(01)   VALUE SPACES. 02570000
025800         10   PV-CREATE-EDIT-YY         PIC X(02)   VALUE SPACES. 02580000
025900     05  PV-STATUS-MMDDYY.                                        02590000
026000         10   PV-STATUS-EDIT-MM         PIC X(02)   VALUE SPACES. 02600000
026100         10   PV-STATUS-SLASH-1         PIC X(01)   VALUE SPACES. 02610000
026200         10   PV-STATUS-EDIT-DD         PIC X(02)   VALUE SPACES. 02620000
026300         10   PV-STATUS-SLASH-2         PIC X(01)   VALUE SPACES. 02630000
026400         10   PV-STATUS-EDIT-YY         PIC X(02)   VALUE SPACES. 02640000
026500     05  PV-SELECT-FROM-DATE.                                     02650000
026600         10   PV-SELECT-FROM-EDIT-MM    PIC X(02)   VALUE SPACES. 02660000
026700         10   PV-SELECT-FROM-SLASH-1    PIC X(01)   VALUE SPACES. 02670000
026800         10   PV-SELECT-FROM-EDIT-DD    PIC X(02)   VALUE SPACES. 02680000
026900         10   PV-SELECT-FROM-SLASH-2    PIC X(01)   VALUE SPACES. 02690000
027000         10   PV-SELECT-FROM-EDIT-YY    PIC X(04)   VALUE SPACES. 02700000
027100     05  PV-PULL-SOURCE                 PIC X(02)   VALUE SPACES. 02710000
027200         88   PV-SOURCE-ADAM                        VALUE 'AD'.   02720000
027300         88   PV-SOURCE-INFOREM                     VALUE 'IN'.   02730000
027400         88   PV-SOURCE-MANUAL                      VALUE 'MA'.   02740000
027400         88   PV-SOURCE-XFER                        VALUE 'XF'.   02741005
027500         88   PV-SOURCE-UNKNOWN                     VALUE SPACES. 02750000
027600     05  PV-CEPLIT-ITEM-QTY              PIC S9(09) VALUE ZEROES  02760000
027700                                                    COMP.         02770000
027800     05  PV-CEPLIT-REQ-QTY               PIC S9(09) VALUE ZEROES  02780000
027900                                                    COMP.         02790000
028000     05  PV-CEPLIT-ACTL-QTY              PIC S9(09) VALUE ZEROES  02800000
028100                                                    COMP.         02810000
028200     05  PV-CEPLDS-DISTRB-QTY            PIC S9(09) VALUE ZEROES  02820000
028300                                                    COMP.         02830000
028400     05  PV-CEPLMF-POSTED-QTY            PIC S9(09) VALUE ZEROES  02840000
028410                                                    COMP.         02841000
028420     05  PV-CEPLAU-POSTED-QTY            PIC S9(09) VALUE ZEROES  02842000
028430                                                    COMP.         02843000
028440     05  PV-TOTAL-POSTED-QTY             PIC S9(09) VALUE ZEROES  02844000
028450                                                    COMP.         02845000
028460     05  PV-CEPLDS-STORE-COUNT           PIC S9(09) VALUE ZEROES  02846000
028470                                                    COMP.         02847000
028480     05  PV-DISTRB-RETAIL                PIC S9(06)V99            02848000
028490                                                    VALUE ZEROES. 02849000
028500                                                                  02850000
028600     05  PV-TYPE-1                       PIC X(02)  VALUE SPACES. 02860000
028700         88   PV-TYPE-1-ADAM                        VALUE 'AD'.   02870000
028800         88   PV-TYPE-1-INFOREM                     VALUE 'IN'.   02880000
028900         88   PV-TYPE-1-MANUAL                      VALUE 'MA'.   02890000
029000     05  PV-TYPE-2                       PIC X(02)  VALUE SPACES. 02900000
029100         88   PV-TYPE-2-ADAM                        VALUE 'AD'.   02910000
029200         88   PV-TYPE-2-INFOREM                     VALUE 'IN'.   02920000
029300         88   PV-TYPE-2-MANUAL                      VALUE 'MA'.   02930000
029400     05  PV-TYPE-3                       PIC X(02)  VALUE SPACES. 02940000
029500         88   PV-TYPE-3-ADAM                        VALUE 'AD'.   02950000
029600         88   PV-TYPE-3-INFOREM                     VALUE 'IN'.   02960000
029700         88   PV-TYPE-3-MANUAL                      VALUE 'MA'.   02970000
029800                                                                  02980000
029900     05  PV-STATUS-1                     PIC X(02)  VALUE SPACES. 02990000
030000         88   PV-STATUS-1-NEW                       VALUE 'NW'.   03000000
030100         88   PV-STATUS-1-CANCELLED                 VALUE 'CA'.   03010000
030200         88   PV-STATUS-1-INPROCESS                 VALUE 'IP'.   03020000
030300         88   PV-STATUS-1-DISTRIBTD                 VALUE 'DS'.   03030000
030400         88   PV-STATUS-1-POSTED                    VALUE 'PD'.   03040000
030500     05  PV-STATUS-2                     PIC X(02)  VALUE SPACES. 03050000
030600         88   PV-STATUS-2-NEW                       VALUE 'NW'.   03060000
030700         88   PV-STATUS-2-CANCELLED                 VALUE 'CA'.   03070000
030800         88   PV-STATUS-2-INPROCESS                 VALUE 'IP'.   03080000
030900         88   PV-STATUS-2-DISTRIBTD                 VALUE 'DS'.   03090000
031000         88   PV-STATUS-2-POSTED                    VALUE 'PD'.   03100000
031100     05  PV-STATUS-3                     PIC X(02)  VALUE SPACES. 03110000
031200         88   PV-STATUS-3-NEW                       VALUE 'NW'.   03120000
031300         88   PV-STATUS-3-CANCELLED                 VALUE 'CA'.   03130000
031400         88   PV-STATUS-3-INPROCESS                 VALUE 'IP'.   03140000
031500         88   PV-STATUS-3-DISTRIBTD                 VALUE 'DS'.   03150000
031600         88   PV-STATUS-3-POSTED                    VALUE 'PD'.   03160000
031700     05  PV-STATUS-4                     PIC X(02)  VALUE SPACES. 03170000
031800         88   PV-STATUS-4-NEW                       VALUE 'NW'.   03180000
031900         88   PV-STATUS-4-CANCELLED                 VALUE 'CA'.   03190000
032000         88   PV-STATUS-4-INPROCESS                 VALUE 'IP'.   03200000
032100         88   PV-STATUS-4-DISTRIBTD                 VALUE 'DS'.   03210000
032200         88   PV-STATUS-4-POSTED                    VALUE 'PD'.   03220000
032300     05  PV-STATUS-5                     PIC X(02)  VALUE SPACES. 03230000
032400         88   PV-STATUS-5-NEW                       VALUE 'NW'.   03240000
032500         88   PV-STATUS-5-CANCELLED                 VALUE 'CA'.   03250000
032600         88   PV-STATUS-5-INPROCESS                 VALUE 'IP'.   03260000
032700         88   PV-STATUS-5-DISTRIBTD                 VALUE 'DS'.   03270000
032800         88   PV-STATUS-5-POSTED                    VALUE 'PD'.   03280000
032900                                                                  03290000
033000     05  PV-PULL-NUMBER                  PIC  9(08) VALUE ZEROES. 03300000
033100     05  PV-REF-NUMBER                   PIC  X(15) VALUE SPACES. 03310000
033200     05  PV-CS-LOCATION                  PIC  9(04) VALUE ZEROES. 03320000
033300     05  PV-LINE-NUMBER                  PIC  9(04) VALUE ZEROES. 03330000
033400     05  PV-STORE-NUMBER                 PIC  9(04) VALUE ZEROES. 03340000
033500     05  PV-CEPLIT-ITM-NBR               PIC  9(15) VALUE ZEROES. 03350000
033600     05  PV-LINE-SKU                     PIC  X(08) VALUE SPACES. 03360000
033700     05  PV-LINE-SKU-RETAIL              PIC  9(05)V99            03370000
033800                                                    VALUE ZEROES. 03380000
033900     05  PV-LINE-ITEM                    PIC  9(15) VALUE ZEROES. 03390000
034000     05  PV-LINE-STATUS-CDE              PIC  X(02) VALUE SPACES. 03400000
034100     05  PV-NBR-STORES                   PIC  9(05) VALUE ZEROES. 03410000
034200     05  PV-REQ-PULL-UNITS               PIC  9(06) VALUE ZEROES. 03420000
034300     05  PV-ACT-PULL-UNITS               PIC  9(06) VALUE ZEROES. 03430000
034400     05  PV-DISTRBUTED-UNITS             PIC  9(06) VALUE ZEROES. 03440000
034500     05  PV-UPDATE-UNITS                 PIC  9(05) VALUE ZEROES. 03450000
034600*LMM                                                              03460000
034700     05  PV-MANIFEST-UNITS               PIC S9(09) COMP.         03470000
034800     05  PV-BEFORE-ADJUST                PIC S9(09) COMP.         03480000
034900     05  PV-AFTER-ADJUST                 PIC S9(09) COMP.         03490000
035000     05  PV-ADJUST-UNITS                 PIC S9(09) COMP.         03500000
035100     05  PV-TOT-ADJUST-UNTS              PIC  Z(05)-.             03510000
035200                                                                  03520000
035300     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 03530000
035400     05  PV-PULL-STATUS-CDE              PIC  X(02) VALUE SPACES. 03540000
035500         88   PV-PULL-STATUS-NEW                    VALUE 'NW'.   03550000
035600         88   PV-PULL-STATUS-CANCELLED              VALUE 'CA'.   03560000
035700         88   PV-PULL-STATUS-INPROCESS              VALUE 'IP'.   03570000
035800         88   PV-PULL-STATUS-DISTRIBTD              VALUE 'DS'.   03580000
035900         88   PV-PULL-STATUS-POSTED                 VALUE 'PD'.   03590000
036000     05  PV-PULL-SOURCE-CDE              PIC  X(02) VALUE SPACES. 03600000
036100     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 03610000
036200     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 03620000
036300     05  PV-DIST-PULL-UNITS              PIC  9(06) VALUE ZEROES. 03630000
036400     05  PV-SKU-NUMBER                   PIC  X(08) VALUE SPACES. 03640000
036800                                                                  03650000
036900     05  PV-SEL-TERM-ID                  PIC  X(04).              03660000
037000     05  PV-SEL-TASK-NUMBER              PIC  9(05).              03670000
037100     05  PV-SEL-SEQ                      PIC  9(01).              03680000
037200                                                                  03690000
037300     05  PV-DISPLAY-NO-ZERO              PIC  Z(05).              03700000
037400     05  PV-DISPLAY-ZERO                 PIC  Z(04)9.             03710000
037500     05  PV-4-DIGIT-STORE                PIC  Z(04)  VALUE ZEROES.03720000
037510     05  PV-ZERO-ADJ-UNIT                PIC   Z(04)9-            03730000
037520                                              VALUE ZEROES.       03740000
037530     05  PV-NUMERIC-ADJ-UNITS            PIC   Z(05)-             03750000
037540                                              VALUE ZEROES.       03751000
037600     05  PV-NUMERIC-ACTL-DISTRB-QTY      PIC   Z(04)9-            03752000
037700                                              VALUE ZEROES.       03753000
037800     05  PV-DISPLAY-ACTL-DISTRB-QTY      PIC   X(06) VALUE ZEROES.03754000
037810     05  PV-ADJUSTMENT-CNT               PIC S9(09) VALUE ZEROES  03755000
037820                                                    COMP.         03756000
037900******************************************************************03757000
038000**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03758000
038100**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03759000
038200**  APPLICATION-SPECIFIC COMMAREA.                              **03760000
038300******************************************************************03770000
038400 01  LQW-LIST-QUEUE-WORK-AREA.                                    03780000
038500     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03790000
038600*LMM                                                              03800000
038700     05  LQW-ITEM-ENTRIES               OCCURS 8 TIMES            03810000
038800                                        INDEXED BY LQW-IDX.       03820000
038900         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03830000
039000         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03840000
039100         10  LQW-SELECTED-SW            PIC  X(01).               03850000
039200             88  LQW-SELECT                         VALUE 'S'.    03860000
039300             88  LQW-DESELECT                       VALUE ' '.    03870000
039400         10  LQW-ACTION                 PIC  X(03).               03880000
039500             88  LQW-DEL                            VALUE 'DEL'.  03890000
039600             88  LQW-INQ                            VALUE 'INQ'.  03900000
039700             88  LQW-UPD                            VALUE 'UPD'.  03910000
039800             88  LQW-ERR                            VALUE 'ERR'.  03920000
039900         10  LQW-UPD-UNITS              PIC  Z(05).               03930000
040000         10  LQW-STORE-NUMBER           PIC  9(04).               03940000
040100         10  LQW-NBR-STORES             PIC  Z(05).               03950000
040200         10  LQW-REQ-UNITS              PIC  Z(05).               03960000
040300         10  LQW-DISTRB-UNITS           PIC  X(06).               03970000
040400         10  LQW-MANIFEST-UNITS         PIC  X(05).               03980000
040500         10  LQW-ADJUST-UNITS           PIC  X(06).               03990000
040600         10  LQW-ADJUST-UNITS-SIGNED    PIC S9(05).               04000000
040700         10  LQW-SEL-ZERO-SW            PIC X(01).                04010000
040800             88  LQW-SEL-ZERO-YES       VALUE 'Y'.                04020000
040900             88  LQW-SEL-ZERO-NO        VALUE 'N'.                04030000
040910         10  LQW-STR-POSTED-UNITS       PIC  X(06).               04040000
040920         10  LQW-ACTL-DISTRIB-QTY       PIC  9(06).               04050000
041000                                                                  04060000
041100                                                                  04070000
041200*---------------------------------------------------------------* 04080000
041300* SELECTON QUEUE LAYOUT                                         * 04090000
041400*---------------------------------------------------------------* 04100000
041500     COPY CEWS003.                                                04110000
041600                                                                  04120000
041700                                                                  04130000
041800*---------------------------------------------------------------* 04140000
041900*    MAP LAYOUT                                                 * 04150000
042000*---------------------------------------------------------------* 04160000
042100                                                                  04170000
042200     COPY CEKM603.                                                04180000
042300*                                                                 04190000
042400 01  MR-OCCURS-LAYOUT                   REDEFINES  CE603AO.       04200000
042500     05  FILLER                         PIC X(222).               04210000
042600*LMM                                                              04220000
042700     05  MR-SCROLL-AREA                 OCCURS 8 TIMES.           04230000
042800         10  MR-SELECTL                 PIC S9(04) COMP.          04240000
042900         10  MR-SELECTA                 PIC  X(01).               04250000
043000         10  MR-SELECTC                 PIC  X(01).               04260000
043100         10  MR-SELECTH                 PIC  X(01).               04270000
043200         10  MR-SELECTI                 PIC  X(01).               04280000
043300                                                                  04290000
043400         10  MR-ACTIONL                 PIC S9(04) COMP.          04300000
043500         10  MR-ACTIONA                 PIC  X(01).               04310000
043600         10  MR-ACTIONC                 PIC  X(01).               04320000
043700         10  MR-ACTIONH                 PIC  X(01).               04330000
043800         10  MR-ACTION                  PIC  X(03).               04340000
043900                                                                  04350000
044000         10  MR-UPD-UNITSL              PIC S9(04) COMP.          04360000
044100         10  MR-UPD-UNITSA              PIC  X(01).               04370000
044200         10  MR-UPD-UNITSC              PIC  X(01).               04380000
044300         10  MR-UPD-UNITSH              PIC  X(01).               04390000
044400         10  MR-UPD-UNITS               PIC  X(05).               04400000
044500                                                                  04410000
044600         10  MR-STORE-NUMBERL           PIC S9(04) COMP.          04420000
044700         10  MR-STORE-NUMBERA           PIC  X(01).               04430000
044800         10  MR-STORE-NUMBERC           PIC  X(01).               04440000
044900         10  MR-STORE-NUMBERH           PIC  X(01).               04450000
045000         10  MR-STORE-NUMBER-X.                                   04460000
045100             15  MR-STORE-NUMBER        PIC  Z(04).               04470000
045200                                                                  04480000
045300         10  MR-REQ-UNITSL              PIC S9(04) COMP.          04490000
045400         10  MR-REQ-UNITSA              PIC  X(01).               04500000
045500         10  MR-REQ-UNITSC              PIC  X(01).               04510000
045600         10  MR-REQ-UNITSH              PIC  X(01).               04520000
045700         10  MR-REQ-UNITS               PIC  Z(05).               04530000
045800                                                                  04540000
045900         10  MR-DISTRBUTED-UNITSL       PIC S9(04) COMP.          04550000
046000         10  MR-DISTRBUTED-UNITSA       PIC  X(01).               04560000
046100         10  MR-DISTRBUTED-UNITSC       PIC  X(01).               04570000
046200         10  MR-DISTRBUTED-UNITSH       PIC  X(01).               04580000
046300         10  MR-DISTRBUTED-UNITS        PIC  X(06).               04590000
046400*LMM                                                              04600000
046500         10  MR-MANIFEST-UNITSL         PIC S9(04) COMP.          04610000
046600         10  MR-MANIFEST-UNITSA         PIC  X(01).               04620000
046700         10  MR-MANIFEST-UNITSC         PIC  X(01).               04630000
046800         10  MR-MANIFEST-UNITSH         PIC  X(01).               04640000
046900         10  MR-MANIFEST-UNITS          PIC  Z(05).               04650000
047000                                                                  04660000
047100         10  MR-ADJUST-UNITSL           PIC S9(04) COMP.          04670000
047200         10  MR-ADJUST-UNITSA           PIC  X(01).               04680000
047300         10  MR-ADJUST-UNITSC           PIC  X(01).               04690000
047400         10  MR-ADJUST-UNITSH           PIC  X(01).               04700000
047500         10  MR-ADJUST-UNITS            PIC  X(06).               04710000
047600                                                                  04720000
047700         10  MR-POSTED-UNITSL           PIC S9(04) COMP.          04730000
047800         10  MR-POSTED-UNITSA           PIC  X(01).               04740000
047900         10  MR-POSTED-UNITSC           PIC  X(01).               04750000
047910         10  MR-POSTED-UNITSH           PIC  X(01).               04760000
047920         10  MR-POSTED-UNITS            PIC  X(06).               04770000
047930                                                                  04780000
047940     05  FILLER                         PIC  X(12).               04790000
047950                                                                  04791000
047960                                                                  04792000
047970*----------------------------------------------------------------*04793000
047980**  SECURITY SUBROUTINE PARAMETERS                                04794000
047990*----------------------------------------------------------------*04795000
048000     COPY DPWS008.                                                04796000
048100                                                                  04797000
048200                                                                  04798000
048300*---------------------------------------------------------------* 04799000
048400*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04800000
048500*---------------------------------------------------------------* 04810000
048600                                                                  04820000
048700     COPY DPWS015.                                                04830000
048800                                                                  04840000
048900*---------------------------------------------------------------* 04850000
049000*    FUNCTION KEYS COPYBOOK.                                    * 04860000
049100*---------------------------------------------------------------* 04870000
049200                                                                  04880000
049300     COPY DPWS016.                                                04890000
049400                                                                  04900000
049500*---------------------------------------------------------------* 04910000
049600*    NUMERIC EDIT LAYOUT.                                       * 04920000
049700*---------------------------------------------------------------* 04930000
049800                                                                  04940000
049900     COPY DPWS010I.                                               04950000
050000 EJECT                                                            04960000
050100*---------------------------------------------------------------* 04970000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 04981009
050300*---------------------------------------------------------------* 04990000
050400                                                                  05000000
050500     COPY DPWS030.                                                05010000
CICS       COPY DPWS930.                                                05011009
050600 EJECT                                                            05020000
050700*---------------------------------------------------------------* 05030000
050800*    STANDARD COMMAREA.                                         * 05040000
050900*---------------------------------------------------------------* 05050000
051000                                                                  05060000
051100     COPY DPWS020.                                                05070000
051200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05080000
051300                                                                  05090000
051400*---------------------------------------------------------------* 05100000
051500* INTER-APPLICATION COMMAREA.                                   * 05110000
051600*   CEWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 05120000
051700*             SPEC SCREEN.                                      * 05130000
051800*   CEWS002 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 05140000
051900*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 05150000
052000*---------------------------------------------------------------* 05160000
052100                                                                  05170000
052200         10  INTER-APPL-COMM-AREA       PIC X(200).               05180000
052300     COPY CEWS001.                                                05190000
052400     COPY CEWS002.                                                05200000
052500*---------------------------------------------------------------* 05210000
052600*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05220000
052700*---------------------------------------------------------------* 05230000
052800         10  ASC-SPECIFIC-COMMAREA.                               05240000
052900             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          05250000
053000             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 05260000
053100                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          05270000
053200             15  ASC-CURR-FCLTY-ID           PIC  X(04).          05280000
053300             15  ASC-CURR-FCLTY-ID-N REDEFINES                    05290000
053400                     ASC-CURR-FCLTY-ID       PIC  9(04).          05300000
053500             15  ASC-CS-LOC                  PIC  X(04).          05310000
053600             15  ASC-CS-LOC-R REDEFINES ASC-CS-LOC.               05320000
053700                 20  ASC-CS-LOC-N            PIC  9(04).          05330000
053800             15  ASC-CS-LOCATION-DESC        PIC  X(25).          05340000
053900*LMM                                                              05350000
054000             15  ASC-MANIFEST-UNTS           PIC  9(05).          05360000
054100             15  ASC-ADJUST-UNTS             PIC  Z(05)-.         05370000
054200             15  ASC-DISTRB-UNTS             PIC  9(05).          05380000
054300             15  ASC-TOT-MANIFEST-UNTS       PIC  9(05).          05390000
054400             15  ASC-TOT-ADJUST-UNTS         PIC S9(09) COMP.     05400000
054410             15  ASC-TOT-ADJUST-CNT          PIC S9(09) COMP.     05410000
054500             15  ASC-TOT-DISTRB-UNTS         PIC  9(05).          05420000
054600             15  ASC-STORE-NBR               PIC  9(04).          05430000
054700             15  ASC-PULL-NBR                PIC  X(09).          05440000
054800             15  ASC-PULL-NBR-R REDEFINES ASC-PULL-NBR.           05450000
054900                 20  ASC-PULL-NBR-N          PIC  9(09).          05460000
055000             15  ASC-REF-NBR                 PIC  X(15).          05470000
055200             15  ASC-SKU-NUMBER              PIC  X(08).          05480000
055900             15  ASC-LINE-ITEM               PIC  9(04).          05490000
056000             15  ASC-LINE-SKU-RETAIL         PIC  9(05)V99.       05500000
056100             15  ASC-LINE-STATUS-CDE         PIC  X(02).          05510000
056200                 88   ASC-LINE-STATUS-NEW             VALUE 'NW'. 05520000
056300                 88   ASC-LINE-STATUS-CANCELLED       VALUE 'CA'. 05530000
056400                 88   ASC-LINE-STATUS-INPROCESS       VALUE 'IP'. 05540000
056500                 88   ASC-LINE-STATUS-DISTRIBTD       VALUE 'DS'. 05550000
056600                 88   ASC-LINE-STATUS-POSTED          VALUE 'PD'. 05560000
056700             15  ASC-LINE-STATUS-DESC        PIC  X(08).          05570000
056800             15  ASC-PULL-SELECT-STATUS      PIC  X(01).          05580000
056900                 88  ASC-SELECT-VALID        VALUE 'A' 'C' 'D'    05590000
057000                                                   'I' 'N' 'P'    05600000
057100                                                   ' '.           05610000
057200                 88  ASC-PULL-STATUS-ENTERED VALUE 'A' 'C' 'D'    05620000
057300                                                   'I' 'N' 'P'.   05630000
057400                 88  ASC-SELECT-ALL               VALUE 'A'.      05640000
057500                 88  ASC-SELECT-CNCLD             VALUE 'C'.      05650000
057600                 88  ASC-SELECT-DSTRB             VALUE 'D'.      05660000
057700                 88  ASC-SELECT-INPROC            VALUE 'I'.      05670000
057800                 88  ASC-SELECT-NEW               VALUE 'N'.      05680000
057900                 88  ASC-SELECT-POSTD             VALUE 'P'.      05690000
058000             15  ASC-PULL-SELECT-TYPE        PIC  X(01).          05700000
      *DJK 0429.2010 - ADDED 'X' AS A NEW VALUE                         05701001
058100                 88  ASC-SELECT-SRC-VALID    VALUE 'A' 'D' 'I'    05710000
058200                                                   'M' ' ' 'X'.   05720001
058300                 88  ASC-PULL-SOURCE-ENTERED VALUE 'A' 'D' 'I'    05730000
058400                                                   'M' 'X'.       05740001
058500                 88  ASC-SELECT-SRC-ALL           VALUE 'A'.      05750000
058600                 88  ASC-SELECT-SRC-ADAM          VALUE 'D'.      05760000
058700                 88  ASC-SELECT-SRC-INFOREM       VALUE 'I'.      05770000
058800                 88  ASC-SELECT-SRC-MANUAL        VALUE 'M'.      05780000
058900             15  ASC-PULL-SELECT-DATE-FROM.                       05790000
059000                 20  ASC-FROM-MM             PIC  9(02).          05800000
059100                 20  ASC-FROM-DD             PIC  9(02).          05810000
059200                 20  ASC-FROM-YY             PIC  9(04).          05820000
059300             15  ASC-PULL-SELECT-DATE-TO.                         05830000
059400                 20  ASC-TO-MM               PIC  9(02).          05840000
059500                 20  ASC-TO-DD               PIC  9(02).          05850000
059600                 20  ASC-TO-YY               PIC  9(04).          05860000
059700             15  ASC-SELECT-LIST-SEQUENCE    PIC  X(01).          05870000
059800                 88  ASC-LIST-SEQ-VALID      VALUE 'P' 'D' ' '.   05880000
059900                 88  ASC-LIST-SEQ-ENTERED    VALUE 'P' 'D'.       05890000
060000                 88  ASC-LIST-SEQ-PL-NBR          VALUE 'P'.      05900000
060100                 88  ASC-LIST-SEQ-CR-DTE          VALUE 'D'.      05910000
060200             15  ASC-PULL-STATUS             PIC  X(02).          05920000
060300                 88  ASC-PULL-CANCELLED           VALUE 'CA'.     05930000
060400                 88  ASC-PULL-DISTRIBUTED         VALUE 'DS'.     05940000
060500                 88  ASC-PULL-IN-PROCESS          VALUE 'IP'.     05950000
060600                 88  ASC-PULL-NEW                 VALUE 'NW'.     05960000
060700                 88  ASC-PULL-POSTED              VALUE 'PD'.     05970000
060800             15  ASC-PULL-TYPE               PIC  X(02).          05980000
060900                 88  ASC-PULL-SRC-ADAM            VALUE 'AD'.     05990000
061000                 88  ASC-PULL-SRC-INFOREM         VALUE 'IN'.     06000000
061100                 88  ASC-PULL-SRC-MANUAL          VALUE 'MA'.     06010000
      *DJK 04/29/2010 - ADDED 'XF' AS A NEW VALUE                       06010101
061100                 88  ASC-PULL-SRC-XFER            VALUE 'XF'.     06011001
061200                                                                  06020000
061300             15  FILLER                      PIC  X(125).         06030000
061400*-----------------------------------------------------------------06040000
061500             15  ASC-BLK-SUB                  PIC S9(04) COMP     06050000
061600                                                         SYNC.    06060000
061700             15  ASC-ITEM-SUB                 PIC S9(04) COMP     06070000
061800                                                         SYNC.    06080000
061900             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  06090000
062000             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  06100000
062100             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  06110000
062200             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  06120000
062300             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  06130000
062400             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     06140000
062500                                                         SYNC.    06150000
062600             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  06160000
062700             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  06170000
062800             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         06180000
062900                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     06190000
063000                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     06200000
063100             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         06210000
063200                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     06220000
063300                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     06230000
063400             15  ASC-LIST-QUEUE-NAME.                             06240000
063500                 20  ASC-LIST-TERM-ID         PIC  X(04).         06250000
063600                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  06260000
063700                 20  ASC-LIST-SEQ             PIC  9(01).         06270000
063800                                                                  06280000
063900             15  ASC-START-ITEM-REQUEST.                          06290000
064000                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         06300000
064100                                                                  06310000
064200             15  ASC-SEL-SUB                  PIC S9(4) COMP.     06320000
064300             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     06330000
064400             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          06340000
064500                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 06350000
064600             15  ASC-SEL-QUEUE-NAME.                              06360000
064700                 20  ASC-SEL-TERM-ID          PIC  X(04).         06370000
064800                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  06380000
064900                 20  ASC-SEL-SEQ              PIC  9(01).         06390000
064910             15  ASC-SEL-QUEUE-NAME-2.                            06400000
064920                 20  ASC-SEL-TERM-ID-2        PIC  X(04).         06410000
064930                 20  ASC-SEL-TASK-NUMBER-2    PIC S9(05) COMP-3.  06420000
064940                 20  ASC-SEL-SEQ-2            PIC  9(01).         06430000
065000             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  06440000
065100                                                                  06450000
065200*-----------------------------------------------------------------06460000
065300                                                                  06470000
065400             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06480000
065500                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06490000
065600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06500000
065700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06510000
065800                                                                  06520000
065900                 20  ASC-ITEM-ARRAY.                              06530000
066000*LMM                                                              06540000
066100                     25  ASC-ITEM-ENTRIES OCCURS 8 TIMES.         06550000
066200                         30  ASC-LIST-ITEM-NUMBER                 06560000
066300                                                     PIC S9(09)   06570000
066400                                                     COMP-3.      06580000
066500                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06590000
066600                             88  ASC-VALID-SELECT    VALUE ' '    06600000
066700                                                           'S'    06610000
066800                                                           'B'    06620000
066900                                                           'E'.   06630000
067000                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06640000
067100                             88  ASC-TEMP-SELECT     VALUE 'S'.   06650000
067200                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06660000
067300                             88  ASC-TEMP-END        VALUE 'E'.   06670000
067400                         30  ASC-SELECTED-SW         PIC  X(01).  06680000
067500                             88  ASC-NO-SELECT       VALUE ' '.   06690000
067600                             88  ASC-SELECT          VALUE 'S'.   06700000
067700                             88  ASC-BEGIN           VALUE 'B'.   06710000
067800                             88  ASC-END             VALUE 'E'.   06720000
067900                         30  ASC-ACTION              PIC  X(03).  06730000
068000                         30  ASC-UPD-UNITS-X         PIC  X(05).  06740000
068100                         30  ASC-UPD-UNITS-R REDEFINES            06750000
068200                             ASC-UPD-UNITS-X.                     06760000
068300                             35  ASC-UPD-UNITS       PIC  9(05).  06770000
068400                         30  ASC-STORE-NUMBER        PIC  9(04).  06780000
068500                         30  ASC-NBR-STORES          PIC  Z(05).  06790000
068600                         30  ASC-REQ-UNITS           PIC  Z(05).  06800000
068700                         30  ASC-DISTRB-UNITS        PIC  X(06).  06810000
068800*LMM                                                              06820000
068900                         30  ASC-MANIFEST-UNITS      PIC  9(05).  06830000
069000                         30  ASC-ADJUST-UNITS        PIC  X(06).  06840000
069100                         30  ASC-ADJUST-UNITS-SIGNED PIC S9(05).  06850000
069200                         30  ASC-SEL-ZERO-SW         PIC X(01).   06860000
069300                             88  ASC-SEL-ZERO-YES    VALUE 'Y'.   06870000
069400                             88  ASC-SEL-ZERO-NO     VALUE 'N'.   06880000
069500                         30  ASC-STR-POSTED-UNITS    PIC  X(06).  06890000
069510                         30  ASC-ACTL-DISTRIB-QTY    PIC  9(06).  06900000
069600                                                                  06910000
069700                                                                  06920000
069800     EJECT                                                        06930000
069900*---------------------------------------------------------------* 06940000
070000*    ABEND PROCESSING COPYBOOK.                                 * 06950000
070100*---------------------------------------------------------------* 06960000
070200                                                                  06970000
070300     COPY DPWS013.                                                06980000
070400                                                                  06990000
070500 EJECT                                                            07000000
070600*---------------------------------------------------------------* 07010000
070700*    TCEPLRQ - CENTRAL STOCK PULL REQUESTS                      * 07020000
070800*---------------------------------------------------------------* 07030000
070900     EXEC SQL                                                     07040000
071000          INCLUDE TCEPLRQ                                         07050000
071100     END-EXEC.                                                    07060000
071200*---------------------------------------------------------------* 07070000
071300*    TCEPLDS - CENTRAL STOCK PULL DISTRIBUTION                  * 07080000
071400*---------------------------------------------------------------* 07090000
071500     EXEC SQL                                                     07100000
071600          INCLUDE TCEPLDS                                         07110000
071700     END-EXEC.                                                    07120000
071800*---------------------------------------------------------------* 07130000
071900*    TCEPLIT - CENTRAL STOCK PULL ITEMS                         * 07140000
072000*---------------------------------------------------------------* 07150000
072100     EXEC SQL                                                     07160000
072200          INCLUDE TCEPLIT                                         07170000
072300     END-EXEC.                                                    07180000
072400*---------------------------------------------------------------* 07190000
072500*    TCEPLST - CENTRAL STOCK PULL STATUS                        * 07200000
072600*---------------------------------------------------------------* 07210000
072700     EXEC SQL                                                     07220000
072800          INCLUDE TCEPLST                                         07230000
072900     END-EXEC.                                                    07240000
073000*LMM                                                              07250000
073100*---------------------------------------------------------------* 07260000
073200*    TCEPLMF - CENTRAL STOCK MANIFEST                           * 07270000
073300*---------------------------------------------------------------* 07280000
073400     EXEC SQL                                                     07290000
073500          INCLUDE TCEPLMF                                         07300000
073600     END-EXEC.                                                    07310000
073700*---------------------------------------------------------------* 07320000
073800*    TCEPLAU - CENTRAL STOCK ADJUST AUDIT                       * 07330000
073900*---------------------------------------------------------------* 07340000
074000     EXEC SQL                                                     07350000
074100          INCLUDE TCEPLAU                                         07360000
074200     END-EXEC.                                                    07370000
074900*---------------------------------------------------------------* 07380000
075000*    TKRPRPM - KOHLS/RETEK PARAMETERS                             07390000
075100*---------------------------------------------------------------* 07400000
075200     EXEC SQL                                                     07410000
075300          INCLUDE TKRPRPM                                         07420000
075400     END-EXEC.                                                    07430000
075500*---------------------------------------------------------------* 07440000
075600*    DB2 AREA FOR COMMUNICATIONS                                * 07450000
075700*---------------------------------------------------------------* 07460000
075800     EXEC SQL                                                     07470000
075900          INCLUDE SQLCA                                           07480000
076000     END-EXEC.                                                    07490000
076100                                                                  07500000
076200*---------------------------------------------------------------* 07510000
076300*    LINE ITEM CURSOR                                           * 07520000
076400*---------------------------------------------------------------* 07530000
076500                                                                  07540000
076600     EXEC SQL                                                     07550000
076700          DECLARE LINE-ITEM-DSTR-CSR CURSOR FOR                   07560000
076800              SELECT  CNSTK_REQ_PL_NBR                            07570000
076900                     ,PL_LNE_NBR                                  07580000
077000                     ,STR_NBR                                     07590000
077100                     ,REQ_ORD_QTY                                 07600000
077200                     ,ACTL_DISTRB_QTY                             07610000
077300                FROM  TCEPLDS                                     07620000
077400               WHERE  CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER          07630000
077500                 AND  PL_LNE_NBR       = :DK-LINE-NUMBER          07640000
077600            ORDER BY  STR_NBR                                     07650000
077700     END-EXEC.                                                    07660000
077800                                                                  07670000
077900                                                                  07680000
078000                                                                  07690000
078100 LINKAGE SECTION.                                                 07700000
078200                                                                  07710000
078300 01  DFHCOMMAREA.                                                 07720000
078400     05  FILLER                         OCCURS  1 TO 4072 TIMES   07730000
078500                                        DEPENDING ON EIBCALEN.    07740000
078600         10  FILLER                     PIC X.                    07750000
078700                                                                  07760000
078800 EJECT                                                            07770000
078900 PROCEDURE DIVISION.                                              07780000
079000******************************************************************07790000
079100**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07800000
079200**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **07810000
079300**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07820000
079400******************************************************************07830000
079500 0000-MAIN-MODULE.                                                07840000
079600     INITIALIZE DP030-CICS-API-FIELDS.                            07850000
079700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07860000
079800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07870000
079900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07880000
080000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07890000
080100     MOVE LENGTH OF CE603AI        TO DP030-MAP-LENGTH (1).       07900000
080200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07910000
080300     PERFORM 0001-CALL-CICS-ARCH-API.                             07920000
080400*                                                                 07930000
080500     PERFORM 1000-CONTROL-PROCESSING                              07940000
080600*                                                                 07950000
080700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07960000
080800     PERFORM 0001-CALL-CICS-ARCH-API.                             07970000
080900                                                                  07980000
081000******************************************************************07990000
081100**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **08000000
081200**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **08010000
081300******************************************************************08020000
081400 0001-CALL-CICS-ARCH-API.                                         08030000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08041009
081600                                    DFHCOMMAREA                   08050009
081700                                    DP030-CICS-API-FIELDS         08060009
081800                                    DP020-STANDARD-COMMAREA       08070009
081900                                    CE603AI.                      08080009
082000*                                                                 08090000
082100     IF  DP030-RC-CALL-SUCCESSFUL                                 08100000
082200         CONTINUE                                                 08110000
082300     ELSE                                                         08120000
082400         SET DP013-NO-ROLLBACK                                    08130000
082500             DP013-XCTL-DISPLAY-RESTART                           08140000
082600             DP013-CICS-ABEND      TO TRUE                        08150000
082700         MOVE '0001-CALL-CICS-ARCH-API'                           08160000
082800                                   TO DP013-PARAGRAPH             08170000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O08171009
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08172009
083100         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      08200000
083200         PERFORM DP013-0000-PROCESS-ABEND                         08210000
083300     END-IF.                                                      08220000
083400*----------------------------------------------------------------*08230000
083500* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *08240000
083600* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *08250000
083700*                                                                *08260000
083800* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *08270000
083900*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *08280000
084000*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *08290000
084100*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *08300000
084200*----------------------------------------------------------------*08310000
084300                                                                  08320000
084400 1000-CONTROL-PROCESSING.                                         08330000
084500                                                                  08340000
084600     EVALUATE TRUE                                                08350000
084700         WHEN DP020-NEXT-ACT-INITIAL                              08360000
084800             INITIALIZE ASC-SPECIFIC-COMMAREA                     08370000
084900             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            08380000
085000                                      ASC-SEL-TERM-ID             08390000
085010                                      ASC-SEL-TERM-ID-2           08400000
085100             MOVE DP020-SRC-TASK-NUMBER                           08410000
085200                                   TO ASC-LIST-TASK-NUMBER        08420000
085300                                      ASC-SEL-TASK-NUMBER         08430000
085310                                      ASC-SEL-TASK-NUMBER-2       08440000
085400             MOVE PC-LIST-QUEUE-SEQ                               08450000
085500                                   TO ASC-LIST-SEQ                08460000
085600             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 08470000
085610                                      ASC-SEL-SEQ-2               08480000
085700             PERFORM 1100-PROCESS-INTER-APPL-COMM                 08490000
085800***-----$TEMPLATE NOTE$-------------------------------------------08500000
085900*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,08510000
086000*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  08520000
086100*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.08530000
086200***---------------------------------------------------------------08540000
086300             IF  PS-COMMAREA-NOT-VALID                            08550000
086400                 SET DP020-NEXT-ACT-APPL-ERROR                    08560000
086500                                   TO TRUE                        08570000
086600             ELSE                                                 08580000
086700                 PERFORM 4000-BUILD-INITIAL-PANEL                 08590000
086800             END-IF                                               08600000
086900                                                                  08610000
087000         WHEN DP020-NEXT-ACT-READ-MAP                             08620000
087100             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08630000
087200                                   TO PV-TOP-ITEM                 08640000
087300             PERFORM 2000-PROCESS-PANEL                           08650000
087400                                                                  08660000
087500         WHEN DP020-NEXT-ACT-RETURN                               08670000
087600             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08680000
087700                                   TO PV-TOP-ITEM                 08690000
087800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08700000
087900             PERFORM 2050-DELETE-LIST-QUEUE                       08710000
088000             PERFORM 4000-BUILD-INITIAL-PANEL                     08720000
088100                                                                  08730000
088200         WHEN OTHER                                               08740000
088300             SET DP013-LOGIC-ABEND TO TRUE                        08750000
088400             SET DP013-NO-ROLLBACK TO TRUE                        08760000
088500             MOVE '1000-CONTROL-PROCESSING'                       08770000
088600                                   TO DP013-PARAGRAPH             08780000
088700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08790000
088800                                   TO DP013-MESSAGE-TEXT(1)       08800000
088900             PERFORM DP013-0000-PROCESS-ABEND                     08810000
089000     END-EVALUATE.                                                08820000
089100                                                                  08830000
089200 EJECT                                                            08840000
089300*----------------------------------------------------------------*08850000
089400* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *08860000
089500* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *08870000
089600*----------------------------------------------------------------*08880000
089700                                                                  08890000
089800 1100-PROCESS-INTER-APPL-COMM.                                    08900000
089900                                                                  08910000
090000     SET PS-COMMAREA-VALID         TO TRUE.                       08920000
090100     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     08930000
090200                                                                  08940000
090300     IF CE002-NUMBER-OF-SELECTED-ITEMS > 0                        08950000
090400         MOVE CE002-CURR-OPER-UNT-ID-N                            08960000
090500                                      TO ASC-CURR-OPER-UNT-ID-N   08970000
090600         MOVE CE002-CURR-FCLTY-ID-N   TO ASC-CURR-FCLTY-ID-N      08980000
090700         MOVE CE002-CS-LOCATION       TO ASC-CS-LOC-N             08990000
090800         MOVE CE002-PULL-NBR          TO ASC-PULL-NBR-N           09000000
090900         MOVE CE002-REF-NBR           TO ASC-REF-NBR              09010000
091000         MOVE CE002-PULL-SELECT-STATUS                            09020000
091100                                      TO ASC-PULL-SELECT-STATUS   09030000
091200         MOVE CE002-PULL-SELECT-TYPE  TO ASC-PULL-SELECT-TYPE     09040000
091300         MOVE CE002-SELECT-LIST-SEQUENCE                          09050000
091400                                      TO ASC-SELECT-LIST-SEQUENCE 09060000
091500         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    09070000
091600         MOVE CE002-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  09080000
091700         MOVE CE002-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      09090000
091800         PERFORM 1120-PREPARE-LIST-ENTRY                          09100000
091900     ELSE                                                         09110000
092000         MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER           09120000
092100         SET  PS-COMMAREA-NOT-VALID TO TRUE                       09130000
092200     END-IF.                                                      09140000
092300                                                                  09150000
092400                                                                  09160000
092500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09170000
092600 1120-PREPARE-LIST-ENTRY.                                         09180000
092700                                                                  09190000
092800     MOVE CE003-MAX-ITEMS          TO ASC-SEL-SUB.                09200000
092900     MOVE ZERO                     TO ASC-SEL-ITEM.               09210000
093000     PERFORM 1130-GET-NEXT-RECORD.                                09220000
093100                                                                  09230000
093200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09240000
093300*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*09250000
093400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09260000
093500 1130-GET-NEXT-RECORD.                                            09270000
093600                                                                  09280000
093700     ADD +1                       TO ASC-SEL-SUB.                 09290000
093800                                                                  09300000
093900     IF  ASC-SEL-SUB > CE003-MAX-ITEMS                            09310000
094000         ADD +1                   TO ASC-SEL-ITEM                 09320000
094100         MOVE +1                  TO ASC-SEL-SUB                  09330000
094200     END-IF.                                                      09340000
094300                                                                  09350000
094400     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                09360000
094500         PERFORM 9100-READ-SEL-QUEUE                              09370000
094600         IF  CE003-ITEM (ASC-SEL-SUB) > ZERO                      09380000
094700             MOVE CE003-PULL-NUMBER (ASC-SEL-SUB)                 09390000
094800                                  TO PV-PULL-NUMBER               09400000
094900                                     ASC-PULL-NBR-N               09410000
095000             MOVE CE003-REF-NUMBER (ASC-SEL-SUB)                  09420000
095100                                  TO PV-REF-NUMBER                09430000
095200             MOVE CE003-LINE-NUMBER (ASC-SEL-SUB)                 09440000
095300                                  TO PV-LINE-NUMBER               09450000
095400                                     ASC-LINE-ITEM                09460000
095500             MOVE CE003-CS-LOCATION (ASC-SEL-SUB)                 09470000
095600                                  TO PV-CS-LOCATION               09480000
095700             MOVE CE003-CREATE-DATE (ASC-SEL-SUB)                 09490000
095800                                  TO PV-CREATE-DATE               09500000
095900             MOVE CE003-PULL-STATUS-CDE (ASC-SEL-SUB)             09510000
096000                                  TO PV-PULL-STATUS-CDE           09520000
096100                                     ASC-PULL-STATUS              09530000
096200             MOVE CE003-PULL-SOURCE-CDE (ASC-SEL-SUB)             09540000
096300                                  TO PV-PULL-SOURCE-CDE           09550000
096400                                     ASC-PULL-TYPE                09560000
096500             MOVE CE003-SELECT-LIST-SEQ (ASC-SEL-SUB)             09570000
096600                                  TO PV-SELECT-LIST-SEQ           09580000
096700             MOVE CE003-NBR-ITEMS (ASC-SEL-SUB)                   09590000
096800                                  TO PV-NBR-ITEMS                 09600000
096900             MOVE CE003-NBR-STORES (ASC-SEL-SUB)                  09610000
097000                                  TO PV-NBR-STORES                09620000
097100             MOVE CE003-REQ-PULL-UNITS (ASC-SEL-SUB)              09630000
097200                                  TO PV-REQ-PULL-UNITS            09640000
097300             MOVE CE003-ACT-PULL-UNITS (ASC-SEL-SUB)              09650000
097400                                  TO PV-ACT-PULL-UNITS            09660000
097500             MOVE CE003-DIST-PULL-UNITS (ASC-SEL-SUB)             09670000
097600                                  TO PV-DIST-PULL-UNITS           09680000
097700             MOVE CE003-LINE-STATUS-CDE (ASC-SEL-SUB)             09690000
097800                                  TO PV-LINE-STATUS-CDE           09700000
097900                                     ASC-LINE-STATUS-CDE          09710000
098000             MOVE CE003-LINE-SKU (ASC-SEL-SUB)                    09720000
098100                                  TO PV-LINE-SKU                  09730000
098200                                     ASC-SKU-NUMBER               09740000
098300             MOVE CE003-LINE-SKU-RETAIL (ASC-SEL-SUB)             09750000
098400                                  TO PV-LINE-SKU-RETAIL           09760000
098500                                     ASC-LINE-SKU-RETAIL          09770000
098600             MOVE CE003-LINE-ITEM (ASC-SEL-SUB)                   09780000
098700                                  TO PV-LINE-ITEM                 09790000
098800             SET CE003-INQ (ASC-SEL-SUB)                          09800000
098900                                  TO TRUE                         09810000
099000             PERFORM 9200-REWRITE-SEL-QUEUE                       09820000
099100         ELSE                                                     09830000
099200             SUBTRACT +1 FROM ASC-SEL-SUB                         09840000
099300             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             09850000
099400             SET DP020-MSG-INFORMATIONAL                          09860000
099500                 PS-LIST-END             TO TRUE                  09870000
099600         END-IF                                                   09880000
099700     ELSE                                                         09890000
099800         SUBTRACT +1 FROM ASC-SEL-ITEM                            09900000
099900         MOVE CE003-MAX-ITEMS     TO ASC-SEL-SUB                  09910000
100000         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             09920000
100100         SET DP020-MSG-INFORMATIONAL                              09930000
100200             PS-LIST-END             TO TRUE                      09940000
100300     END-IF.                                                      09950000
100400                                                                  09960000
100500/                                                                 09970000
100600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09980000
100700*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *09990000
100800*    PROCESSED.                                                  *10000000
100900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10010000
101000                                                                  10020000
101100 1140-GET-PREV-RECORD.                                            10030000
101200                                                                  10040000
101300     SUBTRACT +1 FROM ASC-SEL-SUB.                                10050000
101400                                                                  10060000
101500     IF  ASC-SEL-SUB < +1                                         10070000
101600         SUBTRACT +1 FROM ASC-SEL-ITEM                            10080000
101700         MOVE CE003-MAX-ITEMS     TO ASC-SEL-SUB                  10090000
101800     END-IF.                                                      10100000
101900                                                                  10110000
102000     IF  ASC-SEL-ITEM > ZERO                                      10120000
102100         PERFORM 9100-READ-SEL-QUEUE                              10130000
102200             MOVE CE003-PULL-NUMBER (ASC-SEL-SUB)                 10140000
102300                                  TO PV-PULL-NUMBER               10150000
102400                                     ASC-PULL-NBR-N               10160000
102500             MOVE CE003-REF-NUMBER (ASC-SEL-SUB)                  10170000
102600                                  TO PV-REF-NUMBER                10180000
102700             MOVE CE003-LINE-NUMBER (ASC-SEL-SUB)                 10190000
102800                                  TO PV-LINE-NUMBER               10200000
102900                                     ASC-LINE-ITEM                10210000
103000             MOVE CE003-CS-LOCATION (ASC-SEL-SUB)                 10220000
103100                                  TO PV-CS-LOCATION               10230000
103200             MOVE CE003-CREATE-DATE (ASC-SEL-SUB)                 10240000
103300                                  TO PV-CREATE-DATE               10250000
103400             MOVE CE003-PULL-STATUS-CDE (ASC-SEL-SUB)             10260000
103500                                  TO PV-PULL-STATUS-CDE           10270000
103510                                     ASC-PULL-STATUS              10280000
103520             MOVE CE003-PULL-SOURCE-CDE (ASC-SEL-SUB)             10290000
103530                                  TO PV-PULL-SOURCE-CDE           10300000
103540             MOVE CE003-SELECT-LIST-SEQ (ASC-SEL-SUB)             10310000
103550                                  TO PV-SELECT-LIST-SEQ           10320000
103560             MOVE CE003-NBR-ITEMS (ASC-SEL-SUB)                   10330000
103570                                  TO PV-NBR-ITEMS                 10340000
103580             MOVE CE003-NBR-STORES (ASC-SEL-SUB)                  10350000
103590                                  TO PV-NBR-STORES                10351000
103600             MOVE CE003-REQ-PULL-UNITS (ASC-SEL-SUB)              10352000
103700                                  TO PV-REQ-PULL-UNITS            10353000
103800             MOVE CE003-ACT-PULL-UNITS (ASC-SEL-SUB)              10354000
103900                                  TO PV-ACT-PULL-UNITS            10355000
104000             MOVE CE003-DIST-PULL-UNITS (ASC-SEL-SUB)             10356000
104100                                  TO PV-DIST-PULL-UNITS           10357000
104200             MOVE CE003-LINE-STATUS-CDE (ASC-SEL-SUB)             10358000
104300                                  TO PV-LINE-STATUS-CDE           10359000
104400             MOVE CE003-LINE-SKU (ASC-SEL-SUB)                    10360000
104500                                  TO PV-LINE-SKU                  10370000
104600             MOVE CE003-LINE-SKU-RETAIL (ASC-SEL-SUB)             10380000
104700                                  TO PV-LINE-SKU-RETAIL           10390000
104800             MOVE CE003-LINE-ITEM (ASC-SEL-SUB)                   10400000
104900                                  TO PV-LINE-ITEM                 10410000
105000         SET CE003-INQ (ASC-SEL-SUB)                              10420000
105100                                  TO TRUE                         10430000
105200         PERFORM 9200-REWRITE-SEL-QUEUE                           10440000
105300     ELSE                                                         10450000
105400         MOVE +1                  TO ASC-SEL-ITEM                 10460000
105500                                     ASC-SEL-SUB                  10470000
105600         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             10480000
105700         SET DP020-MSG-INFORMATIONAL                              10490000
105800             PS-LIST-END             TO TRUE                      10500000
105900     END-IF.                                                      10510000
106000                                                                  10520000
106100                                                                  10530000
106200                                                                  10540000
106300                                                                  10550000
106400*----------------------------------------------------------------*10560000
106500* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *10570000
106600* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *10580000
106700* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *10590000
106800* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *10600000
106900* FUNCTION KEYS CAN GET THIS FAR.                                *10610000
107000*----------------------------------------------------------------*10620000
107100                                                                  10630000
107200 2000-PROCESS-PANEL.                                              10640000
107300     EVALUATE TRUE                                                10650000
107400         WHEN DP020-SRC-AID = DP016-CLEAR                         10660000
107500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10670000
107600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10680000
107700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10690000
107800                                                                  10700000
107900         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10710000
108000             PERFORM 2050-DELETE-LIST-QUEUE                       10720000
108100             PERFORM 4000-BUILD-INITIAL-PANEL                     10730000
108200                                                                  10740000
108300         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    10750000
108400             PERFORM 2140-DESELECT-ALL-ITEMS                      10760000
108500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10770000
108600                                                                  10780000
108700         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  10790000
108800             PERFORM 2150-SELECT-ALL-ITEMS                        10800000
108900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10810000
109000                                                                  10820000
109100         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              10830000
109200             PERFORM 2150-SELECT-ALL-ITEMS                        10840000
109300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10850000
109400                                                                  10860000
109500         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             10870000
109600             IF  ASC-USE-SELECTION-QUEUE                          10880000
109700                 PERFORM 1130-GET-NEXT-RECORD                     10890000
109800                 IF PS-LIST-END                                   10900000
109900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10910000
110000                     SET PS-NO-LIST-END TO TRUE                   10920000
110100                 ELSE                                             10930000
110200                     PERFORM 2050-DELETE-LIST-QUEUE               10940000
110300                     PERFORM 3200-RESET-ATTRIBUTES                10950000
110400                     PERFORM 4000-BUILD-INITIAL-PANEL             10960000
110500                 END-IF                                           10970000
110600              ELSE                                                10980000
110700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10990000
110800*                --- BOTTOM OF LIST ---                           11000000
110900                 MOVE PC-TSYMSG-00070                             11010000
111000                                   TO DP020-MSG-NUMBER            11020000
111100                 SET DP020-MSG-INFORMATIONAL                      11030000
111200                                   TO TRUE                        11040000
111300             END-IF                                               11050000
111400                                                                  11060000
111500         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             11070000
111600             IF  ASC-USE-SELECTION-QUEUE                          11080000
111700                 PERFORM 1140-GET-PREV-RECORD                     11090000
111800                 IF PS-LIST-END                                   11100000
111900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11110000
112000                     SET PS-NO-LIST-END                           11120000
112100                                   TO TRUE                        11130000
112200                 ELSE                                             11140000
112300                     PERFORM 2050-DELETE-LIST-QUEUE               11150000
112400                     PERFORM 3200-RESET-ATTRIBUTES                11160000
112500                     PERFORM 4000-BUILD-INITIAL-PANEL             11170000
112600                 END-IF                                           11180000
112700             ELSE                                                 11190000
112800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11200000
112900                 MOVE PC-TSYMSG-00069                             11210000
113000                                   TO DP020-MSG-NUMBER            11220000
113100                 SET DP020-MSG-INFORMATIONAL                      11230000
113200                                   TO TRUE                        11240000
113300             END-IF                                               11250000
113400                                                                  11260000
113500         WHEN OTHER                                               11270000
113600             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11280000
113700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11290000
113800                                                                  11300000
113900             IF  PS-NO-ERROR                                      11310000
114000                 SET DP030-CONTINUE-GO                            11320000
114100                                 TO TRUE                          11330000
114200                 PERFORM 2100-CHECK-FUNCTION-KEY                  11340000
114300             ELSE                                                 11350000
114400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11360000
114500                 SET DP030-OVERRIDE-GO                            11370000
114600                                 TO TRUE                          11380000
114700             END-IF                                               11390000
114800     END-EVALUATE.                                                11400000
114900 EJECT                                                            11410000
115000*----------------------------------------------------------------*11420000
115100*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *11430000
115200*----------------------------------------------------------------*11440000
115300 2050-DELETE-LIST-QUEUE.                                          11450000
115400                                                                  11460000
115500     EXEC CICS                                                    11470000
115600         DELETEQ TS                                               11480000
115700             QUEUE (ASC-LIST-QUEUE-NAME)                          11490000
115800             RESP  (PV-CICS-RESP)                                 11500000
115900     END-EXEC.                                                    11510000
116000                                                                  11520000
116100     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       11530000
116200        (PV-CICS-RESP = DFHRESP(QIDERR))                          11540000
116300         CONTINUE                                                 11550000
116400     ELSE                                                         11560000
116500         SET DP013-CICS-ABEND      TO TRUE                        11570000
116600         SET DP013-NO-ROLLBACK     TO TRUE                        11580000
116700                                                                  11590000
116800         MOVE '2050-DELETE-LIST-QUEUE'                            11600000
116900                                   TO DP013-PARAGRAPH             11610000
117000         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    11620000
117100                                   TO DP013-MESSAGE-TEXT (1)      11630000
117200         PERFORM DP013-0000-PROCESS-ABEND                         11640000
117300     END-IF.                                                      11650000
117400                                                                  11660000
117500     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  11670000
117600 EJECT                                                            11680000
117700*----------------------------------------------------------------*11690000
117800* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*11700000
117900* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *11710000
118000* CICS ARCHITECTURE API.                                         *11720000
118100*----------------------------------------------------------------*11730000
118200 2100-CHECK-FUNCTION-KEY.                                         11740000
118300                                                                  11750000
118400     EVALUATE TRUE                                                11760000
118500*                                                                 11770000
118600* F13 - ADD STORE  (LOCAL-FUNC-01)                                11780000
118700*                                                                 11790000
118800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              11800000
118900              INITIALIZE CE002-INTER-APPL-COMMAREA                11810000
119000              MOVE PC-ONE                                         11820000
119100                                TO CE002-NUMBER-OF-SELECTED-ITEMS 11830000
119200              MOVE ASC-CURR-OPER-UNT-ID-N                         11840000
119300                                    TO CE002-CURR-OPER-UNT-ID-N   11850000
119400              MOVE ASC-CURR-FCLTY-ID-N                            11860000
119500                                    TO CE002-CURR-FCLTY-ID-N      11870000
119600              MOVE ASC-CS-LOC-N     TO CE002-CS-LOCATION          11880000
119700              MOVE ASC-PULL-NBR-N   TO CE002-PULL-NBR             11890000
119800              MOVE ASC-REF-NBR      TO CE002-REF-NBR              11900000
119900              MOVE ASC-PULL-SELECT-STATUS                         11910000
120000                                    TO CE002-PULL-SELECT-STATUS   11920000
120100              MOVE ASC-PULL-SELECT-TYPE                           11930000
120200                                    TO CE002-PULL-SELECT-TYPE     11940000
120300              MOVE ASC-SELECT-LIST-SEQUENCE                       11950000
120400                                    TO CE002-SELECT-LIST-SEQUENCE 11960000
                    MOVE ASC-PULL-TYPE TO CE002-CURR-PULL-TYPE          11961004
120500              PERFORM 5000-PREPARE-SEL-QUEUE-1                    11970000
120600                                                                  11980000
120700*                                                                 11990000
120800* F15 - UPDATE ACTUAL UNITS  (LOCAL-FUNC-02)                      12000000
120900*                                                                 12010000
121000         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              12020000
121100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              12030000
121200                 PERFORM 4700-PROCESS-UPDATE-FUNCTION             12040000
121300                     VARYING PV-ITEM  FROM 1 BY 1                 12050000
121400                     UNTIL PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN   12060000
121500                        OR PS-SOFT-ABORT-ERROR                    12070000
121600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12080000
121700             ELSE                                                 12090000
121800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12100000
121900                 SET DP030-OVERRIDE-GO                            12110000
122000                                   TO TRUE                        12120000
122100                 MOVE PC-TSYMSG-00057                             12130000
122200                                   TO DP020-MSG-NUMBER            12140000
122300                 SET DP020-MSG-WARNING                            12150000
122400                                   TO TRUE                        12160000
122500             END-IF                                               12170000
122600*LMM                                                              12180000
122700*                                                                 12190000
122800*F16=ADJMNFST (CEKCS616 - 'CEUSTADJ') (LOCAL-FUNC-04)             12200000
122900         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              12210000
123000              INITIALIZE CE002-INTER-APPL-COMMAREA                12220000
123100              MOVE PC-ONE TO CE002-NUMBER-OF-SELECTED-ITEMS       12230000
123200              MOVE ASC-CURR-OPER-UNT-ID-N                         12240000
123300                                    TO CE002-CURR-OPER-UNT-ID-N   12250000
123400              MOVE ASC-CURR-FCLTY-ID-N                            12260000
123500                                    TO CE002-CURR-FCLTY-ID-N      12270000
123600              MOVE ASC-CS-LOC-N     TO CE002-CS-LOCATION          12280000
123700              MOVE ASC-PULL-NBR-N   TO CE002-PULL-NBR             12290000
123800              MOVE ASC-REF-NBR      TO CE002-REF-NBR              12300000
123900              MOVE ASC-LINE-ITEM    TO CE002-LNE-NBR              12310000
124100              MOVE ASC-SKU-NUMBER   TO CE002-SKU-NBR              12320000
124200              MOVE ASC-LINE-SKU-RETAIL                            12330000
124300                                    TO CE002-SKU-RETAIL           12340000
124400              MOVE ASC-TOT-DISTRB-UNTS                            12350000
124500                                    TO CE002-DISTRB-UNITS         12360000
124600              MOVE ASC-TOT-MANIFEST-UNTS                          12370000
124700                                    TO CE002-MANIFEST-UNITS       12380000
124800              MOVE ASC-TOT-ADJUST-UNTS                            12390000
124900                                    TO CE002-ADJUSTED-UNITS       12400000
125000              PERFORM 5000-PREPARE-SEL-QUEUE                      12410000
125100                                                                  12420000
125200*                                                                 12430000
125300*F22=ADJ LIST (CEKCS614 - 'CELSTADJ') (LOCAL-FUNC-05)             12440000
125400         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              12450000
125500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              12460000
125600                 INITIALIZE CE002-INTER-APPL-COMMAREA             12470000
125700                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                12480000
125800                           TO CE002-NUMBER-OF-SELECTED-ITEMS      12490000
125900                 MOVE ASC-CURR-OPER-UNT-ID-N                      12500000
126000                           TO CE002-CURR-OPER-UNT-ID-N            12510000
126100                 MOVE ASC-CURR-FCLTY-ID-N                         12520000
126200                           TO CE002-CURR-FCLTY-ID-N               12530000
126300                 MOVE ASC-CS-LOC-N     TO CE002-CS-LOCATION       12540000
126400                 MOVE ASC-PULL-NBR-N   TO CE002-PULL-NBR          12550000
126500                 MOVE ASC-LINE-ITEM    TO CE002-LNE-NBR           12560000
126600                 MOVE ASC-SKU-NUMBER   TO CE002-SKU-NBR           12570000
126700                 MOVE ASC-LINE-SKU-RETAIL                         12580000
126800                                       TO CE002-SKU-RETAIL        12590000
126900                 MOVE ASC-TOT-MANIFEST-UNTS                       12600000
127000                                       TO CE002-MANIFEST-UNITS    12610000
127100                 MOVE ASC-TOT-ADJUST-UNTS                         12620000
127200                                       TO CE002-ADJUSTED-UNITS    12630000
127300                 MOVE ASC-TOT-DISTRB-UNTS                         12640000
127400                                       TO CE002-DISTRB-UNITS      12650000
127500                 PERFORM 5000-PREPARE-SEL-QUEUE                   12660000
127600             ELSE                                                 12670000
127700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12680000
127800                 SET DP030-OVERRIDE-GO                            12690000
127900                                   TO TRUE                        12700000
128000                 MOVE PC-TSYMSG-00057                             12710000
128100                                   TO DP020-MSG-NUMBER            12720000
128200                 SET DP020-MSG-WARNING                            12730000
128300                                   TO TRUE                        12740000
128400             END-IF                                               12750000
128500                                                                  12760000
128600*                                                                 12770000
128700*F23=MNFSTLST (CEKCS613 - 'CELSMFST') (LOCAL-FUNC-06)             12780000
128800         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              12790000
128900              INITIALIZE CE002-INTER-APPL-COMMAREA                12800000
129000              MOVE PC-ONE TO CE002-NUMBER-OF-SELECTED-ITEMS       12810000
129100              MOVE ASC-CURR-OPER-UNT-ID-N                         12820000
129200                                    TO CE002-CURR-OPER-UNT-ID-N   12830000
129300              MOVE ASC-CURR-FCLTY-ID-N                            12840000
129400                                    TO CE002-CURR-FCLTY-ID-N      12850000
129500              MOVE ASC-CS-LOC-N     TO CE002-CS-LOCATION          12860000
129600              MOVE ASC-PULL-NBR-N   TO CE002-PULL-NBR             12870000
129700              MOVE ASC-REF-NBR      TO CE002-REF-NBR              12880000
129800              MOVE ASC-LINE-ITEM    TO CE002-LNE-NBR              12890000
129900              MOVE ASC-SKU-NUMBER   TO CE002-SKU-NBR              12900000
130000              MOVE ASC-LINE-SKU-RETAIL                            12910000
130100                                    TO CE002-SKU-RETAIL           12920000
130200              MOVE ASC-TOT-DISTRB-UNTS                            12930000
130300                                    TO CE002-DISTRB-UNITS         12940000
130400              MOVE ASC-TOT-MANIFEST-UNTS                          12950000
130500                                    TO CE002-MANIFEST-UNITS       12960000
130600              MOVE ASC-TOT-ADJUST-UNTS                            12970000
130700                                    TO CE002-ADJUSTED-UNITS       12980000
130800                                                                  12990000
130900              PERFORM 5000-PREPARE-SEL-QUEUE                      13000000
131000*                                                                 13010000
131100*                                                                 13020000
131200* F6 - FIRST PAGE                                                 13030000
131300*                                                                 13040000
131400         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  13050000
131500             MOVE +1               TO PV-TOP-ITEM                 13060000
131600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13070000
131700*                                                                 13080000
131800* F7 - PREVIOUS PAGE                                              13090000
131900*                                                                 13100000
132000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   13110000
132100             PERFORM 3200-RESET-ATTRIBUTES                        13120000
132200             PERFORM 2110-BROWSE-BACKWARD                         13130000
132300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13140000
132400*                                                                 13150000
132500* F8 - NEXT PAGE                                                  13160000
132600*                                                                 13170000
132700         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   13180000
132800             PERFORM 3200-RESET-ATTRIBUTES                        13190000
132900             PERFORM 2120-BROWSE-FORWARD                          13200000
133000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13210000
133100*                                                                 13220000
133200* ENTER KEY                                                       13230000
133300*                                                                 13240000
133400         WHEN DP020-SRC-AID = DP016-ENTER                         13250000
133500             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   13260000
133600             IF  PS-ERROR                                         13270000
133700                 CONTINUE                                         13280000
133800             ELSE                                                 13290000
133900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13300000
134000             END-IF                                               13310000
134100                                                                  13320000
134200         WHEN OTHER                                               13330000
134300             SET DP013-NO-ROLLBACK                                13340000
134400                 DP013-XCTL-DISPLAY-RESTART                       13350000
134500                 DP013-CICS-ABEND  TO TRUE                        13360000
134600             MOVE '2100-CHECK-FUNCTION-KEY'                       13370000
134700                                   TO DP013-PARAGRAPH             13380000
134800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      13390000
134900                                   TO DP013-MESSAGE-TEXT (1)      13400000
135000             PERFORM DP013-0000-PROCESS-ABEND                     13410000
135100     END-EVALUATE.                                                13420000
135200                                                                  13430000
135300                                                                  13440000
135400*----------------------------------------------------------------*13450000
135500* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     13460000
135600*----------------------------------------------------------------*13470000
135700 2105-RACF-ACCESS.                                                13480000
135800                                                                  13490000
135900      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  13500000
136000      SET DP008-ACCESS-TYPE-USE          TO TRUE                  13510000
136100                                                                  13520000
136200      EXEC CICS                                                   13530000
136300         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 13540000
136400              COMMAREA (DP008-SECURITY-COMMAREA)                  13550000
136500              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             13560000
136600      END-EXEC                                                    13570000
136700                                                                  13580000
136800      IF DP008-CALL-SUCCESSFUL                                    13590000
136900         IF DP008-ACCESS-ALLOWED                                  13600000
137000             SET PS-ACCESS-ALLOWED TO TRUE                        13610000
137100         ELSE                                                     13620000
137200             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    13630000
137300         END-IF                                                   13640000
137400     ELSE                                                         13650000
137500         MOVE '2105-RACF-ACCESS'                                  13660000
137600                               TO DP013-PARAGRAPH                 13670000
137700          MOVE 'UNABLE TO ACCESS CICS'                            13680000
137800                               TO DP013-MESSAGE-TEXT (1)          13690000
137900          MOVE SQLCA                 TO DP013-SQLCA               13700000
138000          SET DP013-DB2-ABEND                                     13710000
138100              DP013-XCTL-DISPLAY-RESTART                          13720000
138200                               TO TRUE                            13730000
138300          PERFORM DP013-0000-PROCESS-ABEND                        13740000
138400      END-IF.                                                     13750000
138600                                                                  13770000
138700                                                                  13780006
138800*----------------------------------------------------------------*13790000
138900*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *13800000
139000*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *13810000
139100*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *13820000
139200*    MESSAGE.                                                    *13830000
139300*----------------------------------------------------------------*13840000
139400                                                                  13850000
139500 2110-BROWSE-BACKWARD.                                            13860000
139600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    13870000
139700         GIVING PV-TOP-ITEM.                                      13880000
139800*                                                                 13890000
139900     IF  ((PV-TOP-ITEM < +1)                                      13900000
140000       OR (PV-TOP-ITEM = +1))                                     13910000
140100         MOVE +1                   TO PV-TOP-ITEM                 13920000
140200*        -- TOP OF LIST --                                        13930000
140300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            13940000
140400         SET DP020-MSG-INFORMATIONAL TO TRUE                      13950000
140500     END-IF.                                                      13960000
140600                                                                  13970000
140700 EJECT                                                            13980000
140800*----------------------------------------------------------------*13990000
140900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *14000000
141000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *14010000
141100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *14020000
141200*----------------------------------------------------------------*14030000
141300                                                                  14040000
141400 2120-BROWSE-FORWARD.                                             14050000
141500                                                                  14060000
141600     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              14070000
141700         GIVING PV-TOP-ITEM.                                      14080000
141800     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   14090000
141900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14100000
142000                                   TO PV-TOP-ITEM                 14110000
142100*        -- BOTTOM OF LIST --                                     14120000
142200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14130000
142300         SET DP020-MSG-INFORMATIONAL                              14140000
142400                                   TO TRUE                        14150000
142500     ELSE                                                         14160000
142600         COMPUTE PV-BOTTOM-ITEM =                                 14170000
142700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 14180000
142800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            14190000
142900*            -- BOTTOM OF LIST --                                 14200000
143000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14210000
143100             SET DP020-MSG-INFORMATIONAL                          14220000
143200                                   TO TRUE                        14230000
143300         END-IF                                                   14240000
143400     END-IF.                                                      14250000
143500 EJECT                                                            14260000
143600*----------------------------------------------------------------*14270000
143700*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *14280000
143800*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *14290000
143900*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *14300000
144000*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *14310000
144100*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *14320000
144200*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *14330000
144300*----------------------------------------------------------------*14340000
144400                                                                  14350000
144500 2130-CHECK-FOR-JUMP-BROWSE.                                      14360000
144600     SET PS-NO-ERROR               TO TRUE.                       14370000
144700     IF (ASC-START-ITEM-REQUEST = SPACE)                          14380000
144800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14390000
144900                                   TO PV-TOP-ITEM                 14400000
145000     ELSE                                                         14410000
145100         MOVE ASC-START-ITEM-REQUEST                              14420000
145200                                   TO DP010I-UNEDITED-FIELD       14430000
145300         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       14440000
145400         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     14450000
145500         SET DP010I-NEGATIVE-NOT-ALLOWED                          14460000
145600                                   TO TRUE                        14470000
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14481008
263455              USING DP010I-NUMERIC-EDIT-AREA                      14482008
145800                                                                  14490000
145900         IF  NOT DP010I-ERROR-DETECTED                            14500000
146000             MOVE DP010I-NUMERIC-FIELD                            14510000
146100                                   TO  ASC-START-ITEM-REQUEST-N   14520000
146200             IF  ASC-START-ITEM-REQUEST-N > ZERO                  14530000
146300                 IF  ASC-START-ITEM-REQUEST-N >                   14540000
146400                                          ASC-NUMBER-OF-ITEMS-READ14550000
146500                     MOVE SPACE TO ASC-START-ITEM-REQUEST         14560000
146600                     COMPUTE PV-TOP-ITEM =                        14570000
146700                             ASC-NUMBER-OF-ITEMS-READ             14580000
146800                             - PC-ITEMS-PER-PANEL + 1             14590000
146900                     IF  PV-TOP-ITEM < +1                         14600000
147000                         MOVE +1   TO PV-TOP-ITEM                 14610000
147100                         MOVE PC-TSYMSG-00070                     14620000
147200                                   TO DP020-MSG-NUMBER            14630000
147300                         SET DP020-MSG-INFORMATIONAL              14640000
147400                                   TO TRUE                        14650000
147500                     END-IF                                       14660000
147600                 ELSE                                             14670000
147700                     MOVE ASC-START-ITEM-REQUEST-N                14680000
147800                                   TO PV-TOP-ITEM                 14690000
147900                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      14700000
148000                     COMPUTE PV-BOTTOM-ITEM =                     14710000
148100                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     14720000
148200                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ14730000
148300*                        -- BOTTOM OF LIST --                     14740000
148400                         MOVE PC-TSYMSG-00070                     14750000
148500                                   TO DP020-MSG-NUMBER            14760000
148600                         SET DP020-MSG-INFORMATIONAL              14770000
148700                                   TO TRUE                        14780000
148800                     END-IF                                       14790000
148900                 END-IF                                           14800000
149000             ELSE                                                 14810000
149100*                --- VALUE OUT OF RANGE ----                      14820000
149200                 MOVE PC-TSYMSG-00101                             14830000
149300                                   TO DP020-MSG-NUMBER            14840000
149400                 MOVE -1           TO ASTRTITL                    14850000
149500                 SET DP030-SET-CURSOR-APPL-1                      14860000
149600                                   TO TRUE                        14870000
149700                 MOVE DP015-REVERSE                               14880000
149800                                   TO ASTRTITH                    14890000
149900                 MOVE DP015-RED    TO ASTRTITC                    14900000
150000                 MOVE DP015-UNP-NUM-BRT-MDT                       14910000
150100                                   TO ASTRTITA                    14920000
150200                 SET DP020-MSG-FATAL                              14930000
150300                                   TO TRUE                        14940000
150400                 SET PS-ERROR      TO TRUE                        14950000
150500             END-IF                                               14960000
150600                                                                  14970000
150700         ELSE                                                     14980000
150800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            14990000
150900             MOVE -1               TO ASTRTITL                    15000000
151000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15010000
151100             MOVE DP015-REVERSE    TO ASTRTITH                    15020000
151200             MOVE DP015-RED        TO ASTRTITC                    15030000
151300             MOVE DP015-UNP-NUM-BRT-MDT                           15040000
151400                                   TO ASTRTITA                    15050000
151500             SET DP020-MSG-FATAL   TO TRUE                        15060000
151600             SET PS-ERROR          TO TRUE                        15070000
151700         END-IF                                                   15080000
151800     END-IF.                                                      15090000
151900 EJECT                                                            15100000
152000*----------------------------------------------------------------*15110000
152100*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *15120000
152200*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *15130000
152300*----------------------------------------------------------------*15140000
152400 2140-DESELECT-ALL-ITEMS.                                         15150000
152500     MOVE +1                       TO ASC-BLK-SUB.                15160000
152600                                                                  15170000
152700     PERFORM 2141-CLEAR-SELECTED-INDS                             15180000
152800         VARYING ASC-ITEM-SUB                                     15190000
152900         FROM 1 BY 1                                              15200000
153000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15210000
153100                                                                  15220000
153200     ADD +1                        TO ASC-BLK-SUB.                15230000
153300                                                                  15240000
153400     PERFORM 2141-CLEAR-SELECTED-INDS                             15250000
153500         VARYING ASC-ITEM-SUB                                     15260000
153600         FROM 1 BY 1                                              15270000
153700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15280000
153800                                                                  15290000
153900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15300000
154000                                   TO PV-LIST-ITEM-NUMBER.        15310000
154100                                                                  15320000
154200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15330000
154300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    15340000
154400                                                                  15350000
154500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15360000
154600        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      15370000
154700         MOVE +1                   TO ASC-BLK-SUB                 15380000
154800                                                                  15390000
154900         PERFORM 5100-WRITE-TEMP-STORAGE                          15400000
155000                                                                  15410000
155100         MOVE +1                   TO PV-BLOCK-NUMBER             15420000
155200                                                                  15430000
155300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15440000
155400             PV-FIRST-BLOCK-IN-ARRAY - 1                          15450000
155500                                                                  15460000
155600         PERFORM                                                  15470000
155700             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15480000
155800                                                                  15490000
155900             PERFORM 4410-READ-TEMP-STORAGE                       15500000
156000                                                                  15510000
156100             PERFORM 2141-CLEAR-SELECTED-INDS                     15520000
156200                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 15530000
156300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15540000
156400                                                                  15550000
156500             PERFORM 5100-WRITE-TEMP-STORAGE                      15560000
156600                                                                  15570000
156700             ADD +1                TO PV-BLOCK-NUMBER             15580000
156800                                                                  15590000
156900         END-PERFORM                                              15600000
157000                                                                  15610000
157100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15620000
157200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15630000
157300                                                                  15640000
157400         PERFORM                                                  15650000
157500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15660000
157600                   ASC-HIGHEST-BLOCK-WRITTEN                      15670000
157700                                                                  15680000
157800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15690000
157900                                   TO PV-BLOCK-NUMBER             15700000
158000                                                                  15710000
158100             PERFORM 4410-READ-TEMP-STORAGE                       15720000
158200                                                                  15730000
158300             PERFORM 2141-CLEAR-SELECTED-INDS                     15740000
158400                 VARYING ASC-ITEM-SUB                             15750000
158500                 FROM 1 BY 1                                      15760000
158600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15770000
158700                                                                  15780000
158800             PERFORM 5100-WRITE-TEMP-STORAGE                      15790000
158900                                                                  15800000
159000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15810000
159100                                                                  15820000
159200         END-PERFORM                                              15830000
159300                                                                  15840000
159400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15850000
159500                                   TO PV-BLOCK-NUMBER             15860000
159600                                                                  15870000
159700         PERFORM 4410-READ-TEMP-STORAGE                           15880000
159800     END-IF.                                                      15890000
159900                                                                  15900000
160000                                                                  15910000
160100     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 15920000
160200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.15930000
160300     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  15940000
160400                                                                  15950000
160500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15960000
160600                                                                  15970000
160700 EJECT                                                            15980000
160800*----------------------------------------------------------------*15990000
160900*    MARK EACH ITEM AS BEING NOT SELECTED.                       *16000000
161000*----------------------------------------------------------------*16010000
161100                                                                  16020000
161200 2141-CLEAR-SELECTED-INDS.                                        16030000
161300                                                                  16040000
161400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           16050000
161500             NOT EQUAL ZERO                                       16060000
161600         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16070000
161700             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16080000
161800                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    16090000
161900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16100000
162000                                   TO TRUE                        16110000
162100         END-IF                                                   16120000
162200     END-IF.                                                      16130000
162300                                                                  16140000
162400 EJECT                                                            16150000
162500*----------------------------------------------------------------*16160000
162600*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *16170000
162700*  FOR ALL ITEMS.                                                *16180000
162800*----------------------------------------------------------------*16190000
162900                                                                  16200000
163000 2150-SELECT-ALL-ITEMS.                                           16210000
163100                                                                  16220000
163200     MOVE +1                       TO ASC-BLK-SUB.                16230000
163300                                                                  16240000
163400     PERFORM 2151-SET-SELECTED-INDS                               16250000
163500         VARYING ASC-ITEM-SUB                                     16260000
163600         FROM 1 BY 1                                              16270000
163700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16280000
163800                                                                  16290000
163900     ADD +1                        TO ASC-BLK-SUB.                16300000
164000                                                                  16310000
164100     PERFORM 2151-SET-SELECTED-INDS                               16320000
164200         VARYING ASC-ITEM-SUB                                     16330000
164300         FROM 1 BY 1                                              16340000
164400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16350000
164500                                                                  16360000
164600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16370000
164700                                   TO PV-LIST-ITEM-NUMBER.        16380000
164800                                                                  16390000
164900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16400000
165000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16410000
165100                                                                  16420000
165200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16430000
165300        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    16440000
165400         MOVE +1                   TO ASC-BLK-SUB                 16450000
165500                                                                  16460000
165600         PERFORM 5100-WRITE-TEMP-STORAGE                          16470000
165700                                                                  16480000
165800         MOVE +1                   TO PV-BLOCK-NUMBER             16490000
165900                                                                  16500000
166000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16510000
166100             PV-FIRST-BLOCK-IN-ARRAY - 1                          16520000
166200                                                                  16530000
166300         PERFORM                                                  16540000
166400             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16550000
166500                                                                  16560000
166600             PERFORM 4410-READ-TEMP-STORAGE                       16570000
166700                                                                  16580000
166800             PERFORM 2151-SET-SELECTED-INDS                       16590000
166900                 VARYING ASC-ITEM-SUB                             16600000
167000                 FROM 1 BY 1                                      16610000
167100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16620000
167200                                                                  16630000
167300             PERFORM 5100-WRITE-TEMP-STORAGE                      16640000
167400                                                                  16650000
167500             ADD +1                TO PV-BLOCK-NUMBER             16660000
167600                                                                  16670000
167700         END-PERFORM                                              16680000
167800                                                                  16690000
167900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16700000
168000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16710000
168100                                                                  16720000
168200         PERFORM                                                  16730000
168300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16740000
168400                   ASC-HIGHEST-BLOCK-WRITTEN                      16750000
168500                                                                  16760000
168600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16770000
168700                                   TO PV-BLOCK-NUMBER             16780000
168800                                                                  16790000
168900             PERFORM 4410-READ-TEMP-STORAGE                       16800000
169000                                                                  16810000
169100             PERFORM 2151-SET-SELECTED-INDS                       16820000
169200                 VARYING ASC-ITEM-SUB                             16830000
169300                 FROM 1 BY 1                                      16840000
169400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16850000
169500                                                                  16860000
169600             PERFORM 5100-WRITE-TEMP-STORAGE                      16870000
169700                                                                  16880000
169800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16890000
169900                                                                  16900000
170000         END-PERFORM                                              16910000
170100                                                                  16920000
170200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16930000
170300                                   TO PV-BLOCK-NUMBER             16940000
170400                                                                  16950000
170500         PERFORM 4410-READ-TEMP-STORAGE                           16960000
170600     END-IF.                                                      16970000
170700                                                                  16980000
170800                                                                  16990000
170900     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             17000000
171000                       ASC-NUMBER-OF-SELECTED-ITEMS.              17010000
171100                                                                  17020000
171200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17030000
171300                                                                  17040000
171400 EJECT                                                            17050000
171500*----------------------------------------------------------------*17060000
171600*    MARK EACH ITEM AS BEING SELECTED.                           *17070000
171700*----------------------------------------------------------------*17080000
171800                                                                  17090000
171900 2151-SET-SELECTED-INDS.                                          17100000
172000                                                                  17110000
172100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO17120000
172200         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             17130000
172300             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             17140000
172400                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        17150000
172500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  17160000
172600                               TO  TRUE                           17170000
172700         END-IF                                                   17180000
172800         IF   DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              17190000
172900              MOVE  ZEROES TO ASC-UPD-UNITS                       17200000
173000                              (ASC-BLK-SUB ASC-ITEM-SUB)          17210000
173100              SET  ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB)    17220000
173200                           TO  TRUE                               17230000
173300         END-IF                                                   17240000
173400     END-IF.                                                      17250000
173500******************************************************************17260000
173600** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **17270000
173700** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **17280000
173800******************************************************************17290000
173900 2200-MOVE-SCREEN-TO-COMMAREA.                                    17300000
174000                                                                  17310000
174100     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             17320000
174200     MOVE +1                       TO PV-SUB.                     17330000
174300*                                                                 17340000
174400     PERFORM 3100-SET-SUBSCRIPTS.                                 17350000
174500     IF  ASTRTITL > ZERO                                          17360000
174600         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          17370000
174700     ELSE                                                         17380000
174800         IF  ASTRTITF = DP015-ERASE-EOF                           17390000
174900             INITIALIZE ASC-START-ITEM-REQUEST                    17400000
175000         END-IF                                                   17410000
175100     END-IF.                                                      17420000
175200                                                                  17430000
175300     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          17440000
175400         VARYING PV-SUB                                           17450000
175500         FROM 1 BY 1                                              17460000
175600         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      17470000
175700******************************************************************17480000
175800** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**17490000
175900******************************************************************17500000
176000 2210-MOVE-LINES-TO-COMMAREA.                                     17510000
176100     IF  MR-SELECTL (PV-SUB) > ZERO                               17520000
176200         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             17530000
176300         MOVE MR-SELECTI (PV-SUB)                                 17540000
176400                                   TO ASC-TEMP-SELECTED-SW        17550000
176500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17560000
176600     ELSE                                                         17570000
176700         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                17580000
176800                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     17590000
176900                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        17600000
177000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17610000
177100         END-IF                                                   17620000
177200     END-IF.                                                      17630000
177300                                                                  17640000
177400*                                                                 17650000
177500*** UPDATE UNITS                                                  17660000
177600*                                                                 17670000
177700     IF  MR-UPD-UNITSL (PV-SUB) > ZERO                            17680000
177800         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             17690000
177900         MOVE MR-UPD-UNITS (PV-SUB) TO ASC-UPD-UNITS-X            17700000
178000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17710000
178100         MOVE ASC-UPD-UNITS-X (ASC-BLK-SUB ASC-ITEM-SUB) TO       17720000
178200                                    DP010I-UNEDITED-FIELD         17730000
178300         MOVE LENGTH OF ASC-UPD-UNITS                             17740000
178400                                 TO DP010I-MAXIMUM-DIGITS         17750000
178500         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       17760000
178600         SET DP010I-NEGATIVE-NOT-ALLOWED                          17770000
178700                                 TO TRUE                          17780000
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17791008
263455              USING DP010I-NUMERIC-EDIT-AREA                      17792008
178900             IF  DP010I-ERROR-DETECTED                            17800000
179000                 CONTINUE                                         17810000
179100             ELSE                                                 17820000
179200                 MOVE DP010I-NUMERIC-FIELD                        17830000
179300                   TO ASC-UPD-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)    17840000
179400             END-IF                                               17850000
179500     ELSE                                                         17860000
179600         IF  MR-UPD-UNITSA (PV-SUB) = DP015-ERASE-EOF             17870000
179700             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         17880000
179800             MOVE ZEROES       TO ASC-UPD-UNITS                   17890000
179900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17900000
180000         END-IF                                                   17910000
180100     END-IF.                                                      17920000
180200                                                                  17930000
180300     ADD +1                        TO ASC-ITEM-SUB.               17940000
180400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        17950000
180500         ADD +1                    TO ASC-BLK-SUB                 17960000
180600         MOVE +1                   TO ASC-ITEM-SUB                17970000
180700     END-IF.                                                      17980000
180800******************************************************************17990000
180900** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **18000000
181000** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **18010000
181100******************************************************************18020000
181200 3000-EDIT-DATA-IN-COMMAREA.                                      18030000
181300     SET PS-NO-ERROR               TO TRUE.                       18040000
181400     PERFORM 3200-RESET-ATTRIBUTES.                               18050000
181500     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     18060000
181600                                                                  18070000
181700**                                                                18080000
181800* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              18090000
181900* EDITTING IS DONE FROM THE BOTTOM UP.                            18100000
182000**                                                                18110000
182100     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       18120000
182200         ASC-ITEMS-DISPLAYED - 1.                                 18130000
182300     PERFORM 3100-SET-SUBSCRIPTS.                                 18140000
182400     PERFORM 3300-EDIT-SELECTIONS                                 18150000
182500         VARYING PV-SUB                                           18160000
182600         FROM PV-SUB BY -1                                        18170000
182700         UNTIL PV-SUB < +1                                        18180000
182800*                                                                 18190000
182900     IF  PS-NO-ERROR                                              18200000
183000         PERFORM 3400-CHECK-RANGE-SEQUENCE                        18210000
183100     END-IF.                                                      18220000
183200*                                                                 18230000
183300     IF  ((PS-NO-ERROR)                                           18240000
183400       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   18250000
183500       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    18260000
183600             PERFORM 3500-MARK-RANGE-AS-SELECTED                  18270000
183700     END-IF.                                                      18280000
183800                                                                  18290000
183900                                                                  18300000
184000*----------------------------------------------------------------*18310000
184100*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *18320000
184200*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*18330000
184300*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *18340000
184400*                                                                *18350000
184500*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *18360000
184600*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *18370000
184700*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *18380000
184800*    US IN THE 2ND BLOCK OF THE ARRAY.                           *18390000
184900*----------------------------------------------------------------*18400000
185000                                                                  18410000
185100 3100-SET-SUBSCRIPTS.                                             18420000
185200                                                                  18430000
185300     COMPUTE ASC-ITEM-SUB =                                       18440000
185400         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        18450000
185500                                                                  18460000
185600     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         18470000
185700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            18480000
185800                                                                  18490000
185900         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               18500000
186000     ELSE                                                         18510000
186100         MOVE +1                     TO ASC-BLK-SUB               18520000
186200     END-IF.                                                      18530000
186300******************************************************************18540000
186400** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **18550000
186500******************************************************************18560000
186600                                                                  18570000
186700 3200-RESET-ATTRIBUTES.                                           18580000
186800     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   18590000
186900     MOVE DP015-GREEN              TO ASTRTITC.                   18600000
187000     MOVE DP015-UNDERLINE          TO ASTRTITH.                   18610000
187100*                                                                 18620000
187200     PERFORM                                                      18630000
187300         VARYING PV-SUB                                           18640000
187400         FROM 1 BY 1                                              18650000
187500         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        18660000
187600         MOVE DP015-UNP-ALP-NOR-OFF                               18670000
187700                                   TO MR-SELECTA (PV-SUB)         18680000
187800                                      MR-UPD-UNITSA (PV-SUB)      18690000
187900         MOVE DP015-ASK-NOR-OFF    TO MR-DISTRBUTED-UNITSA(PV-SUB)18700000
188000         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         18710000
188100                                      MR-UPD-UNITSC (PV-SUB)      18720000
188200         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         18730000
188300                                      MR-UPD-UNITSH (PV-SUB)      18740000
188400     END-PERFORM.                                                 18750000
188500******************************************************************18760000
188600** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **18770000
188700** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **18780000
188800** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **18790000
188900** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **18800000
189000******************************************************************18810000
189100 3300-EDIT-SELECTIONS.                                            18820000
189200     EVALUATE TRUE                                                18830000
189300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18840000
189400             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         18850000
189500                 CONTINUE                                         18860000
189600         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         18870000
189700             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        18880000
189800                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   18890000
189900                 MOVE ASC-TEMP-SELECTED-SW                        18900000
190000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18910000
190100                                TO ASC-SELECTED-SW                18920000
190200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18930000
190300             END-IF                                               18940000
190400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18950000
190500                 = SPACE                                          18960000
190600             EVALUATE TRUE                                        18970000
190700                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       18980000
190800                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS18990000
190900                     MOVE SPACE TO ASC-SELECTED-SW                19000000
191000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19010000
191100                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        19020000
191200                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    19030000
191300                     MOVE SPACE TO ASC-SELECTED-SW                19040000
191400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19050000
191500                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          19060000
191600                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      19070000
191700                     MOVE SPACE TO ASC-SELECTED-SW                19080000
191800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19090000
191900             END-EVALUATE                                         19100000
192000         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           19110000
192100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19120000
192200                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19130000
192300             END-IF                                               19140000
192400             PERFORM 3310-EDIT-RANGE                              19150000
192500         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             19160000
192600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19170000
192700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19180000
192800             END-IF                                               19190000
192900             PERFORM 3310-EDIT-RANGE                              19200000
193000         WHEN OTHER                                               19210000
193100             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           19220000
193200             SET DP020-MSG-FATAL    TO TRUE                       19230000
193300             MOVE -1                TO MR-SELECTL (PV-SUB)        19240000
193400             SET DP030-SET-CURSOR-APPL-1                          19250000
193500                                    TO TRUE                       19260000
193600             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        19270000
193700             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        19280000
193800             SET PS-ERROR TO TRUE                                 19290000
193900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19300000
194000                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     19310000
194100                 MOVE SPACE         TO ASC-SELECTED-SW            19320000
194200                                        (ASC-BLK-SUB ASC-ITEM-SUB)19330000
194300             END-IF                                               19340000
194400     END-EVALUATE.                                                19350000
194500                                                                  19360000
194600     PERFORM 3305-EDIT-LINES.                                     19370000
194700                                                                  19380000
194800     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 19390000
194900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               19400000
195000     IF  ASC-ITEM-SUB < 1                                         19410000
195100         SUBTRACT +1 FROM ASC-BLK-SUB                             19420000
195200         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                19430000
195300     END-IF.                                                      19440000
195400                                                                  19450000
195500                                                                  19460000
195600*----------------------------------------------------------------*19470000
195700*  EDIT SELECTED LINES                                           *19480000
195800*----------------------------------------------------------------*19490000
195900 3305-EDIT-LINES.                                                 19500000
196000                                                                  19510000
196100     IF  ASC-UPD-UNITS-X (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES      19520000
196200         MOVE ASC-UPD-UNITS-X (ASC-BLK-SUB ASC-ITEM-SUB) TO       19530000
196300                                    DP010I-UNEDITED-FIELD         19540000
196400         MOVE LENGTH OF ASC-UPD-UNITS                             19550000
196500                                 TO DP010I-MAXIMUM-DIGITS         19560000
196600         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       19570000
196700         SET DP010I-NEGATIVE-NOT-ALLOWED                          19580000
196800                                 TO TRUE                          19590000
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19601008
263455              USING DP010I-NUMERIC-EDIT-AREA                      19602008
197000             IF  DP010I-ERROR-DETECTED                            19610000
197100                 SET PS-ERROR                                     19620000
197200                     DP020-MSG-FATAL TO  TRUE                     19630000
197300                 MOVE PC-TSYMSG-00008                             19640000
197400                                     TO DP020-MSG-NUMBER          19650000
197500                 MOVE DP015-UNP-ALP-BRT-OFF                       19660000
197600                                     TO MR-UPD-UNITSA (PV-SUB)    19670000
197700                 MOVE DP015-RED      TO MR-UPD-UNITSC (PV-SUB)    19680000
197800                 MOVE DP015-REVERSE  TO MR-UPD-UNITSH (PV-SUB)    19690000
197900                 MOVE -1             TO MR-UPD-UNITSL (PV-SUB)    19700000
198000                 SET DP030-SET-CURSOR-APPL-1                      19710000
198100                                     TO TRUE                      19720000
198200             ELSE                                                 19730000
198300                 MOVE DP010I-NUMERIC-FIELD                        19740000
198400                                     TO ASC-UPD-UNITS             19750000
198500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 19760000
198600             END-IF                                               19770000
198700     END-IF.                                                      19780000
198800                                                                  19790000
198900*-----------------------------------------------------------------19800000
199000* F13-LOCAL-FUNC-01 (ADD LINE) MAKE SURE USER HAS RACF ACCESS     19810000
199100*-----------------------------------------------------------------19820000
199200     IF  PS-NO-ERROR                                              19830000
199300       EVALUATE TRUE                                              19840000
199400           WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)            19850000
199500                                                                  19860000
199600                MOVE 'CECSPCNF' TO DP008-FUNCTION-NAME            19870000
199700                PERFORM 2105-RACF-ACCESS                          19880000
199800                IF  PS-ACCESS-NOT-ALLOWED                         19890000
199900                    SET  PS-ERROR                                 19900000
200000                         DP020-MSG-FATAL TO TRUE                  19910000
200100                    MOVE PC-TSYMSG-02329 TO DP020-MSG-NUMBER      19920000
200200                    MOVE -1              TO MR-SELECTL (PV-SUB)   19930000
200300                    SET  DP030-SET-CURSOR-APPL-1 TO TRUE          19940000
200400                END-IF                                            19950000
200500                                                                  19960000
200600                IF PS-NO-ERROR                                    19970000
200700                  EVALUATE TRUE                                   19980000
200800                      WHEN ASC-LINE-STATUS-POSTED                 19990000
200900                      WHEN ASC-LINE-STATUS-CANCELLED              20000000
201000                      WHEN ASC-LINE-STATUS-DISTRIBTD              20010000
201100                                                                  20020000
201200                  SET PS-ERROR                                    20030000
201300                      DP020-MSG-FATAL TO  TRUE                    20040000
201400                  MOVE PC-TSYMSG-02333                            20050000
201500                                      TO DP020-MSG-NUMBER         20060000
201600                  MOVE -1             TO MR-SELECTL (1)           20070000
201700                  SET DP030-SET-CURSOR-APPL-1                     20080000
201800                                      TO TRUE                     20090000
201900                  END-EVALUATE                                    20100000
202000                END-IF                                            20110000
202100       END-EVALUATE                                               20120000
202200     END-IF.                                                      20130000
202300                                                                  20140000
202400                                                                  20150000
202500*-----------------------------------------------------------------20160000
202600* F15-LOCAL-FUNC-02 (UPDATE)                                      20170000
202700*-----------------------------------------------------------------20180000
202800     IF  PS-NO-ERROR                                              20190000
202900         EVALUATE TRUE                                            20200000
203000             WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)          20210000
203100                  EVALUATE TRUE                                   20220000
203200                      WHEN ASC-LINE-STATUS-POSTED                 20230000
203300                      WHEN ASC-LINE-STATUS-CANCELLED              20240000
203400                                                                  20250000
203500                           SET PS-ERROR                           20260000
203600                           DP020-MSG-FATAL TO  TRUE               20270000
203700                           MOVE PC-TSYMSG-02245                   20280000
203800                                      TO DP020-MSG-NUMBER         20290000
203900                           MOVE DP015-UNP-ALP-BRT-OFF             20300000
204000                                      TO MR-SELECTA (PV-SUB)      20310000
204100                           MOVE DP015-RED                         20320000
204200                                      TO MR-SELECTC (PV-SUB)      20330000
204300                           MOVE DP015-REVERSE                     20340000
204400                                      TO MR-SELECTH (PV-SUB)      20350000
204500                           MOVE -1                                20360000
204600                                      TO MR-SELECTL (PV-SUB)      20370000
204700                           SET DP030-SET-CURSOR-APPL-1            20380000
204800                                      TO TRUE                     20390000
204900                                                                  20400000
205000                      WHEN ASC-LINE-STATUS-NEW                    20410000
205100                           SET PS-ERROR                           20420000
205200                           DP020-MSG-FATAL TO  TRUE               20430000
205300                           MOVE PC-TSYMSG-02355                   20440000
205400                                      TO DP020-MSG-NUMBER         20450000
205500                           MOVE DP015-UNP-ALP-BRT-OFF             20460000
205600                                      TO MR-SELECTA (PV-SUB)      20470000
205700                           MOVE DP015-RED                         20480000
205800                                      TO MR-SELECTC (PV-SUB)      20490000
205900                           MOVE DP015-REVERSE                     20500000
206000                                      TO MR-SELECTH (PV-SUB)      20510000
206100                           MOVE -1                                20520000
206200                                      TO MR-SELECTL (PV-SUB)      20530000
206300                           SET DP030-SET-CURSOR-APPL-1            20540000
206400                                      TO TRUE                     20550000
206500                  END-EVALUATE                                    20560000
206600                                                                  20570000
206700         END-EVALUATE                                             20580000
206800     END-IF.                                                      20590000
206900                                                                  20600000
207000                                                                  20610000
207100*-----------------------------------------------------------------20620000
207200* F16-LOCAL-FUNC-04 (ADJMNFST)                                    20630000
207300*                   (ONLY VALID IF DISTRO MAINTAINED BY RDM)      20640000
207400*-----------------------------------------------------------------20650000
207500     IF  PS-NO-ERROR                                              20660000
207600         EVALUATE TRUE                                            20670000
207700             WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)          20680000
207710                  EVALUATE TRUE                                   20690000
207720                      WHEN ASC-LINE-STATUS-POSTED                 20700000
207730                      WHEN ASC-LINE-STATUS-CANCELLED              20710000
207740                                                                  20720000
207750                           SET PS-ERROR                           20730000
207760                           DP020-MSG-FATAL TO  TRUE               20740000
207770                           MOVE PC-TSYMSG-02245                   20750000
207780                                      TO DP020-MSG-NUMBER         20760000
207790                           MOVE DP015-UNP-ALP-BRT-OFF             20770000
207791                                      TO MR-SELECTA (PV-SUB)      20771000
207792                           MOVE DP015-RED                         20772000
207793                                      TO MR-SELECTC (PV-SUB)      20773000
207794                           MOVE DP015-REVERSE                     20774000
207795                                      TO MR-SELECTH (PV-SUB)      20775000
207796                           MOVE -1                                20776000
207797                                      TO MR-SELECTL (PV-SUB)      20777000
207798                           SET DP030-SET-CURSOR-APPL-1            20778000
207799                                      TO TRUE                     20779000
207800                                                                  20780000
207801                      WHEN ASC-LINE-STATUS-NEW                    20780100
207802                           SET PS-ERROR                           20780200
207803                           DP020-MSG-FATAL TO  TRUE               20780300
207804                           MOVE PC-TSYMSG-02355                   20780400
207805                                      TO DP020-MSG-NUMBER         20780500
207806                           MOVE DP015-UNP-ALP-BRT-OFF             20780600
207807                                      TO MR-SELECTA (PV-SUB)      20780700
207808                           MOVE DP015-RED                         20780800
207809                                      TO MR-SELECTC (PV-SUB)      20780900
207810                           MOVE DP015-REVERSE                     20781000
207811                                      TO MR-SELECTH (PV-SUB)      20781100
207812                           MOVE -1                                20781200
207813                                      TO MR-SELECTL (PV-SUB)      20781300
207814                           SET DP030-SET-CURSOR-APPL-1            20781400
207815                                      TO TRUE                     20781500
207816                  END-EVALUATE                                    20781600
207817                                                                  20781700
207818         END-EVALUATE                                             20781800
207819     END-IF.                                                      20781900
207820                                                                  20782000
207830                                                                  20783000
207840*-----------------------------------------------------------------20784000
207850* F15-LOCAL-FUNC-02 (UPDATE) (ONLY VALID IF USING RDM APPLICATION)20785000
207860*-----------------------------------------------------------------20786000
207870     IF  PS-NO-ERROR                                              20787000
207880         EVALUATE TRUE                                            20788000
207890             WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)          20789000
207900                  PERFORM 3600-CHECK-FOR-RDM-UPD                  20790000
207910         END-EVALUATE                                             20791000
207920     END-IF.                                                      20792000
207930                                                                  20793000
207940                                                                  20794000
207950*-----------------------------------------------------------------20795000
207960* F16-LOCAL-FUNC-04 (ADJMNFST)                                    20796000
207970*                   (ONLY VALID IF DISTRO MAINTAINED BY RDM)      20797000
207980*-----------------------------------------------------------------20798000
207990     IF  PS-NO-ERROR                                              20799000
207991         EVALUATE TRUE                                            20799100
207992             WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)          20799200
207993                  PERFORM 3610-CHECK-FOR-RDM-ADJ                  20799300
207994         END-EVALUATE                                             20799400
207995     END-IF.                                                      20799500
207996                                                                  20799600
207997                                                                  20799700
207998******************************************************************20799800
207999** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **20799900
208000** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **20800000
208100** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**20810000
208200** THE ENDING.                                                  **20820000
208300******************************************************************20830000
208400 3310-EDIT-RANGE.                                                 20840000
208500     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                20850000
208600         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   20860000
208700             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)20870000
208800                                   TO ASC-SELECTED-SW             20880000
208900                                        (ASC-BLK-SUB ASC-ITEM-SUB)20890000
209000             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 20900000
209100         ELSE                                                     20910000
209200             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     20920000
209300                 CONTINUE                                         20930000
209400             ELSE                                                 20940000
209500*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        20950000
209600                 MOVE PC-TSYMSG-00054                             20960000
209700                                   TO DP020-MSG-NUMBER            20970000
209800                 SET DP020-MSG-FATAL                              20980000
209900                                   TO TRUE                        20990000
210000                 MOVE -1           TO MR-SELECTL (PV-SUB)         21000000
210100                 SET DP030-SET-CURSOR-APPL-1                      21010000
210200                                   TO TRUE                        21020000
210300                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         21030000
210400                 MOVE DP015-UNDERLINE                             21040000
210500                                   TO MR-SELECTH (PV-SUB)         21050000
210600                 SET PS-ERROR      TO TRUE                        21060000
210700             END-IF                                               21070000
210800         END-IF                                                   21080000
210900     ELSE                                                         21090000
211000         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     21100000
211100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 21110000
211200                                   TO ASC-SELECTED-SW             21120000
211300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   21130000
211400             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   21140000
211500         ELSE                                                     21150000
211600             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       21160000
211700                 CONTINUE                                         21170000
211800             ELSE                                                 21180000
211900*                -- ONLY ONE END-OF-RANGE ALLOWED --              21190000
212000                 MOVE PC-TSYMSG-00055                             21200000
212100                                   TO DP020-MSG-NUMBER            21210000
212200                 SET DP020-MSG-FATAL                              21220000
212300                                   TO TRUE                        21230000
212400                 MOVE -1           TO MR-SELECTL (PV-SUB)         21240000
212500                 SET DP030-SET-CURSOR-APPL-1                      21250000
212600                                   TO TRUE                        21260000
212700                 SET PS-ERROR      TO TRUE                        21270000
212800             END-IF                                               21280000
212900         END-IF                                                   21290000
213000     END-IF.                                                      21300000
213100*                                                                 21310000
213200******************************************************************21320000
213300** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **21330000
213400** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **21340000
213500******************************************************************21350000
213600 3400-CHECK-RANGE-SEQUENCE.                                       21360000
213700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       21370000
213800       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      21380000
213900       AND  ASC-START-OF-SELECTED-RANGE >                         21390000
214000                                         ASC-END-OF-SELECTED-RANGE21400000
214100*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                21410000
214200         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 21420000
214300         SET DP020-MSG-FATAL TO TRUE                              21430000
214400         SET PS-ERROR TO TRUE                                     21440000
214500         PERFORM 3410-POSITION-AT-ERROR                           21450000
214600     END-IF.                                                      21460000
214700******************************************************************21470000
214800** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **21480000
214900** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **21490000
215000** SHOULD BE POSITIONED ON A RANGE ERROR.                       **21500000
215100******************************************************************21510000
215200 3410-POSITION-AT-ERROR.                                          21520000
215300     SET DP030-SET-CURSOR-APPL-1                                  21530000
215400                                   TO TRUE.                       21540000
215500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 21550000
215600                    - PV-TOP-ITEM + 1.                            21560000
215700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      21570000
215800         CONTINUE                                                 21580000
215900     ELSE                                                         21590000
216000         MOVE -1                   TO MR-SELECTL (PV-SUB)         21600000
216100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         21610000
216200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         21620000
216300     END-IF.                                                      21630000
216400*                                                                 21640000
216500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   21650000
216600                    - PV-TOP-ITEM + 1.                            21660000
216700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      21670000
216800         CONTINUE                                                 21680000
216900     ELSE                                                         21690000
217000         MOVE -1                   TO MR-SELECTL (PV-SUB)         21700000
217100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         21710000
217200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         21720000
217300     END-IF.                                                      21730000
217400 EJECT                                                            21740000
217500*----------------------------------------------------------------*21750000
217600*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *21760000
217700*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *21770000
217800*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *21780000
217900*----------------------------------------------------------------*21790000
218000                                                                  21800000
218100 3500-MARK-RANGE-AS-SELECTED.                                     21810000
218200     MOVE +1                       TO  ASC-BLK-SUB.               21820000
218300     PERFORM 3510-MARK-SELECTED-INDS                              21830000
218400         VARYING ASC-ITEM-SUB                                     21840000
218500         FROM 1 BY 1                                              21850000
218600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21860000
218700                                                                  21870000
218800     ADD +1                        TO ASC-BLK-SUB.                21880000
218900     PERFORM 3510-MARK-SELECTED-INDS                              21890000
219000         VARYING ASC-ITEM-SUB                                     21900000
219100         FROM 1 BY 1                                              21910000
219200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21920000
219300                                                                  21930000
219400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               21940000
219500                                   TO  PV-LIST-ITEM-NUMBER.       21950000
219600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            21960000
219700         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         21970000
219800               PC-ITEMS-PER-PANEL).                               21980000
219900                                                                  21990000
220000     MOVE ASC-START-OF-SELECTED-RANGE                             22000000
220100                                   TO PV-START-OF-SELECTED-RANGE. 22010000
220200     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            22020000
220300         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  22030000
220400               PC-ITEMS-PER-PANEL).                               22040000
220500                                                                  22050000
220600     MOVE ASC-END-OF-SELECTED-RANGE                               22060000
220700                                   TO  PV-END-OF-SELECTED-RANGE.  22070000
220800     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             22080000
220900         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    22090000
221000               PC-ITEMS-PER-PANEL).                               22100000
221100     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             22110000
221200         PV-FIRST-BLOCK-IN-ARRAY + 1.                             22120000
221300                                                                  22130000
221400     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    22140000
221500        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        22150000
221600         MOVE +1                   TO ASC-BLK-SUB                 22160000
221700         PERFORM 5100-WRITE-TEMP-STORAGE                          22170000
221800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         22180000
221900             PV-FIRST-BLOCK-IN-ARRAY - 1                          22190000
222000                                                                  22200000
222100         PERFORM                                                  22210000
222200             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      22220000
222300                   PV-PREV-BLOCK-IN-ARRAY                         22230000
222400             MOVE PV-FIRST-BLOCK-IN-RANGE                         22240000
222500                                   TO PV-BLOCK-NUMBER             22250000
222600             PERFORM 4410-READ-TEMP-STORAGE                       22260000
222700             PERFORM 3510-MARK-SELECTED-INDS                      22270000
222800                 VARYING ASC-ITEM-SUB                             22280000
222900                 FROM 1 BY 1                                      22290000
223000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22300000
223100             PERFORM 5100-WRITE-TEMP-STORAGE                      22310000
223200             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     22320000
223300         END-PERFORM                                              22330000
223400                                                                  22340000
223500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         22350000
223600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     22360000
223700         PERFORM                                                  22370000
223800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       22380000
223900                   PV-LAST-BLOCK-IN-RANGE                         22390000
224000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          22400000
224100                                   TO PV-BLOCK-NUMBER             22410000
224200             PERFORM 4410-READ-TEMP-STORAGE                       22420000
224300             PERFORM 3510-MARK-SELECTED-INDS                      22430000
224400                 VARYING ASC-ITEM-SUB                             22440000
224500                 FROM 1 BY 1                                      22450000
224600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22460000
224700             PERFORM 5100-WRITE-TEMP-STORAGE                      22470000
224800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      22480000
224900         END-PERFORM                                              22490000
225000                                                                  22500000
225100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             22510000
225200                                   TO PV-BLOCK-NUMBER             22520000
225300         PERFORM 4410-READ-TEMP-STORAGE                           22530000
225400     END-IF.                                                      22540000
225500                                                                  22550000
225600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 22560000
225700                                      ASC-END-OF-SELECTED-RANGE.  22570000
225800                                                                  22580000
225900 EJECT                                                            22590000
226000*----------------------------------------------------------------*22600000
226100* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *22610000
226200*----------------------------------------------------------------*22620000
226300                                                                  22630000
226400 3510-MARK-SELECTED-INDS.                                         22640000
226500                                                                  22650000
226600     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         22660000
226700                                ASC-ITEM-SUB) >                   22670000
226800         ASC-START-OF-SELECTED-RANGE)                             22680000
226900     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         22690000
227000                                ASC-ITEM-SUB) =                   22700000
227100         ASC-START-OF-SELECTED-RANGE)                             22710000
227200                                                                  22720000
227300         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     22730000
227400                                    ASC-ITEM-SUB) <               22740000
227500             ASC-END-OF-SELECTED-RANGE)                           22750000
227600         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     22760000
227700                                    ASC-ITEM-SUB) =               22770000
227800             ASC-END-OF-SELECTED-RANGE)                           22780000
227900                                                                  22790000
228000             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          22800000
228100                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   22810000
228200                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   22820000
228300                               TO TRUE                            22830000
228400                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              22840000
228500                               TO TRUE                            22850000
228600                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    22860000
228700             END-IF                                               22870000
228800         END-IF                                                   22880000
228900     END-IF.                                                      22890000
229000                                                                  22900000
229100                                                                  22910000
229200*----------------------------------------------------------------*22920000
229300* VALIDATE FOR RDM UPDATE                                         22930000
229310*----------------------------------------------------------------*22931000
229320 3600-CHECK-FOR-RDM-UPD.                                          22932000
229330                                                                  22933000
229340     MOVE  ASC-PULL-NBR-N    TO DK-RDM-PULL-NUMBER.               22934000
229350                                                                  22935000
229360      EXEC SQL                                                    22936000
229370        SELECT  1                                                 22937000
229380          INTO  :DK-DUMMY-FIELD                                   22938000
229390           FROM  TCEPLRQ A,                                       22939000
229391                 TCEPLST B,                                       22939100
229392                 TKRPRPM C                                        22939200
229393           WHERE     A.CNSTK_REQ_PL_NBR  = B.CNSTK_REQ_PL_NBR     22939300
229394                 AND B.CNSTK_REQ_PL_NBR  = :DK-RDM-PULL-NUMBER    22939400
229395                 AND A.CNSTK_LOC_ID      = C.LOC_ID               22939500
229396                 AND B.PL_LNE_NBR        = 0                      22939600
229397                 AND B.STAT_CDE          = 'NW'                   22939700
229398                 AND C.INTFC_SYS_CDE     = 'RDM'                  22939800
229399                 AND C.SYS_PRC_FUNC_CDE  = 'RDMCSL'               22939900
229400                 AND C.FUNC_PRC_STAT_CDE = 'AC'                   22940000
229401                 AND DATE(FUNC_BEG_TMST) < DATE(CRE_TMST)         22940100
229402      END-EXEC.                                                   22940200
229403                                                                  22940300
229404      EVALUATE TRUE                                               22940400
229405          WHEN SQLCODE = 0                                        22940500
229406              SET PS-ERROR                                        22940600
229407                  DP020-MSG-FATAL TO  TRUE                        22940700
229408              MOVE PC-TSYMSG-02495        TO DP020-MSG-NUMBER     22940800
229409              MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB)  22940900
229410              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  22941000
229411              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  22941100
229412              MOVE -1                     TO MR-SELECTL (PV-SUB)  22941200
229413              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 22941300
229414          WHEN OTHER                                              22941400
229415              PERFORM 3620-CHECK-FOR-RDM-PARAMETER                22941500
229416      END-EVALUATE.                                               22941600
229417                                                                  22941700
229418                                                                  22941800
229419*----------------------------------------------------------------*22941900
229420* VALIDATE FOR RDM-ADJUSTMENT                                     22942000
229421*----------------------------------------------------------------*22942100
229422 3610-CHECK-FOR-RDM-ADJ.                                          22942200
229423                                                                  22942300
229424     MOVE  ASC-PULL-NBR-N    TO DK-RDM-PULL-NUMBER.               22942400
229425                                                                  22942500
229426      EXEC SQL                                                    22942600
229427        SELECT  1                                                 22942700
229428          INTO  :DK-DUMMY-FIELD                                   22942800
229429           FROM  TCEPLRQ A,                                       22942900
229430                 TCEPLST B,                                       22943000
229431                 TKRPRPM C                                        22943100
229432           WHERE     A.CNSTK_REQ_PL_NBR  = B.CNSTK_REQ_PL_NBR     22943200
229433                 AND B.CNSTK_REQ_PL_NBR  = :DK-RDM-PULL-NUMBER    22943300
229434                 AND A.CNSTK_LOC_ID      = C.LOC_ID               22943400
229435                 AND B.PL_LNE_NBR        = 0                      22943500
229436                 AND B.STAT_CDE          = 'NW'                   22943600
229437                 AND C.INTFC_SYS_CDE     = 'RDM'                  22943700
229438                 AND C.SYS_PRC_FUNC_CDE  = 'RDMCSL'               22943800
229439                 AND C.FUNC_PRC_STAT_CDE = 'AC'                   22943900
229440                 AND DATE(FUNC_BEG_TMST) > DATE(CRE_TMST)         22944000
229441      END-EXEC.                                                   22944100
229442                                                                  22944200
229443      EVALUATE TRUE                                               22944300
229444          WHEN SQLCODE = 0                                        22944400
229445              SET PS-ERROR                                        22944500
229446                  DP020-MSG-FATAL TO  TRUE                        22944600
229447              MOVE PC-TSYMSG-02553        TO DP020-MSG-NUMBER     22944700
229448              MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB)  22944800
229449              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  22944900
229450              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  22945000
229451              MOVE -1                     TO MR-SELECTL (PV-SUB)  22945100
229452              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 22945200
229453          WHEN OTHER                                              22945300
229454              PERFORM 3620-CHECK-FOR-RDM-PARAMETER                22945400
229455      END-EVALUATE.                                               22945500
229456                                                                  22945600
229457                                                                  22945700
229458*----------------------------------------------------------------*22945800
229459* CHECK RDM IN PARAMATER TABLE                                    22945900
229460*----------------------------------------------------------------*22946000
229461 3620-CHECK-FOR-RDM-PARAMETER.                                    22946100
229462                                                                  22946200
229463      EXEC SQL                                                    22946300
229464        SELECT  1                                                 22946400
229465          INTO  :DK-DUMMY-FIELD                                   22946500
229466           FROM  TCEPLRQ A,                                       22946600
229467                 TCEPLST B,                                       22946700
229468                 TKRPRPM C                                        22946800
229469           WHERE     A.CNSTK_REQ_PL_NBR  = B.CNSTK_REQ_PL_NBR     22946900
229470                 AND B.CNSTK_REQ_PL_NBR  = :DK-RDM-PULL-NUMBER    22947000
229471                 AND A.CNSTK_LOC_ID      = C.LOC_ID               22947100
229472                 AND B.PL_LNE_NBR        = 0                      22947200
229473                 AND B.STAT_CDE          = 'NW'                   22947300
229474                 AND C.INTFC_SYS_CDE     = 'RDM'                  22947400
229475                 AND C.SYS_PRC_FUNC_CDE  = 'RDMCSL'               22947500
229476                 AND C.FUNC_PRC_STAT_CDE = 'AC'                   22947600
229477      END-EXEC.                                                   22947700
229478                                                                  22947800
229479      EVALUATE TRUE                                               22947900
229480          WHEN SQLCODE = +100                                     22948000
229481               EVALUATE TRUE                                      22948100
229482                   WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)    22948200
229483               SET PS-ERROR                                       22948300
229484                   DP020-MSG-FATAL TO  TRUE                       22948400
229485               MOVE PC-TSYMSG-02553        TO DP020-MSG-NUMBER    22948500
229486               MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB) 22948600
229487               MOVE DP015-RED              TO MR-SELECTC (PV-SUB) 22948700
229488               MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB) 22948800
229489               MOVE -1                     TO MR-SELECTL (PV-SUB) 22948900
229490               SET DP030-SET-CURSOR-APPL-1 TO TRUE                22949000
229500               END-EVALUATE                                       22950000
229501      END-EVALUATE.                                               22950100
229502                                                                  22950200
229503                                                                  22950300
229504*----------------------------------------------------------------*22950400
229505*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *22950500
229506*    INITIALIZE ALL COUNTERS AND FLAGS.                          *22950600
229507*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *22950700
229508*    DISPLAY THE PANEL TO USER.                                  *22950800
229509*----------------------------------------------------------------*22950900
229510                                                                  22951000
229520 4000-BUILD-INITIAL-PANEL.                                        22952000
229530                                                                  22953000
229540     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            22954000
229550                                 ASC-BLOCK-ENTRIES (2).           22955000
229560     MOVE +1                 TO ASC-BLK-SUB.                      22956000
229570     SET ASC-ITEMS-LEFT-ON-DB                                     22957000
229580                             TO TRUE.                             22958000
229590                                                                  22959000
229600     MOVE +0                 TO ASC-ITEM-SUB                      22960000
229700                                ASC-NUMBER-OF-ITEMS-READ          22970000
229800                                ASC-NUMBER-OF-SELECTED-ITEMS      22980000
229900                                ASC-HIGHEST-BLOCK-WRITTEN         22990000
230000                                ASC-START-OF-SELECTED-RANGE       23000000
230100                                ASC-END-OF-SELECTED-RANGE         23010000
230200                                ASC-ITEM-AT-TOP-OF-PANEL.         23020000
230300                                                                  23030000
230400     PERFORM 4100-PREPARE-CURSOR                                  23040000
230500                                                                  23050000
230600     PERFORM 4010-OPEN-CURSOR.                                    23060000
230700                                                                  23070000
230800     PERFORM 4300-READ-ITEMS-FROM-DB.                             23080000
230900                                                                  23090000
231000     PERFORM 4020-CLOSE-CURSOR.                                   23100000
231100                                                                  23110000
231200     MOVE +1                   TO  PV-TOP-ITEM.                   23120000
231300     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          23130000
231400         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    23140000
231500         SET DP020-MSG-FATAL   TO  TRUE                           23150000
231600         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               23160000
231700     ELSE                                                         23170000
231800         MOVE -1               TO MR-SELECTL (1)                  23180000
231900         SET DP030-SET-CURSOR-APPL-1                              23190000
232000                               TO TRUE                            23200000
232100         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     23210000
232200     END-IF.                                                      23220000
232300 EJECT                                                            23230000
232400*----------------------------------------------------------------*23240000
232500* OPEN THE TMESSAGE CURSOR.                                      *23250000
232600*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *23260000
232700*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *23270000
232800*   USER.                                                        *23280000
232900*----------------------------------------------------------------*23290000
233000                                                                  23300000
233100 4010-OPEN-CURSOR.                                                23310000
233200     PERFORM                                                      23320000
233300         WITH TEST AFTER                                          23330000
233400         VARYING PV-RETRY-COUNTER                                 23340000
233500         FROM 1 BY 1                                              23350000
233600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23360000
233700                   OR (SQLCODE = ZERO))                           23370000
233800                                                                  23380000
233900         MOVE 'CURSOR:  LINE-ITEM-DSTR-CSR'                       23390000
234000                              TO DP013-MESSAGE-TEXT (2)           23400000
234100         EXEC SQL                                                 23410000
234200              OPEN LINE-ITEM-DSTR-CSR                             23420000
234300         END-EXEC                                                 23430000
234400                                                                  23440000
234500                                                                  23450000
234600         EVALUATE TRUE                                            23460000
234700             WHEN SQLCODE = ZERO                                  23470000
234800             WHEN SQLCODE = -904                                  23480000
234900             WHEN SQLCODE = -913                                  23490000
235000                 CONTINUE                                         23500000
235100             WHEN SQLWARN0 NOT = SPACES                           23510000
235200             WHEN SQLCODE < ZERO                                  23520000
235300             WHEN SQLCODE > ZERO                                  23530000
235400                 MOVE '4010-OPEN-CURSOR'                          23540000
235500                                   TO DP013-PARAGRAPH             23550000
235600                 MOVE 'OPEN CENTRAL STOCK DISTRO CURSOR - '       23560000
235700                                   TO DP013-MESSAGE-TEXT (1)      23570000
235800                 MOVE SQLCA        TO DP013-SQLCA                 23580000
235900                 MOVE 'TCEPLDS '   TO DP013-DB2-TABLE-NAME (1)    23590000
236000                 SET DP013-DB2-ABEND                              23600000
236100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           23610000
236200                 PERFORM DP013-0000-PROCESS-ABEND                 23620000
236300         END-EVALUATE                                             23630000
236400     END-PERFORM                                                  23640000
236500*                                                                 23650000
236600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23660000
236700         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             23670000
236800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   23680000
236900                                   TO DP013-MESSAGE-TEXT (1)      23690000
237000         MOVE SQLCA                TO DP013-SQLCA                 23700000
237100         MOVE 'TCEPLDS '           TO DP013-DB2-TABLE-NAME (1)    23710000
237200         SET DP013-DB2-ABEND                                      23720000
237300             DP013-XCTL-DISPLAY-RESTART                           23730000
237400                                   TO TRUE                        23740000
237500         PERFORM DP013-0000-PROCESS-ABEND                         23750000
237600     END-IF.                                                      23760000
237700                                                                  23770000
237800 EJECT                                                            23780000
237900*----------------------------------------------------------------*23790000
238000* CLOSE THE TMESSAGE CURSOR.                                     *23800000
238100*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *23810000
238200*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *23820000
238300*   USER.                                                        *23830000
238400*----------------------------------------------------------------*23840000
238500                                                                  23850000
238600 4020-CLOSE-CURSOR.                                               23860000
238700                                                                  23870000
238800     EXEC SQL                                                     23880000
238900          CLOSE LINE-ITEM-DSTR-CSR                                23890000
239000     END-EXEC.                                                    23900000
239100                                                                  23910000
239200*                                                                 23920000
239300     EVALUATE TRUE                                                23930000
239400         WHEN SQLCODE = ZERO                                      23940000
239500             CONTINUE                                             23950000
239600         WHEN SQLWARN0 NOT = SPACES                               23960000
239700         WHEN SQLCODE < ZERO                                      23970000
239800         WHEN SQLCODE > ZERO                                      23980000
239900             MOVE '4020-CLOSE-CURSOR'                             23990000
240000                               TO DP013-PARAGRAPH                 24000000
240100             MOVE 'CLOSE CENTRAL STOCK DISTRIBUTION CURSOR'       24010000
240200                               TO DP013-MESSAGE-TEXT (1)          24020000
240300             MOVE SQLCA        TO DP013-SQLCA                     24030000
240400             MOVE 'TCEPLDS '   TO DP013-DB2-TABLE-NAME (1)        24040000
240500             SET DP013-DB2-ABEND                                  24050000
240600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               24060000
240700             PERFORM DP013-0000-PROCESS-ABEND                     24070000
240800     END-EVALUATE.                                                24080000
240900                                                                  24090000
241000 EJECT                                                            24100000
241100*----------------------------------------------------------------*24110000
241200*    SET UP THE HOST VARIABLES.                                  *24120000
241300*----------------------------------------------------------------*24130000
241400                                                                  24140000
241500 4100-PREPARE-CURSOR.                                             24150000
241600                                                                  24160000
241700     MOVE ASC-PULL-NBR         TO DK-PULL-NUMBER.                 24170000
241800     MOVE ASC-REF-NBR          TO DK-REF-NUMBER.                  24180000
241900     MOVE ASC-LINE-ITEM        TO DK-LINE-NUMBER.                 24190000
242000*LMM                                                              24200000
242100     MOVE ASC-CS-LOC           TO DK-LOC-ID.                      24210000
242200                                                                  24220000
242300*----------------------------------------------------------------*24230000
242400*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *24240000
242500*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *24250000
242600*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *24260000
242700*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *24270000
242800*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *24280000
242900*                                                                *24290000
243000*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *24300000
243100*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *24310000
243200*    UPON INITIALIZATION.                                        *24320000
243300*----------------------------------------------------------------*24330000
243400 4300-READ-ITEMS-FROM-DB.                                         24340000
243500*INITIALIZE COLUMN TOTALS                                         24350000
243600     MOVE ZEROS TO ASC-TOT-DISTRB-UNTS                            24360000
243700                   ASC-TOT-MANIFEST-UNTS                          24370000
243800                   ASC-TOT-ADJUST-UNTS                            24380000
243810                   ASC-TOT-ADJUST-CNT.                            24381000
243900                                                                  24382000
244000     PERFORM                                                      24383000
244100         VARYING PV-READ-COUNT                                    24384000
244200         FROM 1 BY 1                                              24385000
244300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    24386000
244400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         24387000
244500                                                                  24388000
244600         PERFORM 4310-FETCH                                       24389000
244700                                                                  24390000
244800         IF  ASC-ITEMS-LEFT-ON-DB                                 24400000
244900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                24410000
245000                 ADD +1            TO ASC-ITEM-SUB                24420000
245100             ELSE                                                 24430000
245200                 ADD +1            TO ASC-BLK-SUB                 24440000
245300                 MOVE +1           TO ASC-ITEM-SUB                24450000
245400                                                                  24460000
245500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         24470000
245600                     MOVE +1       TO ASC-BLK-SUB                 24480000
245700                     SET ASC-BLOCK-MODIFIED (1)                   24490000
245800                                   TO TRUE                        24500000
245900                     PERFORM 5100-WRITE-TEMP-STORAGE              24510000
246000                     MOVE ASC-BLOCK-ENTRIES                       24520000
246100                               (PC-MAX-BLOCKS-IN-ARRAY)           24530000
246200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 24540000
246300                     ADD +1        TO ASC-BLK-SUB                 24550000
246400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   24560000
246500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      24570000
246600                                   TO TRUE                        24580000
246700                 END-IF                                           24590000
246800             END-IF                                               24600000
246900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    24610000
247000             MOVE ASC-NUMBER-OF-ITEMS-READ                        24620000
247100                                   TO ASC-LIST-ITEM-NUMBER        24630000
247200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24640000
247300                                                                  24650000
247400             MOVE ZEROES      TO  ASC-UPD-UNITS                   24660000
247500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24670000
247600             MOVE CEPLDS-STR-NBR                                  24680000
247700                              TO  ASC-STORE-NUMBER                24690000
247800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24700000
247900                                  ASC-STORE-NBR                   24710000
248000             MOVE CEPLDS-REQ-ORD-QTY                              24720000
248100                              TO  ASC-REQ-UNITS                   24730000
248200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24740000
248300             MOVE PV-DISPLAY-ACTL-DISTRB-QTY                      24750000
248400                              TO  ASC-DISTRB-UNITS                24760000
248500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24770000
248600                                  ASC-DISTRB-UNTS                 24780000
248700*LMM                                                              24790000
248800         ADD CEPLDS-ACTL-DISTRB-QTY TO ASC-TOT-DISTRB-UNTS        24800000
248810                                       ASC-ACTL-DISTRIB-QTY       24810000
248820                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24820000
248900*                                                                 24830000
249000*GET MANIFEST UNITS AND TOTAL MANIFEST UNITS                      24840000
249100         MOVE ASC-STORE-NBR    TO DK-STORE-NUMBER                 24850000
249200         PERFORM 4520-GET-MANIFEST-UNITS                          24860000
249300         MOVE PV-MANIFEST-UNITS TO ASC-MANIFEST-UNITS             24870000
249400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24880000
249500                                   ASC-MANIFEST-UNTS              24890000
249600         ADD PV-MANIFEST-UNITS TO ASC-TOT-MANIFEST-UNTS           24900000
249700                                                                  24910000
249800*GET ADJUSTED UNITS AND TOTAL ADJUSTED UNITS                      24920000
249900         PERFORM 4530-GET-ADJUST-UNITS                            24930000
250000                                                                  24940000
250010         IF  PV-ADJUSTMENT-CNT  >  0  AND                         24950000
250020             PV-ADJUST-UNITS    =  0                              24960000
250030             MOVE  PV-ADJUST-UNITS  TO  PV-ZERO-ADJ-UNIT          24970000
250040             MOVE  PV-ZERO-ADJ-UNIT                               24980000
250100                              TO ASC-ADJUST-UNITS                 24990000
250200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25000000
250201         ELSE                                                     25010000
250202             MOVE  PV-ADJUST-UNITS  TO  PV-NUMERIC-ADJ-UNITS      25020000
250203             MOVE  PV-NUMERIC-ADJ-UNITS                           25020100
250204                              TO ASC-ADJUST-UNITS                 25020200
250205                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25020300
250206         END-IF                                                   25020400
250210                                                                  25020500
250300         MOVE PV-ADJUST-UNITS TO ASC-ADJUST-UNITS-SIGNED          25020600
250400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25020700
250600                                                                  25020800
250700         ADD PV-ADJUST-UNITS   TO ASC-TOT-ADJUST-UNTS             25020900
250800         ADD PV-ADJUSTMENT-CNT TO ASC-TOT-ADJUST-CNT              25021000
251000                                                                  25022000
251100             EVALUATE  TRUE                                       25023000
251200                 WHEN  ASC-PULL-NEW                               25024000
251300                           MOVE  PC-NEW-DESC                      25025000
251400                               TO ASC-LINE-STATUS-DESC            25026000
251500                 WHEN  ASC-PULL-CANCELLED                         25027000
251600                           MOVE  PC-PULL-STATUS-CANCELLED         25028000
251700                               TO ASC-LINE-STATUS-DESC            25029000
251800                 WHEN  ASC-PULL-IN-PROCESS                        25030000
251900                           MOVE  PC-IN-PROCESS-DESC               25040000
252000                               TO ASC-LINE-STATUS-DESC            25050000
252100                 WHEN  ASC-PULL-IN-PROCESS                        25060000
252200                           MOVE  PC-DISTRIB-DESC                  25070000
252300                               TO ASC-LINE-STATUS-DESC            25080000
252400                 WHEN  ASC-PULL-POSTED                            25090000
252500                           MOVE  PC-POSTED-DESC                   25100000
252600                               TO ASC-LINE-STATUS-DESC            25110000
252700             END-EVALUATE                                         25120000
252800                                                                  25130000
252900* DMH 12/15/00 - BEGIN                                            25140000
253000*GET STORE POSTED-UNITS                                           25150000
253100         PERFORM 4535-GET-POSTED-UNITS                            25160000
253200         EVALUATE TRUE                                            25170000
253300             WHEN ASC-LINE-STATUS-POSTED                          25180000
253400                  IF  PV-TOTAL-POSTED-QTY  =  ZERO                25190000
253500                      MOVE  ASC-DISTRB-UNITS                      25200000
253600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25210000
253610                        TO  ASC-STR-POSTED-UNITS                  25220000
253620                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25230000
253630                  ELSE                                            25240000
253640                      MOVE  PV-TOTAL-POSTED-QTY                   25250000
253650                        TO  PV-NUMERIC-ACTL-DISTRB-QTY            25260000
253660                      MOVE  PV-NUMERIC-ACTL-DISTRB-QTY            25270000
253680                        TO  ASC-STR-POSTED-UNITS                  25280000
253690                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25290000
253800                  END-IF                                          25300000
253810             WHEN OTHER                                           25310000
253820                      MOVE  PV-TOTAL-POSTED-QTY                   25320000
253830                        TO  PV-NUMERIC-ACTL-DISTRB-QTY            25330000
253840                      MOVE  PV-NUMERIC-ACTL-DISTRB-QTY            25340000
253850                        TO  ASC-STR-POSTED-UNITS                  25350000
253860                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25360000
253900         END-EVALUATE                                             25370000
254000                                                                  25380000
254030* DMH 12/15/00 - END                                              25390000
254040                                                                  25400000
254050         END-IF                                                   25401000
254060     END-PERFORM.                                                 25402000
254070                                                                  25403000
254080     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          25404000
254090         MOVE +1               TO ASC-BLK-SUB                     25405000
254100         PERFORM 5100-WRITE-TEMP-STORAGE                          25406000
254200         ADD +1                TO ASC-BLK-SUB                     25407000
254300         PERFORM 5100-WRITE-TEMP-STORAGE                          25408000
254400                                                                  25409000
254500         MOVE 1                TO ASC-BLK-SUB                     25410000
254600                                  PV-BLOCK-NUMBER                 25420000
254700         PERFORM 4410-READ-TEMP-STORAGE                           25430000
254800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             25440000
254900             MOVE 2            TO ASC-BLK-SUB                     25450000
255000                                  PV-BLOCK-NUMBER                 25460000
255100             PERFORM 4410-READ-TEMP-STORAGE                       25470000
255200         END-IF                                                   25480000
255300     END-IF.                                                      25490000
255400 EJECT                                                            25500000
255500*----------------------------------------------------------------*25510000
255600*    FETCH THE MESSAGE CURSOR.                                   *25520000
255700*----------------------------------------------------------------*25530000
255800                                                                  25540000
255900 4310-FETCH.                                                      25550000
256000                                                                  25560000
256100     MOVE  ZEROES  TO  CEPLDS-ACTL-DISTRB-QTY.                    25570000
256200                                                                  25580000
256300     EXEC SQL                                                     25590000
256400          FETCH LINE-ITEM-DSTR-CSR                                25600000
256500           INTO  :CEPLDS-CNSTK-REQ-PL-NBR                         25610000
256600               , :CEPLDS-PL-LNE-NBR                               25620000
256700               , :CEPLDS-STR-NBR                                  25630000
256800               , :CEPLDS-REQ-ORD-QTY                              25640000
256900               , :CEPLDS-ACTL-DISTRB-QTY :PV-NULL-IND-1           25650000
257000     END-EXEC.                                                    25660000
257100                                                                  25670000
257200     EVALUATE TRUE                                                25680000
257300         WHEN SQLCODE = ZERO                                      25690000
257400              MOVE CEPLDS-STR-NBR TO ASC-STORE-NBR                25700000
257500                                                                  25710000
257600              IF  PV-NULL-IND-1 < +0                              25720000
257700                  MOVE SPACES  TO  PV-DISPLAY-ACTL-DISTRB-QTY     25730000
257800              ELSE                                                25740000
257900                  MOVE CEPLDS-ACTL-DISTRB-QTY                     25750000
258000                    TO PV-NUMERIC-ACTL-DISTRB-QTY                 25760000
258100                  MOVE PV-NUMERIC-ACTL-DISTRB-QTY                 25770000
258200                    TO PV-DISPLAY-ACTL-DISTRB-QTY                 25780000
258300              END-IF                                              25790000
258400                                                                  25800000
258500         WHEN SQLCODE = +100                                      25810000
258600              MOVE SPACES  TO  PV-DISPLAY-ACTL-DISTRB-QTY         25820000
258700                                                                  25830000
258800         WHEN SQLWARN0 NOT = SPACE                                25840000
258900         WHEN SQLCODE NOT = ZERO                                  25850000
259000              MOVE '4310-FETCH-CURSOR'                            25860000
259100                               TO DP013-PARAGRAPH                 25870000
259200              MOVE 'FETCH CENTRAL STOCK DISTRIBUTION CURSOR'      25880000
259300                               TO DP013-MESSAGE-TEXT (1)          25890000
259400              MOVE SQLCA       TO DP013-SQLCA                     25900000
259500              SET DP013-DB2-ABEND                                 25910000
259600                               TO TRUE                            25920000
259700              PERFORM DP013-0000-PROCESS-ABEND                    25930000
259800     END-EVALUATE.                                                25940000
259900                                                                  25950000
260000     IF  SQLCODE EQUAL +100                                       25960000
260100         SET ASC-NO-ITEMS-LEFT-ON-DB                              25970000
260200                                   TO TRUE                        25980000
260300     END-IF.                                                      25990000
260400                                                                  26000000
260500                                                                  26010000
260600*----------------------------------------------------------------*26020000
260700* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *26030000
260800*----------------------------------------------------------------*26040000
260900                                                                  26050000
261000 4400-MOVE-COMMAREA-TO-SCREEN.                                    26060000
261100     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             26070000
261200         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          26080000
261300         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          26090000
261400             MOVE +1    TO ASC-BLK-SUB                            26100000
261500             PERFORM 5100-WRITE-TEMP-STORAGE                      26110000
261600             ADD +1     TO ASC-BLK-SUB                            26120000
261700             PERFORM 5100-WRITE-TEMP-STORAGE                      26130000
261800             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             26140000
261900                 GIVING PV-BLOCK-NUMBER                           26150000
262000                 REMAINDER PV-REMAINDER                           26160000
262100             IF  PV-REMAINDER > ZERO                              26170000
262200                 ADD +1 TO PV-BLOCK-NUMBER                        26180000
262300             END-IF                                               26190000
262400             MOVE +1    TO ASC-BLK-SUB                            26200000
262500             PERFORM 4410-READ-TEMP-STORAGE                       26210000
262600             ADD +1     TO ASC-BLK-SUB                            26220000
262700                           PV-BLOCK-NUMBER                        26230000
262800             PERFORM 4410-READ-TEMP-STORAGE                       26240000
262900     END-IF.                                                      26250000
263000     MOVE +1            TO ASC-BLK-SUB.                           26260000
263100     COMPUTE ASC-ITEM-SUB =                                       26270000
263200         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              26280000
263300         + PC-ITEMS-PER-PANEL).                                   26290000
263400*                                                                 26300000
263500     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        26310000
263600         ADD +1         TO ASC-BLK-SUB                            26320000
263700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            26330000
263800     END-IF.                                                      26340000
263900*                                                                 26350000
264000     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           26360000
264100         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                26370000
264200     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        26380000
264300     PERFORM 4420-FORMAT-LIST-LINES                               26390000
264400         VARYING PV-SUB                                           26400000
264500         FROM PC-ITEMS-PER-PANEL BY -1                            26410000
264600         UNTIL PV-SUB < +1.                                       26420000
264700*                                                                 26430000
264800     COMPUTE ASC-ITEMS-DISPLAYED =                                26440000
264900         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          26450000
265000     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    26460000
265100                                      ASTRTITO.                   26470000
265200     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    26480000
265300     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    26490000
265400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            26500000
265500                                   TO ASELITO.                    26510000
265600                                                                  26520000
265700     MOVE ASC-CS-LOC-N               TO PV-4-DIGIT-STORE.         26530000
265800     MOVE PV-4-DIGIT-STORE           TO ALOCIDO.                  26540000
265900     MOVE ASC-PULL-NBR-N             TO APULNOO                   26550000
266000                                        DK-PULL-NUMBER.           26560000
266400     MOVE ASC-SKU-NUMBER             TO PV-SKU-NUMBER.            26570000
266600     MOVE PV-SKU-NUMBER              TO ASKUO.                    26580000
266800     MOVE ASC-LINE-ITEM              TO ALNENOO                   26590000
266900                                        DK-LINE-NUMBER.           26600000
267000     MOVE ASC-LINE-SKU-RETAIL        TO ASKRETO.                  26610000
267100                                                                  26620000
267200     PERFORM 4500-GET-PULL-ITEM                                   26630000
267300     PERFORM 4510-GET-PULL-DISTRO                                 26640000
267400     PERFORM 4515-GET-PULL-POSTED                                 26650000
267500                                                                  26660000
267600     EVALUATE TRUE                                                26670000
267700         WHEN ASC-LINE-STATUS-POSTED                              26680000
267800              IF  PV-TOTAL-POSTED-QTY  =  ZERO                    26690000
267900                  MOVE  PV-CEPLDS-DISTRB-QTY                      26700000
268000                    TO  PV-TOTAL-POSTED-QTY                       26710000
268010              END-IF                                              26720000
268020     END-EVALUATE.                                                26730000
268030                                                                  26740000
268040*LMM                                                              26750000
268050     MOVE ASC-TOT-MANIFEST-UNTS      TO AMFUNTO.                  26760000
268051                                                                  26770000
268052     IF  ASC-TOT-ADJUST-CNT  >  0  AND                            26780000
268053         ASC-TOT-ADJUST-UNTS =  0                                 26790000
268054         MOVE  ASC-TOT-ADJUST-UNTS  TO  PV-ZERO-ADJ-UNIT          26800000
268055         MOVE  PV-ZERO-ADJ-UNIT     TO  AADJUNTO                  26801000
268057     ELSE                                                         26802000
268058         MOVE  ASC-TOT-ADJUST-UNTS  TO  PV-NUMERIC-ADJ-UNITS      26803000
268059         MOVE  PV-NUMERIC-ADJ-UNITS TO  AADJUNTO                  26804000
268062     END-IF.                                                      26805000
268063                                                                  26806000
268080     MOVE PV-CEPLIT-REQ-QTY          TO ARQUNTO.                  26807000
268100     MOVE  PV-TOTAL-POSTED-QTY       TO APOSTDO.                  26808000
268200     MOVE PV-CEPLDS-DISTRB-QTY       TO ADSUNTO.                  26809000
268300                                                                  26810000
268400     MULTIPLY  ASC-LINE-SKU-RETAIL                                26820000
268500           BY  PV-CEPLDS-DISTRB-QTY                               26830000
268600       GIVING PV-DISTRB-RETAIL.                                   26840000
268700                                                                  26850000
268800*LMM IF  ASC-PULL-DISTRIBUTED OR                                  26860000
268900*        ASC-PULL-POSTED                                          26870000
269000         MOVE PV-DISTRB-RETAIL       TO ADSRTLO                   26880000
269100*    ELSE                                                         26890000
269200*        MOVE ZEROES                 TO ADSRTLO                   26900000
269300*    END-IF.                                                      26910000
269400                                                                  26920000
269500     MOVE ASC-REF-NBR                TO AREFNOO.                  26930000
269600                                                                  26940000
269700     EVALUATE TRUE                                                26950000
269800         WHEN ASC-PULL-CANCELLED                                  26960000
269900              MOVE PC-PULL-STATUS-CANCELLED TO APULSTO            26970000
270000         WHEN ASC-PULL-DISTRIBUTED                                26980000
270100              MOVE PC-DISTRIB-DESC          TO APULSTO            26990000
270200         WHEN ASC-PULL-IN-PROCESS                                 27000000
270300              MOVE PC-IN-PROCESS-DESC       TO APULSTO            27010000
270400         WHEN ASC-PULL-NEW                                        27020000
270500              MOVE PC-NEW-DESC              TO APULSTO            27030000
270600         WHEN ASC-PULL-POSTED                                     27040000
270700              MOVE PC-POSTED-DESC           TO APULSTO            27050000
270800         WHEN OTHER                                               27060000
270900              MOVE PC-UNKNOWN-DESC          TO APULSTO            27070000
271000     END-EVALUATE.                                                27080000
271100                                                                  27090000
271200     EVALUATE TRUE                                                27100000
271300         WHEN ASC-LINE-STATUS-CANCELLED                           27110000
271400              MOVE PC-PULL-STATUS-CANCELLED TO ALNESTO            27120000
271500         WHEN ASC-LINE-STATUS-DISTRIBTD                           27130000
271600              MOVE PC-DISTRIB-DESC          TO ALNESTO            27140000
271700         WHEN ASC-LINE-STATUS-INPROCESS                           27150000
271800              MOVE PC-IN-PROCESS-DESC       TO ALNESTO            27160000
271900         WHEN ASC-LINE-STATUS-NEW                                 27170000
272000              MOVE PC-NEW-DESC              TO ALNESTO            27180000
272100         WHEN  ASC-LINE-STATUS-POSTED                             27190000
272200              MOVE PC-POSTED-DESC           TO ALNESTO            27200000
272300         WHEN OTHER                                               27210000
272400              MOVE PC-UNKNOWN-DESC          TO ALNESTO            27220000
272500     END-EVALUATE.                                                27230000
272600                                                                  27240000
272700*                                                                 27250000
272800     IF  DP020-MSG-NUMBER-X = SPACE                               27260000
272900         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  27270000
273000*            --- MORE ITEMS TO DISPLAY ----                       27280000
273100             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            27290000
273200             SET DP020-MSG-INFORMATIONAL TO TRUE                  27300000
273300         END-IF                                                   27310000
273400     END-IF.                                                      27320000
273500*----------------------------------------------------------------*27330000
273600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *27340000
273700*----------------------------------------------------------------*27350000
273800                                                                  27360000
273900 4410-READ-TEMP-STORAGE.                                          27370000
274000                                                                  27380000
274100     EXEC CICS                                                    27390000
274200         READQ TS                                                 27400000
274300             QUEUE (ASC-LIST-QUEUE-NAME)                          27410000
274400             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               27420000
274500             ITEM  (PV-BLOCK-NUMBER)                              27430000
274600             RESP  (PV-CICS-RESP)                                 27440000
274700     END-EXEC.                                                    27450000
274800                                                                  27460000
274900     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       27470000
275000       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     27480000
275100         CONTINUE                                                 27490000
275200     ELSE                                                         27500000
275300         SET DP013-CICS-ABEND     TO TRUE                         27510000
275400         SET DP013-NO-ROLLBACK    TO TRUE                         27520000
275500         MOVE '4410-READ-TEMP-STORAGE'                            27530000
275600                                  TO DP013-PARAGRAPH              27540000
275700         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      27550000
275800                                  TO DP013-MESSAGE-TEXT(1)        27560000
275900         PERFORM DP013-0000-PROCESS-ABEND                         27570000
276000     END-IF.                                                      27580000
276100                                                                  27590000
276200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             27600000
276300*                                                                 27610000
276400     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         27620000
276500         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               27630000
276600     END-IF.                                                      27640000
276700 EJECT                                                            27650000
276800*----------------------------------------------------------------*27660000
276900*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *27670000
277000*----------------------------------------------------------------*27680000
277100                                                                  27690000
277200 4420-FORMAT-LIST-LINES.                                          27700000
277300     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      27710000
277400         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                27720000
277500         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           27730000
277600                                    MR-UPD-UNITSA (PV-SUB)        27740000
277700                                    MR-DISTRBUTED-UNITSA (PV-SUB) 27750000
277800         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           27760000
277900                                    MR-UPD-UNITSH (PV-SUB)        27770000
278000*LMM                                                              27780000
278100         MOVE SPACE              TO MR-SELECTI (PV-SUB)           27790000
278200                                    MR-ACTION (PV-SUB)            27800000
278210                                    MR-POSTED-UNITS (PV-SUB)      27810000
278220                                    MR-ADJUST-UNITS (PV-SUB)      27820000
278300                                                                  27830000
278400         MOVE ZEROES             TO MR-UPD-UNITS (PV-SUB)         27840000
278500                                    MR-STORE-NUMBER (PV-SUB)      27850000
278600                                    MR-REQ-UNITS (PV-SUB)         27860000
278700                                    MR-DISTRBUTED-UNITS (PV-SUB)  27870000
278800                                    MR-MANIFEST-UNITS (PV-SUB)    27880000
279000     ELSE                                                         27890000
279100         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      27900000
279200                                                   > SPACE        27910000
279300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 27920000
279400                                 TO MR-SELECTI (PV-SUB)           27930000
279500         ELSE                                                     27940000
279600             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      27950000
279700                                 TO MR-SELECTI (PV-SUB)           27960000
279800         END-IF                                                   27970000
279900*                                                                 27980000
280000         IF  DP030-SET-CURSOR-TRAILER                             27990000
280100             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)28000000
280200                 > SPACE)                                         28010000
280300               OR (PV-SUB = 1))                                   28020000
280400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               28030000
280500                MOVE -1          TO MR-SELECTL (PV-SUB)           28040000
280600             END-IF                                               28050000
280700         END-IF                                                   28060000
280800*                                                                 28070000
280900         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               28080000
281000                                 TO MR-ACTION (PV-SUB)            28090000
281100         MOVE ASC-STORE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)         28100000
281200                                 TO MR-STORE-NUMBER (PV-SUB)      28110000
281300         MOVE ASC-REQ-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)            28120000
281400                                 TO MR-REQ-UNITS (PV-SUB)         28130000
281500         MOVE ASC-DISTRB-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)         28140000
281600                                 TO MR-DISTRBUTED-UNITS (PV-SUB)  28150000
281700*LMM                                                              28160000
281800         MOVE ASC-MANIFEST-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)       28170000
281900                                 TO MR-MANIFEST-UNITS (PV-SUB)    28180000
282000         MOVE ASC-ADJUST-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)         28190000
282100                                 TO MR-ADJUST-UNITS (PV-SUB)      28200000
282200         MOVE ASC-STR-POSTED-UNITS(ASC-BLK-SUB ASC-ITEM-SUB)      28210000
282300                                 TO MR-POSTED-UNITS (PV-SUB)      28220000
282400                                                                  28230000
282500                                                                  28240000
282600         IF  ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB)          28250000
282700             MOVE ASC-UPD-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)        28260000
282800                                   TO PV-DISPLAY-ZERO             28270000
282900             MOVE PV-DISPLAY-ZERO  TO MR-UPD-UNITS (PV-SUB)       28280000
283000             MOVE DP015-UNP-ALP-NOR-MDT                           28290000
283100                                   TO MR-UPD-UNITSA (PV-SUB)      28300000
283200         ELSE                                                     28310000
283300             MOVE ASC-UPD-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)        28320000
283400                                   TO PV-DISPLAY-NO-ZERO          28330000
283500             MOVE PV-DISPLAY-NO-ZERO                              28340000
283600                                   TO MR-UPD-UNITS (PV-SUB)       28350000
283700         END-IF                                                   28360000
283800                                                                  28370000
283900         EVALUATE TRUE                                            28380000
284000             WHEN ASC-LINE-STATUS-POSTED                          28390000
284100             WHEN ASC-LINE-STATUS-CANCELLED                       28400000
284200                  MOVE DP015-ASK-DRK-OFF                          28410000
284300                                 TO MR-UPD-UNITSA (PV-SUB)        28420000
284400                  MOVE DP015-HL-OFF                               28430000
284500                                 TO MR-UPD-UNITSH (PV-SUB)        28440000
284600                  MOVE ZEROES                                     28450000
284700                                 TO MR-UPD-UNITS (PV-SUB)         28460000
284800         END-EVALUATE                                             28470000
284900     END-IF.                                                      28480000
285000     SUBTRACT +1 FROM ASC-ITEM-SUB                                28490000
285100     IF  ASC-ITEM-SUB < + 1                                       28500000
285200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  28510000
285300         MOVE +1                 TO ASC-BLK-SUB                   28520000
285400     END-IF.                                                      28530000
285500******************************************************************28540000
285600** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **28550000
285700** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **28560000
285800** ISSUE A WARNING.                                             **28570000
285900******************************************************************28580000
286000 4430-CHECK-FOR-BEGIN-AND-END.                                    28590000
286100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       28600000
286200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     28610000
286300*            -- NO END-OF-RANGE SPECFIED ---                      28620000
286400             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            28630000
286500             SET DP020-MSG-WARNING TO TRUE                        28640000
286600             PERFORM 4431-POSITION-AT-WARNING                     28650000
286700         END-IF                                                   28660000
286800     ELSE                                                         28670000
286900         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     28680000
287000*            -- NO BEGINNING-OF-RANGE SPECFIED ---                28690000
287100             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            28700000
287200             SET DP020-MSG-WARNING TO TRUE                        28710000
287300             PERFORM 4431-POSITION-AT-WARNING                     28720000
287400         END-IF                                                   28730000
287500     END-IF.                                                      28740000
287600******************************************************************28750000
287700** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **28760000
287800** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **28770000
287900** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **28780000
288000** POSITION THE CURSOR THERE.                                   **28790000
288100******************************************************************28800000
288200 4431-POSITION-AT-WARNING.                                        28810000
288300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 28820000
288400                    - PV-TOP-ITEM + 1.                            28830000
288500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      28840000
288600         CONTINUE                                                 28850000
288700     ELSE                                                         28860000
288800         SET DP030-SET-CURSOR-APPL-1                              28870000
288900                                   TO TRUE                        28880000
289000         MOVE -1                   TO MR-SELECTL (PV-SUB)         28890000
289100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         28900000
289200         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         28910000
289300     END-IF.                                                      28920000
289400*                                                                 28930000
289500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   28940000
289600                    - PV-TOP-ITEM + 1.                            28950000
289700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      28960000
289800         CONTINUE                                                 28970000
289900     ELSE                                                         28980000
290000         SET DP030-SET-CURSOR-APPL-1                              28990000
290100                                   TO TRUE                        29000000
290200         MOVE -1                   TO MR-SELECTL (PV-SUB)         29010000
290300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         29020000
290400         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         29030000
290500     END-IF.                                                      29040000
290600                                                                  29050000
290700                                                                  29060000
290800*----------------------------------------------------------------*29070000
290900* GET PULL ITEM QTYS                                             *29080000
291000*----------------------------------------------------------------*29090000
291100 4500-GET-PULL-ITEM.                                              29100000
291200                                                                  29110000
291300     INITIALIZE  PV-CEPLIT-ITEM-QTY                               29120000
291400                 PV-CEPLIT-REQ-QTY                                29130000
291500                 PV-CEPLIT-ACTL-QTY.                              29140000
291600                                                                  29150000
291700     EXEC SQL                                                     29160000
291800         SELECT  COUNT(*)                                         29170000
291900                ,SUM(PL_REQ_QTY)                                  29180000
292000                ,SUM(ACTL_PL_QTY)                                 29190000
292100           INTO  :PV-CEPLIT-ITEM-QTY                              29200000
292200                ,:PV-CEPLIT-REQ-QTY  :PV-NULL-IND-1               29210000
292300                ,:PV-CEPLIT-ACTL-QTY :PV-NULL-IND-2               29220000
292400           FROM  TCEPLIT                                          29230000
292500          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             29240000
292600            AND  PL_LNE_NBR        =  :DK-LINE-NUMBER             29250000
292700            AND  STAT_CDE         IN  ('NW', 'IP', 'DS', 'PD')    29260000
292800     END-EXEC                                                     29270000
292900                                                                  29280000
293000     EVALUATE TRUE                                                29290000
293100         WHEN SQLCODE = +0                                        29300000
293200              CONTINUE                                            29310000
293300         WHEN SQLCODE = -904                                      29320000
293400         WHEN SQLCODE = -911                                      29330000
293500         WHEN SQLCODE = -913                                      29340000
293600             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    29350000
293700             MOVE '4500-GET-PULL-ITEM  '    TO PV-SOFT-PARAGRAPH  29360000
293800             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  29370000
293900             MOVE LENGTH OF PV-CICS-MSG-AREA2                     29380000
294000               TO PV-COMMAREA-LENGTH                              29390000
294100             EXEC CICS                                            29400000
294200                  WRITEQ TD                                       29410000
294300                   QUEUE  ('CSSL')                                29420000
294400                    FROM  (PV-CICS-MSG-AREA2)                     29430000
294500                  LENGTH  (PV-COMMAREA-LENGTH)                    29440000
294600                    RESP  (PV-CICS-RESP)                          29450000
294700             END-EXEC                                             29460000
294800             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          29470000
294900             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              29480000
295000             PERFORM 9900-SOFT-ABORT                              29490000
295100         WHEN OTHER                                               29500000
295200              MOVE '4500-GET-PULL-ITEM'                           29510000
295300                               TO DP013-PARAGRAPH                 29520000
295400              MOVE 'GET PULL STATUS ITEM QTYS'                    29530000
295500                               TO DP013-MESSAGE-TEXT (1)          29540000
295600              MOVE SQLCA       TO DP013-SQLCA                     29550000
295700              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        29560000
295800              SET DP013-DB2-ABEND                                 29570000
295900                  DP013-XCTL-DISPLAY-RESTART                      29580000
296000                                   TO TRUE                        29590000
296100                  PERFORM DP013-0000-PROCESS-ABEND                29600000
296200     END-EVALUATE.                                                29610000
296300                                                                  29620000
296400                                                                  29630000
296500*----------------------------------------------------------------*29640000
296600* GET PULL DISTRIBUTION QTY                                      *29650000
296700*----------------------------------------------------------------*29660000
296800 4510-GET-PULL-DISTRO.                                            29670000
296900                                                                  29680000
297000     INITIALIZE  PV-CEPLDS-DISTRB-QTY.                            29690000
297100                                                                  29700000
297200     EXEC SQL                                                     29710000
297300          SELECT  SUM(B.ACTL_DISTRB_QTY)                          29720000
297400            INTO  :PV-CEPLDS-DISTRB-QTY :PV-NULL-IND-1            29730000
297500            FROM  TCEPLIT A                                       29740000
297600                 ,TCEPLDS B                                       29750000
297700           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           29760000
297800             AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER           29770000
297900             AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR        29780000
298000             AND  A.PL_LNE_NBR       =  B.PL_LNE_NBR              29790000
298100*LMM         AND  A.STAT_CDE   IN  ('DS','PD')                    29800000
298200     END-EXEC                                                     29810000
298300                                                                  29820000
298400                                                                  29830000
298500     EVALUATE TRUE                                                29840000
298600         WHEN SQLCODE = +0                                        29850000
298700              CONTINUE                                            29860000
298800         WHEN SQLCODE = -904                                      29870000
298900         WHEN SQLCODE = -911                                      29880000
299000         WHEN SQLCODE = -913                                      29890000
299100             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    29900000
299200             MOVE '4510-GET-PULL-DISTRO'    TO PV-SOFT-PARAGRAPH  29910000
299300             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  29920000
299400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     29930000
299500               TO PV-COMMAREA-LENGTH                              29940000
299600             EXEC CICS                                            29950000
299700                  WRITEQ TD                                       29960000
299800                   QUEUE  ('CSSL')                                29970000
299900                    FROM  (PV-CICS-MSG-AREA2)                     29980000
300000                  LENGTH  (PV-COMMAREA-LENGTH)                    29990000
300100                    RESP  (PV-CICS-RESP)                          30000000
300200             END-EXEC                                             30010000
300300             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          30020000
300400             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              30030000
300500             PERFORM 9900-SOFT-ABORT                              30040000
300600         WHEN OTHER                                               30050000
300700              MOVE '4510-GET-PULL-DISTRO'                         30060000
300800                               TO DP013-PARAGRAPH                 30070000
300900              MOVE 'GET PULL DISTRIBTION     '                    30080000
301000                               TO DP013-MESSAGE-TEXT (1)          30090000
301100              MOVE SQLCA       TO DP013-SQLCA                     30100000
301200              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        30110000
301300              MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (2)        30120000
301400              SET DP013-DB2-ABEND                                 30130000
301500                  DP013-XCTL-DISPLAY-RESTART                      30140000
301600                                   TO TRUE                        30150000
301700                  PERFORM DP013-0000-PROCESS-ABEND                30160000
301800     END-EVALUATE.                                                30170000
301900                                                                  30180000
302000                                                                  30190000
302100*----------------------------------------------------------------*30200000
302200* GET PULL POSTED UNITS                                          *30210000
302300*----------------------------------------------------------------*30220000
302400 4515-GET-PULL-POSTED.                                            30230000
302410                                                                  30240000
302420     INITIALIZE  PV-CEPLMF-POSTED-QTY                             30241000
302430                 PV-CEPLAU-POSTED-QTY                             30242000
302440                 PV-TOTAL-POSTED-QTY.                             30243000
302450                                                                  30244000
302460     PERFORM 4516-GET-PULL-POSTED-TCEPLMF.                        30245000
302470     PERFORM 4517-GET-PULL-POSTED-TCEPLAU.                        30246000
302480                                                                  30247000
302490     ADD  PV-CEPLMF-POSTED-QTY                                    30248000
302500          PV-CEPLAU-POSTED-QTY                                    30249000
302510          GIVING  PV-TOTAL-POSTED-QTY.                            30250000
302520                                                                  30251000
302530                                                                  30252000
302540*----------------------------------------------------------------*30253000
302541* GET PULL POSTED UNITS - TCEPLMF                                *30254000
302542*----------------------------------------------------------------*30254100
302543 4516-GET-PULL-POSTED-TCEPLMF.                                    30254200
302544                                                                  30254300
302545     INITIALIZE  PV-CEPLMF-POSTED-QTY.                            30254400
302546                                                                  30254500
302547     EXEC SQL                                                     30254600
302548          SELECT  COALESCE(SUM(C.MFST_UNT_QTY),0)                 30254700
302549            INTO  :PV-CEPLMF-POSTED-QTY                           30254800
302550            FROM  TCEPLRQ A                                       30254900
302551                 ,TCEPLIT B                                       30255000
302552                 ,TCEPLMF C                                       30255100
302553           WHERE  A.CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER            30255200
302554             AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR        30255300
302555             AND  B.PL_LNE_NBR       = :DK-LINE-NUMBER            30255400
302556             AND  B.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR        30255500
302557             AND  C.PL_LNE_NBR       =  B.PL_LNE_NBR              30255600
302558             AND  NOT C.EXPRT_PRC_BTCH_ID = ' '                   30255700
302559     END-EXEC                                                     30255800
302560                                                                  30255900
302561     EVALUATE TRUE                                                30256000
302570         WHEN SQLCODE = +0                                        30257000
302580              CONTINUE                                            30258000
302590         WHEN SQLCODE = -904                                      30259000
302591         WHEN SQLCODE = -911                                      30259100
302592         WHEN SQLCODE = -913                                      30259200
302593             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    30259300
302594             MOVE '4516-GET-PULL-POSTED- '  TO PV-SOFT-PARAGRAPH  30259400
302595             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  30259500
302596             MOVE LENGTH OF PV-CICS-MSG-AREA2                     30259600
302597               TO PV-COMMAREA-LENGTH                              30259700
302598             EXEC CICS                                            30259800
302599                  WRITEQ TD                                       30259900
302600                   QUEUE  ('CSSL')                                30260000
302601                    FROM  (PV-CICS-MSG-AREA2)                     30260100
302602                  LENGTH  (PV-COMMAREA-LENGTH)                    30260200
302603                    RESP  (PV-CICS-RESP)                          30260300
302604             END-EXEC                                             30260400
302605             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          30260500
302606             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              30260600
302607             PERFORM 9900-SOFT-ABORT                              30260700
302608         WHEN OTHER                                               30260800
302609              MOVE '4516-GET-PULL-POSTED-TCEPLMF'                 30260900
302610                               TO DP013-PARAGRAPH                 30261000
302611              MOVE 'GET POSTED UNITS         '                    30261100
302612                               TO DP013-MESSAGE-TEXT (1)          30261200
302613              MOVE SQLCA       TO DP013-SQLCA                     30261300
302614              MOVE 'TCEPLRQ '  TO DP013-DB2-TABLE-NAME (1)        30261400
302615              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (2)        30261500
302616              MOVE 'TCEPLMF '  TO DP013-DB2-TABLE-NAME (3)        30261600
302617              SET DP013-DB2-ABEND                                 30261700
302618                  DP013-XCTL-DISPLAY-RESTART                      30261800
302619                                   TO TRUE                        30261900
302620                  PERFORM DP013-0000-PROCESS-ABEND                30262000
302621     END-EVALUATE.                                                30262100
302622                                                                  30262200
302623                                                                  30262300
302624*----------------------------------------------------------------*30262400
302625* GET PULL POSTED UNITS - TCEPLAU                                *30262500
302626*----------------------------------------------------------------*30262600
302627 4517-GET-PULL-POSTED-TCEPLAU.                                    30262700
302628                                                                  30262800
302629     INITIALIZE  PV-CEPLAU-POSTED-QTY.                            30262900
302630                                                                  30263000
302631     EXEC SQL                                                     30263100
302632          SELECT  COALESCE(SUM(C.AFT_ADJ_UNT_QTY                  30263200
302633                             - C.BEF_ADJ_UNT_QTY),0)              30263300
302634            INTO  :PV-CEPLAU-POSTED-QTY                           30263400
302635            FROM  TCEPLRQ A                                       30263500
302636                 ,TCEPLIT B                                       30263600
302637                 ,TCEPLAU C                                       30263700
302638           WHERE  A.CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER            30263800
302639             AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR        30263900
302640             AND  B.PL_LNE_NBR       = :DK-LINE-NUMBER            30264000
302641             AND  B.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR        30264100
302642             AND  C.PL_LNE_NBR       =  B.PL_LNE_NBR              30264200
302643             AND  NOT C.EXPRT_PRC_BTCH_ID = ' '                   30264300
302644     END-EXEC                                                     30264400
302645                                                                  30264500
302646     EVALUATE TRUE                                                30264600
302647         WHEN SQLCODE = +0                                        30264700
302648              CONTINUE                                            30264800
302649         WHEN SQLCODE = -904                                      30264900
302650         WHEN SQLCODE = -911                                      30265000
302651         WHEN SQLCODE = -913                                      30265100
302660             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    30265200
302661             MOVE '4517-GET-PULL-POSTED- '  TO PV-SOFT-PARAGRAPH  30265300
302662             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  30265400
302663             MOVE LENGTH OF PV-CICS-MSG-AREA2                     30265500
302664               TO PV-COMMAREA-LENGTH                              30265600
302665             EXEC CICS                                            30265700
302666                  WRITEQ TD                                       30265800
302667                   QUEUE  ('CSSL')                                30265900
302668                    FROM  (PV-CICS-MSG-AREA2)                     30266000
302669                  LENGTH  (PV-COMMAREA-LENGTH)                    30266100
302670                    RESP  (PV-CICS-RESP)                          30266200
302671             END-EXEC                                             30266300
302672             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          30266400
302673             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              30266500
302674             PERFORM 9900-SOFT-ABORT                              30266600
302675         WHEN OTHER                                               30266700
302676              MOVE '4517-GET-PULL-POSTED-TCEPLAU'                 30266800
302677                               TO DP013-PARAGRAPH                 30266900
302678              MOVE 'GET POSTED UNITS         '                    30267000
302679                               TO DP013-MESSAGE-TEXT (1)          30267100
302680              MOVE SQLCA       TO DP013-SQLCA                     30267200
302681              MOVE 'TCEPLRQ '  TO DP013-DB2-TABLE-NAME (1)        30267300
302682              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (2)        30267400
302683              MOVE 'TCEPLAU '  TO DP013-DB2-TABLE-NAME (3)        30267500
302684              SET DP013-DB2-ABEND                                 30267600
302685                  DP013-XCTL-DISPLAY-RESTART                      30267700
302686                                   TO TRUE                        30267800
302687                  PERFORM DP013-0000-PROCESS-ABEND                30267900
302688     END-EVALUATE.                                                30268000
302689                                                                  30268100
302690                                                                  30268200
302691*LMM                                                              30268300
302692*----------------------------------------------------------------*30268400
302693*                                                                *30268500
302694*----------------------------------------------------------------*30268600
302695 4520-GET-MANIFEST-UNITS.                                         30268700
302696     INITIALIZE  PV-MANIFEST-UNITS.                               30268800
302697                                                                  30268900
302698     EXEC SQL                                                     30269000
302699        SELECT  SUM(MFST_UNT_QTY)                                 30269100
302700          INTO :PV-MANIFEST-UNITS :PV-NULL-IND-3                  30269200
302800          FROM  TCEPLMF A                                         30269300
302900             ,  TCEPLRQ B                                         30269400
303000        WHERE   A.CNSTK_REQ_PL_NBR = B.CNSTK_REQ_PL_NBR           30269500
303100          AND   A.CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER              30269600
303200          AND   A.PL_LNE_NBR       = :DK-LINE-NUMBER              30269700
303300          AND   B.CNSTK_LOC_ID     = :DK-LOC-ID                   30269800
303400          AND   B.SRC_REF_NBR      = :DK-REF-NUMBER               30269900
303500          AND   A.STR_NBR          = :DK-STORE-NUMBER             30270000
303600     END-EXEC                                                     30280000
303700                                                                  30290000
303800     EVALUATE TRUE                                                30300000
303900         WHEN SQLCODE = ZERO                                      30310000
304000              CONTINUE                                            30320000
304100         WHEN SQLCODE = -904                                      30330000
304200         WHEN SQLCODE = -911                                      30340000
304300         WHEN SQLCODE = -913                                      30350000
304400             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    30360000
304500             MOVE '4520-GET-MANIFEST-UNITS' TO PV-SOFT-PARAGRAPH  30370000
304600             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  30380000
304700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     30390000
304800               TO PV-COMMAREA-LENGTH                              30400000
304900             EXEC CICS                                            30410000
305000                  WRITEQ TD                                       30420000
305100                   QUEUE  ('CSSL')                                30430000
305200                    FROM  (PV-CICS-MSG-AREA2)                     30440000
305300                  LENGTH  (PV-COMMAREA-LENGTH)                    30450000
305400                    RESP  (PV-CICS-RESP)                          30460000
305500             END-EXEC                                             30470000
305600             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          30480000
305700             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              30490000
305800             PERFORM 9900-SOFT-ABORT                              30500000
305900         WHEN OTHER                                               30510000
306000              MOVE '4520-GET-MANIFEST-UNITS '                     30520000
306100                               TO DP013-PARAGRAPH                 30530000
306200              MOVE 'GET MANIFEST UNITS '                          30540000
306300                               TO DP013-MESSAGE-TEXT (1)          30550000
306400              MOVE SQLCA       TO DP013-SQLCA                     30560000
306500              MOVE 'TCEPLMF '  TO DP013-DB2-TABLE-NAME (1)        30570000
306600              SET DP013-DB2-ABEND                                 30580000
306700                  DP013-XCTL-DISPLAY-RESTART                      30590000
306800                                   TO TRUE                        30600000
306900                  PERFORM DP013-0000-PROCESS-ABEND                30610000
307000     END-EVALUATE.                                                30620000
307100*                                                                 30630000
307200*                                                                 30640000
307300*LMM                                                              30650000
307400 4530-GET-ADJUST-UNITS.                                           30660000
307500     INITIALIZE PV-ADJUST-UNITS                                   30670000
307600                PV-BEFORE-ADJUST                                  30680000
307700                PV-AFTER-ADJUST.                                  30690000
307800                                                                  30700000
307900     EXEC SQL                                                     30710000
308000        SELECT COUNT(*)                                           30720000
308010              ,SUM(A.AFT_ADJ_UNT_QTY - A.BEF_ADJ_UNT_QTY)         30730000
308100          INTO :PV-ADJUSTMENT-CNT                                 30740000
308110              ,:PV-ADJUST-UNITS :PV-NULL-IND-1                    30750000
308200          FROM  TCEPLAU A                                         30760000
308300         WHERE A.CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER               30770000
308400           AND A.PL_LNE_NBR       = :DK-LINE-NUMBER               30780000
308500           AND A.STR_NBR          = :DK-STORE-NUMBER              30790000
308600     END-EXEC                                                     30800000
308700                                                                  30810000
308800     EVALUATE TRUE                                                30820000
308900         WHEN SQLCODE = +0                                        30830000
309000              CONTINUE                                            30840000
309100         WHEN SQLCODE = -904                                      30850000
309200         WHEN SQLCODE = -911                                      30860000
309300         WHEN SQLCODE = -913                                      30870000
309400             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    30880000
309500             MOVE '4530-GET-ADJUST-UNITS '  TO PV-SOFT-PARAGRAPH  30890000
309600             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  30900000
309700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     30910000
309800               TO PV-COMMAREA-LENGTH                              30920000
309900             EXEC CICS                                            30930000
310000                  WRITEQ TD                                       30940000
310100                   QUEUE  ('CSSL')                                30950000
310200                    FROM  (PV-CICS-MSG-AREA2)                     30960000
310300                  LENGTH  (PV-COMMAREA-LENGTH)                    30970000
310400                    RESP  (PV-CICS-RESP)                          30980000
310500             END-EXEC                                             30990000
310600             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          31000000
310700             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              31010000
310800             PERFORM 9900-SOFT-ABORT                              31020000
310900         WHEN OTHER                                               31030000
311000              MOVE '4530-GET-ADJUST-UNITS '                       31040000
311100                               TO DP013-PARAGRAPH                 31050000
311200              MOVE 'GET ADJUSTED PULL UNIT QTY '                  31060000
311300                               TO DP013-MESSAGE-TEXT (1)          31070000
311400              MOVE SQLCA       TO DP013-SQLCA                     31080000
311500              MOVE 'TCEPLAU '  TO DP013-DB2-TABLE-NAME (1)        31090000
311600              SET DP013-DB2-ABEND                                 31100000
311700                  DP013-XCTL-DISPLAY-RESTART                      31110000
311800                                   TO TRUE                        31120000
311900                  PERFORM DP013-0000-PROCESS-ABEND                31130000
312000     END-EVALUATE.                                                31140000
312100                                                                  31150000
312200                                                                  31160000
312300*----------------------------------------------------------------*31170000
312400* GET PULL POSTED UNITS - BY STORE                               *31180000
312500*----------------------------------------------------------------*31190000
312510 4535-GET-POSTED-UNITS.                                           31200000
312520                                                                  31210000
312530     INITIALIZE  PV-CEPLMF-POSTED-QTY                             31220000
312531                 PV-CEPLAU-POSTED-QTY                             31230000
312532                 PV-TOTAL-POSTED-QTY.                             31240000
312533                                                                  31250000
312534     PERFORM 4536-GET-PULL-POSTED-TCEPLMF.                        31251000
312535     PERFORM 4537-GET-PULL-POSTED-TCEPLAU.                        31252000
312536                                                                  31253000
312537     ADD  PV-CEPLMF-POSTED-QTY                                    31253100
312538          PV-CEPLAU-POSTED-QTY                                    31253200
312539          GIVING  PV-TOTAL-POSTED-QTY.                            31253300
312540                                                                  31253400
312541                                                                  31253500
312542*----------------------------------------------------------------*31253600
312543* GET PULL POSTED UNITS - TCEPLMF - BY STORE                     *31253700
312544*----------------------------------------------------------------*31253800
312545 4536-GET-PULL-POSTED-TCEPLMF.                                    31253900
312546                                                                  31254000
312547     INITIALIZE  PV-CEPLMF-POSTED-QTY.                            31254100
312548                                                                  31254200
312549     EXEC SQL                                                     31254300
312550          SELECT  COALESCE(SUM(C.MFST_UNT_QTY),0)                 31254400
312551            INTO  :PV-CEPLMF-POSTED-QTY                           31254500
312552            FROM  TCEPLRQ A                                       31254600
312553                 ,TCEPLIT B                                       31254700
312554                 ,TCEPLMF C                                       31254800
312555           WHERE  A.CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER            31254900
312556             AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR        31255000
312557             AND  B.PL_LNE_NBR       = :DK-LINE-NUMBER            31255100
312558             AND  B.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR        31255200
312559             AND  C.PL_LNE_NBR       =  B.PL_LNE_NBR              31255300
312560             AND  C.STR_NBR          = :DK-STORE-NUMBER           31255400
312561             AND  NOT C.EXPRT_PRC_BTCH_ID = ' '                   31255500
312562     END-EXEC                                                     31255600
312563                                                                  31255700
312564     EVALUATE TRUE                                                31255800
312565         WHEN SQLCODE = +0                                        31255900
312566              CONTINUE                                            31256000
312567         WHEN SQLCODE = -904                                      31256100
312568         WHEN SQLCODE = -911                                      31256200
312569         WHEN SQLCODE = -913                                      31256300
312570             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    31256400
312571             MOVE '4536-GET-PULL-POSTED- '  TO PV-SOFT-PARAGRAPH  31256500
312572             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  31256600
312573             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31256700
312574               TO PV-COMMAREA-LENGTH                              31256800
312575             EXEC CICS                                            31256900
312576                  WRITEQ TD                                       31257000
312577                   QUEUE  ('CSSL')                                31257100
312578                    FROM  (PV-CICS-MSG-AREA2)                     31257200
312579                  LENGTH  (PV-COMMAREA-LENGTH)                    31257300
312580                    RESP  (PV-CICS-RESP)                          31257400
312581             END-EXEC                                             31257500
312582             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          31257600
312583             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              31257700
312584             PERFORM 9900-SOFT-ABORT                              31257800
312585         WHEN OTHER                                               31257900
312586             MOVE '4536-GET-PULL-POSTED-TCEPLMF'                  31258000
312587                               TO DP013-PARAGRAPH                 31258100
312588              MOVE 'GET POSTED UNITS BY STORE'                    31258200
312589                               TO DP013-MESSAGE-TEXT (1)          31258300
312590              MOVE SQLCA       TO DP013-SQLCA                     31258400
312591              MOVE 'TCEPLRQ '  TO DP013-DB2-TABLE-NAME (1)        31258500
312592              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (2)        31258600
312593              MOVE 'TCEPLMF '  TO DP013-DB2-TABLE-NAME (3)        31258700
312594              SET DP013-DB2-ABEND                                 31258800
312595                  DP013-XCTL-DISPLAY-RESTART                      31258900
312596                                   TO TRUE                        31259000
312597                  PERFORM DP013-0000-PROCESS-ABEND                31259100
312598     END-EVALUATE.                                                31259200
312599                                                                  31259300
312600                                                                  31259400
312601*----------------------------------------------------------------*31259500
312602* GET PULL POSTED UNITS - TCEPLAU - BY STORE                     *31259600
312603*----------------------------------------------------------------*31259700
312604 4537-GET-PULL-POSTED-TCEPLAU.                                    31259800
312605                                                                  31259900
312606     INITIALIZE  PV-CEPLAU-POSTED-QTY.                            31260000
312607                                                                  31260100
312608     EXEC SQL                                                     31260200
312609          SELECT  COALESCE(SUM(C.AFT_ADJ_UNT_QTY                  31260300
312610                             - C.BEF_ADJ_UNT_QTY),0)              31260400
312611            INTO  :PV-CEPLAU-POSTED-QTY                           31260500
312612            FROM  TCEPLRQ A                                       31260600
312613                 ,TCEPLIT B                                       31260700
312614                 ,TCEPLAU C                                       31260800
312615           WHERE  A.CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER            31260900
312616             AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR        31261000
312617             AND  B.PL_LNE_NBR       = :DK-LINE-NUMBER            31261100
312618             AND  B.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR        31261200
312619             AND  C.PL_LNE_NBR       =  B.PL_LNE_NBR              31261300
312620             AND  C.STR_NBR          = :DK-STORE-NUMBER           31261400
312621             AND  NOT C.EXPRT_PRC_BTCH_ID = ' '                   31261500
312622     END-EXEC                                                     31261600
312623                                                                  31261700
312624     EVALUATE TRUE                                                31261800
312625         WHEN SQLCODE = +0                                        31261900
312626              CONTINUE                                            31262000
312627         WHEN SQLCODE = -904                                      31262100
312628         WHEN SQLCODE = -911                                      31262200
312629         WHEN SQLCODE = -913                                      31262300
312630             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    31262400
312631             MOVE '4537-GET-PULL-POSTED- '  TO PV-SOFT-PARAGRAPH  31262500
312632             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  31262600
312633             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31262700
312634               TO PV-COMMAREA-LENGTH                              31262800
312635             EXEC CICS                                            31262900
312636                  WRITEQ TD                                       31263000
312637                   QUEUE  ('CSSL')                                31263100
312638                    FROM  (PV-CICS-MSG-AREA2)                     31263200
312639                  LENGTH  (PV-COMMAREA-LENGTH)                    31263300
312640                    RESP  (PV-CICS-RESP)                          31263400
312641             END-EXEC                                             31263500
312642             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          31263600
312643             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              31263700
312644             PERFORM 9900-SOFT-ABORT                              31263800
312645         WHEN OTHER                                               31263900
312646              MOVE '4537-GET-PULL-POSTED-TCEPLAU'                 31264000
312647                               TO DP013-PARAGRAPH                 31264100
312648              MOVE 'GET POSTED UNITS BY STORE'                    31264200
312649                               TO DP013-MESSAGE-TEXT (1)          31264300
312650              MOVE SQLCA       TO DP013-SQLCA                     31264400
312651              MOVE 'TCEPLRQ '  TO DP013-DB2-TABLE-NAME (1)        31264500
312652              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (2)        31264600
312653              MOVE 'TCEPLAU '  TO DP013-DB2-TABLE-NAME (3)        31264700
312654              SET DP013-DB2-ABEND                                 31264800
312655                  DP013-XCTL-DISPLAY-RESTART                      31264900
312656                                   TO TRUE                        31265000
312657                  PERFORM DP013-0000-PROCESS-ABEND                31265100
312658     END-EVALUATE.                                                31265200
312659                                                                  31265300
312660                                                                  31265400
312661*----------------------------------------------------------------*31265500
312662*  UPDATE FUNCTION                                               *31265600
312670*----------------------------------------------------------------*31265700
312680 4700-PROCESS-UPDATE-FUNCTION.                                    31265800
312690                                                                  31265900
312700     MOVE +1                       TO ASC-BLK-SUB.                31266000
312800     PERFORM 5100-WRITE-TEMP-STORAGE.                             31267000
312900     ADD +1                        TO ASC-BLK-SUB.                31268000
313000     PERFORM 5100-WRITE-TEMP-STORAGE.                             31269000
313100                                                                  31270000
313200     PERFORM 6112-READ-LIST-QUEUE.                                31280000
313300                                                                  31290000
313400     SET  LQW-IDX  TO   1.                                        31300000
313500                                                                  31310000
313600     IF PS-NO-SOFT-ABORT-ERROR                                    31320000
313700       IF PV-CICS-RESP = DFHRESP (NORMAL)                         31330000
313800         PERFORM                                                  31340000
313900         VARYING LQW-IDX  FROM 1 BY 1                             31350000
314000         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     31360000
314100            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            31370000
314200            OR   PS-SOFT-ABORT-ERROR                              31380000
314300            OR   PS-ERROR                                         31390000
314400             IF  LQW-SELECT (LQW-IDX)                             31400000
314500                 PERFORM 4705-PROCESS-SELECTED-LINES              31410000
314600             END-IF                                               31420000
314700         END-PERFORM                                              31430000
314800       END-IF                                                     31440000
314900     END-IF.                                                      31450000
315000                                                                  31460000
315100     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           31470000
315200     PERFORM 6111-WRITE-LIST-QUEUE.                               31480000
315300                                                                  31490000
315400     MOVE +1                     TO  ASC-BLK-SUB.                 31500000
315500     PERFORM 4410-READ-TEMP-STORAGE.                              31510000
315600                                                                  31520000
315700     ADD +1                      TO  ASC-BLK-SUB                  31530000
315800                                     PV-BLOCK-NUMBER.             31540000
315900                                                                  31550000
316000     PERFORM 4410-READ-TEMP-STORAGE.                              31560000
316100                                                                  31570000
316200                                                                  31580000
316300*----------------------------------------------------------------*31590000
316400*                                                                *31600000
316500*----------------------------------------------------------------*31610000
316600 4705-PROCESS-SELECTED-LINES.                                     31620000
316700                                                                  31630000
316800     PERFORM 4720-UPDATE-LINES.                                   31640000
316900                                                                  31650000
317000     IF  PS-NO-ERROR                                              31660000
317100         SET DP020-MSG-INFORMATIONAL  TO  TRUE                    31670000
317200         MOVE PC-TSYMSG-02252  TO  DP020-MSG-NUMBER               31680000
317300     END-IF.                                                      31690000
317400                                                                  31700000
317500                                                                  31710000
317600*----------------------------------------------------------------*31720000
317700*                                                                *31730000
317800*                                                                *31740000
317900*----------------------------------------------------------------*31750000
318000 4720-UPDATE-LINES.                                               31760000
318100                                                                  31770000
318200     MOVE ASC-PULL-NBR                   TO PV-PULL-NUMBER.       31780000
318300     MOVE LQW-STORE-NUMBER (LQW-IDX)     TO PV-STORE-NUMBER.      31790000
318400     MOVE LQW-UPD-UNITS (LQW-IDX)        TO PV-UPDATE-UNITS.      31800000
318500                                                                  31810000
318600     IF  PS-NO-ERROR                                              31820000
318700         IF  LQW-SELECT (LQW-IDX)                                 31830000
318800                 PERFORM 4730-ISSUE-UPDATE-REQ                    31840000
318900         END-IF                                                   31850000
319000     END-IF.                                                      31860000
319100                                                                  31870000
319200                                                                  31880000
319300     IF  PS-NO-ERROR                                              31890000
319400         SET  LQW-DESELECT (LQW-IDX)                              31900000
319500              LQW-UPD (LQW-IDX)                                   31910000
319600              LQW-SEL-ZERO-NO (LQW-IDX) TO  TRUE                  31920000
319700              MOVE LQW-UPD-UNITS (LQW-IDX)                        31930000
319800                TO PV-NUMERIC-ACTL-DISTRB-QTY                     31940000
319900              MOVE PV-NUMERIC-ACTL-DISTRB-QTY                     31950000
320000                TO LQW-DISTRB-UNITS (LQW-IDX)                     31960000
320100         MOVE ZEROES                   TO  LQW-UPD-UNITS (LQW-IDX)31970000
320200         SUBTRACT  1                                              31980000
320300             FROM  ASC-NUMBER-OF-SELECTED-ITEMS                   31990000
320400         MOVE LQW-SELECTED-SW (LQW-IDX)                           32000000
320500                              TO LQW-TEMP-SELECTED-SW (LQW-IDX)   32010000
320600     END-IF.                                                      32020000
320700                                                                  32030000
320800                                                                  32040000
320900*----------------------------------------------------------------*32050000
321000*                                                                *32060000
321100*----------------------------------------------------------------*32070000
321200 4730-ISSUE-UPDATE-REQ.                                           32080000
321300                                                                  32090000
321400     PERFORM 4740-UPDATE-UNITS.                                   32100000
321500                                                                  32110000
321600     IF  PS-NO-ERROR                                              32120000
321700         EXEC CICS                                                32130000
321800              SYNCPOINT                                           32140000
321900         END-EXEC                                                 32150000
322000     END-IF.                                                      32160000
322100                                                                  32170000
322200                                                                  32180000
322300*----------------------------------------------------------------*32190000
322400*                                                                *32200000
322500*----------------------------------------------------------------*32210000
322600 4740-UPDATE-UNITS.                                               32220000
322700                                                                  32230000
322800     MOVE PV-UPDATE-UNITS         TO CEPLDS-ACTL-DISTRB-QTY.      32240000
322900     MOVE PV-PULL-NUMBER          TO DK-PULL-NUMBER.              32250000
323000     MOVE ASC-LINE-ITEM           TO DK-LINE-NUMBER.              32260000
323100     MOVE PV-STORE-NUMBER         TO DK-STORE-NUMBER.             32270000
323200                                                                  32280000
323300     EXEC SQL                                                     32290000
323400          UPDATE TCEPLDS                                          32300000
323500             SET                                                  32310000
323600                 ACTL_DISTRB_QTY   = :CEPLDS-ACTL-DISTRB-QTY      32320000
323700           WHERE CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER              32330000
323800             AND PL_LNE_NBR        = :DK-LINE-NUMBER              32340000
323900             AND STR_NBR           = :DK-STORE-NUMBER             32350000
324000     END-EXEC.                                                    32360000
324100                                                                  32370000
324200     EVALUATE TRUE                                                32380000
324300         WHEN SQLCODE = ZERO                                      32390000
324400              CONTINUE                                            32400000
324500         WHEN SQLCODE = -904                                      32410000
324600         WHEN SQLCODE = -911                                      32420000
324700         WHEN SQLCODE = -913                                      32430000
324800             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   32440000
324900             MOVE '4740-UPDATE-UNITS'        TO PV-SOFT-PARAGRAPH 32450000
325000             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 32460000
325100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     32470000
325200               TO PV-COMMAREA-LENGTH                              32480000
325300             EXEC CICS                                            32490000
325400                  WRITEQ TD                                       32500000
325500                   QUEUE  ('CSSL')                                32510000
325600                    FROM  (PV-CICS-MSG-AREA2)                     32520000
325700                  LENGTH  (PV-COMMAREA-LENGTH)                    32530000
325800                    RESP  (PV-CICS-RESP)                          32540000
325900             END-EXEC                                             32550000
326000              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         32560000
326100              PERFORM 9900-SOFT-ABORT                             32570000
326200         WHEN SQLWARN0 NOT = SPACES                               32580000
326300         WHEN SQLCODE NOT EQUAL ZERO                              32590000
326400              MOVE '4740-UPDATE-UNITS'                            32600000
326500                                   TO DP013-PARAGRAPH             32610000
326600              STRING ' PULL-'         DELIMITED BY SIZE           32620000
326700                     PV-PULL-NUMBER   DELIMITED BY SIZE           32630000
326800                     '  -  LINE-'     DELIMITED BY SIZE           32640000
326900                     PV-LINE-NUMBER   DELIMITED BY SIZE           32650000
327000                     '  -  STORE-'    DELIMITED BY SIZE           32660000
327100                     PV-STORE-NUMBER  DELIMITED BY SIZE           32670000
327200                     '  -  UPD UNIT-' DELIMITED BY SIZE           32680000
327300                     PV-UPDATE-UNITS  DELIMITED BY SIZE           32690000
327400                     '  TRYING TO UPDATE DISTR UNITS'             32700000
327500                                      DELIMITED BY SIZE           32710000
327600                                 INTO DP013-MESSAGE-TEXT (1)      32720000
327700              MOVE SQLCA           TO DP013-SQLCA                 32730000
327800              MOVE 'TCEPLDS'       TO DP013-DB2-TABLE-NAME (1)    32740000
327900              SET DP013-DB2-ABEND  TO TRUE                        32750000
328000              PERFORM DP013-0000-PROCESS-ABEND                    32760000
328100     END-EVALUATE.                                                32770000
328200                                                                  32780000
328300                                                                  32790000
328400                                                                  32800000
328500                                                                  32810000
328600*----------------------------------------------------------------*32820000
328700* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *32830000
328800* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *32840000
328900* FOR THE SELECTED ITEMS QUEUE.                                  *32850000
329000*                                                                *32860000
329100* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *32870000
329200* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *32880000
329300* THE ARRAY IS FULL.                                             *32890000
329400*----------------------------------------------------------------*32900000
329500                                                                  32910000
329600 5000-PREPARE-SEL-QUEUE.                                          32920000
329700                                                                  32930000
329800     MOVE +1                   TO  ASC-BLK-SUB.                   32940000
329900     PERFORM 5100-WRITE-TEMP-STORAGE.                             32950000
330000     ADD +1                    TO  ASC-BLK-SUB.                   32960000
330100     PERFORM 5100-WRITE-TEMP-STORAGE.                             32970000
330200                                                                  32980000
330210     MOVE ASC-SEL-QUEUE-NAME-2 TO  ASC-SEL-QUEUE-NAME.            32990000
330300     MOVE ASC-SEL-QUEUE-NAME   TO  CE002-SEL-QUEUE-NAME.          33000000
330400     PERFORM 6010-DELETE-SEL-QUEUE.                               33010000
330500                                                                  33020000
330600     SET ASC-UPDATE-TSQ        TO  TRUE.                          33030000
330700                                                                  33040000
330800     SET CE003-IDX             TO  1.                             33050000
330900     MOVE ZERO                 TO CE002-NUMBER-OF-TS-ITEMS.       33060000
331000     INITIALIZE CE003-SELECTED-ITEM-ARRAY.                        33070000
331100                                                                  33080000
331200     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           33090000
331300             VARYING PV-ITEM                                      33100000
331400             FROM 1 BY 1                                          33110000
331500             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     33120000
331600                                                                  33130000
331700     IF  CE003-IDX > 1                                            33140000
331800         PERFORM 5205-WRITE-SEL-QUEUE                             33150000
331900         ADD +1                TO CE002-NUMBER-OF-TS-ITEMS        33160000
332000     END-IF.                                                      33170000
332100                                                                  33180000
332200                                                                  33190000
332300*----------------------------------------------------------------*33200000
332400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  THIS WILL ONLY *33210000
332500* CREATE ONE ENTRY IN THE SELECTION QUEUE.  THE NEXT PROGRAM     *33220000
332600* CAN ACCEPT MULTIPLE QUEUE ENTRIES, EACH CONTAINING A DIFFERENT *33230000
332700* LINE NUMBER.  SINCE THIS PROGRAM IS ONLY WORKING WITH ONE      *33240000
332800* LINE NUMBER IT WILL ONLY CREATE ONE ENTRY IN THE QUEUE.        *33250000
332900*                                                                *33260000
333000* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *33270000
333100* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *33280000
333200* THE ARRAY IS FULL.                                             *33290000
333300*----------------------------------------------------------------*33300000
333400 5000-PREPARE-SEL-QUEUE-1.                                        33310000
333500                                                                  33320000
333600     MOVE +1                   TO  ASC-BLK-SUB.                   33330000
333700     PERFORM 5100-WRITE-TEMP-STORAGE.                             33340000
333800     ADD +1                    TO  ASC-BLK-SUB.                   33350000
333900     PERFORM 5100-WRITE-TEMP-STORAGE.                             33360000
334000                                                                  33370000
334100     MOVE ASC-SEL-QUEUE-NAME   TO  CE002-SEL-QUEUE-NAME.          33380000
334200     PERFORM 6010-DELETE-SEL-QUEUE.                               33390000
334300                                                                  33400000
334400     SET ASC-UPDATE-TSQ        TO  TRUE.                          33410000
334500                                                                  33420000
334600     MOVE ZERO                 TO CE002-NUMBER-OF-TS-ITEMS.       33430000
334700     INITIALIZE CE003-SELECTED-ITEM-ARRAY.                        33440000
334800                                                                  33450000
334900     PERFORM 5200-FILL-SEL-QUEUE-RECORD-1.                        33460000
335000                                                                  33470000
335100     PERFORM 5205-WRITE-SEL-QUEUE                                 33480000
335200     ADD +1                    TO CE002-NUMBER-OF-TS-ITEMS.       33490000
335300                                                                  33500000
335400                                                                  33510000
335500*----------------------------------------------------------------*33520000
335600*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *33530000
335700*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *33540000
335800*----------------------------------------------------------------*33550000
335900                                                                  33560000
336000 5100-WRITE-TEMP-STORAGE.                                         33570000
336100     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     33580000
336200                                   TO PV-LIST-ITEM-NUMBER.        33590000
336300     COMPUTE PV-BLOCK-NUMBER =                                    33600000
336400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    33610000
336500                                                                  33620000
336600     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             33630000
336700     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             33640000
336800         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      33650000
336900             PERFORM 5105-REWRITE-ASC-LISTQ                       33660000
337000         END-IF                                                   33670000
337100     ELSE                                                         33680000
337200         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       33690000
337300         ASC-HIGHEST-BLOCK-WRITTEN + 1                            33700000
337400         PERFORM 5110-WRITE-ASC-LISTQ                             33710000
337500         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   33720000
337600     END-IF.                                                      33730000
337700                                                                  33740000
337800     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             33750000
337900******************************************************************33760000
338000** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **33770000
338100** SPECIFIC COMMAREA.                                           **33780000
338200******************************************************************33790000
338300 5105-REWRITE-ASC-LISTQ.                                          33800000
338400     EXEC CICS                                                    33810000
338500         WRITEQ TS                                                33820000
338600             QUEUE (ASC-LIST-QUEUE-NAME)                          33830000
338700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               33840000
338800             ITEM  (PV-BLOCK-NUMBER)                              33850000
338900             REWRITE                                              33860000
339000             RESP  (PV-CICS-RESP)                                 33870000
339100     END-EXEC.                                                    33880000
339200                                                                  33890000
339300     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           33900000
339400         CONTINUE                                                 33910000
339500     ELSE                                                         33920000
339600         SET DP013-CICS-ABEND            TO TRUE                  33930000
339700         SET DP013-NO-ROLLBACK           TO TRUE                  33940000
339800         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       33950000
339900         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     33960000
340000                                         TO DP013-MESSAGE-TEXT(1) 33970000
340100         PERFORM DP013-0000-PROCESS-ABEND                         33980000
340200     END-IF.                                                      33990000
340300                                                                  34000000
340400******************************************************************34010000
340500** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **34020000
340600** SPECIFIC COMMAREA.                                           **34030000
340700******************************************************************34040000
340800 5110-WRITE-ASC-LISTQ.                                            34050000
340900     EXEC CICS                                                    34060000
341000         WRITEQ TS                                                34070000
341100             QUEUE (ASC-LIST-QUEUE-NAME)                          34080000
341200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               34090000
341300             ITEM  (PV-BLOCK-NUMBER)                              34100000
341400             RESP  (PV-CICS-RESP)                                 34110000
341500     END-EXEC.                                                    34120000
341600     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      34130000
341700         SET DP013-CICS-ABEND      TO TRUE                        34140000
341800         SET DP013-NO-ROLLBACK     TO TRUE                        34150000
341900         MOVE '5110-WRITE-ASC-LISTQ'                              34160000
342000                                   TO DP013-PARAGRAPH             34170000
342100         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           34180000
342200                                   TO DP013-MESSAGE-TEXT(1)       34190000
342300         PERFORM DP013-0000-PROCESS-ABEND                         34200000
342400     END-IF.                                                      34210000
342500                                                                  34220000
342600                                                                  34230000
342700*----------------------------------------------------------------*34240000
342800* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *34250000
342900* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *34260000
343000*----------------------------------------------------------------*34270000
343100                                                                  34280000
343200 5200-FILL-SEL-QUEUE-RECORD.                                      34290000
343300                                                                  34300000
343400     PERFORM 6112-READ-LIST-QUEUE.                                34310000
343500                                                                  34320000
343600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       34330000
343700         PERFORM                                                  34340000
343800         VARYING LQW-IDX                                          34350000
343900         FROM 1 BY 1                                              34360000
344000         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            34370000
344100           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          34380000
344200                                                                  34390000
344300             IF  LQW-SELECT (LQW-IDX)                             34400000
344400                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              34410000
344500                                   TO CE003-ITEM (CE003-IDX)      34420000
344600                 MOVE SPACE        TO CE003-ACTION-SW (CE003-IDX) 34430000
344700                                                                  34440000
344800                 MOVE ASC-PULL-NBR TO  CE003-PULL-NUMBER          34450000
344900                                        (CE003-IDX)               34460000
345000                 MOVE ASC-REF-NBR  TO  CE003-REF-NUMBER           34470000
345100                                        (CE003-IDX)               34480000
345200                 MOVE ASC-CS-LOC   TO  CE003-CS-LOCATION          34490000
345300                                        (CE003-IDX)               34500000
345400                 MOVE ZEROES       TO  CE003-CREATE-DATE          34510000
345500                                        (CE003-IDX)               34520000
345600                 MOVE ASC-PULL-STATUS                             34530000
345700                                   TO  CE003-PULL-STATUS-CDE      34540000
345800                                        (CE003-IDX)               34550000
345900                 MOVE ASC-PULL-TYPE                               34560000
346000                                   TO  CE003-PULL-SOURCE-CDE      34570000
346100                                        (CE003-IDX)               34580000
346200                 MOVE ZEROES       TO  CE003-NBR-ITEMS            34590000
346300                                        (CE003-IDX)               34600000
346400                 MOVE LQW-NBR-STORES (LQW-IDX)                    34610000
346500                                   TO  CE003-NBR-STORES           34620000
346600                                        (CE003-IDX)               34630000
346700                 MOVE LQW-REQ-UNITS (LQW-IDX)                     34640000
346800                                   TO  CE003-REQ-PULL-UNITS       34650000
346900                                        (CE003-IDX)               34660000
347000                 MOVE LQW-DISTRB-UNITS (LQW-IDX)                  34670000
347100                                   TO  CE003-DIST-PULL-UNITS      34680000
347200                                        (CE003-IDX)               34690000
347300                 MOVE ASC-LINE-STATUS-CDE                         34700000
347400                                   TO  CE003-LINE-STATUS-CDE      34710000
347500                                        (CE003-IDX)               34720000
347600                 MOVE ASC-SKU-NUMBER                              34730000
347700                                   TO  CE003-LINE-SKU             34740000
347800                                        (CE003-IDX)               34750000
347900                 MOVE ASC-LINE-SKU-RETAIL                         34760000
348000                                   TO  CE003-LINE-SKU-RETAIL      34770000
348100                                        (CE003-IDX)               34780000
348200                 MOVE ASC-LINE-ITEM                               34790000
348300                                   TO  CE003-LINE-ITEM            34800000
348400                                        (CE003-IDX)               34810000
348500*LMM                                                              34820000
348600                 MOVE LQW-STORE-NUMBER (LQW-IDX)                  34830000
348700                                   TO  CE003-STR-NBR              34840000
348800                                       (CE003-IDX)                34850000
348900                 MOVE LQW-MANIFEST-UNITS (LQW-IDX)                34860000
349000                                   TO  CE003-MFST-UNT-QTY         34870000
349100                                       (CE003-IDX)                34880000
349200                 MOVE LQW-ADJUST-UNITS-SIGNED (LQW-IDX)           34890000
349300                                   TO  CE003-ADJ-UNT-QTY          34900000
349400                                       (CE003-IDX)                34910000
349500*                MOVE LQW-DISTRB-UNITS (LQW-IDX)                  34920000
349510                 MOVE LQW-ACTL-DISTRIB-QTY (LQW-IDX)              34930000
349600                                   TO  CE003-DISTRB-UNITS         34940000
349700                                       (CE003-IDX)                34950000
349800                                                                  34960000
349900                 SET CE003-IDX UP BY 1                            34970000
350000                 IF  CE003-IDX > CE003-MAX-ITEMS                  34980000
350100                     PERFORM 5205-WRITE-SEL-QUEUE                 34990000
350200                     ADD +1        TO CE002-NUMBER-OF-TS-ITEMS    35000000
350300                     INITIALIZE CE003-SELECTED-ITEM-ARRAY         35010000
350400                     SET CE003-IDX TO  1                          35020000
350500                 END-IF                                           35030000
350600             END-IF                                               35040000
350700         END-PERFORM                                              35050000
350800     END-IF.                                                      35060000
350900                                                                  35070000
351000                                                                  35080000
351100*----------------------------------------------------------------*35090000
351200*                                                                *35100000
351300*----------------------------------------------------------------*35110000
351400                                                                  35120000
351500 5200-FILL-SEL-QUEUE-RECORD-1.                                    35130000
351600                                                                  35140000
351700     MOVE 1                 TO  CE003-ITEM (CE003-IDX)            35150000
351800     MOVE ASC-PULL-NBR      TO  CE003-PULL-NUMBER (CE003-IDX)     35160000
351900     MOVE ASC-REF-NBR       TO  CE003-REF-NUMBER (CE003-IDX)      35170000
352000     MOVE ASC-LINE-ITEM     TO  CE003-LINE-NUMBER (CE003-IDX)     35180000
352100     MOVE ASC-CS-LOC        TO  CE003-CS-LOCATION (CE003-IDX)     35190000
352200     MOVE ZEROES            TO  CE003-CREATE-DATE (CE003-IDX)     35200000
352300     MOVE ASC-PULL-STATUS   TO  CE003-PULL-STATUS-CDE (CE003-IDX) 35210000
352400     MOVE ASC-PULL-TYPE     TO  CE003-PULL-SOURCE-CDE (CE003-IDX) 35220000
352500     MOVE ZEROES            TO  CE003-NBR-ITEMS (CE003-IDX)       35230000
352600                                CE003-NBR-STORES (CE003-IDX)      35240000
352700                                CE003-REQ-PULL-UNITS (CE003-IDX)  35250000
352800                                CE003-DIST-PULL-UNITS (CE003-IDX) 35260000
352900     MOVE ASC-LINE-STATUS-CDE                                     35270000
353000                            TO  CE003-LINE-STATUS-CDE (CE003-IDX) 35280000
353100     MOVE ASC-SKU-NUMBER    TO  CE003-LINE-SKU (CE003-IDX)        35290000
353200     MOVE ASC-LINE-SKU-RETAIL                                     35300000
353300                            TO  CE003-LINE-SKU-RETAIL (CE003-IDX).35310000
353400                                                                  35320000
353500*----------------------------------------------------------------*35330000
353600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *35340000
353700*----------------------------------------------------------------*35350000
353800                                                                  35360000
353900 5205-WRITE-SEL-QUEUE.                                            35370000
354000                                                                  35380000
354100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            35390000
354200                                   TO CE003-SELECTED-ITEMS.       35400000
354300                                                                  35410000
354400     EXEC CICS                                                    35420000
354500          WRITEQ TS                                               35430000
354600              QUEUE (ASC-SEL-QUEUE-NAME)                          35440000
354700              FROM  (CE003-SELECT-RECORD)                         35450000
354800              ITEM  (PV-SEL-QUEUE-ITEM)                           35460000
354900              RESP  (PV-CICS-RESP)                                35470000
355000     END-EXEC.                                                    35480000
355100                                                                  35490000
355200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          35500000
355300         CONTINUE                                                 35510000
355400     ELSE                                                         35520000
355500         SET DP013-CICS-ABEND      TO TRUE                        35530000
355600         SET DP013-NO-ROLLBACK     TO TRUE                        35540000
355700         MOVE '5205-WRITE-SEL-QUEUE'                              35550000
355800                                   TO DP013-PARAGRAPH             35560000
355900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          35570000
356000                                   TO DP013-MESSAGE-TEXT(1)       35580000
356100         PERFORM DP013-0000-PROCESS-ABEND                         35590000
356200     END-IF.                                                      35600000
356300 EJECT                                                            35610000
356400******************************************************************35620000
356500** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **35630000
356600** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **35640000
356700** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **35650000
356800** THE USER.                                                    **35660000
356900******************************************************************35670000
357000 6000-REFRESH-PANEL-FROM-TEMP.                                    35680000
357100     IF  ASC-UPDATE-TSQ                                           35690000
357200         SET ASC-NO-TSQ-UPDATE TO TRUE                            35700000
357300         MOVE ZERO                 TO PV-SAVE-ITEM                35710000
357400                                      PV-SEL-QUEUE-ITEM           35720000
357500         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        35730000
357600                                   TO PV-HOLD-SELECTED-ITEMS      35740000
357700         MOVE +1                   TO PV-ITEMS-PROCESSED          35750000
357800         PERFORM 6100-UPDATE-TSQ                                  35760000
357900             UNTIL PV-ITEMS-PROCESSED >                           35770000
358000                                     PV-HOLD-SELECTED-ITEMS       35780000
358100         INITIALIZE ASC-BLOCK-ENTRIES (1)                         35790000
358200                    ASC-BLOCK-ENTRIES (2)                         35800000
358300     END-IF.                                                      35810000
358400                                                                  35820000
358500*----------------------------------------------------------------*35830000
358600*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *35840000
358700*----------------------------------------------------------------*35850000
358800 6010-DELETE-SEL-QUEUE.                                           35860000
358900                                                                  35870000
359000     EXEC CICS                                                    35880000
359100         DELETEQ TS                                               35890000
359200             QUEUE (ASC-SEL-QUEUE-NAME)                           35900000
359300             RESP  (PV-CICS-RESP)                                 35910000
359400     END-EXEC.                                                    35920000
359500*                                                                 35930000
359600     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      35940000
359700        (PV-CICS-RESP = DFHRESP(QIDERR)))                         35950000
359800         CONTINUE                                                 35960000
359900     ELSE                                                         35970000
360000         SET DP013-CICS-ABEND TO TRUE                             35980000
360100         SET DP013-NO-ROLLBACK TO TRUE                            35990000
360200         MOVE '6010-DELETE-SEL-QUEUE'                             36000000
360300                        TO DP013-PARAGRAPH                        36010000
360400         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         36020000
360500                        TO DP013-MESSAGE-TEXT (1)                 36030000
360600         PERFORM DP013-0000-PROCESS-ABEND                         36040000
360700     END-IF.                                                      36050000
360800                                                                  36060000
360900*----------------------------------------------------------------*36070000
361000*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *36080000
361100*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *36090000
361200*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *36100000
361300*    THE TEMP QUEUE.                                             *36110000
361400*----------------------------------------------------------------*36120000
361500                                                                  36130000
361600 6100-UPDATE-TSQ.                                                 36140000
361700                                                                  36150000
361800     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             36160000
361900     PERFORM 6105-READ-SEL-QUEUE.                                 36170000
362000     PERFORM                                                      36180000
362100         VARYING CE003-IDX                                        36190000
362200         FROM 1 BY 1                                              36200000
362300         UNTIL ((PV-ITEMS-PROCESSED >                             36210000
362400                              PV-HOLD-SELECTED-ITEMS)             36220000
362500         OR (CE003-IDX GREATER THAN CE003-MAX-ITEMS))             36230000
362600         IF  CE003-ACTION-SW (CE003-IDX) > SPACE                  36240000
362700             PERFORM 6110-PROCESS-ITEMS                           36250000
362800         END-IF                                                   36260000
362900         ADD +1                TO PV-ITEMS-PROCESSED              36270000
363000     END-PERFORM.                                                 36280000
363100     PERFORM 6111-WRITE-LIST-QUEUE.                               36290000
363200*----------------------------------------------------------------*36300000
363300*    READ THE LIST QUEUE RECORD.                                 *36310000
363400*----------------------------------------------------------------*36320000
363500                                                                  36330000
363600 6105-READ-SEL-QUEUE.                                             36340000
363700                                                                  36350000
363800     EXEC CICS                                                    36360000
363900          READQ TS                                                36370000
364000              QUEUE (ASC-SEL-QUEUE-NAME)                          36380000
364100              INTO  (CE003-SELECT-RECORD)                         36390000
364200              ITEM  (PV-SEL-QUEUE-ITEM)                           36400000
364300              RESP  (PV-CICS-RESP)                                36410000
364400     END-EXEC.                                                    36420000
364500*                                                                 36430000
364600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36440000
364700         CONTINUE                                                 36450000
364800     ELSE                                                         36460000
364900         SET DP013-CICS-ABEND      TO  TRUE                       36470000
365000         SET DP013-NO-ROLLBACK     TO  TRUE                       36480000
365100         MOVE '6105-READ-SEL-QUEUE'                               36490000
365200                                   TO  DP013-PARAGRAPH            36500000
365300         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           36510000
365400                                   TO  DP013-MESSAGE-TEXT(1)      36520000
365500         PERFORM DP013-0000-PROCESS-ABEND                         36530000
365600     END-IF.                                                      36540000
365700 EJECT                                                            36550000
365800*----------------------------------------------------------------*36560000
365900*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*36570000
366000*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*36580000
366100*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *36590000
366200*----------------------------------------------------------------*36600000
366300                                                                  36610000
366400 6110-PROCESS-ITEMS.                                              36620000
366500                                                                  36630000
366600     COMPUTE PV-ITEM = 1 + ((CE003-ITEM (CE003-IDX) - 1)          36640000
366700                     / PC-ITEMS-PER-PANEL).                       36650000
366800                                                                  36660000
366900     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           36670000
367000         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          36680000
367100             PERFORM 6111-WRITE-LIST-QUEUE                        36690000
367200         END-IF                                                   36700000
367300         MOVE PV-ITEM          TO PV-SAVE-ITEM                    36710000
367400                                                                  36720000
367500         PERFORM 6112-READ-LIST-QUEUE                             36730000
367600         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               36740000
367700             CONTINUE                                             36750000
367800         END-IF                                                   36760000
367900     END-IF.                                                      36770000
368000                                                                  36780000
368100     COMPUTE PV-SUB = (CE003-ITEM (CE003-IDX)                     36790000
368200                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              36800000
368300     SET LQW-DESELECT (PV-SUB)             TO  TRUE.              36810000
368400     MOVE LQW-SELECTED-SW (PV-SUB)                                36820000
368500                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  36830000
368600     EVALUATE TRUE                                                36840000
368700         WHEN CE003-INQ (CE003-IDX)                               36850000
368800              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             36860000
368900                                                                  36870000
369000         WHEN CE003-UPD (CE003-IDX)                               36880000
369100              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             36890000
369200                                                                  36900000
369300         WHEN CE003-DEL (CE003-IDX)                               36910000
369400              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             36920000
369500                                                                  36930000
369600         WHEN CE003-ERR (CE003-IDX)                               36940000
369700              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             36950000
369800     END-EVALUATE.                                                36960000
369900                                                                  36970000
370000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                36980000
370100                                                                  36990000
370200*----------------------------------------------------------------*37000000
370300*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *37010000
370400*----------------------------------------------------------------*37020000
370500                                                                  37030000
370600 6111-WRITE-LIST-QUEUE.                                           37040000
370700                                                                  37050000
370800     EXEC CICS                                                    37060000
370900         WRITEQ TS                                                37070000
371000             QUEUE (ASC-LIST-QUEUE-NAME)                          37080000
371100             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     37090000
371200             ITEM  (PV-SAVE-ITEM)                                 37100000
371300             REWRITE                                              37110000
371400             RESP  (PV-CICS-RESP)                                 37120000
371500     END-EXEC.                                                    37130000
371600*                                                                 37140000
371700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37150000
371800         CONTINUE                                                 37160000
371900     ELSE                                                         37170000
372000         SET DP013-CICS-ABEND  TO  TRUE                           37180000
372100         SET DP013-NO-ROLLBACK TO  TRUE                           37190000
372200         MOVE '6111-WRITE-LIST-QUEUE'                             37200000
372300                               TO  DP013-PARAGRAPH                37210000
372400         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  37220000
372500                               TO  DP013-MESSAGE-TEXT(1)          37230000
372600         PERFORM DP013-0000-PROCESS-ABEND                         37240000
372700     END-IF.                                                      37250000
372800                                                                  37260000
372900 EJECT                                                            37270000
373000*----------------------------------------------------------------*37280000
373100*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*37290000
373200*----------------------------------------------------------------*37300000
373300                                                                  37310000
373400 6112-READ-LIST-QUEUE.                                            37320000
373500                                                                  37330000
373600     EXEC CICS                                                    37340000
373700         READQ TS                                                 37350000
373800             QUEUE (ASC-LIST-QUEUE-NAME)                          37360000
373900             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     37370000
374000             ITEM  (PV-ITEM)                                      37380000
374100             RESP  (PV-CICS-RESP)                                 37390000
374200     END-EXEC.                                                    37400000
374300*                                                                 37410000
374400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37420000
374500         CONTINUE                                                 37430000
374600     ELSE                                                         37440000
374700         SET DP013-CICS-ABEND        TO TRUE                      37450000
374800         SET DP013-NO-ROLLBACK       TO TRUE                      37460000
374900         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           37470000
375000         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    37480000
375100                                     TO DP013-MESSAGE-TEXT(1)     37490000
375200         PERFORM DP013-0000-PROCESS-ABEND                         37500000
375300     END-IF.                                                      37510000
375400                                                                  37520000
375500                                                                  37530000
375600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 37540000
375700* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *37550000
375800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 37560000
375900 9100-READ-SEL-QUEUE.                                             37570000
376000                                                                  37580000
376100     EXEC CICS                                                    37590000
376200         READQ TS                                                 37600000
376300             QUEUE (ASC-SEL-QUEUE-NAME)                           37610000
376400             INTO  (CE003-SELECT-RECORD)                          37620000
376500             ITEM  (ASC-SEL-ITEM)                                 37630000
376600             RESP  (PV-CICS-RESP)                                 37640000
376700     END-EXEC.                                                    37650000
376800     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        37660000
376900         CONTINUE                                                 37670000
377000     ELSE                                                         37680000
377100         SET DP013-LOGIC-ABEND                                    37690000
377200             DP013-NO-ROLLBACK   TO   TRUE                        37700000
377300         MOVE '9100-READ-SEL-QUEUE'                               37710000
377400                                 TO   DP013-PARAGRAPH             37720000
377500         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   37730000
377600                                 TO   DP013-MESSAGE-TEXT (1)      37740000
377700         PERFORM DP013-0000-PROCESS-ABEND                         37750000
377800     END-IF.                                                      37760000
377900                                                                  37770000
378000                                                                  37780000
378100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*37790000
378200* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *37800000
378300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 37810000
378400 9200-REWRITE-SEL-QUEUE.                                          37820000
378500                                                                  37830000
378600     EXEC CICS                                                    37840000
378700          WRITEQ TS                                               37850000
378800              QUEUE  (ASC-SEL-QUEUE-NAME)                         37860000
378900              FROM   (CE003-SELECT-RECORD)                        37870000
379000              ITEM   (ASC-SEL-ITEM)                               37880000
379100              RESP   (PV-CICS-RESP)                               37890000
379200              REWRITE                                             37900000
379300     END-EXEC.                                                    37910000
379400                                                                  37920000
379500     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   37930000
379600         SET DP013-CICS-ABEND                                     37940000
379700             DP013-NO-ROLLBACK     TO TRUE                        37950000
379800         MOVE '9200-REWRITE-SEL-QUEUE'                            37960000
379900                                   TO DP013-PARAGRAPH             37970000
380000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   37980000
380100                                   TO DP013-MESSAGE-TEXT (1)      37990000
380200         PERFORM DP013-0000-PROCESS-ABEND                         38000000
380300     END-IF.                                                      38010000
380400                                                                  38020000
380500                                                                  38030000
380600*----------------------------------------------------------------*38040000
380700*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *38050000
380800*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *38060000
380900*----------------------------------------------------------------*38070000
381000 9900-SOFT-ABORT.                                                 38080000
381100                                                                  38090000
381200     EXEC CICS SYNCPOINT                                          38100000
381300          ROLLBACK                                                38110000
381400     END-EXEC.                                                    38120000
381500                                                                  38130000
381600     SET  PS-ERROR                                                38140000
381700          PS-SOFT-ABORT-ERROR                                     38150000
381800          DP020-MSG-FATAL       TO  TRUE.                         38160000
381900                                                                  38170000
382000                                                                  38180000
382100*----------------------------------------------------------------*38190000
382200*    ABEND PROCESSOR MODULE                                      *38200000
382300*----------------------------------------------------------------*38210000
382400                                                                  38220000
382500     COPY DPPD013.                                                38230000
