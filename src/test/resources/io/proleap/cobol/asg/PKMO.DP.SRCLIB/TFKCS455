      ******************************************************************00050078
       IDENTIFICATION DIVISION.                                         00060078
       PROGRAM-ID.    TFKCS455.                                         00070078
       AUTHOR.        JACK KRAMER.                                      00080078
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00090078
       DATE-WRITTEN.  DECEMBER 1996.                                    00100078
       DATE-COMPILED.                                                   00110078
      *---------------------------------------------------------------* 00120078
      *    P473 - TRANSFER DISCREPANCY REPORT.                        * 00130078
      *                                                               * 00140078
      *    THIS PROGRAM PRODUCES A DISCREPANCY REPORT FOR THE         * 00150078
      *    SPECIFIED TRANSFER.                                        * 00160078
      *---------------------------------------------------------------* 00170078
      *  1/20/2003 - RAY GRAF                                           00180078
      *   PROCESS NONINTELLIGENT SKU.                                   00190078
      ******************************************************************00200078
051203**DATE:05/12/2003 CHANGED BY: JULIE TEWES   DUMMY SKU CHANGES     00210078
      ******************************************************************00220078
080204**DATE:08/02/2004 CHANGED BY: RAY GRAF                            00221083
080204**     CHANGE PRINTER DESTINATION TO NEW 8 CHARACTER FORMAT       00222083
      ***************************************************************** 00223083
100404**DATE:10/04/2004 CHANGED BY: RAY GRAF                            00224084
100404**     EXPAND STORE NUMBER.  MAKE DOMAIN COMPLIANT.               00225084
      ***************************************************************** 00226084
SR3403* SR3403  -  JALAJ KUMAR  - 03/20/2012                            00228093
SR3403*            CHANGES FOR LARGE RETAIL PROJECT                     00229093
SR3403***************************************************************** 00229193
CICS  * CHANGED 11/17/2022    BY JIM HUNTER      WR: CHG0278345         00229296
CICS  * THIS PROGRAM DOES NOT CALL THE CICS ARCHITECTURE - REMOVE       00229396
CICS  * COPYBOOK DPWS030.                                               00229496
CICS  *-----------------------------------------------------------------00229596
       ENVIRONMENT DIVISION.                                            00230078
       DATA DIVISION.                                                   00240078
       WORKING-STORAGE SECTION.                                         00250078
                                                                        00260078
       01  DK-DB2-KEYS.                                                 00270078
           05  DK-FROM-STORE-NBR        PIC S9(04)  COMP  VALUE +0.     00280078
           05  DK-STORE-NBR             PIC S9(04)  COMP  VALUE +0.     00290078
           05  DK-XFER-SEQ-NBR          PIC S9(09)  COMP  VALUE +0.     00300078
           05  DK-XFER-DKEY-ID          PIC S9(09)  COMP  VALUE +0.     00310078
      *---------------------------------------------------------------* 00320078
      **PROGRAM CONSTANTS                                               00330078
      *---------------------------------------------------------------* 00340078
       01  PC-PROGRAM-CONSTANTS.                                        00350078
           05 PC-099                    PIC  9(03)  VALUE 099.          00360078
           05 PC-100                    PIC  9(03)  VALUE 100.          00370078
           05 PC-INIT                   PIC  X(04)  VALUE 'INIT'.       00380078
           05 PC-PUT                    PIC  X(04)  VALUE 'PUT'.        00390078
           05 PC-TERM                   PIC  X(04)  VALUE 'TERM'.       00400078
           05  PC-TOP-OF-PAGE              PIC  X(01)  VALUE '1'.       00410078
           05  PC-SINGLE-SPACE             PIC  X(01)  VALUE ' '.       00420078
           05  PC-DOUBLE-SPACE             PIC  X(01)  VALUE '0'.       00430078
           05  PC-TRIPLE-SPACE             PIC  X(01)  VALUE '-'.       00440078
           05  PC-PAGE-MAX                 PIC S9(02)  VALUE +60        00450078
                                                          COMP-3.       00460078
           05  PC-LINE-MAX                    PIC S9(02)  VALUE +60     00470078
                                                          COMP-3.       00480078
           05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00490078
                                                          'TFKCS455'.   00500078
           05  PC-POSITIVE-RECEIPT            PIC X(02)    VALUE 'PR'.  00510078
           05  PC-TRAILER                     PIC X(02)    VALUE '04'.  00520078
           05  PC-LG-TOTE-SEAL1-LITERAL       PIC X(15)  VALUE          00530078
               'LG TOTE SEAL 1:'.                                       00540078
           05  PC-LG-TOTE-SEAL2-LITERAL       PIC X(15)  VALUE          00550078
               'LG TOTE SEAL 2:'.                                       00560078
           05  PC-SM-TOTE-SEAL-LITERAL        PIC X(15)  VALUE          00570078
               'SM TOTE SEAL  :'.                                       00580078
           05  PC-TRLR-NBR-LITERAL            PIC X(15)  VALUE          00590078
               'TRAILER NBR   :'.                                       00600078
           05  PC-TRLR-SEAL-LITERAL           PIC X(15)  VALUE          00610078
               'TRAILER SEAL  :'.                                       00620078
           05  PC-TRANSFERED-LITERAL          PIC X(15)  VALUE          00630078
               'TRANSFERED'.                                            00640078
           05  PC-RECEIVED-LITERAL            PIC X(15)  VALUE          00650078
               'RECEIVED'.                                              00660078
      *---------------------------------------------------------------* 00670078
      **ERROR MESSAGES                                                  00680078
      *---------------------------------------------------------------* 00690078
           05  PC-RETRIEVE-MSG                 PIC  X(28)  VALUE        00700078
               'CICS ERROR IN PASSING DATA. '.                          00710078
           05  PC-CONTENTION-MSG               PIC  X(36)  VALUE        00720078
               'SYSTEM IS BUSY.  PLEASE TRY AGAIN.'.                    00730078
           05  PC-GET-TRANSFER-MSG             PIC  X(33)  VALUE        00740078
               'ERROR READING THE TRANSFER MASTER'.                     00750078
           05  PC-GET-STORE-MSG                PIC  X(29)  VALUE        00760078
               'ERROR READING THE STORE TABLE'.                         00770078
           05  PC-DISCREPANCY-MSG              PIC  X(44)  VALUE        00780078
               'ERROR READING THE TRANSFER DISCREPANCY TABLE'.          00790078
           05  PC-OPEN-CSR-MSG                 PIC  X(41)  VALUE        00800078
               'ERROR OPENING THE DISCREPANCY ITEM CURSOR'.             00810078
           05  PC-OPEN-RECEIPT-MSG             PIC  X(37)  VALUE        00820078
               'ERROR OPENING THE ITEM RECEIPT CURSOR'.                 00830078
           05  PC-CLOSE-CSR-MSG                PIC  X(41)  VALUE        00840078
               'ERROR CLOSING THE ITEM DISCREPANCY CURSOR'.             00850078
           05  PC-CLOSE-RECEIPT-MSG            PIC  X(37)  VALUE        00860078
               'ERROR CLOSING THE ITEM RECEIPT CURSOR'.                 00870078
           05  PC-FETCH-CSR-MSG                PIC  X(41)  VALUE        00880078
               'ERROR READING THE ITEM DISCREPANCY CURSOR'.             00890078
           05  PC-FETCH-RECEIPT-MSG            PIC  X(37)  VALUE        00900078
               'ERROR READING THE ITEM RECEIPT CURSOR'.                 00910078
           05  PC-READ-TRANSFER-RECEIPT-MSG    PIC  X(40)  VALUE        00920078
               'ERROR READING THE TRANSFER RECEIPT TABLE'.              00930078
           05  PC-READ-TRANSFER-TOTAL-MSG      PIC  X(33)  VALUE        00940078
               'ERROR READING THE TRANSFER TOTALS'.                     00950078
           05  PC-READ-RECEIPT-TOTAL-MSG       PIC  X(32)  VALUE        00960078
               'ERROR READING THE RECEIPT TOTALS'.                      00970078
           05  PC-READ-ADJUSTMENTS-MSG         PIC  X(33)  VALUE        00980078
               'ERROR READING POSTING ADJUSTMENTS'.                     00990078
           05  PC-ABEND-MESSAGE                PIC  X(62)  VALUE        01000078
                '  ***** ABEND   ABEND   ABEND   ABEND   ABEND ***'.    01010078
      *---------------------------------------------------------------- 01020078
      **PRORGRAM SWITCHES                                               01030078
      *---------------------------------------------------------------* 01040078
       01  PS-PROGRAM-SWITCHES.                                         01050078
           05  PS-TRANSFER-FOUND-SW     PIC X.                          01060078
               88  PS-TRANSFER-FOUND             VALUE 'Y'.             01070078
               88  PS-TRANSFER-NOT-FOUND         VALUE 'N'.             01080078
           05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01090078
               88  PS-NO-ERROR                            VALUE 'Y'.    01100078
               88  PS-ERROR                               VALUE 'N'.    01110078
           05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01120078
               88  PS-DONE                                VALUE 'Y'.    01130078
               88  PS-NOT-DONE                            VALUE 'N'.    01140078
           05  PS-FIRST-LINE-SW               PIC  X(01)  VALUE 'N'.    01150078
               88  PS-FIRST-LINE                          VALUE 'Y'.    01160078
               88  PS-NOT-FIRST-LINE                      VALUE 'N'.    01170078
           05  PS-SEAL-DISCREPANCY-SW         PIC X(01)   VALUE 'N'.    01180078
               88  PS-SEAL-DISCREPANCY                    VALUE 'Y'.    01190078
           05  PS-DISCREPANCY-SW         PIC X(01)        VALUE 'N'.    01200078
               88  PS-HDR-DISCREPANCY-EXISTS              VALUE 'H'.    01210078
               88  PS-DTL-DISCREPANCY-EXISTS              VALUE 'D'.    01220078
               88  PS-NO-DISCREPANCY-EXISTS               VALUE 'N'.    01230078
           05  PS-ITEMS-LEFT-INDICATOR               PIC  X(01).        01240078
               88  PS-ITEMS-LEFT-ON-DB                    VALUE 'Y'.    01250078
               88  PS-NO-ITEMS-LEFT-ON-DB                 VALUE 'N'.    01260078
           05  PS-ITEMS-LEFT-INDICATOR-2             PIC  X(01).        01270078
               88  PS-ITEMS-LEFT-ON-DB-2                  VALUE 'Y'.    01280078
               88  PS-NO-ITEMS-LEFT-ON-DB-2               VALUE 'N'.    01290078
           05  PS-DRS-INITIALIZED-SW           PIC  X      VALUE 'N'.   01300078
               88  PS-DRS-INITIALIZED                      VALUE 'Y'.   01310078
               88  PS-DRS-NOT-INITIALIZED                  VALUE 'N'.   01320078
           05  PS-CONTENTION-SW                PIC  X(01)  VALUE 'N'.   01330078
               88  PS-CONTENTION                           VALUE 'Y'.   01340078
      *---------------------------------------------------------------* 01350078
      **PROGRAM VARIABLES                                               01360078
      *---------------------------------------------------------------* 01370078
       01  PRV-PROGRAM-RETURN-VARIABLES.                                01380078
           05  PRV-01                       PIC X(42) VALUE             01390078
               '01-ERROR - RETRIEVE COMMAREA DATA.       '.             01400078
           05  PRV-02                       PIC X(42) VALUE             01410078
               '02-DB2 ERROR READING TRANSFER MASTER     '.             01420078
           05  PRV-03                       PIC X(42) VALUE             01430078
               '03-DB2 ERROR READING DISCREPANCY TABLE   '.             01440078
           05  PRV-04                       PIC X(42) VALUE             01450078
               '04-DB2 ERROR READING THE STORE TABLE     '.             01460078
           05  PRV-05                       PIC X(42) VALUE             01470078
               '05-DB2 ERROR OPENING DISCREPANCY CURSOR  '.             01480078
           05  PRV-06                       PIC X(42) VALUE             01490078
               '06-DB2 ERROR CLOSING DISCREPANCY CURSOR  '.             01500078
           05  PRV-07                       PIC X(42) VALUE             01510078
               '07-DB2 ERROR FETCHING DISCREPANCY CURSOR '.             01520078
           05  PRV-08                       PIC X(42) VALUE             01530078
               '08-DB2 ERROR READING POSTING ASDJUSTMENTS'.             01540078
           05  PRV-09                       PIC X(42) VALUE             01550078
               '09-DB2 ERROR READING ITEM RECEIPTS       '.             01560078
           05  PRV-10                       PIC X(42) VALUE             01570078
               '10-DB2 ERROR OPENING THE RECEIPT CURSOR  '.             01580078
           05  PRV-11                       PIC X(42) VALUE             01590078
               '11-DB2 ERROR FETCHING THE RECEIPT CURSOR '.             01600078
           05  PRV-12                       PIC X(42) VALUE             01610078
               '12-DB2 ERROR CLOSING THE RECEIPT CURSOR  '.             01620078
           05  PRV-13                       PIC X(42) VALUE             01630078
               '13-DB2 ERROR READING TRANSFER RECEIPT    '.             01640078
           05  PRV-14                       PIC X(42) VALUE             01650078
               '14-DB2 ERROR READING TRANSFER TOTALS     '.             01660078
           05  PRV-15                       PIC X(42) VALUE             01670078
               '15-DB2 ERROR READING RECEIPT TOTALS      '.             01680078
051203     05  PRV-16                       PIC X(42) VALUE             01690079
051203         '16-DB2 ERROR DUMMY UPC D/M/S             '.             01700079
       01  PV-PROGRAM-VARIABLES.                                        01710078
           05  PV-PRINTER-DEST.                                         01720078
080204         10  FILLER                     PIC X(01).                01721083
080204         10  PV-PRINTER-STORE-LOC       PIC X(05).                01722083
080204         10  FILLER                     PIC X(02).                01723083
           05  PV-ABSTIME                     PIC S9(16)    VALUE +0.   01750083
           05  PV-LINE-COUNT                  PIC  S9(03)   VALUE +0.   01760083
           05  PV-PAGE-COUNT                  PIC  S9(03)   VALUE +0.   01770083
           05  PV-XFER-TOTAL                  PIC S9(08)V99 VALUE +0    01780083
                                                            COMP-3.     01790083
           05  PV-RCVD-TOTAL                  PIC S9(08)V99 VALUE +0    01800083
                                                            COMP-3.     01810083
           05  PV-XFER-IND                    PIC S9(04)    VALUE +0    01820083
                                                    COMP SYNC.          01830078
           05  PV-RCVD-IND                    PIC S9(04)  VALUE +0      01840078
                                                    COMP SYNC.          01850078
           05  PV-VARIANCE                    PIC S9(08)V99  VALUE +0   01860078
                                                          COMP-3.       01870078
           05  PV-EDITTED-VARIANCE-FIELD.                               01880078
               10  PV-EDIT-V-PAREN-1          PIC X       VALUE SPACE.  01890078
SR3403         10  PV-EDITTED-VARIANCE        PIC ZZZZ9.99.             01901093
               10  PV-EDIT-V-PAREN-2          PIC X       VALUE SPACE.  01910078
           05  PV-EDITTED-NET-DISCREP-FIELD.                            01920078
               10  PV-EDIT-D-PAREN-1          PIC X       VALUE SPACE.  01930078
               10  PV-EDITTED-NET-DISCREP     PIC ZZZZZ9.99.            01940078
               10  PV-EDIT-D-PAREN-2          PIC X       VALUE SPACE.  01950078
           05  PV-ERROR-KEY                    PIC  X(25)  VALUE SPACE. 01960078
           05  PV-STORE-ERROR.                                          01970078
               10  FILLER                     PIC X(08)   VALUE         01980078
                   'STORE ='.                                           01990078
               10  PV-STORE                   PIC Z999.                 02000078
           05  PV-SUB                         PIC S9(04)  VALUE +0      02010078
                                                          COMP SYNC.    02020078
           05  PV-SAVE-SUB                    PIC S9(04)  VALUE +0      02030078
                                                          COMP SYNC.    02040078
           05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02050078
                                                          COMP SYNC.    02060078
           05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02070078
                                                          COMP-3.       02080078
           05  PV-CICS-RESPONSE               PIC S9(04)  VALUE +0      02090078
                                                          COMP SYNC.    02100078
           05  PV-ITEM                        PIC S9(04)  VALUE +0      02110078
                                                          COMP SYNC.    02120078
           05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02130078
                                                          COMP SYNC.    02140078
           05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02150078
                                                          COMP SYNC.    02160078
           05  PV-RETRY-COUNT                 PIC S9(04)  VALUE +0      02170078
                                                          COMP SYNC.    02180078
           05  PV-ITEMS-READ                  PIC S9(04)  VALUE +0      02190078
                                                          COMP SYNC.    02200078
           05  PV-ERROR-MSG                    PIC  X(50) VALUE SPACE.  02210078
SR3403     05  PV-CICS-APPL-ID.                                         02211093
SR3403         10  FILLER                     PIC X(4).                 02212093
SR3403         10  PV-CICS-REGION-ENVIRONMENT PIC X.                    02213093
SR3403             88  PV-CR-PRODUCTION            VALUE 'P'.           02214093
SR3403         10  PV-FILLER                  PIC X(3).                 02215093
           05  PV-DISPLAY-KEYS.                                         02220078
               10  PV-DISPLAY-USER-ID          PIC  X(08)  VALUE SPACE. 02230078
               10  FILLER                      PIC  X(02)  VALUE SPACE. 02240078
               10  PV-DISPLAY-XFER-FROM-STORE-NBR                       02250078
100404*                                        PIC  X(03)  VALUE SPACE. 02260084
100404                                         PIC  9(04)  VALUE ZEROS. 02261090
               10  FILLER                      PIC  X(01)  VALUE '-'.   02270078
               10  PV-DISPLAY-XFER-SEQ-NBR     PIC  X(06)  VALUE SPACE. 02280078
               10  FILLER                      PIC  X(02)  VALUE SPACE. 02290078
080204         10  PV-DISPLAY-PRINTER-DEST     PIC  X(08)  VALUE SPACE. 02300083
051203     10  PV-KOHLS-INTERNAL-UPC-NBR      PIC  9(13).               02310078
051203     10  PV-HOLD-UPC-NBR.                                         02320078
051203         15  PV-KOHLS-UPC-DIGITS         PIC X(06).               02330078
051203         15  PV-KOHLS-DEPT               PIC 9(03).               02340078
051203         15  PV-KOHLS-CL.                                         02350078
051203             20  PV-KOHLS-CL-1           PIC 9(01).               02360078
051203             20  PV-KOHLS-CL-2           PIC 9(01).               02370078
051203         15  PV-KOHLS-CL-9 REDEFINES PV-KOHLS-CL      PIC 9(02).  02380078
051203         15  PV-KOHLS-DUMMY-SKU          PIC X(03).               02390078
051203         15  PV-KOHLS-CHECKDIGIT         PIC X(01).               02400078
051203     10  PV-HOLD-UPC-NBR-9 REDEFINES PV-HOLD-UPC-NBR  PIC 9(15).  02410078
      ******************************************************************02420078
      **REPORT HEADINGS                                                 02430078
      ******************************************************************02440078
           COPY DPWS132O.                                               02450078
       01  HL2-HEADING-LINE-2.                                          02460078
           05  FILLER                          PIC  X(55)  VALUE SPACE. 02470078
           05  FILLER                          PIC  X(30)  VALUE        02480078
               'TRANSFER DISCREPANCY'.                                  02490078
                                                                        02500078
       01  HL3-HEADING-LINE-3.                                          02510078
           05  FILLER                          PIC  X(02)  VALUE SPACE. 02520078
100404*    05  FILLER                          PIC  X(17)  VALUE        02530084
100404*         'TRANSFER NO....:'.                                     02530184
100404     05  FILLER                          PIC  X(16)  VALUE        02531087
100404          'TRANSFER NO...:'.                                      02541087
100404*    05  HL3-XFER-FROM-STORE             PIC  X(03)  VALUE SPACE. 02550084
100404     05  HL3-XFER-FROM-STORE             PIC  9(04)  VALUE ZEROS. 02551091
           05  FILLER                          PIC  X(01)  VALUE '-'.   02560078
           05  HL3-XFER-SEQ-NBR                PIC  X(06)  VALUE SPACE. 02570078
           05  FILLER                          PIC  X(24)  VALUE SPACE. 02580078
           05  FILLER                          PIC  X(15)  VALUE        02590084
               'FROM    STORE:'.                                        02600078
100404*    05  HL3-FR-STORE-NBR                PIC  999.                02610084
100404     05  HL3-FR-STORE-NBR                PIC  9999.               02611087
           05  FILLER                          PIC  X      VALUE SPACE. 02620078
           05  HL3-FR-STORE-NAME               PIC  X(10).              02630078
           05  FILLER                          PIC  X(20)  VALUE SPACE. 02640078
           05  HL3-SEAL-LITERAL1               PIC  X(10)  VALUE SPACE. 02650078
           05  FILLER                          PIC  X(01)  VALUE SPACE. 02660078
           05  HL3-SEAL-LITERAL2               PIC  X(10)  VALUE SPACE. 02670078
                                                                        02680078
       01  HL4-HEADING-LINE-4.                                          02690078
           05  FILLER                          PIC  X(53)  VALUE SPACE. 02700078
           05  FILLER                          PIC  X(15)  VALUE        02710078
               'TO      STORE:'.                                        02720078
100404*    05  HL4-TO-STORE-NBR                PIC  999.                02730084
100404     05  HL4-TO-STORE-NBR                PIC  9999.               02731087
           05  FILLER                          PIC  X      VALUE SPACE. 02740078
           05  HL4-TO-STORE-NAME               PIC  X(10).              02750078
           05  FILLER                          PIC  X(05)  VALUE SPACE. 02760078
           05  HL4-SEAL-LITERAL                PIC  X(15)  VALUE SPACE. 02770078
           05  FILLER                          PIC  X(01)  VALUE SPACE. 02780078
           05  HL4-SEAL-1                      PIC  X(08)  VALUE SPACE. 02790078
           05  FILLER                          PIC  X(02)  VALUE SPACE. 02800078
           05  HL4-SEAL-2                      PIC  X(08)  VALUE SPACE. 02810078
                                                                        02820078
       01  HL5-HEADING-LINE-5.                                          02830078
           05  FILLER                          PIC  X(02)  VALUE SPACE. 02840078
           05  FILLER                          PIC  X(24)  VALUE        02850078
                'NET RETAIL DISCREPANCY:'.                              02860078
           05  HL5-NET-DISCREP                 PIC  X(11).              02870078
           05  FILLER                          PIC  X(16)  VALUE SPACE. 02880078
           05  FILLER                          PIC  X(15)  VALUE        02890078
               'RECEIVE STORE:'.                                        02900078
100404*    05  HL5-RC-STORE-NBR                PIC  999.                02910084
100404     05  HL5-RC-STORE-NBR                PIC  9999.               02911087
           05  FILLER                          PIC  X      VALUE SPACE. 02920078
           05  HL5-RC-STORE-NAME               PIC  X(10).              02930078
           05  FILLER                          PIC  X(05)  VALUE SPACE. 02940078
           05  HL5-SEAL-LITERAL                PIC  X(15)  VALUE SPACE. 02950078
           05  FILLER                          PIC  X(01)  VALUE SPACE. 02960078
           05  HL5-SEAL-1                      PIC  X(08)  VALUE SPACE. 02970078
           05  FILLER                          PIC  X(02)  VALUE SPACE. 02980078
           05  HL5-SEAL-2                      PIC  X(08)  VALUE SPACE. 02990078
                                                                        03000078
       01  HL6-HEADING-LINE-6.                                          03010078
           05  FILLER                          PIC  X(87)  VALUE SPACE. 03020078
           05  HL6-SEAL-LITERAL                PIC  X(15)  VALUE SPACE. 03030078
           05  FILLER                          PIC  X(01)  VALUE SPACE. 03040078
           05  HL6-SEAL-1                      PIC  X(08)  VALUE SPACE. 03050078
           05  FILLER                          PIC  X(02)  VALUE SPACE. 03060078
           05  HL6-SEAL-2                      PIC  X(08)  VALUE SPACE. 03070078
                                                                        03080078
       01  HL7-HEADING-LINE-7.                                          03090078
           05  FILLER                          PIC  X(44)  VALUE SPACE. 03100078
           05  FILLER                          PIC  X(15)  VALUE        03110078
             '--TRANSFER--'.                                            03120078
           05  FILLER                          PIC  X(13)  VALUE        03130078
             '--RECEIVED--'.                                            03140078
                                                                        03150078
       01  HL8-HEADING-LINE-8.                                          03160078
           05  FILLER                          PIC  X(09)  VALUE SPACE. 03170078
           05  FILLER                          PIC  X(05)  VALUE 'LN'.  03180078
           05  FILLER                          PIC  X(14)  VALUE        03190078
             'D/M/S     '.                                              03200078
           05  FILLER                          PIC  X(16)  VALUE 'UPC'. 03210078
           05  FILLER                          PIC  X(15)  VALUE        03220078
             'QTY    PRICE'.                                            03230078
           05  FILLER                          PIC  X(16)  VALUE        03240078
             'QTY    PRICE'.                                            03250078
           05  FILLER                          PIC  X(10)  VALUE        03260078
             'VARIANCE'.                                                03270078
                                                                        03280078
       01  DL1-DETAIL-LINE-1.                                           03290078
           05  FILLER                          PIC  X(04)  VALUE SPACE. 03300078
           05  DL1-ACTION                      PIC  X(03)  VALUE SPACE. 03310078
           05  FILLER                          PIC  X(01)  VALUE SPACE. 03320078
           05  DL1-LINE                        PIC  ZZ9.                03330078
           05  FILLER                          PIC  X(03)  VALUE SPACE. 03340078
           05  DL1-DPT-CL-SUBCL.                                        03350078
               10  DL1-DEPT                   PIC 999.                  03360078
               10  FILLER                     PIC X(01)   VALUE SPACE.  03370078
               10  DL1-GROUP-1.                                         03380078
                   15 DL1-CLASS-1             PIC 99      VALUE ZEROS.  03390078
                   15 FILLER                  PIC X(01)   VALUE SPACE.  03400078
                   15 DL1-SUBCLASS-1          PIC 99      VALUE ZEROS.  03410078
                   15 FILLER                  PIC X(02)   VALUE SPACE.  03420078
               10  DL1-GROUP-2 REDEFINES DL1-GROUP-1.                   03430078
                   15 DL1-CLASS-2             PIC  99.                  03440078
                   15 DL1-FILLER-2A           PIC  X(01).               03450078
                   15 DL1-SUBCLASS-2          PIC  999.                 03460078
                   15 DL1-FILLER-2B           PIC  X(01).               03470078
               10  DL1-GROUP-3 REDEFINES DL1-GROUP-1.                   03480078
                   15 DL1-CLASS-3             PIC  999.                 03490078
                   15 DL1-FILLER-3A           PIC  X(01).               03500078
                   15 DL1-SUBCLASS-3          PIC  99.                  03510078
                   15 DL1-FILLER-3B           PIC  X(01).               03520078
               10  DL1-GROUP-4 REDEFINES DL1-GROUP-1.                   03530078
                   15 DL1-CLASS-4             PIC  999.                 03540078
                   15 DL1-FILLER-4A           PIC  X(01).               03550078
                   15 DL1-SUBCLASS-4          PIC  999.                 03560078
           05  FILLER                          PIC  X(02)  VALUE SPACE. 03570078
           05  DL1-UPC                         PIC  99B99999B99999B9.   03580078
           05  FILLER REDEFINES DL1-UPC.                                03590078
               10                              PIC X(02).               03600078
               10  DL1-UPC-DASH-1              PIC X.                   03610078
               10                              PIC X(05).               03620078
               10  DL1-UPC-DASH-2              PIC X.                   03630078
               10                              PIC X(05).               03640078
               10  DL1-UPC-DASH-3              PIC X.                   03650078
               10                              PIC X(01).               03660078
           05  FILLER                          PIC  X(01)  VALUE SPACE. 03670078
           05  DL1-TQTY                        PIC  ZZZ.                03680078
SR3403     05  FILLER                          PIC  X(01)  VALUE SPACE. 03691093
SR3403     05  DL1-TPRICE                      PIC  ZZZZZ.ZZ.           03701093
           05  FILLER                          PIC  X(03)  VALUE SPACE. 03710078
           05  DL1-RQTY                        PIC  ZZZ.                03720078
SR3403     05  FILLER                          PIC  X(01)  VALUE SPACE. 03731093
SR3403     05  DL1-RPRICE                      PIC  ZZZZZ.ZZ.           03741093
           05  FILLER                          PIC  X(03)  VALUE SPACE. 03750078
           05  DL1-VARIANCE                    PIC  X(11).              03760078
           05  FILLER                          PIC  X(03)  VALUE SPACE. 03770078
                                                                        03780078
       01  EH1-ERROR-HEADING-1.                                         03790078
           05  EH1-RUN-DATE                PIC  X(08)  VALUE SPACES.    03800078
           05  FILLER                      PIC  X(02)  VALUE SPACES.    03810078
           05  EH1-RUN-TIME                PIC  X(08)  VALUE SPACES.    03820078
           05  FILLER                      PIC  X(10)  VALUE SPACES.    03830078
           05  FILLER                      PIC  X(48)  VALUE            03840078
               'KOHL''S TRANSFER DISCREPANCY PRINT REQUEST ERROR'.      03850078
                                                                        03860078
       01  EH2-ERROR-HEADING-2.                                         03870078
           05  FILLER                      PIC  X(28)  VALUE            03880078
               'PRINT REQUEST FOR TRANSFER:'.                           03890078
100404*    05  EH2-FROM-STORE-NBR          PIC  X(03).                  03900084
100404     05  EH2-FROM-STORE-NBR          PIC  9(04).                  03901090
           05  FILLER                      PIC  X(01)  VALUE '-'.       03910078
           05  EH2-XFER-SEQ-NBR            PIC  X(06).                  03920078
           05  FILLER                      PIC  X(03)  VALUE SPACE.     03930078
           05  FILLER                      PIC  X(14)  VALUE            03940078
               'REQUESTED BY:'.                                         03950078
           05  EH2-USER-ID                 PIC  X(08)  VALUE SPACE.     03960078
           05  FILLER                      PIC  X(02)  VALUE SPACE.     03970078
           05  FILLER                      PIC  X(40)  VALUE            03980078
               'WAS CANCELLED FOR THE FOLLOWING REASON:'.               03990078
                                                                        04000078
       01  ED1-ERROR-DETAIL-1.                                          04010078
           05  ED1-ERROR                   PIC  X(50)  VALUE SPACE.     04020078
           05  FILLER                      PIC  X(02)  VALUE SPACE.     04030078
           05  FILLER                      PIC  X(02)  VALUE SPACE.     04040078
           05  ED1-ERROR-KEY               PIC  X(25)  VALUE SPACE.     04050078
                                                                        04060078
       01  ED2-ERROR-DETAIL-2.                                          04070078
           05  ED2-MESSAGE                 PIC  X(35)  VALUE SPACE.     04080078
                                                                        04090078
       01  BL-BLANK-LINE.                                               04100078
           05  FILLER                          PIC  X(80)  VALUE SPACE. 04110078
                                                                        04120078
       01  ND-NO-DISCREP-LINE.                                          04130078
           05  FILLER                          PIC  X(35)  VALUE SPACE. 04140078
           05  FILLER                          PIC  X(40)  VALUE        04150078
             'NO DISCREPANCIES EXIST FOR THIS TRANSFER'.                04160078
                                                                        04170078
       01  ND-NO-DETAIL-LINE.                                           04180078
           05  FILLER                          PIC  X(35)  VALUE SPACE. 04190078
           05  FILLER                          PIC  X(50)  VALUE        04200078
             'NO DETAIL DISCREPANCIES EXIST FOR THIS TRANSFER'.         04210078
      *---------------------------------------------------------------* 04220078
      **COPYBOOKS                                                       04230078
      *---------------------------------------------------------------* 04240078
                                                                        04241083
      ** RF COPYBOOK TO FORMAT PRINTER DESTINATION                      04243083
080204     COPY RFWS009.                                                04246083
      **ATTRIBUTE SETTINGS COPYBOOK                                     04250078
           COPY DPWS015.                                                04260083
      **NUMERIC EDIT LAYOUT                                             04270078
           COPY DPWS010I.                                               04280083
      **STANDARD COMMAREA                                               04310078
           COPY DPWS020.                                                04320083
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04330078
      *---------------------------------------------------------------* 04340078
      * INTER-APPLICATION COMMAREA.                                   * 04350078
      *   TFWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04360078
      *             SPEC SCREEN.                                      * 04370078
      *   TFWS003 - IS THE OUTPUT LAYOUT PASSED FOR A LOCAL-GO        * 04380078
      *             FUNCTION.                                         * 04390078
      *---------------------------------------------------------------* 04400078
               10  INTER-APPL-COMM-AREA       PIC X(200).               04410078
      **LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA             04420078
           COPY DRRD001O.                                               04430083
      **LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES         04440078
           COPY DRRD002O.                                               04450083
      **LAYOUT FOR THE DRS TERMINATION BLOCK                            04460078
           COPY DRRD007.                                                04470083
                                                                        04480078
           COPY TFWS005.                                                04490083
      **ABEND PROCESSING COPYBOOK                                       04500078
      *---------------------------------------------------------------* 04510078
           COPY DPWS013.                                                04520083
      *---------------------------------------------------------------* 04530078
      **TABLE INCLUSIONS                                                04540078
      *---------------------------------------------------------------* 04550078
      **DB2 AREA FOR THE TRANSFER TABLE                                 04560078
           EXEC SQL                                                     04570078
                INCLUDE TTFMSTR                                         04580078
           END-EXEC.                                                    04590078
      **DB2 AREA FOR THE TRANSFER ITEM TABLE                            04600078
           EXEC SQL                                                     04610078
                INCLUDE TTFITEM                                         04620078
           END-EXEC.                                                    04630078
      **DB2 AREA FOR THE TRANSFER ITEM RECEIPT TABLE                    04640078
           EXEC SQL                                                     04650078
                INCLUDE TTFITRC                                         04660078
           END-EXEC.                                                    04670078
      **DB2 AREA FOR THE TRANSFER STATUS TABLE                          04680078
           EXEC SQL                                                     04690078
                INCLUDE TTFSTAT                                         04700078
           END-EXEC.                                                    04710078
      **DB2 AREA FOR THE TRANSFER ADJUSTMENT REASON CODE TABLE          04720078
           EXEC SQL                                                     04730078
                INCLUDE TTFAJRS                                         04740078
           END-EXEC.                                                    04750078
      **DB2 AREA FOR THE TRANSFER ITEM POSTING TABLE                    04760078
           EXEC SQL                                                     04770078
                INCLUDE TTFITPS                                         04780078
           END-EXEC.                                                    04790078
      **DB2 AREA FOR THE TRANSFER RECEIPT TABLE                         04800078
           EXEC SQL                                                     04810078
                INCLUDE TTFRCPT                                         04820078
           END-EXEC.                                                    04830078
      **DB2 AREA FOR THE TRANSFER DISCREPANCY TABLE                     04840078
           EXEC SQL                                                     04850078
                INCLUDE TTFDSCP                                         04860078
           END-EXEC.                                                    04870078
      **DB2 AREA FOR THE SKU CROSS REFERENCE TABLE                      04920078
           EXEC SQL                                                     04930078
                INCLUDE TSKXREF                                         04940078
           END-EXEC.                                                    04950078
      **DB2 AREA FOR THE XST_LOC TABLE                                  04951085
           EXEC SQL                                                     04952085
                INCLUDE XST00001                                        04953085
           END-EXEC.                                                    04954085
      **DB2 AREA FOR COMMUNICATIONS                                     04960078
           EXEC SQL                                                     04970078
                INCLUDE SQLCA                                           04980078
           END-EXEC.                                                    04990078
      *---------------------------------------------------------------* 05000078
      **DISCREPANCY CURSOR                                              05010078
      *---------------------------------------------------------------* 05020078
           EXEC SQL                                                     05030078
                DECLARE DISCREP-CSR CURSOR FOR                          05040078
                   SELECT DISTINCT                                      05050078
                          I.XFER_LNE_NBR                                05060078
                        , KOHLS_UPC_NBR                                 05070078
051203                  , SCN_UPC_NBR                                   05080080
                        , XFER_PRIC_AMT                                 05090078
                        , XFER_QTY                                      05100078
051203                  , ITM_NBR                                       05110078
                    FROM  TTFITEM I                                     05120078
                        , TTFITRC R                                     05130078
                        , TTFSTAT S                                     05140078
                    WHERE I.XFER_DKEY_ID    = :DK-XFER-DKEY-ID          05150078
                      AND R.XFER_DKEY_ID    = :DK-XFER-DKEY-ID          05160078
                      AND S.XFER_DKEY_ID    = :DK-XFER-DKEY-ID          05170078
                      AND S.XFER_STAT_CDE   = :PC-POSITIVE-RECEIPT      05180078
                      AND S.XFER_STAT_TMST  = R.XFER_RCPT_TMST          05190078
                      AND R.XFER_LNE_NBR    = I.XFER_LNE_NBR            05200078
                      AND R.XFER_ITM_DSCRP_IND = 'Y'                    05210078
                    ORDER BY                                            05220078
                          I.XFER_LNE_NBR                                05230078
                    WITH UR                                             05231084
           END-EXEC.                                                    05240078
      *---------------------------------------------------------------* 05250078
      **CURSOR TO RETRIEVE TRANSFER RECEIPT ITEMS                       05260078
      *---------------------------------------------------------------* 05270078
           EXEC SQL                                                     05280078
                DECLARE XFER-RECEIPT-CSR CURSOR FOR                     05290078
                SELECT RCVD_XFER_PRIC_AMT                               05300078
                     , RCVD_XFER_QTY                                    05310078
                FROM   TTFITRC I                                        05320078
                     , TTFSTAT S                                        05330078
                WHERE  I.XFER_DKEY_ID     = :DK-XFER-DKEY-ID            05340078
                   AND S.XFER_DKEY_ID     = :DK-XFER-DKEY-ID            05350078
                   AND S.XFER_STAT_CDE    = :PC-POSITIVE-RECEIPT        05360078
                   AND S.XFER_STAT_TMST   = I.XFER_RCPT_TMST            05370078
                   AND RCVD_XFER_PRIC_AMT <> :TFITEM-XFER-PRIC-AMT      05380078
                   AND XFER_LNE_NBR       = :TFITEM-XFER-LNE-NBR        05390078
                ORDER BY RCVD_XFER_PRIC_AMT                             05400078
                 WITH UR                                                05401084
           END-EXEC.                                                    05410078
                                                                        05420078
       LINKAGE SECTION.                                                 05430078
      *---------------------------------------------------------------* 05440078
       01  DFHCOMMAREA.                                                 05450078
           05  FILLER                         OCCURS  1 TO 4072 TIMES   05460078
                                              DEPENDING ON EIBCALEN.    05470078
               10  FILLER                     PIC X.                    05480078
                                                                        05490078
       PROCEDURE DIVISION.                                              05500078
      *---------------------------------------------------------------* 05510078
       0000-MAIN-MODULE.                                                05520078
           SET PS-NO-ERROR          TO TRUE.                            05540078
           PERFORM 8100-FORMAT-TIME.                                    05550078
           PERFORM 0100-RETRIEVE-STORED-DATA.                           05560078
           PERFORM 0200-MAIN-PROCESS.                                   05570078
SR3403     PERFORM 0300-FILL-PRINTER-DEST.                              05571093
                                                                        05580078
           MOVE PC-TERM TO DRS01-DRRB-FUNC.                             05590078
           PERFORM 8000-LINK-TO-DRS.                                    05600078
                                                                        05610078
           GOBACK.                                                      05620078
                                                                        05630078
       EJECT.                                                           05640078
      *---------------------------------------------------------------* 05650078
       0100-RETRIEVE-STORED-DATA.                                       05660078
                                                                        05670078
           MOVE '0100-RETRIEVE-STORED-DATA'  TO DP013-PARAGRAPH.        05680078
                                                                        05690078
           EXEC CICS                                                    05700078
               RETRIEVE                                                 05710078
                   INTO  (TF005-COMMAREA)                               05720078
                   RESP  (PV-CICS-RESPONSE)                             05730078
           END-EXEC.                                                    05740078
                                                                        05750078
           EVALUATE TRUE                                                05760078
               WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05770078
                   CONTINUE                                             05780078
               WHEN OTHER                                               05790078
                   SET PS-ERROR          TO TRUE                        05800078
                   MOVE PC-RETRIEVE-MSG  TO PV-ERROR-MSG                05810078
                   MOVE PRV-01           TO DP013-MESSAGE-TEXT (1)      05820078
                   PERFORM 9000-RETURN-MSG                              05830078
                   MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)      05840078
                   SET DP013-LINK-RETURN                                05850078
                       DP013-CICS-ABEND                                 05860078
                       DP013-NO-ROLLBACK TO TRUE                        05870078
                   PERFORM DP014-0000-PROCESS-ABEND                     05880078
           END-EVALUATE.                                                05890078
                                                                        05900078
           MOVE TF005-XFER-FROM-STORE-NBR                               05910078
                                    TO DK-FROM-STORE-NBR                05920078
                                       HL3-XFER-FROM-STORE.             05930078
           MOVE TF005-XFER-SEQ-NBR  TO DK-XFER-SEQ-NBR                  05940078
                                       HL3-XFER-SEQ-NBR.                05950078
                                                                        05960078
       EJECT.                                                           06000078
      ***************************************************************** 06010078
       0200-MAIN-PROCESS.                                               06020078
                                                                        06030078
           IF PS-NO-ERROR                                               06040078
               PERFORM 1000-GET-TRANSFER                                06050078
           END-IF.                                                      06060078
                                                                        06070078
           IF PS-NO-ERROR                                               06080078
               PERFORM 0400-INIT-PRINTER-FOR-REPORT                     06090078
           END-IF.                                                      06100078
                                                                        06110078
           IF PS-NO-ERROR                                               06120078
               SET PS-NO-DISCREPANCY-EXISTS    TO TRUE                  06130078
               PERFORM 2000-READ-DISCREPANCY                            06140078
           END-IF.                                                      06150078
                                                                        06160078
           IF PS-NO-ERROR                                               06170078
               IF PS-SEAL-DISCREPANCY                                   06180078
                   PERFORM 2200-SETUP-SEALS                             06190078
               END-IF                                                   06200078
               PERFORM 4000-OPEN-CURSOR                                 06210078
               PERFORM 4010-READ-DISCREPANCY-ITEMS                      06220078
               IF PS-NO-DISCREPANCY-EXISTS                              06230078
                   PERFORM 8200-PRINT-HEADINGS                          06240078
                   MOVE ND-NO-DISCREP-LINE     TO DRS01-COMM-DATA       06250078
                   MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL        06260078
                   PERFORM 8000-LINK-TO-DRS                             06270078
               ELSE                                                     06280078
                   IF PS-HDR-DISCREPANCY-EXISTS                         06290078
                       PERFORM 8200-PRINT-HEADINGS                      06300078
                       MOVE ND-NO-DETAIL-LINE      TO DRS01-COMM-DATA   06310078
                       MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL    06320078
                       PERFORM 8000-LINK-TO-DRS                         06330078
                   END-IF                                               06340078
               END-IF                                                   06350078
               PERFORM 4020-CLOSE-DISCREP-CURSOR                        06360078
           END-IF.                                                      06370078
                                                                        06380078
      *----------------------------------------------------------------*06390078
      * IF THERE WAS AN ERROR ENCOUNTERED, TERMINATE DRS AND DELETE ANY 06400078
      * PORTION OF THE DOCUMENT THAT MAY HAVE ALREADY BEEN PRINTED;     06410078
      * THEN INITIALIZE DRS FOR AN ERROR REPORT.                        06420078
      *----------------------------------------------------------------*06430078
           IF PS-ERROR                                                  06440078
               IF PS-DRS-INITIALIZED                                    06450078
                   MOVE 'D'              TO DRS07-DRTB-DISP (1)         06460078
                   MOVE +1               TO DRS07-DRTB-ATTR-INDX (1)    06470078
                   MOVE PC-TERM          TO DRS01-DRRB-FUNC             06480078
                   MOVE DRS07-DRTB-TERM-BLOCK                           06490078
                                         TO DRS01-COMM-DRIB             06500078
                   PERFORM 8000-LINK-TO-DRS                             06510078
               END-IF                                                   06520078
               PERFORM 0500-INIT-PRINTER-FOR-ERROR                      06530078
               PERFORM 9000-PRINT-ERROR                                 06540078
           END-IF.                                                      06550078
                                                                        06560078
       EJECT.                                                           06570078
SR3403******************************************************************06570193
SR3403*    DETERMINE WHAT REGION IF TEST USE TEST PRINTER               06570293
SR3403******************************************************************06570393
SR3403 0300-FILL-PRINTER-DEST.                                          06571094
SR3403      EXEC CICS                                                   06572093
SR3403           ASSIGN                                                 06573093
SR3403           APPLID (PV-CICS-APPL-ID)                               06574093
SR3403      END-EXEC.                                                   06575093
SR3403      EVALUATE TRUE                                               06575193
SR3403           WHEN PV-CR-PRODUCTION                                  06575293
SR3403                CONTINUE                                          06575393
SR3403           WHEN OTHER                                             06575493
SR3403                MOVE 'U4106' TO TF005-PRINTER-DEST                06575593
SR3403      END-EVALUATE.                                               06575693
SR3403 EJECT.                                                           06576093
      *----------------------------------------------------------------*06580093
      * INITIALIZE THE PRINTER FOR THE TRANSFER DOCUMENT.               06590078
      *----------------------------------------------------------------*06600078
       0400-INIT-PRINTER-FOR-REPORT.                                    06610078
                                                                        06620078
           IF TF005-PRINTER-DEST = 'XXXX'                               06630078
               MOVE 'R'                TO DRS02-DRIB-CLASS              06640078
               MOVE 'N'                TO DRS02-DRIB-HOLD               06650078
               MOVE 'LOCAL'            TO DRS02-DRIB-DEST               06660078
           ELSE                                                         06670078
               MOVE 'A'                TO DRS02-DRIB-CLASS              06680078
               MOVE 'N'                TO DRS02-DRIB-HOLD               06690078
               MOVE TF005-PRINTER-DEST                                  06700078
                                       TO DRS02-DRIB-DEST               06710078
           END-IF.                                                      06720078
           MOVE TF005-PRINTER-DEST     TO PV-PRINTER-DEST.              06730083
080204     IF PV-PRINTER-STORE-LOC = '00801'                            06741083
               MOVE 'U17'              TO DRS02-DRIB-DEST               06750078
           END-IF.                                                      06760078
080204     IF PV-PRINTER-STORE-LOC = '00811'                            06771083
080204         MOVE RFWS009-PRINTER-DEST-811 TO DRS02-DRIB-DEST         06772083
           END-IF.                                                      06790078
                                                                        06800078
           MOVE PC-INIT                TO DRS01-DRRB-FUNC.              06810078
           MOVE DRS02-DRIB-HEADER      TO DRS01-COMM-DRIB-HDR.          06820078
           MOVE DRS02-DRIB-ATTRIB      TO DRS01-COMM-DRIB-AT1.          06830078
                                                                        06840078
           PERFORM 8000-LINK-TO-DRS.                                    06850078
                                                                        06860078
           SET PS-DRS-INITIALIZED TO TRUE.                              06870078
           MOVE PC-PUT                 TO  DRS01-DRRB-FUNC.             06880078
           MOVE PC-CURRENT-PROGRAM-NAME TO DP132O-PROGRAM-NAME.         06890078
           MOVE 1                       TO DP132O-REPORT-NUMBER.        06900078
           MOVE 99                      TO PV-LINE-COUNT.               06910078
           MOVE 0                       TO PV-PAGE-COUNT.               06920078
                                                                        06930078
       EJECT.                                                           06940078
      *----------------------------------------------------------------*06950078
      * INITIALIZE THE PRINTER FOR THE ERROR REPORT.                    06960078
      *----------------------------------------------------------------*06970078
       0500-INIT-PRINTER-FOR-ERROR.                                     06980078
                                                                        06990078
           IF TF005-PRINTER-DEST = 'XXXX'                               07000078
               MOVE 'R'                TO DRS02-DRIB-CLASS              07010078
               MOVE 'N'                TO DRS02-DRIB-HOLD               07020078
               MOVE 'LOCAL'            TO DRS02-DRIB-DEST               07030078
           ELSE                                                         07040078
               MOVE 'A'                TO DRS02-DRIB-CLASS              07050078
               MOVE 'N'                TO DRS02-DRIB-HOLD               07060078
               MOVE TF005-PRINTER-DEST                                  07070078
                                       TO DRS02-DRIB-DEST               07080078
           END-IF.                                                      07090078
                                                                        07100078
           MOVE TF005-PRINTER-DEST     TO PV-PRINTER-DEST.              07110083
080204     IF PV-PRINTER-STORE-LOC = '00801'                            07120083
               MOVE 'U17'              TO DRS02-DRIB-DEST               07130078
           END-IF.                                                      07140078
           IF PV-PRINTER-STORE-LOC = '00811'                            07150083
080204         MOVE RFWS009-PRINTER-DEST-811 TO DRS02-DRIB-DEST         07151083
           END-IF.                                                      07170078
                                                                        07180078
           MOVE PC-INIT                TO DRS01-DRRB-FUNC.              07190078
           MOVE DRS02-DRIB-HEADER      TO DRS01-COMM-DRIB-HDR.          07200078
           MOVE DRS02-DRIB-ATTRIB      TO DRS01-COMM-DRIB-AT1.          07210078
                                                                        07220078
           PERFORM 8000-LINK-TO-DRS.                                    07230078
                                                                        07240078
           SET PS-DRS-INITIALIZED      TO TRUE.                         07250078
           MOVE PC-PUT                 TO  DRS01-DRRB-FUNC.             07260078
                                                                        07270078
       EJECT.                                                           07280078
      *----------------------------------------------------------------*07290078
      * SELECT DATA FROM THE TRANSFER TABLES                            07300078
      *----------------------------------------------------------------*07310078
       1000-GET-TRANSFER.                                               07320078
                                                                        07330078
           MOVE '1000-GET-TRANSFER'  TO DP013-PARAGRAPH.                07340078
                                                                        07350078
           EXEC SQL                                                     07360078
               SELECT XFER_DKEY_ID                                      07370078
                     ,TO_STR_NBR                                        07380078
                     ,CONTNR_TYP_CDE                                    07390078
                     ,LG_TTE_1ST_SEAL_ID                                07400078
                     ,LG_TTE_2ND_SEAL_ID                                07410078
                     ,SM_TTE_BAG_SEAL_ID                                07420078
                     ,TRLR_NBR                                          07430078
                     ,TRLR_SEAL_ID                                      07440078
               INTO   :TFMSTR-XFER-DKEY-ID                              07450078
                     ,:TFMSTR-TO-STR-NBR                                07460078
                     ,:TFMSTR-CONTNR-TYP-CDE                            07470078
                     ,:TFMSTR-LG-TTE-1ST-SEAL-ID                        07480078
                     ,:TFMSTR-LG-TTE-2ND-SEAL-ID                        07490078
                     ,:TFMSTR-SM-TTE-BAG-SEAL-ID                        07500078
                     ,:TFMSTR-TRLR-NBR                                  07510078
                     ,:TFMSTR-TRLR-SEAL-ID                              07520078
               FROM   TTFMSTR                                           07530078
               WHERE  XFER_SEQ_NBR   = :DK-XFER-SEQ-NBR     AND         07540078
                      FR_STR_NBR     = :DK-FROM-STORE-NBR               07550078
           END-EXEC.                                                    07560078
                                                                        07570078
           EVALUATE TRUE                                                07580078
               WHEN SQLCODE = ZERO                                      07590078
                   CONTINUE                                             07600078
               WHEN OTHER                                               07610078
                   IF SQLCODE = -904 OR -911 OR -913                    07620078
                       SET PS-CONTENTION TO TRUE                        07630078
                   END-IF                                               07640078
                   SET PS-ERROR         TO TRUE                         07650078
                   MOVE PC-GET-TRANSFER-MSG                             07660078
                                        TO PV-ERROR-MSG                 07670078
                   MOVE PRV-02          TO DP013-MESSAGE-TEXT (1)       07680078
                   PERFORM 9000-RETURN-MSG                              07690078
                   MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)       07700078
                   MOVE 'TTFMSTR'       TO DP013-DB2-TABLE-NAME (1)     07710078
                   MOVE SQLCA           TO DP013-SQLCA                  07720078
                   SET DP013-LINK-RETURN                                07730078
                       DP013-DB2-ABEND                                  07740078
                       DP013-NO-ROLLBACK TO TRUE                        07750078
                   PERFORM DP014-0000-PROCESS-ABEND                     07760078
           END-EVALUATE.                                                07770078
                                                                        07780078
           IF SQLCODE = ZERO                                            07790078
               MOVE TFMSTR-XFER-DKEY-ID     TO DK-XFER-DKEY-ID          07800078
               PERFORM 5500-GET-STORE-NAMES                             07810078
               PERFORM 6200-READ-TRANSFER-RECEIPT                       07820078
               PERFORM 7000-READ-TOT-TRANSFER-AMT                       07830078
               PERFORM 7100-READ-TOT-RECEIPT-AMT                        07840078
               COMPUTE PV-VARIANCE =                                    07850078
                                   (PV-XFER-TOTAL - PV-RCVD-TOTAL)      07860078
               END-COMPUTE                                              07870078
               MOVE PV-VARIANCE      TO PV-EDITTED-NET-DISCREP          07880078
               IF PV-VARIANCE < ZERO                                    07890078
                    MOVE '('          TO PV-EDIT-D-PAREN-1              07900078
                    MOVE ')'          TO PV-EDIT-D-PAREN-2              07910078
               ELSE                                                     07920078
                    MOVE SPACE        TO PV-EDIT-D-PAREN-1              07930078
                                         PV-EDIT-D-PAREN-2              07940078
               END-IF                                                   07950078
               MOVE PV-EDITTED-NET-DISCREP-FIELD                        07960078
                                            TO HL5-NET-DISCREP          07970078
           END-IF.                                                      07980078
                                                                        07990078
       EJECT                                                            08000078
      *----------------------------------------------------------------*08010078
      *    DETERMINE WHETHER THERE IS A TRANSFER DISCREPANCY.          *08020078
      *----------------------------------------------------------------*08030078
       2000-READ-DISCREPANCY.                                           08040078
                                                                        08050078
           MOVE '2000-READ-DISCREPANCY' TO DP013-PARAGRAPH.             08060078
                                                                        08070078
           EXEC SQL                                                     08080078
               SELECT RCVD_AT_STR_NBR                                   08090078
                     ,LG_TTE_1ST_SEAL_ID                                08100078
                     ,LG_TTE_2ND_SEAL_ID                                08110078
                     ,SM_TTE_BG_SEAL_ID                                 08120078
                     ,TRLR_NBR                                          08130078
                     ,TRLR_SEAL_ID                                      08140078
               INTO   :TFDSCP-RCVD-AT-STR-NBR                           08150078
                     ,:TFDSCP-LG-TTE-1ST-SEAL-ID                        08160078
                     ,:TFDSCP-LG-TTE-2ND-SEAL-ID                        08170078
                     ,:TFDSCP-SM-TTE-BG-SEAL-ID                         08180078
                     ,:TFDSCP-TRLR-NBR                                  08190078
                     ,:TFDSCP-TRLR-SEAL-ID                              08200078
               FROM   TTFDSCP D                                         08210078
                     ,TTFSTAT S                                         08220078
               WHERE D.XFER_DKEY_ID   = :DK-XFER-DKEY-ID     AND        08230078
                     S.XFER_DKEY_ID   = :DK-XFER-DKEY-ID     AND        08240078
                     S.XFER_STAT_CDE  = :PC-POSITIVE-RECEIPT AND        08250078
                     S.XFER_STAT_TMST =  D.RCV_XFER_BEG_TMST            08260078
           END-EXEC.                                                    08270078
                                                                        08280078
           EVALUATE TRUE                                                08290078
               WHEN SQLCODE = ZERO                                      08300078
                   SET PS-HDR-DISCREPANCY-EXISTS TO TRUE                08310078
                   EVALUATE TFMSTR-CONTNR-TYP-CDE                       08320078
                      WHEN PC-TRAILER                                   08330078
                          IF TFDSCP-TRLR-NBR           NOT EQUAL        08340078
                             TFMSTR-TRLR-NBR                     OR     08350078
                             TFDSCP-TRLR-SEAL-ID       NOT EQUAL        08360078
                             TFMSTR-TRLR-SEAL-ID                        08370078
                              SET PS-SEAL-DISCREPANCY    TO TRUE        08380078
                          END-IF                                        08390078
                                                                        08400078
                      WHEN OTHER                                        08410078
                         EVALUATE TRUE                                  08420078
                                    ALSO TRUE                           08430078
                           WHEN (TFDSCP-LG-TTE-1ST-SEAL-ID =            08440078
                                 TFMSTR-LG-TTE-1ST-SEAL-ID    AND       08450078
                                 TFDSCP-LG-TTE-2ND-SEAL-ID =            08460078
                                 TFMSTR-LG-TTE-2ND-SEAL-ID)             08470078
                            ALSO TFDSCP-SM-TTE-BG-SEAL-ID =             08480078
                                 TFMSTR-SM-TTE-BAG-SEAL-ID              08490078
                           WHEN (TFDSCP-LG-TTE-1ST-SEAL-ID =            08500078
                                 TFMSTR-LG-TTE-2ND-SEAL-ID    AND       08510078
                                 TFDSCP-LG-TTE-2ND-SEAL-ID =            08520078
                                 TFMSTR-LG-TTE-1ST-SEAL-ID)             08530078
                            ALSO TFDSCP-SM-TTE-BG-SEAL-ID =             08540078
                                 TFMSTR-SM-TTE-BAG-SEAL-ID              08550078
                               CONTINUE                                 08560078
                           WHEN OTHER                                   08570078
                               SET PS-SEAL-DISCREPANCY    TO TRUE       08580078
                         END-EVALUATE                                   08590078
                   END-EVALUATE                                         08600078
                                                                        08610078
               WHEN SQLCODE = +100                                      08620078
                   CONTINUE                                             08630078
               WHEN OTHER                                               08640078
                   IF SQLCODE = -904 OR -911 OR -913                    08650078
                       SET PS-CONTENTION TO TRUE                        08660078
                   END-IF                                               08670078
                   SET PS-ERROR         TO TRUE                         08680078
                   MOVE PC-DISCREPANCY-MSG                              08690078
                                        TO PV-ERROR-MSG                 08700078
                   MOVE PRV-03          TO DP013-MESSAGE-TEXT (1)       08710078
                   PERFORM 9000-RETURN-MSG                              08720078
                   MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)       08730078
                   MOVE 'TTFDSCP'       TO DP013-DB2-TABLE-NAME (1)     08740078
                   MOVE SQLCA           TO DP013-SQLCA                  08750078
                   SET DP013-LINK-RETURN                                08760078
                       DP013-DB2-ABEND                                  08770078
                       DP013-NO-ROLLBACK TO TRUE                        08780078
                   PERFORM DP014-0000-PROCESS-ABEND                     08790078
           END-EVALUATE.                                                08800078
                                                                        08810078
       EJECT.                                                           08820078
      *----------------------------------------------------------------*08830078
      *    DETERMINE WHETHER THERE IS A TRANSFER ITEM DISCREPANCY.     *08840078
      *----------------------------------------------------------------*08850078
       2200-SETUP-SEALS.                                                08860078
                                                                        08870078
           MOVE PC-TRANSFERED-LITERAL          TO HL3-SEAL-LITERAL1.    08880078
           MOVE PC-RECEIVED-LITERAL            TO HL3-SEAL-LITERAL2.    08890078
           EVALUATE TFMSTR-CONTNR-TYP-CDE                               08900078
               WHEN PC-TRAILER                                          08910078
                   MOVE PC-TRLR-NBR-LITERAL    TO HL4-SEAL-LITERAL      08920078
                   MOVE PC-TRLR-SEAL-LITERAL   TO HL5-SEAL-LITERAL      08930078
                   MOVE TFMSTR-TRLR-NBR        TO HL4-SEAL-1            08940078
                   MOVE TFMSTR-TRLR-SEAL-ID    TO HL5-SEAL-1            08950078
                   MOVE TFDSCP-TRLR-NBR        TO HL4-SEAL-2            08960078
                   MOVE TFDSCP-TRLR-SEAL-ID    TO HL5-SEAL-2            08970078
               WHEN OTHER                                               08980078
                   MOVE PC-LG-TOTE-SEAL1-LITERAL TO HL4-SEAL-LITERAL    08990081
                   MOVE PC-LG-TOTE-SEAL2-LITERAL TO HL5-SEAL-LITERAL    09000081
                   MOVE PC-SM-TOTE-SEAL-LITERAL  TO HL6-SEAL-LITERAL    09010081
                   MOVE TFMSTR-LG-TTE-1ST-SEAL-ID TO HL4-SEAL-1         09020081
                   MOVE TFMSTR-LG-TTE-2ND-SEAL-ID TO HL5-SEAL-1         09030081
                   MOVE TFMSTR-SM-TTE-BAG-SEAL-ID TO HL6-SEAL-1         09040081
                   MOVE TFDSCP-LG-TTE-1ST-SEAL-ID TO HL4-SEAL-2         09050081
                   MOVE TFDSCP-LG-TTE-2ND-SEAL-ID TO HL5-SEAL-2         09060081
                   MOVE TFDSCP-SM-TTE-BG-SEAL-ID  TO HL6-SEAL-2         09070081
           END-EVALUATE.                                                09080078
                                                                        09090078
       EJECT.                                                           09100078
      *----------------------------------------------------------------*09110078
      * OPEN THE DISCREPANCY ITEM CURSOR.                              *09120078
      *----------------------------------------------------------------*09130078
       4000-OPEN-CURSOR.                                                09140078
                                                                        09150078
           MOVE '4000-OPEN-CURSOR' TO DP013-PARAGRAPH.                  09160078
                                                                        09170078
           EXEC SQL                                                     09180078
               OPEN DISCREP-CSR                                         09190078
           END-EXEC.                                                    09200078
                                                                        09210078
           EVALUATE TRUE                                                09220078
               WHEN SQLCODE = ZERO                                      09230078
               WHEN SQLCODE = +100                                      09240078
                   CONTINUE                                             09250078
               WHEN OTHER                                               09260078
                   IF SQLCODE = -904 OR -911 OR -913                    09270078
                       SET PS-CONTENTION TO TRUE                        09280078
                   END-IF                                               09290078
                   SET PS-ERROR      TO TRUE                            09300078
                   MOVE PC-OPEN-CSR-MSG                                 09310078
                                     TO PV-ERROR-MSG                    09320078
                   MOVE PRV-05       TO DP013-MESSAGE-TEXT (1)          09330078
                   PERFORM 9000-RETURN-MSG                              09340078
                   MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)       09350078
                   MOVE SQLCA        TO DP013-SQLCA                     09360078
                   MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)        09370078
                   MOVE 'TTFITRC '   TO DP013-DB2-TABLE-NAME (2)        09380078
                   MOVE 'TTFSTAT '   TO DP013-DB2-TABLE-NAME (3)        09390078
                   SET DP013-LINK-RETURN                                09400078
                       DP013-DB2-ABEND                                  09410078
                       DP013-NO-ROLLBACK     TO TRUE                    09420078
                   PERFORM DP014-0000-PROCESS-ABEND                     09430078
           END-EVALUATE.                                                09440078
                                                                        09450078
       EJECT.                                                           09460078
      *----------------------------------------------------------------*09470078
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM TO THE      *09480078
      *    REPORT DETAIL LINE, THEN PRINT THE DETAIL LINE.             *09490078
      *----------------------------------------------------------------*09500078
       4010-READ-DISCREPANCY-ITEMS.                                     09510078
                                                                        09520078
           SET PS-ITEMS-LEFT-ON-DB          TO TRUE.                    09530078
           PERFORM UNTIL  PS-NO-ITEMS-LEFT-ON-DB                        09540078
                                                                        09550078
               PERFORM 4030-FETCH-ITEMS                                 09560078
                                                                        09570078
               IF  PS-ITEMS-LEFT-ON-DB                                  09580078
                   ADD +1                   TO PV-ITEMS-READ            09590078
                   MOVE SPACE               TO DL1-DETAIL-LINE-1        09600078
                   MOVE SKXREF-DEPT         TO DL1-DEPT                 09610078
                   IF SKXREF-CLASS < PC-100 AND                         09620078
                    SKXREF-SUBCLASS < PC-100                            09630078
                    MOVE SKXREF-CLASS    TO DL1-CLASS-1                 09640078
                    MOVE SKXREF-SUBCLASS TO DL1-SUBCLASS-1              09650078
                   ELSE IF                                              09660078
                    SKXREF-CLASS < PC-100 AND                           09670078
                    SKXREF-SUBCLASS > PC-099                            09680078
                    MOVE SKXREF-CLASS    TO DL1-CLASS-2                 09690078
                    MOVE SKXREF-SUBCLASS TO DL1-SUBCLASS-2              09700078
                    MOVE SPACES TO DL1-FILLER-2A                        09710078
                                   DL1-FILLER-2B                        09720078
                   ELSE IF                                              09730078
                    SKXREF-CLASS > PC-099 AND                           09740078
                    SKXREF-SUBCLASS < PC-100                            09750078
                    MOVE SKXREF-CLASS    TO DL1-CLASS-3                 09760078
                    MOVE SKXREF-SUBCLASS TO DL1-SUBCLASS-3              09770078
                    MOVE SPACES TO DL1-FILLER-3A                        09780078
                                   DL1-FILLER-3B                        09790078
                   ELSE IF                                              09800078
                    SKXREF-CLASS > PC-099 AND                           09810078
                    SKXREF-SUBCLASS > PC-099                            09820078
                    MOVE SKXREF-CLASS    TO DL1-CLASS-4                 09830078
                    MOVE SKXREF-SUBCLASS TO DL1-SUBCLASS-4              09840078
                    MOVE SPACES TO DL1-FILLER-4A                        09850078
                   END-IF                                               09860078
                   END-IF                                               09870078
                   END-IF                                               09880078
                   END-IF                                               09890078
                   MOVE TFITEM-KOHLS-UPC-NBR                            09900078
                                            TO DL1-UPC                  09910078
                   MOVE '-'                 TO DL1-UPC-DASH-1           09920078
                                               DL1-UPC-DASH-2           09930078
                                               DL1-UPC-DASH-3           09940078
                   MOVE TFITEM-XFER-LNE-NBR TO DL1-LINE                 09950078
                   IF TFITEM-XFER-QTY > 0                               09960078
                       MOVE TFITEM-XFER-QTY TO DL1-TQTY                 09970078
                       MOVE TFITEM-XFER-PRIC-AMT                        09980078
                                            TO DL1-TPRICE               09990078
                   END-IF                                               10000078
                   PERFORM 5300-READ-ADJUSTMENTS                        10010078
                   PERFORM 5400-READ-ITEM-RECEIPT                       10020078
                   IF TFITRC-RCVD-XFER-QTY > 0                          10030078
                       MOVE TFITRC-RCVD-XFER-QTY TO DL1-RQTY            10040078
                       MOVE TFITRC-RCVD-XFER-PRIC-AMT                   10050078
                                            TO DL1-RPRICE               10060078
                   END-IF                                               10070078
                   COMPUTE PV-VARIANCE =                                10080078
                    ((TFITEM-XFER-QTY * TFITEM-XFER-PRIC-AMT)   -       10090078
                     (TFITRC-RCVD-XFER-QTY * TFITRC-RCVD-XFER-PRIC-AMT))10100078
                   END-COMPUTE                                          10110078
                   MOVE PV-VARIANCE      TO PV-EDITTED-VARIANCE         10120078
                   IF PV-VARIANCE < ZERO                                10130078
                       MOVE '('          TO PV-EDIT-V-PAREN-1           10140078
                       MOVE ')'          TO PV-EDIT-V-PAREN-2           10150078
                   ELSE                                                 10160078
                       MOVE SPACE        TO PV-EDIT-V-PAREN-1           10170078
                                            PV-EDIT-V-PAREN-2           10180078
                   END-IF                                               10190078
                   MOVE PV-EDITTED-VARIANCE-FIELD                       10200078
                                         TO DL1-VARIANCE                10210078
                   ADD 1                    TO PV-LINE-COUNT            10220078
                   IF PV-LINE-COUNT > PC-PAGE-MAX                       10230078
                       PERFORM 8200-PRINT-HEADINGS                      10240078
                       PERFORM 8300-PRINT-COLUMN-HEADINGS               10250078
                   END-IF                                               10260078
                   SET PS-NOT-FIRST-LINE    TO TRUE                     10270078
                   MOVE DL1-DETAIL-LINE-1                               10280078
                                            TO DRS01-COMM-DATA          10290078
                   MOVE PC-SINGLE-SPACE     TO DRS01-COMM-CTL           10300078
                   PERFORM 8000-LINK-TO-DRS                             10310078
                   SET PS-ITEMS-LEFT-ON-DB-2            TO TRUE         10320078
                   PERFORM 5600-OPEN-RECEIPT-CURSOR                     10330078
                   PERFORM 5700-READ-RECEIPT-ITEMS                      10340078
                   PERFORM 5800-CLOSE-RECEIPT-CURSOR                    10350078
                                                                        10360078
               END-IF                                                   10370078
           END-PERFORM.                                                 10380078
                                                                        10390078
           IF PV-ITEMS-READ > ZERO                                      10400078
               SET PS-DTL-DISCREPANCY-EXISTS    TO TRUE                 10410078
           END-IF.                                                      10420078
                                                                        10430078
       EJECT.                                                           10440078
      *----------------------------------------------------------------*10450078
      * CLOSE THE TRANSFER ITEM CURSOR.                                *10460078
      *----------------------------------------------------------------*10470078
       4020-CLOSE-DISCREP-CURSOR.                                       10480078
                                                                        10490078
           MOVE '4020-CLOSE-DISCREP-CURSOR' TO DP013-PARAGRAPH.         10500078
                                                                        10510078
           EXEC SQL                                                     10520078
               CLOSE DISCREP-CSR                                        10530078
           END-EXEC.                                                    10540078
                                                                        10550078
           EVALUATE TRUE                                                10560078
               WHEN SQLCODE = ZERO                                      10570078
                   CONTINUE                                             10580078
               WHEN OTHER                                               10590078
                   IF SQLCODE = -904 OR -911 OR -913                    10600078
                       SET PS-CONTENTION TO TRUE                        10610078
                   END-IF                                               10620078
                   SET PS-ERROR          TO TRUE                        10630078
                   MOVE PC-CLOSE-CSR-MSG                                10640078
                                         TO PV-ERROR-MSG                10650078
                   MOVE PRV-06           TO DP013-MESSAGE-TEXT (1)      10660078
                   PERFORM 9000-RETURN-MSG                              10670078
                   MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)      10680078
                   MOVE SQLCA            TO DP013-SQLCA                 10690078
                   MOVE 'TTFITEM '       TO DP013-DB2-TABLE-NAME (1)    10700078
                   MOVE 'TTFITRC '       TO DP013-DB2-TABLE-NAME (2)    10710078
                   MOVE 'TTFSTAT '       TO DP013-DB2-TABLE-NAME (3)    10720078
                   SET DP013-LINK-RETURN                                10730078
                       DP013-DB2-ABEND                                  10740078
                       DP013-NO-ROLLBACK TO TRUE                        10750078
                   PERFORM DP014-0000-PROCESS-ABEND                     10760078
           END-EVALUATE.                                                10770078
                                                                        10780078
       EJECT.                                                           10790078
      *----------------------------------------------------------------*10800078
      *    FETCH THE TRANSFER ITEM CURSOR. (RETAIL TRANSFERS)          *10810078
      *----------------------------------------------------------------*10820078
       4030-FETCH-ITEMS.                                                10830078
                                                                        10840078
           MOVE '4030-FETCH-ITEMS' TO DP013-PARAGRAPH.                  10850078
                                                                        10860078
           EXEC SQL                                                     10870078
               FETCH DISCREP-CSR                                        10880078
               INTO   :TFITEM-XFER-LNE-NBR                              10890078
                    , :TFITEM-KOHLS-UPC-NBR                             10900078
051203              , :TFITEM-SCN-UPC-NBR                               10910080
                    , :TFITEM-XFER-PRIC-AMT                             10920078
                    , :TFITEM-XFER-QTY                                  10930078
051203              , :SKXREF-ITM-NBR                                   10940078
           END-EXEC.                                                    10950078
                                                                        10960078
           EVALUATE TRUE                                                10970078
               WHEN SQLCODE = ZERO                                      10980078
051203              PERFORM 4040-RETRIEVE-DMS                           10990078
               WHEN SQLCODE = +100                                      11000078
                    SET PS-NO-ITEMS-LEFT-ON-DB  TO TRUE                 11010079
               WHEN OTHER                                               11020078
                   IF SQLCODE = -904 OR -911 OR -913                    11030078
                       SET PS-CONTENTION TO TRUE                        11040078
                   END-IF                                               11050078
                    SET PS-ERROR         TO TRUE                        11060078
                    MOVE PRV-07          TO DP013-MESSAGE-TEXT (1)      11070078
                    PERFORM 9000-RETURN-MSG                             11080078
                    MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)      11090078
                    MOVE SQLCA           TO DP013-SQLCA                 11100078
                    MOVE 'TTFITEM '      TO DP013-DB2-TABLE-NAME (1)    11110078
                    SET DP013-LINK-RETURN                               11120078
                        DP013-DB2-ABEND                                 11130078
                        DP013-NO-ROLLBACK TO TRUE                       11140078
                    PERFORM DP014-0000-PROCESS-ABEND                    11150078
           END-EVALUATE.                                                11160078
                                                                        11170078
       EJECT.                                                           11180078
051203*----------------------------------------------------------------*11190078
051203**RETRIEVE DMS AND CHECK IF UPC IS A DUMMY UPC                   *11200078
051203*----------------------------------------------------------------*11210078
051203 4040-RETRIEVE-DMS.                                               11220078
                                                                        11230078
051203     MOVE '4040-RETRIEVE-DMS' TO DP013-PARAGRAPH.                 11240078
                                                                        11250078
051203     EXEC SQL                                                     11260078
051203          SELECT DEPT                                             11270078
051203               , CLASS                                            11280078
051203               , SUBCLASS                                         11290078
051203          INTO  :SKXREF-DEPT                                      11300078
051203               ,:SKXREF-CLASS                                     11310078
051203               ,:SKXREF-SUBCLASS                                  11320078
051203          FROM   TSKXREF                                          11330078
051203          WHERE  ITM_NBR  = :SKXREF-ITM-NBR                       11340078
051203     END-EXEC.                                                    11350078
                                                                        11360078
051203     EVALUATE TRUE                                                11370078
051203         WHEN SQLCODE = ZERO                                      11380078
051203              CONTINUE                                            11390078
051203         WHEN SQLCODE = +100                                      11400078
051203              MOVE TFITEM-SCN-UPC-NBR TO PV-HOLD-UPC-NBR-9        11410080
051203              MOVE PV-KOHLS-DEPT TO SKXREF-DEPT                   11420078
051203              MOVE PV-KOHLS-CL-9 TO SKXREF-SUBCLASS               11430078
051203              MOVE ZERO          TO PV-KOHLS-CL-2                 11440078
051203              MOVE PV-KOHLS-CL-9 TO SKXREF-CLASS                  11450078
051203         WHEN OTHER                                               11460078
051203              IF SQLCODE = -904 OR -911 OR -913                   11470080
051203                 SET PS-CONTENTION TO TRUE                        11480078
051203              END-IF                                              11490080
051203              SET PS-NO-ITEMS-LEFT-ON-DB                          11500078
051203                  PS-ERROR           TO TRUE                      11510078
051203              MOVE PC-FETCH-CSR-MSG  TO PV-ERROR-MSG              11520078
051203              MOVE PRV-16            TO DP013-MESSAGE-TEXT (1)    11530079
051203              PERFORM 9000-RETURN-MSG                             11540078
051203              MOVE PV-DISPLAY-KEYS   TO DP013-MESSAGE-TEXT (2)    11550078
051203              MOVE SQLCA             TO DP013-SQLCA               11560078
051203              MOVE 'TSKXREF '        TO DP013-DB2-TABLE-NAME (1)  11570078
051203              SET DP013-LINK-RETURN                               11580078
051203                  DP013-DB2-ABEND                                 11590078
051203                  DP013-NO-ROLLBACK  TO TRUE                      11600078
051203              PERFORM DP014-0000-PROCESS-ABEND                    11610078
051203     END-EVALUATE.                                                11620078
                                                                        11630078
051203 EJECT.                                                           11640078
      *----------------------------------------------------------------*11650078
      *  READ THE TRANSFER ITEM POSTING TABLE TO DETERMINE IF THE LINE *11660078
      *  BEING PROCESSED HAS A MANUAL ADJUSTMENT.                      *11670078
      *----------------------------------------------------------------*11680078
       5300-READ-ADJUSTMENTS.                                           11690078
                                                                        11700078
           MOVE '5300-READ-ADJUSTMENTS' TO DP013-PARAGRAPH.             11710078
                                                                        11720078
           EXEC SQL                                                     11730078
               SELECT DISTINCT P.XFER_LNE_NBR                           11740078
                   INTO  :TFITPS-XFER-LNE-NBR                           11750078
                   FROM  TTFITPS P                                      11760078
                       , TTFAJRS A                                      11770078
                   WHERE P.XFER_LNE_NBR  = :TFITEM-XFER-LNE-NBR AND     11780078
                         P.ADJ_RSN_CDE   = A.ADJ_RSN_CDE  AND           11790078
                         P.XFER_DKEY_ID  = :DK-XFER-DKEY-ID AND         11800078
                         A.SYS_RSN_IND   = 'N'                          11810078
           END-EXEC.                                                    11820078
                                                                        11830078
           EVALUATE TRUE                                                11840078
               WHEN SQLCODE = ZERO                                      11850078
                  MOVE 'ADJ'         TO DL1-ACTION                      11860078
               WHEN SQLCODE = +100                                      11870078
                   CONTINUE                                             11880078
               WHEN OTHER                                               11890078
                   IF SQLCODE = -904 OR -911 OR -913                    11900078
                       SET PS-CONTENTION TO TRUE                        11910078
                   END-IF                                               11920078
                   MOVE 'TTFAJRS'    TO DP013-DB2-TABLE-NAME (1)        11930078
                   MOVE 'TTFITPS'    TO DP013-DB2-TABLE-NAME (2)        11940078
                   SET PS-ERROR         TO TRUE                         11950078
                   MOVE PC-READ-ADJUSTMENTS-MSG                         11960078
                                     TO PV-ERROR-MSG                    11970078
                   MOVE PRV-08          TO DP013-MESSAGE-TEXT (1)       11980078
                   PERFORM 9000-RETURN-MSG                              11990078
                   MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)       12000078
                   MOVE SQLCA           TO DP013-SQLCA                  12010078
                   SET DP013-LINK-RETURN                                12020078
                       DP013-DB2-ABEND                                  12030078
                       DP013-NO-ROLLBACK TO TRUE                        12040078
                   PERFORM DP014-0000-PROCESS-ABEND                     12050078
           END-EVALUATE.                                                12060078
                                                                        12070078
       EJECT.                                                           12080078
      *----------------------------------------------------------------*12090078
      *  GET THE TOTAL RECIEVED QTY & PRICE.                           *12100078
      *----------------------------------------------------------------*12110078
       5400-READ-ITEM-RECEIPT.                                          12120078
                                                                        12130078
           MOVE '5400-READ-ITEM-RECEIPT' TO DP013-PARAGRAPH.            12140078
                                                                        12150078
           EXEC SQL                                                     12160078
               SELECT  RCVD_XFER_PRIC_AMT                               12170078
                     , RCVD_XFER_QTY                                    12180078
                   INTO :TFITRC-RCVD-XFER-PRIC-AMT                      12190078
                       ,:TFITRC-RCVD-XFER-QTY                           12200078
                   FROM TTFITRC I                                       12210078
                       ,TTFSTAT S                                       12220078
               WHERE                                                    12230078
                  I.XFER_DKEY_ID     = :DK-XFER-DKEY-ID        AND      12240078
                  S.XFER_DKEY_ID     = I.XFER_DKEY_ID          AND      12250078
                  S.XFER_STAT_CDE    = :PC-POSITIVE-RECEIPT    AND      12260078
                  S.XFER_STAT_TMST   = I.XFER_RCPT_TMST        AND      12270078
                  RCVD_XFER_PRIC_AMT = :TFITEM-XFER-PRIC-AMT   AND      12280078
                  XFER_LNE_NBR       = :TFITEM-XFER-LNE-NBR             12290078
           END-EXEC.                                                    12300078
                                                                        12310078
           EVALUATE TRUE                                                12320078
               WHEN SQLCODE = ZERO                                      12330078
               WHEN SQLCODE = +100                                      12340078
                   CONTINUE                                             12350078
               WHEN OTHER                                               12360078
                   IF SQLCODE = -904 OR -911 OR -913                    12370078
                       SET PS-CONTENTION TO TRUE                        12380078
                   END-IF                                               12390078
                   MOVE 'TTFITRC'    TO DP013-DB2-TABLE-NAME (1)        12400078
                   MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)        12410078
                   SET PS-ERROR         TO TRUE                         12420078
                   MOVE PC-READ-RECEIPT-TOTAL-MSG                       12430078
                                     TO PV-ERROR-MSG                    12440078
                   MOVE PRV-09          TO DP013-MESSAGE-TEXT (1)       12450078
                   PERFORM 9000-RETURN-MSG                              12460078
                   MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)       12470078
                   MOVE SQLCA           TO DP013-SQLCA                  12480078
                   SET DP013-LINK-RETURN                                12490078
                       DP013-DB2-ABEND                                  12500078
                       DP013-NO-ROLLBACK TO TRUE                        12510078
                   PERFORM DP014-0000-PROCESS-ABEND                     12520078
           END-EVALUATE.                                                12530078
                                                                        12540078
           IF SQLCODE = +100                                            12550078
               MOVE ZEROES               TO TFITRC-RCVD-XFER-QTY        12560078
                                            TFITRC-RCVD-XFER-PRIC-AMT   12570078
           END-IF.                                                      12580078
                                                                        12590078
       EJECT                                                            12600078
      *----------------------------------------------------------------*12610078
      *  GET THE FROM AND TO STORE NAMES FOR DISPLAY.                  *12620078
      *----------------------------------------------------------------*12630078
       5500-GET-STORE-NAMES.                                            12640078
                                                                        12650078
           MOVE DK-FROM-STORE-NBR        TO DK-STORE-NBR                12660078
                                            HL3-FR-STORE-NBR.           12670078
100404     PERFORM 5550-READ-XST-LOC.                                   12680084
100404     MOVE XST00001-LOC-10-ABBR-NM  TO HL3-FR-STORE-NAME.          12690084
           MOVE TFMSTR-TO-STR-NBR        TO HL4-TO-STORE-NBR            12700078
                                            DK-STORE-NBR.               12710078
100404     PERFORM 5550-READ-XST-LOC.                                   12720084
100404     MOVE XST00001-LOC-10-ABBR-NM  TO HL4-TO-STORE-NAME.          12730084
                                                                        12740078
       EJECT.                                                           12750078
      *----------------------------------------------------------------*12760078
      *  GET THE 10 CHARACTER ABBREVIATED STORE NAME.                  *12770078
      *----------------------------------------------------------------*12780078
100404 5550-READ-XST-LOC.                                               12790084
                                                                        12800078
100404     MOVE '5550-READ-XST-LOC' TO DP013-PARAGRAPH.                 12810084
                                                                        12820078
           EXEC SQL                                                     12830078
100404         SELECT LOC_10_ABBR_NM                                    12840084
100404             INTO :XST00001-LOC-10-ABBR-NM                        12850084
100404             FROM XST_LOC                                         12860086
100404             WHERE (LOC_NBR  = :DK-STORE-NBR)                     12870084
           END-EXEC.                                                    12880078
                                                                        12890078
           EVALUATE TRUE                                                12900078
               WHEN SQLCODE = +100                                      12910078
100404             MOVE 'INVALID'     TO XST00001-LOC-10-ABBR-NM        12920084
               WHEN SQLCODE = ZERO                                      12930078
                   CONTINUE                                             12940078
               WHEN OTHER                                               12950078
                   IF SQLCODE = -904 OR -911 OR -913                    12960078
                       SET PS-CONTENTION TO TRUE                        12970078
                   END-IF                                               12980078
                   SET PS-ERROR      TO TRUE                            12990078
                   MOVE DK-STORE-NBR TO PV-STORE                        13000078
                   MOVE PV-STORE-ERROR                                  13010078
                                     TO PV-ERROR-KEY                    13020078
                   MOVE PC-GET-STORE-MSG                                13030078
                                        TO PV-ERROR-MSG                 13040078
                   MOVE PRV-04       TO DP013-MESSAGE-TEXT (1)          13050078
                   PERFORM 9000-RETURN-MSG                              13060078
                   MOVE PV-DISPLAY-KEYS                                 13070078
                                     TO DP013-MESSAGE-TEXT (2)          13080078
                   MOVE SQLCA        TO DP013-SQLCA                     13090078
100404             MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (1)        13100084
                   SET DP013-LINK-RETURN                                13110078
                       DP013-DB2-ABEND                                  13120078
                       DP013-NO-ROLLBACK TO TRUE                        13130078
                   PERFORM DP014-0000-PROCESS-ABEND                     13140078
           END-EVALUATE.                                                13150078
                                                                        13160078
       EJECT.                                                           13170078
      *----------------------------------------------------------------*13180078
      * OPEN THE TRANSFER RECEIPT CURSOR.                              *13190078
      *----------------------------------------------------------------*13200078
       5600-OPEN-RECEIPT-CURSOR.                                        13210078
                                                                        13220078
           MOVE '5600-OPEN-RECEIPT-CURSOR'  TO DP013-PARAGRAPH.         13230078
                                                                        13240078
           EXEC SQL                                                     13250078
                OPEN XFER-RECEIPT-CSR                                   13260078
           END-EXEC.                                                    13270078
                                                                        13280078
           EVALUATE TRUE                                                13290078
               WHEN SQLCODE = ZERO                                      13300078
                   CONTINUE                                             13310078
               WHEN OTHER                                               13320078
                   IF SQLCODE = -904 OR -911 OR -913                    13330078
                       SET PS-CONTENTION TO TRUE                        13340078
                   END-IF                                               13350078
                   MOVE 'TTFITRC'    TO DP013-DB2-TABLE-NAME (1)        13360078
                   MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)        13370078
                   SET PS-ERROR         TO TRUE                         13380078
                   MOVE PC-OPEN-RECEIPT-MSG                             13390078
                                     TO PV-ERROR-MSG                    13400078
                   MOVE PRV-10          TO DP013-MESSAGE-TEXT (1)       13410078
                   PERFORM 9000-RETURN-MSG                              13420078
                   MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)       13430078
                   MOVE SQLCA           TO DP013-SQLCA                  13440078
                   SET DP013-LINK-RETURN                                13450078
                       DP013-DB2-ABEND                                  13460078
                       DP013-NO-ROLLBACK TO TRUE                        13470078
                   PERFORM DP014-0000-PROCESS-ABEND                     13480078
           END-EVALUATE.                                                13490078
                                                                        13500078
       EJECT.                                                           13510078
      *----------------------------------------------------------------*13520078
      *    READ THE ITEMS FROM THE TRANSFER RECEIPT DATABASE WHERE     *13530078
      *    THE RECEIPT PRICE IS NOT EQUAL TO THE TRANSFER PRICE AND    *13540078
      *    CONTINUE BUILDING THE BLOCKS IN THE ARRAY.                  *13550078
      *----------------------------------------------------------------*13560078
       5700-READ-RECEIPT-ITEMS.                                         13570078
                                                                        13580078
           PERFORM VARYING PV-READ-COUNT                                13590078
                   FROM 1 BY 1                                          13600078
                   UNTIL (PS-NO-ITEMS-LEFT-ON-DB-2)                     13610078
                                                                        13620078
               PERFORM 5750-FETCH-RECEIPT-CURSOR                        13630078
                                                                        13640078
               IF  PS-ITEMS-LEFT-ON-DB-2                                13650078
                   MOVE SPACES               TO DL1-DETAIL-LINE-1       13660078
                   IF TFITRC-RCVD-XFER-QTY > 0                          13670078
                       MOVE TFITRC-RCVD-XFER-QTY TO DL1-RQTY            13680078
                       MOVE TFITRC-RCVD-XFER-PRIC-AMT                   13690078
                                            TO DL1-RPRICE               13700078
                   END-IF                                               13710078
                   COMPUTE PV-VARIANCE =                                13720078
                    ((0)   -                                            13730078
                     (TFITRC-RCVD-XFER-QTY * TFITRC-RCVD-XFER-PRIC-AMT))13740078
                   END-COMPUTE                                          13750078
                   MOVE PV-VARIANCE      TO PV-EDITTED-VARIANCE         13760078
                   IF PV-VARIANCE < ZERO                                13770078
                       MOVE '('          TO PV-EDIT-V-PAREN-1           13780078
                       MOVE ')'          TO PV-EDIT-V-PAREN-2           13790078
                   ELSE                                                 13800078
                       MOVE SPACE        TO PV-EDIT-V-PAREN-1           13810078
                                            PV-EDIT-V-PAREN-2           13820078
                   END-IF                                               13830078
                   MOVE PV-EDITTED-VARIANCE-FIELD                       13840078
                                         TO DL1-VARIANCE                13850078
                   ADD 1                 TO PV-LINE-COUNT               13860078
                   IF PV-LINE-COUNT > PC-PAGE-MAX                       13870078
                       PERFORM 8200-PRINT-HEADINGS                      13880078
                       PERFORM 8300-PRINT-COLUMN-HEADINGS               13890078
                   END-IF                                               13900078
                                                                        13910078
                   IF PS-FIRST-LINE                                     13920078
                       SET PS-NOT-FIRST-LINE   TO TRUE                  13930078
                       MOVE SKXREF-DEPT     TO DL1-DEPT                 13940078
                       IF SKXREF-CLASS < PC-100 AND                     13950078
                        SKXREF-SUBCLASS < PC-100                        13960078
                        MOVE SKXREF-CLASS TO DL1-CLASS-1                13970078
                        MOVE SKXREF-SUBCLASS TO DL1-SUBCLASS-1          13980078
                       ELSE IF                                          13990078
                        SKXREF-CLASS < PC-100 AND                       14000078
                        SKXREF-SUBCLASS > PC-099                        14010078
                        MOVE SKXREF-CLASS TO DL1-CLASS-2                14020078
                        MOVE SKXREF-SUBCLASS TO DL1-SUBCLASS-2          14030078
                        MOVE SPACES TO DL1-FILLER-2A                    14040078
                                       DL1-FILLER-2B                    14050078
                       ELSE IF                                          14060078
                        SKXREF-CLASS > PC-099 AND                       14070078
                        SKXREF-SUBCLASS < PC-100                        14080078
                        MOVE SKXREF-CLASS TO DL1-CLASS-3                14090078
                        MOVE SKXREF-SUBCLASS TO DL1-SUBCLASS-3          14100078
                        MOVE SPACES TO DL1-FILLER-3A                    14110078
                                       DL1-FILLER-3B                    14120078
                       ELSE IF                                          14130078
                        SKXREF-CLASS > PC-099 AND                       14140078
                        SKXREF-SUBCLASS > PC-099                        14150078
                        MOVE SKXREF-CLASS TO DL1-CLASS-4                14160078
                        MOVE SKXREF-SUBCLASS TO DL1-SUBCLASS-4          14170078
                        MOVE SPACES TO DL1-FILLER-4A                    14180078
                       END-IF                                           14190078
                       END-IF                                           14200078
                       END-IF                                           14210078
                       END-IF                                           14220078
                       MOVE TFITEM-KOHLS-UPC-NBR                        14230078
                                                TO DL1-UPC              14240078
                       MOVE '-'                 TO DL1-UPC-DASH-1       14250078
                                                   DL1-UPC-DASH-2       14260078
                                                   DL1-UPC-DASH-3       14270078
                       MOVE TFITEM-XFER-LNE-NBR TO DL1-LINE             14280078
                       IF TFITEM-XFER-QTY > 0                           14290078
                           MOVE TFITEM-XFER-QTY TO DL1-TQTY             14300078
                           MOVE TFITEM-XFER-PRIC-AMT                    14310078
                                                TO DL1-TPRICE           14320078
                       END-IF                                           14330078
                   END-IF                                               14340078
                   MOVE DL1-DETAIL-LINE-1                               14350078
                                            TO DRS01-COMM-DATA          14360078
                   MOVE PC-SINGLE-SPACE     TO DRS01-COMM-CTL           14370078
                   PERFORM 8000-LINK-TO-DRS                             14380078
               END-IF                                                   14390078
           END-PERFORM.                                                 14400078
                                                                        14410078
       EJECT.                                                           14420078
      *----------------------------------------------------------------*14430078
      *    FETCH THE TRANSFER RECEIPT CURSOR.                          *14440078
      *----------------------------------------------------------------*14450078
       5750-FETCH-RECEIPT-CURSOR.                                       14460078
                                                                        14470078
           MOVE '5750-FETCH-RECEIPT-CURSOR' TO DP013-PARAGRAPH.         14480078
                                                                        14490078
           EXEC SQL                                                     14500078
               FETCH XFER-RECEIPT-CSR                                   14510078
               INTO   :TFITRC-RCVD-XFER-PRIC-AMT                        14520078
                    , :TFITRC-RCVD-XFER-QTY                             14530078
           END-EXEC                                                     14540078
                                                                        14550078
           EVALUATE TRUE                                                14560078
               WHEN SQLCODE = ZERO                                      14570078
                    CONTINUE                                            14580078
               WHEN SQLCODE = +100                                      14590078
                    SET PS-NO-ITEMS-LEFT-ON-DB-2                        14600078
                                         TO TRUE                        14610078
               WHEN OTHER                                               14620078
                   IF SQLCODE = -904 OR -911 OR -913                    14630078
                       SET PS-CONTENTION TO TRUE                        14640078
                   END-IF                                               14650078
                    MOVE 'TTFITRC'    TO DP013-DB2-TABLE-NAME (1)       14660078
                    MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)       14670078
                    SET PS-ERROR         TO TRUE                        14680078
                    MOVE PC-FETCH-RECEIPT-MSG                           14690078
                                         TO PV-ERROR-MSG                14700078
                    MOVE PRV-11          TO DP013-MESSAGE-TEXT (1)      14710078
                    PERFORM 9000-RETURN-MSG                             14720078
                    MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)      14730078
                    MOVE SQLCA           TO DP013-SQLCA                 14740078
                    SET DP013-LINK-RETURN                               14750078
                        DP013-DB2-ABEND                                 14760078
                        DP013-NO-ROLLBACK TO TRUE                       14770078
                    PERFORM DP014-0000-PROCESS-ABEND                    14780078
           END-EVALUATE.                                                14790078
                                                                        14800078
       EJECT.                                                           14810078
      *----------------------------------------------------------------*14820078
      * CLOSE THE TRANSFER RECEIPT CURSOR.                             *14830078
      *----------------------------------------------------------------*14840078
       5800-CLOSE-RECEIPT-CURSOR.                                       14850078
                                                                        14860078
           MOVE '5800-CLOSE-RECEIPT-CURSOR' TO DP013-PARAGRAPH.         14870078
                                                                        14880078
           EXEC SQL                                                     14890078
               CLOSE XFER-RECEIPT-CSR                                   14900078
           END-EXEC.                                                    14910078
                                                                        14920078
           EVALUATE TRUE                                                14930078
               WHEN SQLCODE = ZERO                                      14940078
                   CONTINUE                                             14950078
               WHEN OTHER                                               14960078
                   IF SQLCODE = -904 OR -911 OR -913                    14970078
                       SET PS-CONTENTION TO TRUE                        14980078
                   END-IF                                               14990078
                   MOVE 'TTFITRC'    TO DP013-DB2-TABLE-NAME (1)        15000078
                   MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)        15010078
                   SET PS-ERROR         TO TRUE                         15020078
                   MOVE PC-CLOSE-RECEIPT-MSG                            15030078
                                         TO PV-ERROR-MSG                15040078
                   MOVE PRV-12          TO DP013-MESSAGE-TEXT (1)       15050078
                   PERFORM 9000-RETURN-MSG                              15060078
                   MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)       15070078
                   MOVE SQLCA           TO DP013-SQLCA                  15080078
                   SET DP013-LINK-RETURN                                15090078
                       DP013-DB2-ABEND                                  15100078
                       DP013-NO-ROLLBACK TO TRUE                        15110078
                   PERFORM DP014-0000-PROCESS-ABEND                     15120078
           END-EVALUATE.                                                15130078
                                                                        15140078
       EJECT.                                                           15150078
      *----------------------------------------------------------------*15160078
      *  READ THE TRANSFER RECEIPT TABLE FOR THE RECEIVED STORE NUMBER.*15170078
      *----------------------------------------------------------------*15180078
       6200-READ-TRANSFER-RECEIPT.                                      15190078
                                                                        15200078
           MOVE '6200-READ-TRANSFER-RECEIPT' TO DP013-PARAGRAPH.        15210078
                                                                        15220078
           EXEC SQL                                                     15230078
               SELECT R.STR_NBR                                         15240078
100404               ,S.LOC_10_ABBR_NM                                  15250084
                  INTO :TFRCPT-STR-NBR                                  15260078
100404               , :XST00001-LOC-10-ABBR-NM                         15270084
                  FROM TTFRCPT R                                        15280078
100404               , XST_LOC S                                        15290084
                     , TTFSTAT ST                                       15300078
                  WHERE ST.XFER_STAT_CDE = :PC-POSITIVE-RECEIPT AND     15310078
                        ST.XFER_STAT_TMST = R.RCV_XFER_BEG_TMST AND     15320078
                        R.XFER_DKEY_ID   = :DK-XFER-DKEY-ID     AND     15330078
                        ST.XFER_DKEY_ID  = :DK-XFER-DKEY-ID     AND     15340078
100404                  S.LOC_NBR        = R.STR_NBR                    15350084
           END-EXEC.                                                    15360078
                                                                        15370078
           EVALUATE TRUE                                                15380078
               WHEN SQLCODE = ZERO                                      15410078
                   MOVE TFRCPT-STR-NBR TO HL5-RC-STORE-NBR              15420078
100404             MOVE XST00001-LOC-10-ABBR-NM                         15430084
                                       TO HL5-RC-STORE-NAME             15440078
               WHEN SQLCODE = +100                                      15441084
                   CONTINUE                                             15442084
               WHEN OTHER                                               15450078
                   IF SQLCODE = -904 OR -911 OR -913                    15460078
                       SET PS-CONTENTION TO TRUE                        15470078
                   END-IF                                               15480078
                   MOVE 'TTFRCPT'    TO DP013-DB2-TABLE-NAME (1)        15490078
100404             MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (2)        15500084
                   MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (3)        15510078
                   SET PS-ERROR         TO TRUE                         15520078
                   MOVE PC-READ-TRANSFER-RECEIPT-MSG                    15530078
                                     TO PV-ERROR-MSG                    15540078
                   MOVE PRV-13          TO DP013-MESSAGE-TEXT (1)       15550078
                   PERFORM 9000-RETURN-MSG                              15560078
                   MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)       15570078
                   MOVE SQLCA           TO DP013-SQLCA                  15580078
                   SET DP013-LINK-RETURN                                15590078
                       DP013-DB2-ABEND                                  15600078
                       DP013-NO-ROLLBACK TO TRUE                        15610078
                   PERFORM DP014-0000-PROCESS-ABEND                     15620078
           END-EVALUATE.                                                15630078
                                                                        15640078
       EJECT.                                                           15650078
      *----------------------------------------------------------------*15660078
      * READ THE TRANSFER ITEM DISCREPANCY TABLE TO DETERMINE THE TOTAL*15670078
      * TRANSFER AMOUNT.                                               *15680078
      *----------------------------------------------------------------*15690078
       7000-READ-TOT-TRANSFER-AMT.                                      15700078
                                                                        15710078
           MOVE '7000-READ-TOT-TRANSFER-AMT' TO DP013-PARAGRAPH.        15720078
                                                                        15730078
           EXEC SQL                                                     15740078
               SELECT SUM(XFER_PRIC_AMT * XFER_QTY)                     15750078
                INTO :PV-XFER-TOTAL                                     15760078
                     :PV-XFER-IND                                       15770078
                FROM  TTFITEM I                                         15780078
                    , TTFITRC R                                         15790078
                    , TTFSTAT S                                         15800078
                WHERE                                                   15810078
                  S.XFER_DKEY_ID     = :DK-XFER-DKEY-ID     AND         15820078
                  I.XFER_DKEY_ID     = :DK-XFER-DKEY-ID     AND         15830078
                  R.XFER_DKEY_ID     = :DK-XFER-DKEY-ID     AND         15840078
                  S.XFER_STAT_CDE    = :PC-POSITIVE-RECEIPT AND         15850078
                  S.XFER_STAT_TMST   = R.XFER_RCPT_TMST     AND         15860078
                  R.XFER_LNE_NBR     = I.XFER_LNE_NBR       AND         15870078
                  R.XFER_LNE_SEQ_NBR = 1                    AND         15880078
                  EXISTS                                                15890078
                       (SELECT *                                        15900078
                        FROM TTFITRC A                                  15910078
                        WHERE                                           15920078
                      A.XFER_DKEY_ID    = :DK-XFER-DKEY-ID     AND      15930078
                      S.XFER_STAT_CDE   = :PC-POSITIVE-RECEIPT AND      15940078
                      S.XFER_STAT_TMST  = A.XFER_RCPT_TMST     AND      15950078
                      A.XFER_LNE_NBR    = I.XFER_LNE_NBR       AND      15960078
                      A.XFER_ITM_DSCRP_IND = 'Y')                       15970078
           END-EXEC.                                                    15980078
                                                                        15990078
           EVALUATE TRUE                                                16000078
               WHEN SQLCODE = +100                                      16010078
               WHEN SQLCODE = ZERO                                      16020078
                   CONTINUE                                             16030078
               WHEN OTHER                                               16040078
                   IF SQLCODE = -904 OR -911 OR -913                    16050078
                       SET PS-CONTENTION TO TRUE                        16060078
                   END-IF                                               16070078
                   MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)        16080078
                   SET PS-ERROR         TO TRUE                         16090078
                   MOVE PC-READ-TRANSFER-TOTAL-MSG                      16100078
                                     TO PV-ERROR-MSG                    16110078
                   MOVE PRV-14          TO DP013-MESSAGE-TEXT (1)       16120078
                   PERFORM 9000-RETURN-MSG                              16130078
                   MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)       16140078
                   MOVE SQLCA           TO DP013-SQLCA                  16150078
                   SET DP013-LINK-RETURN                                16160078
                       DP013-DB2-ABEND                                  16170078
                       DP013-NO-ROLLBACK TO TRUE                        16180078
                   PERFORM DP014-0000-PROCESS-ABEND                     16190078
           END-EVALUATE.                                                16200078
                                                                        16210078
           IF PV-XFER-IND < 0                                           16220078
               MOVE ZEROES            TO PV-XFER-TOTAL                  16230078
           END-IF.                                                      16240078
                                                                        16250078
       EJECT.                                                           16260078
      *----------------------------------------------------------------*16270078
      * READ THE TRANSFER ITEM RECEIPT TABLE TO DETERMINE THE TOTAL    *16280078
      * RECEIVED AMOUNT.                                               *16290078
      *----------------------------------------------------------------*16300078
       7100-READ-TOT-RECEIPT-AMT.                                       16310078
                                                                        16320078
           MOVE '7100-READ-TOT-RECEIPT-AMT' TO DP013-PARAGRAPH.         16330078
                                                                        16340078
           EXEC SQL                                                     16350078
               SELECT SUM(RCVD_XFER_PRIC_AMT * RCVD_XFER_QTY)           16360078
                INTO :PV-RCVD-TOTAL                                     16370078
                     :PV-RCVD-IND                                       16380078
                FROM  TTFITEM I                                         16390078
                    , TTFITRC R                                         16400078
                    , TTFSTAT S                                         16410078
                WHERE                                                   16420078
                  S.XFER_DKEY_ID     = :DK-XFER-DKEY-ID     AND         16430078
                  I.XFER_DKEY_ID     = :DK-XFER-DKEY-ID     AND         16440078
                  R.XFER_DKEY_ID     = :DK-XFER-DKEY-ID     AND         16450078
                  S.XFER_STAT_CDE    = :PC-POSITIVE-RECEIPT AND         16460078
                  S.XFER_STAT_TMST   = R.XFER_RCPT_TMST     AND         16470078
                  R.XFER_LNE_NBR     = I.XFER_LNE_NBR       AND         16480078
                  EXISTS                                                16490078
                       (SELECT *                                        16500078
                        FROM TTFITRC R                                  16510078
                        WHERE                                           16520078
                      S.XFER_DKEY_ID    = :DK-XFER-DKEY-ID     AND      16530078
                      I.XFER_DKEY_ID    = :DK-XFER-DKEY-ID     AND      16540078
                      R.XFER_DKEY_ID    = :DK-XFER-DKEY-ID     AND      16550078
                      S.XFER_STAT_CDE   = :PC-POSITIVE-RECEIPT AND      16560078
                      S.XFER_STAT_TMST  = R.XFER_RCPT_TMST     AND      16570078
                      R.XFER_LNE_NBR    = I.XFER_LNE_NBR       AND      16580078
                      R.XFER_ITM_DSCRP_IND = 'Y')                       16590078
           END-EXEC.                                                    16600078
                                                                        16610078
           EVALUATE TRUE                                                16620078
               WHEN SQLCODE = +100                                      16630078
               WHEN SQLCODE = ZERO                                      16640078
                   CONTINUE                                             16650078
               WHEN OTHER                                               16660078
                   IF SQLCODE = -904 OR -911 OR -913                    16670078
                       SET PS-CONTENTION TO TRUE                        16680078
                   END-IF                                               16690078
                   MOVE 'TTFITRC'    TO DP013-DB2-TABLE-NAME (1)        16700078
                   SET PS-ERROR         TO TRUE                         16710078
                   MOVE PC-READ-RECEIPT-TOTAL-MSG                       16720078
                                     TO PV-ERROR-MSG                    16730078
                   MOVE PRV-15          TO DP013-MESSAGE-TEXT (1)       16740078
                   PERFORM 9000-RETURN-MSG                              16750078
                   MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)       16760078
                   MOVE SQLCA           TO DP013-SQLCA                  16770078
                   SET DP013-LINK-RETURN                                16780078
                       DP013-DB2-ABEND                                  16790078
                       DP013-NO-ROLLBACK TO TRUE                        16800078
                   PERFORM DP014-0000-PROCESS-ABEND                     16810078
           END-EVALUATE.                                                16820078
                                                                        16830078
           IF PV-RCVD-IND < 0                                           16840078
               MOVE ZEROES            TO PV-RCVD-TOTAL                  16850078
           END-IF.                                                      16860078
                                                                        16870078
       EJECT.                                                           16880078
      ******************************************************************16890078
      * THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     16900078
      ******************************************************************16910078
       8000-LINK-TO-DRS.                                                16920078
                                                                        16930078
           EXEC CICS                                                    16940078
               LINK                                                     16950078
                   PROGRAM   ('DRS1INTC')                               16960078
                   COMMAREA  (DRS01-COMMAREA)                           16970078
           END-EXEC.                                                    16980078
                                                                        16990078
       EJECT.                                                           17000078
      ******************************************************************17010078
      * FORMAT THE REPORT HEADING DATE AND TIME FIELDS.                 17020078
      ******************************************************************17030078
       8100-FORMAT-TIME.                                                17040078
                                                                        17050078
           EXEC CICS                                                    17060078
               ASKTIME ABSTIME (PV-ABSTIME)                             17070078
           END-EXEC.                                                    17080078
                                                                        17090078
           EXEC CICS                                                    17100078
               FORMATTIME ABSTIME  (PV-ABSTIME)                         17110078
                          MMDDYY   (DP132O-RUN-DATE)                    17120078
                          DATESEP  ('/')                                17130078
                          TIME     (DP132O-RUN-TIME)                    17140078
                          TIMESEP  (':')                                17150078
           END-EXEC.                                                    17160078
                                                                        17170078
       EJECT.                                                           17180078
      ******************************************************************17190078
      *  PRINT THE REPORT HEADING LINES.                                17200078
      ******************************************************************17210078
       8200-PRINT-HEADINGS.                                             17220078
                                                                        17230078
           ADD 1                       TO PV-PAGE-COUNT.                17240078
           MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           17250078
           MOVE DP132O-STANDRD-HEADER-132-COLS                          17260078
                                       TO DRS01-COMM-DATA.              17270078
           MOVE PC-TOP-OF-PAGE         TO DRS01-COMM-CTL.               17280078
           PERFORM 8000-LINK-TO-DRS.                                    17290078
                                                                        17300078
           MOVE HL2-HEADING-LINE-2     TO DRS01-COMM-DATA.              17310078
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               17320078
           PERFORM 8000-LINK-TO-DRS.                                    17330078
                                                                        17340078
           MOVE HL3-HEADING-LINE-3     TO DRS01-COMM-DATA.              17350078
           MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               17360078
           PERFORM 8000-LINK-TO-DRS.                                    17370078
                                                                        17380078
           MOVE HL4-HEADING-LINE-4     TO DRS01-COMM-DATA.              17390078
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               17400078
           PERFORM 8000-LINK-TO-DRS.                                    17410078
                                                                        17420078
           MOVE HL5-HEADING-LINE-5     TO DRS01-COMM-DATA.              17430078
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               17440078
           PERFORM 8000-LINK-TO-DRS.                                    17450078
                                                                        17460078
           MOVE HL6-HEADING-LINE-6     TO DRS01-COMM-DATA.              17470078
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               17480078
           PERFORM 8000-LINK-TO-DRS.                                    17490078
                                                                        17500078
       EJECT.                                                           17510078
      ******************************************************************17520078
      *  PRINT THE REPORT COLUMN HEADINGS.                              17530078
      ******************************************************************17540078
       8300-PRINT-COLUMN-HEADINGS.                                      17550078
                                                                        17560078
           MOVE HL7-HEADING-LINE-7     TO DRS01-COMM-DATA.              17570078
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               17580078
           PERFORM 8000-LINK-TO-DRS.                                    17590078
                                                                        17600078
           MOVE HL8-HEADING-LINE-8     TO DRS01-COMM-DATA.              17610078
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               17620078
           PERFORM 8000-LINK-TO-DRS.                                    17630078
                                                                        17640078
           MOVE BL-BLANK-LINE          TO DRS01-COMM-DATA.              17650078
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               17660078
           PERFORM 8000-LINK-TO-DRS.                                    17670078
           MOVE 09                       TO PV-LINE-COUNT.              17680078
           SET PS-FIRST-LINE           TO TRUE.                         17690078
                                                                        17700078
       EJECT.                                                           17710078
      *----------------------------------------------------------------*17720078
      * BUILD A CICS ERROR MESSAGE WITH DATA FROM THE PASSED COMMAREA.  17730078
      *----------------------------------------------------------------*17740078
       9000-RETURN-MSG.                                                 17750078
                                                                        17760078
           MOVE TF005-USER-ID       TO PV-DISPLAY-USER-ID.              17770078
           MOVE TF005-XFER-FROM-STORE-NBR                               17780078
                                    TO PV-DISPLAY-XFER-FROM-STORE-NBR.  17790078
           MOVE TF005-XFER-SEQ-NBR  TO PV-DISPLAY-XFER-SEQ-NBR.         17800078
           MOVE TF005-PRINTER-DEST  TO PV-DISPLAY-PRINTER-DEST.         17810078
                                                                        17820078
       EJECT.                                                           17830078
      *----------------------------------------------------------------*17840078
      * PRINT AN ERROR REPORT INDICATING THE REASON FOR THE PROGRAM     17850078
      * TERMINATION.                                                    17860078
      *----------------------------------------------------------------*17870078
       9000-PRINT-ERROR.                                                17880078
                                                                        17890078
           MOVE EH1-ERROR-HEADING-1        TO  DRS01-COMM-DATA.         17900078
           MOVE PC-TOP-OF-PAGE             TO  DRS01-COMM-CTL.          17910078
           PERFORM 8000-LINK-TO-DRS.                                    17920078
                                                                        17930078
           MOVE TF005-XFER-FROM-STORE-NBR  TO EH2-FROM-STORE-NBR.       17940078
           MOVE TF005-XFER-SEQ-NBR         TO EH2-XFER-SEQ-NBR.         17950078
           IF TF005-USER-ID > SPACES                                    17960078
               MOVE TF005-USER-ID          TO EH2-USER-ID               17970078
           ELSE                                                         17980078
               MOVE 'PTC'                  TO EH2-USER-ID               17990078
           END-IF.                                                      18000078
           MOVE EH2-ERROR-HEADING-2        TO  DRS01-COMM-DATA.         18010078
           MOVE PC-TRIPLE-SPACE            TO  DRS01-COMM-CTL.          18020078
           PERFORM 8000-LINK-TO-DRS.                                    18030078
                                                                        18040078
           MOVE PV-ERROR-MSG               TO ED1-ERROR.                18050078
           MOVE PV-ERROR-KEY               TO ED1-ERROR-KEY.            18060078
           MOVE ED1-ERROR-DETAIL-1         TO  DRS01-COMM-DATA.         18070078
           MOVE PC-TRIPLE-SPACE            TO  DRS01-COMM-CTL.          18080078
           PERFORM 8000-LINK-TO-DRS.                                    18090078
                                                                        18100078
           IF PS-CONTENTION                                             18110078
               MOVE PC-CONTENTION-MSG      TO ED2-MESSAGE               18120078
               MOVE ED2-ERROR-DETAIL-2     TO  DRS01-COMM-DATA          18130078
               MOVE PC-TRIPLE-SPACE        TO  DRS01-COMM-CTL           18140078
               PERFORM 8000-LINK-TO-DRS                                 18150078
           END-IF.                                                      18160078
                                                                        18170078
           COPY DPPD014.                                                18180083
