000240*-----------------------*                                         00024001
000250 IDENTIFICATION DIVISION.                                         00025001
000260*-----------------------*                                         00026001
000270 PROGRAM-ID.    CNKCS224.                                         00027001
000280 AUTHOR.        DEANNA BRANTNER.                                  00028001
000290 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00029001
000300 DATE-WRITTEN.  JANUARY, 2001.                                    00030001
000400 DATE-COMPILED.                                                   00040001
000500*----------------------------------------------------------------*00050001
000600*    Y224 - DC-DOOR DEFINITION CRITERIA SPECIFICATION            *00060001
000700*                                                                *00070001
000800*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY    *00080001
000900*    SUBSEQUENT PROGRAMS.  FROM THIS SCREEN THE USER CAN PRESS:  *00090001
001000*    F13 TO ADD A DOOR                                           *00100001
001100*    F15 TO UPDATE A DOOR                                        *00110001
001200*    F17 TO DISPLAY A LIST OF DOOR TYPES                         *00120001
001500*    F23 TO DISPLAY A LIST OF DOOR ASSIGNMENTS                   *00150001
001600*    F24 TO PERFORM A STORE ASSIGNMENT                           *00160001
001700*----------------------------------------------------------------*00170001
263455* CHANGED 11/02/2021    BY JIM HUNTER      WR: CHG0263455         00180093
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00190093
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00191093
263455*----------------------------------------------------------------*00192093
CICS  * CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961         00193094
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00194094
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00195094
CICS  *-----------------------------------------------------------------00196094
002000 ENVIRONMENT DIVISION.                                            00200001
002200 DATA DIVISION.                                                   00220001
002300                                                                  00230001
002400 WORKING-STORAGE SECTION.                                         00240001
002500                                                                  00250001
002600 01  DK-DB2-KEYS.                                                 00260001
002700     05  DK-OPER-UNT-ID            PIC S9(04) COMP VALUE +0.      00270001
002800     05  DK-FCLTY-ID               PIC S9(04) COMP VALUE +0.      00280001
002900     05  DK-PRINTER-ID             PIC X(08)       VALUE SPACES.  00290054
002910     05  DK-DOOR-TYPE-CDE          PIC X(02)       VALUE SPACES.  00291054
002920     05  DK-DOOR-ID                PIC X(04)       VALUE SPACES.  00292076
003000                                                                  00300001
003400 01  PV-PROGRAM-VARIABLES.                                        00340001
003500     05  PV-CICS-RESPONSE          PIC S9(08)  VALUE ZEROES       00350001
003600                                   COMP SYNC.                     00360001
004200                                                                  00420001
004300     05  PV-RETRY-COUNTER                PIC S9(04)  VALUE +0     00430001
004400                                                    COMP SYNC.    00440001
004500                                                                  00450001
005400 01  PC-PROGRAM-CONSTANTS.                                        00540001
005500     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'CNK224'.   00550001
005600     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'CNKM224'.  00560001
005700     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'CNKCS224'. 00570001
005800     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE  'DPKCS060'. 00580001
005900     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE  'CNKCS224'. 00590001
006000     05  PC-01                     PIC  X(02)  VALUE  '01'.       00600001
006100     05  PC-DC                     PIC  X(02)  VALUE  'DC'.       00610001
006200     05  PC-A                      PIC  X(01)  VALUE  'A'.        00620001
006210     05  PC-D                      PIC  X(01)  VALUE  'D'.        00621078
006300     05  PC-N                      PIC  X(01)  VALUE  'N'.        00630001
006310     05  PC-U                      PIC  X(01)  VALUE  'U'.        00631026
006400     05  PC-Y                      PIC  X(01)  VALUE  'Y'.        00640001
006500     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00650001
006600                                               COMP-3.            00660001
006700*                                                                 00670001
006800 01  PS-PROGRAM-SWITCHES.                                         00680001
006900     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00690001
007000         88  PS-ERROR                          VALUE  'Y'.        00700001
007100         88  PS-NO-ERROR                       VALUE  'N'.        00710001
007200     05  PS-PRINTER-ID-EXISTS-SW   PIC  X(01)  VALUE  'N'.        00720001
007300         88  PS-PRINTER-ID-EXISTS              VALUE  'Y'.        00730001
007400         88  PS-PRINTER-ID-DOESNT-EXIST        VALUE  'N'.        00740001
007500     05  PS-DOOR-TYPE-EXISTS-SW    PIC  X(01)  VALUE  'N'.        00750001
007600         88  PS-DOOR-TYPE-EXISTS               VALUE  'Y'.        00760001
007700         88  PS-DOOR-TYPE-DOESNT-EXIST         VALUE  'N'.        00770001
007800                                                                  00780001
007900*----------------------------------------------------------------*00790001
008000*  SYSTEM MESSAGES                                               *00800001
008100*----------------------------------------------------------------*00810001
008200*   00005 - INVALID VALUE                                         00820013
008300*   00007 - REQUIRED ENTRY                                        00830013
008400*   00008 - MUST BE NUMERIC                                       00840013
008500*   02571 - UNABLE TO UPD - CURRENT OPER UNT AND OPER UNIT ID ENTE00850037
008501*   02572 - INVALID VALUE - OPER UNIT ID MUST BE A DC LOCATION    00850136
008510*   02573 - ADD FUNCTION INVALID - DOOR ALREADY DEFINED FOR THE DC00851030
008520*   02574 - UPDATE FUNCTION INVALID - DOOR IS CURRENTLY NOT DEFINE00852030
008530*   02575 - STORE ASSIGNMNT FUNCTION ONLY VALID FOR DOOR TYPES SHI00853034
008600*----------------------------------------------------------------*00860001
008800 01  PC-TSYMSG-NUMBERS.                                           00880001
008900     05  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.          00890001
009000     05  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.          00900001
009100     05  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.          00910001
009200     05  PC-TSYMSG-02571       PIC  9(05)  VALUE  02571.          00920036
009201     05  PC-TSYMSG-02572       PIC  9(05)  VALUE  02572.          00920136
009210     05  PC-TSYMSG-02573       PIC  9(05)  VALUE  02573.          00921001
009220     05  PC-TSYMSG-02574       PIC  9(05)  VALUE  02574.          00922001
009230     05  PC-TSYMSG-02575       PIC  9(05)  VALUE  02575.          00923001
009300*                                                                 00930001
009400 01  PM-PROGRAM-MESSAGES.                                         00940001
009500     05  PM-ABEND-INFO-A.                                         00950001
009600         10  FILLER                PIC X(15)   VALUE              00960001
009700                                   'DP020-SRC-AID: '.             00970001
009800         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      00980001
009900         10  FILLER                PIC X(19)   VALUE              00990001
010000                                   '. DP020-FK-ACTION: '.         01000001
010100         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      01010001
010200         10  FILLER                PIC X(22)   VALUE              01020001
010300                                   '. DP020-FK-DISPN-IND: '.      01030001
010400         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      01040001
010500         10  FILLER                PIC X(01)   VALUE '.'.         01050001
010600         10  FILLER                PIC X(19)   VALUE SPACE.       01060001
010700                                                                  01070001
010900*----------------------------------------------------------------*01090001
011000*    MAP LAYOUT                                                  *01100001
011100*----------------------------------------------------------------*01110001
011300     COPY CNKM224.                                                01130001
011500                                                                  01150001
011700*----------------------------------------------------------------*01170001
011800*    ATTRIBUTE SETTINGS COPYBOOK.                                *01180001
011900*----------------------------------------------------------------*01190001
012100     COPY DPWS015.                                                01210001
012200                                                                  01220001
012300*----------------------------------------------------------------*01230001
012400*    FUNCTION KEYS COPYBOOK                                      *01240001
012500*----------------------------------------------------------------*01250001
012700     COPY DPWS016.                                                01270001
012800                                                                  01280001
012900******************************************************************01290001
013000** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01300001
013100** SUB-ROUTINE (DPKUT100).                                      **01310001
013200******************************************************************01320001
013300     COPY DPWS010I.                                               01330001
013400                                                                  01340001
013500******************************************************************01350001
013600** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **01360001
013700** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **01370001
013800******************************************************************01380001
013900     COPY DPWS030.                                                01390001
CICS       COPY DPWS930.                                                01391094
014000                                                                  01400001
014100***************************************************************** 01410001
014200*    STANDARD COMMAREA.                                           01420001
014300***************************************************************** 01430001
014500     COPY DPWS020.                                                01450001
014600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01460001
014700                                                                  01470001
014800***************************************************************** 01480001
014900*    INTER-APPLICATION COMMAREA.                                  01490001
015000***************************************************************** 01500001
015200         10  INTER-APPL-COMM-AREA PIC X(200).                     01520001
015300     COPY CNWS011.                                                01530001
015310                                                                  01531001
015400***************************************************************** 01540001
015500*    SPECIFIC COMMAREA FOR CNKCS224.                              01550001
015600***************************************************************** 01560001
015700         10  ASC-SPECIFIC-COMMAREA.                               01570001
015800             15  ASC-LIST-KEYS.                                   01580001
015900                 20  ASC-CURR-OPER-UNT-ID    PIC  9(04).          01590036
016100                 20  ASC-CURR-FCLTY-ID       PIC  9(04).          01610036
016300             15  ASC-OPER-UNT-ID             PIC  X(04).          01630001
016400             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID      01640001
016500                                             PIC  9(04).          01650041
016600             15  ASC-FCLTY-ID                PIC  X(04).          01660001
016700             15  ASC-FCLTY-ID-N REDEFINES ASC-FCLTY-ID            01670001
016800                                             PIC  Z(04).          01680001
016900             15  ASC-CURR-FCLTY-NME          PIC  X(25).          01690004
017000             15  ASC-FCLTY-NME               PIC  X(25).          01700004
017100             15  ASC-PRINTER-ID              PIC  X(08).          01710001
017200             15  ASC-PRINTER-ID-SW           PIC  X(01).          01720001
017300                 88  ASC-PRINTER-ID-ENTERED     VALUE 'Y'.        01730001
017400                 88  ASC-NO-PRINTER-ID-ENTERED  VALUE 'N'.        01740001
017500             15  ASC-FUNCTION                PIC  X(01).          01750004
017600             15  ASC-DOOR-ID                 PIC  X(04).          01760008
017700             15  ASC-DOOR-TYPE-CDE           PIC  X(02).          01770004
017710             15  ASC-DOOR-TYPE-DESC          PIC  X(30).          01771044
017720             15  ASC-LOC-DESC                PIC  X(30).          01772046
017800             15  ASC-DIVERT-CODE             PIC S9(09) COMP.     01780004
017810             15  ASC-DIVERT-LOC              PIC  X(04).          01781077
017900             15  ASC-LABEL-SEQ               PIC S9(09) COMP.     01790004
018200             15  FILLER                      PIC  X(40).          01820077
018300                                                                  01830001
018400*----------------------------------------------------------------*01840001
018500*    ABEND PROCESSING COPYBOOK.                                  *01850001
018600*----------------------------------------------------------------*01860001
018800     COPY DPWS013.                                                01880001
018900                                                                  01890001
019000*----------------------------------------------------------------*01900001
019100*    CONTROL DOOR TYPE TABLE                                      01910001
019200*----------------------------------------------------------------*01920001
019400     EXEC SQL                                                     01940001
019500          INCLUDE TCNDRTY                                         01950001
019600     END-EXEC.                                                    01960001
019700                                                                  01970001
019800*----------------------------------------------------------------*01980001
019900*    CONTROL DC DOORS TABLE                                       01990001
020000*----------------------------------------------------------------*02000001
020200     EXEC SQL                                                     02020001
020300          INCLUDE TCNDCDR                                         02030001
020400     END-EXEC.                                                    02040001
020500                                                                  02050001
020501*----------------------------------------------------------------*02050101
020502*    COMMAREA USED TO CALL XLKUT071                               02050286
020503*----------------------------------------------------------------*02050301
020510     COPY XLWS071.                                                02051086
020540                                                                  02054001
022100*----------------------------------------------------------------*02210001
022300*  COMMUNICATION AREAS FOR DB2                                    02230001
022310*----------------------------------------------------------------*02231001
022500     EXEC SQL                                                     02250001
022600         INCLUDE SQLCA                                            02260001
022700     END-EXEC.                                                    02270001
022900                                                                  02290001
023000*----------------------------------------------------------------*02300001
023100 LINKAGE SECTION.                                                 02310001
023200                                                                  02320001
023300 01  DFHCOMMAREA.                                                 02330001
023400     05  FILLER                         OCCURS  1 TO 4072 TIMES   02340001
023500                                        DEPENDING ON EIBCALEN.    02350001
023600         10  FILLER                     PIC X.                    02360001
023700                                                                  02370001
023800                                                                  02380001
023900 PROCEDURE DIVISION.                                              02390001
024000***************************************************************** 02400001
024100** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02410001
024200** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02420001
024300** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02430001
024400**                                                             ** 02440001
024500** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02450001
024600** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 02460001
024700***************************************************************** 02470001
024800 0000-MAIN-MODULE.                                                02480001
024900     INITIALIZE DP030-CICS-API-FIELDS.                            02490001
025000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02500001
025100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02510001
025200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02520001
025300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02530001
025400     MOVE LENGTH OF CNK224I       TO DP030-MAP-LENGTH (1).        02540001
025500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02550001
025600     PERFORM 0001-CALL-CICS-ARCH-API.                             02560001
025700*                                                                 02570001
025800     PERFORM 1000-CONTROL-PROCESSING                              02580001
025900*                                                                 02590001
026000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02600001
026100     PERFORM 0001-CALL-CICS-ARCH-API.                             02610001
026200                                                                  02620001
026210*---------------------------------------------------------------- 02621001
026300 0001-CALL-CICS-ARCH-API.                                         02630001
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02640094
026500                                    DFHCOMMAREA                   02650094
026600                                    DP030-CICS-API-FIELDS         02660094
026700                                    DP020-STANDARD-COMMAREA       02670094
026800                                    CNK224I.                      02680094
026900*                                                                 02690001
027000     IF  DP030-RC-CALL-SUCCESSFUL                                 02700001
027100         CONTINUE                                                 02710001
027200     ELSE                                                         02720001
027300         SET DP013-NO-ROLLBACK                                    02730001
027400             DP013-XCTL-DISPLAY-RESTART                           02740001
027500             DP013-CICS-ABEND      TO TRUE                        02750001
027600         MOVE 'BEFORE 0000-MAIN-MODULE'                           02760001
027700                                   TO DP013-PARAGRAPH             02770001
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02771094
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02772094
028000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      02800001
028200         PERFORM DP013-0000-PROCESS-ABEND                         02820001
028300     END-IF.                                                      02830001
028600                                                                  02860001
028700*----------------------------------------------------------------*02870001
028800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02880001
028900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02890001
029000*----------------------------------------------------------------*02900001
029100 1000-CONTROL-PROCESSING.                                         02910001
029200                                                                  02920001
029300     EVALUATE TRUE                                                02930001
029400         WHEN DP020-NEXT-ACT-INITIAL                              02940001
029600             INITIALIZE ASC-SPECIFIC-COMMAREA                     02960001
029700             MOVE DP020-LOCATION-NBR TO ASC-CURR-OPER-UNT-ID      02970085
030100             MOVE 1                 TO ASC-CURR-FCLTY-ID          03010007
030500             PERFORM 4000-BUILD-INITIAL-PANEL                     03050001
030510             PERFORM 3200-RESET-ATTRIBUTES                        03051082
030600                                                                  03060053
030610         WHEN DP020-NEXT-ACT-RETURN                               03061053
030611             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03061153
030612             PERFORM 3200-RESET-ATTRIBUTES                        03061253
030620                                                                  03062053
030700         WHEN DP020-NEXT-ACT-READ-MAP                             03070001
030800             PERFORM 2000-FKEY-PROCESSING                         03080001
030900                                                                  03090001
031000         WHEN OTHER                                               03100001
031100             SET DP013-LOGIC-ABEND                                03110001
031200                 DP013-NO-ROLLBACK TO TRUE                        03120001
031300             MOVE 'CNKCS224 - 1000-CONTROL-PROCESSING'            03130001
031400                                   TO  DP013-PARAGRAPH            03140001
031500             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   03150001
031600                                   TO  DP013-MESSAGE-TEXT(1)      03160001
031700             MOVE DP020-NEXT-APPL-ACTIVITY                        03170001
031800                                   TO DP013-MESSAGE-TEXT(2)       03180001
031900             PERFORM DP013-0000-PROCESS-ABEND                     03190001
032000     END-EVALUATE.                                                03200001
032200                                                                  03220001
032300*----------------------------------------------------------------*03230001
032400* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*03240001
032500* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*03250001
032600* EDITS.                                                         *03260001
032700*----------------------------------------------------------------*03270001
032800 2000-FKEY-PROCESSING.                                            03280001
032900                                                                  03290001
033000     EVALUATE TRUE                                                03300001
033100                                                                  03310001
033200         WHEN DP020-SRC-AID = DP016-CLEAR                         03320001
033300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03330001
033400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03340053
033500                                                                  03350001
033600*F5-REFRESH                                                       03360001
033700         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03370051
033800             INITIALIZE ASC-SPECIFIC-COMMAREA                     03380052
033801             IF DP020-LOCATION-TYPE = 'DC'                        03380183
033802                 MOVE SPACES      TO AOPRNMEO                     03380284
033803                                     ADRTYPCO                     03380384
033804                                     ADRTYDSO                     03380484
033805                                     ADOORIDO                     03380584
033806             ELSE                                                 03380684
033810                 MOVE SPACES      TO AOPRUNTO                     03381082
033820                                     AOPRNMEO                     03382070
033840                                     ADRTYPCO                     03384070
033850                                     ADRTYDSO                     03385070
033860                                     ADOORIDO                     03386071
033870             END-IF                                               03387084
033900             MOVE DP020-LOCATION-NBR TO ASC-CURR-OPER-UNT-ID      03390089
034200             MOVE 1              TO ASC-CURR-FCLTY-ID             03420052
034400             PERFORM 4000-BUILD-INITIAL-PANEL                     03440052
034500             PERFORM 3200-RESET-ATTRIBUTES                        03450051
034600                                                                  03460051
034700         WHEN OTHER                                               03470001
034800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03480001
034900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03490001
035000             IF  PS-NO-ERROR                                      03500001
035100                 SET DP030-CONTINUE-GO TO TRUE                    03510001
035200                 PERFORM 2100-CHECK-FUNCTION-KEY                  03520001
035210                 IF  PS-ERROR                                     03521025
035220                     SET DP030-OVERRIDE-GO TO TRUE                03522025
035230                 END-IF                                           03523025
035300             ELSE                                                 03530001
035400                 SET DP030-OVERRIDE-GO TO TRUE                    03540001
035500             END-IF                                               03550001
035600     END-EVALUATE.                                                03560001
035700                                                                  03570001
035800******************************************************************03580001
035900** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **03590001
036000** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **03600001
036100** FROM THE CICS ARCHITECTURE API.                              **03610001
036200******************************************************************03620001
036300 2100-CHECK-FUNCTION-KEY.                                         03630026
036400     EVALUATE TRUE                                                03640026
036500                                                                  03650026
036600         WHEN DP020-SRC-AID = DP016-ENTER                         03660026
036601           IF ASC-OPER-UNT-ID     NOT = SPACES                    03660138
036602               IF ASC-DOOR-ID         NOT = SPACES                03660260
036610                   PERFORM 3060-RETRIEVE-DOOR-TYPE                03661060
036612               END-IF                                             03661260
036613           END-IF                                                 03661339
036620           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   03662038
036800                                                                  03680026
036900*F13 ADDDOOR  ----> GOES TO CNKCS225 TO PROCESS A DOOR ADD        03690026
037000         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              03700026
037100           IF  ASC-OPER-UNT-ID = SPACES                           03710035
037200               SET PS-ERROR                                       03720035
037201                   DP020-MSG-FATAL         TO TRUE                03720135
037202               MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER    03720235
037203               MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA            03720335
037204               MOVE DP015-RED              TO AOPRUNTC            03720435
037205               MOVE DP015-REVERSE          TO AOPRUNTH            03720535
037206               MOVE -1                     TO AOPRUNTL            03720635
037207               SET DP030-SET-CURSOR-APPL-1 TO TRUE                03720735
037208               MOVE SPACES                 TO AOPRNMEO            03720835
037209           ELSE                                                   03720935
037211               PERFORM 3030-CHECK-4-ROW-ON-CNDCDR                 03721144
037212               MOVE PC-A  TO ASC-FUNCTION                         03721255
037220               PERFORM 2110-PREPARE-INTER-APPL-COMM               03722035
037230           END-IF                                                 03723035
037240           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   03724060
037654                                                                  03765423
037655*F15 UPDDOOR  ----> GOES TO CNKCS225 TO PROCESS A DOOR UPDATE     03765526
037656         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              03765629
037657           IF  ASC-OPER-UNT-ID = SPACES                           03765735
037658               SET PS-ERROR                                       03765835
037659                   DP020-MSG-FATAL         TO TRUE                03765935
037660               MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER    03766035
037661               MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA            03766135
037662               MOVE DP015-RED              TO AOPRUNTC            03766235
037663               MOVE DP015-REVERSE          TO AOPRUNTH            03766335
037664               MOVE -1                     TO AOPRUNTL            03766435
037665               SET DP030-SET-CURSOR-APPL-1 TO TRUE                03766535
037666               MOVE SPACES                 TO AOPRNMEO            03766635
037667           ELSE                                                   03766735
037670               IF  ASC-DOOR-ID = SPACES                           03767056
037674                   SET PS-ERROR                                   03767456
037675                       DP020-MSG-FATAL         TO TRUE            03767556
037676                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER     03767656
037677                   MOVE DP015-UNP-ALP-BRT-OFF  TO ADOORIDA        03767756
037678                   MOVE DP015-RED              TO ADOORIDC        03767856
037679                   MOVE DP015-REVERSE          TO ADOORIDH        03767956
037680                   MOVE -1                     TO ADOORIDL        03768056
037681                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            03768156
037682               ELSE                                               03768256
037683                   PERFORM 3060-RETRIEVE-DOOR-TYPE                03768356
037685                   MOVE PC-U  TO  ASC-FUNCTION                    03768544
037686                   PERFORM 3040-CHECK-4-ROW-ON-CNDCDR             03768644
037688                   PERFORM 2110-PREPARE-INTER-APPL-COMM           03768844
037690               END-IF                                             03769035
037691           END-IF                                                 03769156
037692           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   03769260
037700                                                                  03770026
037800*F17 TYPELIST ----> GOES TO CNKCS226 TO LIST DOOR TYPES           03780026
037900         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              03790029
038000           PERFORM 2110-PREPARE-INTER-APPL-COMM                   03800063
038020           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   03802060
038100                                                                  03810026
038200*F18 STRLIST ----> GOES TO CNKCS231 TO LIST CURRENT STORES        03820074
038300         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              03830074
038400           PERFORM 2110-PREPARE-INTER-APPL-COMM                   03840074
038500           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   03850075
038600                                                                  03860074
039000*F23 DOORLIST ----> GOES TO CNKCS227 TO LIST DOORS                03900074
039100         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              03910074
039110           IF  ASC-OPER-UNT-ID = SPACES                           03911074
039120               SET PS-ERROR                                       03912074
039130                   DP020-MSG-FATAL         TO TRUE                03913074
039140               MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER    03914074
039150               MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA            03915074
039160               MOVE DP015-RED              TO AOPRUNTC            03916074
039170               MOVE DP015-REVERSE          TO AOPRUNTH            03917074
039180               MOVE -1                     TO AOPRUNTL            03918074
039190               SET DP030-SET-CURSOR-APPL-1 TO TRUE                03919074
039191               MOVE SPACES                 TO AOPRNMEO            03919174
039192           ELSE                                                   03919274
039200               PERFORM 2110-PREPARE-INTER-APPL-COMM               03920074
039210           END-IF                                                 03921074
039220           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   03922074
039300                                                                  03930074
039400*F24 STRASGNM ----> GOES TO CNKCS228 TO PROCESS A STORE ASSIGNMENT03940074
039500         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              03950074
039501             IF  ASC-OPER-UNT-ID = SPACES                         03950174
039502                 SET PS-ERROR                                     03950274
039503                     DP020-MSG-FATAL         TO TRUE              03950374
039504                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  03950474
039505                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA          03950574
039506                 MOVE DP015-RED              TO AOPRUNTC          03950674
039507                 MOVE DP015-REVERSE          TO AOPRUNTH          03950774
039508                 MOVE -1                     TO AOPRUNTL          03950874
039509                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              03950974
039510                 MOVE SPACES                 TO AOPRNMEO          03951074
039511             ELSE                                                 03951174
039512                 IF ASC-OPER-UNT-ID > SPACES AND                  03951274
039513                    ASC-DOOR-ID = SPACES                          03951374
039514                     SET PS-ERROR                                 03951474
039515                         DP020-MSG-FATAL         TO TRUE          03951574
039516                     MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER  03951674
039517                     MOVE DP015-UNP-ALP-BRT-OFF  TO ADOORIDA      03951774
039518                     MOVE DP015-RED              TO ADOORIDC      03951874
039519                     MOVE DP015-REVERSE          TO ADOORIDH      03951974
039521                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          03952174
039522                     MOVE -1                     TO ADOORIDL      03952274
039523                     MOVE +1                     TO AOPRUNTL      03952374
039524                 ELSE                                             03952474
039525                     PERFORM 3040-CHECK-4-ROW-ON-CNDCDR           03952574
039526                     IF PS-NO-ERROR                               03952674
039527                         PERFORM 3050-CHECK-4-SH-OR-DS-DOOR       03952774
039530                         IF PS-NO-ERROR                           03953074
039600                             PERFORM 2110-PREPARE-INTER-APPL-COMM 03960074
039610                         ELSE                                     03961074
039611                             PERFORM 3060-RETRIEVE-DOOR-TYPE      03961174
039613                         END-IF                                   03961374
039620                     END-IF                                       03962074
039621                 END-IF                                           03962174
039640             END-IF                                               03964074
039650             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03965074
039700     END-EVALUATE.                                                03970074
039800                                                                  03980074
040000******************************************************************04000074
040100** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **04010074
040200** INTER-APPLICATION COMMAREA.                                  **04020074
040300******************************************************************04030074
040400 2110-PREPARE-INTER-APPL-COMM.                                    04040074
040500                                                                  04050074
040600     INITIALIZE CN011-INTER-APPL-COMMAREA.                        04060074
040700                                                                  04070074
040800     MOVE ASC-FUNCTION             TO CN011-FUNCTION.             04080074
040810     MOVE ASC-CURR-OPER-UNT-ID     TO CN011-CURR-OPER-UNT-ID.     04081074
040900     MOVE ASC-CURR-FCLTY-ID        TO CN011-CURR-FCLTY-ID.        04090074
041000     MOVE ASC-CURR-FCLTY-NME       TO CN011-CURR-FCLTY-NME.       04100074
041010     MOVE ASC-OPER-UNT-ID          TO CN011-OPER-UNT-ID.          04101074
041020     MOVE ASC-FCLTY-ID             TO CN011-FCLTY-ID.             04102074
041030     MOVE ASC-FCLTY-NME            TO CN011-FCLTY-NME.            04103074
041100     MOVE ASC-DOOR-ID              TO CN011-DOOR-ID.              04110076
041200     MOVE ASC-DOOR-TYPE-CDE        TO CN011-DOOR-TYPE-CDE.        04120074
041210     MOVE ASC-DOOR-TYPE-DESC       TO CN011-DOOR-TYPE-DESC.       04121074
041220     MOVE ASC-LOC-DESC             TO CN011-LOC-DESC.             04122074
041300     MOVE ASC-DIVERT-CODE          TO CN011-DIVERT-CODE.          04130074
041310     MOVE ASC-DIVERT-LOC           TO CN011-DIVERT-LOC-ID.        04131078
041400     MOVE ASC-LABEL-SEQ            TO CN011-LABEL-SEQ.            04140074
041500                                                                  04150074
041600*----------------------------------------------------------------*04160074
041700* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*04170074
041800* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *04180074
041900* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *04190074
042000*----------------------------------------------------------------*04200074
042100 2200-MOVE-SCREEN-TO-COMMAREA.                                    04210074
042200*OPER UNT ID                                                      04220074
042300     IF  AOPRUNTL > ZERO                                          04230074
042400         MOVE AOPRUNTI      TO ASC-OPER-UNT-ID                    04240074
042500     ELSE                                                         04250074
042600         IF AOPRUNTF = DP015-ERASE-EOF                            04260074
042700            MOVE SPACES      TO ASC-OPER-UNT-ID                   04270074
042900         END-IF                                                   04290074
043000     END-IF.                                                      04300074
043100*                                                                 04310074
044200*DOOR ID                                                          04420074
044300     IF  ADOORIDL > ZERO                                          04430074
044400         MOVE ADOORIDI              TO ASC-DOOR-ID                04440074
044700     ELSE                                                         04470074
044800         IF ADOORIDF = DP015-ERASE-EOF                            04480074
044900            MOVE SPACES            TO ASC-DOOR-ID                 04490074
045100         END-IF                                                   04510074
045200     END-IF.                                                      04520074
045300*                                                                 04530074
045400*DOOR TYPE CODE                                                   04540074
045500     IF  ADRTYPCL > ZERO                                          04550074
045600         MOVE ADRTYPCI             TO ASC-DOOR-TYPE-CDE           04560074
045700     ELSE                                                         04570074
045800         IF ADRTYPCF = DP015-ERASE-EOF                            04580074
045900            MOVE SPACES            TO ASC-DOOR-TYPE-CDE           04590074
046000         END-IF                                                   04600074
046100     END-IF.                                                      04610074
046300                                                                  04630074
046400******************************************************************04640074
046500* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *04650074
046600* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *04660074
046700* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE     *04670074
046800* DONE IN THE DESTINATION PROGRAM, NOT HERE.                     *04680074
046900******************************************************************04690074
047100 3000-EDIT-DATA-IN-COMMAREA.                                      04710074
047200     PERFORM 3200-RESET-ATTRIBUTES.                               04720074
047300                                                                  04730074
047400*EDIT OPER UNIT TO MAKE SURE NUMERIC                              04740074
047500     IF  ASC-OPER-UNT-ID NOT = SPACES                             04750074
047600         MOVE ASC-OPER-UNT-ID    TO DP010I-UNEDITED-FIELD         04760074
047700         MOVE LENGTH OF ASC-OPER-UNT-ID TO DP010I-MAXIMUM-DIGITS  04770074
047900         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       04790074
048000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04800074
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04821093
263455              USING DP010I-NUMERIC-EDIT-AREA                      04822093
048300         IF  DP010I-ERROR-DETECTED                                04830074
048400             SET PS-ERROR                                         04840074
048500                 DP020-MSG-FATAL         TO TRUE                  04850074
048600             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      04860074
048800             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA              04880074
049000             MOVE DP015-RED              TO AOPRUNTC              04900074
049100             MOVE DP015-REVERSE          TO AOPRUNTH              04910074
049200             MOVE -1                     TO AOPRUNTL              04920074
049300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04930074
049310             MOVE SPACES                 TO AOPRNMEO              04931074
049400         ELSE                                                     04940074
049600             MOVE DP010I-NUMERIC-FIELD TO ASC-OPER-UNT-ID-N       04960074
049900             MOVE ASC-OPER-UNT-ID      TO AOPRUNTO                04990074
050100*VALIDATE OPER UNIT                                               05010074
050200             PERFORM 3010-VALIDATE-OPER-UNT-ID                    05020074
051500             IF PS-ERROR                                          05150074
051501                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             05150174
051510             END-IF                                               05151074
051520         END-IF                                                   05152074
052500     END-IF.                                                      05250074
052600                                                                  05260074
055100*VALIDATE DOOR TYPE CODE                                          05510074
055110     IF  ASC-DOOR-TYPE-CDE NOT = SPACES                           05511074
055200        PERFORM 3020-VALIDATE-DOOR-TYPE-CODE                      05520079
055210     END-IF.                                                      05521074
055300                                                                  05530074
074746                                                                  07474687
074747****************************************************************  07474787
074748*    VERIFY OPER UNIT ID.                                      *  07474888
074749*                                                              *  07474987
074750****************************************************************  07475087
074751                                                                  07475187
074752 3010-VALIDATE-OPER-UNT-ID.                                       07475287
074754                                                                  07475487
074755     INITIALIZE XL071-COMMAREA.                                   07475587
074756     MOVE ASC-OPER-UNT-ID TO XL071-LOCATION-NUMBER.               07475687
074757                                                                  07475787
074758     CALL XL071-LOCATION-MODULE USING                             07475887
074759                                DFHEIBLK                          07475987
074760                                XL071-COMMAREA                    07476087
074761                                XL071-COMMAREA-REC.               07476187
074762                                                                  07476287
074763     EVALUATE TRUE                                                07476387
074764         WHEN XL071-NO-ERRORS                                     07476487
074766         WHEN XL071-DC-ASGMT-NOT-FND                              07476687
074768              MOVE XL071-LOC-NM TO ASC-FCLTY-NME                  07476887
074769              IF XL071-LOC-TYP-CDE = PC-DC                        07476987
074770                 CONTINUE                                         07477087
074771              ELSE                                                07477187
074772                 SET PS-ERROR                                     07477287
074773                     DP020-MSG-FATAL         TO TRUE              07477387
074774                 MOVE PC-TSYMSG-02572        TO DP020-MSG-NUMBER  07477487
074775                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA          07477587
074776                 MOVE DP015-RED              TO AOPRUNTC          07477687
074777                 MOVE DP015-REVERSE          TO AOPRUNTH          07477787
074778                 MOVE -1                     TO AOPRUNTL          07477887
074779                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07477987
074780                 MOVE SPACES                 TO AOPRNMEO          07478087
074781              END-IF                                              07478187
074782                                                                  07478287
074783         WHEN XL071-LOC-NOT-FOUND                                 07478387
074784              MOVE 'NAME NOT FOUND'   TO ASC-FCLTY-NME            07478487
074785              SET PS-ERROR                                        07478587
074786                  DP020-MSG-FATAL         TO TRUE                 07478687
074787              MOVE PC-TSYMSG-02572        TO DP020-MSG-NUMBER     07478787
074788              MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA             07478887
074789              MOVE DP015-RED              TO AOPRUNTC             07478987
074790              MOVE DP015-REVERSE          TO AOPRUNTH             07479087
074791              MOVE -1                     TO AOPRUNTL             07479187
074792              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 07479287
074793              MOVE SPACES                 TO AOPRNMEO             07479387
074795                                                                  07479587
074796         WHEN OTHER                                               07479687
074797              MOVE '3010-VALIDATE-OPER-UNT-ID'                    07479787
074799                                  TO DP013-PARAGRAPH              07479987
074803              STRING 'SELECT STORE NUMBER - '                     07480392
074804                      XL071-LOCATION-NUMBER                       07480492
074805                     ' - BAD RETURN CODE FROM XLKUT071 - '        07480592
074806                      XL071-RETURN-CODE                           07480692
074807                      DELIMITED BY SIZE                           07480792
074808                      INTO DP013-MESSAGE-TEXT (1)                 07480892
074809              STRING 'SQLCODE - '                                 07480992
074810                      XL071-SQLCODE                               07481092
074811                     ' - '                                        07481192
074812                      XL071-DB2-TABLE                             07481292
074813                      DELIMITED BY SIZE                           07481392
074814                      INTO DP013-MESSAGE-TEXT (2)                 07481492
074815              MOVE XL071-SQLCA     TO DP013-SQLCA                 07481592
074816              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    07481692
074827              MOVE XL071-SQLCODE TO SQLCODE                       07482787
074830              SET DP013-DB2-ABEND                                 07483087
074831                  DP013-XCTL-DISPLAY-RESTART TO TRUE              07483187
074832              PERFORM DP013-0000-PROCESS-ABEND                    07483287
074833                                                                  07483387
074834     END-EVALUATE.                                                07483487
074835                                                                  07483587
074836                                                                  07483687
074837******************************************************************07483787
074838** VERIFY DOOR TYPE CODE                                        **07483887
074839******************************************************************07483987
074840 3020-VALIDATE-DOOR-TYPE-CODE.                                    07484087
074841      MOVE ASC-DOOR-TYPE-CDE TO DK-DOOR-TYPE-CDE.                 07484187
074842                                                                  07484287
074843        EXEC SQL                                                  07484387
074844          SELECT  DOOR_TYP_CDE_DESC                               07484487
074845            INTO :CNDRTY-DOOR-TYP-CDE-DESC                        07484587
074846            FROM  TCNDRTY                                         07484687
074847           WHERE  DOOR_TYP_CDE   = :DK-DOOR-TYPE-CDE              07484787
074848             AND  DIVERT_TYP_CDE = :PC-D                          07484887
074849        END-EXEC                                                  07484987
074850                                                                  07485087
074851        EVALUATE TRUE                                             07485187
074852            WHEN SQLCODE = +0                                     07485287
074853              MOVE CNDRTY-DOOR-TYP-CDE-DESC TO ASC-DOOR-TYPE-DESC 07485387
074854            WHEN SQLCODE = +100                                   07485487
074855                SET PS-ERROR                                      07485587
074856                    DP020-MSG-FATAL         TO TRUE               07485687
074857                MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER   07485787
074858                MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA           07485887
074859                MOVE DP015-RED              TO ADRTYPCC           07485987
074860                MOVE DP015-REVERSE          TO ADRTYPCH           07486087
074861                MOVE -1                     TO ADRTYPCL           07486187
074862                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07486287
074863                MOVE SPACES                 TO ADRTYDSO           07486387
074864            WHEN SQLWARN0 NOT = SPACES                            07486487
074865            WHEN SQLCODE < +0                                     07486587
074866            WHEN SQLCODE > +0                                     07486687
074867                MOVE '3020-VALIDATE-DOOR-TYPE-CODE'               07486787
074868                                          TO DP013-PARAGRAPH      07486887
074869                MOVE 'COULDNT VALIDATE DOOR TYPE CODE'            07486987
074870                                    TO DP013-MESSAGE-TEXT (1)     07487087
074871                MOVE SQLCA      TO DP013-SQLCA                    07487187
074872                MOVE 'TCNDRTY'  TO DP013-DB2-TABLE-NAME (1)       07487287
074873                SET DP013-DB2-ABEND                               07487387
074874                    DP013-XCTL-DISPLAY-RESTART TO TRUE            07487487
074875                PERFORM DP013-0000-PROCESS-ABEND                  07487587
074876        END-EVALUATE.                                             07487687
074877                                                                  07487787
074878******************************************************************07487887
074879** CHECK FOR ROW ON CNDCDR - IF NO ROW  - GOTO CNKCS225           07487987
074880******************************************************************07488087
074881 3030-CHECK-4-ROW-ON-CNDCDR.                                      07488187
074882      MOVE ASC-OPER-UNT-ID   TO DK-OPER-UNT-ID.                   07488287
074883      MOVE ASC-DOOR-ID       TO DK-DOOR-ID.                       07488387
074884                                                                  07488487
074885        EXEC SQL                                                  07488587
074886          SELECT  A.DOOR_TYP_CDE                                  07488687
074887                 ,A.DOOR_LOC_DESC                                 07488787
074888                 ,A.DIVERT_NBR                                    07488887
074889                 ,A.DOOR_LBL_SEQ_NBR                              07488987
074890            INTO :CNDCDR-DOOR-TYP-CDE                             07489087
074891                ,:CNDCDR-DOOR-LOC-DESC                            07489187
074892                ,:CNDCDR-DIVERT-NBR                               07489287
074893                ,:CNDCDR-DOOR-LBL-SEQ-NBR                         07489387
074894            FROM  TCNDCDR A                                       07489487
074895               ,  TCNDRTY B                                       07489587
074896           WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID              07489687
074897             AND  A.DOOR_ID        = :DK-DOOR-ID                  07489787
074898             AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE               07489887
074899             AND  B.DIVERT_TYP_CDE = :PC-D                        07489987
074900        END-EXEC                                                  07490087
074901                                                                  07490187
074902        EVALUATE TRUE                                             07490287
074903            WHEN SQLCODE = +0                                     07490387
074904                SET PS-ERROR                                      07490487
074905                    DP020-MSG-FATAL         TO TRUE               07490587
074906                MOVE PC-TSYMSG-02573        TO DP020-MSG-NUMBER   07490687
074907                MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA           07490787
074908                                               ADOORIDA           07490887
074909                MOVE DP015-RED              TO AOPRUNTC           07490987
074910                                               ADOORIDC           07491087
074911                MOVE DP015-REVERSE          TO AOPRUNTH           07491187
074912                                               ADOORIDH           07491287
074913                MOVE -1                     TO AOPRUNTL           07491387
074914                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07491487
074915*--OPER UNT ID MUST EQUAL CURR OPER UNT ID INORDER TO ADD.        07491587
074916            WHEN SQLCODE = +100                                   07491687
074917              IF ASC-CURR-OPER-UNT-ID = ASC-OPER-UNT-ID-N         07491787
074918                MOVE PC-A                    TO ASC-FUNCTION      07491887
074919                MOVE SPACES                  TO ASC-LOC-DESC      07491987
074920                                                ASC-DIVERT-LOC    07492087
074921                MOVE ZEROES                  TO ASC-DIVERT-CODE   07492187
074922                                                ASC-LABEL-SEQ     07492287
074923              ELSE                                                07492387
074924                SET PS-ERROR                                      07492487
074925                    DP020-MSG-FATAL         TO TRUE               07492587
074926                MOVE PC-TSYMSG-02571        TO DP020-MSG-NUMBER   07492687
074927                MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA           07492787
074928                MOVE DP015-RED              TO AOPRUNTC           07492887
074929                MOVE DP015-REVERSE          TO AOPRUNTH           07492987
074930                MOVE -1                     TO AOPRUNTL           07493087
074931                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07493187
074932              END-IF                                              07493287
074933            WHEN SQLWARN0 NOT = SPACES                            07493387
074934            WHEN SQLCODE < +0                                     07493487
074935            WHEN SQLCODE > +0                                     07493587
074936                MOVE '3030-CHECK-4-ROW-ON-CNDCDR'                 07493687
074937                                          TO DP013-PARAGRAPH      07493787
074938                MOVE 'PROBLEM WITH RETRIEVING ROW'                07493887
074939                                    TO DP013-MESSAGE-TEXT (1)     07493987
074940                MOVE SQLCA      TO DP013-SQLCA                    07494087
074941                MOVE 'TCNDCDR'  TO DP013-DB2-TABLE-NAME (1)       07494187
074942                SET DP013-DB2-ABEND                               07494287
074943                    DP013-XCTL-DISPLAY-RESTART TO TRUE            07494387
074944                PERFORM DP013-0000-PROCESS-ABEND                  07494487
074945        END-EVALUATE.                                             07494587
074946                                                                  07494687
074947******************************************************************07494787
074948** CHECK FOR ROW ON CNDCDR - IF A ROW EXISTS  - GOTO CNKCS225     07494887
074949******************************************************************07494987
074950 3040-CHECK-4-ROW-ON-CNDCDR.                                      07495087
074951      MOVE ASC-OPER-UNT-ID   TO DK-OPER-UNT-ID.                   07495187
074952      MOVE ASC-DOOR-ID       TO DK-DOOR-ID.                       07495287
074953                                                                  07495387
074954        EXEC SQL                                                  07495487
074955          SELECT  A.DOOR_TYP_CDE                                  07495587
074956                 ,A.DOOR_LOC_DESC                                 07495687
074957                 ,A.DIVERT_NBR                                    07495787
074958                 ,A.DIVERT_LOC_ID                                 07495887
074959                 ,A.DOOR_LBL_SEQ_NBR                              07495987
074960            INTO :CNDCDR-DOOR-TYP-CDE                             07496087
074961                ,:CNDCDR-DOOR-LOC-DESC                            07496187
074962                ,:CNDCDR-DIVERT-NBR                               07496287
074963                ,:CNDCDR-DIVERT-LOC-ID                            07496387
074964                ,:CNDCDR-DOOR-LBL-SEQ-NBR                         07496487
074965            FROM  TCNDCDR A                                       07496587
074966               ,  TCNDRTY B                                       07496687
074967           WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID              07496787
074968             AND  A.DOOR_ID        = :DK-DOOR-ID                  07496887
074969             AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE               07496987
074970             AND  B.DIVERT_TYP_CDE = :PC-D                        07497087
074971        END-EXEC                                                  07497187
074972                                                                  07497287
074973*--OPER UNT ID MUST EQUAL CURR OPER UNT ID INORDER TO UPDATE.     07497387
074974        EVALUATE TRUE                                             07497487
074975            WHEN SQLCODE = +0                                     07497587
074976              IF ASC-CURR-OPER-UNT-ID = ASC-OPER-UNT-ID-N         07497687
074977                MOVE CNDCDR-DOOR-TYP-CDE     TO ASC-DOOR-TYPE-CDE 07497787
074978                MOVE CNDCDR-DOOR-LOC-DESC    TO ASC-LOC-DESC      07497887
074979                MOVE CNDCDR-DIVERT-NBR       TO ASC-DIVERT-CODE   07497987
074980                MOVE CNDCDR-DIVERT-LOC-ID    TO ASC-DIVERT-LOC    07498087
074981                MOVE CNDCDR-DOOR-LBL-SEQ-NBR TO ASC-LABEL-SEQ     07498187
074982                MOVE PC-U                    TO ASC-FUNCTION      07498287
074983              ELSE                                                07498387
074984                SET PS-ERROR                                      07498487
074985                    DP020-MSG-FATAL         TO TRUE               07498587
074986                MOVE PC-TSYMSG-02571        TO DP020-MSG-NUMBER   07498687
074987                MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA           07498787
074988                MOVE DP015-RED              TO AOPRUNTC           07498887
074989                MOVE DP015-REVERSE          TO AOPRUNTH           07498987
074990                MOVE -1                     TO AOPRUNTL           07499087
074991                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07499187
074992              END-IF                                              07499287
074993            WHEN SQLCODE = +100                                   07499387
074994                MOVE SPACES                 TO ASC-LOC-DESC       07499487
074995                SET PS-ERROR                                      07499587
074996                    DP020-MSG-FATAL         TO TRUE               07499687
074997                MOVE PC-TSYMSG-02574        TO DP020-MSG-NUMBER   07499787
074998                MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA           07499887
074999                                               ADOORIDA           07499987
075000                MOVE DP015-RED              TO AOPRUNTC           07500087
075001                                               ADOORIDC           07500187
075002                MOVE DP015-REVERSE          TO AOPRUNTH           07500287
075003                                               ADOORIDH           07500387
075004                MOVE -1                     TO AOPRUNTL           07500487
075005                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07500587
075006            WHEN SQLWARN0 NOT = SPACES                            07500687
075007            WHEN SQLCODE < +0                                     07500787
075008            WHEN SQLCODE > +0                                     07500887
075009                MOVE '3030-CHECK-4-ROW-ON-CNDCDR'                 07500987
075010                                          TO DP013-PARAGRAPH      07501087
075011                MOVE 'PROBLEM WITH RETRIEVING ROW'                07501187
075012                                    TO DP013-MESSAGE-TEXT (1)     07501287
075013                MOVE SQLCA      TO DP013-SQLCA                    07501387
075014                MOVE 'TCNDCDR'  TO DP013-DB2-TABLE-NAME (1)       07501487
075015                SET DP013-DB2-ABEND                               07501587
075016                    DP013-XCTL-DISPLAY-RESTART TO TRUE            07501687
075017                PERFORM DP013-0000-PROCESS-ABEND                  07501787
075018        END-EVALUATE.                                             07501887
075019                                                                  07501987
075020******************************************************************07502087
075021*  DOOR TYPE MUST EQUAL SH (SHIPPING) OR DS (DC SHUTTLE) -        07502187
075022*         ST (STORAGE)                                            07502287
075023*         THEN GOTO CNKCS228                                      07502387
075024******************************************************************07502487
075025 3050-CHECK-4-SH-OR-DS-DOOR.                                      07502587
075026     IF ASC-DOOR-TYPE-CDE = 'SH' OR 'DS' OR 'ST'                  07502687
075027          MOVE CNDCDR-DOOR-LOC-DESC    TO ASC-LOC-DESC            07502787
075028          MOVE CNDCDR-DIVERT-NBR       TO ASC-DIVERT-CODE         07502887
075029          MOVE CNDCDR-DIVERT-LOC-ID    TO ASC-DIVERT-LOC          07502987
075030          MOVE CNDCDR-DOOR-LBL-SEQ-NBR TO ASC-LABEL-SEQ           07503087
075031     ELSE                                                         07503187
075032          SET PS-ERROR                                            07503287
075033              DP020-MSG-FATAL         TO TRUE                     07503387
075034          MOVE PC-TSYMSG-02575        TO DP020-MSG-NUMBER         07503487
075035          MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA                 07503587
075036          MOVE DP015-RED              TO ADRTYPCC                 07503687
075037          MOVE DP015-REVERSE          TO ADRTYPCH                 07503787
075038          MOVE -1                     TO ADRTYPCL                 07503887
075039          SET DP030-SET-CURSOR-APPL-1 TO TRUE                     07503987
075040     END-IF.                                                      07504084
075041                                                                  07504174
075042******************************************************************07504274
075043** RETRIEVE DOOR TYPE CODE                                        07504374
075044******************************************************************07504474
075045 3060-RETRIEVE-DOOR-TYPE.                                         07504574
075046      MOVE ASC-OPER-UNT-ID-N TO DK-OPER-UNT-ID.                   07504674
075047      MOVE ASC-DOOR-ID       TO DK-DOOR-ID.                       07504776
075048                                                                  07504874
075049        EXEC SQL                                                  07504974
075050          SELECT  A.DOOR_TYP_CDE                                  07505080
075051            INTO :CNDCDR-DOOR-TYP-CDE                             07505174
075052            FROM  TCNDCDR A                                       07505280
075053               ,  TCNDRTY B                                       07505380
075054           WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID              07505480
075055             AND  A.DOOR_ID        = :DK-DOOR-ID                  07505580
075056             AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE               07505680
075057             AND  B.DIVERT_TYP_CDE = :PC-D                        07505781
075058        END-EXEC                                                  07505874
075059                                                                  07505974
075060        EVALUATE TRUE                                             07506074
075061            WHEN SQLCODE = +0                                     07506174
075062                MOVE CNDCDR-DOOR-TYP-CDE     TO ASC-DOOR-TYPE-CDE 07506274
075063                PERFORM 3070-RETRIEVE-DOOR-TYPE-DESC              07506374
075064            WHEN SQLCODE = +100                                   07506474
075065                IF  ADRTYPCL > ZERO                               07506574
075066                    PERFORM 3070-RETRIEVE-DOOR-TYPE-DESC          07506674
075067                ELSE                                              07506774
075068                    MOVE SPACES           TO  ASC-DOOR-TYPE-CDE   07506874
075069                    MOVE SPACES           TO  ASC-DOOR-TYPE-DESC  07506974
075070                END-IF                                            07507074
075071            WHEN SQLWARN0 NOT = SPACES                            07507174
075072            WHEN SQLCODE < +0                                     07507274
075073            WHEN SQLCODE > +0                                     07507374
075074                MOVE '3060-RETRIEVE-DOOR-TYPE'                    07507474
075075                                          TO DP013-PARAGRAPH      07507574
075076                MOVE 'PROBLEM WITH RETRIEVING DOOR TYPE'          07507674
075077                                    TO DP013-MESSAGE-TEXT (1)     07507774
075078                MOVE SQLCA      TO DP013-SQLCA                    07507874
075079                MOVE 'TCNDCDR'  TO DP013-DB2-TABLE-NAME (1)       07507974
075080                SET DP013-DB2-ABEND                               07508074
075081                    DP013-XCTL-DISPLAY-RESTART TO TRUE            07508174
075082                PERFORM DP013-0000-PROCESS-ABEND                  07508274
075083        END-EVALUATE.                                             07508374
075084                                                                  07508474
075085******************************************************************07508574
075086** RETRIEVE DOOR TYPE CODE DESCRIPTION                            07508674
075087******************************************************************07508774
075088 3070-RETRIEVE-DOOR-TYPE-DESC.                                    07508874
075089      MOVE ASC-DOOR-TYPE-CDE TO DK-DOOR-TYPE-CDE.                 07508974
075090                                                                  07509074
075091        EXEC SQL                                                  07509174
075092          SELECT  DOOR_TYP_CDE_DESC                               07509274
075093            INTO :CNDRTY-DOOR-TYP-CDE-DESC                        07509374
075094            FROM  TCNDRTY                                         07509474
075095           WHERE  DOOR_TYP_CDE   = :DK-DOOR-TYPE-CDE              07509578
075096             AND  DIVERT_TYP_CDE = :PC-D                          07509678
075097        END-EXEC                                                  07509774
075098                                                                  07509874
075099        EVALUATE TRUE                                             07509974
075100            WHEN SQLCODE = +0                                     07510074
075101                MOVE CNDRTY-DOOR-TYP-CDE-DESC TO                  07510174
075102                                               ASC-DOOR-TYPE-DESC 07510274
075103            WHEN SQLCODE = +100                                   07510374
075104                MOVE 'NO DOOR DESCRIPTION FOUND' TO               07510474
075105                                               ASC-DOOR-TYPE-DESC 07510574
075106            WHEN SQLWARN0 NOT = SPACES                            07510674
075107            WHEN SQLCODE < +0                                     07510774
075108            WHEN SQLCODE > +0                                     07510874
075109                MOVE '3070-RETRIEVE-DOOR-TYPE-DESC'               07510974
075110                                          TO DP013-PARAGRAPH      07511074
075111                MOVE 'PROBLEM WITH RETRIEVING DOOR DESC'          07511174
075112                                    TO DP013-MESSAGE-TEXT (1)     07511274
075113                MOVE SQLCA      TO DP013-SQLCA                    07511374
075114                MOVE 'TCNDRTY'  TO DP013-DB2-TABLE-NAME (1)       07511474
075115                SET DP013-DB2-ABEND                               07511574
075116                    DP013-XCTL-DISPLAY-RESTART TO TRUE            07511674
075117                PERFORM DP013-0000-PROCESS-ABEND                  07511774
075118        END-EVALUATE.                                             07511874
075119                                                                  07511974
075120******************************************************************07512074
075121** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **07512174
075122** MAP.                                                         **07512274
075130******************************************************************07513074
075200 3200-RESET-ATTRIBUTES.                                           07520074
075201     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       07520184
075202                                                                  07520284
075203     IF DP020-LOCATION-TYPE = 'DC'                                07520384
075204                                                                  07520484
075205         MOVE DP015-ASK-NOR-OFF    TO AOPRUNTA                    07520584
075206         MOVE DP015-UNP-ALP-NOR-OFF TO ADOORIDA                   07520684
075207                                       ADRTYPCA                   07520784
075208         MOVE DP015-BLUE           TO AOPRUNTC                    07520884
075209         MOVE DP015-GREEN          TO ADOORIDC                    07520984
075210                                      ADRTYPCC                    07521084
075211         MOVE DP015-UNDERLINE      TO ADOORIDH                    07521184
075212                                      ADRTYPCH                    07521284
075213         MOVE -1                   TO ADOORIDL                    07521384
075214     ELSE                                                         07521484
075215         MOVE DP015-UNP-ALP-NOR-OFF TO AOPRUNTA                   07521584
075216                                       ADOORIDA                   07521684
075217                                       ADRTYPCA                   07521784
075218         MOVE DP015-GREEN          TO AOPRUNTC                    07521884
075219                                      ADOORIDC                    07521984
075220                                      ADRTYPCC                    07522084
075221         MOVE DP015-UNDERLINE      TO AOPRUNTH                    07522184
075222                                      ADOORIDH                    07522284
075223                                      ADRTYPCH                    07522384
075224         MOVE -1                   TO AOPRUNTL                    07522484
075225     END-IF                                                       07522584
076830                                                                  07683074
076840     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       07684084
076900*----------------------------------------------------------------*07690074
077000*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *07700074
077100*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *07710074
077200*  IT HERE.                                                      *07720074
077300*----------------------------------------------------------------*07730074
077400 4000-BUILD-INITIAL-PANEL.                                        07740074
077401                                                                  07740191
077402     PERFORM 4100-GET-STORE-INFORMATION.                          07740290
077403                                                                  07740390
077520                                                                  07752074
077521     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        07752184
077522                                                                  07752284
077523     IF DP020-LOCATION-TYPE = 'DC'                                07752384
077524         MOVE ASC-CURR-OPER-UNT-ID TO AOPRUNTO                    07752484
077526                                      ASC-OPER-UNT-ID             07752682
077527         MOVE ASC-CURR-FCLTY-NME   TO AOPRNMEO                    07752782
077610     END-IF                                                       07761082
077700                                                                  07770074
078100     MOVE ASC-CURR-OPER-UNT-ID     TO ACPRUNTO.                   07810074
078101     MOVE ASC-CURR-FCLTY-NME       TO ACPRNMEO.                   07810174
078102                                                                  07810290
078103****************************************************************  07810390
078104*    GET STORE INFORMATION.                                    *  07810490
078105*                                                              *  07810590
078106****************************************************************  07810690
078107                                                                  07810790
078108 4100-GET-STORE-INFORMATION.                                      07810890
078109                                                                  07810990
078110     INITIALIZE XL071-COMMAREA.                                   07811090
078121     MOVE ASC-CURR-OPER-UNT-ID TO XL071-LOCATION-NUMBER.          07812190
078130                                                                  07813090
078140     CALL XL071-LOCATION-MODULE USING                             07814090
078150                                DFHEIBLK                          07815090
078160                                XL071-COMMAREA                    07816090
078170                                XL071-COMMAREA-REC.               07817090
078180                                                                  07818090
078190     EVALUATE TRUE                                                07819090
078200         WHEN XL071-NO-ERRORS                                     07820090
078300         WHEN XL071-DC-ASGMT-NOT-FND                              07830090
078400              MOVE XL071-LOC-NM TO ASC-CURR-FCLTY-NME             07840090
078594                                                                  07859490
078595         WHEN XL071-LOC-NOT-FOUND                                 07859590
078596              MOVE 'STORE NAME NOT FOUND' TO ASC-CURR-FCLTY-NME   07859690
078607                                                                  07860790
078608         WHEN OTHER                                               07860890
078610              MOVE '4000-BUILD-INITIAL-PANEL'                     07861090
078611                                  TO DP013-PARAGRAPH              07861190
078612              STRING 'SELECT STORE NUMBER - '                     07861292
078613                      XL071-LOCATION-NUMBER                       07861392
078614                     ' - BAD RETURN CODE FROM XLKUT071 - '        07861492
078615                      XL071-RETURN-CODE                           07861592
078616                      DELIMITED BY SIZE                           07861692
078617                      INTO DP013-MESSAGE-TEXT (1)                 07861792
078618              STRING 'SQLCODE - '                                 07861892
078619                      XL071-SQLCODE                               07861992
078620                     ' - '                                        07862092
078621                      XL071-DB2-TABLE                             07862192
078622                      DELIMITED BY SIZE                           07862292
078623                      INTO DP013-MESSAGE-TEXT (2)                 07862392
078624              MOVE XL071-SQLCA     TO DP013-SQLCA                 07862492
078625              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    07862592
078636              MOVE XL071-SQLCODE TO SQLCODE                       07863690
078639              SET DP013-DB2-ABEND                                 07863990
078640                  DP013-XCTL-DISPLAY-RESTART TO TRUE              07864090
078641              PERFORM DP013-0000-PROCESS-ABEND                    07864190
078642                                                                  07864290
078643     END-EVALUATE.                                                07864390
078650                                                                  07865074
078700*----------------------------------------------------------------*07870074
078800*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *07880074
078900*----------------------------------------------------------------*07890074
079000 4400-MOVE-COMMAREA-TO-SCREEN.                                    07900074
079010     MOVE ASC-CURR-OPER-UNT-ID     TO ACPRUNTO.                   07901074
079011     MOVE ASC-CURR-FCLTY-NME       TO ACPRNMEO.                   07901174
079012     MOVE ASC-OPER-UNT-ID          TO AOPRUNTO.                   07901274
079013     MOVE ASC-FCLTY-NME            TO AOPRNMEO.                   07901374
079020     MOVE ASC-DOOR-ID              TO ADOORIDO.                   07902074
079030     MOVE ASC-DOOR-TYPE-CDE        TO ADRTYPCO.                   07903074
079300     MOVE ASC-DOOR-TYPE-DESC       TO ADRTYDSO.                   07930074
079800                                                                  07980074
082000*----------------------------------------------------------------*08200074
082100*    ABEND PROCESSOR MODULE                                      *08210074
082200*----------------------------------------------------------------*08220074
082300                                                                  08230074
082400     COPY DPPD013.                                                08240074
