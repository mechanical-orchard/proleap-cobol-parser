000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKRP365.                                        00020000
000300 AUTHOR.         NANCY EILBES.                                    00030000
000400 DATE-WRITTEN.   04/29/2013.                                      00040000
000500 DATE-COMPILED.                                                   00050000
000600*----------------------------------------------------------------*00060000
000700*    COBOL 2 WITH SQL                                            *00070000
000800*    REPORT UNUSED NON-INVOICED RECEIPTS                         *00080000
000900*                                                                *00090000
001000*    THIS PROGRAM REPORTS ALL ENTRIES ON THE NON-INVOICED        *00100000
001100*    RECEIPTS TABLE THAT ARE UNMATCHED AS OF THE RUN DATE        *00110014
001200*    AND TIME.  DOLLARS ARE SUMMED BY VENDOR/DEPT/PO/CREATE      *00120000
001210*    DATE.                                                       *00121000
001300*                                                                *00130000
001300*    THE DATA IS RETRIEVED IN PROGRAM APKUT442, THEN SORTED SO   *00131015
001300*    THAT THE SEPHORA VENDORS ARE AT THE END OF THE REPORT.      *00132015
001300*                                                                *00133015
001400* INPUT:                                                         *00140000
001500*  1. UNUSED NON-INVOICED RECEIPTS DATA FILE                     *00150015
001800*                                                                *00180000
001900* OUTPUT:                                                        *00190000
002000*  1. UNUSED NON-INVOICED RECEIPTS REPORT                        *00200000
002100*                                                                *00210000
002300*----------------------------------------------------------------*00230000
002400*                                                                *00240000
002500* CHANGE LOG:                                                    *00250000
002600* DATE  05/09/2013                                               *00260000
002610*     CHANGE MADE: INITIAL VERSION.                              *00261000
002620*     MADE BY: NANCY EILBES            WR/IR #: CHG0053235       *00262000
002630*                                                                *00263000
002600* DATE  08/26/2021                                               *00264015
002610*     CHANGE MADE: SPLIT PGM INTO 2 PIECES - THIS ONE WILL       *00265015
002610*                  NOW JUST PRINT THE REPORT AFTER SORTING       *00265115
002620*     MADE BY: JEAN KURK               WR/IR #: CHG0260549       *00266015
002630*                                                                *00267015
002700*----------------------------------------------------------------*00270000
002800   EJECT                                                          00280000
002900 ENVIRONMENT DIVISION.                                            00290000
003000 CONFIGURATION SECTION.                                           00300000
003100 SOURCE-COMPUTER.    IBM-3090.                                    00310000
003200 OBJECT-COMPUTER.    IBM-3090.                                    00320000
003300                                                                  00330000
003400 INPUT-OUTPUT SECTION.                                            00340000
003500 FILE-CONTROL.                                                    00350000
003600     SELECT UNUSED-NIR-DATA-FILE ASSIGN TO UT-S-INP01.            00360017
003600     SELECT UNUSED-NIR-RPT-FILE  ASSIGN TO UT-S-RPT01.            00361017
003700 EJECT                                                            00370000
003800 DATA DIVISION.                                                   00380000
003900 FILE SECTION.                                                    00390000
004000                                                                  00400000
004100 FD  UNUSED-NIR-DATA-FILE                                         00410017
004200     RECORDING MODE IS F                                          00420000
004400     BLOCK CONTAINS 0 RECORDS                                     00440000
004300     LABEL RECORDS ARE STANDARD                                   00441015
004500     DATA RECORD IS UNUSED-NIR-DATA-REC.                          00450015
004600 01  UNUSED-NIR-DATA-REC              PIC X(100).                 00460015
004800                                                                  00480000
004100 FD  UNUSED-NIR-RPT-FILE                                          00481015
004200     RECORDING MODE IS F                                          00482015
004300     LABEL RECORDS ARE STANDARD                                   00483015
004400     BLOCK CONTAINS 0 RECORDS                                     00484015
004500     DATA RECORD IS UNUSED-NIR-RPT-REC.                           00485015
004600 01  UNUSED-NIR-RPT-REC.                                          00486015
004700     05  FILLER                       PIC  X(132).                00487015
004800                                                                  00488015
004900 EJECT                                                            00490000
005000 WORKING-STORAGE SECTION.                                         00500000
005100                                                                  00510000
005200 01  PV-PROGRAM-VARIABLES.                                        00520000
005300     05  FILLER                  PIC  X(30)  VALUE                00530000
005400         '** BEGINING OF APKRP365 W/S **'.                        00540000
005500     05  PV-CURRENT-PARAGRAPH    PIC  X(35).                      00550000
005600     05  PV-PROGRAM-NAME         PIC  X(08)  VALUE 'APKRP365'.    00560000
005610     05  HOLD-DUN-NBR            PIC  X(09)  VALUE SPACES.        00561000
005612     05  PV-DB2-DATE             PIC  X(10)  VALUE SPACES.        00561200
005630     05  VND-GROSS-COST          PIC S9(11)V999  COMP-3 VALUE 0.  00563000
005640     05  RPT-GROSS-COST          PIC S9(11)V999  COMP-3 VALUE 0.  00564000
005700     05  PV-CURRENT-DATE.                                         00570000
005800         10  PV-CURRENT-YEAR     PIC  9(02)  VALUE ZEROS.         00580000
005900         10  PV-CURRENT-MONTH    PIC  9(02)  VALUE ZEROS.         00590000
006000         10  PV-CURRENT-DAY      PIC  9(02)  VALUE ZEROS.         00600000
006100     05  PV-CURRENT-TIME.                                         00610000
006200         10  PV-CURRENT-HOUR     PIC  9(02)  VALUE ZEROS.         00620000
006300         10  PV-CURRENT-MINUTE   PIC  9(02)  VALUE ZEROS.         00630000
006400         10  FILLER              PIC  9(02)  VALUE ZEROS.         00640000
006500                                                                  00650000
006600                                                                  00660000
006700 01  PS-PROGRAM-SWITCHES.                                         00670000
008800     05  PS-INPUT-EOF-SW             PIC X  VALUE 'N'.            00702015
008900         88  INPUT-EOF-NO                   VALUE 'N'.            00703015
009000         88  INPUT-EOF-YES                  VALUE 'Y'.            00704015
007100                                                                  00710000
007200                                                                  00720000
007300 01  PC-PROGRAM-COUNTERS.                                         00730000
007800     05  PC-MAX-LINES            PIC S9(03)  VALUE +60            00780000
007900                                             COMP-3.              00790000
008000     05  PC-LINE-COUNT           PIC S9(03)  VALUE +99            00800000
008100                                             COMP-3.              00810000
008200     05  PC-PAGE-COUNT           PIC S9(05)  VALUE ZEROS          00820000
008300                                             COMP-3.              00830000
008000     05  PC-INPUT-REC-CNT        PIC S9(09)  VALUE ZERO           00851015
008100                                             COMP-3.              00852015
008600 EJECT                                                            00860000
008700*----------------------------------------------------------------*00870000
008800*  STANDARD HEADER LAYOUT                                        *00880000
008900*----------------------------------------------------------------*00890000
009000     COPY DPWS132O.                                               00900000
009100                                                                  00910000
009200                                                                  00920000
009300 01  H2-HEADER2.                                                  00930000
009400     05  FILLER                  PIC  X(44) VALUE SPACES.         00940000
009500     05  FILLER                  PIC  X(35) VALUE                 00950000
009600         'NON-INVOICED RECEIPTS UNUSED AS OF '.                   00960000
009610     05  H2-DATE                 PIC  X(10) VALUE SPACES.         00961000
009620     05  FILLER                  PIC  X(43) VALUE SPACES.         00962000
009700                                                                  00970000
009800 01  DH-DETAIL-HEADER1.                                           00980000
009900     05  FILLER                  PIC X(01)  VALUE SPACES.         00990000
010000     05  FILLER                  PIC X(03)  VALUE 'ENT'.          01000000
010300     05  FILLER                  PIC X(128) VALUE SPACES.         01030000
010400                                                                  01040000
010500 01  DH-DETAIL-HEADER2.                                           01050000
010600     05  FILLER                  PIC X(01) VALUE SPACES.          01060000
010700     05  FILLER                  PIC X(04) VALUE 'NAME'.          01070000
010800     05  FILLER                  PIC X(30) VALUE SPACES.          01080000
010900     05  FILLER                  PIC X(03) VALUE 'DUN'.           01090000
011000     05  FILLER                  PIC X(07) VALUE SPACES.          01100000
011100     05  FILLER                  PIC X(04) VALUE 'DEPT'.          01110000
011200     05  FILLER                  PIC X(05) VALUE SPACES.          01120000
011300     05  FILLER                  PIC X(02) VALUE 'PO'.            01130000
011400     05  FILLER                  PIC X(10) VALUE SPACES.          01140000
011500     05  FILLER                  PIC X(04) VALUE 'DATE'.          01150000
011600     05  FILLER                  PIC X(40) VALUE SPACES.          01160000
011610                                                                  01161000
011620 01  DH-DETAIL-HEADER3.                                           01162000
011630     05  FILLER                  PIC X(01) VALUE SPACES.          01163000
011640     05  FILLER                  PIC X(04) VALUE 'DESC'.          01164000
011650     05  FILLER                  PIC X(30) VALUE SPACES.          01165000
011660     05  FILLER                  PIC X(03) VALUE 'NBR'.           01166000
011670     05  FILLER                  PIC X(07) VALUE SPACES.          01167000
011680     05  FILLER                  PIC X(04) VALUE 'NBR '.          01168000
011690     05  FILLER                  PIC X(05) VALUE SPACES.          01169000
011691     05  FILLER                  PIC X(03) VALUE 'NBR'.           01169100
011692     05  FILLER                  PIC X(08) VALUE SPACES.          01169200
011693     05  FILLER                  PIC X(08) VALUE 'RECEIVED'.      01169300
011694     05  FILLER                  PIC X(10) VALUE SPACES.          01169400
011695     05  FILLER                  PIC X(10) VALUE 'GROSS COST'.    01169500
011696     05  FILLER                  PIC X(40) VALUE SPACES.          01169600
011700                                                                  01170000
011800 01  DH-DASH-LINE.                                                01180000
011900     05  FILLER                  PIC X(01) VALUE SPACES.          01190000
012000     05  FILLER                  PIC X(30) VALUE ALL '-'.         01200000
012100     05  FILLER                  PIC X(03) VALUE SPACES.          01210000
012200     05  FILLER                  PIC X(09) VALUE ALL '-'.         01220000
012300     05  FILLER                  PIC X(02) VALUE SPACES.          01230000
012310     05  FILLER                  PIC X(04) VALUE ALL '-'.         01231000
012311     05  FILLER                  PIC X(03) VALUE SPACES.          01231100
012312     05  FILLER                  PIC X(09) VALUE ALL '-'.         01231200
012313     05  FILLER                  PIC X(04) VALUE SPACES.          01231300
012314     05  FILLER                  PIC X(10) VALUE ALL '-'.         01231400
012315     05  FILLER                  PIC X(03) VALUE SPACES.          01231500
012316     05  FILLER                  PIC X(18) VALUE ALL '-'.         01231600
012317     05  FILLER                  PIC X(40) VALUE SPACES.          01231700
012318                                                                  01231800
012320 01  DL-DETAIL-LINE.                                              01232000
012330     05  FILLER                  PIC X(1)      VALUE SPACES.      01233000
012340     05  DL-VENDOR-NAME          PIC X(30)     VALUE SPACES.      01234000
012350     05  FILLER                  PIC X(03)     VALUE SPACES.      01235000
012360     05  DL-DUN-NBR              PIC X(09)     VALUE SPACES.      01236000
012370     05  FILLER                  PIC X(03)     VALUE SPACES.      01237000
012500     05  DL-DEPT-NBR             PIC X(03)     VALUE SPACES.      01250000
012600     05  FILLER                  PIC X(03)     VALUE SPACES.      01260000
012700     05  DL-PO-NBR               PIC Z(09)     VALUE SPACES.      01270000
012800     05  FILLER                  PIC X(04)     VALUE SPACES.      01280000
012900     05  DL-CREATE-DTE           PIC X(10)     VALUE SPACES.      01290000
012910     05  FILLER                  PIC X(05)     VALUE SPACES.      01291000
012920     05  DL-GROSS-COST           PIC Z(09).999 VALUE SPACES.      01292000
013000     05  FILLER                  PIC X(41)     VALUE SPACES.      01300000
013001                                                                  01300100
013010 01  TL-VENDOR-TOTAL-LINE.                                        01301000
013020     05  FILLER                  PIC X(74)     VALUE SPACES.      01302000
013030     05  FILLER                  PIC X(01)     VALUE '*'.         01303000
013040     05  FILLER                  PIC X(05)     VALUE SPACES.      01304000
013050     05  VTL-GROSS-COST          PIC Z(09).999 VALUE SPACES.      01305000
013060     05  FILLER                  PIC X(30)     VALUE SPACES.      01306000
013061                                                                  01306100
013062 01  TL-VENDOR-DASH-LINE.                                         01306200
013063     05  FILLER                  PIC X(78)     VALUE SPACES.      01306300
013066     05  FILLER                  PIC X(18)     VALUE ALL '-'.     01306600
013067     05  FILLER                  PIC X(34)     VALUE SPACES.      01306700
013068                                                                  01306800
013069 01  TL-GRAND-TOTAL-LINE.                                         01306900
013070     05  FILLER                  PIC X(26)     VALUE SPACES.      01307000
013071     05  FILLER                  PIC X(49)     VALUE              01307100
013072         'TOTAL GROSS COST FOR UNUSED NON-INVOICED RECEIPTS'.     01307200
013073     05  FILLER                  PIC X(03)     VALUE SPACES.      01307300
013074     05  GTL-GROSS-COST          PIC Z(09).999 VALUE SPACES.      01307400
013075     05  FILLER                  PIC X(42)     VALUE SPACES.      01307500
013080                                                                  01308000
013100 EJECT                                                            01310000
013200*----------------------------------------------------------------*01320000
013300*  COMMUNICATIONS AREA2 FOR DB2                                  *01330000
013400*----------------------------------------------------------------*01340000
013500     COPY SQLCA2.                                                 01350000
013700                                                                  01370000
013800     EXEC SQL                                                     01380000
013900          INCLUDE SQLCA                                           01390000
014000     END-EXEC.                                                    01400000
014100 EJECT                                                            01410000
018500*----------------------------------------------------------------*01850000
018600*  ABEND DATA AREAS                                              *01860000
018700*----------------------------------------------------------------*01870000
018800 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          01880000
018900                                             COMP SYNC.           01890000
019000     88  AC-BAD-DATA                         VALUE +4003.         01900000
019100     88  AC-DB2-ERROR                        VALUE +4013.         01910000
019200                                                                  01920000
019300                                                                  01930000
019400 01  ABEND-AREAS.                                                 01940000
019500     05  AA-ABEND-LIT            PIC  X(40)  VALUE                01950000
019600             '*****       ABEND'.                                 01960000
019700     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                01970000
019800             '*****   PROGRAM: APKRP365'.                         01980000
019900     05  AA-PARAGRAPH-LIT.                                        01990000
020000         10  FILLER              PIC  X(17)  VALUE                02000000
020100             '***** PARAGRAPH: '.                                 02010000
020200         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        02020000
020300     05  AA-MESSAGE-LINE.                                         02030000
020400         10  FILLER              PIC  X(06)  VALUE '*****'.       02040000
020500         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        02050000
020600     05  AA-DB2-ERROR-LIT        PIC  X(40)  VALUE                02060000
020700             '*****    DB2 ERROR'.                                02070000
020800     05  AA-DB2-OPERATION-LIT.                                    02080000
020900         10  FILLER              PIC  X(17)  VALUE                02090000
021000             '***** OPERATION: '.                                 02100000
021100         10  AA-DB2-OPERATION.                                    02110000
021200             15  AA-DB2-OP-1     PIC  X(25)  VALUE SPACES.        02120000
021300             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.        02130000
021400     05  AA-DB2-TABLE-1          PIC  X(08)  VALUE SPACES.        02140000
021500     05  AA-DB2-TABLE-2          PIC  X(08)  VALUE SPACES.        02150000
021600     05  AA-DB2-TABLE-3          PIC  X(08)  VALUE SPACES.        02160000
021700     05  AA-DB2-TABLE-4          PIC  X(08)  VALUE SPACES.        02170000
021800     05  AA-DB2-TABLE-5          PIC  X(08)  VALUE SPACES.        02180000
021900                                                                  02190000
022000                                                                  02200000
022100     COPY DPWS004.                                                02210000
022000                                                                  02210117
066700*--------------------------------------------------------------*  02211017
066800* COPYBOOK FOR OUTPUT RECORD                                   *  02212017
066900*--------------------------------------------------------------*  02213017
067000     COPY APRD442.                                                02214017
067100                                                                  02215017
022200 01  FILLER                      PIC  X(25)  VALUE                02220000
022300     '** END OF APKRP365 W/S **'.                                 02230000
022400 EJECT                                                            02240000
022500 PROCEDURE DIVISION.                                              02250000
022600 A100-MAIN.                                                       02260000
022700                                                                  02270000
022800     MOVE 'A100-MAIN' TO PV-CURRENT-PARAGRAPH.                    02280000
022900                                                                  02290000
023000     PERFORM B100-INITIALIZE.                                     02300000
023100                                                                  02310000
023200     PERFORM B200-PREPARE-REPORT                                  02320000
023300         UNTIL INPUT-EOF-YES.                                     02330016
023400                                                                  02340000
023500     PERFORM B300-END-PROGRAM.                                    02350000
023600                                                                  02360000
023700     GOBACK.                                                      02370000
023800 EJECT                                                            02380000
023900*----------------------------------------------------------------*02390000
024000*    INITIALIZATION PROCESSING                                   *02400000
024100*    CALLED FROM A100-MAIN                                       *02410000
024200*----------------------------------------------------------------*02420000
024300 B100-INITIALIZE.                                                 02430000
024400                                                                  02440000
024500     MOVE 'B100-INITIALIZE' TO PV-CURRENT-PARAGRAPH.              02450000
024600                                                                  02460000
024700     OPEN INPUT  UNUSED-NIR-DATA-FILE                             02471018
024700          OUTPUT UNUSED-NIR-RPT-FILE.                             02472018
024800                                                                  02480000
025300     ACCEPT PV-CURRENT-DATE FROM DATE.                            02530000
025400     MOVE PV-CURRENT-MONTH            TO DP132O-RUN-MONTH.        02540000
025500     MOVE PV-CURRENT-DAY              TO DP132O-RUN-DAY.          02550000
025600     MOVE PV-CURRENT-YEAR             TO DP132O-RUN-YEAR.         02560000
025700                                                                  02570000
025800     ACCEPT PV-CURRENT-TIME FROM TIME.                            02580000
025900     MOVE PV-CURRENT-HOUR             TO DP132O-RUN-HOUR.         02590000
026000     MOVE PV-CURRENT-MINUTE           TO DP132O-RUN-MINUTE.       02600000
026100     MOVE PV-PROGRAM-NAME             TO DP132O-PROGRAM-NAME.     02610000
026200     MOVE 1                           TO DP132O-REPORT-NUMBER.    02620000
026300                                                                  02630000
026301     EXEC SQL                                                     02630100
026302         SET :PV-DB2-DATE  = CURRENT DATE                         02630200
026303     END-EXEC.                                                    02630300
026304                                                                  02630400
026305     MOVE PV-DB2-DATE TO H2-DATE.                                 02630500
026310     PERFORM W200-PRINT-HEADERS.                                  02631000
026320                                                                  02632000
026500     PERFORM R100-READ-UNUSED-NIR.                                02650015
026510     IF INPUT-EOF-YES                                             02651015
026520         PERFORM W400-WRITE-NO-DATA-MESSAGE                       02652000
026521     ELSE                                                         02652100
026522         MOVE AP442-DUN-NBR       TO HOLD-DUN-NBR                 02652215
026523         MOVE AP442-VENDOR-NAME   TO DL-VENDOR-NAME               02652318
026524         MOVE AP442-DUN-NBR       TO DL-DUN-NBR                   02652415
026530     END-IF.                                                      02653000
026600 EJECT                                                            02660000
026700*----------------------------------------------------------------*02670000
026800*    MOVES DATA FROM THE INPUT RECORDS TO THE REPORT.            *02680015
026900*    CALLED FROM A100-MAIN                                       *02690000
027000*----------------------------------------------------------------*02700000
027100 B200-PREPARE-REPORT.                                             02710000
027200                                                                  02720000
027300     MOVE 'B200-PREPARE-REPORT' TO PV-CURRENT-PARAGRAPH.          02730000
027400                                                                  02740000
027410     IF  AP442-DUN-NBR = HOLD-DUN-NBR                             02741015
027700         MOVE AP442-DEPT-NBR       TO DL-DEPT-NBR                 02770015
027710         MOVE AP442-PO-NBR         TO DL-PO-NBR                   02771015
027900         MOVE AP442-CREATE-DTE     TO DL-CREATE-DTE               02790015
028000         MOVE AP442-GROSS-COST     TO DL-GROSS-COST               02800015
028010         ADD AP442-GROSS-COST      TO VND-GROSS-COST              02801015
028011                                      RPT-GROSS-COST              02801115
028012     ELSE                                                         02801200
028013         MOVE VND-GROSS-COST       TO VTL-GROSS-COST              02801315
028014         PERFORM W300-PRINT-TOTALS                                02801400
028015         MOVE ZERO                 TO VND-GROSS-COST              02801515
028016         MOVE AP442-DUN-NBR        TO HOLD-DUN-NBR                02801615
028020         MOVE AP442-VENDOR-NAME    TO DL-VENDOR-NAME              02802018
028030         MOVE AP442-DUN-NBR        TO DL-DUN-NBR                  02803015
028040         MOVE AP442-DEPT-NBR       TO DL-DEPT-NBR                 02804015
028050         MOVE AP442-PO-NBR         TO DL-PO-NBR                   02805015
028060         MOVE AP442-CREATE-DTE     TO DL-CREATE-DTE               02806015
028070         MOVE AP442-GROSS-COST     TO DL-GROSS-COST               02807015
028080         ADD AP442-GROSS-COST      TO VND-GROSS-COST              02808015
028090                                      RPT-GROSS-COST              02809015
028091     END-IF.                                                      02809100
028100                                                                  02810000
028200     PERFORM W100-WRITE-UNUSED-NIR-RPT.                           02820000
028300     INITIALIZE DL-DETAIL-LINE.                                   02830000
028400                                                                  02840000
028500     PERFORM R100-READ-UNUSED-NIR.                                02850015
028600 EJECT                                                            02860000
028700*----------------------------------------------------------------*02870000
028800*    ENDING PROCESSING: DISPLAYS COUNT OF VENDORS AND CLOSES     *02880000
028900*    THE CURSOR AND FILES.                                       *02890000
029000*    CALLED FROM A100-MAIN                                       *02900000
029100*----------------------------------------------------------------*02910000
029200 B300-END-PROGRAM.                                                02920000
029300                                                                  02930000
029400     MOVE 'B300-END-PROGRAM' TO PV-CURRENT-PARAGRAPH.             02940000
029500                                                                  02950000
029600     DISPLAY 'INPUT RECORDS READ = ' PC-INPUT-REC-CNT.            02960015
029700                                                                  02970000
029701     MOVE VND-GROSS-COST TO VTL-GROSS-COST.                       02970100
029702     PERFORM W300-PRINT-TOTALS.                                   02970200
029710     MOVE RPT-GROSS-COST TO GTL-GROSS-COST.                       02971000
029800     PERFORM W500-PRINT-GRAND-TOTAL.                              02980000
029900                                                                  02990000
030000     CLOSE UNUSED-NIR-RPT-FILE                                    03000015
030000           UNUSED-NIR-DATA-FILE.                                  03001015
030100 EJECT                                                            03010000
030200*----------------------------------------------------------------*03020000
030300*    RETRIEVES THE VENDORS ON THE VENDOR SPECIFICATION TABLE.    *03030000
030400*    NOTE:  A NOT FOUND CONDITION IN THIS INSTANCE SIMPLY        *03040000
030500*           RESULTS IN THE OUT OF VENDORS SWITCH BEING SET.      *03050000
030600*----------------------------------------------------------------*03060000
030700 R100-READ-UNUSED-NIR.                                            03070015
030800                                                                  03080000
030900     MOVE 'R100-READ-UNUSED-NIR' TO PV-CURRENT-PARAGRAPH.         03090015
031000                                                                  03100000
025800     READ UNUSED-NIR-DATA-FILE INTO APRD442-RECORD                03111019
025900        AT END                                                    03120015
026000            SET INPUT-EOF-YES TO TRUE                             03130015
026100        NOT AT END                                                03140015
026200            ADD 1 TO PC-INPUT-REC-CNT                             03150015
026300     END-READ.                                                    03160015
036900 EJECT                                                            03690000
037000*----------------------------------------------------------------*03700000
037100*    WRITES THE VENDOR SPECIFICATION REPORT                      *03710000
037200*----------------------------------------------------------------*03720000
037300 W100-WRITE-UNUSED-NIR-RPT.                                       03730000
037400                                                                  03740000
037500     MOVE 'W100-WRITE-UNUSED-NIR-RPT' TO PV-CURRENT-PARAGRAPH.    03750000
037600                                                                  03760000
037700     IF PC-LINE-COUNT > PC-MAX-LINES                              03770000
037800         PERFORM W200-PRINT-HEADERS                               03780000
037810         MOVE AP442-VENDOR-NAME   TO DL-VENDOR-NAME               03781018
037820         MOVE AP442-DUN-NBR       TO DL-DUN-NBR                   03782015
037900     END-IF.                                                      03790000
038000                                                                  03800000
038100     WRITE UNUSED-NIR-RPT-REC FROM DL-DETAIL-LINE AFTER 1.        03810000
038200     ADD 1  TO PC-LINE-COUNT.                                     03820000
038300                                                                  03830000
038400*----------------------------------------------------------------*03840000
038500*    WRITES THE VENDOR SPECIFICATION HEADERS.                    *03850000
038600*----------------------------------------------------------------*03860000
038700 W200-PRINT-HEADERS.                                              03870000
038800                                                                  03880000
038900     MOVE 'W200-PRINT-HEADERS' TO PV-CURRENT-PARAGRAPH.           03890000
039000                                                                  03900000
039100     ADD 1                            TO PC-PAGE-COUNT.           03910000
039200     MOVE PC-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      03920000
039300                                                                  03930000
039400     WRITE UNUSED-NIR-RPT-REC                                     03940000
039500           FROM DP132O-STANDRD-HEADER-132-COLS AFTER PAGE.        03950000
039600     WRITE UNUSED-NIR-RPT-REC FROM H2-HEADER2 AFTER 1.            03960000
039700                                                                  03970000
039800     WRITE UNUSED-NIR-RPT-REC FROM DH-DETAIL-HEADER1 AFTER 2.     03980000
039900     WRITE UNUSED-NIR-RPT-REC FROM DH-DETAIL-HEADER2 AFTER 1.     03990000
039910     WRITE UNUSED-NIR-RPT-REC FROM DH-DETAIL-HEADER3 AFTER 1.     03991000
039920     WRITE UNUSED-NIR-RPT-REC FROM DH-DASH-LINE AFTER 1.          03992000
040000                                                                  04000000
040300     MOVE 6  TO PC-LINE-COUNT.                                    04030000
040310*----------------------------------------------------------------*04031000
040320*    WRITES THE VENDOR SUBTOTAL LINES.                           *04032000
040330*----------------------------------------------------------------*04033000
040340 W300-PRINT-TOTALS.                                               04034000
040350                                                                  04035000
040360     MOVE 'W300-PRINT-TOTALS' TO PV-CURRENT-PARAGRAPH.            04036000
040370                                                                  04037000
040396     WRITE UNUSED-NIR-RPT-REC FROM TL-VENDOR-DASH-LINE AFTER 1.   04039600
040397     WRITE UNUSED-NIR-RPT-REC FROM TL-VENDOR-TOTAL-LINE AFTER 1.  04039700
040398     MOVE SPACES TO UNUSED-NIR-RPT-REC.                           04039800
040399     WRITE UNUSED-NIR-RPT-REC AFTER 1.                            04039900
040400                                                                  04040000
040401     ADD 3  TO PC-LINE-COUNT.                                     04040100
040402*----------------------------------------------------------------*04040200
040403*    WRITES THE VENDOR SUBTOTAL LINES.                           *04040300
040404*----------------------------------------------------------------*04040400
040405 W400-WRITE-NO-DATA-MESSAGE.                                      04040500
040406                                                                  04040600
040407     MOVE 'NO UNUSED NON-INVOICED-RECEIPTS TO REPORT'             04040700
040408        TO UNUSED-NIR-RPT-REC.                                    04040800
040409     WRITE UNUSED-NIR-RPT-REC AFTER 1.                            04040900
040410                                                                  04041000
040411*----------------------------------------------------------------*04041100
040412*    WRITES THE VENDOR SUBTOTAL LINES.                           *04041200
040413*----------------------------------------------------------------*04041300
040414 W500-PRINT-GRAND-TOTAL.                                          04041400
040415                                                                  04041500
040416     WRITE UNUSED-NIR-RPT-REC FROM TL-VENDOR-DASH-LINE AFTER 1.   04041600
040417     WRITE UNUSED-NIR-RPT-REC FROM TL-VENDOR-DASH-LINE AFTER 1.   04041700
040418     WRITE UNUSED-NIR-RPT-REC FROM TL-GRAND-TOTAL-LINE AFTER 1.   04041800
040419                                                                  04041900
