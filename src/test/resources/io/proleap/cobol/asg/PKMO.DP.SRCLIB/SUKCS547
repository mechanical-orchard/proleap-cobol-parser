000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.                SUKCS547.                             00040000
000500 AUTHOR.                    PATRICK BURKE.                        00050000
000600 INSTALLATION.              KOHLS DEPARTMENT STORES.              00060000
000700 DATE-WRITTEN.              3/29/2006.                            00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000*  CICS PROGRAM - SUKCS547 - TRANID = S547                       *00100000
001200*                                                                *00120000
001300******************************************************************00130000
000910*----------------------------------------------------------------*00136207
000911* 07/07/2015  CHERI PARMLEY                                      *00136307
000920*             CHANGE WAS ADDED TO REPEAT THE 4 CURSORS TO        *00136407
000930*             ALSO GET DATA OFF THE NEW XLT_BRND AND             *00136507
000930*             SUT_BRND_MDSE_SUM TABLES. THIS WILL EVENTUALLY     *00136607
000940*             REPLACE THE XLT_MDSE_PGM AND THE SUT_PGM_MDSE_SUM  *00136707
000950*             TABLE.  (WHEN DATA IS OLD AND NOT PULLED ANY LONGER*00136807
000950*             IN ANY SYSTEM)                                     *00136907
000911* 03/2021     JEAN KURK                                          *00137010
000920*             REMOVE SUT_PGM_MDSE_SUM AND XLT_MDSE_PGM           *00137110
000111******************************************************************00138002
001400 ENVIRONMENT DIVISION.                                            00140000
001500******************************************************************00150000
001600 DATA DIVISION.                                                   00160000
001700******************************************************************00170000
001800     EJECT                                                        00180000
001900 WORKING-STORAGE SECTION.                                         00190000
002000 01  FILLER                          PIC X(27) VALUE              00200000
002100     'WORKING STORAGE STARTS HERE'.                               00210000
002200                                                                  00220000
002300*                                                                 00230000
002400*  STANDARD ATTENTION IDENTIFIER LIST                             00240000
002500*                                                                 00250000
002600     COPY DFHAID.                                                 00260000
002700     EJECT                                                        00270000
002800                                                                  00280000
002900* COPIES FOR THE PROGRAM DRS1INTC WORK FIELDS.                    00290000
003000     COPY DRRD001O.                                               00300000
003100     COPY DRRD002O.                                               00310000
003200                                                                  00320000
003300                                                                  00330000
003400*  COPY BOOK CONTAINING THE WORKING STORAGE VALUES REQUIRED FOR   00340000
003500*  CALLING THE PRINTER VALIDATION ROUTINE DPKCS060                00350000
003600*                                                                 00360000
003700     COPY DPWS072.                                                00370000
003800                                                                  00380000
003900*  COPY BOOK CONTAINING COMMON PRINTER LINE COMMANDS              00390000
004000*                                                                 00400000
004100     COPY DSWS004.                                                00410000
004200                                                                  00420000
004700*  RECORD LAYOUT FOR THE REPORT                                   00470000
004800*                                                                 00480000
004900     COPY DPWS132.                                                00490000
005000                                                                  00500000
005010***************************************************************** 00501000
005020*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 00502000
005030***************************************************************** 00503000
005050     COPY SUWS083.                                                00505000
005060                                                                  00506000
005061***************************************************************** 00506100
005070/                                                                 00507000
005100 01  DK-DB2-KEYS.                                                 00510000
005110     05  DK-TRIP-OCRNC-ID             PIC S9(9) COMP VALUE ZERO.  00511000
005130     05  DK-BUS-AREA-ID               PIC S9(2)V COMP-3.          00513000
006900                                                                  00690000
007000 01  IE-DRS-ERROR-MSG.                                            00700000
007100     05  FILLER                       PIC X(41)  VALUE            00710000
007200     'A DRS ERROR HAS OCCURRED  - CONTACT DP - '.                 00720000
007300     05  FILLER                       PIC X(44)  VALUE            00730000
007400     'PROGRAM SUKCS547'.                                          00740000
007500     05  FILLER                       PIC X(11)  VALUE            00750000
007600     'FUNCTION = '.                                               00760000
007700     05  IE-DRS-FUNC                  PIC X(4)   VALUE SPACE.     00770000
007800     05  FILLER                       PIC X(14)  VALUE            00780000
007900     'RETURN CODE = '.                                            00790000
008000     05  IE-DRS-RC                    PIC X(4)   VALUE SPACES.    00800000
008100                                                                  00810000
008200*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               00820000
008300*                                                                 00830000
008310     05  PV-DRS-ABEND-DISPLAY-LINE1.                              00831000
008320         10  FILLER                      PIC  X(14)  VALUE        00832000
008330             'DRRB ID = DRRB'.                                    00833000
008340         10  FILLER                      PIC  X(02)  VALUE SPACE. 00834000
008350         10  FILLER                      PIC  X(12)  VALUE        00835000
008360             'DRRB FUNC = '.                                      00836000
008370         10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE. 00837000
008380         10  FILLER                      PIC  X(02)  VALUE SPACE. 00838000
008390         10  FILLER                      PIC  X(11)  VALUE        00839000
008391             'DRRB RID = '.                                       00839100
008392         10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE. 00839200
008393         10  FILLER                      PIC  X(02)  VALUE SPACE. 00839300
008394         10  FILLER                      PIC  X(15)  VALUE        00839400
008395             'DRRB OPTIONS = '.                                   00839500
008396         10  PV-DRS-DRRB-OPTIONS         PIC  X(08)  VALUE SPACE. 00839600
008397     05  PV-DRS-ABEND-DISPLAY-LINE2.                              00839700
008398         10  FILLER                      PIC  X(10)  VALUE        00839800
008399             'DRRB RC = '.                                        00839900
008400         10  PV-DRS-DRRB-RC              PIC  X(04)  VALUE SPACE. 00840000
008401         10  FILLER                      PIC  X(02)  VALUE SPACE. 00840100
008402         10  FILLER                      PIC  X(18)  VALUE        00840200
008403             'DRRB ATTR-ERROR = '.                                00840300
008404         10  PV-DRS-ATTR-ERROR           PIC  X(02)  VALUE SPACE. 00840400
008405         10  FILLER                      PIC  X(02)  VALUE SPACE. 00840500
008406         10  FILLER                      PIC  X(12)  VALUE        00840600
008407             'DRRB DRDC = '.                                      00840700
008408         10  PV-DRS-DRRB-DRDC            PIC  X(04)  VALUE SPACE. 00840800
008409         10  FILLER                      PIC  X(02)  VALUE SPACE. 00840900
008410         10  FILLER                      PIC  X(13)  VALUE        00841000
008411             'DRRB LINES = '.                                     00841100
008412         10  PV-DRS-DRRB-LINES           PIC  X(04)  VALUE SPACE. 00841200
008413 01  PV-CICS-MSG-AREA.                                            00841300
008414     05  FILLER                          PIC X(20) VALUE          00841400
008415                 '** SUKCS547 ** TASK='.                          00841500
008416     05  PV-TASK-NUMBER                  PIC Z(08).               00841600
008417     05  FILLER                          PIC X(07) VALUE          00841700
008418                 ' TIME= '.                                       00841800
008419     05  PV-TIME                         PIC X(08).               00841900
008420     05  FILLER                          PIC X(09) VALUE          00842000
008421         ' QUEUE = '.                                             00842100
008422     05  PV-QUEUE-NAME.                                           00842200
008423         10  PV-ADDRESS                  PIC X(4)  VALUE SPACES.  00842300
008424         10  PV-TASK                     PIC 9(5)  VALUE ZERO.    00842400
008425         10  PV-LAST-NUMBER              PIC X(1)  VALUE SPACES.  00842500
008426     05  FILLER                          PIC X(1)  VALUE SPACES.  00842600
008427     05  PV-CICS-MESSAGE                 PIC X(55) VALUE SPACES.  00842700
008428                                                                  00842800
008429     COPY DFHAID.                                                 00842900
008430     COPY DPWS013.                                                00843000
008500     COPY DPWS020.                                                00850000
008600                                                                  00860000
008700 01  HL1-HEADING-LINE.                                            00870000
008800     05  FILLER                      PIC X(22)  VALUE SPACES.     00880000
008900     05  FILLER                      PIC X(28)  VALUE             00890000
009000     'TRAILER MERCHANDISE PGM/BRAN'.                              00900005
009100     05  FILLER                      PIC X(13)  VALUE             00910000
009200     'D SUMMARY    '.                                             00920005
009300     05  FILLER                      PIC X(46)  VALUE SPACES.     00930000
009400                                                                  00940000
      *CLP 08/07/2105 START                                             00940104
008700 01  HL1B-HEADING-LINE.                                           00941004
008800     05  FILLER                      PIC X(22)  VALUE SPACES.     00942004
008900     05  FILLER                      PIC X(28)  VALUE             00943004
009000     'TRAILER MERCHANDISE BRAND SU'.                              00944004
009100     05  FILLER                      PIC X(13)  VALUE             00945004
009200     'MMARY        '.                                             00946004
009300     05  FILLER                      PIC X(46)  VALUE SPACES.     00947004
      *CLP 08/07/2105 END                                               00947104
009400                                                                  00948004
009500 01  HL2-HEADING-LINE.                                            00950000
009600     05  FILLER                      PIC X(01)  VALUE SPACES.     00960000
009700     05  FILLER                      PIC X(17)                    00970000
009710                                       VALUE 'STORE NUMBER....:'. 00971000
009720     05  FILLER                      PIC X(01)  VALUE SPACES.     00972000
009800     05  HL2-STORE-NBR               PIC Z,ZZZ.                   00980000
009900     05  FILLER                      PIC X(01)  VALUE SPACES.     00990000
010000     05  HL2-STORE-NAME              PIC X(25)  VALUE SPACES.     01000000
011100                                                                  01110000
011200 01  HL3-HEADING-LINE.                                            01120000
011210     05  FILLER                      PIC X(01)  VALUE SPACES.     01121000
011220     05  FILLER                      PIC X(17)                    01122000
011230                                       VALUE 'TRAILER SERIAL #:'. 01123000
011240     05  FILLER                      PIC X(01)  VALUE SPACES.     01124000
011250     05  HL3-TRAILER-SERIAL          PIC X(09)  VALUE SPACES.     01125000
011260     05  FILLER                      PIC X(13)  VALUE SPACES.     01126000
011261     05  FILLER                      PIC X(15)                    01126100
011262                                       VALUE 'CURRENT STATUS:'.   01126200
011263     05  FILLER                      PIC X(01)  VALUE SPACES.     01126300
011270     05  HL3-CURRENT-STATUS          PIC X(20)  VALUE SPACES.     01127000
011280                                                                  01128000
011290 01  HL4-HEADING-LINE.                                            01129000
011300     05  FILLER                      PIC X(01)  VALUE SPACES.     01130000
011400     05  FILLER                      PIC X(17)                    01140000
011500                                       VALUE 'SCAC/TRAILER ID.:'. 01150000
011600     05  FILLER                      PIC X(01)  VALUE SPACES.     01160000
011700     05  HL4-SCAC                    PIC X(04)  VALUE SPACES.     01170000
011800     05  FILLER                      PIC X(03)  VALUE ' - '.      01180000
011810     05  HL4-TRAILER-ID              PIC X(12)  VALUE SPACES.     01181000
011820     05  FILLER                      PIC X(03)  VALUE SPACES.     01182000
011900     05  FILLER                      PIC X(15)                    01190000
012000                                       VALUE 'SERVICING DC..:'.   01200000
012100     05  FILLER                      PIC X(01)  VALUE SPACES.     01210000
012200     05  HL4-SERVICING-DC            PIC X(20)  VALUE SPACES.     01220000
012210     05  FILLER                      PIC X(01)  VALUE SPACES.     01221000
012300                                                                  01230000
012400 01  HL5-HEADING-LINE.                                            01240000
012500     05  FILLER                      PIC X(01)  VALUE SPACES.     01250000
012600     05  FILLER                      PIC X(17)                    01260000
012700                                       VALUE 'TOTAL CARTONS...:'. 01270000
012800     05  FILLER                      PIC X(01)  VALUE SPACES.     01280000
012900     05  HL5-TOTAL-CARTONS           PIC Z,ZZZ,ZZZ.               01290000
013000     05  FILLER                      PIC X(15)  VALUE SPACES.     01300000
013100     05  FILLER                      PIC X(15)                    01310000
013200                                       VALUE 'SUMMARY AS OF.:'.   01320000
013210     05  FILLER                      PIC X(01)  VALUE SPACES.     01321000
013220     05  HL5-SUMMARY-DATE            PIC X(10)  VALUE SPACES.     01322000
013221     05  FILLER                      PIC X(01)  VALUE SPACES.     01322100
013222     05  HL5-SUMMARY-TIME            PIC X(10)  VALUE SPACES.     01322200
013230                                                                  01323000
013240 01  HL6-HEADING-LINE.                                            01324000
013250     05  FILLER                      PIC X(01)  VALUE SPACES.     01325000
013260     05  FILLER                      PIC X(17)                    01326000
013270                                       VALUE 'TOTAL UNITS.....:'. 01327000
013280     05  FILLER                      PIC X(01)  VALUE SPACES.     01328000
013290     05  HL6-TOTAL-UNITS             PIC Z,ZZZ,ZZZ.               01329000
013291     05  FILLER                      PIC X(15)  VALUE SPACES.     01329100
013300                                                                  01330000
013310 01  HL7-HEADING-LINE.                                            01331000
013320     05  FILLER                      PIC X(01)  VALUE SPACES.     01332000
013360     05  HL7-SEQUENCE-DESC           PIC X(20)  VALUE SPACES.     01336000
013370     05  FILLER                      PIC X(01)  VALUE SPACES.     01337000
013380                                                                  01338000
015500 01  HL8-HEADING-LINE.                                            01550000
015600     05  FILLER                       PIC X(07)  VALUE SPACES.    01560000
015700     05  FILLER                       PIC X(13)                   01570000
015710                                        VALUE 'BUSINESS AREA'.    01571000
015800     05  FILLER                       PIC X(07)  VALUE SPACES.    01580000
015900     05  FILLER                       PIC X(20) VALUE             01590000
015910                                          'PGM/BRAND DESCR     '. 01591005
016000     05  FILLER                       PIC X(07)  VALUE SPACES.    01600000
016100     05  FILLER                       PIC X(07)  VALUE 'CARTONS'. 01610000
016200     05  FILLER                       PIC X(06)  VALUE SPACES.    01620000
016300     05  FILLER                       PIC X(05)  VALUE 'UNITS'.   01630000
016400     05  FILLER                       PIC X(04)  VALUE SPACES.    01640000
016300     05  FILLER                       PIC X(03)  VALUE            01641000
                                            'NEW'.                      01641100
016400     05  FILLER                       PIC X(04)  VALUE SPACES.    01642000
016500     05  FILLER                       PIC X(07)  VALUE 'SKU CNT'. 01650000
016600     05  FILLER                       PIC X(02)  VALUE SPACES.    01660000
016500     05  FILLER                       PIC X(20)  VALUE            01661000
                                            'HANG-H/FOLD-F/BOTH-B'.     01661100
016600     05  FILLER                       PIC X(02)  VALUE SPACES.    01661200
016620                                                                  01662000
024600 01  DL1-DETAIL-LINE.                                             02460000
024700     05  FILLER                       PIC X(07)  VALUE SPACES.    02470000
024800     05  DL1-BUS-AREA                 PIC X(18)  VALUE SPACES.    02480000
025100     05  FILLER                       PIC X(02)  VALUE SPACE.     02510000
025110     05  DL1-MDSE-DESC                PIC X(23)  VALUE SPACES.    02511000
025120     05  FILLER                       PIC X(02)  VALUE SPACE.     02512000
025200     05  DL1-CARTONS                  PIC Z,ZZZ,ZZZ.              02520000
025300     05  FILLER                       PIC X(02)  VALUE SPACES.    02530000
025310     05  DL1-UNITS                    PIC Z,ZZZ,ZZZ.              02531000
025320     05  FILLER                       PIC X(05)  VALUE SPACES.    02532000
025310     05  DL1-NEW-IND                  PIC X(01)  VALUE SPACES.    02532100
025320     05  FILLER                       PIC X(03)  VALUE SPACES.    02532200
025330     05  DL1-SKU-CNT                  PIC Z,ZZZ,ZZZ.              02533000
025340     05  FILLER                       PIC X(12)  VALUE SPACES.    02534000
025310     05  DL1-HANG-FOLD-CDE            PIC X(01)  VALUE SPACES.    02535000
025320     05  FILLER                       PIC X(02)  VALUE SPACES.    02536000
026800                                                                  02680000
033600 01  DL-DASH-LINE                     PIC X(108) VALUE ALL '_'.   03360000
033700                                                                  03370000
033800 01  PC-CARRIAGE-CONTROL.                                         03380000
033900     05  PC-TOP-OF-PAGE               PIC  X(01) VALUE '1'.       03390000
034000     05  PC-SINGLE-SPACE              PIC  X(01) VALUE SPACE.     03400000
034100     05  PC-DOUBLE-SPACE              PIC  X(01) VALUE ZERO.      03410000
034200     05  PC-TRIPLE-SPACE              PIC  X(01) VALUE '-'.       03420000
034300     05  PC-PUT                       PIC  X(03) VALUE 'PUT'.     03430000
034400     05  PC-INIT                      PIC  X(04) VALUE 'INIT'.    03440000
034500     05  PC-TERM                     PIC  X(04)  VALUE 'TERM'.    03450000
034600*                                                                 03460000
044600 01  PS-PROGRAM-SWITCHES.                                         04460000
044900     05  PS-END-OF-CSR-SW             PIC X(1)   VALUE 'N'.       04490000
045000         88  PS-END-OF-CSR-NO                    VALUE 'N'.       04500000
045100         88  PS-END-OF-CSR                       VALUE 'Y'.       04510000
045200     05  PS-BUSAREA-CSR-SW            PIC X(1)   VALUE 'N'.       04520000
045400         88  PS-BUSAREA-CSR                      VALUE 'Y'.       04540000
045500         88  PS-BUSAREA-CSR-NO                   VALUE 'N'.       04550000
046300     05  PS-TOP-OF-PAGE-SET-SW        PIC X(01)  VALUE 'N'.       04630000
046400         88  PS-TOP-OF-PAGE-SET                  VALUE 'Y'.       04640000
046500         88  PS-TOP-OF-PAGE-NOT-SET              VALUE 'N'.       04650000
046600     05  PRINT-DETAIL-CHECK-SW        PIC X(01)  VALUE 'N'.       04660000
046700         88  PRINT-DETAIL-CHECK                  VALUE 'Y'.       04670000
046800         88  NO-PRINT-DETAIL-CHECK               VALUE 'N'.       04680000
046900     05  PRINT-DOUBLE-HEADING-SW      PIC X(01)  VALUE 'N'.       04690000
047000         88  PRINT-DOUBLE-HEADING                VALUE 'Y'.       04700000
047100         88  PRINT-SINGLE-HEADING                VALUE 'N'.       04710000
047200                                                                  04720000
047300 01  PS-PROGRAM-SUBSCRIPTS.                                       04730000
047400     05  PS-DIST-SUB                     PIC S9(04)  VALUE +0     04740000
047500                                                     COMP SYNC.   04750000
047600     05  INST-SUB                        PIC S9(04)  VALUE +0     04760000
047700                                                     COMP SYNC.   04770000
047800     05  STR-SUB                         PIC S9(04)  VALUE +0     04780000
047900                                                     COMP SYNC.   04790000
053300                                                                  05330000
053400 01  PA-PROGRAM-ACCUMS.                                           05340000
053500     05  PA-RPT1-PAGE-NO              PIC S9(5)      VALUE ZERO.  05350000
053600     05  PA-RPT2-PAGE-NO              PIC S9(5)      VALUE ZERO.  05360000
053700     05  PA-AMOUNT-RECEIVED           PIC S9(7)      COMP-3       05370000
053800                                                     VALUE ZERO.  05380000
053900     05  PA-LINE-COUNT                PIC S9(2)      VALUE ZERO.  05390000
054000     05  PA-SELECT-COUNTER            PIC S9(08)     VALUE +0     05400000
054100                                                     COMP SYNC.   05410000
054200     05  PA-VENDOR-REQ-CERT           PIC S9(08)     VALUE +0     05420000
054300                                                     COMP SYNC.   05430000
054400     05  PA-VENDOR-UPC                PIC S9(08)     VALUE +0     05440000
054500                                                     COMP SYNC.   05450000
054600                                                                  05460000
054700 01  SA-SAVE-AREAS.                                               05470000
054800     05  SA-REPORT-ID                 PIC X(8).                   05480000
054900     05  SA-PO-NBR                    PIC X(8).                   05490000
055000     05  SA-KEY-REC-NUM               PIC 9(8)       VALUE ZEROS. 05500000
055100     05  SA-KEY-REC  REDEFINES  SA-KEY-REC-NUM.                   05510000
055200         10  SA-KEY1                  PIC X(7).                   05520000
055300         10  SA-KEY-SUB REDEFINES SA-KEY1.                        05530000
055400             15  FILLER               PIC X(3).                   05540000
055500             15  SA-KEY-LAST4         PIC X(4).                   05550000
055600         10  SA-KEY2                  PIC X.                      05560000
055700     05  SA-TOTAL-QUANTITY            PIC S9(9)  VALUE ZERO.      05570000
055800     05  SA-KEY-FEED-BACK             PIC X(10)  VALUE SPACES.    05580000
055900     05  SA-RQTY                      PIC S9(6)  VALUE ZERO.      05590000
056000*    05  SA-LINE                      PIC X(03)  VALUE SPACES.    05600000
056100*    05  SA-STORE-NUM                 PIC X(03)  VALUE SPACES.    05610000
056200     05  SA-INSTRUCTIONS OCCURS 9 TIMES                           05620000
056300                                      PIC X(25)  VALUE SPACES.    05630000
056400     05  SA-FREIGHT-INSTR             PIC X(25)  VALUE SPACES.    05640000
056500     05  SA-DATE-RECEIVED             PIC X(08)  VALUE SPACES.    05650000
056600     05  SA-STYLE.                                                05660000
056700         10  SA-VENDOR-STYLE          PIC X(15).                  05670000
056800         10  FILLER                   PIC X(10).                  05680000
056900     05  SA-CLASS.                                                05690000
057000         10  SA-CLASS2                PIC X(2).                   05700000
057100         10  FILLER                   PIC X.                      05710000
057200     05  SA-DATE-N                    PIC 9(6).                   05720000
057300     05  SA-DATE REDEFINES SA-DATE-N.                             05730000
057400         10  SA-MONTH                 PIC X(2).                   05740000
057500         10  SA-DAY                   PIC X(2).                   05750000
057600         10  SA-YEAR.                                             05760000
057700             15  SA-FIRST-DIGIT-OF-YEAR                           05770000
057800                                      PIC X.                      05780000
057900             15  SA-SECOND-DIGIT-OF-YEAR                          05790000
058000                                      PIC X.                      05800000
058100     05  SA-SEASON.                                               05810000
058200         10  SA-SEASON-CODE           PIC X.                      05820000
058300         10  SA-SEASON-YR.                                        05830000
058400             15  SA-SEASON-SECOND-DIGIT-OF-YEAR                   05840000
058500                                      PIC X.                      05850000
058600         10  SA-SEASON-MONTH.                                     05860000
058700             15  SA-SEASON-SECOND-DIGIT-OF-MNTH                   05870000
058800                                      PIC X.                      05880000
058900                                                                  05890000
061300 01  PC-PROGRAM-CONSTANTS.                                        06130000
061400     05  PC-M                         PIC X(01) VALUE 'M'.        06140000
061500     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'SUKCS547'. 06150000
061600     05  PC-DPKCS060                  PIC X(8)  VALUE 'DPKCS060'. 06160000
063600     05  PC-LINE-MAX                  PIC S9(2)  VALUE +22.       06360000
063700     05  PC-PAGE                      PIC X      VALUE '1'.       06370000
063800     05  PC-SPACE1                    PIC X      VALUE ' '.       06380000
063900     05  PC-SPACE2                    PIC X      VALUE '0'.       06390000
064000     05  PC-SPACE3                    PIC X      VALUE '-'.       06400000
064100     05  PC-SIX                       PIC 9      VALUE 6.         06410000
064200     05  PC-SEVEN                     PIC 9      VALUE 7.         06420000
064300     05  PC-ONE                       PIC 9      VALUE 1.         06430000
064400     05  PC-01                        PIC XX     VALUE '01'.      06440000
065700     05  PC-MAX-RETRIES               PIC S9(04) VALUE +2         06570000
065800                                      COMP SYNC.                  06580000
065900     05  PC-DEFAULT-DATE              PIC X(26) VALUE             06590000
066000         '9999-09-09-09.09.09.999999'.                            06600000
066400                                                                  06640000
066500 01  PV-PROGRAM-VARIABLES.                                        06650000
066600     05  PV-CICS-MSG-AREA             PIC  X(80)  VALUE SPACE.    06660000
066700     05  PV-CICS-MSG-AREA2            PIC  X(100) VALUE SPACE.    06670000
066800     05  PV-CICS-MSG-HOLD.                                        06680000
066900         10  FILLER                   PIC  X(01)  VALUE SPACE.    06690000
067000         10  PV-CICS-MSG-DATA         PIC  X(79)  VALUE SPACE.    06700000
067100     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        06710000
067200                                                  COMP SYNC.      06720000
067300     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     06730000
067400     05  PV-RUN-TIME                  PIC X(08) VALUE SPACES.     06740000
067500     05  PV-CREATE-DATE               PIC X(10) VALUE SPACES.     06750000
067600     05  PV-CREATE-TIME               PIC X(08) VALUE SPACES.     06760000
067700     05  PV-PAGE-COUNT                PIC 9(05) VALUE ZERO.       06770000
067800     05  PV-LINE-COUNT                PIC 9(05) VALUE ZERO.       06780000
068000     05  PV-DB2-COUNT                 PIC S9(9) VALUE +0          06800000
068100                                                COMP-3.           06810000
068800     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        06880000
068900                                                COMP SYNC.        06890000
069200     05  PV-COMMON-LENGTH             PIC S9(04) VALUE +0         06920000
069300                                                 COMP.            06930000
070900     05  PV-AD-EVNT-DTE               PIC S9(4) VALUE ZERO        07090000
071000                                                 COMP.            07100000
071100     05  PV-SEQ-DESC                  PIC X(20) VALUE SPACES.     07110000
071200                                                                  07120000
074400 01  CA-COMMON-AREA.                                              07440000
074500         10  CA-TRIP-OCRNC-ID         PIC 9(09).                  07450000
074600         10  CA-STORE-NBR             PIC 9(04).                  07460000
074700         10  CA-STORE-NAME            PIC X(25).                  07470000
074800         10  CA-TRAILER-SERIAL-NBR    PIC 9(09).                  07480000
074900         10  CA-CURRENT-STATUS        PIC X(20).                  07490000
075100         10  CA-SCAC                  PIC X(4).                   07510000
075200         10  CA-TRAILER-ID            PIC X(1).                   07520000
075300         10  CA-SERVICING-DC          PIC X(20).                  07530000
075310         10  CA-TOTAL-CARTONS         PIC 9(06).                  07531000
075311         10  CA-SUMMARY-AS-OF-DATE    PIC X(10).                  07531100
075312         10  CA-SUMMARY-AS-OF-TIME    PIC X(08).                  07531200
075320         10  CA-TOTAL-UNITS           PIC 9(06).                  07532000
075330         10  CA-DISPLAY-SEQUENCE      PIC X(20).                  07533000
075400         10  CA-PRINTER               PIC X(8).                   07540000
076200*                                                                 07620000
076300         10  CA-DRIB-AREA             PIC X(264).                 07630000
076500                                                                  07650000
077100*    DOMAIN BUSINESS AREA                                         07710000
077200     EXEC SQL                                                     07720000
077300          INCLUDE XLT00000                                        07730000
077400     END-EXEC.                                                    07740000
077500                                                                  07750000
077600*    DOMAIN BUSINESS GROUP                                        07760000
077700     EXEC SQL                                                     07770000
077800          INCLUDE XLT00001                                        07780000
077900     END-EXEC.                                                    07790000
077901                                                                  07790100
077902*    DOMAIN DEPARTMENT                                            07790200
077903     EXEC SQL                                                     07790300
077904          INCLUDE XLT00002                                        07790400
077905     END-EXEC.                                                    07790500
077906                                                                  07790600
084200*    DOMAIN LOCATION TABLE                                        08420000
084900     EXEC SQL                                                     08490000
085000         INCLUDE XLT00010                                         08500000
085100     END-EXEC.                                                    08510000
085200                                                                  08520000
085210*    XLT MDSE PGM                                                 08521000
085220*    EXEC SQL                                                     08522009
085230*         INCLUDE XLT00040                                        08523009
085240*    END-EXEC.                                                    08524009
085250                                                                  08525000
      *CLP 07/07/2015 START                                             08525102
085210*    XLT BRND                                                     08526001
085220     EXEC SQL                                                     08527001
085230          INCLUDE XLT00043                                        08528001
085240     END-EXEC.                                                    08529001
      *CLP 07/07/2015 END                                               08529102
085250                                                                  08529201
085300*    BUSINESS GROUP SUMMARY                                       08530000
085400     EXEC SQL                                                     08540000
085500          INCLUDE SUT00008                                        08550000
085600     END-EXEC.                                                    08560000
085610                                                                  08561000
085700*    DEPT SUMMARY                                                 08570000
085800     EXEC SQL                                                     08580000
085900          INCLUDE SUT00009                                        08590000
086000     END-EXEC.                                                    08600000
086001                                                                  08600100
086010*    MAJOR CLASS AD DATE                                          08601000
086020     EXEC SQL                                                     08602000
086030          INCLUDE SUT00011                                        08603000
086040     END-EXEC.                                                    08604000
086050/                                                                 08605000
086100                                                                  08610000
086200*    SUT PGM MDSE SUM                                             08620000
086300*    EXEC SQL                                                     08630009
086400*         INCLUDE SUT00096                                        08640009
086500*    END-EXEC.                                                    08650009
086600                                                                  08660000
086200*    SUT BRND MDSE SUM                                            08670001
086300     EXEC SQL                                                     08680001
086400          INCLUDE SUT00066                                        08690001
086500     END-EXEC.                                                    08700001
086600                                                                  08701001
087020     EXEC SQL                                                     08702000
087030          INCLUDE TSUOBTR                                         08703000
087040     END-EXEC.                                                    08704000
087050                                                                  08705000
087100                                                                  08710000
088400*                                                                 08840000
088500*  COMMUNICATION AREAS FOR DB2                                    08850000
088600*                                                                 08860000
088700     EXEC SQL                                                     08870000
088800         INCLUDE SQLCA                                            08880000
088900     END-EXEC.                                                    08890000
089000                                                                  08900000
089578******************************************************************08957800
089579* BUSAREA AREA CURSOR BRINGS BACK ALL MERCHANDISE PGMS FOR AN AREA08957900
089580* SELECTED ON BUSAREA SCREEN IN AREA SEQUENCE                     08958000
089580* WITH XLT_MDSE_PGM AND SUT_PGM_MDSE_SUM                          08958103
089581******************************************************************08958202
089582*                                                                 08958310
089583*    EXEC SQL                                                     08958410
089584*        DECLARE TRLR-AREA-CSR CURSOR FOR                         08958510
089585*     SELECT A.TRIP_OCRNC_ID                                      08958610
089586*          , A.BUS_AREA_ID                                        08958710
089587*          , A.MDSE_PGM_ID                                        08958810
089588*          , A.UNT_QTY                                            08958910
089589*          , A.SKU_QTY                                            08959010
089590*          , A.CART_QTY                                           08959110
089591*          , A.RTL_DOL_AMT                                        08959210
089592*          , A.COST_DOL_AMT                                       08959310
046523*          , A.HNG_FOLD_CDE                                       08959410
046523*          , A.PRC_MSG_RPLN_NEW_IND                               08959510
089593*          , B.BUS_AREA_ID                                        08959610
089594*          , B.BUS_AREA_DESC                                      08959710
089595*          , C.MDSE_PGM_ID                                        08959810
089596*          , C.MDSE_PGM_DESC                                      08959910
089597*     FROM SUT_PGM_MDSE_SUM   A                                   08960010
089598*        , XLT_BUS_AREA   B                                       08960110
089599*        , XLT_MDSE_PGM   C                                       08960210
089600*     WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   08960310
089602*       AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       08960410
089603*       AND C.MDSE_PGM_ID   = A.MDSE_PGM_ID                       08960510
089604*     UNION ALL                                                   08960610
089605*     SELECT A.TRIP_OCRNC_ID                                      08960710
089606*          , A.BUS_AREA_ID                                        08960810
089607*          , A.MDSE_PGM_ID                                        08960910
089608*          , A.UNT_QTY                                            08961010
089609*          , A.SKU_QTY                                            08961110
089610*          , A.CART_QTY                                           08961210
089611*          , A.RTL_DOL_AMT                                        08961310
089612*          , A.COST_DOL_AMT                                       08961410
046523*          , A.HNG_FOLD_CDE                                       08961510
046523*          , A.PRC_MSG_RPLN_NEW_IND                               08961610
089613*          , B.BUS_AREA_ID                                        08961710
089614*          , B.BUS_AREA_DESC                                      08961810
089615*          , 999999999                                            08961910
089616*          , 'UNKNOWN'                                            08962010
089617*     FROM SUT_PGM_MDSE_SUM   A                                   08962110
089618*        , XLT_BUS_AREA   B                                       08962210
089619*        WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                08962310
089621*          AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    08962410
089622*          AND  NOT EXISTS (SELECT *                              08962510
089623*                             FROM XLT_MDSE_PGM  X                08962610
089624*                            WHERE A.MDSE_PGM_ID = X.MDSE_PGM_ID) 08962710
089625*        ORDER BY 12                                              08962810
089626*               , 14                                              08962910
089627*                                                                 08963010
089628*    END-EXEC.                                                    08963110
                                                                        08963202
      *CLP 07/07/2015 START                                             08963307
089578******************************************************************08963402
089579* BUSAREA AREA CURSOR BRINGS BACK ALL MERCHANDISE PGMS FOR AN AREA08963502
089580* SELECTED ON BUSAREA SCREEN IN AREA SEQUENCE                     08963602
089580* WITH XLT_BRND AND SUT_BRND_MDSE_SUM                             08963703
089581******************************************************************08963802
089582                                                                  08963902
089583     EXEC SQL                                                     08964002
089584         DECLARE TRLR-AREA-B-CSR CURSOR FOR                       08964102
089585      SELECT A.TRIP_OCRNC_ID                                      08964202
089586           , A.BUS_AREA_ID                                        08964302
089587           , A.BRND_ID                                            08964402
089588           , A.UNT_QTY                                            08964502
089589           , A.SKU_QTY                                            08964602
089590           , A.CART_QTY                                           08964702
089591           , A.RTL_DOL_AMT                                        08964802
089592           , A.COST_DOL_AMT                                       08964902
046523           , A.HNG_FOLD_CDE                                       08965002
046523           , A.PRC_MSG_RPLN_NEW_IND                               08965102
089593           , B.BUS_AREA_ID                                        08965202
089594           , B.BUS_AREA_DESC                                      08965302
089595           , C.BRND_ID                                            08965402
089596           , C.BRND_DESC                                          08965502
089597      FROM SUT_BRND_MDSE_SUM   A                                  08965602
089598         , XLT_BUS_AREA   B                                       08965702
089599         , XLT_BRND       C                                       08965802
089600      WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   08965902
089602        AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       08966002
089603        AND C.BRND_ID   = A.BRND_ID                               08966102
089604      UNION ALL                                                   08966202
089605      SELECT A.TRIP_OCRNC_ID                                      08966302
089606           , A.BUS_AREA_ID                                        08966402
089607           , A.BRND_ID                                            08966502
089608           , A.UNT_QTY                                            08966602
089609           , A.SKU_QTY                                            08966702
089610           , A.CART_QTY                                           08966802
089611           , A.RTL_DOL_AMT                                        08966902
089612           , A.COST_DOL_AMT                                       08967002
046523           , A.HNG_FOLD_CDE                                       08967102
046523           , A.PRC_MSG_RPLN_NEW_IND                               08967202
089613           , B.BUS_AREA_ID                                        08967302
089614           , B.BUS_AREA_DESC                                      08967402
089615           , 32767                                                08967508
089616           , 'UNKNOWN'                                            08967602
089617      FROM SUT_BRND_MDSE_SUM   A                                  08967702
089618         , XLT_BUS_AREA   B                                       08967802
089619         WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                08967902
089621           AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    08968002
089622           AND  NOT EXISTS (SELECT *                              08968102
089623                              FROM XLT_BRND  X                    08968202
089624                             WHERE A.BRND_ID = X.BRND_ID)         08968302
089625         ORDER BY 12                                              08968402
089626                , 14                                              08968502
089627                                                                  08968602
089628     END-EXEC.                                                    08968702
      *CLP 07/07/2015 END                                               08968807
                                                                        08968907
089629******************************************************************08969002
089630* BUSAREA UNIT CURSOR BRINGS BACK ALL MERCHANDISE PGMS FOR AN AREA08969102
089631* SELECTED ON BUSAREA SCREEN IN UNIT SEQUENCE                     08969202
089631* WITH XLT_MDSE_PGM AND SUT_PGM_MDSE_SUM                          08969303
089632******************************************************************08969402
089633*                                                                 08969510
089634*    EXEC SQL                                                     08969610
089635*        DECLARE TRLR-UNIT-CSR CURSOR FOR                         08969710
089636*     SELECT A.TRIP_OCRNC_ID                                      08969810
089637*          , A.BUS_AREA_ID                                        08969910
089638*          , A.MDSE_PGM_ID                                        08970010
089639*          , A.UNT_QTY                                            08970110
089640*          , A.SKU_QTY                                            08970210
089641*          , A.CART_QTY                                           08970310
089642*          , A.RTL_DOL_AMT                                        08970410
089643*          , A.COST_DOL_AMT                                       08970510
046523*          , A.HNG_FOLD_CDE                                       08970610
046523*          , A.PRC_MSG_RPLN_NEW_IND                               08970710
089644*          , B.BUS_AREA_ID                                        08970810
089645*          , B.BUS_AREA_DESC                                      08970910
089646*          , C.MDSE_PGM_ID                                        08971010
089647*          , C.MDSE_PGM_DESC                                      08971110
089648*     FROM SUT_PGM_MDSE_SUM   A                                   08971210
089649*        , XLT_BUS_AREA   B                                       08971310
089650*        , XLT_MDSE_PGM   C                                       08971410
089651*     WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   08971510
089653*       AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       08971610
089654*       AND C.MDSE_PGM_ID   = A.MDSE_PGM_ID                       08971710
089655*     UNION ALL                                                   08971810
089656*     SELECT A.TRIP_OCRNC_ID                                      08971910
089657*          , A.BUS_AREA_ID                                        08972010
089658*          , A.MDSE_PGM_ID                                        08972110
089659*          , A.UNT_QTY                                            08972210
089660*          , A.SKU_QTY                                            08972310
089661*          , A.CART_QTY                                           08972410
089662*          , A.RTL_DOL_AMT                                        08972510
089663*          , A.COST_DOL_AMT                                       08972610
046523*          , A.HNG_FOLD_CDE                                       08972710
046523*          , A.PRC_MSG_RPLN_NEW_IND                               08972810
089664*          , B.BUS_AREA_ID                                        08972910
089665*          , B.BUS_AREA_DESC                                      08973010
089666*          , 9999999999                                           08973110
089667*          , 'UNKNOWN'                                            08973210
089668*     FROM SUT_PGM_MDSE_SUM   A                                   08973310
089669*        , XLT_BUS_AREA   B                                       08973410
089670*        WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                08973510
089672*          AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    08973610
089673*          AND  NOT EXISTS (SELECT *                              08973710
089674*                             FROM XLT_MDSE_PGM  X                08973810
089675*                            WHERE A.MDSE_PGM_ID = X.MDSE_PGM_ID) 08973910
089676*        ORDER BY 4 DESC                                          08974010
089677*               , 12                                              08974110
089679*                                                                 08974210
089680*    END-EXEC.                                                    08974310
                                                                        08974407
      *CLP 07/07/2015 START                                             08974507
089629******************************************************************08974602
089630* BUSAREA UNIT CURSOR BRINGS BACK ALL MERCHANDISE PGMS FOR AN AREA08974702
089631* SELECTED ON BUSAREA SCREEN IN UNIT SEQUENCE                     08974802
089631* WITH XLT_BRND AND SUT_BRND_MDSE_PGM                             08974903
089632******************************************************************08975002
089633                                                                  08975102
089634     EXEC SQL                                                     08975202
089635         DECLARE TRLR-UNIT-BRND-CSR CURSOR FOR                    08975302
089636      SELECT A.TRIP_OCRNC_ID                                      08975402
089637           , A.BUS_AREA_ID                                        08975502
089638           , A.BRND_ID                                            08975602
089639           , A.UNT_QTY                                            08975702
089640           , A.SKU_QTY                                            08975802
089641           , A.CART_QTY                                           08975902
089642           , A.RTL_DOL_AMT                                        08976002
089643           , A.COST_DOL_AMT                                       08976102
046523           , A.HNG_FOLD_CDE                                       08976202
046523           , A.PRC_MSG_RPLN_NEW_IND                               08976302
089644           , B.BUS_AREA_ID                                        08976402
089645           , B.BUS_AREA_DESC                                      08976502
089646           , C.BRND_ID                                            08976602
089647           , C.BRND_DESC                                          08976702
089648      FROM SUT_BRND_MDSE_SUM   A                                  08976803
089649         , XLT_BUS_AREA   B                                       08976902
089650         , XLT_BRND       C                                       08977002
089651      WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   08977102
089653        AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       08977202
089654        AND C.BRND_ID   = A.BRND_ID                               08977302
089655      UNION ALL                                                   08977402
089656      SELECT A.TRIP_OCRNC_ID                                      08977502
089657           , A.BUS_AREA_ID                                        08977602
089658           , A.BRND_ID                                            08977702
089659           , A.UNT_QTY                                            08977802
089660           , A.SKU_QTY                                            08977902
089661           , A.CART_QTY                                           08978002
089662           , A.RTL_DOL_AMT                                        08978102
089663           , A.COST_DOL_AMT                                       08978202
046523           , A.HNG_FOLD_CDE                                       08978302
046523           , A.PRC_MSG_RPLN_NEW_IND                               08978402
089664           , B.BUS_AREA_ID                                        08978502
089665           , B.BUS_AREA_DESC                                      08978602
089666           , 32767                                                08978708
089667           , 'UNKNOWN'                                            08978802
089668      FROM SUT_BRND_MDSE_SUM   A                                  08978902
089669         , XLT_BUS_AREA   B                                       08979002
089670         WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                08979102
089672           AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    08979202
089673           AND  NOT EXISTS (SELECT *                              08979302
089674                              FROM XLT_BRND  X                    08979402
089675                             WHERE A.BRND_ID = X.BRND_ID)         08979502
089676         ORDER BY 4 DESC                                          08979602
089677                , 12                                              08979702
089679                                                                  08979802
089680     END-EXEC.                                                    08979902
                                                                        08980007
      *CLP 07/07/2015 END                                               08980107
089681******************************************************************08980202
089682* BUSAREA AREA CURSOR BRINGS BACK ALL MERCHANDISE PGMS FOR AN AREA08980302
089683* SELECTED ON BUSAREA SCREEN IN AREA SEQUENCE                     08980402
089683* WITH XLT_MDSE_PGM AND SUT_PGM_MDSE_SUM                          08980503
089684******************************************************************08980602
089685*                                                                 08980710
089686*    EXEC SQL                                                     08980810
089687*        DECLARE BUS-AREA-CSR CURSOR FOR                          08980910
089688*     SELECT A.TRIP_OCRNC_ID                                      08981010
089689*          , A.BUS_AREA_ID                                        08981110
089690*          , A.MDSE_PGM_ID                                        08981210
089691*          , A.UNT_QTY                                            08981310
089692*          , A.SKU_QTY                                            08981410
089693*          , A.CART_QTY                                           08981510
089694*          , A.RTL_DOL_AMT                                        08981610
089695*          , A.COST_DOL_AMT                                       08981710
046523*          , A.HNG_FOLD_CDE                                       08981810
046523*          , A.PRC_MSG_RPLN_NEW_IND                               08981910
089696*          , B.BUS_AREA_ID                                        08982010
089697*          , B.BUS_AREA_DESC                                      08982110
089698*          , C.MDSE_PGM_ID                                        08982210
089699*          , C.MDSE_PGM_DESC                                      08982310
089700*     FROM SUT_PGM_MDSE_SUM   A                                   08982410
089701*        , XLT_BUS_AREA   B                                       08982510
089702*        , XLT_MDSE_PGM   C                                       08982610
089703*     WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   08982710
089704*       AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                     08982810
089705*       AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       08982910
089706*       AND C.MDSE_PGM_ID   = A.MDSE_PGM_ID                       08983010
089707*     UNION ALL                                                   08983110
089708*     SELECT A.TRIP_OCRNC_ID                                      08983210
089709*          , A.BUS_AREA_ID                                        08983310
089710*          , A.MDSE_PGM_ID                                        08983410
089711*          , A.UNT_QTY                                            08983510
089712*          , A.SKU_QTY                                            08983610
089713*          , A.CART_QTY                                           08983710
089714*          , A.RTL_DOL_AMT                                        08983810
089715*          , A.COST_DOL_AMT                                       08983910
046523*          , A.HNG_FOLD_CDE                                       08984010
046523*          , A.PRC_MSG_RPLN_NEW_IND                               08984110
089716*          , B.BUS_AREA_ID                                        08984210
089717*          , B.BUS_AREA_DESC                                      08984310
089718*          , 9999999999                                           08984410
089719*          , 'UNKNOWN'                                            08984510
089720*     FROM SUT_PGM_MDSE_SUM   A                                   08984610
089721*        , XLT_BUS_AREA   B                                       08984710
089722*        WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                08984810
089723*          AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                  08984910
089724*          AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    08985010
089725*          AND  NOT EXISTS (SELECT *                              08985110
089726*                             FROM XLT_MDSE_PGM  X                08985210
089727*                            WHERE A.MDSE_PGM_ID = X.MDSE_PGM_ID) 08985310
089728*        ORDER BY 12                                              08985410
089729*               , 14                                              08985510
089730*                                                                 08985610
089731*    END-EXEC.                                                    08985710
                                                                        08985807
      *CLP 07/07/2015 START                                             08985907
089681******************************************************************08986002
089682* BUSAREA AREA CURSOR BRINGS BACK ALL MERCHANDISE PGMS FOR AN AREA08986102
089683* SELECTED ON BUSAREA SCREEN IN AREA SEQUENCE                     08986202
089683* WITH XLT_BRND AND SUT_BRND_MDSE_SUM                             08986303
089684******************************************************************08986402
089685                                                                  08986502
089686     EXEC SQL                                                     08986602
089687         DECLARE BUS-AREA-B-CSR CURSOR FOR                        08986702
089688      SELECT A.TRIP_OCRNC_ID                                      08986802
089689           , A.BUS_AREA_ID                                        08986902
089690           , A.BRND_ID                                            08987002
089691           , A.UNT_QTY                                            08987102
089692           , A.SKU_QTY                                            08987202
089693           , A.CART_QTY                                           08987302
089694           , A.RTL_DOL_AMT                                        08987402
089695           , A.COST_DOL_AMT                                       08987502
046523           , A.HNG_FOLD_CDE                                       08987602
046523           , A.PRC_MSG_RPLN_NEW_IND                               08987702
089696           , B.BUS_AREA_ID                                        08987802
089697           , B.BUS_AREA_DESC                                      08987902
089698           , C.BRND_ID                                            08988002
089699           , C.BRND_DESC                                          08988102
089700      FROM SUT_BRND_MDSE_SUM   A                                  08988202
089701         , XLT_BUS_AREA   B                                       08988302
089702         , XLT_BRND       C                                       08988402
089703      WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   08988502
089704        AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                     08988602
089705        AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       08988702
089706        AND C.BRND_ID   = A.BRND_ID                               08988802
089707      UNION ALL                                                   08988902
089708      SELECT A.TRIP_OCRNC_ID                                      08989002
089709           , A.BUS_AREA_ID                                        08989102
089710           , A.BRND_ID                                            08989202
089711           , A.UNT_QTY                                            08989302
089712           , A.SKU_QTY                                            08989402
089713           , A.CART_QTY                                           08989502
089714           , A.RTL_DOL_AMT                                        08989602
089715           , A.COST_DOL_AMT                                       08989702
046523           , A.HNG_FOLD_CDE                                       08989802
046523           , A.PRC_MSG_RPLN_NEW_IND                               08989902
089716           , B.BUS_AREA_ID                                        08990002
089717           , B.BUS_AREA_DESC                                      08990102
089718           , 32767                                                08990208
089719           , 'UNKNOWN'                                            08990302
089720      FROM SUT_BRND_MDSE_SUM   A                                  08990402
089721         , XLT_BUS_AREA   B                                       08990502
089722         WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                08990602
089723           AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                  08990702
089724           AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    08990802
089725           AND  NOT EXISTS (SELECT *                              08990902
089726                              FROM XLT_BRND  X                    08991002
089727                             WHERE A.BRND_ID = X.BRND_ID)         08991102
089728         ORDER BY 12                                              08991202
089729                , 14                                              08991302
089730                                                                  08991402
089731     END-EXEC.                                                    08991502
      *CLP 07/07/2015 END                                               08991607
                                                                        08991707
089732******************************************************************08991802
089733* BUSAREA UNIT CURSOR BRINGS BACK ALL MERCHANDISE PGMS FOR AN AREA08991902
089734* SELECTED ON BUSAREA SCREEN IN UNIT SEQUENCE                     08992002
089734* WITH XLT_MDSE_PGM AND SUT_PGM_MDSE_SUM                          08992103
089735******************************************************************08992202
089736*                                                                 08992310
089737*    EXEC SQL                                                     08992410
089738*        DECLARE BUS-UNIT-CSR CURSOR FOR                          08992510
089739*     SELECT A.TRIP_OCRNC_ID                                      08992610
089740*          , A.BUS_AREA_ID                                        08992710
089741*          , A.MDSE_PGM_ID                                        08992810
089742*          , A.UNT_QTY                                            08992910
089743*          , A.SKU_QTY                                            08993010
089744*          , A.CART_QTY                                           08993110
089745*          , A.RTL_DOL_AMT                                        08993210
089746*          , A.COST_DOL_AMT                                       08993310
046523*          , A.HNG_FOLD_CDE                                       08993410
046523*          , A.PRC_MSG_RPLN_NEW_IND                               08993510
089747*          , B.BUS_AREA_ID                                        08993610
089748*          , B.BUS_AREA_DESC                                      08993710
089749*          , C.MDSE_PGM_ID                                        08993810
089750*          , C.MDSE_PGM_DESC                                      08993910
089751*     FROM SUT_PGM_MDSE_SUM   A                                   08994010
089752*        , XLT_BUS_AREA   B                                       08994110
089753*        , XLT_MDSE_PGM   C                                       08994210
089754*     WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   08994310
089755*       AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                     08994410
089756*       AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       08994510
089757*       AND C.MDSE_PGM_ID   = A.MDSE_PGM_ID                       08994610
089758*     UNION ALL                                                   08994710
089759*     SELECT A.TRIP_OCRNC_ID                                      08994810
089760*          , A.BUS_AREA_ID                                        08994910
089761*          , A.MDSE_PGM_ID                                        08995010
089762*          , A.UNT_QTY                                            08995110
089763*          , A.SKU_QTY                                            08995210
089764*          , A.CART_QTY                                           08995310
089765*          , A.RTL_DOL_AMT                                        08995410
089766*          , A.COST_DOL_AMT                                       08995510
046523*          , A.HNG_FOLD_CDE                                       08995610
046523*          , A.PRC_MSG_RPLN_NEW_IND                               08995710
089767*          , B.BUS_AREA_ID                                        08995810
089768*          , B.BUS_AREA_DESC                                      08995910
089769*          , 9999999999                                           08996010
089770*          , 'UNKNOWN'                                            08996110
089771*     FROM SUT_PGM_MDSE_SUM   A                                   08996210
089772*        , XLT_BUS_AREA   B                                       08996310
089773*        WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                08996410
089774*          AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                  08996510
089775*          AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    08996610
089776*          AND  NOT EXISTS (SELECT *                              08996710
089777*                             FROM XLT_MDSE_PGM  X                08996810
089778*                            WHERE A.MDSE_PGM_ID = X.MDSE_PGM_ID) 08996910
089779*        ORDER BY 4 DESC                                          08997010
089780*               , 12                                              08997110
089781*               , 14                                              08997210
089782*                                                                 08997310
089783*    END-EXEC.                                                    08997410
                                                                        08997507
      *CLP 07/07/2015 START                                             08997607
089732******************************************************************08997702
089733* BUSAREA UNIT CURSOR BRINGS BACK ALL MERCHANDISE PGMS FOR AN AREA08997802
089734* SELECTED ON BUSAREA SCREEN IN UNIT SEQUENCE                     08997902
089734* WITH XLT_BRND AND SUT_BRND_MDSE_SUM                             08998003
089735******************************************************************08998102
089736                                                                  08998202
089737     EXEC SQL                                                     08998302
089738         DECLARE BUS-UNIT-B-CSR CURSOR FOR                        08998402
089739      SELECT A.TRIP_OCRNC_ID                                      08998502
089740           , A.BUS_AREA_ID                                        08998602
089741           , A.BRND_ID                                            08998702
089742           , A.UNT_QTY                                            08998802
089743           , A.SKU_QTY                                            08998902
089744           , A.CART_QTY                                           08999002
089745           , A.RTL_DOL_AMT                                        08999102
089746           , A.COST_DOL_AMT                                       08999202
046523           , A.HNG_FOLD_CDE                                       08999302
046523           , A.PRC_MSG_RPLN_NEW_IND                               08999402
089747           , B.BUS_AREA_ID                                        08999502
089748           , B.BUS_AREA_DESC                                      08999602
089749           , C.BRND_ID                                            08999702
089750           , C.BRND_DESC                                          08999802
089751      FROM SUT_BRND_MDSE_SUM   A                                  08999902
089752         , XLT_BUS_AREA   B                                       09000002
089753         , XLT_BRND       C                                       09000102
089754      WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   09000202
089755        AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                     09000302
089756        AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       09000402
089757        AND C.BRND_ID   = A.BRND_ID                               09000502
089758      UNION ALL                                                   09000602
089759      SELECT A.TRIP_OCRNC_ID                                      09000702
089760           , A.BUS_AREA_ID                                        09000802
089761           , A.BRND_ID                                            09000902
089762           , A.UNT_QTY                                            09001002
089763           , A.SKU_QTY                                            09001102
089764           , A.CART_QTY                                           09001202
089765           , A.RTL_DOL_AMT                                        09001302
089766           , A.COST_DOL_AMT                                       09001402
046523           , A.HNG_FOLD_CDE                                       09001502
046523           , A.PRC_MSG_RPLN_NEW_IND                               09001602
089767           , B.BUS_AREA_ID                                        09001702
089768           , B.BUS_AREA_DESC                                      09001802
089769           , 32767                                                09001908
089770           , 'UNKNOWN'                                            09002002
089771      FROM SUT_BRND_MDSE_SUM   A                                  09002102
089772         , XLT_BUS_AREA   B                                       09002202
089773         WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                09002302
089774           AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                  09002402
089775           AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    09002502
089776           AND  NOT EXISTS (SELECT *                              09002602
089777                              FROM XLT_BRND  X                    09002702
089778                             WHERE A.BRND_ID = X.BRND_ID)         09002802
089779         ORDER BY 4 DESC                                          09002902
089780                , 12                                              09003002
089781                , 14                                              09003102
089782                                                                  09003202
089783     END-EXEC.                                                    09003302
      *CLP 07/07/2015 END                                               09003407
089790/                                                                 09004000
089800******************************************************************09010000
105300     COPY DPWS276.                                                10530000
105400                                                                  10540000
105600   EJECT                                                          10560000
105700******************************************************************10570000
105800 LINKAGE SECTION.                                                 10580000
105900******************************************************************10590000
106000                                                                  10600000
106100 01  DFHCOMMAREA                      PIC X(400).                 10610000
106200     EJECT                                                        10620000
106210                                                                  10621000
106300******************************************************************10630000
106400 PROCEDURE DIVISION.                                              10640000
106500******************************************************************10650000
106510                                                                  10651000
106600     PERFORM 1000-INITIALIZE.                                     10660000
106610                                                                  10661000
      *    THIS PROCESSES THE ROWS OFF THE SUT_PGM_MDSE_SUM TABLE       10661102
106611*    PERFORM 2000-PROCESS                                         10661210
106612*            UNTIL PS-END-OF-CSR.                                 10661310
106641*                                                                 10664110
106645*    PERFORM 4020-CLOSE-CURSOR.                                   10664510
106647                                                                  10664700
      *CLP 07/07/2015 START                                             10664802
      *    THIS PROCESSES THE ROWS OFF THE SUT_BRND_MDSE_SUM TABLE      10664902
                                                                        10665002
           SET PS-END-OF-CSR-NO TO TRUE.                                10665102
           PERFORM 4011-OPEN-CURSOR.                                    10665202
                                                                        10665302
109210     IF PS-END-OF-CSR                                             10665402
109300        PERFORM 4021-CLOSE-CURSOR                                 10665502
           ELSE                                                         10665602
106611        PERFORM 2001-PROCESS                                      10665702
106612                 UNTIL PS-END-OF-CSR                              10665802
106645        PERFORM 4021-CLOSE-CURSOR                                 10665902
117640     END-IF.                                                      10666002
                                                                        10666102
      *CLP 07/07/2015 END                                               10666502
                                                                        10666602
106648*    CLOSE PRINTER                                                10666700
106649     MOVE PC-TERM                     TO DRS01-DRRB-FUNC          10666800
106650     PERFORM 8000-LINK-TO-DRS.                                    10666900
106651                                                                  10667000
106652 0000-GOBACK.                                                     10667100
106653                                                                  10667200
106656     GOBACK.                                                      10667300
106657/                                                                 10667400
106658******************************************************************10668000
106700 1000-INITIALIZE.                                                 10670000
106800     MOVE LENGTH OF SU083-COMM-AREA                               10680000
106810                                         TO PV-COMMAREA-LENGTH    10681000
107100                                                                  10710000
107200     EXEC CICS                                                    10720000
107300         RETRIEVE                                                 10730000
107400             INTO (SU083-COMM-AREA)                               10740000
107500             LENGTH (PV-COMMAREA-LENGTH)                          10750000
107600     END-EXEC                                                     10760000
107700                                                                  10770000
107800     EVALUATE TRUE                                                10780000
107900         WHEN PV-CICS-RESP     = DFHRESP (NORMAL)                 10790000
108000             CONTINUE                                             10800000
108100         WHEN OTHER                                               10810000
108200             MOVE '1000-INITIALIZE' TO DP013-PARAGRAPH            10820000
108300             MOVE 'UNABLE TO RETRIEVE DATA'                       10830000
108400                                      TO DP013-MESSAGE-TEXT (1)   10840000
108500             SET DP013-CICS-ABEND                                 10850000
108600                 DP013-NO-ROLLBACK    TO TRUE                     10860000
108800     END-EVALUATE.                                                10880000
108900                                                                  10890000
108910     EXEC SQL                                                     10891000
108920         SELECT                                                   10892000
108930         CHAR ( DATE (CURRENT TIMESTAMP),USA)                     10893000
108940     ,   CHAR ( TIME (CURRENT TIMESTAMP),JIS)                     10894000
108950     INTO                                                         10895000
108960         :PV-RUN-DATE                                             10896000
108970     ,   :PV-RUN-TIME                                             10897000
108980         FROM SYSIBM.SYSDUMMY1                                    10898000
108990     END-EXEC                                                     10899000
108991                                                                  10899100
108992     MOVE PV-RUN-DATE                 TO DP132-RUN-DATE           10899200
108993     MOVE PV-RUN-TIME                 TO DP132-RUN-TIME           10899300
108994                                                                  10899400
108995     MOVE 'SUKCS547'                  TO DP132-PROGRAM-NAME.      10899500
108996     MOVE 1                           TO DP132-REPORT-NUMBER.     10899600
108997                                                                  10899700
108998*    OPEN PRINTER                                                 10899800
108999     MOVE 'A'                         TO DRS02-DRIB-CLASS         10899900
109000     MOVE 'N'                         TO DRS02-DRIB-HOLD          10900000
109010     MOVE SU083-PRINTER-ID            TO DRS02-DRIB-DEST          10901000
109020     MOVE PC-INIT                     TO DRS01-DRRB-FUNC.         10902000
109030     MOVE DRS02-DRIB-HEADER           TO DRS01-COMM-DRIB-HDR.     10903000
109040     MOVE DRS02-DRIB-ATTRIB           TO DRS01-COMM-DRIB-AT1.     10904000
109050     PERFORM 8000-LINK-TO-DRS.                                    10905000
109060                                                                  10906000
109070     MOVE 1                           TO PV-PAGE-COUNT            10907000
109071     PERFORM 1101-SCREEN-SEQUENCE.                                10907100
109080     PERFORM 2200-BUILD-HEADINGS.                                 10908000
109090                                                                  10909000
109091     PERFORM 8100-PRINT-HEADINGS.                                 10909100
109092                                                                  10909200
109093*    OPEN  CURSOR                                                 10909300
109094                                                                  10909400
109095     MOVE SU083-TRIP-OCRNC-ID      TO DK-TRIP-OCRNC-ID.           10909500
109096                                                                  10909600
109097     IF SU083-BUS-AREA-ID  >  0                                   10909700
109098        MOVE SU083-BUS-AREA-ID     TO DK-BUS-AREA-ID              10909800
109099        SET PS-BUSAREA-CSR         TO TRUE                        10909900
109100     ELSE                                                         10910000
109101        SET PS-BUSAREA-CSR-NO      TO TRUE                        10910100
109110     END-IF.                                                      10911000
109120                                                                  10912000
109200*    PERFORM 4010-OPEN-CURSOR.                                    10920010
109201                                                                  10920100
109210*    IF PS-END-OF-CSR                                             10921010
109300*       PERFORM 4020-CLOSE-CURSOR                                 10930010
117640*    END-IF.                                                      11764010
117658/                                                                 11765800
117659******************************************************************11765900
117660 1101-SCREEN-SEQUENCE.                                            11766000
117661                                                                  11766100
117662     EVALUATE TRUE                                                11766200
117670         WHEN SU083-AREA-SEQ                                      11767000
117680             MOVE 'AREA SEQUENCE'       TO PV-SEQ-DESC            11768000
117690                                                                  11769000
117700         WHEN SU083-UNIT-SEQ                                      11770000
117800             MOVE 'UNIT SEQUENCE'       TO PV-SEQ-DESC            11780000
117900     END-EVALUATE.                                                11790000
118000                                                                  11800000
140500******************************************************************14050000
140600*  2000-PROCESS - THIS IS THE MAIN PARAGRAPH FOR PRINTING         14060000
140600*                 MDSE PGM                                        14070004
140800******************************************************************14080000
140900*2000-PROCESS.                                                    14090010
145600*                                                                 14560000
145700*    IF PV-LINE-COUNT > 60                                        14570010
145800*        ADD 1                        TO PV-PAGE-COUNT            14580010
145801*        PERFORM 8100-PRINT-HEADINGS                              14580110
145802*    END-IF.                                                      14580210
145803*                                                                 14580310
145804*    PERFORM 4310-FETCH.                                          14580410
145805*                                                                 14580510
145806*    IF PS-END-OF-CSR-NO                                          14580610
145807*       PERFORM 2100-BUILD-DETAIL                                 14580710
145808*       PERFORM 4000-PRINT-DETAIL-LINE                            14580810
145809*    END-IF.                                                      14580910
145814                                                                  14581400
      *CLP 07/07/2015 START                                             14581502
140500******************************************************************14581602
140600*  2001-PROCESS - THIS IS THE MAIN PARAGRAPH FOR PRINTING         14581702
140600*                 BRAND                                           14581804
140800******************************************************************14581904
140900 2001-PROCESS.                                                    14582004
145600*                                                                 14582104
145700     IF PV-LINE-COUNT > 60                                        14582204
145800         ADD 1                        TO PV-PAGE-COUNT            14583002
145801         PERFORM 8100-PRINT-HEADINGS                              14584005
145802     END-IF.                                                      14585002
145803                                                                  14586002
145804     PERFORM 4311-FETCH.                                          14587002
145805                                                                  14588002
145806     IF PS-END-OF-CSR-NO                                          14589002
145807        PERFORM 2101-BUILD-DETAIL                                 14590004
145808        PERFORM 4000-PRINT-DETAIL-LINE                            14600006
145809     END-IF.                                                      14610002
      *CLP 07/07/2015 END                                               14620002
160801******************************************************************16080100
160802*2100-BUILD-DETAIL.                                               16080210
160803*                                                                 16080310
160810*    MOVE XLT00000-BUS-AREA-DESC   TO DL1-BUS-AREA.               16081010
160830*    MOVE XLT00040-MDSE-PGM-DESC   TO DL1-MDSE-DESC.              16083010
160840*    MOVE SUT00096-CART-QTY        TO DL1-CARTONS.                16084010
160850*    MOVE SUT00096-UNT-QTY         TO DL1-UNITS.                  16085010
160870*    MOVE SUT00096-PRC-MSG-RPLN-NEW-IND                           16086010
      *                                  TO DL1-NEW-IND.                16086110
160870*    MOVE SUT00096-SKU-QTY         TO DL1-SKU-CNT.                16087010
160870*    MOVE SUT00096-HNG-FOLD-CDE(1:1)                              16088010
      *                                  TO DL1-HANG-FOLD-CDE.          16089011
      *CLP 07/07/2015 START                                             16089102
160802 2101-BUILD-DETAIL.                                               16090002
160803                                                                  16100002
160810     MOVE XLT00000-BUS-AREA-DESC   TO DL1-BUS-AREA.               16110002
160830     MOVE XLT00043-BRND-DESC       TO DL1-MDSE-DESC.              16120002
160840     MOVE SUT00066-CART-QTY        TO DL1-CARTONS.                16130007
160850     MOVE SUT00066-UNT-QTY         TO DL1-UNITS.                  16140007
           IF SUT00066-PRC-MSG-RPLN-NEW-IND = 'Y'                       16140107
160870         MOVE SUT00066-PRC-MSG-RPLN-NEW-IND                       16141007
                                         TO DL1-NEW-IND                 16141107
           ELSE                                                         16141207
160870         MOVE SPACE                TO DL1-NEW-IND                 16141307
           END-IF.                                                      16141407
160870     MOVE SUT00066-SKU-QTY         TO DL1-SKU-CNT.                16141507
160870     MOVE SUT00066-HNG-FOLD-CDE(1:1)                              16141607
                                         TO DL1-HANG-FOLD-CDE.          16141702
      *CLP 07/07/2015 END                                               16141802
161420/                                                                 16142000
161421******************************************************************16142100
161422 2200-BUILD-HEADINGS.                                             16142200
161427                                                                  16142700
161428     MOVE SU083-STR-NBR            TO HL2-STORE-NBR.              16142800
161429     MOVE SU083-STR-NAME           TO HL2-STORE-NAME.             16142900
161430     MOVE SU083-TRLR-SRL-NBR       TO HL3-TRAILER-SERIAL.         16143000
161431     MOVE SU083-TRLR-STATUS        TO HL3-CURRENT-STATUS.         16143100
161432     MOVE SU083-SCAC               TO HL4-SCAC.                   16143200
161434     MOVE SU083-TRLR-ID            TO HL4-TRAILER-ID.             16143400
161435     MOVE SU083-SERVICING-DC       TO HL4-SERVICING-DC.           16143500
161436     MOVE SU083-TOTAL-CTNS         TO HL5-TOTAL-CARTONS.          16143600
161439     MOVE SU083-SUMMARY-DATE       TO HL5-SUMMARY-DATE.           16143900
161440     MOVE SU083-SUMMARY-TIME       TO HL5-SUMMARY-TIME.           16144000
161441     MOVE SU083-TOTAL-UNITS        TO HL6-TOTAL-UNITS.            16144100
161443     MOVE PV-SEQ-DESC              TO HL7-SEQUENCE-DESC.          16144300
161444/                                                                 16144400
161452******************************************************************16145200
161453*  WRITE THE DATA TO THE DETAIL AND HEADING LINES VIA DRS.        16145300
161453*  FOR MDSE PGM OR BRAND                                          16145406
161454******************************************************************16145504
161455 4000-PRINT-DETAIL-LINE.                                          16145604
161456                                                                  16145704
161457     IF PV-LINE-COUNT > 60                                        16145804
161458         ADD 1                        TO PV-PAGE-COUNT            16145904
161459         PERFORM 8100-PRINT-HEADINGS                              16146004
161460     END-IF                                                       16146104
161461                                                                  16146204
161462     MOVE PC-SINGLE-SPACE             TO  DRS01-COMM-CTL          16146304
161463     MOVE DL1-DETAIL-LINE             TO  DRS01-COMM-DATA.        16146404
161464     PERFORM 8000-LINK-TO-DRS.                                    16146504
161465     ADD 1                            TO PV-LINE-COUNT.           16146604
161466                                                                  16146704
161467******************************************************************16148404
161468*4010-OPEN-CURSOR.                                                16148510
161469*                                                                 16148610
161470*    EVALUATE TRUE                                                16148710
161471*        WHEN PS-BUSAREA-CSR-NO                                   16148810
161472*            EVALUATE TRUE                                        16148910
161473*            WHEN SU083-AREA-SEQ                                  16149010
161474*                MOVE 'CURSOR:  TRLR AREA CSR'                    16149110
161475*                                   TO DP013-MESSAGE-TEXT (2)     16149210
161476*                EXEC SQL                                         16149310
161477*                   OPEN TRLR-AREA-CSR                            16149410
161478*                END-EXEC                                         16149510
161479*                                                                 16149610
161480*            WHEN SU083-UNIT-SEQ                                  16149710
161481*                MOVE 'CURSOR:  TRLR UNIT CSR'                    16149810
161482*                                   TO DP013-MESSAGE-TEXT (2)     16149910
161483*                EXEC SQL                                         16150010
161484*                   OPEN TRLR-UNIT-CSR                            16150110
161485*                END-EXEC                                         16150210
161486*                                                                 16150310
161487*            END-EVALUATE                                         16150410
161488*                                                                 16150510
161489*        WHEN PS-BUSAREA-CSR                                      16150610
161490*            EVALUATE TRUE                                        16150710
161491*            WHEN SU083-AREA-SEQ                                  16150810
161492*                MOVE 'CURSOR:  BUS AREA CSR'                     16150910
161493*                                   TO DP013-MESSAGE-TEXT (2)     16151010
161494*                EXEC SQL                                         16151110
161495*                   OPEN BUS-AREA-CSR                             16151210
161496*                END-EXEC                                         16151310
161497*                                                                 16151410
161498*            WHEN SU083-UNIT-SEQ                                  16151510
161499*                MOVE 'CURSOR:  BUS UNIT CSR'                     16151610
161500*                                   TO DP013-MESSAGE-TEXT (2)     16151710
161501*                EXEC SQL                                         16151810
161502*                   OPEN BUS-UNIT-CSR                             16151910
161503*                END-EXEC                                         16152010
161504*                                                                 16152110
161505*            END-EVALUATE                                         16152210
161506*    END-EVALUATE                                                 16152310
161507*                                                                 16152410
161508*    EVALUATE TRUE                                                16152510
161509*        WHEN SQLCODE = ZERO                                      16152610
161510*            CONTINUE                                             16152710
161511*        WHEN SQLWARN0 NOT = SPACES                               16152810
161512*        WHEN SQLCODE < ZERO                                      16152910
161513*        WHEN SQLCODE > ZERO                                      16153010
161514*            MOVE '4010-OPEN-CURSOR'                              16153110
161515*                                  TO DP013-PARAGRAPH             16153210
161516*            MOVE 'OPEN CURSOR - '                                16153310
161517*                                  TO DP013-MESSAGE-TEXT (1)      16153410
161518*            MOVE SQLCA        TO DP013-SQLCA                     16153510
161519*            MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        16153610
161520*            MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)        16153710
161521*            SET DP013-DB2-ABEND                                  16153810
161522*                DP013-XCTL-DISPLAY-RESTART TO TRUE               16153910
161523*            PERFORM DP013-0000-PROCESS-ABEND                     16154010
161524*    END-EVALUATE.                                                16154110
161467******************************************************************16154204
      *CLP 07/07/2015 START                                             16154304
161468 4011-OPEN-CURSOR.                                                16154404
161469                                                                  16154504
161470     EVALUATE TRUE                                                16154604
161471         WHEN PS-BUSAREA-CSR-NO                                   16154704
161472             EVALUATE TRUE                                        16154804
161473             WHEN SU083-AREA-SEQ                                  16154904
161474                 MOVE 'CURSOR: TRLR AREA B CSR'                   16155004
161475                                    TO DP013-MESSAGE-TEXT (2)     16155104
161476                 EXEC SQL                                         16155204
161477                    OPEN TRLR-AREA-B-CSR                          16155304
161478                 END-EXEC                                         16155404
161479                                                                  16155504
161480             WHEN SU083-UNIT-SEQ                                  16155604
161481                 MOVE 'CURSOR: TRLR UNIT BRND CSR'                16155704
161482                                    TO DP013-MESSAGE-TEXT (2)     16155804
161483                 EXEC SQL                                         16155904
161484                    OPEN TRLR-UNIT-BRND-CSR                       16156004
161485                 END-EXEC                                         16156104
161486                                                                  16156204
161487             END-EVALUATE                                         16156304
161488                                                                  16156404
161489         WHEN PS-BUSAREA-CSR                                      16156504
161490             EVALUATE TRUE                                        16156604
161491             WHEN SU083-AREA-SEQ                                  16156704
161492                 MOVE 'CURSOR: BUS AREA B CSR'                    16156804
161493                                    TO DP013-MESSAGE-TEXT (2)     16156904
161494                 EXEC SQL                                         16157004
161495                    OPEN BUS-AREA-B-CSR                           16157104
161496                 END-EXEC                                         16157204
161497                                                                  16157304
161498             WHEN SU083-UNIT-SEQ                                  16157404
161499                 MOVE 'CURSOR:  BUS UNIT B CSR'                   16157504
161500                                    TO DP013-MESSAGE-TEXT (2)     16157604
161501                 EXEC SQL                                         16157704
161502                    OPEN BUS-UNIT-B-CSR                           16157804
161503                 END-EXEC                                         16157904
161504                                                                  16158004
161505             END-EVALUATE                                         16158104
161506     END-EVALUATE                                                 16158204
161507                                                                  16158304
161508     EVALUATE TRUE                                                16158404
161509         WHEN SQLCODE = ZERO                                      16158504
161510             CONTINUE                                             16158604
161511         WHEN SQLWARN0 NOT = SPACES                               16158704
161512         WHEN SQLCODE < ZERO                                      16158804
161513         WHEN SQLCODE > ZERO                                      16158904
161514             MOVE '4011-OPEN-CURSOR'                              16159004
161515                                   TO DP013-PARAGRAPH             16159104
161516             MOVE 'OPEN CURSOR - '                                16159204
161517                                   TO DP013-MESSAGE-TEXT (1)      16159304
161518             MOVE SQLCA        TO DP013-SQLCA                     16159404
161519             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        16159504
161520             MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)        16159604
161521             SET DP013-DB2-ABEND                                  16159704
161522                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16159804
161523             PERFORM DP013-0000-PROCESS-ABEND                     16159904
161524     END-EVALUATE.                                                16160004
      *CLP 07/07/2015 END                                               16160104
161525/                                                                 16160204
161526*4020-CLOSE-CURSOR.                                               16160310
161527*                                                                 16160410
161528*    EVALUATE TRUE                                                16160510
161529*       WHEN PS-BUSAREA-CSR-NO                                    16160610
161530*          EVALUATE TRUE                                          16160710
161531*          WHEN SU083-AREA-SEQ                                    16160810
161532*                EXEC SQL                                         16160910
161533*                    CLOSE TRLR-AREA-CSR                          16161010
161534*                END-EXEC                                         16161110
161535*                                                                 16161210
161536*          WHEN SU083-UNIT-SEQ                                    16161310
161537*                EXEC SQL                                         16161410
161538*                    CLOSE TRLR-UNIT-CSR                          16161510
161539*                END-EXEC                                         16161610
161540*                                                                 16161710
161541*          END-EVALUATE                                           16161810
161542*                                                                 16161910
161543*       WHEN PS-BUSAREA-CSR                                       16162010
161544*          EVALUATE TRUE                                          16162110
161545*              WHEN SU083-AREA-SEQ                                16162210
161546*                  EXEC SQL                                       16162310
161547*                      CLOSE BUS-AREA-CSR                         16162410
161548*                  END-EXEC                                       16162510
161549*                                                                 16162610
161550*              WHEN SU083-UNIT-SEQ                                16162710
161551*                  EXEC SQL                                       16162810
161552*                      CLOSE BUS-UNIT-CSR                         16162910
161553*                  END-EXEC                                       16163010
161554*                                                                 16163110
161555*          END-EVALUATE                                           16163210
161556*    END-EVALUATE                                                 16163310
161557*                                                                 16163404
161558*    EVALUATE TRUE                                                16163510
161559*        WHEN SQLCODE = ZERO                                      16163610
161560*            CONTINUE                                             16163710
161561*        WHEN SQLWARN0 NOT = SPACES                               16163810
161562*        WHEN SQLCODE < ZERO                                      16163910
161563*        WHEN SQLCODE > ZERO                                      16164010
161564*            MOVE '4020-CLOSE-CURSOR'                             16164110
161565*                              TO DP013-PARAGRAPH                 16164210
161566*            MOVE 'CLOSE CURSOR '                                 16164310
161567*                              TO DP013-MESSAGE-TEXT (1)          16164410
161568*            MOVE SQLCA        TO DP013-SQLCA                     16164510
161569*            MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        16164610
161570*            SET DP013-DB2-ABEND                                  16164710
161571*                DP013-XCTL-DISPLAY-RESTART TO TRUE               16164810
161572*            PERFORM DP013-0000-PROCESS-ABEND                     16164910
161573*    END-EVALUATE.                                                16165010
161574                                                                  16165104
      *CLP 07/07/2015 START                                             16165204
161526 4021-CLOSE-CURSOR.                                               16165304
161527                                                                  16165404
161528     EVALUATE TRUE                                                16165504
161529        WHEN PS-BUSAREA-CSR-NO                                    16165604
161530           EVALUATE TRUE                                          16165704
161531           WHEN SU083-AREA-SEQ                                    16165804
161532                 EXEC SQL                                         16165904
161533                     CLOSE TRLR-AREA-B-CSR                        16166004
161534                 END-EXEC                                         16166104
161535                                                                  16166204
161536           WHEN SU083-UNIT-SEQ                                    16166304
161537                 EXEC SQL                                         16166404
161538                     CLOSE TRLR-UNIT-BRND-CSR                     16166504
161539                 END-EXEC                                         16166604
161540                                                                  16166704
161541           END-EVALUATE                                           16166804
161542                                                                  16166904
161543        WHEN PS-BUSAREA-CSR                                       16167004
161544           EVALUATE TRUE                                          16167104
161545               WHEN SU083-AREA-SEQ                                16167204
161546                   EXEC SQL                                       16167304
161547                       CLOSE BUS-AREA-B-CSR                       16167404
161548                   END-EXEC                                       16167504
161549                                                                  16167604
161550               WHEN SU083-UNIT-SEQ                                16167704
161551                   EXEC SQL                                       16167804
161552                       CLOSE BUS-UNIT-B-CSR                       16167904
161553                   END-EXEC                                       16168004
161554                                                                  16168104
161555           END-EVALUATE                                           16168204
161556     END-EVALUATE                                                 16168304
161557*                                                                 16168404
161558     EVALUATE TRUE                                                16168504
161559         WHEN SQLCODE = ZERO                                      16168604
161560             CONTINUE                                             16168704
161561         WHEN SQLWARN0 NOT = SPACES                               16168804
161562         WHEN SQLCODE < ZERO                                      16168904
161563         WHEN SQLCODE > ZERO                                      16169004
161564             MOVE '4021-CLOSE-CURSOR'                             16169104
161565                               TO DP013-PARAGRAPH                 16169204
161566             MOVE 'CLOSE CURSOR '                                 16169304
161567                               TO DP013-MESSAGE-TEXT (1)          16169404
161568             MOVE SQLCA        TO DP013-SQLCA                     16169504
161569             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        16169604
161570             SET DP013-DB2-ABEND                                  16169704
161571                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16169804
161572             PERFORM DP013-0000-PROCESS-ABEND                     16169904
161573     END-EVALUATE.                                                16170004
161575 EJECT                                                            16170104
      *CLP 07/07/2015 END                                               16170204
161579*----------------------------------------------------------------*16170304
161580*    FETCH THE BUSAREA CURSOR.                                   *16170404
161581*----------------------------------------------------------------*16170504
161582*4310-FETCH.                                                      16170610
161583*                                                                 16170710
161590*    EVALUATE TRUE                                                16170810
161600*       WHEN PS-BUSAREA-CSR-NO                                    16170910
161610*          EVALUATE TRUE                                          16171010
161622*          WHEN SU083-AREA-SEQ                                    16171110
161623*              EXEC SQL                                           16171210
161624*                  FETCH TRLR-AREA-CSR                            16171310
161625*                   INTO                                          16171410
161626*                    :SUT00096-TRIP-OCRNC-ID                      16171510
161627*                  , :SUT00096-BUS-AREA-ID                        16171610
161628*                  , :SUT00096-MDSE-PGM-ID                        16171710
161629*                  , :SUT00096-UNT-QTY                            16171810
161630*                  , :SUT00096-SKU-QTY                            16171910
161631*                  , :SUT00096-CART-QTY                           16172010
161632*                  , :SUT00096-RTL-DOL-AMT                        16172110
161633*                  , :SUT00096-COST-DOL-AMT                       16172210
221201*                  , :SUT00096-HNG-FOLD-CDE                       16172310
221201*                  , :SUT00096-PRC-MSG-RPLN-NEW-IND               16172410
161634*                  , :XLT00000-BUS-AREA-ID                        16172510
161635*                  , :XLT00000-BUS-AREA-DESC                      16172610
161636*                  , :XLT00040-MDSE-PGM-ID                        16172710
161637*                  , :XLT00040-MDSE-PGM-DESC                      16172810
161638*                                                                 16172910
161639*              END-EXEC                                           16173010
161640*                                                                 16173110
161641*             WHEN SU083-UNIT-SEQ                                 16173210
161642*               EXEC SQL                                          16173310
161643*                 FETCH TRLR-UNIT-CSR                             16173410
161644*                   INTO                                          16173510
161645*                    :SUT00096-TRIP-OCRNC-ID                      16173610
161646*                  , :SUT00096-BUS-AREA-ID                        16173710
161647*                  , :SUT00096-MDSE-PGM-ID                        16173810
161648*                  , :SUT00096-UNT-QTY                            16173910
161649*                  , :SUT00096-SKU-QTY                            16174010
161650*                  , :SUT00096-CART-QTY                           16174110
161651*                  , :SUT00096-RTL-DOL-AMT                        16174210
161652*                  , :SUT00096-COST-DOL-AMT                       16174310
221201*                  , :SUT00096-HNG-FOLD-CDE                       16174410
221201*                  , :SUT00096-PRC-MSG-RPLN-NEW-IND               16174510
161653*                  , :XLT00000-BUS-AREA-ID                        16174610
161654*                  , :XLT00000-BUS-AREA-DESC                      16174710
161655*                  , :XLT00040-MDSE-PGM-ID                        16174810
161656*                  , :XLT00040-MDSE-PGM-DESC                      16174910
161657*                                                                 16175010
161658*             END-EXEC                                            16175110
161659*                                                                 16175210
161660*          END-EVALUATE                                           16175310
161661*                                                                 16175410
161662*       WHEN PS-BUSAREA-CSR                                       16175510
161663*          EVALUATE TRUE                                          16175610
161664*             WHEN SU083-AREA-SEQ                                 16175710
161665*                EXEC SQL                                         16175810
161666*                   FETCH BUS-AREA-CSR                            16175910
161667*                    INTO                                         16176010
161668*                    :SUT00096-TRIP-OCRNC-ID                      16176110
161669*                  , :SUT00096-BUS-AREA-ID                        16176210
161670*                  , :SUT00096-MDSE-PGM-ID                        16176310
161671*                  , :SUT00096-UNT-QTY                            16176410
161672*                  , :SUT00096-SKU-QTY                            16176510
161673*                  , :SUT00096-CART-QTY                           16176610
161674*                  , :SUT00096-RTL-DOL-AMT                        16176710
161675*                  , :SUT00096-COST-DOL-AMT                       16176810
221201*                  , :SUT00096-HNG-FOLD-CDE                       16176910
221201*                  , :SUT00096-PRC-MSG-RPLN-NEW-IND               16177010
161676*                  , :XLT00000-BUS-AREA-ID                        16177110
161677*                  , :XLT00000-BUS-AREA-DESC                      16177210
161678*                  , :XLT00040-MDSE-PGM-ID                        16177310
161679*                  , :XLT00040-MDSE-PGM-DESC                      16177410
161680*                                                                 16177510
161681*                END-EXEC                                         16177610
161682*                                                                 16177710
161683*             WHEN SU083-UNIT-SEQ                                 16177810
161684*                EXEC SQL                                         16177910
161685*                   FETCH BUS-UNIT-CSR                            16178010
161686*                    INTO                                         16178110
161687*                    :SUT00096-TRIP-OCRNC-ID                      16178210
161688*                  , :SUT00096-BUS-AREA-ID                        16178310
161689*                  , :SUT00096-MDSE-PGM-ID                        16178410
161690*                  , :SUT00096-UNT-QTY                            16178510
161691*                  , :SUT00096-SKU-QTY                            16178610
161692*                  , :SUT00096-CART-QTY                           16178710
161693*                  , :SUT00096-RTL-DOL-AMT                        16178810
161694*                  , :SUT00096-COST-DOL-AMT                       16178910
221201*                  , :SUT00096-HNG-FOLD-CDE                       16179010
221201*                  , :SUT00096-PRC-MSG-RPLN-NEW-IND               16179110
161695*                  , :XLT00000-BUS-AREA-ID                        16179210
161696*                  , :XLT00000-BUS-AREA-DESC                      16179310
161697*                  , :XLT00040-MDSE-PGM-ID                        16179410
161698*                  , :XLT00040-MDSE-PGM-DESC                      16179510
161699*                                                                 16179610
161700*                END-EXEC                                         16179710
161701*                                                                 16179810
161702*           END-EVALUATE                                          16179910
161703*    END-EVALUATE                                                 16180010
161704*                                                                 16180104
161705*    EVALUATE TRUE                                                16180210
161706*        WHEN SQLCODE = ZERO                                      16180310
161707*        WHEN SQLCODE = +100                                      16180410
161708*             CONTINUE                                            16180510
161709*        WHEN SQLWARN0 NOT = SPACE                                16180610
161710*        WHEN SQLCODE NOT = ZERO                                  16180710
161711*             MOVE '4310-FETCH-CURSOR'                            16180810
161712*                              TO DP013-PARAGRAPH                 16180910
161713*             MOVE 'FETCH CURSOR'                                 16181010
161714*                              TO DP013-MESSAGE-TEXT (1)          16181110
161715*             MOVE SQLCA       TO DP013-SQLCA                     16181210
161716*             SET DP013-DB2-ABEND                                 16181310
161717*                              TO TRUE                            16181410
161718*             PERFORM DP013-0000-PROCESS-ABEND                    16181510
161719*    END-EVALUATE.                                                16181610
161720*                                                                 16181710
161721*    IF  SQLCODE EQUAL +100                                       16181810
161722*        SET PS-END-OF-CSR       TO TRUE                          16181910
161723*    END-IF.                                                      16182010
161730*                                                                 16182110
      *CLP 07/07/2015 START                                             16182204
161579*----------------------------------------------------------------*16182302
161580*    FETCH THE BUSAREA CURSOR WITH THE XLT_BRND TABLE            *16182402
161581*----------------------------------------------------------------*16183002
161582 4311-FETCH.                                                      16184002
161583                                                                  16185002
161590     EVALUATE TRUE                                                16186002
161600        WHEN PS-BUSAREA-CSR-NO                                    16187002
161610           EVALUATE TRUE                                          16188002
161622           WHEN SU083-AREA-SEQ                                    16189002
161623               EXEC SQL                                           16189102
161624                   FETCH TRLR-AREA-B-CSR                          16189202
161625                    INTO                                          16189302
161626                     :SUT00066-TRIP-OCRNC-ID                      16189407
161627                   , :SUT00066-BUS-AREA-ID                        16189507
161628                   , :SUT00066-BRND-ID                            16189607
161629                   , :SUT00066-UNT-QTY                            16189707
161630                   , :SUT00066-SKU-QTY                            16189807
161631                   , :SUT00066-CART-QTY                           16189907
161632                   , :SUT00066-RTL-DOL-AMT                        16190007
161633                   , :SUT00066-COST-DOL-AMT                       16191007
221201                   , :SUT00066-HNG-FOLD-CDE                       16192007
221201                   , :SUT00066-PRC-MSG-RPLN-NEW-IND               16193007
161634                   , :XLT00000-BUS-AREA-ID                        16194002
161635                   , :XLT00000-BUS-AREA-DESC                      16195002
161636                   , :XLT00043-BRND-ID                            16196002
161637                   , :XLT00043-BRND-DESC                          16197002
161638                                                                  16198002
161639               END-EXEC                                           16199002
161640                                                                  16199102
161641              WHEN SU083-UNIT-SEQ                                 16199202
161642                EXEC SQL                                          16199302
161643                  FETCH TRLR-UNIT-BRND-CSR                        16199402
161644                    INTO                                          16199502
161645                     :SUT00066-TRIP-OCRNC-ID                      16199607
161646                   , :SUT00066-BUS-AREA-ID                        16199707
161647                   , :SUT00066-BRND-ID                            16199807
161648                   , :SUT00066-UNT-QTY                            16199907
161649                   , :SUT00066-SKU-QTY                            16200007
161650                   , :SUT00066-CART-QTY                           16201007
161651                   , :SUT00066-RTL-DOL-AMT                        16202007
161652                   , :SUT00066-COST-DOL-AMT                       16203007
221201                   , :SUT00066-HNG-FOLD-CDE                       16204007
221201                   , :SUT00066-PRC-MSG-RPLN-NEW-IND               16205007
161653                   , :XLT00000-BUS-AREA-ID                        16206002
161654                   , :XLT00000-BUS-AREA-DESC                      16207002
161655                   , :XLT00043-BRND-ID                            16208002
161656                   , :XLT00043-BRND-DESC                          16209002
161657                                                                  16209102
161658              END-EXEC                                            16209202
161659                                                                  16209302
161660           END-EVALUATE                                           16209402
161661                                                                  16209502
161662        WHEN PS-BUSAREA-CSR                                       16209602
161663           EVALUATE TRUE                                          16209702
161664              WHEN SU083-AREA-SEQ                                 16209802
161665                 EXEC SQL                                         16209902
161666                    FETCH BUS-AREA-B-CSR                          16210002
161667                     INTO                                         16211002
161668                     :SUT00066-TRIP-OCRNC-ID                      16212007
161669                   , :SUT00066-BUS-AREA-ID                        16213007
161670                   , :SUT00066-BRND-ID                            16214007
161671                   , :SUT00066-UNT-QTY                            16215007
161672                   , :SUT00066-SKU-QTY                            16216007
161673                   , :SUT00066-CART-QTY                           16217007
161674                   , :SUT00066-RTL-DOL-AMT                        16218007
161675                   , :SUT00066-COST-DOL-AMT                       16219007
221201                   , :SUT00066-HNG-FOLD-CDE                       16219107
221201                   , :SUT00066-PRC-MSG-RPLN-NEW-IND               16219207
161676                   , :XLT00000-BUS-AREA-ID                        16219302
161677                   , :XLT00000-BUS-AREA-DESC                      16219402
161678                   , :XLT00043-BRND-ID                            16219502
161679                   , :XLT00043-BRND-DESC                          16219602
161680                                                                  16219702
161681                 END-EXEC                                         16219802
161682                                                                  16219902
161683              WHEN SU083-UNIT-SEQ                                 16220002
161684                 EXEC SQL                                         16221002
161685                    FETCH BUS-UNIT-B-CSR                          16222002
161686                     INTO                                         16223002
161687                     :SUT00066-TRIP-OCRNC-ID                      16224007
161688                   , :SUT00066-BUS-AREA-ID                        16225007
161689                   , :SUT00066-BRND-ID                            16226007
161690                   , :SUT00066-UNT-QTY                            16227007
161691                   , :SUT00066-SKU-QTY                            16228007
161692                   , :SUT00066-CART-QTY                           16229007
161693                   , :SUT00066-RTL-DOL-AMT                        16229107
161694                   , :SUT00066-COST-DOL-AMT                       16229207
221201                   , :SUT00066-HNG-FOLD-CDE                       16229307
221201                   , :SUT00066-PRC-MSG-RPLN-NEW-IND               16229407
161695                   , :XLT00000-BUS-AREA-ID                        16229502
161696                   , :XLT00000-BUS-AREA-DESC                      16229602
161697                   , :XLT00043-BRND-ID                            16229702
161698                   , :XLT00043-BRND-DESC                          16229802
161699                                                                  16229902
161700                 END-EXEC                                         16230002
161701                                                                  16231002
161702            END-EVALUATE                                          16232002
161703     END-EVALUATE                                                 16233002
161704*                                                                 16234002
161705     EVALUATE TRUE                                                16235002
161706         WHEN SQLCODE = ZERO                                      16236002
161707         WHEN SQLCODE = +100                                      16237002
161708              CONTINUE                                            16238002
161709         WHEN SQLWARN0 NOT = SPACE                                16239002
161710         WHEN SQLCODE NOT = ZERO                                  16239102
161711              MOVE '4311-FETCH-CURSOR'                            16239202
161712                               TO DP013-PARAGRAPH                 16239302
161713              MOVE 'FETCH CURSOR'                                 16239402
161714                               TO DP013-MESSAGE-TEXT (1)          16239502
161715              MOVE SQLCA       TO DP013-SQLCA                     16239602
161716              SET DP013-DB2-ABEND                                 16239702
161717                               TO TRUE                            16239802
161718              PERFORM DP013-0000-PROCESS-ABEND                    16239902
161719     END-EVALUATE.                                                16240002
161720                                                                  16241002
161721     IF  SQLCODE EQUAL +100                                       16242002
161722         SET PS-END-OF-CSR       TO TRUE                          16243002
161723     END-IF.                                                      16244002
      *CLP 07/07/2015 START                                             16245002
161800 EJECT                                                            16250000
165500******************************************************************16550000
165600 8000-LINK-TO-DRS.                                                16560000
165700* THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     16570000
165800                                                                  16580000
165900*  CAUTION:  ANY NON-BLANK CHARACTER IN PRINT POSITION 132        16590000
166000*            WILL CAUSE DOUBLE-SPACING REGARDLESS OF THE          16600000
166100*            CONTENTS OF CARRIAGE CONTROL CHARACTER.              16610000
166200     EXEC CICS                                                    16620000
166300         LINK                                                     16630000
166400             PROGRAM   ('DRS1INTC')                               16640000
166500             COMMAREA  (DRS01-COMMAREA)                           16650000
166600     END-EXEC.                                                    16660000
166700                                                                  16670000
166800     EVALUATE TRUE                                                16680000
166900         WHEN DRS01-DRRB-RC = ZERO                                16690000
167000             CONTINUE                                             16700000
167100         WHEN OTHER                                               16710000
167200             MOVE '8000-LINK-TO-DRS'    TO DP013-PARAGRAPH        16720000
167300             SET DP013-OTHER-ABEND      TO TRUE                   16730000
167400             MOVE DRS01-DRRB-FUNC       TO PV-DRS-DRRB-FUNC       16740000
167500             MOVE DRS01-DRRB-RID        TO PV-DRS-DRRB-RID        16750000
167600             MOVE DRS01-DRRD-OPTIONS    TO PV-DRS-DRRB-OPTIONS    16760000
167700             MOVE DRS01-DRRB-RC         TO PV-DRS-DRRB-RC         16770000
167800             MOVE DRS01-DRRB-ATTR-ERROR TO PV-DRS-ATTR-ERROR      16780000
167900             MOVE DRS01-DRRB-DRDC       TO PV-DRS-DRRB-DRDC       16790000
168000             MOVE DRS01-DRRB01-LINES    TO PV-DRS-DRRB-LINES      16800000
168100             MOVE PV-DRS-ABEND-DISPLAY-LINE1                      16810000
168200                 TO DP013-MESSAGE-TEXT (1)                        16820000
168300             MOVE PV-DRS-ABEND-DISPLAY-LINE2                      16830000
168400                 TO DP013-MESSAGE-TEXT (2)                        16840000
168500             SET DP013-LINK-RETURN      TO TRUE                   16850000
168600             PERFORM DP013-0000-PROCESS-ABEND                     16860000
168700             GO TO 0000-GOBACK                                    16870000
168800     END-EVALUATE.                                                16880000
168900/                                                                 16890000
168900**********************************************************        16891004
168900**********  FOR MDSE PGM                                          16892004
168900**********************************************************        16893004
169000 8100-PRINT-HEADINGS.                                             16900000
169100     MOVE PC-PUT                      TO DRS01-DRRB-FUNC          16910000
169200     MOVE PV-PAGE-COUNT               TO DP132-PAGE-NUMBER        16920000
169300                                                                  16930000
169400     MOVE DP132-STANDRD-HEADER-132-COLS                           16940000
169500                                      TO DRS01-COMM-DATA.         16950000
169600     MOVE PC-TOP-OF-PAGE              TO DRS01-COMM-CTL.          16960000
169700     PERFORM 8000-LINK-TO-DRS.                                    16970000
169800                                                                  16980000
169900     MOVE HL1-HEADING-LINE            TO DRS01-COMM-DATA.         16990000
170000     MOVE PC-DOUBLE-SPACE             TO DRS01-COMM-CTL.          17000000
170100     PERFORM 8000-LINK-TO-DRS.                                    17010000
170200                                                                  17020000
170300     MOVE HL2-HEADING-LINE            TO DRS01-COMM-DATA          17030000
170400     MOVE PC-DOUBLE-SPACE             TO DRS01-COMM-CTL.          17040000
170500     PERFORM 8000-LINK-TO-DRS.                                    17050000
170600                                                                  17060000
170700     MOVE HL3-HEADING-LINE            TO DRS01-COMM-DATA          17070000
170800     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          17080000
170900     PERFORM 8000-LINK-TO-DRS.                                    17090000
171000                                                                  17100000
171100     MOVE HL4-HEADING-LINE            TO DRS01-COMM-DATA          17110000
171200     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          17120000
171300     PERFORM 8000-LINK-TO-DRS.                                    17130000
171400                                                                  17140000
171410     MOVE HL5-HEADING-LINE            TO DRS01-COMM-DATA          17141000
171420     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          17142000
171430     PERFORM 8000-LINK-TO-DRS.                                    17143000
171440                                                                  17144000
171450     MOVE HL6-HEADING-LINE            TO DRS01-COMM-DATA          17145000
171460     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          17146000
171470     PERFORM 8000-LINK-TO-DRS.                                    17147000
171480                                                                  17148000
171490     MOVE HL7-HEADING-LINE            TO DRS01-COMM-DATA          17149000
171491     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          17149100
171492     PERFORM 8000-LINK-TO-DRS.                                    17149200
171493                                                                  17149300
171494     MOVE HL8-HEADING-LINE            TO DRS01-COMM-DATA          17149400
171495     MOVE PC-DOUBLE-SPACE             TO DRS01-COMM-CTL.          17149500
171496     PERFORM 8000-LINK-TO-DRS.                                    17149600
171497                                                                  17149700
171800     MOVE 12                          TO PV-LINE-COUNT.           17180000
171900/                                                                 17190000
292300******************************************************************29230000
292400 9999-ABEND.                                                      29240000
292500     MOVE 'SUKCS547'               TO DP013-PROGRAM.              29250000
292600     SET DP013-LINK-RETURN         TO TRUE.                       29260000
292700     SET DP013-NO-ROLLBACK         TO TRUE.                       29270000
292800     INITIALIZE                       DP013-SRC-TASK-NUMBER       29280000
292900                                      DP013-STACK.                29290000
293000     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             29300000
293100                                                                  29310000
293200     EXEC CICS                                                    29320000
293300         LINK                                                     29330000
293400             PROGRAM  (DP013-NAME)                                29340000
293500             COMMAREA (DP013-PARAMETERS)                          29350000
293600             LENGTH   (DP013-LENGTH)                              29360000
293700     END-EXEC.                                                    29370000
293800                                                                  29380000
293900     EXEC CICS                                                    29390000
294000          RETURN                                                  29400000
294100     END-EXEC.                                                    29410000
294200/                                                                 29420000
294300******************************************************************29430000
294400*    ABEND PROCESSING                                             29440000
294500******************************************************************29450000
294600     COPY DPPD013.                                                29460000
