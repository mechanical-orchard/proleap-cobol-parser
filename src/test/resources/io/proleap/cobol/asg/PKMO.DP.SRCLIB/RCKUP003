00001  ID DIVISION.                                                     05/27/93
00002                                                                   RCKUP003
00003  PROGRAM-ID.    RCKUP003.                                            LV001
00004                                                                   RCKUP003
00005  AUTHOR.        CHUCK ALBERTY -- EXACTA.                          RCKUP003
00006  INSTALLATION.  KOHLS DEPARTMENT STORES.                          RCKUP003
00007  DATE-WRITTEN.  APRIL 10, 1993.                                   RCKUP003
00008  DATE-COMPILED.                                                   RCKUP003
00009 ******************************************************************RCKUP003
00010 *                                                               **RCKUP003
00011 *   THIS PROGRAM WILL UPDATE THE DC_PRT_IND ON THE TASNHDR      **RCKUP003
00012 *   TABLE TO A 'Y' FOR ROWS WITH ANY VALUE OTHER THAN 'Y'.      **RCKUP003
00013 *                                                               **RCKUP003
00014 ******************************************************************RCKUP003
00015 *                                                                 RCKUP003
00016 *                                                                 RCKUP003
00017  ENVIRONMENT DIVISION.                                            RCKUP003
00018 *                                                                 RCKUP003
00019  INPUT-OUTPUT SECTION.                                            RCKUP003
00020 *                                                                 RCKUP003
00021 *                                                                 RCKUP003
00022  DATA DIVISION.                                                   RCKUP003
00023 *                                                                 RCKUP003
00024  FILE SECTION.                                                    RCKUP003
00025 *                                                                 RCKUP003
00026  WORKING-STORAGE SECTION.                                         RCKUP003
00027 *                                                                 RCKUP003
00028  01  FILLER.                                                      RCKUP003
00029      05  FILLER                      PIC  X(41)    VALUE          RCKUP003
00030          'BEGIN WORKING STORAGE.  PROGRAM COMPILED '.             RCKUP003
00031      05  PGM-COMPILED                PIC  X(20)    VALUE SPACES.  RCKUP003
00032 *                                                                 RCKUP003
00033  01  ABEND-CODE                      PIC S9(04)    VALUE ZERO     RCKUP003
00034                                                    COMP SYNC.     RCKUP003
00035 *                                                                 RCKUP003
00036  01  ABEND-PARAGRAPH                 PIC  X(30)    VALUE SPACES.  RCKUP003
00037 *                                                                 RCKUP003
00038  01  PM-PROGRAM-CONSTANTS.                                        RCKUP003
00039      05  PC-Y                        PIC  X(01)    VALUE 'Y'.     RCKUP003
00040 *                                                                 RCKUP003
00041 *                                                                 RCKUP003
00042 ******************************************************************RCKUP003
00043 *  DCLGEN FOR ASN HEADER TABLE                                    RCKUP003
00044 ******************************************************************RCKUP003
00045      EXEC SQL                                                     RCKUP003
00046           INCLUDE TASNHDR                                         RCKUP003
00047      END-EXEC.                                                    RCKUP003
00048 *                                                                 RCKUP003
00049 *                                                                 RCKUP003
00050 ******************************************************************RCKUP003
00051 *  SQL COMMUNICATION AREA                                         RCKUP003
00052 ******************************************************************RCKUP003
00053      EXEC SQL                                                     RCKUP003
00054           INCLUDE SQLCA                                           RCKUP003
00055      END-EXEC.                                                    RCKUP003
00056 *                                                                 RCKUP003
00057 *                                                                 RCKUP003
00058 ******************************************************************RCKUP003
00059 *  SQL COMMUNICATION AREA 2                                       RCKUP003
00060 ******************************************************************RCKUP003
00061      COPY SQLCA2.                                                 RCKUP003
00062 *                                                                 RCKUP003
00063 *                                                                 RCKUP003
00064  PROCEDURE DIVISION.                                              RCKUP003
00065 *                                                                 RCKUP003
00066  0000-MAIN-DRIVER.                                                RCKUP003
00067 ******************************************************************RCKUP003
00068 *  THIS PARAGRAPH UPDATES THE DC_PRT_IND FROM 'N' TO 'Y'.         RCKUP003
00069 *  FOR THOSE ROWS WHERE THE PRINT_IND IS A 'Y'.                   RCKUP003
00070 ******************************************************************RCKUP003
00071      MOVE WHEN-COMPILED              TO PGM-COMPILED.             RCKUP003
00072 *                                                                 RCKUP003
00073      EXEC SQL                                                     RCKUP003
00074           UPDATE TASNHDR                                          RCKUP003
00075              SET DC_PRT_IND  = :PC-Y                              RCKUP003
00076            WHERE DC_PRT_IND ^= :PC-Y AND                          RCKUP003
00077                   PRINT_IND  = :PC-Y                              RCKUP003
00078      END-EXEC.                                                    RCKUP003
00079 *                                                                 RCKUP003
00080      IF  SQLCODE < ZERO                                           RCKUP003
00081          MOVE '0000-MAIN-DRIVER'     TO ABEND-PARAGRAPH           RCKUP003
00082          PERFORM 9999-SQL-ERROR                                   RCKUP003
00083      END-IF.                                                      RCKUP003
00084 *                                                                 RCKUP003
00085      GOBACK.                                                      RCKUP003
00086 *                                                                 RCKUP003
00087 *                                                                 RCKUP003
00088  9999-SQL-ERROR.                                                  RCKUP003
00089 ***************************************************************** RCKUP003
00090 *    THIS PARAGRAPH PERFORMS THE ABEND FOR THE PROGRAM IF AN      RCKUP003
00091 *    INVALID SQLCODE OCCURS.                                      RCKUP003
00092 ***************************************************************** RCKUP003
00093      MOVE SQLCODE                    TO SQLCODE2.                 RCKUP003
00094      MOVE SQLERRD(3)                 TO SQLERRD3.                 RCKUP003
00095      DISPLAY '** ABEND **         ** = SQLERROR'.                 RCKUP003
00096      DISPLAY '** PROGRAM          ** = RCKUP003'.                 RCKUP003
00097      DISPLAY '** PARAGRAPH        ** = ' ABEND-PARAGRAPH.         RCKUP003
00098      DISPLAY '** SQLCODE          ** = ' SQLCODE2.                RCKUP003
00099      DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                RCKUP003
00100      DISPLAY '** SQLERRM          ** = ' SQLERRM.                 RCKUP003
00101      DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                RCKUP003
00102      MOVE +4013                      TO ABEND-CODE.               RCKUP003
00103      CALL 'ILBOABN0' USING ABEND-CODE.                            RCKUP003
