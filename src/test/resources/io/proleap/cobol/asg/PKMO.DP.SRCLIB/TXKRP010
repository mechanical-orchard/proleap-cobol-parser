000100 IDENTIFICATION DIVISION.                                         00010017
000200 PROGRAM-ID.   TXKRP010.                                          00020018
000300 AUTHOR.       BARB SCHULTZ.                                      00030018
000400 DATE-WRITTEN. FEB 2011.                                          00040018
000500******************************************************************00050018
000600*  MODULE TYPE:   COBOL2 DB2 BATCH                                00060018
000700*                                                                 00070018
000800*  DESCRIPTION: THIS PROGRAM WILL BREAK ON SKU AND STORE. IT      00080018
000900*     SHOWS EVERY TRANSACTION THAT HAS THE ENVIRONMENTAL BAG      00090018
001000*     FEES THAT WERE COLLECTED. THIS IS ONLY IN STORE 1105 NOW    00100018
001100*     BUT COULD BE MORE STORES LATER.  THERE ALSO COULD BE MORE   00110018
001200*     SKU'S LATER TOO.                                            00120018
001300* JOB:  TXK501                                                    00130018
001400******************************************************************00140018
001410* CHANGE LOG:                                                     00141027
001420******************************************************************00142027
001500 ENVIRONMENT DIVISION.                                            00150018
001600 CONFIGURATION SECTION.                                           00160018
001700 SOURCE-COMPUTER.        IBM-3090.                                00170018
001800 OBJECT-COMPUTER.        IBM-3090.                                00180018
001900                                                                  00190018
002000 INPUT-OUTPUT SECTION.                                            00200018
002100                                                                  00210018
002200 FILE-CONTROL.                                                    00220018
002300                                                                  00230018
002400     SELECT DATE-CONTROL-FILE                                     00240018
002500       ASSIGN TO INP01.                                           00250018
002600                                                                  00260018
002700     SELECT BAG-FEE-FILE                                          00270018
002800       ASSIGN TO INP02.                                           00280018
002900                                                                  00290018
003000     SELECT REPORT-FILE                                           00300018
003100       ASSIGN TO RPT01.                                           00310018
003200                                                                  00320018
003300******************************************************************00330018
003400 DATA DIVISION.                                                   00340018
003500 FILE SECTION.                                                    00350018
003600                                                                  00360018
003700 FD  DATE-CONTROL-FILE                                            00370018
003800     RECORDING MODE F                                             00380018
003900     BLOCK CONTAINS 0 RECORDS                                     00390018
004000     LABEL RECORDS ARE OMITTED.                                   00400018
004100 01  DATE-CONTROL-RECORD                   PIC  X(80).            00410018
004200                                                                  00420018
004300 FD  BAG-FEE-FILE                                                 00430018
004400     RECORDING MODE F                                             00440018
004500     BLOCK CONTAINS 0 RECORDS                                     00450018
004600     LABEL RECORDS ARE OMITTED.                                   00460018
004700 01  BAG-FEE-RECORD                        PIC  X(125).           00470018
004800                                                                  00480018
004900 FD  REPORT-FILE                                                  00490018
005000     RECORDING MODE F                                             00500018
005100     BLOCK CONTAINS 0 RECORDS                                     00510018
005200     LABEL RECORDS ARE OMITTED.                                   00520018
005300 01  REPORT-RECORD                         PIC  X(132).           00530018
005400                                                                  00540018
005500 WORKING-STORAGE SECTION.                                         00550018
005600                                                                  00560018
005700************************************************************      00570018
005800* CONTROL CARDS - FISCAL PERIOD END DATE                          00580018
005900************************************************************      00590018
006000 01  CC-DATE-CONTROL-CARD.                                        00600018
006100     05  CC-FISCAL-END-DATE          PIC  X(10) VALUE SPACE.      00610018
006200     05  CC-FISCAL-END-DATE-R REDEFINES CC-FISCAL-END-DATE.       00620018
006300         10  CC-FISCAL-END-CCYY      PIC  X(04).                  00630018
006400         10  FILLER                  PIC  X.                      00640018
006500         10  CC-FISCAL-END-MM        PIC  X(02).                  00650018
006600         10  FILLER                  PIC  X.                      00660018
006700         10  CC-FISCAL-END-DD        PIC  X(02).                  00670018
006800     05  FILLER                      PIC  X(70) VALUE SPACE.      00680018
006900                                                                  00690018
007000************************************************************      00700018
007100* PS PROGRAM SWITCHES                                             00710018
007200************************************************************      00720018
007300 01  PS-PROGRAM-SWITCHES.                                         00730018
007400     05  PS-DATE-CONTROL-EOF-SW     PIC  X(001) VALUE 'N'.        00740018
007500       88  PS-DATE-CONTROL-EOF-YES              VALUE 'Y'.        00750018
007600       88  PS-DATE-CONTROL-EOF-NO               VALUE 'N'.        00760018
007700                                                                  00770018
007800     05  PS-BAG-FEE-EOF-SW          PIC  X(001) VALUE 'N'.        00780018
007900       88  PS-BAG-FEE-EOF-YES                   VALUE 'Y'.        00790018
008000       88  PS-BAG-FEE-EOF-NO                    VALUE 'N'.        00800018
008100                                                                  00810018
008200     05  PS-PRINT-STATE-HEADING-SW  PIC  X(001) VALUE 'N'.        00820018
008300       88  PS-PRINT-STATE-HEADING-YES           VALUE 'Y'.        00830018
008400       88  PS-PRINT-STATE-HEADING-NO            VALUE 'N'.        00840018
008500                                                                  00850018
008600************************************************************      00860018
008700* PROGRAM CONSTANTS                                               00870018
008800************************************************************      00880018
008900 01  PC-PROGRAM-CONSTANTS.                                        00890018
009000     05  PC-CURRENT-PROGRAM-NAME PIC  X(008)  VALUE 'TXKRP010'.   00900018
009100                                                                  00910018
009200************************************************************      00920018
009300* PV PROGRAM VARIABLES                                            00930018
009400************************************************************      00940018
009500 01  PV-PROGRAM-VARAIBLES.                                        00950018
009600     05  PV-PAGE-COUNT           PIC S9(04)   VALUE +0     COMP.  00960018
009700     05  PV-LINE-COUNT           PIC S9(04)   VALUE +0     COMP.  00970018
009800     05  PV-MAX-LINE-COUNT       PIC S9(04)   VALUE 38     COMP.  00980018
009900                                                                  00990018
010400     05  PV-HOLD-SKU-NBR         PIC  9(08)   VALUE ZEROES.       01040023
010500     05  PV-HOLD-SKU-DESC        PIC  X(25)   VALUE SPACES.       01050023
010600     05  PV-HOLD-ST-CDE          PIC  X(02)   VALUE SPACES.       01060023
010700     05  PV-HOLD-STR-NBR         PIC  9(04)   VALUE ZEROES.       01070023
010800                                                                  01080018
011800     05  PV-SKU-TOTALS.                                           01180018
011810         10  PV-SKU-TOT-UNITS-SOLD        PIC 9(09).              01181022
011820         10  PV-SKU-TOT-FEES-CHRGD        PIC S9(09)V99.          01182018
011830         10  PV-SKU-TOT-UNITS-RTND        PIC 9(09).              01183018
011840         10  PV-SKU-TOT-FEES-RTND         PIC S9(09)V99.          01184018
011850                                                                  01185018
011851     05  PV-STR-TOTALS.                                           01185118
011852         10  PV-STR-TOT-UNITS-SOLD        PIC 9(09).              01185218
011853         10  PV-STR-TOT-FEES-CHRGD        PIC S9(09)V99.          01185318
011854         10  PV-STR-TOT-UNITS-RTND        PIC 9(09).              01185418
011855         10  PV-STR-TOT-FEES-RTND         PIC S9(09)V99.          01185518
011856                                                                  01185618
011857     05  PV-STATE-TOTALS.                                         01185718
011858         10  PV-STATE-TOT-UNITS-SOLD      PIC 9(09).              01185818
011859         10  PV-STATE-TOT-FEES-CHRGD      PIC S9(09)V99.          01185918
011860         10  PV-STATE-TOT-UNITS-RTND      PIC 9(09).              01186018
011861         10  PV-STATE-TOT-FEES-RTND       PIC S9(09)V99.          01186118
011862                                                                  01186218
011863     05  PV-COMP-TOTALS.                                          01186318
011864         10  PV-COMP-TOT-UNITS-SOLD       PIC 9(09).              01186418
011865         10  PV-COMP-TOT-FEES-CHRGD       PIC S9(09)V99.          01186518
011866         10  PV-COMP-TOT-UNITS-RTND       PIC 9(09).              01186618
011867         10  PV-COMP-TOT-FEES-RTND        PIC S9(09)V99.          01186718
011868                                                                  01186818
011870     05  PV-HOLD-PERIOD-START-DTE.                                01187018
011900         10  PV-HOLD-PERIOD-START-CCYY    PIC X(04).              01190018
012000         10  FILLER                       PIC X(01).              01200018
012100         10  PV-HOLD-PERIOD-START-MM      PIC X(02).              01210018
012200         10  FILLER                       PIC X(01).              01220018
012300         10  PV-HOLD-PERIOD-START-DD      PIC X(02).              01230018
012400                                                                  01240018
012500     05  PV-HOLD-PERIOD-END-DTE.                                  01250018
012600         10  PV-HOLD-PERIOD-END-CCYY      PIC X(04).              01260018
012700         10  FILLER                       PIC X(01).              01270018
012800         10  PV-HOLD-PERIOD-END-MM        PIC X(02).              01280018
012900         10  FILLER                       PIC X(01).              01290018
013000         10  PV-HOLD-PERIOD-END-DD        PIC X(02).              01300018
013100                                                                  01310018
013200     05  PV-CURRENT-DATE.                                         01320018
013300         10  PV-CURRENT-CC                PIC X(02).              01330018
013400         10  PV-CURRENT-YY                PIC X(02).              01340018
013500         10  PV-CURRENT-MM                PIC X(02).              01350018
013600         10  PV-CURRENT-DD                PIC X(02).              01360018
013700         10  PV-CURRENT-HOUR              PIC X(02).              01370018
013800         10  PV-CURRENT-MIN               PIC X(02).              01380018
013900         10  PV-CURRENT-SEC               PIC X(02).              01390018
014000         10  FILLER                       PIC X(08).              01400018
014001                                                                  01400119
014200************************************************************      01420018
014300* THIS IS THE COPYBOOK FOR BAG FEES COLLECTED AND RETURNED *      01430018
014400* EXTRACT USED IN PROGRAM TXKUT013, JOB TXK501.            *      01440018
014500************************************************************      01450018
014600     COPY TXRD002.                                                01460018
014700                                                                  01470018
014800************************************************************      01480018
014900* DATE ROUTINE COPY MEMBERS                                       01490018
015000************************************************************      01500018
015100     COPY DPWS500.                                                01510018
015200                                                                  01520018
015300************************************************************      01530018
015400***  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT               01540018
015500************************************************************      01550018
015600     COPY DPWS132O.                                               01560018
015700                                                                  01570018
015800************************************************************      01580018
015900* PROGRAM ACCUMULATORS                                            01590018
016000************************************************************      01600018
016100 01  PA-PROGRAM-ACCUMULATORS.                                     01610018
016200     05  PA-DATE-CONTROL-RECS-READ    PIC  9(09)   VALUE ZERO.    01620018
016300     05  PA-BAG-FEE-RECS-READ         PIC  9(09)   VALUE ZERO.    01630018
016400     05  PA-REPORT-RECS-WRITTEN       PIC  9(09)   VALUE ZERO.    01640018
016500                                                                  01650018
016600************************************************************      01660018
016700* REPORT HEADINGS                                                 01670018
016800************************************************************      01680018
016900 01  HD00-BLANK-LINE             PIC  X(02)    VALUE SPACES.      01690018
017000                                                                  01700018
017100 01  HD02-MAIN-HEADING.                                           01710018
017200     05  FILLER                  PIC  X(049)   VALUE SPACES.      01720018
017300     05  FILLER                  PIC  X(035)   VALUE              01730018
017400         'BAG FEES COLLECTED AND RETURNED'.                       01740018
017500                                                                  01750018
017600 01  HD03-MAIN-HEADING.                                           01760018
017700     05  FILLER                     PIC  X(055)   VALUE SPACES.   01770018
017800     05  HD03-PERIOD-START-DATE.                                  01780018
017900         10  HD03-PERIOD-START-MM   PIC X(02)    VALUE 'MM'.      01790018
018000         10  FILLER                 PIC X(01)    VALUE '/'.       01800018
018100         10  HD03-PERIOD-START-DD   PIC X(02)    VALUE 'DD'.      01810018
018200         10  FILLER                 PIC X(01)    VALUE '/'.       01820018
018300         10  HD03-PERIOD-START-CCYY PIC X(04)    VALUE 'CCYY'.    01830018
018400         10  FILLER                 PIC X(03)    VALUE ' - '.     01840018
018500         10  HD03-PERIOD-END-MM     PIC X(02)    VALUE 'MM'.      01850018
018600         10  FILLER                 PIC X(01)    VALUE '/'.       01860018
018700         10  HD03-PERIOD-END-DD     PIC X(02)    VALUE 'DD'.      01870018
018800         10  FILLER                 PIC X(01)    VALUE '/'.       01880018
018900         10  HD03-PERIOD-END-CCYY   PIC X(04)    VALUE 'CCYY'.    01890018
019000                                                                  01900018
019100 01  HD05-SKU-HEADING.                                            01910018
019200     05  FILLER                  PIC  X(002)   VALUE SPACES.      01920018
019300     05  FILLER                  PIC  X(005)   VALUE 'SKU:'.      01930018
019400     05  HD05-SKU-NBR            PIC  9(008)   VALUE ZERO.        01940018
019500     05  FILLER                  PIC  X(002)   VALUE SPACES.      01950018
019600     05  HD05-SKU-DESC           PIC  X(025)   VALUE SPACES.      01960018
019700                                                                  01970018
019800 01  HD06-STATE-HEADING.                                          01980018
019900     05  FILLER                  PIC  X(003)   VALUE SPACES.      01990018
020000     05  FILLER                  PIC  X(007)   VALUE 'STATE: '.   02000018
020100     05  HD06-ST-CDE             PIC  X(002)   VALUE SPACES.      02010018
020200                                                                  02020018
020300 01  HD10-TITLE-LINE.                                             02030018
020400     05  HD10-STR-NBR            PIC  X(43)    VALUE SPACES.      02040018
020500     05  HD10-UNITS-SOLD         PIC  X(15)    VALUE              02050018
020600         '# OF FEES'.                                             02060018
020700     05  HD10-FEES-CHRGD         PIC  X(18)    VALUE              02070018
020800         ' AMOUNT OF'.                                            02080018
020900     05  HD10-UNITS-RTND         PIC  X(15)    VALUE              02090018
021000         ' # OF FEES'.                                            02100018
021100     05  HD10-FEES-RTND          PIC  X(18)    VALUE              02110018
021200         ' AMOUNT OF'.                                            02120018
021300                                                                  02130018
021400 01  HD11-DETAIL-LINE.                                            02140018
021500     05  HD11-STR-NBR            PIC  X(10)    VALUE              02150018
021600         '  STORE#  '.                                            02160018
021700     05  HD11-RGST-ID            PIC  X(06)    VALUE ' RGST '.    02170018
021800     05  HD11-TRN-NBR            PIC  X(05)    VALUE ' TRN '.     02180018
021900     05  HD11-SLS-DTE            PIC  X(10) VALUE 'SALES DTE '.   02190018
022000     05  HD11-STRT-TM            PIC  X(10) VALUE '   TIME   '.   02200018
022100     05  HD11-UNITS-SOLD         PIC  X(15)    VALUE              02210018
022200         '  COLLECTED   '.                                        02220018
022300     05  HD11-FEES-CHRGD         PIC  X(18)    VALUE              02230018
022400         ' FEES COLLECTED'.                                       02240018
022500     05  HD11-UNITS-RTND         PIC  X(15)    VALUE              02250018
022600         '   RETURNED  '.                                         02260018
022700     05  HD11-FEES-RTND          PIC  X(18)   VALUE               02270018
022800         ' FEES RETURNED '.                                       02280018
022900                                                                  02290018
023000 01  HD12-DETAIL-LINE.                                            02300018
023100     05  HD12-STR-NBR            PIC  X(10)    VALUE              02310018
023200         '  ------ '.                                             02320018
023300     05  HD12-RGST-ID            PIC  X(05)    VALUE              02330018
023400         ' ----'.                                                 02340018
023500     05  HD12-TRN-NBR            PIC  X(05)    VALUE              02350018
023600         ' ----'.                                                 02360018
023700     05  HD12-SLS-DTE            PIC  X(11)    VALUE              02370018
023800         ' --------- '.                                           02380018
023810     05  HD12-STRT-TM            PIC  X(11)    VALUE              02381018
023820         ' --------  '.                                           02382018
023830     05  HD12-UNITS-SOLD         PIC  X(15)    VALUE              02383018
023840         ' ----------   '.                                        02384018
023850     05  HD12-FEES-CHRGD         PIC  X(18)    VALUE              02385018
023860         '--------------    '.                                    02386018
023870     05  HD12-UNITS-RTND         PIC  X(15)   VALUE               02387018
023880         '  ---------   '.                                        02388018
023890     05  HD12-FEES-RTND          PIC  X(18)   VALUE               02389018
023900         '-------------'.                                         02390018
024000                                                                  02400018
024100 01  DL1-DETAIL-LINE.                                             02410018
024200     05  FILLER              PIC  X(03)   VALUE SPACES.           02420018
024300     05  DL1-STR-NBR         PIC  9(04)   VALUE ZERO.             02430018
024400     05  FILLER              PIC  X(04)   VALUE SPACES.           02440018
024500     05  DL1-RGST-ID         PIC  9(04)   VALUE ZERO.             02450018
024600     05  FILLER              PIC  X(01)   VALUE SPACES.           02460018
024700     05  DL1-TRN-NBR         PIC  9(04)   VALUE ZERO.             02470018
024800     05  FILLER              PIC  X(01)   VALUE SPACES.           02480018
024900     05  DL1-SLS-DTE         PIC  X(10)   VALUE SPACES.           02490018
025000     05  FILLER              PIC  X(01)   VALUE SPACES.           02500018
025100     05  DL1-STRT-TM         PIC  X(08)   VALUE SPACES.           02510018
025200     05  FILLER              PIC  X(03)   VALUE SPACES.           02520018
025300     05  DL1-UNITS-SOLD      PIC  ZZZ,ZZ9.                        02530018
025400     05  FILLER              PIC  X(08)   VALUE SPACES.           02540018
025500     05  DL1-FEES-CHRGD      PIC  ZZZ,ZZ9.99-.                    02550018
025600     05  FILLER              PIC  X(08)   VALUE SPACES.           02560018
025700     05  DL1-UNITS-RTND      PIC  ZZZ,ZZ9.                        02570018
025800     05  FILLER              PIC  X(08)   VALUE SPACES.           02580018
025900     05  DL1-FEES-RTND       PIC  ZZZ,ZZ9.99-.                    02590018
026000                                                                  02600018
026100 01  TT1-TOTAL-LINE.                                              02610018
026200     05  FILLER                  PIC  X(002)   VALUE SPACES.      02620018
026300     05  TT1-TOTAL-LIT           PIC  X(022)   VALUE SPACES.      02630018
026400     05  FILLER REDEFINES     TT1-TOTAL-LIT.                      02640018
026500         10  FILLER              PIC  X(001).                     02650018
026600         10  TT1-STATE-LIT       PIC  X(007).                     02660018
026700         10  TT1-ST-CDE          PIC  X(002).                     02670018
026800         10  TT1-STATE-TOTAL-LIT PIC  X(012).                     02680018
026810     05  FILLER REDEFINES     TT1-TOTAL-LIT.                      02681018
026820         10  FILLER              PIC  X(001).                     02682018
026830         10  TT1-STORE-LIT       PIC  X(007).                     02683018
026840         10  TT1-STR-NBR         PIC  X(004).                     02684018
026850         10  TT1-STORE-TOTAL-LIT PIC  X(010).                     02685018
026900     05  FILLER REDEFINES     TT1-TOTAL-LIT.                      02690018
027000         10  TT1-SKU-LIT         PIC  X(005).                     02700018
027100         10  TT1-SKU-NBR         PIC  9(008).                     02710018
027200         10  TT1-SKU-TOTAL-LIT   PIC  X(009).                     02720018
027300     05  FILLER              PIC  X(15)    VALUE SPACES.          02730018
027400     05  TT1-UNITS-SOLD      PIC  ZZZ,ZZZ,ZZ9.                    02740018
027500     05  FILLER              PIC  X(04)    VALUE SPACES.          02750018
027600     05  TT1-FEES-CHRGD      PIC  ZZZ,ZZZ,ZZ9.99-.                02760018
027700     05  FILLER              PIC  X(04)    VALUE SPACES.          02770018
027800     05  TT1-UNITS-RTND      PIC  ZZZ,ZZZ,ZZ9.                    02780018
027900     05  FILLER              PIC  X(04)    VALUE SPACES.          02790018
028000     05  TT1-FEES-RTND       PIC  ZZZ,ZZZ,ZZ9.99-.                02800018
028100                                                                  02810018
028200 01  TRL1-TRAILER-LINE.                                           02820018
028300     05  FILLER                  PIC  X(053)   VALUE SPACES.      02830018
028400     05  FILLER                  PIC  X(025)   VALUE              02840018
028500         '*** NO DATA TO REPORT ***'.                             02850018
028510                                                                  02851025
028520 01  BLANK-LINE.                                                  02852025
028530     05  FILLER                  PIC  X(132)   VALUE SPACES.      02853025
028600                                                                  02860025
028700************************************************************      02870018
028800* ERROR HANDLING                                                  02880018
028900************************************************************      02890018
029000                                                                  02900018
029100 01  PV-MISC-ABEND-FIELDS.                                        02910018
029200     05  PV-PARAGRAPH-NAME            PIC  X(030)     VALUE SPACE.02920018
029300     05  PV-OPERATION-MSG-1           PIC  X(040)     VALUE SPACE.02930018
029400     05  PV-OPERATION-MSG-2           PIC  X(040)     VALUE SPACE.02940018
029500     05  PV-DB2-OPERATION             PIC  X(030)     VALUE SPACE.02950018
029600                                                                  02960018
029700 01  ABEND-CODE                       PIC S9(004)     VALUE ZEROS 02970018
029800                                                        COMP SYNC.02980018
029900     88  ABEND-4003-INVALID-CNTL-CARD       VALUE +4003.          02990018
030000     88  ABEND-4019-CAL-SUB-ERROR           VALUE +4019.          03000018
030100                                                                  03010018
030200************************************************************      03020018
030300 PROCEDURE DIVISION.                                              03030018
030400************************************************************      03040018
030500 0000-MAINLINE.                                                   03050018
030600                                                                  03060018
030700     DISPLAY '************ START OF TXKRP010 ***************'.    03070018
030800                                                                  03080018
030900     PERFORM 1000-INITIALIZATION.                                 03090018
031000                                                                  03100018
031400     PERFORM 2000-PROC-BAG-FEE-FILE                               03140018
031500       UNTIL PS-BAG-FEE-EOF-YES.                                  03150018
032000                                                                  03200018
032600     PERFORM 3000-WRAPUP.                                         03260023
032700                                                                  03270018
032800     DISPLAY '************  END OF TXKRP010  ***************'.    03280018
032900                                                                  03290018
033000     GOBACK.                                                      03300018
033100                                                                  03310018
033200************************************************************      03320018
033300* INITIALIZATION.                                                 03330018
033400*     OPENS FILES                                                 03340018
033500*     INITIALIZES VARIABLES                                       03350018
033600*     PERFORM INITIAL READ                                        03360018
033700************************************************************      03370018
033800 1000-INITIALIZATION.                                             03380018
033900                                                                  03390018
034000     OPEN INPUT  DATE-CONTROL-FILE                                03400018
034100                 BAG-FEE-FILE                                     03410018
034200          OUTPUT REPORT-FILE                                      03420018
034300                                                                  03430018
034400     MOVE FUNCTION CURRENT-DATE TO PV-CURRENT-DATE                03440018
034500                                                                  03450018
034600     PERFORM 8000-READ-DATE-CONTROL-FILE.                         03460018
034700                                                                  03470018
034800     IF  PS-DATE-CONTROL-EOF-YES                                  03480018
034900         MOVE '8000-READ-DATE-CONTROL-FILE  ' TO PV-PARAGRAPH-NAME03490018
035000         MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG-1  03500018
035100         SET ABEND-4003-INVALID-CNTL-CARD  TO TRUE                03510018
035200         PERFORM 9999-ABEND                                       03520023
035300     END-IF.                                                      03530018
035400                                                                  03540018
035500     PERFORM 9100-GET-FISCAL-PERIOD-START.                        03550023
035600                                                                  03560018
035700     DISPLAY ' '.                                                 03570018
035800     DISPLAY 'CONTROL CARD DATE: ' CC-FISCAL-END-DATE.            03580018
035900                                                                  03590018
036000     DISPLAY ' '.                                                 03600018
036100     DISPLAY 'REPORTING FISCAL PERIOD =>'                         03610018
036200             ' START: ' PV-HOLD-PERIOD-START-DTE                  03620018
036300             ' - '                                                03630018
036400             ' END  : ' PV-HOLD-PERIOD-END-DTE.                   03640018
036500                                                                  03650018
036600     COMPUTE PV-LINE-COUNT  = PV-MAX-LINE-COUNT  + 1.             03660018
036700                                                                  03670018
036800     PERFORM 9200-INITIALIZE-HEADING.                             03680023
036801                                                                  03680122
036810     MOVE ZERO TO  PV-SKU-TOT-UNITS-SOLD                          03681022
036820                   PV-SKU-TOT-FEES-CHRGD                          03682022
036830                   PV-SKU-TOT-UNITS-RTND                          03683022
036840                   PV-SKU-TOT-FEES-RTND                           03684022
036870                   PV-STR-TOT-UNITS-SOLD                          03687022
036880                   PV-STR-TOT-FEES-CHRGD                          03688022
036890                   PV-STR-TOT-UNITS-RTND                          03689022
036891                   PV-STR-TOT-FEES-RTND                           03689122
036894                   PV-STATE-TOT-UNITS-SOLD                        03689422
036895                   PV-STATE-TOT-FEES-CHRGD                        03689522
036896                   PV-STATE-TOT-UNITS-RTND                        03689622
036897                   PV-STATE-TOT-FEES-RTND                         03689722
036900                   PV-COMP-TOT-UNITS-SOLD                         03690022
036901                   PV-COMP-TOT-FEES-CHRGD                         03690122
036902                   PV-COMP-TOT-UNITS-RTND                         03690222
036903                   PV-COMP-TOT-FEES-RTND.                         03690322
036910                                                                  03691018
037000     SET PS-BAG-FEE-EOF-NO TO TRUE.                               03700018
037100     PERFORM 8100-READ-BAG-FEE-FILE.                              03710018
037200                                                                  03720018
043400************************************************************      04340018
043500* PROCESS BAG FEE FILE                                            04350018
043600************************************************************      04360018
043700 2000-PROC-BAG-FEE-FILE.                                          04370018
043800                                                                  04380018
043810     IF  TX002-SKU-NBR = PV-HOLD-SKU-NBR                          04381023
043811         IF  TX002-ST-CDE = PV-HOLD-ST-CDE                        04381123
043820             IF  TX002-STR-NBR = PV-HOLD-STR-NBR                  04382023
043830                 CONTINUE                                         04383023
043840             ELSE                                                 04384023
043850                 PERFORM 6000-STORE-BREAK                         04385023
043851                 MOVE TX002-STR-NBR TO PV-HOLD-STR-NBR            04385123
043860             END-IF                                               04386023
043870         ELSE                                                     04387023
043880             PERFORM 6000-STORE-BREAK                             04388023
043890             PERFORM 6100-STATE-BREAK                             04389023
043891             MOVE TX002-STR-NBR TO PV-HOLD-STR-NBR                04389123
043892             MOVE TX002-ST-CDE TO PV-HOLD-ST-CDE                  04389223
043894         END-IF                                                   04389423
043895     ELSE                                                         04389523
043896         PERFORM 6000-STORE-BREAK                                 04389625
043897         PERFORM 6100-STATE-BREAK                                 04389725
043898         PERFORM 6200-SKU-BREAK                                   04389823
043899         MOVE TX002-STR-NBR TO PV-HOLD-STR-NBR                    04389923
043900         MOVE TX002-ST-CDE TO PV-HOLD-ST-CDE                      04390023
043901         MOVE TX002-SKU-NBR  TO PV-HOLD-SKU-NBR                   04390123
043902         COMPUTE PV-LINE-COUNT  = PV-MAX-LINE-COUNT  + 1          04390223
043903     END-IF.                                                      04390323
043904                                                                  04390423
043905     PERFORM 4100-PROCESS-DETAIL.                                 04390523
043906                                                                  04390623
043910     PERFORM 8100-READ-BAG-FEE-FILE.                              04391023
044000                                                                  04400018
044200                                                                  04420018
047710************************************************************      04771023
047720*     END OF PROGRAM ROUTINE.                                     04772023
047730*     WRITE FINAL TOTALS, CLOSES ALL FILES AND DISPLAYS           04773023
047740*     ANY DATA FROM THE PROGRAM.                                  04774023
047750************************************************************      04775023
047760 3000-WRAPUP.                                                     04776023
047770                                                                  04777023
047771     PERFORM 6000-STORE-BREAK.                                    04777126
047772     PERFORM 6100-STATE-BREAK.                                    04777226
047773     PERFORM 6200-SKU-BREAK.                                      04777326
047774                                                                  04777426
047780     MOVE '     COMPANY TOTAL:'  TO TT1-TOTAL-LIT.                04778023
047790     MOVE PV-COMP-TOT-UNITS-SOLD TO TT1-UNITS-SOLD.               04779023
047791     MOVE PV-COMP-TOT-FEES-CHRGD TO TT1-FEES-CHRGD.               04779123
047792     MOVE PV-COMP-TOT-UNITS-RTND TO TT1-UNITS-RTND.               04779223
047793     MOVE PV-COMP-TOT-FEES-RTND  TO TT1-FEES-RTND.                04779323
047794                                                                  04779423
047795     PERFORM 7400-PRINT-TOTAL-LINE.                               04779523
047796                                                                  04779623
047797     CLOSE DATE-CONTROL-FILE                                      04779723
047798           BAG-FEE-FILE                                           04779823
047799           REPORT-FILE.                                           04779923
047800                                                                  04780023
047801     DISPLAY ' '.                                                 04780123
047802     DISPLAY '*********************************************'.     04780223
047803     DISPLAY '    TXKRP010 SUMMARY STATISTICS              '.     04780323
047804     DISPLAY '*********************************************'.     04780423
047805     DISPLAY ' '.                                                 04780523
047806     DISPLAY 'DATE CONTROL RECS READ ................: '          04780623
047807              PA-DATE-CONTROL-RECS-READ.                          04780723
047808     DISPLAY ' '.                                                 04780823
047809     DISPLAY 'BAG FEE RECS READ .................: '              04780923
047810              PA-BAG-FEE-RECS-READ.                               04781023
047811     DISPLAY ' '.                                                 04781123
047812     DISPLAY 'BAG FEE REPORT RECORDS WRITTEN ....: '              04781223
047813              PA-REPORT-RECS-WRITTEN.                             04781323
047814     DISPLAY ' '.                                                 04781423
047815     DISPLAY '*********************************************'.     04781523
047816                                                                  04781623
052010                                                                  05201018
052100************************************************************      05210018
052200* PROCESS DETAIL.  CHECKS FOR HEADINGS NEEDED, FORMAT DETAIL LINES05220023
052210* AND PRINT, ADD TO ACCUMULATORS.                                 05221023
052300************************************************************      05230018
052400 4100-PROCESS-DETAIL.                                             05240023
052500                                                                  05250018
052600     IF  PV-LINE-COUNT > PV-MAX-LINE-COUNT                        05260018
052700         PERFORM 7000-PRINT-MAIN-HEADING                          05270023
052800         PERFORM 7100-PRINT-DETAIL-HEADING                        05280023
052900         PERFORM 7200-PRINT-SKU-HEADING                           05290023
053000                                                                  05300018
053100***** BYPASS STATE HEADING WHEN NO DATA IS FOUND FOR SKU          05310018
053200                                                                  05320018
053300         IF  PV-HOLD-STR-NBR > ZERO                               05330023
053400             PERFORM 7300-PRINT-ST-CDE-HEADING                    05340023
053500             SET PS-PRINT-STATE-HEADING-NO TO TRUE                05350018
053600         END-IF                                                   05360018
053700     ELSE                                                         05370018
053800         IF  PS-PRINT-STATE-HEADING-YES                           05380023
053900             PERFORM 7300-PRINT-ST-CDE-HEADING                    05390023
054000             SET PS-PRINT-STATE-HEADING-NO TO TRUE                05400023
054100         END-IF                                                   05410023
054200     END-IF.                                                      05420018
054300                                                                  05430018
054400     MOVE TX002-STR-NBR     TO DL1-STR-NBR.                       05440018
054500     MOVE TX002-RGST-ID     TO DL1-RGST-ID.                       05450018
054600     MOVE TX002-TRN-NBR     TO DL1-TRN-NBR.                       05460018
054700     MOVE TX002-SLS-DTE     TO DL1-SLS-DTE.                       05470018
054800     MOVE TX002-STRT-TM     TO DL1-STRT-TM.                       05480018
054900     MOVE TX002-UNITS-SOLD  TO DL1-UNITS-SOLD.                    05490018
055000     MOVE TX002-FEES-CHRGD  TO DL1-FEES-CHRGD.                    05500018
055100     MOVE TX002-UNITS-RTND  TO DL1-UNITS-RTND.                    05510018
055200     MOVE TX002-FEES-RTND   TO DL1-FEES-RTND.                     05520018
055300                                                                  05530018
055400***** BYPASS DETAIL PRINTING WHEN NO DATA IS FOUND FOR SKU        05540018
055500                                                                  05550018
055600     IF  PV-HOLD-STR-NBR       > ZERO                             05560023
055700         WRITE REPORT-RECORD                                      05570018
055800             FROM DL1-DETAIL-LINE                                 05580018
055900             AFTER ADVANCING 1                                    05590018
056000                                                                  05600018
056100         ADD 1 TO PV-LINE-COUNT                                   05610018
056110         ADD 1 TO PA-REPORT-RECS-WRITTEN                          05611018
056120     ELSE                                                         05612018
056130         WRITE REPORT-RECORD                                      05613018
056140             FROM TRL1-TRAILER-LINE                               05614018
056150             AFTER ADVANCING 1                                    05615018
056160                                                                  05616018
056170         ADD 1 TO PV-LINE-COUNT                                   05617018
056180     END-IF.                                                      05618018
056190                                                                  05619018
056310     PERFORM 4150-ADD-TO-CONTROL-TOTAL.                           05631023
058800                                                                  05880018
058900************************************************************      05890018
059000* ADD CONTROL TOTAL TO HIGHER LEVEL CONTROL TOTAL                 05900018
059100************************************************************      05910018
059200 4150-ADD-TO-CONTROL-TOTAL.                                       05920023
059300                                                                  05930018
059400     ADD TX002-UNITS-SOLD TO PV-SKU-TOT-UNITS-SOLD                05940019
059500                             PV-STR-TOT-UNITS-SOLD                05950019
059510                             PV-STATE-TOT-UNITS-SOLD              05951019
059520                             PV-COMP-TOT-UNITS-SOLD.              05952019
059600     ADD TX002-FEES-CHRGD TO PV-SKU-TOT-FEES-CHRGD                05960019
059700                             PV-STR-TOT-FEES-CHRGD                05970019
059710                             PV-STATE-TOT-FEES-CHRGD              05971019
059720                             PV-COMP-TOT-FEES-CHRGD.              05972019
059800     ADD TX002-UNITS-RTND TO PV-SKU-TOT-UNITS-RTND                05980019
059900                             PV-STR-TOT-UNITS-RTND                05990019
059910                             PV-STATE-TOT-UNITS-RTND              05991019
059920                             PV-COMP-TOT-UNITS-RTND.              05992019
060000     ADD TX002-FEES-RTND  TO PV-SKU-TOT-FEES-RTND                 06000019
060100                             PV-STR-TOT-FEES-RTND                 06010019
060110                             PV-STATE-TOT-FEES-RTND               06011019
060120                             PV-COMP-TOT-FEES-RTND.               06012019
060200                                                                  06020018
060201************************************************************      06020123
060202* FORMAT AND PRINT STORE TOTALS, INITIALIZE TOTAL FIELDS.         06020223
060203************************************************************      06020323
060210 6000-STORE-BREAK.                                                06021024
060220                                                                  06022023
060230     MOVE SPACES                 TO TT1-TOTAL-LIT.                06023023
060240     MOVE 'STORE: '              TO TT1-STORE-LIT.                06024023
060250     MOVE ' TOTAL:'              TO TT1-STORE-TOTAL-LIT.          06025023
060260     MOVE PV-HOLD-STR-NBR        TO TT1-STR-NBR.                  06026023
060270                                                                  06027023
060280     MOVE PV-STR-TOT-UNITS-SOLD  TO TT1-UNITS-SOLD.               06028023
060290     MOVE PV-STR-TOT-FEES-CHRGD  TO TT1-FEES-CHRGD.               06029023
060291     MOVE PV-STR-TOT-UNITS-RTND  TO TT1-UNITS-RTND.               06029123
060292     MOVE PV-STR-TOT-FEES-RTND   TO TT1-FEES-RTND.                06029223
060293                                                                  06029323
060294     IF  PV-HOLD-STR-NBR       > ZERO                             06029423
060295         PERFORM 7400-PRINT-TOTAL-LINE                            06029523
060296         WRITE REPORT-RECORD FROM BLANK-LINE AFTER ADVANCING 1    06029625
060300         ADD 1 TO PV-LINE-COUNT                                   06030025
060301     END-IF.                                                      06030123
060302                                                                  06030223
060303     MOVE ZERO          TO PV-STR-TOT-UNITS-SOLD                  06030323
060304                           PV-STR-TOT-FEES-CHRGD                  06030423
060305                           PV-STR-TOT-UNITS-RTND                  06030523
060306                           PV-STR-TOT-FEES-RTND.                  06030623
060307                                                                  06030723
060308************************************************************      06030823
060309* FORMAT AND PRINT STATE TOTALS, INITIALIZE TOTAL FIELDS.         06030923
060310************************************************************      06031023
060311 6100-STATE-BREAK.                                                06031124
060312                                                                  06031223
060313     MOVE SPACES         TO TT1-TOTAL-LIT.                        06031323
060314     MOVE 'STATE: '      TO TT1-STATE-LIT.                        06031423
060315     MOVE ' TOTAL:'      TO TT1-STATE-TOTAL-LIT.                  06031523
060316     MOVE PV-HOLD-ST-CDE TO TT1-ST-CDE.                           06031623
060317                                                                  06031723
060318     MOVE PV-STATE-TOT-UNITS-SOLD TO TT1-UNITS-SOLD.              06031823
060319     MOVE PV-STATE-TOT-FEES-CHRGD TO TT1-FEES-CHRGD.              06031923
060320     MOVE PV-STATE-TOT-UNITS-RTND TO TT1-UNITS-RTND.              06032023
060321     MOVE PV-STATE-TOT-FEES-RTND  TO TT1-FEES-RTND.               06032123
060322                                                                  06032223
060323     IF  PV-HOLD-STR-NBR       > ZERO                             06032323
060324         PERFORM 7400-PRINT-TOTAL-LINE                            06032423
060325         WRITE REPORT-RECORD FROM BLANK-LINE AFTER ADVANCING 1    06032525
060326         ADD 1 TO PV-LINE-COUNT                                   06032625
060327         SET PS-PRINT-STATE-HEADING-YES TO TRUE                   06032727
060328     END-IF.                                                      06032823
060329                                                                  06032923
060330     MOVE ZERO         TO PV-STATE-TOT-UNITS-SOLD                 06033024
060331                          PV-STATE-TOT-FEES-CHRGD                 06033124
060332                          PV-STATE-TOT-UNITS-RTND                 06033224
060333                          PV-STATE-TOT-FEES-RTND.                 06033323
060334                                                                  06033423
060335************************************************************      06033523
060336* FORMAT AND PRINT STATE TOTALS, INITIALIZE TOTAL FIELDS.         06033623
060337************************************************************      06033723
060338 6200-SKU-BREAK.                                                  06033824
060339                                                                  06033923
060340     MOVE SPACES                 TO TT1-TOTAL-LIT.                06034023
060341     MOVE 'SKU: '                TO TT1-SKU-LIT.                  06034123
060342     MOVE ' TOTAL: '             TO TT1-SKU-TOTAL-LIT.            06034223
060343     MOVE  PV-HOLD-SKU-NBR       TO TT1-SKU-NBR.                  06034323
060344                                                                  06034423
060345     MOVE PV-SKU-TOT-UNITS-SOLD TO TT1-UNITS-SOLD.                06034523
060346     MOVE PV-SKU-TOT-FEES-CHRGD TO TT1-FEES-CHRGD.                06034623
060347     MOVE PV-SKU-TOT-UNITS-RTND TO TT1-UNITS-RTND.                06034723
060348     MOVE PV-SKU-TOT-FEES-RTND   TO TT1-FEES-RTND.                06034823
060349                                                                  06034923
060350     IF  PV-HOLD-STR-NBR       > ZERO                             06035023
060351          PERFORM 7400-PRINT-TOTAL-LINE                           06035123
060352     END-IF.                                                      06035223
060353                                                                  06035323
060354     MOVE ZERO           TO PV-SKU-TOT-UNITS-SOLD                 06035423
060355                            PV-SKU-TOT-FEES-CHRGD                 06035523
060356                            PV-SKU-TOT-UNITS-RTND                 06035623
060357                            PV-SKU-TOT-FEES-RTND.                 06035723
060358                                                                  06035823
060359***** BYPASS SKU TOTAL PRINTING WHEN NO DATA IS FOUND FOR SKU     06035923
060360                                                                  06036023
060370******************************************************************06037018
060400* PRINT MAIN HEADING                                              06040018
060500******************************************************************06050018
060600 7000-PRINT-MAIN-HEADING.                                         06060023
060700                                                                  06070018
060800     MOVE  ZERO                TO PV-LINE-COUNT.                  06080018
060900     ADD 1 TO PV-PAGE-COUNT.                                      06090018
061000     MOVE  PV-PAGE-COUNT       TO DP132O-PAGE-NUMBER.             06100018
061100     MOVE 1                    TO DP132O-REPORT-NUMBER.           06110018
061200                                                                  06120018
061300     WRITE REPORT-RECORD                                          06130018
061400         FROM DP132O-STANDRD-HEADER-132-COLS                      06140018
061500         AFTER ADVANCING PAGE.                                    06150018
061600                                                                  06160018
061700     WRITE REPORT-RECORD                                          06170018
061800         FROM HD02-MAIN-HEADING                                   06180018
061900         AFTER ADVANCING 1 LINE.                                  06190018
062000                                                                  06200018
062100     WRITE REPORT-RECORD                                          06210018
062200         FROM HD03-MAIN-HEADING                                   06220018
062300         AFTER ADVANCING 1 LINE.                                  06230018
062400                                                                  06240018
062500     ADD 3 TO PV-LINE-COUNT.                                      06250018
062600                                                                  06260018
062700******************************************************************06270018
062800* PRINT DETAIL HEADING                                            06280018
062900******************************************************************06290018
063000 7100-PRINT-DETAIL-HEADING.                                       06300023
063100                                                                  06310018
063200     WRITE REPORT-RECORD                                          06320018
063300        FROM HD00-BLANK-LINE                                      06330018
063400        AFTER ADVANCING 1 LINE.                                   06340018
063500                                                                  06350018
063600     WRITE REPORT-RECORD                                          06360018
063700        FROM HD10-TITLE-LINE                                      06370018
063800        AFTER ADVANCING 1 LINE.                                   06380018
063900                                                                  06390018
064000     WRITE REPORT-RECORD                                          06400018
064100        FROM HD11-DETAIL-LINE                                     06410018
064200        AFTER ADVANCING 1 LINE.                                   06420018
064300                                                                  06430018
064400     WRITE REPORT-RECORD                                          06440018
064500        FROM HD12-DETAIL-LINE                                     06450018
064600        AFTER ADVANCING 1 LINE.                                   06460018
064700                                                                  06470018
064800     ADD 4 TO PV-LINE-COUNT.                                      06480018
064900                                                                  06490018
065000******************************************************************06500018
065100* PRINT SKU HEADING                                               06510018
065200******************************************************************06520018
065201 7200-PRINT-SKU-HEADING.                                          06520123
065202                                                                  06520218
065203     MOVE  PV-HOLD-SKU-NBR       TO  HD05-SKU-NBR.                06520323
065204     MOVE  PV-HOLD-SKU-DESC TO       HD05-SKU-DESC.               06520423
065205                                                                  06520518
065206     WRITE REPORT-RECORD                                          06520618
065207        FROM HD00-BLANK-LINE                                      06520718
065208        AFTER ADVANCING 1 LINE.                                   06520818
065209                                                                  06520918
065210     WRITE REPORT-RECORD                                          06521018
065220        FROM HD05-SKU-HEADING                                     06522018
065230        AFTER ADVANCING 1 LINE.                                   06523018
065240                                                                  06524018
065250     ADD 2 TO PV-LINE-COUNT.                                      06525018
065260                                                                  06526018
065270******************************************************************06527018
065280* PRINT STATE HEADING                                             06528018
065290******************************************************************06529018
065300 7300-PRINT-ST-CDE-HEADING.                                       06530023
065400                                                                  06540018
065500     MOVE  PV-HOLD-ST-CDE       TO  HD06-ST-CDE.                  06550023
065600                                                                  06560018
065700     WRITE REPORT-RECORD                                          06570018
065800        FROM HD00-BLANK-LINE                                      06580018
065900        AFTER ADVANCING 1 LINE.                                   06590018
066000                                                                  06600018
066100     WRITE REPORT-RECORD                                          06610018
066200        FROM HD06-STATE-HEADING                                   06620018
066300        AFTER ADVANCING 1 LINE.                                   06630018
066400                                                                  06640018
066500     WRITE REPORT-RECORD                                          06650018
066600        FROM HD00-BLANK-LINE                                      06660018
066700        AFTER ADVANCING 1 LINE.                                   06670018
066800                                                                  06680018
066900     ADD 3 TO PV-LINE-COUNT.                                      06690018
067000                                                                  06700018
068100******************************************************************06810018
068200* PRINT TOTAL LINE                                                06820018
068300******************************************************************06830018
068400 7400-PRINT-TOTAL-LINE.                                           06840023
068500                                                                  06850018
068600     WRITE REPORT-RECORD                                          06860018
068700        FROM HD00-BLANK-LINE                                      06870018
068800        AFTER ADVANCING 1 LINE.                                   06880018
068900                                                                  06890018
069000     WRITE REPORT-RECORD                                          06900018
069100         FROM TT1-TOTAL-LINE                                      06910018
069200         AFTER ADVANCING 1.                                       06920018
069300                                                                  06930018
069400     ADD 2 TO PV-LINE-COUNT.                                      06940018
069500                                                                  06950018
069600******************************************************************06960018
069700* READ DATE CONTROL CARD.                                         06970018
069800******************************************************************06980018
069900 8000-READ-DATE-CONTROL-FILE.                                     06990018
070000                                                                  07000018
070100     READ DATE-CONTROL-FILE INTO CC-DATE-CONTROL-CARD             07010018
070200        AT END                                                    07020018
070300           SET PS-DATE-CONTROL-EOF-YES TO TRUE.                   07030018
070400                                                                  07040018
070500     IF  PS-DATE-CONTROL-EOF-NO                                   07050018
070600         ADD 1 TO PA-DATE-CONTROL-RECS-READ                       07060018
070700     END-IF.                                                      07070018
070800                                                                  07080018
070900************************************************************      07090018
071000* READ BAG FEE FILE                                               07100018
071100************************************************************      07110018
071200 8100-READ-BAG-FEE-FILE.                                          07120018
071300                                                                  07130018
071400     READ BAG-FEE-FILE INTO TX002-BAG-FEE-RECORD                  07140018
071500        AT END                                                    07150018
071600           SET PS-BAG-FEE-EOF-YES TO TRUE.                        07160018
071700                                                                  07170018
071800     IF PS-BAG-FEE-EOF-NO                                         07180018
071900         ADD 1 TO PA-BAG-FEE-RECS-READ                            07190018
072000     END-IF.                                                      07200018
072100                                                                  07210018
072110******************************************************************07211023
072120* GET FISCAL PERIOD START DATE                                    07212023
072130******************************************************************07213023
072140 9100-GET-FISCAL-PERIOD-START.                                    07214023
072150                                                                  07215023
072160     INITIALIZE DPG51 DPG52 DPG53                                 07216023
072170                DPG54 DPG55 DPG56.                                07217023
072180                                                                  07218023
072190     SET DPG51-FISCAL-454-CALENDAR   TO TRUE.                     07219023
072191     SET DPG52-LK-DTE-ISO-FMT        TO TRUE.                     07219123
072192                                                                  07219223
072193     MOVE CC-FISCAL-END-DATE         TO DPG52-LK-DATE-INPUT.      07219323
072194                                                                  07219423
072195     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    07219523
072196                                             DPG54 DPG55 DPG56.   07219623
072197                                                                  07219723
072198     IF  DPG54-SEVERE-ERROR                                       07219823
072199         DISPLAY '*********************************'              07219923
072200         DISPLAY '** ABEND FROM CALL SUB         **'              07220023
072201         DISPLAY '** PROGRAM = TXKRP010          **'              07220123
072202         DISPLAY '** DATE = ' CC-FISCAL-END-DATE '     **'        07220223
072203         DISPLAY '*********************************'              07220323
072204         DISPLAY DPG54-ERROR-MESSAGE                              07220423
072205         SET ABEND-4019-CAL-SUB-ERROR  TO TRUE                    07220523
072206         PERFORM 9999-ABEND                                       07220623
072207     ELSE                                                         07220723
072208     IF  DPG54-DATE-INVALID                                       07220823
072209         DISPLAY '*********************************'              07220923
072210         DISPLAY '** ABEND INVALID END DATE      **'              07221023
072211         DISPLAY '** PROGRAM = TXKRP010          **'              07221123
072212         DISPLAY '** DATE = ' CC-FISCAL-END-DATE '         **'    07221223
072213         DISPLAY '*********************************'              07221323
072214         DISPLAY DPG54-ERROR-MESSAGE                              07221423
072215         SET ABEND-4003-INVALID-CNTL-CARD TO TRUE                 07221523
072216         PERFORM 9999-ABEND                                       07221623
072217     END-IF                                                       07221723
072218     END-IF.                                                      07221823
072219                                                                  07221923
072220     MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO PV-HOLD-PERIOD-START-DTE. 07222023
072221     MOVE DPG56-LAST-FP-DB2-ISO-FMT  TO PV-HOLD-PERIOD-END-DTE.   07222123
072222                                                                  07222223
072223************************************************************      07222323
072224* INITIALIZE HEADING DATE AND TIME                                07222423
072225************************************************************      07222523
072226 9200-INITIALIZE-HEADING.                                         07222623
072227                                                                  07222723
072228     MOVE PV-CURRENT-MM                TO DP132O-RUN-MONTH.       07222823
072229     MOVE PV-CURRENT-DD                TO DP132O-RUN-DAY.         07222923
072230     MOVE PV-CURRENT-YY                TO DP132O-RUN-YEAR.        07223023
072231     MOVE PV-CURRENT-HOUR              TO DP132O-RUN-HOUR.        07223123
072232     MOVE PV-CURRENT-MIN               TO DP132O-RUN-MINUTE.      07223223
072233     MOVE 'TXKRP010'                   TO DP132O-PROGRAM-NAME.    07223323
072234     MOVE 1                            TO DP132O-REPORT-NUMBER.   07223423
072235                                                                  07223523
072236     MOVE PV-HOLD-PERIOD-START-MM      TO HD03-PERIOD-START-MM.   07223623
072237     MOVE PV-HOLD-PERIOD-START-DD      TO HD03-PERIOD-START-DD.   07223723
072238     MOVE PV-HOLD-PERIOD-START-CCYY    TO HD03-PERIOD-START-CCYY. 07223823
072239     MOVE PV-HOLD-PERIOD-END-MM        TO HD03-PERIOD-END-MM.     07223923
072240     MOVE PV-HOLD-PERIOD-END-DD        TO HD03-PERIOD-END-DD.     07224023
072241     MOVE PV-HOLD-PERIOD-END-CCYY      TO HD03-PERIOD-END-CCYY.   07224123
072242                                                                  07224223
072250************************************************************      07225018
072300*  ABEND - PERFORMS A NON-SQL-ABEND                               07230018
072400************************************************************      07240018
072500 9999-ABEND.                                                      07250023
072600                                                                  07260018
072700     DISPLAY '** ABEND           **'.                             07270018
072800     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  07280018
072900     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        07290018
073000     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       07300018
073100     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       07310018
073200     CALL 'ILBOABN0' USING ABEND-CODE.                            07320018
073300                                                                  07330018
076000************************************************************      07600018
076100*             E N D    O F    P R O G R A M                       07610018
076200************************************************************      07620018
