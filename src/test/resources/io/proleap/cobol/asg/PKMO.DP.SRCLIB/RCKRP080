000100*-------------------------------*                                 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-------------------------------*                                 00030000
000400 PROGRAM-ID.     RCKRP080.                                        00040000
000500 AUTHOR.         JOHN HUTCHINSON.                                 00050000
000600 INSTALLATION.   KOHLS DEPARTMENT STORES.                         00060000
000700 DATE-WRITTEN    APRIL, 2003.                                     00070000
000800*----------------------------------------------------------------*00080000
000900*    THIS PROGRAM CREATES THE MONTHLY, SEASONAL AND YEAR-END      00090015
001000*    OVER/SHORT ANALYSIS SUMMARY REPORTS.                         00100015
001100*                                                                 00110000
001200*    BASED ON A INPUT CONTROL FILE WHICH CONTAINS WHAT TYPE OF RUN00120000
001300*    IS BEING DONE, THE PROGRAM WILL CREATE REPORTS BY GMM, DMM,  00130000
001400*    BUYER, COMPANY AND COLBY INTERNATIONAL.                      00140000
001500*                                                                 00150000
001600*    THIS IS CLONE OF RCKRP078 BUT HAS THE ADDITIONAL FEATURE     00160005
001700*    WHEREBY ONLY A LIMITED NUMBER OF VENDORS ARE PRINTED BASED   00170015
001800*    ON DB2 TABLE TKRPRPM FOR THE TYPE OF REPORTS BEING CREATED.  00180015
001900*----------------------------------------------------------------*00190000
002000*-------------------------------*                                 00200000
002100 ENVIRONMENT DIVISION.                                            00210000
002200*-------------------------------*                                 00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400 FILE-CONTROL.                                                    00240000
002500     SELECT DATE-FILE         ASSIGN TO UT-S-IN01.                00250000
002600     SELECT CONTROL-FILE      ASSIGN TO UT-S-IN02.                00260000
002700     SELECT INPUT-FILE        ASSIGN TO INP01.                    00270000
002800     SELECT REPORT-FILE       ASSIGN TO RPT01.                    00280000
002900                                                                  00290000
003000*-------------------------------*                                 00300000
003100 DATA DIVISION.                                                   00310000
003200*-------------------------------*                                 00320000
003300 FILE SECTION.                                                    00330000
003400 FD  DATE-FILE                                                    00340000
003500     RECORDING MODE IS F                                          00350000
003600     LABEL RECORDS ARE STANDARD                                   00360000
003700     BLOCK CONTAINS 0 RECORDS.                                    00370000
003800 01  DATE-RECORD                 PIC X(80).                       00380000
003900                                                                  00390029
004000 FD  CONTROL-FILE                                                 00400000
004100     RECORDING MODE IS F                                          00410000
004200     LABEL RECORDS ARE STANDARD                                   00420000
004300     BLOCK CONTAINS 0 RECORDS.                                    00430000
004400 01  CONTROL-RECORD              PIC X(80).                       00440000
004500                                                                  00450000
004600 FD  INPUT-FILE                                                   00460000
004700     RECORDING MODE IS F                                          00470000
004800     LABEL RECORDS ARE STANDARD                                   00480000
004900     BLOCK CONTAINS 0 RECORDS.                                    00490000
005000 01  INPUT-RECORD                PIC X(400).                      00500039
005100                                                                  00510000
005200 FD  REPORT-FILE                                                  00520000
005300     RECORDING MODE IS F                                          00530000
005400     BLOCK CONTAINS 0 RECORDS                                     00540000
005500     LABEL RECORDS ARE OMITTED.                                   00550000
005600 01  REPORT-RECORD               PIC  X(150).                     00560030
005700                                                                  00570000
005800*-------------------------------*                                 00580000
005900 WORKING-STORAGE SECTION.                                         00590000
006000*-------------------------------*                                 00600000
006100 01  PS-SWITCHES.                                                 00610000
006200     05  PS-INPUT-EOF-SW            PIC  X(01) VALUE 'N'.         00620022
006300         88  PS-INPUT-EOF-YES                  VALUE 'Y'.         00630000
006400         88  PS-INPUT-EOF-NO                   VALUE 'N'.         00640000
006500     05  PS-INPUT-DATA-SW           PIC  X(01) VALUE 'Y'.         00650022
006600         88  PS-INPUT-DATA-YES                 VALUE 'Y'.         00660017
006700         88  PS-INPUT-DATA-NO                  VALUE 'N'.         00670017
006800     05  PS-PROCESS-CURR-SW         PIC  X(01) VALUE 'Y'.         00680022
006900         88  PS-PROCESS-CURR-YES               VALUE 'Y'.         00690000
007000         88  PS-PROCESS-CURR-NO                VALUE 'N'.         00700000
007100     05  PS-LINE-PRINTED-SW         PIC  X(01) VALUE 'N'.         00710022
007200         88  PS-LINE-PRINTED-YES               VALUE 'Y'.         00720010
007300         88  PS-LINE-PRINTED-NO                VALUE 'N'.         00730010
007400     05  PS-PRINT-HEADINGS-SW       PIC  X(01) VALUE 'N'.         00740022
007500         88  PS-PRINT-HEADINGS-YES             VALUE 'Y'.         00750000
007600         88  PS-PRINT-HEADINGS-NO              VALUE 'N'.         00760000
007700     05  PS-LIMIT-REPORT-LINES      PIC  X(01) VALUE 'Y'.         00770022
007800         88  PS-LIMIT-REPORT-LINES-YES         VALUE 'Y'.         00780001
007900         88  PS-LIMIT-REPORT-LINES-NO          VALUE 'N'.         00790001
008000     05  PS-ADD-TO-TOTALS-SW        PIC  X(01) VALUE 'Y'.         00800022
008100         88  PS-ADD-TO-TOTALS-YES              VALUE 'Y'.         00810003
008200         88  PS-ADD-TO-TOTALS-NO               VALUE 'N'.         00820003
008300     05  PS-VALID-DATA-TO-PRINT-SW  PIC  X(01) VALUE 'N'.         00830017
008400         88  PS-VALID-DATA-TO-PRINT-YES        VALUE 'Y'.         00840017
008500         88  PS-VALID-DATA-TO-PRINT-NO         VALUE 'N'.         00850017
008600                                                                  00860003
008700 01  PC-PROGRAM-CONSTANTS.                                        00870003
008800     05  PC-RPT-NBR-GMM             PIC 9(01) VALUE 1.            00880039
008900     05  PC-RPT-NBR-DMM             PIC 9(01) VALUE 2.            00890039
009000     05  PC-RPT-COMPANY             PIC 9(01) VALUE 3.            00900039
009100     05  PC-RPT-NBR-BYR             PIC 9(01) VALUE 4.            00910039
009200     05  PC-RPT-NBR-COLBY           PIC 9(01) VALUE 5.            00920039
009300     05  PC-ONE                     PIC 9(01) VALUE 1.            00930039
009400     05  PC-TWENTY-EIGHT            PIC 9(02) VALUE 28.           00940039
009500     05  PC-LINE-LIMIT              PIC S9(4) VALUE +62 COMP.     00950039
009600     05  PC-PCT-SIGN                PIC X(01) VALUE '%'.          00960039
009700     05  PC-PERIOD-06               PIC X(02) VALUE '06'.         00970039
009800     05  PC-PERIOD-07               PIC X(02) VALUE '07'.         00980039
009900     05  PC-CURRENT-PROGRAM         PIC X(08) VALUE 'RCKRP080'.   00990044
010000     05  PC-RUN-TYPE-GMM            PIC X(10) VALUE 'GMM       '. 01000039
010100     05  PC-RUN-TYPE-DMM            PIC X(10) VALUE 'DMM       '. 01010039
010200     05  PC-RUN-TYPE-COMPANY        PIC X(10) VALUE 'COMPANY   '. 01020039
010300     05  PC-RUN-TYPE-BYR            PIC X(10) VALUE 'BUYER     '. 01030039
010400     05  PC-RUN-TYPE-COLBY          PIC X(10) VALUE 'COLBY     '. 01040039
010500     05  PC-RUN-TYPE-VENDOR         PIC X(10) VALUE 'VENDOR    '. 01050039
010600     05  PC-TITLE-NAME-1            PIC X(05) VALUE 'TOTAL'.      01060039
010700     05  PC-TITLE-NAME-2            PIC X(05) VALUE 'FINAL'.      01070039
010800     05  PC-RUN-TYPE-KOHLS          PIC X(25) VALUE               01080039
010900                                    'KOHL''S DEPARTMENT STORES'.  01090039
011000     05  PC-RUN-TYPE-COLBY-INTL     PIC X(25) VALUE               01100039
011100                                    'COLBY INTERNATIONAL LTD  '.  01110039
011200     05  PC-FUNC-GMM                PIC X(06) VALUE 'RCRGMM'.     01120039
011300     05  PC-FUNC-DMM                PIC X(06) VALUE 'RCRDMM'.     01130039
011400     05  PC-FUNC-CMP                PIC X(06) VALUE 'RCRCMP'.     01140039
011500     05  PC-FUNC-CBY                PIC X(06) VALUE 'RCRCBY'.     01150039
011600     05  PC-FUNCTION                PIC X(06) VALUE SPACES.       01160039
011700                                                                  01170000
011800 01  PV-PROGRAM-VARIABLES.                                        01180000
011900     05  PV-LINE-COUNT              PIC S9(4) VALUE +66.          01190039
012000     05  PV-PAGE-COUNT              PIC S9(4) VALUE +0.           01200039
012100     05  PV-VENDOR-COUNT            PIC S9(4) VALUE +0.           01210039
012200     05  PV-REC-COUNT               PIC S9(9) VALUE +0.           01220039
012300     05  PV-RECORD-CNT-YTD       PIC S9(05)     VALUE +0.         01230041
012400     05  PV-HOLD-PO-COUNT        PIC S9(09)     VALUE +0.         01240041
012500     05  PV-PCT-OVER             PIC S9(03)V999 VALUE +0.         01250041
012600     05  PV-PCT-SHORT            PIC S9(03)V999 VALUE +0.         01260041
012700     05  PV-HOLD-BYR-NMBR        PIC  X(03)     VALUE SPACES.     01270061
012800     05  PV-HOLD-DMM-NMBR        PIC  X(02)     VALUE SPACES.     01280061
012900     05  PV-HOLD-GMM-NMBR        PIC  X(02)     VALUE SPACES.     01290061
013000     05  PV-HOLD-VENDOR-DESC     PIC  X(30)     VALUE SPACES.     01300061
013100     05  PV-HOLD-IMPRT-VEND      PIC  X(35)     VALUE SPACES.     01310000
013200                                                                  01320001
013300     05  PV-DISPLAY-QTY1         PIC ZZZ,ZZZ,ZZ9-.                01330051
013400     05  PV-DISPLAY-QTY2         PIC ZZZ,ZZZ,ZZ9-.                01340051
013500     05  PV-DISPLAY-QTY3         PIC ZZZ,ZZZ,ZZ9-.                01350056
013600     05  PV-EXPTED-ITM-QTY       PIC S9(09).                      01360042
013700     05  PV-TOTAL-OVER-SHORT     PIC S9(09).                      01370042
013800     05  PV-INTENDED-ORD-QTY     PIC S9(09).                      01380042
013900     05  PV-STILL-EXPECT-QTY     PIC S9(09).                      01390042
014000     05  PV-ACCURACY             PIC S9(3)V9(5).                  01400042
014100     05  PV-ACCURACY-999         PIC S9(3).                       01410054
014200                                                                  01420042
014300 01  RUN-CONTROL-RECORD.                                          01430001
014400     05  CC-RUN-CONTROL             PIC X(07).                    01440039
014500         88  CC-GMM-NBR                       VALUE 'GMM NBR'.    01450039
014600         88  CC-DMM-NBR                       VALUE 'DMM NBR'.    01460039
014700         88  CC-COMPANY                       VALUE 'COMPANY'.    01470039
014800         88  CC-BYR-NBR                       VALUE 'BYR NBR'.    01480039
014900         88  CC-COLBY                         VALUE 'COLBY  '.    01490039
015000     05  FILLER                     PIC X(73).                    01500039
015100                                                                  01510001
015200 01  CC-CONTROL-CARD-PARAMETERS.                                  01520001
015300     05  CC-EXTRACT-DATE            PIC X(02) VALUE SPACES.       01530039
015400         88  CC-VALID-DATE                    VALUE 'AR' 'VE'     01540039
015500                                                    'BT'.         01550039
015600         88  CC-ARRIVED-DATE-EXTRACT          VALUE 'AR'.         01560039
015700         88  CC-VERIFYD-DATE-EXTRACT          VALUE 'VE'.         01570039
015800         88  CC-BOTH-DATE-EXTRACT             VALUE 'BT'.         01580039
015900     05  FILLER                     PIC X(01) VALUE SPACE.        01590039
016000     05  CC-EXTRACT-TYPE            PIC X(01) VALUE SPACE.        01600039
016100         88  CC-VALID-TYPE                    VALUE 'P' 'Q'       01610039
016200                                                    'S' 'Y'.      01620039
016300         88  CC-PERIOD-NUMBER                 VALUE 'P'.          01630039
016400         88  CC-QUARTER-NUMBER                VALUE 'Q'.          01640039
016500         88  CC-SEASON-NUMBER                 VALUE 'S'.          01650039
016600         88  CC-YEAR-END                      VALUE 'Y'.          01660039
016700     05  FILLER                     PIC X     VALUE SPACE.        01670039
016800     05  CC-EXTRACT-SEASON          PIC X(07) VALUE SPACE.        01680039
016900         88  CC-EXTRACT-VALID-SEASON          VALUE 'SPRING '     01690039
017000                                                    'FALL   '     01700039
017100                                                    'YEAREND'     01710039
017200                                                    'PERIOD '.    01720039
017300         88  CC-EXTRACT-SPRING                VALUE 'SPRING '.    01730039
017400         88  CC-EXTRACT-FALL                  VALUE 'FALL   '.    01740039
017500         88  CC-EXTRACT-YEAR-END              VALUE 'YEAREND'.    01750039
017600         88  CC-EXTRACT-PERIOD                VALUE 'PERIOD '.    01760039
017700     05  FILLER                     PIC X(68) VALUE SPACE.        01770039
017800                                                                  01780000
017900 01  PV-CURRENT-DATE-TIME.                                        01790000
018000     05  PV-CURRENT-DATE.                                         01800000
018100         10  PV-CURRENT-YY          PIC 9(02) VALUE ZERO.         01810039
018200         10  PV-CURRENT-MM          PIC 9(02) VALUE ZERO.         01820039
018300         10  PV-CURRENT-DD          PIC 9(02) VALUE ZERO.         01830039
018400     05  PV-CURRENT-TIME.                                         01840039
018500         10  PV-CURRENT-HOUR        PIC 9(02) VALUE ZERO.         01850039
018600         10  PV-CURRENT-MINUTE      PIC 9(02) VALUE ZERO.         01860039
018700         10  FILLER                 PIC 9(04) VALUE ZERO.         01870039
018800                                                                  01880039
018900 01  PV-DATE-AREA.                                                01890000
019000     05  PV-DATE-AREA-MM            PIC 9(02) VALUE ZERO.         01900039
019100     05  FILLER                     PIC X(01) VALUE '/'.          01910039
019200     05  PV-DATE-AREA-DD            PIC 9(02) VALUE ZERO.         01920039
019300     05  FILLER                     PIC X(01) VALUE '/'.          01930039
019400     05  PV-DATE-AREA-YY            PIC 9(02) VALUE ZERO.         01940039
019500                                                                  01950000
019600 01  PV-START-EXTRACT               PIC X(26) VALUE SPACE.        01960039
019700 01  FILLER REDEFINES PV-START-EXTRACT.                           01970039
019800     05  PV-START-CCYY-MM-DD.                                     01980039
019900         10  PV-START-EXTRACT-YYYY  PIC 9(04).                    01990039
020000         10  PV-START-EXTRACT-1ST   PIC X(01).                    02000039
020100         10  PV-START-EXTRACT-MM    PIC 9(02).                    02010039
020200         10  PV-START-EXTRACT-2ND   PIC X(01).                    02020039
020300         10  PV-START-EXTRACT-DD    PIC 9(02).                    02030039
020400     05  PV-START-EXTRACT-3RD       PIC X(01).                    02040039
020500     05  PV-START-TIMESTAMP         PIC X(15).                    02050039
020600                                                                  02060000
020700 01  PV-END-EXTRACT                 PIC X(26) VALUE SPACE.        02070039
020800 01  FILLER REDEFINES PV-END-EXTRACT.                             02080039
020900     05  PV-END-CCYY-MM-DD.                                       02090039
021000         10  PV-END-EXTRACT-YYYY    PIC 9(04).                    02100039
021100         10  PV-END-EXTRACT-YYYY-RE REDEFINES                     02110039
021200                                    PV-END-EXTRACT-YYYY.          02120039
021300             15  PV-END-EXTRACT-CC  PIC 9(02).                    02130039
021400             15  PV-END-EXTRACT-YY  PIC 9(02).                    02140039
021500         10  PV-END-EXTRACT-1ST     PIC X(01).                    02150039
021600         10  PV-END-EXTRACT-MM      PIC 9(02).                    02160039
021700         10  PV-END-EXTRACT-2ND     PIC X(01).                    02170039
021800         10  PV-END-EXTRACT-DD      PIC 9(02).                    02180039
021900     05  PV-END-EXTRACT-3RD         PIC X(01).                    02190039
022000     05  PV-END-TIMESTAMP           PIC X(15).                    02200039
022100                                                                  02210000
022200 01  PV-YEAR-FORMAT.                                              02220000
022300     05  PV-YEAR-FORMAT-CC          PIC 9(02) VALUE ZERO.         02230039
022400     05  PV-YEAR-FORMAT-YY          PIC 9(02) VALUE ZERO.         02240039
022500                                                                  02250000
022600 01  PV-ABEND-FIELDS.                                             02260000
022700     05  PV-ABEND-CODE           PIC S9(04) VALUE +0 COMP.        02270000
022800     05  PV-ABEND-PROGRAM        PIC  X(08) VALUE 'RCKRP080'.     02280000
022900     05  PV-SQLCODE              PIC  9(9)- VALUE ZEROS.          02290039
023000     05  PV-ABEND-PARAGRAPH      PIC  X(50) VALUE SPACES.         02300001
023100     05  PV-ABEND-DISPLAY-1      PIC  X(50) VALUE SPACES.         02310001
023200     05  PV-ABEND-DISPLAY-2      PIC  X(50) VALUE SPACES.         02320001
023300     05  PV-ABEND-DISPLAY-3      PIC  X(50) VALUE SPACES.         02330001
023400     05  PV-ABEND-OPERATION      PIC  X(50) VALUE SPACES.         02340001
023500     05  PV-ABEND-STRUCT-1       PIC  X(08) VALUE SPACES.         02350001
023600     05  PV-ABEND-STRUCT-2       PIC  X(08) VALUE SPACES.         02360001
023700     05  PV-DB2-OPER-MESS-1      PIC  X(79) VALUE SPACES.         02370001
023800     05  PV-DB2-OPER-MESS-2      PIC  X(79) VALUE SPACES.         02380001
023900     05  PV-DB2-OPER-MESS-3      PIC  X(79) VALUE SPACES.         02390001
024000     05  PV-DB2-TABLE-NAME       PIC  X(08) VALUE SPACES.         02400001
024100                                                                  02410001
024200*    ---------------------                                        02420001
024300*    INPUT DATE RECORD                                            02430001
024400*    ---------------------                                        02440001
024500     COPY RCRD067.                                                02450000
024600                                                                  02460000
024700 01  PV-HOLD-DATE-END.                                            02470000
024800     05  PV-HOLD-DATE-CCYY          PIC X(04) VALUE SPACES.       02480039
024900     05  FILLER                     PIC X(01) VALUE '-'.          02490039
025000     05  PV-HOLD-DATE-MM            PIC X(02) VALUE SPACES.       02500039
025100     05  FILLER                     PIC X(01) VALUE '-'.          02510039
025200     05  PV-HOLD-DATE-DD            PIC X(02) VALUE SPACES.       02520039
025300                                                                  02530000
025400 01  PV-DETAIL-TOTALS.                                            02540039
025500     05  PV-EXPTED-ITM-QTY-D2       PIC S9(09).                   02550039
025600     05  PV-TOTAL-OVER-SHORT-D2     PIC S9(09).                   02560039
025700     05  PV-INTENDED-ORD-QTY-D2     PIC S9(09).                   02570039
025800     05  PV-STILL-EXPECT-QTY-D2     PIC S9(09).                   02580039
025900                                                                  02590039
026000 01  PV-BREAK-TOTALS.                                             02600039
026100     05  PV-BRK-PO-COUNT            PIC S9(9) VALUE +0.           02610039
026200     05  PV-BRK-EXPTED-ITM-QTY      PIC S9(9) VALUE +0.           02620039
026300     05  PV-BRK-VERIFY-ITM-QTY      PIC S9(9) VALUE +0.           02630039
026400     05  PV-BRK-CURR-SPLIT-QTY      PIC S9(9) VALUE +0.           02640039
026500     05  PV-BRK-OVR-QTY             PIC S9(9) VALUE +0.           02650039
026600     05  PV-BRK-SHT-QTY             PIC S9(9) VALUE +0.           02660039
026700     05  PV-BRK-UNITS-OVER          PIC S9(9) VALUE +0.           02670039
026800     05  PV-BRK-UNITS-SHORT         PIC S9(9) VALUE +0.           02680039
026900     05  PV-BRK-OVR-RETAIL          PIC S9(9)V99  VALUE +0.       02690039
027000     05  PV-BRK-SHT-RETAIL          PIC S9(9)V99  VALUE +0.       02700039
027100     05  PV-BRK-OVSH                PIC S9(9)V99  VALUE +0.       02710039
027200     05  PV-BRK-PCT-OVER            PIC S9(3)V999 VALUE +0.       02720039
027300     05  PV-BRK-PCT-SHORT           PIC S9(3)V999 VALUE +0.       02730039
027400     05 PV-EXPTED-ITM-QTY-B1      PIC S9(09).                     02740039
027500     05  PV-TOTAL-OVER-SHORT-B1     PIC S9(09).                   02750039
027600     05  PV-INTENDED-ORD-QTY-B1     PIC S9(09).                   02760039
027700     05  PV-STILL-EXPECT-QTY-B1     PIC S9(09).                   02770039
027800     05  PV-EXPTED-ITM-QTY-B2       PIC S9(09).                   02780039
027900     05  PV-TOTAL-OVER-SHORT-B2     PIC S9(09).                   02790039
028000     05  PV-INTENDED-ORD-QTY-B2     PIC S9(09).                   02800039
028100     05  PV-STILL-EXPECT-QTY-B2     PIC S9(09).                   02810039
028200                                                                  02820000
028300 01 PV-FINAL-TOTALS.                                              02830039
028400     05  PV-TOT-PO-COUNT            PIC S9(9) VALUE +0.           02840039
028500     05  PV-TOT-EXPTED-ITM-QTY      PIC S9(9) VALUE +0.           02850039
028600     05  PV-TOT-VERIFY-ITM-QTY      PIC S9(9) VALUE +0.           02860039
028700     05  PV-TOT-CURR-SPLIT-QTY      PIC S9(9) VALUE +0.           02870039
028800     05  PV-TOT-OVR-QTY             PIC S9(9) VALUE +0.           02880039
028900     05  PV-TOT-SHT-QTY             PIC S9(9) VALUE +0.           02890039
029000     05  PV-TOT-UNITS-OVER          PIC S9(9) VALUE +0.           02900039
029100     05  PV-TOT-UNITS-SHORT         PIC S9(9) VALUE +0.           02910039
029200     05  PV-TOT-OVR-RETAIL          PIC S9(9)V99  VALUE +0.       02920039
029300     05  PV-TOT-SHT-RETAIL          PIC S9(9)V99  VALUE +0.       02930039
029400     05  PV-TOT-OVSH                PIC S9(9)V99  VALUE +0.       02940039
029500     05  PV-TOT-PCT-OVER            PIC S9(3)V999 VALUE +0.       02950039
029600     05  PV-TOT-PCT-SHORT           PIC S9(3)V999 VALUE +0.       02960039
029700     05  PV-EXPTED-ITM-QTY-T1       PIC S9(09).                   02970039
029800     05  PV-TOTAL-OVER-SHORT-T1     PIC S9(09).                   02980039
029900     05  PV-INTENDED-ORD-QTY-T1     PIC S9(09).                   02990039
030000     05  PV-STILL-EXPECT-QTY-T1     PIC S9(09).                   03000039
030100     05  PV-EXPTED-ITM-QTY-T2       PIC S9(09).                   03010039
030200     05  PV-TOTAL-OVER-SHORT-T2     PIC S9(09).                   03020039
030300     05  PV-INTENDED-ORD-QTY-T2     PIC S9(09).                   03030039
030400     05  PV-STILL-EXPECT-QTY-T2     PIC S9(09).                   03040039
030500                                                                  03050039
030600******************************************************************03060032
030700*                     P R I N T   L I N E S                      *03070032
030800******************************************************************03080032
030900 01  HL1-HEADING-LINE-1.                                          03090039
031000     05  HL1-RUN-DATE.                                            03100039
031100         10  HL1-RUN-MONTH          PIC 9(02) VALUE ZERO.         03110039
031200         10  FILLER                 PIC X(01) VALUE '/'.          03120039
031300         10  HL1-RUN-DAY            PIC 9(02) VALUE ZERO.         03130039
031400         10  FILLER                 PIC X(01) VALUE '/'.          03140039
031500         10  HL1-RUN-YEAR           PIC 9(02) VALUE ZERO.         03150039
031600     05  FILLER                     PIC X(02) VALUE SPACE.        03160039
031700     05  HL1-RUN-TIME.                                            03170039
031800         10  HL1-RUN-HOUR           PIC 9(02) VALUE ZERO.         03180039
031900         10  FILLER                 PIC X(01) VALUE ':'.          03190039
032000         10  HL1-RUN-MINUTE         PIC 9(02) VALUE ZERO.         03200039
032100     05  FILLER                     PIC X(39) VALUE SPACE.        03210039
032200     05  FILLER                     PIC X(47) VALUE               03220039
032300         'K O H L '' S   D E P A R T M E N T   S T O R E S'.      03230039
032400     05  FILLER                     PIC X(28) VALUE SPACE.        03240039
032500     05  HL1-PROGRAM-NAME           PIC X(08) VALUE SPACE.        03250039
032600     05  FILLER                     PIC X(01) VALUE '-'.          03260039
032700     05  HL1-REPORT-NUMBER          PIC 9(01) VALUE ZERO.         03270039
032800     05  FILLER                     PIC X(02) VALUE SPACE.        03280039
032900     05  FILLER                     PIC X(05) VALUE 'PAGE '.      03290039
033000     05  HL1-PAGE-NUMBER            PIC ZZZ9  VALUE ZERO.         03300039
033100                                                                  03310039
033200 01  HL2-HEADING-LINE-2.                                          03320039
033300     05  FILLER                 PIC X(55) VALUE SPACES.           03330039
033400     05  FILLER                 PIC X(45) VALUE                   03340039
033500         'OVERAGE/SHORTAGE RECEIVED REPORT (IN 1000''S)'.         03350039
033600     05  FILLER                 PIC X(50) VALUE SPACES.           03360039
033700                                                                  03370039
033800 01  HL2-HEADING-LINE-2B.                                         03380039
033900     05  FILLER                 PIC X(40) VALUE SPACES.           03390039
034000     05  FILLER                 PIC X(04) VALUE 'FOR '.           03400039
034100     05  HL2-MONTH              PIC X(06) VALUE 'MONTH '.         03410039
034200     05  HL2-MONTH-YEAR-START   PIC X(10) VALUE SPACES.           03420039
034300     05  FILLER                 PIC X(03) VALUE ' - '.            03430039
034400     05  HL2-MONTH-YEAR-END     PIC X(10) VALUE SPACES.           03440039
034500     05  FILLER                 PIC X(02) VALUE SPACES.           03450039
034600     05  HL2-FISCAL-PERIOD.                                       03460039
034700         10  FILLER             PIC X(16)                         03470039
034800                                VALUE 'FISCAL PERIOD - '.         03480039
034900         10  HL2-PERIOD         PIC X(02) VALUE SPACES.           03490039
035000     05  FILLER                 PIC X(02) VALUE SPACES.           03500039
035100     05  HL2-FISCAL-PERIOD.                                       03510039
035200         10  FILLER             PIC X(17)                         03520039
035300                                VALUE 'FISCAL QUARTER - '.        03530039
035400         10  HL2-QUARTER        PIC X(02) VALUE SPACES.           03540039
035500     05  FILLER                 PIC X(02) VALUE SPACES.           03550039
035600     05  HL2-FISCAL-SEASON.                                       03560039
035700         10  FILLER             PIC X(18)                         03570039
035800                                VALUE 'SEASONAL REPORT - '.       03580039
035900         10  HL2-SEASON         PIC X(06) VALUE SPACES.           03590039
036000     05  FILLER                 PIC X(10) VALUE SPACES.           03600039
036100                                                                  03610044
036200 01  HL2-HEADING-LINE-2C.                                         03620044
036300     05  FILLER                 PIC X(67) VALUE SPACES.           03630044
036400     05  FILLER                 PIC X(04) VALUE 'TOP '.           03640044
036500     05  HL2-VENDOR-CNT         PIC ZZZ9.                         03650044
036600     05  FILLER                 PIC X(08) VALUE ' VENDORS'.       03660044
036700     05  FILLER                 PIC X(67) VALUE SPACES.           03670044
036800                                                                  03680039
036900 01  HL3-HEADING-LINE-3.                                          03690039
037000     05  FILLER                 PIC X(14) VALUE                   03700039
037100                               'REPORT TYPE - '.                  03710039
037200     05  HL3-REPORT-TYPE        PIC X(11) VALUE SPACES.           03720039
037300     05  FILLER                 PIC X(03) VALUE SPACES.           03730039
037400     05  HL3-USER-ID            PIC X(03) VALUE SPACES.           03740039
037500     05  FILLER                 PIC X(01) VALUE SPACES.           03750039
037600     05  HL3-SEQUENCE-TYPE      PIC X(30) VALUE SPACES.           03760039
037700     05  FILLER                 PIC X(05) VALUE SPACES.           03770039
037800     05  FILLER                 PIC X(13) VALUE '| OVERAGE    '.  03780039
037900     05  FILLER                 PIC X(13) VALUE SPACES.           03790039
038000     05  FILLER                 PIC X(13) VALUE '| SHORTAGE   '.  03800039
038100     05  FILLER                 PIC X(15) VALUE SPACES.           03810039
038200     05  FILLER                 PIC X(13) VALUE '| TOTAL      '.  03820039
038300     05  FILLER                 PIC X(16) VALUE SPACES.           03830039
038400                                                                  03840039
038500 01  HL4-HEADING-LINE-4.                                          03850039
038600     05  FILLER                 PIC X(47) VALUE SPACES.           03860039
038700     05  FILLER                 PIC X(09) VALUE '   TOTAL '.      03870039
038800     05  FILLER                 PIC X(11) VALUE '    TOTAL  '.    03880039
038900     05  HL4-OVERAGE-GROUP.                                       03890039
039000         10  FILLER             PIC X(11) VALUE '|   TOTAL  '.    03900039
039100         10  FILLER             PIC X(07) VALUE '  TOTAL'.        03910039
039200         10  FILLER             PIC X(08) VALUE '  TOTAL '.       03920039
039300     05  HL4-SHORTAGE-GROUP.                                      03930039
039400         10  FILLER             PIC X(12) VALUE '|   TOTAL   '.   03940039
039500         10  FILLER             PIC X(07) VALUE '  TOTAL'.        03950039
039600         10  FILLER             PIC X(09) VALUE '   TOTAL '.      03960039
039700     05  HL4-TOTAL-GROUP.                                         03970039
039800         10  FILLER             PIC X(12) VALUE '|   TOTAL   '.   03980039
039900         10  FILLER             PIC X(08) VALUE '   NET  '.       03990039
040000         10  FILLER             PIC X(09) VALUE '|SHIPMENT'.      04000039
040100                                                                  04010039
040200 01  HL5-HEADING-LINE-5.                                          04020039
040300     05  FILLER                 PIC X(27) VALUE                   04030039
040400                                '                           '.    04040039
040500     05  FILLER                 PIC X(05) VALUE 'SALES'.          04050039
040600     05  FILLER                 PIC X(09) VALUE ' SHIPMENT'.      04060039
040700     05  FILLER                 PIC X(06) VALUE '   PO '.         04070039
040800     05  FILLER                 PIC X(09) VALUE '   UNITS '.      04080039
040900     05  FILLER                 PIC X(11) VALUE '    UNITS  '.    04090039
041000     05  HL5-OVERAGE-GROUP.                                       04100039
041100         10  FILLER             PIC X(11) VALUE '| UNITS ORD'.    04110039
041200         10  FILLER             PIC X(07) VALUE '   OVER'.        04120039
041300         10  FILLER             PIC X(08) VALUE '  %OVER '.       04130039
041400     05  HL5-SHORTAGE-GROUP.                                      04140039
041500         10  FILLER             PIC X(12) VALUE '| UNITS ORD '.   04150039
041600         10  FILLER             PIC X(07) VALUE '  SHORT'.        04160039
041700         10  FILLER             PIC X(09) VALUE '  %SHORT '.      04170039
041800     05  HL5-TOTAL-GROUP.                                         04180039
041900         10  FILLER             PIC X(12) VALUE '|   UNITS   '.   04190039
042000         10  FILLER             PIC X(08) VALUE ' RETAIL$'.       04200039
042100         10  FILLER             PIC X(09) VALUE '|ACCURACY'.      04210039
042200                                                                  04220039
042300 01  HL6-HEADING-LINE-6.                                          04230039
042400     05  FILLER                 PIC X(27) VALUE                   04240039
042500                                'VENDOR NAME                '.    04250039
042600     05  FILLER                 PIC X(05) VALUE ' RANK'.          04260039
042700     05  FILLER                 PIC X(09) VALUE ' ACCURACY'.      04270039
042800     05  FILLER                 PIC X(06) VALUE '  CNT '.         04280039
042900     05  FILLER                 PIC X(09) VALUE '  ORDERED'.      04290039
043000     05  FILLER                 PIC X(11) VALUE '  RECEIVED '.    04300039
043100     05  HL6-OVERAGE-GROUP.                                       04310039
043200         10  FILLER             PIC X(11) VALUE '| W/OVERAGE'.    04320039
043300         10  FILLER             PIC X(07) VALUE '  UNITS'.        04330039
043400         10  FILLER             PIC X(08) VALUE '   REC  '.       04340039
043500     05  HL6-SHORTAGE-GROUP.                                      04350039
043600         10  FILLER             PIC X(12) VALUE '| W/SHORTAGE'.   04360039
043700         10  FILLER             PIC X(07) VALUE '  UNITS'.        04370039
043800         10  FILLER             PIC X(09) VALUE '    REC  '.      04380039
043900     05  HL6-TOTAL-GROUP.                                         04390039
044000         10  FILLER             PIC X(12) VALUE '| OVER/SHORT'.   04400039
044100         10  FILLER             PIC X(08) VALUE ' IMPACT '.       04410039
044200         10  FILLER             PIC X(09) VALUE '|   YTD  '.      04420039
044300                                                                  04430039
044400 01  DL1-DETAIL-LINE-1.                                           04440039
044500     05  DL1-VENDOR-NAME        PIC X(27).                        04450039
044600     05  FILLER  REDEFINES  DL1-VENDOR-NAME.                      04460039
044700         10  DL1-ORDER-NBR      PIC 9(09).                        04470039
044800         10  FILLER             PIC X(18).                        04480039
044900     05  FILLER                 PIC X(01).                        04490039
045000     05  DL1-SALES-RANK         PIC ZZZ9.                         04500039
045100     05  FILLER                 PIC X(03).                        04510039
045200     05  DL1-SHIPMENT-ACCURACY  PIC ZZ9-.                         04520039
045300     05  DL1-PCT-1              PIC X(01).                        04530039
045400     05  FILLER                 PIC X(02).                        04540039
045500     05  DL1-PO-COUNT           PIC ZZZ9.                         04550039
045600     05  FILLER                 PIC X(02).                        04560039
045700     05  DL1-UNITS-ORD          PIC ZZ,ZZ9.9.                     04570039
045800     05  FILLER                 PIC X(02).                        04580039
045900     05  DL1-UNITS-RECV         PIC ZZ,ZZ9.9.                     04590039
046000     05  DL1-OVERAGE-GROUP.                                       04600039
046100         10  FILLER                   PIC  X(02).                 04610039
046200         10  DL1-UNITS-ORD-OVER       PIC  ZZ,ZZ9.9.              04620039
046300         10  FILLER                   PIC  X(02).                 04630039
046400         10  DL1-UNITS-RECV-OVER      PIC  Z,ZZ9.9.               04640039
046500         10  FILLER                   PIC  X(02).                 04650039
046600         10  DL1-PCT-OVER             PIC  ZZ9-.                  04660039
046700         10  DL1-PCT-2                PIC  X(01).                 04670039
046800     05  DL1-SHORTAGE-GROUP.                                      04680039
046900         10  FILLER                   PIC  X(02).                 04690039
047000         10  DL1-UNITS-ORD-SHORT      PIC  ZZ,ZZ9.9.              04700039
047100         10  FILLER                   PIC  X(02).                 04710039
047200         10  DL1-UNITS-RECV-SHORT     PIC  ZZ,ZZ9.9.              04720039
047300         10  FILLER                   PIC  X(03).                 04730039
047400         10  DL1-PCT-SHORT            PIC  ZZ9-.                  04740039
047500         10  DL1-PCT-3                PIC  X(01).                 04750039
047600     05  DL1-TOT-GROUP.                                           04760039
047700         10  FILLER                   PIC  X(02).                 04770039
047800         10  DL1-TOT-OVSH             PIC  ZZ,ZZ9.9.              04780039
047900         10  FILLER                   PIC  X(02).                 04790039
048000         10  DL1-TOT-RETAIL-IMPACT    PIC  ZZ,ZZ9.9-.             04800039
048100         10  FILLER                   PIC  X(03).                 04810039
048200         10  DL1-YTD-ACCURACY         PIC  ZZ9-.                  04820039
048300         10  DL1-PCT-4                PIC  X(01).                 04830039
048400         10  FILLER                   PIC  X(01).                 04840039
048500                                                                  04850039
048600 01  TL1-TOT-LINE-1.                                              04860039
048700     05  TL1-TITLE                    PIC  X(05).                 04870039
048800     05  FILLER                       PIC  X(01).                 04880039
048900     05  TL1-USER-ID                  PIC  X(03).                 04890039
049000     05  FILLER                       PIC  X(01).                 04900039
049100     05  TL1-VENDOR-NAME              PIC  X(24).                 04910039
049200     05  FILLER                       PIC  X(01).                 04920039
049300     05  TL1-SHIPMENT-ACCURACY        PIC  ZZ9-.                  04930039
049400     05  TL1-PCT-1                    PIC  X(01).                 04940039
049500     05  FILLER                       PIC  X(02).                 04950039
049600     05  TL1-PO-COUNT                 PIC  ZZZ9.                  04960039
049700     05  FILLER                       PIC  X(01).                 04970039
049800     05  TL1-UNITS-ORD                PIC  ZZZ,ZZ9.9.             04980039
049900     05  FILLER                       PIC  X(01).                 04990039
050000     05  TL1-UNITS-RECV               PIC  ZZZ,ZZ9.9.             05000039
050100     05  TL1-OVERAGE-GROUP.                                       05010039
050200         10  FILLER                   PIC  X(01).                 05020039
050300         10  TL1-UNITS-ORD-OVER       PIC  ZZZ,ZZ9.9.             05030039
050400         10  FILLER                   PIC  X(01).                 05040039
050500         10  TL1-UNITS-RECV-OVER      PIC  ZZ,ZZ9.9.              05050039
050600         10  FILLER                   PIC  X(02).                 05060039
050700         10  TL1-PCT-OVER             PIC  ZZ9-.                  05070039
050800         10  TL1-PCT-2                PIC  X(01).                 05080039
050900     05  TL1-SHORTAGE-GROUP.                                      05090039
051000         10  FILLER                   PIC  X(01).                 05100039
051100         10  TL1-UNITS-ORD-SHORT      PIC  ZZZ,ZZ9.9.             05110039
051200         10  FILLER                   PIC  X(01).                 05120039
051300         10  TL1-UNITS-RECV-SHORT     PIC  ZZZ,ZZ9.9.             05130039
051400         10  FILLER                   PIC  X(03).                 05140039
051500         10  TL1-PCT-SHORT            PIC  ZZ9-.                  05150039
051600         10  TL1-PCT-3                PIC  X(01).                 05160039
051700     05  TL1-TOT-GROUP.                                           05170039
051800         10  FILLER                   PIC  X(01).                 05180039
051900         10  TL1-TOT-OVSH             PIC  ZZZ,ZZ9.9.             05190039
052000         10  FILLER                   PIC  X(01).                 05200039
052100         10  TL1-TOT-RETAIL-IMPACT    PIC  ZZZ,ZZ9.9-.            05210039
052200         10  FILLER                   PIC  X(03).                 05220039
052300         10  TL1-YTD-ACCURACY         PIC  ZZ9-.                  05230039
052400         10  TL1-PCT-4                PIC  X(01).                 05240039
052500         10  FILLER                   PIC  X(01).                 05250039
052600                                                                  05260039
052700 01  PR-PRINT-DASH-1.                                             05270039
052800     05  FILLER                 PIC X(67) VALUE SPACES.           05280039
052900     05  FILLER                 PIC X(83) VALUE ALL '-'.          05290039
053000                                                                  05300039
053100 01  PR-PRINT-DASH-2.                                             05310039
053200     05  FILLER                 PIC X(150) VALUE ALL '-'.         05320039
053300                                                                  05330039
053400 01  PR-PRINT-DASH-3.                                             05340039
053500     05  FILLER                 PIC X(150) VALUE ALL '='.         05350039
053600                                                                  05360039
053700 01  PR-PRINT-BLANK-LINE.                                         05370039
053800     05  FILLER                 PIC X(150) VALUE SPACES.          05380039
053900                                                                  05390039
054000 01  PR-PRINT-FINAL.                                              05400039
054100     05  FILLER                 PIC X(64) VALUE SPACES.           05410039
054200     05  FILLER                 PIC X(21) VALUE                   05420039
054300                                '*** END OF REPORT ***'.          05430039
054400     05  FILLER                 PIC X(65) VALUE SPACES.           05440039
054500                                                                  05450039
054600 01  PR-PRINT-NO-DETAIL.                                          05460039
054700     05  FILLER                 PIC X(60) VALUE SPACES.           05470039
054800     05  FILLER                 PIC X(29) VALUE                   05480039
054900                                '*** NO DETAILS TO REPORT ***'.   05490039
055000     05  FILLER                 PIC X(61) VALUE SPACES.           05500039
055100                                                                  05510039
055200*---------------------------------------------------------------* 05520039
055300*    COPYBOOK USED FOR INPUT FILE                               * 05530039
055400*---------------------------------------------------------------* 05540039
055500     COPY RCRD065.                                                05550039
055600                                                                  05560039
055700*---------------------------------------------------------------* 05570039
055800*    COPYBOOK USED BY CALENDAR ROUTINE                          * 05580039
055900*---------------------------------------------------------------* 05590039
056000     COPY DPWS500.                                                05600039
056100                                                                  05610001
056200* -------------------------------------------------------------- *05620001
056300*    DB2 SQL COMMUNICATION AREA                                  *05630001
056400* -------------------------------------------------------------- *05640001
056500     EXEC SQL                                                     05650001
056600         INCLUDE SQLCA                                            05660001
056700     END-EXEC.                                                    05670001
056800                                                                  05680001
056900     EXEC SQL                                                     05690001
057000         INCLUDE TKRPRPM                                          05700001
057100     END-EXEC.                                                    05710001
057200                                                                  05720000
057300*-------------------------*                                       05730000
057400 PROCEDURE DIVISION.                                              05740000
057500*-------------------------*                                       05750000
057600     OPEN INPUT DATE-FILE                                         05760039
057700                CONTROL-FILE                                      05770039
057800                INPUT-FILE                                        05780039
057900         OUTPUT REPORT-FILE.                                      05790039
058000                                                                  05800000
058100     PERFORM 1000-INITIALIZE.                                     05810000
058200                                                                  05820000
058300     IF PS-INPUT-EOF-YES                                          05830000
058400         PERFORM 6000-NO-REPORT-DETAIL                            05840000
058500         SET PS-INPUT-DATA-NO TO TRUE                             05850017
058600     ELSE                                                         05860000
058700         PERFORM 2000-MAIN-PROCESS                                05870000
058800           UNTIL  PS-INPUT-EOF-YES.                               05880000
058900                                                                  05890017
059000     IF PS-VALID-DATA-TO-PRINT-NO  AND  PS-INPUT-DATA-YES         05900019
059100         PERFORM 6000-NO-REPORT-DETAIL                            05910017
059200         SET PS-INPUT-DATA-NO TO TRUE                             05920017
059300     END-IF.                                                      05930017
059400                                                                  05940000
059500     IF PS-INPUT-DATA-NO                                          05950017
059600         CONTINUE                                                 05960000
059700     ELSE                                                         05970000
059800         PERFORM 5100-PRINT-END-OF-REPORT.                        05980000
059900                                                                  05990000
060000     CLOSE INPUT-FILE                                             06000000
060100           DATE-FILE                                              06010000
060200           CONTROL-FILE                                           06020000
060300           REPORT-FILE.                                           06030000
060400                                                                  06040000
060500 PROGRAM-EXIT.                                                    06050000
060600     GOBACK.                                                      06060000
060700                                                                  06070000
060800*---------------------------------------------------------------* 06080000
060900*    PROGRAM INITIALIZATION                                     * 06090000
061000*                                                               * 06100000
061100*    -- ACCEPT DATE AND TIME FROM THE SYSTEM AND INITIALIZE     * 06110000
061200*       THE REPORT HEADINGS.                                    * 06120000
061300*---------------------------------------------------------------* 06130000
061400 1000-INITIALIZE.                                                 06140000
061500                                                                  06150000
061600     ACCEPT RUN-CONTROL-RECORD FROM SYSIN.                        06160000
061700                                                                  06170000
061800     DISPLAY '--------------------------------------'.            06180000
061900     DISPLAY '-        PROGRAM - RCKRP080          -'.            06190000
062000     DISPLAY '--------------------------------------'.            06200000
062100     DISPLAY '                                      '.            06210000
062200                                                                  06220000
062300     DISPLAY 'CONTROL CARD SET-UP IS : ' RUN-CONTROL-RECORD.      06230000
062400                                                                  06240000
062500     ACCEPT PV-CURRENT-DATE FROM DATE.                            06250000
062600     ACCEPT PV-CURRENT-TIME FROM TIME.                            06260000
062700                                                                  06270000
062800     MOVE PV-CURRENT-YY       TO  HL1-RUN-YEAR.                   06280000
062900     MOVE PV-CURRENT-MM       TO  HL1-RUN-MONTH.                  06290000
063000     MOVE PV-CURRENT-DD       TO  HL1-RUN-DAY.                    06300000
063100     MOVE PV-CURRENT-HOUR     TO  HL1-RUN-HOUR.                   06310000
063200     MOVE PV-CURRENT-MINUTE   TO  HL1-RUN-MINUTE.                 06320000
063300     MOVE PC-CURRENT-PROGRAM  TO  HL1-PROGRAM-NAME.               06330000
063400                                                                  06340000
063500     MOVE SPACES TO DL1-DETAIL-LINE-1.                            06350012
063600                                                                  06360000
063700     PERFORM 7000-READ-DATE.                                      06370000
063800                                                                  06380000
063900     PERFORM 7100-READ-CONTROL-FILE.                              06390040
064000                                                                  06400000
064100     EVALUATE TRUE                                                06410040
064200                                                                  06420040
064300       WHEN CC-YEAR-END                                           06430040
064400           PERFORM 1200-FISCAL-RPT-DTE-RANGE                      06440040
064500           MOVE 'END OF YEAR'         TO  HL2-FISCAL-SEASON       06450040
064600           MOVE SPACES                TO  HL2-MONTH               06460040
064700           MOVE PV-START-EXTRACT-YYYY TO  RC067-DATE-STA-CCYY     06470040
064800           MOVE PV-START-EXTRACT-MM   TO  RC067-DATE-STA-MM       06480040
064900           MOVE PV-START-EXTRACT-DD   TO  RC067-DATE-STA-DD       06490040
065000           MOVE RC067-DATE-START      TO  HL2-MONTH-YEAR-START    06500040
065100           MOVE RC067-DATE-END        TO  HL2-MONTH-YEAR-END      06510040
065200                                                                  06520040
065300       WHEN CC-SEASON-NUMBER                                      06530040
065400           PERFORM 1300-SEASONAL-RPT-DTE-RANGE                    06540040
065500           MOVE CC-EXTRACT-SEASON     TO  HL2-SEASON              06550040
065600           MOVE SPACES                TO  HL2-MONTH               06560040
065700           MOVE PV-START-EXTRACT-YYYY TO  RC067-DATE-STA-CCYY     06570040
065800           MOVE PV-START-EXTRACT-MM   TO  RC067-DATE-STA-MM       06580040
065900           MOVE PV-START-EXTRACT-DD   TO  RC067-DATE-STA-DD       06590040
066000           MOVE RC067-DATE-START      TO  HL2-MONTH-YEAR-START    06600040
066100           MOVE RC067-DATE-END        TO  HL2-MONTH-YEAR-END      06610040
066200                                                                  06620040
066300       WHEN CC-EXTRACT-PERIOD                                     06630040
066400           MOVE SPACES                TO HL2-FISCAL-SEASON        06640040
066500                                                                  06650040
066600     END-EVALUATE.                                                06660040
066700                                                                  06670040
066800     PERFORM 1400-GET-DATE-AND-FUNC-QTY.                          06680040
066900                                                                  06690008
067000     PERFORM 8000-READ-INPUT-FILE.                                06700008
067100                                                                  06710008
067200     MOVE RC065-BYR-NMBR         TO PV-HOLD-BYR-NMBR.             06720061
067300     MOVE RC065-DMM-NMBR         TO PV-HOLD-DMM-NMBR.             06730061
067400     MOVE RC065-GMM-NMBR         TO PV-HOLD-GMM-NMBR.             06740061
067500     MOVE RC065-VEND-DESC        TO PV-HOLD-VENDOR-DESC.          06750048
067600     MOVE RC065-IMPRT-FCTRY-NAME TO PV-HOLD-IMPRT-VEND.           06760048
067700                                                                  06770008
067800     IF CC-PERIOD-NUMBER                                          06780008
067900         IF RC065-MONTH-END-DATE EQUAL PV-HOLD-DATE-END           06790040
068000             SET PS-PROCESS-CURR-YES TO TRUE                      06800008
068100         ELSE                                                     06810008
068200             SET PS-PROCESS-CURR-NO  TO TRUE                      06820008
068300         END-IF                                                   06830008
068400     ELSE                                                         06840008
068500         SET PS-PROCESS-CURR-YES TO TRUE                          06850008
068600     END-IF.                                                      06860008
068700                                                                  06870008
068800     INITIALIZE PV-DETAIL-TOTALS                                  06880040
068900                PV-FINAL-TOTALS                                   06890040
069000                PV-BREAK-TOTALS.                                  06900008
069100                                                                  06910008
069200     PERFORM 1100-CHECK-CC-PARAMETERS.                            06920008
069300                                                                  06930008
069400     PERFORM 4100-PRINT-RPT-HEADING.                              06940041
069500                                                                  06950008
069600*----------------------------------------------------------------*06960008
069700*    CHECK THAT A VALID CONTROL RUN HAS BEEN REQUESTED.          *06970000
069800*----------------------------------------------------------------*06980000
069900 1100-CHECK-CC-PARAMETERS.                                        06990000
070000                                                                  07000000
070100     IF CC-GMM-NBR    OR                                          07010000
070200        CC-DMM-NBR    OR                                          07020000
070300        CC-COMPANY    OR                                          07030000
070400        CC-BYR-NBR    OR                                          07040000
070500        CC-COLBY                                                  07050000
070600         CONTINUE                                                 07060000
070700     ELSE                                                         07070000
070800         MOVE '1100-CHECK-CC-PARAMETERS' TO PV-ABEND-PARAGRAPH    07080000
070900         STRING  'CONTROL PARAMETERS: ' RUN-CONTROL-RECORD        07090000
071000             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-1            07100000
071100         STRING  'TYPE RUN   "' CC-RUN-CONTROL '" ' ' IS INVALID' 07110000
071200             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-2            07120000
071300         MOVE 'RUN ABORTED' TO PV-ABEND-DISPLAY-3                 07130000
071400         PERFORM 9000-ABEND-ROUTINE                               07140000
071500     END-IF.                                                      07150000
071600                                                                  07160000
071700     PERFORM 3500-SET-REPORT-TYPE.                                07170000
071800                                                                  07180020
071900*----------------------------------------------------------------*07190000
072000*    GET START/END DATES OF THE FISCAL PERIOD.                   *07200000
072100*----------------------------------------------------------------*07210000
072200 1200-FISCAL-RPT-DTE-RANGE.                                       07220040
072300     MOVE '1200-FISCAL-RPT-DTE-RANGE ' TO PV-ABEND-PARAGRAPH.     07230040
072400                                                                  07240000
072500     INITIALIZE DPG51                                             07250020
072600                DPG52                                             07260020
072700                DPG53                                             07270020
072800                DPG54                                             07280020
072900                DPG55                                             07290020
073000                DPG56.                                            07300020
073100                                                                  07310000
073200     MOVE PV-CURRENT-YY    TO  PV-DATE-AREA-YY.                   07320000
073300     MOVE PV-CURRENT-MM    TO  PV-DATE-AREA-MM.                   07330000
073400     MOVE PV-CURRENT-DD    TO  PV-DATE-AREA-DD.                   07340000
073500     MOVE PV-DATE-AREA     TO  DPG52-LK-DATE-INPUT.               07350000
073600     MOVE PC-TWENTY-EIGHT  TO  DPG51-INCR-DECR-DAYS-9.            07360020
073700                                                                  07370000
073800     SET DPG51-FISCAL-454-CALENDAR                                07380000
073900         DPG51-DECREMENT-DATE                                     07390000
074000         DPG52-LK-DTE-GREG-FMT      TO TRUE.                      07400000
074100                                                                  07410000
074200     PERFORM 8100-CALL-DATE-MODULE.                               07420000
074300                                                                  07430000
074400     IF DPG56-FISCAL-PERIOD-NBR = 12                              07440000
074500         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO PV-START-EXTRACT      07450000
074600     ELSE                                                         07460000
074700         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO PV-START-EXTRACT      07470000
074800         INITIALIZE DPG51                                         07480020
074900                    DPG52                                         07490020
075000                    DPG53                                         07500020
075100                    DPG54                                         07510020
075200                    DPG55                                         07520020
075300                    DPG56                                         07530020
075400         MOVE PC-ONE                     TO DPG51-INCR-DECR-DAYS-907540000
075500         MOVE PV-DATE-AREA               TO DPG52-LK-DATE-INPUT   07550000
075600         SET DPG51-FISCAL-454-CALENDAR                            07560000
075700             DPG51-DECREMENT-DATE                                 07570000
075800             DPG52-LK-DTE-GREG-FMT    TO TRUE                     07580000
075900         PERFORM 8100-CALL-DATE-MODULE                            07590000
076000     END-IF.                                                      07600000
076100                                                                  07610000
076200*----------------------------------------------------------------*07620000
076300*    GET START/END DATES SEASONAL                                *07630000
076400*----------------------------------------------------------------*07640000
076500 1300-SEASONAL-RPT-DTE-RANGE.                                     07650040
076600     MOVE '1300-SEASONAL-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.    07660040
076700                                                                  07670000
076800     INITIALIZE DPG51                                             07680020
076900                DPG52                                             07690020
077000                DPG53                                             07700020
077100                DPG54                                             07710020
077200                DPG55                                             07720020
077300                DPG56.                                            07730020
077400                                                                  07740000
077500     MOVE PV-CURRENT-YY    TO  PV-DATE-AREA-YY.                   07750000
077600     MOVE PV-CURRENT-MM    TO  PV-DATE-AREA-MM.                   07760000
077700     MOVE PV-CURRENT-DD    TO  PV-DATE-AREA-DD.                   07770000
077800     MOVE PV-DATE-AREA     TO  DPG52-LK-DATE-INPUT.               07780000
077900     MOVE PC-TWENTY-EIGHT  TO  DPG51-INCR-DECR-DAYS-9.            07790000
078000                                                                  07800000
078100     SET DPG51-FISCAL-454-CALENDAR                                07810000
078200         DPG51-DECREMENT-DATE                                     07820000
078300         DPG52-LK-DTE-GREG-FMT   TO TRUE.                         07830000
078400                                                                  07840000
078500     PERFORM 8100-CALL-DATE-MODULE.                               07850000
078600                                                                  07860000
078700     MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO  PV-START-EXTRACT.        07870000
078800                                                                  07880000
078900     IF DPG56-FISCAL-PERIOD-NBR = 12                              07890000
079000         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO PV-END-EXTRACT        07900000
079100     END-IF.                                                      07910000
079200                                                                  07920000
079300     IF DPG56-FISCAL-PERIOD-NBR > 7                               07930000
079400         MOVE DPG56-FIRST-FD-DB2-ISO-FMT-YR TO  PV-YEAR-FORMAT    07940000
079500         MOVE PV-YEAR-FORMAT-YY             TO  PV-DATE-AREA-YY   07950000
079600         MOVE 01  TO  PV-DATE-AREA-MM                             07960000
079700                      PV-DATE-AREA-DD                             07970000
079800         INITIALIZE DPG51                                         07980020
079900                    DPG52                                         07990020
080000                    DPG53                                         08000020
080100                    DPG54                                         08010020
080200                    DPG55                                         08020020
080300                    DPG56                                         08030020
080400                                                                  08040040
080500         MOVE PV-DATE-AREA   TO  DPG52-LK-DATE-INPUT              08050000
080600         MOVE 220            TO  DPG51-INCR-DECR-DAYS-9           08060000
080700                                                                  08070040
080800         SET DPG51-FISCAL-454-CALENDAR                            08080000
080900             DPG51-INCREMENT-DATE                                 08090000
081000             DPG52-LK-DTE-GREG-FMT  TO TRUE                       08100000
081100                                                                  08110040
081200         PERFORM 8100-CALL-DATE-MODULE                            08120000
081300                                                                  08130040
081400         MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO PV-START-EXTRACT      08140000
081500     END-IF.                                                      08150000
081600                                                                  08160001
081700*----------------------------------------------------------------*08170040
081800*    DETERMINE THE TIME FRAME OF THE REQUESTED REPORT AND        *08180040
081900*    CALL DB2 TO ACCESS THE PROPER FUNCTION QTY.                 *08190040
082000*----------------------------------------------------------------*08200040
082100 1400-GET-DATE-AND-FUNC-QTY.                                      08210040
082200                                                                  08220040
082300     EVALUATE TRUE                                                08230040
082400       WHEN CC-GMM-NBR                                            08240040
082500             MOVE PC-FUNC-GMM TO PC-FUNCTION                      08250040
082600             PERFORM 1500-SELECT-FUNCTION-QTY                     08260040
082700                                                                  08270040
082800         WHEN CC-DMM-NBR                                          08280040
082900             MOVE PC-FUNC-DMM TO PC-FUNCTION                      08290040
083000             PERFORM 1500-SELECT-FUNCTION-QTY                     08300040
083100                                                                  08310040
083200         WHEN CC-COMPANY                                          08320040
083300             MOVE PC-FUNC-CMP TO PC-FUNCTION                      08330040
083400             PERFORM 1500-SELECT-FUNCTION-QTY                     08340040
083500                                                                  08350040
083600         WHEN CC-COLBY                                            08360040
083700             MOVE PC-FUNC-CBY TO PC-FUNCTION                      08370040
083800             PERFORM 1500-SELECT-FUNCTION-QTY                     08380040
083900                                                                  08390040
084000         WHEN OTHER                                               08400040
084100             SET PS-LIMIT-REPORT-LINES-NO TO TRUE                 08410040
084200                                                                  08420040
084300     END-EVALUATE.                                                08430040
084400                                                                  08440040
084500* -------------------------------------------------------------- *08450001
084600*    ACCESS DB2 TABLE TKRPRPM FOR VENDOR LIMIT QUALITY BY        *08460020
084700*    TYPE OF REPORT (GMM, DMM, COMPANY OR COLBY)                 *08470020
084800* -------------------------------------------------------------- *08480020
084900 1500-SELECT-FUNCTION-QTY.                                        08490020
085000                                                                  08500020
085100     EXEC SQL                                                     08510020
085200         SELECT FUNC_QTY                                          08520020
085300           INTO :KRPRPM-FUNC-QTY                                  08530020
085400           FROM TKRPRPM                                           08540040
085500          WHERE INTFC_SYS_CDE      =  'PRO'                       08550040
085600            AND SYS_PRC_FUNC_CDE   =  :PC-FUNCTION                08560040
085700            AND FUNC_PRC_STAT_CDE  =  'AC'                        08570040
085800            AND (CURRENT DATE BETWEEN DATE(FUNC_BEG_TMST)         08580040
085900            AND                       DATE(FUNC_END_TMST))        08590040
086000           WITH UR                                                08600040
086100     END-EXEC.                                                    08610020
086200                                                                  08620020
086300     EVALUATE SQLCODE                                             08630020
086400       WHEN +0                                                    08640020
086500           SET PS-LIMIT-REPORT-LINES-YES TO TRUE                  08650020
086600           MOVE KRPRPM-FUNC-QTY          TO HL2-VENDOR-CNT        08660044
086700                                                                  08670001
086800       WHEN OTHER                                                 08680001
086900           MOVE '1500-SELECT-FUNCTION-QTY' TO PV-ABEND-PARAGRAPH  08690020
087000           MOVE 'GET FUNCTION QTY'         TO PV-DB2-OPER-MESS-1  08700001
087100           MOVE 'TKRPRPM'                  TO PV-ABEND-STRUCT-1   08710001
087200           PERFORM 9900-DB2-ABEND                                 08720001
087300     END-EVALUATE.                                                08730001
087400                                                                  08740000
087500*----------------------------------------------------------------*08750000
087600*    MAIN LINE PROCESSING.  DETERMINE IF INPUT TRANSACTION IS    *08760000
087700*    A YTD ENTRY (BASED ON CURRENT OR PAST DATE) AND ACCUMULATE  *08770000
087800*    YTD ACCURACY DATA FOR YTD SHIPMENT ACCURACY.                *08780000
087900*                                                                *08790000
088000*    IF NOT YTD, PROCESS AS NORMAL SUMMARIZED INPUT TRANS-       *08800000
088100*    ACTION AND WRITE TO REPORT.                                 *08810000
088200*----------------------------------------------------------------*08820000
088300 2000-MAIN-PROCESS.                                               08830000
088400                                                                  08840000
088500     PERFORM 2100-CHECK-FOR-PRINT-BREAK.                          08850000
088600                                                                  08860000
088700     EVALUATE TRUE                                                08870000
088800        WHEN CC-BYR-NBR                                           08880000
088900        WHEN CC-DMM-NBR                                           08890000
089000        WHEN CC-GMM-NBR                                           08900000
089100            PERFORM 2200-PROCESS-BYR-DMM-GMM                      08910000
089200                                                                  08920000
089300        WHEN CC-COLBY                                             08930000
089400        WHEN CC-COMPANY                                           08940000
089500            PERFORM 2300-PROCESS-COLBY-TRANS                      08950000
089600                                                                  08960000
089700     END-EVALUATE.                                                08970000
089800                                                                  08980000
089900     IF PS-PROCESS-CURR-YES                                       08990040
090000       AND PS-PRINT-HEADINGS-YES                                  09000040
090100         SET PS-PRINT-HEADINGS-NO TO TRUE                         09010000
090200         PERFORM 4100-PRINT-RPT-HEADING                           09020041
090300     END-IF.                                                      09030000
090400                                                                  09040000
090500     PERFORM 8000-READ-INPUT-FILE.                                09050000
090600                                                                  09060000
090700*----------------------------------------------------------------*09070000
090800*    DETERMINE IF IT'S TIME FOR A PRINT CONTROL BREAK            *09080000
090900*----------------------------------------------------------------*09090000
091000 2100-CHECK-FOR-PRINT-BREAK.                                      09100000
091100                                                                  09110000
091200     EVALUATE TRUE                                                09120000
091300       WHEN CC-GMM-NBR                                            09130000
091400           IF RC065-GMM-NMBR NOT EQUAL PV-HOLD-GMM-NMBR           09140061
091500               SET PS-LINE-PRINTED-YES   TO TRUE                  09150066
091600               SET PS-PRINT-HEADINGS-YES TO TRUE                  09160040
091700               PERFORM 3100-PRINT-DETAIL-LINE                     09170000
091800               PERFORM 4200-PRINT-BREAK-TOTALS                    09180040
091900               PERFORM 3500-SET-REPORT-TYPE                       09190000
092000               MOVE RC065-GMM-NMBR TO PV-HOLD-GMM-NMBR            09200061
092010               MOVE ZEROES         TO PV-VENDOR-COUNT             09201066
092100           END-IF                                                 09210000
092200                                                                  09220000
092300       WHEN CC-DMM-NBR                                            09230000
092400           IF RC065-DMM-NMBR NOT EQUAL PV-HOLD-DMM-NMBR           09240061
092500               SET PS-LINE-PRINTED-YES   TO TRUE                  09250066
092600               SET PS-PRINT-HEADINGS-YES TO TRUE                  09260040
092700               PERFORM 3100-PRINT-DETAIL-LINE                     09270040
092800               PERFORM 4200-PRINT-BREAK-TOTALS                    09280040
092900               PERFORM 3500-SET-REPORT-TYPE                       09290040
093000               MOVE RC065-DMM-NMBR TO PV-HOLD-DMM-NMBR            09300061
093010               MOVE ZEROES         TO PV-VENDOR-COUNT             09301066
093100           END-IF                                                 09310040
093200                                                                  09320000
093300       WHEN CC-BYR-NBR                                            09330000
093400           IF RC065-BYR-NMBR NOT EQUAL PV-HOLD-BYR-NMBR           09340061
093500               SET PS-LINE-PRINTED-YES   TO TRUE                  09350066
093600               SET PS-PRINT-HEADINGS-YES TO TRUE                  09360040
093700               PERFORM 3100-PRINT-DETAIL-LINE                     09370000
093800               PERFORM 4200-PRINT-BREAK-TOTALS                    09380040
093900               PERFORM 3500-SET-REPORT-TYPE                       09390000
094000               MOVE RC065-BYR-NMBR TO PV-HOLD-BYR-NMBR            09400061
094100           END-IF                                                 09410000
094200                                                                  09420000
094300     END-EVALUATE.                                                09430000
094400                                                                  09440000
094500*----------------------------------------------------------------*09450000
094600*    GMM / DMM / BUYER ALL ACCUM/PRINT ON VENDOR NAME CHANGE.    *09460047
094700*----------------------------------------------------------------*09470000
094800 2200-PROCESS-BYR-DMM-GMM.                                        09480000
094900                                                                  09490000
095000     IF RC065-VEND-DESC NOT = PV-HOLD-VENDOR-DESC                 09500061
095100         IF PS-LINE-PRINTED-YES                                   09510047
095200             SET PS-LINE-PRINTED-NO TO TRUE                       09520047
095300         ELSE                                                     09530047
095400             PERFORM 3100-PRINT-DETAIL-LINE                       09540047
095500         END-IF                                                   09550047
095600         MOVE RC065-VEND-DESC TO PV-HOLD-VENDOR-DESC              09560061
095700         PERFORM 3200-ACCUM-YTD-TOTALS                            09570047
095800         PERFORM 2500-CHECK-FOR-RUN-TYPE                          09580047
095900     ELSE                                                         09590047
096000         PERFORM 3200-ACCUM-YTD-TOTALS                            09600047
096100         PERFORM 2500-CHECK-FOR-RUN-TYPE                          09610047
096200     END-IF.                                                      09620047
096300                                                                  09630047
096400*----------------------------------------------------------------*09640000
096500*    COLBY AND COMPANY PROCESSING.                               *09650047
096600*----------------------------------------------------------------*09660048
096700 2300-PROCESS-COLBY-TRANS.                                        09670020
096800                                                                  09680020
096900     IF CC-COLBY                                                  09690048
097000         MOVE RC065-EXPTED-ITM-QTY TO PV-DISPLAY-QTY1             09700062
097100         IF (RC065-IMPRT-FCTRY-NAME NOT = PV-HOLD-IMPRT-VEND)     09710048
097200***      DISPLAY '2300 CC-COLBY NE - ' RC065-IMPRT-FCTRY-NAME     09720065
097300***              ' ' PV-DISPLAY-QTY1                              09730065
097400             IF PS-LINE-PRINTED-YES                               09740048
097500                 SET PS-LINE-PRINTED-NO TO TRUE                   09750048
097600             ELSE                                                 09760048
097700                 PERFORM 3100-PRINT-DETAIL-LINE                   09770048
097800             END-IF                                               09780048
097900             MOVE RC065-IMPRT-FCTRY-NAME TO PV-HOLD-IMPRT-VEND    09790048
098000             PERFORM 3200-ACCUM-YTD-TOTALS                        09800048
098100             PERFORM 2500-CHECK-FOR-RUN-TYPE                      09810048
098200         ELSE                                                     09820048
098300***      DISPLAY '2300 CC-COLBY EQ - ' RC065-IMPRT-FCTRY-NAME     09830065
098400***              ' ' PV-DISPLAY-QTY1                              09840065
098500             PERFORM 3200-ACCUM-YTD-TOTALS                        09850048
098600             PERFORM 2500-CHECK-FOR-RUN-TYPE                      09860048
098700         END-IF                                                   09870048
098800     ELSE                                                         09880048
098900         IF RC065-VEND-DESC NOT = PV-HOLD-VENDOR-DESC             09890061
099000             IF PS-LINE-PRINTED-YES                               09900048
099100                 SET PS-LINE-PRINTED-NO TO TRUE                   09910048
099200             ELSE                                                 09920048
099300                 PERFORM 3100-PRINT-DETAIL-LINE                   09930048
099400             END-IF                                               09940048
099500             MOVE RC065-VEND-DESC TO PV-HOLD-VENDOR-DESC          09950061
099600             PERFORM 3200-ACCUM-YTD-TOTALS                        09960048
099700             PERFORM 2500-CHECK-FOR-RUN-TYPE                      09970048
099800         ELSE                                                     09980048
099900             PERFORM 3200-ACCUM-YTD-TOTALS                        09990048
100000             PERFORM 2500-CHECK-FOR-RUN-TYPE                      10000048
100100         END-IF                                                   10010000
100200     END-IF.                                                      10020000
100300                                                                  10030000
100400*----------------------------------------------------------------*10040000
100500*----------------------------------------------------------------*10050020
100600 2500-CHECK-FOR-RUN-TYPE.                                         10060020
100700                                                                  10070020
100800     EVALUATE TRUE                                                10080020
100900       WHEN CC-YEAR-END                                           10090020
101000           SET PS-PROCESS-CURR-YES TO TRUE                        10100020
101100           PERFORM 3000-PROCESS-INPUT-DETAILS                     10110020
101200                                                                  10120020
101300       WHEN CC-SEASON-NUMBER  AND  CC-EXTRACT-SPRING              10130020
101400           SET PS-PROCESS-CURR-YES TO TRUE                        10140020
101500           IF CC-ARRIVED-DATE-EXTRACT                             10150040
101600             OR CC-BOTH-DATE-EXTRACT                              10160040
101700               IF RC065-ARRIVE-PERIOD-NBR < PC-PERIOD-07          10170040
101800                   PERFORM 3000-PROCESS-INPUT-DETAILS             10180020
101900               END-IF                                             10190020
102000           END-IF                                                 10200020
102100                                                                  10210020
102200           IF CC-VERIFYD-DATE-EXTRACT                             10220040
102300             OR CC-BOTH-DATE-EXTRACT                              10230040
102400               IF RC065-VRFYD-PERIOD-NBR < PC-PERIOD-07           10240040
102500                   PERFORM 3000-PROCESS-INPUT-DETAILS             10250020
102600               END-IF                                             10260020
102700           END-IF                                                 10270020
102800                                                                  10280020
102900       WHEN CC-SEASON-NUMBER  AND  CC-EXTRACT-FALL                10290020
103000           SET PS-PROCESS-CURR-YES TO TRUE                        10300020
103100           IF CC-ARRIVED-DATE-EXTRACT                             10310040
103200             OR CC-BOTH-DATE-EXTRACT                              10320040
103300               IF RC065-ARRIVE-PERIOD-NBR > PC-PERIOD-06          10330040
103400                   PERFORM 3000-PROCESS-INPUT-DETAILS             10340020
103500               END-IF                                             10350020
103600           END-IF                                                 10360020
103700                                                                  10370020
103800           IF CC-VERIFYD-DATE-EXTRACT                             10380040
103900             OR CC-BOTH-DATE-EXTRACT                              10390040
104000               IF RC065-VRFYD-PERIOD-NBR > PC-PERIOD-06           10400040
104100                   PERFORM 3000-PROCESS-INPUT-DETAILS             10410020
104200               END-IF                                             10420020
104300           END-IF                                                 10430020
104400                                                                  10440020
104500       WHEN CC-PERIOD-NUMBER                                      10450020
104600           IF RC065-MONTH-END-DATE = PV-HOLD-DATE-END             10460040
104700               SET PS-PROCESS-CURR-YES TO TRUE                    10470020
104800               PERFORM 3000-PROCESS-INPUT-DETAILS                 10480020
104900*JPL       ELSE                                                   10490057
105000***            SET PS-PROCESS-CURR-NO TO TRUE                     10500057
105100           END-IF                                                 10510020
105200                                                                  10520020
105300     END-EVALUATE.                                                10530020
105400                                                                  10540020
105500*----------------------------------------------------------------*10550020
105600*    BUILD A REPORT DETAIL LINE AND ACCUMULATE REPORT BREAK      *10560020
105700*    TOTALS.                                                     *10570020
105800*----------------------------------------------------------------*10580020
105900 3000-PROCESS-INPUT-DETAILS.                                      10590020
106000***  DISPLAY '   **3000-PROCESS-INPUT-DETAILS**'.                 10600059
106100                                                                  10610020
106200     SET PS-VALID-DATA-TO-PRINT-YES TO TRUE.                      10620020
106300                                                                  10630020
106400     MOVE SPACES TO DL1-DETAIL-LINE-1.                            10640020
106500                                                                  10650020
106600     EVALUATE TRUE                                                10660020
106700       WHEN CC-COLBY                                              10670020
106800           IF RC065-IMPRT-FCTRY-NAME NOT = SPACES                 10680040
106900               MOVE RC065-IMPRT-FCTRY-NAME  TO  DL1-VENDOR-NAME   10690040
107000           ELSE                                                   10700020
107100               IF RC065-IMPRT-VEND-NAME NOT = SPACES              10710040
107200                   MOVE RC065-IMPRT-VEND-NAME TO DL1-VENDOR-NAME  10720040
107300               ELSE                                               10730020
107400                   MOVE RC065-VEND-DESC TO DL1-VENDOR-NAME        10740040
107500               END-IF                                             10750020
107600           END-IF                                                 10760020
107700                                                                  10770020
107800       WHEN OTHER                                                 10780020
107900           MOVE RC065-VEND-DESC  TO  DL1-VENDOR-NAME              10790040
108000                                                                  10800000
108100     END-EVALUATE.                                                10810000
108200                                                                  10820000
108300     MOVE RC065-PO-COUNT           TO  DL1-PO-COUNT.              10830040
108400     MOVE RC065-CFY-SLSRNK-NBR     TO  DL1-SALES-RANK.            10840040
108500     IF RC065-CURR-SPLIT-QTY > +0                                 10850040
108600         COMPUTE PV-ACCURACY ROUNDED = ((1                        10860040
108700                                    - ((RC065-OVERAGE-QTY         10870040
108800                                      + RC065-SHORTAGE-QTY)       10880040
108900                                    /  RC065-CURR-SPLIT-QTY))     10890040
109000                                    *  100)                       10900040
109100         IF PV-ACCURACY > +0                                      10910040
109200             COMPUTE PV-ACCURACY-999 ROUNDED = PV-ACCURACY * 1    10920054
109300             MOVE PV-ACCURACY-999 TO DL1-SHIPMENT-ACCURACY        10930054
109400         ELSE                                                     10940040
109500             MOVE ZEROES      TO DL1-SHIPMENT-ACCURACY            10950040
109600     ELSE                                                         10960040
109700         MOVE ZEROES          TO DL1-SHIPMENT-ACCURACY            10970040
109800     END-IF.                                                      10980040
109900*JPL                                                              10990055
110000***  MOVE RC065-CURR-SPLIT-QTY TO PV-DISPLAY-QTY1                 11000059
110100***  MOVE RC065-OVERAGE-QTY    TO PV-DISPLAY-QTY2                 11010059
110200***  MOVE RC065-SHORTAGE-QTY   TO PV-DISPLAY-QTY3                 11020059
110300***  DISPLAY '   D1 - ORDERED / OVER / SHORT = '                  11030059
110400***          PV-DISPLAY-QTY1 ' / '                                11040059
110500***          PV-DISPLAY-QTY2 ' / ' PV-DISPLAY-QTY3                11050059
110600                                                                  11060055
110700     COMPUTE DL1-UNITS-ORD         ROUNDED =                      11070034
110800             RC065-CURR-SPLIT-QTY / 1000.                         11080040
110900     COMPUTE DL1-UNITS-RECV        ROUNDED =                      11090034
111000             RC065-EXPTED-ITM-QTY / 1000.                         11100040
111100     COMPUTE DL1-TOT-OVSH          ROUNDED =                      11110034
111200            (RC065-OVERAGE-QTY    +                               11120040
111300             RC065-SHORTAGE-QTY)  / 1000.                         11130040
111400     COMPUTE DL1-TOT-RETAIL-IMPACT ROUNDED =                      11140034
111500            (RC065-OVERAGE-RETAIL-AMT -                           11150040
111600             RC065-SHORTAGE-RETAIL-AMT) / 1000.                   11160040
111700                                                                  11170000
111800     PERFORM 3300-COMPUTE-OVERAGE-NUMBERS.                        11180000
111900                                                                  11190000
112000     PERFORM 3400-COMPUTE-SHORTAGE-NUMBERS.                       11200000
112100                                                                  11210000
112200     ADD RC065-OVERAGE-QTY          TO  PV-BRK-OVSH               11220040
112300                                        PV-BRK-OVR-QTY.           11230040
112400     ADD RC065-SHORTAGE-QTY         TO  PV-BRK-OVSH               11240040
112500                                        PV-BRK-SHT-QTY.           11250040
112600     ADD RC065-OVERAGE-RETAIL-AMT   TO  PV-BRK-OVR-RETAIL.        11260040
112700     ADD RC065-SHORTAGE-RETAIL-AMT  TO  PV-BRK-SHT-RETAIL.        11270040
112800     ADD RC065-TOT-UNITS-ORD-OVER   TO  PV-BRK-UNITS-OVER.        11280040
112900     ADD RC065-TOT-UNITS-ORD-SHORT  TO  PV-BRK-UNITS-SHORT.       11290040
113000     ADD RC065-EXPTED-ITM-QTY       TO  PV-BRK-EXPTED-ITM-QTY.    11300040
113100     ADD RC065-VERIFY-ITM-QTY       TO  PV-BRK-VERIFY-ITM-QTY.    11310040
113200     ADD RC065-CURR-SPLIT-QTY       TO  PV-BRK-CURR-SPLIT-QTY.    11320040
113300     ADD RC065-PO-COUNT             TO  PV-BRK-PO-COUNT.          11330040
113400                                                                  11340000
113500*----------------------------------------------------------------*11350040
113600* SHIPPING ACCURACY CALCULATION.                                  11360040
113700*    1 - ((THE AMOUNT I AM STILL EXPECTING TO RECEIVE)            11370040
113800*       + ( OVER/SHORT KNOWN ALREADY) / INTENDED ORDER QTY)       11380040
113900*                                                                 11390040
114000*    NOTE: IN THE EVENT OF AN OVER SHIPMENT,                      11400040
114100*          WHERE RCVD IS GREATER THAN ORDERED,                    11410040
114200*          THEN STILL EXPECTING QTY IS ZERO.                      11420040
114300*----------------------------------------------------------------*11430040
114400 3010-ACCUM-SHIP-ACC-FIELDS.                                      11440040
114500***  DISPLAY '  3010-ACCUM-SHIP-ACC-FIELDS'.                      11450065
114600                                                                  11460040
114700*D2=DTL YTD /B1=BRK PERIOD /B2=BRK YTD /T1=TOT PERIOD /T2=TOT YTD 11470040
114800     MOVE RC065-EXPTED-ITM-QTY   TO PV-EXPTED-ITM-QTY.            11480040
114900     ADD PV-EXPTED-ITM-QTY       TO PV-EXPTED-ITM-QTY-D2          11490040
115000                                        PV-EXPTED-ITM-QTY-B2      11500040
115100                                        PV-EXPTED-ITM-QTY-T2.     11510040
115200*JPL                                                              11520053
115300***  MOVE RC065-EXPTED-ITM-QTY   TO PV-DISPLAY-QTY1.              11530065
115400***  MOVE PV-EXPTED-ITM-QTY-D2   TO PV-DISPLAY-QTY2.              11540065
115500***  DISPLAY '   RECEIVED-QTY / ACCUM = '                         11550065
115600***          PV-DISPLAY-QTY1  ' / ' PV-DISPLAY-QTY2.              11560065
115700                                                                  11570053
115800     IF CC-PERIOD-NUMBER                                          11580040
115900       AND RC065-MONTH-END-DATE = PV-HOLD-DATE-END                11590040
116000         ADD PV-EXPTED-ITM-QTY   TO PV-EXPTED-ITM-QTY-B1          11600040
116100                                        PV-EXPTED-ITM-QTY-T1      11610040
116200     END-IF.                                                      11620040
116300                                                                  11630040
116400     COMPUTE PV-TOTAL-OVER-SHORT      = RC065-OVERAGE-QTY         11640040
116500                                      + RC065-SHORTAGE-QTY.       11650040
116600     ADD PV-TOTAL-OVER-SHORT         TO PV-TOTAL-OVER-SHORT-D2    11660040
116700                                        PV-TOTAL-OVER-SHORT-B2    11670040
116800                                        PV-TOTAL-OVER-SHORT-T2.   11680040
116900*JPL                                                              11690055
117000***  MOVE RC065-CURR-SPLIT-QTY TO PV-DISPLAY-QTY1                 11700065
117100***  MOVE RC065-OVERAGE-QTY    TO PV-DISPLAY-QTY2                 11710065
117200***  MOVE RC065-SHORTAGE-QTY   TO PV-DISPLAY-QTY3                 11720065
117300***  DISPLAY '   ORDERED / OVER / SHORT = '                       11730065
117400***          PV-DISPLAY-QTY1 ' / '                                11740065
117500***          PV-DISPLAY-QTY2 ' / ' PV-DISPLAY-QTY3                11750065
117600                                                                  11760055
117700     IF CC-PERIOD-NUMBER                                          11770040
117800       AND RC065-MONTH-END-DATE = PV-HOLD-DATE-END                11780040
117900         ADD PV-TOTAL-OVER-SHORT     TO PV-TOTAL-OVER-SHORT-B1    11790040
118000                                        PV-TOTAL-OVER-SHORT-T1    11800040
118100     END-IF.                                                      11810040
118200                                                                  11820040
118300     MOVE RC065-CURR-SPLIT-QTY       TO PV-INTENDED-ORD-QTY.      11830040
118400     ADD PV-INTENDED-ORD-QTY         TO PV-INTENDED-ORD-QTY-D2    11840040
118500                                        PV-INTENDED-ORD-QTY-B2    11850040
118600                                        PV-INTENDED-ORD-QTY-T2.   11860040
118700     IF CC-PERIOD-NUMBER                                          11870040
118800       AND RC065-MONTH-END-DATE = PV-HOLD-DATE-END                11880040
118900         ADD PV-INTENDED-ORD-QTY     TO PV-INTENDED-ORD-QTY-B1    11890040
119000                                        PV-INTENDED-ORD-QTY-T1    11900040
119100     END-IF.                                                      11910040
119200                                                                  11920040
119300     MOVE ZEROES TO PV-STILL-EXPECT-QTY.                          11930040
119400     IF RC065-CURR-SPLIT-QTY > RC065-EXPTED-ITM-QTY               11940040
119500         COMPUTE PV-STILL-EXPECT-QTY  = RC065-CURR-SPLIT-QTY      11950040
119600                                      - RC065-EXPTED-ITM-QTY      11960040
119700         ADD PV-STILL-EXPECT-QTY     TO PV-STILL-EXPECT-QTY-D2    11970040
119800                                        PV-STILL-EXPECT-QTY-B2    11980040
119900                                        PV-STILL-EXPECT-QTY-T2    11990040
120000         IF CC-PERIOD-NUMBER                                      12000040
120100           AND RC065-MONTH-END-DATE = PV-HOLD-DATE-END            12010040
120200             ADD PV-STILL-EXPECT-QTY TO PV-STILL-EXPECT-QTY-B1    12020040
120300                                        PV-STILL-EXPECT-QTY-T1    12030040
120400         END-IF                                                   12040040
120500     END-IF.                                                      12050040
120600*JPL                                                              12060053
120700***  DISPLAY '   VENDOR NAME = ' RC065-VEND-DESC                  12070065
120800***          '  DATE - ' RC065-MONTH-END-DATE.                    12080065
120900                                                                  12090053
121000*----------------------------------------------------------------*12100040
121100*    PRINT DETAIL LINE FOR THE LAST VENDOR PROCESSED.            *12110000
121200*----------------------------------------------------------------*12120000
121300 3100-PRINT-DETAIL-LINE.                                          12130000
121400***  DISPLAY ' 3100-PRINT-DETAIL-LINE'.                           12140065
121500                                                                  12150000
121600* COMPUTE DETAIL SHIPPING ACCURACY YTD (D2)                       12160040
121700     IF PV-INTENDED-ORD-QTY-D2 > ZEROES                           12170040
121800*JPL                                                              12180052
121900***      MOVE PV-TOTAL-OVER-SHORT-D2 TO PV-DISPLAY-QTY1           12190065
122000***      MOVE PV-INTENDED-ORD-QTY-D2 TO PV-DISPLAY-QTY2           12200065
122100***      DISPLAY '   YTD - OVER-SHORT / INTENDED = '              12210065
122200***              PV-DISPLAY-QTY1 ' / ' PV-DISPLAY-QTY2            12220065
122300                                                                  12230052
122400         COMPUTE PV-ACCURACY ROUNDED = ((1                        12240040
122500                                  - (PV-TOTAL-OVER-SHORT-D2       12250040
122600                                  /  PV-INTENDED-ORD-QTY-D2))     12260040
122700                                  *  100)                         12270040
122800         IF PV-ACCURACY > +0                                      12280040
122900             COMPUTE PV-ACCURACY-999 ROUNDED = PV-ACCURACY * 1    12290054
123000             MOVE PV-ACCURACY-999 TO DL1-YTD-ACCURACY             12300054
123100         ELSE                                                     12310040
123200             MOVE ZEROES      TO DL1-YTD-ACCURACY                 12320040
123300     ELSE                                                         12330040
123400         MOVE ZEROES          TO DL1-YTD-ACCURACY                 12340040
123500     END-IF.                                                      12350040
123600                                                                  12360040
123700     IF (CC-YEAR-END OR CC-SEASON-NUMBER)                         12370040
123800       AND (PV-REC-COUNT > +1)                                    12380040
123900         PERFORM 4000-PRINT-DETAIL                                12390040
124000     END-IF.                                                      12400040
124100                                                                  12410040
124200     IF CC-PERIOD-NUMBER                                          12420040
124300         IF PS-PROCESS-CURR-YES                                   12430040
124400             PERFORM 4000-PRINT-DETAIL                            12440040
124500         END-IF                                                   12450040
124600     END-IF.                                                      12460040
124700                                                                  12470040
124800     INITIALIZE PV-DETAIL-TOTALS.                                 12480040
124900     SET PS-PROCESS-CURR-NO TO TRUE.                              12490057
125000                                                                  12500000
125100*----------------------------------------------------------------*12510000
125200*    ADD SHIPPING ACCURACY TO YEAR-TO-DATE TOTALS.               *12520000
125300*----------------------------------------------------------------*12530000
125400 3200-ACCUM-YTD-TOTALS.                                           12540000
125500                                                                  12550000
125600     PERFORM 3010-ACCUM-SHIP-ACC-FIELDS.                          12560040
125700                                                                  12570000
125800*----------------------------------------------------------------*12580000
125900*    CALCULATE OVERAGE SUMMARY REPORT AMOUNTS                    *12590000
126000*----------------------------------------------------------------*12600000
126100 3300-COMPUTE-OVERAGE-NUMBERS.                                    12610000
126200                                                                  12620000
126300     COMPUTE DL1-UNITS-RECV-OVER ROUNDED =                        12630034
126400                                 RC065-OVERAGE-QTY / 1000.        12640040
126500     COMPUTE DL1-UNITS-ORD-OVER  ROUNDED =                        12650034
126600                                 RC065-TOT-UNITS-ORD-OVER / 1000. 12660040
126700                                                                  12670000
126800     MOVE ZEROES TO PV-PCT-OVER.                                  12680040
126900                                                                  12690000
127000     IF RC065-TOT-UNITS-ORD-OVER NOT = ZEROES                     12700040
127100         COMPUTE PV-PCT-OVER ROUNDED = (RC065-OVERAGE-QTY         12710040
127200                                     / RC065-TOT-UNITS-ORD-OVER)  12720040
127300                                     * 100                        12730040
127400     END-IF.                                                      12740040
127500                                                                  12750040
127600     MOVE PV-PCT-OVER TO DL1-PCT-OVER.                            12760040
127700                                                                  12770000
127800*----------------------------------------------------------------*12780000
127900*    CALCULATE SHORTAGE SUMMARY REPORT AMOUNTS                   *12790000
128000*----------------------------------------------------------------*12800000
128100 3400-COMPUTE-SHORTAGE-NUMBERS.                                   12810000
128200                                                                  12820000
128300     COMPUTE DL1-UNITS-RECV-SHORT ROUNDED =                       12830034
128400             RC065-SHORTAGE-QTY  / 1000.                          12840040
128500     COMPUTE DL1-UNITS-ORD-SHORT  ROUNDED =                       12850034
128600             RC065-TOT-UNITS-ORD-SHORT / 1000.                    12860040
128700                                                                  12870000
128800     MOVE ZEROES TO PV-PCT-SHORT.                                 12880040
128900                                                                  12890000
129000     IF RC065-TOT-UNITS-ORD-SHORT NOT = ZEROES                    12900040
129100         COMPUTE PV-PCT-SHORT ROUNDED = (RC065-SHORTAGE-QTY       12910040
129200                                      / RC065-TOT-UNITS-ORD-SHORT)12920040
129300                                      * 100                       12930040
129400     END-IF.                                                      12940040
129500                                                                  12950040
129600     MOVE PV-PCT-SHORT TO DL1-PCT-SHORT.                          12960040
129700                                                                  12970000
129800*----------------------------------------------------------------*12980000
129900*    BASED ON THE RUN TYPE BEING PROCESSED, SET THE REPORT       *12990000
130000*    HEADINGS TO THE CORRECT NAMES.                              *13000000
130100*----------------------------------------------------------------*13010000
130200 3500-SET-REPORT-TYPE.                                            13020000
130300                                                                  13030000
130400     EVALUATE TRUE                                                13040000
130500       WHEN CC-GMM-NBR                                            13050000
130600           MOVE PC-RPT-NBR-GMM         TO HL1-REPORT-NUMBER       13060010
130700           MOVE PC-RUN-TYPE-GMM        TO HL3-REPORT-TYPE         13070010
130800           MOVE RC065-GMM-NAME         TO HL3-SEQUENCE-TYPE       13080040
130900           MOVE RC065-GMM-NMBR         TO HL3-USER-ID             13090040
131000                                                                  13100000
131100       WHEN CC-DMM-NBR                                            13110000
131200           MOVE PC-RPT-NBR-DMM         TO HL1-REPORT-NUMBER       13120010
131300           MOVE PC-RUN-TYPE-DMM        TO HL3-REPORT-TYPE         13130010
131400           MOVE RC065-DMM-NAME         TO HL3-SEQUENCE-TYPE       13140040
131500           MOVE RC065-DMM-NMBR         TO HL3-USER-ID             13150040
131600                                                                  13160000
131700       WHEN CC-COMPANY                                            13170000
131800           MOVE PC-RPT-COMPANY         TO HL1-REPORT-NUMBER       13180010
131900           MOVE PC-RUN-TYPE-COMPANY    TO HL3-REPORT-TYPE         13190010
132000           MOVE PC-RUN-TYPE-KOHLS      TO HL3-SEQUENCE-TYPE       13200010
132100           MOVE SPACES                 TO HL3-USER-ID             13210014
132200                                                                  13220000
132300       WHEN CC-BYR-NBR                                            13230000
132400           MOVE PC-RPT-NBR-BYR         TO HL1-REPORT-NUMBER       13240010
132500           MOVE PC-RUN-TYPE-BYR        TO HL3-REPORT-TYPE         13250010
132600           MOVE RC065-BYR-NAME         TO HL3-SEQUENCE-TYPE       13260040
132700           MOVE RC065-BYR-NMBR         TO HL3-USER-ID             13270040
132800                                                                  13280000
132900       WHEN CC-COLBY                                              13290000
133000           MOVE PC-RPT-NBR-COLBY       TO HL1-REPORT-NUMBER       13300000
133100           MOVE PC-RUN-TYPE-COLBY      TO HL3-REPORT-TYPE         13310000
133200           MOVE PC-RUN-TYPE-COLBY-INTL TO HL3-SEQUENCE-TYPE       13320000
133300           MOVE SPACES                 TO HL3-USER-ID             13330014
133400                                                                  13340000
133500     END-EVALUATE.                                                13350000
133600                                                                  13360000
133700*----------------------------------------------------------------*13370000
133800*    DETERMINE WHICH REPORT IS BEING CREATED AND CHECK FOR       *13380020
133900*    POSSIBLE VENDOR LIMIT.                                      *13390020
134000*                                                                *13400020
134100*    IF GMM OR DMM REPORT,                                       *13410020
134200*        IF VENDOR LIMIT IS SET AND VENDOR LIMIT HAS BE REACHED, *13420020
134300*            DO NOT PRINT VENDOR OR ADD TO DMM OR GMM TOTALS.    *13430020
134400*                                                                *13440040
134500*    IF COMPANY OR COLBY REPORT,                                 *13450040
134600*        IF VENDOR LIMIT IS SET, SET END OF FILE SWITCH IF LIMIT *13460040
134700*            HAS BEEN REACHED.                                   *13470040
134800*----------------------------------------------------------------*13480048
134900 4000-PRINT-DETAIL.                                               13490000
135000                                                                  13500000
135100     IF CC-GMM-NBR                                                13510043
135200       OR CC-DMM-NBR                                              13520043
135300         IF PS-LIMIT-REPORT-LINES-YES                             13530040
135400           AND PV-VENDOR-COUNT = KRPRPM-FUNC-QTY                  13540040
135500             SET PS-ADD-TO-TOTALS-NO TO TRUE                      13550003
135600         ELSE                                                     13560002
135700             PERFORM 4010-PRINT-LINE                              13570040
135800         END-IF                                                   13580002
135900     END-IF.                                                      13590002
136000                                                                  13600002
136100     IF CC-BYR-NBR                                                13610002
136200         PERFORM 4010-PRINT-LINE                                  13620040
136300     END-IF.                                                      13630002
136400                                                                  13640002
136500     IF CC-COLBY                                                  13650043
136600       OR CC-COMPANY                                              13660043
136700         IF PS-LIMIT-REPORT-LINES-YES                             13670040
136800           AND PV-VENDOR-COUNT = KRPRPM-FUNC-QTY                  13680040
136900             SET PS-INPUT-EOF-YES TO TRUE                         13690040
137000         ELSE                                                     13700040
137100             PERFORM 4010-PRINT-LINE                              13710040
137200         END-IF                                                   13720040
137300     END-IF.                                                      13730040
137400                                                                  13740040
137500*----------------------------------------------------------------*13750002
137600*    PRINT DETAIL LINE IF VALID DATA FOUND.                      *13760020
137700*----------------------------------------------------------------*13770002
137800 4010-PRINT-LINE.                                                 13780040
137900***  DISPLAY '   4010-PRINT-LINE FOR ' DL1-VENDOR-NAME.           13790059
138000                                                                  13800002
138100     IF PV-REC-COUNT = +1                                         13810002
138200         CONTINUE                                                 13820002
138300     ELSE                                                         13830002
138400         IF PS-VALID-DATA-TO-PRINT-YES                            13840017
138500             MOVE PC-PCT-SIGN TO DL1-PCT-1                        13850017
138600                                 DL1-PCT-2                        13860017
138700                                 DL1-PCT-3                        13870017
138800                                 DL1-PCT-4                        13880017
138900                                                                  13890017
139000             IF PV-LINE-COUNT > PC-LINE-LIMIT                     13900017
139100                 PERFORM 4100-PRINT-RPT-HEADING                   13910040
139200             END-IF                                               13920017
139300                                                                  13930017
139400             WRITE REPORT-RECORD FROM DL1-DETAIL-LINE-1           13940017
139500                 AFTER ADVANCING 2 LINES                          13950017
139600                                                                  13960017
139700             ADD 2 TO PV-LINE-COUNT                               13970017
139800             ADD 1 TO PV-VENDOR-COUNT                             13980021
139900         END-IF                                                   13990017
140000     END-IF.                                                      14000001
140100                                                                  14010000
140200*----------------------------------------------------------------*14020000
140300*    PRINT REPORT HEADING LINES.                                 *14030020
140400*----------------------------------------------------------------*14040000
140500 4100-PRINT-RPT-HEADING.                                          14050040
140600                                                                  14060000
140700     ADD 1                TO PV-PAGE-COUNT.                       14070000
140800     MOVE PV-PAGE-COUNT   TO HL1-PAGE-NUMBER.                     14080000
140900                                                                  14090000
141000     WRITE REPORT-RECORD FROM HL1-HEADING-LINE-1                  14100000
141100         AFTER ADVANCING PAGE.                                    14110000
141200                                                                  14120000
141300     WRITE REPORT-RECORD FROM HL2-HEADING-LINE-2                  14130000
141400         AFTER ADVANCING 1 LINES.                                 14140032
141500                                                                  14150000
141600     WRITE REPORT-RECORD FROM HL2-HEADING-LINE-2B                 14160032
141700         AFTER ADVANCING 1 LINES.                                 14170032
141800                                                                  14180032
141900     WRITE REPORT-RECORD FROM HL2-HEADING-LINE-2C                 14190044
142000         AFTER ADVANCING 1 LINES.                                 14200044
142100                                                                  14210044
142200     WRITE REPORT-RECORD FROM PR-PRINT-DASH-1                     14220000
142300         AFTER ADVANCING 1 LINES.                                 14230044
142400                                                                  14240000
142500     WRITE REPORT-RECORD FROM HL3-HEADING-LINE-3                  14250000
142600         AFTER ADVANCING 1 LINES.                                 14260000
142700                                                                  14270000
142800     WRITE REPORT-RECORD FROM PR-PRINT-DASH-1                     14280000
142900         AFTER ADVANCING 1 LINES.                                 14290000
143000                                                                  14300000
143100     WRITE REPORT-RECORD FROM HL4-HEADING-LINE-4                  14310000
143200         AFTER ADVANCING 1 LINES.                                 14320000
143300                                                                  14330000
143400     WRITE REPORT-RECORD FROM HL5-HEADING-LINE-5                  14340000
143500         AFTER ADVANCING 1 LINES.                                 14350000
143600                                                                  14360000
143700     WRITE REPORT-RECORD FROM HL6-HEADING-LINE-6                  14370000
143800         AFTER ADVANCING 1 LINES.                                 14380000
143900                                                                  14390000
144000     WRITE REPORT-RECORD FROM PR-PRINT-DASH-2                     14400000
144100         AFTER ADVANCING 1 LINES.                                 14410000
144200                                                                  14420000
144300     MOVE 10 TO PV-LINE-COUNT.                                    14430032
144400                                                                  14440000
144500*----------------------------------------------------------------*14450000
144600*    PRINT BREAK TOTALS AFTER PERFORMING LINE CALCULATIONS.      *14460040
144700*----------------------------------------------------------------*14470000
144800 4200-PRINT-BREAK-TOTALS.                                         14480040
144900                                                                  14490000
145000     MOVE SPACES TO TL1-TOT-LINE-1.                               14500012
145100                                                                  14510000
145200     IF PV-BRK-UNITS-OVER NOT = ZEROES                            14520040
145300         COMPUTE PV-BRK-PCT-OVER       ROUNDED =                  14530040
145400                (PV-BRK-OVR-QTY      /                            14540040
145500                 PV-BRK-UNITS-OVER)  * 100                        14550040
145600     END-IF.                                                      14560040
145700                                                                  14570040
145800     IF PV-BRK-UNITS-SHORT NOT = ZEROES                           14580040
145900         COMPUTE PV-BRK-PCT-SHORT      ROUNDED =                  14590040
146000                (PV-BRK-SHT-QTY      /                            14600040
146100                 PV-BRK-UNITS-SHORT) * 100                        14610040
146200     END-IF.                                                      14620040
146300                                                                  14630040
146400* COMPUTE BREAK SHIPPING ACCURACY (B1)                            14640040
146500     IF PV-INTENDED-ORD-QTY-B1 > ZEROES                           14650040
146600         COMPUTE PV-ACCURACY ROUNDED = ((1                        14660040
146700                                       - (PV-TOTAL-OVER-SHORT-B1  14670040
146800                                       / PV-INTENDED-ORD-QTY-B1)) 14680040
146900                                       * 100)                     14690040
147000         IF PV-ACCURACY > +0                                      14700040
147100             COMPUTE PV-ACCURACY-999 ROUNDED = PV-ACCURACY * 1    14710054
147200             MOVE PV-ACCURACY-999 TO TL1-SHIPMENT-ACCURACY        14720054
147300         ELSE                                                     14730040
147400             MOVE ZEROES      TO TL1-SHIPMENT-ACCURACY            14740040
147500     ELSE                                                         14750040
147600         MOVE ZEROES          TO TL1-SHIPMENT-ACCURACY            14760040
147700     END-IF.                                                      14770040
147800                                                                  14780040
147900* COMPUTE BREAK SHIPPING ACCURACY YTD (B2)                        14790040
148000     IF PV-INTENDED-ORD-QTY-B2 > ZEROES                           14800040
148100         COMPUTE PV-ACCURACY ROUNDED = ((1                        14810040
148200                                  - (PV-TOTAL-OVER-SHORT-B2       14820040
148300                                  / PV-INTENDED-ORD-QTY-B2))      14830040
148400                                  * 100)                          14840040
148500         IF PV-ACCURACY > +0                                      14850040
148600             COMPUTE PV-ACCURACY-999 ROUNDED = PV-ACCURACY * 1    14860054
148700             MOVE PV-ACCURACY-999 TO TL1-YTD-ACCURACY             14870054
148800         ELSE                                                     14880040
148900             MOVE ZEROES      TO TL1-YTD-ACCURACY                 14890040
149000     ELSE                                                         14900040
149100         MOVE ZEROES          TO TL1-YTD-ACCURACY                 14910040
149200     END-IF.                                                      14920040
149300                                                                  14930040
149400     MOVE PC-TITLE-NAME-1    TO  TL1-TITLE.                       14940040
149500     MOVE HL3-SEQUENCE-TYPE  TO  TL1-VENDOR-NAME.                 14950040
149600     MOVE HL3-USER-ID        TO  TL1-USER-ID.                     14960040
149700     MOVE PV-BRK-PO-COUNT    TO  TL1-PO-COUNT.                    14970040
149800     MOVE PV-BRK-PCT-OVER    TO  TL1-PCT-OVER.                    14980040
149900     MOVE PV-BRK-PCT-SHORT   TO  TL1-PCT-SHORT.                   14990040
150000                                                                  15000000
150100     COMPUTE TL1-TOT-RETAIL-IMPACT ROUNDED =                      15010034
150200            (PV-BRK-OVR-RETAIL -                                  15020034
150300             PV-BRK-SHT-RETAIL)    / 1000.                        15030034
150400     COMPUTE TL1-UNITS-ORD         ROUNDED =                      15040034
150500             PV-BRK-CURR-SPLIT-QTY / 1000.                        15050034
150600     COMPUTE TL1-UNITS-RECV        ROUNDED =                      15060034
150700             PV-BRK-EXPTED-ITM-QTY / 1000.                        15070034
150800     COMPUTE TL1-UNITS-ORD-OVER    ROUNDED =                      15080034
150900             PV-BRK-UNITS-OVER     / 1000.                        15090034
151000     COMPUTE TL1-UNITS-RECV-OVER   ROUNDED =                      15100034
151100             PV-BRK-OVR-QTY        / 1000.                        15110034
151200     COMPUTE TL1-UNITS-ORD-SHORT   ROUNDED =                      15120034
151300             PV-BRK-UNITS-SHORT    / 1000.                        15130034
151400     COMPUTE TL1-UNITS-RECV-SHORT  ROUNDED =                      15140034
151500             PV-BRK-SHT-QTY        / 1000.                        15150034
151600     COMPUTE TL1-TOT-OVSH          ROUNDED =                      15160034
151700             PV-BRK-OVSH           / 1000.                        15170034
151800                                                                  15180000
151900     ADD PV-BRK-EXPTED-ITM-QTY     TO  PV-TOT-EXPTED-ITM-QTY.     15190000
152000     ADD PV-BRK-VERIFY-ITM-QTY     TO  PV-TOT-VERIFY-ITM-QTY.     15200000
152100     ADD PV-BRK-CURR-SPLIT-QTY     TO  PV-TOT-CURR-SPLIT-QTY.     15210000
152200     ADD PV-BRK-OVR-QTY            TO  PV-TOT-OVR-QTY.            15220000
152300     ADD PV-BRK-SHT-QTY            TO  PV-TOT-SHT-QTY.            15230000
152400     ADD PV-BRK-UNITS-OVER         TO  PV-TOT-UNITS-OVER.         15240000
152500     ADD PV-BRK-UNITS-SHORT        TO  PV-TOT-UNITS-SHORT.        15250000
152600     ADD PV-BRK-OVR-RETAIL         TO  PV-TOT-OVR-RETAIL.         15260000
152700     ADD PV-BRK-SHT-RETAIL         TO  PV-TOT-SHT-RETAIL.         15270000
152800     ADD PV-BRK-OVSH               TO  PV-TOT-OVSH.               15280000
152900     ADD PV-BRK-PO-COUNT           TO  PV-TOT-PO-COUNT.           15290040
153000                                                                  15300000
153100     MOVE PC-PCT-SIGN  TO  TL1-PCT-1                              15310000
153200                           TL1-PCT-2                              15320000
153300                           TL1-PCT-3                              15330000
153400                           TL1-PCT-4.                             15340000
153500                                                                  15350000
153600     IF PV-LINE-COUNT > PC-LINE-LIMIT                             15360000
153700         PERFORM 4100-PRINT-RPT-HEADING                           15370040
153800     END-IF.                                                      15380000
153900                                                                  15390000
154000     WRITE REPORT-RECORD FROM PR-PRINT-DASH-3                     15400040
154100         AFTER ADVANCING 2 LINES.                                 15410000
154200                                                                  15420000
154300     WRITE REPORT-RECORD FROM TL1-TOT-LINE-1                      15430040
154400         AFTER ADVANCING 2 LINES.                                 15440040
154500                                                                  15450000
154600     WRITE REPORT-RECORD FROM PR-PRINT-BLANK-LINE                 15460040
154700         AFTER ADVANCING 1 LINES.                                 15470040
154800                                                                  15480040
154900     INITIALIZE PV-BREAK-TOTALS.                                  15490040
155000                                                                  15500040
155100*----------------------------------------------------------------*15510000
155200*    PRINT FINAL TOTALS AFTER PERFORMING FIELD CALCULATIONS.     *15520016
155300*----------------------------------------------------------------*15530000
155400 5000-PRINT-FINAL-TOTALS.                                         15540000
155500                                                                  15550000
155600     IF PS-PROCESS-CURR-YES                                       15560000
155700         PERFORM 3100-PRINT-DETAIL-LINE                           15570000
155800     END-IF.                                                      15580000
155900                                                                  15590000
156000     IF PV-BRK-PO-COUNT > +0                                      15600000
156100         PERFORM 4200-PRINT-BREAK-TOTALS                          15610040
156200     END-IF.                                                      15620000
156300                                                                  15630000
156400     MOVE SPACES TO TL1-TOT-LINE-1.                               15640012
156500                                                                  15650040
156600* COMPUTE TOTAL SHIPPING ACCURACY (T1)                            15660040
156700     IF PV-INTENDED-ORD-QTY-T1 > ZEROES                           15670040
156800         COMPUTE PV-ACCURACY ROUNDED = ((1                        15680040
156900                                - (PV-TOTAL-OVER-SHORT-T1         15690040
157000                                /  PV-INTENDED-ORD-QTY-T1))       15700040
157100                                *  100)                           15710040
157200         IF PV-ACCURACY > +0                                      15720040
157300             COMPUTE PV-ACCURACY-999 ROUNDED = PV-ACCURACY * 1    15730054
157400             MOVE PV-ACCURACY-999 TO TL1-SHIPMENT-ACCURACY        15740054
157500         ELSE                                                     15750040
157600             MOVE ZEROES      TO TL1-SHIPMENT-ACCURACY            15760040
157700     ELSE                                                         15770040
157800         MOVE ZEROES          TO TL1-SHIPMENT-ACCURACY            15780040
157900     END-IF.                                                      15790020
158000                                                                  15800000
158100* COMPUTE TOTAL SHIPPING ACCURACY YTD (T2)                        15810040
158200     IF PV-INTENDED-ORD-QTY-T2 > ZEROES                           15820040
158300         COMPUTE PV-ACCURACY ROUNDED = ((1                        15830040
158400                                  - (PV-TOTAL-OVER-SHORT-T2       15840040
158500                                  / PV-INTENDED-ORD-QTY-T2))      15850040
158600                                  * 100)                          15860040
158700         IF PV-ACCURACY > +0                                      15870040
158800             COMPUTE PV-ACCURACY-999 ROUNDED = PV-ACCURACY * 1    15880054
158900             MOVE PV-ACCURACY-999 TO TL1-YTD-ACCURACY             15890054
159000         ELSE                                                     15900040
159100             MOVE ZEROES      TO TL1-YTD-ACCURACY                 15910040
159200     ELSE                                                         15920040
159300         MOVE ZEROES          TO TL1-YTD-ACCURACY                 15930040
159400     END-IF.                                                      15940040
159500                                                                  15950040
159600     IF PV-TOT-UNITS-OVER NOT = ZEROES                            15960040
159700         COMPUTE PV-TOT-PCT-OVER ROUNDED = (PV-TOT-OVR-QTY        15970040
159800                                         / PV-TOT-UNITS-OVER)     15980040
159900                                         * 100                    15990040
160000     END-IF.                                                      16000040
160100                                                                  16010040
160200     IF PV-TOT-UNITS-SHORT NOT = ZEROES                           16020040
160300         COMPUTE PV-TOT-PCT-SHORT ROUNDED = (PV-TOT-SHT-QTY       16030040
160400                                          / PV-TOT-UNITS-SHORT)   16040040
160500                                          * 100                   16050040
160600     END-IF.                                                      16060040
160700                                                                  16070000
160800     MOVE PC-TITLE-NAME-2   TO  TL1-TITLE.                        16080040
160900     MOVE SPACES            TO  TL1-VENDOR-NAME.                  16090040
161000     MOVE PV-TOT-PCT-OVER   TO  TL1-PCT-OVER.                     16100040
161100     MOVE PV-TOT-PCT-SHORT  TO  TL1-PCT-SHORT.                    16110040
161200     MOVE PV-TOT-PO-COUNT   TO  TL1-PO-COUNT.                     16120040
161300                                                                  16130040
161400     COMPUTE TL1-TOT-RETAIL-IMPACT ROUNDED =                      16140040
161500            (PV-TOT-OVR-RETAIL     -                              16150040
161600             PV-TOT-SHT-RETAIL)    / 1000.                        16160040
161700     COMPUTE TL1-UNITS-ORD         ROUNDED =                      16170040
161800             PV-TOT-CURR-SPLIT-QTY / 1000.                        16180040
161900     COMPUTE TL1-UNITS-RECV        ROUNDED =                      16190040
162000             PV-TOT-EXPTED-ITM-QTY / 1000.                        16200040
162100     COMPUTE TL1-UNITS-ORD-OVER    ROUNDED =                      16210040
162200             PV-TOT-UNITS-OVER     / 1000.                        16220040
162300     COMPUTE TL1-UNITS-RECV-OVER   ROUNDED =                      16230040
162400             PV-TOT-OVR-QTY        / 1000.                        16240040
162500     COMPUTE TL1-UNITS-ORD-SHORT   ROUNDED =                      16250040
162600             PV-TOT-UNITS-SHORT    / 1000.                        16260040
162700     COMPUTE TL1-UNITS-RECV-SHORT  ROUNDED =                      16270040
162800             PV-TOT-SHT-QTY        / 1000.                        16280040
162900     COMPUTE TL1-TOT-OVSH          ROUNDED =                      16290040
163000             PV-TOT-OVSH           / 1000.                        16300040
163100                                                                  16310000
163200     MOVE PC-PCT-SIGN TO TL1-PCT-1                                16320000
163300                         TL1-PCT-2                                16330000
163400                         TL1-PCT-3                                16340000
163500                         TL1-PCT-4.                               16350000
163600                                                                  16360000
163700     IF PV-LINE-COUNT > PC-LINE-LIMIT                             16370000
163800         PERFORM 4100-PRINT-RPT-HEADING                           16380040
163900     END-IF.                                                      16390000
164000                                                                  16400000
164100     WRITE REPORT-RECORD FROM PR-PRINT-DASH-3                     16410040
164200         AFTER ADVANCING 2 LINES.                                 16420000
164300                                                                  16430000
164400     WRITE REPORT-RECORD FROM TL1-TOT-LINE-1                      16440040
164500         AFTER ADVANCING 2 LINES.                                 16450040
164600                                                                  16460000
164700     WRITE REPORT-RECORD FROM PR-PRINT-BLANK-LINE                 16470040
164800         AFTER ADVANCING 1 LINES.                                 16480040
164900                                                                  16490040
165000*---------------------------------------------------------------* 16500000
165100*    PRINT END OF REPORT BANNER                                 * 16510000
165200*---------------------------------------------------------------* 16520000
165300 5100-PRINT-END-OF-REPORT.                                        16530000
165400                                                                  16540000
165500     PERFORM 5000-PRINT-FINAL-TOTALS.                             16550000
165600                                                                  16560000
165700     IF PV-LINE-COUNT > PC-LINE-LIMIT                             16570000
165800         PERFORM 4100-PRINT-RPT-HEADING                           16580040
165900     END-IF.                                                      16590000
166000                                                                  16600000
166100     WRITE REPORT-RECORD FROM PR-PRINT-FINAL                      16610000
166200         AFTER ADVANCING 2 LINES.                                 16620000
166300                                                                  16630000
166400*---------------------------------------------------------------* 16640000
166500*    PRINT "NO DETAIL REPORT" BANNER                            * 16650000
166600*---------------------------------------------------------------* 16660000
166700 6000-NO-REPORT-DETAIL.                                           16670000
166800                                                                  16680000
166900     IF PV-LINE-COUNT > PC-LINE-LIMIT                             16690000
167000         PERFORM 4100-PRINT-RPT-HEADING                           16700040
167100     END-IF.                                                      16710000
167200                                                                  16720000
167300     WRITE REPORT-RECORD FROM PR-PRINT-NO-DETAIL                  16730000
167400         AFTER ADVANCING 2 LINES.                                 16740000
167500                                                                  16750000
167600*----------------------------------------------------------------*16760000
167700*----------------------------------------------------------------*16770040
167800 7000-READ-DATE.                                                  16780000
167900     MOVE '7000-READ-DATE  '  TO PV-ABEND-PARAGRAPH.              16790024
168000                                                                  16800000
168100     READ DATE-FILE  INTO  RC067-DATE-RECORD                      16810000
168200       AT END                                                     16820040
168300         MOVE 'EMPTY DATE FILE '  TO PV-ABEND-DISPLAY-1           16830040
168400         PERFORM 9000-ABEND-ROUTINE                               16840040
168500     END-READ.                                                    16850000
168600                                                                  16860000
168700     DISPLAY 'DATE RECORD SET-UP IS : ' RC067-DATE-RECORD.        16870000
168800                                                                  16880000
168900     MOVE RC067-DATE-START          TO  HL2-MONTH-YEAR-START.     16890000
169000     MOVE RC067-DATE-END            TO  HL2-MONTH-YEAR-END.       16900000
169100     MOVE RC067-DATE-FISCAL-PERIOD  TO  HL2-PERIOD.               16910000
169200     MOVE RC067-DATE-FISCAL-QUARTER TO  HL2-QUARTER.              16920000
169300                                                                  16930000
169400     MOVE RC067-DATE-END-CCYY       TO  PV-HOLD-DATE-CCYY.        16940000
169500     MOVE RC067-DATE-END-MM         TO  PV-HOLD-DATE-MM.          16950000
169600     MOVE RC067-DATE-END-DD         TO  PV-HOLD-DATE-DD.          16960000
169700                                                                  16970000
169800*----------------------------------------------------------------*16980000
169900 7100-READ-CONTROL-FILE.                                          16990000
170000     MOVE '7100-READ-CONTROL-FILE'  TO PV-ABEND-PARAGRAPH.        17000024
170100                                                                  17010024
170200     READ CONTROL-FILE INTO CC-CONTROL-CARD-PARAMETERS            17020000
170300       AT END                                                     17030040
170400         MOVE 'EMPTY CONTROL FILE ' TO PV-ABEND-DISPLAY-1         17040040
170500         PERFORM 9000-ABEND-ROUTINE                               17050040
170600     END-READ.                                                    17060000
170700                                                                  17070000
170800     DISPLAY 'CONTROL CARD SET-UP IS : '                          17080000
170900             CC-CONTROL-CARD-PARAMETERS.                          17090040
171000                                                                  17100000
171100*----------------------------------------------------------------*17110000
171200*    CHECK THAT A VALID DATE HAS BEEN REQUESTED....              *17120000
171300*    'AR' - ARRIVAL DATE                                         *17130000
171400*    'VE' - VERIFIED DATE                                        *17140000
171500*----------------------------------------------------------------*17150000
171600     IF NOT CC-VALID-DATE                                         17160000
171700         STRING  'CONTROL PARAMETERS: ' CC-CONTROL-CARD-PARAMETERS17170000
171800             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-1            17180000
171900         STRING  'DATE INDICATOR "' CC-EXTRACT-DATE '" ID INVALID'17190000
172000             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-2            17200000
172100         MOVE 'RUN ABORTED  ' TO PV-ABEND-DISPLAY-3               17210000
172200         PERFORM 9000-ABEND-ROUTINE                               17220000
172300     END-IF.                                                      17230000
172400                                                                  17240000
172500*----------------------------------------------------------------*17250000
172600*    CHECK THAT A VALID TYPE HAS BEEN REQUESTED......            *17260000
172700*    'P' - PERIOD                                                *17270000
172800*    'S' - SEASONAL                                              *17280000
172900*    'Y' - YEAR END                                              *17290000
173000*----------------------------------------------------------------*17300000
173100     IF NOT CC-VALID-TYPE                                         17310000
173200         STRING  'CONTROL PARAMETERS: ' CC-CONTROL-CARD-PARAMETERS17320000
173300             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-1            17330000
173400         STRING  'TYPE INDICATOR "' CC-EXTRACT-TYPE '" IS INVALID'17340000
173500             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-2            17350000
173600         MOVE 'RUN ABORTED' TO PV-ABEND-DISPLAY-3                 17360000
173700         PERFORM 9000-ABEND-ROUTINE                               17370000
173800     END-IF.                                                      17380000
173900                                                                  17390000
174000     IF NOT CC-EXTRACT-VALID-SEASON                               17400000
174100         STRING  'CONTROL PARAMETERS: ' CC-CONTROL-CARD-PARAMETERS17410000
174200             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-1            17420000
174300         STRING  'TYPE SEASON "' CC-EXTRACT-SEASON '" IS INVALID' 17430000
174400             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-2            17440000
174500         MOVE 'RUN ABORTED' TO PV-ABEND-DISPLAY-3                 17450000
174600         PERFORM 9000-ABEND-ROUTINE                               17460000
174700     END-IF.                                                      17470000
174800                                                                  17480000
174900*---------------------------------------------------------------* 17490000
175000*    READ INPUT FILE                                            * 17500000
175100*---------------------------------------------------------------* 17510000
175200 8000-READ-INPUT-FILE.                                            17520000
175300                                                                  17530000
175400     READ INPUT-FILE INTO RC065-RCVR-EXTRACT-RECORD               17540040
175500         AT END                                                   17550000
175600             SET PS-INPUT-EOF-YES TO TRUE                         17560000
175700     END-READ.                                                    17570000
175800                                                                  17580000
175900     ADD +1 TO PV-REC-COUNT.                                      17590000
176000                                                                  17600000
176100*----------------------------------------------------------------*17610000
176200 8100-CALL-DATE-MODULE.                                           17620000
176300                                                                  17630000
176400     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                17640000
176500                                             DPG52                17650000
176600                                             DPG53                17660000
176700                                             DPG54                17670000
176800                                             DPG55                17680000
176900                                             DPG56.               17690000
177000                                                                  17700000
177100     EVALUATE TRUE                                                17710000
177200       WHEN DPG54-SEVERE-ERROR                                    17720000
177300           DISPLAY '---------------------------------------------'17730020
177400           DISPLAY 'INPUT DATE IS      ' DPG52-LK-DATE-INPUT      17740020
177500           DISPLAY '---------------------------------------------'17750020
177600           DISPLAY '** ABEND **        '                          17760020
177700           DISPLAY '** PGM = RCKRP080  '                          17770020
177800           DISPLAY '** EXECUTE PARAGRAPH ' PV-ABEND-PARAGRAPH     17780020
177900           DISPLAY '** ABEND PARAGRAPH - 8100-CALL-DATE-MODULE'   17790020
178000           DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE.  '   17800020
178100           DISPLAY '** ERROR MESSAGE = ' DPG54-ERROR-MESSAGE      17810020
178200           DISPLAY '** DPG51         = ' DPG51                    17820020
178300           DISPLAY '** DPG52         = ' DPG52                    17830020
178400           DISPLAY '** DPG53         = ' DPG53                    17840020
178500           DISPLAY '** DPG54         = ' DPG54                    17850020
178600           DISPLAY '---------------------------------------------'17860020
178700           MOVE +4003 TO PV-ABEND-CODE                            17870020
178800           CALL 'ILBOABN0' USING PV-ABEND-CODE                    17880020
178900                                                                  17890020
179000       WHEN OTHER                                                 17900020
179100           CONTINUE                                               17910020
179200                                                                  17920020
179300     END-EVALUATE.                                                17930020
179400                                                                  17940020
179500*----------------------------------------------------------------*17950020
179600*----------------------------------------------------------------*17960040
179700 9000-ABEND-ROUTINE.                                              17970000
179800                                                                  17980000
179900     DISPLAY '*-----------------------------------------*'        17990000
180000     DISPLAY ' PROGRAM    :  ' PV-ABEND-PROGRAM.                  18000000
180100     DISPLAY ' PARAGRAPH  :  ' PV-ABEND-PARAGRAPH.                18010000
180200     DISPLAY ' ABEND CODE :  ' PV-ABEND-CODE.                     18020000
180300     DISPLAY ' '                                                  18030000
180400     DISPLAY ' ' PV-ABEND-DISPLAY-1                               18040000
180500     DISPLAY ' ' PV-ABEND-DISPLAY-2                               18050000
180600     DISPLAY ' ' PV-ABEND-DISPLAY-3                               18060000
180700     DISPLAY '*-----------------------------------------*'        18070000
180800                                                                  18080023
180900     MOVE +4013 TO PV-ABEND-CODE.                                 18090040
181000                                                                  18100000
181100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         18110000
181200                                                                  18120001
181300* -------------------------------------------------------------- *18130001
181400* -------------------------------------------------------------- *18140001
181500 9900-DB2-ABEND.                                                  18150001
181600                                                                  18160001
181700     MOVE SQLCODE TO PV-SQLCODE.                                  18170001
181800                                                                  18180001
181900     DISPLAY '*** DB2 ERROR   '.                                  18190001
182000     DISPLAY '*** SQLCODE   = ' PV-ABEND-CODE.                    18200001
182100     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 18210001
182200     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               18220001
182300     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               18230001
182400     DISPLAY '*** MESSAGE   = ' PV-DB2-OPER-MESS-1.               18240001
182500     DISPLAY '***           = ' PV-DB2-OPER-MESS-2.               18250001
182600     DISPLAY '***           = ' PV-DB2-OPER-MESS-3.               18260001
182700     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCT-1.                18270001
182800                                                                  18280001
182900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         18290001
183000                                                                  18300000
183100* ------------------------------------------------------------- * 18310000
183200* ------------------------------------------------------------- * 18320000
