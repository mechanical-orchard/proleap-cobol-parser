000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS796.                                         00040000
000500 AUTHOR.        OMAN.                                             00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  OCTOBER 2008.                                     00070000
000800 DATE-COMPILED.                                                   00080000
000900*---------------------------------------------------------------* 00090000
001000*   CHANGES MADE ARE AS FOLLOWS:                                  00100000
001100*   CHG   COMP                                                    00110000
001200*   DTE   DATE  CHANGE DESCRIPTION                                00120000
001300*  12/01  ????  ADDED PARA 3100- TO CONTAIN LOGIC THAT HAD BEEN   00130000
001400*               IN 3000-.  ALSO CHANGED WHEN 5405- GETS CALLED    00140000
001500*               BE ONLY WHEN THE TRIP ID CHANGES.  CHANGED FIELDS 00150000
001600*               NAMED -ORIGINAL TO -CURRENT. COPY BEFORE CHANGES  00160000
001700*               CAN BE FOUND IN TKMAM16.Z.CYCLE1(SUKC796A).       00170000
001800*                                                                 00180000
001900*  12/04  OMAN  ADDED ASGD-END-TMST = PC-DEFAULT-TMST AS IT COULD 00190000
002000                COULD UPDATE MORE THAN ONE ROW.                   00200000
002100*                                                                 00210000
002200*  12/10  OMAN  AFTER INSERTS TO SUT00110 TRIP ASSIGMENT, MOVE    00220000
002300                ASSIGNMENT START DATE TO TWO ASC- FIELDS.         00230000
002400*                                                                 00240000
002500*  12/10  OMAN  ADDED COMPARE IN 4400- TO PROTECT TRIP AND        00250000
002600                TK NUMBER IF OPER UNIT ISN'T EQUAL TO LOGGED IN   00260000
002700                OPER UNIT                                         00270000
002800*  12/11 BANDA  IN THE FETCH OF SUT00112-CART-MTCH-CDE,           00280000
002900                CHANGED PC-PO VALUE 'PO 'TO PC-POL VALUE 'POL'    00290000
003000                AS THE VALUE BEING CHECKED WAS NOT CORRECT        00300000
003100*                                                                 00310000
003200*  12/23  OMAN  17793 IR TK NUMBER WASN'T BEING CLEARED OUT       00320000
003300*               WHEN THE USER IS LOGGED OFF (F18)                 00330000
003400*                                                                 00340000
003500*  12/26  OMAN  17880 IR WHEN SELECTING ALL (F21) ON 794 AND      00350000
003600*               COMING TO THIS SCREEN AND THEN PRESSING F20,      00360000
003700*               THE SCAC TRAILER WASN'T BEING POPULATED.          00370000
003800*                                                                 00380000
003900*  01/16/09 CHRISTINE TWIEHAUS                                    00390000
004000*           IR#18045                                              00400000
004100*           AFTER LOGGOFF/LOGON PROCESS                           00410000
004200*           TK IS STILL FILLED IN FROM THE PREVIOUS USER ID.      00420000
004300*           ALSO CHANGED ABEND MSG IN 5400-COUNT-WORKER-ASSIGN.   00430000
004400*           IR#18118                                              00440000
004500*           FIX F5 REFRESH                                        00450000
004600*           IR#18134                                              00460000
004700*           FIX F5 TURN BLUE AND PROTECT TRIP & TK AFTER          00470000
004800*           F2 CONFIRM UPDATE                                     00480020
004900*                                                                 00490000
005000*  01/23/09 CHRISTINE TWIEHAUS                                    00500000
005100*           IR# 18258                                             00510000
005200*           ALWAYS DISPLAY MOST CURRENT DATA                      00520000
005300*           STOP ABEND IF -811 IN 1165-                           00530000
005400*           STOP ABEND IF -811 IN 5400-COUNT-WORKER-ASSIGNMENTS   00540000
005500*           THIS IR REQUIRED UPDATES TO SUKCS794 ALSO             00550000
005600*                                                                 00560000
005700* 01/27/09 GERMAN BANDA                                           00570000
005800*          WHEN F5 REFRESH AFTER UNASSIGN                         00580000
005900*          INITIALIZE TRIP AND TK FIELDS                          00590000
006000*                                                                 00600000
006010*---------------------------------------------------------------  00601009
006020* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00602009
006030* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00603009
006040* MAKING THE CALL DYNAMIC VS STATIC.                              00604009
006100*                                                                 00610000
001130*                                                                 00620033
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00621033
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00622033
006300*---------------------------------------------------------------* 00630000
006400*    Y796 - PRINT AND APPLY ASSIGN / LOGIN                        00640000
006500*    THIS PROGRAM CAN UPDATE THE TRIP, UNASSIGN THE TRIP, OR      00650000
006600*    LOGOFF THE CURRENT TK FROM THE TRIP.                         00660000
006700*                                                                 00670000
006800*---------------------------------------------------------------* 00680000
006900 ENVIRONMENT DIVISION.                                            00690000
007000 DATA DIVISION.                                                   00700000
007100                                                                  00710000
007200 WORKING-STORAGE SECTION.                                         00720000
007300                                                                  00730000
007400 01  DK-DB2-KEYS.                                                 00740000
007500     05  DK-LOC-NBR               PIC  S9(4) COMP   VALUE 0.      00750013
007510     05  DK-OPER-UNT-ID           PIC  S9(4) COMP   VALUE 0.      00751013
007800     05  DK-ACM-LBL-STA-NBR       PIC  S9(9) COMP   VALUE 0.      00780000
007900     05  DK-DOOR-ID               PIC   X(04)       VALUE SPACES. 00790000
008000     05  DK-TRIP-ID               PIC  S9(9) COMP   VALUE 0.      00800000
008100     05  DK-TIMESTAMP             PIC   X(26)       VALUE SPACES. 00810000
008200     05  DK-TIMESTAMP-1-19        PIC   X(19)       VALUE SPACES. 00820000
008300     05  DK-USR-ID                PIC   X(08)       VALUE SPACES. 00830000
008400     05  DK-DC-NBR                PIC  S9(4) COMP   VALUE 0.      00840000
008500                                                                  00850000
008600 01  DN-DB2-NULL-INDICATORS.                                      00860000
008700     05  DN-UPD-BY-NULL           PIC  S9(4) COMP   VALUE 0.      00870000
008800     05  DN-UPD-TMST-NULL         PIC  S9(4) COMP   VALUE 0.      00880000
008900     05  DN-NULL                  PIC  S9(4) COMP   VALUE -1.     00890000
009000     05  PV-NULL-IND              PIC S9(04)  VALUE ZEROS         00900000
009100                                              COMP SYNC.          00910000
009200                                                                  00920000
009300 01  PC-PROGRAM-CONSTANTS.                                        00930000
009400     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'SUKCS796'.  00940000
009500     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'SUK796  '.  00950000
009600     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'SUKM796 '.  00960000
009700     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           00970000
009800                                              COMP.               00980000
009900     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00990000
010000                                              COMP.               01000000
010100     05  PC-INTER-APPL-CODES.                                     01010000
010200         10  PC-INTER-APPL-CRIT-SPEC-UPD  PIC  X(01)  VALUE '1'.  01020000
010300         10  PC-INTER-APPL-CRIT-SPEC-ADD  PIC  X(01)  VALUE '1'.  01030000
010400         10  PC-INTER-APPL-LIST-ADD       PIC  X(01)  VALUE '1'.  01040000
010500         10  PC-INTER-APPL-LIST-UPDATE    PIC  X(01)  VALUE '2'.  01050000
010600     05  PC-SPACE                 PIC  X(03)  VALUE  '   '.       01060000
010700     05  PC-NULL                  PIC S9(04)  VALUE  -1 COMP.     01070000
010800     05  PC-01                    PIC  X(02)  VALUE  '01'.        01080000
010900     05  PC-DC                    PIC  X(02)  VALUE  'DC'.        01090000
011000     05  PC-DS                    PIC  X(02)  VALUE  'DS'.        01100000
011100     05  PC-SH                    PIC  X(02)  VALUE  'SH'.        01110000
011200     05  PC-POL                   PIC  X(03)  VALUE  'POL'.       01120000
011300     05  PC-AVAILABLE             PIC  X(10)  VALUE 'AVAILABLE '. 01130000
011400     05  PC-VENDOR                PIC  X(03)  VALUE  'VND'.       01140000
011500     05  PC-FIRST                 PIC  X(03)  VALUE  'FST'.       01150000
011600     05  PC-DEFAULT-TMST          PIC  X(26)                      01160000
011700                          VALUE  '9999-09-09-09.09.09.999999'.    01170000
011800                                                                  01180000
011900*----------------------------------------------------------------*01190000
012000*  SYSTEM MESSAGES                                                01200000
012100*----------------------------------------------------------------*01210000
012200*   00004 - PRESS F2 TO CONFIRM                                   01220000
012300*   00005 - INVALID VALUE                                         01230000
012400*   00007 - REQUIRED ENTRY                                        01240000
012500*   00008 - MUST BE NUMERIC                                       01250000
012600*   00034 - ADD SUCCESSFUL                                        01260000
012700*   00045 - INVALID FUNCTION                                      01270000
012800*   00059 - UPDATE(S) SUCCESSFUL                                  01280000
012900*   00069 - TOP OF LIST                                           01290000
013000*   00070 - BOTTOM OF LIST                                        01300000
013100*   00115 - DELETE SUCCESSFUL                                     01310000
013200*   00354 - DELETE PENDING - PRESS PF2 TO CONFIRM                 01320000
013300*   00527 - TYPE CODE DOES NOT EXIST                              01330000
013400*   02571 - UNABLE TO UPD - CURRENT OPER UNT AND OPER UNIT ID ENTE01340000
013500*   02574 - UPDATE FUNCTION INVALID - DOOR IS CURRENTLY NOT DEFINE01350000
013600*   02575 - STORE ASSIGNMNT FUNCTION ONLY VALID FOR DOOR TYPES SHI01360000
013700*   02577 - CANNOT CHANGE DOOR TYPE - DOOR ASSIGNED TO A NON-STORE01370000
013800*   02578 - CANNOT CHANGE DOOR TYPE - DOOR ASSIGNED TO A NON-DC LO01380000
013900*   02579 - CANNOT CHANGE DOOR TYPE-DOOR CURRENTLY ASSIGNED TO A D01390000
014000*   02620 - DOORS SHARING SAME CONVEYOR DIVERT CANNOT HAVE SAME ST01400000
014100*   02643 - DOOR ALREADY EXISTS                                   01410000
014200*   02936 - SHARED DIVERT & LANE ASSIGNMENT ONLY VALID FOR SHIPPIN01420000
014300*   03264 - LABEL SEQUENCE MUST BE UNIQUE - DOOR &VAR IS THIS SEQU01430000
014400*   03266 - DOOR LABEL SEQUENCE IS ONLY VALID FOR SHIPPING DOORS  01440000
014500*   03267 - SHIPPING DOOR LABEL SEQUENCE MUST BE GREATER THAN 0   01450000
014600*   03667 - CANNOT ASSIGN ASSOCIATE TO TRIP THAT IS ALREADY CLOSED01460000
014610*   03727 - USER ID CANNOT BE CHANGE FOR END USER FUNCTION        01461002
014620*   03819 = USRID PREV LOC &VAR - IS THIS CORRECT                 01462009
014700*   05046 - LAND ASSGNMT AND DIVERT LOCATION ID REQUIRED FOR SH   01470000
014800*   99901 - INVALID COMMAND WAS ENTERED                           01480000
014900*----------------------------------------------------------------*01490000
015000     05  PC-TSYMSG-NUMBERS.                                       01500000
015100         10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       01510000
015200         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       01520000
015300         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       01530000
015400         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       01540000
015500         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       01550000
015600         10  PC-TSYMSG-00045      PIC  9(05)  VALUE  00045.       01560000
015700         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       01570000
015800         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       01580000
015900         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       01590000
016000         10  PC-TSYMSG-00743      PIC  9(05)  VALUE  00743.       01600000
016100         10  PC-TSYMSG-01305      PIC  9(05)  VALUE  01305.       01610000
016200         10  PC-TSYMSG-02571      PIC  9(05)  VALUE  02571.       01620000
016300         10  PC-TSYMSG-02999      PIC  9(05)  VALUE  02999.       01630000
016400         10  PC-TSYMSG-03653      PIC  9(05)  VALUE  03653.       01640000
016500         10  PC-TSYMSG-03654      PIC  9(05)  VALUE  03654.       01650000
016600         10  PC-TSYMSG-03264      PIC  9(05)  VALUE  03264.       01660000
016700         10  PC-TSYMSG-03266      PIC  9(05)  VALUE  03266.       01670000
016800         10  PC-TSYMSG-03267      PIC  9(05)  VALUE  03267.       01680000
016900         10  PC-TSYMSG-03628      PIC  9(05)  VALUE  03628.       01690000
017000         10  PC-TSYMSG-03629      PIC  9(05)  VALUE  03629.       01700000
017100         10  PC-TSYMSG-03650      PIC  9(05)  VALUE  03650.       01710000
017200         10  PC-TSYMSG-03664      PIC  9(05)  VALUE  03664.       01720000
017300         10  PC-TSYMSG-03667      PIC  9(05)  VALUE  03667.       01730000
017310         10  PC-TSYMSG-03727      PIC  9(05)  VALUE  03727.       01731002
017320         10  PC-TSYMSG-03819      PIC  9(05)  VALUE  03819.       01732009
017400         10  PC-TSYMSG-99901      PIC  9(05)  VALUE  99901.       01740000
017500*                                                                 01750000
017600 01  PS-PROGRAM-SWITCHES.                                         01760000
017700     05  PS-CURRENT-TMST-SW       PIC  X(01)  VALUE  'N'.         01770000
017800         88  PS-USE-CURRENT-TMST              VALUE  'Y'.         01780000
017900         88  PS-USE-ASC-TMST                  VALUE  'N'.         01790000
018000     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         01800000
018100         88  PS-ERROR                         VALUE  'Y'.         01810000
018200         88  PS-NO-ERROR                      VALUE  'N'.         01820000
018300     05  PS-COMMAREA-SW           PIC  X(01)  VALUE  'N'.         01830000
018400         88  PS-COMMAREA-VALID                VALUE  'Y'.         01840000
018500         88  PS-COMMAREA-NOT-VALID            VALUE  'N'.         01850000
018600     05  PS-LIST-END-SW           PIC  X(01)  VALUE  'N'.         01860000
018700         88  PS-LIST-END                      VALUE  'Y'.         01870000
018800         88  PS-NO-LIST-END                   VALUE  'N'.         01880000
018900     05  PS-CARTON-EXCEPTIONS-SW  PIC  X(01)  VALUE  'N'.         01890000
019000         88  PS-CARTON-EXCEPTIONS-END         VALUE  'Y'.         01900000
019100         88  PS-NOT-CARTON-EXCEPTIONS-END     VALUE  'N'.         01910000
019200     05  PS-LBL-SEQ-OPER-EXISTS-SW PIC X(01)  VALUE  'N'.         01920000
019300         88  PS-LBL-SEQ-OPER-EXISTS-YES       VALUE  'Y'.         01930000
019400         88  PS-LBL-SEQ-OPER-EXISTS-NO        VALUE  'N'.         01940000
019500     05  PS-TYPE-CHANGED-SW        PIC X(01)  VALUE  'N'.         01950000
019600         88  PS-TYPE-CHANGED-YES              VALUE  'Y'.         01960000
019700         88  PS-TYPE-CHANGED-NO               VALUE  'N'.         01970000
019800     05  PS-DOOR-ASSIGNED-SW       PIC X(01)  VALUE  'N'.         01980000
019900         88  PS-DOOR-ASSIGNED-YES             VALUE  'Y'.         01990000
020000         88  PS-DOOR-ASSIGNED-NO              VALUE  'N'.         02000000
020100     05  PS-TRIP-FOUND-SW          PIC X(01)  VALUE  'N'.         02010000
020200         88  PS-TRIP-FOUND-YES                VALUE  'Y'.         02020000
020300         88  PS-TRIP-FOUND-NO                 VALUE  'N'.         02030000
020400                                                                  02040000
020500 01  PV-PROGRAM-VARIABLES.                                        02050000
020600     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            02060000
020700                                              COMP SYNC.          02070000
020800     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            02080000
020900                                              COMP SYNC.          02090000
021000     05  PV-INPUT-SPACE-CNT       PIC S9(04)  VALUE +0            02100000
021100                                              COMP SYNC.          02110000
021200     05  PV-READ-COUNT            PIC S9(09)  VALUE +0            02120000
021300                                              COMP-3.             02130000
021400     05  PV-READ-STORES-COUNT     PIC S9(09)  VALUE +0            02140000
021500                                              COMP-3.             02150000
021600     05  PC-MAX-ITEMS             PIC S9(09)  VALUE +3            02160000
021700                                              COMP-3.             02170000
021800     05  PV-LANE-ASSGN-NUM        PIC  9(09)  VALUE ZEROES.       02180000
021900     05  PV-LABEL-SEQ             PIC S9(04) COMP.                02190000
022000     05  PV-LABEL-SEQ-COUNT       PIC S9(09)  VALUE +0            02200000
022100                                              COMP-3.             02210000
022200     05  PV-WORK-COUNT            PIC S9(04) COMP.                02220000
022300     05  PV-COUNT-ASSIGNMENTS     PIC S9(04) COMP.                02230000
022400     05  PV-COUNT-WORKERS         PIC S9(04) COMP.                02240000
022500     05  PV-TK-USER-ID            PIC  X(08).                     02250000
022600     05  PV-COUNT-ACTVE-TRIPS     PIC S9(04) COMP.                02260000
022700     05  PV-PO-EXCEPTIONS         PIC S9(04) COMP.                02270000
022800     05  PV-VENDOR-EXCEPTIONS     PIC S9(04) COMP.                02280000
022900     05  PV-FIRST-EXCEPTIONS      PIC S9(04) COMP.                02290000
023000******************************************************************02300000
023100*PV-INP VARIABLES HOLD COMMAREA VALUES                            02310000
023200*       ONLY PV-INP VARIABLES READ FROM AND WRITE TO ASC-'S       02320000
023300******************************************************************02330000
023400     05  PV-INP-FUNCTION              PIC  X(01).                 02340000
023500     05  PV-INP-CURR-OPER-UNT-ID      PIC S9(04) COMP.            02350000
023600     05  PV-INP-CURR-FCLTY-ID         PIC S9(04) COMP.            02360000
023700     05  PV-INP-CURR-FCLTY-NME        PIC X(25).                  02370000
023800     05  PV-INP-OPER-UNT-ID           PIC S9(04) COMP.            02380000
023900     05  PV-INP-FCLTY-ID              PIC S9(04) COMP.            02390000
024000     05  PV-INP-FCLTY-NME             PIC X(25).                  02400000
024100     05  PV-INP-DOOR-ID               PIC X(04).                  02410000
024200     05  PV-INP-DOOR-TYPE-CDE         PIC X(02).                  02420000
024300     05  PV-INP-DOOR-TYPE-DESC        PIC  X(30).                 02430000
024400     05  PV-INP-LOC-DESC              PIC  X(30).                 02440000
024500     05  PV-INP-LABEL-SEQ             PIC S9(04) COMP.            02450000
024600     05  PV-INP-LANE-ASGNMT           PIC S9(09) COMP.            02460000
024700     05  PV-INP-DIVERT-LOC            PIC  X(04).                 02470000
024800     05  PV-INP-STORE-ASGNMT          PIC  X(05).                 02480000
024900     05  PV-DOOR-ID                   PIC  X(04) VALUE SPACES.    02490000
024910     05  PV-DISP-OPER                 PIC  9(04) VALUE ZEROES.    02491014
024920     05  PV-DISP-SQL                  PIC  -999  VALUE ZEROES.    02492015
025000                                                                  02500000
025100* DB2 TIMESTAMP FORMAT = CCYY-MM-DD-HH.MM.SS.999999               02510000
025200     05 PV-DB2-CURRENT-TMST       PIC  X(26).                     02520000
025300     05 FILLER REDEFINES PV-DB2-CURRENT-TMST.                     02530000
025400         10 PV-DB2-CURRENT-DATE   PIC  X(10).                     02540000
025500         10 PV-DB2-CURRENT-TIME   PIC  X(16).                     02550000
025600                                                                  02560000
025700*---------------------------------------------------------------* 02570000
025800* SELECTON QUEUE LAYOUT                                         * 02580000
025900*---------------------------------------------------------------* 02590000
026000     COPY SUWS088.                                                02600000
026100                                                                  02610000
026200*----------------------------------------------------------------*02620000
026300*    MAP LAYOUT                                                  *02630000
026400*----------------------------------------------------------------*02640000
026500     COPY SUKM796.                                                02650000
026600                                                                  02660000
026700*----------------------------------------------------------------*02670000
026800*    ATTRIBUTE SETTINGS COPYBOOK.                                *02680000
026900*----------------------------------------------------------------*02690000
027000     COPY DPWS015.                                                02700000
027100                                                                  02710000
027200*----------------------------------------------------------------*02720000
027300*    FUNCTION KEYS COPYBOOK                                      *02730000
027400*----------------------------------------------------------------*02740000
027500     COPY DPWS016.                                                02750000
027600                                                                  02760000
027700**--------------------------------------------------------------**02770000
027800** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **02780000
027900** SUB-ROUTINE (DPKUT100).                                      **02790000
028000**--------------------------------------------------------------**02800000
028100     COPY DPWS010I.                                               02810000
028200                                                                  02820000
028300**--------------------------------------------------------------**02830000
028500** PARAMETERS FOR CALLING CICS ARCHITECTURE API                 **02850033
028600**--------------------------------------------------------------**02860000
028700     COPY DPWS030.                                                02870000
028700     COPY DPWS930.                                                02871033
028800                                                                  02880000
028900**--------------------------------------------------------------**02890000
029000*    STANDARD COMMAREA.                                           02900000
029100**--------------------------------------------------------------**02910000
029200     COPY DPWS020.                                                02920000
029300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02930000
029400                                                                  02940000
029500*---------------------------------------------------------------* 02950000
029600* INTER-APPLICATION COMMAREA.                                     02960000
029700*   SUKS087 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02970000
029800*             SPEC SCREEN.                                        02980000
029900*   SUKS089 - IS THE INPUT LAYOUT THAT WILL BE PASSED FROM        02990000
030000*             THE LIST SCREEN                                     03000000
030100*---------------------------------------------------------------* 03010000
030200                                                                  03020000
030300         10  INTER-APPL-COMM-AREA PIC X(200).                     03030000
030400     COPY SUWS087.                                                03040000
030500     COPY SUWS089.                                                03050000
030600***************************************************************** 03060000
030700*    SPECIFIC COMMMAREA FOR SUKCS796.                             03070000
030800***************************************************************** 03080000
030900         10  ASC-SPECIFIC-COMMAREA.                               03090000
031000             15  ASC-FUNCTION              PIC  X(01).            03100000
031100             15  ASC-OPER-UNT-ID           PIC S9(04)  COMP.      03110000
031200             15  ASC-FCLTY-ID              PIC S9(04)  COMP.      03120000
031300             15  ASC-FCLTY-NME             PIC X(25).             03130000
031400             15  ASC-PNA-STA-NBR           PIC 9(04).             03140000
031500             15  ASC-DOOR-ID               PIC X(04).             03150000
031600             15  ASC-SCAC                  PIC X(04).             03160000
031700             15  ASC-TRAILER               PIC X(10).             03170000
031800             15  ASC-TRAILER-CURRENT       PIC X(10).             03180000
031900             15  ASC-ACTV-IND              PIC X(01).             03190000
032000             15  ASC-ARRIVE-DATE           PIC X(10).             03200000
032100             15  ASC-TRIP-ID.                                     03210000
032200                 20  ASC-TRIP-ID-N         PIC 9(09).             03220000
032300             15  ASC-TRIP-ID-CURRENT       PIC 9(09).             03230000
032400             15  ASC-TK-TP-NBR             PIC X(08).             03240000
032500             15  ASC-TK-TP-NBR-CURRENT     PIC X(08).             03250000
032600             15  ASC-TK-COUNT              PIC 9(05).             03260000
032700             15  ASC-PO-NBR                PIC 9(04).             03270000
032800             15  ASC-VNDR-NBR              PIC 9(04).             03280000
032900             15  ASC-FIRST-NBR             PIC 9(04).             03290000
033000             15  ASC-ASGD-STRT-TMST        PIC X(26).             03300000
033100             15  ASC-CURRENT-TMST          PIC X(26).             03310000
033200             15  ASC-ASSIGN-TMST           PIC X(26).             03320000
033300             15  ASC-UNASSIGN-TMST         PIC X(26).             03330000
033400             15  ASC-COUNT                 PIC S9(09) COMP.       03340000
033500             15  ASC-PO-EXCEPTIONS         PIC S9(04) COMP.       03350000
033600             15  ASC-VENDOR-EXCEPTIONS     PIC S9(04) COMP.       03360000
033700             15  ASC-FIRST-EXCEPTIONS      PIC S9(04) COMP.       03370000
033800                                                                  03380000
033900             15  ASC-INT-APPL-FORMAT-IND   PIC X(01).             03390000
034000*SWITCHES                                                         03400000
034100             15  ASC-ACTION-SW          PIC X(03).                03410000
034200                 88  ASC-ADD            VALUE 'ADD'.              03420000
034300                 88  ASC-DELETE         VALUE 'DEL'.              03430000
034400                 88  ASC-UPDATE         VALUE 'UPD'.              03440000
034500             15  ASC-MSG-NUMBER.                                  03450000
034600                 20  ASC-MSG-NUMBER-N      PIC  9(05).            03460000
034700             15  ASC-INT-APPL-FORMAT-SAVE  PIC  X(01).            03470000
034800             15  ASC-MSG-TEXT              PIC  X(70).            03480000
034900             15  ASC-USE-SELECTION-QUEUE-IND                      03490000
035000                                           PIC  X(01).            03500000
035100                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03510000
035200             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            03520000
035300                                                                  03530000
035400             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    03540000
035500             15  ASC-NUMBER-OF-SELECTED-ITEMS                     03550000
035600                                           PIC S9(09)  COMP-3.    03560000
035700             15  ASC-ITEM-SUB                 PIC S9(04)  COMP    03570000
035800                                                          SYNC.   03580000
035900             15  ASC-SEL-SUB               PIC S9(04)  COMP.      03590000
036000             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      03600000
036100             15  ASC-TEMP-QUEUE-UPDATE-SW  PIC  X(01).            03610000
036200                 88  ASC-UPDATE-TSQ                   VALUE 'Y'.  03620000
036300                 88  ASC-NO-TSQ-UPDATE                VALUE ' '.  03630000
036400                                                                  03640000
036500             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         03650000
036600                 88  ASC-ITEMS-LEFT-ON-DB             VALUE 'Y'.  03660000
036700                 88  ASC-NO-ITEMS-LEFT-ON-DB          VALUE 'N'.  03670000
036800             15  ASC-F2-CONFIRM-SW            PIC  X(01).         03680000
036900                 88  ASC-F2-CONFIRM-YES               VALUE 'Y'.  03690000
037000                 88  ASC-F2-CONFIRM-NO                VALUE 'N'.  03700000
037100             15  ASC-UPDATE-TRIP-SW           PIC  X(01).         03710000
037200                 88  ASC-UPDATE-TRIP-YES              VALUE 'Y'.  03720000
037300                 88  ASC-UPDATE-TRIP-NO               VALUE 'N'.  03730000
037400             15  ASC-UPDATE-TK-NBR-SW         PIC  X(01).         03740000
037500                 88  ASC-UPDATE-TK-NBR-YES            VALUE 'Y'.  03750000
037600                 88  ASC-UPDATE-TK-NBR-NO             VALUE 'N'.  03760000
037700             15  ASC-UNASSIGN-SW              PIC  X(01).         03770000
037800                 88  ASC-UNASSIGN-YES                 VALUE 'Y'.  03780000
037900                 88  ASC-UNASSIGN-NO                  VALUE 'N'.  03790000
038000             15  ASC-LOGOFFTK-SW              PIC  X(01).         03800000
038100                 88  ASC-LOGOFFTK-YES                 VALUE 'Y'.  03810000
038200                 88  ASC-LOGOFFTK-NO                  VALUE 'N'.  03820000
038300             15  ASC-PROTECT-SCREEN-SW        PIC  X(01).         03830000
038400                 88  ASC-PROTECT-SCREEN-YES           VALUE 'Y'.  03840000
038500                 88  ASC-PROTECT-SCREEN-NO            VALUE 'N'.  03850000
038600             15  ASC-REFRESH-FUNCTION-SW      PIC  X(01).         03860000
038700                 88  ASC-FUNCTION-NONE              VALUE ' '.    03870000
038800                 88  ASC-UPD-DOOR                   VALUE 'U'.    03880000
038810             15  ASC-CONFIRM-TYPE-IND         PIC  X(01).         03881020
038820                 88  ASC-CONFIRM-TYPE-NONE          VALUE 'N'.    03882020
038830                 88  ASC-CONFIRM-DIFF-OPER          VALUE 'A'.    03883020
038840             15  ASC-FIRST-NAME            PIC X(10).             03884025
038850             15  ASC-LAST-NAME             PIC X(18).             03885025
038900                                                                  03890000
039000*----------------------------------------------------------------*03900000
039100*    ABEND PROCESSING COPYBOOK.                                  *03910000
039200*----------------------------------------------------------------*03920000
039300     COPY DPWS013.                                                03930000
039400                                                                  03940000
039500*----------------------------------------------------------------*03950000
039600*    DB2 TABLE FOR TRIP                                           03960000
039700*----------------------------------------------------------------*03970000
039800     EXEC SQL                                                     03980000
039900          INCLUDE TVHTRIP                                         03990000
040000     END-EXEC.                                                    04000000
040100                                                                  04010000
040200*----------------------------------------------------------------*04020000
040300*    DB2 TABLE FOR TRIP STATUS                                    04030000
040400*----------------------------------------------------------------*04040000
040500     EXEC SQL                                                     04050000
040600          INCLUDE TTRIPST                                         04060000
040700     END-EXEC.                                                    04070000
040800                                                                  04080000
040900*----------------------------------------------------------------*04090000
041000*    DB2 TABLE FOR TEMPORARY DC EMPLOYEES  DLT_TMP_EMP            04100010
041100*----------------------------------------------------------------*04110000
041200     EXEC SQL                                                     04120000
041300          INCLUDE DLT00002                                        04130000
041400     END-EXEC.                                                    04140000
041500                                                                  04150000
041510*----------------------------------------------------------------*04151010
041520*    DB2 TABLE FOR TEMPORARY DC EMPLOYEES DLT_RDPR_USR_LSTG       04152010
041530*----------------------------------------------------------------*04153010
041540     EXEC SQL                                                     04154010
041550          INCLUDE DLT00009                                        04155010
041560     END-EXEC.                                                    04156010
041570                                                                  04157010
041600*----------------------------------------------------------------*04160000
041700*    DB2 TABLE FOR LOGISTICS USERS                                04170000
041800*----------------------------------------------------------------*04180000
041900     EXEC SQL                                                     04190000
042000          INCLUDE XLT00024                                        04200000
042100     END-EXEC.                                                    04210000
042200                                                                  04220000
042300*----------------------------------------------------------------*04230000
042400*    DB2 TABLE DOOR / TRIP HISTORY                                04240000
042500*----------------------------------------------------------------*04250000
042600     EXEC SQL                                                     04260000
042700          INCLUDE SUT00110                                        04270000
042800     END-EXEC.                                                    04280000
042900                                                                  04290000
043000*----------------------------------------------------------------*04300000
043100*    DB2 TABLE DOOR / WORKER HISTORY                              04310000
043200*----------------------------------------------------------------*04320000
043300     EXEC SQL                                                     04330000
043400          INCLUDE SUT00111                                        04340000
043500     END-EXEC.                                                    04350000
043600*----------------------------------------------------------------*04360000
043700*    DB2 TABLE CARTON EXCEPTIONS                                  04370000
043800*----------------------------------------------------------------*04380000
043900     EXEC SQL                                                     04390000
044000          INCLUDE SUT00112                                        04400000
044100     END-EXEC.                                                    04410000
044200*---------------------------------------------------------------* 04420000
044300*    CARTON EXCEPTION COUNT CURSOR                                04430000
044400*---------------------------------------------------------------* 04440000
044500     EXEC SQL                                                     04450000
044600        DECLARE CARTON-EXCEPTIONS-CSR CURSOR FOR                  04460000
044700         SELECT                                                   04470000
044800                 COUNT(*)                                         04480000
044900                ,S112.OPER_UNT_ID                                 04490000
045000                ,S112.ACM_LBL_STA_NBR                             04500000
045100                ,S112.DOOR_ID                                     04510000
045200                ,S112.INBD_TRIP_ID                                04520000
045300                ,S112.CART_MTCH_CDE                               04530000
045400                                                                  04540000
045500           FROM  SUT_TRIP_MTCH_LVL   S112                         04550000
045600          WHERE  S112.OPER_UNT_ID     = :DK-OPER-UNT-ID           04560000
045700            AND  S112.ACM_LBL_STA_NBR = :DK-ACM-LBL-STA-NBR       04570000
045800            AND  S112.DOOR_ID         = :DK-DOOR-ID               04580000
045900            AND  S112.INBD_TRIP_ID    = :DK-TRIP-ID               04590000
046000       GROUP BY  OPER_UNT_ID                                      04600000
046100                ,ACM_LBL_STA_NBR                                  04610000
046200                ,DOOR_ID                                          04620000
046300                ,INBD_TRIP_ID                                     04630000
046400                ,CART_MTCH_CDE                                    04640000
046500     END-EXEC.                                                    04650000
046600                                                                  04660000
046700*----------------------------------------------------------------*04670000
046800*    DB2 AREA FOR COMMUNICATIONS                                  04680000
046900*----------------------------------------------------------------*04690000
047000     EXEC SQL                                                     04700000
047100          INCLUDE SQLCA                                           04710000
047200     END-EXEC.                                                    04720000
047300                                                                  04730000
047400*----------------------------------------------------------------*04740000
047500 LINKAGE SECTION.                                                 04750000
047600                                                                  04760000
047700 01  DFHCOMMAREA.                                                 04770000
047800     05  FILLER                         OCCURS  1 TO 4072 TIMES   04780000
047900                                        DEPENDING ON EIBCALEN.    04790000
048000         10  FILLER                     PIC X.                    04800000
048100                                                                  04810000
048200 PROCEDURE DIVISION.                                              04820000
048300***************************************************************** 04830000
048400** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 04840000
048500** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 04850000
048600** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 04860000
048700**                                                             ** 04870000
048800** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 04880000
048900** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 04890000
049000***************************************************************** 04900000
049100 0000-MAIN-MODULE.                                                04910000
049200     INITIALIZE DP030-CICS-API-FIELDS.                            04920000
049300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04930000
049400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04940000
049500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04950000
049600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04960000
049700     MOVE LENGTH OF SUK796I        TO DP030-MAP-LENGTH (1).       04970000
049800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04980000
049900     PERFORM 0001-CALL-CICS-ARCH-API.                             04990000
050000                                                                  05000000
050100     PERFORM 1000-CONTROL-PROCESSING                              05010000
050200                                                                  05020000
050300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05030000
050400     PERFORM 0001-CALL-CICS-ARCH-API.                             05040000
050500                                                                  05050000
050600 0001-CALL-CICS-ARCH-API.                                         05060000
050610                                                                  05061019
050700*    CALL 'DPKCS030' USING DFHEIBLK                               05070033
050700     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05071033
050800                           DFHCOMMAREA                            05080000
050900                           DP030-CICS-API-FIELDS                  05090000
051000                           DP020-STANDARD-COMMAREA                05100000
051100                           SUK796I.                               05110000
051200                                                                  05120000
051300     IF  DP030-RC-CALL-SUCCESSFUL                                 05130000
051400         CONTINUE                                                 05140000
051500     ELSE                                                         05150000
051600         SET DP013-NO-ROLLBACK                                    05160000
051700             DP013-XCTL-DISPLAY-RESTART                           05170000
051800             DP013-CICS-ABEND      TO TRUE                        05180000
051900         MOVE 'BEFORE 0000-MAIN-MODULE'                           05190000
052000                                   TO DP013-PARAGRAPH             05200000
052100*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX05210033
052200*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      05220033
052100         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05221033
052200-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05222033
052300         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05230000
052400         PERFORM DP013-0000-PROCESS-ABEND                         05240000
052500     END-IF.                                                      05250000
052600*                                                                 05260000
052700*----------------------------------------------------------------*05270000
052800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *05280000
052900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *05290000
053000*----------------------------------------------------------------*05300000
053100 1000-CONTROL-PROCESSING.                                         05310000
053200                                                                  05320000
053300     EVALUATE TRUE                                                05330000
053400         WHEN DP020-NEXT-ACT-INITIAL                              05340000
053500              INITIALIZE ASC-SPECIFIC-COMMAREA                    05350000
053600              PERFORM 1100-PROCESS-INTER-APPL-COMM                05360000
053700                                                                  05370000
053800              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                05380000
053900              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 05390000
054000              MOVE -1                   TO ATRIPIDL               05400000
054100                                                                  05410000
054200         WHEN DP020-NEXT-ACT-READ-MAP                             05420000
054300             PERFORM 2000-PROCESS-PANEL                           05430000
054400*F3-END                                                           05440000
054500         WHEN DP020-NEXT-ACT-RETURN                               05450000
054600              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                05460000
054700              MOVE -1                   TO ATRIPIDL               05470000
054800                                                                  05480000
054900         WHEN OTHER                                               05490000
055000             SET DP013-LOGIC-ABEND TO TRUE                        05500000
055100             SET DP013-NO-ROLLBACK TO TRUE                        05510000
055200             MOVE '1000-CONTROL-PROCESSING'                       05520000
055300                                   TO DP013-PARAGRAPH             05530000
055400             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05540000
055500                                   TO DP013-MESSAGE-TEXT(1)       05550000
055600             MOVE DP020-NEXT-APPL-ACTIVITY                        05560000
055700                                   TO DP013-MESSAGE-TEXT(2)       05570000
055800             PERFORM DP013-0000-PROCESS-ABEND                     05580000
055900     END-EVALUATE.                                                05590000
056000*                                                                 05600000
056100******************************************************************05610000
056200** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **05620000
056300** INTER-APPLICATION FORMAT CODE.                               **05630000
056400******************************************************************05640000
056500 1100-PROCESS-INTER-APPL-COMM.                                    05650000
056501                                                                  05650119
056560                                                                  05656019
056600     INITIALIZE ASC-SPECIFIC-COMMAREA.                            05660000
056700                                                                  05670000
056800     IF SU089-NUMBER-OF-SELECTED-ITEMS > 0                        05680000
056900        SET SU087-FUNCTION-NONE                                   05690000
057000            ASC-FUNCTION-NONE   TO TRUE                           05700000
057100        SET ASC-USE-SELECTION-QUEUE TO TRUE                       05710000
057200        MOVE SU089-NUMBER-OF-SELECTED-ITEMS                       05720000
057300                              TO ASC-NUMBER-OF-SELECTED-ITEMS     05730000
057400        MOVE SU089-NUMBER-OF-TS-ITEMS                             05740000
057500                              TO ASC-NUMBER-OF-TS-ITEMS           05750000
057600        MOVE SU089-SEL-QUEUE-NAME                                 05760000
057700                              TO ASC-SEL-QUEUE-NAME               05770000
057800        MOVE SU089-OPER-UNT-ID      TO ASC-OPER-UNT-ID            05780000
057900        MOVE SU089-FCLTY-ID         TO ASC-FCLTY-ID               05790000
058000        MOVE SU089-FCLTY-NME        TO ASC-FCLTY-NME              05800000
058100        MOVE SU089-PNA-STA-NBR      TO ASC-PNA-STA-NBR            05810000
058200        MOVE 'UPD' TO  ASC-ACTION-SW                              05820000
058300        SET ASC-PROTECT-SCREEN-NO   TO TRUE                       05830000
058400        PERFORM 1120-PREPARE-LIST-ENTRY.                          05840000
058500                                                                  05850000
058600                                                                  05860000
058700*----------------------------------------------------------------*05870000
058800* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *05880000
058900* STORAGE QUEUE PASSED FROM THE LIST.                            *05890000
059000*----------------------------------------------------------------*05900000
059100 1120-PREPARE-LIST-ENTRY.                                         05910000
059110                                                                  05911019
059200     MOVE SU088-MAX-ITEMS          TO ASC-SEL-SUB.                05920000
059300     MOVE ZERO                     TO ASC-SEL-ITEM.               05930000
059400     PERFORM 1130-GET-NEXT-RECORD.                                05940000
059500                                                                  05950000
059600*---------------------------------------------------------------- 05960000
059700*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*05970000
059800*---------------------------------------------------------------- 05980000
059900 1130-GET-NEXT-RECORD.                                            05990000
059910                                                                  05991019
060000     ADD +1                        TO ASC-SEL-SUB.                06000000
060100                                                                  06010000
060200     SET ASC-UPDATE-TSQ TO TRUE.                                  06020000
060300                                                                  06030000
060400     IF  ASC-SEL-SUB > SU088-MAX-ITEMS                            06040000
060500         ADD +1                    TO ASC-SEL-ITEM                06050000
060600         MOVE +1                   TO ASC-SEL-SUB                 06060000
060700     END-IF.                                                      06070000
060800                                                                  06080000
060900     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                06090000
061000         PERFORM 9100-READ-SEL-QUEUE                              06100000
061100         IF  SU088-ITEM (ASC-SEL-SUB) > ZERO                      06110000
061200             PERFORM 1160-MOVE-TO-ASC                             06120000
061300             SET SU088-INQ (ASC-SEL-SUB) TO TRUE                  06130000
061400             PERFORM 9200-REWRITE-SEL-QUEUE                       06140000
061500         ELSE                                                     06150000
061600             SUBTRACT +1 FROM ASC-SEL-SUB                         06160000
061700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            06170000
061800             SET DP020-MSG-INFORMATIONAL                          06180000
061900                 PS-LIST-END       TO TRUE                        06190000
062000         END-IF                                                   06200000
062100     ELSE                                                         06210000
062200         SUBTRACT +1 FROM ASC-SEL-ITEM                            06220000
062300         MOVE SU088-MAX-ITEMS      TO ASC-SEL-SUB                 06230000
062400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            06240000
062500         SET DP020-MSG-INFORMATIONAL                              06250000
062600                 PS-LIST-END       TO TRUE                        06260000
062700     END-IF.                                                      06270000
062800                                                                  06280000
062900******************************************************************06290000
063000*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING         06300000
063100*  PROCESSED.                                                     06310000
063200******************************************************************06320000
063300 1140-GET-PREV-RECORD.                                            06330000
063310                                                                  06331019
063400     SUBTRACT +1 FROM ASC-SEL-SUB.                                06340000
063500                                                                  06350000
063600     IF  ASC-SEL-SUB < +1                                         06360000
063700         SUBTRACT +1 FROM ASC-SEL-ITEM                            06370000
063800         MOVE SU088-MAX-ITEMS      TO ASC-SEL-SUB                 06380000
063900     END-IF.                                                      06390000
064000                                                                  06400000
064100     IF  ASC-SEL-ITEM > ZERO                                      06410000
064200         PERFORM 9100-READ-SEL-QUEUE                              06420000
064300         IF  SU088-ITEM (ASC-SEL-SUB) > ZERO                      06430000
064400             PERFORM 1160-MOVE-TO-ASC                             06440000
064500         END-IF                                                   06450000
064600                                                                  06460000
064700         SET SU088-INQ (ASC-SEL-SUB) TO TRUE                      06470000
064800         PERFORM 9200-REWRITE-SEL-QUEUE                           06480000
064900     ELSE                                                         06490000
065000         MOVE +1                   TO ASC-SEL-ITEM                06500000
065100                                      ASC-SEL-SUB                 06510000
065200         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            06520000
065300         SET DP020-MSG-INFORMATIONAL                              06530000
065400             PS-LIST-END             TO TRUE                      06540000
065500     END-IF.                                                      06550000
065600                                                                  06560000
065700 1160-MOVE-TO-ASC.                                                06570000
065710                                                                  06571019
065800                                                                  06580000
065900     MOVE SU088-DOOR-ID  (ASC-SEL-SUB)  TO ASC-DOOR-ID.           06590000
066000     MOVE SU088-TRIP-ID  (ASC-SEL-SUB)  TO ASC-TRIP-ID-N.         06600000
066100     MOVE SU088-TRIP-ID  (ASC-SEL-SUB)  TO ASC-TRIP-ID-CURRENT.   06610000
066200     MOVE SU088-SCAC     (ASC-SEL-SUB)  TO ASC-SCAC.              06620000
066300                                                                  06630000
066400     MOVE SU088-TRAILER (ASC-SEL-SUB)                             06640000
066500                                     TO ASC-TRAILER               06650000
066600                                        ASC-TRAILER-CURRENT.      06660000
066700     MOVE SU088-ACTV-IND (ASC-SEL-SUB)                            06670000
066800                                     TO ASC-ACTV-IND.             06680000
066900                                                                  06690000
067000     MOVE SU088-ASSIGN-TMST (ASC-SEL-SUB)  TO                     06700000
067100                             ASC-ASGD-STRT-TMST.                  06710000
067200     MOVE SU088-ASSIGN-TMST (ASC-SEL-SUB) TO                      06720000
067300                             ASC-ASSIGN-TMST.                     06730000
067400     MOVE SU088-UNASSIGN-TMST (ASC-SEL-SUB) TO                    06740000
067500                             ASC-UNASSIGN-TMST.                   06750000
067600* CT BEGIN 1/19/09                                                06760000
067700                                                                  06770000
067800*    IF ASC-UNASSIGN-TMST = SPACES                                06780000
067900         PERFORM 1165-COUNT-WORKERS.                              06790000
068000                                                                  06800000
068100* CT END   1/19/09                                                06810000
068200                                                                  06820000
068300     MOVE SU088-TK-COUNT         (ASC-SEL-SUB) TO                 06830000
068400                                  ASC-TK-COUNT                    06840000
068500                                                                  06850000
068600     MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID.                     06860000
068700     MOVE ASC-PNA-STA-NBR  TO DK-ACM-LBL-STA-NBR.                 06870000
068800     MOVE ASC-DOOR-ID      TO DK-DOOR-ID.                         06880000
068900     MOVE ASC-TRIP-ID-N    TO DK-TRIP-ID.                         06890000
069000                                                                  06900000
069100     MOVE 0 TO PV-PO-EXCEPTIONS                                   06910000
069200               PV-VENDOR-EXCEPTIONS                               06920000
069300               PV-FIRST-EXCEPTIONS.                               06930000
069400                                                                  06940000
069500     PERFORM 1200-OPEN-CARTON-EXCEPTIONS.                         06950000
069600                                                                  06960000
069700     SET PS-NOT-CARTON-EXCEPTIONS-END TO TRUE.                    06970000
069800     PERFORM 1220-COUNT-CARTON-EXCEPTIONS                         06980000
069900       UNTIL PS-CARTON-EXCEPTIONS-END.                            06990000
070000                                                                  07000000
070100     PERFORM 1240-CLOSE-CARTON-EXCEPTIONS.                        07010000
070200                                                                  07020000
070300     MOVE PV-PO-EXCEPTIONS      TO ASC-PO-EXCEPTIONS.             07030000
070400     MOVE PV-VENDOR-EXCEPTIONS  TO ASC-VENDOR-EXCEPTIONS.         07040000
070500     MOVE PV-FIRST-EXCEPTIONS   TO ASC-FIRST-EXCEPTIONS.          07050000
070600                                                                  07060000
070700* CT BEGIN 1/19/09 ADDED -811 LINE WE ARE NOW SELECTING NOT COUNT 07070000
070800                                                                  07080000
070900 1165-COUNT-WORKERS.                                              07090000
070910                                                                  07091019
071000     MOVE +0               TO PV-COUNT-WORKERS.                   07100000
071100     MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID.                     07110000
071200     MOVE ASC-PNA-STA-NBR  TO DK-ACM-LBL-STA-NBR.                 07120000
071300     MOVE ASC-DOOR-ID      TO DK-DOOR-ID.                         07130000
071400     MOVE ASC-TRIP-ID-N    TO DK-TRIP-ID.                         07140000
071500                                                                  07150000
071600* CT BEGIN 1/19/09 ADDED -811 LINE WE ARE NOW SELECTING NOT COUNT 07160000
071700     EXEC SQL                                                     07170000
071800         SELECT  A.WRKR_USR_ID                                    07180000
071900           INTO :PV-TK-USER-ID                                    07190000
072000           FROM  SUT_PNA_STA_WRKR   A                             07200000
072100              ,  SUT_PNA_TRIP_ASGMT B                             07210000
072200          WHERE  A.OPER_UNT_ID     =  B.OPER_UNT_ID               07220000
072300            AND  A.OPER_UNT_ID     = :DK-OPER-UNT-ID              07230000
072400            AND  A.ACM_LBL_STA_NBR =  B.ACM_LBL_STA_NBR           07240000
072500            AND  A.ACM_LBL_STA_NBR = :DK-ACM-LBL-STA-NBR          07250000
072600            AND  A.DOOR_ID         =  B.DOOR_ID                   07260000
072700            AND  A.DOOR_ID         = :DK-DOOR-ID                  07270000
072800            AND  A.INBD_TRIP_ID    = :DK-TRIP-ID                  07280000
072900            AND  A.ASGD_STRT_TMST  =  B.ASGD_STRT_TMST            07290000
073000            AND  A.WRKR_END_TMST   = '9999-09-09-09.09.09.999999' 07300000
073100     END-EXEC.                                                    07310000
073200                                                                  07320000
073300     EVALUATE TRUE                                                07330000
073400         WHEN SQLCODE = +0                                        07340000
073500         WHEN SQLCODE = -811                                      07350000
073600            MOVE PV-TK-USER-ID TO ASC-TK-TP-NBR                   07360000
073700                                  ASC-TK-TP-NBR-CURRENT           07370000
073800         WHEN SQLCODE = +100                                      07380000
073900            MOVE SPACES        TO ASC-TK-TP-NBR                   07390000
074000                                  ASC-TK-TP-NBR-CURRENT           07400000
074010                                  ASC-FIRST-NAME                  07401025
074020                                  ASC-LAST-NAME                   07402025
074100         WHEN SQLWARN0 NOT = SPACES                               07410000
074200         WHEN SQLCODE < +0                                        07420000
074300         WHEN SQLCODE > +0                                        07430000
074400             MOVE '1165-COUNT-WORKERS          '                  07440000
074500                                       TO DP013-PARAGRAPH         07450000
074600             MOVE 'SELECT COUNT SQLCODE NOT 0/+100'               07460000
074700                                 TO DP013-MESSAGE-TEXT (1)        07470000
074800             MOVE SQLCA      TO DP013-SQLCA                       07480000
074900             MOVE 'DB2TDBA.SUT_PNA_STA_WRKR' TO                   07490000
075000                                DP013-DB2-TABLE-NAME (1)          07500000
075100             SET DP013-DB2-ABEND                                  07510000
075200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               07520000
075300             PERFORM DP013-0000-PROCESS-ABEND                     07530000
075400     END-EVALUATE.                                                07540000
075500                                                                  07550000
075600* CT END   1/19/09                                                07560000
075700                                                                  07570000
075800 1200-OPEN-CARTON-EXCEPTIONS.                                     07580000
075810                                                                  07581019
075900                                                                  07590000
076000     EXEC SQL                                                     07600000
076100          OPEN    CARTON-EXCEPTIONS-CSR                           07610000
076200     END-EXEC.                                                    07620000
076300                                                                  07630000
076400     EVALUATE TRUE                                                07640000
076500         WHEN SQLCODE = ZERO                                      07650000
076600              CONTINUE                                            07660000
076700         WHEN SQLWARN0 NOT = SPACE                                07670000
076800         WHEN SQLCODE NOT = ZERO                                  07680000
076900              MOVE '1200-OPEN-CARTON-EXCEPTIONS' TO               07690000
077000                                        DP013-PARAGRAPH           07700000
077100              MOVE 'SUT-TRIP-MTCH-LVL '                           07710000
077200                               TO DP013-DB2-TABLE-NAME (1)        07720000
077300              MOVE 'COULD NOT FETCH ROW'                          07730000
077400                               TO DP013-MESSAGE-TEXT (1)          07740000
077500              MOVE SQLCA       TO DP013-SQLCA                     07750000
077600              SET DP013-DB2-ABEND TO TRUE                         07760000
077700              PERFORM DP013-0000-PROCESS-ABEND                    07770000
077800     END-EVALUATE.                                                07780000
077900                                                                  07790000
078000 1220-COUNT-CARTON-EXCEPTIONS.                                    07800000
078010                                                                  07801019
078100                                                                  07810000
078200     EXEC SQL                                                     07820000
078300          FETCH   CARTON-EXCEPTIONS-CSR                           07830000
078400           INTO  :PV-WORK-COUNT                                   07840000
078500                ,:SUT00112-OPER-UNT-ID                            07850000
078600                ,:SUT00112-ACM-LBL-STA-NBR                        07860000
078700                ,:SUT00112-DOOR-ID                                07870000
078800                ,:SUT00112-INBD-TRIP-ID                           07880000
078900                ,:SUT00112-CART-MTCH-CDE                          07890000
079000                                                                  07900000
079100     END-EXEC.                                                    07910000
079200                                                                  07920000
079300     EVALUATE TRUE                                                07930000
079400         WHEN SQLCODE = ZERO                                      07940000
079500              EVALUATE SUT00112-CART-MTCH-CDE                     07950000
079600                  WHEN PC-POL                                     07960000
079700                       MOVE PV-WORK-COUNT TO PV-PO-EXCEPTIONS     07970000
079800                  WHEN PC-VENDOR                                  07980000
079900                       MOVE PV-WORK-COUNT TO PV-VENDOR-EXCEPTIONS 07990000
080000                  WHEN PC-FIRST                                   08000000
080100                       MOVE PV-WORK-COUNT TO PV-FIRST-EXCEPTIONS  08010000
080200              END-EVALUATE                                        08020000
080300         WHEN SQLCODE = +100                                      08030000
080400              SET PS-CARTON-EXCEPTIONS-END TO TRUE                08040000
080500         WHEN SQLWARN0 NOT = SPACE                                08050000
080600         WHEN SQLCODE NOT = ZERO                                  08060000
080700              MOVE '1200-COUNT-CARTON-EXCEPTIONS' TO              08070000
080800                                        DP013-PARAGRAPH           08080000
080900              MOVE 'SUT-TRIP-MTCH-LVL '                           08090000
081000                               TO DP013-DB2-TABLE-NAME (1)        08100000
081100              MOVE 'COULD NOT FETCH ROW'                          08110000
081200                               TO DP013-MESSAGE-TEXT (1)          08120000
081300              MOVE SQLCA       TO DP013-SQLCA                     08130000
081400              SET DP013-DB2-ABEND TO TRUE                         08140000
081500              PERFORM DP013-0000-PROCESS-ABEND                    08150000
081600     END-EVALUATE.                                                08160000
081700                                                                  08170000
081800 1240-CLOSE-CARTON-EXCEPTIONS.                                    08180000
081810                                                                  08181019
081900                                                                  08190000
082000     EXEC SQL                                                     08200000
082100          CLOSE   CARTON-EXCEPTIONS-CSR                           08210000
082200     END-EXEC.                                                    08220000
082300                                                                  08230000
082400     EVALUATE TRUE                                                08240000
082500         WHEN SQLCODE = ZERO                                      08250000
082600              CONTINUE                                            08260000
082700         WHEN SQLWARN0 NOT = SPACE                                08270000
082800         WHEN SQLCODE NOT = ZERO                                  08280000
082900              MOVE '1200-OPEN-CARTON-EXCEPTIONS' TO               08290000
083000                                        DP013-PARAGRAPH           08300000
083100              MOVE 'SUT-TRIP-MTCH-LVL '                           08310000
083200                               TO DP013-DB2-TABLE-NAME (1)        08320000
083300              MOVE 'COULD NOT FETCH ROW'                          08330000
083400                               TO DP013-MESSAGE-TEXT (1)          08340000
083500              MOVE SQLCA       TO DP013-SQLCA                     08350000
083600              SET DP013-DB2-ABEND TO TRUE                         08360000
083700              PERFORM DP013-0000-PROCESS-ABEND                    08370000
083800     END-EVALUATE.                                                08380000
083900                                                                  08390000
084000                                                                  08400000
084100*----------------------------------------------------------------*08410000
084200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *08420000
084300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *08430000
084400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *08440000
084500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *08450000
084600* FUNCTION KEYS CAN GET THIS FAR.                                *08460000
084700*----------------------------------------------------------------*08470000
084800 2000-PROCESS-PANEL.                                              08480000
084810                                                                  08481019
084900                                                                  08490000
085000     EVALUATE TRUE                                                08500000
085100                                                                  08510000
085200         WHEN DP020-SRC-AID = DP016-CLEAR                         08520000
085300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08530000
085400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08540000
085500                                                                  08550000
085600*F5 REFRESH -                                                     08560000
085700         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     08570000
085800              MOVE ASC-TRIP-ID-CURRENT TO ASC-TRIP-ID             08580000
085900              MOVE ASC-TK-TP-NBR-CURRENT TO ASC-TK-TP-NBR         08590000
086000              MOVE ASC-TRAILER-CURRENT   TO ASC-TRAILER           08600000
086100              SET  ASC-PROTECT-SCREEN-NO                          08610000
086200                   ASC-F2-CONFIRM-NO                              08620020
086210                   ASC-CONFIRM-TYPE-NONE TO  TRUE                 08621020
086300              IF ASC-TRAILER = PC-AVAILABLE                       08630000
086400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08640000
086500                 PERFORM 3200-RESET-ATTRIBUTES                    08650000
086600              ELSE                                                08660000
086700                 PERFORM 4000-BUILD-INITIAL-PANEL                 08670000
086800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08680000
086900                 PERFORM 3200-RESET-ATTRIBUTES                    08690000
087000              END-IF                                              08700000
087100*F20-NEXT SEL                                                     08710000
087200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             08720000
087300             IF ASC-INT-APPL-FORMAT-IND = ' '                     08730000
087400                MOVE DP020-INT-APPL-FORMAT-IND                    08740000
087500                                      TO ASC-INT-APPL-FORMAT-IND  08750000
087600             END-IF                                               08760000
087700             IF ASC-INT-APPL-FORMAT-IND = '2'                     08770000
087800               IF  ASC-USE-SELECTION-QUEUE                        08780000
087900                   PERFORM 1130-GET-NEXT-RECORD                   08790000
088000**??  17794 IR     IF ASC-OPER-UNT-ID   = DP020-LOCATION-NBR      08800000
088100**??                  PERFORM 3000-EDIT-DATA-IN-COMMAREA          08810000
088200**??               END-IF                                         08820000
088300                   SET ASC-PROTECT-SCREEN-NO   TO TRUE            08830000
088400                   IF PS-LIST-END                                 08840000
088500                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       08850000
088600                       SET PS-NO-LIST-END TO TRUE                 08860000
088700                   ELSE                                           08870000
088800****  17794 IR         FOR THOSE DOOR THAT ARE AVAILABLE          08880000
088900****                   JUST DISPLAY THE DATA                      08890000
089000                       IF ASC-TRAILER = PC-AVAILABLE              08900000
089100                          CONTINUE                                08910000
089200                       ELSE                                       08920000
089300                          PERFORM 4000-BUILD-INITIAL-PANEL        08930000
089400                       END-IF                                     08940000
089500                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       08950000
089600                       PERFORM 3200-RESET-ATTRIBUTES              08960000
089700                   END-IF                                         08970000
089800               ELSE                                               08980000
089900*                --- BOTTOM OF LIST ---                           08990000
090000                   MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER       09000000
090100                   SET DP020-MSG-INFORMATIONAL TO TRUE            09010000
090200               END-IF                                             09020000
090300           ELSE                                                   09030000
090400               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           09040000
090500               SET DP020-MSG-FATAL TO TRUE                        09050000
090600           END-IF                                                 09060000
090700                                                                  09070000
090800*F19-PREV SEL                                                     09080000
090900         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09090000
091000             IF ASC-INT-APPL-FORMAT-IND   = ' '                   09100000
091100                MOVE DP020-INT-APPL-FORMAT-IND                    09110000
091200                                      TO ASC-INT-APPL-FORMAT-IND  09120000
091300             END-IF                                               09130000
091400             IF ASC-INT-APPL-FORMAT-IND = '2'                     09140000
091500                IF  ASC-USE-SELECTION-QUEUE                       09150000
091600                   PERFORM 1140-GET-PREV-RECORD                   09160000
091700**??  17794 IR     IF ASC-OPER-UNT-ID   = DP020-LOCATION-NBR      09170000
091800**??                  PERFORM 3000-EDIT-DATA-IN-COMMAREA          09180000
091900**??               END-IF                                         09190000
092000                   SET ASC-PROTECT-SCREEN-NO   TO TRUE            09200000
092100                   IF PS-LIST-END                                 09210000
092200                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       09220000
092300                       SET PS-NO-LIST-END TO TRUE                 09230000
092400                   ELSE                                           09240000
092500                       PERFORM 4000-BUILD-INITIAL-PANEL           09250000
092600                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       09260000
092700                       PERFORM 3200-RESET-ATTRIBUTES              09270000
092800                   END-IF                                         09280000
092900               ELSE                                               09290000
093000                   MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER       09300000
093100                   SET DP020-MSG-INFORMATIONAL TO TRUE            09310000
093200               END-IF                                             09320000
093300           ELSE                                                   09330000
093400               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           09340000
093500               SET DP020-MSG-FATAL TO TRUE                        09350000
093600           END-IF                                                 09360000
093700                                                                  09370000
093800         WHEN OTHER                                               09380000
093900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09390000
094000             PERFORM 3200-RESET-ATTRIBUTES                        09400000
094100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09410000
094200             IF PS-NO-ERROR                                       09420000
094300                 PERFORM 4500-MOVE-COMMAREA-TO-TEMP               09430000
094400                 PERFORM 2100-CHECK-FUNCTION-KEY                  09440000
094500                 IF PS-NO-ERROR                                   09450000
094600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09460000
094700                     SET DP030-CONTINUE-GO TO TRUE                09470000
094800                 ELSE                                             09480000
094900                     SET DP030-OVERRIDE-GO TO TRUE                09490000
095000                 END-IF                                           09500000
095100             ELSE                                                 09510000
095200                 SET DP030-OVERRIDE-GO TO TRUE                    09520000
095300             END-IF                                               09530000
095400     END-EVALUATE.                                                09540000
095500                                                                  09550000
095600*----------------------------------------------------------------*09560000
095700* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *09570000
095800* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *09580000
095900* FROM THE CICS ARCHITECTURE API.                                *09590000
096000*----------------------------------------------------------------*09600000
096100 2100-CHECK-FUNCTION-KEY.                                         09610000
096110                                                                  09611019
096200     EVALUATE TRUE                                                09620000
096300         WHEN DP020-SRC-AID = DP016-ENTER                         09630000
096400              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                09640000
096500                                                                  09650000
096600*-F 2 = CONFIRM UPDATE                                            09660000
096700         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID)                   09670000
096800              AND ASC-F2-CONFIRM-YES                              09680000
096900              IF ASC-ACTION-SW = 'UPD'                            09690000
097000                  PERFORM 9100-READ-SEL-QUEUE                     09700000
097100                  SET SU088-UPD (ASC-SEL-SUB) TO TRUE             09710000
097200                  MOVE ASC-DOOR-ID  TO SU088-DOOR-ID (ASC-SEL-SUB)09720000
097300*CT 1/23/09 BEGIN IR 18258                                        09730000
097400                  IF ASC-LOGOFFTK-YES     AND                     09740000
097500                     ASC-F2-CONFIRM-YES                           09750000
097600                     MOVE SPACES           TO ASC-TK-TP-NBR       09760000
097610                                              ASC-FIRST-NAME      09761025
097620                                              ASC-LAST-NAME       09762025
097700                  END-IF                                          09770000
097800                  IF ASC-UNASSIGN-YES     AND                     09780000
097900                     ASC-F2-CONFIRM-YES                           09790000
098000                     MOVE SPACES           TO ASC-TRIP-ID         09800000
098100                     MOVE SPACES           TO ASC-TK-TP-NBR       09810000
098110                                              ASC-FIRST-NAME      09811025
098120                                              ASC-LAST-NAME       09812025
098200                  END-IF                                          09820000
098300                  MOVE ASC-TRIP-ID  TO SU088-TRIP-ID (ASC-SEL-SUB)09830000
098400                                       SU087-TRIP-ID              09840000
098500                  MOVE ASC-TK-TP-NBR TO SU088-TK-NBR (ASC-SEL-SUB)09850000
098600*CT 1/23/09 END                                                   09860000
098700                  IF PS-NO-ERROR                                  09870000
098800                      PERFORM 2400-PROCESS-ALL-UPDATES            09880000
098900                      SET ASC-PROTECT-SCREEN-YES TO TRUE          09890000
099000                  END-IF                                          09900000
099100                  MOVE ASC-ASSIGN-TMST TO                         09910000
099200                                   SU088-ASSIGN-TMST (ASC-SEL-SUB)09920000
099300                  PERFORM 9200-REWRITE-SEL-QUEUE                  09930000
099400              END-IF                                              09940000
099500                                                                  09950000
099600                                                                  09960000
099700                                                                  09970000
099800*-F15 = UPDATE                                                    09980000
099900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09990000
100000            IF ASC-OPER-UNT-ID = DP020-LOCATION-NBR               10000000
100100              SET ASC-F2-CONFIRM-NO                               10010020
100110                  ASC-CONFIRM-TYPE-NONE TO TRUE                   10011020
100200                                                                  10020000
100300**            THIS MEANS IT'S UNASSIGNED AND CAN'T BE CHANGED     10030000
100400              IF  ASC-UNASSIGN-TMST > SPACES                      10040000
100500                  CONTINUE                                        10050000
100600              ELSE                                                10060000
100700              IF PS-NO-ERROR                                      10070000
100800                 SET ASC-F2-CONFIRM-YES      TO TRUE              10080000
100900                 SET PS-ERROR                TO TRUE              10090000
101000                 SET DP020-MSG-FATAL         TO TRUE              10100000
101100                 MOVE PC-TSYMSG-00004        TO DP020-MSG-NUMBER  10110000
101200                 MOVE DP015-UNP-ALP-NOR-OFF  TO ATRIPIDA          10120000
101300                 MOVE DP015-GREEN            TO ATRIPIDC          10130000
101400* GB 1/20        MOVE DP015-BLUE             TO ATRIPIDC          10140000
101500                 MOVE -1                     TO ATRIPIDL          10150000
101600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10160000
101700              END-IF                                              10170000
101800              END-IF                                              10180000
101900            ELSE                                                  10190000
102000               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               10200000
102100               SET DP030-OVERRIDE-GO TO TRUE                      10210000
102200               MOVE PC-TSYMSG-02571  TO DP020-MSG-NUMBER          10220000
102300               SET PS-ERROR                                       10230000
102400                   DP020-MSG-FATAL   TO TRUE                      10240000
102500            END-IF                                                10250000
102600                                                                  10260000
102700*-F17 = GO TO TK HISTORY                                          10270000
102800         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              10280000
102900              PERFORM 2110-PREPARE-INTER-APPL-COMM                10290000
103000                                                                  10300000
103100                                                                  10310000
103200*-F18 = LOGOFFTK - LOGOFF CURRENT USER FROM TRIP                  10320000
103300         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              10330000
103400            IF ASC-OPER-UNT-ID = DP020-LOCATION-NBR               10340000
103500              SET ASC-F2-CONFIRM-NO                               10350020
103510                  ASC-CONFIRM-TYPE-NONE  TO TRUE                  10351020
103600              SET ASC-LOGOFFTK-YES  TO TRUE                       10360000
103700**GB 1/26/09 BEG                                                  10370000
103800              IF  ASC-ASSIGN-TMST   = SPACES                      10380000
103900                 SET PS-ERROR                TO TRUE              10390000
104000                 SET ASC-LOGOFFTK-NO         TO TRUE              10400000
104100                 SET DP020-MSG-FATAL         TO TRUE              10410000
104200                 MOVE PC-TSYMSG-03650        TO DP020-MSG-NUMBER  10420000
104300                 MOVE DP015-PRO-NOR-OFF      TO ATRIPIDA          10430000
104400                 MOVE DP015-GREEN            TO ATRIPIDC          10440000
104500                 MOVE -1                     TO ATRIPIDL          10450000
104600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10460000
104700              END-IF                                              10470000
104800**GB 1/26/09 END                                                  10480000
104900                                                                  10490000
105000**            THIS MEANS IT'S UNASSIGNED AND CAN'T BE CHANGED     10500000
105100              IF  ASC-UNASSIGN-TMST > SPACES                      10510000
105200                  CONTINUE                                        10520000
105300              ELSE                                                10530000
105400              IF  PS-NO-ERROR                                     10540000
105500                  SET ASC-F2-CONFIRM-YES      TO TRUE             10550000
105600                  SET PS-ERROR                TO TRUE             10560000
105700                  SET DP020-MSG-FATAL         TO TRUE             10570000
105800                  MOVE PC-TSYMSG-00004        TO DP020-MSG-NUMBER 10580000
105900                  MOVE DP015-PRO-NOR-OFF      TO ATRIPIDA         10590000
106000***GB 1/20/09     MOVE DP015-BLUE             TO ATRIPIDC         10600000
106100                  MOVE DP015-GREEN            TO ATRIPIDC         10610000
106200                  MOVE -1                     TO ATRIPIDL         10620000
106300                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             10630000
106400              END-IF                                              10640000
106500              END-IF                                              10650000
106600            ELSE                                                  10660000
106700               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               10670000
106800               SET DP030-OVERRIDE-GO TO TRUE                      10680000
106900               MOVE PC-TSYMSG-02571  TO DP020-MSG-NUMBER          10690000
107000               SET PS-ERROR                                       10700000
107100                   DP020-MSG-FATAL   TO TRUE                      10710000
107200            END-IF                                                10720000
107300                                                                  10730000
107400*-F22 = UNASSIGN                                                  10740000
107500         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              10750000
107600            IF ASC-OPER-UNT-ID = DP020-LOCATION-NBR               10760000
107700             SET ASC-F2-CONFIRM-NO                                10770020
107710                 ASC-CONFIRM-TYPE-NONE TO TRUE                    10771020
107800             SET ASC-UNASSIGN-YES  TO TRUE                        10780000
107900                                                                  10790000
108000**            THIS MEANS IT'S UNASSIGNED AND CAN'T BE CHANGED     10800000
108100              IF  ASC-UNASSIGN-TMST > SPACES                      10810000
108200                  CONTINUE                                        10820000
108300              ELSE                                                10830000
108400**GB 1/21/09 BEG                                                  10840000
108500                IF  ASC-ASSIGN-TMST   = SPACES                    10850000
108600                   SET PS-ERROR                TO TRUE            10860000
108700                   SET ASC-UNASSIGN-NO         TO TRUE            10870000
108800                   SET DP020-MSG-FATAL         TO TRUE            10880000
108900                   MOVE PC-TSYMSG-03650        TO DP020-MSG-NUMBER10890000
109000                   MOVE DP015-PRO-NOR-OFF      TO ATRIPIDA        10900000
109100                   MOVE DP015-GREEN            TO ATRIPIDC        10910000
109200                   MOVE -1                     TO ATRIPIDL        10920000
109300                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            10930000
109400**GB 1/21/09 END                                                  10940000
109500                ELSE                                              10950000
109600                   PERFORM 2300-SELECT-TRIP-ASGMT                 10960000
109700                END-IF                                            10970000
109800                IF PS-NO-ERROR                                    10980000
109900                   SET ASC-F2-CONFIRM-YES      TO TRUE            10990000
110000                   SET PS-ERROR                TO TRUE            11000000
110100                   SET DP020-MSG-FATAL         TO TRUE            11010000
110200                   MOVE PC-TSYMSG-00004        TO DP020-MSG-NUMBER11020000
110300                   MOVE DP015-PRO-NOR-OFF      TO ATRIPIDA        11030000
110400                   MOVE DP015-GREEN            TO ATRIPIDC        11040000
110500                   MOVE -1                     TO ATRIPIDL        11050000
110600                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            11060000
110700               END-IF                                             11070000
110800             END-IF                                               11080000
110900            ELSE                                                  11090000
111000               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               11100000
111100               SET DP030-OVERRIDE-GO TO TRUE                      11110000
111200               MOVE PC-TSYMSG-02571  TO DP020-MSG-NUMBER          11120000
111300               SET PS-ERROR                                       11130000
111400                   DP020-MSG-FATAL   TO TRUE                      11140000
111500            END-IF                                                11150000
111600                                                                  11160000
111700         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID) AND               11170000
111800              ASC-F2-CONFIRM-NO                                   11180000
111900               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           11190000
112000               SET DP020-MSG-FATAL TO TRUE                        11200000
112100                                                                  11210000
112200         WHEN OTHER                                               11220000
112300             SET DP013-NO-ROLLBACK                                11230000
112400                 DP013-XCTL-DISPLAY-RESTART                       11240000
112500                 DP013-CICS-ABEND      TO TRUE                    11250000
112600             MOVE '2000-PROCESS-PANEL' TO DP013-PARAGRAPH         11260000
112700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11270000
112800                                   TO DP013-MESSAGE-TEXT (1)      11280000
112900             PERFORM DP013-0000-PROCESS-ABEND                     11290000
113000                                                                  11300000
113100     END-EVALUATE.                                                11310000
113200                                                                  11320000
113300******************************************************************11330000
113400** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **11340000
113500** INTER-APPLICATION COMMAREA.                                  **11350000
113600******************************************************************11360000
113700 2110-PREPARE-INTER-APPL-COMM.                                    11370000
113710                                                                  11371019
113800                                                                  11380000
113900     INITIALIZE SU087-INTER-APPL-COMMAREA.                        11390000
114000     MOVE ASC-OPER-UNT-ID    TO SU087-OPER-UNT-ID.                11400000
114100     MOVE ASC-PNA-STA-NBR    TO SU087-PNA-STA-NBR.                11410000
114200     MOVE ASC-DOOR-ID        TO SU087-DOOR-ID.                    11420000
114300     MOVE ASC-TRIP-ID        TO SU087-TRIP-ID.                    11430000
114400     MOVE ASC-SCAC           TO SU087-SCAC.                       11440000
114500     MOVE ASC-TRAILER        TO SU087-TRAILER.                    11450000
114600     MOVE ASC-ASGD-STRT-TMST TO SU087-ASGD-STRT-TMST.             11460000
114700     MOVE ASC-REFRESH-FUNCTION-SW TO SU087-FUNCTION.              11470000
114800                                                                  11480000
114900                                                                  11490000
115000*----------------------------------------------------------------*11500000
115100* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *11510000
115200* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *11520000
115300* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *11530000
115400* THIS PARAGRAPH DOES NOT USE TEMPORARY VARIABLES.               *11540000
115500*----------------------------------------------------------------*11550000
115600 2200-MOVE-SCREEN-TO-COMMAREA.                                    11560000
115610                                                                  11561019
115700*DOOR ID                                                          11570000
115800         IF  ATRIPIDL > ZERO                                      11580000
115900             MOVE ATRIPIDI             TO ASC-TRIP-ID             11590000
116000             SET ASC-UPDATE-TRIP-YES TO TRUE                      11600000
116100         ELSE                                                     11610000
116200             IF  ATRIPIDF = DP015-ERASE-EOF                       11620000
116300                 MOVE SPACES           TO ASC-TRIP-ID             11630000
116400                 SET ASC-UPDATE-TRIP-NO  TO TRUE                  11640000
116500             END-IF                                               11650000
116600         END-IF                                                   11660000
116700                                                                  11670000
116800*TK / TP NUMBER                                                   11680000
116900         IF  ATKPNBRL > ZERO                                      11690000
117000             MOVE ATKPNBRI             TO ASC-TK-TP-NBR           11700000
117100             SET ASC-UPDATE-TK-NBR-YES  TO TRUE                   11710000
117200         ELSE                                                     11720000
117300             IF  ATKPNBRF = DP015-ERASE-EOF                       11730000
117400                 MOVE SPACES           TO ASC-TK-TP-NBR           11740000
117410                                          ASC-FIRST-NAME          11741025
117420                                          ASC-LAST-NAME           11742025
117500                 SET ASC-UPDATE-TK-NBR-NO   TO TRUE               11750000
117600             END-IF                                               11760000
117700         END-IF.                                                  11770000
117800                                                                  11780000
117900 2300-SELECT-TRIP-ASGMT.                                          11790007
117910                                                                  11791019
118000                                                                  11800000
118100     MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID.                     11810000
118200     MOVE ASC-PNA-STA-NBR  TO DK-ACM-LBL-STA-NBR.                 11820000
118300     MOVE ASC-DOOR-ID      TO DK-DOOR-ID.                         11830000
118400     MOVE ASC-TRIP-ID-N    TO DK-TRIP-ID.                         11840000
118500     MOVE ASC-ASSIGN-TMST    TO  DK-TIMESTAMP.                    11850000
118600                                                                  11860000
118700     EXEC SQL                                                     11870000
118800         SELECT                                                   11880000
118900                 ASGD_STRT_TMST                                   11890000
119000                ,ASGD_END_TMST                                    11900000
119100                ,CRE_BY_USR_ID                                    11910000
119200                                                                  11920000
119300           INTO                                                   11930000
119400                 :SUT00110-ASGD-STRT-TMST                         11940000
119500                ,:SUT00110-ASGD-END-TMST                          11950000
119600                ,:SUT00110-CRE-BY-USR-ID                          11960000
119700                                                                  11970000
119800           FROM  SUT_PNA_TRIP_ASGMT                               11980000
119900          WHERE  OPER_UNT_ID          = :DK-OPER-UNT-ID           11990000
120000            AND  ACM_LBL_STA_NBR      = :DK-ACM-LBL-STA-NBR       12000000
120100            AND  DOOR_ID              = :DK-DOOR-ID               12010000
120200            AND  INBD_TRIP_ID         = :DK-TRIP-ID               12020000
120300            AND  ASGD_STRT_TMST       = :DK-TIMESTAMP             12030000
120400     END-EXEC.                                                    12040000
120500                                                                  12050000
120600     EVALUATE TRUE                                                12060000
120700         WHEN SQLCODE = +0                                        12070000
120800              CONTINUE                                            12080000
120900         WHEN SQLCODE = +100                                      12090000
121000             SET PS-ERROR                                         12100000
121100                 DP020-MSG-FATAL         TO TRUE                  12110000
121200             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      12120000
121300             MOVE DP015-UNP-ALP-BRT-OFF  TO ATRIPIDA              12130000
121400             MOVE DP015-RED              TO ATRIPIDC              12140000
121500             MOVE DP015-REVERSE          TO ATRIPIDH              12150000
121600             MOVE -1                     TO ATRIPIDL              12160000
121700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12170000
121800         WHEN SQLWARN0 NOT = SPACES                               12180000
121900         WHEN SQLCODE < +0                                        12190000
122000         WHEN SQLCODE > +0                                        12200000
122100             MOVE '2300-SELECT-TRIP-ASGMT      '                  12210000
122200                                       TO DP013-PARAGRAPH         12220000
122300             MOVE 'TRIP NOT FOUNDTE DOOR TYPE CODE'               12230000
122400                                 TO DP013-MESSAGE-TEXT (1)        12240000
122500             MOVE SQLCA      TO DP013-SQLCA                       12250000
122600             MOVE 'SUT_PNA_TRIP_ASGMT'  TO                        12260000
122700                                DP013-DB2-TABLE-NAME (1)          12270000
122800             SET DP013-DB2-ABEND                                  12280000
122900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12290000
123000             PERFORM DP013-0000-PROCESS-ABEND                     12300000
123100     END-EVALUATE.                                                12310000
123200                                                                  12320000
123300 2330-SELECT-WORKER-ASGMT.                                        12330000
123310                                                                  12331019
123400                                                                  12340000
123500     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                   12350000
123600     MOVE ASC-PNA-STA-NBR    TO DK-ACM-LBL-STA-NBR.               12360000
123700     MOVE ASC-DOOR-ID        TO DK-DOOR-ID.                       12370000
123800     MOVE ASC-TRIP-ID-N      TO DK-TRIP-ID.                       12380000
123900     MOVE ASC-ASSIGN-TMST    TO  DK-TIMESTAMP.                    12390000
124000                                                                  12400000
124100     EXEC SQL                                                     12410000
124200         SELECT                                                   12420000
124300                 WRKR_STRT_TMST                                   12430000
124400                ,WRKR_END_TMST                                    12440000
124500                ,WRKR_USR_ID                                      12450000
124600                ,CRE_BY_USR_ID                                    12460000
124700                ,CRE_TMST                                         12470000
124800                ,UPDATE_BY_USERID                                 12480000
124900                ,UPDATE_TIMESTAMP                                 12490000
125000                                                                  12500000
125100           INTO                                                   12510000
125200                 :SUT00111-WRKR-STRT-TMST                         12520000
125300                ,:SUT00111-WRKR-END-TMST                          12530000
125400                ,:SUT00111-WRKR-USR-ID                            12540000
125500                ,:SUT00111-CRE-BY-USR-ID                          12550000
125600                ,:SUT00111-CRE-TMST                               12560000
125700                ,:SUT00111-UPDATE-BY-USERID  :DN-UPD-BY-NULL      12570000
125800                ,:SUT00111-UPDATE-TIMESTAMP  :DN-UPD-TMST-NULL    12580000
125900                                                                  12590000
126000           FROM  SUT_PNA_STA_WRKR                                 12600000
126100          WHERE  OPER_UNT_ID          = :DK-OPER-UNT-ID           12610000
126200            AND  ACM_LBL_STA_NBR      = :DK-ACM-LBL-STA-NBR       12620000
126300            AND  DOOR_ID              = :DK-DOOR-ID               12630000
126400            AND  INBD_TRIP_ID         = :DK-TRIP-ID               12640000
126500            AND  ASGD_STRT_TMST       = :DK-TIMESTAMP             12650000
126600     END-EXEC.                                                    12660000
126700                                                                  12670000
126800     EVALUATE TRUE                                                12680000
126900         WHEN SQLCODE = +0                                        12690000
127000              CONTINUE                                            12700000
127100         WHEN SQLCODE = +100                                      12710000
127200             SET PS-ERROR                                         12720000
127300                 DP020-MSG-FATAL         TO TRUE                  12730000
127400             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      12740000
127500             MOVE DP015-UNP-ALP-BRT-OFF  TO ATRIPIDA              12750000
127600             MOVE DP015-RED              TO ATRIPIDC              12760000
127700             MOVE DP015-REVERSE          TO ATRIPIDH              12770000
127800             MOVE -1                     TO ATRIPIDL              12780000
127900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12790000
128000         WHEN SQLWARN0 NOT = SPACES                               12800000
128100         WHEN SQLCODE < +0                                        12810000
128200         WHEN SQLCODE > +0                                        12820000
128300             MOVE '2330-SELECT-WRKR-ASGMT      '                  12830000
128400                                       TO DP013-PARAGRAPH         12840000
128500             MOVE 'TRIP NOT FOUNDTE DOOR TYPE CODE'               12850000
128600                                 TO DP013-MESSAGE-TEXT (1)        12860000
128700             MOVE SQLCA      TO DP013-SQLCA                       12870000
128800             MOVE 'SUT_PNA_PNA_WRKR '   TO                        12880000
128900                                DP013-DB2-TABLE-NAME (1)          12890000
129000             SET DP013-DB2-ABEND                                  12900000
129100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12910000
129200             PERFORM DP013-0000-PROCESS-ABEND                     12920000
129300     END-EVALUATE.                                                12930000
129400                                                                  12940000
129500 2400-PROCESS-ALL-UPDATES.                                        12950000
129510                                                                  12951019
129600                                                                  12960000
129700      EVALUATE TRUE                                               12970000
129800**--->    F15 - UPDATE TRIP AND TK NUMBER CHANGED                 12980000
129900**              LOGOFF PREVIOUS WORKER IF OPEN                    12990000
130000**              END    PREVIOUS TRIP AT DOOR                      13000000
130100**              CREATE NEW TRIP AT DOOR                           13010000
130200**              CREATE NEW WORKER AT DOOR                         13020000
130300          WHEN ASC-UPDATE-TRIP-YES                                13030000
130400           AND ASC-UPDATE-TK-NBR-YES                              13040000
130500               IF ASC-TRAILER = PC-AVAILABLE                      13050000
130600                  CONTINUE                                        13060000
130700               ELSE                                               13070000
130800                  PERFORM 2460-UPD-STATION-WORKER                 13080000
130900                  PERFORM 2440-UPD-TRIP-ASSIGNMENT                13090000
131000               END-IF                                             13100000
131100               PERFORM 2405-FORMAT-TRIP-ASSIGNMENT                13110000
131200               PERFORM 2410-INSERT-TRIP-ASSIGNMENT                13120000
131300               SET PS-USE-CURRENT-TMST      TO TRUE               13130000
131400               PERFORM 9000-SYNCPOINT                             13140000
131500               PERFORM 2415-FORMAT-WORKER                         13150000
131600               PERFORM 2420-INSERT-WORKER                         13160000
131700               IF PS-NO-ERROR                                     13170000
131800                  MOVE PC-TSYMSG-01305     TO DP020-MSG-NUMBER    13180000
131900                  SET DP030-OVERRIDE-GO    TO TRUE                13190000
132000                  SET DP020-MSG-WARNING    TO TRUE                13200000
132100                  SET ASC-UPDATE-TRIP-NO   TO TRUE                13210000
132200                  MOVE ASC-TRIP-ID      TO ASC-TRIP-ID-CURRENT    13220000
132300                  SET ASC-UPDATE-TK-NBR-NO TO TRUE                13230000
132400                  MOVE ASC-TK-TP-NBR   TO ASC-TK-TP-NBR-CURRENT   13240000
132500                  PERFORM 4100-SELECT-TVHTRIP                     13250000
132600                  MOVE ASC-TRAILER TO ASC-TRAILER-CURRENT         13260000
132700                  SET SU087-UPD-DOOR                              13270000
132800                      ASC-UPD-DOOR    TO TRUE                     13280000
132900                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            13290000
133000               END-IF                                             13300000
133100                                                                  13310000
133200**--->    F15 - UPDATE TRIP ONLY                                  13320000
133300          WHEN ASC-UPDATE-TRIP-YES                                13330000
133400               PERFORM 2460-UPD-STATION-WORKER                    13340000
133500               PERFORM 2440-UPD-TRIP-ASSIGNMENT                   13350000
133600               PERFORM 2405-FORMAT-TRIP-ASSIGNMENT                13360000
133700               PERFORM 2410-INSERT-TRIP-ASSIGNMENT                13370000
133800               SET PS-USE-CURRENT-TMST      TO TRUE               13380000
133900               PERFORM 9000-SYNCPOINT                             13390000
134000               PERFORM 2415-FORMAT-WORKER                         13400000
134100               PERFORM 2420-INSERT-WORKER                         13410000
134200               IF PS-NO-ERROR                                     13420000
134300                  MOVE PC-TSYMSG-01305  TO DP020-MSG-NUMBER       13430000
134400                  SET DP030-OVERRIDE-GO TO TRUE                   13440000
134500                  SET DP020-MSG-WARNING TO TRUE                   13450000
134600                  SET ASC-UPDATE-TRIP-NO   TO TRUE                13460000
134700                  MOVE ASC-TRIP-ID      TO ASC-TRIP-ID-CURRENT    13470000
134800                  PERFORM 4100-SELECT-TVHTRIP                     13480000
134900                  MOVE ASC-TRAILER TO ASC-TRAILER-CURRENT         13490000
135000                  SET SU087-UPD-DOOR                              13500000
135100                      ASC-UPD-DOOR    TO TRUE                     13510000
135200                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            13520000
135300               END-IF                                             13530000
135400                                                                  13540000
135500**--->    F15 - UPDATE TK NUMBER ONLY                             13550000
135600          WHEN ASC-UPDATE-TK-NBR-YES                              13560000
135700               PERFORM 2300-SELECT-TRIP-ASGMT                     13570000
135800               IF SUT00110-ASGD-END-TMST  NOT = PC-DEFAULT-TMST   13580000
135900                  MOVE PC-TSYMSG-03667  TO DP020-MSG-NUMBER       13590000
136000                  SET DP030-OVERRIDE-GO TO TRUE                   13600000
136100                  SET DP020-MSG-WARNING TO TRUE                   13610000
136200                  SET ASC-UPDATE-TK-NBR-NO TO TRUE                13620000
136300                  MOVE ASC-TK-TP-NBR   TO ASC-TK-TP-NBR-CURRENT   13630000
136400                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            13640000
136500               ELSE                                               13650000
136600                  PERFORM 2460-UPD-STATION-WORKER                 13660000
136700                  SET PS-USE-ASC-TMST          TO TRUE            13670000
136800                  PERFORM 2415-FORMAT-WORKER                      13680000
136900                  PERFORM 2420-INSERT-WORKER                      13690000
137000                  IF PS-NO-ERROR                                  13700000
137100                     MOVE PC-TSYMSG-01305  TO DP020-MSG-NUMBER    13710000
137200                     SET DP030-OVERRIDE-GO TO TRUE                13720000
137300                     SET DP020-MSG-WARNING TO TRUE                13730000
137400                     SET ASC-UPDATE-TK-NBR-NO TO TRUE             13740000
137500                     MOVE ASC-TK-TP-NBR   TO ASC-TK-TP-NBR-CURRENT13750000
137600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13760000
137700                  END-IF                                          13770000
137800               END-IF                                             13780000
137900                                                                  13790000
138000**--->    F18 - UNASSIGN                                          13800000
138100          WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)             13810000
138200            OR ASC-UNASSIGN-YES                                   13820000
138300               PERFORM 2460-UPD-STATION-WORKER                    13830000
138400               PERFORM 2440-UPD-TRIP-ASSIGNMENT                   13840000
138500*GB 1/27/09                                                       13850000
138600               INITIALIZE      ASC-TRIP-ID-CURRENT                13860000
138700                               ASC-TK-TP-NBR-CURRENT              13870000
138800               MOVE PC-AVAILABLE TO ASC-TRAILER                   13880000
138900                                    ASC-TRAILER-CURRENT           13890000
139000               MOVE SPACES       TO ASC-SCAC                      13900000
139100*GB 1/27/09                                                       13910000
139200                                                                  13920000
139300               IF PS-NO-ERROR                                     13930000
139400                  MOVE PC-TSYMSG-03628  TO DP020-MSG-NUMBER       13940000
139500                  SET DP030-OVERRIDE-GO TO TRUE                   13950000
139600                  SET DP020-MSG-WARNING TO TRUE                   13960000
139700                  SET ASC-UNASSIGN-NO   TO TRUE                   13970000
139800                  SET SU087-UPD-DOOR                              13980000
139900                      ASC-UPD-DOOR    TO TRUE                     13990000
140000                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            14000000
140100               END-IF                                             14010000
140200                                                                  14020000
140300**--->    F18 - LOGOFFTK                                          14030000
140400          WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)             14040000
140500            OR ASC-LOGOFFTK-YES                                   14050000
140600               PERFORM 2460-UPD-STATION-WORKER                    14060000
140700               IF PS-NO-ERROR                                     14070000
140800                  MOVE PC-TSYMSG-03629  TO DP020-MSG-NUMBER       14080000
140900                  SET DP030-OVERRIDE-GO TO TRUE                   14090000
141000                  SET DP020-MSG-WARNING TO TRUE                   14100000
141100                  SET ASC-LOGOFFTK-NO   TO TRUE                   14110000
141200**??  17793 IR  TK NBR ON SCREEN WASN'T BEING CLEARED OUT         14120000
141300**??            WHEN THE USER IS LOGGED OFF                       14130000
141400                  MOVE SPACES          TO ASC-TK-TP-NBR-CURRENT   14140000
141500                                          ASC-TK-TP-NBR           14150000
141510                                          ASC-FIRST-NAME          14151025
141520                                          ASC-LAST-NAME           14152025
141600                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            14160000
141700               END-IF                                             14170000
141800                                                                  14180000
141900      END-EVALUATE.                                               14190000
142000                                                                  14200000
142100 2405-FORMAT-TRIP-ASSIGNMENT.                                     14210000
142110                                                                  14211019
142200                                                                  14220000
142300     MOVE ASC-OPER-UNT-ID      TO  SUT00110-OPER-UNT-ID.          14230000
142400     MOVE ASC-PNA-STA-NBR      TO  SUT00110-ACM-LBL-STA-NBR.      14240000
142500     MOVE ASC-DOOR-ID          TO  SUT00110-DOOR-ID.              14250000
142600     MOVE ASC-TRIP-ID-N        TO  SUT00110-INBD-TRIP-ID.         14260000
142700     MOVE DP020-USERID         TO  SUT00110-CRE-BY-USR-ID.        14270000
142800     MOVE DN-NULL              TO  DN-UPD-BY-NULL.                14280000
142900     MOVE DN-NULL              TO  DN-UPD-TMST-NULL.              14290000
143000     PERFORM 7100-GET-CURRENT-TIMESTAMP.                          14300000
143100     MOVE ASC-CURRENT-TMST      TO SUT00110-ASGD-STRT-TMST.       14310000
143200     MOVE PC-DEFAULT-TMST      TO  SUT00110-ASGD-END-TMST.        14320000
143300                                                                  14330000
143400 7100-GET-CURRENT-TIMESTAMP.                                      14340000
143500                                                                  14350000
143600     EXEC SQL                                                     14360000
143700         SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP             14370000
143800     END-EXEC.                                                    14380000
143900                                                                  14390000
144000     MOVE PV-DB2-CURRENT-TMST TO ASC-CURRENT-TMST.                14400000
144100                                                                  14410000
144200                                                                  14420000
144300 2410-INSERT-TRIP-ASSIGNMENT.                                     14430000
144310                                                                  14431019
144400                                                                  14440000
144500     EXEC SQL                                                     14450000
144600         INSERT                                                   14460000
144700           INTO  SUT_PNA_TRIP_ASGMT                               14470000
144800               (                                                  14480000
144900                 OPER_UNT_ID                                      14490000
145000                ,ACM_LBL_STA_NBR                                  14500000
145100                ,DOOR_ID                                          14510000
145200                ,INBD_TRIP_ID                                     14520000
145300                ,ASGD_STRT_TMST                                   14530000
145400                ,ASGD_END_TMST                                    14540000
145500                ,CRE_BY_USR_ID                                    14550000
145600                ,UPDATE_BY_USERID                                 14560000
145700                ,UPDATE_TIMESTAMP                                 14570000
145800                )                                                 14580000
145900                                                                  14590000
146000        VALUES (                                                  14600000
146100                 :SUT00110-OPER-UNT-ID                            14610000
146200                ,:SUT00110-ACM-LBL-STA-NBR                        14620000
146300                ,:SUT00110-DOOR-ID                                14630000
146400                ,:SUT00110-INBD-TRIP-ID                           14640000
146500                ,:SUT00110-ASGD-STRT-TMST                         14650000
146600                ,:PC-DEFAULT-TMST                                 14660000
146700                ,:SUT00110-CRE-BY-USR-ID                          14670000
146800                ,:SUT00110-UPDATE-BY-USERID  :DN-UPD-BY-NULL      14680000
146900                ,:SUT00110-UPDATE-TIMESTAMP  :DN-UPD-TMST-NULL    14690000
147000                )                                                 14700000
147100                                                                  14710000
147200     END-EXEC.                                                    14720000
147300                                                                  14730000
147400     EVALUATE TRUE                                                14740000
147500         WHEN SQLCODE = +0                                        14750000
147600              MOVE SUT00110-ASGD-STRT-TMST TO ASC-ASSIGN-TMST     14760000
147700                                      ASC-ASGD-STRT-TMST          14770000
147800                                                                  14780000
147900         WHEN SQLWARN0 NOT = SPACES                               14790000
148000         WHEN SQLCODE < +0                                        14800000
148100         WHEN SQLCODE > +0                                        14810000
148200             MOVE '2410-INSERT-TRIP-ASSIGMENT'                    14820000
148300                                       TO DP013-PARAGRAPH         14830000
148400             MOVE 'INSERT FAILED                  '               14840000
148500                                 TO DP013-MESSAGE-TEXT (1)        14850000
148600             MOVE SQLCA      TO DP013-SQLCA                       14860000
148700             MOVE 'SUT_PNA_TRIP_ASGMT'  TO                        14870000
148800                                DP013-DB2-TABLE-NAME (1)          14880000
148900             SET DP013-DB2-ABEND                                  14890000
149000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               14900000
149100             PERFORM DP013-0000-PROCESS-ABEND                     14910000
149200     END-EVALUATE.                                                14920000
149300                                                                  14930000
149400 2415-FORMAT-WORKER.                                              14940000
149410                                                                  14941019
149500                                                                  14950000
149600     MOVE ASC-OPER-UNT-ID      TO  SUT00111-OPER-UNT-ID.          14960000
149700     MOVE ASC-PNA-STA-NBR      TO  SUT00111-ACM-LBL-STA-NBR.      14970000
149800     MOVE ASC-DOOR-ID          TO  SUT00111-DOOR-ID.              14980000
149900     MOVE ASC-TRIP-ID-N        TO  SUT00111-INBD-TRIP-ID.         14990000
150000                                                                  15000000
150100     MOVE ASC-ASGD-STRT-TMST TO  SUT00111-ASGD-STRT-TMST.         15010000
150200     MOVE ASC-TRIP-ID-N        TO  SUT00111-INBD-TRIP-ID.         15020000
150300     MOVE DP020-USERID         TO  SUT00111-CRE-BY-USR-ID.        15030000
150400     MOVE PC-DEFAULT-TMST      TO  SUT00111-WRKR-END-TMST.        15040000
150500     MOVE ASC-TK-TP-NBR        TO  SUT00111-WRKR-USR-ID.          15050000
150600     MOVE DN-NULL              TO  DN-UPD-BY-NULL.                15060000
150700     MOVE DN-NULL              TO  DN-UPD-TMST-NULL.              15070000
150800                                                                  15080000
150900 2420-INSERT-WORKER.                                              15090000
151000                                                                  15100000
151100     IF PS-USE-CURRENT-TMST                                       15110000
151200        MOVE ASC-CURRENT-TMST TO SUT00111-ASGD-STRT-TMST          15120000
151300        EXEC SQL                                                  15130000
151400            INSERT                                                15140000
151500              INTO  SUT_PNA_STA_WRKR                              15150000
151600                  (                                               15160000
151700                    OPER_UNT_ID                                   15170000
151800                   ,ACM_LBL_STA_NBR                               15180000
151900                   ,DOOR_ID                                       15190000
152000                   ,INBD_TRIP_ID                                  15200000
152100                   ,ASGD_STRT_TMST                                15210000
152200                   ,WRKR_STRT_TMST                                15220000
152300                   ,WRKR_END_TMST                                 15230000
152400                   ,WRKR_USR_ID                                   15240000
152500                   ,CRE_BY_USR_ID                                 15250000
152600                   ,CRE_TMST                                      15260000
152700                   ,UPDATE_BY_USERID                              15270000
152800                   ,UPDATE_TIMESTAMP                              15280000
152900                   )                                              15290000
153000                                                                  15300000
153100           VALUES (                                               15310000
153200                    :SUT00111-OPER-UNT-ID                         15320000
153300                   ,:SUT00111-ACM-LBL-STA-NBR                     15330000
153400                   ,:SUT00111-DOOR-ID                             15340000
153500                   ,:SUT00111-INBD-TRIP-ID                        15350000
153600                   ,:SUT00111-ASGD-STRT-TMST                      15360000
153700                   , CURRENT TIMESTAMP                            15370000
153800                   ,:SUT00111-WRKR-END-TMST                       15380000
153900                   ,:SUT00111-WRKR-USR-ID                         15390000
154000                   ,:SUT00111-CRE-BY-USR-ID                       15400000
154100                   , CURRENT TIMESTAMP                            15410000
154200                   ,:SUT00111-UPDATE-BY-USERID  :DN-UPD-BY-NULL   15420000
154300                   ,:SUT00111-UPDATE-TIMESTAMP  :DN-UPD-TMST-NULL 15430000
154400                   )                                              15440000
154500                                                                  15450000
154600        END-EXEC                                                  15460000
154700     ELSE                                                         15470000
154800        MOVE ASC-ASGD-STRT-TMST TO  SUT00111-ASGD-STRT-TMST       15480000
154900                                                                  15490000
155000        EXEC SQL                                                  15500000
155100            INSERT                                                15510000
155200              INTO  SUT_PNA_STA_WRKR                              15520000
155300                  (                                               15530000
155400                    OPER_UNT_ID                                   15540000
155500                   ,ACM_LBL_STA_NBR                               15550000
155600                   ,DOOR_ID                                       15560000
155700                   ,INBD_TRIP_ID                                  15570000
155800                   ,ASGD_STRT_TMST                                15580000
155900                   ,WRKR_STRT_TMST                                15590000
156000                   ,WRKR_END_TMST                                 15600000
156100                   ,WRKR_USR_ID                                   15610000
156200                   ,CRE_BY_USR_ID                                 15620000
156300                   ,CRE_TMST                                      15630000
156400                   ,UPDATE_BY_USERID                              15640000
156500                   ,UPDATE_TIMESTAMP                              15650000
156600                   )                                              15660000
156700                                                                  15670000
156800           VALUES (                                               15680000
156900                    :SUT00111-OPER-UNT-ID                         15690000
157000                   ,:SUT00111-ACM-LBL-STA-NBR                     15700000
157100                   ,:SUT00111-DOOR-ID                             15710000
157200                   ,:SUT00111-INBD-TRIP-ID                        15720000
157300                   ,:SUT00111-ASGD-STRT-TMST                      15730000
157400                   , CURRENT TIMESTAMP                            15740000
157500                   ,:SUT00111-WRKR-END-TMST                       15750000
157600                   ,:SUT00111-WRKR-USR-ID                         15760000
157700                   ,:SUT00111-CRE-BY-USR-ID                       15770000
157800                   , CURRENT TIMESTAMP                            15780000
157900                   ,:SUT00111-UPDATE-BY-USERID  :DN-UPD-BY-NULL   15790000
158000                   ,:SUT00111-UPDATE-TIMESTAMP  :DN-UPD-TMST-NULL 15800000
158100                   )                                              15810000
158200                                                                  15820000
158300        END-EXEC                                                  15830000
158400     END-IF.                                                      15840000
158500                                                                  15850000
158600     EVALUATE TRUE                                                15860000
158700         WHEN SQLCODE = +0                                        15870000
158800              CONTINUE                                            15880000
158900         WHEN SQLWARN0 NOT = SPACES                               15890000
159000         WHEN SQLCODE < +0                                        15900000
159100         WHEN SQLCODE > +0                                        15910000
159200             MOVE '2420-INSERT-WORKER-ASSIGMENT'                  15920000
159300                                       TO DP013-PARAGRAPH         15930000
159400             MOVE 'INSERT FAILED                  '               15940000
159500                                 TO DP013-MESSAGE-TEXT (1)        15950000
159600             MOVE SQLCA      TO DP013-SQLCA                       15960000
159700             MOVE 'SUT_PNA_STA-WRKR  '  TO                        15970000
159800                                DP013-DB2-TABLE-NAME (1)          15980000
159900             SET DP013-DB2-ABEND                                  15990000
160000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16000000
160100             PERFORM DP013-0000-PROCESS-ABEND                     16010000
160200     END-EVALUATE.                                                16020000
160300                                                                  16030000
160400                                                                  16040000
160500 2440-UPD-TRIP-ASSIGNMENT.                                        16050000
160510                                                                  16051019
160600                                                                  16060000
160700     MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID.                 16070000
160800     MOVE ASC-PNA-STA-NBR      TO DK-ACM-LBL-STA-NBR.             16080000
160900     MOVE ASC-DOOR-ID          TO DK-DOOR-ID.                     16090000
161000     MOVE ASC-TRIP-ID-CURRENT  TO DK-TRIP-ID.                     16100000
161100     MOVE ASC-ASSIGN-TMST      TO DK-TIMESTAMP.                   16110000
161200                                                                  16120000
161300     MOVE DP020-USERID         TO SUT00110-UPDATE-BY-USERID.      16130000
161400                                                                  16140000
161500     EXEC SQL                                                     16150000
161600         UPDATE  SUT_PNA_TRIP_ASGMT   S110                        16160000
161700            SET  S110.ASGD_END_TMST      = CURRENT TIMESTAMP      16170000
161800                ,S110.UPDATE_BY_USERID   =                        16180000
161900                                      :SUT00110-UPDATE-BY-USERID  16190000
162000                ,S110.UPDATE_TIMESTAMP   = CURRENT TIMESTAMP      16200000
162100                                                                  16210000
162200          WHERE  OPER_UNT_ID          = :DK-OPER-UNT-ID           16220000
162300            AND  ACM_LBL_STA_NBR      = :DK-ACM-LBL-STA-NBR       16230000
162400            AND  DOOR_ID              = :DK-DOOR-ID               16240000
162500            AND  INBD_TRIP_ID         = :DK-TRIP-ID               16250000
162600            AND  ASGD_STRT_TMST       = :DK-TIMESTAMP             16260000
162700     END-EXEC.                                                    16270000
162800                                                                  16280000
162900     EVALUATE TRUE                                                16290000
163000         WHEN SQLCODE = +0                                        16300000
163100              CONTINUE                                            16310000
163200         WHEN SQLWARN0 NOT = SPACES                               16320000
163300         WHEN SQLCODE < +0                                        16330000
163400         WHEN SQLCODE > +0                                        16340000
163500             MOVE '2440-UPD-TRIP-ASGMT      '                     16350000
163600                                       TO DP013-PARAGRAPH         16360000
163700             MOVE 'TRIP NOT FOUNDTE DOOR TYPE CODE'               16370000
163800                                 TO DP013-MESSAGE-TEXT (1)        16380000
163900             MOVE SQLCA      TO DP013-SQLCA                       16390000
164000             MOVE 'SUT_PNA_TRIP_ASGMT'  TO                        16400000
164100                                DP013-DB2-TABLE-NAME (1)          16410000
164200             SET DP013-DB2-ABEND                                  16420000
164300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16430000
164400             PERFORM DP013-0000-PROCESS-ABEND                     16440000
164500     END-EVALUATE.                                                16450000
164600                                                                  16460000
164700 2460-UPD-STATION-WORKER.                                         16470000
164710                                                                  16471019
164800                                                                  16480000
164900     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                   16490000
165000     MOVE ASC-PNA-STA-NBR    TO DK-ACM-LBL-STA-NBR.               16500000
165100     MOVE ASC-DOOR-ID        TO DK-DOOR-ID.                       16510000
165200     MOVE ASC-TRIP-ID-CURRENT TO DK-TRIP-ID.                      16520000
165300     MOVE ASC-TK-TP-NBR-CURRENT TO DK-USR-ID.                     16530000
165400     MOVE ASC-TK-TP-NBR          TO SUT00111-WRKR-USR-ID.         16540000
165500                                                                  16550000
165600     MOVE ASC-ASSIGN-TMST    TO  DK-TIMESTAMP.                    16560000
165700                                                                  16570000
165800     MOVE DP020-USERID         TO SUT00111-UPDATE-BY-USERID.      16580000
165900                                                                  16590000
166000     EXEC SQL                                                     16600000
166100         UPDATE  SUT_PNA_STA_WRKR  S111                           16610000
166200            SET  S111.WRKR_END_TMST      = CURRENT TIMESTAMP      16620000
166300                ,S111.UPDATE_BY_USERID   =                        16630000
166400                                       :SUT00111-UPDATE-BY-USERID 16640000
166500                ,S111.UPDATE_TIMESTAMP   = CURRENT TIMESTAMP      16650000
166600                                                                  16660000
166700          WHERE  OPER_UNT_ID          = :DK-OPER-UNT-ID           16670000
166800            AND  ACM_LBL_STA_NBR      = :DK-ACM-LBL-STA-NBR       16680000
166900            AND  DOOR_ID              = :DK-DOOR-ID               16690000
167000            AND  INBD_TRIP_ID         = :DK-TRIP-ID               16700000
167100*           AND  ASGD_STRT_TMST       = :DK-TIMESTAMP             16710007
167200            AND  WRKR_END_TMST        = :PC-DEFAULT-TMST          16720000
167300*           AND  WRKR_USR_ID          = :DK-USR-ID                16730007
167400     END-EXEC.                                                    16740000
167500                                                                  16750000
167600     EVALUATE TRUE                                                16760000
167700         WHEN SQLCODE = +0                                        16770000
167800              CONTINUE                                            16780000
167900         WHEN SQLCODE = +100                                      16790000
168000              CONTINUE                                            16800000
168100         WHEN SQLWARN0 NOT = SPACES                               16810000
168200         WHEN SQLCODE < +0                                        16820000
168300         WHEN SQLCODE > +0                                        16830000
168400             MOVE '2460-UPD-STATION-WORKER  '                     16840000
168500                                       TO DP013-PARAGRAPH         16850000
168600             MOVE 'TRIP NOT FOUNDTE DOOR TYPE CODE'               16860000
168700                                 TO DP013-MESSAGE-TEXT (1)        16870000
168710             MOVE  DK-OPER-UNT-ID TO  PV-DISP-OPER                16871014
168800             STRING  'OPER='              DELIMITED BY SIZE       16880000
168900                      PV-DISP-OPER        DELIMITED BY SIZE       16890014
169000                     ' STA='              DELIMITED BY SIZE       16900000
169100                      ASC-PNA-STA-NBR     DELIMITED BY SIZE       16910000
169200                                     INTO DP013-MESSAGE-TEXT (2)  16920000
169300             STRING  'DOOR='              DELIMITED BY SIZE       16930000
169400                      DK-DOOR-ID          DELIMITED BY SIZE       16940000
169500                     ' TRIP='             DELIMITED BY SIZE       16950000
169600                      ASC-TRIP-ID         DELIMITED BY SIZE       16960000
169700                                     INTO DP013-MESSAGE-TEXT (3)  16970000
169800             MOVE SQLCA      TO DP013-SQLCA                       16980000
169900             MOVE 'SUT_PNA_PNA_WRKR '   TO                        16990000
170000                                DP013-DB2-TABLE-NAME (1)          17000000
170100             SET DP013-DB2-ABEND                                  17010000
170200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17020000
170300             PERFORM DP013-0000-PROCESS-ABEND                     17030000
170400     END-EVALUATE.                                                17040000
170500                                                                  17050000
170600                                                                  17060000
170700*----------------------------------------------------------------*17070000
170800* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *17080000
170900* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *17090000
171000* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *17100000
171100*----------------------------------------------------------------*17110000
171200 3000-EDIT-DATA-IN-COMMAREA.                                      17120000
171210                                                                  17121019
171300                                                                  17130000
171400     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) OR                17140000
171500         ASC-UNASSIGN-TMST > SPACES                               17150000
171600         CONTINUE                                                 17160000
171700     ELSE                                                         17170000
171800     IF  ASC-TRIP-ID  >  SPACES  AND                              17180000
171900         ASC-TRIP-ID-N  NOT = ZEROS                               17190000
172000         MOVE ASC-TRIP-ID            TO DP010I-UNEDITED-FIELD     17200000
172100         MOVE LENGTH OF ASC-TRIP-ID                               17210000
172200                                   TO DP010I-MAXIMUM-DIGITS       17220000
172300         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     17230000
172400         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  17240000
172500         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17250009
172510              USING DP010I-NUMERIC-EDIT-AREA                      17251009
172600         IF  DP010I-ERROR-DETECTED                                17260000
172700             SET PS-ERROR                                         17270000
172800                 DP020-MSG-FATAL         TO TRUE                  17280000
172900            MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER       17290000
173000            MOVE DP015-UNP-ALP-BRT-OFF  TO ATRIPIDA               17300000
173100            MOVE DP015-RED              TO ATRIPIDC               17310000
173200            MOVE DP015-REVERSE          TO ATRIPIDH               17320000
173300            MOVE -1                     TO ATRIPIDL               17330000
173400            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   17340000
173500         ELSE                                                     17350000
173600             MOVE DP010I-NUMERIC-FIELD TO ASC-TRIP-ID-N           17360000
173700             PERFORM 5500-SELECT-TVHTRIP                          17370000
173800         END-IF                                                   17380000
173900     ELSE                                                         17390000
174000        SET PS-ERROR                                              17400000
174100            DP020-MSG-FATAL         TO TRUE                       17410000
174200        MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER           17420000
174300        MOVE DP015-UNP-ALP-BRT-OFF  TO ATRIPIDA                   17430000
174400        MOVE DP015-RED              TO ATRIPIDC                   17440000
174500        MOVE DP015-REVERSE          TO ATRIPIDH                   17450000
174600        MOVE -1                     TO ATRIPIDL                   17460000
174700        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       17470000
174800     END-IF.                                                      17480000
174900                                                                  17490000
174901*                                                                 17490102
174902*** DMH ADDED - 1/25/13 - BEGIN                                   17490202
174903*** LOCAL FUND 04 = USER DONE                                     17490302
174904*** USER ID CANNOT BE CHANGE WHEN USING THIS FUNCTION -  THAT     17490402
174905*** WILL CAUSE A BLANK USER ID IN SUT_PNA_STA_WRKR TABLE          17490502
174906*** IF CHANGING THE ASSOCIATE - THE UPDATE FUNCTION MUST BE USED  17490602
174907***                                                               17490702
174908                                                                  17490802
174910     IF  DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                   17491002
174920         IF  ASC-TK-TP-NBR  =  ASC-TK-TP-NBR-CURRENT              17492002
174930             CONTINUE                                             17493002
174940         ELSE                                                     17494002
174995             SET PS-ERROR                                         17499502
174996                 DP020-MSG-FATAL         TO TRUE                  17499602
174997             SET ASC-F2-CONFIRM-NO                                17499720
174998                 ASC-CONFIRM-TYPE-NONE   TO TRUE                  17499820
174999            MOVE PC-TSYMSG-03727        TO DP020-MSG-NUMBER       17499920
175000            MOVE DP015-UNP-ALP-BRT-OFF  TO ATKPNBRA               17500020
175001            MOVE DP015-RED              TO ATKPNBRC               17500120
175002            MOVE DP015-REVERSE          TO ATKPNBRH               17500220
175003            MOVE -1                     TO ATKPNBRL               17500320
175004            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   17500420
175006         END-IF                                                   17500602
175016     END-IF.                                                      17501602
175017*** DMH ADDED - 1/25/13 - END                                     17501702
175018                                                                  17501802
175019                                                                  17501902
175020     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) OR                17502000
175100         ASC-UNASSIGN-TMST > SPACES                               17510000
175200         CONTINUE                                                 17520000
175310     ELSE                                                         17531020
175400     IF PS-NO-ERROR                                               17540000
175500        IF  ASC-TK-TP-NBR  >  SPACES                              17550000
175600            EVALUATE TRUE                                         17560000
175700                WHEN ASC-TK-TP-NBR(1:2) = 'TK'                    17570000
175710                WHEN ASC-TK-TP-NBR(1:2) = 'TC'                    17571000
175720                WHEN ASC-TK-TP-NBR(1:2) = 'TV'                    17572000
175800                     PERFORM 5200-SELECT-XLT-USER                 17580000
175801                     IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)   17580121
175802                         AND  PS-NO-ERROR                         17580222
175810                         PERFORM 5210-SELECT-DLT-USR-LOC          17581021
175820                     END-IF                                       17582021
175900                                                                  17590000
176000                WHEN ASC-TK-TP-NBR(1:2) = 'TP'                    17600000
176100                     PERFORM 5100-SELECT-DLT-TEMP                 17610000
176101                     IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)   17610121
176102                         AND  PS-NO-ERROR                         17610222
176110                         PERFORM 5110-SELECT-DLT-USR-LOC-TEMP     17611021
176120                     END-IF                                       17612021
176200                                                                  17620000
176300                WHEN OTHER                                        17630000
176400                     SET PS-ERROR                                 17640000
176500                         DP020-MSG-FATAL         TO TRUE          17650000
176600                     MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER  17660000
176700                     MOVE DP015-UNP-ALP-BRT-OFF  TO ATKPNBRA      17670000
176800                     MOVE DP015-RED              TO ATKPNBRC      17680000
176900                     MOVE DP015-REVERSE          TO ATKPNBRH      17690000
177000                     MOVE +0                     TO ATRIPIDL      17700000
177100                     MOVE -1                     TO ATKPNBRL      17710000
177200                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          17720000
177300                                                                  17730000
177400            END-EVALUATE                                          17740000
177500                                                                  17750000
177600**  PERFORM F15 SPECIFIC EDITS FOR UPDATES                        17760000
177700            PERFORM 3100-UPDATE-EDITS                             17770000
177800                                                                  17780000
177900        ELSE                                                      17790000
178000**--->      REQUIRED FOR F15 UPDATE                               17800000
178100**--->               AND F18 LOGOFFTK                             17810000
178200            IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) OR          17820000
178300               DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)             17830000
178400               SET PS-ERROR                                       17840000
178500                   DP020-MSG-FATAL         TO TRUE                17850000
178600               MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER    17860000
178700               MOVE DP015-UNP-ALP-BRT-OFF  TO ATKPNBRA            17870000
178800               MOVE DP015-RED              TO ATKPNBRC            17880000
178900               MOVE DP015-REVERSE          TO ATKPNBRH            17890000
179000               MOVE +0                     TO ATRIPIDL            17900000
179100               MOVE -1                     TO ATKPNBRL            17910000
179200               SET DP030-SET-CURSOR-APPL-1 TO TRUE                17920000
179300            END-IF                                                17930000
179400        END-IF                                                    17940021
179500     END-IF.                                                      17950000
179600                                                                  17960000
179700*----------------------------------------------------------------*17970000
179800*    FOLLOWING EDITS ARE FOR F15 (LOCAL-01).                     *17980000
179900*                                                                *17990000
180000*    5400-COUNT-WORKER-ASSIGNMENTS - A WORKER CAN ONLY BE ACTIVE *18000000
180100*         ON ONE ASSIGNMENT AT A TIME.                           *18010000
180200*                                                                *18020000
180300*    5405-COUNT-TRIP-ASSIGNMENTS   - IF THE TRIP IS CHANGING,    *18030000
180400*         MAKE SURE THAT IT ISN'T ALREADY ACTIVE.                *18040000
180500*                                                                *18050000
180600*----------------------------------------------------------------*18060000
180700 3100-UPDATE-EDITS.                                               18070000
180710                                                                  18071019
180800                                                                  18080000
180900     IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                    18090000
180910     OR (DP020-FK-CONFIRM  (DP020-SRC-AID)                        18091006
180920     AND NOT ASC-LOGOFFTK-YES)                                    18092006
181000         PERFORM 5400-COUNT-WORKER-ASSIGNMENTS                    18100000
181100         IF PV-DOOR-ID NOT = SPACES                               18110000
181200**??     IF PV-COUNT-ASSIGNMENTS > 0                              18120000
181300            SET PS-ERROR                                          18130000
181400                DP020-MSG-FATAL         TO TRUE                   18140000
181500            MOVE PC-TSYMSG-03653    TO DP020-MSG-NUMBER           18150000
181600            MOVE PV-DOOR-ID        TO DP020-MSG-TEXT              18160000
181700            MOVE DP015-UNP-ALP-BRT-OFF  TO ATKPNBRA               18170000
181800            MOVE DP015-RED              TO ATKPNBRC               18180000
181900            MOVE DP015-REVERSE          TO ATKPNBRH               18190000
182000            MOVE +0                     TO ATRIPIDL               18200000
182100            MOVE -1                     TO ATKPNBRL               18210000
182200            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   18220000
182300         END-IF                                                   18230000
182400                                                                  18240000
182500         IF PS-NO-ERROR                                           18250000
182600            IF ASC-TRIP-ID = ASC-TRIP-ID-CURRENT                  18260000
182700               CONTINUE                                           18270000
182800            ELSE                                                  18280000
182900               PERFORM 5405-COUNT-TRIP-ASSIGNMENTS                18290000
183000** 17790 IR  CHANGE FOLLOWING LINE                                18300000
183100               IF PS-TRIP-FOUND-YES                               18310000
183200** 17790 IR    IF PV-COUNT-ACTVE-TRIPS > 0                        18320000
183300                  SET PS-ERROR                                    18330000
183400                      DP020-MSG-FATAL         TO TRUE             18340000
183500                  MOVE PC-TSYMSG-03654    TO DP020-MSG-NUMBER     18350000
183600                  MOVE PV-DOOR-ID        TO DP020-MSG-TEXT        18360000
183700                  MOVE DP015-UNP-ALP-BRT-OFF  TO ATRIPIDA         18370000
183800                  MOVE DP015-RED              TO ATRIPIDC         18380000
183900                  MOVE DP015-REVERSE          TO ATRIPIDH         18390000
184000                  MOVE -1                     TO ATRIPIDL         18400000
184100                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             18410000
184200               END-IF                                             18420000
184300            END-IF                                                18430000
184400         END-IF                                                   18440000
184500      END-IF.                                                     18450000
184600                                                                  18460000
184700*----------------------------------------------------------------*18470000
184800* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *18480000
184900* MAP.                                                           *18490000
185000*----------------------------------------------------------------*18500000
185100 3200-RESET-ATTRIBUTES.                                           18510000
185110                                                                  18511019
185200                                                                  18520000
185300     IF ASC-OPER-UNT-ID   = DP020-LOCATION-NBR                    18530000
185400        IF ASC-UNASSIGN-TMST = SPACES    AND                      18540000
185500           ASC-PROTECT-SCREEN-NO                                  18550000
185600            MOVE DP015-UNP-ALP-NOR-OFF    TO ATRIPIDA             18560000
185700            MOVE DP015-UNP-ALP-NOR-OFF    TO ATKPNBRA             18570000
185800            MOVE DP015-GREEN              TO ATRIPIDC             18580000
185900            MOVE DP015-GREEN              TO ATKPNBRC             18590000
186000            MOVE DP015-UNDERLINE          TO ATRIPIDH             18600000
186100            MOVE DP015-UNDERLINE          TO ATKPNBRH             18610000
186200            MOVE -1                       TO ATRIPIDL             18620000
186300        ELSE                                                      18630000
186400        IF ASC-UNASSIGN-TMST = SPACES    AND                      18640000
186500           DP020-FK-REFRESH(DP020-SRC-AID)                        18650000
186600            MOVE DP015-UNP-ALP-NOR-OFF    TO ATRIPIDA             18660000
186700            MOVE DP015-UNP-ALP-NOR-OFF    TO ATKPNBRA             18670000
186800            MOVE DP015-GREEN              TO ATRIPIDC             18680000
186900            MOVE DP015-GREEN              TO ATKPNBRC             18690000
187000            MOVE DP015-UNDERLINE          TO ATRIPIDH             18700000
187100            MOVE DP015-UNDERLINE          TO ATKPNBRH             18710000
187200            MOVE -1                       TO ATRIPIDL             18720000
187300*       ELSE                                                      18730000
187400*           MOVE DP015-ASK-NOR-OFF      TO ATRIPIDA               18740000
187500*           MOVE DP015-ASK-NOR-OFF      TO ATKPNBRA               18750000
187600*           MOVE DP015-BLUE               TO ATRIPIDC             18760000
187700*           MOVE DP015-BLUE               TO ATKPNBRC             18770000
187800*           MOVE DP015-HL-OFF             TO ATRIPIDH             18780000
187900*           MOVE DP015-HL-OFF             TO ATKPNBRH             18790000
188000*           MOVE -1                       TO ATRIPIDL             18800000
188100*       END-IF                                                    18810000
188200        END-IF                                                    18820000
188300     ELSE                                                         18830000
188400        MOVE DP015-ASK-NOR-OFF      TO ATRIPIDA                   18840000
188500        MOVE DP015-ASK-NOR-OFF      TO ATKPNBRA                   18850000
188600        MOVE DP015-BLUE               TO ATRIPIDC                 18860000
188700        MOVE DP015-BLUE               TO ATKPNBRC                 18870000
188800        MOVE DP015-HL-OFF             TO ATRIPIDH                 18880000
188900        MOVE DP015-HL-OFF             TO ATKPNBRH                 18890000
189000        MOVE -1                       TO ATRIPIDL                 18900000
189100     END-IF.                                                      18910000
189200                                                                  18920000
189300     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       18930000
189400                                                                  18940000
189500*----------------------------------------------------------------*18950000
189600*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *18960000
189700*    ENTRY.                                                      *18970000
189800*----------------------------------------------------------------*18980000
189900 4000-BUILD-INITIAL-PANEL.                                        18990000
189910                                                                  18991019
190000                                                                  19000000
190100     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                   19010000
190200                                                                  19020000
190300     PERFORM 4100-SELECT-TVHTRIP.                                 19030000
190400                                                                  19040000
190500                                                                  19050000
190600*----------------------------------------------------------------*19060000
190700*    RETRIEVE INFORMATION FROM THE TVHTRIP                        19070000
190800*----------------------------------------------------------------*19080000
190900 4100-SELECT-TVHTRIP.                                             19090000
191000                                                                  19100000
191100**   17880 IR - CHG FROM ASC-TRIP-ID TO ASC-TRIP-ID-N             19110000
191200     MOVE ASC-TRIP-ID-N   TO DK-TRIP-ID.                          19120000
191300                                                                  19130000
191400     EXEC SQL                                                     19140000
191500         SELECT                                                   19150000
191600                OWNER_SCAC_ID                                     19160000
191700               ,VEH_NBR                                           19170000
191800               ,TRIP_ID                                           19180000
191900          INTO                                                    19190000
192000                :VHTRIP-OWNER-SCAC-ID                             19200000
192100               ,:VHTRIP-VEH-NBR                                   19210000
192200               ,:VHTRIP-TRIP-ID                                   19220000
192300         FROM  TVHTRIP                                            19230000
192400        WHERE  TRIP_ID     = :DK-TRIP-ID                          19240000
192500     END-EXEC.                                                    19250000
192600                                                                  19260000
192700     EVALUATE TRUE                                                19270000
192800         WHEN SQLCODE = ZERO                                      19280000
192900              MOVE VHTRIP-OWNER-SCAC-ID TO ASC-SCAC               19290000
193000              MOVE VHTRIP-VEH-NBR       TO ASC-TRAILER            19300000
193100                                                                  19310000
193200         WHEN SQLCODE = +100                                      19320000
193300              MOVE SPACES               TO ASC-SCAC               19330000
193400              MOVE PC-AVAILABLE         TO ASC-TRAILER            19340000
193500                                                                  19350000
193600         WHEN SQLWARN0 NOT = SPACES                               19360000
193700         WHEN SQLCODE < +0                                        19370000
193800         WHEN SQLCODE > +0                                        19380000
193900             MOVE '4360-SELECT-VHTRIP      ' TO DP013-PARAGRAPH   19390000
194000             MOVE 'TROUBLE RETRIEVING TRIP'                       19400000
194100                                      TO DP013-MESSAGE-TEXT (1)   19410000
194200             MOVE SQLCA        TO DP013-SQLCA                     19420000
194300             MOVE 'TVHTRIP '   TO DP013-DB2-TABLE-NAME (1)        19430000
194400             SET DP013-DB2-ABEND                                  19440000
194500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               19450000
194600             PERFORM DP013-0000-PROCESS-ABEND                     19460000
194700         END-EVALUATE.                                            19470000
194800                                                                  19480000
194900*----------------------------------------------------------------*19490000
195000*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *19500000
195100*----------------------------------------------------------------*19510000
195200 4400-MOVE-COMMAREA-TO-SCREEN.                                    19520000
195210                                                                  19521019
195300                                                                  19530000
195400     MOVE ASC-OPER-UNT-ID          TO AOPRUNTO.                   19540000
195500     MOVE ASC-FCLTY-NME            TO AOPRNMEO.                   19550000
195600     MOVE ASC-PNA-STA-NBR          TO ASTANBRO.                   19560000
195700     MOVE ASC-DOOR-ID              TO ADOORIDO.                   19570000
195800     MOVE ASC-SCAC                 TO ASCACO.                     19580000
195900     MOVE ASC-TRAILER              TO ATRAILRO.                   19590000
196000     MOVE ASC-TRIP-ID-N            TO ATRIPIDO.                   19600000
196100     MOVE ASC-TK-TP-NBR            TO ATKPNBRO.                   19610000
196110     MOVE ASC-FIRST-NAME           TO AFRSTNMO.                   19611025
196120     MOVE ASC-LAST-NAME            TO ALASTNMO.                   19612025
196200     IF ASC-TK-COUNT > 1                                          19620000
196300        MOVE 'MULT'  TO AMULTO                                    19630000
196400     ELSE                                                         19640000
196500        MOVE SPACES TO AMULTO                                     19650000
196600     END-IF.                                                      19660000
196700     MOVE ASC-PO-EXCEPTIONS        TO APOO.                       19670000
196800     MOVE ASC-VENDOR-EXCEPTIONS    TO AVENDORO.                   19680000
196900     MOVE ASC-FIRST-EXCEPTIONS     TO AFIRSTO.                    19690000
197000                                                                  19700000
197100     COMPUTE PV-WORK-COUNT = ASC-PO-EXCEPTIONS +                  19710000
197200                             ASC-VENDOR-EXCEPTIONS +              19720000
197300                             ASC-FIRST-EXCEPTIONS.                19730000
197400     MOVE PV-WORK-COUNT TO ACRTNEXO.                              19740000
197500     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         19750000
197600                                                                  19760000
197700     IF ASC-OPER-UNT-ID   = DP020-LOCATION-NBR                    19770000
197800        IF ASC-UNASSIGN-TMST = SPACES  AND                        19780000
197900           ASC-PROTECT-SCREEN-NO                                  19790000
198000            MOVE DP015-UNP-ALP-NOR-OFF    TO ATRIPIDA             19800000
198100            MOVE DP015-UNP-ALP-NOR-OFF    TO ATKPNBRA             19810000
198200            MOVE DP015-GREEN              TO ATRIPIDC             19820000
198300            MOVE DP015-GREEN              TO ATKPNBRC             19830000
198400            MOVE DP015-UNDERLINE          TO ATRIPIDH             19840000
198500            MOVE DP015-UNDERLINE          TO ATKPNBRH             19850000
198600            MOVE -1                       TO ATRIPIDL             19860000
198700        ELSE                                                      19870000
198800        IF ASC-UNASSIGN-TMST = SPACES    AND                      19880000
198900           DP020-FK-REFRESH(DP020-SRC-AID)                        19890000
199000            MOVE DP015-UNP-ALP-NOR-OFF    TO ATRIPIDA             19900000
199100            MOVE DP015-UNP-ALP-NOR-OFF    TO ATKPNBRA             19910000
199200            MOVE DP015-GREEN              TO ATRIPIDC             19920000
199300            MOVE DP015-GREEN              TO ATKPNBRC             19930000
199400            MOVE DP015-UNDERLINE          TO ATRIPIDH             19940000
199500            MOVE DP015-UNDERLINE          TO ATKPNBRH             19950000
199600            MOVE -1                       TO ATRIPIDL             19960000
199700        ELSE                                                      19970000
199800            MOVE DP015-ASK-NOR-OFF      TO ATRIPIDA               19980000
199900            MOVE DP015-ASK-NOR-OFF      TO ATKPNBRA               19990000
200000            MOVE DP015-BLUE               TO ATRIPIDC             20000000
200100            MOVE DP015-BLUE               TO ATKPNBRC             20010000
200200            MOVE DP015-HL-OFF             TO ATRIPIDH             20020000
200300            MOVE DP015-HL-OFF             TO ATKPNBRH             20030000
200400            MOVE -1                       TO ATRIPIDL             20040000
200500        END-IF                                                    20050000
200600        END-IF                                                    20060000
200700     ELSE                                                         20070000
200800        MOVE DP015-ASK-NOR-OFF      TO ATRIPIDA                   20080000
200900        MOVE DP015-ASK-NOR-OFF      TO ATKPNBRA                   20090000
201000        MOVE DP015-BLUE               TO ATRIPIDC                 20100000
201100        MOVE DP015-BLUE               TO ATKPNBRC                 20110000
201200        MOVE DP015-HL-OFF             TO ATRIPIDH                 20120000
201300        MOVE DP015-HL-OFF             TO ATKPNBRH                 20130000
201400        MOVE -1                       TO ATRIPIDL                 20140000
201500     END-IF.                                                      20150000
201600                                                                  20160000
203500                                                                  20350000
203600*------------------------------------------------------------     20360000
203700*  MOVE COMMAREA TO TEMP AREA                                     20370000
203800*------------------------------------------------------------     20380000
203900 4500-MOVE-COMMAREA-TO-TEMP.                                      20390000
203910                                                                  20391019
204000     MOVE ASC-DOOR-ID             TO PV-INP-DOOR-ID.              20400000
204100     MOVE ASC-OPER-UNT-ID         TO PV-INP-OPER-UNT-ID.          20410000
204200     MOVE ASC-FCLTY-NME           TO PV-INP-FCLTY-NME.            20420000
204300                                                                  20430000
204400                                                                  20440000
204500*----------------------------------------------------------------*20450000
204600*                                                                *20460000
204700*----------------------------------------------------------------*20470000
204800 5100-SELECT-DLT-TEMP.                                            20480000
204900                                                                  20490000
205000     MOVE ASC-OPER-UNT-ID  TO DK-DC-NBR.                          20500000
205100     MOVE ASC-TK-TP-NBR    TO DK-USR-ID.                          20510000
205110     MOVE SPACES           TO ASC-FIRST-NAME                      20511025
205120                              ASC-LAST-NAME.                      20512025
205200                                                                  20520000
205300     EXEC SQL                                                     20530000
205400          SELECT                                                  20540000
205500                  TMP_USR_ID                                      20550000
205600                 ,DC_NBR                                          20560000
205700                 ,FRST_NM                                         20570000
205800                 ,LAST_NM                                         20580000
205900                 ,CRE_BY_USR_ID                                   20590000
206000                 ,ACTV_IND                                        20600000
206100                 ,CRE_TMST                                        20610000
206200                                                                  20620000
206300            INTO  :DLT00002-TMP-USR-ID                            20630000
206400                 ,:DLT00002-DC-NBR                                20640000
206500                 ,:DLT00002-FRST-NM                               20650000
206600                 ,:DLT00002-LAST-NM                               20660000
206700                 ,:DLT00002-CRE-BY-USR-ID                         20670000
206800                 ,:DLT00002-ACTV-IND                              20680000
206900                 ,:DLT00002-CRE-TMST                              20690000
207000                                                                  20700000
207100            FROM  DLT_TMP_EMP   EMP                               20710000
207200           WHERE  DC_NBR     =  :DK-DC-NBR                        20720000
207300             AND  TMP_USR_ID =  :DK-USR-ID                        20730000
207400            WITH  UR                                              20740000
207500     END-EXEC.                                                    20750000
207600                                                                  20760000
207700     EVALUATE TRUE                                                20770000
207800         WHEN SQLCODE = +0                                        20780000
207810             MOVE DLT00002-FRST-NM TO ASC-FIRST-NAME              20781025
207820             MOVE DLT00002-LAST-NM TO ASC-LAST-NAME               20782025
207900                                                                  20790025
208000         WHEN SQLCODE = +100                                      20800000
208100             SET PS-ERROR                                         20810000
208200                 DP020-MSG-FATAL         TO TRUE                  20820000
208300             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      20830000
208400             MOVE DP015-UNP-ALP-BRT-OFF  TO ATKPNBRA              20840000
208500             MOVE DP015-RED              TO ATKPNBRC              20850000
208600             MOVE DP015-REVERSE          TO ATKPNBRH              20860000
208700             MOVE +0                     TO ATRIPIDL              20870000
208800             MOVE -1                     TO ATKPNBRL              20880000
208900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  20890000
209000         WHEN SQLWARN0 NOT = SPACES                               20900000
209100         WHEN SQLCODE < +0                                        20910000
209200         WHEN SQLCODE > +0                                        20920000
209300             MOVE '5100-SELECT-DLT-TEMP        '                  20930000
209400                                       TO DP013-PARAGRAPH         20940000
209500             MOVE 'CAN"T RETRIEVE ROW             '               20950000
209600                                 TO DP013-MESSAGE-TEXT (1)        20960000
209700             MOVE SQLCA      TO DP013-SQLCA                       20970000
209800             MOVE 'DLT_TMP_EMP '  TO                              20980000
209900                                DP013-DB2-TABLE-NAME (1)          20990000
210000             SET DP013-DB2-ABEND                                  21000000
210100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21010000
210200             PERFORM DP013-0000-PROCESS-ABEND                     21020000
210300     END-EVALUATE.                                                21030000
210400                                                                  21040000
210410                                                                  21041015
210500                                                                  21050000
210510*----------------------------------------------------------------*21051012
210520* TEMP USERID AND CURRENT OPER                                   *21052012
210530* CHECK IF THE TK HAS ALREADY BEEN USED FOR CURRENT LOCATION     *21053012
210540* +0 OR -811 - THE TK HAS ALREADY BEEN USED FOR CURRENT LOCATION *21054012
210550* +100 - NOT USED FOR THIS LOCATION                              *21055012
210560*        PERFORM SQL AGAIN WITHOUT OPER TO SEE IF FROM ANOTHER   *21056012
210570*        LOCATION                                                *21057012
210580*----------------------------------------------------------------*21058012
210590 5110-SELECT-DLT-USR-LOC-TEMP.                                    21059012
210607                                                                  21060712
210608     MOVE ASC-TK-TP-NBR    TO  DK-USR-ID.                         21060812
210609     MOVE ASC-OPER-UNT-ID  TO  DK-LOC-NBR.                        21060912
210610                                                                  21061012
210611     EXEC SQL                                                     21061112
210612          SELECT LOC_NBR                                          21061212
210613            INTO :DLT00009-LOC-NBR                                21061312
210614            FROM DLT_RDPR_USR_LSTG                                21061412
210615           WHERE TMP_USR_ID  = :DK-USR-ID                         21061523
210616             AND LOC_NBR     = :DK-LOC-NBR                        21061612
210617            WITH UR                                               21061712
210618     END-EXEC.                                                    21061812
210619                                                                  21061912
210620     EVALUATE TRUE                                                21062012
210621         WHEN SQLCODE = +0                                        21062112
210622         WHEN SQLCODE = -811                                      21062212
210623             MOVE ASC-FIRST-NAME         TO AFRSTNMO              21062330
210624             MOVE ASC-LAST-NAME          TO ALASTNMO              21062430
210625                                                                  21062512
210635         WHEN SQLCODE = +100                                      21063512
210646              PERFORM 5115-DLT-USR-TEMP-NO-OPER                   21064614
210647                                                                  21064712
210648         WHEN SQLWARN0 NOT = SPACES                               21064812
210649         WHEN SQLCODE < +0                                        21064912
210650         WHEN SQLCODE > +0                                        21065012
210661             MOVE '5110-SELECT-DLT-USR-LOC-TEMP'                  21066112
210662                                       TO DP013-PARAGRAPH         21066212
210663             MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER            21066312
210664             STRING 'ASC-TK-TP-NBR:' ASC-TK-TP-NBR                21066412
210665                    '   ASC-OPER-UNT-ID:' PV-DISP-OPER            21066512
210666                                    DELIMITED BY SIZE             21066612
210667                               INTO DP013-MESSAGE-TEXT (1)        21066712
210668             MOVE SQLCA      TO DP013-SQLCA                       21066812
210669             MOVE 'DLT_RDPR_USR_LSTG '  TO                        21066912
210670                                DP013-DB2-TABLE-NAME (1)          21067012
210671             SET DP013-DB2-ABEND                                  21067112
210672                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21067212
210673             PERFORM DP013-0000-PROCESS-ABEND                     21067312
210674     END-EVALUATE.                                                21067412
210675                                                                  21067512
210676                                                                  21067615
210677*----------------------------------------------------------------*21067715
210678* TEMP USERID AND DIFFERENT OPER                                 *21067815
210679* CHECK IF THE TK HAS ALREADY BEEN USED FOR DIFFERENT LOCATION   *21067915
210680* +0 OR -811 - THE TK HAS ALREADY BEEN USED AT DIFFERENT OPER    *21068015
210681*              DISPLAY NEW ERROR MESSAGE WITH F2-CONFIRM         *21068115
210682* +100 - NOT USED FOR THIS LOCATION                              *21068215
210683*        THIS IS A NEW ID - CONTINUE PROCESSING                  *21068315
210684*----------------------------------------------------------------*21068415
210685 5115-DLT-USR-TEMP-NO-OPER.                                       21068515
210700                                                                  21070015
210701     MOVE ASC-TK-TP-NBR    TO  DK-USR-ID.                         21070115
210702                                                                  21070215
210703     EXEC SQL                                                     21070315
210704          SELECT LOC_NBR                                          21070415
210705            INTO :DLT00009-LOC-NBR                                21070515
210706            FROM DLT_RDPR_USR_LSTG                                21070615
210707           WHERE TMP_USR_ID  = :DK-USR-ID                         21070723
210708            FETCH FIRST 1 ROW ONLY                                21070815
210709            WITH UR                                               21070915
210710     END-EXEC.                                                    21071015
210711                                                                  21071115
210712     EVALUATE TRUE                                                21071215
210713         WHEN SQLCODE = +0                                        21071315
210714         WHEN SQLCODE = -811                                      21071415
210715                                                                  21071515
210716             SET PS-ERROR                                         21071615
210717                 DP020-MSG-WARNING                                21071726
210718                 ASC-F2-CONFIRM-YES                               21071820
210719                 ASC-CONFIRM-DIFF-OPER   TO TRUE                  21071920
210720             MOVE PC-TSYMSG-03819        TO DP020-MSG-NUMBER      21072020
210721             MOVE DLT00009-LOC-NBR       TO PV-DISP-OPER          21072120
210722             MOVE ASC-FIRST-NAME         TO AFRSTNMO              21072228
210723             MOVE ASC-LAST-NAME          TO ALASTNMO              21072328
210724             MOVE PV-DISP-OPER           TO DP020-MSG-TEXT        21072420
210725             MOVE DP015-UNP-ALP-BRT-OFF  TO ATKPNBRA              21072520
210726             MOVE DP015-RED              TO ATKPNBRC              21072627
210727             MOVE DP015-REVERSE          TO ATKPNBRH              21072720
210728             MOVE +0                     TO ATRIPIDL              21072820
210729             MOVE -1                     TO ATKPNBRL              21072920
210730             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  21073020
210731                                                                  21073120
210732         WHEN SQLCODE = +100                                      21073220
210733             MOVE ASC-FIRST-NAME         TO AFRSTNMO              21073330
210734             MOVE ASC-LAST-NAME          TO ALASTNMO              21073430
210736                                                                  21073620
210737         WHEN SQLWARN0 NOT = SPACES                               21073720
210738         WHEN SQLCODE < +0                                        21073820
210739         WHEN SQLCODE > +0                                        21073920
210740             MOVE '5115-DLT-USR-TEMP-NO-OPER'                     21074020
210741                                       TO DP013-PARAGRAPH         21074120
210742             MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER            21074220
210743             STRING 'ASC-TK-TP-NBR:' ASC-TK-TP-NBR                21074320
210744                    '   ASC-OPER-UNT-ID:' PV-DISP-OPER            21074420
210745                                    DELIMITED BY SIZE             21074520
210746                               INTO DP013-MESSAGE-TEXT (1)        21074620
210747             MOVE SQLCA      TO DP013-SQLCA                       21074720
210748             MOVE 'DLT_RDPR_USR_LSTG '  TO                        21074820
210749                                DP013-DB2-TABLE-NAME (1)          21074920
210750             SET DP013-DB2-ABEND                                  21075020
210751                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21075120
210752             PERFORM DP013-0000-PROCESS-ABEND                     21075220
210753     END-EVALUATE.                                                21075320
210754                                                                  21075420
210764                                                                  21076420
210765*----------------------------------------------------------------*21076520
210770*                                                                *21077000
210800*----------------------------------------------------------------*21080000
210900 5200-SELECT-XLT-USER.                                            21090000
211000                                                                  21100000
211100     MOVE ASC-TK-TP-NBR  TO DK-USR-ID.                            21110000
211110     MOVE SPACES         TO ASC-FIRST-NAME                        21111025
211120                            ASC-LAST-NAME.                        21112025
211200                                                                  21120000
211300     EXEC SQL                                                     21130000
211400          SELECT                                                  21140000
211500                  USR_ID                                          21150000
211510                , USR_LAST_NM                                     21151024
211520                , USR_FRST_NM                                     21152024
211600            INTO                                                  21160000
211700                  :XLT00024-USR-ID                                21170000
211710                , :XLT00024-USR-LAST-NM                           21171024
211720                , :XLT00024-USR-FRST-NM                           21172024
211800                                                                  21180000
211900            FROM  XLT_USR   XLT024                                21190000
212000           WHERE  USR_ID   = :DK-USR-ID                           21200000
212100            WITH  UR                                              21210000
212200     END-EXEC.                                                    21220000
212300                                                                  21230000
212400     EVALUATE TRUE                                                21240000
212500         WHEN SQLCODE = +0                                        21250000
212520              MOVE XLT00024-USR-FRST-NM TO ASC-FIRST-NAME         21252025
212530              MOVE XLT00024-USR-LAST-NM TO ASC-LAST-NAME          21253025
212600                                                                  21260025
212700         WHEN SQLCODE = +100                                      21270000
212800             SET PS-ERROR                                         21280000
212900                 DP020-MSG-FATAL         TO TRUE                  21290000
213000             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      21300000
213100             MOVE DP015-UNP-ALP-BRT-OFF  TO ATKPNBRA              21310000
213200             MOVE DP015-RED              TO ATKPNBRC              21320000
213300             MOVE DP015-REVERSE          TO ATKPNBRH              21330000
213400             MOVE +0                     TO ATRIPIDL              21340000
213500             MOVE -1                     TO ATKPNBRL              21350000
213600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  21360000
213700         WHEN SQLWARN0 NOT = SPACES                               21370000
213800         WHEN SQLCODE < +0                                        21380000
213900         WHEN SQLCODE > +0                                        21390000
214000             MOVE '5200-SELECT-XLT-USER        '                  21400000
214100                                       TO DP013-PARAGRAPH         21410000
214200             MOVE 'CAN"T READ ROW                 '               21420000
214300                                 TO DP013-MESSAGE-TEXT (1)        21430000
214400             MOVE SQLCA      TO DP013-SQLCA                       21440000
214500             MOVE 'XLT_USR           '  TO                        21450000
214600                                DP013-DB2-TABLE-NAME (1)          21460000
214700             SET DP013-DB2-ABEND                                  21470000
214800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21480000
214900             PERFORM DP013-0000-PROCESS-ABEND                     21490000
215000     END-EVALUATE.                                                21500000
215010                                                                  21501015
215100                                                                  21510000
215110*----------------------------------------------------------------*21511010
215120* CHECK KOHLS USER ID AND CURRENT OPER                           *21512011
215121* CHECK IF THE TK HAS ALREADY BEEN USED FOR CURRENT LOCATION     *21512111
215122* +0 OR -811 - THE TK HAS ALREADY BEEN USED FOR CURRENT LOCATION *21512211
215123* +100 - NOT USED FOR THIS LOCATION                              *21512311
215124*        PERFORM SQL AGAIN WITHOUT OPER TO SEE IF FROM ANOTHER   *21512411
215125*        LOCATION                                                *21512511
215130*----------------------------------------------------------------*21513010
215140 5210-SELECT-DLT-USR-LOC.                                         21514010
215158                                                                  21515817
215160     MOVE ASC-TK-TP-NBR    TO  DK-USR-ID.                         21516011
215161     MOVE ASC-OPER-UNT-ID  TO  DK-LOC-NBR.                        21516111
215170                                                                  21517010
215180     EXEC SQL                                                     21518010
215190          SELECT LOC_NBR                                          21519011
215192            INTO :DLT00009-LOC-NBR                                21519211
215195            FROM DLT_RDPR_USR_LSTG                                21519511
215196           WHERE USR_ID      = :DK-USR-ID                         21519611
215197             AND LOC_NBR     = :DK-LOC-NBR                        21519711
215198            WITH UR                                               21519810
215199     END-EXEC.                                                    21519910
215200                                                                  21520010
215201     EVALUATE TRUE                                                21520110
215202         WHEN SQLCODE = +0                                        21520210
215203         WHEN SQLCODE = -811                                      21520310
215204             MOVE ASC-FIRST-NAME         TO AFRSTNMO              21520430
215205             MOVE ASC-LAST-NAME          TO ALASTNMO              21520530
215215                                                                  21521511
215216         WHEN SQLCODE = +100                                      21521610
215225              PERFORM 5215-SELECT-DLT-USR-NO-OPER                 21522511
215226                                                                  21522610
215227         WHEN SQLWARN0 NOT = SPACES                               21522710
215228         WHEN SQLCODE < +0                                        21522810
215229         WHEN SQLCODE > +0                                        21522910
215238             MOVE '5210-SELECT-DLT-USR-LOC     '                  21523811
215239                                       TO DP013-PARAGRAPH         21523910
215240             MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER            21524011
215241             STRING 'ASC-TK-TP-NBR:' ASC-TK-TP-NBR                21524111
215242                    '   ASC-OPER-UNT-ID:' PV-DISP-OPER            21524211
215243                                    DELIMITED BY SIZE             21524311
215244                               INTO DP013-MESSAGE-TEXT (1)        21524411
215245             MOVE SQLCA      TO DP013-SQLCA                       21524510
215246             MOVE 'DLT_RDPR_USR_LSTG '  TO                        21524611
215247                                DP013-DB2-TABLE-NAME (1)          21524710
215248             SET DP013-DB2-ABEND                                  21524810
215249                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21524910
215250             PERFORM DP013-0000-PROCESS-ABEND                     21525010
215251     END-EVALUATE.                                                21525110
215252                                                                  21525215
215260                                                                  21526010
215261*----------------------------------------------------------------*21526111
215262* CHECK KOHLS USER ID AND DIFFERENT OPER                         *21526211
215263* CHECK IF THE TK HAS ALREADY BEEN USED FOR DIFFERENT LOCATION   *21526311
215264* +0 OR -811 - THE TK HAS ALREADY BEEN USED AT DIFFERENT OPER    *21526411
215265*              DISPLAY NEW ERROR MESSAGE WITH F2-CONFIRM         *21526511
215266* +100 - NOT USED FOR THIS LOCATION                              *21526611
215267*        THIS IS A NEW ID - CONTINUE PROCESSING                  *21526711
215268*----------------------------------------------------------------*21526811
215269 5215-SELECT-DLT-USR-NO-OPER.                                     21526911
215270                                                                  21527019
215287     MOVE ASC-TK-TP-NBR    TO  DK-USR-ID.                         21528717
215288                                                                  21528817
215289     EXEC SQL                                                     21528917
215290          SELECT LOC_NBR                                          21529017
215291               , CRE_TMST                                         21529125
215292            INTO :DLT00009-LOC-NBR                                21529225
215293               , :DLT00009-CRE-TMST                               21529325
215294            FROM DLT_RDPR_USR_LSTG                                21529425
215295           WHERE USR_ID      = :DK-USR-ID                         21529525
215296            ORDER BY CRE_TMST DESC                                21529625
215297            FETCH FIRST 1 ROW ONLY                                21529725
215298            WITH UR                                               21529825
215299     END-EXEC.                                                    21529925
215300                                                                  21530025
215301     EVALUATE TRUE                                                21530125
215302         WHEN SQLCODE = +0                                        21530225
215303         WHEN SQLCODE = -811                                      21530325
215304                                                                  21530425
215305             SET PS-ERROR                                         21530525
215306                 DP020-MSG-WARNING                                21530629
215307                 ASC-F2-CONFIRM-YES                               21530725
215308                 ASC-CONFIRM-DIFF-OPER   TO TRUE                  21530825
215309             MOVE PC-TSYMSG-03819        TO DP020-MSG-NUMBER      21530925
215310             MOVE DLT00009-LOC-NBR       TO PV-DISP-OPER          21531025
215311             MOVE ASC-FIRST-NAME         TO AFRSTNMO              21531129
215312             MOVE ASC-LAST-NAME          TO ALASTNMO              21531229
215313             MOVE PV-DISP-OPER           TO DP020-MSG-TEXT        21531325
215314             MOVE DP015-UNP-ALP-BRT-OFF  TO ATKPNBRA              21531425
215315             MOVE DP015-RED              TO ATKPNBRC              21531525
215316             MOVE DP015-REVERSE          TO ATKPNBRH              21531625
215317             MOVE +0                     TO ATRIPIDL              21531725
215318             MOVE -1                     TO ATKPNBRL              21531825
215319             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  21531925
215320                                                                  21532025
215321         WHEN SQLCODE = +100                                      21532125
215322             MOVE ASC-FIRST-NAME         TO AFRSTNMO              21532230
215323             MOVE ASC-LAST-NAME          TO ALASTNMO              21532330
215325                                                                  21532525
215326         WHEN SQLWARN0 NOT = SPACES                               21532625
215327         WHEN SQLCODE < +0                                        21532725
215328         WHEN SQLCODE > +0                                        21532825
215329             MOVE '5215-SELECT-DLT-USR-NO-OPER '                  21532925
215330                                       TO DP013-PARAGRAPH         21533025
215331             MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER            21533125
215332             STRING 'ASC-TK-TP-NBR:' ASC-TK-TP-NBR                21533225
215333                    '   ASC-OPER-UNT-ID:' PV-DISP-OPER            21533325
215334                                    DELIMITED BY SIZE             21533425
215335                               INTO DP013-MESSAGE-TEXT (1)        21533525
215336             MOVE SQLCA      TO DP013-SQLCA                       21533625
215337             MOVE 'DLT_RDPR_USR_LSTG '  TO                        21533725
215338                                DP013-DB2-TABLE-NAME (1)          21533825
215339             SET DP013-DB2-ABEND                                  21533925
215340                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21534025
215341             PERFORM DP013-0000-PROCESS-ABEND                     21534125
215342     END-EVALUATE.                                                21534225
215343                                                                  21534325
215352                                                                  21535225
215353*----------------------------------------------------------------*21535325
215360*                                                                *21536011
215400*----------------------------------------------------------------*21540000
215500 5300-SELECT-STATION-WORKER.                                      21550000
215600                                                                  21560000
215700     MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID.                     21570000
215800     MOVE ASC-PNA-STA-NBR  TO DK-ACM-LBL-STA-NBR.                 21580000
215900     MOVE ASC-DOOR-ID      TO DK-DOOR-ID.                         21590000
216000     MOVE ASC-TRIP-ID-N    TO DK-TRIP-ID.                         21600000
216100                                                                  21610000
216200     MOVE ASC-ASSIGN-TMST    TO  DK-TIMESTAMP.                    21620000
216300                                                                  21630000
216400     EXEC SQL                                                     21640000
216500         SELECT                                                   21650000
216600                 WRKR_STRT_TMST                                   21660000
216700                ,WRKR_END_TMST                                    21670000
216800                ,WRKR_USR_ID                                      21680000
216900                                                                  21690000
217000           INTO                                                   21700000
217100                 :SUT00111-WRKR-STRT-TMST                         21710000
217200                ,:SUT00111-WRKR-END-TMST                          21720000
217300                ,:SUT00111-WRKR-USR-ID                            21730000
217400                                                                  21740000
217500           FROM  SUT_PNA_STA_WRKR                                 21750000
217600          WHERE  OPER_UNT_ID         = :DK-OPER-UNT-ID            21760000
217700            AND  ACM_LBL_STA_NBR     = :DK-ACM-LBL-STA-NBR        21770000
217800            AND  DOOR_ID             = :DK-DOOR-ID                21780000
217900            AND  INBD_TRIP_ID        = :DK-TRIP-ID                21790000
218000            AND  ASGD_STRT_TMST       = :DK-TIMESTAMP             21800000
218100            AND  WRKR_USR_ID          = :DK-USR-ID                21810000
218200     END-EXEC.                                                    21820000
218300                                                                  21830000
218400     EVALUATE TRUE                                                21840000
218500         WHEN SQLCODE = +0                                        21850000
218600              CONTINUE                                            21860000
218700         WHEN SQLCODE = +100                                      21870000
218800             SET PS-ERROR                                         21880000
218900                 DP020-MSG-FATAL         TO TRUE                  21890000
219000             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      21900000
219100             MOVE DP015-UNP-ALP-BRT-OFF  TO ATKPNBRA              21910000
219200             MOVE DP015-RED              TO ATKPNBRC              21920000
219300             MOVE DP015-REVERSE          TO ATKPNBRH              21930000
219400             MOVE +0                     TO ATRIPIDL              21940000
219500             MOVE -1                     TO ATKPNBRL              21950000
219600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  21960000
219700         WHEN SQLWARN0 NOT = SPACES                               21970000
219800         WHEN SQLCODE < +0                                        21980000
219900         WHEN SQLCODE > +0                                        21990000
220000             MOVE '5300-SELECT-STATION-WORKER  '                  22000000
220100                                       TO DP013-PARAGRAPH         22010000
220200             MOVE 'CAN"T READ ROW                 '               22020000
220300                                 TO DP013-MESSAGE-TEXT (1)        22030000
220400             MOVE SQLCA      TO DP013-SQLCA                       22040000
220500             MOVE 'SUT_PNA_STA_WRKR  '  TO                        22050000
220600                                DP013-DB2-TABLE-NAME (1)          22060000
220700             SET DP013-DB2-ABEND                                  22070000
220800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               22080000
220900             PERFORM DP013-0000-PROCESS-ABEND                     22090000
221000     END-EVALUATE.                                                22100000
221100                                                                  22110000
221200*----------------------------------------------------------------*22120000
221300*                                                                *22130000
221400*----------------------------------------------------------------*22140000
221500 5400-COUNT-WORKER-ASSIGNMENTS.                                   22150000
221600                                                                  22160000
221700     MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID.                     22170000
221800     MOVE 0 TO PV-COUNT-ASSIGNMENTS.                              22180000
221900                                                                  22190000
222000* CT BEGIN 1/19/09 ADDED -811 LINE WE ARE NOW SELECTING NOT COUNT 22200000
222100**??     SELECT  COUNT(*)                                         22210000
222200**??       INTO  :PV-COUNT-ASSIGNMENTS                            22220000
222300     EXEC SQL                                                     22230000
222400         SELECT  DOOR_ID                                          22240000
222500           INTO  :PV-DOOR-ID                                      22250000
222600                                                                  22260000
222700           FROM  SUT_PNA_STA_WRKR                                 22270000
222800          WHERE  OPER_UNT_ID         = :DK-OPER-UNT-ID            22280000
222900            AND  WRKR_USR_ID          = :DK-USR-ID                22290000
223000            AND  WRKR_END_TMST        = :PC-DEFAULT-TMST          22300000
223100     END-EXEC.                                                    22310000
223200                                                                  22320000
223300     EVALUATE TRUE                                                22330000
223400         WHEN SQLCODE = +0                                        22340000
223500         WHEN SQLCODE = -811                                      22350000
223600              CONTINUE                                            22360000
223700         WHEN SQLCODE = +100                                      22370000
223800              MOVE SPACE TO PV-DOOR-ID                            22380000
223900**??                                                              22390000
224000**??         SET PS-ERROR                                         22400000
224100**??             DP020-MSG-FATAL         TO TRUE                  22410000
224200**??         MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      22420000
224300**??         MOVE DP015-UNP-ALP-BRT-OFF  TO ATKPNBRA              22430000
224400**??         MOVE DP015-RED              TO ATKPNBRC              22440000
224500**??         MOVE DP015-REVERSE          TO ATKPNBRH              22450000
224600**??         MOVE -1                     TO ATKPNBRL              22460000
224700**??         SET DP030-SET-CURSOR-APPL-1 TO TRUE                  22470000
224800         WHEN SQLWARN0 NOT = SPACES                               22480000
224900         WHEN SQLCODE < +0                                        22490000
225000         WHEN SQLCODE > +0                                        22500000
225100             MOVE '5400-COUNT-WORKER-ASSIGNMENT'                  22510000
225200                                       TO DP013-PARAGRAPH         22520000
225300             MOVE 'CAN"T READ ROW                 '               22530000
225400                                 TO DP013-MESSAGE-TEXT (1)        22540000
225500             MOVE SQLCA      TO DP013-SQLCA                       22550000
225600             MOVE 'SUT_PNA_STA_WRKR  '  TO                        22560000
225700                                DP013-DB2-TABLE-NAME (1)          22570000
225800             SET DP013-DB2-ABEND                                  22580000
225900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               22590000
226000             PERFORM DP013-0000-PROCESS-ABEND                     22600000
226100     END-EVALUATE.                                                22610000
226200                                                                  22620000
226300*----------------------------------------------------------------*22630000
226400*                                                                *22640000
226500*----------------------------------------------------------------*22650000
226600 5405-COUNT-TRIP-ASSIGNMENTS.                                     22660000
226610                                                                  22661019
226700                                                                  22670000
226800     MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID.                     22680000
226900     MOVE 0 TO PV-COUNT-ACTVE-TRIPS.                              22690000
227000                                                                  22700000
227100     EXEC SQL                                                     22710000
227200         SELECT  DOOR_ID                                          22720000
227300           INTO  :SUT00110-DOOR-ID                                22730000
227400                                                                  22740000
227500           FROM  SUT_PNA_TRIP_ASGMT                               22750000
227600          WHERE  OPER_UNT_ID         = :DK-OPER-UNT-ID            22760000
227700            AND  INBD_TRIP_ID        = :DK-TRIP-ID                22770000
227800            AND  ASGD_END_TMST        = :PC-DEFAULT-TMST          22780000
227900     END-EXEC.                                                    22790000
228000                                                                  22800000
228100     EVALUATE TRUE                                                22810000
228200         WHEN SQLCODE = +0                                        22820000
228300         WHEN SQLCODE = -811                                      22830000
228400              SET PS-TRIP-FOUND-YES TO TRUE                       22840000
228500              MOVE SUT00110-DOOR-ID TO PV-DOOR-ID                 22850000
228600         WHEN SQLCODE = +100                                      22860000
228700              SET PS-TRIP-FOUND-NO  TO TRUE                       22870000
228800              MOVE SPACES           TO PV-DOOR-ID                 22880000
228900         WHEN SQLWARN0 NOT = SPACES                               22890000
229000         WHEN SQLCODE < +0                                        22900000
229100         WHEN SQLCODE > +0                                        22910000
229200             MOVE '5405-COUNT-TRIP-ASSIGNMENTS '                  22920000
229300                                       TO DP013-PARAGRAPH         22930000
229400             MOVE 'CAN"T READ ROW                 '               22940000
229500                                 TO DP013-MESSAGE-TEXT (1)        22950000
229600             MOVE SQLCA      TO DP013-SQLCA                       22960000
229700             MOVE 'SUT_PNA_TRIP_ASGMT'  TO                        22970000
229800                                DP013-DB2-TABLE-NAME (1)          22980000
229900             SET DP013-DB2-ABEND                                  22990000
230000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               23000000
230100             PERFORM DP013-0000-PROCESS-ABEND                     23010000
230200     END-EVALUATE.                                                23020000
230300                                                                  23030000
230400*----------------------------------------------------------------*23040000
230500*                                                                *23050000
230600*----------------------------------------------------------------*23060000
230700 5500-SELECT-TVHTRIP.                                             23070000
230710                                                                  23071019
230800                                                                  23080000
230900     MOVE ASC-TRIP-ID-N    TO DK-TRIP-ID.                         23090000
231000                                                                  23100000
232500     EXEC SQL                                                     23250000
232600         SELECT                                                   23260000
232700                 B.OPER_UNT_ID                                    23270000
232800               , A.OWNER_SCAC_ID                                  23280000
232900               , A.VEH_NBR                                        23290000
233000               , B.TRIP_STATUS_CDE                                23300000
233100          INTO   :TRIPST-OPER-UNT-ID                              23310000
233200               , :VHTRIP-OWNER-SCAC-ID                            23320000
233300               , :VHTRIP-VEH-NBR :PV-NULL-IND                     23330000
233400               , :TRIPST-TRIP-STATUS-CDE                          23340000
233500          FROM   TVHTRIP A                                        23350000
233600                ,TTRIPST B                                        23360000
233700          WHERE A.TRIP_ID = :DK-TRIP-ID                           23370000
233800            AND A.TRIP_ID = B.TRIP_ID                             23380000
233900            AND B.STATUS_DTE =                                    23390000
234000                  (SELECT MAX(D.STATUS_DTE)                       23400000
234100                     FROM TTRIPST D                               23410000
234200                    WHERE D.TRIP_ID       = B.TRIP_ID)            23420000
234300            AND B.STATUS_TME =                                    23430000
234400                  (SELECT MAX(E.STATUS_TME)                       23440000
234500                     FROM TTRIPST E                               23450000
234600                    WHERE E.TRIP_ID       = B.TRIP_ID             23460000
234700                      AND B.STATUS_DTE    = E.STATUS_DTE)         23470000
234800     END-EXEC.                                                    23480000
234900                                                                  23490000
235000     EVALUATE TRUE                                                23500000
235100         WHEN SQLCODE = +0                                        23510000
235200              IF ASC-OPER-UNT-ID NOT = TRIPST-OPER-UNT-ID         23520000
235300                 SET PS-ERROR                                     23530000
235400                     DP020-MSG-FATAL         TO TRUE              23540000
235500                 MOVE PC-TSYMSG-02999        TO DP020-MSG-NUMBER  23550000
235600                 MOVE DP015-UNP-ALP-BRT-OFF  TO ATRIPIDA          23560000
235700                 MOVE DP015-RED              TO ATRIPIDC          23570000
235800                 MOVE DP015-REVERSE          TO ATRIPIDH          23580000
235900                 MOVE -1                     TO ATRIPIDL          23590000
236000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              23600000
236100              ELSE                                                23610000
236200              IF  PV-NULL-IND    =  -1                            23620000
236300                 SET PS-ERROR                                     23630000
236400                     DP020-MSG-FATAL         TO TRUE              23640000
236500                 MOVE PC-TSYMSG-00743        TO DP020-MSG-NUMBER  23650000
236600                 MOVE DP015-UNP-ALP-BRT-OFF  TO ATRIPIDA          23660000
236700                 MOVE DP015-RED              TO ATRIPIDC          23670000
236800                 MOVE DP015-REVERSE          TO ATRIPIDH          23680000
236900                 MOVE -1                     TO ATRIPIDL          23690000
237000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              23700000
237100              ELSE                                                23710000
237200              IF  TRIPST-TRIP-STATUS-CDE  = 'EN'                  23720000
237300                 SET PS-ERROR                                     23730000
237400                     DP020-MSG-FATAL         TO TRUE              23740000
237500                 MOVE PC-TSYMSG-03664        TO DP020-MSG-NUMBER  23750000
237600                 MOVE DP015-UNP-ALP-BRT-OFF  TO ATRIPIDA          23760000
237700                 MOVE DP015-RED              TO ATRIPIDC          23770000
237800                 MOVE DP015-REVERSE          TO ATRIPIDH          23780000
237900                 MOVE -1                     TO ATRIPIDL          23790000
238000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              23800000
238100              END-IF                                              23810000
238200              END-IF                                              23820000
238300              END-IF                                              23830000
238400                                                                  23840000
238500         WHEN SQLCODE = +100                                      23850000
238600              SET PS-ERROR                                        23860000
238700                  DP020-MSG-FATAL         TO TRUE                 23870000
238800              MOVE PC-TSYMSG-00743        TO DP020-MSG-NUMBER     23880000
238900              MOVE DP015-UNP-ALP-BRT-OFF  TO ATRIPIDA             23890000
239000              MOVE DP015-RED              TO ATRIPIDC             23900000
239100              MOVE DP015-REVERSE          TO ATRIPIDH             23910000
239200              MOVE -1                     TO ATRIPIDL             23920000
239300              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 23930000
239400         WHEN SQLWARN0 NOT = SPACES                               23940000
239500         WHEN SQLCODE < +0                                        23950000
239600         WHEN SQLCODE > +0                                        23960000
239700             MOVE '5500-SELECT-TVHTRIP         '                  23970000
239800                                       TO DP013-PARAGRAPH         23980000
239900             MOVE 'CAN"T READ ROW                 '               23990000
240000                                 TO DP013-MESSAGE-TEXT (1)        24000000
240100             MOVE SQLCA      TO DP013-SQLCA                       24010000
240200             MOVE 'TVHTRIP           '  TO                        24020000
240300                                DP013-DB2-TABLE-NAME (1)          24030000
240400             SET DP013-DB2-ABEND                                  24040000
240500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               24050000
240600             PERFORM DP013-0000-PROCESS-ABEND                     24060000
240700     END-EVALUATE.                                                24070000
240800                                                                  24080000
240900 9000-SYNCPOINT.                                                  24090000
241000     EXEC CICS                                                    24100000
241100         SYNCPOINT                                                24110000
241200     END-EXEC.                                                    24120000
241300                                                                  24130000
241400                                                                  24140000
241500*----------------------------------------------------------------*24150000
241600* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *24160000
241700*----------------------------------------------------------------*24170000
241800 9100-READ-SEL-QUEUE.                                             24180000
241900     EXEC CICS                                                    24190000
242000         READQ TS                                                 24200000
242100             QUEUE (ASC-SEL-QUEUE-NAME)                           24210000
242200             INTO  (SU088-SELECT-RECORD)                          24220000
242300             ITEM  (ASC-SEL-ITEM)                                 24230000
242400             RESP  (PV-CICS-RESPONSE)                             24240000
242500     END-EXEC.                                                    24250000
242600                                                                  24260000
242700     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       24270000
242800         CONTINUE                                                 24280000
242900     ELSE                                                         24290000
243000         SET DP013-LOGIC-ABEND                                    24300000
243100             DP013-NO-ROLLBACK     TO TRUE                        24310000
243200         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            24320000
243300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   24330000
243400                                   TO DP013-MESSAGE-TEXT (1)      24340000
243500         PERFORM DP013-0000-PROCESS-ABEND                         24350000
243600     END-IF.                                                      24360000
243700                                                                  24370000
243800*----------------------------------------------------------------*24380000
243900* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *24390000
244000*----------------------------------------------------------------*24400000
244100 9200-REWRITE-SEL-QUEUE.                                          24410000
244200     EXEC CICS                                                    24420000
244300          WRITEQ TS                                               24430000
244400              QUEUE  (ASC-SEL-QUEUE-NAME)                         24440000
244500              FROM   (SU088-SELECT-RECORD)                        24450000
244600              ITEM   (ASC-SEL-ITEM)                               24460000
244700              RESP   (PV-CICS-RESPONSE)                           24470000
244800              REWRITE                                             24480000
244900     END-EXEC.                                                    24490000
245000                                                                  24500000
245100     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   24510000
245200         SET DP013-CICS-ABEND                                     24520000
245300             DP013-NO-ROLLBACK     TO TRUE                        24530000
245400         MOVE '9200-REWRITE-SEL-QUEUE'  TO DP013-PARAGRAPH        24540000
245500         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   24550000
245600                                   TO DP013-MESSAGE-TEXT (1)      24560000
245700         PERFORM DP013-0000-PROCESS-ABEND                         24570000
245800     END-IF.                                                      24580000
245900                                                                  24590000
246000     COPY DPPD013.                                                24600000
246100*----------------------------------------------------------------*24610000
246200*    ABEND PROCESSOR MODULE                                      *24620000
246300*----------------------------------------------------------------*24630000
