000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*-----------------------*                                         00030001
000400 PROGRAM-ID.    PCKCS112.                                         00040001
000500 AUTHOR.        ANNE YEKO.                                        00050001
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060001
000700 DATE-WRITTEN.  03-08-93.                                         00070001
000800 DATE-COMPILED.                                                   00080001
000900                                                                  00090001
001000*----------------------------------------------------------------*00100001
001100*    E112 - HEADER LABEL REQUEST                                 *00110001
001200*                                                                *00120001
001300*    THIS PROGRAM ALLOWS THE USER TO ENTER CRITERIA ABOUT A      *00130001
001400*    HEADER LABEL.  WHEN THE "CARTON" PF KEY IS DEPRESSED, THE   *00140001
001500*    PROGRAM WILL PASS THE INFORMATION ON TO THE CARTON LABEL    *00150001
001600*    PROGRAM.  IF THE "HEADER" PF KEY IS DEPRESSED, ONLY THE     *00160001
001700*                                                                *00170001
001800*    04/12/94 ST  CONVERTED FROM IMS TO DB2                      *00180001
001900*                                                                *00190001
002000*    05/27/94 MS  ADD OPERATING UNIT AND FACILITY                *00200001
002100*                                                                *00210001
002110*    12/10/99     CHANGE TO USE TCP/IP SOCKETS                   *00211042
002120*                                                                *00212043
002130*                                                                *00213043
002140*----------------------------------------------------------------*00214043
002141*  CHANGED 10/13/2014    BY COGNIZANT       WR: CHG0094517        00214153
002142*                                                                 00214254
002143* EXTENDED PO# FROM 7 TO 8 DIGITS WHERE NEEDED.                   00214354
002144*-----------------------------------------------------------------00214454
002146* DATE  11/04/2021                                                00214655
002147*            - CHANGE CALL OF 'DPKUT100' TO                     * 00214755
002148*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00214855
002149*              MAKING THE CALL DYNAMIC VS STATIC                * 00214955
002150*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00215056
1122RM*---------------------------------------------------------------- 00215157
1122RM* DATE  11/07/2022                                              * 00215257
1122RM*            - ADD COPYBOOK DPWS930                             * 00215357
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00215457
1122RM*              DYNAMIC.                                         * 00215557
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00215657
002152*---------------------------------------------------------------- 00215757
002153                                                                  00215857
002160 ENVIRONMENT DIVISION.                                            00216043
002170                                                                  00217043
002180 DATA DIVISION.                                                   00218043
002190                                                                  00219043
002200 WORKING-STORAGE SECTION.                                         00220043
002300                                                                  00230043
002400 01  PC-PROGRAM-CONSTANTS.                                        00240043
002500     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'PC112A  '.  00250043
002600     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'PCKM112 '.  00260043
002700     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'PCKCS112'.  00270043
002800     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00280043
002900                                              COMP.               00290043
003000     05  PC-LABEL-FORMAT          PIC  9(03)  VALUE  1.           00300043
003100     05  PC-PROCESS-AREA          PIC  X(02)  VALUE  'P '.        00310043
003200     05  PC-N                     PIC  X(01)  VALUE  'N'.         00320043
003300     05  PC-Y                     PIC  X(01)  VALUE  'Y'.         00330043
003400     05  PC-A                     PIC  X(01)  VALUE  'A'.         00340043
003500     05  PC-01                    PIC  X(02)  VALUE  '01'.        00350043
003600     05  PC-1                     PIC  X(01)  VALUE  '1'.         00360043
003700     05  PC-2                     PIC  X(01)  VALUE  '2'.         00370043
003800     05  PC-3                     PIC  X(01)  VALUE  '3'.         00380043
003900     05  PC-4                     PIC  X(01)  VALUE  '4'.         00390043
004000     05  PC-5                     PIC  X(01)  VALUE  '5'.         00400043
004100     05  PC-DASH                  PIC  X(01)  VALUE  '-'.         00410043
004200     05  PC-MULTIPLE-SHIPMENTS    PIC  X(18)  VALUE               00420043
004300         'MULTIPLE SHIPMENTS'.                                    00430043
004400     05  PC-ON-HANGER             PIC  X(09)  VALUE               00440043
004500         'ON HANGER'.                                             00450043
004600     05  PC-PACKED-BY-STORE       PIC  X(15)  VALUE               00460043
004700         'PACKED BY STORE'.                                       00470043
004800     05  PC-PRE-TICKETED          PIC  X(15)  VALUE               00480043
004900         'PRE TICKETED   '.                                       00490043
005000     05  PC-HOT                   PIC  X(08)  VALUE 'HOT     '.   00500043
005100     05  PC-PICTURED              PIC  X(08)  VALUE 'PICTURED'.   00510043
005200     05  PC-AD-PREP               PIC  X(08)  VALUE 'AD PREP '.   00520043
005300     05  PC-RAIN-CHECK            PIC  X(08)  VALUE 'RAIN CHK'.   00530043
005400     05  PC-CUST-ORDER            PIC  X(08)  VALUE 'CUST ORD'.   00540043
005500     05  PC-DETAIL-CHECK          PIC  X(12)  VALUE               00550043
005600         'DETAIL CHECK'.                                          00560043
005700     05  PC-0085                  PIC S9(04)  COMP VALUE 85.      00570043
005800     05  PC-0001                  PIC S9(04)  COMP VALUE 1.       00580043
005900     05  PC-90                    PIC  X(02)  VALUE '90'.         00590043
006000     05  PC-OPER-UNT-ID           PIC S9(04)  VALUE +0 COMP.      00600043
006100     05  PC-FCLTY-ID              PIC S9(04)  VALUE +0 COMP.      00610043
006200     05  PC-PRTR-VALIDATION-PGM   PIC  X(08)  VALUE 'DPKCS060'.   00620043
006300                                                                  00630043
006400     05  PC-TSYMSG-NUMBERS.                                       00640043
006500         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00650043
006600*            INVALID VALUE                                        00660043
006700         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00670043
006800*            REQUIRED ENTRY                                       00680043
006900         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00690043
007000*            MUST BE NUMERIC                                      00700043
007100         10  PC-TSYMSG-00009      PIC  9(05)  VALUE  00008.       00710043
007200*            INVALID DATE                                         00720043
007300         10  PC-TSYMSG-00083      PIC  9(05)  VALUE  00083.       00730043
007400*            PO NOT FOUND                                         00740043
007500         10  PC-TSYMSG-00098      PIC  9(05)  VALUE  00098.       00750043
007600*            PRINT SUCCESSFUL                                     00760043
007700         10  PC-TSYMSG-00746      PIC  9(05)  VALUE  00746.       00770043
007710*            INVALID PRINTER DESTINATION                          00771043
007720         10  PC-TSYMSG-02122      PIC  9(05)  VALUE  02122.       00772043
007730*            SOCKET ERROR                                         00773043
007740                                                                  00774043
007750 01  PM-PROGRAM-MESSAGES.                                         00775043
007760     05  PM-PROGRAM-MESSAGE-1.                                    00776043
007770         10  PM-RET-CDE           PIC  X(02)  VALUE SPACES.       00777043
007780         10  FILLER               PIC  X(01)  VALUE '-'.          00778043
007790         10  PM-RET-MSG           PIC  X(25)  VALUE SPACES.       00779043
007800         10  FILLER               PIC  X(48)  VALUE SPACES.       00780043
007900 01  PS-PROGRAM-SWITCHES.                                         00790043
008000     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00800043
008100         88  PS-ERROR                         VALUE  'Y'.         00810043
008200         88  PS-NO-ERROR                      VALUE  'N'.         00820043
008300     05  PS-PO-FOUND-SW           PIC  X(01)  VALUE  'Y'.         00830043
008400         88  PS-PO-FOUND                      VALUE  'Y'.         00840043
008500         88  PS-PO-NOT-FOUND                  VALUE  'N'.         00850043
008600     05  PS-TICKET-TYPE-SW        PIC  X(01)  VALUE  'N'.         00860043
008700         88  PS-TICKET-TYPE-VALID             VALUE  'Y'.         00870043
008800         88  PS-TICKET-TYPE-INVALID           VALUE  'N'.         00880043
008900     05  FACILITY-EDIT-SW         PIC  X(01)  VALUE  ' '.         00890043
009000         88  ERROR-ON-FACILITY-EDIT           VALUE  ' '.         00900043
009100         88  NO-ERROR-ON-FACILITY-EDIT        VALUE  'X'.         00910043
009200     05  OP-UNIT-EDIT-SW          PIC  X(01)  VALUE  ' '.         00920043
009300         88  ERROR-ON-OP-UNIT-EDIT            VALUE  ' '.         00930043
009400         88  NO-ERROR-ON-OP-UNIT-EDIT         VALUE  'X'.         00940043
009500     05  PRINTER-EDIT-SW          PIC  X(01)  VALUE  ' '.         00950043
009600         88  ERROR-ON-PRINTER-EDIT            VALUE  ' '.         00960043
009700         88  NO-ERROR-ON-PRINTER-EDIT         VALUE  'X'.         00970043
009800                                                                  00980043
009900 01  PV-PROGRAM-VARIABLES.                                        00990043
010000     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01000043
010100                                              COMP SYNC.          01010043
010200     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01020043
010300                                              COMP SYNC.          01030043
010400     05  PV-SHIPMENT-COUNT        PIC S9(04)  VALUE +0            01040043
010500                                              COMP.               01050043
010600     05  PV-PRINTER-ID            PIC S9(04)  VALUE +0            01060043
010700                                              COMP.               01070043
010800     05  PV-OPER-UNT-ID           PIC S9(04)  VALUE +0            01080043
010900                                              COMP.               01090043
011000     05  PV-FCLTY-ID              PIC S9(04)  VALUE +0            01100043
011100                                              COMP.               01110043
011200     05  PV-QUOTIENT              PIC 9(02)   VALUE ZERO          01120043
011300                                              COMP.               01130043
011400     05  PV-REMAIN                PIC 9(02)   VALUE ZERO          01140043
011500                                              COMP.               01150043
011600     05  PV-COMMAREA-LENGTH       PIC S9(04)  VALUE +0            01160043
011700                                              COMP.               01170043
011800     05  PV-RCVR-SEQ-NBR          PIC S9(3)   VALUE +0            01180043
011900                                              COMP.               01190043
012000     05  PV-PO-NBR                PIC S9(8)   VALUE +0            01200054
012100                                              COMP.               01210043
012200     05  PV-PO-LINE-NBR           PIC S9(7)   VALUE +0            01220043
012300                                              COMP.               01230043
012400                                                                  01240043
012500     05  PV-RECEIVER.                                             01250043
012600         10  PV-RCVR-PO               PIC 9(08)   VALUE ZEROS.    01260043
012700         10  PV-RCVR-SEQ              PIC 9(03)   VALUE ZEROS.    01270043
012800                                                                  01280043
012900     05  PV-FORMAT-DATE.                                          01290043
013000         10  PV-MM                PIC X(02)   VALUE SPACES.       01300043
013100         10  FILLER               PIC X(01)   VALUE '-'.          01310043
013200         10  PV-DD                PIC X(02)   VALUE SPACES.       01320043
013300         10  FILLER               PIC X(01)   VALUE '-'.          01330043
013400         10  PV-YY                PIC X(02)   VALUE SPACES.       01340043
013500     05  PV-KEY-DEPT              PIC X(03)   VALUE SPACES.       01350043
013600     05  PV-KEY-CLASS             PIC X(02)   VALUE SPACES.       01360043
013700     05  PV-CCYYMMDD              PIC X(10)   VALUE SPACES.       01370043
013800     05  PV-CCYYMMDD-REFORMAT.                                    01380043
013900         10  PV-CCYYMMDD-CC       PIC X(02).                      01390043
014000         10  PV-CCYYMMDD-YY       PIC X(02).                      01400043
014100         10  FILLER               PIC X(01).                      01410043
014200         10  PV-CCYYMMDD-MM       PIC X(02).                      01420043
014300         10  FILLER               PIC X(01).                      01430043
014400         10  PV-CCYYMMDD-DD       PIC X(02).                      01440043
014500     05  PV-AD-CCYYMMDD.                                          01450043
014600         10  PV-AD-CC             PIC X(02)   VALUE SPACES.       01460043
014700         10  PV-AD-YY             PIC X(02)   VALUE SPACES.       01470043
014800         10  FILLER               PIC X(01)   VALUE SPACES.       01480043
014900         10  PV-AD-MM             PIC X(02)   VALUE SPACES.       01490043
015000         10  FILLER               PIC X(01)   VALUE SPACES.       01500043
015100         10  PV-AD-DD             PIC X(02)   VALUE SPACES.       01510043
015200     05  PV-TKT-FMT-ID-NULL       PIC S9(4)   VALUE +0 COMP.      01520043
015300     05  PV-TKT-FMT-ID            PIC X(6)    VALUE SPACES.       01530043
015400     05  PV-EST-AR-TMST-NULL      PIC S9(4)   VALUE +0 COMP.      01540043
015500     05  PV-COUNT                 PIC S9(04)  VALUE +0            01550043
015600                                              COMP.               01560043
015700     05  PV-DISPLAY-ORD-NBR       PIC 9(07)   VALUE 0.            01570043
015800     05  PV-PICX-FOUR             PIC X(04)   VALUE SPACES.       01580043
015900     05  PV-PIC9-FOUR REDEFINES                                   01590043
016000         PV-PICX-FOUR             PIC 9(04).                      01600043
016100     05  PV-SUPPRESS-FOUR         PIC ZZZ9.                       01610043
016200     05 PV-DC-5-CHAR-ABBR            PIC X(05) VALUE SPACES.      01620043
016300     05 PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.          01630043
016400         10 FILLER                   PIC  X(03).                  01640043
016500         10 PV-2-DIGIT-DC-ABBR       PIC  X(02).                  01650043
016600                                                                  01660043
016700                                                                  01670043
016710 EJECT                                                            01671043
016720*----------------------------------------------------------------*01672043
016721*  SENDING/RECEIVING AREA FOR THE                                *01672143
016722*  PRINTER VALIDATION ROUTING (DPKCS060)                         *01672243
016723*----------------------------------------------------------------*01672343
016724     COPY DPWS072.                                                01672443
016725                                                                  01672543
016726 EJECT                                                            01672643
016727*----------------------------------------------------------------*01672743
016728*    CALLING PARMS USED TO COMMUNICATE TO ARCH PROGRAM DPKCS030  *01672843
016729*----------------------------------------------------------------*01672943
016730     COPY DPWS030.                                                01673043
1122RM     COPY DPWS930.                                                01673157
                                                                        01674057
016750 EJECT                                                            01675043
016760*----------------------------------------------------------------*01676043
016770*    NUMERIC EDIT COPYBOOK                                       *01677043
016780*----------------------------------------------------------------*01678043
016790     COPY DPWS010I.                                               01679043
016800                                                                  01680043
016900 EJECT                                                            01690043
017000*----------------------------------------------------------------*01700043
017100*    DATE VALIDATION COPYBOOK                                    *01710043
017200*----------------------------------------------------------------*01720043
017300     COPY DPWS500.                                                01730043
017400                                                                  01740043
017500 EJECT                                                            01750043
017600*----------------------------------------------------------------*01760043
017700*    STANDARD COMMAREA.                                          *01770043
017800*----------------------------------------------------------------*01780043
017900                                                                  01790043
018000     COPY DPWS020.                                                01800043
018100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01810043
018200                                                                  01820043
018300*----------------------------------------------------------------*01830043
018400*    INTER-APPLICATION COMMAREA.                                 *01840043
018500*----------------------------------------------------------------*01850043
018600                                                                  01860043
018700         10  INTER-APPL-COMM-AREA PIC X(200).                     01870043
018800     COPY PCWS014.                                                01880043
018900*----------------------------------------------------------------*01890043
019000*    SPECIFIC COMMMAREA FOR PCKCS112.                            *01900043
019100*----------------------------------------------------------------*01910043
019200         10  ASC-SPECIFIC-COMMAREA.                               01920043
019300             15  ASC-ADD-COMPLETE-SW         PIC  X(01).          01930043
019400                 88  ASC-ADD-COMPLETE                   VALUE 'Y'.01940043
019500                 88  ASC-ADD-PENDING                    VALUE 'N'.01950043
019600             15  ASC-PRTR-ID.                                     01960043
019700                 20  ASC-PRTR-ID-N           PIC  9(03).          01970043
019800             15  ASC-PRTR-DESC               PIC  X(25).          01980043
019900             15  FILLER                      PIC  X(08).          01990043
020000             15  ASC-PRC-AREA                PIC  X(06).          02000043
020100             15  ASC-PRC-AREA-CDE            PIC  X(03).          02010043
020200             15  ASC-CART-CT                 PIC  X(04).          02020043
020300             15  ASC-CART-CT-N     REDEFINES                      02030043
020400                 ASC-CART-CT                 PIC  9(04).          02040043
020500             15  ASC-PO-NBR-OLD              PIC  X(08).          02050043
020600             15  ASC-RCVR-SEQ-NBR-OLD        PIC  X(03).          02060043
020700             15  ASC-PO-NBR                  PIC  X(08).          02070043
020800             15  ASC-PO-NBR-N  REDEFINES                          02080043
020900                 ASC-PO-NBR                  PIC  9(08).          02090043
021000             15  ASC-RCVR-SEQ-NBR            PIC  X(03).          02100043
021100             15  ASC-RCVR-SEQ-NBR-N  REDEFINES                    02110043
021200                 ASC-RCVR-SEQ-NBR            PIC  9(03).          02120043
021300             15  ASC-RCVD-DATE.                                   02130043
021400                 20  ASC-RCVD-MM             PIC  X(02).          02140043
021500                 20  ASC-RCVD-MM-N  REDEFINES                     02150043
021600                     ASC-RCVD-MM             PIC  9(02).          02160043
021700                 20  ASC-RCVD-DD             PIC  X(02).          02170043
021800                 20  ASC-RCVD-DD-N  REDEFINES                     02180043
021900                     ASC-RCVD-DD             PIC  9(02).          02190043
022000                 20  ASC-RCVD-YY             PIC  X(02).          02200043
022100                 20  ASC-RCVD-YY-N  REDEFINES                     02210043
022200                     ASC-RCVD-YY             PIC  9(02).          02220043
022300             15  ASC-RCVD-DESC               PIC  X(07).          02230043
022400             15  ASC-VEND-NAME               PIC  X(25).          02240043
022500             15  ASC-AD-DATE.                                     02250043
022600                 20  ASC-AD-MM               PIC  X(02).          02260043
022700                 20  ASC-AD-MM-N  REDEFINES                       02270043
022800                     ASC-AD-MM               PIC  9(02).          02280043
022900                 20  ASC-AD-DD               PIC  X(02).          02290043
023000                 20  ASC-AD-DD-N  REDEFINES                       02300043
023100                     ASC-AD-DD               PIC  9(02).          02310043
023200                 20  ASC-AD-YY               PIC  X(02).          02320043
023300                 20  ASC-AD-YY-N  REDEFINES                       02330043
023400                     ASC-AD-YY               PIC  9(02).          02340043
023500             15  ASC-PIC-INFO                PIC  X(08).          02350043
023600             15  ASC-SPECIAL-INST            PIC  X(25).          02360043
023700             15  ASC-MULT-SHIP               PIC  X(01).          02370043
023800             15  ASC-PRE-TKT                 PIC  X(01).          02380043
023900             15  ASC-PACKED-BY-STR           PIC  X(01).          02390043
024000             15  ASC-TICKET-TYPE             PIC  X(06).          02400043
024100             15  ASC-DETAIL-CHECK            PIC  X(01).          02410043
024200             15  ASC-GARMENT-ON-HANGER       PIC  X(01).          02420043
024300             15  ASC-DEPT                    PIC  X(03).          02430043
024400             15  ASC-CLASS                   PIC X(02).           02440043
024500             15  ASC-OPER-UNT-ID             PIC X(04).           02450043
024600             15  ASC-OPER-UNT-ID-N REDEFINES                      02460043
024700                 ASC-OPER-UNT-ID             PIC 9(04).           02470043
024800             15  ASC-FCLTY-ID                PIC X(04).           02480043
024900             15  ASC-FCLTY-ID-N       REDEFINES                   02490043
025000                 ASC-FCLTY-ID                PIC 9(04).           02500043
025100             15  ASC-OP-UNIT-NAME            PIC X(24).           02510043
025200             15  ASC-TRIP-ID                 PIC S9(9).           02520043
025300     EJECT                                                        02530043
025400*----------------------------------------------------------------*02540043
025500*    CARTON LABEL COPYBOOK  (SOCKETS)                            *02550043
025600*----------------------------------------------------------------*02560043
025700                                                                  02570043
025800     COPY PCWS140.                                                02580043
025900*----------------------------------------------------------------*02590043
026000*    ABEND PROCESSING COPYBOOK.                                  *02600043
026100*----------------------------------------------------------------*02610043
026200                                                                  02620043
026300     COPY DPWS013.                                                02630043
026400                                                                  02640043
026500     EJECT                                                        02650043
026600*----------------------------------------------------------------*02660043
026700*    ATTRIBUTE SETTINGS COPYBOOK.                                *02670043
026800*----------------------------------------------------------------*02680043
026900                                                                  02690043
027000     COPY DPWS015.                                                02700043
027100                                                                  02710043
027200*----------------------------------------------------------------*02720043
027300*    FUNCTION KEYS COPYBOOK                                      *02730043
027400*----------------------------------------------------------------*02740043
027500                                                                  02750043
027600     COPY DPWS016.                                                02760043
027700                                                                  02770043
027800*----------------------------------------------------------------*02780043
027900*    MAP LAYOUT                                                  *02790043
028000*----------------------------------------------------------------*02800043
028100                                                                  02810043
028200     COPY PCKM112.                                                02820043
028300                                                                  02830043
028400 EJECT                                                            02840043
028500*---------------------------------------------------------------* 02850043
028600*    DB2 AREA FOR RECEIVER TABLE                                * 02860043
028700*---------------------------------------------------------------* 02870043
028800     EXEC SQL                                                     02880043
028900          INCLUDE TRECEIV                                         02890043
029000     END-EXEC.                                                    02900043
029100                                                                  02910043
029200/                                                                 02920043
029300     EXEC SQL                                                     02930043
029400          INCLUDE TSHPTPO                                         02940043
029500     END-EXEC.                                                    02950043
029600/                                                                 02960043
029700     EXEC SQL                                                     02970043
029800          INCLUDE TVHTRIP                                         02980043
029900     END-EXEC.                                                    02990043
030000/                                                                 03000043
030100     EXEC SQL                                                     03010043
030200          INCLUDE TSHIPMT                                         03020043
030300     END-EXEC.                                                    03030043
030400/                                                                 03040043
030500*---------------------------------------------------------------* 03050043
030600*    DB2 AREA FOR PURCHASE ORDER TABLE                          * 03060043
030700*---------------------------------------------------------------* 03070043
030800     EXEC SQL                                                     03080043
030900          INCLUDE TPURCHS                                         03090043
031000     END-EXEC.                                                    03100043
031100                                                                  03110043
031200/                                                                 03120043
031300*---------------------------------------------------------------* 03130043
031400*    DB2 AREA FOR PURCHASE ORDER ITEM TABLE                     * 03140043
031500*---------------------------------------------------------------* 03150043
031600     EXEC SQL                                                     03160043
031700          INCLUDE TPURITM                                         03170043
031800     END-EXEC.                                                    03180043
031900                                                                  03190043
032000/                                                                 03200043
032100*---------------------------------------------------------------* 03210043
032200*    DB2 DCLGEN FOR THE PO PURCHASE INSTRUCTION                 * 03220043
032300*---------------------------------------------------------------* 03230043
032400     EXEC SQL                                                     03240043
032500          INCLUDE TPOINST                                         03250043
032600     END-EXEC.                                                    03260043
032700/                                                                 03270043
032800*---------------------------------------------------------------* 03280043
032900*    DB2 DCLGEN FOR THE INSTRUCTION CODE TABLE                  * 03290043
033000*---------------------------------------------------------------* 03300043
033100     EXEC SQL                                                     03310043
033200          INCLUDE TINSTCD                                         03320043
033300     END-EXEC.                                                    03330043
033400/                                                                 03340043
033500*---------------------------------------------------------------* 03350043
033600*    DB2 AREA FOR THE ENTERPRISE TABLE                          * 03360043
033700*---------------------------------------------------------------* 03370043
033800     EXEC SQL                                                     03380043
033900          INCLUDE TEXTENT                                         03390043
034000     END-EXEC.                                                    03400043
034100                                                                  03410043
034200/                                                                 03420043
034300*---------------------------------------------------------------* 03430043
034400*    DB2 AREA FOR THE ENTERPRISE NAME TABLE                     * 03440043
034500*---------------------------------------------------------------* 03450043
034600     EXEC SQL                                                     03460043
034700          INCLUDE TENTNME                                         03470043
034800     END-EXEC.                                                    03480043
034900                                                                  03490043
035000/                                                                 03500043
035100*---------------------------------------------------------------* 03510043
035200*    DB2 AREA FOR THE LABEL PARAMETER TABLE                     * 03520043
035300*---------------------------------------------------------------* 03530043
035400                                                                  03540043
035500     EXEC SQL                                                     03550043
035600          INCLUDE TPCLABL                                         03560043
035700     END-EXEC.                                                    03570043
035800                                                                  03580043
035900*---------------------------------------------------------------* 03590043
036000*    DB2 AREA FOR THE TICKET FORMAT TABLE                       * 03600043
036100*---------------------------------------------------------------* 03610043
036200                                                                  03620043
036300     EXEC SQL                                                     03630043
036400          INCLUDE TTKTFMT                                         03640043
036500     END-EXEC.                                                    03650043
036600                                                                  03660043
036700*----------------------------------------------------------------*03670043
036800*    DB2 AREA FOR OPERATION SET TABLE                            *03680043
036900*----------------------------------------------------------------*03690043
037000                                                                  03700043
037100     EXEC SQL                                                     03710043
037200          INCLUDE TOPRSET                                         03720043
037300     END-EXEC.                                                    03730043
037400/                                                                 03740043
037500*----------------------------------------------------------------*03750043
037600*    DB2 AREA FOR WORK ORDER TABLE                               *03760043
037700*----------------------------------------------------------------*03770043
037800                                                                  03780043
037900     EXEC SQL                                                     03790043
038000          INCLUDE TWRKORD                                         03800043
038100     END-EXEC.                                                    03810043
038200/                                                                 03820043
039100*----------------------------------------------------------------*03910044
039200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR LOGISTICS DOMAIN       03920044
039300*  LOCATION MASTER TABLE (XLT_LOC)                                03930044
039400*----------------------------------------------------------------*03940044
039500     EXEC SQL                                                     03950044
039600          INCLUDE XLT00010                                        03960044
039700     END-EXEC.                                                    03970044
039710                                                                  03971044
039730*----------------------------------------------------------------*03973044
039800*    DB2 AREA FOR COMMUNICATIONS                                  03980043
039810*----------------------------------------------------------------*03981044
039900                                                                  03990043
040000     EXEC SQL                                                     04000043
040100          INCLUDE SQLCA                                           04010043
040200     END-EXEC.                                                    04020043
040300                                                                  04030043
040400 EJECT                                                            04040043
040500 LINKAGE SECTION.                                                 04050043
040600                                                                  04060043
040700 01  DFHCOMMAREA.                                                 04070043
040800     05  FILLER                         OCCURS  1 TO 4072 TIMES   04080043
040900                                        DEPENDING ON EIBCALEN.    04090043
041000         10  FILLER                     PIC X.                    04100043
041100                                                                  04110043
041200     EJECT                                                        04120043
041300 PROCEDURE DIVISION.                                              04130043
041400*----------------------------------------------------------------*04140043
041500*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *04150043
041600*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *04160043
041700*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *04170043
041800*                                                                *04180043
041900*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *04190043
042000*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *04200043
042100*----------------------------------------------------------------*04210043
042200 0000-MAIN-MODULE.                                                04220043
042300                                                                  04230043
042400     INITIALIZE DP030-CICS-API-FIELDS.                            04240043
042500                                                                  04250043
042600     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         04260043
042700     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            04270043
042800     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           04280043
042900                                                                  04290043
043000     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         04300043
043100                                                                  04310043
043200     MOVE LENGTH OF PC112AI      TO DP030-MAP-LENGTH (1).         04320043
043300     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       04330043
043400                                                                  04340043
043500     PERFORM 0001-CALL-CICS-ARCH-API.                             04350043
043600                                                                  04360043
043700     PERFORM 1000-CONTROL-PROCESSING.                             04370043
043800                                                                  04380043
043900     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       04390043
044000                                                                  04400043
044100     PERFORM 0001-CALL-CICS-ARCH-API.                             04410043
044200                                                                  04420043
044300                                                                  04430043
044400 0001-CALL-CICS-ARCH-API.                                         04440043
044500                                                                  04450043
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               04460057
1122RM     CALL DP930-CICS-ARCH-API                                     04461057
1122RM                     USING DFHEIBLK                               04462057
044700                           DFHCOMMAREA                            04470043
044800                           DP030-CICS-API-FIELDS                  04480043
044900                           DP020-STANDARD-COMMAREA                04490043
045000                           PC112AI.                               04500043
045100                                                                  04510043
045200     IF  DP030-RC-CALL-SUCCESSFUL                                 04520043
045300         CONTINUE                                                 04530043
045400     ELSE                                                         04540043
045500         SET DP013-NO-ROLLBACK   TO TRUE                          04550043
045600         SET DP013-XCTL-DISPLAY-RESTART                           04560043
045700                                 TO TRUE                          04570043
045800         SET DP013-CICS-ABEND    TO TRUE                          04580043
045900         MOVE 'BEFORE 0000-MAIN-MODULE'                           04590043
046000                                 TO DP013-PARAGRAPH               04600043
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX04610057
1122RM*             'T LINE'           TO DP013-MESSAGE-TEXT (2)        04620057
1122RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04621057
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04622057
046300         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        04630043
046400         PERFORM DP013-0000-PROCESS-ABEND                         04640043
046500     END-IF.                                                      04650043
046600 EJECT                                                            04660043
046700*----------------------------------------------------------------*04670043
046800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04680043
046900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04690043
047000*                                                                *04700043
047100*    PERFORMED BY 0000-MAIN-MODULE.                              *04710043
047200*----------------------------------------------------------------*04720043
047300                                                                  04730043
047400 1000-CONTROL-PROCESSING.                                         04740043
047500                                                                  04750043
047600     EVALUATE TRUE                                                04760043
047700         WHEN DP020-NEXT-ACT-INITIAL                              04770043
047800             INITIALIZE ASC-SPECIFIC-COMMAREA                     04780043
047900             SET ASC-ADD-PENDING TO TRUE                          04790043
048000             MOVE SPACES         TO PC014-PRIOR-SCREEN-SW         04800043
048100             PERFORM 3000-BUILD-INITIAL-PANEL                     04810043
048200                                                                  04820043
048300         WHEN ASC-ADD-COMPLETE                                    04830043
048400         WHEN PC014-PRIOR-SCREEN-CARTON                           04840043
048500             MOVE ASC-PRTR-ID-N  TO PV-PRINTER-ID                 04850043
048600             INITIALIZE ASC-SPECIFIC-COMMAREA                     04860043
048700             MOVE PV-PRINTER-ID  TO ASC-PRTR-ID-N                 04870043
048800             SET ASC-ADD-PENDING TO TRUE                          04880043
048900             MOVE SPACES         TO PC014-PRIOR-SCREEN-SW         04890043
049000             PERFORM 3000-BUILD-INITIAL-PANEL                     04900043
049100                                                                  04910043
049200         WHEN DP020-NEXT-ACT-READ-MAP                             04920043
049300             PERFORM 2000-FKEY-PROCESSING                         04930043
049400                                                                  04940043
049500         WHEN DP020-NEXT-ACT-RETURN                               04950043
049600             PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                 04960043
049700             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   04970043
049800             PERFORM 3200-DISPLAY-PANEL                           04980043
049900                                                                  04990043
050000         WHEN OTHER                                               05000043
050100             SET DP013-LOGIC-ABEND                                05010043
050200                                 TO TRUE                          05020043
050300             SET DP013-NO-ROLLBACK                                05030043
050400                                 TO TRUE                          05040043
050500             MOVE '1000-CONTROL-PROCESSING'                       05050043
050600                                 TO DP013-PARAGRAPH               05060043
050700             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   05070043
050800                                 TO DP013-MESSAGE-TEXT(1)         05080043
050900             MOVE DP020-NEXT-APPL-ACTIVITY                        05090043
051000                                 TO DP013-MESSAGE-TEXT(2)         05100043
051100             PERFORM DP013-0000-PROCESS-ABEND                     05110043
051200     END-EVALUATE.                                                05120043
051300                                                                  05130043
051400*----------------------------------------------------------------*05140043
051500*   DETERMINE THE PROCESSING PATH HERE.                          *05150043
051600*                                                                *05160043
051700*   PERFORMED BY 1000-CONTROL-PROCESSING.                        *05170043
051800*----------------------------------------------------------------*05180043
051900                                                                  05190043
052000 2000-FKEY-PROCESSING.                                            05200043
052100                                                                  05210043
052200     EVALUATE TRUE                                                05220043
052300         WHEN DP020-SRC-AID = DP016-CLEAR                         05230043
052400             PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                 05240043
052500             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   05250043
052600             PERFORM 3200-DISPLAY-PANEL                           05260043
052700                                                                  05270043
052800         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     05280043
052900             MOVE ASC-PRTR-ID-N  TO PV-PRINTER-ID                 05290043
053000             INITIALIZE ASC-SPECIFIC-COMMAREA                     05300043
053100             MOVE PV-PRINTER-ID  TO ASC-PRTR-ID-N                 05310043
053200             PERFORM 3000-BUILD-INITIAL-PANEL                     05320043
053300             PERFORM 2210-RESET-ATTRIBUTES                        05330043
053400             PERFORM 3200-DISPLAY-PANEL                           05340043
053500                                                                  05350043
053600         WHEN DP020-SRC-AID = DP016-ENTER                         05360043
053700             PERFORM 2100-MOVE-SCREEN-TO-COMMAREA                 05370043
053800             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   05380043
053900             PERFORM 3200-DISPLAY-PANEL                           05390043
054000                                                                  05400043
054100         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 05410043
054200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              05420043
054300             PERFORM 2100-MOVE-SCREEN-TO-COMMAREA                 05430043
054400             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   05440043
054500             IF  PS-ERROR                                         05450043
054600                 SET DP030-OVERRIDE-GO                            05460043
054700                                 TO TRUE                          05470043
054800                 PERFORM 3200-DISPLAY-PANEL                       05480043
054900             ELSE                                                 05490043
055000                 SET DP030-CONTINUE-GO                            05500043
055100                                 TO TRUE                          05510043
055200                 PERFORM 4000-SETUP-LABELS                        05520043
055300                 IF PC140-CRA-SUCCESSFUL                          05530043
055400                     SET ASC-ADD-COMPLETE                         05540043
055500                                 TO TRUE                          05550043
055600                     SET DP020-MSG-INFORMATIONAL                  05560043
055700                                 TO TRUE                          05570043
055800                     MOVE ASC-PRTR-ID-N  TO PV-PRINTER-ID         05580043
055900                     INITIALIZE ASC-SPECIFIC-COMMAREA             05590043
056000                     MOVE PV-PRINTER-ID  TO ASC-PRTR-ID-N         05600043
056100                     PERFORM 2300-MOVE-COMMAREA-TO-SCREEN         05610043
056200                     PERFORM 3000-BUILD-INITIAL-PANEL             05620043
056300                 END-IF                                           05630043
056400             END-IF                                               05640043
056500                                                                  05650043
056600         WHEN OTHER                                               05660043
056700             SET DP013-NO-ROLLBACK                                05670043
056800                                 TO TRUE                          05680043
056900             SET DP013-XCTL-DISPLAY-RESTART                       05690043
057000                                 TO TRUE                          05700043
057100             SET DP013-CICS-ABEND                                 05710043
057200                                 TO TRUE                          05720043
057300             MOVE '2000-FKEY-PROCESSING'                          05730043
057400                                 TO DP013-PARAGRAPH               05740043
057500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      05750043
057600                                 TO DP013-MESSAGE-TEXT (1)        05760043
057700             PERFORM DP013-0000-PROCESS-ABEND                     05770043
057800     END-EVALUATE.                                                05780043
057900                                                                  05790043
058000 EJECT                                                            05800043
058100*----------------------------------------------------------------*05810043
058200*    HERE WE SIMPLY MOVE DATA ENTERED ON THE SCREEN TO THE COMM  *05820043
058300*    AREA.                                                       *05830043
058400*                                                                *05840043
058500*    PERFORMED BY 2000-FKEY-PROCESSING.                          *05850043
058600*----------------------------------------------------------------*05860043
058700                                                                  05870043
058800 2100-MOVE-SCREEN-TO-COMMAREA.                                    05880043
058900                                                                  05890043
059000     IF AOPUNITL > ZERO                                           05900043
059100         MOVE AOPUNITI           TO ASC-OPER-UNT-ID               05910043
059200     ELSE                                                         05920043
059300         IF AOPUNITF = DP015-ERASE-EOF                            05930043
059400             MOVE SPACE          TO ASC-OPER-UNT-ID               05940043
059500         END-IF                                                   05950043
059600     END-IF                                                       05960043
059700                                                                  05970043
059800     IF AFACILL  > ZERO                                           05980043
059900         MOVE AFACILI            TO ASC-FCLTY-ID                  05990043
060000     ELSE                                                         06000043
060100         IF AFACILF  = DP015-ERASE-EOF                            06010043
060200             MOVE SPACE          TO ASC-FCLTY-ID                  06020043
060300         END-IF                                                   06030043
060400     END-IF                                                       06040043
060500                                                                  06050043
060600     IF  APRTRL > ZERO                                            06060043
060700         MOVE APRTRI             TO ASC-PRTR-ID                   06070043
060800     ELSE                                                         06080043
060900         IF  APRTRF = DP015-ERASE-EOF                             06090043
061000             MOVE SPACE          TO ASC-PRTR-ID                   06100043
061100         END-IF                                                   06110043
061200     END-IF.                                                      06120043
061300                                                                  06130043
061400     IF  APOL > ZERO                                              06140043
061500         MOVE APOI               TO ASC-PO-NBR                    06150043
061600     ELSE                                                         06160043
061700         IF  APOF = DP015-ERASE-EOF                               06170043
061800             MOVE SPACE          TO ASC-PO-NBR                    06180043
061900         END-IF                                                   06190043
062000     END-IF.                                                      06200043
062100                                                                  06210043
062200     IF  ASEQL > ZERO                                             06220043
062300         MOVE ASEQI              TO ASC-RCVR-SEQ-NBR              06230043
062400     ELSE                                                         06240043
062500         IF  ASEQF = DP015-ERASE-EOF                              06250043
062600             MOVE SPACE          TO ASC-RCVR-SEQ-NBR              06260043
062700         END-IF                                                   06270043
062800     END-IF.                                                      06280043
062900                                                                  06290043
063000     IF  AAREAL > ZERO                                            06300043
063100         MOVE AAREAI             TO ASC-PRC-AREA                  06310043
063200     ELSE                                                         06320043
063300         IF  AAREAF = DP015-ERASE-EOF                             06330043
063400             MOVE SPACE          TO ASC-PRC-AREA                  06340043
063500         END-IF                                                   06350043
063600     END-IF.                                                      06360043
063700                                                                  06370043
063800     IF  ACRTNL > ZERO                                            06380043
063900         MOVE ACRTNI             TO ASC-CART-CT                   06390043
064000     ELSE                                                         06400043
064100         IF  ACRTNF = DP015-ERASE-EOF                             06410043
064200             MOVE SPACE          TO ASC-CART-CT                   06420043
064300         END-IF                                                   06430043
064400     END-IF.                                                      06440043
064500                                                                  06450043
064600     IF  ARCVDMML > ZERO                                          06460043
064700         MOVE ARCVDMMI           TO ASC-RCVD-MM                   06470043
064800     ELSE                                                         06480043
064900         IF  ARCVDMMF = DP015-ERASE-EOF                           06490043
065000             MOVE SPACE          TO ASC-RCVD-MM                   06500043
065100         END-IF                                                   06510043
065200     END-IF.                                                      06520043
065300                                                                  06530043
065400     IF  ARCVDDDL > ZERO                                          06540043
065500         MOVE ARCVDDDI           TO ASC-RCVD-DD                   06550043
065600     ELSE                                                         06560043
065700         IF  ARCVDDDF = DP015-ERASE-EOF                           06570043
065800             MOVE SPACE          TO ASC-RCVD-DD                   06580043
065900         END-IF                                                   06590043
066000     END-IF.                                                      06600043
066100                                                                  06610043
066200     IF  ARCVDYYL > ZERO                                          06620043
066300         MOVE ARCVDYYI           TO ASC-RCVD-YY                   06630043
066400     ELSE                                                         06640043
066500         IF  ARCVDYYF = DP015-ERASE-EOF                           06650043
066600             MOVE SPACE          TO ASC-RCVD-YY                   06660043
066700         END-IF                                                   06670043
066800     END-IF.                                                      06680043
066900                                                                  06690043
067000     IF  AVNDRL > ZERO                                            06700043
067100         MOVE AVNDRI             TO ASC-VEND-NAME                 06710043
067200     ELSE                                                         06720043
067300         IF  AVNDRF = DP015-ERASE-EOF                             06730043
067400             MOVE SPACE          TO ASC-VEND-NAME                 06740043
067500         END-IF                                                   06750043
067600     END-IF.                                                      06760043
067700                                                                  06770043
067800     IF  AADMML > ZERO                                            06780043
067900         MOVE AADMMI             TO ASC-AD-MM                     06790043
068000     ELSE                                                         06800043
068100         IF  AADMMF = DP015-ERASE-EOF                             06810043
068200             MOVE SPACE          TO ASC-AD-MM                     06820043
068300         END-IF                                                   06830043
068400     END-IF.                                                      06840043
068500                                                                  06850043
068600     IF  AADDDL > ZERO                                            06860043
068700         MOVE AADDDI             TO ASC-AD-DD                     06870043
068800     ELSE                                                         06880043
068900         IF  AADDDF = DP015-ERASE-EOF                             06890043
069000             MOVE SPACE          TO ASC-AD-DD                     06900043
069100         END-IF                                                   06910043
069200     END-IF.                                                      06920043
069300                                                                  06930043
069400     IF  AADYYL > ZERO                                            06940043
069500         MOVE AADYYI             TO ASC-AD-YY                     06950043
069600     ELSE                                                         06960043
069700         IF  AADYYF = DP015-ERASE-EOF                             06970043
069800             MOVE SPACE          TO ASC-AD-YY                     06980043
069900         END-IF                                                   06990043
070000     END-IF.                                                      07000043
070100                                                                  07010043
070200     IF  APICL > ZERO                                             07020043
070300         MOVE APICI              TO ASC-PIC-INFO                  07030043
070400     ELSE                                                         07040043
070500         IF  APICF = DP015-ERASE-EOF                              07050043
070600             MOVE SPACE          TO ASC-PIC-INFO                  07060043
070700         END-IF                                                   07070043
070800     END-IF.                                                      07080043
070900                                                                  07090043
071000     IF  AMSHIPL > ZERO                                           07100043
071100         MOVE AMSHIPI            TO ASC-MULT-SHIP                 07110043
071200     ELSE                                                         07120043
071300         IF  AMSHIPF = DP015-ERASE-EOF                            07130043
071400             MOVE SPACE          TO ASC-MULT-SHIP                 07140043
071500         END-IF                                                   07150043
071600     END-IF.                                                      07160043
071700                                                                  07170043
071800     IF  ASPCLL > ZERO                                            07180043
071900         MOVE ASPCLI             TO ASC-SPECIAL-INST              07190043
072000     ELSE                                                         07200043
072100         IF  ASPCLF = DP015-ERASE-EOF                             07210043
072200             MOVE SPACE          TO ASC-SPECIAL-INST              07220043
072300         END-IF                                                   07230043
072400     END-IF.                                                      07240043
072500                                                                  07250043
072600     IF  APRETKTL > ZERO                                          07260043
072700         MOVE APRETKTI           TO ASC-PRE-TKT                   07270043
072800     ELSE                                                         07280043
072900         IF  APRETKTF = DP015-ERASE-EOF                           07290043
073000             MOVE SPACE          TO ASC-PRE-TKT                   07300043
073100         END-IF                                                   07310043
073200     END-IF.                                                      07320043
073300                                                                  07330043
073400     IF  APACKL > ZERO                                            07340043
073500         MOVE APACKI             TO ASC-PACKED-BY-STR             07350043
073600     ELSE                                                         07360043
073700         IF  APACKF = DP015-ERASE-EOF                             07370043
073800             MOVE SPACE          TO ASC-PACKED-BY-STR             07380043
073900         END-IF                                                   07390043
074000     END-IF.                                                      07400043
074100                                                                  07410043
074200     IF  ADTLL > ZERO                                             07420043
074300         MOVE ADTLI              TO ASC-DETAIL-CHECK              07430043
074400     ELSE                                                         07440043
074500         IF  ADTLF = DP015-ERASE-EOF                              07450043
074600             MOVE SPACE          TO ASC-DETAIL-CHECK              07460043
074700         END-IF                                                   07470043
074800     END-IF.                                                      07480043
074900                                                                  07490043
075000     IF  AHANGRL > ZERO                                           07500043
075100         MOVE AHANGRI            TO ASC-GARMENT-ON-HANGER         07510043
075200     ELSE                                                         07520043
075300         IF  ATKTF = DP015-ERASE-EOF                              07530043
075400             MOVE SPACE          TO ASC-GARMENT-ON-HANGER         07540043
075500         END-IF                                                   07550043
075600     END-IF.                                                      07560043
075700                                                                  07570043
075800     IF  ATKTL > ZERO                                             07580043
075900         MOVE ATKTI              TO ASC-TICKET-TYPE               07590043
076000     ELSE                                                         07600043
076100         IF  ATKTF = DP015-ERASE-EOF                              07610043
076200             MOVE SPACE          TO ASC-TICKET-TYPE               07620043
076300         END-IF                                                   07630043
076400     END-IF.                                                      07640043
076500                                                                  07650043
076600*----------------------------------------------------------------*07660043
076700*    HERE WE SIMPLY ENSURE THE DATA IS CORRECT.  IF NOT, ISSUE   *07670043
076800*    APPROPRIATE ERRORS.                                         *07680043
076900*                                                                *07690043
077000*    PERFORMED BY 2000-FKEY-PROCESSING.                          *07700043
077100*----------------------------------------------------------------*07710043
077200                                                                  07720043
077300 2200-EDIT-DATA-IN-COMMAREA.                                      07730043
077400                                                                  07740043
077500     PERFORM 2210-RESET-ATTRIBUTES.                               07750043
077600                                                                  07760043
077700     IF  ASC-PO-NBR = SPACES OR ZEROS                             07770043
077800         SET PS-ERROR            TO TRUE                          07780043
077900         SET DP020-MSG-FATAL     TO TRUE                          07790043
078000         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              07800043
078100         MOVE DP015-UNP-ALP-BRT-OFF                               07810043
078200                                 TO APOA                          07820043
078300         MOVE DP015-RED          TO APOC                          07830043
078400         MOVE DP015-REVERSE      TO APOH                          07840043
078500         MOVE -1                 TO APOL                          07850043
078600         SET DP030-SET-CURSOR-APPL-1                              07860043
078700                                 TO TRUE                          07870043
078800     ELSE                                                         07880043
078900         PERFORM 2235-EDIT-PO-NBR                                 07890043
079000     END-IF.                                                      07900043
079100                                                                  07910043
079200     IF  ASC-RCVR-SEQ-NBR = SPACES OR ZEROS                       07920043
079300         SET PS-ERROR            TO TRUE                          07930043
079400         SET DP020-MSG-FATAL     TO TRUE                          07940043
079500         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              07950043
079600         MOVE DP015-UNP-ALP-BRT-OFF                               07960043
079700                                 TO ASEQA                         07970043
079800         MOVE DP015-RED          TO ASEQC                         07980043
079900         MOVE DP015-REVERSE      TO ASEQH                         07990043
080000         MOVE -1                 TO ASEQL                         08000043
080100         SET DP030-SET-CURSOR-APPL-1                              08010043
080200                                 TO TRUE                          08020043
080300     ELSE                                                         08030043
080400         PERFORM 2230-EDIT-RCVR-SEQ-NBR                           08040043
080500     END-IF.                                                      08050043
080600                                                                  08060043
080700     IF PS-NO-ERROR          AND                                  08070043
080800      ((ASC-RCVR-SEQ-NBR NOT = ASC-RCVR-SEQ-NBR-OLD) OR           08080043
080900       (ASC-PO-NBR NOT = ASC-PO-NBR-OLD))                         08090043
081000         PERFORM 2298-GET-ALL-INFO                                08100043
081100         MOVE ASC-RCVR-SEQ-NBR   TO ASC-RCVR-SEQ-NBR-OLD          08110043
081200         MOVE ASC-PO-NBR         TO ASC-PO-NBR-OLD                08120043
081300     END-IF.                                                      08130043
081400                                                                  08140043
081500     IF  ASC-TICKET-TYPE > SPACES                                 08150043
081600         PERFORM 2283-VALIDATE-TICKET-TYPE                        08160043
081700         IF  PS-TICKET-TYPE-INVALID                               08170043
081800             SET PS-ERROR        TO TRUE                          08180043
081900             SET DP020-MSG-FATAL TO TRUE                          08190043
082000             MOVE PC-TSYMSG-00005                                 08200043
082100                                 TO DP020-MSG-NUMBER              08210043
082200             MOVE DP015-UNP-ALP-BRT-OFF                           08220043
082300                                 TO ATKTA                         08230043
082400             MOVE DP015-RED      TO ATKTC                         08240043
082500             MOVE DP015-REVERSE  TO ATKTH                         08250043
082600             MOVE -1             TO ATKTL                         08260043
082700             SET DP030-SET-CURSOR-APPL-1                          08270043
082800                                 TO TRUE                          08280043
082900         END-IF                                                   08290043
083000     END-IF.                                                      08300043
083100                                                                  08310043
083200     IF  ASC-GARMENT-ON-HANGER = PC-Y OR PC-N OR SPACES           08320043
083300         CONTINUE                                                 08330043
083400     ELSE                                                         08340043
083500         SET PS-ERROR            TO TRUE                          08350043
083600         SET DP020-MSG-FATAL     TO TRUE                          08360043
083700         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              08370043
083800         MOVE DP015-UNP-ALP-BRT-OFF                               08380043
083900                                 TO ADTLA                         08390043
084000         MOVE DP015-RED          TO ADTLC                         08400043
084100         MOVE DP015-REVERSE      TO ADTLH                         08410043
084200         MOVE -1                 TO ADTLL                         08420043
084300         SET DP030-SET-CURSOR-APPL-1                              08430043
084400                                 TO TRUE                          08440043
084500     END-IF.                                                      08450043
084600                                                                  08460043
084700     IF  ASC-DETAIL-CHECK = PC-Y OR PC-N OR SPACES                08470043
084800         CONTINUE                                                 08480043
084900     ELSE                                                         08490043
085000         SET PS-ERROR            TO TRUE                          08500043
085100         SET DP020-MSG-FATAL     TO TRUE                          08510043
085200         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              08520043
085300         MOVE DP015-UNP-ALP-BRT-OFF                               08530043
085400                                 TO ADTLA                         08540043
085500         MOVE DP015-RED          TO ADTLC                         08550043
085600         MOVE DP015-REVERSE      TO ADTLH                         08560043
085700         MOVE -1                 TO ADTLL                         08570043
085800         SET DP030-SET-CURSOR-APPL-1                              08580043
085900                                 TO TRUE                          08590043
086000     END-IF.                                                      08600043
086100                                                                  08610043
086200     IF  ASC-PACKED-BY-STR = PC-Y OR PC-N OR SPACES               08620043
086300         CONTINUE                                                 08630043
086400     ELSE                                                         08640043
086500         SET PS-ERROR            TO TRUE                          08650043
086600         SET DP020-MSG-FATAL     TO TRUE                          08660043
086700         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              08670043
086800         MOVE DP015-UNP-ALP-BRT-OFF                               08680043
086900                                 TO APACKA                        08690043
087000         MOVE DP015-RED          TO APACKC                        08700043
087100         MOVE DP015-REVERSE      TO APACKH                        08710043
087200         MOVE -1                 TO APACKL                        08720043
087300         SET DP030-SET-CURSOR-APPL-1                              08730043
087400                                 TO TRUE                          08740043
087500     END-IF.                                                      08750043
087600                                                                  08760043
087700     IF  ASC-PRE-TKT = PC-Y OR PC-N OR SPACES                     08770043
087800         CONTINUE                                                 08780043
087900     ELSE                                                         08790043
088000         SET PS-ERROR            TO TRUE                          08800043
088100         SET DP020-MSG-FATAL     TO TRUE                          08810043
088200         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              08820043
088300         MOVE DP015-UNP-ALP-BRT-OFF                               08830043
088400                                 TO APRETKTA                      08840043
088500         MOVE DP015-RED          TO APRETKTC                      08850043
088600         MOVE DP015-REVERSE      TO APRETKTH                      08860043
088700         MOVE -1                 TO APRETKTL                      08870043
088800         SET DP030-SET-CURSOR-APPL-1                              08880043
088900                                 TO TRUE                          08890043
089000     END-IF.                                                      08900043
089100                                                                  08910043
089200     IF  ASC-MULT-SHIP = PC-Y OR PC-N OR SPACES                   08920043
089300         CONTINUE                                                 08930043
089400     ELSE                                                         08940043
089500         SET PS-ERROR            TO TRUE                          08950043
089600         SET DP020-MSG-FATAL     TO TRUE                          08960043
089700         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              08970043
089800         MOVE DP015-UNP-ALP-BRT-OFF                               08980043
089900                                 TO AMSHIPA                       08990043
090000         MOVE DP015-RED          TO AMSHIPC                       09000043
090100         MOVE DP015-REVERSE      TO AMSHIPH                       09010043
090200         MOVE -1                 TO AMSHIPL                       09020043
090300         SET DP030-SET-CURSOR-APPL-1                              09030043
090400                                 TO TRUE                          09040043
090500     END-IF.                                                      09050043
090600                                                                  09060043
090700     IF  ASC-AD-DATE = SPACES OR ZEROS                            09070043
090800         CONTINUE                                                 09080043
090900     ELSE                                                         09090043
091000         PERFORM 2220-EDIT-AD-DATE                                09100043
091100     END-IF.                                                      09110043
091200                                                                  09120043
091300     IF  ASC-RCVD-DATE = SPACES OR ZEROS                          09130043
091400         CONTINUE                                                 09140043
091500     ELSE                                                         09150043
091600         PERFORM 2225-EDIT-RCVD-DATE                              09160043
091700     END-IF.                                                      09170043
091800                                                                  09180043
091900     IF  ASC-CART-CT = SPACES OR ZEROS                            09190043
092000         SET PS-ERROR            TO TRUE                          09200043
092100         SET DP020-MSG-FATAL     TO TRUE                          09210043
092200         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              09220043
092300         MOVE DP015-UNP-NUM-BRT-OFF                               09230043
092400                                 TO ACRTNA                        09240043
092500         MOVE DP015-RED          TO ACRTNC                        09250043
092600         MOVE DP015-REVERSE      TO ACRTNH                        09260043
092700         MOVE -1                 TO ACRTNL                        09270043
092800         SET DP030-SET-CURSOR-APPL-1                              09280043
092900                                 TO TRUE                          09290043
093000     ELSE                                                         09300043
093100         PERFORM 2240-EDIT-CARTON-CNT                             09310043
093200     END-IF.                                                      09320043
093300                                                                  09330043
093400     IF  ASC-PRC-AREA = SPACE                                     09340043
093500         SET PS-ERROR            TO TRUE                          09350043
093600         SET DP020-MSG-FATAL     TO TRUE                          09360043
093700         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              09370043
093800         MOVE DP015-UNP-ALP-BRT-OFF                               09380043
093900                                 TO AAREAA                        09390043
094000         MOVE DP015-RED          TO AAREAC                        09400043
094100         MOVE DP015-REVERSE      TO AAREAH                        09410043
094200         MOVE -1                 TO AAREAL                        09420043
094300         SET DP030-SET-CURSOR-APPL-1                              09430043
094400                                 TO TRUE                          09440043
094500     ELSE                                                         09450043
094600         PERFORM 2270-VALIDATE-PROCESSING-AREA                    09460043
094700         IF SQLCODE = +100                                        09470043
094800             SET PS-ERROR        TO TRUE                          09480043
094900             SET DP020-MSG-FATAL TO TRUE                          09490043
095000             MOVE PC-TSYMSG-00005                                 09500043
095100                                 TO DP020-MSG-NUMBER              09510043
095200             MOVE DP015-UNP-ALP-BRT-OFF                           09520043
095300                                 TO AAREAA                        09530043
095400             MOVE DP015-RED      TO AAREAC                        09540043
095500             MOVE DP015-REVERSE  TO AAREAH                        09550043
095600             MOVE -1             TO AAREAL                        09560043
095700             SET DP030-SET-CURSOR-APPL-1                          09570043
095800                                 TO TRUE                          09580043
095900     END-IF.                                                      09590043
096000                                                                  09600043
096100     SET ERROR-ON-FACILITY-EDIT TO TRUE                           09610043
096200     PERFORM 2243-EDIT-FACILITY.                                  09620043
096300                                                                  09630043
096400     SET ERROR-ON-OP-UNIT-EDIT TO TRUE                            09640043
096500     IF NO-ERROR-ON-FACILITY-EDIT                                 09650043
096600         PERFORM 2242-EDIT-OPERATING-UNIT.                        09660043
096700                                                                  09670043
096800     SET ERROR-ON-PRINTER-EDIT TO TRUE                            09680043
096900     PERFORM 2245-EDIT-PRINTER-ID                                 09690043
097000                                                                  09700043
097100     IF NO-ERROR-ON-FACILITY-EDIT AND                             09710043
097200        NO-ERROR-ON-OP-UNIT-EDIT  AND                             09720043
097300        NO-ERROR-ON-PRINTER-EDIT                                  09730043
097400            PERFORM 2260-VALIDATE-PRINTER                         09740043
097500            IF PS-NO-ERROR                                        09750043
097600                PERFORM 2265-VALIDATE-PRINTER-ID                  09760043
097700                MOVE DP072-PRTR-LOC-DESC TO ASC-PRTR-DESC         09770043
097800                                            APRDESCO              09780043
097900                MOVE DP072-PRTR-IP-ADDRESS                        09790043
098000                                     TO                           09800043
098100                                        PC140-HL-IP-ADDRESS       09810043
098200                MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE               09820043
098300                                     TO                           09830043
098400                                        PC140-HL-OS-RLSE-CDE      09840043
098410                MOVE DP072-PRTR-DATA-XFER-MODE-ID                 09841043
098420                                     TO                           09842043
098430                                        PC140-HL-XFER-MODE-ID     09843043
098440                MOVE DP072-XMIT-INTFC-CDE                         09844043
098450                                     TO PC140-XMIT-INTFC-CDE      09845043
098460                                                                  09846043
098470                MOVE DP072-PRTR-OPER-UNT-ID TO PC-OPER-UNT-ID     09847043
098480                                                                  09848043
098490                PERFORM 3500-GET-DC-LOCATION                      09849043
098491            END-IF                                                09849143
098492     END-IF                                                       09849243
098493                                                                  09849343
098494     IF  PS-NO-ERROR                                              09849443
098495         MOVE -1                 TO APRTRL                        09849543
098496         SET DP030-SET-CURSOR-APPL-1                              09849643
098497                                 TO TRUE                          09849743
098498     END-IF.                                                      09849843
098499                                                                  09849943
098500 2210-RESET-ATTRIBUTES.                                           09850043
098600                                                                  09860043
098700     MOVE DP015-UNP-NUM-NOR-OFF  TO APRTRA                        09870043
098800                                    ACRTNA                        09880043
098900                                    APOA                          09890043
099000                                    ASEQA                         09900043
099100                                    ARCVDMMA                      09910043
099200                                    ARCVDDDA                      09920043
099300                                    ARCVDYYA                      09930043
099400                                    AADMMA                        09940043
099500                                    AADDDA                        09950043
099600                                    AADYYA                        09960043
099700     MOVE DP015-UNP-ALP-NOR-OFF  TO AAREAA                        09970043
099800                                    AVNDRA                        09980043
099900                                    APICA                         09990043
100000                                    AMSHIPA                       10000043
100100                                    ASPCLA                        10010043
100200                                    APRETKTA                      10020043
100300                                    APACKA                        10030043
100400                                    ADTLA                         10040043
100500                                    ATKTA                         10050043
100600                                    AOPUNITA                      10060043
100700                                    AFACILA                       10070043
100800     MOVE DP015-GREEN            TO APRTRC                        10080043
100900                                    AAREAC                        10090043
101000                                    ACRTNC                        10100043
101100                                    APOC                          10110043
101200                                    ASEQC                         10120043
101300                                    ARCVDMMC                      10130043
101400                                    ARCVDDDC                      10140043
101500                                    ARCVDYYC                      10150043
101600                                    AVNDRC                        10160043
101700                                    AADMMC                        10170043
101800                                    AADDDC                        10180043
101900                                    AADYYC                        10190043
102000                                    APICC                         10200043
102100                                    AMSHIPC                       10210043
102200                                    ASPCLC                        10220043
102300                                    APRETKTC                      10230043
102400                                    APACKC                        10240043
102500                                    ADTLC                         10250043
102600                                    ATKTC                         10260043
102700                                    AOPUNITC                      10270043
102800                                    AFACILC                       10280043
102900     MOVE DP015-UNDERLINE        TO APRTRH                        10290043
103000                                    AAREAH                        10300043
103100                                    ACRTNH                        10310043
103200                                    APOH                          10320043
103300                                    ASEQH                         10330043
103400                                    ARCVDMMH                      10340043
103500                                    ARCVDDDH                      10350043
103600                                    ARCVDYYH                      10360043
103700                                    AVNDRH                        10370043
103800                                    AADMMH                        10380043
103900                                    AADDDH                        10390043
104000                                    AADYYH                        10400043
104100                                    APICH                         10410043
104200                                    AMSHIPH                       10420043
104300                                    ASPCLH                        10430043
104400                                    APRETKTH                      10440043
104500                                    APACKH                        10450043
104600                                    ADTLH                         10460043
104700                                    ATKTH                         10470043
104800                                    AOPUNITH                      10480043
104900                                    AFACILH.                      10490043
105000*----------------------------------------------------------------*10500043
105100*    CHECK THE AD DATE FOR NUMERIC                               *10510043
105200*----------------------------------------------------------------*10520043
105300                                                                  10530043
105400 2220-EDIT-AD-DATE.                                               10540043
105500                                                                  10550043
105600     MOVE ASC-AD-MM              TO DP010I-UNEDITED-FIELD.        10560043
105700     MOVE +2                     TO DP010I-MAXIMUM-DIGITS.        10570043
105800     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      10580043
105900                                                                  10590043
106000     SET DP010I-NEGATIVE-NOT-ALLOWED                              10600043
106100                                 TO TRUE.                         10610043
106200                                                                  10620043
106310     CALL DP010I-NUMERIC-EDIT-ROUTINE                             10631054
106320                         USING DP010I-NUMERIC-EDIT-AREA           10632054
106400                                                                  10640043
106500     IF DP010I-NO-ERROR-DETECTED                                  10650043
106600         MOVE DP010I-NUMERIC-FIELD                                10660043
106700                                 TO ASC-AD-MM-N                   10670043
106800         MOVE ASC-AD-MM          TO AADMMO                        10680043
106900         MOVE ASC-AD-DD          TO DP010I-UNEDITED-FIELD         10690043
106910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10691054
106920                         USING DP010I-NUMERIC-EDIT-AREA           10692054
107100         IF DP010I-NO-ERROR-DETECTED                              10710043
107200             MOVE DP010I-NUMERIC-FIELD                            10720043
107300                                 TO ASC-AD-DD-N                   10730043
107400             MOVE ASC-AD-DD      TO AADDDO                        10740043
107500             MOVE ASC-AD-YY      TO DP010I-UNEDITED-FIELD         10750043
107510             CALL DP010I-NUMERIC-EDIT-ROUTINE                     10751054
107520                         USING DP010I-NUMERIC-EDIT-AREA           10752054
107700             IF DP010I-NO-ERROR-DETECTED                          10770043
107800                 MOVE DP010I-NUMERIC-FIELD                        10780043
107900                                 TO ASC-AD-YY-N                   10790043
108000                 MOVE ASC-AD-YY  TO AADYYO                        10800043
108100             END-IF                                               10810043
108200         END-IF                                                   10820043
108300     END-IF.                                                      10830043
108400                                                                  10840043
108500     IF DP010I-NO-ERROR-DETECTED                                  10850043
108600         PERFORM 2250-VALIDATE-AD-DATE                            10860043
108700     END-IF.                                                      10870043
108800                                                                  10880043
108900     IF DPG54-SEVERE-ERROR OR                                     10890043
109000        DP010I-ERROR-DETECTED                                     10900043
109100         SET PS-ERROR            TO TRUE                          10910043
109200         SET DP020-MSG-FATAL     TO TRUE                          10920043
109300         MOVE PC-TSYMSG-00009    TO DP020-MSG-NUMBER              10930043
109400         MOVE DP015-UNP-NUM-BRT-OFF                               10940043
109500                                 TO AADMMA                        10950043
109600                                    AADDDA                        10960043
109700                                    AADYYA                        10970043
109800         MOVE DP015-RED          TO AADMMC                        10980043
109900                                    AADDDC                        10990043
110000                                    AADYYC                        11000043
110100         MOVE DP015-REVERSE      TO AADMMH                        11010043
110200                                    AADDDH                        11020043
110300                                    AADYYH                        11030043
110400         MOVE -1                 TO AADMML                        11040043
110500         SET DP030-SET-CURSOR-APPL-1                              11050043
110600                                 TO TRUE                          11060043
110700     END-IF.                                                      11070043
110800                                                                  11080043
110900                                                                  11090043
111000                                                                  11100043
111100*----------------------------------------------------------------*11110043
111200*    CHECK THE RECEIVED DATE FOR NUMERIC                         *11120043
111300*----------------------------------------------------------------*11130043
111400                                                                  11140043
111500 2225-EDIT-RCVD-DATE.                                             11150043
111600                                                                  11160043
111700     MOVE ASC-RCVD-MM            TO DP010I-UNEDITED-FIELD.        11170043
111800     MOVE +2                     TO DP010I-MAXIMUM-DIGITS.        11180043
111900     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      11190043
112000                                                                  11200043
112100     SET DP010I-NEGATIVE-NOT-ALLOWED                              11210043
112200                                 TO TRUE.                         11220043
112300                                                                  11230043
112410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             11241054
112420                         USING DP010I-NUMERIC-EDIT-AREA           11242054
112500                                                                  11250043
112600     IF DP010I-NO-ERROR-DETECTED                                  11260043
112700         MOVE DP010I-NUMERIC-FIELD                                11270043
112800                                 TO ASC-RCVD-MM-N                 11280043
112900         MOVE ASC-RCVD-MM        TO ARCVDMMO                      11290043
113000         MOVE ASC-RCVD-DD        TO DP010I-UNEDITED-FIELD         11300043
113010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11301054
113020                         USING DP010I-NUMERIC-EDIT-AREA           11302054
113200         IF DP010I-NO-ERROR-DETECTED                              11320043
113300             MOVE DP010I-NUMERIC-FIELD                            11330043
113400                                 TO ASC-RCVD-DD-N                 11340043
113500             MOVE ASC-RCVD-DD    TO ARCVDDDO                      11350043
113600             MOVE ASC-RCVD-YY    TO DP010I-UNEDITED-FIELD         11360043
113610             CALL DP010I-NUMERIC-EDIT-ROUTINE                     11361054
113620                         USING DP010I-NUMERIC-EDIT-AREA           11362054
113800             IF DP010I-NO-ERROR-DETECTED                          11380043
113900                 MOVE DP010I-NUMERIC-FIELD                        11390043
114000                                 TO ASC-RCVD-YY-N                 11400043
114100                 MOVE ASC-RCVD-YY                                 11410043
114200                                 TO ARCVDYYO                      11420043
114300             END-IF                                               11430043
114400         END-IF                                                   11440043
114500     END-IF.                                                      11450043
114600                                                                  11460043
114700     IF DP010I-NO-ERROR-DETECTED                                  11470043
114800         PERFORM 2260-VALIDATE-RCVD-DATE                          11480043
114900     END-IF.                                                      11490043
115000                                                                  11500043
115100     IF DPG54-SEVERE-ERROR OR                                     11510043
115200        DP010I-ERROR-DETECTED                                     11520043
115300         SET PS-ERROR            TO TRUE                          11530043
115400         SET DP020-MSG-FATAL     TO TRUE                          11540043
115500         MOVE PC-TSYMSG-00009    TO DP020-MSG-NUMBER              11550043
115600         MOVE DP015-UNP-NUM-BRT-OFF                               11560043
115700                                 TO ARCVDMMA                      11570043
115800                                    ARCVDDDA                      11580043
115900                                    ARCVDYYA                      11590043
116000         MOVE DP015-RED          TO ARCVDMMC                      11600043
116100                                    ARCVDDDC                      11610043
116200                                    ARCVDYYC                      11620043
116300         MOVE DP015-REVERSE      TO ARCVDMMH                      11630043
116400                                    ARCVDDDH                      11640043
116500                                    ARCVDYYH                      11650043
116600         MOVE -1                 TO ARCVDMML                      11660043
116700         SET DP030-SET-CURSOR-APPL-1                              11670043
116800                                 TO TRUE                          11680043
116900     END-IF.                                                      11690043
117000                                                                  11700043
117100                                                                  11710043
117200*----------------------------------------------------------------*11720043
117300*    CHECK THE RECEIVER NUMBER FOR NUMERIC                       *11730043
117400*----------------------------------------------------------------*11740043
117500                                                                  11750043
117600 2230-EDIT-RCVR-SEQ-NBR.                                          11760043
117700                                                                  11770043
117800     MOVE ASC-RCVR-SEQ-NBR       TO DP010I-UNEDITED-FIELD.        11780043
117900     MOVE +3                     TO DP010I-MAXIMUM-DIGITS.        11790043
118000     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      11800043
118100                                                                  11810043
118200     SET DP010I-NEGATIVE-NOT-ALLOWED                              11820043
118300                                 TO TRUE.                         11830043
118400                                                                  11840043
118510     CALL DP010I-NUMERIC-EDIT-ROUTINE                             11851054
118520                         USING DP010I-NUMERIC-EDIT-AREA           11852054
118600                                                                  11860043
118700     IF DP010I-ERROR-DETECTED                                     11870043
118800         SET PS-ERROR            TO TRUE                          11880043
118900         SET DP020-MSG-FATAL     TO TRUE                          11890043
119000         MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER              11900043
119100         MOVE DP015-UNP-NUM-BRT-OFF                               11910043
119200                                 TO ASEQA                         11920043
119300         MOVE DP015-RED          TO ASEQC                         11930043
119400         MOVE DP015-REVERSE      TO ASEQH                         11940043
119500         MOVE -1                 TO ASEQL                         11950043
119600         SET DP030-SET-CURSOR-APPL-1                              11960043
119700                                 TO TRUE                          11970043
119800     ELSE                                                         11980043
119900         MOVE DP010I-NUMERIC-FIELD                                11990043
120000                                 TO ASC-RCVR-SEQ-NBR-N            12000043
120100         MOVE ASC-RCVR-SEQ-NBR   TO ASEQO                         12010043
120200                                    PV-RCVR-SEQ-NBR               12020043
120300         PERFORM 2275-GET-RECEIVER-NBR                            12030043
120400     END-IF.                                                      12040043
120500                                                                  12050043
120600                                                                  12060043
120700*----------------------------------------------------------------*12070043
120800*    CHECK THE PURCHASE ORDER NUMBER FOR NUMERIC                 *12080043
120900*----------------------------------------------------------------*12090043
121000                                                                  12100043
121100 2235-EDIT-PO-NBR.                                                12110043
121200                                                                  12120043
121300     MOVE ASC-PO-NBR             TO DP010I-UNEDITED-FIELD.        12130043
121400     MOVE +8                     TO DP010I-MAXIMUM-DIGITS.        12140043
121500     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      12150043
121600                                                                  12160043
121700     SET DP010I-NEGATIVE-NOT-ALLOWED                              12170043
121800                                 TO TRUE.                         12180043
121900                                                                  12190043
122010     CALL DP010I-NUMERIC-EDIT-ROUTINE                             12201054
122020                         USING DP010I-NUMERIC-EDIT-AREA           12202054
122100                                                                  12210043
122200     IF DP010I-ERROR-DETECTED                                     12220043
122300         SET PS-ERROR            TO TRUE                          12230043
122400         SET DP020-MSG-FATAL     TO TRUE                          12240043
122500         MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER              12250043
122600         MOVE DP015-UNP-NUM-BRT-OFF                               12260043
122700                                 TO APOA                          12270043
122800         MOVE DP015-RED          TO APOC                          12280043
122900         MOVE DP015-REVERSE      TO APOH                          12290043
123000         MOVE -1                 TO APOL                          12300043
123100         SET DP030-SET-CURSOR-APPL-1                              12310043
123200                                 TO TRUE                          12320043
123300     ELSE                                                         12330043
123400         MOVE DP010I-NUMERIC-FIELD                                12340043
123500                                 TO ASC-PO-NBR-N                  12350043
123600         MOVE ASC-PO-NBR         TO APOO                          12360043
123700         PERFORM 2280-VALIDATE-PO                                 12370043
123800     END-IF.                                                      12380043
123900                                                                  12390043
124000                                                                  12400043
124100*----------------------------------------------------------------*12410043
124200*    CHECK THE CARTON COUNT FOR NUMERIC AND > 0                  *12420043
124300*----------------------------------------------------------------*12430043
124400                                                                  12440043
124500 2240-EDIT-CARTON-CNT.                                            12450043
124600                                                                  12460043
124700     MOVE ASC-CART-CT            TO DP010I-UNEDITED-FIELD.        12470043
124800     MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        12480043
124900     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      12490043
125000                                                                  12500043
125100     SET DP010I-NEGATIVE-NOT-ALLOWED                              12510043
125200                                 TO TRUE.                         12520043
125300                                                                  12530043
125410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             12541054
125420                         USING DP010I-NUMERIC-EDIT-AREA           12542054
125500                                                                  12550043
125600     IF DP010I-ERROR-DETECTED                                     12560043
125700         SET PS-ERROR            TO TRUE                          12570043
125800         SET DP020-MSG-FATAL     TO TRUE                          12580043
125900         MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER              12590043
126000         MOVE DP015-UNP-NUM-BRT-OFF                               12600043
126100                                 TO ACRTNA                        12610043
126200         MOVE DP015-RED          TO ACRTNC                        12620043
126300         MOVE DP015-REVERSE      TO ACRTNH                        12630043
126400         MOVE -1                 TO ACRTNL                        12640043
126500         SET DP030-SET-CURSOR-APPL-1                              12650043
126600                                 TO TRUE                          12660043
126700     ELSE                                                         12670043
126800         MOVE DP010I-NUMERIC-FIELD                                12680043
126900                                 TO ASC-CART-CT-N                 12690043
127000         MOVE ASC-CART-CT-N      TO ACRTNO                        12700043
127100         IF ASC-CART-CT-N NOT > ZERO                              12710043
127200             SET PS-ERROR        TO TRUE                          12720043
127300             SET DP020-MSG-FATAL TO TRUE                          12730043
127400             MOVE PC-TSYMSG-00005                                 12740043
127500                                 TO DP020-MSG-NUMBER              12750043
127600             MOVE DP015-UNP-NUM-BRT-OFF                           12760043
127700                                 TO ACRTNA                        12770043
127800             MOVE DP015-RED      TO ACRTNC                        12780043
127900             MOVE DP015-REVERSE  TO ACRTNH                        12790043
128000             MOVE -1             TO ACRTNL                        12800043
128100             SET DP030-SET-CURSOR-APPL-1                          12810043
128200                                 TO TRUE                          12820043
128300         END-IF                                                   12830043
128400     END-IF.                                                      12840043
128500                                                                  12850043
128600                                                                  12860043
128700 2242-EDIT-OPERATING-UNIT.                                        12870043
128800                                                                  12880043
128900     IF ASC-OPER-UNT-ID NOT > SPACES                              12890043
129000         SET PS-ERROR            TO TRUE                          12900043
129100         SET DP020-MSG-FATAL     TO TRUE                          12910043
129200         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              12920043
129300         MOVE DP015-UNP-NUM-BRT-OFF                               12930043
129400                                 TO AOPUNITA                      12940043
129500         MOVE DP015-RED          TO AOPUNITC                      12950043
129600         MOVE DP015-REVERSE      TO AOPUNITH                      12960043
129700         MOVE -1                 TO AOPUNITL                      12970043
129800         SET DP030-SET-CURSOR-APPL-1                              12980043
129900                                 TO TRUE                          12990043
130000                                                                  13000043
130100     ELSE                                                         13010043
130200                                                                  13020043
130300         MOVE ASC-OPER-UNT-ID-N      TO DP010I-UNEDITED-FIELD     13030043
130400         MOVE +4                     TO DP010I-MAXIMUM-DIGITS     13040043
130500         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   13050043
130600                                                                  13060043
130700         SET DP010I-NEGATIVE-NOT-ALLOWED                          13070043
130800                                     TO TRUE                      13080043
130900                                                                  13090043
131010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13101054
131020                         USING DP010I-NUMERIC-EDIT-AREA           13102054
131100                                                                  13110043
131200         IF DP010I-NO-ERROR-DETECTED                              13120043
131300             MOVE DP010I-NUMERIC-FIELD                            13130043
131400                                     TO ASC-OPER-UNT-ID-N         13140043
131500                                        PV-SUPPRESS-FOUR          13150043
131600             MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                  13160043
131700             PERFORM 2244-GET-OP-UNIT-NAME                        13170043
131800             SET NO-ERROR-ON-OP-UNIT-EDIT TO TRUE                 13180043
131900         ELSE                                                     13190043
132000             SET PS-ERROR            TO TRUE                      13200043
132100             SET DP020-MSG-FATAL     TO TRUE                      13210043
132200             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          13220043
132300             MOVE DP015-UNP-NUM-BRT-OFF                           13230043
132400                                     TO AOPUNITA                  13240043
132500             MOVE DP015-RED          TO AOPUNITC                  13250043
132600             MOVE DP015-REVERSE      TO AOPUNITH                  13260043
132700             MOVE -1                 TO AOPUNITL                  13270043
132800             SET DP030-SET-CURSOR-APPL-1                          13280043
132900                                     TO TRUE                      13290043
133000         END-IF                                                   13300043
133100     .                                                            13310043
133200                                                                  13320043
133300 2243-EDIT-FACILITY.                                              13330043
133400                                                                  13340043
133500     IF ASC-FCLTY-ID NOT > SPACES                                 13350043
133600         SET PS-ERROR            TO TRUE                          13360043
133700         SET DP020-MSG-FATAL     TO TRUE                          13370043
133800         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              13380043
133900         MOVE DP015-UNP-NUM-BRT-OFF                               13390043
134000                                 TO AFACILA                       13400043
134100         MOVE DP015-RED          TO AFACILC                       13410043
134200         MOVE DP015-REVERSE      TO AFACILH                       13420043
134300         MOVE -1                 TO AFACILL                       13430043
134400         SET DP030-SET-CURSOR-APPL-1                              13440043
134500                                 TO TRUE                          13450043
134600                                                                  13460043
134700     ELSE                                                         13470043
134800                                                                  13480043
134900         MOVE ASC-FCLTY-ID-N         TO DP010I-UNEDITED-FIELD     13490043
135000         MOVE +4                     TO DP010I-MAXIMUM-DIGITS     13500043
135100         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   13510043
135200                                                                  13520043
135300         SET DP010I-NEGATIVE-NOT-ALLOWED                          13530043
135400                                     TO TRUE                      13540043
135500                                                                  13550043
135610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13561054
135620                         USING DP010I-NUMERIC-EDIT-AREA           13562054
135700                                                                  13570043
135800         IF DP010I-NO-ERROR-DETECTED                              13580043
135900             MOVE DP010I-NUMERIC-FIELD                            13590043
136000                                     TO ASC-FCLTY-ID-N            13600043
136100                                        PV-SUPPRESS-FOUR          13610043
136200             MOVE PV-SUPPRESS-FOUR   TO AFACILO                   13620043
136300             SET NO-ERROR-ON-FACILITY-EDIT TO TRUE                13630043
136400         ELSE                                                     13640043
136500             SET PS-ERROR            TO TRUE                      13650043
136600             SET DP020-MSG-FATAL     TO TRUE                      13660043
136700             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          13670043
136800             MOVE DP015-UNP-NUM-BRT-OFF                           13680043
136900                                     TO AFACILA                   13690043
137000             MOVE DP015-RED          TO AFACILC                   13700043
137100             MOVE DP015-REVERSE      TO AFACILH                   13710043
137200             MOVE -1                 TO AFACILL                   13720043
137300             SET DP030-SET-CURSOR-APPL-1                          13730043
137400                                     TO TRUE                      13740043
137500         END-IF                                                   13750043
137600     END-IF                                                       13760043
137700     .                                                            13770043
137800                                                                  13780043
137900                                                                  13790043
138000/                                                                 13800043
138100 2244-GET-OP-UNIT-NAME.                                           13810043
138200                                                                  13820043
138300     MOVE SPACES            TO ASC-OP-UNIT-NAME                   13830043
138400     MOVE ASC-FCLTY-ID-N    TO PC-FCLTY-ID                        13840043
138500     MOVE ASC-FCLTY-ID-N    TO PC140-CRA-FACLTY-ID                13850043
138600     MOVE ASC-OPER-UNT-ID-N TO PC-OPER-UNT-ID                     13860043
138700                                                                  13870043
138800     PERFORM                                                      13880043
138900         WITH TEST AFTER                                          13890043
139000         VARYING PV-RETRY-COUNTER                                 13900043
139100         FROM 1 BY 1                                              13910043
139200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13920043
139300                   OR (SQLCODE = +0)                              13930043
139400                   OR (SQLCODE = +100))                           13940043
139500                                                                  13950043
139600         EXEC SQL                                                 13960043
139700            SELECT  LOC_NM                                        13970046
139800              INTO :XLT00010-LOC-NM                               13980046
139900              FROM  XLT_LOC                                       13990044
140000             WHERE  LOC_NBR  = :PC-OPER-UNT-ID                    14000047
140200         END-EXEC                                                 14020043
140300                                                                  14030043
140400         EVALUATE TRUE                                            14040043
140500             WHEN SQLCODE = +0                                    14050043
140600                 MOVE XLT00010-LOC-NM TO ASC-OP-UNIT-NAME         14060046
140700                                         AOPDESCO                 14070046
140800             WHEN SQLCODE = +100                                  14080043
140900             WHEN SQLCODE = -811                                  14090043
141000             WHEN SQLCODE = -904                                  14100043
141100             WHEN SQLCODE = -913                                  14110043
141200                 CONTINUE                                         14120043
141300             WHEN SQLWARN0 NOT = SPACES                           14130043
141400             WHEN SQLCODE < +0                                    14140043
141500             WHEN SQLCODE > +0                                    14150043
141600                 MOVE '2244-GET-OP-UNIT-NAME'                     14160043
141700                                 TO DP013-PARAGRAPH               14170043
141800                 MOVE 'SELECT STORE NUMBER'                       14180043
141900                                 TO DP013-MESSAGE-TEXT (1)        14190043
142000                 MOVE SQLCA      TO DP013-SQLCA                   14200043
142100                 MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME (1)      14210044
142200                 SET DP013-DB2-ABEND                              14220043
142300                                 TO TRUE                          14230043
142400                 SET DP013-XCTL-DISPLAY-RESTART                   14240043
142500                                 TO TRUE                          14250043
142600                 PERFORM DP013-0000-PROCESS-ABEND                 14260043
142700         END-EVALUATE                                             14270043
142800     END-PERFORM.                                                 14280043
142900                                                                  14290043
143000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14300043
143100         MOVE '3010-VALIDATE-FCLTY-ID'                            14310043
143200                                 TO DP013-PARAGRAPH               14320043
143300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     14330043
143400                                 TO DP013-MESSAGE-TEXT (1)        14340043
143500         MOVE 'STORE NUMBER  '   TO DP013-MESSAGE-TEXT (2)        14350043
143600         MOVE SQLCA              TO DP013-SQLCA                   14360043
143700         MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)      14370044
143800         SET DP013-DB2-ABEND     TO TRUE                          14380043
143900         SET DP013-XCTL-DISPLAY-RESTART                           14390043
144000                                 TO TRUE                          14400043
144100         PERFORM DP013-0000-PROCESS-ABEND                         14410043
144200     END-IF.                                                      14420043
144300                                                                  14430043
144400                                                                  14440043
144500*----------------------------------------------------------------*14450043
144600*    CHECK THE PRINTER NUMBER FOR NUMERIC                        *14460043
144700*----------------------------------------------------------------*14470043
144800                                                                  14480043
144900 2245-EDIT-PRINTER-ID.                                            14490043
145000                                                                  14500043
145100     IF ASC-PRTR-ID NOT > SPACES                                  14510043
145200         SET PS-ERROR            TO TRUE                          14520043
145300         SET DP020-MSG-FATAL     TO TRUE                          14530043
145400         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              14540043
145500         MOVE DP015-UNP-NUM-BRT-OFF                               14550043
145600                                 TO APRTRA                        14560043
145700         MOVE DP015-RED          TO APRTRC                        14570043
145800         MOVE DP015-REVERSE      TO APRTRH                        14580043
145900         MOVE -1                 TO APRTRL                        14590043
146000         SET DP030-SET-CURSOR-APPL-1                              14600043
146100                                 TO TRUE                          14610043
146200                                                                  14620043
146300     ELSE                                                         14630043
146400                                                                  14640043
146500         MOVE ASC-PRTR-ID            TO DP010I-UNEDITED-FIELD     14650043
146600         MOVE +3                     TO DP010I-MAXIMUM-DIGITS     14660043
146700         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   14670043
146800                                                                  14680043
146900         SET DP010I-NEGATIVE-NOT-ALLOWED                          14690043
147000                                     TO TRUE                      14700043
147100                                                                  14710043
147210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14721054
147220                         USING DP010I-NUMERIC-EDIT-AREA           14722054
147300                                                                  14730043
147400         IF DP010I-ERROR-DETECTED                                 14740043
147500             SET PS-ERROR            TO TRUE                      14750043
147600             SET DP020-MSG-FATAL     TO TRUE                      14760043
147700             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          14770043
147800             MOVE DP015-UNP-NUM-BRT-OFF                           14780043
147900                                     TO APRTRA                    14790043
148000             MOVE DP015-RED          TO APRTRC                    14800043
148100             MOVE DP015-REVERSE      TO APRTRH                    14810043
148200             MOVE -1                 TO APRTRL                    14820043
148300             SET DP030-SET-CURSOR-APPL-1                          14830043
148400                                     TO TRUE                      14840043
148500         ELSE                                                     14850043
148600             MOVE DP010I-NUMERIC-FIELD                            14860043
148700                                     TO ASC-PRTR-ID-N             14870043
148800             MOVE ASC-PRTR-ID        TO APRTRO                    14880043
148900             SET NO-ERROR-ON-PRINTER-EDIT TO TRUE                 14890043
149000                                                                  14900043
149100         END-IF                                                   14910043
149200     END-IF.                                                      14920043
149300                                                                  14930043
149400                                                                  14940043
149500*----------------------------------------------------------------*14950043
149600*    CALL THE DATE ROUTINE TO VERIFY PROPER MMDDYY FORMAT        *14960043
149700*----------------------------------------------------------------*14970043
149800                                                                  14980043
149900 2250-VALIDATE-AD-DATE.                                           14990043
150000     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              15000043
150100     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      15010043
150200     SET DPG52-LK-DTE-GREG         TO TRUE                        15020043
150300                                                                  15030043
150400     MOVE ASC-AD-MM              TO DPG52-LK-DATE-INPUT(1:2).     15040043
150500     MOVE ASC-AD-DD              TO DPG52-LK-DATE-INPUT(3:2).     15050043
150600     MOVE ASC-AD-YY              TO DPG52-LK-DATE-INPUT(5:2).     15060043
150700                                                                  15070043
150800     CALL DP500-KOHLS-CALENDAR-ROUTINE                            15080043
150900         USING DPG51                                              15090043
151000               DPG52                                              15100043
151100               DPG53                                              15110043
151200               DPG54                                              15120043
151300               DPG55                                              15130043
151400               DPG56.                                             15140043
151500                                                                  15150043
151600                                                                  15160043
151700*----------------------------------------------------------------*15170043
151800*    CALL THE DATE ROUTINE TO VERIFY PROPER MMDDYY FORMAT        *15180043
151900*----------------------------------------------------------------*15190043
152000                                                                  15200043
152100 2260-VALIDATE-RCVD-DATE.                                         15210043
152200     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              15220043
152300     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      15230043
152400     SET DPG52-LK-DTE-GREG         TO TRUE.                       15240043
152500                                                                  15250043
152600     MOVE ASC-RCVD-MM            TO DPG52-LK-DATE-INPUT(1:2).     15260043
152700     MOVE ASC-RCVD-DD            TO DPG52-LK-DATE-INPUT(3:2).     15270043
152800     MOVE ASC-RCVD-YY            TO DPG52-LK-DATE-INPUT(5:2).     15280043
152900                                                                  15290043
153000     CALL DP500-KOHLS-CALENDAR-ROUTINE                            15300043
153100         USING DPG51                                              15310043
153200               DPG52                                              15320043
153300               DPG53                                              15330043
153310               DPG54                                              15331043
153320               DPG55                                              15332043
153330               DPG56.                                             15333043
153340                                                                  15334043
153350                                                                  15335043
153360*----------------------------------------------------------------*15336043
153370*   2260-VALIDATE-PRINTER                                        *15337043
153380* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *15338043
153390*----------------------------------------------------------------*15339043
153400 2260-VALIDATE-PRINTER.                                           15340043
153500                                                                  15350043
153600     MOVE ASC-PRTR-ID-N           TO DP072-PRINTER-ID.            15360043
153700     MOVE PC-CURRENT-PROGRAM-NAME TO DP072-RPT-PGM-NME.           15370043
153800     MOVE PC-01                   TO DP072-RPT-PGM-TYP-ID.        15380043
153900     MOVE ASC-OPER-UNT-ID-N       TO DP072-ORIGIN-OPER-UNT-ID     15390043
154000                                     DP072-OPER-UNT-ID.           15400043
154100     MOVE ASC-FCLTY-ID-N          TO DP072-ORIGIN-FCLTY-ID        15410043
154200                                     DP072-FCLTY-ID.              15420043
154300                                                                  15430043
154400     SET DP072-VALIDATE           TO TRUE.                        15440043
154500                                                                  15450043
154600     EXEC CICS                                                    15460043
154700          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  15470043
154800               COMMAREA (DP072-COMM-AREA)                         15480043
154900               RESP     (PV-CICS-RESPONSE)                        15490043
155000     END-EXEC.                                                    15500043
155100                                                                  15510043
155200     EVALUATE TRUE                                                15520043
155300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15530043
155400              CONTINUE                                            15540043
155500         WHEN OTHER                                               15550043
155600              SET PS-ERROR                TO TRUE                 15560043
155700              SET DP020-MSG-FATAL         TO TRUE                 15570043
155800              MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER     15580043
155810              MOVE DP015-UNP-NUM-BRT-OFF  TO APRTRA               15581043
155820              MOVE DP015-RED              TO APRTRC               15582043
155830              MOVE DP015-REVERSE          TO APRTRH               15583043
155840              MOVE -1                     TO APRTRL               15584043
155850              MOVE SPACES                 TO ASC-PRTR-DESC        15585043
155860              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 15586043
155870              PERFORM DP013-0000-PROCESS-ABEND                    15587043
155880     END-EVALUATE.                                                15588043
155890                                                                  15589043
155900                                                                  15590043
156000 EJECT                                                            15600043
156100*----------------------------------------------------------------*15610043
156200*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *15620043
156300*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *15630043
156400*  CAN BE PRINTED ON THIS PRINTER.                               *15640043
156500*----------------------------------------------------------------*15650043
156600 2265-VALIDATE-PRINTER-ID.                                        15660043
156700                                                                  15670043
156800     IF  DP072-PRTR-PRTR-TRK-STAT-CDE =  PC-A                     15680043
156900         CONTINUE                                                 15690043
157000     ELSE                                                         15700043
157100         SET  PS-ERROR                TO TRUE                     15710043
157200         SET  DP020-MSG-FATAL         TO TRUE                     15720043
157300         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         15730043
157400         MOVE DP015-UNP-NUM-BRT-OFF   TO APRTRA                   15740043
157500         MOVE DP015-RED               TO APRTRC                   15750043
157600         MOVE DP015-REVERSE           TO APRTRH                   15760043
157700         MOVE -1                      TO APRTRL                   15770043
157800         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     15780043
157900     END-IF.                                                      15790043
158000                                                                  15800043
158100 EJECT                                                            15810043
158200*----------------------------------------------------------------*15820043
158300*    CHECK TPCLABL TO SEE IF A VALID PROCESSING AREA WAS ENTERED *15830043
158400*----------------------------------------------------------------*15840043
158500                                                                  15850043
158600 2270-VALIDATE-PROCESSING-AREA.                                   15860043
158700                                                                  15870043
158800     MOVE ASC-PRC-AREA           TO PCLABL-CNTL-DESC.             15880043
158900                                                                  15890043
159000     PERFORM                                                      15900043
159100         WITH TEST AFTER                                          15910043
159200         VARYING PV-RETRY-COUNTER                                 15920043
159300         FROM 1 BY 1                                              15930043
159400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15940043
159500                   OR (SQLCODE = ZERO)                            15950043
159600                   OR (SQLCODE = +100))                           15960043
159700                                                                  15970043
159800         EXEC SQL                                                 15980043
159900            SELECT  CNTL_CDE,                                     15990043
160000                    CNTL_DESC                                     16000043
160100              INTO :PCLABL-CNTL-CDE,                              16010043
160200                   :PCLABL-CNTL-DESC                              16020043
160300              FROM  TPCLABL                                       16030043
160400             WHERE  LBL_TYP_CDE = :PC-PROCESS-AREA                16040043
160500               AND  CNTL_DESC   = :PCLABL-CNTL-DESC               16050043
160600         END-EXEC                                                 16060043
160700                                                                  16070043
160800         EVALUATE TRUE                                            16080043
160900             WHEN SQLCODE = ZERO                                  16090043
161000                 MOVE PCLABL-CNTL-CDE                             16100043
161100                                 TO ASC-PRC-AREA-CDE              16110043
161200             WHEN SQLCODE = +100                                  16120043
161300                 MOVE ZEROS      TO ASC-PRC-AREA-CDE              16130043
161400             WHEN SQLCODE = -904                                  16140043
161500             WHEN SQLCODE = -913                                  16150043
161600                 CONTINUE                                         16160043
161700                                                                  16170043
161800             WHEN SQLWARN0 NOT = SPACES                           16180043
161900             WHEN SQLCODE < ZERO                                  16190043
162000             WHEN SQLCODE > ZERO                                  16200043
162100                 MOVE '2270-VALIDATE-PROCESSING-AREA'             16210043
162200                                 TO DP013-PARAGRAPH               16220043
162300                 MOVE 'SELECT PROCESSING AREA'                    16230043
162400                                 TO DP013-MESSAGE-TEXT (1)        16240043
162500                 MOVE SQLCA      TO DP013-SQLCA                   16250043
162600                 MOVE 'TPCLABL'  TO DP013-DB2-TABLE-NAME (1)      16260043
162700                 SET DP013-DB2-ABEND                              16270043
162800                                 TO TRUE                          16280043
162900                 SET DP013-XCTL-DISPLAY-RESTART                   16290043
163000                                 TO TRUE                          16300043
163100                 PERFORM DP013-0000-PROCESS-ABEND                 16310043
163200         END-EVALUATE                                             16320043
163300     END-PERFORM.                                                 16330043
163400                                                                  16340043
163500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16350043
163600         MOVE '2270-VALIDATE-PROCESSING-AREA'                     16360043
163700                                 TO DP013-PARAGRAPH               16370043
163800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     16380043
163900                                 TO DP013-MESSAGE-TEXT (1)        16390043
164000         MOVE 'PROCESSING AREA'  TO DP013-MESSAGE-TEXT (2)        16400043
164100         MOVE SQLCA              TO DP013-SQLCA                   16410043
164200         MOVE 'TPCLABL'          TO DP013-DB2-TABLE-NAME (1)      16420043
164300         SET DP013-DB2-ABEND     TO TRUE                          16430043
164400         SET DP013-XCTL-DISPLAY-RESTART                           16440043
164500                                 TO TRUE                          16450043
164600         PERFORM DP013-0000-PROCESS-ABEND                         16460043
164700     END-IF.                                                      16470043
164800                                                                  16480043
164900                                                                  16490043
165000*----------------------------------------------------------------*16500043
165100*    READ THE DB2 RECEIVER DATABASE TO VERIFY RECEIVER NUMBER    *16510043
165200*----------------------------------------------------------------*16520043
165300                                                                  16530043
165400 2275-GET-RECEIVER-NBR.                                           16540043
165500                                                                  16550043
165600     INITIALIZE  DCLTRECEIV.                                      16560043
165700                                                                  16570043
165800     MOVE ASC-PO-NBR-N                 TO PV-PO-NBR.              16580043
165900     MOVE ASC-RCVR-SEQ-NBR-N           TO PV-RCVR-SEQ-NBR.        16590043
166000                                                                  16600043
166100     EXEC SQL                                                     16610043
166200          SELECT                                                  16620043
166300                 OPER_UNT_ID                                      16630043
166400                ,FCLTY_ID                                         16640043
166500                ,STATUS_CDE                                       16650043
166600                ,PACK_BY_ST_IND                                   16660043
166700                ,DATE(REC_TMST)                                   16670043
166800                ,EXPTED_CART_CNT                                  16680043
166900                ,ACTL_CART_CNT                                    16690043
167000                ,EXPTED_ITM_QTY                                   16700043
167100                ,ACTL_ITM_QTY                                     16710043
167200                ,PRE_TKT_IND                                      16720043
167300                ,AD_INFO_DESC                                     16730043
167400                ,VERFYD_TMST                                      16740043
167500                ,GOH_IND                                          16750043
167600            INTO                                                  16760043
167700                 :RECEIV-OPER-UNT-ID                              16770043
167800                ,:RECEIV-FCLTY-ID                                 16780043
167900                ,:RECEIV-STATUS-CDE                               16790043
168000                ,:RECEIV-PACK-BY-ST-IND                           16800043
168100                ,:PV-CCYYMMDD                                     16810043
168200                ,:RECEIV-EXPTED-CART-CNT                          16820043
168300                ,:RECEIV-ACTL-CART-CNT                            16830043
168400                ,:RECEIV-EXPTED-ITM-QTY                           16840043
168500                ,:RECEIV-ACTL-ITM-QTY                             16850043
168600                ,:RECEIV-PRE-TKT-IND                              16860043
168700                ,:RECEIV-AD-INFO-DESC                             16870043
168800                ,:RECEIV-VERFYD-TMST                              16880043
168900                ,:RECEIV-GOH-IND                                  16890043
169000            FROM TRECEIV                                          16900043
169100           WHERE ORD_NBR     = :PV-PO-NBR                         16910043
169200             AND REC_SEQ_NBR = :PV-RCVR-SEQ-NBR                   16920043
169300             AND VER_STATUS_CDE = 'A'                             16930043
169400     END-EXEC                                                     16940043
169500                                                                  16950043
169600     EVALUATE TRUE                                                16960043
169700         WHEN SQLCODE = +0                                        16970043
169800              CONTINUE                                            16980043
169900                                                                  16990043
170000         WHEN SQLCODE = +100                                      17000043
170100             SET PS-ERROR        TO TRUE                          17010043
170200             SET DP020-MSG-FATAL TO TRUE                          17020043
170300             MOVE PC-TSYMSG-00005                                 17030043
170400                                 TO DP020-MSG-NUMBER              17040043
170500             MOVE DP015-UNP-NUM-BRT-OFF                           17050043
170600                                 TO ASEQA                         17060043
170700             MOVE DP015-RED      TO ASEQC                         17070043
170800             MOVE DP015-REVERSE  TO ASEQH                         17080043
170900             MOVE -1             TO ASEQL                         17090043
171000             SET DP030-SET-CURSOR-APPL-1                          17100043
171100                                 TO TRUE                          17110043
171200                                                                  17120043
171300         WHEN SQLCODE = -904                                      17130043
171400         WHEN SQLCODE = -913                                      17140043
171500             CONTINUE                                             17150043
171600         WHEN SQLWARN0 NOT = SPACES                               17160043
171700         WHEN SQLCODE < +0                                        17170043
171800         WHEN SQLCODE > +0                                        17180043
171900              MOVE '4050-SELECT-TRECEIV'                          17190043
172000                              TO DP013-PARAGRAPH                  17200043
172100              MOVE 'UNSUCCESSFUL SELECT ON TRECEIV  '             17210043
172200                              TO DP013-MESSAGE-TEXT (1)           17220043
172300              MOVE SQLCA      TO DP013-SQLCA                      17230043
172400              MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)         17240043
172500              SET DP013-DB2-ABEND                                 17250043
172600                  DP013-XCTL-DISPLAY-RESTART                      17260043
172700                              TO TRUE                             17270043
172800              PERFORM DP013-0000-PROCESS-ABEND                    17280043
172900     END-EVALUATE.                                                17290043
173000                                                                  17300043
173100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17310043
173200         MOVE '4050-SELECT-TRECEIV'                               17320043
173300                                  TO DP013-PARAGRAPH              17330043
173400         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TRECEIV  '       17340043
173500                                  TO DP013-MESSAGE-TEXT (1)       17350043
173600         MOVE SQLCA               TO DP013-SQLCA                  17360043
173700         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     17370043
173800         SET DP013-DB2-ABEND                                      17380043
173900             DP013-XCTL-DISPLAY-RESTART                           17390043
174000                                  TO TRUE                         17400043
174100         PERFORM DP013-0000-PROCESS-ABEND                         17410043
174200     END-IF.                                                      17420043
174300                                                                  17430043
174400                                                                  17440043
174500 EJECT                                                            17450043
174600*----------------------------------------------------------------*17460043
174700*    DO A COUNT FOR A SPECIFIC PURCHASE ORDER NUMBER.            *17470043
174800*                                                                *17480043
174900*----------------------------------------------------------------*17490043
175000 2280-VALIDATE-PO.                                                17500043
175100                                                                  17510043
175200     MOVE ASC-PO-NBR-N           TO PV-PO-NBR.                    17520043
175300                                                                  17530043
175400     PERFORM                                                      17540043
175500         WITH TEST AFTER                                          17550043
175600         VARYING PV-RETRY-COUNTER                                 17560043
175700         FROM 1 BY 1                                              17570043
175800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17580043
175900             OR (SQLCODE = +0)                                    17590043
176000             OR (SQLCODE = +100))                                 17600043
176100                                                                  17610043
176200         EXEC SQL                                                 17620043
176300              SELECT COUNT(*)                                     17630043
176400                INTO :PV-COUNT                                    17640043
176500                FROM TPURCHS                                      17650043
176600               WHERE PO_NBR         = :PV-PO-NBR                  17660043
176700                 AND VER_STATUS_CDE = 'A'                         17670043
176800         END-EXEC                                                 17680043
176900                                                                  17690043
177000         EVALUATE TRUE                                            17700043
177100             WHEN SQLCODE = +0                                    17710043
177200                 IF PV-COUNT > ZERO                               17720043
177300                     NEXT SENTENCE                                17730043
177400                 ELSE                                             17740043
177500                     SET PS-PO-NOT-FOUND TO TRUE                  17750043
177600                     SET DP020-MSG-WARNING                        17760043
177700                                         TO TRUE                  17770043
177800                     MOVE PC-TSYMSG-00083                         17780043
177900                                         TO DP020-MSG-NUMBER      17790043
178000                     MOVE DP015-UNP-NUM-BRT-OFF                   17800043
178100                                         TO APOA                  17810043
178200*                    MOVE DP015-RED      TO APOC                  17820043
178300*                    MOVE DP015-REVERSE  TO APOH                  17830043
178400                     MOVE -1             TO APOL                  17840043
178500                     SET DP030-SET-CURSOR-APPL-1                  17850043
178600                                         TO TRUE                  17860043
178700                 END-IF                                           17870043
178800                                                                  17880043
178900             WHEN SQLCODE = +100                                  17890043
179000*                SET PS-ERROR        TO TRUE                      17900043
179100                 SET PS-PO-NOT-FOUND TO TRUE                      17910043
179200                 SET DP020-MSG-WARNING                            17920043
179300                                     TO TRUE                      17930043
179400                 MOVE PC-TSYMSG-00083                             17940043
179500                                     TO DP020-MSG-NUMBER          17950043
179600                 MOVE DP015-UNP-NUM-BRT-OFF                       17960043
179700                                     TO APOA                      17970043
179800*                MOVE DP015-RED      TO APOC                      17980043
179900*                MOVE DP015-REVERSE  TO APOH                      17990043
180000                 MOVE -1             TO APOL                      18000043
180100                 SET DP030-SET-CURSOR-APPL-1                      18010043
180200                                     TO TRUE                      18020043
180300                                                                  18030043
180400             WHEN SQLCODE = -904                                  18040043
180500             WHEN SQLCODE = -913                                  18050043
180600                  CONTINUE                                        18060043
180700                                                                  18070043
180800             WHEN SQLWARN0 NOT = SPACES                           18080043
180900             WHEN SQLCODE < +0                                    18090043
181000             WHEN SQLCODE > +0                                    18100043
181100                 MOVE '2280-VALIDATE-PO'                          18110043
181200                                  TO DP013-PARAGRAPH              18120043
181300                  MOVE 'UNSUCCESSFUL SELECT FOR P.O.       '      18130043
181400                                  TO DP013-MESSAGE-TEXT (1)       18140043
181500                  MOVE SQLCA      TO DP013-SQLCA                  18150043
181600                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)     18160043
181700                  SET DP013-DB2-ABEND                             18170043
181800                      DP013-XCTL-DISPLAY-RESTART                  18180043
181900                                  TO TRUE                         18190043
182000                  PERFORM DP013-0000-PROCESS-ABEND                18200043
182100         END-EVALUATE                                             18210043
182200     END-PERFORM.                                                 18220043
182300                                                                  18230043
182400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        18240043
182500         MOVE '2280-VALIDATE-PO'                                  18250043
182600                                  TO DP013-PARAGRAPH              18260043
182700         MOVE 'MAX RETRIES EXCEEDED ON SELECT FOR DEPT NBR'       18270043
182800                                  TO DP013-MESSAGE-TEXT (1)       18280043
182900         MOVE SQLCA               TO DP013-SQLCA                  18290043
183000         MOVE 'TPURCHS '          TO DP013-DB2-TABLE-NAME (1)     18300043
183100         SET DP013-DB2-ABEND                                      18310043
183200             DP013-XCTL-DISPLAY-RESTART                           18320043
183300                                  TO TRUE                         18330043
183400         PERFORM DP013-0000-PROCESS-ABEND                         18340043
183500     END-IF.                                                      18350043
183600                                                                  18360043
183700/                                                                 18370043
183800*----------------------------------------------------------------*18380043
183900*    VALIDATE TICKET TYPE                                        *18390043
184000*----------------------------------------------------------------*18400043
184100 2283-VALIDATE-TICKET-TYPE.                                       18410043
184200                                                                  18420043
184300     PERFORM                                                      18430043
184400         WITH TEST AFTER                                          18440043
184500         VARYING PV-RETRY-COUNTER                                 18450043
184600         FROM 1 BY 1                                              18460043
184700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               18470043
184800                   OR (SQLCODE = ZERO)                            18480043
184900                   OR (SQLCODE = +100))                           18490043
185000                                                                  18500043
185100         EXEC SQL                                                 18510043
185200              SELECT TKT_FMT_ID                                   18520043
185300                INTO :TKTFMT-TKT-FMT-ID                           18530043
185400                FROM TTKTFMT                                      18540043
185500               WHERE OPER_UNT_ID   = :PC-0085                     18550043
185600                 AND FCLTY_ID      = :PC-0001                     18560043
185700                 AND TKT_FMT_ID    = :ASC-TICKET-TYPE             18570043
185800                 FETCH FIRST 1 ROW ONLY                           18580043
185900         END-EXEC                                                 18590043
186000                                                                  18600043
186100         EVALUATE TRUE                                            18610043
186200             WHEN SQLCODE = ZERO                                  18620043
186300                  SET PS-TICKET-TYPE-VALID                        18630043
186400                                   TO TRUE                        18640043
186500             WHEN SQLCODE = +100                                  18650043
186600                  SET PS-TICKET-TYPE-INVALID                      18660043
186700                                   TO TRUE                        18670043
186800             WHEN SQLCODE = -904                                  18680043
186900             WHEN SQLCODE = -913                                  18690043
187000                  CONTINUE                                        18700043
187100             WHEN SQLWARN0 NOT = SPACES                           18710043
187200             WHEN SQLCODE < ZERO                                  18720043
187300             WHEN SQLCODE > ZERO                                  18730043
187400                  MOVE '2283-VALIDATE-TICKET-TYPE'                18740043
187500                                   TO DP013-PARAGRAPH             18750043
187600                  MOVE 'SELECT TICKET TYPE FROM TTIKFMT'          18760043
187700                                   TO DP013-MESSAGE-TEXT (1)      18770043
187800                  MOVE SQLCA       TO DP013-SQLCA                 18780043
187900                  MOVE 'TTIKFMT'   TO DP013-DB2-TABLE-NAME (1)    18790043
188000                  SET DP013-DB2-ABEND                             18800043
188100                      DP013-XCTL-DISPLAY-RESTART                  18810043
188200                                   TO TRUE                        18820043
188300                  PERFORM DP013-0000-PROCESS-ABEND                18830043
188400         END-EVALUATE                                             18840043
188500     END-PERFORM.                                                 18850043
188600                                                                  18860043
188700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        18870043
188800         MOVE '2283-VALIDATE-TICKET-TYPE'                         18880043
188900                                   TO DP013-PARAGRAPH             18890043
189000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     18900043
189100                                   TO DP013-MESSAGE-TEXT (1)      18910043
189200         MOVE 'TTIKFMT: '          TO DP013-MESSAGE-TEXT (2)      18920043
189300         MOVE ASC-TICKET-TYPE      TO DP013-MESSAGE-TEXT (3)      18930043
189400         MOVE SQLCA                TO DP013-SQLCA                 18940043
189500         MOVE 'TTIKFMT'            TO DP013-DB2-TABLE-NAME (1)    18950043
189600         SET DP013-DB2-ABEND                                      18960043
189700             DP013-XCTL-DISPLAY-RESTART                           18970043
189800                                   TO TRUE                        18980043
189900         PERFORM DP013-0000-PROCESS-ABEND                         18990043
190000     END-IF.                                                      19000043
190100                                                                  19010043
190200*----------------------------------------------------------------*19020043
190300*    IF A PURCHASE ORDER WAS ENTERED, FILL IN THE VENDOR NAME    *19030043
190400*----------------------------------------------------------------*19040043
190500                                                                  19050043
190600 2285-SELECT-VENDOR-NAME.                                         19060043
190700                                                                  19070043
190800     MOVE ASC-PO-NBR-N           TO PV-PO-NBR.                    19080043
190900                                                                  19090043
191000     PERFORM                                                      19100043
191100         WITH TEST AFTER                                          19110043
191200         VARYING PV-RETRY-COUNTER                                 19120043
191300         FROM 1 BY 1                                              19130043
191400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19140043
191500             OR (SQLCODE = +0)                                    19150043
191600             OR (SQLCODE = +100))                                 19160043
191700                                                                  19170043
191800         EXEC SQL                                                 19180043
191900              SELECT ENT_NAME_DESC                                19190043
192000                INTO :ENTNME-ENT-NAME-DESC                        19200043
192100                FROM TPURCHS A                                    19210043
192200                    ,TENTNME B                                    19220043
192300               WHERE A.PO_NBR         = :PV-PO-NBR                19230043
192400                 AND A.VER_STATUS_CDE = 'A'                       19240043
192500                 AND B.TYPE_CDE       = '01'                      19250043
192600                 AND A.ENT_ID = B.ENT_ID                          19260043
192700         END-EXEC                                                 19270043
192800                                                                  19280043
192900         EVALUATE TRUE                                            19290043
193000             WHEN SQLCODE = +0                                    19300043
193100                 MOVE ENTNME-ENT-NAME-DESC                        19310043
193200                                     TO ASC-VEND-NAME             19320043
193300                                        AVNDRO                    19330043
193400                                                                  19340043
193500             WHEN SQLCODE = +100                                  19350043
193600                  CONTINUE                                        19360043
193700             WHEN SQLCODE = -904                                  19370043
193800             WHEN SQLCODE = -913                                  19380043
193900                  CONTINUE                                        19390043
194000                                                                  19400043
194100             WHEN SQLWARN0 NOT = SPACES                           19410043
194200             WHEN SQLCODE < +0                                    19420043
194300             WHEN SQLCODE > +0                                    19430043
194400                  MOVE '2285-SELECT-VENDOR-NAME'                  19440043
194500                                  TO DP013-PARAGRAPH              19450043
194600                  MOVE 'UNSUCCESSFUL SELECT ON TENTNME TABLE'     19460043
194700                                  TO DP013-MESSAGE-TEXT (1)       19470043
194800                  MOVE SQLCA      TO DP013-SQLCA                  19480043
194900                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)     19490043
195000                  MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (2)     19500043
195100                  SET DP013-DB2-ABEND                             19510043
195200                      DP013-XCTL-DISPLAY-RESTART                  19520043
195300                                  TO TRUE                         19530043
195400                  PERFORM DP013-0000-PROCESS-ABEND                19540043
195500         END-EVALUATE                                             19550043
195600     END-PERFORM.                                                 19560043
195700                                                                  19570043
195800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19580043
195900         MOVE '4330-GET-ENT-NAME  '                               19590043
196000                                  TO DP013-PARAGRAPH              19600043
196100         MOVE 'MAX RETRIES EXCEEDED ON SELECT TENTNME TABLE'      19610043
196200                                  TO DP013-MESSAGE-TEXT (1)       19620043
196300         MOVE SQLCA               TO DP013-SQLCA                  19630043
196400         MOVE 'TPURCHS'           TO DP013-DB2-TABLE-NAME (1)     19640043
196500         MOVE 'TENTNME'           TO DP013-DB2-TABLE-NAME (2)     19650043
196600         SET DP013-DB2-ABEND                                      19660043
196700             DP013-XCTL-DISPLAY-RESTART                           19670043
196800                                  TO TRUE                         19680043
196900         PERFORM DP013-0000-PROCESS-ABEND                         19690043
197000     END-IF.                                                      19700043
197100/                                                                 19710043
197200*----------------------------------------------------------------*19720043
197300*    READ THE PO ITME DATABASE TO RETRIEVE DEPT, CLASS AND AD DATE19730043
197400*----------------------------------------------------------------*19740043
197500                                                                  19750043
197600 2293-GET-PO-ITEM.                                                19760043
197700                                                                  19770043
197800     MOVE ASC-PO-NBR-N           TO PV-PO-NBR.                    19780043
197900                                                                  19790043
198000     PERFORM                                                      19800043
198100         WITH TEST AFTER                                          19810043
198200         VARYING PV-RETRY-COUNTER                                 19820043
198300         FROM 1 BY 1                                              19830043
198400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19840043
198500             OR (SQLCODE = +0)                                    19850043
198600             OR (SQLCODE = +100))                                 19860043
198700                                                                  19870043
198800         EXEC SQL                                                 19880043
198900              SELECT DISTINCT                                     19890043
199000                 MIN(A.DEPT_NBR),                                 19900043
199100                 MIN(B.CL_NBR),                                   19910043
199200                 MIN(B.AD_EVNT_DTE)                               19920043
199300                INTO                                              19930043
199400                     :PURCHS-DEPT-NBR,                            19940043
199500                     :PURITM-CL-NBR,                              19950043
199600                     :PURITM-AD-EVNT-DTE                          19960043
199700                FROM TPURCHS A,                                   19970043
199800                     TPURITM B                                    19980043
199900               WHERE A.PO_NBR         = B.PO_NBR                  19990043
200000                 AND A.VER_STATUS_CDE = 'A'                       20000043
200100                 AND A.VER_STATUS_CDE = B.VER_STATUS_CDE          20010043
200200                 AND B.PO_NBR         = :PV-PO-NBR                20020043
200300         END-EXEC                                                 20030043
200400                                                                  20040043
200500         EVALUATE TRUE                                            20050043
200600             WHEN SQLCODE = +0                                    20060043
200700                 MOVE PURCHS-DEPT-NBR                             20070043
200800                                     TO ASC-DEPT                  20080043
200900                 MOVE PURITM-CL-NBR  TO ASC-CLASS                 20090043
201000                 IF PURITM-AD-EVNT-DTE = '0001-01-01'             20100043
201100                     MOVE SPACES     TO PV-AD-CCYYMMDD            20110043
201200                 ELSE                                             20120043
201300                     MOVE PURITM-AD-EVNT-DTE                      20130043
201400                                         TO PV-AD-CCYYMMDD        20140043
201500                     MOVE PV-AD-MM       TO AADMMO                20150043
201600                                            ASC-AD-MM             20160043
201700                     MOVE PV-AD-DD       TO AADDDO                20170043
201800                                            ASC-AD-DD             20180043
201900                     MOVE PV-AD-YY       TO AADYYO                20190043
202000                                            ASC-AD-YY             20200043
202100                 END-IF                                           20210043
202200             WHEN SQLCODE = +100                                  20220043
202300                 MOVE SPACES         TO ASC-DEPT                  20230043
202400                                        ASC-CLASS                 20240043
202500                                        ASC-AD-DATE               20250043
202600             WHEN SQLCODE = -904                                  20260043
202700             WHEN SQLCODE = -913                                  20270043
202800                  CONTINUE                                        20280043
202900                                                                  20290043
203000             WHEN SQLWARN0 NOT = SPACES                           20300043
203100             WHEN SQLCODE < +0                                    20310043
203200             WHEN SQLCODE > +0                                    20320043
203300                  MOVE '2293-GET-PO-ITEM'                         20330043
203400                                   TO DP013-PARAGRAPH             20340043
203500                  MOVE 'UNSUCCESSFUL SELECT ON PO ITEM'           20350043
203600                                   TO DP013-MESSAGE-TEXT (1)      20360043
203700                  MOVE SQLCA       TO DP013-SQLCA                 20370043
203800                  MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)    20380043
203900                  SET DP013-DB2-ABEND                             20390043
204000                      DP013-XCTL-DISPLAY-RESTART                  20400043
204100                                   TO TRUE                        20410043
204200                  PERFORM DP013-0000-PROCESS-ABEND                20420043
204300         END-EVALUATE                                             20430043
204400     END-PERFORM.                                                 20440043
204500                                                                  20450043
204600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20460043
204700         MOVE '9050-GET-PURITM'    TO DP013-PARAGRAPH             20470043
204800         MOVE 'MAX RETRIES EXCEEDED ON SELECT FOR PO ITEM VER NBR'20480043
204900                                   TO DP013-MESSAGE-TEXT (1)      20490043
205000         MOVE SQLCA                TO DP013-SQLCA                 20500043
205100         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (1)    20510043
205200         SET DP013-DB2-ABEND                                      20520043
205300             DP013-XCTL-DISPLAY-RESTART                           20530043
205400                                   TO TRUE                        20540043
205500         PERFORM DP013-0000-PROCESS-ABEND                         20550043
205600     END-IF.                                                      20560043
205700                                                                  20570043
205800/                                                                 20580043
205900*----------------------------------------------------------------*20590043
206000*    READ THE DB2 P.O. SPECIAL INSTRUCTION DATABASE              *20600043
206100*----------------------------------------------------------------*20610043
206200                                                                  20620043
206300 2295-GET-PO-INSTRUCT.                                            20630043
206400                                                                  20640043
206500     INITIALIZE DCLTPOINST                                        20650043
206600                DCLTINSTCD.                                       20660043
206700                                                                  20670043
206800     MOVE ASC-PO-NBR-N           TO PV-PO-NBR.                    20680043
206900                                                                  20690043
207000     PERFORM                                                      20700043
207100         WITH TEST AFTER                                          20710043
207200         VARYING PV-RETRY-COUNTER                                 20720043
207300         FROM 1 BY 1                                              20730043
207400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20740043
207500            OR  (SQLCODE = ZERO)                                  20750043
207600            OR  (SQLCODE = +100)                                  20760043
207700            OR  (SQLCODE = -811))                                 20770043
207800                                                                  20780043
207900         EXEC SQL                                                 20790043
208000             SELECT                                               20800043
208100                     B.INSTR_DESC                                 20810043
208200               INTO  :INSTCD-INSTR-DESC                           20820043
208300               FROM  TPOINST A,                                   20830043
208400                     TINSTCD B                                    20840043
208500              WHERE  (A.PO_NBR     =  :PV-PO-NBR                  20850043
208600                AND   A.RECIP_CDE  =  'DC'                        20860043
208700                AND   A.INSTR_NBR  =  B.INSTR_NBR)                20870043
208800         END-EXEC                                                 20880043
208900                                                                  20890043
209000         EVALUATE TRUE                                            20900043
209100             WHEN SQLCODE = ZERO                                  20910043
209200                 MOVE INSTCD-INSTR-DESC                           20920043
209300                                     TO ASPCLO                    20930043
209400                                        ASC-SPECIAL-INST          20940043
209500                                                                  20950043
209600             WHEN SQLCODE = -904                                  20960043
209700             WHEN SQLCODE = -913                                  20970043
209800                 CONTINUE                                         20980043
209900             WHEN SQLCODE = +100                                  20990043
210000                 MOVE SPACES         TO ASPCLO                    21000043
210100                                        ASC-SPECIAL-INST          21010043
210200                                                                  21020043
210300             WHEN SQLCODE = -811                                  21030043
210400                 MOVE 'MULTIPLE SPEC INSTRUCTION'                 21040043
210500                                     TO ASPCLO                    21050043
210600                                        ASC-SPECIAL-INST          21060043
210700             WHEN SQLWARN0 NOT = SPACES                           21070043
210800             WHEN SQLCODE < ZERO                                  21080043
210900             WHEN SQLCODE > ZERO                                  21090043
211000                  MOVE '2295-GET-PO-INSTRUCT'                     21100043
211100                                     TO DP013-PARAGRAPH           21110043
211200                  MOVE 'SELECT SPECIAL INSTRUCTIONS  KEYS = '     21120043
211300                                     TO DP013-MESSAGE-TEXT (1)    21130043
211400                  MOVE PV-PO-NBR TO PV-DISPLAY-ORD-NBR            21140043
211500                  MOVE PV-DISPLAY-ORD-NBR                         21150043
211600                                     TO DP013-MESSAGE-TEXT (2)    21160043
211700                  MOVE SQLCA         TO DP013-SQLCA               21170043
211800                  MOVE 'TPOINST'     TO DP013-DB2-TABLE-NAME (1)  21180043
211900                  MOVE 'TINSTCD'     TO DP013-DB2-TABLE-NAME (2)  21190043
212000                  SET DP013-DB2-ABEND                             21200043
212100                                     TO TRUE                      21210043
212200                  SET DP013-NO-ROLLBACK                           21220043
212300                                     TO TRUE                      21230043
212400                  PERFORM DP013-0000-PROCESS-ABEND                21240043
212500         END-EVALUATE                                             21250043
212600     END-PERFORM.                                                 21260043
212700                                                                  21270043
212800     IF  PV-RETRY-COUNTER  > PC-MAX-RETRIES                       21280043
212900         MOVE '2295-GET-PO-INSTRUCT'                              21290043
213000                                     TO DP013-PARAGRAPH           21300043
213100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     21310043
213200                                     TO DP013-MESSAGE-TEXT (1)    21320043
213300         MOVE 'THE SPECIAL INSTRUCTIONS.  KEYS = '                21330043
213400                                     TO DP013-MESSAGE-TEXT (2)    21340043
213500         MOVE PV-PO-NBR              TO PV-DISPLAY-ORD-NBR        21350043
213600         MOVE PV-DISPLAY-ORD-NBR     TO DP013-MESSAGE-TEXT (3)    21360043
213700         MOVE SQLCA                  TO DP013-SQLCA               21370043
213800         MOVE 'TPOINST'              TO DP013-DB2-TABLE-NAME (1)  21380043
213900         MOVE 'TINSTCD'              TO DP013-DB2-TABLE-NAME (2)  21390043
214000         SET DP013-DB2-ABEND         TO TRUE                      21400043
214100         SET DP013-NO-ROLLBACK       TO TRUE                      21410043
214200         PERFORM DP013-0000-PROCESS-ABEND                         21420043
214300     END-IF.                                                      21430043
214400/                                                                 21440043
214500*----------------------------------------------------------------*21450043
214600*    GET ALL THE PERTINENT INFO                                  *21460043
214700*----------------------------------------------------------------*21470043
214800                                                                  21480043
214900 2298-GET-ALL-INFO.                                               21490043
215000                                                                  21500043
215100     PERFORM 2275-GET-RECEIVER-NBR.                               21510043
215200     PERFORM 2410-MOVE-RCVR-DATA.                                 21520043
215300     PERFORM 2400-GET-PROCESS-AREA.                               21530043
215400                                                                  21540043
215500     IF PS-PO-FOUND                                               21550043
215600         PERFORM 2293-GET-PO-ITEM                                 21560043
215700         PERFORM 2295-GET-PO-INSTRUCT                             21570043
215800         PERFORM 2285-SELECT-VENDOR-NAME                          21580043
215900                                                                  21590043
216000         PERFORM 2430-GET-PACKSLIP-IND                            21600043
216100                                                                  21610043
216200         IF PV-CCYYMMDD = '9999-09-09'                            21620043
216300             MOVE SPACES                 TO ARCVDMMO              21630043
216400                                            ASC-RCVD-MM           21640043
216500                                            ARCVDDDO              21650043
216600                                            ASC-RCVD-DD           21660043
216700                                            ARCVDYYO              21670043
216800                                            ASC-RCVD-YY           21680043
216900             MOVE 'ENROUTE'              TO ARCVDESO              21690043
217000                                            ASC-RCVD-DESC         21700043
217100         ELSE                                                     21710043
217200             MOVE PV-CCYYMMDD            TO PV-CCYYMMDD-REFORMAT  21720043
217300             MOVE PV-CCYYMMDD-MM         TO ARCVDMMO              21730043
217400                                            ASC-RCVD-MM           21740043
217500             MOVE PV-CCYYMMDD-DD         TO ARCVDDDO              21750043
217600                                            ASC-RCVD-DD           21760043
217700             MOVE PV-CCYYMMDD-YY         TO ARCVDYYO              21770043
217800                                            ASC-RCVD-YY           21780043
217900             MOVE SPACES                 TO ARCVDESO              21790043
218000                                            ASC-RCVD-DESC         21800043
218100                                                                  21810043
218200         IF SHPTPO-PKSL-IND   = PC-N                              21820043
218300             MOVE PC-Y               TO ASC-DETAIL-CHECK          21830043
218400                                        ADTLO                     21840043
218500         END-IF                                                   21850043
218600                                                                  21860043
218700         PERFORM 2435-SELECT-TRAILER-ID                           21870043
218800                                                                  21880043
218900     END-IF.                                                      21890043
219000                                                                  21900043
219100                                                                  21910043
219200/                                                                 21920043
219300*----------------------------------------------------------------*21930043
219400*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *21940043
219500*----------------------------------------------------------------*21950043
219600                                                                  21960043
219700 2300-MOVE-COMMAREA-TO-SCREEN.                                    21970043
219800                                                                  21980043
219900     MOVE ASC-OPER-UNT-ID-N      TO PV-SUPPRESS-FOUR              21990043
220000     MOVE PV-SUPPRESS-FOUR       TO AOPUNITO                      22000043
220100     MOVE ASC-FCLTY-ID-N         TO PV-SUPPRESS-FOUR              22010043
220200     MOVE PV-SUPPRESS-FOUR       TO AFACILO                       22020043
220300     MOVE ASC-PRTR-ID            TO APRTRO.                       22030043
220400     MOVE ASC-PRTR-DESC          TO APRDESCO.                     22040043
220500     MOVE ASC-PRC-AREA           TO AAREAO.                       22050043
220600     MOVE ASC-CART-CT            TO ACRTNO.                       22060043
220700     MOVE ASC-PO-NBR             TO APOO.                         22070043
220800     MOVE ASC-RCVR-SEQ-NBR       TO ASEQO.                        22080043
220900     MOVE ASC-RCVD-MM            TO ARCVDMMO.                     22090043
221000     MOVE ASC-RCVD-DD            TO ARCVDDDO.                     22100043
221100     MOVE ASC-RCVD-YY            TO ARCVDYYO.                     22110043
221200     MOVE ASC-RCVD-DESC          TO ARCVDESO.                     22120043
221300     MOVE ASC-VEND-NAME          TO AVNDRO.                       22130043
221400     MOVE ASC-AD-MM              TO AADMMO.                       22140043
221500     MOVE ASC-AD-DD              TO AADDDO.                       22150043
221600     MOVE ASC-AD-YY              TO AADYYO.                       22160043
221700     MOVE ASC-PIC-INFO           TO APICO.                        22170043
221800     MOVE ASC-MULT-SHIP          TO AMSHIPO.                      22180043
221900     MOVE ASC-SPECIAL-INST       TO ASPCLO.                       22190043
222000     MOVE ASC-PRE-TKT            TO APRETKTO.                     22200043
222100     MOVE ASC-PACKED-BY-STR      TO APACKO.                       22210043
222200     MOVE ASC-DETAIL-CHECK       TO ADTLO.                        22220043
222300     MOVE ASC-GARMENT-ON-HANGER  TO AHANGRO.                      22230043
222400     MOVE ASC-TICKET-TYPE        TO ATKTO.                        22240043
222500                                                                  22250043
222600*----------------------------------------------------------------*22260043
222700*  CHECK THE TROUBLE INDICATOR AND MOVE THE PROCESSING AREA      *22270043
222800*----------------------------------------------------------------*22280043
222900 2400-GET-PROCESS-AREA.                                           22290043
223000     MOVE ASC-FCLTY-ID-N         TO PC-FCLTY-ID                   22300043
223100     MOVE ASC-OPER-UNT-ID-N      TO PC-OPER-UNT-ID                22310043
223200     PERFORM 2440-GET-OPER-SET-DESC                               22320043
223300     MOVE OPRSET-CNTL-DESC       TO ASC-PRC-AREA                  22330043
223400                                    AAREAO.                       22340043
223500                                                                  22350043
223600     PERFORM 2450-CHECK-MULT-SHIPMENTS.                           22360043
223700                                                                  22370043
223800     IF PV-SHIPMENT-COUNT > 1                                     22380043
223900         MOVE PC-Y               TO ASC-MULT-SHIP                 22390043
224000                                    AMSHIPO                       22400043
224100     ELSE                                                         22410043
224200         MOVE PC-N               TO ASC-MULT-SHIP                 22420043
224300                                    AMSHIPO                       22430043
224400     END-IF.                                                      22440043
224500                                                                  22450043
224600/                                                                 22460043
224700*----------------------------------------------------------------*22470043
224800*  MOVE FIELDS FROM THE RECEIVER TABLE                           *22480043
224900*----------------------------------------------------------------*22490043
225000 2410-MOVE-RCVR-DATA.                                             22500043
225100                                                                  22510043
225200     IF RECEIV-ACTL-CART-CNT > 0                                  22520043
225300         MOVE RECEIV-ACTL-CART-CNT                                22530043
225400                                 TO ASC-CART-CT-N                 22540043
225500         MOVE ASC-CART-CT        TO ACRTNO                        22550043
225600     ELSE                                                         22560043
225700         IF RECEIV-EXPTED-CART-CNT > 0                            22570043
225800             MOVE RECEIV-EXPTED-CART-CNT                          22580043
225900                                 TO ASC-CART-CT-N                 22590043
226000             MOVE ASC-CART-CT    TO ACRTNO                        22600043
226100         ELSE                                                     22610043
226200             MOVE ZERO           TO ASC-CART-CT-N                 22620043
226300             MOVE ASC-CART-CT    TO ACRTNO                        22630043
226400         END-IF                                                   22640043
226500     END-IF.                                                      22650043
226600                                                                  22660043
226700     IF RECEIV-PRE-TKT-IND = PC-Y                                 22670043
226800         MOVE PC-Y               TO APRETKTO                      22680043
226900                                    ASC-PRE-TKT                   22690043
227000     END-IF.                                                      22700043
227100                                                                  22710043
227200     IF RECEIV-PACK-BY-ST-IND = PC-Y                              22720043
227300         MOVE PC-Y               TO APACKO                        22730043
227400                                    ASC-PACKED-BY-STR             22740043
227500     END-IF.                                                      22750043
227600                                                                  22760043
227700     IF RECEIV-GOH-IND = PC-Y                                     22770043
227800         MOVE PC-Y               TO AHANGRO                       22780043
227900                                    ASC-GARMENT-ON-HANGER         22790043
228000     END-IF.                                                      22800043
228100                                                                  22810043
228200     MOVE RECEIV-AD-INFO-DESC    TO APICO                         22820043
228300                                    ASC-PIC-INFO.                 22830043
228400                                                                  22840043
228500/                                                                 22850043
228600*----------------------------------------------------------------*22860043
228700*    RETRIEVE PACKSLIP-IND FROM SHIPPO.                          *22870043
228800*----------------------------------------------------------------*22880043
228900 2430-GET-PACKSLIP-IND.                                           22890043
229000                                                                  22900043
229100     INITIALIZE DCLTSHIPMT                                        22910043
229200                DCLTSHPTPO.                                       22920043
229300                                                                  22930043
229400     MOVE ASC-PO-NBR-N           TO PV-PO-NBR.                    22940043
229500                                                                  22950043
229600     PERFORM                                                      22960043
229700         WITH TEST AFTER                                          22970043
229800         VARYING PV-RETRY-COUNTER                                 22980043
229900         FROM 1 BY 1                                              22990043
230000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23000043
230100                   OR (SQLCODE = ZERO)                            23010043
230200                   OR (SQLCODE = +100))                           23020043
230300                                                                  23030043
230400         EXEC SQL                                                 23040043
230500              SELECT                                              23050043
230600                 MAX(A.EST_AR_TMST),                              23060043
230700                 MAX(B.PKSL_IND)                                  23070043
230800                INTO :SHIPMT-EST-AR-TMST                          23080043
230900                     :PV-EST-AR-TMST-NULL,                        23090043
231000                     :SHPTPO-PKSL-IND                             23100043
231100                FROM TSHIPMT A,                                   23110043
231200                     TSHPTPO B                                    23120043
231300               WHERE B.PO_NBR           = :PV-PO-NBR              23130043
231400                 AND A.SHIPT_ID         = B.SHIPT_ID              23140043
231500         END-EXEC                                                 23150043
231600                                                                  23160043
231700         EVALUATE TRUE                                            23170043
231800             WHEN SQLCODE = ZERO                                  23180043
231900             WHEN SQLCODE = -305                                  23190043
232000             WHEN SQLCODE = +100                                  23200043
232100             WHEN SQLCODE = -904                                  23210043
232200             WHEN SQLCODE = -913                                  23220043
232300                  CONTINUE                                        23230043
232400             WHEN SQLWARN0 NOT = SPACES                           23240043
232500             WHEN SQLCODE < ZERO                                  23250043
232600             WHEN SQLCODE > ZERO                                  23260043
232700                  MOVE '2430-GET-PACKSLIP-IND'                    23270043
232800                                   TO DP013-PARAGRAPH             23280043
232900                  MOVE 'SELECT PROC AREA FRO TDCTFAS:'            23290043
233000                                   TO DP013-MESSAGE-TEXT (1)      23300043
233100                  MOVE SQLCA       TO DP013-SQLCA                 23310043
233200                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)    23320043
233300                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)    23330043
233400                  SET DP013-DB2-ABEND                             23340043
233500                      DP013-XCTL-DISPLAY-RESTART                  23350043
233600                                   TO TRUE                        23360043
233700                  PERFORM DP013-0000-PROCESS-ABEND                23370043
233800         END-EVALUATE                                             23380043
233900     END-PERFORM.                                                 23390043
234000                                                                  23400043
234100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23410043
234200         MOVE '2430-GET-PACKSLIP-IND'                             23420043
234300                                   TO DP013-PARAGRAPH             23430043
234400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     23440043
234500                                   TO DP013-MESSAGE-TEXT (1)      23450043
234600         MOVE 'ATTEMPT TO SELECT TSHIPMT & TSHPTPO'               23460043
234700                                   TO DP013-MESSAGE-TEXT (2)      23470043
234800         MOVE SQLCA                TO DP013-SQLCA                 23480043
234900         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    23490043
235000         MOVE 'TSHPTPO'            TO DP013-DB2-TABLE-NAME (2)    23500043
235100         SET DP013-DB2-ABEND                                      23510043
235200             DP013-XCTL-DISPLAY-RESTART                           23520043
235300                                   TO TRUE                        23530043
235400         PERFORM DP013-0000-PROCESS-ABEND                         23540043
235500     END-IF.                                                      23550043
235600*----------------------------------------------------------------*23560043
235700*    RETRIEVE TRAILER ID FROM TVHTRIP.                           *23570043
235800*----------------------------------------------------------------*23580043
235900                                                                  23590043
236000 2435-SELECT-TRAILER-ID.                                          23600043
236100                                                                  23610043
236200     EXEC SQL                                                     23620043
236300         SELECT C.TRIP_ID                                         23630043
236400          INTO  :VHTRIP-TRIP-ID                                   23640043
236500           FROM TSHPTPO A                                         23650043
236600              , TSHIPMT B                                         23660043
236700              , TVHTRIP C                                         23670043
236800          WHERE A.PO_NBR         = :PV-PO-NBR                     23680043
236900            AND A.REC_SEQ_NBR    = :PV-RCVR-SEQ-NBR               23690043
237000            AND A.SHIPT_ID       = B.SHIPT_ID                     23700043
237100            AND B.TRIP_ID        = C.TRIP_ID                      23710043
237200            AND A.PRIM_SHIPT_IND = :PC-Y                          23720043
237300     END-EXEC.                                                    23730043
237400                                                                  23740043
237500     EVALUATE TRUE                                                23750043
237600         WHEN SQLCODE = ZERO                                      23760043
237700             MOVE VHTRIP-TRIP-ID TO                               23770043
237800                                    PC140-HL-TRIP-ID              23780043
237900                                    PC014-TRIP-ID                 23790043
238000                                    ASC-TRIP-ID                   23800043
238100         WHEN SQLCODE = +100                                      23810043
238200             MOVE SPACES         TO                               23820043
238300                                    PC140-HL-TRIP-ID              23830043
238400                                    PC014-TRIP-ID                 23840043
238500         WHEN SQLCODE = -904                                      23850043
238600         WHEN SQLCODE = -911                                      23860043
238700         WHEN SQLCODE = -913                                      23870043
238800               CONTINUE                                           23880043
238900         WHEN SQLWARN0 NOT = SPACE                                23890043
239000         WHEN SQLCODE < ZERO                                      23900043
239100         WHEN SQLCODE > ZERO                                      23910043
239200                  MOVE '2435-SELECT-TRAILER-ID'                   23920043
239300                                  TO DP013-PARAGRAPH              23930043
239400                  MOVE 'UNSUCCESSFUL SELECT ON TVHTRIP  '         23940043
239500                                  TO DP013-MESSAGE-TEXT (1)       23950043
239600                  MOVE SQLCA      TO DP013-SQLCA                  23960043
239700                  MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (1)     23970043
239800                  MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (2)     23980043
239900                  MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (3)     23990043
240000                  SET DP013-DB2-ABEND                             24000043
240100                      DP013-XCTL-DISPLAY-RESTART                  24010043
240200                                  TO TRUE                         24020043
240300                  PERFORM DP013-0000-PROCESS-ABEND                24030043
240400                                                                  24040043
240500     END-EVALUATE.                                                24050043
240600                                                                  24060043
240700                                                                  24070043
240800/                                                                 24080043
240900 2440-GET-OPER-SET-DESC.                                          24090043
241000                                                                  24100043
241100     PERFORM                                                      24110043
241200         WITH TEST AFTER                                          24120043
241300         VARYING PV-RETRY-COUNTER                                 24130043
241400         FROM 1 BY 1                                              24140043
241500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24150043
241600             OR (SQLCODE = +0)                                    24160043
241700             OR (SQLCODE = +100))                                 24170043
241800                                                                  24180043
241900         EXEC SQL                                                 24190043
242000            SELECT  DISTINCT                                      24200043
242100                    C.CNTL_DESC                                   24210043
242200              INTO :OPRSET-CNTL-DESC                              24220043
242300              FROM  TRECEIV A                                     24230043
242400                   ,TWRKORD B                                     24240043
242500                   ,TOPRSET C                                     24250043
242600             WHERE  A.OPER_UNT_ID    = :PC-OPER-UNT-ID            24260043
242700               AND  A.FCLTY_ID       = :PC-FCLTY-ID               24270043
242800               AND  A.ORD_NBR        = :PV-PO-NBR                 24280043
242900               AND  A.REC_SEQ_NBR    = :PV-RCVR-SEQ-NBR           24290043
243000               AND  B.ORD_LNE_NBR    = 0                          24300043
243100               AND  A.VER_STATUS_CDE = 'A'                        24310043
243200               AND  B.VER_STATUS_CDE = 'A'                        24320043
243300               AND  A.ORD_NBR        = B.ORD_NBR                  24330043
243400               AND  A.REC_SEQ_NBR    = B.RCVR_SEQ_NBR             24340043
243500               AND  B.OPER_SET_ID    = C.OPER_SET_ID              24350043
243510               AND  C.OPER_UNT_ID    = A.CURR_OPER_UNT_ID         24351050
243600         END-EXEC                                                 24360043
243700                                                                  24370043
243800         EVALUATE TRUE                                            24380043
243900             WHEN SQLCODE = +0                                    24390043
244000             WHEN SQLCODE = +100                                  24400043
244100             WHEN SQLCODE = -904                                  24410043
244200             WHEN SQLCODE = -913                                  24420043
244300                  CONTINUE                                        24430043
244400                                                                  24440043
244500             WHEN SQLWARN0 NOT = SPACES                           24450043
244600             WHEN SQLCODE < +0                                    24460043
244700             WHEN SQLCODE > +0                                    24470043
244800                  MOVE '2440-GET-OPER-SET-DESC'                   24480043
244900                                  TO DP013-PARAGRAPH              24490043
245000                  MOVE 'UNSUCCESSFUL SELECT ON TOPRSET  '         24500043
245100                                  TO DP013-MESSAGE-TEXT (1)       24510043
245200                  MOVE SQLCA      TO DP013-SQLCA                  24520043
245300                  MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)     24530043
245400                  MOVE 'TWRKORD ' TO DP013-DB2-TABLE-NAME (2)     24540043
245500                  MOVE 'TOPRSET ' TO DP013-DB2-TABLE-NAME (3)     24550043
245600                  SET DP013-DB2-ABEND                             24560043
245700                      DP013-XCTL-DISPLAY-RESTART                  24570043
245800                                  TO TRUE                         24580043
245900                  PERFORM DP013-0000-PROCESS-ABEND                24590043
246000         END-EVALUATE                                             24600043
246100     END-PERFORM.                                                 24610043
246200                                                                  24620043
246300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24630043
246400         MOVE '2440-GET-OPER-SET-DESC'                            24640043
246500                                  TO DP013-PARAGRAPH              24650043
246600         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TOPRSET  '       24660043
246700                                  TO DP013-MESSAGE-TEXT (1)       24670043
246800         MOVE SQLCA               TO DP013-SQLCA                  24680043
246900         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     24690043
247000         MOVE 'TWRKORD '          TO DP013-DB2-TABLE-NAME (2)     24700043
247100         MOVE 'TOPRSET '          TO DP013-DB2-TABLE-NAME (3)     24710043
247200         SET DP013-DB2-ABEND                                      24720043
247300             DP013-XCTL-DISPLAY-RESTART                           24730043
247400                                  TO TRUE                         24740043
247500         PERFORM DP013-0000-PROCESS-ABEND                         24750043
247600     END-IF.                                                      24760043
247700                                                                  24770043
247800/                                                                 24780043
247900*----------------------------------------------------------------*24790043
248000*    CHECK IF THERE ARE MULTIPLE SHIPMENTS FOR THIS RECEIVER     *24800043
248100*----------------------------------------------------------------*24810043
248200 2450-CHECK-MULT-SHIPMENTS.                                       24820043
248300                                                                  24830043
248400     INITIALIZE PV-SHIPMENT-COUNT.                                24840043
248500                                                                  24850043
248600     PERFORM                                                      24860043
248700         WITH TEST AFTER                                          24870043
248800         VARYING PV-RETRY-COUNTER                                 24880043
248900         FROM 1 BY 1                                              24890043
249000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24900043
249100            OR (SQLCODE = +0)                                     24910043
249200            OR (SQLCODE = +100))                                  24920043
249300                                                                  24930043
249400         EXEC SQL                                                 24940043
249500            SELECT COUNT(*)                                       24950043
249600              INTO :PV-SHIPMENT-COUNT                             24960043
249700              FROM TSHPTPO                                        24970043
249800          WHERE PO_NBR      = :PV-PO-NBR                          24980043
249900            AND REC_SEQ_NBR = :PV-RCVR-SEQ-NBR                    24990043
250000         END-EXEC                                                 25000043
250100                                                                  25010043
250200         EVALUATE TRUE                                            25020043
250300             WHEN SQLCODE = +0                                    25030043
250400             WHEN SQLCODE = +100                                  25040043
250500             WHEN SQLCODE = -904                                  25050043
250600             WHEN SQLCODE = -913                                  25060043
250700                 CONTINUE                                         25070043
250800                                                                  25080043
250900             WHEN SQLWARN0 NOT = SPACE                            25090043
251000             WHEN SQLCODE < +0                                    25100043
251100             WHEN SQLCODE > +0                                    25110043
251200                 MOVE '2450-CHECK-MULT-SHIPMENTS'                 25120043
251300                                 TO DP013-PARAGRAPH               25130043
251400                 MOVE 'COUNT MULTIPLE SHIPMENTS'                  25140043
251500                                 TO DP013-MESSAGE-TEXT (1)        25150043
251600                 MOVE SQLCA      TO DP013-SQLCA                   25160043
251700                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)      25170043
251800                 SET DP013-DB2-ABEND                              25180043
251900                                 TO TRUE                          25190043
252000                 SET DP013-XCTL-DISPLAY-RESTART                   25200043
252100                                 TO TRUE                          25210043
252200                 PERFORM DP013-0000-PROCESS-ABEND                 25220043
252300         END-EVALUATE                                             25230043
252400     END-PERFORM.                                                 25240043
252500                                                                  25250043
252600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25260043
252700             AND (SQLCODE = -904 OR -913)                         25270043
252800         MOVE '2450-CHECK-MULT-SHIPMENTS'                         25280043
252900                                 TO DP013-PARAGRAPH               25290043
253000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO COUNT'      25300043
253100                                 TO DP013-MESSAGE-TEXT (1)        25310043
253200         MOVE 'MULTIPLE SHIPMENTS'                                25320043
253300                                 TO DP013-MESSAGE-TEXT (2)        25330043
253400         MOVE SQLCA              TO DP013-SQLCA                   25340043
253500         MOVE 'TSHPTPO'          TO DP013-DB2-TABLE-NAME (1)      25350043
253600         SET DP013-DB2-ABEND     TO TRUE                          25360043
253700         SET DP013-XCTL-DISPLAY-RESTART                           25370043
253800                                 TO TRUE                          25380043
253900         PERFORM DP013-0000-PROCESS-ABEND                         25390043
254000     END-IF.                                                      25400043
254100                                                                  25410043
254200/                                                                 25420043
254300*----------------------------------------------------------------*25430043
254400*    NO INFORMATION IS DEFAULTED TO, DISPLAY BLANK MAP.          *25440043
254500*----------------------------------------------------------------*25450043
254600                                                                  25460043
254700 3000-BUILD-INITIAL-PANEL.                                        25470043
254800                                                                  25480043
254900     SET DP030-SET-CURSOR-APPL-1 TO TRUE                          25490043
255000     MOVE -1                     TO APRTRL.                       25500043
255100     MOVE PC-N                   TO ADTLO                         25510043
255200                                    ASC-DETAIL-CHECK.             25520043
255300                                                                  25530043
255400*    *-------------------------------------*                      25540043
255500*    * DEFAULT OPERATING UNIT AND FACILITY *                      25550043
255600*    *-------------------------------------*                      25560043
255700     PERFORM 3300-FORMAT-OP-UNIT                                  25570043
255800                                                                  25580043
255900     PERFORM 3400-FORMAT-FCLTY-ID                                 25590043
256000                                                                  25600043
256100     PERFORM 3200-DISPLAY-PANEL.                                  25610043
256200                                                                  25620043
256300                                                                  25630043
256400*----------------------------------------------------------------*25640043
256500*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.      *25650043
256600*                                                                *25660043
256700*    PERFORMED BY 1000-CONTROL-PROCESSING.                       *25670043
256800*    PERFORMED BY 3000-PROCESS-PANEL.                            *25680043
256900*----------------------------------------------------------------*25690043
257000                                                                  25700043
257100 3200-DISPLAY-PANEL.                                              25710043
257200                                                                  25720043
257300     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            25730043
257400     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           25740043
257500/                                                                 25750043
257600 3300-FORMAT-OP-UNIT.                                             25760043
257700                                                                  25770043
257800     MOVE DP020-LOCATION-NBR     TO DP010I-UNEDITED-FIELD         25780045
257900     MOVE +4                     TO DP010I-MAXIMUM-DIGITS         25790043
258000     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS       25800043
258100                                                                  25810043
258200     SET DP010I-NEGATIVE-NOT-ALLOWED                              25820043
258300                                 TO TRUE                          25830043
258400                                                                  25840043
258510     CALL DP010I-NUMERIC-EDIT-ROUTINE                             25851054
258520                         USING DP010I-NUMERIC-EDIT-AREA           25852054
258600                                                                  25860043
258700     IF DP010I-NO-ERROR-DETECTED                                  25870043
258800         MOVE DP010I-NUMERIC-FIELD                                25880043
258900                                 TO PV-PIC9-FOUR                  25890043
259000         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              25900043
259100         MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                      25910043
259200                                    ASC-OPER-UNT-ID               25920043
259300     ELSE                                                         25930043
259400         MOVE DP020-LOCATION-NBR TO PV-PICX-FOUR                  25940045
259500         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              25950043
259600         MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                      25960043
259700                                    ASC-OPER-UNT-ID               25970043
259800                                                                  25980043
259900     .                                                            25990043
260000/                                                                 26000043
260100 3400-FORMAT-FCLTY-ID.                                            26010043
260200                                                                  26020043
260300     MOVE DP020-FCLTY-ID         TO DP010I-UNEDITED-FIELD         26030043
260400     MOVE +4                     TO DP010I-MAXIMUM-DIGITS         26040043
260500     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS       26050043
260600                                                                  26060043
260700     SET DP010I-NEGATIVE-NOT-ALLOWED                              26070043
260800                                 TO TRUE                          26080043
260900                                                                  26090043
261010     CALL DP010I-NUMERIC-EDIT-ROUTINE                             26101054
261020                         USING DP010I-NUMERIC-EDIT-AREA           26102054
261100                                                                  26110043
261200     IF DP010I-NO-ERROR-DETECTED                                  26120043
261300         MOVE DP010I-NUMERIC-FIELD                                26130043
261400                                 TO PV-PIC9-FOUR                  26140043
261500         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              26150043
261600         MOVE PV-SUPPRESS-FOUR   TO AFACILO                       26160043
261700                                    ASC-FCLTY-ID-N                26170043
261800     ELSE                                                         26180043
261900         MOVE DP020-FCLTY-ID     TO AFACILO                       26190045
262000                                    ASC-FCLTY-ID                  26200043
262100         SET PS-ERROR            TO TRUE                          26210043
262200         SET DP020-MSG-FATAL     TO TRUE                          26220043
262300         MOVE PC-TSYMSG-00005                                     26230043
262400                                 TO DP020-MSG-NUMBER              26240043
262500         MOVE DP015-UNP-ALP-BRT-OFF                               26250043
262600                                 TO AFACILA                       26260043
262700         MOVE DP015-RED          TO AFACILC                       26270043
262800         MOVE DP015-REVERSE      TO AFACILH                       26280043
262900         MOVE -1                 TO AFACILL                       26290043
263000         SET DP030-SET-CURSOR-APPL-1                              26300043
263100                                 TO TRUE                          26310043
263200     .                                                            26320043
263300 EJECT                                                            26330043
263400*----------------------------------------------------------------*26340043
263500*                                                                *26350043
263600*----------------------------------------------------------------*26360043
263700 3500-GET-DC-LOCATION.                                            26370043
263800     EXEC SQL                                                     26380043
263900          SELECT LOC_5_ABBR_NM                                    26390044
264000          INTO  :PV-DC-5-CHAR-ABBR                                26400043
264100          FROM   XLT_LOC                                          26410044
264200          WHERE  LOC_TYP_CDE = 'DC'                               26420044
264300          AND    LOC_NBR     = :PC-OPER-UNT-ID                    26430044
264400     END-EXEC.                                                    26440043
264500                                                                  26450043
264600     EVALUATE TRUE                                                26460043
264700         WHEN SQLCODE = ZERO                                      26470043
264800              MOVE  PV-2-DIGIT-DC-ABBR  TO  PC140-CRA-DC-ID       26480043
264900              MOVE  PC-OPER-UNT-ID      TO  PC140-CRA-OPER-UNT-ID 26490043
265000                                                                  26500043
265100         WHEN SQLCODE = +100                                      26510043
265200              MOVE  PC-90   TO  PC140-CRA-DC-ID                   26520043
265300                                PC140-CRA-OPER-UNT-ID             26530043
265400                                                                  26540043
265500         WHEN SQLWARN0 NOT = SPACES                               26550043
265600         WHEN SQLCODE NOT EQUAL ZERO                              26560043
265700             MOVE '3500-GET-DC-LOCATION'                          26570043
265800                             TO DP013-PARAGRAPH                   26580043
265900             MOVE 'PCKCS112 - GET DC LOCATION CODE'               26590043
266000                             TO DP013-MESSAGE-TEXT(1)             26600043
266100             MOVE PC140-CRA-DC-ID                                 26610043
266200                             TO DP013-MESSAGE-TEXT(2)             26620043
266300             MOVE SQLCA      TO DP013-SQLCA                       26630043
266400             MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME(1)           26640044
266500             SET DP013-DB2-ABEND                                  26650043
266600                             TO TRUE                              26660043
266700             SET DP013-NO-ROLLBACK                                26670043
266800                             TO TRUE                              26680043
266900             SET DP013-XCTL-DISPLAY-RESTART                       26690043
267000                             TO TRUE                              26700043
267100             PERFORM DP013-0000-PROCESS-ABEND                     26710043
267200     END-EVALUATE.                                                26720043
267300                                                                  26730043
267400 4000-SETUP-LABELS.                                               26740043
267500                                                                  26750043
267600                                                                  26760043
267700     SET PC140-COMMON-HDR-LBL-NBR       TO TRUE.                  26770043
267800                                                                  26780043
267900     MOVE PC-LABEL-FORMAT        TO PC014-LBL-FMT.                26790043
268000     MOVE ASC-PRTR-ID            TO                               26800043
268100                                    PC140-HL-PRTR-ID              26810043
268200                                    PC014-PRTR-ID.                26820043
268300     MOVE ASC-PRTR-DESC          TO PC014-PRTR-DESC.              26830043
268400     MOVE ASC-PRC-AREA           TO                               26840043
268500                                    PC140-HL-PRC-AREA-TX          26850043
268600                                    PC014-PRC-AREA.               26860043
268700                                                                  26870043
268800     IF ASC-TRIP-ID = ZERO                                        26880043
268900          MOVE SPACES            TO                               26890043
269000                                    PC140-HL-TRIP-ID              26900043
269100                                    PC014-TRIP-ID                 26910043
269200     ELSE                                                         26920043
269300          MOVE ASC-TRIP-ID       TO                               26930043
269400                                    PC140-HL-TRIP-ID              26940043
269500                                    PC014-TRIP-ID                 26950043
269600     END-IF                                                       26960043
269700                                                                  26970043
269800     MOVE ASC-PRC-AREA-CDE       TO                               26980043
269900                                    PC140-HL-PRC-AREA-3           26990043
270000                                    PC014-PRC-AREA-CDE.           27000043
270100     MOVE ASC-CART-CT            TO                               27010043
270200                                    PC140-HL-CART-CT              27020043
270300                                    PC014-CART-CT.                27030043
270400     MOVE ASC-OPER-UNT-ID        TO PC014-OPER-UNT-ID.            27040043
270500     MOVE ASC-FCLTY-ID           TO PC014-FCLTY-ID.               27050043
270600     MOVE ASC-RCVD-MM            TO PV-MM.                        27060043
270700     MOVE ASC-RCVD-DD            TO PV-DD.                        27070043
270800     MOVE ASC-RCVD-YY            TO PV-YY.                        27080043
270900                                                                  27090043
271000     IF ASC-RCVD-DATE = SPACES                                    27100043
271100     AND ASC-RCVD-DESC = 'ENROUTE'                                27110043
271200        MOVE 'ENROUTE'           TO                               27120043
271300                                    PC140-HL-RCVD-MM-DD-YY        27130043
271400*** BY CHANGING FROM 09-09-99 TO '09099999', AN 88-LEVEL CAN BE   27140043
271500*** CHECKED IN THE FOLLOWING PROGRAM FOR ENROUTE.                 27150043
271600        MOVE '09099999'          TO PC014-RCVD-DATE               27160043
271700     ELSE                                                         27170043
271800        MOVE PV-FORMAT-DATE      TO                               27180043
271900                                    PC140-HL-RCVD-MM-DD-YY        27190043
272000                                    PC014-RCVD-DATE               27200043
272100     END-IF.                                                      27210043
272200     MOVE ASC-VEND-NAME          TO                               27220043
272300                                    PC140-HL-VEND-NAME            27230043
272400                                    PC014-VEND-NAME.              27240043
272500     MOVE ASC-PO-NBR             TO                               27250043
272510                                    PC140-HL-PO-NBR               27251043
272520                                    PC014-PO-NBR                  27252043
272530                                    PC014-PO-NBR-OLD.             27253043
272540     MOVE ASC-RCVR-SEQ-NBR       TO PV-RCVR-SEQ                   27254043
272550                                    PC140-HL-RCVR-SEQ-NBR-TX      27255043
272560                                    PC014-RCVR-SEQ-NBR            27256043
272570                                    PC014-RCVR-SEQ-NBR-TX         27257043
272580                                    PC014-RCVR-SEQ-NBR-OLD.       27258043
272590                                                                  27259043
272600                                                                  27260043
272700     STRING PC140-HL-PO-NBR         DELIMITED BY SIZE             27270043
272800            PC140-HL-RCVR-SEQ-NBR-TX                              27280043
272900                                    DELIMITED BY SIZE             27290043
273000                               INTO PC140-HL-RCVR-NBR.            27300043
273100                                                                  27310043
273200     MOVE ASC-AD-MM              TO PV-MM.                        27320043
273300     MOVE ASC-AD-DD              TO PV-DD.                        27330043
273400     MOVE ASC-AD-YY              TO PV-YY.                        27340043
273500     MOVE PV-FORMAT-DATE         TO                               27350043
273600                                    PC140-HL-AD-MM-DD-YY          27360043
273700                                    PC014-AD-DATE.                27370043
273800     MOVE ASC-PIC-INFO           TO                               27380043
273900                                    PC140-HL-PIC-TX               27390043
274000                                    PC014-PIC-INFO.               27400043
274100                                                                  27410043
274200     IF ASC-MULT-SHIP = PC-N OR SPACES                            27420043
274300         MOVE SPACES             TO                               27430043
274400                                    PC140-HL-MULT-SHIPMENTS-TX    27440043
274500                                    PC014-MULT-SHIPMENTS          27450043
274600     ELSE                                                         27460043
274700         MOVE PC-MULTIPLE-SHIPMENTS                               27470043
274800                                 TO                               27480043
274900                                    PC140-HL-MULT-SHIPMENTS-TX    27490043
275000         MOVE PC-Y               TO PC014-MULT-SHIPMENTS          27500043
275100                                                                  27510043
275200                                                                  27520043
275300     IF ASC-SPECIAL-INST = SPACES                                 27530043
275400        CONTINUE                                                  27540043
275500     ELSE                                                         27550043
275510        SET PC140-CRA-SPC-INSTR    TO TRUE                        27551043
275520     END-IF.                                                      27552043
275530                                                                  27553043
275540     MOVE ASC-SPECIAL-INST       TO                               27554043
275550                                    PC140-HL-SPECIAL-TX           27555043
275560                                    PC014-SPECIAL-INST.           27556043
275570                                                                  27557043
275580     IF ASC-PRE-TKT = PC-N OR SPACES                              27558043
275590         MOVE SPACES             TO                               27559043
275600                                    PC140-HL-PRE-TKT-TX           27560043
275700                                    PC014-PRE-TKT                 27570043
275800     ELSE                                                         27580043
275900         MOVE PC-PRE-TICKETED    TO                               27590043
276000                                    PC140-HL-PRE-TKT-TX           27600043
276100         MOVE PC-Y               TO PC014-PRE-TKT                 27610043
276200     END-IF.                                                      27620043
276300                                                                  27630043
276400     IF ASC-PACKED-BY-STR = PC-N OR SPACES                        27640043
276500         MOVE SPACES             TO                               27650043
276600                                    PC140-HL-PACKED-BY-TX         27660043
276700     ELSE                                                         27670043
276800         MOVE PC-PACKED-BY-STORE TO                               27680043
276900                                    PC140-HL-PACKED-BY-TX         27690043
277000     END-IF.                                                      27700043
277100                                                                  27710043
277200     IF ASC-GARMENT-ON-HANGER = PC-N OR SPACES                    27720043
277210         MOVE SPACES             TO                               27721043
277220                                    PC140-HL-ON-HANGER-TX         27722043
277230                                    PC014-GARMENT-ON-HANGER       27723043
277240     ELSE                                                         27724043
277250         MOVE PC-ON-HANGER       TO                               27725043
277260                                    PC140-HL-ON-HANGER-TX         27726043
277270         MOVE PC-Y               TO PC014-GARMENT-ON-HANGER       27727043
277280     END-IF                                                       27728043
277290                                                                  27729043
277300     MOVE PC140-HL-PACKED-BY-TX  TO PC014-PACKED-BY-STR.          27730043
277400     MOVE ASC-TICKET-TYPE        TO                               27740043
277410                                    PC140-HL-TICKET-TYPE          27741043
277420                                    PC014-TICKET-TYPE.            27742043
277430     MOVE ASC-DEPT               TO                               27743043
277440                                    PC140-HL-DEPT                 27744043
277450                                    PC014-DEPT.                   27745043
277460     MOVE ASC-CLASS              TO                               27746043
277470                                    PC140-HL-CLASS                27747043
277480                                    PC014-CLASS.                  27748043
277490                                                                  27749043
277500     IF ASC-DETAIL-CHECK = PC-Y                                   27750043
277600         MOVE PC-DETAIL-CHECK    TO                               27760043
277700                                    PC140-HL-DETAIL-CHECK         27770043
277800         MOVE PC-Y               TO PC014-DETAIL-CHECK            27780043
277900     ELSE                                                         27790043
278000         MOVE SPACES             TO                               27800043
278100                                    PC140-HL-DETAIL-CHECK         27810043
278200                                    PC014-DETAIL-CHECK            27820043
278300     END-IF.                                                      27830043
278400                                                                  27840043
278500     IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                    27850043
278600       AND PC140-SOCKET-INTFC                                     27860043
278700         PERFORM 4200-LINK-SOCKET-PRINT-ROUTINE                   27870043
278800     END-IF.                                                      27880043
278900/                                                                 27890043
279000 4200-LINK-SOCKET-PRINT-ROUTINE.                                  27900043
279100                                                                  27910043
279200     MOVE DP020-USERID           TO PC140-CRA-USERID.             27920043
279300     MOVE LENGTH OF PC140-LABELMST TO PV-COMMAREA-LENGTH.         27930043
279400                                                                  27940043
279500     EXEC CICS                                                    27950043
279600          LINK PROGRAM  ('PCKCS707')                              27960043
279700               COMMAREA (PC140-LABELMST)                          27970043
279800               LENGTH   (PV-COMMAREA-LENGTH)                      27980043
279900               RESP     (PV-CICS-RESPONSE)                        27990043
280000     END-EXEC.                                                    28000043
280100                                                                  28010043
280200     EVALUATE TRUE                                                28020043
280300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 28030043
280400              CONTINUE                                            28040043
280500         WHEN OTHER                                               28050043
280600              PERFORM DP013-0000-PROCESS-ABEND                    28060043
280700     END-EVALUATE.                                                28070043
280800     IF PC140-CRA-SOCKET-COMM-ERROR                               28080043
280900         SET PS-ERROR            TO TRUE                          28090043
281000         SET DP020-MSG-FATAL     TO TRUE                          28100043
281100         MOVE PC-TSYMSG-02122    TO DP020-MSG-NUMBER              28110043
281200         MOVE DP015-UNP-NUM-BRT-OFF                               28120043
281300                                 TO APRTRA                        28130043
281400         MOVE DP015-RED          TO APRTRC                        28140043
281500         MOVE DP015-REVERSE      TO APRTRH                        28150043
281510         MOVE -1                 TO APRTRL                        28151043
281520         SET DP030-SET-CURSOR-APPL-1                              28152043
281530                                 TO TRUE                          28153043
281531     ELSE                                                         28153143
281532     IF PC140-CRA-INVALID-PRT-FMT                                 28153243
281533         SET PS-ERROR            TO TRUE                          28153343
281534         SET DP020-MSG-FATAL     TO TRUE                          28153443
281535         MOVE DP015-UNP-NUM-BRT-OFF                               28153543
281536                                 TO APRTRA                        28153643
281537         MOVE DP015-RED          TO APRTRC                        28153743
281538         MOVE DP015-REVERSE      TO APRTRH                        28153843
281539         MOVE -1                 TO APRTRL                        28153943
281540         SET DP030-SET-CURSOR-APPL-1                              28154043
281541                                 TO TRUE                          28154143
281542         MOVE PC140-CRA-RET-CDE      TO PM-RET-CDE                28154243
281543         MOVE PC140-CRA-RET-MSG      TO PM-RET-MSG                28154343
281544         MOVE PM-PROGRAM-MESSAGE-1   TO DP020-MSG-TEXT            28154443
281545     ELSE                                                         28154543
281546         SET DP020-MSG-INFORMATIONAL TO TRUE                      28154643
281547         MOVE PC-TSYMSG-00098    TO DP020-MSG-NUMBER              28154743
281548         MOVE -1                 TO APRTRL                        28154843
281549         SET DP030-SET-CURSOR-APPL-1                              28154943
281550                                 TO TRUE                          28155043
281560     END-IF.                                                      28156043
281570     EJECT                                                        28157043
281580*----------------------------------------------------------------*28158043
281590*    ABEND PROCESSOR MODULE                                      *28159043
281600*----------------------------------------------------------------*28160043
281700                                                                  28170043
281800     COPY DPPD013.                                                28180043
281900                                                                  28190043
