000100 TITLE 'EXPAND CARTON AUDIT EXTRACT'.                                     
000200 IDENTIFICATION DIVISION.                                                 
000300 PROGRAM-ID.    SUKUT061.                                                 
000400 AUTHOR.        DENNIS STEFFEN.                                           
000500 DATE-WRITTEN.  WINTER 2002.                                              
000600 ENVIRONMENT DIVISION.                                                    
000700 INPUT-OUTPUT SECTION.                                                    
000800                                                                          
000900 FILE-CONTROL.                                                            
001000     SELECT CARTON-EXTRACT-FILE     ASSIGN TO INP01.                      
001100     SELECT NEW-CARTON-EXTRACT-FILE ASSIGN TO OUT01.                      
001200                                                                          
001300 DATA DIVISION.                                                           
001400 FILE SECTION.                                                            
001500                                                                          
001600 FD  CARTON-EXTRACT-FILE                                                  
001700     RECORDING MODE IS F                                                  
001800     LABEL RECORDS ARE STANDARD                                           
001900     RECORD CONTAINS 100                                                  
002000     BLOCK CONTAINS 0 RECORDS                                             
002100     DATA RECORD IS CARTON-EXTRACT-RECORD.                                
002200 01  CARTON-EXTRACT-RECORD            PIC X(100).                         
002300                                                                          
002400 FD  NEW-CARTON-EXTRACT-FILE                                              
002500     RECORDING MODE IS F                                                  
002600     LABEL RECORDS ARE STANDARD                                           
002700     RECORD CONTAINS 100                                                  
002800     BLOCK CONTAINS 0 RECORDS                                             
002900     DATA RECORD IS CARTON-EXTRACT-RECORD.                                
003000 01  NEW-CARTON-EXTRACT-RECORD        PIC X(100).                         
003100                                                                          
003200 WORKING-STORAGE SECTION.                                                 
003300                                                                          
003400 01  PV-ABEND-CODE                    PIC S9(04)   VALUE ZERO             
003500                                                   COMP SYNC.             
003600                                                                          
003700 01  PS-PROGRAM-SWITCHES.                                                 
003800     05  PS-END-EXTRACT-SW            PIC X(1)   VALUE 'N'.               
003900         88  PS-END-EXTRACT                      VALUE 'Y'.               
003910     05  PS-END-EXTRACT-SW            PIC X(1)   VALUE ' '.               
003920         88  PS-VALID-PO-RCVR                    VALUE 'Y'.               
003930         88  PS-INVALID-PO-RCVR                  VALUE 'N'.               
004000                                                                          
004100                                                                          
004200 01  PV-PROGRAM-VARIABLES.                                                
004300     05  PV-RETRY-COUNT               PIC S9(04)  VALUE ZERO              
004400                                                  COMP SYNC.              
004600     05  PV-PARAGRAPH-NAME            PIC X(30)   VALUE SPACES.           
004700     05  PV-ERROR-MESSAGE-1           PIC X(60)   VALUE SPACES.           
004800     05  PV-ERROR-MESSAGE-2           PIC X(60)   VALUE SPACES.           
004900     05  PV-SQLCODE                   PIC 9(9)    VALUE ZERO.             
005100     05  PV-READ-COUNT                PIC S9(9) COMP-3                    
005200                                                   VALUE ZERO.            
005300     05  PV-WRITE-COUNT               PIC S9(9) COMP-3                    
005400                                                   VALUE ZERO.            
005500     05  PV-DECIMAL-DEPT              PIC S9(4) COMP-3                    
005600                                                   VALUE ZERO.            
005700     05  PV-DISP-NBR                  PIC Z(8)9.                          
005710                                                                          
005800     05  PV-DISPLAY-ENT-ID            PIC 9(09)  VALUE ZERO.              
005900     05  PV-DISPLAY-PO                PIC 9(09)  VALUE ZERO.              
005910     05  PV-DISPLAY-RCVR              PIC 9(09)  VALUE ZERO.              
006000                                                                          
006100 01  PC-PROGRAM-CONSTANTS.                                                
006200     05  PC-PROGRAM-NAME              PIC X(08)  VALUE 'SUKUT061'.        
006300     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3                 
006400                                                 COMP SYNC.               
006500 01  PV-ABEND-FIELDS.                                                     
006600     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'SUKUT061'.        
006700     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.            
006800     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.            
006900     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.            
007000     05  PV-ABEND-STRUCTURE-2         PIC X(20)  VALUE SPACES.            
007100     05  PV-ABEND-STRUCTURE-3         PIC X(20)  VALUE SPACES.            
007200     05  PV-ABEND-STATUS              PIC XX     VALUE SPACES.            
007300     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.            
007400     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.            
007500     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.            
007600     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.            
007700                                                                          
007800     COPY SURD027.                                                        
007900                                                                          
008000     COPY SURD028.                                                        
008100/                                                                         
008200*  USED FOR DB2 ERROR MESSAGE BUILDING                                    
008300     COPY DPWS004.                                                        
008400                                                                          
008500*   DB2 SQL COMMUNICATION AREA                                            
008600     EXEC SQL                                                             
008700          INCLUDE SQLCA                                                   
008800     END-EXEC.                                                            
008900                                                                          
009000     EXEC SQL                                                             
009100          INCLUDE TPURCHS                                                 
009200     END-EXEC.                                                            
009300                                                                          
009400     EXEC SQL                                                             
009500          INCLUDE TRECEIV                                                 
009600     END-EXEC.                                                            
009700                                                                          
009800*    SUT_VND_DEPT_RNKG                                                    
009900     EXEC SQL                                                             
010000          INCLUDE SUT00018                                                
010100     END-EXEC.                                                            
010200                                                                          
010300*    SUT_VND_RNKG                                                         
010400     EXEC SQL                                                             
010500          INCLUDE SUT00019                                                
010600     END-EXEC.                                                            
010700                                                                          
010800 PROCEDURE DIVISION.                                                      
010900                                                                          
011000     PERFORM 1000-INIT.                                                   
011100                                                                          
011200     PERFORM 2000-PROCESS                                                 
011300        UNTIL PS-END-EXTRACT.                                             
011400                                                                          
011500     PERFORM 9000-TERMINATE.                                              
011600                                                                          
011700     GOBACK.                                                              
011800                                                                          
011900 1000-INIT.                                                               
012000                                                                          
012100     OPEN INPUT  CARTON-EXTRACT-FILE                                      
012200     OPEN OUTPUT NEW-CARTON-EXTRACT-FILE                                  
012300                                                                          
012400     PERFORM 8000-READ-EXTRACT-REC.                                       
012500                                                                          
012600 2000-PROCESS.                                                            
012700                                                                          
012800     INITIALIZE SU028-PO-CTN-EXTRACT-RECORD                               
012900                                                                          
013000     MOVE SU027-OPER-UNT-ID           TO SU028-OPER-UNT-ID                
013100     MOVE SU027-PO-NBR                TO SU028-PO-NBR                     
013200                                         PURCHS-PO-NBR                    
013300                                         RECEIV-ORD-NBR                   
013400     PERFORM 7000-SELECT-TPURCHS.                                         
013500     MOVE PURCHS-DEPT-NBR             TO SU028-DEPT-NBR                   
013600     MOVE PURCHS-ENT-ID               TO SU028-ENT-ID                     
013700                                         SUT00018-ENT-ID                  
013800                                         SUT00019-ENT-ID                  
013900                                                                          
014010     MOVE SU027-REC-SEQ-NBR           TO SU028-REC-SEQ-NBR                
014100                                         RECEIV-REC-SEQ-NBR               
014200     PERFORM 7050-SELECT-TRECEIV.                                         
014300                                                                          
014400     EVALUATE TRUE                                                        
014500         WHEN RECEIV-PACK-BY-ST-IND = 'Y'                                 
014600             MOVE 'PS'                TO SU028-PKGNG-TYPE                 
014700         WHEN RECEIV-PKGNG-CDE = 'M' OR 'I'                               
014800             MOVE 'PP'                TO SU028-PKGNG-TYPE                 
014900         WHEN OTHER                                                       
015000             MOVE 'BC'                TO SU028-PKGNG-TYPE                 
015100     END-EVALUATE                                                         
015200                                                                          
015300     MOVE SU027-SHPD-QTY              TO SU028-TOTAL-RCVR-UNITS           
015400     MOVE SU027-PO-RCVR-CTN-CNT       TO SU028-TOTAL-RCVR-CTNS            
015500     MOVE SU027-CRE-DATE              TO SU028-PROCESS-DATE               
015600                                                                          
015610     IF  PS-VALID-PO-RCVR                                                 
015700         PERFORM 2050-VENDOR-RANKING                                      
015900         PERFORM 8100-WRITE-EXTRACT-REC                                   
016110     END-IF.                                                              
016111                                                                          
016120     PERFORM 8000-READ-EXTRACT-REC.                                       
016200                                                                          
016210                                                                          
016300 2050-VENDOR-RANKING.                                                     
016400     PERFORM 7100-SELECT-SUT00018.                                        
016500     IF SQLCODE = +100                                                    
016600         PERFORM 7150-SELECT-SUT00019                                     
016700         IF SQLCODE = +100                                                
016800             MOVE 'DEFALT'            TO SU028-VENDOR-RANK                
016900         END-IF                                                           
017000     END-IF.                                                              
017100/                                                                         
017200 7000-SELECT-TPURCHS.                                                     
017300                                                                          
017400     PERFORM                                                              
017500         WITH TEST AFTER                                                  
017600         VARYING PV-RETRY-COUNT                                           
017700         FROM 1 BY 1                                                      
017800         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                         
017900            OR  (SQLCODE = ZERO))                                         
018000                                                                          
018100         EXEC SQL                                                         
018200             SELECT                                                       
018300                 PUR.DEPT_NBR                                             
018400             ,   DEC(PUR.DEPT_NBR)                                        
018500             ,   PUR.ENT_ID                                               
018600             INTO                                                         
018700                 :PURCHS-DEPT-NBR                                         
018800             ,   :PV-DECIMAL-DEPT                                         
018900             ,   :PURCHS-ENT-ID                                           
019000             FROM                                                         
019100                 TPURCHS PUR                                              
019200             WHERE                                                        
019300                 PUR.PO_NBR           = :PURCHS-PO-NBR                    
019400             AND PUR.VER_STATUS_CDE   = 'A'                               
019500             WITH UR                                                      
019600         END-EXEC                                                         
019700                                                                          
019800         EVALUATE TRUE                                                    
019900             WHEN SQLCODE = ZERO                                          
020000             WHEN SQLCODE = -904                                          
020100             WHEN SQLCODE = -911                                          
020200             WHEN SQLCODE = -913                                          
020300                  CONTINUE                                                
020400             WHEN SQLWARN0 NOT = SPACE                                    
020500             WHEN SQLCODE  NOT = ZERO                                     
020600                  MOVE '7000-SELECT-TPURCHS'                              
020700                                 TO PV-ABEND-PARAGRAPH                    
020800                  MOVE 'SELECT TPURCHS'                                   
020900                                 TO PV-ABEND-OPERATION                    
021000                  MOVE 'TPURCHS' TO PV-ABEND-STRUCTURE-1                  
021100                  MOVE PURCHS-PO-NBR  TO PV-DISP-NBR                      
021200                  STRING 'PO-NBR = ' PV-DISP-NBR                          
021300                                 DELIMITED BY SIZE                        
021400                                 INTO PV-ABEND-STRUCTURE-2                
021500                  PERFORM 9900-DB2-ABEND                                  
021600         END-EVALUATE                                                     
021700     END-PERFORM.                                                         
021800                                                                          
021900     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
022000         MOVE '7000-SELECT-TPURCHS'                                       
022100                                 TO PV-ABEND-PARAGRAPH                    
022200         MOVE 'MAX RETRIES EXCEEDED'                                      
022300                                 TO PV-ABEND-OPERATION                    
022400         PERFORM 9900-DB2-ABEND                                           
022500     END-IF.                                                              
022600                                                                          
022700 7050-SELECT-TRECEIV.                                                     
022800                                                                          
023600     EXEC SQL                                                             
023700          SELECT                                                          
023800                 REC.PKGNG_CDE                                            
023900             ,   REC.PACK_BY_ST_IND                                       
024000            INTO                                                          
024100                :RECEIV-PKGNG-CDE                                         
024200            ,   :RECEIV-PACK-BY-ST-IND                                    
024300            FROM                                                          
024400                 TRECEIV REC                                              
024500           WHERE                                                          
024600                 REC.ORD_NBR          = :RECEIV-ORD-NBR                   
024700             AND REC.REC_SEQ_NBR      = :RECEIV-REC-SEQ-NBR               
024800             AND REC.VER_STATUS_CDE   = 'A'                               
025000     END-EXEC.                                                            
025100                                                                          
025200     EVALUATE TRUE                                                        
025300         WHEN SQLCODE = ZERO                                              
025400         WHEN SQLCODE = -904                                              
025500         WHEN SQLCODE = -911                                              
025600         WHEN SQLCODE = -913                                              
025701              SET PS-VALID-PO-RCVR    TO TRUE                             
025710         WHEN SQLCODE = +100                                              
025720              SET PS-INVALID-PO-RCVR  TO TRUE                             
025800         WHEN SQLWARN0 NOT = SPACE                                        
025900         WHEN SQLCODE  NOT = ZERO                                         
026000              MOVE '7050-SELECT-TRECEIV'                                  
026100                             TO PV-ABEND-PARAGRAPH                        
026200              MOVE 'SELECT TRECEIV'                                       
026300                             TO PV-ABEND-OPERATION                        
026400              MOVE 'TRECEIV' TO PV-ABEND-STRUCTURE-1                      
026410              INITIALIZE PV-DB2-OPERATION-MESSAGE-2                       
026420              MOVE  RECEIV-ORD-NBR     TO PV-DISPLAY-PO                   
026421              MOVE  RECEIV-REC-SEQ-NBR TO PV-DISPLAY-RCVR                 
026430              STRING 'PO-RCVR - '                                         
026440                     PV-DISPLAY-PO '-'                                    
026441                     PV-DISPLAY-RCVR  DELIMITED BY SIZE                   
026450                            INTO  PV-DB2-OPERATION-MESSAGE-2              
026460              PERFORM 9900-DB2-ABEND                                      
026500              PERFORM 9900-DB2-ABEND                                      
026600     END-EVALUATE.                                                        
026800                                                                          
027600                                                                          
027700 7100-SELECT-SUT00018.                                                    
027800                                                                          
027900     MOVE PV-DECIMAL-DEPT             TO SUT00018-DEPT-NBR                
027940     MOVE SU028-PKGNG-TYPE            TO SUT00018-PKGNG-TYP-CDE           
028000     PERFORM                                                              
028100         WITH TEST AFTER                                                  
028200         VARYING PV-RETRY-COUNT                                           
028300         FROM 1 BY 1                                                      
028400         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                         
028500            OR  (SQLCODE = ZERO OR +100))                                 
028600                                                                          
028700         EXEC SQL                                                         
028800             SELECT                                                       
028900                 VND_RNKG_CDE                                             
029000             INTO                                                         
029100                 :SUT00018-VND-RNKG-CDE                                   
029200             FROM                                                         
029300                 SUT_VND_DEPT_RNKG                                        
029400             WHERE                                                        
029500                 ENT_ID               = :SUT00018-ENT-ID                  
029520             AND DEPT_NBR             = :SUT00018-DEPT-NBR                
029530             AND PKGNG_TYP_CDE        = :SUT00018-PKGNG-TYP-CDE           
029600             WITH UR                                                      
029700         END-EXEC                                                         
029800                                                                          
029900         EVALUATE TRUE                                                    
030000             WHEN SQLCODE = ZERO                                          
030100                 MOVE SUT00018-VND-RNKG-CDE                               
030200                                      TO SU028-VENDOR-RANK                
030300             WHEN SQLCODE = +100                                          
030400             WHEN SQLCODE = -904                                          
030500             WHEN SQLCODE = -911                                          
030600             WHEN SQLCODE = -913                                          
030700                  CONTINUE                                                
030800             WHEN SQLWARN0 NOT = SPACE                                    
030900             WHEN SQLCODE  NOT = ZERO                                     
031000                  MOVE '7100-SELECT-SUT00018'                             
031100                                 TO PV-ABEND-PARAGRAPH                    
031200                  MOVE 'SELECT RRANKING'                                  
031300                                 TO PV-ABEND-OPERATION                    
031400                  MOVE 'SUT_VND_DEPT_RNKG'                                
031500                                 TO PV-ABEND-STRUCTURE-1                  
031510                  INITIALIZE PV-DB2-OPERATION-MESSAGE-2                   
031511                  MOVE SUT00018-ENT-ID     TO PV-DISPLAY-ENT-ID           
031512                  MOVE SU027-PO-NBR        TO PV-DISPLAY-PO               
031513                  MOVE SU027-REC-SEQ-NBR   TO PV-DISPLAY-RCVR             
031520                  STRING 'ENT-ID - '                                      
031521                         PV-DISPLAY-ENT-ID   DELIMITED BY SIZE            
031530                               INTO  PV-DB2-OPERATION-MESSAGE-2           
031540                  STRING 'PO-RCVR - '                                     
031550                         PV-DISPLAY-PO '-'                                
031551                         PV-DISPLAY-RCVR     DELIMITED BY SIZE            
031560                               INTO  PV-DB2-OPERATION-MESSAGE-3           
031600                  PERFORM 9900-DB2-ABEND                                  
031700         END-EVALUATE                                                     
031800     END-PERFORM.                                                         
031900                                                                          
032000     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
032100         MOVE '7100-SELECT-SUT00018'                                      
032200                                 TO PV-ABEND-PARAGRAPH                    
032300         MOVE 'MAX RETRIES EXCEEDED'                                      
032400                                 TO PV-ABEND-OPERATION                    
032500         PERFORM 9900-DB2-ABEND                                           
032600     END-IF.                                                              
032700                                                                          
032800 7150-SELECT-SUT00019.                                                    
032900                                                                          
032910     MOVE SU028-PKGNG-TYPE            TO SUT00019-PKGNG-TYP-CDE           
032920                                                                          
033000     PERFORM                                                              
033100         WITH TEST AFTER                                                  
033200         VARYING PV-RETRY-COUNT                                           
033300         FROM 1 BY 1                                                      
033400         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                         
033500            OR  (SQLCODE = ZERO OR +100))                                 
033600                                                                          
033700         EXEC SQL                                                         
033800             SELECT                                                       
033900                 VND_RNKG_CDE                                             
034000             INTO                                                         
034100                 :SUT00019-VND-RNKG-CDE                                   
034200             FROM                                                         
034300                 SUT_VND_RNKG                                             
034400             WHERE                                                        
034500                 ENT_ID               = :SUT00019-ENT-ID                  
034510             AND PKGNG_TYP_CDE        = :SUT00019-PKGNG-TYP-CDE           
034600             WITH UR                                                      
034700         END-EXEC                                                         
034800                                                                          
034900         EVALUATE TRUE                                                    
035000             WHEN SQLCODE = ZERO                                          
035100                 MOVE SUT00019-VND-RNKG-CDE                               
035200                                      TO SU028-VENDOR-RANK                
035300             WHEN SQLCODE = +100                                          
035400             WHEN SQLCODE = -904                                          
035500             WHEN SQLCODE = -911                                          
035600             WHEN SQLCODE = -913                                          
035700                  CONTINUE                                                
035800             WHEN SQLWARN0 NOT = SPACE                                    
035900             WHEN SQLCODE  NOT = ZERO                                     
036000                  MOVE '7150-SELECT-SUT00019'                             
036100                                 TO PV-ABEND-PARAGRAPH                    
036200                  MOVE 'SELECT RANKING'                                   
036300                                 TO PV-ABEND-OPERATION                    
036400                  MOVE 'SUT_VND_RNKG'                                     
036500                                 TO PV-ABEND-STRUCTURE-1                  
036510                  INITIALIZE PV-DB2-OPERATION-MESSAGE-2                   
036520                  MOVE SUT00019-ENT-ID     TO PV-DISPLAY-ENT-ID           
036530                  STRING 'ENT-ID - '                                      
036540                         PV-DISPLAY-ENT-ID   DELIMITED BY SIZE            
036550                             INTO  PV-DB2-OPERATION-MESSAGE-2             
036600                  PERFORM 9900-DB2-ABEND                                  
036700         END-EVALUATE                                                     
036800     END-PERFORM.                                                         
036900                                                                          
037000     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
037100         MOVE '7150-SELECT-SUT00019'                                      
037200                                 TO PV-ABEND-PARAGRAPH                    
037300         MOVE 'MAX RETRIES EXCEEDED'                                      
037400                                 TO PV-ABEND-OPERATION                    
037500         PERFORM 9900-DB2-ABEND                                           
037600     END-IF.                                                              
037700/                                                                         
037800 8000-READ-EXTRACT-REC.                                                   
037900                                                                          
038000     READ CARTON-EXTRACT-FILE INTO                                        
038100           SU027-CARTON-EXTRACT-RECORD                                    
038200     AT END                                                               
038300         SET PS-END-EXTRACT           TO TRUE                             
038400     NOT AT END                                                           
038500         ADD 1                        TO PV-READ-COUNT                    
038600     END-READ.                                                            
038700                                                                          
038800 8100-WRITE-EXTRACT-REC.                                                  
038900                                                                          
039000     ADD 1                         TO PV-WRITE-COUNT                      
039100     WRITE NEW-CARTON-EXTRACT-RECORD FROM                                 
039200           SU028-PO-CTN-EXTRACT-RECORD.                                   
039300/                                                                         
039400 9000-TERMINATE.                                                          
039500                                                                          
039600     CLOSE CARTON-EXTRACT-FILE                                            
039700           NEW-CARTON-EXTRACT-FILE                                        
039800                                                                          
039900     DISPLAY '************************'.                                  
040000     DISPLAY '******* SUKUT061 *******'.                                  
040100     DISPLAY '************************'.                                  
040200     DISPLAY SPACES                                                       
040300     MOVE PV-READ-COUNT               TO PV-DISP-NBR                      
040400     DISPLAY 'CARTONS FETCHED            = ' PV-DISP-NBR                  
040500                                                                          
040600     MOVE PV-WRITE-COUNT              TO PV-DISP-NBR                      
040700     DISPLAY 'EXTRACTS WRITTEN           = ' PV-DISP-NBR                  
040800     DISPLAY SPACES                                                       
040900     DISPLAY '************************'.                                  
041000                                                                          
041100 9900-DB2-ABEND.                                                          
041200                                                                          
041300     MOVE SQLCODE TO PV-SQLCODE.                                          
041400     DISPLAY '*** DB2 ERROR '.                                            
041500     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                               
041600     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                         
041700     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.                       
041800     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.                       
041900     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.               
042000     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.               
042100     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-3.               
042200     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.                     
042210     DISPLAY '*** TABLE 2   = ' PV-ABEND-STRUCTURE-2.                     
042300                                                                          
042700                                                                          
042800                                                                          
042900     COPY DPPD004.                                                        
043000                                                                          
043100     IF SQLCODE NOT = -911                                                
043200         EXEC SQL                                                         
043300              ROLLBACK                                                    
043400         END-EXEC                                                         
043500     END-IF.                                                              
043600                                                                          
043700     MOVE +4013                  TO PV-ABEND-CODE.                        
043800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                                 
043900                                                                          
044000*9200-ABEND.                                                              
044100******************************************************************        
044200*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                               
044300******************************************************************        
044400*    DISPLAY '***************************'.                               
044500*    DISPLAY '**       ABEND           **'.                               
044600*    DISPLAY '**  IN PROGRAM SUKUT061  **'.                               
044700*    DISPLAY '***************************'.                               
044800*    DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.                
044900*    DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.               
045000*    DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.               
045010*    DISPLAY '**                 ** = ' PV-ABEND-STRUCTURE-1.             
045020*    DISPLAY '**                 ** = ' PV-ABEND-STRUCTURE-2.             
045100*                                                                         
045200*    MOVE +4014                  TO PV-ABEND-CODE.                        
045300*    CALL 'ILBOABN0' USING PV-ABEND-CODE.                                 
045400*                                                                         
