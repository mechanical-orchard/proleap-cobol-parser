000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.    ETKCS337.                                         00030000
000400 AUTHOR.        TESS BESTE.                                       00040000
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
000600 DATE-WRITTEN.  01-28-94.                                         00060000
000700 DATE-COMPILED.                                                   00070000
000800*----------------------------------------------------------------*00080000
000900*              E337 - EDI NETWORK ADD/UPDATE/DELETE               00090000
001000*                                                                 00100000
001100* THIS PROGRAM ALLOWS THE USER TO ADD, UPDATE, OR DELETE AN EDI   00110000
001200* NETWORK.                                                        00120000
001300*                                                                 00130000
001400* WHEN ADDING A NETWORK, A BLANK SCREEN IS DISPLAYED. THE USER    00140000
001500* ENTERS ALL THE INFORMATION RELEVANT TO THE NETWORK. WHEN THE    00150000
001600* ENTER OR ADD KEY IS PRESSED, THE DATA IS EDITED. A ROW FOR THE  00160000
001700* NETWORK IS INSERTED INTO THE NETWORK TABLE IF THE ADD KEY WAS   00170000
001800* PRESSED AND NO ERRORS WERE DETECTED DURING EDITING.             00180000
001900*                                                                 00190000
002000* WHEN UPDATING A NETWORK, THE EXISTING INFORMATION FOR THE       00200000
002100* NETWORK IS DISPLAYED. THE USER CHANGES THE INFORMATION AS       00210000
002200* DESIRED. WHEN THE ENTER OR UPDATE KEY IS PRESSED, THE DATA IS   00220000
002300* EDITED. THE ROW FOR THE NETWORK IS UPDATED ON THE NETWORK TABLE 00230000
002400* IF THE UPDATE KEY WAS PRESSED AND NO ERRORS WERE DETECTED DURING00240000
002500* EDITING.                                                        00250000
002600*                                                                 00260000
002700* WHEN DELETING A NETWORK, THE EXISTING INFORMATION FOR THE       00270000
002800* NETWORK IS DISPLAYED. WHEN THE USER PRESSES THE CONFIRM KEY,    00280000
002900* THE ROW FOR THE NETWORK IS DELETED FROM THE NETWORK TABLE.      00290000
003000*----------------------------------------------------------------*00300000
003010* 10/11/2021 GERMAN BANDA                    WR/IR #: CHG0262418* 00301002
003020*            - CHANGE CALL OF DPKUT100 TO                       * 00302002
003030*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00303002
003040*              MAKING THE CALL DYNAMIC VS STATIC                * 00304002
003050*                                                               * 00305002
003060*---------------------------------------------------------------* 00306002
CICS  *  CHANGED 10/28/2022    BY BARB SCHULTZ    WR: CHG0277210      * 00307003
CICS  *                                                               * 00308003
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL   * 00309003
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.    * 00309103
CICS  *---------------------------------------------------------------* 00309303
003100                                                                  00310000
003200                                                                  00320000
003300                                                                  00330000
003400 ENVIRONMENT DIVISION.                                            00340000
003500                                                                  00350000
003600 DATA DIVISION.                                                   00360000
003700                                                                  00370000
003800 WORKING-STORAGE SECTION.                                         00380000
003900                                                                  00390000
004000 01  PC-PROGRAM-CONSTANTS.                                        00400000
004100     05  PC-CURRENT-MAP-NAME          PIC  X(8)     VALUE         00410000
004200                                                         'ET337A'.00420000
004300     05  PC-CURRENT-MAPSET-NAME       PIC  X(8)     VALUE         00430000
004400                                                        'ETKM337'.00440000
004500     05  PC-CURRENT-PROGRAM-NAME      PIC  X(8)     VALUE         00450000
004600                                                      'ETKCS337'. 00460000
004700     05  PC-TSYMSG-NUMBERS.                                       00470000
004800         10  PC-TSYMSG-00004          PIC  9(5)     VALUE 00004.  00480000
004900         10  PC-TSYMSG-00005          PIC  9(5)     VALUE 00005.  00490000
005000         10  PC-TSYMSG-00007          PIC  9(5)     VALUE 00007.  00500000
005100         10  PC-TSYMSG-00008          PIC  9(5)     VALUE 00008.  00510000
005200         10  PC-TSYMSG-00046          PIC  9(5)     VALUE 00046.  00520000
005300         10  PC-TSYMSG-00059          PIC  9(5)     VALUE 00059.  00530000
005400         10  PC-TSYMSG-00069          PIC  9(5)     VALUE 00069.  00540000
005500         10  PC-TSYMSG-00070          PIC  9(5)     VALUE 00070.  00550000
005600         10  PC-TSYMSG-00115          PIC  9(5)     VALUE 00115.  00560000
005700         10  PC-TSYMSG-00116          PIC  9(5)     VALUE 00116.  00570000
005800         10  PC-TSYMSG-00117          PIC  9(5)     VALUE 00117.  00580000
005900         10  PC-TSYMSG-00148          PIC  9(5)     VALUE 00148.  00590000
006000         10  PC-TSYMSG-00223          PIC  9(5)     VALUE 00223.  00600000
006100         10  PC-TSYMSG-00232          PIC  9(5)     VALUE 00232.  00610000
006200         10  PC-TSYMSG-00551          PIC  9(5)     VALUE 00551.  00620000
006300     05  PC-TYPE-CDE-DIALUP           PIC  X        VALUE '0'.    00630000
006400     05  PC-TYPE-CDE-LEASE-LINE       PIC  X        VALUE '1'.    00640000
006500     05  PC-TYPE-CDE-INTCONNECT       PIC  X        VALUE '2'.    00650000
006600     05  PC-TYPE-CDE-DESC-DIALUP      PIC  X(12)    VALUE         00660000
006700                                                        'DIAL UP'.00670000
006800     05  PC-TYPE-CDE-DESC-LEASE-LINE  PIC  X(12)    VALUE         00680000
006900                                                     'LEASE LINE'.00690000
007000     05  PC-TYPE-CDE-DESC-INTCONNECT  PIC  X(12)    VALUE         00700000
007100                                                   'INTERCONNECT'.00710000
007200                                                                  00720000
007300 01  PS-PROGRAM-SWITCHES.                                         00730000
007400     05  PS-ERROR-SW                  PIC  X        VALUE 'N'.    00740000
007500         88  PS-ERROR                               VALUE 'Y'.    00750000
007600         88  PS-NO-ERROR                            VALUE 'N'.    00760000
007700     05  PS-LIST-END-SW               PIC X         VALUE 'N'.    00770000
007800         88  PS-LIST-END                            VALUE 'Y'.    00780000
007900         88  PS-NO-LIST-END                         VALUE 'N'.    00790000
008000     05  PS-ADD-SUCCESSFUL-SW         PIC X         VALUE 'Y'.    00800000
008100         88 PS-ADD-SUCCESSFUL                       VALUE 'Y'.    00810000
008200         88 PS-ADD-NOT-SUCCESSFUL                   VALUE 'N'.    00820000
008300     05  PS-UPDATES-REQUESTED-SW      PIC X         VALUE 'Y'.    00830000
008400         88  PS-UPDATES-REQUESTED                   VALUE 'Y'.    00840000
008500         88  PS-NO-UPDATES-REQUESTED                VALUE 'N'.    00850000
008600                                                                  00860000
008700 01  PV-PROGRAM-VARIABLES.                                        00870000
008800     05  PV-CICS-RESP                 PIC S9(04)    COMP SYNC     00880000
008900                                                    VALUE +0.     00890000
009000     05  PV-PHONE.                                                00900000
009100         10  PV-PHONE-PART1           PIC X.                      00910000
009200         10  PV-PHONE-PART2           PIC X(3).                   00920000
009300         10  PV-PHONE-PART3           PIC X(3).                   00930000
009400         10  PV-PHONE-PART4           PIC X(4).                   00940000
009500                                                                  00950000
009600     05  PV-LINE-SPEED                PIC X(7).                   00960000
009700     05  PV-LINE-SPEED-DIGIT          REDEFINES                   00970000
009800         PV-LINE-SPEED                PIC X                       00980000
009900                                      OCCURS 7.                   00990000
010000                                                                  01000000
010100     05  PV-SUB                       PIC S9(04)    COMP SYNC     01010000
010200                                                    VALUE ZERO.   01020000
010300     05  PV-SUB2                      PIC S9(04)    COMP SYNC.    01030000
010400     05  PV-NUMBER-OF-SPACES          PIC S9(04)    COMP SYNC.    01040000
010500                                                                  01050000
010600*----------------------------------------------------------------*01060000
010700*    INTERCHANGE ID TABLE                                        *01070000
010800*----------------------------------------------------------------*01080000
010900     COPY ETWS305.                                                01090000
011000                                                                  01100000
011100*----------------------------------------------------------------*01110000
011200*    MAP LAYOUT                                                  *01120000
011300*----------------------------------------------------------------*01130000
011400     COPY ETKM337.                                                01140000
011500                                                                  01150000
011600*----------------------------------------------------------------*01160000
011700*    NUMERIC EDIT SUBROUTINE COPYBOOK.                           *01170000
011800*----------------------------------------------------------------*01180000
011900     COPY DPWS010I.                                               01190000
012000                                                                  01200000
012100*----------------------------------------------------------------*01210000
012200*    ATTRIBUTE SETTINGS COPYBOOK.                                *01220000
012300*----------------------------------------------------------------*01230000
012400     COPY DPWS015.                                                01240000
012500                                                                  01250000
012600*----------------------------------------------------------------*01260000
012700*    FUNCTION KEYS COPYBOOK                                      *01270000
012800*----------------------------------------------------------------*01280000
012900     COPY DPWS016.                                                01290000
013000                                                                  01300000
013100*-----------------------------------------------------------------01310000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.            01320003
013300*-----------------------------------------------------------------01330000
013400     COPY DPWS030.                                                01340000
CICS       COPY DPWS930.                                                01341003
013500                                                                  01350000
013600*-----------------------------------------------------------------01360000
013700*    STANDARD COMMAREA.                                           01370000
013800*-----------------------------------------------------------------01380000
013900     COPY DPWS020.                                                01390000
014000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01400000
014100                                                                  01410000
014200*-----------------------------------------------------------------01420000
014300*    INTER-APPLICATION COMMAREA.                                  01430000
014400*-----------------------------------------------------------------01440000
014500         10  INTER-APPL-COMM-AREA PIC X(200).                     01450000
014600     COPY ETWS336.                                                01460000
014700                                                                  01470000
014800*-----------------------------------------------------------------01480000
014900*    APPLICATION SPECIFIC COMMMAREA FOR ETKCS337.                 01490000
015000*-----------------------------------------------------------------01500000
015100         10  ASC-SPECIFIC-COMMAREA.                               01510000
015200             15  ASC-SEL-SUB          PIC S9(4)     COMP.         01520000
015300             15  ASC-SEL-ITEM         PIC S9(4)     COMP.         01530000
015400             15  ASC-NUMBER-OF-TS-ITEMS                           01540000
015500                                      PIC S9(5)     COMP-3.       01550000
015600             15  ASC-USE-SELECTION-QUEUE-IND                      01560000
015700                                      PIC  X.                     01570000
015800                 88  ASC-USE-SELECTION-QUEUE        VALUE 'Y'.    01580000
015900             15  ASC-SEL-QUEUE-NAME.                              01590000
016000                 20  ASC-SEL-TERM-ID  PIC  X(4).                  01600000
016100                 20  ASC-SEL-TASK-NUMBER                          01610000
016200                                      PIC S9(05)    COMP-3.       01620000
016300                 20  ASC-SEL-SEQ      PIC  9.                     01630000
016400                                                                  01640000
016500             15  ASC-INT-APPL-FORMAT-IND                          01650000
016600                                      PIC X.                      01660000
016700                 88  ASC-INT-APPL-FORMAT-ADD        VALUE '1'.    01670000
016800                 88  ASC-INT-APPL-FORMAT-UPDATE     VALUE '3'.    01680000
016900                 88  ASC-INT-APPL-FORMAT-DELETE     VALUE '4'.    01690000
017000             15  ASC-MAP-KEY-FIELDS.                              01700000
017100                 20  ASC-NETWORK-ID   PIC  X.                     01710000
017200             15  ASC-MAP-DETAIL-FIELDS.                           01720000
017300                 20  ASC-NETWORK-NAME PIC  X(15).                 01730000
017400                 20  ASC-TYPE-CDE     PIC  X.                     01740000
017500                     88  ASC-VALID-TYPE-CDE         VALUE '0'     01750000
017600                                                          '1'     01760000
017700                                                          '2'.    01770000
017800                 20  ASC-TYPE-CDE-DESC                            01780000
017900                                      PIC  X(12).                 01790000
018000                 20  ASC-LINE-SPEED   PIC  9(7).                  01800000
018100                 20  ASC-LINE-SPEED-X REDEFINES                   01810000
018200                     ASC-LINE-SPEED   PIC  X(7).                  01820000
018300                 20  ASC-LINE-SPEED-DIGIT                         01830000
018400                                      REDEFINES                   01840000
018500                     ASC-LINE-SPEED   PIC  X                      01850000
018600                                      OCCURS 7.                   01860000
018700                 20  ASC-USER-ID      PIC  X(8).                  01870000
018800                 20  ASC-PASSWORD     PIC  X(8).                  01880000
018900                 20  ASC-DIALUP-PHONE-PART1                       01890000
019000                                      PIC  X.                     01900000
019100                 20  ASC-DIALUP-PHONE-PART2                       01910000
019200                                      PIC  X(3).                  01920000
019300                 20  ASC-DIALUP-PHONE-PART3                       01930000
019400                                      PIC  X(3).                  01940000
019500                 20  ASC-DIALUP-PHONE-PART4                       01950000
019600                                      PIC  X(4).                  01960000
019700                 20  ASC-CONTACT-PHONE-PART1                      01970000
019800                                      PIC  X.                     01980000
019900                 20  ASC-CONTACT-PHONE-PART2                      01990000
020000                                      PIC  X(3).                  02000000
020100                 20  ASC-CONTACT-PHONE-PART3                      02010000
020200                                      PIC  X(3).                  02020000
020300                 20  ASC-CONTACT-PHONE-PART4                      02030000
020400                                      PIC  X(4).                  02040000
020500                 20  ASC-DFLT-INTCHG-ID-QUAL                      02050000
020600                                      PIC  X(2).                  02060000
020700                 20  ASC-DFLT-INTCHG-ID                           02070000
020800                                      PIC  X(15).                 02080000
020900                                                                  02090000
021000             15  ASC-ORIG-MAP-DETAIL-FIELDS.                      02100000
021100                 20  ASC-ORIG-NETWORK-NAME                        02110000
021200                                      PIC X(15).                  02120000
021300                 20  ASC-ORIG-TYPE-CDE                            02130000
021400                                      PIC X.                      02140000
021500                 20  ASC-ORIG-TYPE-CDE-DESC                       02150000
021600                                      PIC  X(12).                 02160000
021700                 20  ASC-ORIG-LINE-SPEED                          02170000
021800                                      PIC  9(7).                  02180000
021900                 20  ASC-ORIG-LINE-SPEED-X                        02190000
022000                                      REDEFINES                   02200000
022100                     ASC-ORIG-LINE-SPEED                          02210000
022200                                      PIC  X(7).                  02220000
022300                 20  ASC-ORIG-USER-ID PIC  X(8).                  02230000
022400                 20  ASC-ORIG-PASSWORD                            02240000
022500                                      PIC X(8).                   02250000
022600                 20  ASC-ORIG-DIALUP-PHONE-NBR                    02260000
022700                                      PIC  X(11).                 02270000
022800                 20  ASC-ORIG-CONTACT-PHONE-NBR                   02280000
022900                                      PIC  X(11).                 02290000
023000                 20  ASC-ORIG-DFLT-INTCHG-ID-QUAL                 02300000
023100                                      PIC  X(2).                  02310000
023200                 20  ASC-ORIG-DFLT-INTCHG-ID                      02320000
023300                                      PIC  X(15).                 02330000
023400                                                                  02340000
023500             15  ASC-DATA-EXISTS-SW   PIC X.                      02350000
023600                 88  ASC-DATA-EXISTS                VALUE 'Y'.    02360000
023700                 88  ASC-DATA-DOES-NOT-EXIST        VALUE 'N'.    02370000
023800                                                                  02380000
023900         10  FILLER                   PIC  X(2666).               02390000
024000                                                                  02400000
024100*---------------------------------------------------------------* 02410000
024200*    NETWORK SELECTION TSQ B QUEUE RECORD LAYOUT.                 02420000
024300*---------------------------------------------------------------* 02430000
024400     COPY ETWS335.                                                02440000
024500                                                                  02450000
024600*----------------------------------------------------------------*02460000
024700*    ABEND PROCESSING COPYBOOK.                                  *02470000
024800*----------------------------------------------------------------*02480000
024900     COPY DPWS013.                                                02490000
025000                                                                  02500000
025100*---------------------------------------------------------------* 02510000
025200*    DB2 AREA FOR EDI NETWORK TABLE                             * 02520000
025300*---------------------------------------------------------------* 02530000
025400     EXEC SQL                                                     02540000
025500          INCLUDE TNETWRK                                         02550000
025600     END-EXEC.                                                    02560000
025700                                                                  02570000
025800*---------------------------------------------------------------* 02580000
025900*    DB2 AREA FOR COMMUNICATIONS                                  02590000
026000*---------------------------------------------------------------* 02600000
026100     EXEC SQL                                                     02610000
026200          INCLUDE SQLCA                                           02620000
026300     END-EXEC.                                                    02630000
026400                                                                  02640000
026500                                                                  02650000
026600 LINKAGE SECTION.                                                 02660000
026700                                                                  02670000
026800 01  DFHCOMMAREA.                                                 02680000
026900     05  FILLER                       OCCURS  1 TO 4072 TIMES     02690000
027000                                      DEPENDING ON EIBCALEN.      02700000
027100         10  FILLER                   PIC  X.                     02710000
027200                                                                  02720000
027300 EJECT                                                            02730000
027400 PROCEDURE DIVISION.                                              02740000
027500                                                                  02750000
027600*---------------------------------------------------------------* 02760000
027700*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.  * 02770000
027800*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API   * 02780000
027900*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.             * 02790000
028000*                                                               * 02800000
028100*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE   * 02810000
028200*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.        * 02820000
028300*---------------------------------------------------------------* 02830000
028400 0000-MAIN-MODULE.                                                02840000
028500                                                                  02850000
028600     INITIALIZE DP030-CICS-API-FIELDS.                            02860000
028700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02870000
028800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02880000
028900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02890000
029000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02900000
029100     MOVE LENGTH OF ET337AI        TO DP030-MAP-LENGTH (1).       02910000
029200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02920000
029300     PERFORM 0001-CALL-CICS-ARCH-API.                             02930000
029400                                                                  02940000
029500     PERFORM 1000-CONTROL-PROCESSING                              02950000
029600                                                                  02960000
029700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02970000
029800     PERFORM 0001-CALL-CICS-ARCH-API.                             02980000
029900                                                                  02990000
030000                                                                  03000000
030100 0001-CALL-CICS-ARCH-API.                                         03010000
030200                                                                  03020000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03030003
030400                                    DFHCOMMAREA                   03040003
030500                                    DP030-CICS-API-FIELDS         03050003
030600                                    DP020-STANDARD-COMMAREA       03060003
030700                                    ET337AI.                      03070003
030800                                                                  03080000
030900     IF  DP030-RC-CALL-SUCCESSFUL                                 03090000
031000         CONTINUE                                                 03100000
031100     ELSE                                                         03110000
031200         SET DP013-NO-ROLLBACK                                    03120000
031300             DP013-XCTL-DISPLAY-RESTART                           03130000
031400             DP013-CICS-ABEND      TO TRUE                        03140000
CICS           MOVE '0001-CALL-CICS-ARCH-API'                           03150003
CICS                                     TO DP013-PARAGRAPH             03160003
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03170005
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03180005
CICS           MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      03181004
031900         PERFORM DP013-0000-PROCESS-ABEND                         03190000
032000     END-IF.                                                      03200000
032100                                                                  03210000
032200                                                                  03220000
032300*----------------------------------------------------------------*03230000
032400*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03240000
032500*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03250000
032600*----------------------------------------------------------------*03260000
032700 1000-CONTROL-PROCESSING.                                         03270000
032800                                                                  03280000
032900                                                                  03290000
033000     EVALUATE TRUE                                                03300000
033100         WHEN DP020-NEXT-ACT-INITIAL                              03310000
033200             INITIALIZE ASC-SPECIFIC-COMMAREA                     03320000
033300             MOVE DP020-INT-APPL-FORMAT-IND                       03330000
033400                 TO ASC-INT-APPL-FORMAT-IND                       03340000
033500*            *----------------------------------------------------03350000
033600*            * THE ADD FUNCTION DOES NOT NEED THE LIST QUEUE.     03360000
033700*            *----------------------------------------------------03370000
033800             IF ASC-INT-APPL-FORMAT-ADD                           03380000
033900                 CONTINUE                                         03390000
034000             ELSE                                                 03400000
034100                 PERFORM 1100-PROCESS-INTER-APPL-COMM             03410000
034200             END-IF                                               03420000
034300             PERFORM 4000-BUILD-INITIAL-PANEL                     03430000
034400                                                                  03440000
034500         WHEN DP020-NEXT-ACT-READ-MAP                             03450000
034600             PERFORM 2000-PROCESS-PANEL                           03460000
034700                                                                  03470000
034800         WHEN DP020-NEXT-ACT-RETURN                               03480000
034900             IF ASC-DATA-DOES-NOT-EXIST                           03490000
035000                 PERFORM 4500-SET-ATTRIBUTES-TO-PROT              03500000
035100*                ---- DATA DOES NOT EXIST ----                    03510000
035200                 MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER         03520000
035300                 SET DP020-MSG-FATAL  TO TRUE                     03530000
035400             ELSE                                                 03540000
035500                 IF ASC-INT-APPL-FORMAT-ADD                       03550000
035600                 OR ASC-INT-APPL-FORMAT-UPDATE                    03560000
035700*                    *--------------------------------------------03570000
035800*                    * IF THE ADD OR UPDATE FUNCTION IS BEING     03580000
035900*                    * PERFORMED, EDIT THE FIELDS.                03590000
036000*                    *--------------------------------------------03600000
036100                     PERFORM 3000-EDIT-DATA-IN-COMMAREA           03610000
036200                 ELSE                                             03620000
036300*                    *--------------------------------------------03630000
036400*                    * IF THE DELETE FUNCTION IS BEING PERFORMED, 03640000
036500*                    * PROTECT THE SCREEN FIELDS AND ISSUE THE    03650000
036600*                    * CONFIRMATION MSG.                          03660000
036700*                    *--------------------------------------------03670000
036800                     PERFORM 4500-SET-ATTRIBUTES-TO-PROT          03680000
036900                     SET DP020-MSG-INFORMATIONAL TO TRUE          03690000
037000*                    ---- PRESS F2 TO CONFIRM REQUEST ----        03700000
037100                     MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER     03710000
037200                 END-IF                                           03720000
037300             END-IF                                               03730000
037400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03740000
037500                                                                  03750000
037600         WHEN OTHER                                               03760000
037700             SET DP013-LOGIC-ABEND                                03770000
037800                 DP013-NO-ROLLBACK TO TRUE                        03780000
037900             MOVE '1000-CONTROL-PROCESSING'                       03790000
038000                                   TO DP013-PARAGRAPH             03800000
038100             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   03810000
038200                                   TO DP013-MESSAGE-TEXT(1)       03820000
038300             MOVE DP020-NEXT-APPL-ACTIVITY                        03830000
038400                                   TO DP013-MESSAGE-TEXT(2)       03840000
038500             PERFORM DP013-0000-PROCESS-ABEND                     03850000
038600     END-EVALUATE.                                                03860000
038700                                                                  03870000
038800                                                                  03880000
038900 1100-PROCESS-INTER-APPL-COMM.                                    03890000
039000                                                                  03900000
039100     SET ASC-USE-SELECTION-QUEUE   TO TRUE.                       03910000
039200     MOVE ET336-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS.     03920000
039300     MOVE ET336-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME.         03930000
039400     PERFORM 1120-PREPARE-LIST-ENTRY.                             03940000
039500                                                                  03950000
039600                                                                  03960000
039700*----------------------------------------------------------------*03970000
039800* GET READY TO START AT THE FIRST ITEM ON THE LIST.               03980000
039900*----------------------------------------------------------------*03990000
040000 1120-PREPARE-LIST-ENTRY.                                         04000000
040100                                                                  04010000
040200     MOVE ET335-MAX-ITEMS TO ASC-SEL-SUB.                         04020000
040300     MOVE ZERO            TO ASC-SEL-ITEM.                        04030000
040400     PERFORM 2140-GET-NEXT-NETWORK-ID.                            04040000
040500                                                                  04050000
040600                                                                  04060000
040700*----------------------------------------------------------------*04070000
040800* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*04080000
040900* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*04090000
041000* EDITS.                                                         *04100000
041100*----------------------------------------------------------------*04110000
041200 2000-PROCESS-PANEL.                                              04120000
041300                                                                  04130000
041400     EVALUATE TRUE                                                04140000
041500         WHEN DP020-SRC-AID = DP016-CLEAR                         04150000
041600             EVALUATE TRUE                                        04160000
041700                 WHEN ASC-INT-APPL-FORMAT-ADD                     04170000
041800                     PERFORM 3000-EDIT-DATA-IN-COMMAREA           04180000
041900                                                                  04190000
042000                 WHEN ASC-INT-APPL-FORMAT-UPDATE                  04200000
042100                     IF ASC-DATA-DOES-NOT-EXIST                   04210000
042200                         PERFORM 4500-SET-ATTRIBUTES-TO-PROT      04220000
042300*                        ---- DATA DOES NOT EXIST ----            04230000
042400                         MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER 04240000
042500                         SET DP020-MSG-FATAL  TO TRUE             04250000
042600                     ELSE                                         04260000
042700                         PERFORM 3000-EDIT-DATA-IN-COMMAREA       04270000
042800                     END-IF                                       04280000
042900                                                                  04290000
043000                 WHEN ASC-INT-APPL-FORMAT-DELETE                  04300000
043100                     PERFORM 4500-SET-ATTRIBUTES-TO-PROT          04310000
043200                     IF ASC-DATA-DOES-NOT-EXIST                   04320000
043300*                        ---- DATA DOES NOT EXIST ----            04330000
043400                         MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER 04340000
043500                         SET DP020-MSG-FATAL  TO TRUE             04350000
043600                     ELSE                                         04360000
043700                         SET DP020-MSG-INFORMATIONAL TO TRUE      04370000
043800*                        ---- PRESS F2 TO CONFIRM REQUEST ----    04380000
043900                         MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER 04390000
044000                     END-IF                                       04400000
044100             END-EVALUATE                                         04410000
044200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04420000
044300                                                                  04430000
044400         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    04440000
044500             INITIALIZE ASC-MAP-DETAIL-FIELDS                     04450000
044600             IF ASC-INT-APPL-FORMAT-ADD                           04460000
044700                 INITIALIZE ASC-MAP-KEY-FIELDS                    04470000
044800             END-IF                                               04480000
044900             PERFORM 4000-BUILD-INITIAL-PANEL                     04490000
045000                                                                  04500000
045100         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             04510000
045200             PERFORM 2140-GET-NEXT-NETWORK-ID                     04520000
045300             INITIALIZE ASC-MAP-DETAIL-FIELDS                     04530000
045400             PERFORM 4000-BUILD-INITIAL-PANEL                     04540000
045500             SET PS-NO-LIST-END TO TRUE                           04550000
045600                                                                  04560000
045700         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             04570000
045800             PERFORM 2150-GET-PREV-NETWORK-ID                     04580000
045900             INITIALIZE ASC-MAP-DETAIL-FIELDS                     04590000
046000             PERFORM 4000-BUILD-INITIAL-PANEL                     04600000
046100             SET PS-NO-LIST-END TO TRUE                           04610000
046200                                                                  04620000
046300         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    04630000
046400             PERFORM 5200-DELETE-NETWORK                          04640000
046500                                                                  04650000
046600         WHEN OTHER                                               04660000
046700             EVALUATE TRUE                                        04670000
046800                 WHEN ASC-INT-APPL-FORMAT-ADD                     04680000
046900                     PERFORM 2200-MOVE-SCREEN-TO-COMMAREA         04690000
047000                     PERFORM 3000-EDIT-DATA-IN-COMMAREA           04700000
047100                     IF  PS-NO-ERROR                              04710000
047200                         PERFORM 2100-CHECK-FUNCTION-KEY          04720000
047300                     END-IF                                       04730000
047400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         04740000
047500                                                                  04750000
047600                 WHEN ASC-INT-APPL-FORMAT-UPDATE                  04760000
047700                     IF ASC-DATA-EXISTS                           04770000
047800                         PERFORM 2200-MOVE-SCREEN-TO-COMMAREA     04780000
047900                         PERFORM 3000-EDIT-DATA-IN-COMMAREA       04790000
048000                         IF  PS-NO-ERROR                          04800000
048100                             PERFORM 2100-CHECK-FUNCTION-KEY      04810000
048200                         END-IF                                   04820000
048300                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     04830000
048400                     ELSE                                         04840000
048500                         PERFORM 2100-CHECK-FUNCTION-KEY          04850000
048600                     END-IF                                       04860000
048700                                                                  04870000
048800                 WHEN ASC-INT-APPL-FORMAT-DELETE                  04880000
048900                     PERFORM 2100-CHECK-FUNCTION-KEY              04890000
049000                                                                  04900000
049100             END-EVALUATE                                         04910000
049200     END-EVALUATE.                                                04920000
049300                                                                  04930000
049400                                                                  04940000
049500*----------------------------------------------------------------*04950000
049600*  ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED      *04960000
049700*  FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED  *04970000
049800*  FROM THE CICS ARCHITECTURE API.                               *04980000
049900*----------------------------------------------------------------*04990000
050000 2100-CHECK-FUNCTION-KEY.                                         05000000
050100                                                                  05010000
050200     EVALUATE TRUE                                                05020000
050300         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              05030000
050400             EVALUATE TRUE                                        05040000
050500                 WHEN ASC-INT-APPL-FORMAT-ADD                     05050000
050600                     PERFORM 5000-ADD-NETWORK                     05060000
050700                     IF PS-ADD-SUCCESSFUL                         05070000
050800                         INITIALIZE ASC-MAP-KEY-FIELDS            05080000
050900                                    ASC-MAP-DETAIL-FIELDS         05090000
051000*                        ---- PREVIOUS OBJECT HAS BEEN ADDED ---- 05100000
051100                         MOVE PC-TSYMSG-00223  TO DP020-MSG-NUMBER05110000
051200                         SET  DP020-MSG-INFORMATIONAL TO TRUE     05120000
051300                     END-IF                                       05130000
051400                                                                  05140000
051500                 WHEN ASC-INT-APPL-FORMAT-UPDATE                  05150000
051600                     IF ASC-DATA-EXISTS                           05160000
051700                         IF PS-NO-UPDATES-REQUESTED               05170000
051800*                            ---- DATA NOT CHNGD;NO UPD PERFORMED 05180000
051900                             MOVE PC-TSYMSG-00046                 05190000
052000                                               TO DP020-MSG-NUMBER05200000
052100                             SET DP020-MSG-WARNING TO TRUE        05210000
052200                         ELSE                                     05220000
052300                             PERFORM 5100-UPDATE-NETWORK          05230000
052400                         END-IF                                   05240000
052500                     ELSE                                         05250000
052600                         PERFORM 4500-SET-ATTRIBUTES-TO-PROT      05260000
052700*                        ---- DATA DOES NOT EXIST ----            05270000
052800                         MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER 05280000
052900                         SET DP020-MSG-FATAL  TO TRUE             05290000
053000                     END-IF                                       05300000
053100                                                                  05310000
053200                 WHEN OTHER                                       05320000
053300                     SET DP013-NO-ROLLBACK                        05330000
053400                         DP013-XCTL-DISPLAY-RESTART               05340000
053500                         DP013-CICS-ABEND  TO TRUE                05350000
053600                     MOVE '2100-CHECK-FUNCTION-KEY'               05360000
053700                                       TO DP013-PARAGRAPH         05370000
053800                     MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY AP05380000
053900-                         'I'          TO DP013-MESSAGE-TEXT (1)  05390000
054000                     PERFORM DP013-0000-PROCESS-ABEND             05400000
054100             END-EVALUATE                                         05410000
054200                                                                  05420000
054300         WHEN DP020-SRC-AID = DP016-ENTER                         05430000
054400             EVALUATE TRUE                                        05440000
054500                 WHEN ASC-INT-APPL-FORMAT-ADD                     05450000
054600                     CONTINUE                                     05460000
054700                                                                  05470000
054800                 WHEN ASC-INT-APPL-FORMAT-UPDATE                  05480000
054900                     IF ASC-DATA-DOES-NOT-EXIST                   05490000
055000                         SET DP020-MSG-FATAL  TO TRUE             05500000
055100*                        ---- DATA DOES NOT EXIST ----            05510000
055200                         MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER 05520000
055300                     END-IF                                       05530000
055400                                                                  05540000
055500                 WHEN ASC-INT-APPL-FORMAT-DELETE                  05550000
055600                     IF ASC-DATA-EXISTS                           05560000
055700                         SET DP020-MSG-INFORMATIONAL TO TRUE      05570000
055800*                        ---- PRESS F2 TO CONFIRM REQUEST ----    05580000
055900                         MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER 05590000
056000                     ELSE                                         05600000
056100                         SET DP020-MSG-FATAL  TO TRUE             05610000
056200*                        ---- DATA DOES NOT EXIST ----            05620000
056300                         MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER 05630000
056400                     END-IF                                       05640000
056500             END-EVALUATE                                         05650000
056600                                                                  05660000
056700         WHEN OTHER                                               05670000
056800             SET DP013-NO-ROLLBACK                                05680000
056900                 DP013-XCTL-DISPLAY-RESTART                       05690000
057000                 DP013-CICS-ABEND  TO TRUE                        05700000
057100             MOVE '2100-CHECK-FUNCTION-KEY'                       05710000
057200                                   TO DP013-PARAGRAPH             05720000
057300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      05730000
057400                                   TO DP013-MESSAGE-TEXT (1)      05740000
057500             PERFORM DP013-0000-PROCESS-ABEND                     05750000
057600     END-EVALUATE.                                                05760000
057700                                                                  05770000
057800                                                                  05780000
057900 2140-GET-NEXT-NETWORK-ID.                                        05790000
058000                                                                  05800000
058100     ADD +1                       TO ASC-SEL-SUB.                 05810000
058200     IF  ASC-SEL-SUB > ET335-MAX-ITEMS                            05820000
058300         ADD +1                   TO ASC-SEL-ITEM                 05830000
058400         MOVE +1                  TO ASC-SEL-SUB                  05840000
058500     END-IF.                                                      05850000
058600     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                05860000
058700         PERFORM 9100-READ-SEL-QUEUE                              05870000
058800         IF  ET335-ITEM (ASC-SEL-SUB) > ZERO                      05880000
058900             MOVE ET335-NETWORK-ID (ASC-SEL-SUB) TO ASC-NETWORK-ID05890000
059000             IF ET335-ACTION-SW (ASC-SEL-SUB) = SPACE             05900000
059100                 SET ET335-INQ (ASC-SEL-SUB)         TO TRUE      05910000
059200                 PERFORM 9200-REWRITE-SEL-QUEUE                   05920000
059300             END-IF                                               05930000
059400         ELSE                                                     05940000
059500             SUBTRACT +1 FROM ASC-SEL-SUB                         05950000
059600*            ---- BOTTOM OF LIST ----                             05960000
059700             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             05970000
059800             SET DP020-MSG-INFORMATIONAL                          05980000
059900                 PS-LIST-END             TO TRUE                  05990000
060000         END-IF                                                   06000000
060100     ELSE                                                         06010000
060200         SUBTRACT +1 FROM ASC-SEL-ITEM                            06020000
060300         MOVE ET335-MAX-ITEMS     TO ASC-SEL-SUB                  06030000
060400*        ---- BOTTOM OF LIST ----                                 06040000
060500         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             06050000
060600         SET DP020-MSG-INFORMATIONAL                              06060000
060700             PS-LIST-END             TO TRUE                      06070000
060800     END-IF.                                                      06080000
060900                                                                  06090000
061000                                                                  06100000
061100 2150-GET-PREV-NETWORK-ID.                                        06110000
061200                                                                  06120000
061300     SUBTRACT +1 FROM ASC-SEL-SUB.                                06130000
061400     IF  ASC-SEL-SUB < +1                                         06140000
061500         SUBTRACT +1 FROM ASC-SEL-ITEM                            06150000
061600         MOVE ET335-MAX-ITEMS     TO ASC-SEL-SUB                  06160000
061700     END-IF.                                                      06170000
061800                                                                  06180000
061900     IF  ASC-SEL-ITEM > ZERO                                      06190000
062000         PERFORM 9100-READ-SEL-QUEUE                              06200000
062100         MOVE ET335-NETWORK-ID (ASC-SEL-SUB)                      06210000
062200                                  TO ASC-NETWORK-ID               06220000
062300     ELSE                                                         06230000
062400         MOVE +1                  TO ASC-SEL-ITEM                 06240000
062500                                     ASC-SEL-SUB                  06250000
062600*        ---- TOP OF LIST ----                                    06260000
062700         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             06270000
062800         SET DP020-MSG-INFORMATIONAL                              06280000
062900                 PS-LIST-END         TO TRUE                      06290000
063000     END-IF.                                                      06300000
063100                                                                  06310000
063200                                                                  06320000
063300*----------------------------------------------------------------*06330000
063400* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*06340000
063500* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *06350000
063600* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *06360000
063700*----------------------------------------------------------------*06370000
063800 2200-MOVE-SCREEN-TO-COMMAREA.                                    06380000
063900                                                                  06390000
064000     IF ANTIDL > ZERO                                             06400000
064100         MOVE ANTIDI TO ASC-NETWORK-ID                            06410000
064200     ELSE                                                         06420000
064300         IF ANTIDF = DP015-ERASE-EOF                              06430000
064400             MOVE SPACE TO ASC-NETWORK-ID                         06440000
064500         END-IF                                                   06450000
064600     END-IF.                                                      06460000
064700                                                                  06470000
064800     IF ANAMEL > ZERO                                             06480000
064900         MOVE ANAMEI TO ASC-NETWORK-NAME                          06490000
065000     ELSE                                                         06500000
065100         IF ANAMEF = DP015-ERASE-EOF                              06510000
065200             MOVE SPACE TO ASC-NETWORK-NAME                       06520000
065300         END-IF                                                   06530000
065400     END-IF.                                                      06540000
065500                                                                  06550000
065600     IF ATYPEL > ZERO                                             06560000
065700         MOVE ATYPEI TO ASC-TYPE-CDE                              06570000
065800     ELSE                                                         06580000
065900         IF ATYPEF = DP015-ERASE-EOF                              06590000
066000             MOVE SPACE TO ASC-TYPE-CDE                           06600000
066100         END-IF                                                   06610000
066200     END-IF.                                                      06620000
066300                                                                  06630000
066400     IF ALSPEEDL > ZERO                                           06640000
066500         MOVE ALSPEEDI TO ASC-LINE-SPEED-X                        06650000
066600     ELSE                                                         06660000
066700         IF ALSPEEDF = DP015-ERASE-EOF                            06670000
066800             MOVE SPACE TO ASC-LINE-SPEED-X                       06680000
066900         END-IF                                                   06690000
067000     END-IF.                                                      06700000
067100                                                                  06710000
067200     IF AUSERIDL > ZERO                                           06720000
067300         MOVE AUSERIDI TO ASC-USER-ID                             06730000
067400     ELSE                                                         06740000
067500         IF AUSERIDF = DP015-ERASE-EOF                            06750000
067600             MOVE SPACE TO ASC-USER-ID                            06760000
067700         END-IF                                                   06770000
067800     END-IF.                                                      06780000
067900                                                                  06790000
068000     IF APASSWDL > ZERO                                           06800000
068100         MOVE APASSWDI TO ASC-PASSWORD                            06810000
068200     ELSE                                                         06820000
068300         IF APASSWDF = DP015-ERASE-EOF                            06830000
068400             MOVE SPACE TO ASC-PASSWORD                           06840000
068500         END-IF                                                   06850000
068600     END-IF.                                                      06860000
068700                                                                  06870000
068800     IF ADIAL1L  > ZERO                                           06880000
068900         MOVE ADIAL1I TO ASC-DIALUP-PHONE-PART1                   06890000
069000     ELSE                                                         06900000
069100         IF ADIAL1F = DP015-ERASE-EOF                             06910000
069200             MOVE SPACE TO ASC-DIALUP-PHONE-PART1                 06920000
069300         END-IF                                                   06930000
069400     END-IF.                                                      06940000
069500                                                                  06950000
069600     IF ADIAL2L  > ZERO                                           06960000
069700         MOVE ADIAL2I TO ASC-DIALUP-PHONE-PART2                   06970000
069800     ELSE                                                         06980000
069900         IF ADIAL2F = DP015-ERASE-EOF                             06990000
070000             MOVE SPACE TO ASC-DIALUP-PHONE-PART2                 07000000
070100         END-IF                                                   07010000
070200     END-IF.                                                      07020000
070300                                                                  07030000
070400     IF ADIAL3L  > ZERO                                           07040000
070500         MOVE ADIAL3I TO ASC-DIALUP-PHONE-PART3                   07050000
070600     ELSE                                                         07060000
070700         IF ADIAL3F = DP015-ERASE-EOF                             07070000
070800             MOVE SPACE TO ASC-DIALUP-PHONE-PART3                 07080000
070900         END-IF                                                   07090000
071000     END-IF.                                                      07100000
071100                                                                  07110000
071200     IF ADIAL4L  > ZERO                                           07120000
071300         MOVE ADIAL4I TO ASC-DIALUP-PHONE-PART4                   07130000
071400     ELSE                                                         07140000
071500         IF ADIAL4F = DP015-ERASE-EOF                             07150000
071600             MOVE SPACE TO ASC-DIALUP-PHONE-PART4                 07160000
071700         END-IF                                                   07170000
071800     END-IF.                                                      07180000
071900                                                                  07190000
072000     IF ACNTCT1L > ZERO                                           07200000
072100         MOVE ACNTCT1I TO ASC-CONTACT-PHONE-PART1                 07210000
072200     ELSE                                                         07220000
072300         IF ACNTCT1F = DP015-ERASE-EOF                            07230000
072400             MOVE SPACE TO ASC-CONTACT-PHONE-PART1                07240000
072500         END-IF                                                   07250000
072600     END-IF.                                                      07260000
072700                                                                  07270000
072800     IF ACNTCT2L > ZERO                                           07280000
072900         MOVE ACNTCT2I TO ASC-CONTACT-PHONE-PART2                 07290000
073000     ELSE                                                         07300000
073100         IF ACNTCT2F = DP015-ERASE-EOF                            07310000
073200             MOVE SPACE TO ASC-CONTACT-PHONE-PART2                07320000
073300         END-IF                                                   07330000
073400     END-IF.                                                      07340000
073500                                                                  07350000
073600     IF ACNTCT3L > ZERO                                           07360000
073700         MOVE ACNTCT3I TO ASC-CONTACT-PHONE-PART3                 07370000
073800     ELSE                                                         07380000
073900         IF ACNTCT3F = DP015-ERASE-EOF                            07390000
074000             MOVE SPACE TO ASC-CONTACT-PHONE-PART3                07400000
074100         END-IF                                                   07410000
074200     END-IF.                                                      07420000
074300                                                                  07430000
074400     IF ACNTCT4L > ZERO                                           07440000
074500         MOVE ACNTCT4I TO ASC-CONTACT-PHONE-PART4                 07450000
074600     ELSE                                                         07460000
074700         IF ACNTCT4F = DP015-ERASE-EOF                            07470000
074800             MOVE SPACE TO ASC-CONTACT-PHONE-PART4                07480000
074900         END-IF                                                   07490000
075000     END-IF.                                                      07500000
075100                                                                  07510000
075200     IF AINTIDQL > ZERO                                           07520000
075300         MOVE AINTIDQI TO ASC-DFLT-INTCHG-ID-QUAL                 07530000
075400     ELSE                                                         07540000
075500         IF AINTIDQF = DP015-ERASE-EOF                            07550000
075600             MOVE SPACE TO ASC-DFLT-INTCHG-ID-QUAL                07560000
075700         END-IF                                                   07570000
075800     END-IF.                                                      07580000
075900                                                                  07590000
076000     IF AINTIDL > ZERO                                            07600000
076100         MOVE AINTIDI TO ASC-DFLT-INTCHG-ID                       07610000
076200     ELSE                                                         07620000
076300         IF AINTIDF = DP015-ERASE-EOF                             07630000
076400             MOVE SPACE TO ASC-DFLT-INTCHG-ID                     07640000
076500         END-IF                                                   07650000
076600     END-IF.                                                      07660000
076700                                                                  07670000
076800                                                                  07680000
076900*----------------------------------------------------------------*07690000
077000* EDIT EACH FIELD ENTERED BY THE USER. IF AN ERROR IS FOUND,      07700000
077100* POSITION THE CURSOR ON THAT FIELD AND DISPLAY THE APPROPRIATE  *07710000
077200* ERROR MESSAGE.                                                  07720000
077300*----------------------------------------------------------------*07730000
077400 3000-EDIT-DATA-IN-COMMAREA.                                      07740000
077500                                                                  07750000
077600     PERFORM 3225-RESET-ATTRIBUTES.                               07760000
077700     PERFORM 3250-EDIT-MAP-DETAIL-FIELDS.                         07770000
077800                                                                  07780000
077900     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         07790000
078000                                                                  07800000
078100     IF ASC-INT-APPL-FORMAT-UPDATE                                07810000
078200         IF ASC-MAP-DETAIL-FIELDS = ASC-ORIG-MAP-DETAIL-FIELDS    07820000
078300             SET PS-NO-UPDATES-REQUESTED TO TRUE                  07830000
078400         END-IF                                                   07840000
078500     END-IF.                                                      07850000
078600                                                                  07860000
078700     IF PS-NO-ERROR                                               07870000
078800         IF ASC-INT-APPL-FORMAT-ADD                               07880000
078900             MOVE -1 TO ANTIDL                                    07890000
079000         ELSE                                                     07900000
079100             MOVE -1 TO ANAMEL                                    07910000
079200     END-IF.                                                      07920000
079300                                                                  07930000
079400                                                                  07940000
079500 3225-RESET-ATTRIBUTES.                                           07950000
079600                                                                  07960000
079700     IF ASC-INT-APPL-FORMAT-UPDATE                                07970000
079800         MOVE DP015-PRO-NOR-OFF     TO ANTIDA                     07980000
079900     ELSE                                                         07990000
080000         MOVE DP015-UNP-ALP-NOR-OFF TO ANTIDA                     08000000
080100     END-IF.                                                      08010000
080200     MOVE DP015-UNP-ALP-NOR-OFF     TO ANAMEA                     08020000
080300                                       ATYPEA                     08030000
080400                                       ALSPEEDA                   08040000
080500                                       AUSERIDA                   08050000
080600                                       APASSWDA                   08060000
080700                                       ADIAL1A                    08070000
080800                                       ADIAL2A                    08080000
080900                                       ADIAL3A                    08090000
081000                                       ADIAL4A                    08100000
081100                                       ACNTCT1A                   08110000
081200                                       ACNTCT2A                   08120000
081300                                       ACNTCT3A                   08130000
081400                                       ACNTCT4A                   08140000
081500                                       AINTIDQA                   08150000
081600                                       AINTIDA.                   08160000
081700     MOVE DP015-UNP-NUM-NOR-OFF     TO ALSPEEDA.                  08170000
081800                                                                  08180000
081900     IF ASC-INT-APPL-FORMAT-UPDATE                                08190000
082000         MOVE DP015-BLUE            TO ANTIDC                     08200000
082100     ELSE                                                         08210000
082200         MOVE DP015-GREEN           TO ANTIDC                     08220000
082300     END-IF.                                                      08230000
082400     MOVE DP015-GREEN               TO ANAMEC                     08240000
082500                                       ATYPEC                     08250000
082600                                       ALSPEEDC                   08260000
082700                                       AUSERIDC                   08270000
082800                                       APASSWDC                   08280000
082900                                       ADIAL1C                    08290000
083000                                       ADIAL2C                    08300000
083100                                       ADIAL3C                    08310000
083200                                       ADIAL4C                    08320000
083300                                       ACNTCT1C                   08330000
083400                                       ACNTCT2C                   08340000
083500                                       ACNTCT3C                   08350000
083600                                       ACNTCT4C                   08360000
083700                                       AINTIDQC                   08370000
083800                                       AINTIDC.                   08380000
083900                                                                  08390000
084000     IF ASC-INT-APPL-FORMAT-UPDATE                                08400000
084100         MOVE DP015-HL-OFF          TO ANTIDH                     08410000
084200     ELSE                                                         08420000
084300         MOVE DP015-UNDERLINE       TO ANTIDH                     08430000
084400     END-IF.                                                      08440000
084500     MOVE DP015-UNDERLINE           TO ANAMEH                     08450000
084600                                       ATYPEH                     08460000
084700                                       ALSPEEDH                   08470000
084800                                       AUSERIDH                   08480000
084900                                       APASSWDH                   08490000
085000                                       ADIAL1H                    08500000
085100                                       ADIAL2H                    08510000
085200                                       ADIAL3H                    08520000
085300                                       ADIAL4H                    08530000
085400                                       ACNTCT1H                   08540000
085500                                       ACNTCT2H                   08550000
085600                                       ACNTCT3H                   08560000
085700                                       ACNTCT4H                   08570000
085800                                       AINTIDQH                   08580000
085900                                       AINTIDH.                   08590000
086000                                                                  08600000
086100                                                                  08610000
086200 3250-EDIT-MAP-DETAIL-FIELDS.                                     08620000
086300                                                                  08630000
086400*    *------------------------------------------------------------08640000
086500*    * EDIT THE DEFAULT INTERCHANGE ID QUALIF.                    08650000
086600*    *------------------------------------------------------------08660000
086700                                                                  08670000
086800     IF ASC-DFLT-INTCHG-ID-QUAL = SPACE                           08680000
086900         CONTINUE                                                 08690000
087000     ELSE                                                         08700000
087100         SEARCH ET305-TP-ID-ENTRY                                 08710000
087200             AT END                                               08720000
087300                 SET PS-ERROR                                     08730000
087400                     DP020-MSG-FATAL         TO TRUE              08740000
087500*                ---- INVALID VALUE ----                          08750000
087600                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  08760000
087700                 MOVE DP015-UNP-ALP-BRT-OFF  TO AINTIDQA          08770000
087800                 MOVE DP015-RED              TO AINTIDQC          08780000
087900                 MOVE DP015-REVERSE          TO AINTIDQH          08790000
088000                 MOVE -1                     TO AINTIDQL          08800000
088100             WHEN ET305-TP-ID (ET305-IDX)                         08810000
088200                                         = ASC-DFLT-INTCHG-ID-QUAL08820000
088300                 CONTINUE                                         08830000
088400         END-SEARCH                                               08840000
088500     END-IF.                                                      08850000
088600                                                                  08860000
088700*    *------------------------------------------------------------08870000
088800*    * EDIT THE CONTACT PHONE NUMBER.                             08880000
088900*    *------------------------------------------------------------08890000
089000                                                                  08900000
089100     IF  ASC-CONTACT-PHONE-PART1 NOT = SPACE                      08910000
089200     OR  ASC-CONTACT-PHONE-PART2 NOT = SPACE                      08920000
089300     OR  ASC-CONTACT-PHONE-PART3 NOT = SPACE                      08930000
089400     OR  ASC-CONTACT-PHONE-PART4 NOT = SPACE                      08940000
089500         INITIALIZE PV-NUMBER-OF-SPACES                           08950000
089600         INSPECT ASC-CONTACT-PHONE-PART4                          08960000
089700             TALLYING PV-NUMBER-OF-SPACES FOR ALL SPACES          08970000
089800         IF PV-NUMBER-OF-SPACES > ZERO                            08980000
089900             SET PS-ERROR                                         08990000
090000                 DP020-MSG-FATAL         TO TRUE                  09000000
090100*            ---- INVALID VALUE ----                              09010000
090200             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      09020000
090300             MOVE DP015-UNP-ALP-BRT-OFF  TO ACNTCT4A              09030000
090400             MOVE DP015-RED              TO ACNTCT4C              09040000
090500             MOVE DP015-REVERSE          TO ACNTCT4H              09050000
090600             MOVE -1                     TO ACNTCT4L              09060000
090700         END-IF                                                   09070000
090800         INITIALIZE PV-NUMBER-OF-SPACES                           09080000
090900         INSPECT ASC-CONTACT-PHONE-PART3                          09090000
091000             TALLYING PV-NUMBER-OF-SPACES FOR ALL SPACES          09100000
091100         IF PV-NUMBER-OF-SPACES > ZERO                            09110000
091200             SET PS-ERROR                                         09120000
091300                 DP020-MSG-FATAL         TO TRUE                  09130000
091400*            ---- INVALID VALUE ----                              09140000
091500             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      09150000
091600             MOVE DP015-UNP-ALP-BRT-OFF  TO ACNTCT3A              09160000
091700             MOVE DP015-RED              TO ACNTCT3C              09170000
091800             MOVE DP015-REVERSE          TO ACNTCT3H              09180000
091900             MOVE -1                     TO ACNTCT3L              09190000
092000         END-IF                                                   09200000
092100         INITIALIZE PV-NUMBER-OF-SPACES                           09210000
092200         INSPECT ASC-CONTACT-PHONE-PART2                          09220000
092300             TALLYING PV-NUMBER-OF-SPACES FOR ALL SPACES          09230000
092400         IF PV-NUMBER-OF-SPACES > ZERO                            09240000
092500             SET PS-ERROR                                         09250000
092600                 DP020-MSG-FATAL         TO TRUE                  09260000
092700*            ---- INVALID VALUE ----                              09270000
092800             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      09280000
092900             MOVE DP015-UNP-ALP-BRT-OFF  TO ACNTCT2A              09290000
093000             MOVE DP015-RED              TO ACNTCT2C              09300000
093100             MOVE DP015-REVERSE          TO ACNTCT2H              09310000
093200             MOVE -1                     TO ACNTCT2L              09320000
093300         END-IF                                                   09330000
093400         INITIALIZE PV-NUMBER-OF-SPACES                           09340000
093500         INSPECT ASC-CONTACT-PHONE-PART1                          09350000
093600             TALLYING PV-NUMBER-OF-SPACES FOR ALL SPACES          09360000
093700         IF PV-NUMBER-OF-SPACES > ZERO                            09370000
093800             SET PS-ERROR                                         09380000
093900                 DP020-MSG-FATAL         TO TRUE                  09390000
094000*            ---- INVALID VALUE ----                              09400000
094100             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      09410000
094200             MOVE DP015-UNP-ALP-BRT-OFF  TO ACNTCT1A              09420000
094300             MOVE DP015-RED              TO ACNTCT1C              09430000
094400             MOVE DP015-REVERSE          TO ACNTCT1H              09440000
094500             MOVE -1                     TO ACNTCT1L              09450000
094600         END-IF                                                   09460000
094700     END-IF.                                                      09470000
094800                                                                  09480000
094900*    *------------------------------------------------------------09490000
095000*    * EDIT THE DIALUP PHONE NUMBER.                              09500000
095100*    *------------------------------------------------------------09510000
095200                                                                  09520000
095300     IF ASC-TYPE-CDE = PC-TYPE-CDE-DIALUP                         09530000
095400         IF  ASC-DIALUP-PHONE-PART1 = SPACE                       09540000
095500         AND ASC-DIALUP-PHONE-PART2 = SPACE                       09550000
095600         AND ASC-DIALUP-PHONE-PART3 = SPACE                       09560000
095700         AND ASC-DIALUP-PHONE-PART4 = SPACE                       09570000
095800             SET PS-ERROR                                         09580000
095900                 DP020-MSG-FATAL         TO TRUE                  09590000
096000*            ---- REQUIRED FIELD ----                             09600000
096100             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      09610000
096200             MOVE DP015-UNP-ALP-BRT-OFF  TO ADIAL1A               09620000
096300                                            ADIAL2A               09630000
096400                                            ADIAL3A               09640000
096500                                            ADIAL4A               09650000
096600             MOVE DP015-RED              TO ADIAL1C               09660000
096700                                            ADIAL2C               09670000
096800                                            ADIAL3C               09680000
096900                                            ADIAL4C               09690000
097000             MOVE DP015-REVERSE          TO ADIAL1H               09700000
097100                                            ADIAL2H               09710000
097200                                            ADIAL3H               09720000
097300                                            ADIAL4H               09730000
097400             MOVE -1                     TO ADIAL1L               09740000
097500         ELSE                                                     09750000
097600             INITIALIZE PV-NUMBER-OF-SPACES                       09760000
097700             INSPECT ASC-DIALUP-PHONE-PART4                       09770000
097800                 TALLYING PV-NUMBER-OF-SPACES FOR ALL SPACES      09780000
097900             IF PV-NUMBER-OF-SPACES > ZERO                        09790000
098000                 SET PS-ERROR                                     09800000
098100                     DP020-MSG-FATAL         TO TRUE              09810000
098200*                ---- INVALID VALUE ----                          09820000
098300                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  09830000
098400                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADIAL4A           09840000
098500                 MOVE DP015-RED              TO ADIAL4C           09850000
098600                 MOVE DP015-REVERSE          TO ADIAL4H           09860000
098700                 MOVE -1                     TO ADIAL4L           09870000
098800             END-IF                                               09880000
098900             INITIALIZE PV-NUMBER-OF-SPACES                       09890000
099000             INSPECT ASC-DIALUP-PHONE-PART3                       09900000
099100                 TALLYING PV-NUMBER-OF-SPACES FOR ALL SPACES      09910000
099200             IF PV-NUMBER-OF-SPACES > ZERO                        09920000
099300                 SET PS-ERROR                                     09930000
099400                     DP020-MSG-FATAL         TO TRUE              09940000
099500*                ---- INVALID VALUE ----                          09950000
099600                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  09960000
099700                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADIAL3A           09970000
099800                 MOVE DP015-RED              TO ADIAL3C           09980000
099900                 MOVE DP015-REVERSE          TO ADIAL3H           09990000
100000                 MOVE -1                     TO ADIAL3L           10000000
100100             END-IF                                               10010000
100200             INITIALIZE PV-NUMBER-OF-SPACES                       10020000
100300             INSPECT ASC-DIALUP-PHONE-PART2                       10030000
100400                 TALLYING PV-NUMBER-OF-SPACES FOR ALL SPACES      10040000
100500             IF PV-NUMBER-OF-SPACES > ZERO                        10050000
100600                 SET PS-ERROR                                     10060000
100700                     DP020-MSG-FATAL         TO TRUE              10070000
100800*                ---- INVALID VALUE ----                          10080000
100900                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  10090000
101000                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADIAL2A           10100000
101100                 MOVE DP015-RED              TO ADIAL2C           10110000
101200                 MOVE DP015-REVERSE          TO ADIAL2H           10120000
101300                 MOVE -1                     TO ADIAL2L           10130000
101400             END-IF                                               10140000
101500             INITIALIZE PV-NUMBER-OF-SPACES                       10150000
101600             INSPECT ASC-DIALUP-PHONE-PART1                       10160000
101700                 TALLYING PV-NUMBER-OF-SPACES FOR ALL SPACES      10170000
101800             IF PV-NUMBER-OF-SPACES > ZERO                        10180000
101900                 SET PS-ERROR                                     10190000
102000                     DP020-MSG-FATAL         TO TRUE              10200000
102100*                ---- INVALID VALUE ----                          10210000
102200                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  10220000
102300                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADIAL1A           10230000
102400                 MOVE DP015-RED              TO ADIAL1C           10240000
102500                 MOVE DP015-REVERSE          TO ADIAL1H           10250000
102600                 MOVE -1                     TO ADIAL1L           10260000
102700             END-IF                                               10270000
102800         END-IF                                                   10280000
102900     ELSE                                                         10290000
103000         MOVE SPACE TO ASC-DIALUP-PHONE-PART1                     10300000
103100                       ASC-DIALUP-PHONE-PART2                     10310000
103200                       ASC-DIALUP-PHONE-PART3                     10320000
103300                       ASC-DIALUP-PHONE-PART4                     10330000
103400     END-IF.                                                      10340000
103500                                                                  10350000
103600*    *------------------------------------------------------------10360000
103700*    * EDIT THE LINE SPEED.                                       10370000
103800*    *------------------------------------------------------------10380000
103900                                                                  10390000
104000     IF ASC-LINE-SPEED-X = SPACE                                  10400000
104100         MOVE ZERO TO ASC-LINE-SPEED                              10410000
104200     ELSE                                                         10420000
104300         MOVE ASC-LINE-SPEED-X       TO DP010I-UNEDITED-FIELD     10430000
104400         MOVE LENGTH OF ASC-LINE-SPEED                            10440000
104500                                     TO DP010I-MAXIMUM-DIGITS     10450000
104600         MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS   10460000
104700         SET  DP010I-NEGATIVE-NOT-ALLOWED                         10470000
104800                                     TO TRUE                      10480000
104910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10491001
104920                         USING DP010I-NUMERIC-EDIT-AREA           10492001
105000                                                                  10500000
105100         IF DP010I-ERROR-DETECTED                                 10510000
105200             SET  PS-ERROR                                        10520000
105300                  DP020-MSG-FATAL        TO TRUE                  10530000
105400*            ---- MUST BE NUMERIC ----                            10540000
105500             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      10550000
105600             MOVE DP015-UNP-NUM-BRT-OFF  TO ALSPEEDA              10560000
105700             MOVE DP015-RED              TO ALSPEEDC              10570000
105800             MOVE DP015-REVERSE          TO ALSPEEDH              10580000
105900             MOVE -1                     TO ALSPEEDL              10590000
106000         ELSE                                                     10600000
106100             MOVE DP010I-NUMERIC-FIELD   TO ASC-LINE-SPEED        10610000
106200         END-IF                                                   10620000
106300     END-IF.                                                      10630000
106400                                                                  10640000
106500*    *------------------------------------------------------------10650000
106600*    * EDIT THE TYPE CODE.                                        10660000
106700*    *------------------------------------------------------------10670000
106800                                                                  10680000
106900     IF ASC-TYPE-CDE = SPACE                                      10690000
107000         MOVE SPACE TO ASC-TYPE-CDE-DESC                          10700000
107100     ELSE                                                         10710000
107200         EVALUATE TRUE                                            10720000
107300             WHEN ASC-TYPE-CDE = PC-TYPE-CDE-DIALUP               10730000
107400                 MOVE PC-TYPE-CDE-DESC-DIALUP                     10740000
107500                                TO ASC-TYPE-CDE-DESC              10750000
107600             WHEN ASC-TYPE-CDE = PC-TYPE-CDE-LEASE-LINE           10760000
107700                 MOVE PC-TYPE-CDE-DESC-LEASE-LINE                 10770000
107800                                TO ASC-TYPE-CDE-DESC              10780000
107900             WHEN ASC-TYPE-CDE = PC-TYPE-CDE-INTCONNECT           10790000
108000                 MOVE PC-TYPE-CDE-DESC-INTCONNECT                 10800000
108100                                TO ASC-TYPE-CDE-DESC              10810000
108200             WHEN OTHER                                           10820000
108300                 MOVE SPACE     TO ASC-TYPE-CDE-DESC              10830000
108400                 SET PS-ERROR                                     10840000
108500                     DP020-MSG-FATAL         TO TRUE              10850000
108600*                ---- INVALID VALUE ----                          10860000
108700                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  10870000
108800                 MOVE DP015-UNP-ALP-BRT-OFF  TO ATYPEA            10880000
108900                 MOVE DP015-RED              TO ATYPEC            10890000
109000                 MOVE DP015-REVERSE          TO ATYPEH            10900000
109100                 MOVE -1                     TO ATYPEL            10910000
109200         END-EVALUATE                                             10920000
109300     END-IF.                                                      10930000
109400                                                                  10940000
109500*    *------------------------------------------------------------10950000
109600*    * EDIT THE NETWORK ID. THIS EDIT IS ONLY PERFORMED FOR THE   10960000
109700*    * ADD FUNCTION BECAUSE NETWORK ID IS A PROTECTED FIELD WHEN  10970000
109800*    * THE UPDATE FUNCTION IS PERFORMED.                          10980000
109900*    *------------------------------------------------------------10990000
110000                                                                  11000000
110100     IF ASC-INT-APPL-FORMAT-ADD                                   11010000
110200         IF ASC-NETWORK-ID = SPACE                                11020000
110300             SET PS-ERROR                                         11030000
110400                 DP020-MSG-FATAL         TO TRUE                  11040000
110500*            ---- REQUIRED FIELD ----                             11050000
110600             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      11060000
110700             MOVE DP015-UNP-ALP-BRT-OFF  TO ANTIDA                11070000
110800             MOVE DP015-RED              TO ANTIDC                11080000
110900             MOVE DP015-REVERSE          TO ANTIDH                11090000
111000             MOVE -1                     TO ANTIDL                11100000
111100         ELSE                                                     11110000
111200             PERFORM 4310-READ-TNETWRK                            11120000
111300             IF SQLCODE = +100                                    11130000
111400                 CONTINUE                                         11140000
111500             ELSE                                                 11150000
111600                 SET PS-ERROR                                     11160000
111700                     DP020-MSG-FATAL         TO TRUE              11170000
111800*                ---- CANNOT ADD - RECORD ALREADY EXISTS ----     11180000
111900                 MOVE PC-TSYMSG-00117        TO DP020-MSG-NUMBER  11190000
112000                 MOVE DP015-UNP-ALP-BRT-OFF  TO ANTIDA            11200000
112100                 MOVE DP015-RED              TO ANTIDC            11210000
112200                 MOVE DP015-REVERSE          TO ANTIDH            11220000
112300                 MOVE -1                     TO ANTIDL            11230000
112400             END-IF                                               11240000
112500         END-IF                                                   11250000
112600     END-IF.                                                      11260000
112700                                                                  11270000
112800                                                                  11280000
112900 4000-BUILD-INITIAL-PANEL.                                        11290000
113000                                                                  11300000
113100*    *------------------------------------------------------------11310000
113200*    * IF THE ADD FUNCTION IS BEING PERFORMED, DISPLAY THE SCREEN 11320000
113300*    * WITH ALL DATA FIELDS EMPTY AND UNPROTECTED, AND THE CURSOR 11330000
113400*    * ON NETWORK ID.                                             11340000
113500*    *------------------------------------------------------------11350000
113600     IF ASC-INT-APPL-FORMAT-ADD                                   11360000
113700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      11370000
113800         MOVE -1 TO ANTIDL                                        11380000
113900     ELSE                                                         11390000
114000*        *--------------------------------------------------------11400000
114100*        * IF THE UPDATE OR DELETE FUNCTION IS BEING PERFORMED,   11410000
114200*        * RETRIEVE THE INFORMATION FOR THE SELECTED NETWORK AND  11420000
114300*        * DISPLAY IT IF IT IS FOUND.                             11430000
114400*        *--------------------------------------------------------11440000
114500         PERFORM 4300-GET-NETWORK-INFO                            11450000
114600         IF SQLCODE = +100                                        11460000
114700             SET ASC-DATA-DOES-NOT-EXIST TO TRUE                  11470000
114800             EVALUATE TRUE                                        11480000
114900                 WHEN DP020-FK-REFRESH (DP020-SRC-AID)            11490000
115000                     SET DP020-MSG-FATAL TO TRUE                  11500000
115100*                    ---- DATA DOES NOT EXIST ----                11510000
115200                     MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER     11520000
115300                     PERFORM 4500-SET-ATTRIBUTES-TO-PROT          11530000
115400                     PERFORM 9100-READ-SEL-QUEUE                  11540000
115500                     SET ET335-DEL (ASC-SEL-SUB) TO TRUE          11550000
115600                     PERFORM 9200-REWRITE-SEL-QUEUE               11560000
115700                 WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)     11570000
115800                 WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)     11580000
115900                     IF PS-LIST-END                               11590000
116000                         CONTINUE                                 11600000
116100                     ELSE                                         11610000
116200                         SET DP020-MSG-FATAL TO TRUE              11620000
116300*                        ---- DATA DOES NOT EXIST ----            11630000
116400                         MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER 11640000
116500                     END-IF                                       11650000
116600                     PERFORM 4500-SET-ATTRIBUTES-TO-PROT          11660000
116700                     PERFORM 9100-READ-SEL-QUEUE                  11670000
116800                     SET ET335-DEL (ASC-SEL-SUB) TO TRUE          11680000
116900                     PERFORM 9200-REWRITE-SEL-QUEUE               11690000
117000                 WHEN OTHER                                       11700000
117100                     SET DP020-NEXT-ACT-APPL-ERROR                11710000
117200                         DP020-MSG-FATAL           TO TRUE        11720000
117300*                    ---- DATA DOES NOT EXIST ----                11730000
117400                     MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER     11740000
117500             END-EVALUATE                                         11750000
117600         ELSE                                                     11760000
117700             SET ASC-DATA-EXISTS TO TRUE                          11770000
117800             IF ASC-INT-APPL-FORMAT-DELETE                        11780000
117900*                *------------------------------------------------11790000
118000*                * IF THE DELETE FUNCTION IS BEING PERFORMED,     11800000
118100*                * PROTECT THE SCREEN FIELDS AND ISSUE THE        11810000
118200*                * CONFIRMATION MSG.                              11820000
118300*                *------------------------------------------------11830000
118400                 PERFORM 4500-SET-ATTRIBUTES-TO-PROT              11840000
118500                 IF PS-NO-LIST-END                                11850000
118600                     SET DP020-MSG-INFORMATIONAL TO TRUE          11860000
118700*                    ---- PRESS F2 TO CONFIRM REQUEST ----        11870000
118800                     MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER     11880000
118900                 END-IF                                           11890000
119000             ELSE                                                 11900000
119100*                *------------------------------------------------11910000
119200*                * IF THE UPDATE FUNCTION IS BEING PERFORMED,     11920000
119300*                * PROTECT THE NETWORK ID AND SET THE CURSOR ON   11930000
119400*                * NETWORK NAME.                                  11940000
119500*                *-------------------------------------------     11950000
119600                 MOVE ASC-MAP-DETAIL-FIELDS                       11960000
119700                                     TO ASC-ORIG-MAP-DETAIL-FIELDS11970000
119800                 PERFORM 3225-RESET-ATTRIBUTES                    11980000
119900                 MOVE -1                    TO ANAMEL             11990000
120000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              12000000
120100             END-IF                                               12010000
120200         END-IF                                                   12020000
120300     END-IF.                                                      12030000
120400                                                                  12040000
120500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        12050000
120600                                                                  12060000
120700                                                                  12070000
120800 4300-GET-NETWORK-INFO.                                           12080000
120900                                                                  12090000
121000     PERFORM 4310-READ-TNETWRK.                                   12100000
121100                                                                  12110000
121200     EVALUATE TRUE                                                12120000
121300         WHEN SQLCODE = ZERO                                      12130000
121400             MOVE NETWRK-NETWK-NME      TO ASC-NETWORK-NAME       12140000
121500             MOVE NETWRK-NETWK-TYPE-CDE TO ASC-TYPE-CDE           12150000
121600             EVALUATE TRUE                                        12160000
121700                 WHEN ASC-TYPE-CDE = PC-TYPE-CDE-DIALUP           12170000
121800                     MOVE PC-TYPE-CDE-DESC-DIALUP                 12180000
121900                                        TO ASC-TYPE-CDE-DESC      12190000
122000                 WHEN ASC-TYPE-CDE = PC-TYPE-CDE-LEASE-LINE       12200000
122100                     MOVE PC-TYPE-CDE-DESC-LEASE-LINE             12210000
122200                                        TO ASC-TYPE-CDE-DESC      12220000
122300                 WHEN ASC-TYPE-CDE = PC-TYPE-CDE-INTCONNECT       12230000
122400                     MOVE PC-TYPE-CDE-DESC-INTCONNECT             12240000
122500                                        TO ASC-TYPE-CDE-DESC      12250000
122600             END-EVALUATE                                         12260000
122700                                                                  12270000
122800             MOVE NETWRK-LNE-SPEED-NBR  TO ASC-LINE-SPEED         12280000
122900             MOVE NETWRK-KOHLS-UID      TO ASC-USER-ID            12290000
123000             MOVE NETWRK-KOHLS-PASSWORD-ID                        12300000
123100                                        TO ASC-PASSWORD           12310000
123200                                                                  12320000
123300*            *----------------------------------------------------12330000
123400*            * BREAK THE DIALUP PHONE INTO PARTS.                 12340000
123500*            *----------------------------------------------------12350000
123600             MOVE NETWRK-COMM-PHN-NBR   TO PV-PHONE               12360000
123700             MOVE PV-PHONE-PART1        TO ASC-DIALUP-PHONE-PART1 12370000
123800             MOVE PV-PHONE-PART2        TO ASC-DIALUP-PHONE-PART2 12380000
123900             MOVE PV-PHONE-PART3        TO ASC-DIALUP-PHONE-PART3 12390000
124000             MOVE PV-PHONE-PART4        TO ASC-DIALUP-PHONE-PART4 12400000
124100                                                                  12410000
124200*            *----------------------------------------------------12420000
124300*            * BREAK THE CONTACT PHONE INTO PARTS.                12430000
124400*            *----------------------------------------------------12440000
124500             MOVE NETWRK-TECH-CNTCT-PHN-NBR                       12450000
124600                                        TO PV-PHONE               12460000
124700             MOVE PV-PHONE-PART1        TO ASC-CONTACT-PHONE-PART112470000
124800             MOVE PV-PHONE-PART2        TO ASC-CONTACT-PHONE-PART212480000
124900             MOVE PV-PHONE-PART3        TO ASC-CONTACT-PHONE-PART312490000
125000             MOVE PV-PHONE-PART4        TO ASC-CONTACT-PHONE-PART412500000
125100                                                                  12510000
125200             MOVE NETWRK-DFLT-INCHG-ID-DESC                       12520000
125300                                        TO ASC-DFLT-INTCHG-ID-QUAL12530000
125400             MOVE NETWRK-DFLT-INCHG-ID  TO ASC-DFLT-INTCHG-ID     12540000
125500         WHEN SQLCODE = +100                                      12550000
125600             CONTINUE                                             12560000
125700     END-EVALUATE.                                                12570000
125800                                                                  12580000
125900                                                                  12590000
126000 4310-READ-TNETWRK.                                               12600000
126100                                                                  12610000
126200     EXEC SQL                                                     12620000
126300          SELECT NETWK_NME                                        12630000
126400               , NETWK_TYPE_CDE                                   12640000
126500               , COMM_PHN_NBR                                     12650000
126600               , LNE_SPEED_NBR                                    12660000
126700               , KOHLS_UID                                        12670000
126800               , KOHLS_PASSWORD_ID                                12680000
126900               , DFLT_INCHG_ID                                    12690000
127000               , DFLT_INCHG_ID_DESC                               12700000
127100               , TECH_CNTCT_PHN_NBR                               12710000
127200          INTO   :NETWRK-NETWK-NME                                12720000
127300               , :NETWRK-NETWK-TYPE-CDE                           12730000
127400               , :NETWRK-COMM-PHN-NBR                             12740000
127500               , :NETWRK-LNE-SPEED-NBR                            12750000
127600               , :NETWRK-KOHLS-UID                                12760000
127700               , :NETWRK-KOHLS-PASSWORD-ID                        12770000
127800               , :NETWRK-DFLT-INCHG-ID                            12780000
127900               , :NETWRK-DFLT-INCHG-ID-DESC                       12790000
128000               , :NETWRK-TECH-CNTCT-PHN-NBR                       12800000
128100          FROM TNETWRK                                            12810000
128200          WHERE NETWK_ID = :ASC-NETWORK-ID                        12820000
128300     END-EXEC.                                                    12830000
128400                                                                  12840000
128500     EVALUATE TRUE                                                12850000
128600         WHEN SQLCODE = ZERO                                      12860000
128700         WHEN SQLCODE = +100                                      12870000
128800             CONTINUE                                             12880000
128900         WHEN SQLWARN0 NOT = SPACE                                12890000
129000         WHEN SQLCODE  NOT = ZERO                                 12900000
129100             MOVE '4310-READ-TNETWRK'   TO  DP013-PARAGRAPH       12910000
129200             MOVE 'SELECT FROM TNETWRK' TO  DP013-MESSAGE-TEXT (1)12920000
129300             MOVE SQLCA                 TO  DP013-SQLCA           12930000
129400             SET DP013-DB2-ABEND        TO  TRUE                  12940000
129500             PERFORM DP013-0000-PROCESS-ABEND                     12950000
129600     END-EVALUATE.                                                12960000
129700                                                                  12970000
129800                                                                  12980000
129900 4400-MOVE-COMMAREA-TO-SCREEN.                                    12990000
130000                                                                  13000000
130100     MOVE ASC-NETWORK-ID            TO ANTIDO.                    13010000
130200     MOVE ASC-NETWORK-NAME          TO ANAMEO.                    13020000
130300     MOVE ASC-TYPE-CDE              TO ATYPEO.                    13030000
130400     MOVE ASC-TYPE-CDE-DESC         TO ATYPDSCO.                  13040000
130500                                                                  13050000
130600*    *------------------------------------------------------------13060000
130700*    * REMOVE LEADING ZEROS AND LEFT JUSTIFY THE LINE SPEED.      13070000
130800*    *------------------------------------------------------------13080000
130900     INSPECT ASC-LINE-SPEED                                       13090000
131000         TALLYING PV-SUB FOR LEADING ZEROS.                       13100000
131100                                                                  13110000
131200     ADD  +1 TO PV-SUB.                                           13120000
131300     MOVE +1 TO PV-SUB2.                                          13130000
131400     MOVE SPACE TO PV-LINE-SPEED.                                 13140000
131500                                                                  13150000
131600     PERFORM                                                      13160000
131700         VARYING PV-SUB FROM PV-SUB BY 1                          13170000
131800         UNTIL PV-SUB > LENGTH OF ALSPEEDO                        13180000
131900             MOVE ASC-LINE-SPEED-DIGIT (PV-SUB)                   13190000
132000               TO  PV-LINE-SPEED-DIGIT (PV-SUB2)                  13200000
132100             ADD +1 TO PV-SUB2                                    13210000
132200     END-PERFORM.                                                 13220000
132300                                                                  13230000
132400     MOVE PV-LINE-SPEED             TO ALSPEEDO.                  13240000
132500                                                                  13250000
132600     MOVE ASC-USER-ID               TO AUSERIDO.                  13260000
132700     MOVE ASC-PASSWORD              TO APASSWDO.                  13270000
132800     MOVE ASC-DIALUP-PHONE-PART1    TO ADIAL1O.                   13280000
132900     MOVE ASC-DIALUP-PHONE-PART2    TO ADIAL2O.                   13290000
133000     MOVE ASC-DIALUP-PHONE-PART3    TO ADIAL3O.                   13300000
133100     MOVE ASC-DIALUP-PHONE-PART4    TO ADIAL4O.                   13310000
133200     MOVE ASC-CONTACT-PHONE-PART1   TO ACNTCT1O.                  13320000
133300     MOVE ASC-CONTACT-PHONE-PART2   TO ACNTCT2O.                  13330000
133400     MOVE ASC-CONTACT-PHONE-PART3   TO ACNTCT3O.                  13340000
133500     MOVE ASC-CONTACT-PHONE-PART4   TO ACNTCT4O.                  13350000
133600     MOVE ASC-DFLT-INTCHG-ID-QUAL   TO AINTIDQO                   13360000
133700     MOVE ASC-DFLT-INTCHG-ID        TO AINTIDO.                   13370000
133800                                                                  13380000
133900                                                                  13390000
134000 4500-SET-ATTRIBUTES-TO-PROT.                                     13400000
134100                                                                  13410000
134200     MOVE DP015-PRO-NOR-OFF TO ANTIDA                             13420000
134300                               ANAMEA                             13430000
134400                               ATYPEA                             13440000
134500                               ALSPEEDA                           13450000
134600                               AUSERIDA                           13460000
134700                               APASSWDA                           13470000
134800                               ADIAL1A                            13480000
134900                               ADIAL2A                            13490000
135000                               ADIAL3A                            13500000
135100                               ADIAL4A                            13510000
135200                               ACNTCT1A                           13520000
135300                               ACNTCT2A                           13530000
135400                               ACNTCT3A                           13540000
135500                               ACNTCT4A                           13550000
135600                               AINTIDQA                           13560000
135700                               AINTIDA.                           13570000
135800                                                                  13580000
135900     MOVE DP015-BLUE        TO ANTIDC                             13590000
136000                               ANAMEC                             13600000
136100                               ATYPEC                             13610000
136200                               ALSPEEDC                           13620000
136300                               AUSERIDC                           13630000
136400                               APASSWDC                           13640000
136500                               ADIAL1C                            13650000
136600                               ADIAL2C                            13660000
136700                               ADIAL3C                            13670000
136800                               ADIAL4C                            13680000
136900                               ACNTCT1C                           13690000
137000                               ACNTCT2C                           13700000
137100                               ACNTCT3C                           13710000
137200                               ACNTCT4C                           13720000
137300                               AINTIDQC                           13730000
137400                               AINTIDC.                           13740000
137500                                                                  13750000
137600     MOVE DP015-HL-OFF      TO ANTIDH                             13760000
137700                               ANAMEH                             13770000
137800                               ATYPEH                             13780000
137900                               ALSPEEDH                           13790000
138000                               AUSERIDH                           13800000
138100                               APASSWDH                           13810000
138200                               ADIAL1H                            13820000
138300                               ADIAL2H                            13830000
138400                               ADIAL3H                            13840000
138500                               ADIAL4H                            13850000
138600                               ACNTCT1H                           13860000
138700                               ACNTCT2H                           13870000
138800                               ACNTCT3H                           13880000
138900                               ACNTCT4H                           13890000
139000                               AINTIDQH                           13900000
139100                               AINTIDH.                           13910000
139200                                                                  13920000
139300                                                                  13930000
139400 5000-ADD-NETWORK.                                                13940000
139500                                                                  13950000
139600     MOVE ASC-NETWORK-ID          TO NETWRK-NETWK-ID.             13960000
139700     MOVE ASC-NETWORK-NAME        TO NETWRK-NETWK-NME.            13970000
139800     MOVE ASC-TYPE-CDE            TO NETWRK-NETWK-TYPE-CDE.       13980000
139900     MOVE ASC-LINE-SPEED          TO NETWRK-LNE-SPEED-NBR.        13990000
140000     MOVE ASC-USER-ID             TO NETWRK-KOHLS-UID.            14000000
140100     MOVE ASC-PASSWORD            TO NETWRK-KOHLS-PASSWORD-ID.    14010000
140200                                                                  14020000
140300*    *------------------------------------------------------------14030000
140400*    * COMBINE THE 4 PARTS OF THE DIALUP PHONE NUMBER BEFORE      14040000
140500*    * MOVING IT TO THE DCLGEN.                                   14050000
140600*    *------------------------------------------------------------14060000
140700     MOVE ASC-DIALUP-PHONE-PART1  TO PV-PHONE-PART1.              14070000
140800     MOVE ASC-DIALUP-PHONE-PART2  TO PV-PHONE-PART2.              14080000
140900     MOVE ASC-DIALUP-PHONE-PART3  TO PV-PHONE-PART3.              14090000
141000     MOVE ASC-DIALUP-PHONE-PART4  TO PV-PHONE-PART4.              14100000
141100     MOVE PV-PHONE                TO NETWRK-COMM-PHN-NBR.         14110000
141200                                                                  14120000
141300*    *------------------------------------------------------------14130000
141400*    * COMBINE THE 4 PARTS OF THE CONTACT PHONE NUMBER BEFORE     14140000
141500*    * MOVING IT TO THE DCLGEN.                                   14150000
141600*    *------------------------------------------------------------14160000
141700     MOVE ASC-CONTACT-PHONE-PART1 TO PV-PHONE-PART1.              14170000
141800     MOVE ASC-CONTACT-PHONE-PART2 TO PV-PHONE-PART2.              14180000
141900     MOVE ASC-CONTACT-PHONE-PART3 TO PV-PHONE-PART3.              14190000
142000     MOVE ASC-CONTACT-PHONE-PART4 TO PV-PHONE-PART4.              14200000
142100     MOVE PV-PHONE                TO NETWRK-TECH-CNTCT-PHN-NBR.   14210000
142200                                                                  14220000
142300     MOVE ASC-DFLT-INTCHG-ID-QUAL TO NETWRK-DFLT-INCHG-ID-DESC.   14230000
142400     MOVE ASC-DFLT-INTCHG-ID      TO NETWRK-DFLT-INCHG-ID.        14240000
142500                                                                  14250000
142600     PERFORM 5050-INSERT-TNETWRK-ROW.                             14260000
142700                                                                  14270000
142800     IF SQLCODE NOT = 0                                           14280000
142900         SET PS-ADD-NOT-SUCCESSFUL                                14290000
143000             DP020-MSG-WARNING TO TRUE                            14300000
143100*        ---- WAIT 15 SECONDS, THEN RETRY ----                    14310000
143200         MOVE PC-TSYMSG-00551  TO DP020-MSG-NUMBER                14320000
143300     END-IF.                                                      14330000
143400                                                                  14340000
143500                                                                  14350000
143600*----------------------------------------------------------------*14360000
143700* INSERT A ROW INTO THE TNETWRK TABLE                            *14370000
143800*----------------------------------------------------------------*14380000
143900 5050-INSERT-TNETWRK-ROW.                                         14390000
144000                                                                  14400000
144100     EXEC SQL                                                     14410000
144200         INSERT INTO TNETWRK                                      14420000
144300            (                                                     14430000
144400             NETWK_ID                                             14440000
144500            ,NETWK_NME                                            14450000
144600            ,NETWK_TYPE_CDE                                       14460000
144700            ,COMM_PHN_NBR                                         14470000
144800            ,LNE_SPEED_NBR                                        14480000
144900            ,KOHLS_UID                                            14490000
145000            ,KOHLS_PASSWORD_ID                                    14500000
145100            ,DFLT_INCHG_ID                                        14510000
145200            ,DFLT_INCHG_ID_DESC                                   14520000
145300            ,TECH_CNTCT_PHN_NBR                                   14530000
145400            )                                                     14540000
145500         VALUES                                                   14550000
145600            (                                                     14560000
145700             :NETWRK-NETWK-ID                                     14570000
145800            ,:NETWRK-NETWK-NME                                    14580000
145900            ,:NETWRK-NETWK-TYPE-CDE                               14590000
146000            ,:NETWRK-COMM-PHN-NBR                                 14600000
146100            ,:NETWRK-LNE-SPEED-NBR                                14610000
146200            ,:NETWRK-KOHLS-UID                                    14620000
146300            ,:NETWRK-KOHLS-PASSWORD-ID                            14630000
146400            ,:NETWRK-DFLT-INCHG-ID                                14640000
146500            ,:NETWRK-DFLT-INCHG-ID-DESC                           14650000
146600            ,:NETWRK-TECH-CNTCT-PHN-NBR                           14660000
146700            )                                                     14670000
146800     END-EXEC.                                                    14680000
146900                                                                  14690000
147000     EVALUATE TRUE                                                14700000
147100         WHEN SQLCODE = ZERO                                      14710000
147200         WHEN SQLCODE = -904                                      14720000
147300         WHEN SQLCODE = -913                                      14730000
147400             CONTINUE                                             14740000
147500         WHEN SQLWARN0 NOT = SPACES                               14750000
147600         WHEN SQLCODE  NOT = ZERO                                 14760000
147700             MOVE '5150-INSERT-TNETWRK-ROW'                       14770000
147800                               TO DP013-PARAGRAPH                 14780000
147900             MOVE 'INSERT A ROW INTO THE TNETWRK TABLE'           14790000
148000                               TO DP013-MESSAGE-TEXT(1)           14800000
148100             MOVE SQLCA        TO DP013-SQLCA                     14810000
148200             MOVE 'TNETWRK'    TO DP013-DB2-TABLE-NAME (1)        14820000
148300             SET DP013-DB2-ABEND                                  14830000
148400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               14840000
148500             PERFORM DP013-0000-PROCESS-ABEND                     14850000
148600     END-EVALUATE.                                                14860000
148700                                                                  14870000
148800                                                                  14880000
148900 5100-UPDATE-NETWORK.                                             14890000
149000                                                                  14900000
149100     MOVE ASC-NETWORK-ID          TO NETWRK-NETWK-ID.             14910000
149200     MOVE ASC-NETWORK-NAME        TO NETWRK-NETWK-NME.            14920000
149300     MOVE ASC-TYPE-CDE            TO NETWRK-NETWK-TYPE-CDE.       14930000
149400     MOVE ASC-LINE-SPEED          TO NETWRK-LNE-SPEED-NBR.        14940000
149500     MOVE ASC-USER-ID             TO NETWRK-KOHLS-UID.            14950000
149600     MOVE ASC-PASSWORD            TO NETWRK-KOHLS-PASSWORD-ID.    14960000
149700                                                                  14970000
149800*    *------------------------------------------------------------14980000
149900*    * COMBINE THE 4 PARTS OF THE DIALUP PHONE NUMBER BEFORE      14990000
150000*    * MOVING IT TO THE DCLGEN.                                   15000000
150100*    *------------------------------------------------------------15010000
150200     MOVE ASC-DIALUP-PHONE-PART1  TO PV-PHONE-PART1.              15020000
150300     MOVE ASC-DIALUP-PHONE-PART2  TO PV-PHONE-PART2.              15030000
150400     MOVE ASC-DIALUP-PHONE-PART3  TO PV-PHONE-PART3.              15040000
150500     MOVE ASC-DIALUP-PHONE-PART4  TO PV-PHONE-PART4.              15050000
150600     MOVE PV-PHONE                TO NETWRK-COMM-PHN-NBR.         15060000
150700                                                                  15070000
150800*    *------------------------------------------------------------15080000
150900*    * COMBINE THE 4 PARTS OF THE CONTACT PHONE NUMBER BEFORE     15090000
151000*    * MOVING IT TO THE DCLGEN.                                   15100000
151100*    *------------------------------------------------------------15110000
151200     MOVE ASC-CONTACT-PHONE-PART1 TO PV-PHONE-PART1.              15120000
151300     MOVE ASC-CONTACT-PHONE-PART2 TO PV-PHONE-PART2.              15130000
151400     MOVE ASC-CONTACT-PHONE-PART3 TO PV-PHONE-PART3.              15140000
151500     MOVE ASC-CONTACT-PHONE-PART4 TO PV-PHONE-PART4.              15150000
151600     MOVE PV-PHONE                TO NETWRK-TECH-CNTCT-PHN-NBR.   15160000
151700                                                                  15170000
151800     MOVE ASC-DFLT-INTCHG-ID-QUAL TO NETWRK-DFLT-INCHG-ID-DESC.   15180000
151900     MOVE ASC-DFLT-INTCHG-ID      TO NETWRK-DFLT-INCHG-ID.        15190000
152000                                                                  15200000
152100     PERFORM 5150-UPDATE-TNETWRK-ROW.                             15210000
152200                                                                  15220000
152300     IF SQLCODE = ZERO                                            15230000
152400         MOVE ASC-MAP-DETAIL-FIELDS TO ASC-ORIG-MAP-DETAIL-FIELDS 15240000
152500         SET DP020-MSG-INFORMATIONAL TO TRUE                      15250000
152600*        ---- UPDATES SUCCESSFUL ----                             15260000
152700         MOVE PC-TSYMSG-00059        TO DP020-MSG-NUMBER          15270000
152800         PERFORM 9100-READ-SEL-QUEUE                              15280000
152900         SET ET335-UPD (ASC-SEL-SUB) TO TRUE                      15290000
153000         PERFORM 9200-REWRITE-SEL-QUEUE                           15300000
153100     END-IF.                                                      15310000
153200                                                                  15320000
153300                                                                  15330000
153400 5150-UPDATE-TNETWRK-ROW.                                         15340000
153500                                                                  15350000
153600     EXEC SQL                                                     15360000
153700         UPDATE TNETWRK                                           15370000
153800             SET                                                  15380000
153900                 NETWK_NME          = :NETWRK-NETWK-NME           15390000
154000                ,NETWK_TYPE_CDE     = :NETWRK-NETWK-TYPE-CDE      15400000
154100                ,COMM_PHN_NBR       = :NETWRK-COMM-PHN-NBR        15410000
154200                ,LNE_SPEED_NBR      = :NETWRK-LNE-SPEED-NBR       15420000
154300                ,KOHLS_UID          = :NETWRK-KOHLS-UID           15430000
154400                ,KOHLS_PASSWORD_ID  = :NETWRK-KOHLS-PASSWORD-ID   15440000
154500                ,DFLT_INCHG_ID      = :NETWRK-DFLT-INCHG-ID       15450000
154600                ,DFLT_INCHG_ID_DESC = :NETWRK-DFLT-INCHG-ID-DESC  15460000
154700                ,TECH_CNTCT_PHN_NBR = :NETWRK-TECH-CNTCT-PHN-NBR  15470000
154800             WHERE  NETWK_ID = :NETWRK-NETWK-ID                   15480000
154900     END-EXEC.                                                    15490000
155000                                                                  15500000
155100     EVALUATE TRUE                                                15510000
155200         WHEN SQLCODE = ZERO                                      15520000
155300             CONTINUE                                             15530000
155400         WHEN SQLCODE = +100                                      15540000
155500             PERFORM 4500-SET-ATTRIBUTES-TO-PROT                  15550000
155600*            ---- DATA DOES NOT EXIST ----                        15560000
155700             MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER             15570000
155800             SET DP020-MSG-FATAL  TO TRUE                         15580000
155900             INITIALIZE ASC-MAP-DETAIL-FIELDS                     15590000
156000         WHEN SQLCODE = -904                                      15600000
156100         WHEN SQLCODE = -913                                      15610000
156200             SET DP020-MSG-WARNING TO TRUE                        15620000
156300*            ---- WAIT 15 SECONDS, THEN RETRY ----                15630000
156400             MOVE PC-TSYMSG-00551  TO DP020-MSG-NUMBER            15640000
156500         WHEN SQLWARN0 NOT = SPACES                               15650000
156600         WHEN SQLCODE  NOT = ZERO                                 15660000
156700             MOVE '5150-UPDATE-TNETWRK-ROW'                       15670000
156800                               TO DP013-PARAGRAPH                 15680000
156900             MOVE 'UPDATE A ROW IN TNETWRK'                       15690000
157000                               TO DP013-MESSAGE-TEXT(1)           15700000
157100             MOVE SQLCA        TO DP013-SQLCA                     15710000
157200             MOVE 'TNETWRK'    TO DP013-DB2-TABLE-NAME (1)        15720000
157300             SET DP013-DB2-ABEND                                  15730000
157400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               15740000
157500             PERFORM DP013-0000-PROCESS-ABEND                     15750000
157600     END-EVALUATE.                                                15760000
157700                                                                  15770000
157800                                                                  15780000
157900 5200-DELETE-NETWORK.                                             15790000
158000                                                                  15800000
158100     PERFORM 5250-DELETE-TNETWRK-ROW.                             15810000
158200                                                                  15820000
158300     EVALUATE TRUE                                                15830000
158400         WHEN SQLCODE = 0                                         15840000
158500*            ---- DELETE SUCCESSFUL ----                          15850000
158600             MOVE PC-TSYMSG-00115         TO DP020-MSG-NUMBER     15860000
158700             SET  DP020-MSG-INFORMATIONAL                         15870000
158800                 ASC-DATA-DOES-NOT-EXIST  TO TRUE                 15880000
158900             PERFORM 9100-READ-SEL-QUEUE                          15890000
159000             SET ET335-DEL (ASC-SEL-SUB)  TO TRUE                 15900000
159100             PERFORM 9200-REWRITE-SEL-QUEUE                       15910000
159200             INITIALIZE ASC-MAP-DETAIL-FIELDS                     15920000
159300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15930000
159400         WHEN SQLCODE = +100                                      15940000
159500*            ---- CANNOT DELETE - RECORD DOES NOT EXIST ----      15950000
159600             MOVE PC-TSYMSG-00116         TO DP020-MSG-NUMBER     15960000
159700             SET  DP020-MSG-FATAL                                 15970000
159800                  ASC-DATA-DOES-NOT-EXIST TO TRUE                 15980000
159900         WHEN SQLCODE = -532                                      15990000
160000*            ---- RELATED INFO EXISTS - DELETE NOT ALLOWED ----   16000000
160100             MOVE PC-TSYMSG-00232         TO DP020-MSG-NUMBER     16010000
160200             SET  DP020-MSG-FATAL         TO TRUE                 16020000
160300         WHEN OTHER                                               16030000
160400             SET DP020-MSG-WARNING TO TRUE                        16040000
160500*        ---- WAIT 15 SECONDS, THEN RETRY ----                    16050000
160600             MOVE PC-TSYMSG-00551  TO DP020-MSG-NUMBER            16060000
160700     END-EVALUATE.                                                16070000
160800                                                                  16080000
160900                                                                  16090000
161000 5250-DELETE-TNETWRK-ROW.                                         16100000
161100                                                                  16110000
161200     EXEC SQL                                                     16120000
161300         DELETE FROM TNETWRK                                      16130000
161400         WHERE  NETWK_ID = :ASC-NETWORK-ID                        16140000
161500     END-EXEC.                                                    16150000
161600                                                                  16160000
161700     EVALUATE TRUE                                                16170000
161800         WHEN SQLCODE = ZERO                                      16180000
161900         WHEN SQLCODE = +100                                      16190000
162000         WHEN SQLCODE = -532                                      16200000
162100         WHEN SQLCODE = -904                                      16210000
162200         WHEN SQLCODE = -913                                      16220000
162300             CONTINUE                                             16230000
162400         WHEN SQLWARN0 NOT = SPACES                               16240000
162500         WHEN SQLCODE  NOT = ZERO                                 16250000
162600             MOVE '5250-DELETE-TNETWRK-ROW'                       16260000
162700                               TO DP013-PARAGRAPH                 16270000
162800             MOVE 'DELETE A ROW FROM TNETWRK'                     16280000
162900                               TO DP013-MESSAGE-TEXT(1)           16290000
163000             MOVE SQLCA        TO DP013-SQLCA                     16300000
163100             MOVE 'TNETWRK'    TO DP013-DB2-TABLE-NAME (1)        16310000
163200             SET DP013-DB2-ABEND                                  16320000
163300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16330000
163400             PERFORM DP013-0000-PROCESS-ABEND                     16340000
163500     END-EVALUATE.                                                16350000
163600                                                                  16360000
163700                                                                  16370000
163800*----------------------------------------------------------------*16380000
163900* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *16390000
164000*----------------------------------------------------------------*16400000
164100 9100-READ-SEL-QUEUE.                                             16410000
164200                                                                  16420000
164300     EXEC CICS                                                    16430000
164400         READQ TS                                                 16440000
164500             QUEUE (ASC-SEL-QUEUE-NAME)                           16450000
164600             INTO  (ET335-NETWORK-ID-REC)                         16460000
164700             ITEM  (ASC-SEL-ITEM)                                 16470000
164800             RESP  (PV-CICS-RESP)                                 16480000
164900     END-EXEC.                                                    16490000
165000                                                                  16500000
165100     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           16510000
165200         CONTINUE                                                 16520000
165300     ELSE                                                         16530000
165400         SET DP013-LOGIC-ABEND                                    16540000
165500             DP013-NO-ROLLBACK      TO TRUE                       16550000
165600         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            16560000
165700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   16570000
165800                                    TO DP013-MESSAGE-TEXT (1)     16580000
165900         PERFORM DP013-0000-PROCESS-ABEND                         16590000
166000     END-IF.                                                      16600000
166100                                                                  16610000
166200                                                                  16620000
166300*----------------------------------------------------------------*16630000
166400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *16640000
166500*----------------------------------------------------------------*16650000
166600 9200-REWRITE-SEL-QUEUE.                                          16660000
166700                                                                  16670000
166800     EXEC CICS                                                    16680000
166900          WRITEQ TS                                               16690000
167000              QUEUE  (ASC-SEL-QUEUE-NAME)                         16700000
167100              FROM   (ET335-NETWORK-ID-REC)                       16710000
167200              ITEM   (ASC-SEL-ITEM)                               16720000
167300              RESP   (PV-CICS-RESP)                               16730000
167400              REWRITE                                             16740000
167500     END-EXEC.                                                    16750000
167600                                                                  16760000
167700     IF  PV-CICS-RESP NOT = DFHRESP(NORMAL)                       16770000
167800         SET DP013-CICS-ABEND                                     16780000
167900             DP013-NO-ROLLBACK         TO TRUE                    16790000
168000         MOVE '9200-REWRITE-SEL-QUEUE' TO DP013-PARAGRAPH         16800000
168100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   16810000
168200                                       TO DP013-MESSAGE-TEXT (1)  16820000
168300         PERFORM DP013-0000-PROCESS-ABEND                         16830000
168400     END-IF.                                                      16840000
168500                                                                  16850000
168600                                                                  16860000
168700*----------------------------------------------------------------*16870000
168800*    ABEND PROCESSOR MODULE                                      *16880000
168900*----------------------------------------------------------------*16890000
169000                                                                  16900000
169100     COPY DPPD013.                                                16910000
