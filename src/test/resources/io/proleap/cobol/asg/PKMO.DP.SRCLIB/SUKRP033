000100***************************************************************** 00040002
000200 IDENTIFICATION DIVISION.                                         00050002
000300***************************************************************** 00060002
000400 PROGRAM-ID.             SUKRP033.                                00070002
000500 AUTHOR.                 DEANNA BRANTNER.                         00080002
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00090002
000700 DATE-WRITTEN            AUGUST 2002.                             00100002
000800 DATE-COMPILED.                                                   00110002
000900***************************************************************** 00120002
001000*  THIS PROGRAM WILL CREATE THE DAILY TRAILER SUSPENSE REPORT - * 00130002
001100*  SHIPPED BUT NOT OPENED AT STORE REPORT.                      * 00140002
001200***************************************************************** 00250002
001300*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00260002
001400*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00270002
001500***************************************************************** 00290002
001600***************************************************************** 00300002
001700 ENVIRONMENT DIVISION.                                            00310002
001800***************************************************************** 00320002
001900 CONFIGURATION SECTION.                                           00340002
002000 SOURCE-COMPUTER.        IBM-3090.                                00360002
002100 OBJECT-COMPUTER.        IBM-3090.                                00370002
002200                                                                  00380002
002300 INPUT-OUTPUT SECTION.                                            00390002
002400 FILE-CONTROL.                                                    00410002
002500*                                                                 00420002
002600     SELECT INPUT-FILE                                            00430002
002700         ASSIGN TO INP01.                                         00440002
002800*                                                                 00450002
002900     SELECT REPORT-FILE                                           00490002
003000         ASSIGN TO RPT01.                                         00500002
003100*                                                                 00510002
003200***************************************************************** 00520002
003300 DATA DIVISION.                                                   00530002
003400***************************************************************** 00540002
003500 FILE SECTION.                                                    00550002
003600*                                                                 00560002
003700 FD  INPUT-FILE                                                   00570002
003800     RECORDING MODE IS F                                          00580002
003900     LABEL RECORDS ARE STANDARD                                   00590002
004000     BLOCK CONTAINS 0 RECORDS                                     00610007
004100     RECORD CONTAINS 081 CHARACTERS.                              00611020
004200 01  INPUT-RECORD                    PIC  X(081).                 00630020
004300*                                                                 00640002
004400 FD  REPORT-FILE                                                  00720002
004500     RECORDING MODE IS F                                          00730002
004600     BLOCK CONTAINS 0  RECORDS.                                   00740002
004700 01  REPORT-RECORD                   PIC  X(132).                 00750002
004800*                                                                 00760002
004900***************************************************************** 00770002
005000 WORKING-STORAGE SECTION.                                         00780002
005100*                                                                 00790002
005200 01  PROGRAM-SWITCHES.                                            01020002
005300     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         01030002
005400         88  PS-END-OF-INPUT                   VALUE 'Y'.         01040002
005500         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         01050002
005600*                                                                 01060002
005700 01  PC-PROGRAM-CONSTANTS.                                        01070002
005800     05  PC-SUKRP033                 PIC X(08) VALUE  'SUKRP033'. 01080002
005900     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        01100002
006000*                                                                 01110002
006100 01  PV-PROGRAM-VARIABLES.                                        01120002
006200     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACE.       01130002
006300     05  PV-TIMESTAMP                PIC X(26) VALUE SPACE.       01130002
006400     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         01140002
006500                                                   COMP-3.        01150002
006600     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         01160002
006700                                                   COMP-3.        01170002
006800     05  PV-MAX-LINE-COUNT           PIC S9(3) VALUE +60          01180002
006900                                                   COMP-3.        01190002
007000     05  PV-OPER-UNT-ID              PIC S9(04) VALUE ZERO        01200040
007100                                                   COMP.          01201040
007200     05  PV-STR-NBR                  PIC S9(04) VALUE ZERO        01210040
007300                                                   COMP.          01220040
007400     05  PV-TODAYS-DATE.                                          01240002
007500         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        01250039
007600         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        01260002
007700         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        01270002
007800     05  PV-TODAYS-TIME.                                          01280002
007900         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        01290002
008000         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        01300002
008100         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        01310002
008200         10  FILLER                  PIC 9(02) VALUE ZERO.        01320002
008300     05  PV-COMPARE-DATE.                                         01321035
008400         10  PV-COMPARE-DATE-CC      PIC 9(02) VALUE ZERO.        01322035
008500         10  PV-COMPARE-DATE-YY      PIC 9(02) VALUE ZERO.        01322135
008600         10  FILLER                  PIC X(01) VALUE '-'.         01323035
008700         10  PV-COMPARE-DATE-MM      PIC 9(02) VALUE ZERO.        01324035
008800         10  FILLER                  PIC X(01) VALUE '-'.         01325035
008900         10  PV-COMPARE-DATE-DD      PIC 9(02) VALUE ZERO.        01326035
009000*                                                                 01330002
009100 01  PV-DATE-TIME.                                                01340007
009200     05  PV-DATE-TIME-CCYY            PIC X(04) VALUE SPACE.      01341007
009300     05  FILLER                       PIC X(01) VALUE SPACE.      01342007
009400     05  PV-DATE-TIME-MM              PIC X(02) VALUE SPACE.      01350007
009500     05  FILLER                       PIC X(01) VALUE SPACE.      01360007
009600     05  PV-DATE-TIME-DD              PIC X(02) VALUE SPACE.      01370007
009700     05  FILLER                       PIC X(01) VALUE SPACE.      01380007
009800     05  PV-DATE-TIME-HH              PIC X(02) VALUE SPACE.      01390007
009900     05  FILLER                       PIC X(01) VALUE SPACE.      01400007
010000     05  PV-DATE-TIME-MN              PIC X(02) VALUE SPACE.      01410007
010100     05  FILLER                       PIC X(01) VALUE SPACE.      01420007
010200     05  PV-DATE-TIME-SS              PIC X(02) VALUE SPACE.      01430007
010300     05  FILLER                       PIC X(07) VALUE SPACE.      01440007
010400*                                                                 01540002
010500 01  PV-DISPLAY-DATE.                                             01541007
010600     05  PV-DISPLAY-MM                PIC X(02) VALUE SPACE.      01542007
010700     05  FILLER                       PIC X(01) VALUE '/'.        01543007
010800     05  PV-DISPLAY-DD                PIC X(02) VALUE SPACE.      01544007
010900     05  FILLER                       PIC X(01) VALUE '/'.        01545007
011000     05  PV-DISPLAY-CCYY              PIC X(04) VALUE SPACE.      01546007
011100*                                                                 01548007
011200 01  PV-DISPLAY-TIME.                                             01549007
011300     05  PV-DISPLAY-HH                PIC X(02) VALUE SPACE.      01549107
011400     05  FILLER                       PIC X(01) VALUE ':'.        01549207
011500     05  PV-DISPLAY-MN                PIC X(02) VALUE SPACE.      01549307
011600*                                                                 01549607
011700 01  DK-DB2-KEY-FIELDS.                                           01550002
011800     05  DK-OPER-UNT-ID              PIC S9(04) COMP VALUE ZEROES.01560004
011900*                                                                 01570002
012000 01  ABEND-CODE                      PIC S9(4)  VALUE +0          01580002
012100                                                 COMP SYNC.       01590002
012200*                                                                 01600002
012300******************************************************************01610002
012400* COPY BOOK FOR TRAILER SUSPENSE - SHIPPED BUT NOT OPENED AT STORE01620002
012500******************************************************************01630002
012600     COPY SURD023.                                                01640051
012700/                                                                 01650051
012800*  LOGISTICS DOMAIN LOCATION MODULE                               01651051
012900*                                                                 01652051
013000     COPY XLWS071.                                                01653051
013100/                                                                 01654051
013200******************************************************************01660002
013300*  DB2 FORMATTED MESSAGE AREA                                     01670002
013400******************************************************************01680002
013500     COPY DPWS004.                                                01690002
013600*                                                                 01700002
013700******************************************************************01710002
013800*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01720002
013900******************************************************************01730002
014000     COPY DPWS132O.                                               01740002
014100*                                                                 01750002
014200 01  HEADING-LINES.                                               01760002
014300     05  HEADING-LINE-1.                                          01770002
014400         10  FILLER                  PIC  X(54)    VALUE SPACES.  01790002
014500         10  FILLER                  PIC  X(23)    VALUE          01800002
014600             'TRAILER SUSPENSE REPORT'.                           01810002
014700         10  FILLER                  PIC  X(47)    VALUE SPACES.  01820002
014800*                                                                 01830002
014900     05  HEADING-LINE-2.                                          01831002
015000         10  FILLER                  PIC  X(50)    VALUE SPACES.  01832002
015100         10  FILLER                  PIC  X(31)    VALUE          01834002
015200             'SHIPPED BUT NOT OPENED AT STORE'.                   01835005
015300         10  FILLER                  PIC  X(47)    VALUE SPACES.  01836002
015400*                                                                 01837002
015500     05  HEADING-LINE-3.                                          02040013
015600         10  FILLER                  PIC  X(02)    VALUE SPACE.   02050002
015700         10  FILLER                  PIC  X(11)    VALUE          02060002
015800             'OPER ID:   '.                                       02070002
015900         10  HL4-OPER-UNT            PIC  9(04)    VALUE ZEROES.  02080002
016000         10  FILLER                  PIC  X(02)    VALUE SPACES.  02100002
016100         10  HL4-OPER-NAME           PIC  X(20)    VALUE SPACES.  02120028
016200         10  FILLER                  PIC  X(01)    VALUE SPACES.  02121021
016300         10  FILLER                  PIC  X(38)    VALUE          02130025
016400             '*** SHIPPED TRAILERS NOT OPENED AFTER '.            02131025
016500         10  HL4-TRIP-HOURS          PIC  ZZ9      VALUE ZEROES.  02133019
016600         10  FILLER                  PIC  X(01)    VALUE SPACES.  02134017
016700         10  FILLER                  PIC  X(17)    VALUE          02135026
016800             'OR MORE HOURS ***'.                                 02136026
016900         10  FILLER                  PIC  X(02)    VALUE SPACES.  02137017
017000         10  FILLER                  PIC  X(30)    VALUE SPACES.  02140021
017100*                                                                 02250002
017200     05  HEADING-LINE-4.                                          02480013
017300         10  FILLER                  PIC  X(11)    VALUE SPACES.  02490003
017400         10  FILLER                  PIC  X(06)    VALUE          02520003
017500             ' NEW  '.                                            02530003
017600         10  FILLER                  PIC  X(66)    VALUE SPACES.  02531003
017700         10  FILLER                  PIC  X(09)    VALUE          02620002
017800             'TRAILER  '.                                         02630003
017900         10  FILLER                  PIC  X(05)    VALUE SPACES.  02631003
018000         10  FILLER                  PIC  X(19)    VALUE          02640003
018100             'TRAILER DEPARTED DC'.                               02650005
018200         10  FILLER                  PIC  X(35)    VALUE SPACES.  02700003
018300*                                                                 02710002
018400     05  HEADING-LINE-5.                                          02711013
018500         10  FILLER                  PIC  X(02)    VALUE SPACES.  02712003
018600         10  FILLER                  PIC  X(06)    VALUE          02713003
018700             'STORE '.                                            02714003
018800         10  FILLER                  PIC  X(03)    VALUE SPACES.  02715003
018900         10  FILLER                  PIC  X(06)    VALUE          02716003
019000             'STORE '.                                            02717003
019100         10  FILLER                  PIC  X(08)    VALUE SPACES.  02718003
019200         10  FILLER                  PIC  X(05)    VALUE          02719003
019300             'CITY '.                                             02719103
019400         10  FILLER                  PIC  X(10)    VALUE SPACES.  02719203
019500         10  FILLER                  PIC  X(06)    VALUE          02719303
019600             'STATE '.                                            02719403
019700         10  FILLER                  PIC  X(08)    VALUE SPACES.  02719503
019800         10  FILLER                  PIC  X(05)    VALUE          02719603
019900             'SCAC '.                                             02719703
020000         10  FILLER                  PIC  X(07)    VALUE SPACES.  02719803
020100         10  FILLER                  PIC  X(11)    VALUE          02719903
020200             'TRAILER ID '.                                       02720003
020300         10  FILLER                  PIC  X(06)    VALUE SPACES.  02720103
020400         10  FILLER                  PIC  X(09)    VALUE          02720203
020500             'SERIAL # '.                                         02720303
020600         10  FILLER                  PIC  X(10)    VALUE SPACES.  02720403
020700         10  FILLER                  PIC  X(10)    VALUE          02720503
020800             'DATE/TIME '.                                        02720603
020900         10  FILLER                  PIC  X(10)    VALUE SPACES.  02720728
021000         10  FILLER                  PIC  X(08)    VALUE          02720803
021100             'TRIP ID '.                                          02720903
021200         10  FILLER                  PIC  X(15)    VALUE SPACES.  02721003
021300*                                                                 02721103
021400     05  HEADING-LINE-6.                                          02722013
021500         10  FILLER                  PIC  X(02)    VALUE SPACES.  02723011
021600         10  FILLER                  PIC  X(06)    VALUE          02724011
021700             '----- '.                                            02725011
021800         10  FILLER                  PIC  X(03)    VALUE SPACES.  02726011
021900         10  FILLER                  PIC  X(06)    VALUE          02727011
022000             '----- '.                                            02728011
022100         10  FILLER                  PIC  X(03)    VALUE SPACES.  02729011
022200         10  FILLER                  PIC  X(15)    VALUE          02730012
022300             '---------------'.                                   02740011
022400         10  FILLER                  PIC  X(05)    VALUE SPACES.  02750013
022500         10  FILLER                  PIC  X(06)    VALUE          02760011
022600             '----- '.                                            02770011
022700         10  FILLER                  PIC  X(08)    VALUE SPACES.  02780011
022800         10  FILLER                  PIC  X(05)    VALUE          02790011
022900             '---- '.                                             02800011
023000         10  FILLER                  PIC  X(07)    VALUE SPACES.  02810011
023100         10  FILLER                  PIC  X(11)    VALUE          02820011
023200             '---------- '.                                       02830011
023300         10  FILLER                  PIC  X(06)    VALUE SPACES.  02840011
023400         10  FILLER                  PIC  X(09)    VALUE          02850011
023500             '-------- '.                                         02860011
023600         10  FILLER                  PIC  X(05)    VALUE SPACES.  02870011
023700         10  FILLER                  PIC  X(19)    VALUE          02880012
023800             '-------------------'.                               02890011
023900         10  FILLER                  PIC  X(06)    VALUE SPACES.  02900028
024000         10  FILLER                  PIC  X(08)    VALUE          02910011
024100             '------- '.                                          02920011
024200         10  FILLER                  PIC  X(15)    VALUE SPACES.  02930011
024300*                                                                 02950002
024400 01  DETAIL-LINES.                                                02960002
024500     05  DETAIL-LINE1.                                            02970002
024600         10  FILLER                 PIC  X(02)     VALUE SPACES.  02980002
024700         10  DL1-STR-NBR            PIC  Z(04)     VALUE SPACES.  02990003
024800         10  FILLER                 PIC  X(07)     VALUE SPACES.  03000045
024900         10  DL1-NEW-STR-SW         PIC  X(01)     VALUE SPACES.  03010003
025000         10  FILLER                 PIC  X(06)     VALUE SPACES.  03020050
025100         10  DL1-CITY               PIC  X(15)     VALUE SPACES.  03030003
025200         10  FILLER                 PIC  X(06)     VALUE SPACES.  03040003
025300         10  DL1-STATE              PIC  X(02)     VALUE SPACES.  03050003
025400         10  FILLER                 PIC  X(11)     VALUE SPACES.  03060009
025500         10  DL1-SCAC               PIC  X(04)     VALUE SPACES.  03070003
025600         10  FILLER                 PIC  X(08)     VALUE SPACES.  03080003
025700         10  DL1-TRLR-ID            PIC  X(12)     VALUE SPACES.  03090004
025800         10  FILLER                 PIC  X(05)     VALUE SPACES.  03100010
025900         10  DL1-TRLR-SRL-NBR       PIC  X(09)     VALUE SPACES.  03110003
026000         10  FILLER                 PIC  X(06)     VALUE SPACES.  03120011
026100         10  DL1-DATE               PIC  X(10)     VALUE SPACES.  03130010
026200         10  FILLER                 PIC  X(02)     VALUE SPACES.  03140010
026300         10  DL1-TIME               PIC  X(05)     VALUE SPACES.  03150003
026400         10  FILLER                 PIC  X(07)     VALUE SPACES.  03160028
026500         10  DL1-TRIP-ID            PIC  X(09)     VALUE SPACES.  03161003
026600         10  FILLER                 PIC  X(15)     VALUE SPACES.  03180003
026700*                                                                 03190002
026800 01  MISCELLANEOUS-LINES.                                         03660002
026900     05  BLANK-LINE.                                              03670002
027000         10  FILLER                  PIC  X(132)   VALUE SPACES.  03680002
027100     05  NO-DATA-LINE.                                            03690002
027200         10  FILLER                  PIC  X(42)    VALUE SPACES.  03700002
027300         10  FILLER                  PIC  X(47)    VALUE          03710002
027400             '**** NO INFORMATION EXISTS FOR THIS REPORT ****'.   03720002
027500         10  FILLER                  PIC  X(43)    VALUE SPACES.  03730002
027600     05  END-OF-REPORT-LINE.                                      03740002
027700         10  FILLER                  PIC  X(54)    VALUE SPACES.  03741015
027800         10  FILLER                  PIC  X(44)    VALUE          03750002
027900             '  ** END OF REPORT **                       '.      03760002
028000         10  FILLER                  PIC  X(44)    VALUE SPACES.  03770002
028100*                                                                 03880002
028200***************************************************************** 03890002
028300*  DB2 COMMUNICATION AREA                                         03900002
028400***************************************************************** 03901004
028500     EXEC SQL                                                     03920002
028600         INCLUDE SQLCA                                            03930002
028700     END-EXEC.                                                    03940002
028800                                                                  03950004
028900***************************************************************** 03951004
029000*  DB2 COMMUNICATION AREA2                                        03960002
029100***************************************************************** 03961004
029200     COPY SQLCA2.                                                 03980002
029300                                                                  03990002
029400                                                                  04010002
029500***************************************************************** 04011004
029600 PROCEDURE DIVISION.                                              04020002
029700*                                                                 04030002
029800 0000-MAINLINE-PROCESSING.                                        04040002
029900******************************************************************04050002
030000**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      04060002
030100******************************************************************04070002
030200*    DISPLAY '****** STARTING SUKRP033 ******'.                   04080002
030300*                                                                 04090002
030400*OPEN FILES.                                                      04100002
030500     OPEN INPUT INPUT-FILE                                        04110004
030600          OUTPUT REPORT-FILE.                                     04130004
030700*                                                                 04140002
030800*PREPARE REPORT.                                                  04150002
030900     PERFORM 1000-INITIALIZATION.                                 04160002
031000*                                                                 04170002
031100*READ FIRST RECORD.                                               04180002
031200     SET PS-NOT-END-OF-INPUT TO TRUE.                             04190002
031300     READ INPUT-FILE                                              04200004
031400       INTO SU023-EXTRACT-RECORD                                  04210004
031500         AT END                                                   04220002
031600           SET PS-END-OF-INPUT TO TRUE.                           04230002
031700*                                                                 04240002
031800*                                                                 04242014
031900*PROCESS INPUT FILE.                                              04250002
032000     IF PS-END-OF-INPUT                                           04260002
032100     ADD +1                  TO PV-PAGE-COUNT                     04261048
032200     MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER                04262048
032300     WRITE REPORT-RECORD                                          04264046
032400       FROM DP132O-STANDRD-HEADER-132-COLS                        04265046
032500         AFTER ADVANCING PAGE                                     04266047
032600     WRITE REPORT-RECORD                                          04268047
032700       FROM HEADING-LINE-1                                        04269046
032800         AFTER ADVANCING 2 LINES                                  04269147
032900     WRITE REPORT-RECORD                                          04269346
033000       FROM HEADING-LINE-2                                        04269446
033100         AFTER ADVANCING 1 LINE                                   04269547
033200     WRITE REPORT-RECORD                                          04271046
033300       FROM NO-DATA-LINE                                          04280046
033400         AFTER ADVANCING 2 LINES                                  04290046
033500     ELSE                                                         04300002
033600         MOVE SU023-OPER-UNT-ID TO DK-OPER-UNT-ID                 04310040
033700                                   PV-OPER-UNT-ID                 04311040
033800                                   HL4-OPER-UNT                   04312040
033900         PERFORM 2150-SELECT-STORE-NAME                           04313051
034000         MOVE SU023-TRIP-HOURS    TO HL4-TRIP-HOURS               04315040
034100         PERFORM 1500-PAGE-BREAK                                  04316040
034200         PERFORM 2000-PROCESS-INPUT UNTIL PS-END-OF-INPUT         04320040
034300     END-IF.                                                      04331040
034400*                                                                 04340002
034500*FINISH REPORT.                                                   04350002
034600     WRITE REPORT-RECORD                                          04360004
034700       FROM END-OF-REPORT-LINE                                    04370002
034800         AFTER ADVANCING 2 LINES.                                 04380002
034900*                                                                 04390002
035000*CLOSE FILES.                                                     04400002
035100     CLOSE INPUT-FILE                                             04410004
035200           REPORT-FILE.                                           04430004
035300*                                                                 04440002
035400     GOBACK.                                                      04450002
035500*                                                                 04460002
035600******************************************************************04461004
035700 1000-INITIALIZATION.                                             04470002
035800******************************************************************04480002
035900**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               04490002
036000******************************************************************04500002
036100     EXEC SQL                                                             
036200         SET :PV-TIMESTAMP = CURRENT TIMESTAMP                            
036300     END-EXEC.                                                            
036400                                                                          
036500     ACCEPT PV-TODAYS-DATE                                        04530002
036600       FROM DATE.                                                 04540002
036700*                                                                 04550002
036800     ACCEPT PV-TODAYS-TIME                                        04560002
036900       FROM TIME.                                                 04570002
037000*                                                                 04580002
037100     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH                  04590035
037200                                PV-COMPARE-DATE-MM.               04591035
037300     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY                    04600036
037400                                PV-COMPARE-DATE-DD.               04601035
037500     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR                   04610035
037600                                PV-COMPARE-DATE-YY.               04611035
037700     IF PV-COMPARE-DATE-YY  >  80                                 04612037
037800         MOVE  19            TO PV-COMPARE-DATE-CC                04613037
037900     ELSE                                                         04614035
038000         MOVE  20            TO PV-COMPARE-DATE-CC                04615037
038100     END-IF.                                                      04616035
038200*                                                                 04620002
038300     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  04630002
038400     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                04640002
038500*                                                                 04650002
038600     MOVE PC-SUKRP033        TO DP132O-PROGRAM-NAME.              04660002
038700     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             04670002
038800*                                                                 04680002
038900     MOVE +0                 TO PV-PAGE-COUNT.                    04690002
039000*                                                                 04700002
039100*                                                                 04820002
039200******************************************************************04850002
039300**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  04860002
039400**  PAGES (AS NEEDED).                                            04870002
039500******************************************************************04880002
039600 1500-PAGE-BREAK.                                                 04881004
039700     ADD +1                  TO PV-PAGE-COUNT.                    04890002
039800     MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER.               04900002
039900*                                                                 04910002
040000     WRITE REPORT-RECORD                                          04920004
040100       FROM DP132O-STANDRD-HEADER-132-COLS                        04930002
040200         AFTER ADVANCING PAGE.                                    04940002
040300*                                                                 04950002
040400     WRITE REPORT-RECORD                                          04990004
040500       FROM HEADING-LINE-1                                        05000002
040600         AFTER ADVANCING 2 LINES.                                 05010002
040700*                                                                 05020002
040800     WRITE REPORT-RECORD                                          05030004
040900       FROM HEADING-LINE-2                                        05040002
041000         AFTER ADVANCING 1 LINE.                                  05050002
041100*                                                                 05060002
041200     WRITE REPORT-RECORD                                          05070004
041300       FROM HEADING-LINE-3                                        05080002
041400         AFTER ADVANCING 2 LINES.                                 05090002
041500*                                                                 05100002
041600     WRITE REPORT-RECORD                                          05110004
041700       FROM HEADING-LINE-4                                        05120002
041800         AFTER ADVANCING 2 LINE.                                  05130004
041900*                                                                 05140002
042000     WRITE REPORT-RECORD                                          05150004
042100       FROM HEADING-LINE-5                                        05160002
042200         AFTER ADVANCING 1 LINE.                                  05170002
042300*                                                                 05180002
042400     WRITE REPORT-RECORD                                          05190008
042500       FROM HEADING-LINE-6                                        05200008
042600         AFTER ADVANCING 1 LINE.                                  05210008
042700*                                                                 05220008
042800     MOVE +10                TO PV-LINE-COUNT.                    05230013
042900*                                                                 05240002
043000******************************************************************05260002
043100**  READ INPUT-FILE, WHEN DC CHANGES, TO A PAGE BREAK             05270040
043200******************************************************************05310002
043300 2000-PROCESS-INPUT.                                              05311004
043400     IF SU023-OPER-UNT-ID NOT = PV-OPER-UNT-ID                    05330004
043500         MOVE SU023-OPER-UNT-ID TO PV-OPER-UNT-ID                 05370004
043600                                   DK-OPER-UNT-ID                 05371017
043700                                   HL4-OPER-UNT                   05371117
043800         PERFORM 2150-SELECT-STORE-NAME                           05372051
043900         MOVE SU023-TRIP-HOURS     TO HL4-TRIP-HOURS              05373120
044000         PERFORM 1500-PAGE-BREAK                                  05374016
044100         PERFORM 2175-SELECT-STORE-DATES                          05374140
044200         PERFORM 2100-PRINT-DETAIL-LINE                           05375030
044300     ELSE                                                         05380016
044400         IF SU023-STR-NBR NOT = PV-STR-NBR                        05380140
044500             PERFORM 2175-SELECT-STORE-DATES                      05380340
044600             PERFORM 2100-PRINT-DETAIL-LINE                       05380440
044700         ELSE                                                     05380540
044800             PERFORM 2100-PRINT-DETAIL-LINE                       05380640
044900         END-IF                                                   05381040
045000     END-IF.                                                      05382040
045100*                                                                 05390002
045200     PERFORM 3000-READ-EXTRACT-FILE.                              05880002
045300*                                                                 05890002
045400 2100-PRINT-DETAIL-LINE.                                          06001004
045500*                                                                 06010002
045600     MOVE PV-OPER-UNT-ID   TO DK-OPER-UNT-ID.                     06020004
045700*    DISPLAY '** DB2-STORE-KEY = ' DK-OPER-UNT-ID.                06030002
045800*                                                                 06060002
045900     MOVE SU023-STR-NBR            TO DL1-STR-NBR.                06070004
046000     MOVE SU023-CITY               TO DL1-CITY.                   06080004
046100     MOVE SU023-STATE              TO DL1-STATE.                  06090004
046200     MOVE SU023-SCAC               TO DL1-SCAC.                   06100004
046300     MOVE SU023-TRLR-ID            TO DL1-TRLR-ID.                06110004
046400     MOVE SU023-TRLR-SRL-NBR       TO DL1-TRLR-SRL-NBR.           06120004
046500     MOVE SU023-OTBND-STAT-TMST    TO PV-DATE-TIME.               06130007
046600     MOVE PV-DATE-TIME-CCYY        TO PV-DISPLAY-CCYY.            06140007
046700     MOVE PV-DATE-TIME-MM          TO PV-DISPLAY-MM.              06140107
046800     MOVE PV-DATE-TIME-DD          TO PV-DISPLAY-DD.              06140207
046900     MOVE PV-DATE-TIME-HH          TO PV-DISPLAY-HH.              06140307
047000     MOVE PV-DATE-TIME-MN          TO PV-DISPLAY-MN.              06140407
047100     MOVE PV-DISPLAY-DATE          TO DL1-DATE.                   06140507
047200     MOVE PV-DISPLAY-TIME          TO DL1-TIME.                   06140607
047300     MOVE SU023-TRIP-ID            TO DL1-TRIP-ID.                06141004
047400                                                                  06150004
047500*                                                                 06160002
047600     ADD +1 TO PV-LINE-COUNT.                                     06170002
047700     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         06180002
047800         PERFORM 1500-PAGE-BREAK                                  06190002
047900     END-IF.                                                      06200002
048000*                                                                 06210002
048100     WRITE REPORT-RECORD                                          06220004
048200       FROM DETAIL-LINE1                                          06230002
048300         AFTER ADVANCING 1 LINE.                                  06240002
048400*                                                                 06260002
048500 2150-SELECT-STORE-NAME.                                          06311051
048600*                                                                 06330002
048700                                                                  06330451
048800     INITIALIZE XL071-COMMAREA-REC.                               06330551
048900     MOVE DK-OPER-UNT-ID        TO XL071-LOCATION-NUMBER          06330651
049000                                                                  06330751
049100     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         06330851
049200                                                                  06330951
049300     EVALUATE TRUE                                                06331051
049400     WHEN XL071-NO-ERRORS                                         06331151
049500         MOVE XL071-LOC-NM          TO HL4-OPER-NAME              06331251
049600     WHEN XL071-LOC-NOT-FOUND                                     06331351
049700     WHEN XL071-DC-ASGMT-NOT-FND                                  06331451
049800         MOVE 'UNKNOWN'             TO HL4-OPER-NAME              06331551
049900     WHEN XL071-BAD-DB2-RETURN                                    06331651
050000         DISPLAY '2150-SELECT-STORE-NAME'                         06331751
050100         DISPLAY 'CALL LOCATION MOD '                             06331851
050200         DISPLAY 'XLT00010'                                       06331951
050300         MOVE XL071-SQLCA             TO SQLCA                    06332051
050400         PERFORM Z999-SQL-ERROR                                   06470040
050500     END-EVALUATE.                                                06332251
050600/                                                                 06490002
050700******************************************************************06500040
050800**  NEED TO CHECK TO SEE IF THE STORE IS NOT YET OPENED BUT IS    06510040
050900**  OPEN TO RECEIVE MERCHANDISE.                                  06520040
051000******************************************************************06530040
051100 2175-SELECT-STORE-DATES.                                         06540040
051200                                                                  06330451
051300                                                                          
051400     INITIALIZE XL071-COMMAREA-REC.                               06330551
051500     MOVE SU023-STR-NBR         TO PV-STR-NBR                             
051600                                   XL071-LOCATION-NUMBER          06330651
051700                                                                  06330751
051800     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         06330851
051900                                                                          
052000     EVALUATE TRUE                                                06331051
052100     WHEN XL071-NO-ERRORS                                         06331151
052200         IF PV-COMPARE-DATE < XL071-OPN-DTE                       06770042
052300             MOVE 'Y' TO DL1-NEW-STR-SW                           06793040
052400         ELSE                                                     06793142
052500             MOVE SPACE TO DL1-NEW-STR-SW                         06795042
052600         END-IF                                                   06795242
052700     WHEN XL071-LOC-NOT-FOUND                                     06331351
052800     WHEN XL071-DC-ASGMT-NOT-FND                                  06331451
052900         MOVE SPACE                 TO DL1-NEW-STR-SW             06799040
053000     WHEN XL071-BAD-DB2-RETURN                                    06331651
053100         DISPLAY '2175-SELECT-STORE-DATES'                        06331751
053200         DISPLAY 'CALL LOCATION MOD '                             06331851
053300         DISPLAY 'XLT00010'                                       06331951
053400         MOVE XL071-SQLCA             TO SQLCA                    06332051
053500         PERFORM Z999-SQL-ERROR                                   06470040
053600     END-EVALUATE.                                                06332251
053700/                                                                 06490002
053800******************************************************************06820002
053900*  READ A RECORD FROM THE TRAILER SUSPENSE UNLOAD FILE.          *06830004
054000******************************************************************06840002
054100 3000-READ-EXTRACT-FILE.                                          06841004
054200     READ INPUT-FILE                                              06860004
054300       INTO SU023-EXTRACT-RECORD                                  06870004
054400         AT END                                                   06880002
054500           SET PS-END-OF-INPUT TO TRUE.                           06890002
054600*                                                                 06900002
054700******************************************************************06930002
054800*     SQL WARNING OR ERROR PROCESSING                            *06940002
054900******************************************************************06950002
055000 Z999-SQL-ERROR.                                                  06951004
055100     MOVE SQLCODE    TO SQLCODE2.                                 06970002
055200     MOVE SQLERRD(3) TO SQLERRD3.                                 06980002
055300     DISPLAY '** ABEND **       ** = SQLERROR'.                   06990002
055400     DISPLAY '** PROGRAM        ** = SUKRP033'.                   07000002
055500     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  07010002
055600     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  07020002
055700     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   07030002
055800     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  07040002
055900*                                                                 07050002
056000******************************************************************07060002
056100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    07070002
056200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         07080002
056300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     07090002
056400* FORMAT.                                                         07100002
056500******************************************************************07110002
056600     COPY DPPD004.                                                07120002
056700*                                                                 07130002
056800     MOVE +4003 TO  ABEND-CODE.                                   07140002
056900     CALL 'ILBOABN0' USING ABEND-CODE.                            07150002
057000******************************************************************07180002
