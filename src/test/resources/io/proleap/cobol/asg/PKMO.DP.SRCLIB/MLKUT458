       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    MLKUT458                                                  
       AUTHOR.        LEE YANG.                                                 
       INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
       DATE-WRITTEN.  08-15-2008.                                               
       DATE-COMPILED.                                                           
      ******************************************************************        
      * MLKUT458 - PRODUCE AUDIT SPREADSHEET FOR BRAND VENDOR          *        
      ******************************************************************        
      *                                                                *        
      *  THIS PROGRAM WILL TAKE UP TO 4 INPUT AND PRODUCE UP TO 4      *        
      *  OUTPUT FILE IN A COMMA-DELIMITED FORMAT.                      *        
      *                                                                *        
      *  THERE IS AN OPTIONAL CONTROL INPUT THAT COULD CONTAIN         *        
      *  DESCRIPTION OR VERBIAGE THAT WILL BE PUT IN THE OUTPUT        *        
      *                                                                *        
      ******************** HISTORY OF CHANGES **************************        
      * CHG ID/                                                        *        
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                    *        
      * -------  ----------  ----------------------------------------  *        
RONNA *          08/15/1012  RECOMPILE TO PULL IN MODIFIED PEWS049     *        
      ******************************************************************        
205464*CHG0205464  08/16/2018  RECOMPILE TO PULL IN MODIFIED PEWS049   *        
      ******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.        IBM-3090.                                        
       OBJECT-COMPUTER.        IBM-3090.                                        
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT OPTIONAL CNTL-INPUT-FILE                                      
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT PURCH-FILE                                                    
               ASSIGN TO INP02.                                                 
                                                                                
           SELECT SALES-FILE                                                    
               ASSIGN TO INP03.                                                 
                                                                                
           SELECT PRICE-CHANGES-FILE                                            
               ASSIGN TO INP04.                                                 
                                                                                
           SELECT ADJUSTMENT-FILE                                               
               ASSIGN TO INP05.                                                 
                                                                                
           SELECT PURCH-OUTPUT-FILE                                             
               ASSIGN TO OUT01.                                                 
                                                                                
           SELECT SALES-OUTPUT-FILE                                             
               ASSIGN TO OUT02.                                                 
                                                                                
           SELECT PRICE-CHANGES-OUTPUT-FILE                                     
               ASSIGN TO OUT03.                                                 
                                                                                
           SELECT ADJUSTMENT-OUTPUT-FILE                                        
               ASSIGN TO OUT04.                                                 
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
                                                                                
       FD  CNTL-INPUT-FILE                                                      
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  CNTL-INPUT-RECORD               PIC X(80).                           
                                                                                
       FD  PURCH-FILE                                                           
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  PURCH-RECORD                    PIC X(200).                          
                                                                                
       FD  SALES-FILE                                                           
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  SALES-RECORD                    PIC X(080).                          
                                                                                
       FD  PRICE-CHANGES-FILE                                                   
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  PRICE-CHANGES-RECORD            PIC X(200).                          
                                                                                
       FD  ADJUSTMENT-FILE                                                      
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  ADJUSTMENT-RECORD               PIC X(090).                          
                                                                                
       FD  PURCH-OUTPUT-FILE                                                    
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  PURCH-OUTPUT-RECORD             PIC X(235).                          
                                                                                
       FD  SALES-OUTPUT-FILE                                                    
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  SALES-OUTPUT-RECORD             PIC X(185).                          
                                                                                
       FD  PRICE-CHANGES-OUTPUT-FILE                                            
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  PRICE-CHANGES-OUTPUT-RECORD     PIC X(225).                          
                                                                                
       FD  ADJUSTMENT-OUTPUT-FILE                                               
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  ADJUSTMENT-OUTPUT-RECORD        PIC X(165).                          
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** PERM CONSTANTS           ***'.                                  
                                                                                
      *01  PE049-GP-STATUS-CDE.                                                 
      *01  PE049-PENDING-STATUS-CDES.                                           
      *01  PE049-IN-PROCESS-STATUS-CDES.                                        
      *01  PE049-STORE-IP-STATUS-CDES.                                          
      *01  PE049-COMPLETED-STATUS-CDES.                                         
      *01  PE049-HISTORY-STATUS-CDES.                                           
      *01  PE049-IN-STORE-STATUS-CDES.                                          
      *01  PE049-INSTR-DOC-TYP-CDES.                                            
      *01  PE049-TYP-CDES.                                                      
      *01  PE049-RSN-CDES.                                                      
      *01  PE049-RSN-XCDES.                                                     
      *01  PE049-TKT-TYP-CDES.                                                  
      *01  PE049-STORE-GROUP-CODES.                                             
      *01  PE049-ALL-STRG-INDS.                                                 
      *01  PE049-LOCATION-TYPE-CODES.                                           
      *01  PE049-UPD-INDS.                                                      
      *01  PE049-GMM-APPRVL-INDS.                                               
      *01  PE049-APPRVL-SUB-INDS.                                               
      *01  PE049-PRC-INDS.                                                      
      *01  PE049-ZERO-OUT-EXCLUSION-INDS.                                       
      *01  PE049-PRT-RNBR-SKU-IND.                                              
      *01  PE049-DEFAULT-DATE                                                   
      *01  PE049-DEFAULT-TIME                                                   
      *01  PE049-DEFAULT-TIMESTAMP                                              
      *01  PE049-TIMESTAMP-INACTIVE-TIME.                                       
      *01  PE049-TIMESTAMP-ACTIVE-TIME.                                         
      *01  PE049-PRT-AREA.                                                      
      *01  PE049-MAX-LINES-PER-DOCUMENT                                         
      *01  PE049-DOC-SEQ-CUTOVER-DATE                                           
      *01  PE049-XMIT-SEQ-NUMBERS.                                              
      *01  PE049-SUMMARY-COUNT                                                  
      *01  PE049-SYSTEM-CONSTANT                                                
      *01  PE049-LONG-MKDN-MKUP-DESC.                                           
      *01  PE049-SHORT-MKDN-MKUP-DESC.                                          
      *01  PE049-MRKDWN-MRKUP-BATCH-NBR                                         
      *01  PE049-INSTR-MKDN-MKUP-BTCH-NBR                                       
      *01  PE049-TICKET-COLORS.                                                 
      *01  PE049-LONG-RSN-DESC.                                                 
      *01  PE049-CLR-TO-ACTV-EXPL-TXT                                           
      *01  PE049-INSTR-SHORT-RSN-DESC.                                          
      *01  PE049-INSTR-DOC-RSN-DESC.                                            
      *01  PE049-STATUS-DESC.                                                   
      *01  PE049-WORKING-TYPE-CDE                                               
      *01  PE049-WORKING-TKT-TYP-CDE                                            
      *01  PE049-WORKING-RSN-CDE                                                
      *01  PE049-WORKING-RSN-XCDES                                              
      *01  PE049-WORKING-XMIT-SEQ                                               
      *01  PE049-WORKING-INSTR-RSN-CDE                                          
      *01  PE049-WORKING-GMM-APPRVL                                             
      *01  PE049-WORKING-APPRVL-SUB                                             
      *01  PE049-WORKING-STATUS-CODE                                            
      *01  PE049-WORKING-STR-STATUS-CODE                                        
      *01  PE049-WORKING-INSTR-STATUS-CDE                                       
      *01  PE049-WORKING-GMA-TYPE                                               
      *01  PE049-WORKING-ZERO-OUT-EXC-IND                                       
      *01  PE049-WORKING-STR-GP-CDE                                             
      *01  PE049-WORKING-EDIT-STR-GRP-CDE                                       
      *01  PE049-PERM-FUNCTION-NAME                                             
      *01  PE049-CNCL-FUNCTION                                                  
      *01  PE049-CNCL-FUNCTION-IP                                               
      *01  PE049-PERM-RELEASE-AVAIL.                                            
      *01  PE049-ZERO-OUT-RSN-CODE                                              
      *01  PE049-RF-ZERO-OUT-RSN-CODE                                           
      *01  PE049-CUST-RTN-RSN-CODE                                              
      *01  PE049-RTN-TO-VNDR-RSN-CODE                                           
      *01  PE049-INV-MISSD-RSN-CODE                                             
      *01  PE049-LOSS-PREV-RSN-CODE                                             
      *01  PE049-INSTR-RSN-TABLE.                                               
      *01  PE049-INSTR-RSN-VALUE-TABLE.                                         
      *01  PE049-MESSAGES.                                                      
      *01  PE049-MKDN-RPT-RSN-TABLE.                                            
      *01  PE049-MKDN-RPT-RSN-VALUE-TABLE.                                      
           COPY PEWS049.                                                        
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** PURCH ADJUSTMENT DATA    ***'.                                  
                                                                                
      *01  ML030-PURCH-RECORD.                                                  
           COPY MLRD030.                                                        
                                                                                
       01  RP-PURCH-HEADER.                                                     
           05  FILLER                      PIC X(01)       VALUE SPACE.         
           05  FILLER                      PIC X(04)       VALUE 'DEPT'.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(09)       VALUE                
               'ENT-ID'.                                                        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(30)       VALUE                
               'VENDOR NAME'.                                                   
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(09)       VALUE                
               'LBL-SEQ'.                                                       
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(20)       VALUE                
               'BRAND NAME'.                                                    
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(09)       VALUE                
               'DKEY   '.                                                       
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(08)       VALUE 'SKU'.         
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(06)       VALUE                
               'DUMMY?'.                                                        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(15)       VALUE                
               'MARKER/COMMENT'.                                                
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(10)       VALUE                
               'CHNG? B/E'.                                                     
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(10)       VALUE                
               'FSCL DATE'.                                                     
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(03)       VALUE                
               'SYS'.                                                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(38)       VALUE                
               'TRN CDE - DESCRIPTION'.                                         
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(07)       VALUE                
               'DR/CR  '.                                                       
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(12)       VALUE                
               'PURCH GR CST'.                                                  
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(12)       VALUE                
               'PURCH NT CST'.                                                  
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(12)       VALUE                
               'PURCH RETAIL'.                                                  
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(03)       VALUE SPACES.        
                                                                                
       01  RP-PURCH-REPORT.                                                     
           05  FILLER                      PIC X(01)       VALUE SPACE.         
           05  RP-PURCH-DEPT-NBR           PIC X(04)       VALUE SPACES.        
           05  RP-PURCH-DEPT-NBR-9 REDEFINES RP-PURCH-DEPT-NBR                  
                                           PIC 9(04).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-ENT-ID             PIC X(09)       VALUE SPACES.        
           05  RP-PURCH-ENT-ID-9 REDEFINES RP-PURCH-ENT-ID                      
                                           PIC 9(09).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-VENDOR-NAME        PIC X(30)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-LBL-SEQ-NBR        PIC X(09)       VALUE SPACES.        
           05  RP-PURCH-LBL-SEQ-NBR-9 REDEFINES RP-PURCH-LBL-SEQ-NBR            
                                           PIC 9(09).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-BRAND-NAME         PIC X(20)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-ML-LWST-ID         PIC X(09)       VALUE SPACES.        
           05  RP-PURCH-ML-LWST-ID-9 REDEFINES RP-PURCH-ML-LWST-ID              
                                           PIC 9(09).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-SKU                PIC X(08)       VALUE SPACES.        
           05  RP-PURCH-SKU-9 REDEFINES RP-PURCH-SKU                            
                                           PIC 9(08).                           
           05  FILLER         REDEFINES RP-PURCH-SKU.                           
               10  FILLER                  PIC X(05).                           
               10  FILLER                  PIC X(03).                           
                   88  RP-PURCH-DUMMY-SKU                  VALUES ARE           
                       '000' '999'.                                             
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-DUMMY-SKU-IND      PIC X(06)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-MARKER             PIC X(15)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-CHANGED-CODE       PIC X(10)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-FSCL-DTE           PIC X(10)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-SYST-ORIG          PIC X(03)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-AP-TRANS-CDE       PIC X(02)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE '-'.           
           05  RP-PURCH-AP-TRANS-CDE-DESC  PIC X(35)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(05)       VALUE SPACES.        
           05  RP-PURCH-DR-CR-CDE          PIC X(02)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-EXTD-GRO-COST      PIC -ZZZZZZZ9.99                     
                                                           VALUE ZEROES.        
           05  FILLER REDEFINES RP-PURCH-EXTD-GRO-COST.                         
               10  RP-PURCH-EXTD-GRO-COST-PCK                                   
                                           PIC S9(13)V99                        
                               COMP-3.                                          
               10  FILLER                  PIC X(04).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-EXTD-NET-COST      PIC -ZZZZZZZ9.99                     
                                                           VALUE ZEROES.        
           05  FILLER REDEFINES RP-PURCH-EXTD-NET-COST.                         
               10  RP-PURCH-EXTD-NET-COST-PCK                                   
                                           PIC S9(13)V99                        
                               COMP-3.                                          
               10  FILLER                  PIC X(04).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PURCH-EXTD-RTL-AMT       PIC -ZZZZZZZ9.99                     
                                                           VALUE ZEROES.        
           05  FILLER REDEFINES RP-PURCH-EXTD-RTL-AMT.                          
               10  RP-PURCH-EXTD-RTL-PCK                                        
                                           PIC S9(13)V99                        
                               COMP-3.                                          
               10  FILLER                  PIC X(04).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(03)       VALUE SPACES.        
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** SALES DATA               ***'.                                  
                                                                                
      *01  ML022-SALE-RECORD.                                                   
           COPY MLRD022.                                                        
                                                                                
       01  RP-SALES-HEADER.                                                     
           05  FILLER                      PIC X(01)       VALUE SPACE.         
           05  FILLER                      PIC X(04)       VALUE 'DEPT'.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(09)       VALUE                
               'ENT-ID'.                                                        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(30)       VALUE                
               'VENDOR NAME'.                                                   
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(09)       VALUE                
               'LBL-SEQ'.                                                       
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(20)       VALUE                
               'BRAND NAME'.                                                    
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(09)       VALUE                
               'DKEY   '.                                                       
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(08)       VALUE 'SKU'.         
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(06)       VALUE                
               'DUMMY?'.                                                        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(15)       VALUE                
               'MARKER/COMMENT'.                                                
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(10)       VALUE                
               'CHNG? B/E'.                                                     
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(10)       VALUE                
               'FSCL DATE'.                                                     
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(03)       VALUE                
               'SYS'.                                                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(17)       VALUE                
               'SLS TYPE - DESC'.                                               
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(12)       VALUE                
               'SALES RETAIL'.                                                  
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(08)       VALUE SPACES.        
                                                                                
       01  RP-SALES-REPORT.                                                     
           05  FILLER                      PIC X(01)       VALUE SPACE.         
           05  RP-SALE-DEPT-NBR            PIC X(04)       VALUE SPACES.        
           05  RP-SALE-DEPT-NBR-9 REDEFINES RP-SALE-DEPT-NBR                    
                                           PIC 9(04).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-SALE-ENT-ID              PIC X(09)       VALUE SPACES.        
           05  RP-SALE-ENT-ID-9 REDEFINES RP-SALE-ENT-ID                        
                                           PIC 9(09).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-SALE-VENDOR-NAME         PIC X(30)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-SALE-LBL-SEQ-NBR         PIC X(09)       VALUE SPACES.        
           05  RP-SALE-LBL-SEQ-NBR-9 REDEFINES RP-SALE-LBL-SEQ-NBR              
                                           PIC 9(09).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-SALE-BRAND-NAME          PIC X(20)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-SALE-ML-LWST-ID          PIC X(09)       VALUE SPACES.        
           05  RP-SALE-ML-LWST-ID-9 REDEFINES RP-SALE-ML-LWST-ID                
                                           PIC 9(09).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-SALE-SKU                 PIC X(08)       VALUE SPACES.        
           05  RP-SALE-SKU-9 REDEFINES RP-SALE-SKU                              
                                           PIC 9(08).                           
           05  FILLER         REDEFINES RP-SALE-SKU.                            
               10  FILLER                  PIC X(05).                           
               10  FILLER                  PIC X(03).                           
                   88  RP-SALE-DUMMY-SKU                   VALUES ARE           
                       '000' '999'.                                             
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-SALE-DUMMY-SKU-IND       PIC X(06)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-SALE-MARKER              PIC X(15)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-SALE-CHANGED-CODE        PIC X(10)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-SALE-FSCL-DTE            PIC X(10)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-SALE-SYST-ORIG           PIC X(03)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-SALE-TYPE-2              PIC X(01)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE '-'.           
           05  RP-SALE-TYPE-2-DESC         PIC X(15)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-SALE-EXTD-RTL-AMT        PIC -ZZZZZZZ9.99                     
                                                           VALUE ZEROES.        
           05  FILLER REDEFINES RP-SALE-EXTD-RTL-AMT.                           
               10  RP-SALE-EXTD-RTL-PCK    PIC S9(13)V99                        
                               COMP-3.                                          
               10  FILLER                  PIC X(04).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(08)       VALUE SPACES.        
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** PRICE CHANGES DATA       ***'.                                  
                                                                                
      *01  ML029-PC-RECORD.                                                     
           COPY MLRD029.                                                        
                                                                                
       01  RP-PRICE-CHANGES-HEADER.                                             
           05  FILLER                      PIC X(01)       VALUE SPACE.         
           05  FILLER                      PIC X(04)       VALUE 'DEPT'.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(09)       VALUE                
               'ENT-ID'.                                                        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(30)       VALUE                
               'VENDOR NAME'.                                                   
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(09)       VALUE                
               'LBL-SEQ'.                                                       
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(20)       VALUE                
               'BRAND NAME'.                                                    
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(09)       VALUE                
               'DKEY   '.                                                       
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(08)       VALUE 'SKU'.         
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(06)       VALUE                
               'DUMMY?'.                                                        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(15)       VALUE                
               'MARKER/COMMENT'.                                                
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(10)       VALUE                
               'CHNG? B/E'.                                                     
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(10)       VALUE                
               'FSCL DATE'.                                                     
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(03)       VALUE                
               'SYS'.                                                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(18)       VALUE                
               'TRAN CODE - DESC  '.                                            
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(26)       VALUE                
               'RSN CODE - DESC   '.                                            
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(17)       VALUE                
               'CATEGORY - DESC  '.                                             
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(14)       VALUE                
               'EXTENDED RTL'.                                                  
           05  FILLER                      PIC X(01)       VALUE ','.           
                                                                                
       01  RP-PRICE-CHANGES-REPORT.                                             
           05  FILLER                      PIC X(01)       VALUE SPACE.         
           05  RP-PC-DEPT-NBR              PIC X(04)       VALUE SPACES.        
           05  RP-PC-DEPT-NBR-9 REDEFINES RP-PC-DEPT-NBR                        
                                           PIC 9(04).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-ENT-ID                PIC X(09)       VALUE SPACES.        
           05  RP-PC-ENT-ID-9 REDEFINES RP-PC-ENT-ID                            
                                           PIC 9(09).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-VENDOR-NAME           PIC X(30)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-LBL-SEQ-NBR           PIC X(09)       VALUE SPACES.        
           05  RP-PC-LBL-SEQ-NBR-9 REDEFINES RP-PC-LBL-SEQ-NBR                  
                                           PIC 9(09).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-BRAND-NAME            PIC X(20)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-ML-LWST-ID            PIC X(09)       VALUE SPACES.        
           05  RP-PC-ML-LWST-ID-9 REDEFINES RP-PC-ML-LWST-ID                    
                                           PIC 9(09).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-SKU                   PIC X(08)       VALUE SPACES.        
           05  RP-PC-SKU-9 REDEFINES RP-PC-SKU                                  
                                           PIC 9(08).                           
           05  FILLER         REDEFINES RP-PC-SKU.                              
               10  FILLER                  PIC X(05).                           
               10  FILLER                  PIC X(03).                           
                   88  RP-PC-DUMMY-SKU                     VALUES ARE           
                       '000' '999'.                                             
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-DUMMY-SKU-IND         PIC X(06)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-MARKER                PIC X(15)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-CHANGED-CODE          PIC X(10)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-FSCL-DTE              PIC X(10)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-SYST-ORIG             PIC X(03)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-TRANS-CDE             PIC X(02)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE '-'.           
           05  RP-PC-TRANS-CDE-DESC        PIC X(15)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-MKDN-MKUP-RSN-CDE     PIC X(03)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE '-'.           
           05  RP-PC-MKDN-MKUP-RSN-CDE-DES PIC X(22)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-CATEGORY              PIC X(01)       VALUE SPACE.         
           05  FILLER                      PIC X(01)       VALUE '-'.           
           05  RP-PC-CATEGORY-DESC         PIC X(15)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-PC-EXTD-RTL-AMT          PIC -ZZZZZZZZZ9.99                   
                                                           VALUE ZEROES.        
           05  FILLER REDEFINES RP-PC-EXTD-RTL-AMT.                             
               10  RP-PC-EXTD-RTL-PCK      PIC S9(13)V99                        
                               COMP-3.                                          
               10  FILLER                  PIC X(06).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** ADJUSTMENTS DATA         ***'.                                  
                                                                                
      *01  ML024-ADJ-RECORD.                                                    
           COPY MLRD024.                                                        
                                                                                
       01  RP-ADJUSTMENT-HEADER.                                                
           05  FILLER                      PIC X(01)       VALUE SPACE.         
           05  FILLER                      PIC X(04)       VALUE 'DEPT'.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(09)       VALUE                
               'ENT-ID'.                                                        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(30)       VALUE                
               'VENDOR NAME'.                                                   
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(09)       VALUE                
               'LBL-SEQ'.                                                       
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(20)       VALUE                
               'BRAND NAME'.                                                    
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(09)       VALUE                
               'DKEY   '.                                                       
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(08)       VALUE 'SKU'.         
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(06)       VALUE                
               'DUMMY?'.                                                        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(15)       VALUE                
               'MARKER/COMMENT'.                                                
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(10)       VALUE                
               'CHNG? B/E'.                                                     
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(10)       VALUE                
               'FSCL DATE'.                                                     
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(03)       VALUE                
               'SYS'.                                                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(16)       VALUE                
               'EXTENDED RETAIL '.                                              
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(02)       VALUE SPACES.        
                                                                                
       01  RP-ADJUSTMENT-REPORT.                                                
           05  FILLER                      PIC X(01)       VALUE SPACE.         
           05  RP-ADJ-DEPT-NBR             PIC X(04)       VALUE SPACES.        
           05  RP-ADJ-DEPT-NBR-9 REDEFINES RP-ADJ-DEPT-NBR                      
                                           PIC 9(04).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-ADJ-ENT-ID               PIC X(09)       VALUE SPACES.        
           05  RP-ADJ-ENT-ID-9 REDEFINES RP-ADJ-ENT-ID                          
                                           PIC 9(09).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-ADJ-VENDOR-NAME          PIC X(30)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-ADJ-LBL-SEQ-NBR          PIC X(09)       VALUE SPACES.        
           05  RP-ADJ-LBL-SEQ-NBR-9 REDEFINES RP-ADJ-LBL-SEQ-NBR                
                                           PIC 9(09).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-ADJ-BRAND-NAME           PIC X(20)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-ADJ-ML-LWST-ID           PIC X(09)       VALUE SPACES.        
           05  RP-ADJ-ML-LWST-ID-9 REDEFINES RP-ADJ-ML-LWST-ID                  
                                           PIC 9(09).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-ADJ-SKU                  PIC X(08)       VALUE SPACES.        
           05  RP-ADJ-SKU-9 REDEFINES RP-ADJ-SKU                                
                                           PIC 9(08).                           
           05  FILLER         REDEFINES RP-ADJ-SKU.                             
               10  FILLER                  PIC X(05).                           
               10  FILLER                  PIC X(03).                           
                   88  RP-ADJ-DUMMY-SKU                    VALUES ARE           
                       '000' '999'.                                             
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-ADJ-DUMMY-SKU-IND        PIC X(06)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-ADJ-MARKER               PIC X(15)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-ADJ-CHANGED-CODE         PIC X(10)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-ADJ-FSCL-DTE             PIC X(10)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-ADJ-SYST-ORIG            PIC X(03)       VALUE SPACES.        
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  RP-ADJ-AT-RTL-AMT           PIC -ZZZZZZZZZZZ9.99                 
                                                           VALUE ZEROES.        
           05  FILLER REDEFINES RP-ADJ-AT-RTL-AMT.                              
               10  RP-ADJ-AT-RTL-PCK       PIC S9(13)V99                        
                               COMP-3.                                          
               10  FILLER                  PIC X(08).                           
           05  FILLER                      PIC X(01)       VALUE ','.           
           05  FILLER                      PIC X(04)       VALUE SPACES.        
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** PROGRAM CONSTANTS AREA   ***'.                                  
                                                                                
       01  PROGRAM-CONSTANTS.                                                   
           05 PC-3                         PIC S9(05)      VALUE +3             
                               COMP-3.                                          
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** PROGRAM VARIABLE WS AREA ***'.                                  
                                                                                
       01  PROGRAM-VARIABLES.                                                   
           05  PV-PARAGRAPH-NAME           PIC X(30)       VALUE SPACES.        
           05  PV-OPERATION-ATTEMPTED      PIC X(30)       VALUE SPACES.        
           05  PV-MARKER-COMMENT           PIC X(15)       VALUE SPACES.        
           05  PV-CHANGED-CODE             PIC X(10)       VALUE SPACES.        
           05  FILLER REDEFINES PV-CHANGED-CODE.                                
               10  PV-CHANGED-CODE-1       PIC X(04).                           
               10  PV-CHANGED-SEPARATOR    PIC X(02).                           
               10  PV-CHANGED-CODE-2       PIC X(04).                           
           05  PV-DEPT-NBR-PRC-CHK         PIC S9(4)       VALUE ZEROES         
                               COMP-3.                                          
           05  PV-ENT-ID-PRC-CHK           PIC S9(9)       VALUE ZEROES         
                               COMP.                                            
           05  PV-ENT-ID-PRC-TMP           PIC S9(9)       VALUE ZEROES         
                               COMP.                                            
           05  PV-LBL-SEQ-NBR-PRC-CHK      PIC S9(4)       VALUE ZEROES         
                               COMP.                                            
           05  PV-LBL-SEQ-NBR-PRC-TMP      PIC S9(4)       VALUE ZEROES         
                               COMP.                                            
           05  PV-ML-LWST-ID-PRC-CHK       PIC S9(9)       VALUE ZEROES         
                               COMP.                                            
           05  PV-ENT-ID-ATTR-CHK          PIC S9(9)       VALUE ZEROES         
                               COMP.                                            
           05  PV-LBL-SEQ-NBR-ATTR-CHK     PIC S9(4)       VALUE ZEROES         
                               COMP.                                            
           05  PV-NEXT-FSCL-MN-BEG-DTE     PIC X(10)       VALUE SPACES.        
           05  PV-PROC-FSCL-DTE            PIC X(10)       VALUE SPACES.        
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** ABEND CODE               ***'.                                  
                                                                                
       01  ABEND-CODE                      PIC S9(04)      VALUE ZEROES         
                               COMP SYNC.                                       
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** PROGRAM ACCUMULATORS     ***'.                                  
                                                                                
       01  PA-PROGRAM-ACCUMULATORS.                                             
           05  PA-VEND-NAME-CALL           PIC  9(09)      VALUE ZEROES.        
           05  PA-BRND-NAME-CALL           PIC  9(09)      VALUE ZEROES.        
           05  PA-ATTR-CHECK               PIC  9(09)      VALUE ZEROES.        
           05  PA-DKEY-CHECK               PIC  9(09)      VALUE ZEROES.        
           05  PA-DKEY-CHECK-FAIL          PIC  9(09)      VALUE ZEROES.        
           05  PA-CNTL-COUNT               PIC  9(09)      VALUE ZEROES.        
           05  PA-CNTL-PROCESSED           PIC  9(09)      VALUE ZEROES.        
           05  PA-PURCH-IN                 PIC  9(09)      VALUE ZEROES.        
           05  PA-PURCH-DUMMY              PIC  9(09)      VALUE ZEROES.        
           05  PA-PURCH-TRANS-CODE-CALL    PIC  9(09)      VALUE ZEROES.        
           05  PA-PURCH-VEND-NAME-CALL     PIC  9(09)      VALUE ZEROES.        
           05  PA-PURCH-BRND-NAME-CALL     PIC  9(09)      VALUE ZEROES.        
           05  PA-PURCH-SKU-ATTR           PIC  9(09)      VALUE ZEROES.        
           05  PA-PURCH-DKEY-CHECK         PIC  9(09)      VALUE ZEROES.        
           05  PA-PURCH-DKEY-CHECK-FAIL    PIC  9(09)      VALUE ZEROES.        
           05  PA-PURCH-OUT                PIC  9(09)      VALUE ZEROES.        
           05  PA-SALES-IN                 PIC  9(09)      VALUE ZEROES.        
           05  PA-SALES-DUMMY              PIC  9(09)      VALUE ZEROES.        
           05  PA-SALES-VEND-NAME-CALL     PIC  9(09)      VALUE ZEROES.        
           05  PA-SALES-BRND-NAME-CALL     PIC  9(09)      VALUE ZEROES.        
           05  PA-SALES-SKU-ATTR           PIC  9(09)      VALUE ZEROES.        
           05  PA-SALES-DKEY-CHECK         PIC  9(09)      VALUE ZEROES.        
           05  PA-SALES-DKEY-CHECK-FAIL    PIC  9(09)      VALUE ZEROES.        
           05  PA-SALES-OUT                PIC  9(09)      VALUE ZEROES.        
           05  PA-PC-IN                    PIC  9(09)      VALUE ZEROES.        
           05  PA-PC-DUMMY                 PIC  9(09)      VALUE ZEROES.        
           05  PA-PC-VEND-NAME-CALL        PIC  9(09)      VALUE ZEROES.        
           05  PA-PC-BRND-NAME-CALL        PIC  9(09)      VALUE ZEROES.        
           05  PA-PC-SKU-ATTR              PIC  9(09)      VALUE ZEROES.        
           05  PA-PC-DKEY-CHECK            PIC  9(09)      VALUE ZEROES.        
           05  PA-PC-DKEY-CHECK-FAIL       PIC  9(09)      VALUE ZEROES.        
           05  PA-PC-OUT                   PIC  9(09)      VALUE ZEROES.        
           05  PA-INV-ADJ-IN               PIC  9(09)      VALUE ZEROES.        
           05  PA-INV-ADJ-DUMMY            PIC  9(09)      VALUE ZEROES.        
           05  PA-INV-ADJ-VEND-NAME-CALL   PIC  9(09)      VALUE ZEROES.        
           05  PA-INV-ADJ-BRND-NAME-CALL   PIC  9(09)      VALUE ZEROES.        
           05  PA-INV-ADJ-SKU-ATTR         PIC  9(09)      VALUE ZEROES.        
           05  PA-INV-ADJ-DKEY-CHECK       PIC  9(09)      VALUE ZEROES.        
           05  PA-INV-ADJ-DKEY-CHECK-FAIL  PIC  9(09)      VALUE ZEROES.        
           05  PA-INV-ADJ-OUT              PIC  9(09)      VALUE ZEROES.        
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** PROGRAM SWITCH AREA      ***'.                                  
                                                                                
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-EOF-CNTL-SW              PIC X           VALUE 'N'.           
               88  PS-EOF-CNTL                             VALUE 'Y'.           
               88  PS-NOT-EOF-CNTL                         VALUE 'N'.           
           05  PS-EOF-PURCH-SW             PIC X           VALUE 'N'.           
               88  PS-EOF-PURCH                            VALUE 'Y'.           
               88  PS-NOT-EOF-PURCH                        VALUE 'N'.           
           05  PS-EOF-SALES-SW             PIC X           VALUE 'N'.           
               88  PS-EOF-SALES                            VALUE 'Y'.           
               88  PS-NOT-EOF-SALES                        VALUE 'N'.           
           05  PS-EOF-PRICE-CHANGES-SW     PIC X           VALUE 'N'.           
               88  PS-EOF-PRICE-CHANGES                    VALUE 'Y'.           
               88  PS-NOT-EOF-PRICE-CHANGES                VALUE 'N'.           
           05  PS-EOF-ADJUSTMENT-SW        PIC X           VALUE 'N'.           
               88  PS-EOF-ADJUSTMENT                       VALUE 'Y'.           
               88  PS-NOT-EOF-ADJUSTMENT                   VALUE 'N'.           
           05  PS-BOM-SKU-ATTR-FOUND-SW    PIC X           VALUE 'N'.           
               88  PS-BOM-SKU-ATTR-FOUND                   VALUE 'Y'.           
               88  PS-BOM-SKU-ATTR-NOT-FOUND               VALUE 'N'.           
           05  PS-EOM-SKU-ATTR-FOUND-SW    PIC X           VALUE 'N'.           
               88  PS-EOM-SKU-ATTR-FOUND                   VALUE 'Y'.           
               88  PS-EOM-SKU-ATTR-NOT-FOUND               VALUE 'N'.           
           05  PS-CNTL-VALIDATION-SW       PIC X(08)       VALUE SPACE.         
               88  PS-CNTL-VALIDATION-OK                   VALUE                
                   '* OKAY *'.                                                  
               88  PS-CNTL-VALIDATION-FAIL                 VALUE                
                   '* FAIL *'.                                                  
           05  PS-CHECK-DKEY-SW            PIC X           VALUE SPACE.         
               88  PS-GET-DKEY                             VALUE 'D'.           
               88  PS-GET-VENDOR-BRAND                     VALUE 'B'.           
               88  PS-CHECK-DKEY-FAIL                      VALUE 'F'.           
           05  PS-REQ-REPORT-SW            PIC X(15)       VALUE SPACES.        
               88  PS-RPT-DUMMY-SKU-ONLY                   VALUE                
                   'DUMMY SKU ONLY'.                                            
               88  PS-RPT-ALL                              VALUES ARE           
                   SPACES 'ALL'.                                                
           05  PS-REQ-ATTR-CHECK-SW        PIC X(15)       VALUE SPACES.        
               88  PS-ATTR-CHK-BOM-ONLY                    VALUES ARE           
                   SPACES 'INP TO BOM ONLY'.                                    
               88  PS-ATTR-CHK-EOM-ONLY                    VALUE                
                   'INP TO EOM ONLY'.                                           
               88  PS-ATTR-CHK-BOM-EOM-ONLY                VALUE                
                   'BOM TO EOM ONLY'.                                           
      * 'ALL' MEANS INP-TO-BOM AND BOM-TO-EOM                                   
               88  PS-ATTR-CHK-ALL                         VALUE                
                   'ALL'.                                                       
           05  PS-REQ-AMT-TYPE-SW          PIC X(15)       VALUE SPACES.        
               88  PS-AMT-PCK-DEC                          VALUE                
                   'PACKED DECIMAL '.                                           
      * DEFAULT AMOUNT TYPE IS DISPLAY DECIMAL                                  
               88  PS-AMT-DISPLAY-DEC                      VALUES ARE           
                   'DISPLAY DECIMAL' SPACES.                                    
                                                                                
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-JOB-NAME                 PIC X(08)       VALUE SPACES.        
           05  PC-PROGRAM-NAME             PIC X(08)       VALUE                
               'MLKUT458'.                                                      
                                                                                
       01  PE-PROGRAM-ERROR-MESSAGES.                                           
           05  PE-MSG-01                   PIC X(30)       VALUE                
                'INSPECT WHERE CLAUSE VARIABLE'.                                
           05  PE-MSG-02                   PIC X(30)       VALUE                
                'DB2 SELECT ATTEMPTED         '.                                
           05  PE-MSG-03                   PIC X(30)       VALUE                
                'ATTEMPTING TO OPEN DB2 CURSOR'.                                
           05  PE-MSG-04                   PIC X(30)       VALUE                
                'ATTEMPT TO FETCH CURSOR ROW  '.                                
           05  PE-MSG-05                   PIC X(30)       VALUE                
                'ATTEMPT TO CLOSE DB2 CURSOR  '.                                
           05  PE-MSG-07                   PIC X(30)       VALUE                
                'ERROR IN SELECT - TCKRSTCNTL '.                                
           05  PE-MSG-13                   PIC X(30)       VALUE                
                'SHRINK NOT FND FOR DEPT/DATE '.                                
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** OPTIONAL CONTROL INFO    ***'.                                  
                                                                                
      *****************************************************************         
      *  INPUT DATE CONTROL LAYOUT                                    *         
      *****************************************************************         
       01  CC-CNTL-LAYOUT.                                                      
           05  CC-COMMENT-IND              PIC  X(01)      VALUE SPACE.         
               88  CC-COMMENT-RECORD                       VALUE '*'.           
           05  CC-COMMAND                  PIC  X(16)      VALUE SPACES.        
               88  CC-REPORT-CMD                           VALUE                
                   'REPORT '.                                                   
               88  CC-ATTR-CHK-CMD                         VALUES ARE           
                   'ATTR CHECK '.                                               
               88  CC-SET-MARKER-CMD                       VALUES ARE           
                   'SET MARKER '.                                               
               88  CC-PROCESS-DATE-CMD                     VALUES ARE           
                   'PROCESS DATE'.                                              
               88  CC-AMOUNT-TYPE-CMD                      VALUES ARE           
                   'AMOUNT TYPE'.                                               
           05  FILLER                      PIC  X(01)      VALUE SPACE.         
           05  CC-COMMAND-PARM             PIC  X(15)      VALUE SPACES.        
               88  CC-DUMMY-SKU-ONLY                       VALUE                
                   'DUMMY SKU ONLY'.                                            
               88  CC-ALL                                  VALUES ARE           
                   SPACES 'ALL'.                                                
               88  CC-INP-TO-BOM-ONLY                      VALUE                
                   'INP TO BOM ONLY'.                                           
               88  CC-INP-TO-EOM-ONLY                      VALUE                
                   'INP TO EOM ONLY'.                                           
               88  CC-BOM-EOM-ONLY                         VALUE                
                   'BOM TO EOM ONLY'.                                           
               88  CC-AMT-PCK-DEC                          VALUE                
                   'PACKED DECIMAL '.                                           
               88  CC-AMT-DISPLAY-DEC                      VALUES ARE           
                   'DISPLAY DECIMAL' SPACES.                                    
           05  FILLER                      PIC  X(46)      VALUE SPACES.        
                                                                                
      ****************************************************                      
      *  COMMUNICATION AREAS FOR DB2                     *                      
      ****************************************************                      
           EXEC SQL                                                             
               INCLUDE SQLCA                                                    
           END-EXEC.                                                            
                                                                                
      ****************************************************                      
      *  AP TRANCODE INFORMATION TABLE                   *                      
      ****************************************************                      
           EXEC SQL                                                             
               INCLUDE TTRNCDE                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************                      
      *  ML CONTROL TABLE                                *                      
      ****************************************************                      
           EXEC SQL                                                             
               INCLUDE TMLCNTL                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************                      
      *  ML DATE ATTRIBUTE TABLE                         *                      
      ****************************************************                      
           EXEC SQL                                                             
               INCLUDE TDTATTR                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************                      
      * XM SKU ATTRIBUTES TABLE XMT_BOM_SKU_ATTR         *                      
      ****************************************************                      
           EXEC SQL                                                             
               INCLUDE XMT00023                                                 
           END-EXEC.                                                            
                                                                                
                                                                                
      ****************************************************                      
      * XM DOMAIN VENDOR TABLE XMT_VND                   *                      
      ****************************************************                      
           EXEC SQL                                                             
               INCLUDE XMT00000                                                 
           END-EXEC.                                                            
                                                                                
                                                                                
      ****************************************************                      
      * VENDOR STYLE LABEL/BRAND INFO                    *                      
      ****************************************************                      
           EXEC SQL                                                             
               INCLUDE TVSCHVL                                                  
           END-EXEC.                                                            
                                                                                
                                                                                
      ****************************************************                      
      * ML LOW LEVEL MERCHANDISE LEVEL KEY (DKEY) VIEW   *                      
      ****************************************************                      
           EXEC SQL                                                             
               INCLUDE MLV00000                                                 
           END-EXEC.                                                            
                                                                                
                                                                                
      ****************************************************                      
      *  ERROR MESSAGE AREA FOR DB2                      *                      
      ****************************************************                      
           COPY DPWS004.                                                        
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
                                                                                
       0000-MAIN-MODULE.                                                        
                                                                                
           PERFORM 1000-INITIALIZATION.                                         
                                                                                
           PERFORM 6100-READ-PURCH.                                             
           DISPLAY ' '.                                                         
           DISPLAY ' ... PROCESSING PURCHASES ' FUNCTION CURRENT-DATE.          
           PERFORM 2100-PROCESS-PURCH                                           
                UNTIL PS-EOF-PURCH.                                             
                                                                                
           PERFORM 6200-READ-SALES.                                             
           DISPLAY ' '.                                                         
           DISPLAY ' ... PROCESSING SALES ' FUNCTION CURRENT-DATE.              
           PERFORM 2200-PROCESS-SALES                                           
                UNTIL PS-EOF-SALES.                                             
                                                                                
           PERFORM 6300-READ-PRICE-CHANGES.                                     
           DISPLAY ' '.                                                         
           DISPLAY ' ... PROCESSING PRICE CHANGES '                             
                   FUNCTION CURRENT-DATE.                                       
           PERFORM 2300-PROCESS-PRICE-CHANGES                                   
                UNTIL PS-EOF-PRICE-CHANGES.                                     
                                                                                
           PERFORM 6400-READ-ADJUSTMENT.                                        
           DISPLAY ' '.                                                         
           DISPLAY ' ... PROCESSING INVENTORY ADJUSTMENTS '                     
                   FUNCTION CURRENT-DATE.                                       
           PERFORM 2400-PROCESS-ADJUSTMENT                                      
                UNTIL PS-EOF-ADJUSTMENT.                                        
                                                                                
           PERFORM 8000-EOJ-ROUTINE.                                            
                                                                                
           STOP RUN.                                                            
                                                                                
                                                                                
      ******************************************************************        
      * LOAD TABLE WITH MONTHS TO BE RECALCULATED                               
      ******************************************************************        
       1000-INITIALIZATION.                                                     
                                                                                
           OPEN INPUT  CNTL-INPUT-FILE                                          
                       PURCH-FILE                                               
                       SALES-FILE                                               
                       PRICE-CHANGES-FILE                                       
                       ADJUSTMENT-FILE                                          
                OUTPUT PURCH-OUTPUT-FILE                                        
                       SALES-OUTPUT-FILE                                        
                       PRICE-CHANGES-OUTPUT-FILE                                
                       ADJUSTMENT-OUTPUT-FILE.                                  
                                                                                
           SET PS-NOT-EOF-CNTL              TO TRUE.                            
           SET PS-NOT-EOF-PURCH             TO TRUE.                            
           SET PS-NOT-EOF-SALES             TO TRUE.                            
           SET PS-NOT-EOF-PRICE-CHANGES     TO TRUE.                            
           SET PS-NOT-EOF-ADJUSTMENT        TO TRUE.                            
                                                                                
           DISPLAY '----+----1----+----2----+----3----+----4----+----5'.        
           PERFORM 6000-READ-CNTL-FILE.                                         
           PERFORM                                                              
               UNTIL PS-EOF-CNTL                                                
               EVALUATE TRUE                                                    
                   WHEN CC-COMMENT-RECORD                                       
                       SET PS-CNTL-VALIDATION-OK    TO TRUE                     
                   WHEN CC-REPORT-CMD                                           
                       ADD +1             TO PA-CNTL-PROCESSED                  
                       IF CC-ALL OR CC-DUMMY-SKU-ONLY                           
                           SET PS-CNTL-VALIDATION-OK    TO TRUE                 
                           MOVE CC-COMMAND-PARM  TO PS-REQ-REPORT-SW            
                       ELSE                                                     
                           SET PS-CNTL-VALIDATION-FAIL  TO TRUE                 
                           DISPLAY '  *** INVALID REPORT REQUEST ***'           
                       END-IF                                                   
                   WHEN CC-ATTR-CHK-CMD                                         
                       ADD +1             TO PA-CNTL-PROCESSED                  
                       IF CC-ALL OR CC-INP-TO-BOM-ONLY                          
                           OR CC-INP-TO-EOM-ONLY OR CC-BOM-EOM-ONLY             
                           SET PS-CNTL-VALIDATION-OK    TO TRUE                 
                           MOVE CC-COMMAND-PARM  TO PS-REQ-ATTR-CHECK-SW        
                       ELSE                                                     
                           SET PS-CNTL-VALIDATION-FAIL  TO TRUE                 
                           DISPLAY '  *** INVALID ATTR CHECK REQ ***'           
                       END-IF                                                   
                   WHEN CC-SET-MARKER-CMD                                       
                       ADD +1             TO PA-CNTL-PROCESSED                  
                       SET PS-CNTL-VALIDATION-OK    TO TRUE                     
                       MOVE CC-COMMAND-PARM  TO PV-MARKER-COMMENT               
                   WHEN CC-PROCESS-DATE-CMD                                     
                       ADD +1             TO PA-CNTL-PROCESSED                  
                       MOVE CC-COMMAND-PARM  TO DTATTR-KY-DTE                   
                       PERFORM 7600-GET-FSCL-DATES                              
                   WHEN CC-AMOUNT-TYPE-CMD                                      
                       ADD +1             TO PA-CNTL-PROCESSED                  
                       IF CC-AMT-PCK-DEC OR CC-AMT-DISPLAY-DEC                  
                           SET PS-CNTL-VALIDATION-OK    TO TRUE                 
                           MOVE CC-COMMAND-PARM  TO PS-REQ-AMT-TYPE-SW          
                       ELSE                                                     
                           SET PS-CNTL-VALIDATION-FAIL  TO TRUE                 
                           DISPLAY '  *** INVALID AMOUNT TYPE REQ ***'          
                       END-IF                                                   
                   WHEN OTHER                                                   
                       SET PS-CNTL-VALIDATION-FAIL  TO TRUE                     
                       DISPLAY '  *** INVALID COMMAND ***'                      
               END-EVALUATE                                                     
                                                                                
               DISPLAY CC-CNTL-LAYOUT ' ' PS-CNTL-VALIDATION-SW                 
                                                                                
               PERFORM 6000-READ-CNTL-FILE                                      
           END-PERFORM.                                                         
           IF PA-CNTL-PROCESSED = ZEROES                                        
               DISPLAY '*** NO REQUEST CONTROL PROCESSED'                       
           END-IF.                                                              
           IF PV-NEXT-FSCL-MN-BEG-DTE = SPACES                                  
               PERFORM 7700-GET-MLCNTL-DATE                                     
               MOVE MLCNTL-OPN-FSCL-WK-DTE   TO DTATTR-KY-DTE                   
               PERFORM 7600-GET-FSCL-DATES                                      
               IF PS-CNTL-VALIDATION-OK                                         
                   DISPLAY ' *** NO PROCESS DATE SPECIFIED, DEFAULT'            
                           ' TO ML CNTL DATE (' DTATTR-KY-DTE ')'               
               ELSE                                                             
                   DISPLAY ' *** NO PROCESS DATE SPECIFIED, CANNOT'             
                           ' VALIDATE ML CNTL DATE (' DTATTR-KY-DTE ')'         
               END-IF                                                           
           END-IF.                                                              
                                                                                
      * LOAD MKDN-MKUP REASON CODE TABLE VALUE                                  
           MOVE PE049-MKDN-RPT-RSN-VALUE-TABLE                                  
               TO PE049-MKDN-RPT-RSN-TABLE.                                     
                                                                                
      * INITIALIZE VARIABLES THAT WILL BE REFERENCED BEFORE POPULATING          
           MOVE ZEROES                  TO MLV00000-DEPT-NBR                    
                                           MLV00000-LBL-SEQ-NBR                 
                                           MLV00000-ENT-ID                      
                                           XMT00000-ENT-ID                      
                                           VSCHVL-CHARTC-SEQ-NBR.               
                                                                                
                                                                                
      ******************************************************************        
      * MAIN PROCESSING OF PURCHASE ADJUSTMENTS                                 
      ******************************************************************        
       2100-PROCESS-PURCH.                                                      
                                                                                
           MOVE ML030-PURCH-DEPT-NBR      TO RP-PURCH-DEPT-NBR-9                
                                             PV-DEPT-NBR-PRC-CHK.               
                                                                                
           MOVE ML030-PURCH-ENT-ID        TO RP-PURCH-ENT-ID-9                  
                                             PV-ENT-ID-PRC-CHK.                 
           PERFORM 3100-VENDOR-INFO.                                            
           ADD PA-VEND-NAME-CALL          TO PA-PURCH-VEND-NAME-CALL.           
           MOVE XMT00000-PRIM-VND-NM      TO RP-PURCH-VENDOR-NAME.              
                                                                                
           MOVE ML030-PURCH-LBL-SEQ-NBR   TO RP-PURCH-LBL-SEQ-NBR-9             
                                             PV-LBL-SEQ-NBR-PRC-CHK.            
           PERFORM 3200-BRAND-INFO.                                             
           ADD PA-BRND-NAME-CALL          TO PA-PURCH-BRND-NAME-CALL.           
           MOVE VSCHVL-CHARTC-VAL-DESC    TO RP-PURCH-BRAND-NAME.               
                                                                                
           MOVE ML030-PURCH-ML-LWST-ID    TO PV-ML-LWST-ID-PRC-CHK.             
           PERFORM 3300-GET-DKEY.                                               
           ADD PA-DKEY-CHECK              TO PA-PURCH-DKEY-CHECK.               
           ADD PA-DKEY-CHECK-FAIL         TO PA-PURCH-DKEY-CHECK-FAIL.          
           MOVE PV-ML-LWST-ID-PRC-CHK     TO RP-PURCH-ML-LWST-ID.               
                                                                                
           IF ML030-PURCH-TRANSFER-FRM-STORE                                    
               OR ML030-PURCH-TRANSFER-TO-STORE                                 
               MOVE ML030-PURCH-TRANS-CDE     TO RP-PURCH-SYST-ORIG             
           ELSE                                                                 
               MOVE ML030-PURCH-SYST-ORIG-CDE TO RP-PURCH-SYST-ORIG             
           END-IF.                                                              
                                                                                
           MOVE ML030-PURCH-EDIT-DTE      TO DTATTR-KY-DTE.                     
           PERFORM 3050-DATE-CHECK.                                             
           MOVE PV-PROC-FSCL-DTE          TO RP-PURCH-FSCL-DTE.                 
                                                                                
           MOVE ML030-PURCH-SKU           TO RP-PURCH-SKU.                      
           IF RP-PURCH-DUMMY-SKU                                                
               ADD +1                     TO PA-PURCH-DUMMY                     
               MOVE 'YES'                 TO RP-PURCH-DUMMY-SKU-IND             
               MOVE SPACES                TO RP-PURCH-CHANGED-CODE              
           ELSE                                                                 
               MOVE 'NO'                  TO RP-PURCH-DUMMY-SKU-IND             
               MOVE RP-PURCH-SKU-9        TO XMT00023-SKU-NBR                   
               PERFORM 3000-ATTR-CHECK                                          
               ADD PA-ATTR-CHECK          TO PA-PURCH-SKU-ATTR                  
               MOVE PV-CHANGED-CODE       TO RP-PURCH-CHANGED-CODE              
           END-IF.                                                              
                                                                                
           IF ML030-PURCH-AP-TRANS-CDE = TRNCDE-AP-TRN-CDE                      
               CONTINUE                                                         
           ELSE                                                                 
               ADD +1                     TO PA-PURCH-TRANS-CODE-CALL           
               MOVE ML030-PURCH-AP-TRANS-CDE  TO RP-PURCH-AP-TRANS-CDE          
                                                 TRNCDE-AP-TRN-CDE              
               PERFORM 7100-GET-AP-TRNCDE-DESC                                  
               MOVE TRNCDE-TRN-DESC       TO RP-PURCH-AP-TRANS-CDE-DESC         
           END-IF.                                                              
                                                                                
           MOVE ML030-PURCH-DR-CR-CDE     TO RP-PURCH-DR-CR-CDE.                
                                                                                
           IF (ML030-PURCH-DR-CR-CDE = '02' OR '08')                            
               COMPUTE ML030-PURCH-EXTD-GRO-COST-AMT                            
                       = ML030-PURCH-EXTD-GRO-COST-AMT * -1                     
               COMPUTE ML030-PURCH-EXTD-NET-COST-AMT                            
                       = ML030-PURCH-EXTD-NET-COST-AMT * -1                     
               COMPUTE ML030-PURCH-EXTD-RTL-AMT                                 
                       = ML030-PURCH-EXTD-RTL-AMT * -1                          
           END-IF.                                                              
           IF PS-AMT-PCK-DEC                                                    
               MOVE ML030-PURCH-EXTD-GRO-COST-AMT                               
                   TO RP-PURCH-EXTD-GRO-COST-PCK                                
               MOVE ML030-PURCH-EXTD-NET-COST-AMT                               
                   TO RP-PURCH-EXTD-NET-COST-PCK                                
               MOVE ML030-PURCH-EXTD-RTL-AMT  TO RP-PURCH-EXTD-RTL-PCK          
           ELSE                                                                 
               MOVE ML030-PURCH-EXTD-GRO-COST-AMT                               
                   TO RP-PURCH-EXTD-GRO-COST                                    
               MOVE ML030-PURCH-EXTD-NET-COST-AMT                               
                   TO RP-PURCH-EXTD-NET-COST                                    
               MOVE ML030-PURCH-EXTD-RTL-AMT  TO RP-PURCH-EXTD-RTL-AMT          
           END-IF.                                                              
                                                                                
           MOVE PV-MARKER-COMMENT         TO RP-PURCH-MARKER.                   
                                                                                
           IF (RP-PURCH-DUMMY-SKU AND PS-RPT-DUMMY-SKU-ONLY)                    
               OR PS-RPT-ALL                                                    
               PERFORM 5100-WRITE-PURCH-REC                                     
           END-IF.                                                              
                                                                                
           PERFORM 6100-READ-PURCH.                                             
                                                                                
                                                                                
      ******************************************************************        
      * MAIN PROCESSING OF SALES                                                
      ******************************************************************        
       2200-PROCESS-SALES.                                                      
                                                                                
           MOVE ML022-SALE-DEPT-NBR       TO RP-SALE-DEPT-NBR-9                 
                                             PV-DEPT-NBR-PRC-CHK.               
                                                                                
           MOVE ML022-SALE-ENT-ID         TO RP-SALE-ENT-ID-9                   
                                             PV-ENT-ID-PRC-CHK.                 
           PERFORM 3100-VENDOR-INFO.                                            
           ADD PA-VEND-NAME-CALL          TO PA-SALES-VEND-NAME-CALL.           
           MOVE XMT00000-PRIM-VND-NM      TO RP-SALE-VENDOR-NAME.               
                                                                                
           MOVE ML022-SALE-LBL-SEQ-NBR    TO RP-SALE-LBL-SEQ-NBR-9              
                                             PV-LBL-SEQ-NBR-PRC-CHK.            
           PERFORM 3200-BRAND-INFO.                                             
           ADD PA-BRND-NAME-CALL          TO PA-SALES-BRND-NAME-CALL.           
           MOVE VSCHVL-CHARTC-VAL-DESC    TO RP-SALE-BRAND-NAME.                
                                                                                
           MOVE ML022-SALE-ML-LWST-ID     TO PV-ML-LWST-ID-PRC-CHK.             
           PERFORM 3300-GET-DKEY.                                               
           ADD PA-DKEY-CHECK              TO PA-SALES-DKEY-CHECK.               
           ADD PA-DKEY-CHECK-FAIL         TO PA-SALES-DKEY-CHECK-FAIL.          
           MOVE PV-ML-LWST-ID-PRC-CHK     TO RP-SALE-ML-LWST-ID.                
                                                                                
           MOVE ML022-SALE-SYST-ORIG-CDE  TO RP-SALE-SYST-ORIG.                 
                                                                                
           MOVE ML022-SALE-EDIT-DTE       TO DTATTR-KY-DTE.                     
           PERFORM 3050-DATE-CHECK.                                             
           MOVE PV-PROC-FSCL-DTE          TO RP-SALE-FSCL-DTE.                  
                                                                                
           MOVE ML022-SALE-SKU            TO RP-SALE-SKU.                       
           IF RP-SALE-DUMMY-SKU                                                 
               ADD +1                     TO PA-SALES-DUMMY                     
               MOVE 'YES'                 TO RP-SALE-DUMMY-SKU-IND              
               MOVE SPACES                TO RP-SALE-CHANGED-CODE               
           ELSE                                                                 
               MOVE 'NO'                  TO RP-SALE-DUMMY-SKU-IND              
               MOVE RP-SALE-SKU-9         TO XMT00023-SKU-NBR                   
               PERFORM 3000-ATTR-CHECK                                          
               ADD PA-ATTR-CHECK          TO PA-SALES-SKU-ATTR                  
               MOVE PV-CHANGED-CODE       TO RP-SALE-CHANGED-CODE               
           END-IF.                                                              
                                                                                
           MOVE ML022-SALE-TYPE-2         TO RP-SALE-TYPE-2.                    
           EVALUATE TRUE                                                        
               WHEN ML022-SALE-CLEARANCE                                        
                   MOVE 'CLEARANCE      ' TO RP-SALE-TYPE-2-DESC                
               WHEN ML022-SALE-PROMO-GOLDSTAR                                   
                   MOVE 'PROMO CLEARANCE' TO RP-SALE-TYPE-2-DESC                
               WHEN ML022-SALE-PROMO                                            
                   MOVE 'PROMOTIONAL    ' TO RP-SALE-TYPE-2-DESC                
               WHEN ML022-SALE-REGULAR                                          
                   MOVE 'REGULAR        ' TO RP-SALE-TYPE-2-DESC                
               WHEN OTHER                                                       
                   MOVE 'OTHERS         ' TO RP-SALE-TYPE-2-DESC                
           END-EVALUATE.                                                        
                                                                                
           IF PS-AMT-PCK-DEC                                                    
               MOVE ML022-SALE-EXTD-RTL-AMT   TO RP-SALE-EXTD-RTL-PCK           
           ELSE                                                                 
               MOVE ML022-SALE-EXTD-RTL-AMT   TO RP-SALE-EXTD-RTL-AMT           
           END-IF.                                                              
                                                                                
           MOVE PV-MARKER-COMMENT         TO RP-SALE-MARKER.                    
                                                                                
           IF (RP-SALE-DUMMY-SKU AND PS-RPT-DUMMY-SKU-ONLY)                     
               OR PS-RPT-ALL                                                    
               PERFORM 5200-WRITE-SALES-REC                                     
           END-IF.                                                              
                                                                                
           PERFORM 6200-READ-SALES.                                             
                                                                                
                                                                                
      ******************************************************************        
      * MAIN PROCESSING OF PRICE CHANGES                                        
      ******************************************************************        
       2300-PROCESS-PRICE-CHANGES.                                              
                                                                                
           MOVE ML029-PC-DEPT-NBR         TO RP-PC-DEPT-NBR-9                   
                                             PV-DEPT-NBR-PRC-CHK.               
                                                                                
           MOVE ML029-PC-ENT-ID           TO RP-PC-ENT-ID-9                     
                                             PV-ENT-ID-PRC-CHK.                 
           PERFORM 3100-VENDOR-INFO.                                            
           ADD PA-VEND-NAME-CALL          TO PA-PC-VEND-NAME-CALL.              
           MOVE XMT00000-PRIM-VND-NM      TO RP-PC-VENDOR-NAME.                 
                                                                                
           MOVE ML029-PC-LBL-SEQ-NBR      TO RP-PC-LBL-SEQ-NBR-9                
                                             PV-LBL-SEQ-NBR-PRC-CHK.            
           PERFORM 3200-BRAND-INFO.                                             
           ADD PA-BRND-NAME-CALL          TO PA-PC-BRND-NAME-CALL.              
           MOVE VSCHVL-CHARTC-VAL-DESC    TO RP-PC-BRAND-NAME.                  
                                                                                
           MOVE ML029-PC-ML-LWST-ID       TO PV-ML-LWST-ID-PRC-CHK.             
           PERFORM 3300-GET-DKEY.                                               
           ADD PA-DKEY-CHECK              TO PA-PC-DKEY-CHECK.                  
           ADD PA-DKEY-CHECK-FAIL         TO PA-PC-DKEY-CHECK-FAIL.             
           MOVE PV-ML-LWST-ID-PRC-CHK     TO RP-PC-ML-LWST-ID.                  
                                                                                
           MOVE ML029-PC-SYST-ORIG-CDE    TO RP-PC-SYST-ORIG.                   
                                                                                
           MOVE ML029-PC-EDIT-DTE         TO DTATTR-KY-DTE.                     
           PERFORM 3050-DATE-CHECK.                                             
           MOVE PV-PROC-FSCL-DTE          TO RP-PC-FSCL-DTE.                    
                                                                                
           MOVE ML029-PC-SKU              TO RP-PC-SKU.                         
           IF RP-PC-DUMMY-SKU                                                   
               ADD +1                     TO PA-PC-DUMMY                        
               MOVE 'YES'                 TO RP-PC-DUMMY-SKU-IND                
               MOVE SPACES                TO RP-PC-CHANGED-CODE                 
           ELSE                                                                 
               MOVE 'NO'                  TO RP-PC-DUMMY-SKU-IND                
               MOVE RP-PC-SKU-9           TO XMT00023-SKU-NBR                   
               PERFORM 3000-ATTR-CHECK                                          
               ADD PA-ATTR-CHECK          TO PA-PC-SKU-ATTR                     
               MOVE PV-CHANGED-CODE       TO RP-PC-CHANGED-CODE                 
           END-IF.                                                              
                                                                                
           MOVE ML029-PC-TRANS-CDE        TO RP-PC-TRANS-CDE.                   
           IF ML029-PC-MARKDOWN                                                 
               MOVE 'MARKDOWN       '         TO RP-PC-TRANS-CDE-DESC           
           ELSE                                                                 
               MOVE 'MARKUP         '         TO RP-PC-TRANS-CDE-DESC           
           END-IF.                                                              
                                                                                
           MOVE ML029-PC-MKDN-MKUP-RSN-CDE                                      
               TO RP-PC-MKDN-MKUP-RSN-CDE.                                      
           SET PE049-RSN-CDE-IDX          TO 1.                                 
           SEARCH PE049-RSN-CODE-DESC-TABLE                                     
               AT END                                                           
                   SET PE049-RSN-CDE-IDX          TO 1                          
                   MOVE PE049-RPT-RSN-CODE-DESC (PE049-RSN-CDE-IDX)             
                       TO RP-PC-MKDN-MKUP-RSN-CDE-DES                           
               WHEN PE049-RPT-RSN-CODE (PE049-RSN-CDE-IDX)                      
                       = ML029-PC-MKDN-MKUP-RSN-CDE                             
                   MOVE PE049-RPT-RSN-CODE-DESC (PE049-RSN-CDE-IDX)             
                       TO RP-PC-MKDN-MKUP-RSN-CDE-DES                           
           END-SEARCH.                                                          
                                                                                
           MOVE ML029-PC-CATEGORY         TO RP-PC-CATEGORY.                    
           EVALUATE TRUE                                                        
               WHEN ML029-MARKDOWN-PLU                                          
                   MOVE 'PLU            '     TO RP-PC-CATEGORY-DESC            
               WHEN ML029-MARKDOWN-PERM                                         
                   MOVE 'PERM           '     TO RP-PC-CATEGORY-DESC            
               WHEN ML029-MARKDOWN-UNMATCHED                                    
                   MOVE 'UNMATCH        '     TO RP-PC-CATEGORY-DESC            
               WHEN ML029-MARKDOWN-BUYER                                        
                   MOVE 'BUYER          '     TO RP-PC-CATEGORY-DESC            
               WHEN ML029-MARKDOWN-STORE                                        
                   MOVE 'STORE          '     TO RP-PC-CATEGORY-DESC            
           END-EVALUATE.                                                        
                                                                                
           IF PS-AMT-PCK-DEC                                                    
               MOVE ML029-PC-EXTD-RTL-AMT     TO RP-PC-EXTD-RTL-PCK             
           ELSE                                                                 
               MOVE ML029-PC-EXTD-RTL-AMT     TO RP-PC-EXTD-RTL-AMT             
           END-IF.                                                              
                                                                                
           MOVE PV-MARKER-COMMENT         TO RP-PC-MARKER.                      
                                                                                
           IF (RP-PC-DUMMY-SKU AND PS-RPT-DUMMY-SKU-ONLY)                       
               OR PS-RPT-ALL                                                    
               PERFORM 5300-WRITE-PRICE-CHANGES-REC                             
           END-IF.                                                              
                                                                                
           PERFORM 6300-READ-PRICE-CHANGES.                                     
                                                                                
                                                                                
      ******************************************************************        
      * MAIN PROCESSING OF INVENTORY ADJUSTMENTS                                
      ******************************************************************        
       2400-PROCESS-ADJUSTMENT.                                                 
                                                                                
           MOVE ML024-ADJ-DEPT-NBR        TO RP-ADJ-DEPT-NBR-9                  
                                             PV-DEPT-NBR-PRC-CHK.               
                                                                                
           MOVE ML024-ADJ-ML-LWST-ID      TO PV-ML-LWST-ID-PRC-CHK.             
           MOVE ML024-ADJ-ENT-ID          TO RP-ADJ-ENT-ID-9                    
                                             PV-ENT-ID-PRC-CHK.                 
           MOVE ML024-ADJ-LBL-SEQ-NBR     TO RP-ADJ-LBL-SEQ-NBR-9               
                                             PV-LBL-SEQ-NBR-PRC-CHK.            
           PERFORM 3400-GET-VENDOR-BRAND.                                       
           IF PA-DKEY-CHECK > ZEROES                                            
               ADD PA-DKEY-CHECK          TO PA-INV-ADJ-DKEY-CHECK              
               MOVE MLV00000-LBL-SEQ-NBR  TO ML024-ADJ-LBL-SEQ-NBR              
               MOVE MLV00000-ENT-ID       TO ML024-ADJ-ENT-ID                   
           END-IF.                                                              
           ADD PA-DKEY-CHECK-FAIL     TO PA-INV-ADJ-DKEY-CHECK-FAIL.            
                                                                                
           PERFORM 3100-VENDOR-INFO.                                            
           ADD PA-VEND-NAME-CALL          TO PA-INV-ADJ-VEND-NAME-CALL.         
           MOVE XMT00000-PRIM-VND-NM      TO RP-ADJ-VENDOR-NAME.                
                                                                                
           PERFORM 3200-BRAND-INFO.                                             
           ADD PA-BRND-NAME-CALL          TO PA-INV-ADJ-BRND-NAME-CALL.         
           MOVE VSCHVL-CHARTC-VAL-DESC    TO RP-ADJ-BRAND-NAME.                 
                                                                                
           MOVE ML024-ADJ-ML-LWST-ID      TO PV-ML-LWST-ID-PRC-CHK.             
           PERFORM 3300-GET-DKEY.                                               
           ADD PA-DKEY-CHECK              TO PA-INV-ADJ-DKEY-CHECK.             
           ADD PA-DKEY-CHECK-FAIL         TO PA-INV-ADJ-DKEY-CHECK-FAIL.        
           MOVE PV-ML-LWST-ID-PRC-CHK     TO RP-ADJ-ML-LWST-ID.                 
                                                                                
           MOVE ML024-ADJ-SYST-ORIG-CDE   TO RP-ADJ-SYST-ORIG.                  
                                                                                
           MOVE ML024-ADJ-EDIT-DTE        TO DTATTR-KY-DTE.                     
           PERFORM 3050-DATE-CHECK.                                             
           MOVE PV-PROC-FSCL-DTE          TO RP-ADJ-FSCL-DTE.                   
                                                                                
           MOVE ML024-ADJ-SKU             TO RP-ADJ-SKU.                        
           IF RP-ADJ-DUMMY-SKU                                                  
               ADD +1                     TO PA-INV-ADJ-DUMMY                   
               MOVE 'YES'                 TO RP-ADJ-DUMMY-SKU-IND               
               MOVE SPACES                TO RP-ADJ-CHANGED-CODE                
           ELSE                                                                 
               MOVE 'NO'                  TO RP-ADJ-DUMMY-SKU-IND               
               MOVE RP-ADJ-SKU-9          TO XMT00023-SKU-NBR                   
               PERFORM 3000-ATTR-CHECK                                          
               ADD PA-ATTR-CHECK          TO PA-INV-ADJ-SKU-ATTR                
               MOVE PV-CHANGED-CODE       TO RP-ADJ-CHANGED-CODE                
           END-IF.                                                              
                                                                                
           IF PS-AMT-PCK-DEC                                                    
               MOVE ML024-ADJ-AT-RTL-AMT      TO RP-ADJ-AT-RTL-PCK              
           ELSE                                                                 
               MOVE ML024-ADJ-AT-RTL-AMT      TO RP-ADJ-AT-RTL-AMT              
           END-IF.                                                              
                                                                                
           MOVE PV-MARKER-COMMENT         TO RP-ADJ-MARKER.                     
                                                                                
           IF (RP-ADJ-DUMMY-SKU AND PS-RPT-DUMMY-SKU-ONLY)                      
               OR PS-RPT-ALL                                                    
               PERFORM 5400-WRITE-ADJUSTMENT-REC                                
           END-IF.                                                              
                                                                                
           PERFORM 6400-READ-ADJUSTMENT.                                        
                                                                                
                                                                                
      ******************************************************************        
      * ATTRIBUTES CHECK                                                        
      ******************************************************************        
       3000-ATTR-CHECK.                                                         
                                                                                
           MOVE SPACES TO PV-CHANGED-CODE.                                      
           IF PS-ATTR-CHK-ALL                                                   
               MOVE ' /'              TO PV-CHANGED-SEPARATOR                   
           END-IF.                                                              
                                                                                
           MOVE ZEROES                TO PA-ATTR-CHECK.                         
                                                                                
      * CHECK INPUT VENDOR/BRAND WITH EOM-ONLY? (VALID FOR HISTORICAL)          
           IF PS-ATTR-CHK-EOM-ONLY                                              
               MOVE XMT00000-ENT-ID       TO PV-ENT-ID-ATTR-CHK                 
               MOVE VSCHVL-CHARTC-SEQ-NBR TO PV-LBL-SEQ-NBR-ATTR-CHK            
           ELSE                                                                 
      * CHECK INPUT VENDOR/BRAND WITH BOM ATTRIBUTES                            
               ADD +1                     TO PA-ATTR-CHECK                      
               PERFORM 7400-GET-BOM-ATTR                                        
               MOVE XMT00023-ENT-ID       TO PV-ENT-ID-ATTR-CHK                 
               MOVE XMT00023-LBL-SEQ-NBR  TO PV-LBL-SEQ-NBR-ATTR-CHK            
               IF PS-BOM-SKU-ATTR-FOUND                                         
                   IF XMT00000-ENT-ID NOT = XMT00023-ENT-ID                     
                       AND VSCHVL-CHARTC-SEQ-NBR                                
                           NOT = XMT00023-LBL-SEQ-NBR                           
                       MOVE 'BOTH'        TO PV-CHANGED-CODE-1                  
                   ELSE                                                         
                       IF XMT00000-ENT-ID NOT = XMT00023-ENT-ID                 
                           MOVE 'VNDR'        TO PV-CHANGED-CODE-1              
                       ELSE                                                     
                           IF VSCHVL-CHARTC-SEQ-NBR                             
                                   NOT = XMT00023-LBL-SEQ-NBR                   
                               MOVE 'BRND'        TO PV-CHANGED-CODE-1          
                           END-IF                                               
                       END-IF                                                   
                   END-IF                                                       
               ELSE                                                             
                   MOVE ALL '?'           TO PV-CHANGED-CODE-1                  
               END-IF                                                           
           END-IF.                                                              
                                                                                
      * SKIP, IF CHECK INPUT VENDOR/BRAND WITH BOM-ONLY                         
           IF PS-ATTR-CHK-BOM-ONLY                                              
               CONTINUE                                                         
           ELSE                                                                 
      * CHECK INPUT VENDOR/BRAND WITH EOM-ONLY (VALID FOR HISTORICAL)           
      * OR CHECK BOM-WITH-EOM VENDOR/BRAND (VALID FOR HISTORICAL)               
      * BOM-WITH-EOM VENDOR/BRAND CHECK WILL OVERRIDE EOM-ONLY CHECK            
               ADD +1                     TO PA-ATTR-CHECK                      
               PERFORM 7500-GET-EOM-ATTR                                        
               IF PS-EOM-SKU-ATTR-FOUND                                         
                   IF PV-ENT-ID-ATTR-CHK NOT = XMT00023-ENT-ID                  
                       AND PV-LBL-SEQ-NBR-ATTR-CHK                              
                           NOT = XMT00023-LBL-SEQ-NBR                           
                       MOVE 'BOTH'        TO PV-CHANGED-CODE-2                  
                   ELSE                                                         
                       IF PV-ENT-ID-ATTR-CHK NOT = XMT00023-ENT-ID              
                           MOVE 'VNDR'        TO PV-CHANGED-CODE-2              
                       ELSE                                                     
                           IF PV-LBL-SEQ-NBR-ATTR-CHK                           
                                   NOT = XMT00023-LBL-SEQ-NBR                   
                               MOVE 'BRND'        TO PV-CHANGED-CODE-2          
                           END-IF                                               
                       END-IF                                                   
                   END-IF                                                       
               ELSE                                                             
                   MOVE ALL '?'           TO PV-CHANGED-CODE-2                  
               END-IF                                                           
      * REPLACE CODE 1 WITH EOM CHECK RESULT, IF EOM-ONLY                       
               IF PS-ATTR-CHK-EOM-ONLY                                          
                   MOVE PV-CHANGED-CODE-2 TO PV-CHANGED-CODE-1                  
                   MOVE SPACES            TO PV-CHANGED-CODE-2                  
               END-IF                                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      * FISCAL/TRANSACTION DATE CHECK                                           
      ******************************************************************        
       3050-DATE-CHECK.                                                         
                                                                                
           IF DTATTR-KY-DTE >= DTATTR-FSCL-MN-BEG-DTE                           
               AND DTATTR-KY-DTE <= DTATTR-FSCL-MN-END-DTE                      
               MOVE DTATTR-FSCL-MN-END-DTE TO PV-PROC-FSCL-DTE                  
           ELSE                                                                 
               MOVE DTATTR-KY-DTE          TO PV-PROC-FSCL-DTE                  
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      * CHECK VENDOR INFORMATION AND RETURN VENDOR NAME                         
      ******************************************************************        
       3100-VENDOR-INFO.                                                        
                                                                                
           IF PV-ENT-ID-PRC-CHK NOT = ZEROES                                    
               AND PV-ENT-ID-PRC-CHK NOT = XMT00000-ENT-ID                      
               MOVE +1                    TO PA-VEND-NAME-CALL                  
               MOVE PV-ENT-ID-PRC-CHK TO XMT00000-ENT-ID                        
               PERFORM 7200-GET-VENDOR-NAME                                     
           ELSE                                                                 
               MOVE ZEROES                TO PA-VEND-NAME-CALL                  
               IF PV-ENT-ID-PRC-CHK = ZEROES                                    
                   MOVE SPACES                TO XMT00000-PRIM-VND-NM           
               END-IF                                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      * CHECK BRAND INFORMATION AND RETURN BRAND NAME                           
      ******************************************************************        
       3200-BRAND-INFO.                                                         
                                                                                
           IF PV-LBL-SEQ-NBR-PRC-CHK NOT = ZEROES                               
               AND PV-LBL-SEQ-NBR-PRC-CHK NOT = VSCHVL-CHARTC-SEQ-NBR           
               MOVE +1                    TO PA-BRND-NAME-CALL                  
               MOVE PV-LBL-SEQ-NBR-PRC-CHK TO VSCHVL-CHARTC-SEQ-NBR             
               PERFORM 7300-GET-BRAND-NAME                                      
           ELSE                                                                 
               MOVE ZEROES                TO PA-BRND-NAME-CALL                  
               IF PV-LBL-SEQ-NBR-PRC-CHK = ZEROES                               
                   MOVE SPACES                TO VSCHVL-CHARTC-VAL-DESC         
               END-IF                                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      * CHECK DKEY INFORMATION AND RETURN DKEY                                  
      ******************************************************************        
       3300-GET-DKEY.                                                           
                                                                                
           MOVE ZEROES                  TO PA-DKEY-CHECK.                       
           IF PV-ML-LWST-ID-PRC-CHK = ZEROES                                    
               IF PV-DEPT-NBR-PRC-CHK = MLV00000-DEPT-NBR                       
                   AND PV-LBL-SEQ-NBR-PRC-CHK = MLV00000-LBL-SEQ-NBR            
                   AND PV-ENT-ID-PRC-CHK = MLV00000-ENT-ID                      
                   CONTINUE                                                     
               ELSE                                                             
                   MOVE +1                      TO PA-DKEY-CHECK                
                   MOVE PV-DEPT-NBR-PRC-CHK     TO MLV00000-DEPT-NBR            
                   MOVE PV-LBL-SEQ-NBR-PRC-CHK  TO MLV00000-LBL-SEQ-NBR         
                   MOVE PV-ENT-ID-PRC-CHK       TO MLV00000-ENT-ID              
                   SET PS-GET-DKEY                TO TRUE                       
                   PERFORM 7000-CHECK-DKEY                                      
               END-IF                                                           
               MOVE MLV00000-ML-LO-MDSE-LVL-ID                                  
                   TO PV-ML-LWST-ID-PRC-CHK                                     
           ELSE                                                                 
               IF PV-ML-LWST-ID-PRC-CHK = MLV00000-ML-LO-MDSE-LVL-ID            
                   AND PV-DEPT-NBR-PRC-CHK = MLV00000-DEPT-NBR                  
                   AND PV-LBL-SEQ-NBR-PRC-CHK = PV-LBL-SEQ-NBR-PRC-TMP          
                   AND PV-ENT-ID-PRC-CHK = PV-ENT-ID-PRC-TMP                    
                   CONTINUE                                                     
               ELSE                                                             
                   MOVE PV-DEPT-NBR-PRC-CHK     TO MLV00000-DEPT-NBR            
      * SAVE OFF ORIGINAL ENT-ID AND LBL-SEQ                                    
                   MOVE PV-ENT-ID-PRC-CHK       TO PV-ENT-ID-PRC-TMP            
                   MOVE PV-LBL-SEQ-NBR-PRC-CHK                                  
                       TO PV-LBL-SEQ-NBR-PRC-TMP                                
                   MOVE ZEROES                                                  
                       TO PV-ENT-ID-PRC-CHK                                     
                          PV-LBL-SEQ-NBR-PRC-CHK                                
                   PERFORM 3400-GET-VENDOR-BRAND                                
                   IF PS-CHECK-DKEY-FAIL                                        
                       CONTINUE                                                 
                   ELSE                                                         
                       IF MLV00000-LBL-SEQ-NBR                                  
                               NOT = PV-LBL-SEQ-NBR-PRC-TMP                     
                           AND PV-LBL-SEQ-NBR-PRC-TMP NOT = ZEROES              
                           DISPLAY ' MISMATCH LABEL-SEQ W/DKEY FOR'             
                                   ' DEPT = ' PV-DEPT-NBR-PRC-CHK               
                                   ' DKEY = ' PV-ML-LWST-ID-PRC-CHK             
                                   ' LABEL (ORIGINAL/NEW) = '                   
                                   PV-LBL-SEQ-NBR-PRC-TMP                       
                                   '/' MLV00000-LBL-SEQ-NBR                     
                       END-IF                                                   
                       IF MLV00000-ENT-ID NOT = PV-ENT-ID-PRC-TMP               
                           AND PV-ENT-ID-PRC-TMP NOT = ZEROES                   
                           DISPLAY ' MISMATCH ENT-ID W/DKEY FOR'                
                                   ' DEPT = ' PV-DEPT-NBR-PRC-CHK               
                                   ' DKEY = ' PV-ML-LWST-ID-PRC-CHK             
                                   ' ENT-ID (ORIGINAL/NEW) = '                  
                                   PV-ENT-ID-PRC-TMP                            
                                   '/' MLV00000-ENT-ID                          
                       END-IF                                                   
                   END-IF                                                       
      * RESTORE ORIGINAL ENT-ID AND LBL-SEQ                                     
                   MOVE PV-ENT-ID-PRC-TMP       TO PV-ENT-ID-PRC-CHK            
                   MOVE PV-LBL-SEQ-NBR-PRC-TMP                                  
                       TO PV-LBL-SEQ-NBR-PRC-CHK                                
               END-IF                                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      * CHECK VENDOR/BRAND FROM DKEY AND RETURN VENDOR/BRAND                    
      ******************************************************************        
       3400-GET-VENDOR-BRAND.                                                   
                                                                                
           MOVE ZEROES                  TO PA-DKEY-CHECK.                       
           IF (PV-ENT-ID-PRC-CHK = ZEROES OR                                    
                   PV-LBL-SEQ-NBR-PRC-CHK = ZEROES)                             
               AND PV-ML-LWST-ID-PRC-CHK NOT = ZEROES                           
               SET PS-GET-VENDOR-BRAND    TO TRUE                               
               MOVE PV-ML-LWST-ID-PRC-CHK TO MLV00000-ML-LO-MDSE-LVL-ID         
               PERFORM 7000-CHECK-DKEY                                          
               IF PS-CHECK-DKEY-FAIL                                            
                   MOVE +1                      TO PA-DKEY-CHECK-FAIL           
               ELSE                                                             
                   MOVE +1                      TO PA-DKEY-CHECK                
                   IF MLV00000-LBL-SEQ-NBR NOT = PV-LBL-SEQ-NBR-PRC-CHK         
                       AND PV-LBL-SEQ-NBR-PRC-CHK NOT = ZEROES                  
                       DISPLAY ' LABEL FROM DKEY IS DIFFERENT FOR'              
                               ' DEPT = ' PV-DEPT-NBR-PRC-CHK                   
                               ' DKEY = ' PV-ML-LWST-ID-PRC-CHK                 
                               ' LABEL (ORIGINAL/NEW) = '                       
                               PV-LBL-SEQ-NBR-PRC-CHK                           
                               '/' MLV00000-LBL-SEQ-NBR                         
                   END-IF                                                       
                   IF MLV00000-ENT-ID NOT = PV-ENT-ID-PRC-CHK                   
                       AND PV-ENT-ID-PRC-CHK NOT = ZEROES                       
                       DISPLAY ' ENT-ID FROM DKEY IS DIFFERENT FOR'             
                               ' DEPT = ' PV-DEPT-NBR-PRC-CHK                   
                               ' DKEY = ' PV-ML-LWST-ID-PRC-CHK                 
                               ' ENT-ID (ORIGINAL/NEW) = '                      
                               PV-ENT-ID-PRC-CHK                                
                               '/' MLV00000-ENT-ID                              
                   END-IF                                                       
               END-IF                                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      * WRITE PURCHASE ADJUSTMENTS CSV OUTPUT                                   
      ******************************************************************        
       5100-WRITE-PURCH-REC.                                                    
                                                                                
           IF PA-PURCH-OUT = ZEROES                                             
               WRITE PURCH-OUTPUT-RECORD FROM RP-PURCH-HEADER                   
           END-IF.                                                              
                                                                                
           ADD +1             TO PA-PURCH-OUT.                                  
           WRITE PURCH-OUTPUT-RECORD FROM RP-PURCH-REPORT.                      
                                                                                
      ******************************************************************        
      * WRITE SALES CSV OUTPUT                                                  
      ******************************************************************        
       5200-WRITE-SALES-REC.                                                    
                                                                                
           IF PA-SALES-OUT = ZEROES                                             
               WRITE SALES-OUTPUT-RECORD FROM RP-SALES-HEADER                   
           END-IF.                                                              
                                                                                
           ADD +1             TO PA-SALES-OUT.                                  
           WRITE SALES-OUTPUT-RECORD FROM RP-SALES-REPORT.                      
                                                                                
      ******************************************************************        
      * WRITE PRICE CHANGES CSV OUTPUT                                          
      ******************************************************************        
       5300-WRITE-PRICE-CHANGES-REC.                                            
                                                                                
           IF PA-PC-OUT = ZEROES                                                
               WRITE PRICE-CHANGES-OUTPUT-RECORD                                
                   FROM RP-PRICE-CHANGES-HEADER                                 
           END-IF.                                                              
                                                                                
           ADD +1             TO PA-PC-OUT.                                     
           WRITE PRICE-CHANGES-OUTPUT-RECORD                                    
               FROM RP-PRICE-CHANGES-REPORT.                                    
                                                                                
      ******************************************************************        
      * WRITE INVENTORY ADJUSTMENTS CSV OUTPUT                                  
      ******************************************************************        
       5400-WRITE-ADJUSTMENT-REC.                                               
                                                                                
           IF PA-INV-ADJ-OUT = ZEROES                                           
               WRITE ADJUSTMENT-OUTPUT-RECORD FROM RP-ADJUSTMENT-HEADER         
           END-IF.                                                              
                                                                                
           ADD +1             TO PA-INV-ADJ-OUT.                                
           WRITE ADJUSTMENT-OUTPUT-RECORD FROM RP-ADJUSTMENT-REPORT.            
                                                                                
      ******************************************************************        
      * READ OPTIONAL CONTROL CARD                                              
      ******************************************************************        
       6000-READ-CNTL-FILE.                                                     
           READ CNTL-INPUT-FILE INTO CC-CNTL-LAYOUT                             
               AT END                                                           
                   SET PS-EOF-CNTL TO TRUE                                      
               NOT AT END                                                       
                   ADD 1 TO PA-CNTL-COUNT                                       
           END-READ.                                                            
                                                                                
      ******************************************************************        
      * READ PURCH ADJUSTMENTS                                                  
      ******************************************************************        
       6100-READ-PURCH.                                                         
           READ PURCH-FILE INTO ML030-PURCH-RECORD                              
               AT END                                                           
                   SET PS-EOF-PURCH TO TRUE                                     
               NOT AT END                                                       
                   ADD 1 TO PA-PURCH-IN                                         
           END-READ.                                                            
                                                                                
      ******************************************************************        
      * READ SALES                                                              
      ******************************************************************        
       6200-READ-SALES.                                                         
           READ SALES-FILE INTO ML022-SALE-RECORD                               
               AT END                                                           
                   SET PS-EOF-SALES TO TRUE                                     
               NOT AT END                                                       
                   ADD 1 TO PA-SALES-IN                                         
           END-READ.                                                            
                                                                                
      ******************************************************************        
      * READ PRICE CHANGES                                                      
      ******************************************************************        
       6300-READ-PRICE-CHANGES.                                                 
           READ PRICE-CHANGES-FILE INTO ML029-PC-RECORD                         
               AT END                                                           
                   SET PS-EOF-PRICE-CHANGES TO TRUE                             
               NOT AT END                                                       
                   ADD 1 TO PA-PC-IN                                            
           END-READ.                                                            
                                                                                
      ******************************************************************        
      * READ INVENTORY ADJUSTMENTS                                              
      ******************************************************************        
       6400-READ-ADJUSTMENT.                                                    
           READ ADJUSTMENT-FILE INTO ML024-ADJ-RECORD                           
               AT END                                                           
                   SET PS-EOF-ADJUSTMENT TO TRUE                                
               NOT AT END                                                       
                   ADD 1 TO PA-INV-ADJ-IN                                       
           END-READ.                                                            
                                                                                
      ******************************************************************        
      * GET VENDOR & BRAND FROM DKEY OR GET DKEY FROM VENDOR & BRAND            
      ******************************************************************        
       7000-CHECK-DKEY.                                                         
                                                                                
           IF PS-GET-DKEY                                                       
               EXEC SQL                                                         
                   SELECT                                                       
                           ML_LO_MDSE_LVL_ID                                    
                    INTO                                                        
                          :MLV00000-ML-LO-MDSE-LVL-ID                           
                    FROM                                                        
                         MLV_BRND_VND                                           
                    WHERE                                                       
                          DEPT_NBR   = :MLV00000-DEPT-NBR                       
                      AND LBL_SEQ_NBR = :MLV00000-LBL-SEQ-NBR                   
                      AND ENT_ID     = :MLV00000-ENT-ID                         
                    WITH UR                                                     
               END-EXEC                                                         
           ELSE                                                                 
               EXEC SQL                                                         
                   SELECT                                                       
                           LBL_SEQ_NBR                                          
                          ,ENT_ID                                               
                                                                                
                    INTO                                                        
                          :MLV00000-LBL-SEQ-NBR                                 
                         ,:MLV00000-ENT-ID                                      
                    FROM                                                        
                         MLV_BRND_VND                                           
                    WHERE                                                       
                          ML_LO_MDSE_LVL_ID                                     
                              = :MLV00000-ML-LO-MDSE-LVL-ID                     
                    WITH UR                                                     
               END-EXEC                                                         
           END-IF.                                                              
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN 0                                                           
               WHEN -811                                                        
                   CONTINUE                                                     
               WHEN +100                                                        
                   SET PS-CHECK-DKEY-FAIL TO TRUE                               
                   MOVE ZEROES            TO MLV00000-ML-LO-MDSE-LVL-ID         
               WHEN OTHER                                                       
                   IF PS-GET-DKEY                                               
                       DISPLAY 'LOOKING FOR DEPT = ' MLV00000-DEPT-NBR          
                               ' LABEL = ' MLV00000-LBL-SEQ-NBR                 
                               ' ENT-ID = ' MLV00000-ENT-ID                     
                   ELSE                                                         
                       DISPLAY 'LOOKING FOR DKEY = '                            
                               MLV00000-ML-LO-MDSE-LVL-ID                       
                   END-IF                                                       
                   MOVE '7000-CHECK-DKEY        ' TO PV-PARAGRAPH-NAME          
                   MOVE PE-MSG-02 TO PV-OPERATION-ATTEMPTED                     
                   PERFORM 9900-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
      ******************************************************************        
      * GET AP TRAN CODE DESCRIPTION                                            
      ******************************************************************        
       7100-GET-AP-TRNCDE-DESC.                                                 
                                                                                
           EXEC SQL                                                             
               SELECT                                                           
                       TRN_DESC                                                 
                INTO                                                            
                      :TRNCDE-TRN-DESC                                          
                FROM                                                            
                     TTRNCDE                                                    
                WHERE                                                           
                      AP_TRN_CDE = :TRNCDE-AP-TRN-CDE                           
                WITH UR                                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN 0                                                           
               WHEN -811                                                        
                   INSPECT TRNCDE-TRN-DESC                                      
                       REPLACING ALL ',' BY ' '                                 
               WHEN +100                                                        
                   MOVE '???'                     TO TRNCDE-TRN-DESC            
               WHEN OTHER                                                       
                   DISPLAY 'LOOKING FOR AP TRNCDE = ' TRNCDE-AP-TRN-CDE         
                   MOVE '7100-GET-AP-TRNCDE-DESC' TO PV-PARAGRAPH-NAME          
                   MOVE PE-MSG-02 TO PV-OPERATION-ATTEMPTED                     
                   PERFORM 9900-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
      ******************************************************************        
      * GET VENDOR NAME                                                         
      ******************************************************************        
       7200-GET-VENDOR-NAME.                                                    
                                                                                
           EXEC SQL                                                             
               SELECT                                                           
                       PRIM_VND_NM                                              
                INTO                                                            
                      :XMT00000-PRIM-VND-NM                                     
                FROM                                                            
                     XMT_VND                                                    
                WHERE                                                           
                      ENT_ID = :XMT00000-ENT-ID                                 
                WITH UR                                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN 0                                                           
                   INSPECT XMT00000-PRIM-VND-NM                                 
                       REPLACING ALL ',' BY ' '                                 
               WHEN +100                                                        
                   MOVE '???'                 TO XMT00000-PRIM-VND-NM           
               WHEN OTHER                                                       
                   DISPLAY 'LOOKING FOR VENDOR = ' XMT00000-ENT-ID              
                   MOVE '7200-GET-VENDOR-NAME   ' TO PV-PARAGRAPH-NAME          
                   MOVE PE-MSG-02 TO PV-OPERATION-ATTEMPTED                     
                   PERFORM 9900-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
      ******************************************************************        
      * GET BRAND NAME                                                          
      ******************************************************************        
       7300-GET-BRAND-NAME.                                                     
                                                                                
           EXEC SQL                                                             
               SELECT                                                           
                       CHARTC_VAL_DESC                                          
                INTO                                                            
                      :VSCHVL-CHARTC-VAL-DESC                                   
                FROM                                                            
                     TVSCHVL                                                    
                WHERE                                                           
                      CHARTC_CDE = :PC-3                                        
                  AND CHARTC_SEQ_NBR = :VSCHVL-CHARTC-SEQ-NBR                   
                WITH UR                                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN 0                                                           
                   INSPECT VSCHVL-CHARTC-VAL-DESC                               
                       REPLACING ALL ',' BY ' '                                 
               WHEN +100                                                        
                   MOVE '???'                 TO VSCHVL-CHARTC-VAL-DESC         
               WHEN OTHER                                                       
                   DISPLAY 'LOOKING FOR LABEL = ' VSCHVL-CHARTC-SEQ-NBR         
                   MOVE '7300-GET-BRAND-NAME    ' TO PV-PARAGRAPH-NAME          
                   MOVE PE-MSG-02 TO PV-OPERATION-ATTEMPTED                     
                   PERFORM 9900-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
      ******************************************************************        
      * CHECK SKU'S BOM ATTRIBUTES                                              
      ******************************************************************        
       7400-GET-BOM-ATTR.                                                       
                                                                                
           SET PS-BOM-SKU-ATTR-NOT-FOUND     TO TRUE.                           
           EXEC SQL                                                             
               SELECT                                                           
                       ENT_ID                                                   
                      ,LBL_SEQ_NBR                                              
                INTO                                                            
                      :XMT00023-ENT-ID                                          
                     ,:XMT00023-LBL-SEQ-NBR                                     
                FROM                                                            
                     XMT_BOM_SKU_ATTR                                           
                WHERE                                                           
                      SKU_NBR = :XMT00023-SKU-NBR                               
                  AND FSCL_BOM_DATE  = :DTATTR-FSCL-MN-BEG-DTE                  
                WITH UR                                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN 0                                                           
                   SET PS-BOM-SKU-ATTR-FOUND         TO TRUE                    
               WHEN +100                                                        
                   MOVE ZEROES                TO XMT00023-ENT-ID                
                                                 XMT00023-LBL-SEQ-NBR           
               WHEN OTHER                                                       
                   DISPLAY 'LOOKING FOR SKU = ' XMT00023-SKU-NBR                
                           ' AND DATE = ' DTATTR-FSCL-MN-BEG-DTE                
                   MOVE '7400-GET-BOM-ATTR      ' TO PV-PARAGRAPH-NAME          
                   MOVE PE-MSG-02 TO PV-OPERATION-ATTEMPTED                     
                   PERFORM 9900-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
      ******************************************************************        
      * CHECK SKU'S EOM ATTRIBUTES                                              
      ******************************************************************        
       7500-GET-EOM-ATTR.                                                       
                                                                                
           SET PS-EOM-SKU-ATTR-NOT-FOUND     TO TRUE.                           
           EXEC SQL                                                             
               SELECT                                                           
                       ENT_ID                                                   
                      ,LBL_SEQ_NBR                                              
                INTO                                                            
                      :XMT00023-ENT-ID                                          
                     ,:XMT00023-LBL-SEQ-NBR                                     
                FROM                                                            
                     XMT_BOM_SKU_ATTR                                           
                WHERE                                                           
                      SKU_NBR = :XMT00023-SKU-NBR                               
                  AND FSCL_BOM_DATE  = :PV-NEXT-FSCL-MN-BEG-DTE                 
                WITH UR                                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN 0                                                           
                   SET PS-EOM-SKU-ATTR-FOUND         TO TRUE                    
               WHEN +100                                                        
                   MOVE ZEROES                TO XMT00023-ENT-ID                
                                                 XMT00023-LBL-SEQ-NBR           
               WHEN OTHER                                                       
                   DISPLAY 'LOOKING FOR SKU = ' XMT00023-SKU-NBR                
                           ' AND DATE = ' PV-NEXT-FSCL-MN-BEG-DTE               
                   MOVE '7500-GET-EOM-ATTR      ' TO PV-PARAGRAPH-NAME          
                   MOVE PE-MSG-02 TO PV-OPERATION-ATTEMPTED                     
                   PERFORM 9900-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
      ******************************************************************        
      * GET FISCAL MONTH BEGINNING AND ENDING DATES                             
      ******************************************************************        
       7600-GET-FSCL-DATES.                                                     
                                                                                
           EXEC SQL                                                             
               SELECT                                                           
                       FSCL_MN_BEG_DTE                                          
                      ,FSCL_MN_END_DTE                                          
                      ,FSCL_MN_END_DTE + 1 DAY                                  
                INTO                                                            
                      :DTATTR-FSCL-MN-BEG-DTE                                   
                     ,:DTATTR-FSCL-MN-END-DTE                                   
                     ,:PV-NEXT-FSCL-MN-BEG-DTE                                  
                FROM                                                            
                     TDTATTR                                                    
                WHERE                                                           
                      KY_DTE = :DTATTR-KY-DTE                                   
                WITH UR                                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN 0                                                           
                   SET PS-CNTL-VALIDATION-OK    TO TRUE                         
               WHEN +100                                                        
                   SET PS-CNTL-VALIDATION-FAIL  TO TRUE                         
                   MOVE SPACES                TO DTATTR-FSCL-MN-BEG-DTE         
                                                 DTATTR-FSCL-MN-END-DTE         
                                                 PV-NEXT-FSCL-MN-BEG-DTE        
               WHEN OTHER                                                       
                   DISPLAY 'LOOKING FOR DATE = ' DTATTR-KY-DTE                  
                   MOVE '7600-GET-FSCL-DATES    ' TO PV-PARAGRAPH-NAME          
                   MOVE PE-MSG-02 TO PV-OPERATION-ATTEMPTED                     
                   PERFORM 9900-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
      ******************************************************************        
      * GET PROCESSING DATE FROM ML CONTROL                                     
      ******************************************************************        
       7700-GET-MLCNTL-DATE.                                                    
                                                                                
           EXEC SQL                                                             
               SELECT                                                           
                       OPN_FSCL_WK_DTE                                          
                INTO                                                            
                      :MLCNTL-OPN-FSCL-WK-DTE                                   
                FROM                                                            
                     TMLCNTL                                                    
                WITH UR                                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN 0                                                           
                   CONTINUE                                                     
               WHEN +100                                                        
                   MOVE SPACES                TO MLCNTL-OPN-FSCL-WK-DTE         
               WHEN OTHER                                                       
                   MOVE '7700-GET-MLCNTL-DATE   ' TO PV-PARAGRAPH-NAME          
                   MOVE PE-MSG-02 TO PV-OPERATION-ATTEMPTED                     
                   PERFORM 9900-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
      ******************************************************************        
      *  RESET STATUS CODE, DISPLAY FINAL COUNTS , CLOSE INPUT FILE    *        
      ******************************************************************        
       8000-EOJ-ROUTINE.                                                        
                                                                                
           CLOSE CNTL-INPUT-FILE                                                
                 PURCH-FILE                                                     
                 SALES-FILE                                                     
                 PRICE-CHANGES-FILE                                             
                 ADJUSTMENT-FILE                                                
                 PURCH-OUTPUT-FILE                                              
                 SALES-OUTPUT-FILE                                              
                 PRICE-CHANGES-OUTPUT-FILE                                      
                 ADJUSTMENT-OUTPUT-FILE.                                        
                                                                                
           DISPLAY ' '.                                                         
           DISPLAY 'OPTIONAL CONTROL     ' PA-CNTL-COUNT.                       
           DISPLAY '  CONTROL PROCESSED  ' PA-CNTL-PROCESSED.                   
           DISPLAY 'PURCHASE ADJUSTMENTS '                                      
           DISPLAY '  RECORD IN          ' PA-PURCH-IN.                         
           DISPLAY '  DUMMY SKUS         ' PA-PURCH-DUMMY.                      
           DISPLAY '  TRANS CODE LOOKUP  ' PA-PURCH-TRANS-CODE-CALL.            
           DISPLAY '  VENDOR DESC LOOKUP ' PA-PURCH-VEND-NAME-CALL.             
           DISPLAY '  BRAND NAME LOOKUP  ' PA-PURCH-BRND-NAME-CALL.             
           DISPLAY '  SKU ATTR CHECK     ' PA-PURCH-SKU-ATTR.                   
           DISPLAY '  DKEY PROCESS/CHECK ' PA-PURCH-DKEY-CHECK.                 
           DISPLAY '  DKEY CHECK FAIL    ' PA-PURCH-DKEY-CHECK-FAIL.            
           DISPLAY '  RECORD OUT         ' PA-PURCH-OUT.                        
           DISPLAY 'SALES                '                                      
           DISPLAY '  RECORD IN          ' PA-SALES-IN.                         
           DISPLAY '  DUMMY SKUS         ' PA-SALES-DUMMY.                      
           DISPLAY '  VENDOR DESC LOOKUP ' PA-SALES-VEND-NAME-CALL.             
           DISPLAY '  BRAND NAME LOOKUP  ' PA-SALES-BRND-NAME-CALL.             
           DISPLAY '  SKU ATTR CHECK     ' PA-SALES-SKU-ATTR.                   
           DISPLAY '  DKEY PROCESS/CHECK ' PA-SALES-DKEY-CHECK.                 
           DISPLAY '  DKEY CHECK FAIL    ' PA-SALES-DKEY-CHECK-FAIL.            
           DISPLAY '  RECORD OUT         ' PA-SALES-OUT.                        
           DISPLAY 'PRICE CHANGES        '                                      
           DISPLAY '  RECORD IN          ' PA-PC-IN.                            
           DISPLAY '  DUMMY SKUS         ' PA-PC-DUMMY.                         
           DISPLAY '  VENDOR DESC LOOKUP ' PA-PC-VEND-NAME-CALL.                
           DISPLAY '  BRAND NAME LOOKUP  ' PA-PC-BRND-NAME-CALL.                
           DISPLAY '  SKU ATTR CHECK     ' PA-PC-SKU-ATTR.                      
           DISPLAY '  DKEY PROCESS/CHECK ' PA-PC-DKEY-CHECK.                    
           DISPLAY '  DKEY CHECK FAIL    ' PA-PC-DKEY-CHECK-FAIL.               
           DISPLAY '  RECORD OUT         ' PA-PC-OUT.                           
           DISPLAY 'INVENTORY ADJUSTMENTS'                                      
           DISPLAY '  RECORD IN          ' PA-INV-ADJ-IN.                       
           DISPLAY '  DUMMY SKUS         ' PA-INV-ADJ-DUMMY.                    
           DISPLAY '  VENDOR DESC LOOKUP ' PA-INV-ADJ-VEND-NAME-CALL.           
           DISPLAY '  BRAND NAME LOOKUP  ' PA-INV-ADJ-BRND-NAME-CALL.           
           DISPLAY '  SKU ATTR CHECK     ' PA-INV-ADJ-SKU-ATTR.                 
           DISPLAY '  DKEY PROCESS/CHECK ' PA-INV-ADJ-DKEY-CHECK.               
           DISPLAY '  DKEY CHECK FAIL    ' PA-INV-ADJ-DKEY-CHECK-FAIL.          
           DISPLAY '  RECORD OUT         ' PA-INV-ADJ-OUT.                      
           DISPLAY ' '.                                                         
                                                                                
                                                                                
      ******************************************************************        
      *  STANDARD DB2 ERROR ABEND ROUTINE                                       
      *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.                     
      ******************************************************************        
       9900-SQL-ABEND.                                                          
                                                                                
           MOVE +4013                 TO ABEND-CODE.                            
           DISPLAY '**  ABEND     **'.                                          
           DISPLAY '**  PROGRAM   ** => ' PC-PROGRAM-NAME.                      
           DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.                    
           DISPLAY '**  OPERATION **  = ' PV-OPERATION-ATTEMPTED.               
                                                                                
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE                 
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.                
                                                                                
           COPY DPPD004.                                                        
           PERFORM 9999-ABEND.                                                  
                                                                                
      ******************************************************************        
      *  STANDARD DB2 ERROR ABEND ROUTINE                                       
      *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.                     
      ******************************************************************        
       9999-ABEND.                                                              
                                                                                
           CALL 'ILBOABN0'  USING ABEND-CODE.                                   
                                                                                
