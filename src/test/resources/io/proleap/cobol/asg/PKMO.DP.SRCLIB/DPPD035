      ******************************************************                000 
      *     DPPD035                                        *                000 
      ******************************************************                000 
      *     THIS ROUTINE TAKES A 4 DIGIT STORE NUMBER,                      000 
      *     CALCULATES THE CHECK DIGIT AND PUTS IT IN                       000 
      *     POSITION 5.                                                     000 
      ****************************************************************      000 
206118* 08/20/18  CHG0206118  RENAMED FROM KDU1805 WHICH DID NOT                
206118*                       MEET STANDARDS FOR MAINFRAME REFACTORING          
      ****************************************************************      000 
      *                                                                     000 
       CALCULATE-CHECK-DIGIT.                                               000 
           MOVE '0' TO STORE-DIGIT (5).                                     000 
           MOVE STORE-DIGIT (4) TO ODD-BYTE (2).                            000 
           MOVE STORE-DIGIT (2) TO ODD-BYTE (1).                            000 
           COMPUTE ODD-RESULT = ODD-DIGITS * 2.                             001 
           MOVE STORE-DIGIT (3) TO EVEN-BYTE (2).                           001 
           MOVE STORE-DIGIT (1) TO EVEN-BYTE (1).                           001 
           COMPUTE ODD-EVEN-RESULT = ODD-RESULT-BYTE (1)                    001 
                                   + ODD-RESULT-BYTE (2)                    001 
                                   + ODD-RESULT-BYTE (3)                    001 
                                   + EVEN-BYTE (1)                          001 
                                   + EVEN-BYTE (2).                         001 
           COMPUTE CHECK-DIGIT = 10 - ODD-EVEN-BYTE (3).                    001 
      *                                                                     001 
           MOVE CHECK-DIGIT TO STORE-DIGIT (5).                             002 
       CHECK-DIGIT-EXIT.                                                    002 
           EXIT.                                                            002 
