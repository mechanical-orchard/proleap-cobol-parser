000100**************************************************************    00010000
000110*  DLWS027  --  DLKUT031                                     *    00011000
000120**************************************************************    00012000
000130*    ******                IMPORTANT                 ******  *    00013000
000140*   THIS IS THE COMMUNICATION AREA TO BE USED BY A CALLING   *    00014000
000150*   PROGRAM THAT WILL USE ROUTINE DLKUT031 TO HANDLE         *    00015000
000160*   REMOVING ASSOCIATE FROM ACTIVE ASSIGNMENTS WHEN THEY     *    00016000
000170*   ARE ON MULTIPLE ACTIVE ASSIGNMENT.                       *    00017000
000180*                                                            *    00018000
000190*   IN BATCH DO THIS:                                        *    00019000
000200*     CALL DL027-USER-PGM USING DL027-USER-COMMAREA          *    00020000
000300*                                                            *    00030000
000400*    ******                IMPORTANT                 ******  *    00040000
000500*                                                            *    00050000
000600*     INITIALIZE DL027-USER-COMMAREA BEFORE CALLING DLKUT031 *    00060000
000700*                                                            *    00070000
000800*     DL027-ACCESS-METHOD IS REQUIRED.                       *    00080000
000900*                                                            *    00090000
001000*     THE APPROPRIATE DL027-KEYS FIELDS ARE REQUIRED.        *    00100000
001100*                                                            *    00110000
001200*     REGARDING DL027-OUTPUT-FIELDS:                         *    00120000
001300*       THE APPROPRIATE OUTPUT FIELDS WILL BE RETURNED TO    *    00130000
001400*       THE CALLING PROGRAM BASED ON WHAT THE DLKUT031       *    00140000
001500*       MODULE DETERMINES.                                   *    00150000
001600*                                                            *    00160000
001700*     NOTE: IF FIELD(S) ARE ADDED TO THIS COPYBOOK           *    00170000
001800*           DECREMENT THE FILLER NEAR THE END OF THIS        *    00180000
001900*           COPYBOOK SO THE TOTAL LENGTH REMAINS THE SAME    *    00190000
002000*           AT LENGTH OF 550                                 *    00200000
002100**************************************************************    00210000
002200 01  DL027-ASGMT-COMMAREA.                                        00220000
002300     05  DL027-ACCESS-METHOD              PIC  X(04).             00230000
002400         88  DL027-BY-DC-MULT-ASGMT            VALUE 'MLTD'.      00240001
002500     05  DL027-FILLER                     PIC  X(20).             00250000
002600                                                                  00260000
002700     05  DL027-KEYS.                                              00270000
002800         10  DL027-KEY-WK-TYP             PIC X(15).              00280000
002900                 88  DL027-NO-KEY-WK-TYP       VALUE SPACES.      00290000
003000         10  DL027-KEY-WK-AREA  PIC X(20).                        00300000
003100                 88  DL027-NO-KEY-WK-AREA      VALUE SPACES.      00310000
003200         10  DL027-KEY-DC-NBR             PIC S9(04) COMP.        00320000
003300             88  DL027-NO-KEY-DC-NBR           VALUE ZEROS.       00330000
003400***      10  DL027-KEY-USER-ID            PIC  X(08).             00340001
003500***          88  DL003-NO-KEY-USER-ID          VALUE SPACES.      00350001
003600***      10  DL027-USER-FOUND-CODE        PIC  X(01).             00360001
003700***          88  DL027-USER-NOT-FOUND          VALUE 'N'.         00370001
003800***          88  DL027-USER-IS-KOHLS           VALUE 'K'.         00380001
003900***          88  DL027-USER-IS-TEMP            VALUE 'T'.         00390001
004000***      10  DL027-FILLER                 PIC  X(49).             00400001
004010         10  DL027-FILLER                 PIC  X(58).             00401001
004100                                                                  00410000
004200     05  DL027-RETURN-CODE                PIC  X(02).             00420000
004300         88  DL027-SUCCESSFUL             VALUES ZERO.            00430000
004400         88  DL027-SQL-ERROR              VALUE '01'.             00440000
004500         88  DL027-MISSING-KEY-FIELDS     VALUE '02'.             00450000
004600         88  DL027-CALLED-MODULE-FAILURE  VALUE '98'.             00460000
004700         88  DL027-INVALID-ACCESS         VALUE '99'.             00470000
004710                                                                  00471000
004720     05  DL027-RETURN-SQLCODES.                                   00472000
004730         10  DL027-ASGMT-SQLCODE          PIC  S9(9).             00473000
004740             88  DL027-SQL-NOT-FOUND      VALUE  +100.            00474000
004750             88  DL027-SQL-CONTENTION     VALUES -904 -911 -913.  00475000
004760         10  DL027-FILLER                 PIC  X(32).             00476000
004770                                                                  00477000
004780* THE FOLLOWING FIELD SHOULD CONTAIN THE ORIGINAL CALLING         00478000
004790* PROGRAM ASSOCIATED TO THE PROCESSING TO BE DONE.                00479000
004800     05  DL027-ORIG-CALLING-PGM-NM        PIC  X(08).             00480000
004900     05  DL027-FILLER                     PIC  X(17).             00490000
005000                                                                  00500000
005100* THE FOLLOWING ARE TO CONTAIN PARAGRAPH NUMBERS ASSOCIATED TO    00510000
005200* THE ABOVE SQL RETURN CODES.                                     00520000
005300     05  DL027-CALL-MOD-FAIL-SQL-PARA     PIC  X(5).              00530000
005400     05  DL027-CALL-MOD-FAIL-NM           PIC  X(08).             00540000
005500     05  DL027-CALL-MOD-FAIL-ERR-CDE      PIC  X(02).             00550000
005600     05  DL027-CALL-MOD-FAIL-SQL-CDE      PIC  S9(9).             00560000
005700     05  DL027-FILLER                     PIC  X(10).             00570000
005800                                                                  00580000
005900     05  DL027-OUTPUT-FIELDS.                                     00590000
006000         10  DL027-FILLER                 PIC  X(108).            00600000
006100                                                                  00610000
006200     05  DL027-FILLER                     PIC  X(92).             00620000
006300     05  DL027-SQLCA                      PIC  X(138).            00630000
006400 01  DL027-COMMAREA                       PIC  X(01).             00640000
006500 01  DL027-MULT-ASGMT-PGM                 PIC  X(08)              00650004
006600                                          VALUE 'DLKUT031'.       00660005
