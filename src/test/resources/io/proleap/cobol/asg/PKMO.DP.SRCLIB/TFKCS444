      *-----------------------*                                         00010099
       IDENTIFICATION DIVISION.                                         00020099
      *-----------------------*                                         00030099
       PROGRAM-ID.    TFKCS444.                                         00040099
       AUTHOR.        JACK KRAMER.                                      00050099
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
       DATE-WRITTEN.  JANUARY 1997.                                     00070099
       DATE-COMPILED.                                                   00080099
                                                                        00090099
      ******************************************************************00100099
      * PROGRAM NUMBER: TFKCS444       SYSTEM: TF     LANGUAGE: COBOL II00110099
      *                                                                 00120099
      * TRANID:  P444       MNEMONIC:  TFLWKST       MAP: TFKM444       00130099
      *                                                                 00140099
      * PROGRAM NAME : TRANSFER WORKSHEET CRITERIA LIST                 00150099
      *                                                                 00160099
      * ORIGINAL WORK REQUEST #: 3780                                  F00170099
      *                                                                 00180099
      * PROGRAM OBJECTIVE:                                              00190099
      *                                                                 00200099
      *   TO DISPLAY A LIST OF WORKSHEETS AS PER CRITERIA PASSED FROM   00210099
      *   THE TRANSFER WORKSHEET CRITERIA SPECIFICATION PROGRAM         00220099
      *   (TFKCS443) AND PASS INFORMATION TO THE NEXT PROGRAM,          00230099
      *   ACCORDING TO THE FUNCTION KEY SELECTED.                       00240099
      *                                                                 00250099
      * PROGRAM NARRATIVE:                                              00260099
      *                                                                 00270099
      *   THIS PROGRAM GENERATES A LIST OF TRANSFER WORKSHEETS BASED ON 00280099
      *   THE INPUT SELECTION CRITERIA. IT WILL ALLOW THE USER TO       00290099
      *   SELECT A SPECIFIC WORKSHEET FOR INQUIRY, MAINTENANCE, TO      00300099
      *   COMPLETE THE WORKSHEET, OR TO REQUEST A WORKSHEET LIST.       00310099
      *   THIS PROGRAM USES DYNAMIC SQL TO BUILD THE WORKSHEET LIST     00320099
      *   BASED ON DIFFERENT SELECTION CRITERIA.                        00330099
      *                                                                 00340099
      ***************************************************************** 00350099
      *  1/20/2003 - RAY GRAF                                           00352099
      *   PROCESS NONINTELLIGENT SKU.                                   00353099
111703******************************************************************00355099
111703* 11/17/2003 - RAY GRAF                                           00356099
111703*   SORT1/SORT2 TRANSFER TYPES.                                   00357099
111703******************************************************************00380099
080204**DATE:08/02/2004 CHANGED BY: RAY GRAF                            00390099
080204**     CHANGE PRINTER DESTINATION TO NEW 8 CHARACTER FORMAT       00400099
      ***************************************************************** 00410099
100404**DATE:10/04/2004 CHANGED BY: RAY GRAF                            00411099
100404**     EXPAND STORE NUMBER. MAKE DOMAIN COMPLIANT.                00412099
      ***************************************************************** 00413099
051705*  DATE 05/17/05 RAY GRAF                                         00414099
051705*  REMOVE PHYSICAL INVENTORY LOGIC                                00415099
051705******************************************************************00416099
022212*  DATE 02/22/12 CHERI PARMLEY                                    00418099
022212*  COMPILE DUE TO TTFITEM TABLE CHANGES                           00419099
022212******************************************************************00419199
022212*  DATE 02/14/23 JEAN KURK              CHG0281369                00419299
022212*  REMOVE COPYBOOK FOR UPC CHECK DIGIT ROUTINE                    00419399
022212******************************************************************00419499
      * DATE:        09/24/2021                                         00419599
      * WR/IR#:      CHG0261678                                         00419699
      * PROGRAMMER:  GERMAN BANDA                                       00419799
      * DESCRIPTION: CHANGE CALL OF DPKUT100 TO                         00419899
      *              CALL DP010I-NUMERIC-EDIT-ROUTINE                   00419999
      *              MAKING THE CALL DYNAMIC VS STATIC                  00420099
      *----------------------------------------------------------------*00420199
CICS  * CHANGED 11/17/2022    BY JIM HUNTER      WR: CHG0278345         00420299
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00420399
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00420499
CICS  *-----------------------------------------------------------------00420599
       EJECT                                                            00421099
       ENVIRONMENT DIVISION.                                            00430099
                                                                        00440099
       DATA DIVISION.                                                   00450099
                                                                        00460099
       WORKING-STORAGE SECTION.                                         00470099
                                                                        00470199
       01  DK-DB2-KEYS.                                                 00470299
           05  DK-XFER-TYPE                   PIC  X(02)  VALUE SPACE.  00470399
           05  DK-CONTNR-TYPE                 PIC  X(02)  VALUE SPACE.  00470499
           05  DK-XFER-DKEY-ID                PIC  S9(9)  VALUE ZERO    00470599
                                                          COMP.         00470699
           05  DK-STORE-NBR                   PIC S9(04)  VALUE ZERO    00470799
                                                          COMP.         00470899
080204     05  DK-STORE-NBR-9                 PIC S9(04)  VALUE ZERO    00470999
                                                          COMP.         00471099
           05  DK-UPC-NBR                     PIC S9(15)  VALUE ZERO    00471399
                                                          COMP-3.       00471499
           05  DK-ITEM-NBR                    PIC S9(15)  VALUE ZEROS   01990099
                                                           COMP-3.      01990199
           05  DK-SKU-STATUS-CODE             PIC S9(03)  VALUE ZEROS   01990299
                                                           COMP-3.      01990399
       01  PC-PROGRAM-CONSTANTS.                                        01990699
           05  PC-ITEM-NUMBER-LENGTH          PIC S9(04)  VALUE +5      01990799
                                                          COMP SYNC.    01990899
           05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +15     01990999
                                                          COMP SYNC.    01991099
           05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      01992099
                                                          COMP SYNC.    01993099
           05  PC-1                           PIC S9(03)  VALUE +1      01994099
                                                          COMP-3.       01995099
           05  PC-APOSTROPHE                  PIC  X(01)  VALUE X'7D'.  01996099
           05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    01997099
           05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         01998099
                                                          'TF444A  '.   01999099
           05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         02000099
                                                          'TFKM444 '.   02010099
           05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         02020099
                                                          'TFKCS444'.   02030099
           05  PC-PKMO000                PIC  X(08)  VALUE ',PKMO000'.  02040099
           05  PC-SCL                         PIC  X(03)  VALUE 'SCL'.  02050099
           05  PC-KOHLS-OPERATING-COMPANY     PIC  X(02)  VALUE '03'.   02060099
           05  PC-DOUBLE-SPACE                PIC  X(01)  VALUE '0'.    02060199
           05  PC-CLEARANCE                   PIC  9(02)  VALUE 30.     02060299
111703*    05  PC-DEFECTIVE-DAMAGE       PIC  X(02)  VALUE '01'.        02060699
111703     05  PC-DEFECTIVE-DAMAGE-SORT1 PIC  X(02)  VALUE '00'.        02060799
111703     05  PC-DEFECTIVE-DAMAGE-SORT2 PIC  X(02)  VALUE '01'.        02060899
           05  PC-CALLBACK               PIC  X(02)  VALUE '02'.        02060999
           05  PC-STOCK-BAL-CORP         PIC  X(02)  VALUE '03'.        02061099
           05  PC-STOCK-BAL-STORE        PIC  X(02)  VALUE '04'.        02061199
           05  PC-CUSTOMER               PIC  X(02)  VALUE '05'.        02061299
           05  PC-NON-RETAIL             PIC  X(02)  VALUE '06'.        02062099
           05  PC-OFFSITE-STORAGE        PIC  X(02)  VALUE '07'.        02062199
           05  PC-SECURE-TOTE            PIC  X(02)  VALUE '02'.        02062299
           05  PC-TRAILER                PIC  X(02)  VALUE '04'.        02062399
           05  PC-HAND-CARRY             PIC  X(02)  VALUE '05'.        02062499
           05  PC-COMPLETE-STATUS        PIC  X(02)  VALUE 'CM'.        02062599
           05  PC-MAX-RETAIL-ITEMS       PIC S9(03)  VALUE  +40 COMP-3. 02062699
           05  PC-MAX-NON-RETAIL-ITEMS   PIC S9(03)  VALUE  +20 COMP-3. 02062799
           05  PC-RTV-TYPE               PIC  X(02)  VALUE  'RV'.       02062899
           05  PC-STORE-TYPE             PIC  X(02)  VALUE  'DS'.       02062999
           05  PC-DC                     PIC  X(02)  VALUE  'DC'.       02063099
           05  PC-FIVE-DAYS              PIC  9(01)  VALUE  5.          02064099
           05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  02065099
           05  PC-EQUAL                       PIC  X(02)  VALUE ' ='.   02066099
           05  PC-INIT                        PIC  X(04)  VALUE 'INIT'. 02067099
           05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  02068099
           05  PC-LINE-MAX                    PIC S9(03)  VALUE +60.    02069099
           05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      02070099
           05  PC-ZERO                   PIC S9(04)  VALUE ZERO         02080199
                                                          COMP SYNC.    02080299
           05  PC-3270-ENTRY             PIC  X(02)  VALUE  '02'.       02090099
           05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         02100099
                                                          +1000000      02110099
                                                          COMP-3.       02120099
           05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      02130099
                                                          COMP-3.       02140099
           05  PC-MAX-TYPES                   PIC S9(03)  VALUE +9      02150099
                                                          COMP-3.       02160099
           05 PC-MAX-DATE               PIC X(10) VALUE '9999-09-09'.   03850299
           05  PC-NOT-EQUAL                   PIC  X(02)  VALUE '^='.   03850399
           05  PC-POS-RECEIVED-STATUS         PIC  X(02)  VALUE 'PR'.   03850499
           05  PC-PUT                         PIC  X(04)  VALUE 'PUT'.  03850599
           05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      03850699
           05  PC-SINGLE-SPACE                PIC  X(01)  VALUE ' '.    03850799
           05  PC-TERM                        PIC  X(04)  VALUE 'TERM'. 03850899
           05  PC-TOP-OF-PAGE                 PIC  X(01)  VALUE '1'.    03850999
           05  PC-VOID-STATUS                 PIC  X(02)  VALUE  'VD'.  03851099
           05  PC-YES                         PIC  X(01)  VALUE 'Y'.    03852099
      *                                                                 03853099
           05  PC-TSYMSG-NUMBERS.                                       03854099
               10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  03855099
               10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  03856099
               10  PC-TSYMSG-00017            PIC  9(05)  VALUE 00017.  03857099
               10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  03858099
               10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  03859099
               10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  03860099
               10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  03870099
               10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  03880099
               10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  03890099
               10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  03900099
               10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  03910099
               10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  03920099
               10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  03930099
               10  PC-TSYMSG-00098            PIC  9(05)  VALUE 00098.  03940099
               10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  03950099
               10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  03960099
               10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  03970099
               10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  03980099
               10  PC-TSYMSG-01401            PIC  9(05)  VALUE 01401.  03990099
               10  PC-TSYMSG-01403            PIC  9(05)  VALUE 01403.  04000099
               10  PC-TSYMSG-01483            PIC  9(05)  VALUE 01483.  04010099
               10  PC-TSYMSG-01487            PIC  9(05)  VALUE 01487.  04020099
               10  PC-TSYMSG-01488            PIC  9(05)  VALUE 01488.  04030099
               10  PC-TSYMSG-01495            PIC  9(05)  VALUE 01495.  04040099
               10  PC-TSYMSG-01680            PIC  9(05)  VALUE 01680.  04050099
      *                                                                 04060099
       01  PS-PROGRAM-SWITCHES.                                         04060199
           05  PS-ABEND-IND                   PIC X(01)   VALUE 'N'.    04060299
               88  PS-NO-ABEND-IN-PROGRESS                VALUE 'N'.    04060399
               88  PS-ABEND-IN-PROGRESS                   VALUE 'Y'.    04060499
           05  PS-CURSOR-SW                   PIC  X(01)  VALUE ' '.    04060599
               88  PS-XFER-ALL-CSR                        VALUE 'A'.    04060699
               88  PS-XFER-ITEM-CSR                       VALUE 'I'.    04060799
               88  PS-XFER-LIST-CSR                       VALUE 'L'.    04060899
               88  PS-XFER-RCVR-CSR                       VALUE 'R'.    04060999
           05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    04061099
               88  PS-NO-ERROR                            VALUE 'N'.    04062099
               88  PS-ERROR                               VALUE 'Y'.    04063099
           05  PS-ERROR-DB2-SW                PIC  X(01)  VALUE 'Y'.    04064099
               88  PS-NO-ERROR-DB2                        VALUE 'Y'.    04065099
               88  PS-ERROR-DB2                           VALUE 'N'.    04066099
           05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    04067099
               88  PS-COMMAREA-VALID                      VALUE 'Y'.    04068099
               88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    04068199
           05  PS-XFER-NBR-CHG-IND            PIC  X(01)  VALUE 'N'.    04068299
               88  PS-XFER-NBR-NO-CHG                     VALUE 'N'.    04068399
               88  PS-XFER-NBR-CHG                        VALUE 'Y'.    04068499
           05  PS-STORE-FOUND-SW              PIC  X(01)  VALUE 'Y'.    04068599
               88  PS-STORE-FOUND                         VALUE 'Y'.    04068699
               88  PS-STORE-NOT-FOUND                     VALUE 'N'.    04068799
           05  PS-VALID-UPC-SW                PIC  X(01)  VALUE 'N'.    04069499
               88  PS-VALID-UPC                           VALUE 'Y'.    04069599
               88  PS-INVALID-UPC                         VALUE 'N'.    04069699
           05  PS-VALID-CHECK-DIGIT-SW        PIC  X(01)  VALUE 'N'.    04069799
               88  PS-VALID-CHECK-DIGIT                   VALUE 'Y'.    04069899
               88  PS-INVALID-CHECK-DIGIT                 VALUE 'N'.    04069999
           05  PS-WKSHT-FOUND-IND        PIC X(01)   VALUE 'N'.         04070099
               88  PS-WKSHT-NOT-FOUND                VALUE 'N'.         04070199
               88  PS-WKSHT-FOUND                    VALUE 'Y'.         04070299
               88  PS-WKSHT-COMPLETED                VALUE 'C'.         04070399
      *                                                                 04071399
       01  PV-PROGRAM-VARIABLES.                                        04071499
100404*****HOLD FOR REGIONAL AND NONREGIONAL FIELDS                     04071599
100404     05  PV-NREGN-UNT-RTL-AMT          PIC S9(7)V9(2) VALUE ZERO. 04071699
100404     05  PV-NREGN-UPC-STAT-CHG-DTE     PIC  X(10)     VALUE SPACE.04071799
100404     05  PV-NREGN-UNT-RTL-CHG-DTE      PIC  X(10)     VALUE SPACE.04071899
100404     05  PV-NREGN-LOC-SKU-STAT-CDE     PIC  X(02)     VALUE SPACE.04071999
100404     05  PV-NREGN-LOC-SKU-STAT-CDE-9 REDEFINES                    04072099
100404             PV-NREGN-LOC-SKU-STAT-CDE PIC  9(02).                04072199
100404     05  PV-REGN-LOC-SKU-STAT-CDE      PIC  X(02)     VALUE SPACE.04072299
100404     05  PV-GP-RTL-QTY-NULL-IND        PIC S9(04)     VALUE +0    04072399
100404                                                      COMP SYNC.  04072499
100404     05  PV-GP-RTL-AMT-NULL-IND        PIC S9(04)     VALUE +0    04072599
100404                                                      COMP SYNC.  04072699
           05  PV-LINE-NBR             PIC S9(04)   VALUE +0  COMP.     04072799
           05  PV-ABSTIME                     PIC S9(16)  VALUE +0      04072899
                                                          COMP SYNC.    04072999
           05  PV-ORD-BY-SUB                  PIC S9(04)  VALUE +0      04073099
                                                          COMP SYNC.    04073199
           05  PV-REMAINDER                   PIC S9(04)  VALUE +0      04073299
                                                          COMP SYNC.    04073399
           05  PV-RETRY-COUNT                 PIC S9(04)  VALUE +0      04074099
                                                          COMP SYNC.    04075099
           05  PV-SUB                         PIC S9(04)  VALUE +0      04076099
                                                          COMP SYNC.    04077099
           05  PV-STATUS-TBL-SUB              PIC S9(04)  VALUE +0      04078099
                                                          COMP SYNC.    04079099
           05  PV-WHERE-SUB                   PIC S9(04)  VALUE +0      04080099
                                                          COMP SYNC.    04090099
           05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      04100099
                                                          COMP-3.       04110099
           05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      04120099
                                                          COMP-3.       04130099
           05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      04140099
                                                          COMP-3.       04150099
           05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      04160099
                                                          COMP-3.       04170099
           05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      04180099
                                                          COMP-3.       04190099
           05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      04200099
                                                          COMP-3.       04210099
           05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      04220099
                                                          COMP-3.       04230099
           05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      04240099
                                                          COMP SYNC.    04250099
           05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      04260099
                                                          COMP SYNC.    04270099
           05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      04280099
                                                          COMP SYNC.    04290099
           05  PV-ITEM                        PIC S9(04)  VALUE +0      04300099
                                                          COMP SYNC.    04310099
           05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      04320099
                                                          COMP SYNC.    04330099
           05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      04340099
                                                          COMP SYNC.    04350099
           05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      04360099
                                                          COMP SYNC.    04370099
           05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      04380099
                                                          COMP SYNC.    04390099
           05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      04400099
                                                          COMP SYNC.    04400199
           05  PV-NULL-IND                    PIC S9(04)  VALUE +0      04400299
                                                    COMP SYNC.          04400399
           05  PV-DB2-TIMESTAMP        PIC X(26).                       04400499
           05  PV-DISPLAY-ITM-NBR             PIC 9(15)   VALUE ZERO.   04400599
           05  PV-HOLD-QTY             PIC S9(04)   VALUE +0  COMP.     04400699
           05  PV-UPC-CODE                     PIC S9(15)  VALUE ZERO   04400799
                                                           COMP-3.      04400899
           05  PV-UPC-CODE-DISPLAY             PIC 9(15)  VALUE ZERO.   04400999
           05  PV-LINE-COUNT                  PIC S9(03)  VALUE +0.     04401099
           05  PV-PAGE-COUNT                  PIC S9(03)  VALUE +0.     04402099
           05  PV-ORDER-BY-COUNT              PIC  9(02)  VALUE ZERO.   04402199
           05  PV-SYSTEM-ID.                                            04402299
               10  FILLER                     PIC  X(04)  VALUE SPACE.  04402399
               10  PV-REGION-IND              PIC  X(01).               04402499
                   88  PV-TEST-CICS                       VALUE 'T'.    04402599
                   88  PV-QA-CICS                         VALUE 'Q'.    04402699
                   88  PV-PROD-CICS                       VALUE 'P'.    04402799
                   88  PV-LEARN-CICS                      VALUE 'L'.    04402899
               10  FILLER                     PIC  X(01)  VALUE SPACES. 04402999
100404*    05  PV-XFER-NBR                    PIC 9(09).                04403099
100404     05  PV-XFER-NBR                    PIC 9(10).                04403199
           05  FILLER REDEFINES PV-XFER-NBR.                            04403299
100404*        10  PV-FROM-STORE-NBR          PIC 9(03).                04403399
100404         10  PV-FROM-STORE-NBR          PIC 9(04).                04403499
               10  PV-SEQ-NBR                 PIC 9(06).                04403599
           05  PV-DISP-XFER-NBR.                                        04403699
100404*        10  PV-DISP-FROM-STORE-NBR     PIC X(03).                04403799
100404         10  PV-DISP-FROM-STORE-NBR     PIC X(04).                04403899
               10                             PIC X(01)  VALUE '-'.     04403999
               10  PV-DISP-SEQ-NBR            PIC 9(06).                04404099
           05  PV-XFER-SEQ-NBR         PIC S9(09)   VALUE +0  COMP.     04404299
                                                                        04408099
           05  PV-XFER-TYPE-TBL.                                        04409099
               10  PV-XFER-TYPE-DESC OCCURS 9 TIMES.                    04410099
                   15  PV-XFER-TYPE-LINE-DESC PIC X(18).                04420099
                                                                        04430099
           05  PV-CONTNR-TYPE-TBL.                                      04440099
               10  PV-CONTNR-TYPE-DESC OCCURS 9 TIMES.                  04450099
                   15  PV-CONTNR-TYPE-LINE-DESC PIC X(18).              04460099
051705*    05  PV-CURRENT-DATE.                                         04470099
051705*        10  PV-CURRENT-YEAR             PIC  9(02)  VALUE ZEROS. 04480099
051705*        10  PV-CURRENT-MONTH            PIC  9(02)  VALUE ZEROS. 04490099
051705*        10  PV-CURRENT-DAY              PIC  9(02)  VALUE ZEROS. 04500099
051705*    05  PV-GREGORIAN-DATE.                                       04510099
051705*        10  PV-GD-MONTH                 PIC  9(02)  VALUE ZEROS. 04520099
051705*        10  PV-GD-DAY                   PIC  9(02)  VALUE ZEROS. 04530099
051705*        10  PV-GD-YEAR                  PIC  9(02)  VALUE ZEROS. 04540099
051705*    05  PV-CURRENT-ISO-DATE             PIC X(10)   VALUE SPACE. 04550099
051705*    05  PV-XFER-INV-CTOFF-DTE           PIC X(10)   VALUE SPACE. 04560099
051705*    05  PV-FR-STR-INV-DTE               PIC X(10)   VALUE SPACE. 04570099
051705*    05  PV-TO-STR-INV-DTE               PIC X(10)   VALUE SPACE. 04580099
051705*    05  PV-MAX-PLND-INV-DTE             PIC X(10)   VALUE SPACE. 04590099
051705*    05  PV-PHY-INV-PERD-IND             PIC X(01)   VALUE SPACE. 04600099
           05  PV-CUR-RTL-AMT                  PIC S9(7)V9(2) COMP-3.   04600199
           05  PV-GP-QTY                       PIC S9(3)V COMP-3.       04600299
           05  PV-GP-RTL-AMT                   PIC S9(5)V9(2) COMP-3.   04601099
       01  SD-SYSTEM-DATE.                                              04610099
           05  SD-MMDDYY-FORMAT            PIC  X(08)  VALUE SPACE.     04620099
           05  FILLER  REDEFINES  SD-MMDDYY-FORMAT.                     04630099
               10  SD-SYSTEM-MONTH         PIC  X(02).                  04640099
               10  FILLER                  PIC  X(01).                  04650099
               10  SD-SYSTEM-DAY           PIC  X(02).                  04660099
               10  FILLER                  PIC  X(01).                  04670099
               10  SD-SYSTEM-YEAR          PIC  X(02).                  04680099
                                                                        04690099
       01  PW-PROGRAM-WORK-FIELDS.                                      04700099
           05  PW-XFER-DESC                                PIC  X(21).  05760099
           05  PW-CONTNR-TYPE                              PIC  X(02).  05770099
           05  PW-CONTNR-DESC                              PIC  X(18).  05780099
100404*    05  PW-TO-STORE                                 PIC  X(03).  05790099
100404     05  PW-TO-STORE                                 PIC  X(04).  05791099
100404*    05  PW-TO-STORE-N     REDEFINES PW-TO-STORE     PIC  9(03).  05800099
100404     05  PW-TO-STORE-N     REDEFINES PW-TO-STORE     PIC  9(04).  05810099
           05  PW-TO-STORE-TYPE                            PIC  X(02).  05820099
           05  PW-CUST-NAME                                PIC  X(20).  05830099
           05  PW-PHONE-NBR                                PIC  X(10).  05830199
           05  PW-COMP-BY-INT                              PIC  X(01).  05830299
           05  PW-COMP-BY-NAM                              PIC  X(20).  05840099
           05  PW-REQ-BY-INT                               PIC  X(01).  05850099
           05  PW-REQ-BY-NAM                               PIC  X(20).  05860099
           05  PW-CALLBACK-NBR                             PIC  X(04).  05890099
           05  PW-CALLBACK-NBR-N REDEFINES PW-CALLBACK-NBR              05900099
                                                           PIC  9(04).  05910099
           05  PW-APPROVAL-NBR                             PIC  X(09).  05920099
           05  PW-APPROVAL-NBR-N REDEFINES PW-APPROVAL-NBR              05930099
                                                           PIC  9(09).  05940099
           05  PW-LG-TOTE-SEAL1                            PIC  X(07).  06120099
           05  PW-LG-TOTE-SEAL2                            PIC  X(07).  06130099
           05  PW-SM-TOTE-SEAL                             PIC  X(07).  06140099
           05  PW-TRAILER-SEAL                             PIC  X(07).  06150099
           05  PW-TRAILER-NBR                              PIC  X(08).  06160099
           05  PW-ITEM-SUB                     PIC S9(04) COMP  SYNC.   06670099
           05  PW-RETAIL-ITEM-ARRAY.                                    06670199
               10  PW-RETAIL-ENTRIES OCCURS 40 TIMES.                   06670299
                   15  FILLER                            PIC  X(09).    06670399
                   15  PW-UPC                            PIC  9(13).    06670799
                   15  PW-UPC-XXX REDEFINES PW-UPC.                     06670899
                       45  PW-KOHLS-UPC-DIGITS           PIC X(04).     06670999
                       45  PW-KOHLS-DEPT                 PIC X(03).     06671099
                       45  FILLER                        PIC X(02).     06671199
                       45  PW-KOHLS-DUMMY-SKU            PIC X(03).     06671299
                       45  FILLER                        PIC X(01).     06671399
                   15  PW-KOHLS-UPC                      PIC S9(15)     06671499
                                                         COMP-3.        06671599
                   15  PW-ITEM-NBR                       PIC S9(15)     06671699
                                                         COMP-3.        06671799
                   15  PW-PRICE                          PIC X(07).     06671899
                   15  PW-PRICE-N REDEFINES PW-PRICE                    06671999
                                                         PIC  9(05)V99. 06672099
                   15  PW-FILE-PRICE                     PIC S9(05)V99  06672199
                                                         COMP-3.        06672299
                   15  PW-RTL-QTY                        PIC X(03).     06672399
                   15  PW-RTL-QTY-N REDEFINES PW-RTL-QTY                06672499
                                                         PIC  9(03).    06672599
                   15  PW-RTL-ITEM-UPDATED-SW PIC X(01).                06672699
                       88  PW-RTL-ITEM-UPDATED                          06672799
                                                            VALUE 'Y'.  06672899
                       88  PW-RTL-ITEM-NOT-UPDATED                      06672999
                                                            VALUE ' '.  06673099
                   15  PW-GROUP-PRICED-SW     PIC X(01).                06673199
                       88  PW-GROUP-PRICED-ITEM             VALUE 'Y'.  06673299
                       88  PW-NOT-GROUP-PRICED-ITEM         VALUE 'N'.  06673399
           05  PW-NON-RETAIL-ITEM-ARRAY                                 06673499
                           REDEFINES PW-RETAIL-ITEM-ARRAY.              06673599
               10  PW-NON-RETAIL-ENTRIES OCCURS 20 TIMES.               06673699
                   15  PW-ITEM-DESC.                                    06673799
                       20  PW-ITEM-DESC1                 PIC X(20).     06673899
                       20  PW-ITEM-DESC2                 PIC X(20).     06673999
                   15  PW-NRTL-DEPT                      PIC  X(03).    06674099
                   15  PW-FIXTURE                        PIC  X(20).    06674199
                   15  PW-NRTL-QTY                       PIC X(03).     06674299
                   15  PW-NRTL-QTY-N REDEFINES  PW-NRTL-QTY             06674399
                                                         PIC 9(03).     06674499
                   15  PW-NRTL-ITEM-UPDATED-SW PIC X(01).               06674599
                       88  PW-NRTL-ITEM-UPDATED                         06674699
                                                            VALUE 'Y'.  06674799
                       88  PW-NRTL-ITEM-NOT-UPDATED                     06674899
                                                            VALUE ' '.  06674999
           EJECT                                                        06675099
      *---------------------------------------------------------------* 06675199
      *  WORKING STORAGE AREA USED TO BUILD SQL STATEMENTS            * 06675299
      *---------------------------------------------------------------* 06675399
                                                                        06675499
       01  PV-SQL-STMT.                                                 06675599
           49  PV-SQL-STMT-LEN                PIC S9(04)  COMP  VALUE 0.06675699
      *  SELECT LENGTH PLUS WHERE LENGTH PLUS ORDER BY LENGTH           06676099
           49  PV-SQL-STMT-TEXT               PIC X(2096) VALUE SPACES. 06677099
                                                                        06678099
       01  PV-BUILD-XFER-LIST-SELECT.                                   06679099
           05  PV-BUILD-XFER-LIST-LEN         PIC S9(04) COMP VALUE +0. 06680099
           05  PV-XFER-LIST-SELECT-BYTES      PIC S9(04) COMP VALUE 268.06690099
      *         INCLUDES SELECT LENGTH, FROM LENGTH, AND PARTIAL WHERE  06700099
      *         LENGTH.                                                 06710099
           05  PV-BUILD-XFER-LIST-SEL-STMT.                             06720099
               10  FILLER                     PIC  X(07)                06730099
                               VALUE 'SELECT '.                         06740099
               10  FILLER                     PIC  X(16)                06750099
                               VALUE ' A.XFER_DKEY_ID '.                06760099
               10  FILLER                     PIC  X(16)                06770099
                               VALUE ',A.XFER_TYP_CDE '.                06780099
               10  FILLER                     PIC  X(18)                06790099
                               VALUE ',A.CONTNR_TYP_CDE '.              06800099
               10  FILLER                     PIC  X(14)                06810099
                               VALUE ',A.TO_STR_NBR '.                  06820099
               10  FILLER                     PIC  X(19)                06830099
                               VALUE ',A.WRKSHT_PROB_IND '.             06840099
100404         10  FILLER                     PIC  X(18)                06850099
100404                         VALUE ',B.LOC_10_ABBR_NM '.              06860099
               10  FILLER                     PIC  X(06)                06870099
                                         VALUE 'FROM  '.                06880099
               10  FILLER                     PIC  X(03)                06890099
                                         VALUE 'DB2'.                   06900099
               10  PV-BUILD-QUAL-XL1          PIC  X(01).               06910099
               10  FILLER                     PIC  X(03)                06920099
                                         VALUE 'DBA'.                   06930099
               10  FILLER                     PIC  X(11)                06940099
                                         VALUE '.TTFMSTR A '.           06950099
               10  PV-BUILD-L-PKMO000.                                  06960099
                   15  FILLER                 PIC  X(04)                06970099
                                         VALUE ',DB2'.                  06980099
                   15  PV-BUILD-QUAL-XL2      PIC  X(01).               06990099
                   15  FILLER                 PIC  X(03)                07000099
                                         VALUE 'DBA'.                   07010099
               10  FILLER                     PIC  X(11)                07020099
100404                                   VALUE '.XST_LOC B '.           07030099
               10  FILLER                     PIC  X(06)                07040099
                                         VALUE 'WHERE '.                07050099
               10  FILLER                     PIC  X(15)                07060099
                     VALUE 'A.FR_STR_NBR = '.                           07070099
100404*        10  PV-BUILD-LIST-FR-STR       PIC  9(03).               07080099
100404         10  PV-BUILD-LIST-FR-STR       PIC  9(04).               07081099
               10  FILLER                     PIC  X(05)                07090099
                                         VALUE ' AND '.                 07100099
               10  FILLER                     PIC  X(23)                07110099
                     VALUE 'A.XFER_SEQ_NBR IS NULL '.                   07120099
               10  FILLER                     PIC  X(04)                07130099
                                         VALUE 'AND '.                  07140099
               10  FILLER                     PIC  X(25)                07150099
100404               VALUE 'A.TO_STR_NBR = B.LOC_NBR '.                 07160099
               10  FILLER                     PIC  X(04)                07170099
                                         VALUE 'AND '.                  07180099
               10  FILLER                     PIC  X(22)                07190099
                     VALUE 'A.ENTR_MTHD_TYP_CDE = '.                    07200099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  07210099
               10  FILLER                     PIC  X(02)  VALUE '02'.   07220099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  07230099
               10  PVBLDSQL-XFER-LIST-WH-ORD  PIC  X(542) VALUE SPACES. 07240099
                                                                        07250099
       01  PV-BUILD-XFER-ITEM-SELECT.                                   07260099
           05  PV-BUILD-XFER-ITEM-LEN         PIC S9(04) COMP VALUE +0. 07270099
           05  PV-XFER-ITEM-SELECT-BYTES      PIC S9(04) COMP VALUE 388.07280099
      *         INCLUDES SELECT LENGTH, FROM LENGTH, AND PARTIAL WHERE  07290099
      *         LENGTH.                                                 07300099
           05  PV-BUILD-XFER-ITEM-SEL-STMT.                             07310099
               10  FILLER                     PIC  X(16)                07320099
                               VALUE 'SELECT DISTINCT '.                07330099
               10  FILLER                     PIC  X(16)                07340099
                               VALUE ' A.XFER_DKEY_ID '.                07350099
               10  FILLER                     PIC  X(16)                07360099
                               VALUE ',A.XFER_TYP_CDE '.                07370099
               10  FILLER                     PIC  X(18)                07380099
                               VALUE ',A.CONTNR_TYP_CDE '.              07390099
               10  FILLER                     PIC  X(14)                07400099
                               VALUE ',A.TO_STR_NBR '.                  07410099
               10  FILLER                     PIC  X(19)                07420099
                               VALUE ',A.WRKSHT_PROB_IND '.             07430099
100404         10  FILLER                     PIC  X(18)                07440099
100404                         VALUE ',B.LOC_10_ABBR_NM '.              07450099
               10  FILLER                     PIC  X(06)                07460099
                                         VALUE 'FROM  '.                07470099
               10  FILLER                     PIC  X(03)                07480099
                                         VALUE 'DB2'.                   07490099
               10  PV-BUILD-QUAL-XI1          PIC  X(01).               07500099
               10  FILLER                     PIC  X(03)                07510099
                                         VALUE 'DBA'.                   07520099
               10  FILLER                     PIC  X(11)                07530099
                                         VALUE '.TTFMSTR A '.           07540099
               10  PV-BUILD-I-PKMO000.                                  07550099
                   15  FILLER                 PIC  X(04)                07560099
                                         VALUE ',DB2'.                  07570099
                   15  PV-BUILD-QUAL-XI2      PIC  X(01).               07580099
                   15  FILLER                 PIC  X(03)                07590099
                                         VALUE 'DBA'.                   07600099
               10  FILLER                     PIC  X(11)                07610099
100404                                   VALUE '.XST_LOC B '.           07620099
               10  FILLER                     PIC  X(04)                07630099
                                         VALUE ',DB2'.                  07640099
               10  PV-BUILD-QUAL-XI3          PIC  X(01).               07650099
               10  FILLER                     PIC  X(03)                07660099
                                         VALUE 'DBA'.                   07670099
               10  FILLER                     PIC  X(11)                07680099
                                         VALUE '.TTFITEM C '.           07690099
               10  FILLER                     PIC  X(04)                07691199
                                         VALUE ',DB2'.                  07691299
               10  PV-BUILD-QUAL-XI3A         PIC  X(01).               07691399
               10  FILLER                     PIC  X(03)                07691499
                                         VALUE 'DBA'.                   07691599
               10  FILLER                     PIC  X(11)                07691699
                                         VALUE '.TSKXREF E '.           07691799
               10  FILLER                     PIC  X(06)                07700099
                                         VALUE 'WHERE '.                07710099
               10  FILLER                     PIC  X(32)                07720099
                     VALUE 'C.XFER_DKEY_ID = A.XFER_DKEY_ID '.          07730099
               10  FILLER                     PIC  X(04)                07740099
                                         VALUE 'AND '.                  07750099
               10  FILLER                     PIC  X(15)                07760099
                     VALUE 'A.FR_STR_NBR = '.                           07770099
100404*        10  PV-BUILD-ITEM-FR-STR       PIC  9(03).               07780099
100404         10  PV-BUILD-ITEM-FR-STR       PIC  9(04).               07780199
      **>**********************************************************     07781099
               10  FILLER                     PIC  X(05)                07781199
                                         VALUE ' AND '.                 07781299
               10  FILLER                     PIC  X(32)                07781399
                     VALUE 'C.ITM_NBR = E.ITM_NBR           '.          07781499
      **>**********************************************************     07782099
               10  FILLER                     PIC  X(05)                07790099
                                         VALUE ' AND '.                 07800099
               10  FILLER                     PIC  X(23)                07810099
                     VALUE 'A.XFER_SEQ_NBR IS NULL '.                   07820099
               10  FILLER                     PIC  X(04)                07830099
                                         VALUE 'AND '.                  07840099
               10  FILLER                     PIC  X(25)                07850099
100404               VALUE 'A.TO_STR_NBR = B.LOC_NBR '.                 07860099
               10  FILLER                     PIC  X(04)                07870099
                                         VALUE 'AND '.                  07880099
               10  FILLER                     PIC  X(22)                07890099
                     VALUE 'A.ENTR_MTHD_TYP_CDE = '.                    07900099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  07910099
               10  FILLER                     PIC  X(02)  VALUE '02'.   07920099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  07930099
               10  PVBLDSQL-XFER-ITEM-WH-ORD  PIC  X(542) VALUE SPACES. 07940099
                                                                        07950099
       01  PV-WHERE-BYTES                     PIC S9(04)  COMP VALUE 0. 07960099
       01  PV-WHERE-SIZE                      PIC S9(04)  COMP VALUE 47.07970099
       01  PV-ORDER-BY-BYTES                  PIC S9(04)  COMP VALUE 10.07980099
       01  PV-ORDER-BY-SIZE                   PIC S9(04)  COMP VALUE 18.07990099
                                                                        08000099
       01  PV-WHERE-LITERALS.                                           08010099
           05  PV-WHERE-XFER-TYPE.                                      08020099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.08030099
               10  FILLER                     PIC  X(17)                08040099
                                     VALUE 'A.XFER_TYP_CDE = '.         08050099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  08060099
               10  PV-WH-XFER-TYPE            PIC  X(02)  VALUE SPACES. 08070099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  08080099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  08090099
           05  PV-WHERE-CONTNR-TYPE.                                    08100099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.08110099
               10  FILLER                     PIC  X(19)                08120099
                                     VALUE 'A.CONTNR_TYP_CDE = '.       08130099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  08140099
               10  PV-WH-CONTNR-TYPE          PIC  X(02)  VALUE SPACES. 08150099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  08160099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  08170099
           05  PV-WHERE-TO-STORE.                                       08180099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.08190099
               10  FILLER                     PIC  X(15)                08200099
                                     VALUE 'A.TO_STR_NBR = '.           08210099
100404*        10  PV-WH-TO-STORE             PIC  9(03).               08220099
100404         10  PV-WH-TO-STORE             PIC  9(04).               08221099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  08230099
           05  PV-WHERE-ITEM-DEPT.                                      08240099
      **************************************************************    08241099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.08241199
               10  FILLER                     PIC  X(09)                08241299
                                     VALUE 'E.DEPT = '.                 08241399
               10  PV-WH-ITEM-DEPT            PIC  9(03)  VALUE ZERO.   08241499
               10  FILLER                     PIC  X(01)  VALUE SPACE.  08241599
           05  PV-WHERE-ITEM-CLASS.                                     08320099
      **************************************************************    08321099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.08321199
               10  FILLER                     PIC  X(10)                08321299
                                     VALUE 'E.CLASS = '.                08321399
               10  PV-WH-ITEM-CLASS           PIC  9(03)  VALUE ZERO.   08321499
               10  FILLER                     PIC  X(01)  VALUE SPACE.  08321599
           05  PV-WHERE-CALLBACK-NBR.                                   08400099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.08410099
               10  FILLER                     PIC  X(13)                08420099
                                     VALUE 'A.CLBK_NBR = '.             08430099
               10  PV-WH-CALLBACK-NBR         PIC  9(04)  VALUE ZERO.   08440099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  08450099
           05  PV-WHERE-APPROVAL-NBR.                                   08460099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.08470099
               10  FILLER                     PIC  X(21)                08480099
                                     VALUE 'A.STK_BAL_APVL_NBR = '.     08490099
               10  PV-WH-APPROVAL-NBR         PIC  9(09)  VALUE ZERO.   08500099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  08510099
           05  PV-WHERE-COMP-INIT-NM.                                   08520099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.08530099
               10  FILLER                     PIC  X(21)                08540099
                                     VALUE 'A.CPLD_INIT_1ST_NM = '.     08550099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  08560099
               10  PV-WH-COMP-INIT-NM         PIC  X(01)  VALUE SPACE.  08570099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  08580099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  08590099
           05  PV-WHERE-COMP-LAST-NM.                                   08600099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.08610099
               10  FILLER                     PIC  X(17)                08620099
                                     VALUE 'A.CPLD_LAST_NM = '.         08630099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  08640099
               10  PV-WH-COMP-LAST-NM-DELIM   PIC  X(21)  VALUE SPACE.  08650099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  08650199
           05  PV-WHERE-FR-STR-OVRRID-IND.                              08650299
               10  FILLER                     PIC  X(05)  VALUE ' AND '.08650399
               10  FILLER                     PIC  X(20)                08650499
                                      VALUE 'A.FR_STR_OVRRID_IND '.     08650599
               10  PV-WH-FR-STR-OVRRID-OP     PIC  X(02)  VALUE SPACES. 08650699
               10  FILLER                     PIC  X(01)  VALUE SPACE.  08650799
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  08650899
               10  PV-WH-FR-STR-OVRRID-VALUE  PIC  X(01)  VALUE 'Y'.    08650999
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  08651099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  08652099
                                                                        08653099
       01  PV-WHERE-TABLE.                                              08654099
           05  PV-WHERE-LINE                  PIC  X(47)                08655099
                                              OCCURS 10 TIMES.          08656099
                                                                        08657099
       01  PV-ORDER-BY-FIELDS.                                          08658099
           05  PV-ORDER-BY-XFER-TYPE          PIC  X(14)                08659099
                                     VALUE 'A.XFER_TYP_CDE'.            08660099
           05  PV-ORDER-BY-CONTNR-TYPE        PIC  X(16)                08670099
                                     VALUE 'A.CONTNR_TYP_CDE'.          08680099
           05  PV-ORDER-BY-TO-STORE           PIC  X(12)                08690099
                                     VALUE 'A.TO_STR_NBR'.              08700099
           05  PV-ORDER-BY-CONTROL-NBR        PIC  X(14)                08710099
                                     VALUE 'A.XFER_DKEY_ID'.            08720099
                                                                        08730099
       01  PV-BUILD-ORDER-BY-COMMAND          PIC  X(10)                08740099
                                              VALUE ' ORDER BY '.       08750099
       01  PV-BUILD-ORDER-BY-COMMA            PIC  X(02)  VALUE ' ,'.   08760099
                                                                        08770099
       01  PV-BUILD-ORDER-BY.                                           08780099
           05  PV-BUILD-ORDER-BY-PREFIX       PIC  X(02)  VALUE SPACES. 08790099
           05  PV-BUILD-ORDER-BY-LITERAL      PIC  X(20)  VALUE SPACES. 08800099
                                                                        08810099
       01  PV-ORDER-BY-TABLE.                                           08820099
           05  PV-ORDER-BY-LINE               PIC  X(18)                08830099
                                              OCCURS 4 TIMES.           08840099
                                                                        08850099
           EJECT                                                        08860099
      *                                                                 08870099
      *                                                                 08880099
      ******************************************************************08890099
      **  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **08900099
      **  THIS MUST BE THE EXACT SAME FORMAT AS A BLOCK IN THE        **08910099
      **  APPLICATION-SPECIFIC COMMAREA.                              **08920099
      ******************************************************************08930099
       01  LQW-LIST-QUEUE-WORK-AREA.                                    08940099
           05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  08950099
           05  LQW-ITEM-ENTRIES               OCCURS 15 TIMES           08960099
                                              INDEXED BY LQW-IDX.       08970099
               10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       08980099
               10  LQW-TEMP-SELECTED-SW       PIC  X(01).               08990099
               10  LQW-SELECTED-SW            PIC  X(01).               09000099
                   88  LQW-SELECT                         VALUE 'S'.    09010099
                   88  LQW-DESELECT                       VALUE ' '.    09020099
               10  LQW-ACTION                 PIC X(03).                09030099
               10  LQW-CONTROL-NBR            PIC 9(09).                09040099
100404*        10  LQW-TRANSFER-TYPE          PIC X(22).                09050099
100404         10  LQW-TRANSFER-TYPE          PIC X(20).                09051099
100404*        10  LQW-TO-STORE-NBR           PIC X(03).                09060099
100404         10  LQW-TO-STORE-NBR           PIC X(04).                09061099
               10  LQW-TO-STORE-NAME          PIC X(10).                09070099
100404         10  LQW-CONTNR-TYPE            PIC X(18).                09080099
100404*>       10  LQW-CONTNR-TYPE            PIC X(14).                09081099
               10  LQW-DISCREP-IND            PIC X(01).                09090099
                                                                        09100099
           EJECT                                                        09110099
      *---------------------------------------------------------------* 09120099
      *  RECORD LAYOUT FOR THE TRANSFER SELECTION TEMP STORAGE QUEUE  * 09130099
      *---------------------------------------------------------------* 09140099
                                                                        09150099
       01  TF421-SELECTED-LINES.                                        09160099
             05  TF421-SELECTED-ITEMS         PIC S9(05)  COMP-3        09170099
                                                          VALUE ZERO.   09180099
             05  TF421-MAX-ITEMS              PIC  9(03)  VALUE 20.     09190099
             05  TF421-SELECTED-ITEM-ARRAY.                             09200099
                 10  FILLER                   OCCURS 20 TIMES           09210099
                                              INDEXED BY TF421-IDX.     09220099
                     15  TF421-ITEM           PIC S9(09)  COMP-3.       09230099
                     15  TF421-ACTION-SW      PIC  X(01).               09240099
                         88  TF421-SEL                  VALUE 'S'.      09250099
                     15  TF421-XFER-DKEY-ID   PIC  S9(09) COMP.         09260099
                                                                        09270099
           EJECT                                                        09280099
                                                                        09281099
      *----------------------------------------------------------------*09282099
      *  RF COPYBOOK TO FORMAT PRINTER DESTINATION                      09283099
      *----------------------------------------------------------------*09284099
080204     COPY RFWS009.                                                09285099
                                                                        09286099
      *---------------------------------------------------------------* 09290099
      *    MAP LAYOUT                                                 * 09300099
      *---------------------------------------------------------------* 09310099
                                                                        09320099
           COPY TFKM444.                                                09330099
      *                                                                 09340099
       01  MR-OCCURS-LAYOUT                   REDEFINES  TF444AO.       09350099
100404     05  FILLER                         PIC X(12).                09350199
      *                                                                 09350399
           05  MR-FR-STORE-NBRL              PIC S9(04)  COMP.          09350499
           05  MR-FR-STORE-NBRA              PIC  X(01).                09350599
           05  MR-FR-STORE-NBRC              PIC  X(01).                09350699
           05  MR-FR-STORE-NBRH              PIC  X(01).                09350799
100404*    05  MR-FR-STORE-NBR               PIC  X(03).                09350899
100404     05  MR-FR-STORE-NBR               PIC  X(04).                09350999
      *                                                                 09351099
           05 MR-STARTL                       PIC S9(04) COMP.          09351199
           05 MR-STARTA                       PIC  X(01).               09351299
           05 MR-STARTC                       PIC  X(01).               09352099
           05 MR-STARTH                       PIC  X(01).               09353099
           05 MR-START                        PIC 9(05).                09354099
      *                                                                 09355099
           05 MR-ENDL                         PIC S9(04) COMP.          09356099
           05 MR-ENDA                         PIC  X(01).               09357099
           05 MR-ENDC                         PIC  X(01).               09358099
           05 MR-ENDH                         PIC  X(01).               09359099
           05 MR-END                          PIC 9(05).                09360099
      *                                                                 09370099
           05 MR-TOTALL                       PIC S9(04) COMP.          09380099
           05 MR-TOTALA                       PIC  X(01).               09390099
           05 MR-TOTALC                       PIC  X(01).               09400099
           05 MR-TOTALH                       PIC  X(01).               09410099
           05 MR-TOTAL                        PIC 9(05).                09420099
      *                                                                 09430099
           05  MR-SCROLL-AREA                 OCCURS 15 TIMES.          09440099
               10  MR-SELECTL                 PIC S9(04) COMP.          09450099
               10  MR-SELECTA                 PIC  X(01).               09460099
               10  MR-SELECTC                 PIC  X(01).               09470099
               10  MR-SELECTH                 PIC  X(01).               09480099
               10  MR-SELECTI                 PIC  X(01).               09490099
                                                                        09500099
               10  FILLER                     PIC  X(05).               09510099
               10  MR-ACTION                  PIC  X(03).               09520099
                                                                        09530099
               10  FILLER                     PIC  X(05).               09540099
               10  MR-CONTROL-NBR             PIC  X(09).               09550099
                                                                        09560099
               10  FILLER                     PIC  X(05).               09570099
100404*        10  MR-TRANSFER-TYPE           PIC  X(22).               09580099
100404         10  MR-TRANSFER-TYPE           PIC  X(20).               09581099
                                                                        09590099
               10  FILLER                     PIC  X(05).               09600099
100404*        10  MR-TO-STORE-NBR            PIC  X(03).               09610099
100404         10  MR-TO-STORE-NBR            PIC  X(04).               09611099
                                                                        09620099
100404         10  FILLER                     PIC  X(05).               09630099
               10  MR-TO-STORE-NAME           PIC  X(10).               09640099
                                                                        09650099
               10  FILLER                     PIC  X(05).               09660099
               10  MR-CONTAINER-TYPE          PIC  X(14).               09670099
                                                                        09680099
               10  FILLER                     PIC  X(05).               09690099
               10  MR-DISCREPANCY-SW          PIC  X(01).               09700099
                                                                        09710099
           EJECT                                                        09720099
      *---------------------------------------------------------------* 09730099
      *    ATTRIBUTE SETTINGS COPYBOOK.                               * 09740099
      *---------------------------------------------------------------* 09750099
                                                                        09760099
           COPY DPWS015.                                                09770099
                                                                        09780099
      *---------------------------------------------------------------* 09790099
      *    FUNCTION KEYS COPYBOOK.                                    * 09800099
      *---------------------------------------------------------------* 09810099
                                                                        09820099
           COPY DPWS016.                                                09830099
                                                                        09840099
      *---------------------------------------------------------------* 09850099
      *    NUMERIC EDIT LAYOUT.                                       * 09860099
      *---------------------------------------------------------------* 09870099
                                                                        09880099
           COPY DPWS010I.                                               09890099
                                                                        09900099
      ******************************************************************09910099
      *  DATE VALIDATION CALLING PARAMETER LIST                        *09920099
      ******************************************************************09930099
                                                                        09940099
           COPY DPWS500.                                                09950099
                                                                        09950199
       EJECT                                                            09950799
      *---------------------------------------------------------------* 09950899
      *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 09950999
      *---------------------------------------------------------------* 09951099
                                                                        09952099
           COPY DPWS030.                                                09953099
CICS       COPY DPWS930.                                                09953199
       EJECT                                                            09954099
      *---------------------------------------------------------------* 09955099
      *    STANDARD COMMAREA.                                         * 09956099
      *---------------------------------------------------------------* 09957099
                                                                        09958099
           COPY DPWS020.                                                09959099
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                09960099
                                                                        09970099
      *---------------------------------------------------------------* 09980099
      * INTER-APPLICATION COMMAREA.                                   * 09990099
      *   TFWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 10000099
      *             SPEC SCREEN.                                      * 10010099
      *   TFWS001 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 10020099
      *             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 10030099
      *---------------------------------------------------------------* 10040099
                                                                        10050099
               10  INTER-APPL-COMM-AREA       PIC X(200).               10060099
           COPY TFWS001.                                                10070099
      *---------------------------------------------------------------* 10080099
      *  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 10090099
      *---------------------------------------------------------------* 10100099
               10  ASC-SPECIFIC-COMMAREA.                               10110099
                   15  ASC-CRITERIA-INFO.                               10120099
                       20  ASC-XFER-TYPE                   PIC  X(02).  10130099
                           88  ASC-ALL-TYPES               VALUE '  '.  10140099
111703*                    88  ASC-DEFECTS-DAMAGES-TYPE    VALUE '01'.  10150099
111703                     88  ASC-DEFECTS-DAMAGES-SORT1   VALUE '00'.  10151099
111703                     88  ASC-DEFECTS-DAMAGES-SORT2   VALUE '01'.  10152099
                           88  ASC-CALLBACK-TYPE           VALUE '02'.  10160099
                           88  ASC-STOCK-BAL-CORP-TYPE     VALUE '03'.  10170099
                           88  ASC-STOCK-BAL-STORE-TYPE    VALUE '04'.  10180099
                           88  ASC-CUSTOMER-TYPE           VALUE '05'.  10190099
                           88  ASC-NON-RETAIL-TYPE         VALUE '06'.  10200099
                       20  ASC-CONTNR-TYPE                 PIC  X(02).  10210099
100404*                20  ASC-XFER-TO-STR                 PIC  9(03).  10220099
100404                 20  ASC-XFER-TO-STR                 PIC  9(04).  10221099
100404*                20  ASC-XFER-FR-STR                 PIC  9(03).  10230099
100404                 20  ASC-XFER-FR-STR                 PIC  9(04).  10231099
                       20  ASC-XFER-DPT                    PIC  9(03).  10240099
                       20  ASC-XFER-CLASS                  PIC  9(03).  10250099
                       20  ASC-XFER-CALLBACK-NBR           PIC  9(04).  10260099
                       20  ASC-XFER-APPROVAL-NBR           PIC  9(09).  10270099
                       20  ASC-XFER-COMP-BY-FIRST-INIT     PIC  X(01).  10280099
                       20  ASC-XFER-COMP-BY-LAST-NAME      PIC  X(20).  10290099
                   15  ASC-CRITERIA-SORT-ORDER.                         10300099
                       20  ASC-XFER-TYPE-SORT-NR           PIC  9(01).  10310099
                       20  ASC-CONTNR-TYPE-SORT-NR         PIC  9(01).  10320099
                       20  ASC-XFER-TO-STR-SORT-NR         PIC  9(01).  10330099
                   15  ASC-SEL-CONTROL-NBR         PIC S9(09)  COMP.    10340099
                   15  ASC-ACTION-SW               PIC  X(01).          10350099
                       88  ASC-PRT-DOC-REQUESTED   VALUE 'D'.           10360099
                       88  ASC-PRT-WKSHT-REQUESTED VALUE 'W'.           10370099
                       88  ASC-COMPLETE-REQUESTED  VALUE 'C'.           10380099
100404*            15  ASC-FROM-STORE                  PIC  9(03).      10380199
100404             15  ASC-FROM-STORE                  PIC  9(04).      10380299
                   15  ASC-XFER-SEQ-NBR                PIC S9(09) COMP. 10380399
                   15  ASC-NBR-OF-LINES-ENTERED        PIC S9(03)       10380499
                                                              COMP-3.   10380599
                   15  ASC-CMPLT-XFER-TYPE                PIC  X(02).   10380699
                       88  ASC-NON-RETAIL-XFER             VALUE '06'.  10380799
                       88  ASC-RETAIL-XFER                 VALUE        10380899
111703*                                          '01' THRU '05', '07'.  10380999
111703                                           '00' THRU '05', '07'.  10381099
                   15  ASC-PROB-IND                PIC  X(01).          10381199
                       88  ASC-PROBLEM-EXISTS      VALUE 'Y'.           10381299
                       88  ASC-NO-PROBLEM-EXISTS   VALUE 'N'.           10381399
                   15  ASC-DO-NOT-SHIP-SW                  PIC  X(01).  10381499
                       88  ASC-DO-NOT-SHIP                 VALUE 'N'.   10381599
                       88  ASC-OK-TO-SHIP                  VALUE 'Y'.   10381699
                   15  ASC-FR-STR-OVRRID-IND       PIC  X(01).          10381799
                       88  ASC-FR-STR-OVERRIDE     VALUE 'Y'.           10381899
                   15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                10381999
                       20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  10382099
                           88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   10382199
                           88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   10382299
                                                                        10383099
                       20  ASC-ITEM-ARRAY.                              10384099
                           25  ASC-ITEM-ENTRIES OCCURS 15 TIMES.        10385099
                               30  ASC-LIST-ITEM-NUMBER                 10386099
                                                       PIC S9(09)       10387099
                                                           COMP-3.      10388099
                               30  ASC-TEMP-SELECTED-SW PIC X(01).      10389099
                                   88  ASC-VALID-SELECT  VALUE ' '      10390099
                                                               'S'.     10400099
                                   88  ASC-TEMP-NO-SELECT               10410099
                                                         VALUE ' '.     10420099
                                   88  ASC-TEMP-SELECT   VALUE 'S'.     10430099
                               30  ASC-SELECTED-SW     PIC X(01).       10440099
                                   88  ASC-NO-SELECT     VALUE ' '.     10450099
                                   88  ASC-SELECT        VALUE 'S'.     10460099
                               30  ASC-ACTION          PIC X(03).       10470099
                               30  ASC-CONTROL-NBR     PIC 9(09).       10480099
100404*                        30  ASC-TRANSFER-TYPE   PIC X(22).       10490099
100404                         30  ASC-TRANSFER-TYPE   PIC X(20).       10491099
100404*                        30  ASC-TO-STORE-NBR    PIC 9(03).       10500099
100404                         30  ASC-TO-STORE-NBR    PIC 9(04).       10501099
                               30  ASC-TO-STORE-NAME   PIC X(10).       10510099
                               30  ASC-CONTAINER-TYPE  PIC X(18).       10520099
                               30  ASC-DISCREP-IND     PIC X(01).       10530099
                                                                        10540099
                   15  ASC-BLK-SUB                     PIC S9(04) COMP  10550099
                                                                SYNC.   10560099
                   15  ASC-ITEM-SUB                    PIC S9(04) COMP  10570099
                                                                SYNC.   10580099
                   15  ASC-NUMBER-OF-ITEMS-READ        PIC S9(09)       10590099
                                                                COMP-3. 10600099
                   15  ASC-NUMBER-OF-SELECTED-ITEMS    PIC S9(09)       10610099
                                                                COMP-3. 10620099
                   15  ASC-ITEMS-DISPLAYED             PIC S9(03)       10630099
                                                                COMP-3. 10640099
                   15  ASC-ITEM-AT-TOP-OF-PANEL        PIC S9(09)       10650099
                                                                COMP-3. 10660099
                   15  ASC-ITEM-AT-BOT-OF-PANEL        PIC S9(09)       10670099
                                                                COMP-3. 10680099
                   15  ASC-HIGHEST-BLOCK-WRITTEN       PIC S9(04) COMP  10690099
                                                                SYNC.   10700099
                   15  ASC-ITEMS-LEFT-INDICATOR        PIC  X(01).      10710099
                       88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   10720099
                       88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   10730099
                   15  ASC-TEMP-QUEUE-UPDATE-SW        PIC  X(01).      10740099
                       88  ASC-UPDATE-TSQ                  VALUE 'Y'.   10750099
                       88  ASC-NO-TSQ-UPDATE               VALUE ' '.   10760099
                   15  ASC-LIST-QUEUE-NAME.                             10770099
                       20  ASC-LIST-TERM-ID            PIC  X(04).      10780099
                       20  ASC-LIST-TASK-NUMBER        PIC S9(05)       10790099
                                                                COMP-3. 10800099
                       20  ASC-LIST-SEQ                PIC  9(01).      10810099
                   15  ASC-SEL-QUEUE-NAME.                              10820099
                       20  ASC-SEL-TERM-ID             PIC  X(04).      10830099
                       20  ASC-SEL-TASK-NUMBER         PIC S9(05)       10840099
                                                                COMP-3. 10850099
                       20  ASC-SEL-SEQ                 PIC  9(01).      10860099
                                                                        10870099
                   15  ASC-START-ITEM-REQUEST.                          10880099
                       20  ASC-START-ITEM-REQUEST-N    PIC  9(05).      10890099
                                                                        10900099
           EJECT                                                        10910099
      *---------------------------------------------------------------* 10920099
      *    ABEND PROCESSING COPYBOOK.                                 * 10930099
      *---------------------------------------------------------------* 10940099
                                                                        10950099
           COPY DPWS013.                                                10960099
                                                                        10960199
           EJECT                                                        10960299
      *---------------------------------------------------------------* 10960399
      *    DB2 AREA FOR TRANSFER TABLE                                * 10960499
      *---------------------------------------------------------------* 10960599
           EXEC SQL                                                     10960699
                INCLUDE TTFMSTR                                         10960799
           END-EXEC.                                                    10960899
      *---------------------------------------------------------------* 10960999
      *    DB2 AREA FOR TRANSFER ITEM TABLE                           * 10961099
      *---------------------------------------------------------------* 10961199
           EXEC SQL                                                     10961299
                INCLUDE TTFITEM                                         10961399
           END-EXEC.                                                    10961499
      *---------------------------------------------------------------* 10961599
      *    DB2 AREA FOR TRANSFER TYPE TABLE                           * 10961699
      *---------------------------------------------------------------* 10961799
           EXEC SQL                                                     10961899
                INCLUDE TTFTYCD                                         10961999
           END-EXEC.                                                    10962099
      *---------------------------------------------------------------* 10962199
      *    DB2 AREA FOR CONTAINER TYPE TABLE                          * 10962299
      *---------------------------------------------------------------* 10962399
           EXEC SQL                                                     10962499
                INCLUDE TTFSHCT                                         10962599
           END-EXEC.                                                    10962699
      *---------------------------------------------------------------* 10962799
      *    DB2 AREA FOR TRANSFER STATUS TABLE                         * 10962899
      *---------------------------------------------------------------* 10962999
           EXEC SQL                                                     10963099
                INCLUDE TTFSTAT                                         10963199
           END-EXEC.                                                    10963299
      *---------------------------------------------------------------* 10963399
      *    DB2 AREA FOR TRANSFER CUSTOMER TABLE                       * 10963499
      *---------------------------------------------------------------* 10963599
           EXEC SQL                                                     10963699
                INCLUDE TTFCUST                                         10963799
           END-EXEC.                                                    10963899
      *---------------------------------------------------------------* 10964599
      *    DB2 AREA FOR XST_LOC TABLE                                 * 10964699
      *---------------------------------------------------------------* 10964799
           EXEC SQL                                                     10964899
                INCLUDE XST00001                                        10964999
           END-EXEC.                                                    10965099
      *---------------------------------------------------------------* 10966099
100404*    DB2 AREA FOR XST_SKU_LOC TABLE                             * 10967099
      *---------------------------------------------------------------* 10967199
           EXEC SQL                                                     10967299
100404          INCLUDE XST00008                                        10967399
           END-EXEC.                                                    10967499
      *---------------------------------------------------------------* 10967599
100404*    DB2 AREA FOR XST_SKU TABLE                                 * 10967699
      *---------------------------------------------------------------* 10967799
           EXEC SQL                                                     10967899
100404          INCLUDE XST00010                                        10967999
           END-EXEC.                                                    10968099
      *---------------------------------------------------------------* 10968199
100404*    DB2 AREA FOR XST_UPC TABLE                                 * 10968299
      *---------------------------------------------------------------* 10968399
           EXEC SQL                                                     10968499
100404          INCLUDE XST00012                                        10968599
           END-EXEC.                                                    10968699
      *---------------------------------------------------------------* 10968799
      *    DB2 AREA FOR PERMANENT PRICE CHANGE HISTORY TABLE          * 10968899
      *---------------------------------------------------------------* 10968999
           EXEC SQL                                                     10969099
               INCLUDE TPPCPRC                                          10969199
           END-EXEC.                                                    10969299
051705*---------------------------------------------------------------* 10969399
051705*    DB2 AREA FOR TRANSFER CONTROL TABLE                        * 10969499
051705*---------------------------------------------------------------* 10969599
051705*    EXEC SQL                                                     10969699
051705*         INCLUDE TTFCNTL                                         10969799
051705*    END-EXEC.                                                    10969899
051705*---------------------------------------------------------------* 10969999
051705*    DB2 AREA FOR INVENTORY PARAMETERS TABLE                    * 10970099
051705*---------------------------------------------------------------* 10970199
051705*    EXEC SQL                                                     10970299
051705*         INCLUDE TINVPAR                                         10970399
051705*    END-EXEC.                                                    10970499
      *---------------------------------------------------------------* 10970599
      *    DB2 AREA FOR SKU CROSS REFERENCE TABLE                     * 10970699
      *---------------------------------------------------------------* 10970799
           EXEC SQL                                                     10970899
                INCLUDE TSKXREF                                         10970999
           END-EXEC.                                                    10971099
      *---------------------------------------------------------------* 10971199
      *    DB2 AREA FOR COMMUNICATIONS                                * 10971299
      *---------------------------------------------------------------* 10971399
           EXEC SQL                                                     10971499
                INCLUDE SQLCA                                           10971599
           END-EXEC.                                                    10971699
      *---------------------------------------------------------------* 10971799
      *    CURSOR TO OBTAIN THE TRANSFER TYPE CODES AND DESCRIPTIONS  * 10971899
      *---------------------------------------------------------------* 10971999
                                                                        10972099
           EXEC SQL                                                     10972199
                DECLARE XFER-TYPE-CSR CURSOR                            10972299
                FOR                                                     10972399
                  SELECT                                                10972499
                      XFER_TYP_CDE                                      10972599
                     ,TYP_1ST_LNE_DESC                                  10972699
                     ,TYP_2ND_LNE_DESC                                  10972799
                  FROM                                                  10972899
                      TTFTYCD                                           10972999
                  ORDER BY XFER_TYP_CDE                                 10973099
                  WITH UR                                               10973199
           END-EXEC.                                                    10973299
                                                                        10973399
      *---------------------------------------------------------------* 10973499
      *  CURSOR TO OBTAIN THE CONTAINER TYPE CODES AND DESCRIPTIONS   * 10973599
      *---------------------------------------------------------------* 10973699
                                                                        10973799
           EXEC SQL                                                     10973899
                DECLARE CONTNR-TYPE-CSR CURSOR                          10973999
                FOR                                                     10974099
                  SELECT                                                10974199
                      CONTNR_TYP_CDE                                    10974299
                     ,CONTNR_TYP_DESC                                   10974399
                  FROM                                                  10974499
                      TTFSHCT                                           10974599
                  ORDER BY CONTNR_TYP_CDE                               10974699
                  WITH UR                                               10974799
           END-EXEC.                                                    10974899
                                                                        10974999
      *---------------------------------------------------------------* 10975099
      *    CURSOR TO GET TRANSFER ITEMS FOR A RETAIL TRANSFER.        * 10975199
      *---------------------------------------------------------------* 10975299
                                                                        10975399
           EXEC SQL                                                     10975499
                DECLARE RTL-ITEM-CSR CURSOR                             10975599
                FOR SELECT                                              10975699
                      XFER_LNE_NBR                                      10975799
                     ,CPLD_RTL_PRIC_AMT                                 10975899
                     ,SCN_UPC_NBR                                       10975999
                     ,KOHLS_UPC_NBR                                     10976099
                     ,ITM_NBR                                           10976199
                     ,XFER_PRIC_AMT                                     10976299
                     ,XFER_QTY                                          10976399
                FROM  TTFITEM                                           10976499
               WHERE  XFER_DKEY_ID   = :DK-XFER-DKEY-ID                 10976599
               ORDER BY  XFER_LNE_NBR                                   10976699
                WITH UR                                                 10976799
                                                                        10976899
           END-EXEC.                                                    10976999
                                                                        10977099
      *---------------------------------------------------------------* 10977199
      *    CURSOR TO GET TRANSFER ITEMS FOR A NON-RETAIL TRANSFER.    * 10977299
      *---------------------------------------------------------------* 10977399
                                                                        10977499
           EXEC SQL                                                     10977599
                DECLARE NRTL-ITEM-CSR CURSOR                            10977699
                FOR SELECT                                              10977799
                      XFER_LNE_NBR                                      10977899
                     ,NRTL_1ST_LNE_DESC                                 10977999
                     ,NRTL_2ND_LNE_DESC                                 10978099
                     ,NRTL_FIXT_ID                                      10978199
                     ,NRTL_DEPT_NBR                                     10978299
                     ,XFER_QTY                                          10978399
                FROM  TTFITEM                                           10978499
               WHERE  XFER_DKEY_ID   = :DK-XFER-DKEY-ID                 10978599
               ORDER BY  XFER_LNE_NBR                                   10978699
                WITH UR                                                 10978799
                                                                        10978899
           END-EXEC.                                                    10978999
                                                                        10979099
                                                                        10979199
       EJECT                                                            10979299
       LINKAGE SECTION.                                                 10979399
                                                                        10979499
       01  DFHCOMMAREA.                                                 10980099
           05  FILLER                         OCCURS  1 TO 4072 TIMES   10990099
                                              DEPENDING ON EIBCALEN.    11000099
               10  FILLER                     PIC X.                    11010099
                                                                        11020099
       EJECT                                                            11030099
       PROCEDURE DIVISION.                                              11040099
      ******************************************************************11050099
      **  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **11060099
      **  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **11070099
      **  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **11080099
      ******************************************************************11090099
       0000-MAIN-MODULE.                                                11100099
           INITIALIZE DP030-CICS-API-FIELDS.                            11110099
           MOVE +1                       TO DP030-NUMBER-OF-MAPS.       11120099
           MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          11130099
           MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         11140099
           SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       11150099
           MOVE LENGTH OF TF444AI        TO DP030-MAP-LENGTH (1).       11160099
           MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     11170099
           PERFORM 0001-CALL-CICS-ARCH-API.                             11180099
                                                                        11190099
           PERFORM 1000-CONTROL-PROCESSING                              11200099
                                                                        11210099
           MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     11220099
           PERFORM 0001-CALL-CICS-ARCH-API.                             11230099
                                                                        11240099
      ******************************************************************11250099
      **  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **11260099
      **  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **11270099
      ******************************************************************11280099
       0001-CALL-CICS-ARCH-API.                                         11290099
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      11300099
                                          DFHCOMMAREA                   11310099
                                          DP030-CICS-API-FIELDS         11320099
                                          DP020-STANDARD-COMMAREA       11330099
                                          TF444AI.                      11340099
      *                                                                 11350099
           IF  DP030-RC-CALL-SUCCESSFUL                                 11360099
               CONTINUE                                                 11370099
           ELSE                                                         11380099
               SET DP013-NO-ROLLBACK                                    11390099
                   DP013-XCTL-DISPLAY-RESTART                           11400099
                   DP013-CICS-ABEND      TO TRUE                        11410099
               MOVE '0001-CALL-CICS-ARCH-API'                           11420099
                                         TO DP013-PARAGRAPH             11430099
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O11431099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      11432099
               MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      11460099
               PERFORM DP013-0000-PROCESS-ABEND                         11470099
           END-IF.                                                      11480099
      *----------------------------------------------------------------*11490099
      * PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *11500099
      * COURSE OF ACTION IS FOR THIS TRANSACTION.                      *11510099
      *                                                                *11520099
      * NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *11530099
      *  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *11540099
      *  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *11550099
      *  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *11560099
      *----------------------------------------------------------------*11570099
                                                                        11580099
       1000-CONTROL-PROCESSING.                                         11590099
                                                                        11600099
           EVALUATE TRUE                                                11610099
               WHEN DP020-NEXT-ACT-INITIAL                              11620099
                   INITIALIZE ASC-SPECIFIC-COMMAREA                     11630099
                   MOVE EIBTRMID         TO ASC-LIST-TERM-ID            11640099
                                            ASC-SEL-TERM-ID             11650099
                   MOVE DP020-SRC-TASK-NUMBER                           11660099
                                         TO ASC-LIST-TASK-NUMBER        11670099
                                            ASC-SEL-TASK-NUMBER         11680099
                   MOVE PC-LIST-QUEUE-SEQ                               11690099
                                         TO ASC-LIST-SEQ                11700099
                   MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 11710099
                   PERFORM 1100-PROCESS-INTER-APPL-COMM                 11720099
                   IF  PS-COMMAREA-NOT-VALID                            11730099
                       SET DP020-NEXT-ACT-APPL-ERROR                    11740099
                                         TO TRUE                        11750099
                   ELSE                                                 11760099
                       PERFORM 4000-BUILD-INITIAL-PANEL                 11770099
                   END-IF                                               11780099
                                                                        11790099
               WHEN DP020-NEXT-ACT-READ-MAP                             11800099
                   MOVE ASC-ITEM-AT-TOP-OF-PANEL                        11810099
                                         TO PV-TOP-ITEM                 11820099
                   PERFORM 2000-PROCESS-PANEL                           11830099
                                                                        11840099
               WHEN DP020-NEXT-ACT-RETURN                               11850099
                   MOVE ASC-ITEM-AT-TOP-OF-PANEL                        11860099
                                             TO PV-TOP-ITEM             11870099
                   MOVE ZERO        TO ASC-ITEM-AT-TOP-OF-PANEL         11870199
                   IF ASC-PRT-WKSHT-REQUESTED      AND                  11870299
                         TF001-PRINT-YES            AND                 11870399
                         TF001-PRINTER-DEST NOT = SPACES                11870499
                       MOVE PC-TSYMSG-00098  TO DP020-MSG-NUMBER        11870599
                       SET DP020-MSG-INFORMATIONAL  TO TRUE             11870699
                   ELSE                                                 11870799
                       IF ASC-PRT-DOC-REQUESTED    AND                  11870899
                             TF001-PRINT-DOC                            11870999
                           IF ASC-DO-NOT-SHIP                           11871099
                               MOVE PC-TSYMSG-01680 TO DP020-MSG-NUMBER 11872099
                           ELSE                                         11872199
                               MOVE PC-TSYMSG-01495 TO DP020-MSG-NUMBER 11872299
                           END-IF                                       11872399
                           MOVE ASC-XFER-FR-STR  TO                     28400499
                                               PV-DISP-FROM-STORE-NBR   28400599
                           MOVE ASC-XFER-SEQ-NBR TO PV-DISP-SEQ-NBR     28400699
                           MOVE PV-DISP-XFER-NBR TO DP020-MSG-TEXT      28401099
                           SET DP020-MSG-INFORMATIONAL TO TRUE          28402099
                       ELSE                                             28403099
                           PERFORM 6000-REFRESH-PANEL-FROM-TEMP         28404099
                           PERFORM 3000-EDIT-DATA-IN-COMMAREA           28405099
                       END-IF                                           28406099
                   END-IF                                               28407099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 28408099
                                                                        28409099
               WHEN OTHER                                               28410099
                   SET DP013-LOGIC-ABEND TO TRUE                        28420099
                   SET DP013-NO-ROLLBACK TO TRUE                        28430099
                   MOVE '1000-CONTROL-PROCESSING'                       28440099
                                         TO DP013-PARAGRAPH             28450099
                   MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    28460099
                                         TO DP013-MESSAGE-TEXT(1)       28470099
                   PERFORM DP013-0000-PROCESS-ABEND                     28480099
           END-EVALUATE.                                                28490099
                                                                        28500099
       EJECT                                                            28510099
      *----------------------------------------------------------------*28520099
      * DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA       *28530099
      *----------------------------------------------------------------*28540099
                                                                        28550099
       1100-PROCESS-INTER-APPL-COMM.                                    28560099
                                                                        28570099
           SET PS-COMMAREA-VALID         TO TRUE.                       28580099
           MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     28590099
                                                                        28600099
           MOVE TF001-XFER-TYPE          TO ASC-XFER-TYPE.              28610099
           MOVE TF001-CONTNR-TYPE        TO ASC-CONTNR-TYPE.            28620099
           MOVE TF001-XFER-TO-STR        TO ASC-XFER-TO-STR.            28630099
           MOVE TF001-XFER-DPT           TO ASC-XFER-DPT.               28640099
           MOVE TF001-XFER-CLASS         TO ASC-XFER-CLASS.             28650099
           MOVE TF001-XFER-CALLBACK-NBR  TO ASC-XFER-CALLBACK-NBR.      28660099
           MOVE TF001-XFER-APPROVAL-NBR  TO ASC-XFER-APPROVAL-NBR.      28670099
           MOVE TF001-XFER-COMP-BY-FIRST-INIT                           28680099
                                         TO ASC-XFER-COMP-BY-FIRST-INIT.28690099
           MOVE TF001-XFER-COMP-BY-LAST-NAME                            28700099
                                         TO ASC-XFER-COMP-BY-LAST-NAME. 28710099
           MOVE TF001-XFER-TYPE-SORT-NR  TO ASC-XFER-TYPE-SORT-NR.      28720099
           MOVE TF001-XFER-CONTNR-TYPE-SORT-NR                          28730099
                                         TO ASC-CONTNR-TYPE-SORT-NR.    28740099
           MOVE TF001-XFER-TO-STR-SORT-NR                               28750099
                                         TO ASC-XFER-TO-STR-SORT-NR.    28760099
           MOVE TF001-XFER-FROM-STR      TO ASC-XFER-FR-STR.            28770099
           MOVE TF001-FR-STR-OVRRID-IND  TO ASC-FR-STR-OVRRID-IND.      28780099
                                                                        28790099
       EJECT                                                            28800099
      *----------------------------------------------------------------*28810099
      * DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *28820099
      * ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *28830099
      * USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *28840099
      * OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *28850099
      * FUNCTION KEYS CAN GET THIS FAR.                                *28860099
      *----------------------------------------------------------------*28870099
                                                                        28880099
       2000-PROCESS-PANEL.                                              28890099
           EVALUATE TRUE                                                28900099
               WHEN DP020-SRC-AID = DP016-CLEAR                         28910099
                   MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    28920099
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   28930099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 28940099
                                                                        28950099
               WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    28960099
                   PERFORM 2050-DELETE-LIST-QUEUE                       28970099
                   PERFORM 4000-BUILD-INITIAL-PANEL                     28980099
                                                                        28990099
               WHEN OTHER                                               29000099
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 29010099
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   29020099
                   IF  PS-NO-ERROR                                      29030099
                       SET DP030-CONTINUE-GO                            29040099
                                       TO TRUE                          29050099
                       PERFORM 2100-CHECK-FUNCTION-KEY                  29060099
                   ELSE                                                 29070099
                       SET DP030-OVERRIDE-GO                            29080099
                                       TO TRUE                          29090099
                   END-IF                                               29100099
           END-EVALUATE.                                                29110099
       EJECT                                                            29120099
      *----------------------------------------------------------------*29130099
      *  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *29140099
      *----------------------------------------------------------------*29150099
       2050-DELETE-LIST-QUEUE.                                          29160099
                                                                        29170099
           EXEC CICS                                                    29180099
               DELETEQ TS                                               29190099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          29200099
                   RESP  (PV-CICS-RESP)                                 29210099
           END-EXEC.                                                    29220099
                                                                        29230099
           IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       29240099
              (PV-CICS-RESP = DFHRESP(QIDERR))                          29250099
               CONTINUE                                                 29260099
           ELSE                                                         29270099
               SET DP013-CICS-ABEND      TO TRUE                        29280099
               SET DP013-NO-ROLLBACK     TO TRUE                        29290099
                                                                        29300099
               MOVE '2050-DELETE-LIST-QUEUE'                            29310099
                                         TO DP013-PARAGRAPH             29320099
               MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    29330099
                                         TO DP013-MESSAGE-TEXT (1)      29340099
               PERFORM DP013-0000-PROCESS-ABEND                         29350099
           END-IF.                                                      29360099
                                                                        29370099
           MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  29380099
       EJECT                                                            29390099
      *----------------------------------------------------------------*29400099
      * ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*29410099
      * NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *29420099
      * CICS ARCHITECTURE API.                                         *29430099
      *----------------------------------------------------------------*29440099
       2100-CHECK-FUNCTION-KEY.                                         29450099
           EVALUATE TRUE                                                29460099
      *----------  CTL INQ  --------------------------------------------29470099
               WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              29480099
      *----------  CTL MNT  --------------------------------------------29490099
               WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              29500099
                   MOVE SPACE            TO ASC-ACTION-SW               29510099
                   IF  ASC-NUMBER-OF-SELECTED-ITEMS = +1                29520099
                       PERFORM 5000-PREPARE-SEL-QUEUE                   29530099
                       PERFORM 5300-VERIFY-WORKSHEET-EXISTS             29540099
                       IF PS-WKSHT-FOUND                                29550099
                           INITIALIZE TF001-INTER-APPL-COMMAREA         29560099
                           MOVE ASC-SEL-CONTROL-NBR TO TF001-DKEY-ID    29570099
                           MOVE ASC-FROM-STORE   TO TF001-XFER-FROM-STR 29580099
                       ELSE                                             29590099
                           IF PS-WKSHT-COMPLETED                        29600099
                               MOVE SPACE            TO ASC-ACTION-SW   29610099
                               SET PS-ERROR                             29610199
                                   DP030-OVERRIDE-GO                    29610299
                                   DP020-MSG-FATAL TO TRUE              29610399
      *    -- WORKSHEET HAS BEEN COMPLETED --                           29610499
                               MOVE PC-TSYMSG-01487 TO DP020-MSG-NUMBER 29610599
                               MOVE ASC-FROM-STORE                      29610699
                                              TO PV-DISP-FROM-STORE-NBR 29610799
                               MOVE ASC-XFER-SEQ-NBR                    29610899
                                                    TO PV-DISP-SEQ-NBR  29610999
                               MOVE PV-DISP-XFER-NBR                    29611099
                                                    TO DP020-MSG-TEXT   29612099
                           ELSE                                         29613099
                               MOVE SPACE            TO ASC-ACTION-SW   29614099
                               SET PS-ERROR                             29614199
                                   DP030-OVERRIDE-GO                    29614299
                                   DP020-MSG-FATAL TO TRUE              29614399
      *     -- INVALID CONTROL NUMBER --                                29614499
                               MOVE PC-TSYMSG-01401 TO DP020-MSG-NUMBER 29614599
                           END-IF                                       29614699
                       END-IF                                           29614799
                   ELSE                                                 29614899
      *      -- A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION          29614999
                       MOVE SPACE            TO ASC-ACTION-SW           29615099
                       SET DP030-OVERRIDE-GO                            29616099
                           DP020-MSG-FATAL                              29617099
                           PS-ERROR         TO TRUE                     29618099
                       MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         29619099
                   END-IF                                               29620099
                                                                        29630099
      *----------  COMPLETE  -------------------------------------------29640099
               WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              29650099
                   IF PS-XFER-NBR-CHG                                   29660099
                       MOVE SPACE               TO ASC-ACTION-SW        29670099
                   END-IF                                               29680099
                   IF  ASC-NUMBER-OF-SELECTED-ITEMS = +1                29690099
                       PERFORM 5000-PREPARE-SEL-QUEUE                   29700099
                       PERFORM 5300-VERIFY-WORKSHEET-EXISTS             29710099
                       IF PS-WKSHT-FOUND                                29720099
                           PERFORM 2300-CHECK-COMPLETE                  29730099
                       ELSE                                             29740099
                           IF PS-WKSHT-COMPLETED                        29750099
                               MOVE SPACE            TO ASC-ACTION-SW   29760099
                               SET PS-ERROR                             29760199
                                   DP030-OVERRIDE-GO                    29760299
                                   DP020-MSG-FATAL TO TRUE              29760399
      *    -- WORKSHEET HAS BEEN COMPLETED --                           29760499
                               MOVE PC-TSYMSG-01487 TO DP020-MSG-NUMBER 29760599
                               MOVE ASC-FROM-STORE                      29760699
                                              TO PV-DISP-FROM-STORE-NBR 29760799
                               MOVE ASC-XFER-SEQ-NBR                    29760899
                                                    TO PV-DISP-SEQ-NBR  29760999
                               MOVE PV-DISP-XFER-NBR                    29761099
                                                    TO DP020-MSG-TEXT   29762099
                           ELSE                                         29763099
                               MOVE SPACE            TO ASC-ACTION-SW   29764099
                               SET PS-ERROR                             29764199
                                   DP030-OVERRIDE-GO                    29764299
                                   DP020-MSG-FATAL TO TRUE              29764399
      *     -- INVALID CONTROL NUMBER --                                29764499
                               MOVE PC-TSYMSG-01401 TO DP020-MSG-NUMBER 29764599
                           END-IF                                       29764699
                       END-IF                                           29764799
                   ELSE                                                 29764899
      *      -- A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION          29764999
                       MOVE SPACE            TO ASC-ACTION-SW           29765099
                       SET DP030-OVERRIDE-GO                            29766099
                           DP020-MSG-FATAL                              29767099
                           PS-ERROR         TO TRUE                     29768099
                       MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         29769099
                   END-IF                                               29770099
                                                                        29780099
      *----------  PRT WKST  -------------------------------------------29790099
               WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              29800099
                   MOVE SPACE            TO ASC-ACTION-SW               29810099
                   IF  ASC-NUMBER-OF-SELECTED-ITEMS = +1                29820099
                       PERFORM 5000-PREPARE-SEL-QUEUE                   29830099
                       PERFORM 5300-VERIFY-WORKSHEET-EXISTS             29840099
                       IF PS-WKSHT-FOUND                                29850099
                           INITIALIZE TF001-INTER-APPL-COMMAREA         29860099
080204                     MOVE ASC-XFER-FR-STR   TO RFWS009-STORE-NBR  29870099
080204                     MOVE RFWS009-STORE-PRINTER-DEST              29871099
080204                                            TO TF001-PRINTER-DEST 29872099
                           MOVE ASC-SEL-CONTROL-NBR TO TF001-DKEY-ID    29890099
                           SET ASC-PRT-WKSHT-REQUESTED  TO TRUE         29900099
                       ELSE                                             29910099
                           IF PS-WKSHT-COMPLETED                        29920099
                               SET PS-ERROR                             29920199
                                   DP030-OVERRIDE-GO                    29920299
                                   DP020-MSG-FATAL TO TRUE              29920399
      *     -- WORKSHEET HAS BEEN COMPLETED --                          29920499
                               MOVE PC-TSYMSG-01487 TO DP020-MSG-NUMBER 29920599
                               MOVE ASC-FROM-STORE                      29920699
                                              TO PV-DISP-FROM-STORE-NBR 29920799
                               MOVE ASC-XFER-SEQ-NBR                    29920899
                                                    TO PV-DISP-SEQ-NBR  29920999
                               MOVE PV-DISP-XFER-NBR                    29921099
                                                    TO DP020-MSG-TEXT   29922099
                           ELSE                                         29923099
                               SET PS-ERROR                             29923199
                                   DP030-OVERRIDE-GO                    29923299
                                   DP020-MSG-FATAL TO TRUE              29923399
      *      -- INVALID CONTROL NUMBER --                               29923499
                               MOVE PC-TSYMSG-01401 TO DP020-MSG-NUMBER 29923599
                           END-IF                                       29923699
                       END-IF                                           29923799
                   ELSE                                                 29923899
      *    -- A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION            29923999
                       SET DP030-OVERRIDE-GO                            29924099
                           DP020-MSG-FATAL                              29925099
                           PS-ERROR         TO TRUE                     29926099
                       MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         29927099
                   END-IF                                               29928099
                                                                        29929099
               WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  29930099
                   MOVE SPACE               TO ASC-ACTION-SW            29940099
                   MOVE +1                  TO PV-TOP-ITEM              29950099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 29960099
                                                                        29970099
               WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   29980099
                   MOVE SPACE               TO ASC-ACTION-SW            29990099
                   PERFORM 2110-BROWSE-BACKWARD                         30000099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 30010099
                                                                        30020099
               WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   30030099
                   MOVE SPACE               TO ASC-ACTION-SW            30040099
                   PERFORM 2120-BROWSE-FORWARD                          30050099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 30060099
                                                                        30070099
               WHEN DP020-SRC-AID = DP016-ENTER                         30080099
                   MOVE SPACE               TO ASC-ACTION-SW            30090099
                   PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   30100099
                   IF  PS-ERROR                                         30110099
                       CONTINUE                                         30120099
                   ELSE                                                 30130099
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             30140099
                   END-IF                                               30150099
                                                                        30160099
               WHEN OTHER                                               30170099
                   SET DP013-NO-ROLLBACK                                30180099
                       DP013-XCTL-DISPLAY-RESTART                       30190099
                       DP013-CICS-ABEND  TO TRUE                        30200099
                   MOVE '2100-CHECK-FUNCTION-KEY'                       30210099
                                         TO DP013-PARAGRAPH             30220099
                   MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      30230099
                                         TO DP013-MESSAGE-TEXT (1)      30240099
                   PERFORM DP013-0000-PROCESS-ABEND                     30250099
           END-EVALUATE.                                                30260099
      *                                                                 30270099
      *----------------------------------------------------------------*30280099
      *    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *30290099
      *    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *30300099
      *    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *30310099
      *    MESSAGE.                                                    *30320099
      *----------------------------------------------------------------*30330099
                                                                        30340099
       2110-BROWSE-BACKWARD.                                            30350099
           SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    30360099
               GIVING PV-TOP-ITEM.                                      30370099
      *                                                                 30380099
           IF  ((PV-TOP-ITEM < +1)                                      30390099
             OR (PV-TOP-ITEM = +1))                                     30400099
               MOVE +1                   TO PV-TOP-ITEM                 30410099
      *        -- TOP OF LIST --                                        30420099
               MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            30430099
               SET DP020-MSG-INFORMATIONAL TO TRUE                      30440099
           END-IF.                                                      30450099
                                                                        30460099
       EJECT                                                            30470099
      *----------------------------------------------------------------*30480099
      *    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *30490099
      *    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *30500099
      *    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *30510099
      *----------------------------------------------------------------*30520099
                                                                        30530099
       2120-BROWSE-FORWARD.                                             30540099
                                                                        30550099
           ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              30560099
               GIVING PV-TOP-ITEM.                                      30570099
           IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   30580099
               MOVE ASC-ITEM-AT-TOP-OF-PANEL                            30590099
                                         TO PV-TOP-ITEM                 30600099
      *        -- BOTTOM OF LIST --                                     30610099
               MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            30620099
               SET DP020-MSG-INFORMATIONAL                              30630099
                                         TO TRUE                        30640099
           ELSE                                                         30650099
               COMPUTE PV-BOTTOM-ITEM =                                 30660099
                   PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 30670099
               IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            30680099
      *            -- BOTTOM OF LIST --                                 30690099
                   MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            30700099
                   SET DP020-MSG-INFORMATIONAL                          30710099
                                         TO TRUE                        30720099
               END-IF                                                   30730099
           END-IF.                                                      30740099
       EJECT                                                            30750099
      *----------------------------------------------------------------*30760099
      *    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *30770099
      *    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *30780099
      *    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *30790099
      *    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *30800099
      *    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *30810099
      *    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *30820099
      *----------------------------------------------------------------*30830099
                                                                        30840099
       2130-CHECK-FOR-JUMP-BROWSE.                                      30850099
           SET PS-NO-ERROR               TO TRUE.                       30860099
           IF (ASC-START-ITEM-REQUEST = SPACE)                          30870099
               MOVE ASC-ITEM-AT-TOP-OF-PANEL                            30880099
                                         TO PV-TOP-ITEM                 30890099
           ELSE                                                         30900099
               MOVE ASC-START-ITEM-REQUEST                              30910099
                                         TO DP010I-UNEDITED-FIELD       30920099
               MOVE PC-ITEM-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS      30930099
               MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     30940099
               SET DP010I-NEGATIVE-NOT-ALLOWED                          30950099
                                         TO TRUE                        30960099
               CALL DP010I-NUMERIC-EDIT-ROUTINE                         30971099
                         USING DP010I-NUMERIC-EDIT-AREA                 30972099
                                                                        30980099
               IF  NOT DP010I-ERROR-DETECTED                            30990099
                   MOVE DP010I-NUMERIC-FIELD                            31000099
                                         TO  ASC-START-ITEM-REQUEST-N   31010099
                   IF  ASC-START-ITEM-REQUEST-N > ZERO                  31020099
                       IF  ASC-START-ITEM-REQUEST-N >                   31030099
                                                ASC-NUMBER-OF-ITEMS-READ31040099
                           MOVE SPACE TO ASC-START-ITEM-REQUEST         31050099
                           COMPUTE PV-TOP-ITEM =                        31060099
                                   ASC-NUMBER-OF-ITEMS-READ             31070099
                                   - PC-ITEMS-PER-PANEL + 1             31080099
                           IF  PV-TOP-ITEM < +1                         31090099
                               MOVE +1   TO PV-TOP-ITEM                 31100099
                               MOVE PC-TSYMSG-00070                     31110099
                                         TO DP020-MSG-NUMBER            31120099
                               SET DP020-MSG-INFORMATIONAL              31130099
                                         TO TRUE                        31140099
                           END-IF                                       31150099
                       ELSE                                             31160099
                           MOVE ASC-START-ITEM-REQUEST-N                31170099
                                         TO PV-TOP-ITEM                 31180099
                           MOVE SPACE    TO ASC-START-ITEM-REQUEST      31190099
                           COMPUTE PV-BOTTOM-ITEM =                     31200099
                               PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     31210099
                           IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ31220099
      *                        -- BOTTOM OF LIST --                     31230099
                               MOVE PC-TSYMSG-00070                     31240099
                                         TO DP020-MSG-NUMBER            31250099
                               SET DP020-MSG-INFORMATIONAL              31260099
                                         TO TRUE                        31270099
                           END-IF                                       31280099
                       END-IF                                           31290099
                   ELSE                                                 31300099
      *                --- VALUE OUT OF RANGE ----                      31310099
                       MOVE PC-TSYMSG-00101                             31320099
                                         TO DP020-MSG-NUMBER            31330099
                       MOVE -1           TO MR-STARTL                   31340099
                       SET DP030-SET-CURSOR-APPL-1                      31350099
                                         TO TRUE                        31360099
                       MOVE DP015-REVERSE                               31370099
                                         TO MR-STARTH                   31380099
                       MOVE DP015-RED    TO MR-STARTC                   31390099
                       MOVE DP015-UNP-NUM-BRT-MDT                       31400099
                                         TO MR-STARTA                   31410099
                       SET DP020-MSG-FATAL                              31420099
                                         TO TRUE                        31430099
                       SET PS-ERROR      TO TRUE                        31440099
                   END-IF                                               31450099
                                                                        31460099
               ELSE                                                     31470099
                   MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            31480099
                   MOVE -1               TO MR-STARTL                   31490099
                   SET DP030-SET-CURSOR-APPL-1 TO TRUE                  31500099
                   MOVE DP015-REVERSE    TO MR-STARTH                   31510099
                   MOVE DP015-RED        TO MR-STARTC                   31520099
                   MOVE DP015-UNP-NUM-BRT-MDT                           31530099
                                         TO MR-STARTA                   31540099
                   SET DP020-MSG-FATAL   TO TRUE                        31550099
                   SET PS-ERROR          TO TRUE                        31560099
               END-IF                                                   31570099
           END-IF.                                                      31580099
       EJECT                                                            31590099
      ******************************************************************31600099
      ** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **31610099
      ** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **31620099
      ******************************************************************31630099
       2200-MOVE-SCREEN-TO-COMMAREA.                                    31640099
                                                                        31650099
           MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             31660099
           MOVE +1                       TO PV-SUB.                     31670099
      *                                                                 31680099
           PERFORM 3100-SET-SUBSCRIPTS.                                 31690099
           IF  MR-STARTL > ZERO                                         31700099
               MOVE MR-START        TO ASC-START-ITEM-REQUEST           31710099
           ELSE                                                         31720099
               IF  MR-STARTA = DP015-ERASE-EOF                          31730099
                   INITIALIZE ASC-START-ITEM-REQUEST                    31740099
               END-IF                                                   31750099
           END-IF.                                                      31760099
           PERFORM 2210-MOVE-LINES-TO-COMMAREA                          31770099
               VARYING PV-SUB                                           31780099
               FROM 1 BY 1                                              31790099
               UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      31800099
      ******************************************************************31810099
      ** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**31820099
      ******************************************************************31830099
       2210-MOVE-LINES-TO-COMMAREA.                                     31840099
                                                                        31850099
           IF  MR-SELECTL (PV-SUB) > ZERO                               31860099
               SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             31870099
               MOVE MR-SELECTI (PV-SUB)                                 31880099
                                         TO ASC-TEMP-SELECTED-SW        31890099
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      31900099
           ELSE                                                         31910099
               IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                31920099
                       SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     31930099
                       MOVE SPACE        TO ASC-TEMP-SELECTED-SW        31940099
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      31950099
               END-IF                                                   31960099
           END-IF.                                                      31970099
                                                                        31980099
           ADD +1                        TO ASC-ITEM-SUB.               31990099
                                                                        32000099
           IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        32010099
               ADD +1                    TO ASC-BLK-SUB                 32020099
               MOVE +1                   TO ASC-ITEM-SUB                32030099
           END-IF.                                                      32040099
                                                                        32050099
      ******************************************************************32060099
      * READ THE DATA FOR THE SELECTED WORKSHEET AND BUILD THE ARRAY   *32070099
      * IN PREPARATION FOR COMPLETING THE TRANSFER.                    *32080099
      ******************************************************************32090099
       2300-CHECK-COMPLETE.                                             32090199
           MOVE ASC-SEL-CONTROL-NBR      TO DK-XFER-DKEY-ID.            32090299
           MOVE +0                       TO ASC-NBR-OF-LINES-ENTERED.   32090399
           PERFORM 6200-GET-CONTROL-INFO.                               32090499
           PERFORM 3150-EDIT-DATA-IN-COMMAREA                           32090599
           IF PS-ERROR                                                  32090699
               SET ASC-PROBLEM-EXISTS  TO TRUE                          32090799
           END-IF                                                       32090899
           IF ASC-PROBLEM-EXISTS                                        32090999
               MOVE SPACE      TO ASC-ACTION-SW                         32091099
               MOVE PC-TSYMSG-01488       TO DP020-MSG-NUMBER           32091199
               SET DP020-MSG-FATAL                                      32091299
                   DP030-OVERRIDE-GO      TO TRUE                       32091399
               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     32091499
           ELSE                                                         32091599
               IF ASC-NBR-OF-LINES-ENTERED = 0                          32091699
                   MOVE SPACE      TO ASC-ACTION-SW                     32091799
                   MOVE PC-TSYMSG-01483    TO DP020-MSG-NUMBER          32091899
                   SET DP020-MSG-FATAL                                  32091999
                       DP030-OVERRIDE-GO  TO TRUE                       32092099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 32092199
               ELSE                                                     32092299
                   IF ASC-COMPLETE-REQUESTED                            32092399
                       IF PS-XFER-NBR-CHG                               32092499
                           SET ASC-COMPLETE-REQUESTED TO TRUE           32092599
                           MOVE PC-TSYMSG-01403 TO DP020-MSG-NUMBER     32092699
                           MOVE 'F23-COMPLETE'   TO DP020-MSG-TEXT      32092799
                           SET DP020-MSG-INFORMATIONAL                  32092899
                               DP030-OVERRIDE-GO      TO TRUE           32092999
                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         32093099
                       ELSE                                             32094099
      *  TRANSFER DATA MUST BE RE-READ BEFORE COMPLETING BECAUSE THE    32095099
      *  COMMAREA IS NOT LARGE ENOUGH TO HOLD THE DETAIL                32095199
                           PERFORM 6200-GET-CONTROL-INFO                32095299
                           PERFORM 7000-COMPLETE-TRANSFER               32095399
                           INITIALIZE TF001-INTER-APPL-COMMAREA         32095499
080204                     MOVE ASC-XFER-FR-STR  TO RFWS009-STORE-NBR   32095599
                                                    PV-FROM-STORE-NBR   32095699
                           MOVE ASC-XFER-SEQ-NBR TO PV-SEQ-NBR          32095799
                           MOVE PV-XFER-NBR      TO TF001-XFER-NBR      32095899
080204                     MOVE RFWS009-STORE-PRINTER-DEST              32095999
080204                                           TO TF001-PRINTER-DEST  32096099
                           SET ASC-PRT-DOC-REQUESTED TO TRUE            32097099
                       END-IF                                           32097199
                   ELSE                                                 32097299
                       SET ASC-COMPLETE-REQUESTED TO TRUE               32097399
                       MOVE PC-TSYMSG-01403 TO DP020-MSG-NUMBER         32097499
                       MOVE 'F23-COMPLETE'   TO DP020-MSG-TEXT          32097599
                       SET DP020-MSG-INFORMATIONAL                      32097699
                           DP030-OVERRIDE-GO      TO TRUE               32097799
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             32097899
                   END-IF                                               32097999
               END-IF                                                   32098099
           END-IF.                                                      32099099
      ******************************************************************32100099
      ** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **32110099
      ** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **32120099
      ******************************************************************32130099
       3000-EDIT-DATA-IN-COMMAREA.                                      32140099
                                                                        32150099
           SET PS-NO-ERROR               TO TRUE.                       32160099
           PERFORM 3200-RESET-ATTRIBUTES.                               32170099
           MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     32180099
                                                                        32190099
           COMPUTE PV-ITEM-IN-USE =  PV-TOP-ITEM +                      32200099
               ASC-ITEMS-DISPLAYED - 1.                                 32210099
           PERFORM 3100-SET-SUBSCRIPTS.                                 32220099
           PERFORM 3050-EDIT-SELECTIONS                                 32230099
              VARYING PV-SUB                                            32240099
              FROM PV-SUB BY -1                                         32250099
              UNTIL PV-SUB < +1.                                        32260099
                                                                        32270099
           IF ASC-NUMBER-OF-SELECTED-ITEMS > +1                         32280099
             AND PS-NO-ERROR                                            32290099
      **       -- ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNCTION -32300099
               SET DP030-OVERRIDE-GO                                    32310099
                   DP020-MSG-FATAL                                      32320099
                   PS-ERROR             TO TRUE                         32330099
               MOVE PC-TSYMSG-00047     TO DP020-MSG-NUMBER             32340099
           END-IF.                                                      32350099
                                                                        32360099
       EJECT                                                            32370099
      ******************************************************************32380099
      ** EDIT THE SELECTION MADE. NOTE THAT THE SELECTED SW IS        **32390099
      ** WHAT WAS PREVIOUSLY CHECKED AND CORREC 'TEMP-SELECTED-SW'    **32400099
      ** IS WHAT HAS JUST BE ENTERED AND HAS NOT BEEN EDITED OR       **32410099
      ** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **32420099
      ******************************************************************32430099
                                                                        32440099
       3050-EDIT-SELECTIONS.                                            32450099
                                                                        32460099
           EVALUATE TRUE                                                32470099
               WHEN ASC-TEMP-SELECTED-SW(ASC-BLK-SUB ASC-ITEM-SUB)      32480099
                   = ASC-SELECTED-SW    (ASC-BLK-SUB ASC-ITEM-SUB)      32490099
                       CONTINUE                                         32500099
               WHEN ASC-TEMP-SELECT     (ASC-BLK-SUB ASC-ITEM-SUB)      32510099
                   IF NOT ASC-SELECT    (ASC-BLK-SUB ASC-ITEM-SUB)      32520099
                      ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS    32530099
                      MOVE ASC-TEMP-SELECTED-SW                         32540099
                                         (ASC-BLK-SUB ASC-ITEM-SUB)     32550099
                                     TO ASC-SELECTED-SW                 32560099
                                         (ASC-BLK-SUB ASC-ITEM-SUB)     32570099
                   END-IF                                               32580099
               WHEN ASC-TEMP-SELECTED-SW(ASC-BLK-SUB ASC-ITEM-SUB)      32590099
                   = SPACE                                              32600099
                   IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             32610099
                      SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     32620099
                      MOVE SPACES TO ASC-SELECTED-SW                    32630099
                                         (ASC-BLK-SUB ASC-ITEM-SUB)     32640099
                   END-IF                                               32650099
              WHEN OTHER                                                32660099
      *           -- INVALID VALUE --                                   32670099
                  MOVE PC-TSYMSG-00005       TO DP020-MSG-NUMBER        32680099
                  SET DP020-MSG-FATAL        TO TRUE                    32690099
                  MOVE -1                    TO MR-SELECTL (PV-SUB)     32700099
                  SET DP030-SET-CURSOR-APPL-1 TO TRUE                   32710099
                  MOVE DP015-RED              TO MR-SELECTC (PV-SUB)    32720099
                  MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)    32730099
                  SET PS-ERROR                TO TRUE                   32740099
                  IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              32750099
                     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS       32760099
                     MOVE SPACE               TO ASC-SELECTED-SW        32770099
                                           (ASC-BLK-SUB ASC-ITEM-SUB)   32780099
                  END-IF                                                32790099
           END-EVALUATE.                                                32800099
                                                                        32810099
           SUBTRACT +1 FROM  PV-ITEM-IN-USE.                            32820099
           SUBTRACT +1 FROM ASC-ITEM-SUB.                               32830099
           IF ASC-ITEM-SUB < 1                                          32840099
              SUBTRACT +1 FROM ASC-BLK-SUB                              32850099
              MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                   32860099
           END-IF.                                                      32870099
                                                                        32880099
       EJECT                                                            32890099
      *----------------------------------------------------------------*32900099
      *    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *32910099
      *    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*32920099
      *    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *32930099
      *                                                                *32940099
      *    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *32950099
      *    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *32960099
      *    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *32970099
      *    US IN THE 2ND BLOCK OF THE ARRAY.                           *32980099
      *----------------------------------------------------------------*32990099
                                                                        33000099
       3100-SET-SUBSCRIPTS.                                             33010099
                                                                        33020099
           COMPUTE ASC-ITEM-SUB =                                       33030099
               (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        33040099
                                                                        33050099
           IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         33060099
               SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            33070099
                                                                        33080099
               MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               33090099
           ELSE                                                         33100099
               MOVE +1                     TO ASC-BLK-SUB               33110099
           END-IF.                                                      33110199
      ******************************************************************33110299
      ** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **33110399
      ** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **33110499
      ******************************************************************33110599
       3150-EDIT-DATA-IN-COMMAREA.                                      33110699
051705     SET ASC-OK-TO-SHIP          TO TRUE.                         33110799
           SET PS-NO-ERROR               TO TRUE.                       33110899
           PERFORM 3300-EDIT-HEADER-INFO.                               33110999
           IF ASC-CMPLT-XFER-TYPE NOT = PC-NON-RETAIL                   33111099
               PERFORM 3400-EDIT-RTL-DETAIL-INFO                        33112099
                 VARYING PW-ITEM-SUB                                    38341499
                   FROM 1 BY 1                                          38341599
                   UNTIL PW-ITEM-SUB >   PC-MAX-RETAIL-ITEMS            38341699
           ELSE                                                         38341799
               PERFORM 3450-EDIT-NRTL-DETAIL-INFO                       38341899
                 VARYING PW-ITEM-SUB                                    38341999
                   FROM 1 BY 1                                          38342099
                   UNTIL PW-ITEM-SUB >   PC-MAX-NON-RETAIL-ITEMS        38342199
           END-IF.                                                      38342299
051705******************************************************************38342399
051705** IF NO OTHER EDIT ERRORS, CHECK INVENTORY DATE.               **38342499
051705******************************************************************38342599
051705*    IF PS-NO-ERROR                                        AND    38342699
051705*       ASC-CMPLT-XFER-TYPE          NOT = PC-NON-RETAIL   AND    38342799
051705*       ASC-CMPLT-XFER-TYPE          NOT = PC-OFFSITE-STORAGE     38342899
051705*        PERFORM 3380-GET-CUR-DATE                                38342999
051705*        PERFORM 4520-READ-CONTROL-TABLE                          38343099
051705*        IF PV-PHY-INV-PERD-IND = PC-YES                          38343199
051705*            PERFORM 4530-CHECK-INVENTORY                         38343299
051705*        END-IF                                                   38343399
051705*    END-IF.                                                      38343499
051705*                                                                 38343599
051705*EJECT                                                            38343699
      ******************************************************************38343799
      ** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **38343899
      ******************************************************************38343999
                                                                        38344099
       3200-RESET-ATTRIBUTES.                                           38345099
           MOVE DP015-UNP-ALP-NOR-OFF    TO MR-STARTA.                  38346099
           MOVE DP015-GREEN              TO MR-STARTC.                  38347099
           MOVE DP015-UNDERLINE          TO MR-STARTH.                  38348099
      *                                                                 38349099
           PERFORM                                                      38350099
               VARYING PV-SUB                                           38360099
               FROM 1 BY 1                                              38370099
               UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        38380099
               IF PV-SUB > ASC-ITEMS-DISPLAYED                          38390099
                   MOVE DP015-ASK-DRK-OFF                               38400099
                                       TO MR-SELECTA (PV-SUB)           38410099
                   MOVE DP015-HL-OFF   TO MR-SELECTH (PV-SUB)           38420099
               ELSE                                                     38430099
                   MOVE DP015-UNP-ALP-NOR-OFF                           38440099
                                         TO MR-SELECTA (PV-SUB)         38450099
                   MOVE DP015-GREEN      TO MR-SELECTC (PV-SUB)         38460099
                   MOVE DP015-UNDERLINE  TO MR-SELECTH (PV-SUB)         38470099
               END-IF                                                   38480099
           END-PERFORM.                                                 38480199
      ******************************************************************38480299
      ** EDIT THE HEADING INFORMATION.                                **38480399
      ******************************************************************38480499
       3300-EDIT-HEADER-INFO.                                           38480599
           IF PW-TO-STORE      NOT > SPACES                             38480699
               IF PS-NO-ERROR                                           38480799
                   SET PS-ERROR           TO TRUE                       38480899
               END-IF                                                   38480999
           ELSE                                                         38481099
               IF PW-TO-STORE      = ASC-XFER-FR-STR                    38481199
                   IF PS-NO-ERROR                                       38481299
                      SET  PS-ERROR           TO TRUE                   38481399
                   END-IF                                               38481499
               ELSE                                                     38481599
                   MOVE PW-TO-STORE-N         TO DK-STORE-NBR           38481699
                   SET PS-STORE-NOT-FOUND     TO TRUE                   38481799
                   PERFORM 4500-READ-STORE                              38481899
                   IF PS-STORE-NOT-FOUND                                38481999
                       IF PS-NO-ERROR                                   38482099
                           SET PS-ERROR           TO TRUE               38482199
                       END-IF                                           38482299
                   ELSE                                                 38482399
                     EVALUATE ASC-CMPLT-XFER-TYPE                       38482499
111703*                WHEN PC-DEFECTIVE-DAMAGE                         38482599
111703                 WHEN PC-DEFECTIVE-DAMAGE-SORT1                   38482699
111703                 WHEN PC-DEFECTIVE-DAMAGE-SORT2                   38482799
                       WHEN PC-CALLBACK                                 38482899
                         IF PW-TO-STORE-TYPE NOT = PC-RTV-TYPE          38482999
                           IF PS-NO-ERROR                               38483099
                               SET PS-ERROR           TO TRUE           38483199
                           END-IF                                       38483299
                         END-IF                                         38483399
                       WHEN PC-NON-RETAIL                               38483499
                         IF PW-TO-STORE-TYPE NOT = PC-STORE-TYPE  AND   38483599
                            PW-TO-STORE-TYPE NOT = PC-DC                38483699
                           IF PS-NO-ERROR                               38483799
                               SET PS-ERROR           TO TRUE           38483899
                           END-IF                                       38483999
                         END-IF                                         38484099
                       WHEN OTHER                                       38484199
                         IF PW-TO-STORE-TYPE NOT = PC-STORE-TYPE        38484299
                           IF PS-NO-ERROR                               38484399
                               SET PS-ERROR           TO TRUE           38484499
                           END-IF                                       38484599
                         END-IF                                         38484699
                     END-EVALUATE                                       38484799
                   END-IF                                               38484899
               END-IF                                                   38484999
           END-IF.                                                      38485099
           EVALUATE ASC-CMPLT-XFER-TYPE                                 38485199
111703*        WHEN PC-DEFECTIVE-DAMAGE                                 38485299
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT1                           38485399
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT2                           38485499
               WHEN PC-STOCK-BAL-STORE                                  38485599
                   PERFORM 3310-EDIT-DEF-DAMAGE                         38485699
               WHEN PC-CALLBACK                                         38485799
                   PERFORM 3320-EDIT-CALLBACK                           38485899
               WHEN PC-STOCK-BAL-CORP                                   38485999
                   PERFORM 3330-EDIT-STOCK-BAL-CORP                     38486099
               WHEN PC-CUSTOMER                                         38486199
                   PERFORM 3340-EDIT-CUSTOMER                           38486299
               WHEN PC-NON-RETAIL                                       38486399
                   PERFORM 3350-EDIT-NON-RETAIL                         38486499
           END-EVALUATE.                                                38486599
           EVALUATE PW-CONTNR-TYPE                                      38486699
               WHEN PC-TRAILER                                          38486799
                   PERFORM 3360-EDIT-TRAILER                            38486899
               WHEN PC-SECURE-TOTE                                      38486999
                   PERFORM 3370-EDIT-TOTE                               38487099
           END-EVALUATE.                                                38487199
                                                                        38487299
      ******************************************************************38487399
      ** EDIT THE HEADING INFO FOR DEFECTIVE/DAMAGE OR STOCK BAL-STORE *38487499
      ******************************************************************38487599
       3310-EDIT-DEF-DAMAGE.                                            38487699
           IF PW-COMP-BY-INT NOT > SPACES                               38487799
               IF PS-NO-ERROR                                           38487899
                   SET PS-ERROR           TO TRUE                       38487999
               END-IF                                                   38488099
           END-IF                                                       38488199
           IF PW-COMP-BY-NAM NOT > SPACES                               38488299
               IF PS-NO-ERROR                                           38488399
                   SET PS-ERROR           TO TRUE                       38488499
               END-IF                                                   38488599
           END-IF.                                                      38488699
      ******************************************************************38488799
      ** EDIT THE HEADING INFO FOR CALLBACK TRANSFERS.                **38488899
      ******************************************************************38488999
       3320-EDIT-CALLBACK.                                              38489099
           IF PW-COMP-BY-INT NOT > SPACES                               38489199
               IF PS-NO-ERROR                                           38489299
                   SET PS-ERROR           TO TRUE                       38489399
               END-IF                                                   38489499
           END-IF                                                       38489599
           IF PW-COMP-BY-NAM NOT > SPACES                               38489699
               IF PS-NO-ERROR                                           38489799
                   SET PS-ERROR           TO TRUE                       38489899
               END-IF                                                   38489999
           END-IF                                                       38490099
           IF PW-CALLBACK-NBR NOT > ZEROES                              38490199
               IF PS-NO-ERROR                                           38490299
                   SET PS-ERROR           TO TRUE                       38490399
               END-IF                                                   38490499
           END-IF.                                                      38490599
      ******************************************************************38490699
      ** EDIT THE HEADING INFO FOR STOCK BALANCE - CORP TRANSFERS.    **38490799
      ******************************************************************38490899
       3330-EDIT-STOCK-BAL-CORP.                                        38490999
           IF PW-COMP-BY-INT NOT > SPACES                               38491099
               IF PS-NO-ERROR                                           38491199
                   SET PS-ERROR           TO TRUE                       38491299
               END-IF                                                   38491399
           END-IF                                                       38491499
           IF PW-COMP-BY-NAM NOT > SPACES                               38491599
               IF PS-NO-ERROR                                           38491699
                   SET PS-ERROR           TO TRUE                       38491799
               END-IF                                                   38491899
           END-IF                                                       38491999
           IF PW-APPROVAL-NBR NOT > ZEROES                              38492099
               IF PS-NO-ERROR                                           38492199
                   SET PS-ERROR           TO TRUE                       38492299
               END-IF                                                   38492399
           END-IF.                                                      38492499
      ******************************************************************38492599
      ** EDIT THE HEADING INFO FOR CUSTOMER TRANSFERS.                **38492699
      ******************************************************************38492799
       3340-EDIT-CUSTOMER.                                              38492899
           IF PW-COMP-BY-INT NOT > SPACES                               38492999
               IF PS-NO-ERROR                                           38493099
                   SET PS-ERROR           TO TRUE                       38493199
               END-IF                                                   38493299
           END-IF                                                       38493399
           IF PW-COMP-BY-NAM NOT > SPACES                               38493499
               IF PS-NO-ERROR                                           38493599
                   SET PS-ERROR           TO TRUE                       38493699
               END-IF                                                   38493799
           END-IF                                                       38493899
           IF PW-REQ-BY-INT NOT > SPACES                                38493999
               IF PS-NO-ERROR                                           38494099
                   SET PS-ERROR           TO TRUE                       38494199
               END-IF                                                   38494299
           END-IF                                                       38494399
           IF PW-REQ-BY-NAM NOT > SPACES                                38494499
               IF PS-NO-ERROR                                           38494599
                   SET PS-ERROR           TO TRUE                       38494699
               END-IF                                                   38494799
           END-IF                                                       38494899
           IF PW-CUST-NAME NOT > SPACES                                 38494999
               IF PS-NO-ERROR                                           38495099
                   SET PS-ERROR           TO TRUE                       38495199
               END-IF                                                   38495299
           END-IF.                                                      38495399
           IF PW-PHONE-NBR NOT > SPACES                                 38495499
               IF PS-NO-ERROR                                           38495599
                   SET PS-ERROR           TO TRUE                       38495699
               END-IF                                                   38495799
           END-IF.                                                      38495899
      ******************************************************************38495999
      ** EDIT THE HEADING INFO FOR NON-RETAIL TRANSFERS.              **38496099
      ******************************************************************38496199
       3350-EDIT-NON-RETAIL.                                            38496299
           IF PW-COMP-BY-INT NOT > SPACES                               38496399
               IF PS-NO-ERROR                                           38496499
                   SET PS-ERROR           TO TRUE                       38496599
               END-IF                                                   38496699
           END-IF                                                       38496799
           IF PW-COMP-BY-NAM NOT > SPACES                               38496899
               IF PS-NO-ERROR                                           38496999
                   SET PS-ERROR           TO TRUE                       38497099
               END-IF                                                   38497199
           END-IF                                                       38497299
           IF PW-REQ-BY-INT NOT > SPACES                                38497399
               IF PS-NO-ERROR                                           38497499
                   SET PS-ERROR           TO TRUE                       38497599
               END-IF                                                   38497699
           END-IF                                                       38497799
           IF PW-REQ-BY-NAM NOT > SPACES                                38497899
               IF PS-NO-ERROR                                           38497999
                   SET PS-ERROR           TO TRUE                       38498099
               END-IF                                                   38498199
           END-IF.                                                      38498299
      ******************************************************************38498399
      ** EDIT THE TRAILER INFORMATION.                                **38498499
      ******************************************************************38498599
       3360-EDIT-TRAILER.                                               38498699
           IF PW-TRAILER-SEAL NOT > SPACES                              38498799
               IF PS-NO-ERROR                                           38498899
                   SET PS-ERROR           TO TRUE                       38498999
               END-IF                                                   38499099
           END-IF.                                                      38499199
           IF PW-TRAILER-NBR NOT > SPACES                               38499299
               IF PS-NO-ERROR                                           38499399
                   SET PS-ERROR           TO TRUE                       38499499
               END-IF                                                   38499599
           END-IF.                                                      38499699
      ******************************************************************38499799
      ** EDIT THE TOTE INFORMATION - ONLY REQUIRED FOR SECURE TOTES.  **38499899
      ******************************************************************38499999
       3370-EDIT-TOTE.                                                  38500099
           IF PW-LG-TOTE-SEAL1 NOT > SPACES                             38500199
               IF PS-NO-ERROR                                           38500299
                   SET PS-ERROR           TO TRUE                       38500399
               END-IF                                                   38500499
           END-IF.                                                      38500599
           IF PW-LG-TOTE-SEAL2 NOT > SPACES                             38500699
               IF PS-NO-ERROR                                           38500799
                   SET PS-ERROR           TO TRUE                       38500899
               END-IF                                                   38500999
           END-IF.                                                      38501099
051705*3380-GET-CUR-DATE.                                               38501199
051705*    EXEC CICS                                                    38501299
051705*        ASKTIME ABSTIME (PV-ABSTIME)                             38501399
051705*    END-EXEC.                                                    38501499
051705*                                                                 38502099
051705*    EXEC CICS                                                    38503099
051705*        FORMATTIME ABSTIME  (PV-ABSTIME)                         38504099
051705*                   MMDDYY   (SD-MMDDYY-FORMAT)                   38505099
051705*                   DATESEP                                       38506099
051705*    END-EXEC.                                                    38507099
051705*                                                                 38508099
051705*    MOVE SD-SYSTEM-MONTH           TO  PV-CURRENT-MONTH.         38509099
051705*    MOVE SD-SYSTEM-DAY             TO  PV-CURRENT-DAY.           38510099
051705*    MOVE SD-SYSTEM-YEAR            TO  PV-CURRENT-YEAR.          38520099
051705*    INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              38530099
051705*                                                                 38540099
051705*    MOVE PV-CURRENT-DATE              TO  DPG51-SYSTEM-DATE.     38550099
051705*    SET  DPG51-ACTUAL-CALENDAR-ONLY                              38560099
051705*         DPG51-DO-NOT-INCR-DECR-DATE                             38570099
051705*         DPG52-LK-DTE-GREG          TO TRUE.                     38580099
051705*                                                                 38590099
051705*    MOVE PV-CURRENT-MONTH           TO  PV-GD-MONTH.             38600099
051705*    MOVE PV-CURRENT-DAY             TO  PV-GD-DAY.               38610099
051705*    MOVE PV-CURRENT-YEAR            TO  PV-GD-YEAR.              38620099
051705*    MOVE PV-GREGORIAN-DATE          TO  DPG52-LK-DATE-INPUT.     38630099
051705*                                                                 38640099
051705*    CALL DP500-KOHLS-CALENDAR-ROUTINE                            38650099
051705*        USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               38660099
051705*                                                                 38670099
051705*    EVALUATE TRUE                                                38680099
051705*        WHEN DPG54-DATE-VALID                                    38690099
051705*            MOVE DPG55-DB2-ISO-DATE-FMT TO PV-CURRENT-ISO-DATE   38700099
051705*        WHEN OTHER                                               38710099
051705*            MOVE '3380-GET-CUR-DATE'  TO DP013-PARAGRAPH         38720099
051705*            MOVE 'GET THE CURRENT DATE'                          38730099
051705*                                      TO DP013-MESSAGE-TEXT (1)  38740099
051705*            MOVE DPG54-ERROR-MESSAGE  TO DP013-MESSAGE-TEXT (2)  38750099
051705*            SET DP013-OTHER-ABEND     TO TRUE                    38750199
051705*            PERFORM DP013-0000-PROCESS-ABEND                     38750299
051705*    END-EVALUATE.                                                38750399
      *                                                                 38750499
      ******************************************************************38750599
      ** EDIT THE RETAIL TRANSFER DETAIL INFORMATION.                 **38750699
      ******************************************************************38750799
       3400-EDIT-RTL-DETAIL-INFO.                                       38750899
           SET PS-INVALID-UPC               TO TRUE                     38751199
           IF PW-UPC (PW-ITEM-SUB) > ZEROES                             38753299
               MOVE PW-UPC (PW-ITEM-SUB) TO DK-UPC-NBR                  38753399
               PERFORM 3700-SELECT-UPC-NBR                              38753499
               IF PS-INVALID-UPC                                        38753599
                   IF PS-NO-ERROR                                       38753699
                       SET PS-ERROR         TO TRUE                     38753799
                   END-IF                                               38753899
               END-IF                                                   38753999
           END-IF.                                                      38754099
      *- IF A QTY OR PRICE IS ENTERED, THEN A UPC MUST BE ENTERED       38755499
           IF (PW-RTL-QTY       (PW-ITEM-SUB) > SPACES               OR 38755599
               PW-PRICE (PW-ITEM-SUB) > SPACES)                         38755699
               IF  PW-UPC (PW-ITEM-SUB) = ZEROES                        38755899
      *            -- MUST ENTER UPC --                                 38755999
                   IF PS-NO-ERROR                                       38756099
                       SET PS-ERROR           TO TRUE                   38756199
                   END-IF                                               38756299
              END-IF                                                    38756399
           END-IF.                                                      38756499
           IF PW-PRICE (PW-ITEM-SUB) > SPACES                           38756599
               IF (PS-VALID-UPC)                                        38756699
                   PERFORM 4600-VALIDATE-PRICE                          38756799
               END-IF                                                   38756899
           END-IF.                                                      38757999
           IF PW-RTL-QTY (PW-ITEM-SUB) NOT > ZEROES                     38758099
               IF (PW-UPC    (PW-ITEM-SUB) > ZEROES               OR    38758299
                   PW-PRICE (PW-ITEM-SUB) > SPACES)                     38758399
      *            -- REQUIRED FIELD --                                 38758499
                   IF PS-NO-ERROR                                       38758599
                       SET PS-ERROR           TO TRUE                   38758699
                   END-IF                                               38758799
               END-IF                                                   38758899
           END-IF.                                                      38758999
      ******************************************************************38759099
      ** EDIT THE NON-RETAIL TRANSFER DETAIL INFORMATION.             **38759199
      ******************************************************************38759299
       3450-EDIT-NRTL-DETAIL-INFO.                                      38759399
      *- IF DEPT OR QTY OR FIXTURE WAS ENTERED, DESCRIPTION IS REQUIRED 38759499
           IF (PW-NRTL-DEPT (PW-ITEM-SUB) > SPACES OR                   38759599
               PW-NRTL-QTY (PW-ITEM-SUB) > SPACES                OR     38759699
               PW-FIXTURE (PW-ITEM-SUB) > SPACES)                       38759799
               IF PW-ITEM-DESC (PW-ITEM-SUB) NOT > SPACES               38759899
      *            -- REQUIRED FIELD --                                 38759999
                   IF PS-NO-ERROR                                       38760099
                       SET PS-ERROR           TO TRUE                   38760199
                   END-IF                                               38760299
               END-IF                                                   38760399
           END-IF.                                                      38760499
           IF PW-NRTL-QTY (PW-ITEM-SUB) NOT > ZEROES                    38760599
      *- IF DEPT OR DESCRIPTION OR FIXTURE WAS ENTERED, QTY IS REQUIRED 38760699
               IF (PW-NRTL-DEPT (PW-ITEM-SUB) > SPACES OR               38760799
                   PW-ITEM-DESC (PW-ITEM-SUB) > SPACES OR               38760899
                   PW-FIXTURE (PW-ITEM-SUB) > SPACES)                   38760999
      *            -- REQUIRED FIELD --                                 38761099
                   IF PS-NO-ERROR                                       38761199
                       SET PS-ERROR           TO TRUE                   38761299
                   END-IF                                               38761399
               END-IF                                                   38761499
           END-IF.                                                      38761599
      *----------------------------------------------------------------*41410399
      *    READ XST_UPC AND XST_SKU_LOC USING THE ENTERED UPC NUMBER   *41410499
      *----------------------------------------------------------------*41410699
       3700-SELECT-UPC-NBR.                                             41410799
100404     INITIALIZE DCLXST00008.                                      41410899
100404     INITIALIZE DCLXST00010.                                      41410999
                                                                        41411099
           PERFORM                                                      41411299
             WITH TEST AFTER                                            41411399
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       41411499
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  41411599
                    OR SQLCODE = ZERO                                   41411699
                    OR SQLCODE = +100                                   41411799
               EXEC SQL                                                 41411899
100404             SELECT B.UNT_RTL_AMT                                 41412999
100404                   ,B.UPC_STAT_CHG_DTE                            41413099
100404                   ,B.UNT_RTL_CHG_DTE                             41413199
100404                   ,B.LOC_SKU_STAT_CDE                            41413299
100404                   ,C.ITM_NBR                                     41413399
100404                   ,B.GP_RTL_AMT                                  41413499
100404                   ,B.GP_RTL_QTY                                  41413599
100404                   ,D.REGN_PRIC_IND                               41413699
100404                   ,B.INTR_UPC_ID                                 41413799
100404               INTO :XST00008-UNT-RTL-AMT                         41414899
100404                   ,:PV-NREGN-UPC-STAT-CHG-DTE                    41414999
100404                   ,:PV-NREGN-UNT-RTL-CHG-DTE                     41415099
100404                   ,:PV-NREGN-LOC-SKU-STAT-CDE                    41415199
100404                   ,:SKXREF-ITM-NBR                               41415299
100404                   ,:XST00008-GP-RTL-AMT                          41415399
100404                    :PV-GP-RTL-AMT-NULL-IND                       41415499
100404                   ,:XST00008-GP-RTL-QTY                          41415599
100404                    :PV-GP-RTL-QTY-NULL-IND                       41415699
100404                   ,:XST00010-REGN-PRIC-IND                       41415799
100404                   ,:XST00008-INTR-UPC-ID                         41415899
100404                FROM XST_UPC     A                                41416399
100404                    ,XST_SKU_LOC B                                41416499
100404                    ,TSKXREF     C                                41416599
100404                    ,XST_SKU     D                                41416699
100404          WHERE  (A.UPC_NBR               =  :DK-UPC-NBR   AND    41416799
100404                  A.LAST_ACTN_CDE        IN ('A', 'U')     AND    41416899
100404                  A.INTR_UPC_ID           = B.INTR_UPC_ID  AND    41416999
100404                  B.LOC_NBR               = 0              AND    41417099
100404                  B.END_TMST             IS NULL           AND    41417199
100404                  B.LOC_SKU_STAT_CDE NOT IN ('98')         AND    41417299
100404                  B.INTR_UPC_ID           = C.INTR_UPC_ID  AND    41417399
100404                  C.SKU_STAT_CDE     NOT IN ('98')         AND    41417499
100404                  A.INTR_UPC_ID           = D.INTR_UPC_ID)        41417599
               END-EXEC                                                 41418099
                                                                        41418199
               EVALUATE TRUE                                            41418299
                   WHEN SQLCODE = ZERO                                  41418399
                     SET PS-VALID-UPC          TO TRUE                  41418499
100404               MOVE SKXREF-ITM-NBR       TO PW-ITEM-NBR           41418599
                                                 (PW-ITEM-SUB)          41418699
100404               MOVE XST00008-UNT-RTL-AMT  TO PV-CUR-RTL-AMT       41418799
100404               IF PV-GP-RTL-QTY-NULL-IND < 0                      41418899
100404                   MOVE ZEROS TO XST00008-GP-RTL-QTY              41418999
100404               END-IF                                             41419099
100404               IF PV-GP-RTL-AMT-NULL-IND < 0                      41419199
100404                   MOVE ZEROS TO XST00008-GP-RTL-AMT              41419299
100404               END-IF                                             41419399
100404               MOVE XST00008-GP-RTL-QTY   TO PV-GP-QTY            41419499
100404               MOVE XST00008-GP-RTL-AMT   TO PV-GP-RTL-AMT        41419599
100404               IF XST00010-REGN-PRIC-IND = PC-YES                 41419999
                         EVALUATE ASC-CMPLT-XFER-TYPE                   41420099
111703*                      WHEN  PC-DEFECTIVE-DAMAGE                  41420199
111703                       WHEN  PC-DEFECTIVE-DAMAGE-SORT1            41420299
111703                       WHEN  PC-DEFECTIVE-DAMAGE-SORT2            41420399
                             WHEN  PC-CALLBACK                          41420499
                                MOVE ASC-FROM-STORE TO DK-STORE-NBR     41420599
                                PERFORM 7800-CHECK-REGN-PRC             41420699
                             WHEN  PC-STOCK-BAL-CORP                    41420799
                             WHEN  PC-STOCK-BAL-STORE                   41420899
                             WHEN  PC-CUSTOMER                          41420999
                                MOVE ASC-TO-STORE-NBR                   41421099
                                           (ASC-BLK-SUB ASC-ITEM-SUB)   41421199
                                                      TO DK-STORE-NBR   41421299
                                PERFORM 7800-CHECK-REGN-PRC             41421399
                         END-EVALUATE                                   41421499
                     END-IF                                             41421599
                     MOVE PV-CUR-RTL-AMT TO PW-FILE-PRICE               41421699
                                        (PW-ITEM-SUB)                   41421799
                     IF PV-GP-QTY > +1                                  41421899
                         COMPUTE PV-CUR-RTL-AMT =                       41421999
                                      PV-GP-RTL-AMT / PV-GP-QTY         41422099
                         SET PW-GROUP-PRICED-ITEM (PW-ITEM-SUB)         41422199
                                               TO TRUE                  41422299
                     ELSE                                               41422399
                         SET PW-NOT-GROUP-PRICED-ITEM (PW-ITEM-SUB)     41422499
                                               TO TRUE                  41422599
                     END-IF                                             41423099
                   WHEN SQLCODE = -904                                  41500299
                   WHEN SQLCODE = -913                                  41500399
                       CONTINUE                                         41500499
                   WHEN SQLCODE = +100                                  41500599
                       SET PS-INVALID-UPC          TO TRUE              41500699
                   WHEN OTHER                                           41500799
                       MOVE '3700-SELECT-UPC-NBR'                       41501099
                                           TO DP013-PARAGRAPH           41501199
100404                 MOVE 'READ A ROW FROM XST_UPC'                   41501299
                                           TO DP013-MESSAGE-TEXT (1)    41501399
                       MOVE SQLCA          TO DP013-SQLCA               41501499
100404                 MOVE 'XST_UPC'      TO DP013-DB2-TABLE-NAME (1)  41501599
100404                 MOVE 'XST_SKU_LOC'  TO DP013-DB2-TABLE-NAME (2)  41501699
100404                 MOVE 'XST_SKU'      TO DP013-DB2-TABLE-NAME (3)  41501799
100404                 MOVE 'TSKXREF'      TO DP013-DB2-TABLE-NAME (4)  41501899
                       SET DP013-DB2-ABEND TO TRUE                      41501999
                       PERFORM DP013-0000-PROCESS-ABEND                 41502099
               END-EVALUATE                                             41502199
           END-PERFORM.                                                 41502299
                                                                        41502399
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          41502499
               MOVE '3700-SELECT-UPC-NBR'  TO DP013-PARAGRAPH           41502599
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT '    41502699
                                           TO DP013-MESSAGE-TEXT (1)    41502799
100404         MOVE 'DATA FROM XST_UPC & XST_SKU_LOC'                   41502899
                                           TO DP013-MESSAGE-TEXT (2)    41502999
               MOVE SQLCA                  TO DP013-SQLCA               41503099
100404         MOVE 'XST_UPC'              TO DP013-DB2-TABLE-NAME (1)  41503199
100404         MOVE 'XST_SKU_LOC'          TO DP013-DB2-TABLE-NAME (2)  41503299
100404         MOVE 'XST_SKU'              TO DP013-DB2-TABLE-NAME (3)  41503399
100404         MOVE 'TSKXREF'              TO DP013-DB2-TABLE-NAME (4)  41503499
               SET DP013-DB2-ABEND         TO TRUE                      41503799
               PERFORM DP013-0000-PROCESS-ABEND                         41503899
           END-IF.                                                      41503999
           IF PS-VALID-UPC                                              41504099
               PERFORM 3800-SELECT-KOHLS-INTERNAL-UPC                   41504199
               IF PS-INVALID-CHECK-DIGIT                                41504299
                   SET PS-INVALID-UPC      TO TRUE                      41504399
               END-IF                                                   41504499
           END-IF.                                                      41504599
                                                                        41504699
      ******************************************************************41504799
      *  GENERATE THE KOHL'S INTERNAL UPC NUMBER                        41504899
      ******************************************************************41504999
       3800-SELECT-KOHLS-INTERNAL-UPC.                                  41505099
           SET PS-VALID-CHECK-DIGIT        TO TRUE.                     41505199
               EXEC SQL                                                 41505299
100404             SELECT UPC_NBR                                       41505399
100404               INTO :XST00012-UPC-NBR                             41505499
100404               FROM XST_UPC                                       41505599
100404              WHERE UPC_ID     =  :XST00008-INTR-UPC-ID           41505699
100404                AND LAST_ACTN_CDE IN ('A', 'U')                   41505799
               END-EXEC.                                                41505899
                                                                        41505999
           EVALUATE TRUE                                                41506099
               WHEN SQLCODE = ZERO                                      41506199
100404             MOVE XST00012-UPC-NBR TO DK-UPC-NBR                  41506299
                                            PW-KOHLS-UPC (PW-ITEM-SUB)  41506399
               WHEN SQLCODE = +100                                      41506499
                   SET PS-INVALID-CHECK-DIGIT  TO TRUE                  41506599
               WHEN OTHER                                               41506699
                   MOVE '3800-SELECT-KOHLS-INTERNAL-UPC'                41506799
                                       TO DP013-PARAGRAPH               41506899
                   MOVE 'SELECT-KOHLS-INTERNAL-UPC'                     41506999
                                       TO DP013-MESSAGE-TEXT (1)        41507099
                   MOVE SQLCA              TO DP013-SQLCA               41507199
100404             MOVE 'XST_UPC'          TO DP013-DB2-TABLE-NAME (1)  41507299
                   SET DP013-DB2-ABEND TO TRUE                          41507399
                   PERFORM DP013-0000-PROCESS-ABEND                     41507499
           END-EVALUATE.                                                41507599
      *                                                                 41507699
       EJECT                                                            41507799
                                                                        41507899
      *----------------------------------------------------------------*41546099
      *    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *41547099
      *    INITIALIZE ALL COUNTERS AND FLAGS.                          *41548099
      *    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *41549099
      *    DISPLAY THE PANEL TO USER.                                  *41550099
      *----------------------------------------------------------------*41560099
                                                                        41570099
       4000-BUILD-INITIAL-PANEL.                                        41580099
                                                                        41590099
           INITIALIZE                    ASC-BLOCK-ENTRIES (1)          41600099
                                         ASC-BLOCK-ENTRIES (2)          41610099
                                         PV-XFER-TYPE-TBL.              41620099
           MOVE +1                   TO  ASC-BLK-SUB.                   41630099
                                                                        41640099
           MOVE +0                   TO  ASC-ITEM-SUB                   41650099
                                         ASC-NUMBER-OF-ITEMS-READ       41660099
                                         ASC-NUMBER-OF-SELECTED-ITEMS   41670099
                                         ASC-HIGHEST-BLOCK-WRITTEN      41680099
                                         ASC-ITEM-AT-TOP-OF-PANEL.      41690099
                                                                        41700099
           PERFORM 4010-OPEN-XFER-TYPE-CURSOR.                          41710099
                                                                        41720099
           PERFORM 4020-READ-TRANSFER-TYPES.                            41730099
                                                                        41740099
           PERFORM 4030-CLOSE-XFER-TYPE-CURSOR.                         41750099
                                                                        41760099
           PERFORM 4040-OPEN-CONTNR-TYPE-CURSOR.                        41770099
                                                                        41780099
           PERFORM 4050-READ-CONTAINER-TYPES.                           41790099
                                                                        41800099
           PERFORM 4060-CLOSE-CONTNR-TYPE-CURSOR.                       41810099
                                                                        41820099
           PERFORM 4100-BUILD-CURSOR                                    41830099
                                                                        41840099
           PERFORM 4210-COMBINE-SQL.                                    41850099
           PERFORM 4220-DECLARE-CURSOR.                                 41860099
           PERFORM 4230-PREPARE-CURSOR.                                 41870099
                                                                        41880099
           PERFORM 4240-OPEN-CURSOR.                                    41890099
                                                                        41900099
           PERFORM 4300-READ-ITEMS-FROM-DB.                             41910099
                                                                        41920099
           PERFORM 4250-CLOSE-CURSOR.                                   41930099
                                                                        41940099
           MOVE +1               TO  PV-TOP-ITEM                        41950099
           IF PS-ERROR-DB2                                              41960099
               SET DP020-NEXT-ACT-APPL-ERROR                            41970099
                   DP020-MSG-FATAL TO TRUE                              41980099
               MOVE PC-TSYMSG-00050 TO DP020-MSG-NUMBER                 41990099
           ELSE                                                         42000099
               IF ASC-NUMBER-OF-ITEMS-READ = ZERO                       42010099
                   SET DP020-NEXT-ACT-APPL-ERROR                        42020099
                       DP020-MSG-FATAL TO TRUE                          42030099
                   MOVE PC-TSYMSG-00050 TO DP020-MSG-NUMBER             42040099
               ELSE                                                     42050099
                   IF ASC-NUMBER-OF-ITEMS-READ > ZERO                   42060099
                       MOVE -1       TO MR-SELECTL (1)                  42070099
                       SET DP030-SET-CURSOR-APPL-1                      42080099
                                     TO TRUE                            42090099
                   END-IF                                               42100099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 42110099
               END-IF                                                   42120099
           END-IF.                                                      42130099
                                                                        42140099
       EJECT                                                            42150099
      *----------------------------------------------------------------*42160099
      * OPENS THE TRANSFER TYPE CURSOR                                 *42170099
      *----------------------------------------------------------------*42180099
                                                                        42190099
       4010-OPEN-XFER-TYPE-CURSOR.                                      42200099
                                                                        42210099
           EXEC SQL                                                     42220099
               OPEN XFER-TYPE-CSR                                       42230099
           END-EXEC.                                                    42240099
                                                                        42250099
           EVALUATE TRUE                                                42260099
               WHEN SQLCODE = +0                                        42270099
                   CONTINUE                                             42280099
               WHEN OTHER                                               42290099
                    MOVE '4010-OPEN-XFER-TYPE-CURSOR'                   42300099
                                     TO DP013-PARAGRAPH                 42310099
                    MOVE 'OPEN XFER-TYPE-CSR CURSOR'                    42320099
                                     TO DP013-MESSAGE-TEXT (1)          42330099
                    MOVE SQLCA           TO DP013-SQLCA                 42340099
                    SET DP013-DB2-ABEND                                 42350099
                                     TO TRUE                            42360099
                    PERFORM DP013-0000-PROCESS-ABEND                    42370099
           END-EVALUATE.                                                42380099
                                                                        42390099
       EJECT                                                            42400099
      *----------------------------------------------------------------*42410099
      *    READ THE TRANSFER TYPES AND DESCRIPTIONS AND PROCESS THEM   *42420099
      *----------------------------------------------------------------*42430099
                                                                        42440099
       4020-READ-TRANSFER-TYPES.                                        42450099
                                                                        42460099
           SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       42470099
           PERFORM                                                      42480099
               VARYING PV-READ-COUNT                                    42490099
               FROM 1 BY 1                                              42500099
               UNTIL ((PV-READ-COUNT > PC-MAX-TYPES)                    42510099
                  OR (ASC-NO-ITEMS-LEFT-ON-DB))                         42520099
                                                                        42530099
               PERFORM 4025-FETCH-TRANSFER-TYPE                         42540099
                                                                        42550099
               IF  ASC-ITEMS-LEFT-ON-DB                                 42560099
                   MOVE TFTYCD-XFER-TYP-CDE(2:1)                        42570099
                                         TO PV-STATUS-TBL-SUB           42580099
111703************************************************************      42580199
111703** DEFECTIVE DAMAGED SORT1 XFER TYPE OF 0 CANNOT BE USED AS       42580299
111703** A SUBSCRIPT.  DEFAULT IT TO MAX TYPE CODE OF 8                 42580399
111703************************************************************      42580499
111703             IF PV-STATUS-TBL-SUB = 0                             42580599
111703                 MOVE 8 TO PV-STATUS-TBL-SUB                      42580699
111703             END-IF                                               42580799
                                                                        42582099
                   IF TFTYCD-TYP-2ND-LNE-DESC = SPACES                  42590099
                       MOVE TFTYCD-TYP-1ST-LNE-DESC                     42600099
                                         TO PV-XFER-TYPE-LINE-DESC      42610099
                                            (PV-STATUS-TBL-SUB)         42620099
                   ELSE                                                 42630099
                       STRING TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  ' 42640099
                              TFTYCD-TYP-2ND-LNE-DESC DELIMITED BY '  ' 42650099
                           INTO PV-XFER-TYPE-LINE-DESC                  42660099
                                            (PV-STATUS-TBL-SUB)         42670099
                   END-IF                                               42680099
               END-IF                                                   42690099
           END-PERFORM.                                                 42700099
                                                                        42710099
       EJECT                                                            42720099
      *----------------------------------------------------------------*42730099
      *    FETCH THE TRANSFER TYPES AND DESCRIPTIONS                   *42740099
      *----------------------------------------------------------------*42750099
                                                                        42760099
       4025-FETCH-TRANSFER-TYPE.                                        42770099
                                                                        42780099
           EXEC SQL                                                     42790099
               FETCH XFER-TYPE-CSR                                      42800099
                   INTO                                                 42810099
                       :TFTYCD-XFER-TYP-CDE                             42820099
                     , :TFTYCD-TYP-1ST-LNE-DESC                         42830099
                     , :TFTYCD-TYP-2ND-LNE-DESC                         42840099
           END-EXEC.                                                    42850099
                                                                        42860099
           EVALUATE TRUE                                                42870099
               WHEN SQLCODE = ZERO                                      42880099
                    CONTINUE                                            42890099
               WHEN SQLCODE = +100                                      42900099
                    SET ASC-NO-ITEMS-LEFT-ON-DB                         42910099
                                       TO TRUE                          42920099
               WHEN OTHER                                               42930099
                    MOVE '4025-FETCH-TRANSFER-TYPE'                     42950099
                                     TO DP013-PARAGRAPH                 42960099
                    MOVE 'FETCH XFER-TYPE-CSR CURSOR'                   42970099
                                     TO DP013-MESSAGE-TEXT (1)          42980099
                    MOVE SQLCA           TO DP013-SQLCA                 42990099
                    SET DP013-DB2-ABEND                                 43000099
                                     TO TRUE                            43010099
                    PERFORM DP013-0000-PROCESS-ABEND                    43020099
           END-EVALUATE.                                                43030099
                                                                        43040099
       EJECT                                                            43050099
      *----------------------------------------------------------------*43060099
      * CLOSE THE TRANSFER TYPE CURSOR                                 *43070099
      *----------------------------------------------------------------*43080099
                                                                        43090099
       4030-CLOSE-XFER-TYPE-CURSOR.                                     43100099
                                                                        43110099
           EXEC SQL                                                     43120099
               CLOSE XFER-TYPE-CSR                                      43130099
           END-EXEC.                                                    43140099
                                                                        43140199
           EVALUATE TRUE                                                43140299
               WHEN SQLCODE = ZERO                                      43140399
                    CONTINUE                                            43140499
               WHEN OTHER                                               43140599
                    MOVE '4030-CLOSE-XFER-TYPE-CURSOR'                  43140699
                                 TO  DP013-PARAGRAPH                    43140799
                    MOVE 'CLOSE XFER-TYPE-CSR CURSOR'                   43140899
                                 TO  DP013-MESSAGE-TEXT (1)             43140999
                    MOVE SQLCA   TO  DP013-SQLCA                        43141099
                    SET DP013-DB2-ABEND                                 43141199
                                 TO  TRUE                               43141299
                    PERFORM DP013-0000-PROCESS-ABEND                    43141399
           END-EVALUATE.                                                43141499
                                                                        43141599
       EJECT                                                            43141699
      *----------------------------------------------------------------*43141799
      * OPENS THE CONTAINER TYPE CURSOR                                *43141899
      *----------------------------------------------------------------*43141999
                                                                        43142099
       4040-OPEN-CONTNR-TYPE-CURSOR.                                    43143099
                                                                        43144099
           EXEC SQL                                                     43145099
               OPEN CONTNR-TYPE-CSR                                     43146099
           END-EXEC.                                                    43147099
                                                                        43148099
           EVALUATE TRUE                                                43149099
               WHEN SQLCODE = +0                                        43150099
                   CONTINUE                                             43160099
               WHEN OTHER                                               43170099
                    MOVE '4040-OPEN-CONTNR-TYPE-CURSOR'                 43180099
                                     TO DP013-PARAGRAPH                 43190099
                    MOVE 'OPEN CONTNR-TYPE-CSR CURSOR'                  43200099
                                     TO DP013-MESSAGE-TEXT (1)          43210099
                    MOVE SQLCA           TO DP013-SQLCA                 43220099
                    SET DP013-DB2-ABEND                                 43230099
                                     TO TRUE                            43240099
                    PERFORM DP013-0000-PROCESS-ABEND                    43250099
           END-EVALUATE.                                                43260099
                                                                        43270099
       EJECT                                                            43280099
      *----------------------------------------------------------------*43290099
      *    READ THE CONTAINER TYPES AND DESCRIPTIONS AND PROCESS THEM  *43300099
      *----------------------------------------------------------------*43310099
                                                                        43320099
       4050-READ-CONTAINER-TYPES.                                       43330099
                                                                        43340099
           SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       43350099
           PERFORM                                                      43360099
               VARYING PV-READ-COUNT                                    43370099
               FROM 1 BY 1                                              43380099
               UNTIL ((PV-READ-COUNT > PC-MAX-TYPES)                    43390099
                  OR (ASC-NO-ITEMS-LEFT-ON-DB))                         43400099
                                                                        43410099
               PERFORM 4055-FETCH-CONTAINER-TYPE                        43420099
                                                                        43430099
               IF  ASC-ITEMS-LEFT-ON-DB                                 43440099
                   MOVE TFSHCT-CONTNR-TYP-CDE(2:1)                      43450099
                                         TO PV-STATUS-TBL-SUB           43460099
                   MOVE TFSHCT-CONTNR-TYP-DESC                          43470099
                                         TO PV-CONTNR-TYPE-LINE-DESC    43480099
                                            (PV-STATUS-TBL-SUB)         43490099
               END-IF                                                   43500099
           END-PERFORM.                                                 43510099
                                                                        43520099
       EJECT                                                            43530099
      *----------------------------------------------------------------*43540099
      *    FETCH THE CONTAINER TYPES AND DESCRIPTIONS                  *43550099
      *----------------------------------------------------------------*43560099
                                                                        43570099
       4055-FETCH-CONTAINER-TYPE.                                       43580099
                                                                        43590099
           EXEC SQL                                                     43600099
               FETCH CONTNR-TYPE-CSR                                    43610099
                   INTO                                                 43620099
                       :TFSHCT-CONTNR-TYP-CDE                           43630099
                      ,:TFSHCT-CONTNR-TYP-DESC                          43640099
           END-EXEC.                                                    43650099
                                                                        43660099
           EVALUATE TRUE                                                43670099
               WHEN SQLCODE = ZERO                                      43680099
                    CONTINUE                                            43690099
               WHEN SQLCODE = +100                                      43700099
                    SET ASC-NO-ITEMS-LEFT-ON-DB                         43710099
                                       TO TRUE                          43720099
               WHEN OTHER                                               43730099
                    MOVE '4055-FETCH-CONTAINER-TYPE'                    43750099
                                     TO DP013-PARAGRAPH                 43760099
                    MOVE 'FETCH CONTNR-TYPE-CSR CURSOR'                 43770099
                                     TO DP013-MESSAGE-TEXT (1)          43780099
                    MOVE SQLCA           TO DP013-SQLCA                 43790099
                    SET DP013-DB2-ABEND                                 43800099
                                     TO TRUE                            43810099
                    PERFORM DP013-0000-PROCESS-ABEND                    43820099
           END-EVALUATE.                                                43830099
                                                                        43840099
       EJECT                                                            43850099
      *----------------------------------------------------------------*43860099
      * CLOSE THE CONTAINER TYPE CURSOR                                *43870099
      *----------------------------------------------------------------*43880099
                                                                        43890099
       4060-CLOSE-CONTNR-TYPE-CURSOR.                                   43900099
                                                                        43910099
           EXEC SQL                                                     43920099
               CLOSE CONTNR-TYPE-CSR                                    43930099
           END-EXEC.                                                    43940099
                                                                        43940199
           EVALUATE TRUE                                                43940299
               WHEN SQLCODE = ZERO                                      43940399
                    CONTINUE                                            43940499
               WHEN OTHER                                               43940599
                    MOVE '4060-CLOSE-CONTNR-TYPE-CURSOR'                43940699
                                 TO  DP013-PARAGRAPH                    43940799
                    MOVE 'CLOSE CONTNR-TYPE-CSR CURSOR'                 43940899
                                 TO  DP013-MESSAGE-TEXT (1)             43940999
                    MOVE SQLCA   TO  DP013-SQLCA                        43941099
                    SET DP013-DB2-ABEND                                 43941199
                                 TO  TRUE                               43941299
                    PERFORM DP013-0000-PROCESS-ABEND                    43941399
           END-EVALUATE.                                                43941499
                                                                        43941599
       EJECT                                                            43941699
      *----------------------------------------------------------------*43941799
      *    SET UP THE HOST VARIABLES.                                  *43941899
      *----------------------------------------------------------------*43941999
                                                                        43942099
       4100-BUILD-CURSOR.                                               43943099
                                                                        43944099
           MOVE ZERO                     TO PV-ORD-BY-SUB               43945099
                                            PV-WHERE-SUB.               43946099
           MOVE SPACE                    TO PS-CURSOR-SW.               43947099
                                                                        43948099
           INITIALIZE PV-WHERE-TABLE                                    43949099
                      PV-ORDER-BY-TABLE                                 43950099
                      PV-SQL-STMT.                                      43960099
           EXEC CICS ASSIGN                                             43970099
                     APPLID(PV-SYSTEM-ID)                               43980099
           END-EXEC.                                                    43990099
                                                                        44000099
           MOVE PV-REGION-IND             TO PV-BUILD-QUAL-XL1          44010099
                                             PV-BUILD-QUAL-XL2          44020099
                                             PV-BUILD-QUAL-XI1          44030099
                                             PV-BUILD-QUAL-XI2          44040099
                                             PV-BUILD-QUAL-XI3          44050099
                                             PV-BUILD-QUAL-XI3A.        44051099
      *    IF PV-PROD-CICS                                              44060099
      *        MOVE PC-PKMO000            TO PV-BUILD-I-PKMO000         44070099
      *                                      PV-BUILD-L-PKMO000         44080099
      *    END-IF.                                                      44090099
           IF ASC-XFER-DPT > ZERO                                       44100099
             OR ASC-XFER-CLASS > ZERO                                   44110099
               SET PS-XFER-ITEM-CSR      TO TRUE                        44120099
           ELSE                                                         44130099
               SET PS-XFER-LIST-CSR  TO TRUE                            44140099
           END-IF.                                                      44150099
                                                                        44160099
      *    INSERT A 'WHERE' CLAUSE WITH 'AND' IN FRONT OF THE STATEMENT 44170099
      *    INTO THE GENERIC CURSOR WHERE CLAUSE FOR EACH SELECT CRITERIA44180099
      *    FIELD.                                                       44180199
                                                                        44180299
           IF  ASC-FR-STR-OVERRIDE                                      44180399
               MOVE PC-EQUAL             TO PV-WH-FR-STR-OVRRID-OP      44180499
           ELSE                                                         44180599
               MOVE PC-NOT-EQUAL         TO PV-WH-FR-STR-OVRRID-OP      44180699
           END-IF.                                                      44180799
           ADD PV-WHERE-SIZE             TO PV-WHERE-BYTES              44180899
           ADD PC-1                      TO PV-WHERE-SUB                44180999
           MOVE PV-WHERE-FR-STR-OVRRID-IND TO                           44181099
                                         PV-WHERE-LINE (PV-WHERE-SUB).  44182099
                                                                        44183099
           IF  ASC-XFER-TYPE > SPACES                                   44184099
               MOVE ASC-XFER-TYPE        TO PV-WH-XFER-TYPE             44185099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              44186099
               ADD PC-1                  TO PV-WHERE-SUB                44187099
               MOVE PV-WHERE-XFER-TYPE   TO PV-WHERE-LINE (PV-WHERE-SUB)44188099
           END-IF.                                                      44189099
                                                                        44190099
           IF  ASC-CONTNR-TYPE > SPACES                                 44200099
               MOVE ASC-CONTNR-TYPE      TO PV-WH-CONTNR-TYPE           44210099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              44220099
               ADD PC-1                  TO PV-WHERE-SUB                44230099
               MOVE PV-WHERE-CONTNR-TYPE TO PV-WHERE-LINE (PV-WHERE-SUB)44240099
           END-IF.                                                      44250099
                                                                        44260099
           IF  ASC-XFER-TO-STR > ZERO                                   44270099
               MOVE ASC-XFER-TO-STR      TO PV-WH-TO-STORE              44280099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              44290099
               ADD PC-1                  TO PV-WHERE-SUB                44300099
               MOVE PV-WHERE-TO-STORE    TO PV-WHERE-LINE (PV-WHERE-SUB)44310099
           END-IF.                                                      44320099
                                                                        44330099
           IF  ASC-XFER-DPT > ZERO                                      44340099
               MOVE ASC-XFER-DPT         TO PV-WH-ITEM-DEPT             44350099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              44360099
               ADD PC-1                  TO PV-WHERE-SUB                44370099
               MOVE PV-WHERE-ITEM-DEPT   TO PV-WHERE-LINE (PV-WHERE-SUB)44380099
           END-IF.                                                      44390099
                                                                        44400099
           IF  ASC-XFER-CLASS > ZERO                                    44410099
               MOVE ASC-XFER-CLASS       TO PV-WH-ITEM-CLASS            44420099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              44430099
               ADD PC-1                  TO PV-WHERE-SUB                44440099
               MOVE PV-WHERE-ITEM-CLASS  TO PV-WHERE-LINE (PV-WHERE-SUB)44450099
           END-IF.                                                      44460099
                                                                        44470099
           IF  ASC-XFER-CALLBACK-NBR > ZERO                             44480099
               MOVE ASC-XFER-CALLBACK-NBR                               44490099
                                         TO PV-WH-CALLBACK-NBR          44500099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              44510099
               ADD PC-1                  TO PV-WHERE-SUB                44520099
               MOVE PV-WHERE-CALLBACK-NBR                               44530099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)44540099
           END-IF.                                                      44550099
                                                                        44560099
           IF  ASC-XFER-APPROVAL-NBR > ZERO                             44570099
               MOVE ASC-XFER-APPROVAL-NBR                               44580099
                                         TO PV-WH-APPROVAL-NBR          44590099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              44600099
               ADD PC-1                  TO PV-WHERE-SUB                44610099
               MOVE PV-WHERE-APPROVAL-NBR                               44620099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)44630099
           END-IF.                                                      44640099
                                                                        44650099
           IF  ASC-XFER-COMP-BY-FIRST-INIT > SPACE                      44660099
               MOVE ASC-XFER-COMP-BY-FIRST-INIT                         44670099
                                         TO PV-WH-COMP-INIT-NM          44680099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              44690099
               ADD PC-1                  TO PV-WHERE-SUB                44700099
               MOVE PV-WHERE-COMP-INIT-NM                               44710099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)44720099
           END-IF.                                                      44730099
                                                                        44740099
           IF  ASC-XFER-COMP-BY-LAST-NAME > SPACE                       44750099
               STRING ASC-XFER-COMP-BY-LAST-NAME  DELIMITED BY '   '    44760099
                      PC-APOSTROPHE               DELIMITED BY SIZE     44770099
                   INTO PV-WH-COMP-LAST-NM-DELIM                        44780099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              44790099
               ADD PC-1                  TO PV-WHERE-SUB                44800099
               MOVE PV-WHERE-COMP-LAST-NM                               44810099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)44820099
           END-IF.                                                      44830099
                                                                        44840099
           IF  ASC-CRITERIA-SORT-ORDER = ZEROES                         44850099
      *        SELECT THE CORRECT DEFAULT ORDER BY FIELDS               44860099
               MOVE PV-ORDER-BY-CONTROL-NBR                             44870099
                                         TO PV-BUILD-ORDER-BY-LITERAL   44880099
               ADD PV-ORDER-BY-SIZE      TO PV-ORDER-BY-BYTES           44890099
               ADD PC-1                  TO PV-ORD-BY-SUB               44900099
               MOVE PV-BUILD-ORDER-BY                                   44910099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 44920099
           ELSE                                                         44930099
               PERFORM 4110-BUILD-ORDER-BY-TABLE                        44940099
                   VARYING PV-ORDER-BY-COUNT                            44950099
                   FROM 1 BY 1                                          44960099
                   UNTIL PV-ORDER-BY-COUNT > 3                          44970099
                   MOVE PV-ORDER-BY-CONTROL-NBR                         44980099
                                         TO PV-BUILD-ORDER-BY-LITERAL   44990099
                   ADD PV-ORDER-BY-SIZE  TO PV-ORDER-BY-BYTES           45000099
                   ADD PC-1              TO PV-ORD-BY-SUB               45010099
                   MOVE PV-BUILD-ORDER-BY                               45020099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 45030099
           END-IF.                                                      45040099
                                                                        45050099
      /                                                                 45060099
      *----------------------------------------------------------------*45070099
      *    INSERT AN ORDER BY CLAUSE WITH THE PROPER ORDER BY PREFIX    45080099
      *    INTO THE GENERIC CURSOR ORDER BY CLAUSE FOR EACH SORT ORDER  45090099
      *    FIELD.                                                       45100099
      *----------------------------------------------------------------*45110099
                                                                        45120099
       4110-BUILD-ORDER-BY-TABLE.                                       45130099
                                                                        45140099
           IF  ASC-XFER-TYPE-SORT-NR = PV-ORDER-BY-COUNT                45150099
               MOVE PV-ORDER-BY-XFER-TYPE                               45160099
                                         TO PV-BUILD-ORDER-BY-LITERAL   45170099
               ADD PV-ORDER-BY-SIZE      TO PV-ORDER-BY-BYTES           45180099
               ADD PC-1                  TO PV-ORD-BY-SUB               45190099
               MOVE PV-BUILD-ORDER-BY                                   45200099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 45210099
               MOVE PV-BUILD-ORDER-BY-COMMA                             45220099
                                         TO PV-BUILD-ORDER-BY-PREFIX    45230099
           END-IF.                                                      45240099
                                                                        45250099
           IF  ASC-CONTNR-TYPE-SORT-NR = PV-ORDER-BY-COUNT              45260099
               MOVE PV-ORDER-BY-CONTNR-TYPE                             45270099
                                         TO PV-BUILD-ORDER-BY-LITERAL   45280099
               ADD PV-ORDER-BY-SIZE      TO PV-ORDER-BY-BYTES           45290099
               ADD PC-1                  TO PV-ORD-BY-SUB               45300099
               MOVE PV-BUILD-ORDER-BY                                   45310099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 45320099
               MOVE PV-BUILD-ORDER-BY-COMMA                             45330099
                                         TO PV-BUILD-ORDER-BY-PREFIX    45340099
           END-IF.                                                      45350099
                                                                        45360099
           IF  ASC-XFER-TO-STR-SORT-NR = PV-ORDER-BY-COUNT              45370099
               MOVE PV-ORDER-BY-TO-STORE TO PV-BUILD-ORDER-BY-LITERAL   45380099
               ADD PV-ORDER-BY-SIZE      TO PV-ORDER-BY-BYTES           45390099
               ADD PC-1                  TO PV-ORD-BY-SUB               45400099
               MOVE PV-BUILD-ORDER-BY                                   45410099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 45420099
               MOVE PV-BUILD-ORDER-BY-COMMA                             45430099
                                         TO PV-BUILD-ORDER-BY-PREFIX    45440099
           END-IF.                                                      45450099
      /                                                                 45460099
      *----------------------------------------------------------------*45470099
      *    PLACE ALL 'WHERE' AND 'ORDER BY' LINES INTO THE APPROPRIATE *45480099
      *    SQL LIST.                                                   *45490099
      *----------------------------------------------------------------*45500099
                                                                        45510099
       4210-COMBINE-SQL.                                                45520099
                                                                        45530099
           IF PS-XFER-LIST-CSR                                          45540099
               STRING PV-WHERE-LINE (1)  DELIMITED BY '   '             45550099
                      PV-WHERE-LINE (2)  DELIMITED BY '   '             45560099
                      PV-WHERE-LINE (3)  DELIMITED BY '   '             45570099
                      PV-WHERE-LINE (4)  DELIMITED BY '   '             45580099
                      PV-WHERE-LINE (5)  DELIMITED BY '   '             45590099
                      PV-WHERE-LINE (6)  DELIMITED BY '   '             45600099
                      PV-WHERE-LINE (7)  DELIMITED BY '   '             45610099
                      PV-WHERE-LINE (8)  DELIMITED BY '   '             45620099
                      PV-WHERE-LINE (9)  DELIMITED BY '   '             45630099
                      PV-WHERE-LINE (10) DELIMITED BY '   '             45640099
                      PV-BUILD-ORDER-BY-COMMAND                         45650099
                                            DELIMITED BY SIZE           45660099
                      PV-ORDER-BY-LINE (1)  DELIMITED BY '   '          45670099
                      PV-ORDER-BY-LINE (2)  DELIMITED BY '   '          45680099
                      PV-ORDER-BY-LINE (3)  DELIMITED BY '   '          45690099
                      PV-ORDER-BY-LINE (4)  DELIMITED BY '   '          45700099
                   INTO PVBLDSQL-XFER-LIST-WH-ORD                       45710099
               ADD PV-XFER-LIST-SELECT-BYTES                            45720099
                   PV-WHERE-BYTES                                       45730099
                   PV-ORDER-BY-BYTES                                    45740099
                   GIVING PV-BUILD-XFER-LIST-LEN                        45750099
               MOVE ASC-XFER-FR-STR             TO PV-BUILD-LIST-FR-STR 45760099
               MOVE PV-BUILD-XFER-LIST-LEN TO PV-SQL-STMT-LEN           45770099
               MOVE PV-BUILD-XFER-LIST-SEL-STMT TO PV-SQL-STMT-TEXT     45780099
           END-IF.                                                      45790099
                                                                        45800099
           IF PS-XFER-ITEM-CSR                                          45810099
               STRING PV-WHERE-LINE (1)  DELIMITED BY '   '             45820099
                      PV-WHERE-LINE (2)  DELIMITED BY '   '             45830099
                      PV-WHERE-LINE (3)  DELIMITED BY '   '             45840099
                      PV-WHERE-LINE (4)  DELIMITED BY '   '             45850099
                      PV-WHERE-LINE (5)  DELIMITED BY '   '             45860099
                      PV-WHERE-LINE (6)  DELIMITED BY '   '             45870099
                      PV-WHERE-LINE (7)  DELIMITED BY '   '             45880099
                      PV-WHERE-LINE (8)  DELIMITED BY '   '             45890099
                      PV-WHERE-LINE (9)  DELIMITED BY '   '             45900099
                      PV-WHERE-LINE (10) DELIMITED BY '   '             45910099
                      PV-BUILD-ORDER-BY-COMMAND                         45920099
                                            DELIMITED BY SIZE           45930099
                      PV-ORDER-BY-LINE (1)  DELIMITED BY '   '          45940099
                      PV-ORDER-BY-LINE (2)  DELIMITED BY '   '          45950099
                      PV-ORDER-BY-LINE (3)  DELIMITED BY '   '          45960099
                      PV-ORDER-BY-LINE (4)  DELIMITED BY '   '          45970099
                   INTO PVBLDSQL-XFER-ITEM-WH-ORD                       45980099
               ADD PV-XFER-ITEM-SELECT-BYTES                            45990099
                   PV-WHERE-BYTES                                       46000099
                   PV-ORDER-BY-BYTES                                    46010099
                   GIVING PV-BUILD-XFER-ITEM-LEN                        46020099
               MOVE ASC-XFER-FR-STR             TO PV-BUILD-ITEM-FR-STR 46030099
               MOVE PV-BUILD-XFER-ITEM-LEN TO PV-SQL-STMT-LEN           46040099
               MOVE PV-BUILD-XFER-ITEM-SEL-STMT TO PV-SQL-STMT-TEXT     46050099
           END-IF.                                                      46060099
                                                                        46070099
       EJECT                                                            46080099
      *----------------------------------------------------------------*46090099
      *    DECLARE THE CURSOR FOR DYNAMIC SQL CALL                     *46100099
      *----------------------------------------------------------------*46110099
                                                                        46120099
       4220-DECLARE-CURSOR.                                             46130099
                                                                        46140099
           IF PS-XFER-LIST-CSR                                          46150099
               PERFORM 4221-DECLARE-LIST-CURSOR                         46160099
           ELSE                                                         46170099
               PERFORM 4222-DECLARE-ITEM-CURSOR                         46180099
           END-IF.                                                      46190099
                                                                        46200099
       EJECT                                                            46210099
      *----------------------------------------------------------------*46220099
      *    DECLARE THE TRANSFER LIST CURSOR FOR DYNAMIC SQL CALL       *46230099
      *----------------------------------------------------------------*46240099
                                                                        46250099
       4221-DECLARE-LIST-CURSOR.                                        46260099
                                                                        46270099
           EXEC SQL                                                     46280099
               DECLARE XFER-LIST-CSR CURSOR FOR                         46290099
                       XFER-SELECT-LIST                                 46300099
           END-EXEC.                                                    46310099
                                                                        46320099
                                                                        46330099
           EVALUATE TRUE                                                46340099
               WHEN SQLCODE = +0                                        46350099
                    CONTINUE                                            46360099
               WHEN OTHER                                               46370099
                    MOVE '4221-DECLARE-LIST-CURSOR'                     46390099
                                     TO DP013-PARAGRAPH                 46400099
                    MOVE 'DECLARE TRANSFER LIST CURSOR'                 46410099
                                     TO DP013-MESSAGE-TEXT (1)          46420099
                    MOVE SQLCA       TO DP013-SQLCA                     46430099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        46440099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        46450099
                    SET DP013-DB2-ABEND                                 46460099
                                     TO TRUE                            46470099
                    PERFORM DP013-0000-PROCESS-ABEND                    46480099
           END-EVALUATE.                                                46490099
                                                                        46500099
       EJECT                                                            46510099
      *----------------------------------------------------------------*46520099
      *    DECLARE THE TRANSFER ITEM CURSOR FOR DYNAMIC SQL CALL        46530099
      *----------------------------------------------------------------*46540099
                                                                        46550099
       4222-DECLARE-ITEM-CURSOR.                                        46560099
                                                                        46570099
           EXEC SQL                                                     46580099
               DECLARE XFER-ITEM-CSR CURSOR FOR                         46590099
                       XFER-SELECT-ITEM                                 46600099
           END-EXEC.                                                    46610099
                                                                        46620099
                                                                        46630099
           EVALUATE TRUE                                                46640099
               WHEN SQLCODE = +0                                        46650099
                    CONTINUE                                            46660099
               WHEN OTHER                                               46670099
                    MOVE '4222-DECLARE-ITEM-CURSOR'                     46690099
                                     TO DP013-PARAGRAPH                 46700099
                    MOVE 'DECLARE TRANSFER ITEM CURSOR'                 46710099
                                     TO DP013-MESSAGE-TEXT (1)          46720099
                    MOVE SQLCA       TO DP013-SQLCA                     46730099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        46740099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        46750099
                    MOVE 'TTFITEM'   TO DP013-DB2-TABLE-NAME (3)        46760099
                    SET DP013-DB2-ABEND                                 46770099
                                     TO TRUE                            46780099
                    PERFORM DP013-0000-PROCESS-ABEND                    46790099
           END-EVALUATE.                                                46800099
                                                                        46810099
       EJECT                                                            46820099
      *----------------------------------------------------------------*46830099
      *  PREPARE THE APPROPRIATE TRANSFER CURSOR FOR DYNAMIC SQL CALL. *46840099
      *----------------------------------------------------------------*46850099
                                                                        46860099
       4230-PREPARE-CURSOR.                                             46870099
                                                                        46880099
           IF PS-XFER-LIST-CSR                                          46890099
               PERFORM 4231-PREPARE-LIST-CURSOR                         46900099
           ELSE                                                         46910099
               PERFORM 4232-PREPARE-ITEM-CURSOR                         46920099
           END-IF.                                                      46930099
                                                                        46940099
      /                                                                 46950099
      *----------------------------------------------------------------*46960099
      *    PREPARE THE TRANSFER LIST CURSOR FOR DYNAMIC SQL CALL       *46970099
      *----------------------------------------------------------------*46980099
                                                                        46990099
       4231-PREPARE-LIST-CURSOR.                                        47000099
                                                                        47010099
           EXEC SQL                                                     47020099
               PREPARE XFER-SELECT-LIST FROM :PV-SQL-STMT               47030099
           END-EXEC.                                                    47040099
                                                                        47050099
                                                                        47060099
           EVALUATE TRUE                                                47070099
               WHEN SQLCODE = +0                                        47080099
                    CONTINUE                                            47090099
               WHEN OTHER                                               47100099
                    MOVE '4231-PREPARE-LIST-CURSOR'                     47120099
                                     TO DP013-PARAGRAPH                 47130099
                    MOVE 'PREPARE TRANSFER LIST CURSOR'                 47140099
                                     TO DP013-MESSAGE-TEXT (1)          47150099
                    MOVE SQLCA       TO DP013-SQLCA                     47160099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        47170099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        47180099
                    SET DP013-DB2-ABEND                                 47190099
                                     TO TRUE                            47200099
                    PERFORM DP013-0000-PROCESS-ABEND                    47210099
           END-EVALUATE.                                                47220099
                                                                        47230099
      /                                                                 47240099
      *----------------------------------------------------------------*47250099
      *    PREPARE THE TRANSFER ITEM CURSOR FOR DYNAMIC SQL CALL       *47260099
      *----------------------------------------------------------------*47270099
                                                                        47280099
       4232-PREPARE-ITEM-CURSOR.                                        47290099
                                                                        47300099
           EXEC SQL                                                     47310099
               PREPARE XFER-SELECT-ITEM FROM :PV-SQL-STMT               47320099
           END-EXEC.                                                    47330099
                                                                        47340099
                                                                        47350099
           EVALUATE TRUE                                                47360099
               WHEN SQLCODE = +0                                        47370099
                    CONTINUE                                            47380099
               WHEN OTHER                                               47390099
                    MOVE '4232-PREPARE-ITEM-CURSOR'                     47410099
                                     TO DP013-PARAGRAPH                 47420099
                    MOVE 'PREPARE TRANSFER ITEM CURSOR'                 47430099
                                     TO DP013-MESSAGE-TEXT (1)          47440099
                    MOVE SQLCA       TO DP013-SQLCA                     47450099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        47460099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        47470099
                    MOVE 'TTFITEM'   TO DP013-DB2-TABLE-NAME (3)        47480099
                    SET DP013-DB2-ABEND                                 47490099
                                     TO TRUE                            47500099
                    PERFORM DP013-0000-PROCESS-ABEND                    47510099
           END-EVALUATE.                                                47520099
                                                                        47530099
      /                                                                 47540099
      *----------------------------------------------------------------*47550099
      * OPEN THE APPROPRIATE TRANSFER CURSOR.                          *47560099
      *----------------------------------------------------------------*47570099
                                                                        47580099
       4240-OPEN-CURSOR.                                                47590099
                                                                        47600099
           IF PS-XFER-LIST-CSR                                          47610099
               PERFORM 4241-OPEN-LIST-CURSOR                            47620099
           ELSE                                                         47630099
               PERFORM 4242-OPEN-ITEM-CURSOR                            47640099
           END-IF.                                                      47650099
                                                                        47660099
       EJECT                                                            47670099
      *----------------------------------------------------------------*47680099
      * OPEN THE TRANSFER LIST CURSOR.                                 *47690099
      *----------------------------------------------------------------*47700099
                                                                        47710099
       4241-OPEN-LIST-CURSOR.                                           47720099
                                                                        47730099
           PERFORM                                                      47740099
               WITH TEST AFTER                                          47750099
               VARYING PV-RETRY-COUNT                                   47760099
               FROM 1 BY 1                                              47770099
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 47780099
                         OR (SQLCODE = ZERO))                           47790099
               EXEC SQL                                                 47800099
                    OPEN XFER-LIST-CSR                                  47810099
               END-EXEC                                                 47820099
                                                                        47830099
                                                                        47840099
               EVALUATE TRUE                                            47850099
                   WHEN SQLCODE = ZERO                                  47860099
                   WHEN SQLCODE = -904                                  47870099
                   WHEN SQLCODE = -913                                  47880099
                       CONTINUE                                         47890099
                   WHEN OTHER                                           47900099
                       MOVE '4241-OPEN-LIST-CURSOR'                     47930099
                                         TO DP013-PARAGRAPH             47940099
                       MOVE 'ERROR OPENING THE TRANSFER LIST CURSOR '   47950099
                                         TO DP013-MESSAGE-TEXT (1)      47960099
                       MOVE SQLCA        TO DP013-SQLCA                 47970099
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    47980099
                       MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)    47990099
                       SET DP013-DB2-ABEND                              48000099
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           48010099
                       PERFORM DP013-0000-PROCESS-ABEND                 48020099
               END-EVALUATE                                             48030099
           END-PERFORM.                                                 48040099
                                                                        48050099
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          48060099
               MOVE '4241-OPEN-LIST-CURSOR'                             48070099
                                         TO DP013-PARAGRAPH             48080099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO '           48090099
                                         TO DP013-MESSAGE-TEXT (1)      48100099
               MOVE 'OPEN THE TRANSFER LIST CURSOR '                    48110099
                                         TO DP013-MESSAGE-TEXT (2)      48120099
               MOVE SQLCA                TO DP013-SQLCA                 48130099
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    48140099
               MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (2)    48150099
               SET DP013-DB2-ABEND                                      48160099
                   DP013-XCTL-DISPLAY-RESTART                           48170099
                                         TO TRUE                        48180099
               PERFORM DP013-0000-PROCESS-ABEND                         48190099
           END-IF.                                                      48200099
                                                                        48210099
       EJECT                                                            48220099
      *----------------------------------------------------------------*48230099
      * OPEN THE TRANSFER ITEM CURSOR.                                 *48240099
      *----------------------------------------------------------------*48250099
                                                                        48260099
       4242-OPEN-ITEM-CURSOR.                                           48270099
                                                                        48280099
           PERFORM                                                      48290099
               WITH TEST AFTER                                          48300099
               VARYING PV-RETRY-COUNT                                   48310099
               FROM 1 BY 1                                              48320099
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 48330099
                         OR (SQLCODE = ZERO))                           48340099
               EXEC SQL                                                 48350099
                    OPEN XFER-ITEM-CSR                                  48360099
               END-EXEC                                                 48370099
                                                                        48380099
                                                                        48390099
               EVALUATE TRUE                                            48400099
                   WHEN SQLCODE = ZERO                                  48410099
                   WHEN SQLCODE = -904                                  48420099
                   WHEN SQLCODE = -913                                  48430099
                       CONTINUE                                         48440099
                   WHEN OTHER                                           48450099
                       MOVE '4242-OPEN-ITEM-CURSOR'                     48480099
                                         TO DP013-PARAGRAPH             48490099
                       MOVE 'ERROR OPENING THE TRANSFER ITEM CURSOR '   48500099
                                         TO DP013-MESSAGE-TEXT (1)      48510099
                       MOVE SQLCA        TO DP013-SQLCA                 48520099
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    48530099
                       MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)    48540099
                       MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (3)    48550099
                       SET DP013-DB2-ABEND                              48560099
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           48570099
                       PERFORM DP013-0000-PROCESS-ABEND                 48580099
               END-EVALUATE                                             48590099
           END-PERFORM.                                                 48600099
                                                                        48610099
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          48620099
               MOVE '4242-OPEN-ITEM-CURSOR'                             48630099
                                         TO DP013-PARAGRAPH             48640099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO '           48650099
                                         TO DP013-MESSAGE-TEXT (1)      48660099
               MOVE 'OPEN THE TRANSFER ITEM CURSOR '                    48670099
                                         TO DP013-MESSAGE-TEXT (2)      48680099
               MOVE SQLCA                TO DP013-SQLCA                 48690099
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    48700099
               MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (2)    48710099
               MOVE 'TTFITEM'            TO DP013-DB2-TABLE-NAME (3)    48720099
               SET DP013-DB2-ABEND                                      48730099
                   DP013-XCTL-DISPLAY-RESTART                           48740099
                                         TO TRUE                        48750099
               PERFORM DP013-0000-PROCESS-ABEND                         48760099
           END-IF.                                                      48770099
                                                                        48780099
       EJECT                                                            48790099
      *----------------------------------------------------------------*48800099
      * CLOSE THE APPROPRIATE TRANSFER CURSOR.                         *48810099
      *----------------------------------------------------------------*48820099
                                                                        48830099
       4250-CLOSE-CURSOR.                                               48840099
                                                                        48850099
           IF PS-XFER-LIST-CSR                                          48860099
               PERFORM 4251-CLOSE-LIST-CURSOR                           48870099
           ELSE                                                         48880099
               PERFORM 4252-CLOSE-ITEM-CURSOR                           48890099
           END-IF.                                                      48900099
                                                                        48910099
       EJECT                                                            48920099
      *----------------------------------------------------------------*48930099
      * CLOSE THE TRANSFER LIST CURSOR.                                *48940099
      *----------------------------------------------------------------*48950099
                                                                        48960099
       4251-CLOSE-LIST-CURSOR.                                          48970099
                                                                        48980099
           EXEC SQL                                                     48990099
               CLOSE XFER-LIST-CSR                                      49000099
           END-EXEC.                                                    49010099
                                                                        49020099
           EVALUATE TRUE                                                49030099
               WHEN SQLCODE = ZERO                                      49040099
                   CONTINUE                                             49050099
               WHEN OTHER                                               49060099
                   MOVE '4251-CLOSE-LIST-CURSOR'                        49090099
                                     TO DP013-PARAGRAPH                 49100099
                   MOVE 'ERROR CLOSING THE TRANSFER LIST CURSOR '       49110099
                                     TO DP013-MESSAGE-TEXT (1)          49120099
                   MOVE SQLCA        TO DP013-SQLCA                     49130099
                   MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)        49140099
                   MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)        49150099
                   SET DP013-DB2-ABEND                                  49160099
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               49170099
                   PERFORM DP013-0000-PROCESS-ABEND                     49180099
           END-EVALUATE.                                                49190099
                                                                        49200099
       EJECT                                                            49210099
      *----------------------------------------------------------------*49220099
      * CLOSE THE TRANSFER ITEM CURSOR.                                *49230099
      *----------------------------------------------------------------*49240099
                                                                        49250099
       4252-CLOSE-ITEM-CURSOR.                                          49260099
                                                                        49270099
           EXEC SQL                                                     49280099
               CLOSE XFER-ITEM-CSR                                      49290099
           END-EXEC.                                                    49300099
                                                                        49310099
           EVALUATE TRUE                                                49320099
               WHEN SQLCODE = ZERO                                      49330099
                   CONTINUE                                             49340099
               WHEN OTHER                                               49350099
                   MOVE '4252-CLOSE-ITEM-CURSOR'                        49380099
                                     TO DP013-PARAGRAPH                 49390099
                   MOVE 'ERROR CLOSING THE TRANSFER ITEM CURSOR '       49400099
                                     TO DP013-MESSAGE-TEXT (1)          49410099
                   MOVE SQLCA        TO DP013-SQLCA                     49420099
                   MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)        49430099
                   MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)        49440099
                   MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (3)        49450099
                   SET DP013-DB2-ABEND                                  49460099
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               49470099
                   PERFORM DP013-0000-PROCESS-ABEND                     49480099
           END-EVALUATE.                                                49490099
                                                                        49500099
       EJECT                                                            49510099
      *----------------------------------------------------------------*49520099
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *49530099
      *    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *49540099
      *    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *49550099
      *    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *49560099
      *    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *49570099
      *                                                                *49580099
      *    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *49590099
      *    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *49600099
      *    UPON INITIALIZATION.                                        *49610099
      *----------------------------------------------------------------*49620099
                                                                        49630099
       4300-READ-ITEMS-FROM-DB.                                         49640099
                                                                        49650099
           SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       49660099
           PERFORM                                                      49670099
               VARYING PV-READ-COUNT                                    49680099
               FROM 1 BY 1                                              49690099
               UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    49700099
                  OR (ASC-NO-ITEMS-LEFT-ON-DB)                          49710099
                  OR (PS-ERROR-DB2))                                    49720099
                                                                        49730099
               PERFORM 4310-FETCH-CURSOR                                49740099
                                                                        49750099
               IF  ASC-ITEMS-LEFT-ON-DB AND                             49760099
                   PS-NO-ERROR-DB2                                      49770099
                   IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                49780099
                       ADD +1            TO ASC-ITEM-SUB                49790099
                   ELSE                                                 49800099
                       ADD +1            TO ASC-BLK-SUB                 49810099
                       MOVE +1           TO ASC-ITEM-SUB                49820099
                                                                        49830099
                       IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         49840099
                           MOVE +1       TO ASC-BLK-SUB                 49850099
                           SET ASC-BLOCK-MODIFIED (1)                   49860099
                                         TO TRUE                        49870099
                           PERFORM 5100-WRITE-TEMP-STORAGE              49880099
                           MOVE ASC-BLOCK-ENTRIES                       49890099
                                     (PC-MAX-BLOCKS-IN-ARRAY)           49900099
                                      TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 49910099
                           ADD +1        TO ASC-BLK-SUB                 49920099
                           INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   49930099
                           SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      49940099
                                         TO TRUE                        49950099
                       END-IF                                           49960099
                   END-IF                                               49970099
                   ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    49980099
                   MOVE ASC-NUMBER-OF-ITEMS-READ                        49990099
                                         TO ASC-LIST-ITEM-NUMBER        50000099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  50010099
                   MOVE TFMSTR-XFER-DKEY-ID                             50020099
                                         TO ASC-CONTROL-NBR             50030099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  50040099
                   MOVE TFMSTR-XFER-TYP-CDE(2:1)                        50050099
                                         TO PV-STATUS-TBL-SUB           50060099
111703************************************************************      50060199
111703** DEFECTIVE DAMAGED SORT1 XFER TYPE OF 0 CANNOT BE USED AS       50060299
111703** A SUBSCRIPT.  DEFAULT IT TO MAX TYPE CODE OF 8                 50060399
111703************************************************************      50060499
111703             IF PV-STATUS-TBL-SUB = 0                             50060599
111703                 MOVE 8 TO PV-STATUS-TBL-SUB                      50060699
111703             END-IF                                               50060799
                                                                        50062099
                   MOVE PV-XFER-TYPE-LINE-DESC (PV-STATUS-TBL-SUB)      50070099
                                         TO ASC-TRANSFER-TYPE           50080099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  50090099
                   MOVE TFMSTR-CONTNR-TYP-CDE(2:1)                      50100099
                                         TO PV-STATUS-TBL-SUB           50110099
                   MOVE PV-CONTNR-TYPE-LINE-DESC (PV-STATUS-TBL-SUB)    50120099
                                         TO ASC-CONTAINER-TYPE          50130099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  50140099
                   MOVE TFMSTR-TO-STR-NBR                               50150099
                                         TO ASC-TO-STORE-NBR            50160099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  50170099
                   MOVE TFMSTR-WRKSHT-PROB-IND                          50180099
                                         TO ASC-DISCREP-IND             50190099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  50200099
100404             MOVE XST00001-LOC-10-ABBR-NM                         50210099
                                         TO ASC-TO-STORE-NAME           50220099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  50230099
               END-IF                                                   50240099
           END-PERFORM.                                                 50250099
                                                                        50260099
           IF  ASC-NUMBER-OF-ITEMS-READ > ZERO  AND                     50270099
               PS-NO-ERROR-DB2                                          50280099
               MOVE +1               TO ASC-BLK-SUB                     50290099
               PERFORM 5100-WRITE-TEMP-STORAGE                          50300099
               ADD +1                TO ASC-BLK-SUB                     50310099
               PERFORM 5100-WRITE-TEMP-STORAGE                          50320099
                                                                        50330099
               MOVE 1                TO ASC-BLK-SUB                     50340099
                                        PV-BLOCK-NUMBER                 50350099
               PERFORM 4410-READ-TEMP-STORAGE                           50360099
               IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             50370099
                   MOVE 2            TO ASC-BLK-SUB                     50380099
                                        PV-BLOCK-NUMBER                 50390099
                   PERFORM 4410-READ-TEMP-STORAGE                       50400099
               END-IF                                                   50410099
           END-IF.                                                      50420099
                                                                        50430099
       EJECT                                                            50440099
      *----------------------------------------------------------------*50450099
      * FETCH THE APPROPRIATE TRANSFER CURSOR.                         *50460099
      *----------------------------------------------------------------*50470099
                                                                        50480099
       4310-FETCH-CURSOR.                                               50490099
                                                                        50500099
           IF PS-XFER-LIST-CSR                                          50510099
               PERFORM 4311-FETCH-LIST-CURSOR                           50520099
           ELSE                                                         50530099
               PERFORM 4312-FETCH-ITEM-CURSOR                           50540099
           END-IF.                                                      50550099
                                                                        50560099
       EJECT                                                            50570099
      *----------------------------------------------------------------*50580099
      * FETCH THE TRANSFER LIST CURSOR.                                *50590099
      *----------------------------------------------------------------*50600099
                                                                        50610099
       4311-FETCH-LIST-CURSOR.                                          50620099
                                                                        50630099
           EXEC SQL                                                     50640099
                FETCH XFER-LIST-CSR                                     50650099
                INTO  :TFMSTR-XFER-DKEY-ID                              50660099
                    , :TFMSTR-XFER-TYP-CDE                              50670099
                    , :TFMSTR-CONTNR-TYP-CDE                            50680099
                    , :TFMSTR-TO-STR-NBR                                50690099
                    , :TFMSTR-WRKSHT-PROB-IND                           50700099
100404              , :XST00001-LOC-10-ABBR-NM                          50710099
           END-EXEC.                                                    50720099
                                                                        50730099
           EVALUATE TRUE                                                50740099
               WHEN SQLCODE = ZERO                                      50750099
               WHEN SQLCODE = +100                                      50760099
                    CONTINUE                                            50770099
               WHEN OTHER                                               50780099
                    MOVE '4311-FETCH-LIST-CURSOR'                       50800099
                                     TO DP013-PARAGRAPH                 50810099
                    MOVE 'FETCH TRANSFER LIST CURSOR'                   50820099
                                     TO DP013-MESSAGE-TEXT (1)          50830099
                    MOVE SQLCA       TO DP013-SQLCA                     50840099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        50850099
100404              MOVE 'XST_LOC'   TO DP013-DB2-TABLE-NAME (2)        50860099
                    SET DP013-DB2-ABEND                                 50870099
                                     TO TRUE                            50880099
                    SET PS-ERROR-DB2  TO TRUE                           50890099
                    PERFORM DP013-0000-PROCESS-ABEND                    50900099
           END-EVALUATE.                                                50910099
                                                                        50920099
           IF  SQLCODE EQUAL +100                                       50930099
               SET ASC-NO-ITEMS-LEFT-ON-DB                              50940099
                                         TO TRUE                        50950099
           END-IF.                                                      50960099
                                                                        50970099
       EJECT                                                            50980099
      *----------------------------------------------------------------*50990099
      * FETCH THE TRANSFER ITEM CURSOR.                                *51000099
      *----------------------------------------------------------------*51010099
                                                                        51020099
       4312-FETCH-ITEM-CURSOR.                                          51030099
                                                                        51040099
           EXEC SQL                                                     51050099
                FETCH XFER-ITEM-CSR                                     51060099
                INTO  :TFMSTR-XFER-DKEY-ID                              51070099
                    , :TFMSTR-XFER-TYP-CDE                              51080099
                    , :TFMSTR-CONTNR-TYP-CDE                            51090099
                    , :TFMSTR-TO-STR-NBR                                51100099
                    , :TFMSTR-WRKSHT-PROB-IND                           51110099
100404              , :XST00001-LOC-10-ABBR-NM                          51120099
           END-EXEC.                                                    51130099
                                                                        51140099
           EVALUATE TRUE                                                51150099
               WHEN SQLCODE = ZERO                                      51160099
               WHEN SQLCODE = +100                                      51170099
                    CONTINUE                                            51180099
               WHEN OTHER                                               51190099
                    MOVE '4312-FETCH-ITEM-CURSOR'                       51210099
                                     TO DP013-PARAGRAPH                 51220099
                    MOVE 'FETCH TRANSFER ITEM CURSOR'                   51230099
                                     TO DP013-MESSAGE-TEXT (1)          51240099
                    MOVE SQLCA       TO DP013-SQLCA                     51250099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        51260099
100404              MOVE 'XST_LOC'   TO DP013-DB2-TABLE-NAME (2)        51270099
                    MOVE 'TTFITEM'   TO DP013-DB2-TABLE-NAME (3)        51280099
                    SET DP013-DB2-ABEND                                 51290099
                                     TO TRUE                            51300099
                    SET PS-ERROR-DB2  TO TRUE                           51310099
                    PERFORM DP013-0000-PROCESS-ABEND                    51320099
           END-EVALUATE.                                                51330099
                                                                        51340099
           IF  SQLCODE EQUAL +100                                       51350099
               SET ASC-NO-ITEMS-LEFT-ON-DB                              51360099
                                         TO TRUE                        51370099
           END-IF.                                                      51380099
                                                                        51390099
       EJECT                                                            51400099
      *----------------------------------------------------------------*51410099
      * MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *51420099
      *----------------------------------------------------------------*51430099
                                                                        51440099
       4400-MOVE-COMMAREA-TO-SCREEN.                                    51450099
           IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             51460099
               AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          51470099
               OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          51480099
                   MOVE +1    TO ASC-BLK-SUB                            51490099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      51500099
                   ADD +1     TO ASC-BLK-SUB                            51510099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      51520099
                   DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             51530099
                       GIVING PV-BLOCK-NUMBER                           51540099
                       REMAINDER PV-REMAINDER                           51550099
                   IF  PV-REMAINDER > ZERO                              51560099
                       ADD +1 TO PV-BLOCK-NUMBER                        51570099
                   END-IF                                               51580099
                   MOVE +1    TO ASC-BLK-SUB                            51590099
                   PERFORM 4410-READ-TEMP-STORAGE                       51600099
                   ADD +1     TO ASC-BLK-SUB                            51610099
                                 PV-BLOCK-NUMBER                        51620099
                   PERFORM 4410-READ-TEMP-STORAGE                       51630099
           END-IF.                                                      51640099
           MOVE +1            TO ASC-BLK-SUB.                           51650099
           COMPUTE ASC-ITEM-SUB =                                       51660099
               ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              51670099
               + PC-ITEMS-PER-PANEL).                                   51680099
      *                                                                 51690099
           IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        51700099
               ADD +1         TO ASC-BLK-SUB                            51710099
               SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            51720099
           END-IF.                                                      51730099
      *                                                                 51740099
           COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           51750099
               ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                51760099
           PERFORM 4420-FORMAT-LIST-LINES                               51770099
               VARYING PV-SUB                                           51780099
               FROM PC-ITEMS-PER-PANEL BY -1                            51790099
               UNTIL PV-SUB < +1.                                       51800099
      *                                                                 51810099
           COMPUTE ASC-ITEMS-DISPLAYED =                                51820099
               ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          51830099
           MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    51840099
                                            MR-START.                   51850099
           MOVE ASC-ITEM-AT-BOT-OF-PANEL TO MR-END.                     51860099
           MOVE ASC-NUMBER-OF-ITEMS-READ TO MR-TOTAL.                   51870099
           MOVE ASC-XFER-FR-STR          TO MR-FR-STORE-NBR.            51880099
           IF  DP020-MSG-NUMBER-X = SPACE                               51890099
               IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  51900099
      *            --- MORE ITEMS TO DISPLAY ----                       51910099
                   MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            51920099
                   SET DP020-MSG-INFORMATIONAL TO TRUE                  51930099
               END-IF                                                   51940099
           END-IF.                                                      51950099
      *----------------------------------------------------------------*51960099
      *    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *51970099
      *----------------------------------------------------------------*51980099
                                                                        51990099
       4410-READ-TEMP-STORAGE.                                          52000099
                                                                        52010099
           EXEC CICS                                                    52020099
               READQ TS                                                 52030099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          52040099
                   INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               52050099
                   ITEM  (PV-BLOCK-NUMBER)                              52060099
                   RESP  (PV-CICS-RESP)                                 52070099
           END-EXEC.                                                    52080099
                                                                        52090099
           IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       52100099
             OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     52110099
               CONTINUE                                                 52120099
           ELSE                                                         52130099
               SET DP013-CICS-ABEND     TO TRUE                         52140099
               SET DP013-NO-ROLLBACK    TO TRUE                         52150099
               MOVE '4410-READ-TEMP-STORAGE'                            52160099
                                        TO DP013-PARAGRAPH              52170099
               MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      52180099
                                        TO DP013-MESSAGE-TEXT(1)        52190099
               PERFORM DP013-0000-PROCESS-ABEND                         52200099
           END-IF.                                                      52210099
                                                                        52220099
           SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             52230099
      *                                                                 52240099
           IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         52250099
               INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               52260099
           END-IF.                                                      52270099
       EJECT                                                            52280099
      *----------------------------------------------------------------*52290099
      *    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *52300099
      *----------------------------------------------------------------*52310099
                                                                        52320099
       4420-FORMAT-LIST-LINES.                                          52330099
           IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      52340099
               SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                52350099
               MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           52360099
               MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           52370099
               MOVE SPACE              TO MR-SELECTI (PV-SUB)           52380099
                                          MR-ACTION (PV-SUB)            52390099
                                          MR-CONTROL-NBR (PV-SUB)       52400099
                                          MR-TRANSFER-TYPE (PV-SUB)     52410099
                                          MR-TO-STORE-NBR (PV-SUB)      52420099
                                          MR-TO-STORE-NAME (PV-SUB)     52430099
                                          MR-CONTAINER-TYPE (PV-SUB)    52440099
                                          MR-DISCREPANCY-SW (PV-SUB)    52450099
           ELSE                                                         52460099
               MOVE DP015-UNP-ALP-NOR-OFF                               52470099
                                       TO MR-SELECTA (PV-SUB)           52480099
               MOVE DP015-GREEN        TO MR-SELECTC (PV-SUB)           52490099
               MOVE DP015-UNDERLINE    TO MR-SELECTH (PV-SUB)           52500099
               IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      52510099
                                                         > SPACE        52520099
                   MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 52530099
                                       TO MR-SELECTI (PV-SUB)           52540099
               ELSE                                                     52550099
                   MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      52560099
                                       TO MR-SELECTI (PV-SUB)           52570099
               END-IF                                                   52580099
      *                                                                 52590099
               IF  DP030-SET-CURSOR-TRAILER                             52600099
                   IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)52610099
                       > SPACE)                                         52620099
                     OR (PV-SUB = 1))                                   52630099
                      SET DP030-SET-CURSOR-APPL-1 TO TRUE               52640099
                      MOVE -1          TO MR-SELECTL (PV-SUB)           52650099
                   END-IF                                               52660099
               END-IF                                                   52670099
      *                                                                 52680099
               IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           52690099
                   MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           52700099
                                       TO MR-ACTION (PV-SUB)            52710099
                   MOVE ASC-CONTROL-NBR (ASC-BLK-SUB ASC-ITEM-SUB)      52720099
                                       TO MR-CONTROL-NBR (PV-SUB)       52730099
                   MOVE ASC-TRANSFER-TYPE (ASC-BLK-SUB ASC-ITEM-SUB)    52740099
                                       TO MR-TRANSFER-TYPE (PV-SUB)     52750099
                   MOVE ASC-TO-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)     52760099
                                       TO MR-TO-STORE-NBR (PV-SUB)      52770099
                   MOVE ASC-TO-STORE-NAME (ASC-BLK-SUB ASC-ITEM-SUB)    52780099
                                       TO MR-TO-STORE-NAME (PV-SUB)     52790099
                   MOVE ASC-CONTAINER-TYPE (ASC-BLK-SUB ASC-ITEM-SUB)   52800099
                                       TO MR-CONTAINER-TYPE (PV-SUB)    52810099
                   MOVE ASC-DISCREP-IND (ASC-BLK-SUB ASC-ITEM-SUB)      52820099
                                       TO MR-DISCREPANCY-SW (PV-SUB)    52830099
               END-IF                                                   52840099
           END-IF.                                                      52850099
           SUBTRACT +1 FROM ASC-ITEM-SUB                                52860099
           IF  ASC-ITEM-SUB < + 1                                       52870099
               MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  52880099
               MOVE +1                 TO ASC-BLK-SUB                   52890099
           END-IF.                                                      52900099
       EJECT                                                            52900199
      *----------------------------------------------------------------*52900299
      *    GET THE STORE TYPE.                                         *52900399
      *----------------------------------------------------------------*52900499
       4500-READ-STORE.                                                 52900599
           PERFORM WITH TEST AFTER                                      52900699
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       52900799
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  52900899
                    OR SQLCODE = ZERO                                   52900999
                    OR SQLCODE = +100                                   52901099
               EXEC SQL                                                 52901199
100404             SELECT LOC_TYP_CDE                                   52901299
100404                 INTO :XST00001-LOC-TYP-CDE                       52901399
100404                 FROM XST_LOC                                     52901499
100404                 WHERE   (LOC_NBR        = :DK-STORE-NBR)         52901799
100404                   AND   (CHAR(OPN_DTE) <= CURRENT DATE           52901899
                                         AND                            52901999
100404                          CHAR(CLO_DTE) >= CURRENT DATE)          52902099
               END-EXEC                                                 52902199
               EVALUATE TRUE                                            52902299
                   WHEN SQLCODE = ZERO                                  52902399
100404                 MOVE XST00001-LOC-TYP-CDE TO PW-TO-STORE-TYPE    52902499
                       SET PS-STORE-FOUND        TO TRUE                52902599
                   WHEN SQLCODE = -904                                  52902699
                   WHEN SQLCODE = -913                                  52902799
                   WHEN SQLCODE = +100                                  52902899
                       CONTINUE                                         52902999
                   WHEN OTHER                                           52903199
                        MOVE '4500-READ-STORE'                          52903399
                                          TO DP013-PARAGRAPH            52903499
                        MOVE 'READ A ROW FROM THE STORE TABLE'          52903599
                                          TO DP013-MESSAGE-TEXT(1)      52903699
                        MOVE SQLCA        TO DP013-SQLCA                52903799
100404                  MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (1)   52903899
                        SET DP013-DB2-ABEND                             52903999
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          52904099
                        PERFORM DP013-0000-PROCESS-ABEND                52904199
               END-EVALUATE                                             52904299
           END-PERFORM.                                                 52904399
                                                                        52904499
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           52904599
               MOVE '4500-READ-STORE' TO DP013-PARAGRAPH                52904699
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO READ'       52904799
                                          TO DP013-MESSAGE-TEXT (1)     52904899
               MOVE 'THE STORE TABLE'     TO DP013-MESSAGE-TEXT (2)     52904999
               MOVE SQLCA                 TO DP013-SQLCA                52905099
100404         MOVE 'XST_LOC'             TO DP013-DB2-TABLE-NAME (1)   52905199
               SET DP013-DB2-ABEND                                      52905299
                   DP013-XCTL-DISPLAY-RESTART                           52905399
                                          TO TRUE                       52905499
               PERFORM DP013-0000-PROCESS-ABEND                         52905599
           END-IF.                                                      52905699
       EJECT                                                            52905799
051705*----------------------------------------------------------------*52905899
051705*    GET THE PHYSICAL INVENTORY PERIOD INDICATOR FROM TTFCNTL    *52905999
051705*----------------------------------------------------------------*52906099
051705*4520-READ-CONTROL-TABLE.                                         52907099
051705*    PERFORM                                                      52908099
051705*        WITH TEST AFTER                                          52909099
051705*        VARYING PV-RETRY-COUNT                                   52910099
051705*        FROM 1 BY 1                                              52920099
051705*        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 52930099
051705*            OR (SQLCODE = +0))                                   52940099
051705*        EXEC SQL                                                 52950099
051705*            SELECT PHY_INV_PERD_IND                              52960099
051705*                  ,XFER_INV_CTOFF_DTE                            52970099
051705*                  ,MAX_PLND_INV_DTE                              52980099
051705*             INTO :TFCNTL-PHY-INV-PERD-IND                       52990099
051705*                 ,:TFCNTL-XFER-INV-CTOFF-DTE                     53000099
051705*                 ,:TFCNTL-MAX-PLND-INV-DTE                       53010099
051705*             FROM TTFCNTL                                        53020099
051705*        END-EXEC                                                 53030099
051705*        EVALUATE TRUE                                            53040099
051705*            WHEN SQLCODE = ZERO                                  53050099
051705*                  MOVE TFCNTL-PHY-INV-PERD-IND                   53060099
051705*                                    TO PV-PHY-INV-PERD-IND       53070099
051705*                  MOVE TFCNTL-MAX-PLND-INV-DTE                   53080099
051705*                                    TO PV-MAX-PLND-INV-DTE       53090099
051705*                  MOVE TFCNTL-XFER-INV-CTOFF-DTE                 53100099
051705*                                    TO PV-XFER-INV-CTOFF-DTE     53110099
051705*            WHEN SQLCODE = -904                                  53120099
051705*            WHEN SQLCODE = -913                                  53130099
051705*                CONTINUE                                         53140099
051705*            WHEN OTHER                                           53150099
051705*                MOVE '4520-READ-CONTROL-TABLE'                   53180099
051705*                                  TO DP013-PARAGRAPH             53190099
051705*                MOVE 'GET THE PHYSICAL INV. PERIOD INDICATOR'    53200099
051705*                                      TO DP013-MESSAGE-TEXT (1)  53210099
051705*                MOVE SQLCA            TO DP013-SQLCA             53220099
051705*                MOVE 'TTFCNTL'        TO DP013-DB2-TABLE-NAME (1)53230099
051705*                SET DP013-DB2-ABEND                              53240099
051705*                DP013-XCTL-DISPLAY-RESTART                       53250099
051705*                                     TO TRUE                     53260099
051705*                PERFORM DP013-0000-PROCESS-ABEND                 53270099
051705*        END-EVALUATE                                             53280099
051705*    END-PERFORM.                                                 53290099
051705*                                                                 53300099
051705*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          53310099
051705*                MOVE '4520-READ-CONTROL-TABLE'                   53320099
051705*                                  TO DP013-PARAGRAPH             53330099
051705*                MOVE 'MAX RETRIES EXCEEDED READING '             53340099
051705*                                      TO DP013-MESSAGE-TEXT (1)  53350099
051705*                MOVE SQLCA            TO DP013-SQLCA             53360099
051705*                MOVE 'TTFCNTL'        TO DP013-DB2-TABLE-NAME (1)53370099
051705*                SET DP013-DB2-ABEND                              53380099
051705*                DP013-XCTL-DISPLAY-RESTART                       53390099
051705*                                     TO TRUE                     53400099
051705*                PERFORM DP013-0000-PROCESS-ABEND                 53410099
051705*    END-IF.                                                      53410199
051705*4530-CHECK-INVENTORY.                                            53410299
051705*    MOVE ASC-FROM-STORE     TO DK-STORE-NBR-9.                   53410499
051705*    PERFORM 4540-GET-PLND-INV-DTE.                               53410599
051705*    MOVE INVPAR-PLND-INV-DTE   TO PV-FR-STR-INV-DTE.             53410699
051705*    MOVE PW-TO-STORE-N      TO DK-STORE-NBR-9.                   53410799
051705*    PERFORM 4540-GET-PLND-INV-DTE.                               53410899
051705*    MOVE INVPAR-PLND-INV-DTE   TO PV-TO-STR-INV-DTE.             53410999
051705*    IF PW-CONTNR-TYPE = PC-HAND-CARRY                            53411099
051705*        EVALUATE TRUE                                            53412099
051705*            WHEN PV-FR-STR-INV-DTE >= PV-CURRENT-ISO-DATE AND    53413099
051705*                 PV-TO-STR-INV-DTE >= PV-CURRENT-ISO-DATE        53414099
051705*            WHEN PV-FR-STR-INV-DTE <  PV-CURRENT-ISO-DATE AND    53415099
051705*                 PV-TO-STR-INV-DTE <  PV-CURRENT-ISO-DATE        53416099
051705*                CONTINUE                                         53417099
051705*            WHEN OTHER                                           53417199
051705*                IF PS-NO-ERROR                                   53417299
051705*                    SET PS-ERROR           TO TRUE               53417399
051705*                END-IF                                           53417499
051705*        END-EVALUATE                                             53417599
051705*    ELSE                                                         53417699
051705*        IF PV-CURRENT-ISO-DATE > PV-XFER-INV-CTOFF-DTE  AND      53417799
051705*           PV-CURRENT-ISO-DATE <= PV-FR-STR-INV-DTE              53417899
051705*            SET ASC-DO-NOT-SHIP          TO TRUE                 53417999
051705*        END-IF                                                   53418099
051705*    END-IF.                                                      53418199
051705*----------------------------------------------------------------*53418299
051705*    GET THE MAX PLANNED INVENTORY DATE FOR THIS STORE           *53418399
051705*----------------------------------------------------------------*53418499
051705*4540-GET-PLND-INV-DTE.                                           53418599
051705*    PERFORM                                                      53418699
051705*        WITH TEST AFTER                                          53418799
051705*        VARYING PV-RETRY-COUNT                                   53418899
051705*        FROM 1 BY 1                                              53418999
051705*        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 53419099
051705*            OR (SQLCODE = +100)                                  53420099
051705*            OR (SQLCODE = +0))                                   53420199
051705*        EXEC SQL                                                 53420299
051705*            SELECT MAX(PLND_INV_DTE)                             53420399
051705*                INTO :INVPAR-PLND-INV-DTE                        53420499
051705*                     :PV-NULL-IND                                53420599
051705*                FROM TINVPAR                                     53420699
051705*                WHERE  LOC_NBR      = :DK-STORE-NBR-9      AND   53420799
051705*                       PLND_INV_DTE < :PC-MAX-DATE               53420899
051705*        END-EXEC                                                 53420999
051705*        EVALUATE TRUE                                            53421099
051705*            WHEN SQLCODE = ZERO                                  53422099
051705*            WHEN SQLCODE = -904                                  53423099
051705*            WHEN SQLCODE = -913                                  53424099
051705*                CONTINUE                                         53424199
051705*            WHEN SQLCODE = +100                                  53424299
051705*                MOVE PV-CURRENT-ISO-DATE TO INVPAR-PLND-INV-DTE  53424399
051705*            WHEN OTHER                                           53424499
051705*                MOVE '4540-GET-PLND-INV-DTE'                     53424799
051705*                                  TO DP013-PARAGRAPH             53424899
051705*                MOVE 'GET THE PLANNED INVENTORY DATE FOR STORE:' 53424999
051705*                                      TO DP013-MESSAGE-TEXT (1)  53425099
051705*                MOVE DK-STORE-NBR-9                              53426099
051705*                                      TO DP013-MESSAGE-TEXT (2)  53427099
051705*                MOVE SQLCA            TO DP013-SQLCA             53428099
051705*                MOVE 'TINVPAR'        TO DP013-DB2-TABLE-NAME (1)53429099
051705*                SET DP013-DB2-ABEND                              53430099
051705*                DP013-XCTL-DISPLAY-RESTART                       53440099
051705*                                     TO TRUE                     53450099
051705*                PERFORM DP013-0000-PROCESS-ABEND                 53450199
051705*        END-EVALUATE                                             53450299
051705*    END-PERFORM.                                                 53450399
051705*                                                                 53450499
051705*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          53450599
051705*                MOVE '4540-GET-PLND-INV-DTE'                     53450699
051705*                                  TO DP013-PARAGRAPH             53450799
051705*                MOVE 'MAX RETRIES EXCEEDED READING FOR STORE:'   53450899
051705*                                      TO DP013-MESSAGE-TEXT (1)  53450999
051705*                MOVE DK-STORE-NBR-9                              53451099
051705*                                      TO DP013-MESSAGE-TEXT (2)  53452099
051705*                MOVE SQLCA            TO DP013-SQLCA             53453099
051705*                MOVE 'TINVPAR'        TO DP013-DB2-TABLE-NAME (1)53454099
051705*                SET DP013-DB2-ABEND                              53455099
051705*                DP013-XCTL-DISPLAY-RESTART                       53456099
051705*                                     TO TRUE                     53457099
051705*                PERFORM DP013-0000-PROCESS-ABEND                 53458099
051705*    END-IF.                                                      53459099
051705*    IF PV-NULL-IND < 0                                           53460099
051705*        MOVE PV-CURRENT-ISO-DATE TO INVPAR-PLND-INV-DTE          53470099
051705*    END-IF.                                                      53470199
       4600-VALIDATE-PRICE.                                             53470299
           IF PW-GROUP-PRICED-ITEM   (PW-ITEM-SUB)                      53470399
               IF PW-PRICE-N(PW-ITEM-SUB)                               53470499
                                   NOT = PV-CUR-RTL-AMT                 53470599
      * -- THIS IS A GROUP PRICED ITEM; TRANSFER PRICE SHOULD BE --     53470699
                   IF PS-NO-ERROR                                       53470799
                       SET PS-ERROR          TO TRUE                    53470899
                   END-IF                                               53470999
               END-IF                                                   53471099
           ELSE                                                         53471199
             EVALUATE ASC-CMPLT-XFER-TYPE                               53471299
111703*         WHEN PC-DEFECTIVE-DAMAGE                                53471399
111703          WHEN PC-DEFECTIVE-DAMAGE-SORT1                          53471499
111703          WHEN PC-DEFECTIVE-DAMAGE-SORT2                          53471599
                   IF PW-PRICE-N(PW-ITEM-SUB)                           53471699
                                   < PV-CUR-RTL-AMT                     53471799
      * -- DAMAGED TAG PRICE MUST MATCH CURRENT FILE PRICE --           53471899
                       IF PS-NO-ERROR                                   53471999
                           SET PS-ERROR           TO TRUE               53472099
                       END-IF                                           53472199
                   END-IF                                               53472299
                WHEN PC-CALLBACK                                        53473099
                   CONTINUE                                             53473199
                WHEN PC-STOCK-BAL-STORE                                 53473299
                WHEN PC-STOCK-BAL-CORP                                  53473399
                WHEN PC-CUSTOMER                                        53473499
100404            IF (PV-NREGN-LOC-SKU-STAT-CDE = PC-CLEARANCE  AND     53473599
100404                XST00010-REGN-PRIC-IND NOT = PC-YES)              53473699
100404                IF PV-NREGN-UPC-STAT-CHG-DTE                      53473899
100404                                       < PV-NREGN-UNT-RTL-CHG-DTE 53473999
                          PERFORM 7750-GET-CLR-ITM-1ST-MKDN-PRIC        53474099
                      ELSE                                              53474199
100404                    MOVE XST00008-UNT-RTL-AMT TO PPCPRC-RTL-AMT   53474299
                      END-IF                                            53474399
                      IF PW-PRICE-N(PW-ITEM-SUB)                        53474499
                                        >  PPCPRC-RTL-AMT               53474599
      * -- ITEM IS IN CLEARANCE STATUS - COMPLETE INSTORE PRICE CHANGE -53474699
                         IF PS-NO-ERROR                                 53474799
                             SET PS-ERROR           TO TRUE             53474899
                         END-IF                                         53474999
                      END-IF                                            53475099
                  ELSE                                                  53475199
                      IF PW-PRICE-N(PW-ITEM-SUB)                        53475299
                                   NOT = PV-CUR-RTL-AMT                 53475399
      * -- PRICE MUST MATCH FILE PRICE - COMPLETE INSTORE PRICE CHANGE -53475499
                         IF PS-NO-ERROR                                 53475599
                             SET PS-ERROR           TO TRUE             53475699
                         END-IF                                         53475799
                      END-IF                                            53475899
                  END-IF                                                53475999
             END-EVALUATE                                               53476099
           END-IF.                                                      53476199
       EJECT                                                            53476299
      *----------------------------------------------------------------*53476399
      * PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *53476499
      * ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *53476599
      * FOR THE SELECTED ITEMS QUEUE.                                  *53476699
      *                                                                *53477099
      * FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *53478099
      * QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *53479099
      * THE ARRAY IS FULL.                                             *53480099
      *----------------------------------------------------------------*53490099
                                                                        53500099
       5000-PREPARE-SEL-QUEUE.                                          53510099
                                                                        53520099
           MOVE +1                   TO  ASC-BLK-SUB.                   53530099
           PERFORM 5100-WRITE-TEMP-STORAGE.                             53540099
           ADD +1                    TO  ASC-BLK-SUB.                   53550099
           PERFORM 5100-WRITE-TEMP-STORAGE.                             53560099
                                                                        53570099
           PERFORM 6010-DELETE-SEL-QUEUE.                               53580099
                                                                        53590099
           SET ASC-UPDATE-TSQ        TO  TRUE.                          53600099
                                                                        53610099
           SET TF421-IDX             TO  1.                             53620099
           INITIALIZE TF421-SELECTED-ITEM-ARRAY.                        53630099
                                                                        53640099
           PERFORM 5200-FILL-SEL-QUEUE-RECORD                           53650099
                   VARYING PV-ITEM                                      53660099
                   FROM 1 BY 1                                          53670099
                   UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     53680099
                                                                        53690099
           IF  TF421-IDX > 1                                            53700099
               PERFORM 5205-WRITE-SEL-QUEUE                             53710099
           END-IF.                                                      53720099
       EJECT                                                            53730099
      *----------------------------------------------------------------*53740099
      *    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *53750099
      *    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *53760099
      *----------------------------------------------------------------*53770099
                                                                        53780099
       5100-WRITE-TEMP-STORAGE.                                         53790099
           MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     53800099
                                         TO PV-LIST-ITEM-NUMBER.        53810099
           COMPUTE PV-BLOCK-NUMBER =                                    53820099
               1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    53830099
                                                                        53840099
           IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             53850099
           OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             53860099
               IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      53870099
                   PERFORM 5105-REWRITE-ASC-LISTQ                       53880099
               END-IF                                                   53890099
           ELSE                                                         53900099
               COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       53910099
               ASC-HIGHEST-BLOCK-WRITTEN + 1                            53920099
               PERFORM 5110-WRITE-ASC-LISTQ                             53930099
               ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   53940099
           END-IF.                                                      53950099
                                                                        53960099
           SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             53970099
      ******************************************************************53980099
      ** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **53990099
      ** SPECIFIC COMMAREA.                                           **54000099
      ******************************************************************54010099
       5105-REWRITE-ASC-LISTQ.                                          54020099
           EXEC CICS                                                    54030099
               WRITEQ TS                                                54040099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          54050099
                   FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               54060099
                   ITEM  (PV-BLOCK-NUMBER)                              54070099
                   REWRITE                                              54080099
                   RESP  (PV-CICS-RESP)                                 54090099
           END-EXEC.                                                    54100099
                                                                        54110099
           IF  PV-CICS-RESP = DFHRESP(NORMAL)                           54120099
               CONTINUE                                                 54130099
           ELSE                                                         54140099
               SET DP013-CICS-ABEND            TO TRUE                  54150099
               SET DP013-NO-ROLLBACK           TO TRUE                  54160099
               MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       54170099
               MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     54180099
                                               TO DP013-MESSAGE-TEXT(1) 54190099
               PERFORM DP013-0000-PROCESS-ABEND                         54200099
           END-IF.                                                      54210099
                                                                        54220099
      ******************************************************************54230099
      ** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **54240099
      ** SPECIFIC COMMAREA.                                           **54250099
      ******************************************************************54260099
       5110-WRITE-ASC-LISTQ.                                            54270099
           EXEC CICS                                                    54280099
               WRITEQ TS                                                54290099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          54300099
                   FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               54310099
                   ITEM  (PV-BLOCK-NUMBER)                              54320099
                   RESP  (PV-CICS-RESP)                                 54330099
           END-EXEC.                                                    54340099
           IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      54350099
               SET DP013-CICS-ABEND      TO TRUE                        54360099
               SET DP013-NO-ROLLBACK     TO TRUE                        54370099
               MOVE '5110-WRITE-ASC-LISTQ'                              54380099
                                         TO DP013-PARAGRAPH             54390099
               MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           54400099
                                         TO DP013-MESSAGE-TEXT(1)       54410099
               PERFORM DP013-0000-PROCESS-ABEND                         54420099
           END-IF.                                                      54430099
       EJECT                                                            54440099
      *----------------------------------------------------------------*54450099
      * READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *54460099
      * TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *54470099
      *----------------------------------------------------------------*54480099
                                                                        54490099
       5200-FILL-SEL-QUEUE-RECORD.                                      54500099
                                                                        54510099
           PERFORM 6112-READ-LIST-QUEUE.                                54520099
                                                                        54530099
           IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       54540099
               PERFORM                                                  54550099
               VARYING LQW-IDX                                          54560099
               FROM 1 BY 1                                              54570099
               UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            54580099
                 OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          54590099
                                                                        54600099
                   IF  LQW-SELECT (LQW-IDX)                             54610099
                       MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              54620099
                                     TO TF421-ITEM (TF421-IDX)          54630099
                       IF LQW-CONTROL-NBR (LQW-IDX) NOT =               54640099
                                                  ASC-SEL-CONTROL-NBR   54650099
                         AND ASC-SEL-CONTROL-NBR NOT = ZERO             54660099
                           SET PS-XFER-NBR-CHG TO TRUE                  54670099
                       END-IF                                           54680099
                       MOVE LQW-CONTROL-NBR  (LQW-IDX)                  54690099
                                     TO ASC-SEL-CONTROL-NBR             54700099
                       MOVE 'S'      TO TF421-ACTION-SW(TF421-IDX)      54710099
                       SET TF421-IDX UP BY 1                            54720099
                       IF  TF421-IDX > TF421-MAX-ITEMS                  54730099
                           PERFORM 5205-WRITE-SEL-QUEUE                 54740099
                           INITIALIZE TF421-SELECTED-ITEM-ARRAY         54750099
                           SET TF421-IDX TO  1                          54760099
                       END-IF                                           54770099
                   END-IF                                               54780099
               END-PERFORM                                              54790099
           END-IF.                                                      54800099
                                                                        54810099
      *----------------------------------------------------------------*54820099
      *    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *54830099
      *----------------------------------------------------------------*54840099
                                                                        54850099
       5205-WRITE-SEL-QUEUE.                                            54860099
                                                                        54870099
           EXEC CICS                                                    54880099
                WRITEQ TS                                               54890099
                    QUEUE (ASC-SEL-QUEUE-NAME)                          54900099
                    FROM  (TF421-SELECTED-LINES)                        54910099
                    ITEM  (PV-SEL-QUEUE-ITEM)                           54920099
                    RESP  (PV-CICS-RESP)                                54930099
           END-EXEC.                                                    54940099
                                                                        54950099
           IF  PV-CICS-RESP = DFHRESP (NORMAL)                          54960099
               CONTINUE                                                 54970099
           ELSE                                                         54980099
               SET DP013-CICS-ABEND      TO TRUE                        54990099
               SET DP013-NO-ROLLBACK     TO TRUE                        55000099
               MOVE '5205-WRITE-SEL-QUEUE'                              55010099
                                         TO DP013-PARAGRAPH             55020099
               MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          55030099
                                         TO DP013-MESSAGE-TEXT(1)       55040099
               PERFORM DP013-0000-PROCESS-ABEND                         55050099
           END-IF.                                                      55060099
       EJECT                                                            55070099
      ******************************************************************55080099
      *    SELECT THE TTFMSTR TABLE ROW FOR A WORKSHEET. IF THE         55090099
      *    WORKSHEET IS NOT COMPLETED, THE XFER-SEQ-NBR WILL            55100099
      *    BE NULL.                                                     55110099
      ******************************************************************55110199
       5300-VERIFY-WORKSHEET-EXISTS.                                    55110299
                                                                        55110399
           MOVE ASC-SEL-CONTROL-NBR      TO  TFMSTR-XFER-DKEY-ID.       55110499
                                                                        55110599
           PERFORM                                                      55110699
               WITH TEST AFTER                                          55110799
               VARYING PV-RETRY-COUNT                                   55110899
               FROM 1 BY 1                                              55110999
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 55111099
                   OR (SQLCODE = +0)                                    55112099
                   OR (SQLCODE = +100))                                 55113099
                                                                        55114099
               EXEC SQL                                                 55115099
                   SELECT                                               55116099
                          FR_STR_NBR                                    55117099
                         ,XFER_SEQ_NBR                                  55118099
                    INTO :TFMSTR-FR-STR-NBR                             55119099
                        ,:TFMSTR-XFER-SEQ-NBR                           55120099
                          :PV-NULL-IND                                  55130099
                    FROM TTFMSTR                                        55140099
                   WHERE XFER_DKEY_ID      = :TFMSTR-XFER-DKEY-ID       55150099
                     AND ENTR_MTHD_TYP_CDE = :PC-3270-ENTRY             55160099
               END-EXEC                                                 55170099
                                                                        55180099
               EVALUATE TRUE                                            55190099
                   WHEN SQLCODE = +0                                    55200099
                       MOVE TFMSTR-FR-STR-NBR       TO ASC-FROM-STORE   55210099
                       IF PV-NULL-IND < +0                              55220099
                           SET PS-WKSHT-FOUND       TO TRUE             55230099
                           MOVE ZEROES              TO ASC-XFER-SEQ-NBR 55240099
                       ELSE                                             55250099
                           SET PS-WKSHT-COMPLETED   TO TRUE             55260099
                           MOVE TFMSTR-XFER-SEQ-NBR TO ASC-XFER-SEQ-NBR 55270099
                       END-IF                                           55280099
                   WHEN SQLCODE = +100                                  55290099
                        SET PS-WKSHT-NOT-FOUND TO TRUE                  55300099
                   WHEN SQLCODE = -904                                  55310099
                   WHEN SQLCODE = -913                                  55320099
                        CONTINUE                                        55330099
                                                                        55340099
                   WHEN OTHER                                           55350099
                        MOVE '5300-VERIFY-WORKSHEET-EXISTS'             55380099
                                        TO DP013-PARAGRAPH              55390099
                        MOVE 'UNSUCCESSFUL SELECT'                      55400099
                                        TO DP013-MESSAGE-TEXT (1)       55410099
                        MOVE SQLCA      TO DP013-SQLCA                  55420099
                        MOVE 'TTFMSTR'  TO DP013-DB2-TABLE-NAME (1)     55430099
                        SET DP013-DB2-ABEND                             55440099
                            DP013-XCTL-DISPLAY-RESTART                  55450099
                                        TO TRUE                         55460099
                        PERFORM DP013-0000-PROCESS-ABEND                55470099
               END-EVALUATE                                             55480099
           END-PERFORM.                                                 55490099
                                                                        55500099
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          55510099
               MOVE '5300-VERIFY-WORKSHEET-EXISTS'                      55520099
                                        TO DP013-PARAGRAPH              55530099
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   55540099
                                        TO DP013-MESSAGE-TEXT (1)       55550099
               MOVE SQLCA               TO DP013-SQLCA                  55560099
               MOVE 'TTFMSTR   '        TO DP013-DB2-TABLE-NAME (1)     55570099
               SET DP013-DB2-ABEND                                      55580099
                   DP013-XCTL-DISPLAY-RESTART                           55590099
                                        TO TRUE                         55600099
               PERFORM DP013-0000-PROCESS-ABEND                         55610099
           END-IF.                                                      55620099
                                                                        55620199
           EJECT                                                        55620299
      ******************************************************************55620399
      ** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **55620499
      ** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **55620599
      ** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **55620699
      ** THE USER.                                                    **55620799
      ******************************************************************55620899
       6000-REFRESH-PANEL-FROM-TEMP.                                    55620999
           IF  ASC-UPDATE-TSQ AND                                       55621099
               ASC-NUMBER-OF-SELECTED-ITEMS > 0                         55622099
               SET ASC-NO-TSQ-UPDATE TO TRUE                            55623099
               MOVE ZERO                 TO PV-SAVE-ITEM                55624099
                                            PV-SEL-QUEUE-ITEM           55625099
               MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        55626099
                                         TO PV-HOLD-SELECTED-ITEMS      55627099
               PERFORM 6100-UPDATE-TSQ                                  55628099
                   UNTIL PV-ITEMS-PROCESSED >                           55629099
                                           PV-HOLD-SELECTED-ITEMS       55630099
               PERFORM 6010-DELETE-SEL-QUEUE                            55640099
               INITIALIZE ASC-BLOCK-ENTRIES (1)                         55650099
                          ASC-BLOCK-ENTRIES (2)                         55660099
               MOVE ZERO                 TO ASC-SEL-CONTROL-NBR         55670099
           END-IF.                                                      55680099
                                                                        55690099
      *----------------------------------------------------------------*55700099
      *    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *55710099
      *----------------------------------------------------------------*55720099
       6010-DELETE-SEL-QUEUE.                                           55730099
                                                                        55740099
           EXEC CICS                                                    55750099
               DELETEQ TS                                               55760099
                   QUEUE (ASC-SEL-QUEUE-NAME)                           55770099
                   RESP  (PV-CICS-RESP)                                 55780099
           END-EXEC.                                                    55790099
      *                                                                 55800099
           IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      55810099
              (PV-CICS-RESP = DFHRESP(QIDERR)))                         55820099
               CONTINUE                                                 55830099
           ELSE                                                         55840099
               SET DP013-CICS-ABEND TO TRUE                             55850099
               SET DP013-NO-ROLLBACK TO TRUE                            55860099
               MOVE '6010-DELETE-SEL-QUEUE'                             55870099
                              TO DP013-PARAGRAPH                        55880099
               MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         55890099
                              TO DP013-MESSAGE-TEXT (1)                 55900099
               PERFORM DP013-0000-PROCESS-ABEND                         55910099
           END-IF.                                                      55920099
                                                                        55930099
      *----------------------------------------------------------------*55940099
      *    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *55950099
      *    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *55960099
      *    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *55970099
      *    THE TEMP QUEUE.                                             *55980099
      *----------------------------------------------------------------*55990099
                                                                        56000099
       6100-UPDATE-TSQ.                                                 56010099
                                                                        56020099
           ADD 1                     TO  PV-SEL-QUEUE-ITEM.             56030099
           PERFORM 6105-READ-SEL-QUEUE.                                 56040099
           PERFORM                                                      56050099
               VARYING TF421-IDX                                        56060099
               FROM 1 BY 1                                              56070099
               UNTIL ((PV-ITEMS-PROCESSED >                             56080099
                                    PV-HOLD-SELECTED-ITEMS)             56090099
               OR (TF421-IDX GREATER THAN TF421-MAX-ITEMS))             56100099
               IF  TF421-ACTION-SW (TF421-IDX) > SPACE                  56110099
                   PERFORM 6110-PROCESS-ITEMS                           56120099
               END-IF                                                   56130099
               ADD +1                TO PV-ITEMS-PROCESSED              56140099
           END-PERFORM.                                                 56150099
           PERFORM 6111-WRITE-LIST-QUEUE.                               56160099
      *----------------------------------------------------------------*56170099
      *    READ THE LIST QUEUE RECORD.                                 *56180099
      *----------------------------------------------------------------*56190099
                                                                        56200099
       6105-READ-SEL-QUEUE.                                             56210099
                                                                        56220099
           EXEC CICS                                                    56230099
                READQ TS                                                56240099
                    QUEUE (ASC-SEL-QUEUE-NAME)                          56250099
                    INTO  (TF421-SELECTED-LINES)                        56260099
                    ITEM  (PV-SEL-QUEUE-ITEM)                           56270099
                    RESP  (PV-CICS-RESP)                                56280099
           END-EXEC.                                                    56290099
      *                                                                 56300099
           IF  PV-CICS-RESP = DFHRESP (NORMAL)                          56310099
               CONTINUE                                                 56320099
           ELSE                                                         56330099
               SET DP013-CICS-ABEND      TO  TRUE                       56340099
               SET DP013-NO-ROLLBACK     TO  TRUE                       56350099
               MOVE '6105-READ-SEL-QUEUE'                               56360099
                                         TO  DP013-PARAGRAPH            56370099
               MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           56380099
                                         TO  DP013-MESSAGE-TEXT(1)      56390099
               PERFORM DP013-0000-PROCESS-ABEND                         56400099
           END-IF.                                                      56410099
       EJECT                                                            56420099
      *----------------------------------------------------------------*56430099
      *    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*56440099
      *    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*56450099
      *    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *56460099
      *----------------------------------------------------------------*56470099
                                                                        56480099
       6110-PROCESS-ITEMS.                                              56490099
                                                                        56500099
           COMPUTE PV-ITEM = 1 + ((TF421-ITEM (TF421-IDX) - 1)          56510099
                           / PC-ITEMS-PER-PANEL).                       56520099
                                                                        56530099
           IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           56540099
               IF  PV-SAVE-ITEM NOT EQUAL ZERO                          56550099
                   PERFORM 6111-WRITE-LIST-QUEUE                        56560099
               END-IF                                                   56570099
               MOVE PV-ITEM          TO PV-SAVE-ITEM                    56580099
                                                                        56590099
               PERFORM 6112-READ-LIST-QUEUE                             56600099
               IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               56610099
                   CONTINUE                                             56620099
               END-IF                                                   56630099
           END-IF.                                                      56640099
                                                                        56650099
           COMPUTE PV-SUB = (TF421-ITEM (TF421-IDX)                     56660099
                          - LQW-LIST-ITEM-NUMBER (1)) + 1.              56670099
           SET LQW-DESELECT (PV-SUB) TO    TRUE                         56680099
           MOVE LQW-SELECTED-SW (PV-SUB)                                56690099
                                     TO LQW-TEMP-SELECTED-SW (PV-SUB).  56700099
                                                                        56710099
           SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                56720099
                                                                        56730099
      *----------------------------------------------------------------*56740099
      *    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *56750099
      *----------------------------------------------------------------*56760099
                                                                        56770099
       6111-WRITE-LIST-QUEUE.                                           56780099
                                                                        56790099
           EXEC CICS                                                    56800099
               WRITEQ TS                                                56810099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          56820099
                   FROM  (LQW-LIST-QUEUE-WORK-AREA)                     56830099
                   ITEM  (PV-SAVE-ITEM)                                 56840099
                   REWRITE                                              56850099
                   RESP  (PV-CICS-RESP)                                 56860099
           END-EXEC.                                                    56870099
      *                                                                 56880099
           IF  PV-CICS-RESP = DFHRESP (NORMAL)                          56890099
               CONTINUE                                                 56900099
           ELSE                                                         56910099
               SET DP013-CICS-ABEND  TO  TRUE                           56920099
               SET DP013-NO-ROLLBACK TO  TRUE                           56930099
               MOVE '6111-WRITE-LIST-QUEUE'                             56940099
                                     TO  DP013-PARAGRAPH                56950099
               MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  56960099
                                     TO  DP013-MESSAGE-TEXT(1)          56970099
               PERFORM DP013-0000-PROCESS-ABEND                         56980099
           END-IF.                                                      56990099
                                                                        57000099
       EJECT                                                            57010099
      *----------------------------------------------------------------*57020099
      *    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*57030099
      *----------------------------------------------------------------*57040099
                                                                        57050099
       6112-READ-LIST-QUEUE.                                            57060099
                                                                        57070099
           EXEC CICS                                                    57080099
               READQ TS                                                 57090099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          57100099
                   INTO  (LQW-LIST-QUEUE-WORK-AREA)                     57110099
                   ITEM  (PV-ITEM)                                      57120099
                   RESP  (PV-CICS-RESP)                                 57130099
           END-EXEC.                                                    57140099
      *                                                                 57150099
           IF  PV-CICS-RESP = DFHRESP (NORMAL)                          57160099
               CONTINUE                                                 57170099
           ELSE                                                         57180099
               SET DP013-CICS-ABEND        TO TRUE                      57190099
               SET DP013-NO-ROLLBACK       TO TRUE                      57200099
               MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           57210099
               MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    57220099
                                           TO DP013-MESSAGE-TEXT(1)     57230099
               PERFORM DP013-0000-PROCESS-ABEND                         57240099
           END-IF.                                                      57250099
                                                                        57260099
       EJECT                                                            57260199
      *----------------------------------------------------------------*57260299
      * SELECT DATA FROM THE TRANSFER TABLES TO PREPARE FOR COMPLETE.   57260399
      *----------------------------------------------------------------*57260499
       6200-GET-CONTROL-INFO.                                           57260599
           PERFORM                                                      57260699
               WITH TEST AFTER                                          57260799
               VARYING PV-RETRY-COUNT                                   57260899
               FROM 1 BY 1                                              57260999
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 57261099
                         OR (SQLCODE = ZERO)                            57261199
                         OR (SQLCODE = +100))                           57261299
      *                                                                 57261399
               EXEC SQL                                                 57261499
                   SELECT XFER_TYP_CDE                                  57261599
                         ,CONTNR_TYP_CDE                                57261699
                         ,TO_STR_NBR                                    57261799
                         ,CPLD_INIT_1ST_NM                              57261899
                         ,CPLD_LAST_NM                                  57261999
                         ,LG_TTE_1ST_SEAL_ID                            57262099
                         ,LG_TTE_2ND_SEAL_ID                            57262199
                         ,SM_TTE_BAG_SEAL_ID                            57262299
                         ,TRLR_NBR                                      57262399
                         ,TRLR_SEAL_ID                                  57262499
                         ,CLBK_NBR                                      57262599
                         ,STK_BAL_APVL_NBR                              57262699
                         ,RQSTR_INIT_1ST_NM                             57262799
                         ,RQSTR_LAST_NM                                 57262899
                         ,WRKSHT_PROB_IND                               57262999
                   INTO   :TFMSTR-XFER-TYP-CDE                          57263099
                         ,:TFMSTR-CONTNR-TYP-CDE                        57263199
                         ,:TFMSTR-TO-STR-NBR                            57263299
                         ,:TFMSTR-CPLD-INIT-1ST-NM                      57263399
                         ,:TFMSTR-CPLD-LAST-NM                          57263499
                         ,:TFMSTR-LG-TTE-1ST-SEAL-ID                    57263599
                         ,:TFMSTR-LG-TTE-2ND-SEAL-ID                    57263699
                         ,:TFMSTR-SM-TTE-BAG-SEAL-ID                    57263799
                         ,:TFMSTR-TRLR-NBR                              57263899
                         ,:TFMSTR-TRLR-SEAL-ID                          57263999
                         ,:TFMSTR-CLBK-NBR                              57264099
                         ,:TFMSTR-STK-BAL-APVL-NBR                      57264199
                         ,:TFMSTR-RQSTR-INIT-1ST-NM                     57264299
                         ,:TFMSTR-RQSTR-LAST-NM                         57264399
                         ,:TFMSTR-WRKSHT-PROB-IND                       57264499
                   FROM   TTFMSTR                                       57264599
                   WHERE  XFER_DKEY_ID   = :DK-XFER-DKEY-ID             57264699
               END-EXEC                                                 57264799
                                                                        57264899
               EVALUATE TRUE                                            57264999
                   WHEN SQLCODE = ZERO                                  57265099
                      MOVE TFMSTR-XFER-TYP-CDE  TO ASC-CMPLT-XFER-TYPE  57265199
                      MOVE TFMSTR-CONTNR-TYP-CDE TO PW-CONTNR-TYPE      57265299
                      MOVE TFMSTR-TO-STR-NBR    TO PW-TO-STORE-N        57265399
                      MOVE TFMSTR-CPLD-INIT-1ST-NM                      57265499
                                                TO PW-COMP-BY-INT       57265599
                      MOVE TFMSTR-CPLD-LAST-NM  TO PW-COMP-BY-NAM       57265699
                      MOVE TFMSTR-LG-TTE-1ST-SEAL-ID                    57265799
                                                TO PW-LG-TOTE-SEAL1     57265899
                      MOVE TFMSTR-LG-TTE-2ND-SEAL-ID                    57265999
                                                TO PW-LG-TOTE-SEAL2     57266099
                      MOVE TFMSTR-SM-TTE-BAG-SEAL-ID                    57266199
                                                TO PW-SM-TOTE-SEAL      57266299
                      MOVE TFMSTR-TRLR-NBR      TO PW-TRAILER-NBR       57266399
                      MOVE TFMSTR-TRLR-SEAL-ID  TO PW-TRAILER-SEAL      57266499
                      MOVE TFMSTR-CLBK-NBR      TO PW-CALLBACK-NBR-N    57266599
                      MOVE TFMSTR-STK-BAL-APVL-NBR                      57266699
                                                TO PW-APPROVAL-NBR-N    57266799
                      MOVE TFMSTR-RQSTR-INIT-1ST-NM                     57266899
                                                TO PW-REQ-BY-INT        57266999
                      MOVE TFMSTR-RQSTR-LAST-NM TO PW-REQ-BY-NAM        57267099
                      MOVE TFMSTR-WRKSHT-PROB-IND                       57267199
                                                TO ASC-PROB-IND         57267299
                      IF ASC-CMPLT-XFER-TYPE = PC-CUSTOMER              57267399
                          PERFORM 6250-READ-CUSTOMER                    57267499
                      END-IF                                            57267599
                      IF ASC-CMPLT-XFER-TYPE NOT = PC-NON-RETAIL        57267699
                          INITIALIZE PW-RETAIL-ITEM-ARRAY               57267799
                          PERFORM 6210-OPEN-RTL-CURSOR                  57267899
                          PERFORM 6220-READ-RTL-ITEMS-FROM-DB           57267999
                          PERFORM 6230-CLOSE-RTL-CURSOR                 57268099
                      ELSE                                              57268199
                          INITIALIZE PW-NON-RETAIL-ITEM-ARRAY           57268299
                          PERFORM 6310-OPEN-NRTL-CURSOR                 57268399
                          PERFORM 6320-READ-NRTL-ITEMS-FROM-DB          57268499
                          PERFORM 6330-CLOSE-NRTL-CURSOR                57268599
                      END-IF                                            57268699
                                                                        57268799
                   WHEN SQLCODE = +100                                  57268899
                   WHEN SQLCODE = -904                                  57268999
                   WHEN SQLCODE = -913                                  57269099
                       CONTINUE                                         57269199
                   WHEN OTHER                                           57269299
                       MOVE '6200-GET-CONTROL-INFO'                     57269599
                                         TO DP013-PARAGRAPH             57269699
                       MOVE 'SELECT TRANSFER DATA'                      57269799
                                         TO DP013-MESSAGE-TEXT (1)      57269899
                       MOVE SQLCA        TO DP013-SQLCA                 57269999
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    57270099
                       SET DP013-DB2-ABEND                              57270299
                           DP013-XCTL-DISPLAY-RESTART                   57270399
                                         TO TRUE                        57270499
                       PERFORM DP013-0000-PROCESS-ABEND                 57270599
               END-EVALUATE                                             57270699
           END-PERFORM.                                                 57270799
      *                                                                 57270899
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          57270999
               MOVE '6200-GET-CONTROL-INFO'                             57271099
                                         TO DP013-PARAGRAPH             57271199
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     57271299
                                         TO DP013-MESSAGE-TEXT (1)      57271399
               MOVE 'TRANSFER DATA'      TO DP013-MESSAGE-TEXT (2)      57271499
               MOVE SQLCA                TO DP013-SQLCA                 57271599
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    57271699
               SET DP013-DB2-ABEND                                      57271899
                   DP013-XCTL-DISPLAY-RESTART                           57271999
                                         TO TRUE                        57272099
               PERFORM DP013-0000-PROCESS-ABEND                         57272199
           END-IF.                                                      57272299
       EJECT                                                            57272399
      *----------------------------------------------------------------*57272499
      * SELECT DATA FROM THE TRANSFER THE CUSTOMER TABLE.              *57272599
      *----------------------------------------------------------------*57272699
       6250-READ-CUSTOMER.                                              57272799
           INITIALIZE DCLTTFCUST.                                       57272899
           PERFORM WITH TEST AFTER                                      57272999
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       57273099
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  57273199
                    OR SQLCODE = ZERO                                   57273299
                    OR SQLCODE = +100                                   57273399
               EXEC SQL                                                 57273499
                   SELECT CUST_NM                                       57273599
                         ,PHN_NBR                                       57273699
                       INTO :TFCUST-CUST-NM                             57273799
                           ,:TFCUST-PHN-NBR                             57273899
                       FROM TTFCUST                                     57273999
                       WHERE XFER_DKEY_ID  = :DK-XFER-DKEY-ID           57274099
               END-EXEC                                                 57274199
               EVALUATE TRUE                                            57274299
                   WHEN SQLCODE = ZERO                                  57274399
                       MOVE TFCUST-CUST-NM TO PW-CUST-NAME              57274499
                       MOVE TFCUST-PHN-NBR TO PW-PHONE-NBR              57274599
                   WHEN SQLCODE = +100                                  57274699
                       MOVE SPACES        TO PW-CUST-NAME               57274799
                                             PW-PHONE-NBR               57274899
                   WHEN SQLCODE = -904                                  57274999
                   WHEN SQLCODE = -913                                  57275099
                       CONTINUE                                         57275199
                   WHEN OTHER                                           57275299
                       MOVE '6250-READ-CUSTOMER'                        57275599
                                         TO DP013-PARAGRAPH             57275699
                       MOVE 'READ DATA FROM TTFCUST'                    57275799
                                         TO DP013-MESSAGE-TEXT (1)      57275899
                       MOVE SQLCA        TO DP013-SQLCA                 57275999
                       MOVE 'TTFCUST'    TO DP013-DB2-TABLE-NAME (1)    57276099
                       SET DP013-DB2-ABEND                              57276199
                           DP013-XCTL-DISPLAY-RESTART                   57276299
                                         TO TRUE                        57276399
                       PERFORM DP013-0000-PROCESS-ABEND                 57276499
               END-EVALUATE                                             57276599
           END-PERFORM.                                                 57276699
      *                                                                 57276799
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          57276899
               MOVE '6250-READ-CUSTOMER'                                57276999
                                         TO DP013-PARAGRAPH             57277099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     57277199
                                         TO DP013-MESSAGE-TEXT (1)      57277299
               MOVE 'DATA FROM TTFCUST'  TO DP013-MESSAGE-TEXT (2)      57277399
               MOVE SQLCA                TO DP013-SQLCA                 57277499
               MOVE 'TTFCUST'            TO DP013-DB2-TABLE-NAME (1)    57277599
               SET DP013-DB2-ABEND                                      57277699
                   DP013-XCTL-DISPLAY-RESTART                           57277799
                                         TO TRUE                        57277899
               PERFORM DP013-0000-PROCESS-ABEND                         57277999
           END-IF.                                                      57278099
       EJECT                                                            57278199
      *----------------------------------------------------------------*57278299
      * OPEN THE RETAIL TRANSFER ITEM CURSOR.                          *57278399
      *----------------------------------------------------------------*57278499
       6210-OPEN-RTL-CURSOR.                                            57278599
           PERFORM                                                      57278699
               WITH TEST AFTER                                          57278799
               VARYING PV-RETRY-COUNT                                   57278899
               FROM 1 BY 1                                              57278999
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 57279099
                         OR (SQLCODE = ZERO))                           57279199
                   EXEC SQL                                             57279299
                        OPEN RTL-ITEM-CSR                               57279399
                   END-EXEC                                             57279499
                                                                        57279599
               EVALUATE TRUE                                            57279699
                   WHEN SQLCODE = ZERO                                  57279799
                   WHEN SQLCODE = -904                                  57279899
                   WHEN SQLCODE = -913                                  57279999
                       CONTINUE                                         57280099
                   WHEN OTHER                                           57280199
                       MOVE '6210-OPEN-RTL-CURSOR'                      57280499
                                         TO DP013-PARAGRAPH             57280599
                       MOVE 'OPEN TRANSFER ITEM CURSOR - '              57280699
                                         TO DP013-MESSAGE-TEXT (1)      57280799
                       MOVE SQLCA        TO DP013-SQLCA                 57280899
                       MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)    57280999
                       SET DP013-DB2-ABEND                              57281099
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           57281199
                       PERFORM DP013-0000-PROCESS-ABEND                 57281299
               END-EVALUATE                                             57281399
           END-PERFORM.                                                 57281499
      *                                                                 57281599
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          57281699
               MOVE '6210-OPEN-RTL-CURSOR'   TO DP013-PARAGRAPH         57281799
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   57281899
                                         TO DP013-MESSAGE-TEXT (1)      57281999
               MOVE SQLCA                TO DP013-SQLCA                 57282099
               MOVE 'TTFITEM '           TO DP013-DB2-TABLE-NAME (1)    57282199
               SET DP013-DB2-ABEND                                      57282299
                   DP013-XCTL-DISPLAY-RESTART                           57282399
                                         TO TRUE                        57282499
               PERFORM DP013-0000-PROCESS-ABEND                         57282599
           END-IF.                                                      57282699
                                                                        57282799
       EJECT                                                            57282899
      *----------------------------------------------------------------*57282999
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *57283099
      *    BLOCKS IN THE ARRAY.  THE LIMIT IS 2 BLOCKS; WHEN THEY      *57283199
      *    BECOME FULL, STOP PROCESSING. (RETAIL TRANSFERS)            *57283299
      *----------------------------------------------------------------*57283399
                                                                        57283499
       6220-READ-RTL-ITEMS-FROM-DB.                                     57283599
                                                                        57283699
           SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       57283799
           PERFORM                                                      57283899
               UNTIL  ASC-NO-ITEMS-LEFT-ON-DB                           57283999
                                                                        57284099
               PERFORM 6240-FETCH-RTL-ITEMS                             57284199
                                                                        57284299
               IF  ASC-ITEMS-LEFT-ON-DB                                 57284399
                   ADD +1                TO ASC-NBR-OF-LINES-ENTERED    57284499
                   MOVE TFITEM-XFER-LNE-NBR TO PW-ITEM-SUB              57284599
                   MOVE TFITEM-XFER-QTY                  TO             57285299
                           PW-RTL-QTY-N      (PW-ITEM-SUB)              57285399
                   MOVE TFITEM-CPLD-RTL-PRIC-AMT         TO             57285499
                           PW-FILE-PRICE     (PW-ITEM-SUB)              57285599
                   IF TFITEM-SCN-UPC-NBR > 0                            57285699
                       MOVE TFITEM-SCN-UPC-NBR           TO             57285799
                           PW-UPC            (PW-ITEM-SUB)              57285899
                   END-IF                                               57285999
                   MOVE TFITEM-ITM-NBR                   TO             57286099
                           PW-ITEM-NBR       (PW-ITEM-SUB)              57286199
                   MOVE TFITEM-KOHLS-UPC-NBR             TO             57286299
                           PW-KOHLS-UPC      (PW-ITEM-SUB)              57286399
                   MOVE TFITEM-XFER-PRIC-AMT             TO             57286499
                           PW-PRICE-N        (PW-ITEM-SUB)              57286599
               END-IF                                                   57286699
           END-PERFORM.                                                 57286799
                                                                        57286899
       EJECT                                                            57286999
      *----------------------------------------------------------------*57287099
      * CLOSE THE TRANSFER ITEM CURSOR.                                *57287199
      *----------------------------------------------------------------*57287299
                                                                        57287399
       6230-CLOSE-RTL-CURSOR.                                           57287499
           EXEC SQL                                                     57287599
               CLOSE RTL-ITEM-CSR                                       57287699
           END-EXEC                                                     57287799
      *                                                                 57287899
           EVALUATE TRUE                                                57287999
               WHEN SQLCODE = ZERO                                      57288099
                   CONTINUE                                             57288199
               WHEN OTHER                                               57288299
                   MOVE '6230-CLOSE-RTL-CURSOR'                         57288599
                                     TO DP013-PARAGRAPH                 57288699
                   MOVE 'CLOSE TRANSFER ITEM CURSOR '                   57288799
                                     TO DP013-MESSAGE-TEXT (1)          57288899
                   MOVE SQLCA        TO DP013-SQLCA                     57288999
                   MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)        57289099
                   SET DP013-DB2-ABEND                                  57289199
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               57289299
                   PERFORM DP013-0000-PROCESS-ABEND                     57289399
           END-EVALUATE.                                                57289499
                                                                        57289599
       EJECT                                                            57289699
      *----------------------------------------------------------------*57289799
      *    FETCH THE TRANSFER ITEM CURSOR. (RETAIL TRANSFERS)          *57289899
      *----------------------------------------------------------------*57289999
                                                                        57290099
       6240-FETCH-RTL-ITEMS.                                            57290199
                                                                        57290299
           EXEC SQL                                                     57290399
               FETCH RTL-ITEM-CSR                                       57290499
               INTO                                                     57290599
                      :TFITEM-XFER-LNE-NBR                              57290699
                    , :TFITEM-CPLD-RTL-PRIC-AMT                         57291099
                    , :TFITEM-SCN-UPC-NBR                               57291199
                    , :TFITEM-KOHLS-UPC-NBR                             57291299
                    , :TFITEM-ITM-NBR                                   57291399
                    , :TFITEM-XFER-PRIC-AMT                             57291499
                    , :TFITEM-XFER-QTY                                  57291599
           END-EXEC                                                     57291699
                                                                        57291799
           EVALUATE TRUE                                                57291899
               WHEN SQLCODE = ZERO                                      57291999
                    CONTINUE                                            57292099
               WHEN SQLCODE = +100                                      57292199
                    SET ASC-NO-ITEMS-LEFT-ON-DB                         57292299
                                         TO TRUE                        57292399
               WHEN OTHER                                               57292499
                    MOVE '6240-FETCH-RTL-ITEMS'                         57292699
                                     TO DP013-PARAGRAPH                 57292799
                    MOVE 'FETCH RETAIL TRANSFER ITEM CURSOR'            57292899
                                     TO DP013-MESSAGE-TEXT (1)          57292999
                    MOVE 'TTFITEM '  TO DP013-DB2-TABLE-NAME (1)        57293099
                    MOVE SQLCA       TO DP013-SQLCA                     57293199
                    SET DP013-DB2-ABEND                                 57293299
                                     TO TRUE                            57293399
                    PERFORM DP013-0000-PROCESS-ABEND                    57293499
           END-EVALUATE.                                                57293599
                                                                        57293699
       EJECT                                                            57293799
      *----------------------------------------------------------------*57293899
      * OPEN THE NON-RETAIL TRANSFER ITEM CURSOR.                      *57293999
      *----------------------------------------------------------------*57294099
       6310-OPEN-NRTL-CURSOR.                                           57294199
           PERFORM                                                      57294299
               WITH TEST AFTER                                          57294399
               VARYING PV-RETRY-COUNT                                   57294499
               FROM 1 BY 1                                              57294599
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 57294699
                         OR (SQLCODE = ZERO))                           57294799
                   EXEC SQL                                             57294899
                        OPEN NRTL-ITEM-CSR                              57294999
                   END-EXEC                                             57295099
                                                                        57295199
               EVALUATE TRUE                                            57295299
                   WHEN SQLCODE = ZERO                                  57295399
                   WHEN SQLCODE = -904                                  57295499
                   WHEN SQLCODE = -913                                  57295599
                       CONTINUE                                         57295699
                   WHEN OTHER                                           57295799
                       MOVE '6310-OPEN-NRTL-CURSOR'                     57296099
                                         TO DP013-PARAGRAPH             57296199
                       MOVE 'OPEN TRANSFER ITEM CURSOR - '              57296299
                                         TO DP013-MESSAGE-TEXT (1)      57296399
                       MOVE SQLCA        TO DP013-SQLCA                 57296499
                       MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)    57296599
                       SET DP013-DB2-ABEND                              57296699
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           57296799
                       PERFORM DP013-0000-PROCESS-ABEND                 57296899
               END-EVALUATE                                             57296999
           END-PERFORM.                                                 57297099
      *                                                                 57297199
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          57297299
               MOVE '6310-OPEN-NRTL-CURSOR'   TO DP013-PARAGRAPH        57297399
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   57297499
                                         TO DP013-MESSAGE-TEXT (1)      57297599
               MOVE SQLCA                TO DP013-SQLCA                 57297699
               MOVE 'TTFITEM '           TO DP013-DB2-TABLE-NAME (1)    57297799
               SET DP013-DB2-ABEND                                      57297899
                   DP013-XCTL-DISPLAY-RESTART                           57297999
                                         TO TRUE                        57298099
               PERFORM DP013-0000-PROCESS-ABEND                         57298199
           END-IF.                                                      57298299
                                                                        57298399
       EJECT                                                            57298499
      *----------------------------------------------------------------*57298599
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *57298699
      *    BLOCKS IN THE ARRAY.  THE LIMIT IS 2 BLOCKS; WHEN THEY      *57298799
      *    BECOME FULL, STOP PROCESSING. (NON-RETAIL TRANSFERS)        *57298899
      *----------------------------------------------------------------*57298999
                                                                        57299099
       6320-READ-NRTL-ITEMS-FROM-DB.                                    57299199
                                                                        57299299
           SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       57299399
           PERFORM                                                      57299499
               UNTIL  ASC-NO-ITEMS-LEFT-ON-DB                           57299599
                                                                        57299699
               PERFORM 6340-FETCH-NRTL-ITEMS                            57299799
                                                                        57299899
               IF  ASC-ITEMS-LEFT-ON-DB                                 57299999
                   ADD +1                TO ASC-NBR-OF-LINES-ENTERED    57300099
                   MOVE TFITEM-XFER-LNE-NBR TO PW-ITEM-SUB              57300199
                   MOVE TFITEM-NRTL-FIXT-ID              TO             57300299
                           PW-FIXTURE        (PW-ITEM-SUB)              57300399
                   MOVE TFITEM-NRTL-DEPT-NBR             TO             57300499
                           PW-NRTL-DEPT      (PW-ITEM-SUB)              57300599
                   MOVE TFITEM-NRTL-1ST-LNE-DESC         TO             57300699
                           PW-ITEM-DESC1     (PW-ITEM-SUB)              57300799
                   MOVE TFITEM-NRTL-2ND-LNE-DESC         TO             57300899
                           PW-ITEM-DESC2     (PW-ITEM-SUB)              57300999
                   MOVE TFITEM-XFER-QTY                  TO             57301099
                           PW-NRTL-QTY-N     (PW-ITEM-SUB)              57301199
               END-IF                                                   57301299
           END-PERFORM.                                                 57301399
                                                                        57301499
       EJECT                                                            57301599
      *----------------------------------------------------------------*57301699
      * CLOSE THE NON-RETAIL TRANSFER ITEM CURSOR.                     *57301799
      *----------------------------------------------------------------*57301899
                                                                        57301999
       6330-CLOSE-NRTL-CURSOR.                                          57302099
           EXEC SQL                                                     57302199
               CLOSE NRTL-ITEM-CSR                                      57302299
           END-EXEC                                                     57302399
      *                                                                 57302499
           EVALUATE TRUE                                                57302599
               WHEN SQLCODE = ZERO                                      57302699
                   CONTINUE                                             57302799
               WHEN OTHER                                               57302899
                   MOVE '6330-CLOSE-NRTL-CURSOR'                        57303199
                                     TO DP013-PARAGRAPH                 57303299
                   MOVE 'CLOSE TRANSFER ITEM CURSOR '                   57303399
                                     TO DP013-MESSAGE-TEXT (1)          57303499
                   MOVE SQLCA        TO DP013-SQLCA                     57303599
                   MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)        57303699
                   SET DP013-DB2-ABEND                                  57303799
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               57303899
                   PERFORM DP013-0000-PROCESS-ABEND                     57303999
           END-EVALUATE.                                                57304099
                                                                        57304199
       EJECT                                                            57304299
      *----------------------------------------------------------------*57304399
      *    FETCH THE TRANSFER ITEM CURSOR. (NON-RETAIL)                *57304499
      *----------------------------------------------------------------*57304599
                                                                        57304699
       6340-FETCH-NRTL-ITEMS.                                           57304799
                                                                        57304899
           EXEC SQL                                                     57304999
               FETCH NRTL-ITEM-CSR                                      57305099
               INTO                                                     57305199
                      :TFITEM-XFER-LNE-NBR                              57305299
                    , :TFITEM-NRTL-1ST-LNE-DESC                         57305399
                    , :TFITEM-NRTL-2ND-LNE-DESC                         57305499
                    , :TFITEM-NRTL-FIXT-ID                              57305599
                    , :TFITEM-NRTL-DEPT-NBR                             57305699
                    , :TFITEM-XFER-QTY                                  57305799
           END-EXEC                                                     57305899
                                                                        57305999
           EVALUATE TRUE                                                57306099
               WHEN SQLCODE = ZERO                                      57306199
                    CONTINUE                                            57306299
               WHEN SQLCODE = +100                                      57306399
                    SET ASC-NO-ITEMS-LEFT-ON-DB                         57306499
                                         TO TRUE                        57306599
               WHEN OTHER                                               57306699
                    MOVE '6340-FETCH-NRTL-ITEMS'                        57306899
                                     TO DP013-PARAGRAPH                 57306999
                    MOVE 'FETCH NON-RETAIL TRANSFER ITEM CURSOR'        57307099
                                     TO DP013-MESSAGE-TEXT (1)          57307199
                    MOVE 'TTFITEM '  TO DP013-DB2-TABLE-NAME (1)        57307299
                    MOVE SQLCA       TO DP013-SQLCA                     57307399
                    SET DP013-DB2-ABEND                                 57307499
                                     TO TRUE                            57307599
                    PERFORM DP013-0000-PROCESS-ABEND                    57307699
           END-EVALUATE.                                                57307799
                                                                        57307899
       EJECT                                                            57307999
      *----------------------------------------------------------------*57308099
      *  UPDATE AND INSERT ROWS IN THE APPROPRIATE TABLES WHEN THE     *57308199
      *  COMPLETE TRANSFER FUNCTION IS SELECTED.                       *57308299
      *----------------------------------------------------------------*57308399
       7000-COMPLETE-TRANSFER.                                          57308499
           PERFORM 7100-PREPARE-COMPLETE.                               57308599
           INITIALIZE DCLTTFMSTR.                                       57308699
           MOVE ASC-SEL-CONTROL-NBR        TO TFMSTR-XFER-DKEY-ID.      57308799
           MOVE DP020-USERID               TO TFMSTR-CPLD-XFER-USR-ID.  57308899
           MOVE PV-XFER-SEQ-NBR            TO TFMSTR-XFER-SEQ-NBR       57308999
                                              ASC-XFER-SEQ-NBR.         57309099
           EXEC SQL                                                     57309199
               SET :PV-DB2-TIMESTAMP = CURRENT TIMESTAMP                57309299
           END-EXEC.                                                    57309399
           PERFORM 7200-COMPLETE-TTFMSTR                                57309499
           PERFORM 8000-DELETE-XFER-ITEMS.                              57309599
           MOVE 0                    TO PV-LINE-NBR.                    57309699
           IF ASC-CMPLT-XFER-TYPE NOT = PC-NON-RETAIL                   57309799
               PERFORM 9000-CHECK-RETAIL-ITEMS                          57309899
                 VARYING PW-ITEM-SUB                                    57309999
                   FROM 1 BY 1 UNTIL                                    57310099
                         PW-ITEM-SUB > PC-MAX-RETAIL-ITEMS              57310199
           ELSE                                                         57310299
               PERFORM 9200-CHECK-NON-RETAIL-ITEMS                      57310399
                 VARYING PW-ITEM-SUB                                    57310499
                   FROM 1 BY 1 UNTIL                                    57310599
                         PW-ITEM-SUB > PC-MAX-NON-RETAIL-ITEMS          57310699
           END-IF.                                                      57310799
           PERFORM 7400-INSERT-STATUS.                                  57310899
      *----------------------------------------------------------------*57310999
      *  DETERMINE THE NEXT SEQUENCE NUMBER TO BE ASSIGNED AS THE      *57311099
      *  TRANSFER NUMBER FOR THIS STORE.                               *57311199
      *----------------------------------------------------------------*57311299
       7100-PREPARE-COMPLETE.                                           57311399
           MOVE ASC-XFER-FR-STR    TO TFMSTR-FR-STR-NBR                 57311499
           PERFORM                                                      57311599
               WITH TEST AFTER                                          57311699
               VARYING PV-RETRY-COUNT                                   57311799
               FROM 1 BY 1                                              57311899
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 57311999
                         OR (SQLCODE = ZERO)                            57312099
                         OR (SQLCODE = +100))                           57312199
      *                                                                 57312299
               EXEC SQL                                                 57312399
                   SELECT MAX(XFER_SEQ_NBR)                             57312499
                   INTO   :PV-XFER-SEQ-NBR                              57312599
                          :PV-NULL-IND                                  57312699
                   FROM   TTFMSTR                                       57312799
                   WHERE  FR_STR_NBR     = :TFMSTR-FR-STR-NBR   AND     57312899
                          XFER_SEQ_NBR   IS NOT NULL                    57312999
               END-EXEC                                                 57313099
                                                                        57313199
               EVALUATE TRUE                                            57313299
                   WHEN SQLCODE = ZERO                                  57313399
                   WHEN SQLCODE = +100                                  57313499
                   WHEN SQLCODE = -904                                  57313599
                   WHEN SQLCODE = -913                                  57313699
                       CONTINUE                                         57313799
                   WHEN OTHER                                           57313899
                       MOVE '7100-PREPARE-COMPLETE'                     57314199
                                         TO DP013-PARAGRAPH             57314299
                       MOVE 'SELECT TRANSFER DATA'                      57314399
                                         TO DP013-MESSAGE-TEXT (1)      57314499
                       MOVE SQLCA        TO DP013-SQLCA                 57314599
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    57314699
                       SET DP013-DB2-ABEND                              57314799
                           DP013-XCTL-DISPLAY-RESTART                   57314899
                                         TO TRUE                        57314999
                       PERFORM DP013-0000-PROCESS-ABEND                 57315099
               END-EVALUATE                                             57315199
           END-PERFORM.                                                 57315299
      *                                                                 57315399
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          57315499
               MOVE '7100-PREPARE-COMPLETE'                             57315599
                                         TO DP013-PARAGRAPH             57315699
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     57315799
                                         TO DP013-MESSAGE-TEXT (1)      57315899
               MOVE 'TRANSFER DATA'      TO DP013-MESSAGE-TEXT (2)      57315999
               MOVE SQLCA                TO DP013-SQLCA                 57316099
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    57316199
               SET DP013-DB2-ABEND                                      57316299
                   DP013-XCTL-DISPLAY-RESTART                           57316399
                                         TO TRUE                        57316499
               PERFORM DP013-0000-PROCESS-ABEND                         57316599
           END-IF.                                                      57316699
           IF SQLCODE = +100                                            57316799
               MOVE +1                    TO PV-XFER-SEQ-NBR            57316899
           ELSE                                                         57316999
               IF PV-NULL-IND < 0                                       57317099
                   MOVE +1                TO PV-XFER-SEQ-NBR            57317199
               ELSE                                                     57317299
                   ADD +1                 TO PV-XFER-SEQ-NBR            57317399
               END-IF                                                   57317499
           END-IF.                                                      57317599
       EJECT                                                            57317699
      *----------------------------------------------------------------*57317799
      *  UPDATE THE TRANSFER MASTER TABLE WITH COMPLETE TRANSFER DATA. *57317899
      *----------------------------------------------------------------*57317999
       7200-COMPLETE-TTFMSTR.                                           57318099
           PERFORM                                                      57318199
             WITH TEST AFTER                                            57318299
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       57318399
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  57318499
                    OR SQLCODE = ZERO                                   57318599
                    OR SQLCODE = +100                                   57318699
               EXEC SQL                                                 57318799
                 UPDATE TTFMSTR                                         57318899
                   SET  XFER_SEQ_NBR       = :TFMSTR-XFER-SEQ-NBR       57318999
                       ,CMPT_XFER_END_TMST = :PV-DB2-TIMESTAMP          57319099
                       ,CPLD_XFER_USR_ID   = :TFMSTR-CPLD-XFER-USR-ID   57319199
                   WHERE (XFER_DKEY_ID  = :TFMSTR-XFER-DKEY-ID)         57319299
               END-EXEC                                                 57319399
               EVALUATE TRUE                                            57319499
                   WHEN SQLCODE = ZERO                                  57319599
                   WHEN SQLCODE = -904                                  57319699
                   WHEN SQLCODE = -913                                  57319799
                       CONTINUE                                         57319899
                   WHEN OTHER                                           57319999
                       MOVE '7200-COMPLETE-TTFMSTR'                     57320299
                                           TO DP013-PARAGRAPH           57320399
                       MOVE 'UPDATE A ROW IN TTFMSTR'                   57320499
                                           TO DP013-MESSAGE-TEXT (1)    57320599
                       MOVE SQLCA          TO DP013-SQLCA               57320699
                       MOVE 'TTFMSTR'      TO DP013-DB2-TABLE-NAME (1)  57320799
                       SET DP013-DB2-ABEND TO TRUE                      57320899
                       PERFORM DP013-0000-PROCESS-ABEND                 57320999
               END-EVALUATE                                             57321099
           END-PERFORM.                                                 57321199
                                                                        57321299
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           57321399
              MOVE '7200-COMPLETE-TTFMSTR'                              57321499
                                           TO DP013-PARAGRAPH           57321599
              MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE A ROW'57321699
                                           TO DP013-MESSAGE-TEXT (1)    57321799
              MOVE 'IN THE TRANSFER MASTER TABLE'                       57321899
                                           TO DP013-MESSAGE-TEXT (2)    57321999
              MOVE SQLCA                   TO DP013-SQLCA               57322099
              MOVE 'TTFMSTR'               TO DP013-DB2-TABLE-NAME (1)  57322199
              SET DP013-DB2-ABEND          TO TRUE                      57322299
              PERFORM DP013-0000-PROCESS-ABEND                          57322399
           END-IF.                                                      57322499
       EJECT                                                            57322599
      *----------------------------------------------------------------*57322699
      *  INSERT A ROW IN THE TRANSFER STATUS TABLE FOR COMPLETE XFER.  *57322799
      *----------------------------------------------------------------*57322899
       7400-INSERT-STATUS.                                              57322999
           INITIALIZE DCLTTFSTAT.                                       57323099
           MOVE TFMSTR-XFER-DKEY-ID        TO TFSTAT-XFER-DKEY-ID.      57324099
           MOVE PV-DB2-TIMESTAMP           TO TFSTAT-XFER-STAT-TMST.    57325099
           MOVE PC-COMPLETE-STATUS         TO TFSTAT-XFER-STAT-CDE.     57325199
           PERFORM WITH TEST AFTER                                      57325299
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       57325399
               UNTIL SQLCODE = 0 OR                                     57325499
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    57325599
               EXEC SQL                                                 57325699
                    INSERT                                              57325799
                      INTO TTFSTAT                                      57325899
                          (XFER_DKEY_ID                                 57325999
                         , XFER_STAT_TMST                               57326099
                         , XFER_STAT_CDE)                               57326199
                    VALUES                                              57326299
                          (:TFSTAT-XFER-DKEY-ID                         57326399
                         , :TFSTAT-XFER-STAT-TMST                       57326499
                         , :TFSTAT-XFER-STAT-CDE)                       57326599
               END-EXEC                                                 57326699
                                                                        57326799
               EVALUATE TRUE                                            57326899
                   WHEN SQLCODE = 0                                     57326999
                   WHEN SQLCODE = -904                                  57327099
                   WHEN SQLCODE = -913                                  57327199
                        CONTINUE                                        57327299
                   WHEN OTHER                                           57327399
                        MOVE '7400-INSERT-STATUS'                       57327499
                                          TO DP013-PARAGRAPH            57327599
                        MOVE 'INSERT A ROW INTO THE TTFSTAT TABLE'      57327699
                                          TO DP013-MESSAGE-TEXT(1)      57327799
                        MOVE SQLCA        TO DP013-SQLCA                57327899
                        MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (1)   57327999
                        SET DP013-DB2-ABEND                             57328099
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          57328199
                        PERFORM DP013-0000-PROCESS-ABEND                57328299
               END-EVALUATE                                             57328399
           END-PERFORM.                                                 57328499
                                                                        57328599
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       57328699
              SQLCODE NOT = 0                                           57328799
               MOVE '7400-INSERT-STATUS' TO DP013-PARAGRAPH             57328899
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     57328999
                                          TO DP013-MESSAGE-TEXT (1)     57329099
               MOVE 'A TRANSFER STATUS'   TO DP013-MESSAGE-TEXT (2)     57329199
               MOVE SQLCA                 TO DP013-SQLCA                57329299
               MOVE 'TTFSTAT'             TO DP013-DB2-TABLE-NAME (1)   57329399
               SET DP013-DB2-ABEND                                      57329499
                   DP013-XCTL-DISPLAY-RESTART                           57329599
                                          TO TRUE                       57329699
               PERFORM DP013-0000-PROCESS-ABEND                         57329799
           END-IF.                                                      57329899
       EJECT                                                            57329999
      *----------------------------------------------------------------*57330099
      *  SELECT THE CLEARANCE ITEM FIRST MARKDOWN PRICE.               *57330199
      *----------------------------------------------------------------*57330299
       7750-GET-CLR-ITM-1ST-MKDN-PRIC.                                  57330399
           INITIALIZE DCLTPPCPRC.                                       57330499
           MOVE PW-ITEM-NBR (PW-ITEM-SUB) TO DK-ITEM-NBR.               57330599
100404     MOVE PV-NREGN-LOC-SKU-STAT-CDE-9 TO DK-SKU-STATUS-CODE.      57330699
                                                                        57330799
           PERFORM                                                      57330899
               WITH TEST AFTER                                          57330999
               VARYING PV-RETRY-COUNT                                   57331099
               FROM 1 BY 1                                              57331199
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 57331299
                   OR (SQLCODE = +0)                                    57331399
                   OR (SQLCODE = +100))                                 57331499
                                                                        57331599
               EXEC SQL                                                 57331699
                   SELECT  MAX(RTL_AMT)                                 57331799
                     INTO  :PPCPRC-RTL-AMT                              57331899
                              :PV-NULL-IND                              57331999
                     FROM  TPPCPRC                                      57332099
                    WHERE  (TSK_ITM_NBR  =  :DK-ITEM-NBR                57332199
                      AND   STR_NBR      =  :PC-ZERO                    57332299
100404                AND   STATUS_CDE   =  :DK-SKU-STATUS-CODE)        57333099
               END-EXEC                                                 57334099
                                                                        57334199
               EVALUATE TRUE                                            57334299
                   WHEN SQLCODE = ZERO                                  57334399
                   WHEN SQLCODE = -904                                  57334499
                   WHEN SQLCODE = -913                                  57334599
                       CONTINUE                                         57334699
                   WHEN SQLCODE = +100                                  57334799
100404                 MOVE XST00008-UNT-RTL-AMT TO PPCPRC-RTL-AMT      57334899
                   WHEN OTHER                                           57334999
                       MOVE '7750-GET-CLR-ITM-1ST-MKDN-PRIC'            57337099
                                             TO DP013-PARAGRAPH         57338099
                       MOVE 'SELECT THE 1ST MARKDOWN PRICE FOR A CLEARAN57339099
      -                 'CE ITEM.  TSK-ITEM-NMBR:'                      57340099
                                             TO DP013-MESSAGE-TEXT (1)  57350099
                       MOVE DK-ITEM-NBR  TO PV-DISPLAY-ITM-NBR          57360099
                       MOVE PV-DISPLAY-ITM-NBR TO DP013-MESSAGE-TEXT (2)57370099
                       MOVE SQLCA            TO DP013-SQLCA             57380099
                       MOVE 'TPPCPRC'        TO DP013-DB2-TABLE-NAME (1)57380199
                       SET DP013-DB2-ABEND                              57380299
                       DP013-XCTL-DISPLAY-RESTART                       57380399
                                            TO TRUE                     57380499
                       PERFORM DP013-0000-PROCESS-ABEND                 57380599
               END-EVALUATE                                             57380699
           END-PERFORM.                                                 57380799
                                                                        57380899
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          57380999
                   MOVE '7750-GET-CLR-ITM-1ST-MKDN-PRIC'                57381099
                                             TO DP013-PARAGRAPH         57382099
                   MOVE 'SELECT THE 1ST MARKDOWN PRICE FOR A CLEARANCE I57383099
      -                 'TEM.  TSK-ITEM-NMBR:'                          57384099
                                             TO DP013-MESSAGE-TEXT (1)  57385099
                   MOVE DK-ITEM-NBR     TO PV-DISPLAY-ITM-NBR           57386099
                   MOVE PV-DISPLAY-ITM-NBR   TO DP013-MESSAGE-TEXT (2)  57387099
                   MOVE SQLCA                TO DP013-SQLCA             57388099
                   MOVE 'TPPCPRC'            TO DP013-DB2-TABLE-NAME (1)57388199
                   SET DP013-DB2-ABEND                                  57388299
                       DP013-XCTL-DISPLAY-RESTART                       57388399
                                            TO TRUE                     57388499
                   PERFORM DP013-0000-PROCESS-ABEND                     57388599
           END-IF.                                                      57388699
           IF PV-NULL-IND IS NEGATIVE                                   57388799
100404         MOVE XST00008-UNT-RTL-AMT TO PPCPRC-RTL-AMT              57388899
           END-IF.                                                      57388999
                                                                        57389099
       7800-CHECK-REGN-PRC.                                             57389199
           PERFORM                                                      57389399
               WITH TEST AFTER                                          57389499
               VARYING PV-RETRY-COUNT                                   57389599
               FROM 1 BY 1                                              57389699
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 57389799
                   OR (SQLCODE = +0)                                    57389899
                   OR (SQLCODE = +100))                                 57389999
               EXEC SQL                                                 57390099
100404             SELECT  LOC_SKU_STAT_CDE                             57391299
100404                    ,UNT_RTL_AMT                                  57391399
100404               INTO :PV-REGN-LOC-SKU-STAT-CDE                     57391699
100404                   ,:XST00008-UNT-RTL-AMT                         57391799
100404               FROM  XST_SKU_LOC A                                57392099
100404              WHERE  A.INTR_UPC_ID  = :XST00008-INTR-UPC-ID       57392199
100404                AND  A.LOC_NBR      = :DK-STORE-NBR               57392299
100404                AND  A.BEG_TMST    <= CURRENT TIMESTAMP           57392399
100404                AND  (A.END_TMST    > CURRENT TIMESTAMP           57392499
100404                 OR  A.END_TMST IS NULL)                          57392599
               END-EXEC                                                 57392699
                                                                        57392799
               EVALUATE TRUE                                            57392899
                   WHEN SQLCODE = ZERO                                  57392999
100404                 IF PV-REGN-LOC-SKU-STAT-CDE = PC-CLEARANCE       57393099
100404                     MOVE XST00008-UNT-RTL-AMT TO PV-CUR-RTL-AMT  57393199
                           MOVE +1                   TO PV-GP-QTY       57393299
                       END-IF                                           57393399
                   WHEN SQLCODE = +100                                  57393499
                   WHEN SQLCODE = -904                                  57393599
                   WHEN SQLCODE = -913                                  57393699
                       CONTINUE                                         57393799
                   WHEN OTHER                                           57393899
                       MOVE '7800-CHECK-REGN-PRC'                       57393999
                                             TO DP013-PARAGRAPH         57394099
100404                 MOVE 'SELECT DATA FROM XST_SKU_LOC'              57394199
                                             TO DP013-MESSAGE-TEXT (1)  57394299
                       MOVE SQLCA            TO DP013-SQLCA             57394399
100404                 MOVE 'XST_SKU_LOC'    TO DP013-DB2-TABLE-NAME (1)57394499
                       SET DP013-DB2-ABEND                              57394799
                           DP013-XCTL-DISPLAY-RESTART                   57394899
                                         TO TRUE                        57394999
                       PERFORM DP013-0000-PROCESS-ABEND                 57395099
               END-EVALUATE                                             57395199
           END-PERFORM.                                                 57395299
                                                                        57395399
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          57395499
               MOVE '7800-CHECK-REGN-PRC'                               57395599
                                     TO DP013-PARAGRAPH                 57395699
100404         MOVE 'SELECT DATA FROM XST_SKU_LOC'                      57395799
                                     TO DP013-MESSAGE-TEXT (1)          57395899
               MOVE SQLCA            TO DP013-SQLCA                     57395999
100404         MOVE 'XST_SKU_LOC'    TO DP013-DB2-TABLE-NAME (1)        57396099
               SET DP013-DB2-ABEND                                      57396399
                   DP013-XCTL-DISPLAY-RESTART                           57396499
                                 TO TRUE                                57396599
               PERFORM DP013-0000-PROCESS-ABEND                         57396699
           END-IF.                                                      57396799
      *                                                                 57396899
       8000-DELETE-XFER-ITEMS.                                          57396999
           MOVE ASC-SEL-CONTROL-NBR TO TFITEM-XFER-DKEY-ID.             57397099
           PERFORM WITH TEST AFTER                                      57397199
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       57397299
               UNTIL SQLCODE = 0    OR                                  57397399
                     SQLCODE = +100 OR                                  57397499
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    57397599
               EXEC SQL                                                 57397699
                    DELETE FROM TTFITEM                                 57397799
                    WHERE  (XFER_DKEY_ID   =  :TFITEM-XFER-DKEY-ID)     57397899
               END-EXEC                                                 57397999
                                                                        57398099
               EVALUATE TRUE                                            57398199
                   WHEN SQLCODE = ZERO                                  57398299
                   WHEN SQLCODE = +100                                  57398399
                   WHEN SQLCODE = -904                                  57398499
                   WHEN SQLCODE = -913                                  57398599
                      CONTINUE                                          57398699
                   WHEN OTHER                                           57398799
                      MOVE '8000-DELETE-XFER-ITEMS'                     57398899
                                             TO DP013-PARAGRAPH         57398999
                      MOVE 'DELETE TRANSFER ITEMS'                      57399099
                                             TO DP013-MESSAGE-TEXT (1)  57399199
                      MOVE SQLCA             TO DP013-SQLCA             57399299
                      MOVE 'TTFITEM'         TO DP013-DB2-TABLE-NAME (1)57399399
                      SET DP013-DB2-ABEND    TO TRUE                    57399499
               END-EVALUATE                                             57399599
           END-PERFORM.                                                 57399699
                                                                        57399799
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       57399899
              SQLCODE NOT = 0                                           57399999
               MOVE '8000-DELETE-XFER-ITEMS'       TO DP013-PARAGRAPH   57400099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO DELETE'     57400199
                                          TO DP013-MESSAGE-TEXT (1)     57400299
               MOVE 'TRANSFER ITEMS'      TO DP013-MESSAGE-TEXT (2)     57400399
               MOVE SQLCA                 TO DP013-SQLCA                57400499
               MOVE 'TTFITEM'             TO DP013-DB2-TABLE-NAME (1)   57400599
               SET DP013-DB2-ABEND                                      57400699
                   DP013-XCTL-DISPLAY-RESTART                           57400799
                                          TO TRUE                       57400899
               PERFORM DP013-0000-PROCESS-ABEND                         57400999
           END-IF.                                                      57401099
       9000-CHECK-RETAIL-ITEMS.                                         57401199
           IF PW-RTL-ITEM-NOT-UPDATED (PW-ITEM-SUB)                     57401299
                 AND PW-RTL-QTY (PW-ITEM-SUB) > SPACES                  57401399
               MOVE PW-RTL-QTY-N (PW-ITEM-SUB)                          57401499
                                       TO PV-HOLD-QTY                   57401599
               SET PW-RTL-ITEM-UPDATED (PW-ITEM-SUB)                    57401699
                                       TO TRUE                          57401799
               PERFORM 9050-COMPLETE-RETAIL-ITEMS                       57401899
                 VARYING PV-ITEM                                        57401999
                   FROM PW-ITEM-SUB BY 1                                57402099
                     UNTIL PV-ITEM >  PC-MAX-RETAIL-ITEMS               57402199
               PERFORM 9100-INSERT-RETAIL-ITEMS                         57402299
           END-IF.                                                      57402399
       9050-COMPLETE-RETAIL-ITEMS.                                      57402499
           IF PW-RTL-ITEM-NOT-UPDATED (PV-ITEM)                         57402599
               IF PW-KOHLS-UPC-DIGITS (PV-ITEM) = '0400' AND            57402699
                  PW-KOHLS-DUMMY-SKU  (PV-ITEM) = '000'                 57402799
                   IF (PW-KOHLS-UPC (PV-ITEM) =                         57402899
                       PW-KOHLS-UPC (PW-ITEM-SUB)) AND                  57402999
                      (PW-PRICE (PV-ITEM) =                             57403099
                       PW-PRICE (PW-ITEM-SUB))                          57403199
                        ADD PW-RTL-QTY-N (PV-ITEM)                      57403299
                                        TO PV-HOLD-QTY                  57403399
                        SET PW-RTL-ITEM-UPDATED (PV-ITEM)               57403499
                                        TO TRUE                         57403599
                   END-IF                                               57403699
               ELSE                                                     57403799
                   IF (PW-ITEM-NBR   (PV-ITEM) =                        57403899
                       PW-ITEM-NBR   (PW-ITEM-SUB)) AND                 57403999
                      (PW-PRICE (PV-ITEM) =                             57404099
                       PW-PRICE (PW-ITEM-SUB))                          57404199
                        ADD PW-RTL-QTY-N (PV-ITEM)                      57404299
                                        TO PV-HOLD-QTY                  57404399
                        SET PW-RTL-ITEM-UPDATED (PV-ITEM)               57404499
                                        TO TRUE                         57404599
                   END-IF                                               57404699
               END-IF                                                   57404799
           END-IF.                                                      57404899
       EJECT                                                            57404999
       9100-INSERT-RETAIL-ITEMS.                                        57405099
           INITIALIZE DCLTTFITEM.                                       57405199
           MOVE ASC-SEL-CONTROL-NBR        TO TFITEM-XFER-DKEY-ID.      57405299
           ADD +1                          TO PV-LINE-NBR.              57405399
           MOVE PV-LINE-NBR                TO TFITEM-XFER-LNE-NBR.      57405499
           MOVE PW-UPC   (PW-ITEM-SUB)     TO TFITEM-SCN-UPC-NBR.       57405599
           MOVE PW-KOHLS-UPC (PW-ITEM-SUB)                              57405699
                                           TO TFITEM-KOHLS-UPC-NBR.     57405799
           MOVE PW-ITEM-NBR   (PW-ITEM-SUB)                             57405899
                                           TO TFITEM-ITM-NBR.           57405999
           MOVE PW-PRICE-N (PW-ITEM-SUB)                                57406099
                                           TO TFITEM-XFER-PRIC-AMT.     57406199
           MOVE PW-FILE-PRICE (PW-ITEM-SUB)                             57406299
                                           TO TFITEM-CPLD-RTL-PRIC-AMT. 57406399
           MOVE PW-GROUP-PRICED-SW (PW-ITEM-SUB)                        57406499
                                           TO TFITEM-ITM-PRIC-MLT-IND.  57406599
           MOVE PV-HOLD-QTY                TO TFITEM-XFER-QTY.          57406699
           PERFORM WITH TEST AFTER                                      57406799
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       57406899
               UNTIL SQLCODE = 0 OR                                     57406999
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    57407099
                                                                        57407199
               EXEC SQL                                                 57407299
                    INSERT                                              57407399
                      INTO TTFITEM                                      57407499
                          (XFER_DKEY_ID                                 57407599
                         , XFER_LNE_NBR                                 57407699
                         , CPLD_RTL_PRIC_AMT                            57407799
                         , SCN_UPC_NBR                                  57407899
                         , KOHLS_UPC_NBR                                57407999
                         , ITM_NBR                                      57408099
                         , XFER_PRIC_AMT                                57408199
                         , ITM_PRIC_MLT_IND                             57408299
                         , XFER_QTY)                                    57408399
                    VALUES                                              57408499
                          (:TFITEM-XFER-DKEY-ID                         57408599
                         , :TFITEM-XFER-LNE-NBR                         57408699
                         , :TFITEM-CPLD-RTL-PRIC-AMT                    57408799
                         , :TFITEM-SCN-UPC-NBR                          57408899
                         , :TFITEM-KOHLS-UPC-NBR                        57408999
                         , :TFITEM-ITM-NBR                              57409099
                         , :TFITEM-XFER-PRIC-AMT                        57409199
                         , :TFITEM-ITM-PRIC-MLT-IND                     57409299
                         , :TFITEM-XFER-QTY)                            57409399
               END-EXEC                                                 57409499
                                                                        57409599
               EVALUATE TRUE                                            57409699
                   WHEN SQLCODE = 0                                     57409799
                   WHEN SQLCODE = -904                                  57409899
                   WHEN SQLCODE = -913                                  57409999
                        CONTINUE                                        57410099
                   WHEN OTHER                                           57410199
                        MOVE '9100-INSERT-RETAIL-ITEMS'                 57410299
                                          TO DP013-PARAGRAPH            57410399
                        MOVE 'INSERT A ROW INTO THE TTFITEM TABLE'      57410499
                                          TO DP013-MESSAGE-TEXT(1)      57410599
                        MOVE SQLCA        TO DP013-SQLCA                57410699
                        MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)   57410799
                        SET DP013-DB2-ABEND                             57410899
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          57410999
                        PERFORM DP013-0000-PROCESS-ABEND                57411099
               END-EVALUATE                                             57411199
           END-PERFORM.                                                 57411299
                                                                        57411399
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       57411499
              SQLCODE NOT = 0                                           57411599
               MOVE '9100-INSERT-RETAIL-ITEMS' TO DP013-PARAGRAPH       57411699
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     57411799
                                          TO DP013-MESSAGE-TEXT (1)     57411899
               MOVE 'A TRANSFER ITEM'     TO DP013-MESSAGE-TEXT (2)     57411999
               MOVE SQLCA                 TO DP013-SQLCA                57412099
               MOVE 'TTFITEM'             TO DP013-DB2-TABLE-NAME (1)   57412199
               SET DP013-DB2-ABEND                                      57412299
                   DP013-XCTL-DISPLAY-RESTART                           57412399
                                          TO TRUE                       57412499
               PERFORM DP013-0000-PROCESS-ABEND                         57412599
           END-IF.                                                      57412699
       EJECT                                                            57412799
       9200-CHECK-NON-RETAIL-ITEMS.                                     57412899
           IF PW-NRTL-QTY (PW-ITEM-SUB) > SPACES                        57412999
               PERFORM 9300-INSERT-NON-RETAIL-ITEMS                     57413099
           END-IF.                                                      57413199
       9300-INSERT-NON-RETAIL-ITEMS.                                    57413299
           INITIALIZE DCLTTFITEM.                                       57413399
           MOVE ASC-SEL-CONTROL-NBR        TO TFITEM-XFER-DKEY-ID.      57413499
           ADD +1                          TO PV-LINE-NBR.              57413599
           MOVE PV-LINE-NBR                TO TFITEM-XFER-LNE-NBR.      57413699
           MOVE PW-ITEM-DESC1 (PW-ITEM-SUB)                             57413799
                                           TO TFITEM-NRTL-1ST-LNE-DESC. 57413899
           MOVE PW-ITEM-DESC2 (PW-ITEM-SUB)                             57413999
                                           TO TFITEM-NRTL-2ND-LNE-DESC. 57414099
           MOVE PW-NRTL-QTY-N (PW-ITEM-SUB)                             57414199
                                           TO TFITEM-XFER-QTY.          57414299
           MOVE PW-NRTL-DEPT (PW-ITEM-SUB)                              57414399
                                           TO TFITEM-NRTL-DEPT-NBR      57414499
           MOVE PW-FIXTURE   (PW-ITEM-SUB)                              57414599
                                           TO TFITEM-NRTL-FIXT-ID.      57414699
           PERFORM WITH TEST AFTER                                      57414799
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       57414899
               UNTIL SQLCODE = 0 OR                                     57414999
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    57415099
                                                                        57415199
               EXEC SQL                                                 57415299
                    INSERT                                              57415399
                      INTO TTFITEM                                      57415499
                          (XFER_DKEY_ID                                 57415599
                         , XFER_LNE_NBR                                 57415699
                         , NRTL_1ST_LNE_DESC                            57415799
                         , NRTL_2ND_LNE_DESC                            57415899
                         , NRTL_FIXT_ID                                 57415999
                         , NRTL_DEPT_NBR                                57416099
                         , XFER_QTY)                                    57416199
                    VALUES                                              57416299
                          (:TFITEM-XFER-DKEY-ID                         57416399
                         , :TFITEM-XFER-LNE-NBR                         57416499
                         , :TFITEM-NRTL-1ST-LNE-DESC                    57416599
                         , :TFITEM-NRTL-2ND-LNE-DESC                    57416699
                         , :TFITEM-NRTL-FIXT-ID                         57416799
                         , :TFITEM-NRTL-DEPT-NBR                        57416899
                         , :TFITEM-XFER-QTY)                            57416999
               END-EXEC                                                 57417099
                                                                        57417199
               EVALUATE TRUE                                            57417299
                   WHEN SQLCODE = 0                                     57417399
                   WHEN SQLCODE = -904                                  57417499
                   WHEN SQLCODE = -913                                  57417599
                        CONTINUE                                        57417699
                   WHEN OTHER                                           57417799
                        MOVE '9300-INSERT-NON-RETAIL-ITEMS'             57417899
                                          TO DP013-PARAGRAPH            57417999
                        MOVE 'INSERT A ROW INTO THE TTFITEM TABLE'      57418099
                                          TO DP013-MESSAGE-TEXT(1)      57418199
                        MOVE SQLCA        TO DP013-SQLCA                57418299
                        MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)   57418399
                        SET DP013-DB2-ABEND                             57418499
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          57418599
                        PERFORM DP013-0000-PROCESS-ABEND                57418699
               END-EVALUATE                                             57418799
           END-PERFORM.                                                 57418899
                                                                        57418999
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       57419099
              SQLCODE NOT = 0                                           57419199
               MOVE '9300-INSERT-NON-RETAIL-ITEMS' TO DP013-PARAGRAPH   57419299
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     57419399
                                          TO DP013-MESSAGE-TEXT (1)     57419499
               MOVE 'A TRANSFER ITEM'     TO DP013-MESSAGE-TEXT (2)     57419599
               MOVE SQLCA                 TO DP013-SQLCA                57419699
               MOVE 'TTFITEM'             TO DP013-DB2-TABLE-NAME (1)   57419799
               SET DP013-DB2-ABEND                                      57419899
                   DP013-XCTL-DISPLAY-RESTART                           57419999
                                          TO TRUE                       57420099
               PERFORM DP013-0000-PROCESS-ABEND                         57420199
           END-IF.                                                      57420299
       EJECT                                                            57420399
      *----------------------------------------------------------------*57420499
      *    ABEND PROCESSOR MODULE                                      *57420599
      *----------------------------------------------------------------*57420699
                                                                        57421099
           COPY DPPD013.                                                57430099
