000100*                                                                 00010000
000200*                                                                 00020000
000300*                                                                 00030000
000400 IDENTIFICATION DIVISION.                                         00040000
000500                                                                  00050000
000600 PROGRAM-ID.    MBKCS106.                                         00060000
000700 AUTHOR.        MICHELLE WEBB.                                    00070000
000800 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00080000
000900 DATE-WRITTEN.  10-14-91.                                         00090000
001000 DATE-COMPILED.                                                   00100000
001100                                                                  00110000
001200***************************************************************** 00120000
001300*  MERCHANDISE AREA RESPONSIBILITY ADD SCREEN                     00130000
001400*                                                                 00140000
001500*  THIS PROGRAM CAN BE ACCESSED THRU THREE SEPARATE PROGRAMS :    00150000
001600*  MBKCS104, MBKCS114 AND MBKCS110.                               00160000
001700*                                                                 00170000
001800*  THIS PROGRAM HAS TWO SEPARATE FUNCTIONS:                       00180000
001900*    1) ADDS THE MERCHANDISE AREA DATA FOR THE MAJOR CLASS AND    00190000
002000*       SUB CLASS WITHOUT DISPLAYING THE RESPONSIBILITY ADD SCREEN00200000
002100*    2) DISPLAYS AND PROCESSES THE RESPONSIBILITY ADD DATA IF THE 00210000
002200*       USER IS ADDING A DMA, GMA OR DPT, AND THEN ADDS THE       00220000
002300*       CORRESPONDING MERCHANDISE AREA.                           00230000
002400*                                                                 00240000
002500*  A TSQ IS BUILT IN THE SENDING PROGRAM THAT WILL CARRY THE      00250000
002600*  MERCHANDISE DATA ALREADY CREATED IN THE SENDING PROGRAMS.      00260000
002700*                                                                 00270000
002800*  NOTE THAT THE SCREEN HAS BEEN REDEFINED IN WORKING STORAGE     00280000
002900*  TO MAKE TABLE HANDLING A LITTLE EASIER                         00290000
003000*                                                                 00300000
003100***************************************************************** 00310000
003200*  06/20/94 - AJR WR2602 -GROUP PRICING                           00320000
003300*  REMOVED THE GROUP OWNERSHIP INDICATOR.  ALL GROUP PRICED ITEMS 00330000
003400*  WILL BE OWNED AT THE LOW PRICE (GROUP EACH PRICE).             00340000
003500***************************************************************** 00350000
003600*  06/23/95 - DMH WR3324 - SHRINK ENHANCEMENT                     00360000
003700*  THE SHRINK PERCENT WILL BE SET BY THE FISCAL MONTH PASSED TO   00370000
003800*  THIS PGM FROM TSQUEUE. IF ZERO, USE THE CURRENT FISCAL MONTH.  00380000
003900***************************************************************** 00390000
004000*  02/22/96 - DMH WR3488 - INITIALIZE SHRINK FOR PREV YEAR        00400000
004100*  INSERT A SHRINK SEGMENT FOR A NEW DEPT. THE KEY SHOULD BE      00410000
004200*  THE PREVIOUS YEAR AND THE SHRINKS INITIALIZED TO ZEROS.        00420000
004300***************************************************************** 00430000
004400*  09/12/96 - TAM WR???? - ADDED CODE TO INSERT "REPORT NUMBER    00440000
004500*  OF DAYS BEFORE SHIPMENT" AND "REPORT NUMBER OF DAYS AFTER      00450000
004510*  CLEARANCE" SO THAT THE ROWS MEETING THE CRITERIA WILL NOT      00460000
004520*  APPEAR ON REPORTS.  NOTE: THE 2 FIELDS WERE BUILT IN           00470000
004530*  PGM=MBKCS114 AND PASSED.                                       00480000
004540***************************************************************** 00490000
004541*  09/23/97 - DMH WR???? - SET VSM CONV IND TO 'Y' FOR NEW DPTS   00500000
004542***************************************************************** 00510000
004543***************************************************************** 00520000
004544* 08/17/98 - DAVE METZGER - WR# 5701                              00530000
004545*   REMOVED DP060 LOGIC AND CHANGED CODE TO ALWAYS WORK WITH THE  00540000
004546*   SHRINK PERCENT FOR THE FISCAL PERIOD THAT IS CURRENTLY OPEN.  00550000
C14666***************************************************************** 00560000
C14666* 07/10/2012 - THERESE RAMSEYER   CRQ000000014666                 00570002
C14666*                                                                 00580000
C14666*  INCREASE DECIMAL PRECISION OF SHRINK PERCENTAGE.               00590000
C14666*  CHANGE MBWS104 COPYBOOK MERCHANDISE AREA ADD TEMPORARY STORAGE 00600000
C14666*  QUEUE TO ACCEPT TWO SHRINK PERCENTAGES - ONE FOR ECOM AND THE  00610000
C14666*  OTHER FOR BRICK&MORTAR STORES. CHANGE THE APPL SPECIFIC        00620000
C14666*  COMMAREA : ADD ASC-ECOM-SHRINK-PERCENT AND CHANGE              00630000
C14666*  ASC-SHRINK-PERCENT TO ASC-BM-SHRINK-PERCENT.                   00640000
C14666*  ADD A SECOND PERFORM OF 9027-INSERT-DPTSHK-ROW TO ALSO         00650000
C14666*  INSERT THE SECOND ROW TO TDPTSHK FOR A DEPT ADD FUNCTION.      00660000
C14666***************************************************************** 00670000
262978* CHANGED 10/21/2021    BY JIM HUNTER      WR: CHG0262978         00671003
262978* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00672003
262978* MAKING THE CALL DYNAMIC VS STATIC.                              00673003
262978******************************************************************00674003
004666*                                                                 00680000
004549 ENVIRONMENT DIVISION.                                            00690000
004550*                                                                 00700000
004560 DATA DIVISION.                                                   00710000
004570*                                                                 00720000
004580 WORKING-STORAGE SECTION.                                         00730000
004590                                                                  00740000
004600 01  PC-PROGRAM-CONSTANTS.                                        00750000
004700     05  PC-CURR-YR-IND                 PIC X(01)    VALUE 'C'.   00760000
004800     05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.00770000
004900     05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  00780000
005000                                                     COMP SYNC.   00790000
005100     05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        00800000
005200     'MB106A  '.                                                  00810000
005300     05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        00820000
005400     'MBKM106 '.                                                  00830000
005500     05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        00840000
005600     'MBKCS106'.                                                  00850000
005700     05  PC-BUYER-LEVEL                 PIC X(03)    VALUE 'BYR'. 00860000
005800     05  PC-CONSECUTIVE-DAYS            PIC S9(03)   VALUE +1.    00870000
005900     05  PC-CENTURY-CUTOFF              PIC 9(02)    VALUE 85.    00880000
006000     05  PC-DEPT-LEVEL-CD               PIC X(03)    VALUE 'DPT'. 00890000
006100     05  PC-DMM-LEVEL                   PIC X(03)    VALUE 'DMM'. 00900000
006200     05  PC-DMA-LEVEL-CD                PIC X(03)    VALUE 'DMA'. 00910000
006300     05  PC-DPT-LEVEL-CD                PIC X(03)    VALUE 'DPT'. 00920000
006400     05  PC-GMM-LEVEL                   PIC X(03)    VALUE 'GMM'. 00930000
006500     05  PC-GMA-LEVEL-CD                PIC X(03)    VALUE 'GMA'. 00940000
006600     05  PC-INFINITY-DATE               PIC 9(08)  VALUE 99990909.00950000
006700     05  PC-MCL-LEVEL-CD                PIC X(03)    VALUE 'MCL'. 00960000
006800     05  PC-MAX-RETRIES                 PIC S9(3)    VALUE +3.    00970000
006900     05  PC-MAX-SCREEN-LINES            PIC S9(3)    VALUE +09.   00980000
007000     05  PC-SCL-LEVEL-CD                PIC X(03)    VALUE 'SCL'. 00990000
007100     05  PC-YEAR-DAYS                   PIC 9(03)    VALUE 365.   01000000
007200     05  PC-TSQ-ADD-LENGTH              PIC S9(04)   VALUE 0      01010000
007300                                                     COMP SYNC.   01020000
007400     05  PC-TSQ-MAINT-LENGTH            PIC S9(04)   VALUE 0      01030000
007500                                                     COMP SYNC.   01040000
007600     05  PC-TSYMSG-00005                PIC 9(05)    VALUE 00005. 01050000
007700     05  PC-TSYMSG-00007                PIC 9(05)    VALUE 00007. 01060000
007800     05  PC-TSYMSG-00008                PIC 9(05)    VALUE 00008. 01070000
007900     05  PC-TSYMSG-00009                PIC 9(05)    VALUE 00009. 01080000
008000     05  PC-TSYMSG-00010                PIC 9(05)    VALUE 00010. 01090000
008100     05  PC-TSYMSG-00025                PIC 9(05)    VALUE 00025. 01100000
008200     05  PC-TSYMSG-00045                PIC 9(05)    VALUE 00045. 01110000
008300     05  PC-TSYMSG-00059                PIC 9(05)    VALUE 00059. 01120000
008400     05  PC-TSYMSG-00067                PIC 9(05)    VALUE 00067. 01130000
008500     05  PC-TSYMSG-00070                PIC 9(05)    VALUE 00070. 01140000
008600     05  PC-TSYMSG-00122                PIC 9(05)    VALUE 00122. 01150000
008700     05  PC-TSYMSG-00138                PIC 9(05)    VALUE 00138. 01160000
008800     05  PC-TSYMSG-00143                PIC 9(05)    VALUE 00143. 01170000
008900     05  PC-TSYMSG-00144                PIC 9(05)    VALUE 00144. 01180000
009000     05  PC-TSYMSG-00145                PIC 9(05)    VALUE 00145. 01190000
009100     05  PC-TSYMSG-00181                PIC 9(05)    VALUE 00181. 01200000
009200     05  PC-TSYMSG-00182                PIC 9(05)    VALUE 00182. 01210000
009300     05  PC-TSYMSG-00188                PIC 9(05)    VALUE 00188. 01220000
009400     05  PC-TSYMSG-00189                PIC 9(05)    VALUE 00189. 01230000
009500     05  PC-TSYMSG-00190                PIC 9(05)    VALUE 00190. 01240000
009600     05  PC-TSYMSG-99901                PIC 9(05)    VALUE 99901. 01250000
009700     05  PC-CNVER-IND                   PIC X(01)    VALUE 'Y'.   01260000
009800     EJECT                                                        01270000
009900                                                                  01280000
010000                                                                  01290000
010100 01  PS-PROGRAM-SWITCHES.                                         01300000
010200     05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   01310000
010300         88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   01320000
010400         88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   01330000
010500         88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   01340000
010600         88  PS-SEND-DATA-ONLY                       VALUE '4'.   01350000
010700         88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   01360000
010800         88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   01370000
010900     05  PS-RSPLVL-FOUND-SW             PIC X(01)    VALUE 'N'.   01380000
011000         88  PS-RSPLVL-FOUND                         VALUE 'Y'.   01390000
011100         88  PS-RSPLVL-NOT-FOUND                     VALUE 'N'.   01400000
011200     05  PS-CONSECUTIVE-DATE-SW         PIC X(01)    VALUE 'N'.   01410000
011300         88  PS-DATES-CONSECUTIVE                    VALUE 'Y'.   01420000
011400         88  PS-DATES-NOT-CONSECUTIVE                VALUE 'N'.   01430000
011500     05  PS-DATE-STATUS-SW              PIC X(01)    VALUE ' '.   01440000
011600         88  PS-DATES-OK                             VALUE ' '.   01450000
011700         88  PS-DATES-OVERLAP                        VALUE 'Y'.   01460000
011800         88  PS-DATES-GAP                            VALUE 'N'.   01470000
011900     05  PS-DONE-SW                     PIC X(01)    VALUE 'N'.   01480000
012000         88  PS-DONE                                 VALUE 'Y'.   01490000
012100         88  PS-NOT-DONE                             VALUE 'N'.   01500000
012200     05  PS-MATCH-SW                    PIC X(01)    VALUE 'N'.   01510000
012300         88  PS-NEED-MATCH                           VALUE 'Y'.   01520000
012400         88  PS-NEED-NO-MATCH                        VALUE 'N'.   01530000
012500     05  PS-UPDATE-SW                   PIC X(01)    VALUE 'N'.   01540000
012600         88  PS-UPDATE-OK                            VALUE 'Y'.   01550000
012700         88  PS-NO-UPDATE-OK                         VALUE 'N'.   01560000
012800     05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   01570000
012900         88  PS-ERROR                                VALUE 'Y'.   01580000
013000         88  PS-NO-ERROR                             VALUE 'N'.   01590000
013100     05  PS-ST-DATE-ERR-SW              PIC X(01)    VALUE 'N'.   01600000
013200         88  PS-START-DATE-ERROR                     VALUE 'Y'.   01610000
013300         88  PS-NO-START-DATE-ERROR                  VALUE 'N'.   01620000
013400     05  PS-ED-DATE-ERR-SW              PIC X(01)    VALUE 'N'.   01630000
013500         88  PS-END-DATE-ERROR                       VALUE 'Y'.   01640000
013600         88  PS-NO-END-DATE-ERROR                    VALUE 'N'.   01650000
013700     05  PS-SORT-SW                     PIC X(01)    VALUE 'N'.   01660000
013800         88  PS-SORT-COMPLETE                        VALUE 'Y'.   01670000
013900         88  PS-SORT-NOT-COMPLETE                    VALUE 'N'.   01680000
014000     05  PS-DMM-LEVEL-SPECIFIED-SW      PIC X(01)    VALUE 'N'.   01690000
014100         88  PS-DMM-LEVEL-SPECIFIED                  VALUE 'Y'.   01700000
014200         88  PS-DMM-NOT-SPECIFIED                    VALUE 'N'.   01710000
014300     05  PS-GMM-LEVEL-SPECIFIED-SW      PIC X(01)    VALUE 'N'.   01720000
014400         88  PS-GMM-LEVEL-SPECIFIED                  VALUE 'Y'.   01730000
014500         88  PS-GMM-NOT-SPECIFIED                    VALUE 'N'.   01740000
014600     05  PS-BYR-SPECIFIED-SW            PIC X(01)    VALUE 'N'.   01750000
014700         88  PS-BYR-LEVEL-SPECIFIED                  VALUE 'Y'.   01760000
014800         88  PS-BYR-NOT-SPECIFIED                    VALUE 'N'.   01770000
014900     05  PS-INTER-APPL-SW               PIC X(01)    VALUE 'N'.   01780000
015000         88  PS-INTER-APPL-VALID                     VALUE 'Y'.   01790000
015100         88  PS-INTER-APPL-INVALID                   VALUE 'N'.   01800000
015200     05  PS-QUEUE-STATUS                PIC X(01)    VALUE 'Y'.   01810000
015300         88  PS-FULL-QUEUE                           VALUE 'Y'.   01820000
015400         88  PS-EMPTY-QUEUE                          VALUE 'N'.   01830000
015500     05  PS-ROW-FOUND-SW                PIC X(01)    VALUE 'Y'.   01840000
015600         88  PS-ROW-FOUND                            VALUE 'Y'.   01850000
015700         88  PS-ROW-NOT-FOUND                        VALUE 'N'.   01860000
015800     EJECT                                                        01870000
015900                                                                  01880000
016000 01  PV-PROGRAM-VARIABLES.                                        01890000
016100     05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     01900000
016200                                                     COMP SYNC.   01910000
016300     05  PV-BUYERS-SPECIFIED            PIC S9(3)    VALUE 0.     01920000
016400     05  PV-COUNTER                     PIC S9(4)V   VALUE 0      01930000
016500                                                     COMP.        01940000
016600     05  PV-WORK-LEVEL                  PIC X(03)    VALUE SPACES.01950000
016700     05  PV-WORK-ID                     PIC X(08)    VALUE SPACES.01960000
016800     05  PV-PREV-LEVEL                  PIC X(03)    VALUE SPACES.01970000
016900     05  PV-RSPLVL-TO-FIND              PIC X(03)    VALUE SPACES.01980000
017000     05  PV-CHANGE-DATE.                                          01990000
017100         10  PV-CHANGE-CENT             PIC 9(02)    VALUE 0.     02000000
017200         10  PV-CHANGE-YY               PIC 9(02)    VALUE 0.     02010000
017300         10  PV-DASH1                   PIC X        VALUE '-'.   02020000
017400         10  PV-CHANGE-MM               PIC 9(02)    VALUE 0.     02030000
017500         10  PV-DASH2                   PIC X        VALUE '-'.   02040000
017600         10  PV-CHANGE-DD               PIC 9(02)    VALUE 0.     02050000
017700     05  PV-DMMS-SPECIFIED              PIC S9(3)    VALUE 0.     02060000
017800     05  PV-ERROR-MSG.                                            02070000
017900         10  FILLER                     PIC X(13)                 02080000
018000                                        VALUE 'MDSEAR-DKEY :'.    02090000
018100         10  PV-ERR-DKEY                PIC 9(06)V   VALUE 0.     02100000
018200     05  PV-FILL-SUB                    PIC S9(04)   VALUE +0     02110000
018300                                                     COMP SYNC.   02120000
018400     05  PV-TEMP-SUB                    PIC S9(04)   VALUE +0     02130000
018500                                                     COMP SYNC.   02140000
018600     05  PV-START-DATE                  PIC 9(8)     VALUE 0.     02150000
018700     05  PV-END-DATE                    PIC 9(8)     VALUE 0.     02160000
018800     05  PV-GMMS-SPECIFIED              PIC S9(3)    VALUE 0.     02170000
018900     05  PV-SHRINK-FISCAL-NBR           PIC S9(2)    VALUE 0.     02180000
019000     05  PV-MSG-NUMBER-X                PIC X(05)    VALUE SPACES.02190000
019100     05  PV-MAP-SUB                     PIC S9(04)   VALUE +0     02200000
019200                                                     COMP SYNC.   02210000
019300     05  PV-FMT-YR                      PIC X(04)    VALUE SPACES.02220000
019400     05  PV-FMT-YR-N REDEFINES PV-FMT-YR                          02230000
019500                                        PIC 9(04).                02240000
019600     05  PV-MDSEAR-LIST-SEQ-NBR.                                  02250000
019700         10  PV-LIST-SEQ-OPERCO         PIC X(02)    VALUE SPACES.02260000
019800         10  PV-LIST-SEQ-GMA            PIC X(02)    VALUE SPACES.02270000
019900         10  PV-LIST-SEQ-DMA            PIC X(02)    VALUE SPACES.02280000
020000         10  PV-LIST-SEQ-DPT            PIC X(03)    VALUE SPACES.02290000
020100         10  PV-LIST-SEQ-MCL            PIC X(02)    VALUE SPACES.02300000
020200         10  PV-LIST-SEQ-SCL            PIC X(03)    VALUE SPACES.02310000
020300         10  PV-LIST-SEQ-ZERO           PIC X(01)    VALUE SPACES.02320000
020400     05  FILLER REDEFINES PV-MDSEAR-LIST-SEQ-NBR.                 02330000
020500         10 PV-MDSEAR-LIST-SEQ-NBR-N    PIC 9(15).                02340000
020600     05  PV-SAVE-SCREEN-LINE            PIC X(63)    VALUE SPACES.02350000
020700     05  PV-NUMBER-COMPARISONS          PIC S9(04)   VALUE +0     02360000
020800                                                     COMP SYNC.   02370000
020900     05  PV-RETRY-COUNTER               PIC S9(3)    VALUE 0.     02380000
021000     05  PV-SHRINK-YR-NBR               PIC 9(04)    VALUE 0.     02390000
021100     05  PV-TEMP-YEAR-DATE.                                       02400000
021200         10  PV-TY-CC                   PIC 9(02)    VALUE 0.     02410000
021300         10  PV-TY-YY                   PIC 9(02)    VALUE 0.     02420000
021400         10  PV-TY-MM                   PIC 9(02)    VALUE 0.     02430000
021500         10  PV-TY-DD                   PIC 9(02)    VALUE 0.     02440000
021600     05  PV-TEMP-SORT-LINE              PIC X(13)    VALUE SPACES.02450000
021700     05  PV-TEMP-SCREEN-LINE            PIC X(53)    VALUE SPACES.02460000
021800     05  PV-TSQ-LENGTH                  PIC S9(4)    VALUE 0      02470000
021900                                                     COMP SYNC.   02480000
022000     05  PV-TSQ-NAME.                                             02490000
022100         10 PV-TSQ-TERM-ID              PIC X(4)     VALUE SPACES.02500000
022200         10 PV-TSQ-TASK-ID              PIC S9(07)   VALUE 0      02510000
022300                                                      COMP-3.     02520000
022400     05  PV-TEMP-LEVEL                  PIC X(03)    VALUE SPACES.02530000
022500     05  PV-TEMP-START-DATE.                                      02540000
022600         10  PV-TMP-STRT-CC             PIC 9(02)    VALUE 0.     02550000
022700         10  PV-TMP-STRT-YY             PIC 9(02)    VALUE 0.     02560000
022800         10  PV-TMP-STRT-MM             PIC 9(02)    VALUE 0.     02570000
022900         10  PV-TMP-STRT-DD             PIC 9(02)    VALUE 0.     02580000
023000     05  PV-TEMP-DATE-1.                                          02590000
023100         10  PV-TMP-DTE-CC1             PIC 9(02)    VALUE 0.     02600000
023200         10  PV-TMP-DTE-YY1             PIC 9(02)    VALUE 0.     02610000
023300         10  PV-TMP-DTE-MM1             PIC 9(02)    VALUE 0.     02620000
023400         10  PV-TMP-DTE-DD1             PIC 9(02)    VALUE 0.     02630000
023500     05  PV-TEMP-DATE-2.                                          02640000
023600         10  PV-TMP-DTE-CC2             PIC 9(02)    VALUE 0.     02650000
023700         10  PV-TMP-DTE-YY2             PIC 9(02)    VALUE 0.     02660000
023800         10  PV-TMP-DTE-MM2             PIC 9(02)    VALUE 0.     02670000
023900         10  PV-TMP-DTE-DD2             PIC 9(02)    VALUE 0.     02680000
024000     05  PV-WORK-SUB                    PIC S9(04)   VALUE +0.    02690000
024100     05  PV-WORK-TDPTSHK.                                         02700000
024200         10  FILLER                     PIC X(04).                02710000
024300         10  FILLER                     PIC X(04).                02720000
024400         10  FILLER                     PIC X(26).                02730000
C14666         10  PV-SHRINK-PCTN   OCCURS 12 PIC SV9999   COMP-3.      02740000
C14666         10  FILLER                     PIC X(01).                02750000
C14666         10  FILLER                     PIC X(10).                02760000
C14666         10  FILLER                     PIC X(08).                02770000
024600     05  PV-SUB                         PIC S9(04)   VALUE +0     02780000
024700     EJECT                                                        02790000
024800                                                     COMP SYNC.   02800000
024900 01  DK-DATA-KEYS.                                                02810000
025000     05  DK-OPERCO-NBR                  PIC X(02)    VALUE SPACES.02820000
025100     05  DK-GMA-NBR                     PIC X(02)    VALUE SPACES.02830000
025200     05  DK-DMA-NBR                     PIC X(02)    VALUE SPACES.02840000
025300     05  DK-DEPT-NBR                    PIC X(03)    VALUE SPACES.02850000
025400     05  DK-MAJ-CL-NBR                  PIC X(02)    VALUE SPACES.02860000
025500     05  DK-SUB-CL-NBR                  PIC X(03)    VALUE SPACES.02870000
025600     05  DK-END-DATE                    PIC X(10)    VALUE SPACES.02880000
025700     05  DK-MDSELV-CDE                  PIC X(03)    VALUE SPACES.02890000
025800     05  DK-MDSEBG-NBR                  PIC X(03)    VALUE SPACES.02900000
025900     05  DK-DPTDIS-CDE                  PIC X(03)    VALUE SPACES.02910000
026000     05  DK-MDSEAR-DKEY                 PIC S9(06)V   COMP-3      02920000
026100                                                     VALUE 0.     02930000
026200     05  DK-RSPLVL-CDE                  PIC X(03)    VALUE SPACES.02940000
026300     05  DK-UID-NBR                     PIC X(08)    VALUE SPACES.02950000
026400     EJECT                                                        02960000
026500                                                                  02970000
026600***************************************************************** 02980000
026700*    STANDARD COMMAREA.                                           02990000
026800***************************************************************** 03000000
026900                                                                  03010000
027000     COPY DPWS020.                                                03020000
027100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03030000
027200                                                                  03040000
027300***************************************************************** 03050000
027400*    INTER-APPLICATION COMMAREA.                                  03060000
027500***************************************************************** 03070000
027600                                                                  03080000
027700         10  INTER-APPL-COMM-AREA       PIC X(200).               03090000
027800     COPY MBWS005.                                                03100000
027900                                                                  03110000
028000***************************************************************** 03120000
028100*    APPLICATION SPECIFIC COMMAREA FOR MBKCS106 - 2865 BYTES      03130000
028200***************************************************************** 03140000
028300         10  ASC-APPL-SPEC-COMMAREA.                              03150000
028400             15 ASC-COMPANY-NO                  PIC X(2).         03160000
028500             15 ASC-GMA-NO                      PIC X(2).         03170000
028600             15 ASC-GMA-DESC                    PIC X(25).        03180000
028700             15 ASC-DMA-NO                      PIC X(2).         03190000
028800             15 ASC-DMA-DESC                    PIC X(25).        03200000
028900             15 ASC-DPT-NO                      PIC X(3).         03210000
029000             15 ASC-DPT-DESC                    PIC X(25).        03220000
029100             15 ASC-MCL-NO                      PIC X(2).         03230000
029200             15 ASC-MCL-DESC                    PIC X(25).        03240000
029300             15 ASC-SCL-NO                      PIC X(3).         03250000
029400             15 ASC-SCL-DESC                    PIC X(25).        03260000
029500*                                                                 03270000
029600             15 ASC-MERCH-TYPE                  PIC X(01).        03280000
029700             15 ASC-BUYER-NUMBER                PIC X(03).        03290000
029800             15 ASC-BUS-GROUP                   PIC X(03).        03300000
029900             15 ASC-DEPT-DISCOUNT               PIC X(02).        03310000
030000             15 ASC-AR-DESCRIP                  PIC X(25).        03320000
030100             15 ASC-POS-DESCRIP                 PIC X(17).        03330000
030200             15 ASC-TAX-DEFLT-IND               PIC X(01).        03340000
030300             15 ASC-CONSIGN-IND                 PIC X(01).        03350000
030400                 15 ASC-SCRN-DAYS-BEF-SHIP-NBR  PIC 9(03).        03360000
030500                 15 ASC-SCRN-DAYS-AFT-CLR-NBR   PIC 9(03).        03370000
030600             15 ASC-SKU-LVL-UPD-IND             PIC X(01).        03380000
030700             15 ASC-PARENT-MDSEAR-DKEY          PIC S9(06)V       03390000
030800                                                COMP-3.           03400000
030900             15 ASC-MDSEAR-DKEY                 PIC S9(06)V       03410000
031000                                                COMP-3.           03420000
031100             15 ASC-FREIGHT-PERCENT             PIC SV999         03430000
031200                                                COMP-3.           03440000
C14666             15 ASC-BM-SHRINK-PERCENT           PIC SV9999        03450000
031400                                                COMP-3.           03460000
C14666             15 ASC-ECOM-SHRINK-PERCENT         PIC SV9999        03470000
C14666                                                COMP-3.           03480000
031500             15 ASC-SHRINK-FISCAL-NBR           PIC 99.           03490000
031600*                                                                 03500000
031700             15 ASC-LEVEL-START-DATE-CYMD       PIC 9(8).         03510000
031800             15 FILLER REDEFINES ASC-LEVEL-START-DATE-CYMD.       03520000
031900                20  ASC-LEVEL-START-CC          PIC 9(02).        03530000
032000                20  ASC-LEVEL-START-DATE        PIC 9(06).        03540000
032100                20  FILLER REDEFINES ASC-LEVEL-START-DATE.        03550000
032200                    25  ASC-LEVEL-START-YY      PIC 9(02).        03560000
032300                    25  ASC-LEVEL-START-MM      PIC 9(02).        03570000
032400                    25  ASC-LEVEL-START-DD      PIC 9(02).        03580000
032500                                                                  03590000
032600             15 ASC-LEVEL-END-DATE-CYMD         PIC 9(08).        03600000
032700             15 FILLER REDEFINES ASC-LEVEL-END-DATE-CYMD.         03610000
032800                20  ASC-LEVEL-END-CC            PIC 9(02).        03620000
032900                20  ASC-LEVEL-END-DATE          PIC 9(06).        03630000
033000                20  FILLER REDEFINES ASC-LEVEL-END-DATE.          03640000
033100                    25  ASC-LEVEL-END-YY        PIC 9(02).        03650000
033200                    25  ASC-LEVEL-END-MM        PIC 9(02).        03660000
033300                    25  ASC-LEVEL-END-DD        PIC 9(02).        03670000
033400                                                                  03680000
033500             15 ASC-LEVEL-TO-ADD                PIC 9.            03690000
033600                88  ASC-ADD-GMA                 VALUE 1.          03700000
033700                88  ASC-ADD-DMA                 VALUE 2.          03710000
033800                88  ASC-ADD-DPT                 VALUE 3.          03720000
033900                88  ASC-ADD-MCL                 VALUE 4.          03730000
034000                88  ASC-ADD-SCL                 VALUE 5.          03740000
034100*                                                                 03750000
034200*                                                                 03760000
034300             15  ASC-EDITED-DATE-YYYYMMDD       PIC X(10).        03770000
034400             15  FILLER  REDEFINES  ASC-EDITED-DATE-YYYYMMDD.     03780000
034500                 20  ASC-CCYY                   PIC X(04).        03790000
034600                 20  FILLER                     PIC X(01).        03800000
034700                 20  ASC-MM                     PIC 9(02).        03810000
034800                 20  FILLER                     PIC X(03).        03820000
034900             15 ASC-TEMP-QUEUE-INFORMATION.                       03830000
035000                 20  ASC-TEMP-QUEUE-NAME        PIC X(08).        03840000
035100                 20  FILLER REDEFINES ASC-TEMP-QUEUE-NAME.        03850000
035200                     25  ASC-TERM-ID            PIC X(04).        03860000
035300                     25  ASC-TASK-ID            PIC S9(07)        03870000
035400                                                    COMP-3.       03880000
035500                 20 ASC-TEMP-QUEUE-LENGTH       PIC S9(4)         03890000
035600                                                    COMP.         03900000
035700                 20 ASC-TSQ-ITEM-NBR            PIC S9(04)        03910000
035800                                                    COMP SYNC.    03920000
035900*                                                                 03930000
036000*                                                                 03940000
036100             15 ASC-CURRENT-DATE-CYMD           PIC 9(08).        03950000
036200             15 ASC-LINES-ENTERED               PIC S9(04)        03960000
036300                                                    COMP.         03970000
036400*                                                                 03980000
036500*                                                                 03990000
036600             15 ASC-SCREEN-TABLE-INFO.                            04000000
036700                 20  ASC-SCREEN-LINE   OCCURS 9 TIMES             04010000
036800                                       INDEXED BY ASC-INDEX,      04020000
036900                                                  ASC-INDEX2      04030000
037000                                                  ASC-INDEX3.     04040000
037100                     25  ASC-LEVEL              PIC X(03).        04050000
037200                     25  ASC-LEVEL-CHANGED-SW   PIC X.            04060000
037300                         88 ASC-LEVEL-CHANGED   VALUE 'Y'.        04070000
037400                         88 ASC-LEVEL-NOT-CHANGED VALUE 'N'.      04080000
037500                                                                  04090000
037600                     25  ASC-START-DATE-CYMD    PIC X(08).        04100000
037700                     25  ASC-START-DATE-CYMD-N REDEFINES          04110000
037800                           ASC-START-DATE-CYMD  PIC 9(08).        04120000
037900                     25  FILLER REDEFINES ASC-START-DATE-CYMD.    04130000
038000                         30 ASC-START-CYMD-CC   PIC X(02).        04140000
038100                         30 ASC-START-DATE      PIC X(06).        04150000
038200                         30 FILLER REDEFINES ASC-START-DATE.      04160000
038300                            35 ASC-START-YY     PIC X(02).        04170000
038400                            35 ASC-START-MM     PIC X(02).        04180000
038500                            35 ASC-START-DD     PIC X(02).        04190000
038600                         30  ASC-START-DATE-N REDEFINES           04200000
038700                                ASC-START-DATE  PIC 9(06).        04210000
038800                         30  FILLER REDEFINES ASC-START-DATE-N.   04220000
038900                            35 ASC-START-YY-N   PIC 9(02).        04230000
039000                            35 ASC-START-MM-N   PIC 9(02).        04240000
039100                            35 ASC-START-DD-N   PIC 9(02).        04250000
039200*                                                                 04260000
039300*                                                                 04270000
039400                     25  ASC-END-DATE-CYMD      PIC X(08).        04280000
039500                     25  FILLER REDEFINES ASC-END-DATE-CYMD.      04290000
039600                         30  ASC-END-DATE-CYMD-N PIC 9(08).       04300000
039700                     25  FILLER REDEFINES ASC-END-DATE-CYMD.      04310000
039800                         30  ASC-END-CYMD-CC    PIC X(02).        04320000
039900                         30  ASC-END-DATE       PIC X(06).        04330000
040000                         30  FILLER REDEFINES ASC-END-DATE.       04340000
040100                             35  ASC-END-YY     PIC X(02).        04350000
040200                             35  ASC-END-MM     PIC X(02).        04360000
040300                             35  ASC-END-DD     PIC X(02).        04370000
040400                         30  FILLER REDEFINES ASC-END-DATE.       04380000
040500                             35 ASC-END-DATE-N  PIC 9(06).        04390000
040600                             35 FILLER REDEFINES ASC-END-DATE-N.  04400000
040700                                40 ASC-END-YY-N PIC 9(02).        04410000
040800                                40 ASC-END-MM-N PIC 9(02).        04420000
040900                                40 ASC-END-DD-N PIC 9(02).        04430000
041000*                                                                 04440000
041100*                                                                 04450000
041200                     25  ASC-WORKER-ID          PIC X(08).        04460000
041300                     25  ASC-WORKER-CHANGED-SW  PIC X.            04470000
041400                         88 ASC-WORKER-CHANGED  VALUE 'Y'.        04480000
041500                         88 ASC-WORKER-NOT-CHANGED VALUE 'N'.     04490000
041600                                                                  04500000
041700                     25  ASC-WORKER-NBR         PIC S9(06)V       04510000
041800                                                COMP-3.           04520000
041900                     25  ASC-LAST-NAME          PIC X(18).        04530000
042000                     25  ASC-FIRST-NAME         PIC X(12).        04540000
042100                                                                  04550000
042200             15  ASC-SHRINK-YR-IND              PIC X(1).         04560000
042300             15  ASC-STR-ZN-ID                  PIC X(05).        04570000
042400             15  ASC-CAL-MN-NBR                 PIC X(02).        04580000
042500             15  ASC-CAL-MN-NBR-N REDEFINES                       04590000
042600                 ASC-CAL-MN-NBR                 PIC 9(02).        04600000
042700             15  ASC-SHNK-FSCL-YR-NBR           PIC X(04).        04610000
C14666             15  FILLER                         PIC X(984).       04620000
042900                                                                  04630000
043000                                                                  04640000
043100***************************************************************** 04650000
043200*    ABEND PROCESSING COPYBOOK.                                   04660000
043300***************************************************************** 04670000
043400                                                                  04680000
043500     COPY DPWS013.                                                04690000
043600                                                                  04700000
043700***************************************************************** 04710000
043800*    ATTRIBUTE SETTINGS COPYBOOK.                                 04720000
043900***************************************************************** 04730000
044000                                                                  04740000
044100     COPY DPWS015.                                                04750000
044200                                                                  04760000
044300***************************************************************** 04770000
044400*    CALENDAR ROUTINE PARAMETER LIST COPYBOOK.                    04780000
044500***************************************************************** 04790000
044600                                                                  04800000
044700     COPY DPWS500.                                                04810000
044800                                                                  04820000
044900***************************************************************** 04830000
045000*    CURRENT DATE AND TIME COPYBOOK.                              04840000
045100***************************************************************** 04850000
045200                                                                  04860000
045300     COPY DPWS017.                                                04870000
045400                                                                  04880000
045500***************************************************************** 04890000
045600*    TOGGLE FUNCTION KEY LINES COPYBOOK.                          04900000
045700***************************************************************** 04910000
045800                                                                  04920000
045900     COPY DPWS009.                                                04930000
046000                                                                  04940000
046100***************************************************************** 04950000
046200*    FUNCTION KEYS COPYBOOK.                                      04960000
046300***************************************************************** 04970000
046400                                                                  04980000
046500     COPY DPWS016.                                                04990000
046600                                                                  05000000
046700***************************************************************** 05010000
046800*    VARIABLE MESSAGE AREA.                                       05020000
046900***************************************************************** 05030000
047000                                                                  05040000
047100     COPY DPWS006.                                                05050000
047200                                                                  05060000
047300***************************************************************** 05070000
047400*    NUMERIC EDIT ROUTINE                                         05080000
047500***************************************************************** 05090000
047600                                                                  05100000
047700     COPY DPWS010I.                                               05110000
047800                                                                  05120000
047900***************************************************************** 05130000
048000*    MERCHANDISE AREA ADD TEMPORARY STORAGE QUEUE                 05140000
048100***************************************************************** 05150000
048200                                                                  05160000
048300     COPY MBWS104.                                                05170000
048400                                                                  05180000
048500***************************************************************** 05190000
048600*    DPKUT045 COPYBOOK.                                           05200000
048700*                                                                 05210000
048800*    DATA AREA NECESSARY TO INTERACT WITH SUB-ROUTINE DPKUT045    05220000
048900*                                                                 05230000
049000*    DPKUT045 IS A UTILITY ROUTINE THAT CONVERTS THE EIBAID       05240000
049100*    CHARACTER RECEIVED FROM THE TERMINAL INTO A INTEGER VALUE    05250000
049200*    FROM 1 TO 29. THIS INTEGER VALUE IS STORED IN DP020-SRC-AID  05260000
049300*    AND IS USED TO INTERROGATE THE DP020-FUNCTION-KEY-ARRAY      05270000
049400*    TABLE IN THE STANDARD COMMAREA TO DETERMINE WHAT TO DO NEXT. 05280000
049500*    IN ADDITION DPKUT045 WILL PARSE THE SCREEN INPUT COMMAND     05290000
049600*    FIELD AND CONVERT RECOGNIZED SCREEN MANIPULATION COMMANDS    05300000
049700*    INTO THE DP020-SRC-AID EQUIVALENT.                           05310000
049800***************************************************************** 05320000
049900                                                                  05330000
050000     COPY DPWS045.                                                05340000
050100                                                                  05350000
050200***************************************************************** 05360000
050300*    SYSTEM MESSAGES RECORD LAYOUT                                05370000
050400***************************************************************** 05380000
050500                                                                  05390000
050600     COPY DPRD507I.                                               05400000
050700                                                                  05410000
050800***************************************************************** 05420000
050900*    STANDARD ATTENTION IDENTIFIER LIST                           05430000
051000***************************************************************** 05440000
051100                                                                  05450000
051200     COPY DFHAID.                                                 05460000
051300                                                                  05470000
051400***************************************************************** 05480000
051500*    MAP LAYOUT                                                   05490000
051600***************************************************************** 05500000
051700                                                                  05510000
051800     COPY MBKM106.                                                05520000
051900                                                                  05530000
052000 01  MD-MAP-DATA-AREA REDEFINES MB106AO.                          05540000
052100***************************************************************** 05550000
052200*    FOR THE UTILITIES THAT RECEIVE AND SEND THE MAP TO THE       05560000
052300*    TERMINAL TO FUNCTION CORRECTLY, CHANGE THE PIC CLAUSE OF     05570000
052400*    THE FOLLOWING FILLER STATEMENT TO BE EQUAL TO THE TOTAL      05580000
052500*    LENGTH OF THE MAP COPYBOOK.                                  05590000
052600***************************************************************** 05600000
052700     05  FILLER                         PIC X(1460).              05610000
052800***************************************************************** 05620000
052900*    THIS MAP IS REDEFINED TO MAKE THE TABLE HANDLING EASIER      05630000
053000*    THIS MAP IS REDEFINED TO MAKE THE TABLE HANDLING EASIER      05640000
053100*    THIS MAP IS REDEFINED TO MAKE THE TABLE HANDLING EASIER      05650000
053200*    THIS MAP IS REDEFINED TO MAKE THE TABLE HANDLING EASIER      05660000
053300***************************************************************** 05670000
053400 01  MR-MAP-REDEF-AREA REDEFINES MB106AO.                         05680000
053500     05  FILLER                         PIC X(12).                05690000
053600     05  FILLER                         PIC X(85).                05700000
053700     05  MR-HEADER-DATA.                                          05710000
053800         10  MR-COMPANY-L               PIC S9(04)  COMP.         05720000
053900         10  MR-COMPANY-A               PIC  X(01).               05730000
054000         10  MR-COMPANY-C               PIC  X(01).               05740000
054100         10  MR-COMPANY-H               PIC  X(01).               05750000
054200         10  MR-COMPANY                 PIC  X(02).               05760000
054300         10  MR-GMA-NO-L                PIC S9(04)  COMP.         05770000
054400         10  MR-GMA-NO-A                PIC  X(01).               05780000
054500         10  MR-GMA-NO-C                PIC  X(01).               05790000
054600         10  MR-GMA-NO-H                PIC  X(01).               05800000
054700         10  MR-GMA-NO                  PIC  X(02).               05810000
054800         10  MR-GMA-DESC-L              PIC S9(04)  COMP.         05820000
054900         10  MR-GMA-DESC-A              PIC  X(01).               05830000
055000         10  MR-GMA-DESC-C              PIC  X(01).               05840000
055100         10  MR-GMA-DESC-H              PIC  X(01).               05850000
055200         10  MR-GMA-DESC                PIC  X(25).               05860000
055300         10  MR-DMAHDR-L                PIC S9(04)  COMP.         05870000
055400         10  MR-DMAHDR-A                PIC  X(01).               05880000
055500         10  MR-DMAHDR-C                PIC  X(01).               05890000
055600         10  MR-DMAHDR-H                PIC  X(01).               05900000
055700         10  MR-DMAHDR                  PIC  X(04).               05910000
055800         10  MR-DMA-NO-L                PIC S9(04)  COMP.         05920000
055900         10  MR-DMA-NO-A                PIC  X(01).               05930000
056000         10  MR-DMA-NO-C                PIC  X(01).               05940000
056100         10  MR-DMA-NO-H                PIC  X(01).               05950000
056200         10  MR-DMA-NO                  PIC  X(02).               05960000
056300         10  MR-DMA-DESC-L              PIC S9(04)  COMP.         05970000
056400         10  MR-DMA-DESC-A              PIC  X(01).               05980000
056500         10  MR-DMA-DESC-C              PIC  X(01).               05990000
056600         10  MR-DMA-DESC-H              PIC  X(01).               06000000
056700         10  MR-DMA-DESC                PIC  X(25).               06010000
056800         10  MR-DPTHDR-L                PIC S9(04)  COMP.         06020000
056900         10  MR-DPTHDR-A                PIC  X(01).               06030000
057000         10  MR-DPTHDR-C                PIC  X(01).               06040000
057100         10  MR-DPTHDR-H                PIC  X(01).               06050000
057200         10  MR-DPTHDR                  PIC  X(11).               06060000
057300         10  MR-DPT-NO-L                PIC S9(04)  COMP.         06070000
057400         10  MR-DPT-NO-A                PIC  X(01).               06080000
057500         10  MR-DPT-NO-C                PIC  X(01).               06090000
057600         10  MR-DPT-NO-H                PIC  X(01).               06100000
057700         10  MR-DPT-NO                  PIC  X(03).               06110000
057800         10  MR-DPT-DESC-L              PIC S9(04)  COMP.         06120000
057900         10  MR-DPT-DESC-A              PIC  X(01).               06130000
058000         10  MR-DPT-DESC-C              PIC  X(01).               06140000
058100         10  MR-DPT-DESC-H              PIC  X(01).               06150000
058200         10  MR-DPT-DESC                PIC  X(25).               06160000
058300     05  MR-SCREEN-LINE                 OCCURS 9 TIMES.           06170000
058400         10  MR-LEVEL-L                 PIC S9(04)  COMP.         06180000
058500         10  MR-LEVEL-A                 PIC  X(01).               06190000
058600         10  MR-LEVEL-C                 PIC  X(01).               06200000
058700         10  MR-LEVEL-H                 PIC  X(01).               06210000
058800         10  MR-LEVEL                   PIC  X(03).               06220000
058900         10  MR-STRT-MM-L               PIC S9(04)  COMP.         06230000
059000         10  MR-STRT-MM-A               PIC  X(01).               06240000
059100         10  MR-STRT-MM-C               PIC  X(01).               06250000
059200         10  MR-STRT-MM-H               PIC  X(01).               06260000
059300         10  MR-STRT-MM                 PIC  X(02).               06270000
059400         10  MR-STRT-DD-L               PIC S9(04)  COMP.         06280000
059500         10  MR-STRT-DD-A               PIC  X(01).               06290000
059600         10  MR-STRT-DD-C               PIC  X(01).               06300000
059700         10  MR-STRT-DD-H               PIC  X(01).               06310000
059800         10  MR-STRT-DD                 PIC  X(02).               06320000
059900         10  MR-STRT-YY-L               PIC S9(04)  COMP.         06330000
060000         10  MR-STRT-YY-A               PIC  X(01).               06340000
060100         10  MR-STRT-YY-C               PIC  X(01).               06350000
060200         10  MR-STRT-YY-H               PIC  X(01).               06360000
060300         10  MR-STRT-YY                 PIC  X(02).               06370000
060400         10  MR-END-MM-L                PIC S9(04)  COMP.         06380000
060500         10  MR-END-MM-A                PIC  X(01).               06390000
060600         10  MR-END-MM-C                PIC  X(01).               06400000
060700         10  MR-END-MM-H                PIC  X(01).               06410000
060800         10  MR-END-MM                  PIC  X(02).               06420000
060900         10  MR-END-DD-L                PIC S9(04)  COMP.         06430000
061000         10  MR-END-DD-A                PIC  X(01).               06440000
061100         10  MR-END-DD-C                PIC  X(01).               06450000
061200         10  MR-END-DD-H                PIC  X(01).               06460000
061300         10  MR-END-DD                  PIC  X(02).               06470000
061400         10  MR-END-YY-L                PIC S9(04)  COMP.         06480000
061500         10  MR-END-YY-A                PIC  X(01).               06490000
061600         10  MR-END-YY-C                PIC  X(01).               06500000
061700         10  MR-END-YY-H                PIC  X(01).               06510000
061800         10  MR-END-YY                  PIC  X(02).               06520000
061900         10  MR-WORKER-L                PIC S9(04)  COMP.         06530000
062000         10  MR-WORKER-A                PIC  X(01).               06540000
062100         10  MR-WORKER-C                PIC  X(01).               06550000
062200         10  MR-WORKER-H                PIC  X(01).               06560000
062300         10  MR-WORKER                  PIC  X(08).               06570000
062400         10  MR-LNAME-L                 PIC S9(04)  COMP.         06580000
062500         10  MR-LNAME-A                 PIC  X(01).               06590000
062600         10  MR-LNAME-C                 PIC  X(01).               06600000
062700         10  MR-LNAME-H                 PIC  X(01).               06610000
062800         10  MR-LNAME                   PIC  X(18).               06620000
062900         10  MR-FNAME-L                 PIC S9(04)  COMP.         06630000
063000         10  MR-FNAME-A                 PIC  X(01).               06640000
063100         10  MR-FNAME-C                 PIC  X(01).               06650000
063200         10  MR-FNAME-H                 PIC  X(01).               06660000
063300         10  MR-FNAME                   PIC  X(12).               06670000
063400     05  MR-MSG-L                       PIC S9(04)  COMP.         06680000
063500     05  MR-MSG-A                       PIC  X(01).               06690000
063600     05  MR-MSG-C                       PIC  X(01).               06700000
063700     05  MR-MSG-H                       PIC  X(01).               06710000
063800     05  MR-MSG                         PIC  X(78).               06720000
063900     05  MR-CMD-L                       PIC S9(04)  COMP.         06730000
064000     05  MR-CMD-A                       PIC  X(01).               06740000
064100     05  MR-CMD-C                       PIC  X(01).               06750000
064200     05  MR-CMD-H                       PIC  X(01).               06760000
064300     05  MR-CMD                         PIC  X(08).               06770000
064400     05  MR-KEY-L                       PIC S9(04)  COMP.         06780000
064500     05  MR-KEY-A                       PIC  X(01).               06790000
064600     05  MR-KEY-C                       PIC  X(01).               06800000
064700     05  MR-KEY-H                       PIC  X(01).               06810000
064800     05  MR-KEY                         PIC  X(08).               06820000
064900     05  MR-KLINE1-L                    PIC S9(04)  COMP.         06830000
065000     05  MR-KLINE1-A                    PIC  X(01).               06840000
065100     05  MR-KLINE1-C                    PIC  X(01).               06850000
065200     05  MR-KLINE1-H                    PIC  X(01).               06860000
065300     05  MR-KLINE1                      PIC  X(78).               06870000
065400     05  MR-KLINE2-L                    PIC S9(04)  COMP.         06880000
065500     05  MR-KLINE2-A                    PIC  X(01).               06890000
065600     05  MR-KLINE2-C                    PIC  X(01).               06900000
065700     05  MR-KLINE2-H                    PIC  X(01).               06910000
065800     05  MR-KLINE2                      PIC  X(78).               06920000
065900     EJECT                                                        06930000
066000***************************************************************** 06940000
066100*    RESPONSIBILITY LEVEL   DB2 TABLE DEFINITION                  06950000
066200***************************************************************** 06960000
066300                                                                  06970000
066400     EXEC SQL                                                     06980000
066500         INCLUDE TRSPLVL                                          06990000
066600     END-EXEC.                                                    07000000
066700     EJECT                                                        07010000
066800***************************************************************** 07020000
066900*    MBS WORKER TABLE       DB2 TABLE DEFINITION                  07030000
067000***************************************************************** 07040000
067100                                                                  07050000
067200     EXEC SQL                                                     07060000
067300         INCLUDE TWORKER                                          07070000
067400     END-EXEC.                                                    07080000
067500***************************************************************** 07090000
067600*    MBS MERCHANDISE AREA   DB2 TABLE DEFINITION                  07100000
067700***************************************************************** 07110000
067800                                                                  07120000
067900     EXEC SQL                                                     07130000
068000         INCLUDE TMDSEAR                                          07140000
068100     END-EXEC.                                                    07150000
068200***************************************************************** 07160000
068300*    MBS RESPONSIBILITY AREA DB2 TABLE DEFINITION                 07170000
068400***************************************************************** 07180000
068500                                                                  07190000
068600     EXEC SQL                                                     07200000
068700         INCLUDE TRSPBAR                                          07210000
068800     END-EXEC.                                                    07220000
068900***************************************************************** 07230000
069000*    MBS MERCHANDISE DEPT    DB2 TABLE DEFINITION                 07240000
069100***************************************************************** 07250000
069200                                                                  07260000
069300     EXEC SQL                                                     07270000
069400         INCLUDE TMDSEDP                                          07280000
069500     END-EXEC.                                                    07290000
069600***************************************************************** 07300000
069700*    MBS SHRINK PERCENT      DB2 TABLE DEFINITION                 07310000
069800***************************************************************** 07320000
069900                                                                  07330000
070000     EXEC SQL                                                     07340000
070100         INCLUDE TDPTSHK                                          07350000
070200     END-EXEC.                                                    07360000
070300***************************************************************** 07370000
070400*    MBS MERCHANDISE CLASS   DB2 TABLE DEFINITION                 07380000
070500***************************************************************** 07390000
070600                                                                  07400000
070700     EXEC SQL                                                     07410000
070800         INCLUDE TMDSECL                                          07420000
070900     END-EXEC.                                                    07430000
071000***************************************************************** 07440000
071100*    MBS APPLIC. AVAILABILITY DB2 TABLE DEFINITION                07450000
071200***************************************************************** 07460000
071300                                                                  07470000
071400     EXEC SQL                                                     07480000
071500         INCLUDE TAPLAVL                                          07490000
071600     END-EXEC.                                                    07500000
071700                                                                  07510000
071800***************************************************************** 07520000
071900*    APPLICATION AVAILABILITY CURSOR                              07530000
072000***************************************************************** 07540000
072100     EXEC SQL                                                     07550000
072200         DECLARE APLAVL_CUR CURSOR FOR                            07560000
072300            SELECT B.APLSYS_CDE,                                  07570000
072400                   B.MDSEAR_DKEY,                                 07580000
072500                   B.MDSEAR_STRT_DTE,                             07590000
072600                   B.MDSEAR_END_DTE                               07600000
072700            FROM TAPLAVL B                                        07610000
072800            WHERE (B.MDSEAR_DKEY = :DK-MDSEAR-DKEY) AND           07620000
072900                  (B.MDSEAR_END_DTE > DATE(CURRENT TIMESTAMP))    07630000
073000     END-EXEC.                                                    07640000
073100                                                                  07650000
073200     EJECT                                                        07660000
073300***************************************************************** 07670000
073400*    DB2 COMMUNICATION AREA                                       07680000
073500***************************************************************** 07690000
073600                                                                  07700000
073700     EXEC SQL                                                     07710000
073800         INCLUDE SQLCA                                            07720000
073900     END-EXEC.                                                    07730000
074000                                                                  07740000
074100                                                                  07750000
074200 LINKAGE SECTION.                                                 07760000
074300                                                                  07770000
074400 01  DFHCOMMAREA.                                                 07780000
074500     05  FILLER                       OCCURS 1 TO 4072 TIMES      07790000
074600                                      DEPENDING ON EIBCALEN.      07800000
074700         10  FILLER                   PIC X.                      07810000
074800 EJECT                                                            07820000
074900*                                                                 07830000
075000*                                                                 07840000
075100*                                                                 07850000
075200 PROCEDURE DIVISION.                                              07860000
075300                                                                  07870000
075400                                                                  07880000
075500                                                                  07890000
075600                                                                  07900000
075700 0000-MAIN-MODULE.                                                07910000
075800                                                                  07920000
075900******************************************************************07930000
076000*    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.           07940000
076100*                                                                 07950000
076200************* DO NOT ALTER THIS PARAGRAPH ************************07960000
076300*                                                                 07970000
076400******************************************************************07980000
076500                                                                  07990000
076600     PERFORM DP015-0000-CHECK-COMMAREA.                           08000000
076700                                                                  08010000
076800******************************************************************08020000
076900*    DP020-SRC-RETURN-W-TRAN-ID WILL BE TRUE IF THIS PROGRAM WAS  08030000
077000*    SENT A STANDARD COMMAREA. IF NOT SET TRUE (MEANING OTHER     08040000
077100*    THAN A STANDARD COMMAREA WAS SENT TO THIS PROGRAM, THIS      08050000
077200*    PROGRAM WILL RETURN TO CICS.                                 08060000
077300******************************************************************08070000
077400     IF DP020-SRC-RETURN-W-TRAN-ID                                08080000
077500         PERFORM 1000-CONTROL-PROCESSING                          08090000
077600     END-IF.                                                      08100000
077700                                                                  08110000
077800     PERFORM DP003-0000-RETURN-TO-CICS.                           08120000
077900 EJECT                                                            08130000
078000 1000-CONTROL-PROCESSING.                                         08140000
078100                                                                  08150000
078200******************************************************************08160000
078300*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    08170000
078400*    COURSE OF ACTION IS FOR THIS TRANSACTION.                    08180000
078500*                                                                 08190000
078600*                                                                 08200000
078700************* DO NOT ALTER THIS PARAGRAPH ************************08210000
078800*                                                                 08220000
078900******************************************************************08230000
079000                                                                  08240000
079100     MOVE LENGTH OF MB104-MDSEAR-ADD-TSQUEUE                      08250000
079200                               TO  ASC-TEMP-QUEUE-LENGTH          08260000
079300                                   MB005-LIST-QUEUE-LENGTH.       08270000
079400                                                                  08280000
079500     EVALUATE TRUE                                                08290000
079600                                                                  08300000
079700         WHEN DP020-NEXT-ACT-INITIAL                              08310000
079800             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 08320000
079900                                                                  08330000
080000             PERFORM 1100-INITIALIZE-COMMAREA                     08340000
080100             MOVE LENGTH OF MB104-MDSEAR-ADD-TSQUEUE              08350000
080200                               TO  ASC-TEMP-QUEUE-LENGTH          08360000
080300                                   MB005-LIST-QUEUE-LENGTH        08370000
080400             PERFORM 4100-SAVE-INITIAL-INTERAPPL                  08380000
080500             IF PS-INTER-APPL-VALID                               08390000
080600                PERFORM 1500-DETERMINE-AND-READ-TSQ               08400000
080700                PERFORM 1700-CONTROL-PATH                         08410000
080800             ELSE                                                 08420000
080900                PERFORM 9999-RETURN-TO-PREV-TRAN                  08430000
081000                PERFORM 4300-SETUP-INTER-APPL-COMM                08440000
081100                PERFORM DP015-1000-START-NAVIGATOR                08450000
081200             END-IF                                               08460000
081300                                                                  08470000
081400         WHEN DP020-NEXT-ACT-READ-MAP                             08480000
081500             PERFORM 3000-PROCESS-MAP                             08490000
081600                                                                  08500000
081700         WHEN DP020-NEXT-ACT-RETURN                               08510000
081800             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 08520000
081900                                                                  08530000
082000             PERFORM 4200-UPDATE-INITIAL-INTERAPPL                08540000
082100             PERFORM 3300-EDIT-DATA-IN-COMMAREA                   08550000
082200             PERFORM 2200-DISPLAY-PANEL                           08560000
082300                                                                  08570000
082400         WHEN DP020-NEXT-ACT-ERROR                                08580000
082500                                                                  08590000
082600             MOVE DP020-MSG-NUMBER-X  TO PV-MSG-NUMBER-X          08600000
082700                                                                  08610000
082800             IF DP020-NAV-MNEMONIC = SPACES                       08620000
082900                 MOVE SPACES          TO ANAVCMDO                 08630000
083000                 MOVE DP015-GREEN     TO ANAVCMDC                 08640000
083100                 MOVE DP015-UNDERLINE TO ANAVCMDH                 08650000
083200             ELSE                                                 08660000
083300                 MOVE DP015-RED       TO ANAVCMDC                 08670000
083400                 MOVE DP015-REVERSE   TO ANAVCMDH                 08680000
083500             END-IF                                               08690000
083600                                                                  08700000
083700             MOVE LOW-VALUES TO DP020-INTER-APPL-DATA-AREA        08710000
083800                                                                  08720000
083900             PERFORM 3300-EDIT-DATA-IN-COMMAREA                   08730000
084000                                                                  08740000
084100             SET PS-ERROR                TO TRUE                  08750000
084200             SET PS-SEND-DATA-ONLY-FRSET TO TRUE                  08760000
084300                                                                  08770000
084400             MOVE PV-MSG-NUMBER-X     TO DP020-MSG-NUMBER-X       08780000
084500******************************************************************08790000
084600*    END OF CODE BLOCK DESIGNED TO SAVE MESSAGE FROM DPKCS008     08800000
084700******************************************************************08810000
084800             MOVE -1         TO ANAVCMDL                          08820000
084900                                                                  08830000
085000             PERFORM 2200-DISPLAY-PANEL                           08840000
085100                                                                  08850000
085200         WHEN OTHER                                               08860000
085300             SET DP013-LOGIC-ABEND TO TRUE                        08870000
085400             SET DP013-NO-ROLLBACK TO TRUE                        08880000
085500                                                                  08890000
085600             MOVE 'B100-CONTROL-PROCESSING' TO                    08900000
085700                  DP013-PARAGRAPH                                 08910000
085800             MOVE 'INVALID NEXT ACTION FOR ARCHITECTURE' TO       08920000
085900                     DP013-MESSAGE-TEXT(1)                        08930000
086000                                                                  08940000
086100             PERFORM DP013-0000-PROCESS-ABEND                     08950000
086200                                                                  08960000
086300     END-EVALUATE.                                                08970000
086400 EJECT                                                            08980000
086500 1100-INITIALIZE-COMMAREA.                                        08990000
086600                                                                  09000000
086700******************************************************************09010000
086800*                                                                 09020000
086900******************************************************************09030000
087000      INITIALIZE ASC-APPL-SPEC-COMMAREA.                          09040000
087100                                                                  09050000
087200 EJECT                                                            09060000
087300                                                                  09070000
087400 1500-DETERMINE-AND-READ-TSQ.                                     09080000
087500******************************************************************09090000
087600*                                                                 09100000
087700*    READ THE ADD TEMP STORAGE QUEUE. MOVE PERTINENT DATA TO      09110000
087800*    APP. SPECIFIC COMMAREA.                                      09120000
087900*                                                                 09130000
088000*    PERFORMED BY : 1000-CONTROL-PROCESSING                       09140000
088100******************************************************************09150000
088200                                                                  09160000
088300     MOVE +1 TO ASC-TSQ-ITEM-NBR.                                 09170000
088400                                                                  09180000
088500     PERFORM 9050-READ-TSQ.                                       09190000
088600                                                                  09200000
088700     MOVE MB104-CO-NUMBER       TO ASC-COMPANY-NO.                09210000
088800     MOVE MB104-GMA-NUMBER      TO ASC-GMA-NO.                    09220000
088900     MOVE MB104-GMA-DESCRIP     TO ASC-GMA-DESC.                  09230000
089000     MOVE MB104-DMA-NUMBER      TO ASC-DMA-NO.                    09240000
089100     MOVE MB104-DMA-DESCRIP     TO ASC-DMA-DESC.                  09250000
089200     MOVE MB104-DEPT-NUMBER     TO ASC-DPT-NO.                    09260000
089300     MOVE MB104-DEPT-DESCRIP    TO ASC-DPT-DESC.                  09270000
089400     MOVE MB104-MCLASS-NUMBER   TO ASC-MCL-NO.                    09280000
089500     MOVE MB104-MCLASS-DESCRIP  TO ASC-MCL-DESC.                  09290000
089600     MOVE MB104-SCLASS-NUMBER   TO ASC-SCL-NO.                    09300000
089700     MOVE MB104-SCLASS-DESCRIP  TO ASC-SCL-DESC.                  09310000
089800     MOVE MB104-START-DATE      TO ASC-LEVEL-START-DATE-CYMD.     09320000
089900     MOVE MB104-END-DATE        TO ASC-LEVEL-END-DATE-CYMD.       09330000
090000     MOVE MB104-MDSE-LEVEL      TO ASC-LEVEL-TO-ADD.              09340000
090100     MOVE MB104-MERCH-TYPE      TO ASC-MERCH-TYPE.                09350000
090200     MOVE MB104-BUYER-NUMBER    TO ASC-BUYER-NUMBER.              09360000
090300     MOVE MB104-BUS-GROUP       TO ASC-BUS-GROUP.                 09370000
090400     MOVE MB104-DEPT-DISCOUNT   TO ASC-DEPT-DISCOUNT.             09380000
090500     MOVE MB104-AR-DESCRIP      TO ASC-AR-DESCRIP.                09390000
090600     MOVE MB104-POS-DESCRIP     TO ASC-POS-DESCRIP.               09400000
090700     MOVE MB104-TAX-DEFLT-IND   TO ASC-TAX-DEFLT-IND.             09410000
090800     MOVE MB104-CONSIGN-IND     TO ASC-CONSIGN-IND.               09420000
090900     MOVE MB104-DAYS-BEF-SHIP-NBR TO                              09430000
091000          ASC-SCRN-DAYS-BEF-SHIP-NBR                              09440000
091100     MOVE MB104-DAYS-AFT-CLR-NBR TO                               09450000
091200          ASC-SCRN-DAYS-AFT-CLR-NBR                               09460000
091300     MOVE MB104-SKU-LVL-UPD-IND TO ASC-SKU-LVL-UPD-IND.           09470000
091400     MOVE MB104-PARENT-MDSEAR-DKEY TO ASC-PARENT-MDSEAR-DKEY.     09480000
091500                                                                  09490000
091600     IF  MB104-FREIGHT-PERCENT NUMERIC                            09500000
091700         MOVE MB104-FREIGHT-PERCENT                               09510000
091800                                TO  ASC-FREIGHT-PERCENT           09520000
091900     ELSE                                                         09530000
092000         MOVE ZERO              TO  ASC-FREIGHT-PERCENT           09540000
092100     END-IF.                                                      09550000
092200                                                                  09560000
C14666     IF  MB104-BM-SHRINK-PERCENT NUMERIC                          09570000
C14666         MOVE MB104-BM-SHRINK-PERCENT                             09580001
C14666                                TO  ASC-BM-SHRINK-PERCENT         09590001
092600     ELSE                                                         09600000
C14666         MOVE ZERO              TO  ASC-BM-SHRINK-PERCENT         09610001
092800     END-IF.                                                      09620000
092900                                                                  09630000
C14666     IF  MB104-ECOM-SHRINK-PERCENT NUMERIC                        09640000
C14666         MOVE MB104-ECOM-SHRINK-PERCENT                           09650000
C14666                                TO  ASC-ECOM-SHRINK-PERCENT       09660000
C14666     ELSE                                                         09670000
C14666         MOVE ZERO              TO  ASC-ECOM-SHRINK-PERCENT       09680000
C14666     END-IF.                                                      09690000
C14666                                                                  09700000
093000     MOVE MB104-STR-ZN-ID        TO  ASC-STR-ZN-ID.               09710000
093100     MOVE MB104-CAL-MN-NBR       TO  ASC-CAL-MN-NBR.              09720000
093200     MOVE MB104-SHNK-FSCL-YR-NBR TO  ASC-SHNK-FSCL-YR-NBR.        09730000
093300                                                                  09740000
093400/                                                                 09750000
093500 1700-CONTROL-PATH.                                               09760000
093600******************************************************************09770000
093700*    THIS PARAGRAPH CONTROLS THE PATH OF THE PROGRAM.             09780000
093800*                                                                 09790000
093900*    IF USER IS ADDING GMA,DMA OR DEPARTMENT LEVELS, HE HAS TO    09800000
094000*    ENTER RESPONSIBITY DATA, THUS SCREEN SHOULD BE BUILT AND     09810000
094100*    DISPLAYED. ALL OTHER LEVELS DO NOT NEED RESPONSIBITY DATA    09820000
094200*    AND SHOULD PROCESS THE TABLE MAINTAINANCE PARAGRAPHS, AND    09830000
094300*    RETURN TO THE BEGINNING OF THE ADD CYCLE.                    09840000
094400*                                                                 09850000
094500*    PERFORMED BY : 1000-CONTROL-PROCESSING                       09860000
094600******************************************************************09870000
094700     IF (ASC-ADD-GMA) OR                                          09880000
094800        (ASC-ADD-DMA) OR                                          09890000
094900        (ASC-ADD-DPT)                                             09900000
095000        PERFORM 2000-BUILD-INITIAL-PANEL                          09910000
095100        PERFORM 2200-DISPLAY-PANEL                                09920000
095200     ELSE                                                         09930000
095300        PERFORM 6000-PROCESS-MAINTAINANCE                         09940000
095400        PERFORM 9999-RETURN-TO-PREV-TRAN                          09950000
095500        PERFORM 4300-SETUP-INTER-APPL-COMM                        09960000
095600        PERFORM DP015-1000-START-NAVIGATOR                        09970000
095700     END-IF.                                                      09980000
095800                                                                  09990000
095900                                                                  10000000
096000                                                                  10010000
096100 1700-RESET-ATTRIBUTES.                                           10020000
096200******************************************************************10030000
096300*                                                                 10040000
096400******************************************************************10050000
096500     IF ASC-ADD-GMA                                               10060000
096600        MOVE DP015-ASK-DRK-OFF  TO MR-DMAHDR-A                    10070000
096700                                   MR-DMA-NO-A                    10080000
096800                                   MR-DMA-DESC-A                  10090000
096900                                   MR-DPTHDR-A                    10100000
097000                                   MR-DPT-NO-A                    10110000
097100                                   MR-DPT-DESC-A                  10120000
097200        MOVE DP015-HL-OFF       TO MR-DMAHDR-H                    10130000
097300                                   MR-DMA-NO-H                    10140000
097400                                   MR-DMA-DESC-H                  10150000
097500                                   MR-DPTHDR-H                    10160000
097600                                   MR-DPT-NO-H                    10170000
097700                                   MR-DPT-DESC-H                  10180000
097800     ELSE                                                         10190000
097900        IF ASC-ADD-DMA                                            10200000
098000            MOVE DP015-ASK-DRK-OFF TO MR-DPTHDR-A                 10210000
098100                                      MR-DPT-NO-A                 10220000
098200                                      MR-DPT-DESC-A               10230000
098300            MOVE DP015-HL-OFF   TO MR-DPTHDR-H                    10240000
098400                                   MR-DPT-NO-H                    10250000
098500                                   MR-DPT-DESC-H                  10260000
098600        END-IF                                                    10270000
098700     END-IF.                                                      10280000
098800                                                                  10290000
098900                                                                  10300000
099000     PERFORM VARYING PV-MAP-SUB                                   10310000
099100             FROM 1 BY 1                                          10320000
099200             UNTIL PV-MAP-SUB > 9                                 10330000
099300                                                                  10340000
099400         MOVE DP015-GREEN  TO MR-LEVEL-C(PV-MAP-SUB)              10350000
099500                              MR-STRT-MM-C(PV-MAP-SUB)            10360000
099600                              MR-STRT-DD-C(PV-MAP-SUB)            10370000
099700                              MR-STRT-YY-C(PV-MAP-SUB)            10380000
099800                              MR-END-MM-C(PV-MAP-SUB)             10390000
099900                              MR-END-DD-C(PV-MAP-SUB)             10400000
100000                              MR-END-YY-C(PV-MAP-SUB)             10410000
100100                              MR-WORKER-C(PV-MAP-SUB)             10420000
100200                                                                  10430000
100300         MOVE DP015-UNDERLINE TO MR-LEVEL-H(PV-MAP-SUB)           10440000
100400                              MR-STRT-MM-H(PV-MAP-SUB)            10450000
100500                              MR-STRT-DD-H(PV-MAP-SUB)            10460000
100600                              MR-STRT-YY-H(PV-MAP-SUB)            10470000
100700                              MR-END-MM-H(PV-MAP-SUB)             10480000
100800                              MR-END-DD-H(PV-MAP-SUB)             10490000
100900                              MR-END-YY-H(PV-MAP-SUB)             10500000
101000                              MR-WORKER-H(PV-MAP-SUB)             10510000
101100     END-PERFORM.                                                 10520000
101200                                                                  10530000
101300 2000-BUILD-INITIAL-PANEL.                                        10540000
101400                                                                  10550000
101500******************************************************************10560000
101600*  DISPLAY A BLANK SCREEN SO USER CAN ENTER RESPONSIBILITY DATA   10570000
101700*                                                                 10580000
101800******************************************************************10590000
101900                                                                  10600000
102000     PERFORM DP017-0000-GET-CURR-DATE-TIME                        10610000
102100     SET DP017-EDITED-YMD-DATE-DASH-1                             10620000
102200         DP017-EDITED-YMD-DATE-DASH-2 TO TRUE.                    10630000
102300     INITIALIZE ASC-SCREEN-TABLE-INFO.                            10640000
102400     MOVE DP017-EDITED-DATE-YYYYMMDD TO  DK-END-DATE              10650000
102500                                       ASC-EDITED-DATE-YYYYMMDD.  10660000
102600     MOVE DP017-CURRENT-DATE-YYYYMMDD TO ASC-CURRENT-DATE-CYMD.   10670000
102700                                                                  10680000
102800     PERFORM 1700-RESET-ATTRIBUTES.                               10690000
102900                                                                  10700000
103000 EJECT                                                            10710000
103100                                                                  10720000
103200                                                                  10730000
103300 2200-DISPLAY-PANEL.                                              10740000
103400                                                                  10750000
103500******************************************************************10760000
103600*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.       10770000
103700*                                                                 10780000
103800******************************************************************10790000
103900                                                                  10800000
104000     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       10810000
104100                                                                  10820000
104200     PERFORM DP002-0000-FORMAT-TITLE-LINES.                       10830000
104300     PERFORM 3310-MOVE-COMMAREA-TO-SCREEN.                        10840000
104400                                                                  10850000
104500                                                                  10860000
104600     PERFORM DP005-0000-FORMAT-MSG-LINES.                         10870000
104700                                                                  10880000
104800     IF (DP020-SRC-AID = DP016-PA2) OR                            10890000
104900        (PS-SEND-MAP-N-DATA-FRSET)                                10900000
105000         PERFORM DP009-0000-LOAD-FK-LINES                         10910000
105100     END-IF.                                                      10920000
105200                                                                  10930000
105300     IF PS-NO-ERROR                                               10940000
105400        MOVE -1 TO MR-LEVEL-L(1)                                  10950000
105500     END-IF.                                                      10960000
105600                                                                  10970000
105700     PERFORM DP008-0000-WRITE-PANEL.                              10980000
105800                                                                  10990000
105900 EJECT                                                            11000000
106000                                                                  11010000
106100                                                                  11020000
106200                                                                  11030000
106300 3000-PROCESS-MAP.                                                11040000
106400                                                                  11050000
106500******************************************************************11060000
106600*                                                                 11070000
106700******************************************************************11080000
106800                                                                  11090000
106900     SET PS-SEND-DATA-ONLY-FRSET TO TRUE.                         11100000
107000                                                                  11110000
107100     PERFORM DP007-0000-GET-PANEL.                                11120000
107200                                                                  11130000
107300                                                                  11140000
107400     IF (DP020-SRC-AID NOT = DP016-PF5)   AND                     11150000
107500        (DP020-SRC-AID NOT = DP016-CLEAR)                         11160000
107600         PERFORM 3200-MOVE-SCREEN-TO-COMMAREA                     11170000
107700     END-IF.                                                      11180000
107800                                                                  11190000
107900     PERFORM 3100-CHECK-LOCAL-FKEYS.                              11200000
108000 EJECT                                                            11210000
108100                                                                  11220000
108200 3100-CHECK-LOCAL-FKEYS.                                          11230000
108300                                                                  11240000
108400******************************************************************11250000
108500*    TAKE THE APPROPRIATE COURSE OF ACTION BASED ON WHAT          11260000
108600*    FUNCTION KEY THE USER HAS HIT.                               11270000
108700*                                                                 11280000
108800*    MODIFY THE EVALUATE CLAUSE BELOW BY ADDING A WHEN  CLAUSE    11290000
108900*    FOR EACH AID KEY YOU PLAN ON HANDLING WITHIN THIS PROGRAM.   11300000
109000*    DO NOT MODIFY OR DELETE ANY OF THE EXISTING WHEN  CLAUSES.   11310000
109100*                                                                 11320000
109200******************************************************************11330000
109300                                                                  11340000
109400     EVALUATE TRUE                                                11350000
109500                                                                  11360000
109600         WHEN (DP020-FK-GO-TO-TRAN(DP020-SRC-AID)  OR             11370000
109700               DP020-FK-RETURN(DP020-SRC-AID))                    11380000
109800             PERFORM 4300-SETUP-INTER-APPL-COMM                   11390000
109900             PERFORM DP015-1000-START-NAVIGATOR                   11400000
110000                                                                  11410000
110100         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     11420000
110200             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 11430000
110300             INITIALIZE ANAVCMDO ANAVKEYO                         11440000
110400                        DP020-NAV-KEY-DATA                        11450000
110500                        DP020-NAV-MNEMONIC                        11460000
110600             PERFORM 2000-BUILD-INITIAL-PANEL                     11470000
110700             PERFORM 2200-DISPLAY-PANEL                           11480000
110800                                                                  11490000
110900                                                                  11500000
111000         WHEN DP020-SRC-AID = DP016-ENTER                         11510000
111100                                                                  11520000
111200             IF (DP020-NAV-MNEMONIC = SPACES)     OR              11530000
111300                (DP020-NAV-MNEMONIC = LOW-VALUES)                 11540000
111400                 PERFORM 3300-EDIT-DATA-IN-COMMAREA               11550000
111500                 PERFORM 2200-DISPLAY-PANEL                       11560000
111600             ELSE                                                 11570000
111700                 PERFORM 4300-SETUP-INTER-APPL-COMM               11580000
111800                 PERFORM DP015-1000-START-NAVIGATOR               11590000
111900             END-IF                                               11600000
112000                                                                  11610000
112100         WHEN DP020-SRC-AID = DP016-PF13                          11620000
112200             PERFORM 3300-EDIT-DATA-IN-COMMAREA                   11630000
112300             IF PS-NO-ERROR                                       11640000
112400                PERFORM 5500-SORT-SCREEN                          11650000
112500                PERFORM 6000-PROCESS-MAINTAINANCE                 11660000
112600                IF PS-NO-ERROR                                    11670000
112700                    PERFORM 9999-RETURN-TO-PREV-TRAN              11680000
112800                    PERFORM 4300-SETUP-INTER-APPL-COMM            11690000
112900                    PERFORM DP015-1000-START-NAVIGATOR            11700000
113000                END-IF                                            11710000
113100             END-IF                                               11720000
113200             PERFORM 3310-MOVE-COMMAREA-TO-SCREEN                 11730000
113300             PERFORM 2200-DISPLAY-PANEL                           11740000
113400                                                                  11750000
113500                                                                  11760000
113600                                                                  11770000
113700         WHEN DP020-SRC-AID = DP016-PA2                           11780000
113800             SET PS-SEND-DATA-ONLY TO TRUE                        11790000
113900                                                                  11800000
114000             MOVE -1 TO ANAVCMDL                                  11810000
114100                                                                  11820000
114200             PERFORM DP017-0000-GET-CURR-DATE-TIME                11830000
114300             PERFORM DP009-0000-LOAD-FK-LINES                     11840000
114400             PERFORM DP008-0000-WRITE-PANEL                       11850000
114500                                                                  11860000
114600         WHEN DP020-SRC-AID = DP016-CLEAR                         11870000
114700             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 11880000
114800                                                                  11890000
114900             PERFORM 3300-EDIT-DATA-IN-COMMAREA                   11900000
115000             PERFORM 2200-DISPLAY-PANEL                           11910000
115100                                                                  11920000
115200         WHEN OTHER                                               11930000
115300*            -- INVALID FUNCTION KEY --                           11940000
115400             PERFORM 3300-EDIT-DATA-IN-COMMAREA                   11950000
115500             MOVE PC-TSYMSG-00045  TO DP020-MSG-NUMBER            11960000
115600             SET DP020-MSG-FATAL TO TRUE                          11970000
115700             PERFORM 2200-DISPLAY-PANEL                           11980000
115800                                                                  11990000
115900     END-EVALUATE.                                                12000000
116000 EJECT                                                            12010000
116100                                                                  12020000
116200 3200-MOVE-SCREEN-TO-COMMAREA.                                    12030000
116300                                                                  12040000
116400******************************************************************12050000
116500*                                                                 12060000
116600******************************************************************12070000
116700                                                                  12080000
116800     SET ASC-INDEX TO 1.                                          12090000
116900                                                                  12100000
117000     PERFORM VARYING PV-MAP-SUB                                   12110000
117100        FROM 1 BY 1                                               12120000
117200        UNTIL (PV-MAP-SUB > PC-MAX-SCREEN-LINES)                  12130000
117300                                                                  12140000
117400         IF MR-LEVEL-L(PV-MAP-SUB) > 0                            12150000
117500            MOVE MR-LEVEL(PV-MAP-SUB)   TO ASC-LEVEL(ASC-INDEX)   12160000
117600            SET ASC-LEVEL-CHANGED(ASC-INDEX) TO TRUE              12170000
117700         ELSE                                                     12180000
117800            IF MR-LEVEL-A(PV-MAP-SUB) = DP015-ERASE-EOF           12190000
117900               MOVE SPACE TO ASC-LEVEL(ASC-INDEX)                 12200000
118000               SET ASC-LEVEL-CHANGED(ASC-INDEX) TO TRUE           12210000
118100            END-IF                                                12220000
118200         END-IF                                                   12230000
118300*                                                                 12240000
118400*                                                                 12250000
118500         IF MR-STRT-MM-L(PV-MAP-SUB) > 0                          12260000
118600            MOVE MR-STRT-MM(PV-MAP-SUB) TO                        12270000
118700                 ASC-START-MM(ASC-INDEX)                          12280000
118800         ELSE                                                     12290000
118900            IF MR-STRT-MM-A(PV-MAP-SUB) = DP015-ERASE-EOF         12300000
119000               MOVE SPACE TO ASC-START-MM(ASC-INDEX)              12310000
119100            END-IF                                                12320000
119200         END-IF                                                   12330000
119300                                                                  12340000
119400         IF MR-STRT-DD-L(PV-MAP-SUB) > 0                          12350000
119500            MOVE MR-STRT-DD(PV-MAP-SUB) TO                        12360000
119600                 ASC-START-DD(ASC-INDEX)                          12370000
119700         ELSE                                                     12380000
119800            IF MR-STRT-DD-A(PV-MAP-SUB) = DP015-ERASE-EOF         12390000
119900               MOVE SPACE TO ASC-START-DD(ASC-INDEX)              12400000
120000            END-IF                                                12410000
120100         END-IF                                                   12420000
120200                                                                  12430000
120300         IF MR-STRT-YY-L(PV-MAP-SUB) > 0                          12440000
120400            MOVE MR-STRT-YY(PV-MAP-SUB) TO                        12450000
120500                 ASC-START-YY(ASC-INDEX)                          12460000
120600         ELSE                                                     12470000
120700            IF MR-STRT-YY-A(PV-MAP-SUB) = DP015-ERASE-EOF         12480000
120800               MOVE SPACE TO ASC-START-YY(ASC-INDEX)              12490000
120900            END-IF                                                12500000
121000         END-IF                                                   12510000
121100*                                                                 12520000
121200*                                                                 12530000
121300         IF MR-END-MM-L(PV-MAP-SUB) > 0                           12540000
121400            MOVE MR-END-MM(PV-MAP-SUB) TO ASC-END-MM(ASC-INDEX)   12550000
121500         ELSE                                                     12560000
121600            IF MR-END-MM-A(PV-MAP-SUB) = DP015-ERASE-EOF          12570000
121700               MOVE SPACE TO ASC-END-MM(ASC-INDEX)                12580000
121800            END-IF                                                12590000
121900         END-IF                                                   12600000
122000                                                                  12610000
122100         IF MR-END-DD-L(PV-MAP-SUB) > 0                           12620000
122200            MOVE MR-END-DD(PV-MAP-SUB) TO ASC-END-DD(ASC-INDEX)   12630000
122300         ELSE                                                     12640000
122400            IF MR-END-DD-A(PV-MAP-SUB) = DP015-ERASE-EOF          12650000
122500               MOVE SPACE TO ASC-END-DD(ASC-INDEX)                12660000
122600            END-IF                                                12670000
122700         END-IF                                                   12680000
122800                                                                  12690000
122900         IF MR-END-YY-L(PV-MAP-SUB) > 0                           12700000
123000            MOVE MR-END-YY(PV-MAP-SUB) TO ASC-END-YY(ASC-INDEX)   12710000
123100         ELSE                                                     12720000
123200            IF MR-END-YY-A(PV-MAP-SUB) = DP015-ERASE-EOF          12730000
123300               MOVE SPACE TO ASC-END-YY(ASC-INDEX)                12740000
123400            END-IF                                                12750000
123500         END-IF                                                   12760000
123600*                                                                 12770000
123700*                                                                 12780000
123800         IF MR-WORKER-L(PV-MAP-SUB) > 0                           12790000
123900            MOVE MR-WORKER(PV-MAP-SUB) TO                         12800000
124000                 ASC-WORKER-ID(ASC-INDEX)                         12810000
124100            SET ASC-WORKER-CHANGED(ASC-INDEX) TO TRUE             12820000
124200         ELSE                                                     12830000
124300            IF MR-WORKER-A(PV-MAP-SUB) = DP015-ERASE-EOF          12840000
124400               MOVE SPACE TO ASC-WORKER-ID(ASC-INDEX)             12850000
124500               SET ASC-WORKER-CHANGED(ASC-INDEX) TO TRUE          12860000
124600            END-IF                                                12870000
124700         END-IF                                                   12880000
124800*                                                                 12890000
124900*                                                                 12900000
125000         IF MR-LNAME-L(PV-MAP-SUB) > 0                            12910000
125100            MOVE MR-LNAME(PV-MAP-SUB) TO ASC-LAST-NAME(ASC-INDEX) 12920000
125200         ELSE                                                     12930000
125300            IF MR-LNAME-A(PV-MAP-SUB) = DP015-ERASE-EOF           12940000
125400               MOVE SPACE TO ASC-LAST-NAME(ASC-INDEX)             12950000
125500            END-IF                                                12960000
125600         END-IF                                                   12970000
125700*                                                                 12980000
125800*                                                                 12990000
125900         IF MR-FNAME-L(PV-MAP-SUB) > 0                            13000000
126000            MOVE MR-FNAME(PV-MAP-SUB) TO ASC-FIRST-NAME(ASC-INDEX)13010000
126100         ELSE                                                     13020000
126200            IF MR-FNAME-A(PV-MAP-SUB) = DP015-ERASE-EOF           13030000
126300               MOVE SPACE TO ASC-FIRST-NAME(ASC-INDEX)            13040000
126400            END-IF                                                13050000
126500         END-IF                                                   13060000
126600                                                                  13070000
126700        SET ASC-INDEX UP BY 1                                     13080000
126800                                                                  13090000
126900     END-PERFORM.                                                 13100000
127000                                                                  13110000
127100 EJECT                                                            13120000
127200                                                                  13130000
127300 3300-EDIT-DATA-IN-COMMAREA.                                      13140000
127400                                                                  13150000
127500******************************************************************13160000
127600*                                                                 13170000
127700******************************************************************13180000
127800                                                                  13190000
127900     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       13200000
128000                                                                  13210000
128100     PERFORM 1700-RESET-ATTRIBUTES.                               13220000
128200                                                                  13230000
128300     SET PS-NO-ERROR TO TRUE.                                     13240000
128400                                                                  13250000
128500     MOVE +1 TO PV-FILL-SUB.                                      13260000
128600                                                                  13270000
128700     PERFORM 4000-PROCESS-SCREEN.                                 13280000
128800                                                                  13290000
128900     PERFORM 3310-MOVE-COMMAREA-TO-SCREEN.                        13300000
129000                                                                  13310000
129100     MOVE ASC-LINES-ENTERED  TO PV-WORK-SUB.                      13320000
129200     PERFORM                                                      13330000
129300        VARYING ASC-INDEX FROM                                    13340000
129400        PV-WORK-SUB BY -1                                         13350000
129500        UNTIL ASC-INDEX < 1                                       13360000
129600                                                                  13370000
129700        IF ASC-WORKER-NOT-CHANGED(ASC-INDEX)                      13380000
129800           CONTINUE                                               13390000
129900        ELSE                                                      13400000
130000           PERFORM 4030-VALIDATE-WORKER-ID                        13410000
130100        END-IF                                                    13420000
130200                                                                  13430000
130300        PERFORM 4020-VALIDATE-DATES                               13440000
130400                                                                  13450000
130500        IF ASC-LEVEL-NOT-CHANGED(ASC-INDEX)                       13460000
130600           CONTINUE                                               13470000
130700        ELSE                                                      13480000
130800           PERFORM 4010-EDIT-RESP-LEVEL                           13490000
130900        END-IF                                                    13500000
131000                                                                  13510000
131100        PERFORM 4050-CHECK-DUPLICATE-ENTRIES                      13520000
131200                                                                  13530000
131300        COMPUTE PV-WORK-SUB = PV-WORK-SUB - 1                     13540000
131400                                                                  13550000
131500     END-PERFORM.                                                 13560000
131600                                                                  13570000
131700     PERFORM 4040-EDIT-RESPON-ASSIGNMENTS.                        13580000
131800                                                                  13590000
131900                                                                  13600000
132000     PERFORM 4060-MASK-END-DATES.                                 13610000
132100                                                                  13620000
132200                                                                  13630000
132300 EJECT                                                            13640000
132400                                                                  13650000
132500                                                                  13660000
132600 3301-MOVE-SCREEN-LINE.                                           13670000
132700                                                                  13680000
132800******************************************************************13690000
132900*                                                                 13700000
133000*   PERFORMED BY : 3310-MOVE-COMMAREA-TO-SCREEN                   13710000
133100******************************************************************13720000
133200                                                                  13730000
133300     SET ASC-INDEX TO 1.                                          13740000
133400                                                                  13750000
133500     PERFORM VARYING PV-MAP-SUB                                   13760000
133600        FROM 1 BY 1                                               13770000
133700        UNTIL (PV-MAP-SUB > PC-MAX-SCREEN-LINES)                  13780000
133800                                                                  13790000
133900        MOVE ASC-LEVEL(ASC-INDEX)     TO MR-LEVEL (PV-MAP-SUB)    13800000
134000        MOVE ASC-START-MM(ASC-INDEX)  TO MR-STRT-MM(PV-MAP-SUB)   13810000
134100        MOVE ASC-START-DD(ASC-INDEX)  TO MR-STRT-DD(PV-MAP-SUB)   13820000
134200        MOVE ASC-START-YY(ASC-INDEX)  TO MR-STRT-YY(PV-MAP-SUB)   13830000
134300                                                                  13840000
134400        IF ASC-END-DATE-CYMD-N(PV-MAP-SUB) = PC-INFINITY-DATE     13850000
134500          MOVE SPACES              TO MR-END-MM(PV-MAP-SUB)       13860000
134600                                      MR-END-DD(PV-MAP-SUB)       13870000
134700                                      MR-END-YY(PV-MAP-SUB)       13880000
134800                                      ASC-END-MM(ASC-INDEX)       13890000
134900                                      ASC-END-DD(ASC-INDEX)       13900000
135000                                      ASC-END-YY(ASC-INDEX)       13910000
135100        ELSE                                                      13920000
135200          MOVE ASC-END-MM(ASC-INDEX)    TO MR-END-MM(PV-MAP-SUB)  13930000
135300          MOVE ASC-END-DD(ASC-INDEX)    TO MR-END-DD(PV-MAP-SUB)  13940000
135400          MOVE ASC-END-YY(ASC-INDEX)    TO MR-END-YY(PV-MAP-SUB)  13950000
135500        END-IF                                                    13960000
135600        MOVE ASC-WORKER-ID(ASC-INDEX) TO MR-WORKER(PV-MAP-SUB)    13970000
135700        MOVE ASC-LAST-NAME(ASC-INDEX) TO MR-LNAME(PV-MAP-SUB)     13980000
135800        MOVE ASC-FIRST-NAME(ASC-INDEX)TO MR-FNAME(PV-MAP-SUB)     13990000
135900                                                                  14000000
136000        SET ASC-INDEX UP BY 1                                     14010000
136100                                                                  14020000
136200     END-PERFORM.                                                 14030000
136300                                                                  14040000
136400 EJECT                                                            14050000
136500                                                                  14060000
136600 3305-REMOVE-EMPTY-LINES.                                         14070000
136700                                                                  14080000
136800******************************************************************14090000
136900*  IF USER REMOVES THE LEVEL FIELD FROM THE SCREEN, ERASE         14100000
137000*  THE LINE AND MOVE ALL LINES OF DATA BELOW IT UP.               14110000
137100******************************************************************14120000
137200     IF ASC-LEVEL(ASC-INDEX)  > SPACES                            14130000
137300        IF PV-FILL-SUB < ASC-INDEX                                14140000
137400           MOVE ASC-SCREEN-LINE(ASC-INDEX) TO                     14150000
137500                        ASC-SCREEN-LINE(PV-FILL-SUB)              14160000
137600           INITIALIZE ASC-SCREEN-LINE(ASC-INDEX)                  14170000
137700        END-IF                                                    14180000
137800        ADD  +1 TO PV-FILL-SUB                                    14190000
137900     ELSE                                                         14200000
138000        INITIALIZE ASC-SCREEN-LINE(ASC-INDEX)                     14210000
138100     END-IF.                                                      14220000
138200                                                                  14230000
138300 3310-MOVE-COMMAREA-TO-SCREEN.                                    14240000
138400******************************************************************14250000
138500*                                                                 14260000
138600******************************************************************14270000
138700                                                                  14280000
138800     MOVE ASC-COMPANY-NO          TO AOPERCOO.                    14290000
138900     MOVE ASC-GMA-NO              TO AGMAO.                       14300000
139000     MOVE ASC-GMA-DESC            TO AGMADESO.                    14310000
139100     MOVE ASC-DMA-NO              TO ADMAO.                       14320000
139200     MOVE ASC-DMA-DESC            TO ADMADESO.                    14330000
139300     MOVE ASC-DPT-NO              TO ADPTO.                       14340000
139400     MOVE ASC-DPT-DESC            TO ADPTDESO.                    14350000
139500     PERFORM 3301-MOVE-SCREEN-LINE.                               14360000
139600                                                                  14370000
139700 4000-PROCESS-SCREEN.                                             14380000
139800******************************************************************14390000
139900*  REMOVE ALL EMPTY LINES FROM THE SCREEN. IF THE USER EOF'S OR   14400000
140000*  MOVES SPACES TO THE RESPONSIBILITY AREA, REMOVE THE LINE FROM  14410000
140100*  THE SCREEN, AND MOVE ALL THE OTHER LINES OF DATA UP ONE LINE   14420000
140200*  ON THE SCREEN.                                                 14430000
140300*                                                                 14440000
140400******************************************************************14450000
140500                                                                  14460000
140600     PERFORM 3305-REMOVE-EMPTY-LINES                              14470000
140700        VARYING ASC-INDEX                                         14480000
140800        FROM 1 BY 1                                               14490000
140900        UNTIL (ASC-INDEX > PC-MAX-SCREEN-LINES).                  14500000
141000                                                                  14510000
141100     COMPUTE ASC-LINES-ENTERED = PV-FILL-SUB - 1.                 14520000
141200                                                                  14530000
141300                                                                  14540000
141400 4010-EDIT-RESP-LEVEL.                                            14550000
141500******************************************************************14560000
141600* MAKE SURE LEVELS ENTERED ARE VALID LEVELS ON DATABASE.          14570000
141700******************************************************************14580000
141800     MOVE ASC-LEVEL(ASC-INDEX)  TO DK-RSPLVL-CDE.                 14590000
141900     PERFORM 9000-GET-RESPBL-LEVEL.                               14600000
142000     IF SQLCODE = 0                                               14610000
142100        CONTINUE                                                  14620000
142200     ELSE                                                         14630000
142300        SET PS-ERROR         TO TRUE                              14640000
142400        SET DP020-MSG-FATAL  TO TRUE                              14650000
142500        MOVE DP015-RED       TO MR-LEVEL-C(PV-WORK-SUB)           14660000
142600        MOVE DP015-REVERSE   TO MR-LEVEL-H(PV-WORK-SUB)           14670000
142700        MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                  14680000
142800        MOVE -1              TO MR-LEVEL-L(PV-WORK-SUB)           14690000
142900     END-IF.                                                      14700000
143000                                                                  14710000
143100                                                                  14720000
143200 4020-VALIDATE-DATES.                                             14730000
143300******************************************************************14740000
143400*                                                                 14750000
143500******************************************************************14760000
143600                                                                  14770000
143700                                                                  14780000
143800     SET PS-NO-END-DATE-ERROR TO TRUE.                            14790000
143900     PERFORM 4022-EDIT-END-DATE.                                  14800000
144000                                                                  14810000
144100     SET PS-NO-START-DATE-ERROR TO TRUE                           14820000
144200     PERFORM 4021-EDIT-START-DATE.                                14830000
144300                                                                  14840000
144400     IF (PS-NO-START-DATE-ERROR) AND                              14850000
144500        (PS-NO-END-DATE-ERROR)                                    14860000
144600         PERFORM 4025-COMPARE-DATES                               14870000
144700     END-IF.                                                      14880000
144800                                                                  14890000
144900 4021-EDIT-START-DATE.                                            14900000
145000******************************************************************14910000
145100*                                                                 14920000
145200******************************************************************14930000
145300                                                                  14940000
145400     IF (ASC-START-MM(ASC-INDEX) = SPACES OR '00')                14950000
145500         CONTINUE                                                 14960000
145600     ELSE                                                         14970000
145700         MOVE ASC-START-MM(ASC-INDEX) TO  DP010I-UNEDITED-FIELD   14980000
145800         MOVE +2                 TO  DP010I-MAXIMUM-DIGITS        14990000
145900         SET DP010I-NEGATIVE-ALLOWED TO TRUE                      15000000
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15011003
262978              USING DP010I-NUMERIC-EDIT-AREA                      15012003
146100         IF DP010I-ERROR-DETECTED                                 15020000
146200            SET PS-START-DATE-ERROR TO TRUE                       15030000
146300         ELSE                                                     15040000
146400            MOVE DP010I-NUMERIC-FIELD  TO                         15050000
146500                                    ASC-START-MM-N(ASC-INDEX)     15060000
146600            MOVE ASC-START-MM(ASC-INDEX) TO                       15070000
146700                                    MR-STRT-MM(PV-WORK-SUB)       15080000
146800         END-IF                                                   15090000
146900     END-IF.                                                      15100000
147000                                                                  15110000
147100                                                                  15120000
147200     IF (ASC-START-DD(ASC-INDEX) = SPACES OR '00')                15130000
147300        CONTINUE                                                  15140000
147400     ELSE                                                         15150000
147500         MOVE ASC-START-DD(ASC-INDEX) TO  DP010I-UNEDITED-FIELD   15160000
147600         MOVE +2                 TO  DP010I-MAXIMUM-DIGITS        15170000
147700         SET DP010I-NEGATIVE-ALLOWED TO TRUE                      15180000
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15191003
262978              USING DP010I-NUMERIC-EDIT-AREA                      15192003
147900         IF DP010I-ERROR-DETECTED                                 15200000
148000            SET PS-START-DATE-ERROR TO TRUE                       15210000
148100         ELSE                                                     15220000
148200            MOVE DP010I-NUMERIC-FIELD  TO                         15230000
148300                                    ASC-START-DD-N(ASC-INDEX)     15240000
148400            MOVE ASC-START-DD(ASC-INDEX) TO                       15250000
148500                                    MR-STRT-DD(PV-WORK-SUB)       15260000
148600         END-IF                                                   15270000
148700     END-IF.                                                      15280000
148800                                                                  15290000
148900                                                                  15300000
149000     IF (ASC-START-YY(ASC-INDEX) = SPACES OR '00')                15310000
149100        CONTINUE                                                  15320000
149200     ELSE                                                         15330000
149300         MOVE ASC-START-YY(ASC-INDEX) TO  DP010I-UNEDITED-FIELD   15340000
149400         MOVE +2                 TO  DP010I-MAXIMUM-DIGITS        15350000
149500         SET DP010I-NEGATIVE-ALLOWED TO TRUE                      15360000
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15371003
262978              USING DP010I-NUMERIC-EDIT-AREA                      15372003
149700         IF DP010I-ERROR-DETECTED                                 15380000
149800            SET PS-START-DATE-ERROR TO TRUE                       15390000
149900         ELSE                                                     15400000
150000            MOVE DP010I-NUMERIC-FIELD  TO                         15410000
150100                                    ASC-START-YY-N(ASC-INDEX)     15420000
150200            MOVE ASC-START-YY(ASC-INDEX) TO                       15430000
150300                                    MR-STRT-YY(PV-WORK-SUB)       15440000
150400         END-IF                                                   15450000
150500     END-IF.                                                      15460000
150600                                                                  15470000
150700     IF PS-START-DATE-ERROR                                       15480000
150800        SET PS-ERROR         TO TRUE                              15490000
150900        SET DP020-MSG-FATAL  TO TRUE                              15500000
151000        MOVE DP015-RED       TO MR-STRT-MM-C(PV-WORK-SUB)         15510000
151100                                MR-STRT-DD-C(PV-WORK-SUB)         15520000
151200                                MR-STRT-YY-C(PV-WORK-SUB)         15530000
151300        MOVE DP015-REVERSE   TO MR-STRT-MM-H(PV-WORK-SUB)         15540000
151400                                MR-STRT-DD-H(PV-WORK-SUB)         15550000
151500                                MR-STRT-YY-H(PV-WORK-SUB)         15560000
151600        MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER                  15570000
151700        MOVE -1              TO MR-STRT-MM-L(PV-WORK-SUB)         15580000
151800     ELSE                                                         15590000
151900        IF (ASC-START-DATE-N(ASC-INDEX) > 0) AND                  15600000
152000           (ASC-START-MM-N(ASC-INDEX) IS NUMERIC) AND             15610000
152100           (ASC-START-DD-N(ASC-INDEX) IS NUMERIC) AND             15620000
152200           (ASC-START-YY-N(ASC-INDEX) IS NUMERIC)                 15630000
152300           PERFORM 4023-VALIDATE-START-DATE                       15640000
152400        ELSE                                                      15650000
152500           IF ASC-START-DATE(ASC-INDEX) = SPACES                  15660000
152600              MOVE ASC-LEVEL-START-DATE-CYMD TO                   15670000
152700                     ASC-START-DATE-CYMD-N(ASC-INDEX)             15680000
152800              MOVE ASC-START-MM(ASC-INDEX) TO                     15690000
152900                     MR-STRT-MM(PV-WORK-SUB)                      15700000
153000              MOVE ASC-START-DD(ASC-INDEX) TO                     15710000
153100                     MR-STRT-DD(PV-WORK-SUB)                      15720000
153200              MOVE ASC-START-YY(ASC-INDEX) TO                     15730000
153300                     MR-STRT-YY(PV-WORK-SUB)                      15740000
153400           ELSE                                                   15750000
153500             IF ASC-START-DATE-N(ASC-INDEX) = ZERO                15760000
153600               SET PS-ERROR,                                      15770000
153700                   DP020-MSG-FATAL,                               15780000
153800                   PS-START-DATE-ERROR TO TRUE                    15790000
153900               MOVE DP015-RED       TO MR-STRT-MM-C(PV-WORK-SUB)  15800000
154000                                       MR-STRT-DD-C(PV-WORK-SUB)  15810000
154100                                       MR-STRT-YY-C(PV-WORK-SUB)  15820000
154200               MOVE DP015-REVERSE   TO MR-STRT-MM-H(PV-WORK-SUB)  15830000
154300                                       MR-STRT-DD-H(PV-WORK-SUB)  15840000
154400                                       MR-STRT-YY-H(PV-WORK-SUB)  15850000
154500               MOVE PC-TSYMSG-00010 TO DP020-MSG-NUMBER           15860000
154600               MOVE -1              TO MR-STRT-MM-L(PV-WORK-SUB)  15870000
154700             ELSE                                                 15880000
154800               SET PS-ERROR,                                      15890000
154900                   DP020-MSG-FATAL,                               15900000
155000                   PS-START-DATE-ERROR TO TRUE                    15910000
155100               MOVE DP015-RED       TO MR-STRT-MM-C(PV-WORK-SUB)  15920000
155200                                       MR-STRT-DD-C(PV-WORK-SUB)  15930000
155300                                       MR-STRT-YY-C(PV-WORK-SUB)  15940000
155400               MOVE DP015-REVERSE   TO MR-STRT-MM-H(PV-WORK-SUB)  15950000
155500                                       MR-STRT-DD-H(PV-WORK-SUB)  15960000
155600                                       MR-STRT-YY-H(PV-WORK-SUB)  15970000
155700               MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER           15980000
155800               MOVE -1              TO MR-STRT-MM-L(PV-WORK-SUB)  15990000
155900             END-IF                                               16000000
156000           END-IF                                                 16010000
156100        END-IF                                                    16020000
156200     END-IF.                                                      16030000
156300                                                                  16040000
156400 4022-EDIT-END-DATE.                                              16050000
156500******************************************************************16060000
156600*                                                                 16070000
156700******************************************************************16080000
156800                                                                  16090000
156900     IF (ASC-END-MM(ASC-INDEX) = SPACES OR '00')                  16100000
157000         CONTINUE                                                 16110000
157100     ELSE                                                         16120000
157200         MOVE ASC-END-MM(ASC-INDEX) TO    DP010I-UNEDITED-FIELD   16130000
157300         MOVE +2                 TO  DP010I-MAXIMUM-DIGITS        16140000
157400         SET DP010I-NEGATIVE-ALLOWED TO TRUE                      16150000
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16161003
262978              USING DP010I-NUMERIC-EDIT-AREA                      16162003
157600         IF DP010I-ERROR-DETECTED                                 16170000
157700            SET PS-END-DATE-ERROR TO TRUE                         16180000
157800         ELSE                                                     16190000
157900            MOVE DP010I-NUMERIC-FIELD  TO                         16200000
158000                                    ASC-END-MM-N(ASC-INDEX)       16210000
158100            MOVE ASC-END-MM(ASC-INDEX) TO                         16220000
158200                                    MR-END-MM(PV-WORK-SUB)        16230000
158300         END-IF                                                   16240000
158400     END-IF.                                                      16250000
158500                                                                  16260000
158600                                                                  16270000
158700     IF (ASC-END-DD(ASC-INDEX) = SPACES OR '00')                  16280000
158800        CONTINUE                                                  16290000
158900     ELSE                                                         16300000
159000         MOVE ASC-END-DD(ASC-INDEX) TO    DP010I-UNEDITED-FIELD   16310000
159100         MOVE +2                 TO  DP010I-MAXIMUM-DIGITS        16320000
159200         SET DP010I-NEGATIVE-ALLOWED TO TRUE                      16330000
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16341003
262978              USING DP010I-NUMERIC-EDIT-AREA                      16342003
159400         IF DP010I-ERROR-DETECTED                                 16350000
159500            SET PS-END-DATE-ERROR TO TRUE                         16360000
159600         ELSE                                                     16370000
159700            MOVE DP010I-NUMERIC-FIELD  TO                         16380000
159800                                    ASC-END-DD-N(ASC-INDEX)       16390000
159900            MOVE ASC-END-DD(ASC-INDEX) TO                         16400000
160000                                    MR-END-DD(PV-WORK-SUB)        16410000
160100         END-IF                                                   16420000
160200     END-IF.                                                      16430000
160300                                                                  16440000
160400                                                                  16450000
160500     IF (ASC-END-YY(ASC-INDEX) = SPACES OR '00')                  16460000
160600        CONTINUE                                                  16470000
160700     ELSE                                                         16480000
160800         MOVE ASC-END-YY(ASC-INDEX) TO    DP010I-UNEDITED-FIELD   16490000
160900         MOVE +2                 TO  DP010I-MAXIMUM-DIGITS        16500000
161000         SET DP010I-NEGATIVE-ALLOWED TO TRUE                      16510000
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16521003
262978              USING DP010I-NUMERIC-EDIT-AREA                      16522003
161200         IF DP010I-ERROR-DETECTED                                 16530000
161300            SET PS-END-DATE-ERROR TO TRUE                         16540000
161400         ELSE                                                     16550000
161500            MOVE DP010I-NUMERIC-FIELD  TO                         16560000
161600                                    ASC-END-YY-N(ASC-INDEX)       16570000
161700            MOVE ASC-END-YY(ASC-INDEX) TO                         16580000
161800                                    MR-END-YY(PV-WORK-SUB)        16590000
161900         END-IF                                                   16600000
162000     END-IF.                                                      16610000
162100                                                                  16620000
162200     IF PS-END-DATE-ERROR                                         16630000
162300        SET PS-ERROR         TO TRUE                              16640000
162400        SET DP020-MSG-FATAL  TO TRUE                              16650000
162500        MOVE DP015-RED       TO MR-END-MM-C(PV-WORK-SUB)          16660000
162600                                MR-END-DD-C(PV-WORK-SUB)          16670000
162700                                MR-END-YY-C(PV-WORK-SUB)          16680000
162800        MOVE DP015-REVERSE   TO MR-END-MM-H(PV-WORK-SUB)          16690000
162900                                MR-END-DD-H(PV-WORK-SUB)          16700000
163000                                MR-END-YY-H(PV-WORK-SUB)          16710000
163100        MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER                  16720000
163200        MOVE -1              TO MR-END-MM-L(PV-WORK-SUB)          16730000
163300     ELSE                                                         16740000
163400        IF (ASC-END-DATE-N(ASC-INDEX) > 0) AND                    16750000
163500           (ASC-END-MM-N(ASC-INDEX) IS NUMERIC) AND               16760000
163600           (ASC-END-DD-N(ASC-INDEX) IS NUMERIC) AND               16770000
163700           (ASC-END-YY-N(ASC-INDEX) IS NUMERIC)                   16780000
163800           PERFORM 4024-VALIDATE-END-DATE                         16790000
163900        ELSE                                                      16800000
164000           IF ASC-END-DATE(ASC-INDEX) = SPACES                    16810000
164100              MOVE ASC-LEVEL-END-DATE-CYMD TO                     16820000
164200                   ASC-END-DATE-CYMD-N(ASC-INDEX)                 16830000
164300              MOVE ASC-END-MM(ASC-INDEX) TO                       16840000
164400                   MR-END-MM(PV-WORK-SUB)                         16850000
164500              MOVE ASC-END-DD(ASC-INDEX) TO                       16860000
164600                   MR-END-DD(PV-WORK-SUB)                         16870000
164700              MOVE ASC-END-YY(ASC-INDEX) TO                       16880000
164800                   MR-END-YY(PV-WORK-SUB)                         16890000
164900           ELSE                                                   16900000
165000              IF ASC-END-DATE-N(ASC-INDEX) = ZEROES               16910000
165100                 SET PS-ERROR                                     16920000
165200                     DP020-MSG-FATAL                              16930000
165300                     PS-END-DATE-ERROR TO TRUE                    16940000
165400                 MOVE DP015-RED       TO MR-END-MM-C(PV-WORK-SUB) 16950000
165500                                         MR-END-DD-C(PV-WORK-SUB) 16960000
165600                                         MR-END-YY-C(PV-WORK-SUB) 16970000
165700                 MOVE DP015-REVERSE   TO MR-END-MM-H(PV-WORK-SUB) 16980000
165800                                         MR-END-DD-H(PV-WORK-SUB) 16990000
165900                                         MR-END-YY-H(PV-WORK-SUB) 17000000
166000                 MOVE PC-TSYMSG-00010 TO DP020-MSG-NUMBER         17010000
166100                 MOVE -1              TO MR-END-MM-L(PV-WORK-SUB) 17020000
166200              ELSE                                                17030000
166300                 SET PS-ERROR,                                    17040000
166400                     DP020-MSG-FATAL,                             17050000
166500                     PS-END-DATE-ERROR TO TRUE                    17060000
166600                 MOVE DP015-RED       TO MR-END-MM-C(PV-WORK-SUB) 17070000
166700                                         MR-END-DD-C(PV-WORK-SUB) 17080000
166800                                         MR-END-YY-C(PV-WORK-SUB) 17090000
166900                 MOVE DP015-REVERSE   TO MR-END-MM-H(PV-WORK-SUB) 17100000
167000                                         MR-END-DD-H(PV-WORK-SUB) 17110000
167100                                         MR-END-YY-H(PV-WORK-SUB) 17120000
167200                 MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         17130000
167300                 MOVE -1              TO MR-END-MM-L(PV-WORK-SUB) 17140000
167400              END-IF                                              17150000
167500           END-IF                                                 17160000
167600        END-IF                                                    17170000
167700     END-IF.                                                      17180000
167800                                                                  17190000
167900 4023-VALIDATE-START-DATE.                                        17200000
168000******************************************************************17210000
168100*                                                                 17220000
168200******************************************************************17230000
168210     INITIALIZE DPG51                                             17240000
168220                DPG52                                             17250000
168230                DPG53                                             17260000
168240                DPG54                                             17270000
168250                DPG55                                             17280000
168260                DPG56.                                            17290000
168270     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      17300000
168280     SET DPG52-LK-DTE-GREG TO TRUE.                               17310000
168500     MOVE ASC-START-MM(ASC-INDEX) TO DPG52-GREG-DATE-MO-X.        17320000
168600     MOVE ASC-START-DD(ASC-INDEX) TO DPG52-GREG-DATE-DY-X.        17330000
168700     MOVE ASC-START-YY(ASC-INDEX) TO DPG52-GREG-DATE-YR-X.        17340000
168800     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                17350000
168810                                             DPG52                17360000
168820                                             DPG53                17370000
168830                                             DPG54                17380000
168840                                             DPG55                17390000
168850                                             DPG56.               17400000
168900     IF DPG54-NO-ERROR                                            17410000
169000         MOVE DPG55-DB2-ISO-DATE                                  17420000
169100                               TO ASC-START-DATE-CYMD(ASC-INDEX)  17430000
169200     ELSE                                                         17440000
169300*        --  DATE NOT VALID --                                    17450000
169400         SET PS-ERROR TO TRUE                                     17460000
169500         SET PS-START-DATE-ERROR TO TRUE                          17470000
169600         MOVE DP015-RED        TO MR-STRT-MM-C(PV-WORK-SUB)       17480000
169700                                  MR-STRT-DD-C(PV-WORK-SUB)       17490000
169800                                  MR-STRT-YY-C(PV-WORK-SUB)       17500000
169900         MOVE DP015-REVERSE    TO MR-STRT-MM-H(PV-WORK-SUB)       17510000
170000                                  MR-STRT-DD-H(PV-WORK-SUB)       17520000
170100                                  MR-STRT-YY-H(PV-WORK-SUB)       17530000
170200         MOVE DP015-UNP-ALP-BRT-OFF TO                            17540000
170300                                  MR-STRT-MM-A(PV-WORK-SUB)       17550000
170400                                  MR-STRT-DD-A(PV-WORK-SUB)       17560000
170500                                  MR-STRT-YY-A(PV-WORK-SUB)       17570000
170600         MOVE PC-TSYMSG-00009           TO DP020-MSG-NUMBER       17580000
170700         SET DP020-MSG-FATAL TO TRUE                              17590000
170800         MOVE -1               TO MR-STRT-MM-L(PV-WORK-SUB)       17600000
170900     END-IF.                                                      17610000
171000                                                                  17620000
171100 4024-VALIDATE-END-DATE.                                          17630000
171200******************************************************************17640000
171300*                                                                 17650000
171400******************************************************************17660000
171410     INITIALIZE DPG51                                             17670000
171420                DPG52                                             17680000
171430                DPG53                                             17690000
171440                DPG54                                             17700000
171450                DPG55                                             17710000
171460                DPG56.                                            17720000
171470     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      17730000
171480     SET DPG52-LK-DTE-GREG TO TRUE.                               17740000
171490     MOVE ASC-END-MM(ASC-INDEX) TO DPG52-GREG-DATE-MO-X.          17750000
171491     MOVE ASC-END-DD(ASC-INDEX) TO DPG52-GREG-DATE-DY-X.          17760000
171492     MOVE ASC-END-YY(ASC-INDEX) TO DPG52-GREG-DATE-YR-X.          17770000
171493     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                17780000
171494                                             DPG52                17790000
171495                                             DPG53                17800000
171496                                             DPG54                17810000
171497                                             DPG55                17820000
171498                                             DPG56.               17830000
171499     IF DPG54-NO-ERROR                                            17840000
171500         MOVE DPG55-DB2-ISO-DATE TO ASC-END-DATE-CYMD(ASC-INDEX)  17850000
172400     ELSE                                                         17860000
172500*        --  DATE NOT VALID --                                    17870000
172600         SET PS-ERROR TO TRUE                                     17880000
172700         SET PS-END-DATE-ERROR TO TRUE                            17890000
172800         MOVE DP015-RED        TO MR-END-MM-C(PV-WORK-SUB)        17900000
172900                                  MR-END-DD-C(PV-WORK-SUB)        17910000
173000                                  MR-END-YY-C(PV-WORK-SUB)        17920000
173100         MOVE DP015-REVERSE    TO MR-END-MM-H(PV-WORK-SUB)        17930000
173200                                  MR-END-DD-H(PV-WORK-SUB)        17940000
173300                                  MR-END-YY-H(PV-WORK-SUB)        17950000
173400         MOVE DP015-UNP-ALP-BRT-OFF TO                            17960000
173500                                  MR-END-MM-A(PV-WORK-SUB)        17970000
173600                                  MR-END-DD-A(PV-WORK-SUB)        17980000
173700                                  MR-END-YY-A(PV-WORK-SUB)        17990000
173800         MOVE PC-TSYMSG-00009           TO DP020-MSG-NUMBER       18000000
173900         SET DP020-MSG-FATAL TO TRUE                              18010000
174000         MOVE -1               TO MR-END-MM-L(PV-WORK-SUB)        18020000
174100     END-IF.                                                      18030000
174200 4025-COMPARE-DATES.                                              18040000
174300******************************************************************18050000
174400* 1. CALCULATE NEW DATE = TODAY - 30 DAYS                         18060000
174500* 2. CALCULATE NEW DATE = TODAY + 365 DAYS                        18070000
174600* 3. IF END DATE NOT = 99990909, END DATE MUST BE LESS THAN       18080000
174700*    CURRENT DATE + 365 DAYS.                                     18090000
174800* 4. END DATE MUST BE LESS THAN MERCHANDISE AREA START DATE       18100000
174900* 5. START-DATE MUST BE < TODAY'S DATE + 365                      18110000
175000* 6. IF RESPONSIBILITY IS NOT NEW FOR MERCH. AREA, USER CANNOT    18120000
175100*    CHANGE THE START DATE, SO DONT CHECK IT.                     18130000
175200* 7. IF RESPONSIBILITY IS NEW FOR THIS MERCHANDISE AREA,          18140000
175300*     A) START DATE MUST BE GREATER THAN TODAY - 30 DAYS          18150000
175400*     B) START DATE MUST BE GREATER THAN MERCHANDISE AREA START   18160000
175500*     C) START DATE MUST BE LESS THAN TODAY + 365 DAYS            18170000
175600* 8. END DATE MUST BE GREATER THAN START DATE                     18180000
175700******************************************************************18190000
175710     INITIALIZE DPG51                                             18200000
175720                DPG52                                             18210000
175730                DPG53                                             18220000
175740                DPG54                                             18230000
175750                DPG55                                             18240000
175760                DPG56.                                            18250000
175770     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      18260000
175771     SET DPG51-INCREMENT-DATE TO TRUE.                            18270000
175772     MOVE PC-YEAR-DAYS TO DPG51-INCR-DECR-DAYS-9.                 18280000
175780     SET DPG52-LK-DTE-ISO TO TRUE.                                18290000
175790     MOVE DP017-CURRENT-DATE-YYYYMMDD TO DPG52-DB2-ISO-DATE-N.    18300000
175793     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                18310000
175794                                             DPG52                18320000
175795                                             DPG53                18330000
175796                                             DPG54                18340000
175797                                             DPG55                18350000
175798                                             DPG56.               18360000
175799     IF DPG54-NO-ERROR                                            18370000
176400        MOVE DPG55-DB2-ISO-DATE TO PV-TEMP-YEAR-DATE              18380000
176800     ELSE                                                         18390000
176900        SET DP013-LOGIC-ABEND TO TRUE                             18400000
177000        SET DP013-ROLLBACK TO TRUE                                18410000
177100        MOVE '4025-COMPARE-DATES' TO DP013-PARAGRAPH              18420000
177200        MOVE 'INVALID CURRENT DATE' TO DP013-MESSAGE-TEXT(1)      18430000
177300        MOVE 'TRIED TO ADD 365 DAYS' TO DP013-MESSAGE-TEXT(2)     18440000
177400        PERFORM DP013-0000-PROCESS-ABEND                          18450000
177500     END-IF.                                                      18460000
177600                                                                  18470000
177700     IF (ASC-END-DATE-CYMD-N(ASC-INDEX) > PV-TEMP-YEAR-DATE) AND  18480000
177800        (ASC-END-DATE-CYMD-N(ASC-INDEX) NOT = PC-INFINITY-DATE)   18490000
177900         SET PS-ERROR         TO TRUE                             18500000
178000         SET DP020-MSG-FATAL  TO TRUE                             18510000
178100         MOVE DP015-RED       TO MR-END-MM-C(PV-WORK-SUB)         18520000
178200                                 MR-END-DD-C(PV-WORK-SUB)         18530000
178300                                 MR-END-YY-C(PV-WORK-SUB)         18540000
178400         MOVE DP015-REVERSE   TO MR-END-MM-H(PV-WORK-SUB)         18550000
178500                                 MR-END-DD-H(PV-WORK-SUB)         18560000
178600                                 MR-END-YY-H(PV-WORK-SUB)         18570000
178700         MOVE PC-TSYMSG-00025 TO DP020-MSG-NUMBER                 18580000
178800         MOVE -1              TO MR-END-MM-L(PV-WORK-SUB)         18590000
178900     END-IF.                                                      18600000
179000                                                                  18610000
179100     IF ASC-END-DATE-CYMD-N(ASC-INDEX) >                          18620000
179200                ASC-LEVEL-END-DATE-CYMD                           18630000
179300         SET PS-ERROR         TO TRUE                             18640000
179400         SET DP020-MSG-FATAL  TO TRUE                             18650000
179500         MOVE DP015-RED       TO MR-END-MM-C(PV-WORK-SUB)         18660000
179600                                 MR-END-DD-C(PV-WORK-SUB)         18670000
179700                                 MR-END-YY-C(PV-WORK-SUB)         18680000
179800         MOVE DP015-REVERSE   TO MR-END-MM-H(PV-WORK-SUB)         18690000
179900                                 MR-END-DD-H(PV-WORK-SUB)         18700000
180000                                 MR-END-YY-H(PV-WORK-SUB)         18710000
180100         MOVE PC-TSYMSG-00145 TO DP020-MSG-NUMBER                 18720000
180200         MOVE -1              TO MR-END-MM-L(PV-WORK-SUB)         18730000
180300     END-IF.                                                      18740000
180400                                                                  18750000
180500     IF ASC-START-DATE-CYMD-N(ASC-INDEX) >                        18760000
180600                PV-TEMP-YEAR-DATE                                 18770000
180700         SET PS-ERROR         TO TRUE                             18780000
180800         SET DP020-MSG-FATAL  TO TRUE                             18790000
180900         MOVE DP015-RED    TO                                     18800000
181000                            MR-STRT-MM-C(PV-WORK-SUB)             18810000
181100                            MR-STRT-DD-C(PV-WORK-SUB)             18820000
181200                            MR-STRT-YY-C(PV-WORK-SUB)             18830000
181300         MOVE DP015-REVERSE TO                                    18840000
181400                            MR-STRT-MM-H(PV-WORK-SUB)             18850000
181500                            MR-STRT-DD-H(PV-WORK-SUB)             18860000
181600                            MR-STRT-YY-H(PV-WORK-SUB)             18870000
181700         MOVE PC-TSYMSG-00025 TO DP020-MSG-NUMBER                 18880000
181800         MOVE -1          TO MR-STRT-MM-L(PV-WORK-SUB)            18890000
181900     END-IF.                                                      18900000
182000                                                                  18910000
182100     IF ASC-START-DATE-CYMD-N(ASC-INDEX) <                        18920000
182200                ASC-LEVEL-START-DATE-CYMD                         18930000
182300         SET PS-ERROR         TO TRUE                             18940000
182400         SET DP020-MSG-FATAL  TO TRUE                             18950000
182500         MOVE DP015-RED    TO                                     18960000
182600                            MR-STRT-MM-C(PV-WORK-SUB)             18970000
182700                            MR-STRT-DD-C(PV-WORK-SUB)             18980000
182800                            MR-STRT-YY-C(PV-WORK-SUB)             18990000
182900         MOVE DP015-REVERSE TO                                    19000000
183000                            MR-STRT-MM-H(PV-WORK-SUB)             19010000
183100                            MR-STRT-DD-H(PV-WORK-SUB)             19020000
183200                            MR-STRT-YY-H(PV-WORK-SUB)             19030000
183300         MOVE PC-TSYMSG-00144 TO DP020-MSG-NUMBER                 19040000
183400         MOVE -1          TO MR-STRT-MM-L(PV-WORK-SUB)            19050000
183500     END-IF.                                                      19060000
183600                                                                  19070000
183700     IF (PS-NO-ERROR) AND                                         19080000
183800        (ASC-END-DATE-CYMD-N(ASC-INDEX) <                         19090000
183900                   ASC-START-DATE-CYMD-N(ASC-INDEX))              19100000
184000        SET PS-ERROR         TO TRUE                              19110000
184100        SET DP020-MSG-FATAL  TO TRUE                              19120000
184200        MOVE DP015-RED       TO MR-END-MM-C(PV-WORK-SUB)          19130000
184300                                MR-END-DD-C(PV-WORK-SUB)          19140000
184400                                MR-END-YY-C(PV-WORK-SUB)          19150000
184500        MOVE DP015-REVERSE   TO MR-END-MM-H(PV-WORK-SUB)          19160000
184600                                MR-END-DD-H(PV-WORK-SUB)          19170000
184700                                MR-END-YY-H(PV-WORK-SUB)          19180000
184800        MOVE PC-TSYMSG-00143 TO DP020-MSG-NUMBER                  19190000
184900        MOVE -1              TO MR-END-MM-L(PV-WORK-SUB)          19200000
185000     END-IF.                                                      19210000
185100                                                                  19220000
185200*    IF PS-NO-ERROR                                               19230000
185300*       SET ASC-START-NOT-CHANGED(ASC-INDEX)                      19240000
185400*           ASC-END-NOT-CHANGED(ASC-INDEX) TO TRUE                19250000
185500*    END-IF.                                                      19260000
185600     EJECT                                                        19270000
185700 4030-VALIDATE-WORKER-ID.                                         19280000
185800******************************************************************19290000
185900*                                                                 19300000
186000*                                                                 19310000
186100******************************************************************19320000
186200     IF ASC-WORKER-ID(ASC-INDEX) = SPACES                         19330000
186300        SET PS-ERROR         TO TRUE                              19340000
186400        SET DP020-MSG-FATAL  TO TRUE                              19350000
186500        INITIALIZE  MR-WORKER(PV-WORK-SUB)                        19360000
186600                    MR-FNAME(PV-WORK-SUB)                         19370000
186700                    MR-LNAME(PV-WORK-SUB)                         19380000
186800                    ASC-WORKER-ID(ASC-INDEX)                      19390000
186900                    ASC-FIRST-NAME(ASC-INDEX)                     19400000
187000                    ASC-LAST-NAME(ASC-INDEX)                      19410000
187100        MOVE DP015-RED       TO MR-WORKER-C(PV-WORK-SUB)          19420000
187200        MOVE DP015-REVERSE   TO MR-WORKER-H(PV-WORK-SUB)          19430000
187300        MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER                  19440000
187400        MOVE -1              TO MR-WORKER-L(PV-WORK-SUB)          19450000
187500     ELSE                                                         19460000
187600        MOVE ASC-WORKER-ID(ASC-INDEX) TO DK-UID-NBR               19470000
187700        MOVE ASC-COMPANY-NO           TO DK-OPERCO-NBR            19480000
187800        PERFORM 9010-GET-WORKER-INFO                              19490000
187900        IF SQLCODE = +0                                           19500000
188000            SET ASC-WORKER-NOT-CHANGED(ASC-INDEX) TO TRUE         19510000
188100            MOVE WORKER-FIR-NAME TO MR-FNAME (PV-WORK-SUB)        19520000
188200                                    ASC-FIRST-NAME(ASC-INDEX)     19530000
188300            MOVE WORKER-LAST-NAME TO MR-LNAME(PV-WORK-SUB)        19540000
188400                                    ASC-LAST-NAME(ASC-INDEX)      19550000
188500            MOVE WORKER-NBR      TO ASC-WORKER-NBR(ASC-INDEX)     19560000
188600        ELSE                                                      19570000
188700            INITIALIZE  MR-FNAME(PV-WORK-SUB)                     19580000
188800                        MR-LNAME(PV-WORK-SUB)                     19590000
188900                        ASC-FIRST-NAME(ASC-INDEX)                 19600000
189000                        ASC-LAST-NAME(ASC-INDEX)                  19610000
189100            SET PS-ERROR         TO TRUE                          19620000
189200            SET DP020-MSG-FATAL  TO TRUE                          19630000
189300            MOVE DP015-RED       TO MR-WORKER-C(PV-WORK-SUB)      19640000
189400            MOVE DP015-REVERSE   TO MR-WORKER-H(PV-WORK-SUB)      19650000
189500            MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER              19660000
189600            MOVE -1              TO MR-WORKER-L(PV-WORK-SUB)      19670000
189700        END-IF                                                    19680000
189800     END-IF.                                                      19690000
189900                                                                  19700000
190000 4040-EDIT-RESPON-ASSIGNMENTS.                                    19710000
190100******************************************************************19720000
190200*    COUNT THE NUMBER OF GMM'S, DMM'S AND BYR'S SPECIFIED.        19730000
190300*    IF DUPLICATES ARE FOUND SEND MESSAGE.                        19740000
190400*    IF HAVEN'T ADDED REQUIRED ASSIGNMENT FOR THE LEVEL BEING     19750000
190500*    ADDED, SEND ERROR MESSAGE.                                   19760000
190600*                                                                 19770000
190700*    PERFORMED BY : 3300-EDIT-DATA-IN-COMMAREA                    19780000
190800******************************************************************19790000
190900     PERFORM                                                      19800000
191000        VARYING ASC-INDEX                                         19810000
191100        FROM 1 BY 1                                               19820000
191200        UNTIL ASC-INDEX > ASC-LINES-ENTERED                       19830000
191300                                                                  19840000
191400        IF ASC-LEVEL(ASC-INDEX) = PC-GMM-LEVEL                    19850000
191500           SET PS-GMM-LEVEL-SPECIFIED                             19860000
191600               ASC-LEVEL-NOT-CHANGED(ASC-INDEX) TO TRUE           19870000
191700           ADD 1 TO PV-GMMS-SPECIFIED                             19880000
191800        ELSE                                                      19890000
191900           IF ASC-LEVEL(ASC-INDEX) = PC-DMM-LEVEL                 19900000
192000              SET PS-DMM-LEVEL-SPECIFIED                          19910000
192100                  ASC-LEVEL-NOT-CHANGED(ASC-INDEX) TO TRUE        19920000
192200              ADD 1 TO PV-DMMS-SPECIFIED                          19930000
192300           ELSE                                                   19940000
192400              IF ASC-LEVEL(ASC-INDEX) = PC-BUYER-LEVEL            19950000
192500                 SET PS-BYR-LEVEL-SPECIFIED                       19960000
192600                     ASC-LEVEL-NOT-CHANGED(ASC-INDEX) TO TRUE     19970000
192700                 ADD 1 TO PV-BUYERS-SPECIFIED                     19980000
192800              END-IF                                              19990000
192900           END-IF                                                 20000000
193000        END-IF                                                    20010000
193100     END-PERFORM.                                                 20020000
193200                                                                  20030000
193300                                                                  20040000
193400     IF (ASC-ADD-GMA) AND                                         20050000
193500        (PV-GMMS-SPECIFIED = 0)                                   20060000
193600        SET PS-ERROR         TO TRUE                              20070000
193700        SET DP020-MSG-FATAL  TO TRUE                              20080000
193800        MOVE PC-TSYMSG-00181 TO DP020-MSG-NUMBER                  20090000
193900        MOVE -1              TO MR-LEVEL-L(1)                     20100000
194000     ELSE                                                         20110000
194100        IF (ASC-ADD-DMA) AND                                      20120000
194200           (PV-DMMS-SPECIFIED = 0)                                20130000
194300           SET PS-ERROR         TO TRUE                           20140000
194400           SET DP020-MSG-FATAL  TO TRUE                           20150000
194500           MOVE PC-TSYMSG-00181 TO DP020-MSG-NUMBER               20160000
194600           MOVE -1              TO MR-LEVEL-L(1)                  20170000
194700        ELSE                                                      20180000
194800           IF (ASC-ADD-DPT) AND                                   20190000
194900              (PV-BUYERS-SPECIFIED = 0)                           20200000
195000              SET PS-ERROR         TO TRUE                        20210000
195100              SET DP020-MSG-FATAL  TO TRUE                        20220000
195200              MOVE PC-TSYMSG-00181 TO DP020-MSG-NUMBER            20230000
195300              MOVE -1              TO MR-LEVEL-L(1)               20240000
195400           END-IF                                                 20250000
195500        END-IF                                                    20260000
195600     END-IF.                                                      20270000
195700                                                                  20280000
195800                                                                  20290000
195900 EJECT                                                            20300000
196000                                                                  20310000
196100 4050-CHECK-DUPLICATE-ENTRIES.                                    20320000
196200******************************************************************20330000
196300*  CHECK TO SEE IF DUPLICATE LEVEL-USERID COMBINATION EXISTS ON   20340000
196400*  SCREEN. IF SO SEND ERROR MESSAGE. NO LEVEL-USERID COMBINATIONS 20350000
196500*  CAN BOTH BE ACTIVE AT THE SAME TIME, ALTHOUGH YOU CAN REACTIVAT20360000
196600*  A PERSON AFTER THEY HAVE BECOME INACTIVE.                      20370000
196700*    PERFORMED BY : 3300-EDIT-DATA-IN-COMMAREA                    20380000
196800******************************************************************20390000
196900                                                                  20400000
197000                                                                  20410000
197100     MOVE ASC-LEVEL(ASC-INDEX) TO PV-WORK-LEVEL.                  20420000
197200     MOVE ASC-WORKER-ID(ASC-INDEX) TO PV-WORK-ID.                 20430000
197300     MOVE ALL '-'              TO ASC-LEVEL(ASC-INDEX)            20440000
197400                                  ASC-WORKER-ID(ASC-INDEX).       20450000
197500     SET ASC-INDEX2 TO 1                                          20460000
197600     SEARCH ASC-SCREEN-LINE                                       20470000
197700        VARYING ASC-INDEX2                                        20480000
197800        AT END                                                    20490000
197900            CONTINUE                                              20500000
198000        WHEN (PV-WORK-LEVEL = ASC-LEVEL(ASC-INDEX2) AND           20510000
198100              PV-WORK-ID    = ASC-WORKER-ID(ASC-INDEX2))          20520000
198200***----- DUPLICATE LEVEL/USERID COMBINATION -----***              20530000
198300             SET PV-WORK-SUB      TO ASC-INDEX                    20540000
198400             SET PS-ERROR         TO TRUE                         20550000
198500             SET DP020-MSG-FATAL  TO TRUE                         20560000
198600             MOVE PC-TSYMSG-00190 TO DP020-MSG-NUMBER             20570000
198700             MOVE DP015-RED       TO MR-LEVEL-C(PV-WORK-SUB)      20580000
198800                                     MR-STRT-MM-C(PV-WORK-SUB)    20590000
198900                                     MR-STRT-DD-C(PV-WORK-SUB)    20600000
199000                                     MR-STRT-YY-C(PV-WORK-SUB)    20610000
199100                                     MR-END-MM-C(PV-WORK-SUB)     20620000
199200                                     MR-END-DD-C(PV-WORK-SUB)     20630000
199300                                     MR-END-YY-C(PV-WORK-SUB)     20640000
199400                                     MR-WORKER-C(PV-WORK-SUB)     20650000
199500             MOVE DP015-REVERSE   TO MR-LEVEL-H(PV-WORK-SUB)      20660000
199600                                     MR-STRT-MM-H(PV-WORK-SUB)    20670000
199700                                     MR-STRT-DD-H(PV-WORK-SUB)    20680000
199800                                     MR-STRT-YY-H(PV-WORK-SUB)    20690000
199900                                     MR-END-MM-H(PV-WORK-SUB)     20700000
200000                                     MR-END-DD-H(PV-WORK-SUB)     20710000
200100                                     MR-END-YY-H(PV-WORK-SUB)     20720000
200200                                     MR-WORKER-H(PV-WORK-SUB)     20730000
200300             MOVE -1              TO MR-LEVEL-L(PV-WORK-SUB)      20740000
200400     END-SEARCH.                                                  20750000
200500     MOVE PV-WORK-LEVEL TO ASC-LEVEL(ASC-INDEX).                  20760000
200600     MOVE PV-WORK-ID   TO ASC-WORKER-ID(ASC-INDEX).               20770000
200700     EJECT                                                        20780000
200800                                                                  20790000
200900 4060-MASK-END-DATES.                                             20800000
201000******************************************************************20810000
201100*                                                                 20820000
201200*    PERFORMED BY : 3300-EDIT-DATA-IN-COMMAREA                    20830000
201300******************************************************************20840000
201400     PERFORM VARYING                                              20850000
201500        ASC-INDEX FROM 1 BY 1                                     20860000
201600        UNTIL (ASC-INDEX > ASC-LINES-ENTERED)                     20870000
201700                                                                  20880000
201800        IF ASC-END-DATE-CYMD(ASC-INDEX) = '99990909'              20890000
201900           SET PV-WORK-SUB TO ASC-INDEX                           20900000
202000           MOVE SPACES TO MR-END-MM (PV-WORK-SUB)                 20910000
202100                          MR-END-DD (PV-WORK-SUB)                 20920000
202200                          MR-END-YY (PV-WORK-SUB)                 20930000
202300                          ASC-END-YY(ASC-INDEX)                   20940000
202400                          ASC-END-MM(ASC-INDEX)                   20950000
202500                          ASC-END-DD(ASC-INDEX)                   20960000
202600        END-IF                                                    20970000
202700                                                                  20980000
202800     END-PERFORM.                                                 20990000
202900                                                                  21000000
203000                                                                  21010000
203100 4100-SAVE-INITIAL-INTERAPPL.                                     21020000
203200******************************************************************21030000
203300*    SAVE THE INTER-APPLICATION COMMAREA ON THE FIRST CYCLE       21040000
203400*    OF THIS TRANSACTION.                                         21050000
203500******************************************************************21060000
203600                                                                  21070000
203700     IF (DP020-MB-MERCH-AREA-ADD) OR                              21080000
203800        (DP020-MB-MERCH-DEPT-MAINT) OR                            21090000
203900        (DP020-MB-SUB-CLASS-MAINT)                                21100000
204000        SET PS-INTER-APPL-VALID        TO TRUE                    21110000
204100        MOVE MB005-LIST-QUEUE-NAME     TO ASC-TEMP-QUEUE-NAME     21120000
204200        MOVE MB005-CO-NUMBER           TO ASC-COMPANY-NO          21130000
204300     ELSE                                                         21140000
204400          MOVE PC-TSYMSG-99901 TO DP020-MSG-NUMBER                21150000
204500          SET DP020-MSG-FATAL  TO TRUE                            21160000
204600          SET PS-INTER-APPL-INVALID TO TRUE                       21170000
204700          MOVE -1 TO ANAVCMDL                                     21180000
204800     END-IF.                                                      21190000
204900                                                                  21200000
205000 EJECT                                                            21210000
205100                                                                  21220000
205200 4200-UPDATE-INITIAL-INTERAPPL.                                   21230000
205300                                                                  21240000
205400******************************************************************21250000
205500******************************************************************21260000
205600 EJECT                                                            21270000
205700                                                                  21280000
205800 4300-SETUP-INTER-APPL-COMM.                                      21290000
205900                                                                  21300000
206000******************************************************************21310000
206100*                                                                 21320000
206200******************************************************************21330000
206300                                                                  21340000
206400     SET DP020-MB-RESP-LEVEL-ADD   TO TRUE                        21350000
206500     MOVE ASC-TEMP-QUEUE-NAME   TO MB005-LIST-QUEUE-NAME.         21360000
206600     MOVE ASC-TEMP-QUEUE-LENGTH TO MB005-LIST-QUEUE-LENGTH.       21370000
206700     MOVE ASC-COMPANY-NO        TO MB005-CO-NUMBER.               21380000
206800     MOVE 'DPT'                 TO MB005-MDSEAR-LEVEL.            21390000
206900     MOVE PS-UPDATE-SW          TO MB005-RECORD-UPDATED-SW.       21400000
207000                                                                  21410000
207100 EJECT                                                            21420000
207200                                                                  21430000
207300 5500-SORT-SCREEN.                                                21440000
207400******************************************************************21450000
207500*  SORT THE COMMAREA TABLE IN RESPONSIBILITY/ START DATE          21460000
207600*  ORDER.                                                         21470000
207700*                                                                 21480000
207800*  PERFORMED BY 6000-PROCESS-MAINTAINANCE.                        21490000
207900******************************************************************21500000
208000                                                                  21510000
208100     COMPUTE PV-NUMBER-COMPARISONS = ASC-LINES-ENTERED - 1        21520000
208200     PERFORM 5575-SORT-LINE-TABLE                                 21530000
208300        UNTIL PS-SORT-COMPLETE OR                                 21540000
208400              PV-NUMBER-COMPARISONS = ZERO.                       21550000
208500                                                                  21560000
208600     EJECT                                                        21570000
208700                                                                  21580000
208800 5575-SORT-LINE-TABLE.                                            21590000
208900******************************************************************21600000
209000*  SORT THE COMMAREA TABLE IN RESPONSIBILITY/ START DATE          21610000
209100*  ORDER.                                                         21620000
209200*                                                                 21630000
209300*  PERFORMED BY 5500-MANIPULATE-INPUT.                            21640000
209400******************************************************************21650000
209500     SET ASC-INDEX TO 1.                                          21660000
209600     SET PS-SORT-COMPLETE TO TRUE.                                21670000
209700     PERFORM 5580-COMPARE-KEYS                                    21680000
209800        UNTIL ASC-INDEX  > PV-NUMBER-COMPARISONS.                 21690000
209900     SUBTRACT 1 FROM PV-NUMBER-COMPARISONS.                       21700000
210000                                                                  21710000
210100 5580-COMPARE-KEYS.                                               21720000
210200******************************************************************21730000
210300*  SORT THE COMMAREA TABLE IN RESPONSIBILITY/ START DATE          21740000
210400*  ORDER.                                                         21750000
210500*                                                                 21760000
210600*  PERFORMED BY 5575-SORT-LINE-TABLE.                             21770000
210700******************************************************************21780000
210800     IF ASC-LEVEL(ASC-INDEX) > ASC-LEVEL(ASC-INDEX + 1)           21790000
210900        MOVE ASC-SCREEN-LINE(ASC-INDEX) TO PV-SAVE-SCREEN-LINE    21800000
211000        MOVE ASC-SCREEN-LINE(ASC-INDEX + 1) TO                    21810000
211100             ASC-SCREEN-LINE(ASC-INDEX)                           21820000
211200        MOVE PV-SAVE-SCREEN-LINE TO ASC-SCREEN-LINE(ASC-INDEX + 1)21830000
211300        SET PS-SORT-NOT-COMPLETE TO TRUE                          21840000
211400     ELSE                                                         21850000
211500       IF ASC-LEVEL(ASC-INDEX) = ASC-LEVEL(ASC-INDEX + 1)         21860000
211600          IF ASC-START-DATE-CYMD-N(ASC-INDEX) >                   21870000
211700             ASC-START-DATE-CYMD-N(ASC-INDEX + 1)                 21880000
211800            MOVE ASC-SCREEN-LINE(ASC-INDEX) TO PV-SAVE-SCREEN-LINE21890000
211900            MOVE ASC-SCREEN-LINE(ASC-INDEX + 1) TO                21900000
212000                 ASC-SCREEN-LINE(ASC-INDEX)                       21910000
212100            MOVE PV-SAVE-SCREEN-LINE TO                           21920000
212200                     ASC-SCREEN-LINE(ASC-INDEX + 1)               21930000
212300            SET PS-SORT-NOT-COMPLETE TO TRUE                      21940000
212400          END-IF                                                  21950000
212500       END-IF                                                     21960000
212600     END-IF.                                                      21970000
212700     SET ASC-INDEX UP BY 1.                                       21980000
212800                                                                  21990000
212900 EJECT                                                            22000000
213000                                                                  22010000
213100 6000-PROCESS-MAINTAINANCE.                                       22020000
213200                                                                  22030000
213300******************************************************************22040000
213400* 1) ADD A TMDSEAR ROW NO MATTER WHAT MERCH. AREA. BEING ADDED.   22050000
213500* 2) IF GMA, DMA OR DPT ADDED, ADD ROWS TO TRSPBAR                22060000
213600* 3) IF DPT ADDED ADD ROW TO TMDSEDP                              22070000
213700* 4) IF SCL ADDED ADD ROW TO TMDSECL                              22080000
213800* 5) REGARDLESS OF LEVEL ADDED ADD ALL TAPLAVL ROWS               22090000
213900*                                                                 22100000
214000******************************************************************22110000
214100     PERFORM DP017-0000-GET-CURR-DATE-TIME                        22120000
214200     SET DP017-EDITED-YMD-DATE-DASH-1                             22130000
214300         DP017-EDITED-YMD-DATE-DASH-2 TO TRUE                     22140000
214400     MOVE DP017-EDITED-DATE-YYYYMMDD TO  DK-END-DATE              22150000
214500                                       ASC-EDITED-DATE-YYYYMMDD   22160000
214600     MOVE DP017-CURRENT-DATE-YYYYMMDD TO ASC-CURRENT-DATE-CYMD    22170000
214700                                                                  22180000
214800     PERFORM 6100-FILL-IN-END-DATES.                              22190000
214900                                                                  22200000
215000     PERFORM 6200-EDIT-COVERAGES.                                 22210000
215100                                                                  22220000
215200     IF PS-NO-ERROR                                               22230000
215300         PERFORM 7000-ADD-MERCHANDISE-AREA                        22240000
215400                                                                  22250000
215500         IF PS-NO-ERROR                                           22260000
215600             IF (ASC-ADD-GMA) OR                                  22270000
215700                (ASC-ADD-DMA) OR                                  22280000
215800                (ASC-ADD-DPT)                                     22290000
215900                PERFORM 7010-PROCESS-RESPONSIBILITY               22300000
216000             END-IF                                               22310000
216100                                                                  22320000
216200             IF ASC-ADD-DPT                                       22330000
216300                PERFORM 7020-ADD-DEPARTMENT                       22340000
216400                PERFORM 7025-ADD-SHRINK                           22350000
216500             END-IF                                               22360000
216600                                                                  22370000
216700             IF ASC-ADD-SCL                                       22380000
216800                PERFORM 7030-ADD-CLASS                            22390000
216900             END-IF                                               22400000
217000                                                                  22410000
217100             PERFORM 7040-ADD-APPL-SYS-AVAIL                      22420000
217200         END-IF                                                   22430000
217300     END-IF.                                                      22440000
217400                                                                  22450000
217500     IF PS-NO-ERROR                                               22460000
217600        SET PS-UPDATE-OK TO TRUE                                  22470000
217700        PERFORM 9900-COMMIT                                       22480000
217800     ELSE                                                         22490000
217900        SET PS-NO-UPDATE-OK TO TRUE                               22500000
218000     END-IF.                                                      22510000
218100                                                                  22520000
218200 EJECT                                                            22530000
218300 6100-FILL-IN-END-DATES.                                          22540000
218400******************************************************************22550000
218500*  INSURE THAT ALL END DATES THAT ARE BLANK ARE FILLED IN WITH    22560000
218600*  99990909.                                                      22570000
218700******************************************************************22580000
218800*                                                                 22590000
218900     PERFORM                                                      22600000
219000        VARYING ASC-INDEX                                         22610000
219100        FROM 1 BY 1                                               22620000
219200        UNTIL (ASC-INDEX > ASC-LINES-ENTERED)                     22630000
219300                                                                  22640000
219400           IF ASC-END-DATE(ASC-INDEX) = SPACES                    22650000
219500              MOVE PC-INFINITY-DATE TO                            22660000
219600                    ASC-END-DATE-CYMD-N(ASC-INDEX)                22670000
219700           END-IF                                                 22680000
219800                                                                  22690000
219900     END-PERFORM.                                                 22700000
220000                                                                  22710000
220100                                                                  22720000
220200 6200-EDIT-COVERAGES.                                             22730000
220300******************************************************************22740000
220400*  INSURE THAT ALL GMMS DMMS AND BUYERS START AND END DATES       22750000
220500*  COVER THE ENTIRE MERCHANDISE AREA START THRU END DATES.        22760000
220600******************************************************************22770000
220700                                                                  22780000
220800     IF ASC-ADD-GMA                                               22790000
220900        MOVE PC-GMM-LEVEL TO PV-RSPLVL-TO-FIND                    22800000
221000     ELSE                                                         22810000
221100        IF ASC-ADD-DMA                                            22820000
221200           MOVE PC-DMM-LEVEL TO PV-RSPLVL-TO-FIND                 22830000
221300        ELSE                                                      22840000
221400           MOVE PC-BUYER-LEVEL TO PV-RSPLVL-TO-FIND               22850000
221500        END-IF                                                    22860000
221600     END-IF.                                                      22870000
221700                                                                  22880000
221800     SET PS-NEED-NO-MATCH TO TRUE                                 22890000
221900     INITIALIZE PV-PREV-LEVEL.                                    22900000
222000     PERFORM 6201-PROCESS-COVERAGE                                22910000
222100        VARYING ASC-INDEX FROM 1                                  22920000
222200        BY 1                                                      22930000
222300        UNTIL (PS-RSPLVL-FOUND) OR                                22940000
222400              (ASC-INDEX > ASC-LINES-ENTERED).                    22950000
222500                                                                  22960000
222600 6201-PROCESS-COVERAGE.                                           22970000
222700******************************************************************22980000
222800*  THIS PARAGRAPH FINDS THE FIRST OCCURRENCE OF THE ASSIGNMENT    22990000
222900*  AND STARTS THE PROCESS TO DETERMINE IF THERE IS FULL COVERAGE  23000000
223000*  FOR THE ASSIGNMENT LEVEL.                                      23010000
223100******************************************************************23020000
223200     SET PS-NEED-NO-MATCH TO TRUE                                 23030000
223300     IF ASC-LEVEL(ASC-INDEX) = PV-RSPLVL-TO-FIND                  23040000
223400                                                                  23050000
223500        SET PS-RSPLVL-FOUND TO TRUE                               23060000
223600        PERFORM 6202-CHECK-START-DATE                             23070000
223700                                                                  23080000
223800        IF PS-NO-ERROR                                            23090000
223900           PERFORM 6203-CHECK-END-DATE                            23100000
224000        END-IF                                                    23110000
224100                                                                  23120000
224200     END-IF.                                                      23130000
224300     EJECT                                                        23140000
224400                                                                  23150000
224500                                                                  23160000
224600 6202-CHECK-START-DATE.                                           23170000
224700******************************************************************23180000
224800*  CHECK THE START DATE OF THIS FIRST RECORD. IT SHOULD ALWAYS    23190000
224900*  MATCH THE START DATE OF THE MERCHANDISE AREA.                  23200000
225000******************************************************************23210000
225100     IF ASC-START-DATE-CYMD-N(ASC-INDEX) NOT =                    23220000
225200           ASC-LEVEL-START-DATE-CYMD                              23230000
225300           SET PS-ERROR,                                          23240000
225400               DP020-MSG-FATAL TO TRUE                            23250000
225500           SET PV-WORK-SUB TO ASC-INDEX                           23260000
225600           MOVE DP015-RED      TO MR-STRT-MM-C(PV-WORK-SUB)       23270000
225700                                  MR-STRT-DD-C(PV-WORK-SUB)       23280000
225800                                  MR-STRT-YY-C(PV-WORK-SUB)       23290000
225900           MOVE DP015-REVERSE  TO MR-STRT-MM-H(PV-WORK-SUB)       23300000
226000                                  MR-STRT-DD-H(PV-WORK-SUB)       23310000
226100                                  MR-STRT-YY-H(PV-WORK-SUB)       23320000
226200           MOVE -1             TO MR-STRT-MM-L(PV-WORK-SUB)       23330000
226300           MOVE PC-TSYMSG-00188 TO DP020-MSG-NUMBER               23340000
226400           MOVE ASC-LEVEL(ASC-INDEX) TO PV-PREV-LEVEL             23350000
226500     END-IF.                                                      23360000
226600                                                                  23370000
226700                                                                  23380000
226800 6203-CHECK-END-DATE.                                             23390000
226900******************************************************************23400000
227000* THIS ROUTINE EDITS THE END DATE OF THE FIRST RECORD FOUND       23410000
227100* FOR THE RESPONSIBILITY LEVEL. IT THEN STARTS PROCESSING ALL     23420000
227200* OTHER ENTRIES ON THE SCREEN THAT ARE FOR THE SAME LEVEL.        23430000
227300******************************************************************23440000
227400                                                                  23450000
227500     IF ASC-END-DATE-CYMD-N(ASC-INDEX) NOT =                      23460000
227600                      ASC-LEVEL-END-DATE-CYMD                     23470000
227700        SET PS-NEED-MATCH TO TRUE                                 23480000
227800     END-IF.                                                      23490000
227900                                                                  23500000
228000     SET ASC-INDEX2 TO ASC-INDEX                                  23510000
228100     SET ASC-INDEX2 UP BY 1                                       23520000
228200                                                                  23530000
228300**************************************************************    23540000
228400*     LAST RECORD ON SCREEN HAS AN END DATE THAT DOES NOT         23550000
228500*     MATCH THE MERCHANDISE AREA LEVEL END DATE                   23560000
228600*     END DATE ON ASC-INDEX ROW IS NOT FULL COVERAGE              23570000
228700**************************************************************    23580000
228800                                                                  23590000
228900     IF (ASC-INDEX2 > ASC-LINES-ENTERED) AND                      23600000
229000        (PS-NEED-MATCH)                                           23610000
229100        SET PS-ERROR, PS-DONE,                                    23620000
229200            DP020-MSG-FATAL TO TRUE                               23630000
229300        SET PV-WORK-SUB TO ASC-INDEX                              23640000
229400        MOVE DP015-RED      TO MR-END-MM-C(PV-WORK-SUB)           23650000
229500                               MR-END-DD-C(PV-WORK-SUB)           23660000
229600                               MR-END-YY-C(PV-WORK-SUB)           23670000
229700        MOVE DP015-REVERSE  TO MR-END-MM-H(PV-WORK-SUB)           23680000
229800                               MR-END-DD-H(PV-WORK-SUB)           23690000
229900                               MR-END-YY-H(PV-WORK-SUB)           23700000
230000        MOVE -1             TO MR-END-MM-L(PV-WORK-SUB)           23710000
230100        MOVE PC-TSYMSG-00188 TO DP020-MSG-NUMBER                  23720000
230200     ELSE                                                         23730000
230300****************************************************************  23740000
230400*       PROCESS THE FOLLOWING RECORDS ON THE SCREEN THAT          23750000
230500*       MATCH THE CURRENT RESPONSIBILITY LEVEL                    23760000
230600*       IF ALREADY HAD END DATE MATCH PARENT END DATE - ERROR     23770000
230700****************************************************************  23780000
230800                                                                  23790000
230900         IF ASC-LEVEL(ASC-INDEX2) = PV-RSPLVL-TO-FIND             23800000
231000                                                                  23810000
231100            IF PS-NEED-NO-MATCH                                   23820000
231200               SET PS-ERROR,                                      23830000
231300                   DP020-MSG-FATAL TO TRUE                        23840000
231400               SET PV-WORK-SUB TO ASC-INDEX                       23850000
231500               MOVE DP015-RED      TO MR-LEVEL-C(PV-WORK-SUB)     23860000
231600               MOVE DP015-REVERSE  TO MR-LEVEL-H(PV-WORK-SUB)     23870000
231700               MOVE -1             TO MR-LEVEL-L(PV-WORK-SUB)     23880000
231800               SET PV-WORK-SUB     TO ASC-INDEX2                  23890000
231900               MOVE DP015-RED      TO MR-LEVEL-C(PV-WORK-SUB)     23900000
232000               MOVE DP015-REVERSE  TO MR-LEVEL-H(PV-WORK-SUB)     23910000
232100               MOVE PC-TSYMSG-00189 TO DP020-MSG-NUMBER           23920000
232200                                                                  23930000
232300            ELSE                                                  23940000
232400                                                                  23950000
232500**********************************************************        23960000
232600*       PROCESS ALL OTHER MATCHING RESPONSIBILITY LEVELS *        23970000
232700**********************************************************        23980000
232800                                                                  23990000
232900               SET PS-NOT-DONE TO TRUE                            24000000
233000               SET ASC-INDEX3 TO ASC-INDEX                        24010000
233100               PERFORM 6204-CHECK-MATCHES                         24020000
233200               UNTIL (ASC-INDEX2 > ASC-LINES-ENTERED) OR          24030000
233300                       (PS-DONE)                                  24040000
233400                                                                  24050000
233500**************************************************************    24060000
233600*       LAST ENTRY ON SCREEN DID NOT HAVE END DATE THAT EQUALS    24070000
233700*       MDSEAR END DATE                                           24080000
233800**************************************************************    24090000
233900                                                                  24100000
234000               IF (PS-NO-ERROR) AND (PS-NEED-MATCH)               24110000
234100                   SET PS-ERROR,                                  24120000
234200                       DP020-MSG-FATAL TO TRUE                    24130000
234300                   SET PV-WORK-SUB     TO ASC-INDEX3              24140000
234400                   MOVE DP015-RED      TO MR-END-MM-C(PV-WORK-SUB)24150000
234500                                          MR-END-DD-C(PV-WORK-SUB)24160000
234600                                          MR-END-YY-C(PV-WORK-SUB)24170000
234700                   MOVE DP015-REVERSE  TO MR-END-MM-H(PV-WORK-SUB)24180000
234800                                          MR-END-DD-H(PV-WORK-SUB)24190000
234900                                          MR-END-YY-H(PV-WORK-SUB)24200000
235000                   MOVE -1             TO MR-END-MM-L(PV-WORK-SUB)24210000
235100                   MOVE PC-TSYMSG-00188 TO DP020-MSG-NUMBER       24220000
235200               END-IF                                             24230000
235300            END-IF                                                24240000
235400         ELSE                                                     24250000
235500            IF PS-NEED-MATCH                                      24260000
235600                SET PS-ERROR,                                     24270000
235700                    DP020-MSG-FATAL TO TRUE                       24280000
235800                SET PV-WORK-SUB     TO ASC-INDEX                  24290000
235900                MOVE DP015-RED      TO MR-END-MM-C(PV-WORK-SUB)   24300000
236000                                       MR-END-DD-C(PV-WORK-SUB)   24310000
236100                                       MR-END-YY-C(PV-WORK-SUB)   24320000
236200                MOVE DP015-REVERSE  TO MR-END-MM-H(PV-WORK-SUB)   24330000
236300                                       MR-END-DD-H(PV-WORK-SUB)   24340000
236400                                       MR-END-YY-H(PV-WORK-SUB)   24350000
236500                MOVE -1             TO MR-END-MM-L(PV-WORK-SUB)   24360000
236600                MOVE PC-TSYMSG-00188 TO DP020-MSG-NUMBER          24370000
236700            END-IF                                                24380000
236800         END-IF                                                   24390000
236900     END-IF.                                                      24400000
237000                                                                  24410000
237100      EJECT                                                       24420000
237200                                                                  24430000
237300 6204-CHECK-MATCHES.                                              24440000
237400******************************************************************24450000
237500* TEST END DATE(INDEX3) AGAINST THE START DATE(INDEX2)            24460000
237600* INDEX3 = FIRST LEVEL IN TABLE                                   24470000
237700* INDEX2 = NEXT LEVEL IN TABLE                                    24480000
237800*                                                                 24490000
237900******************************************************************24500000
238000     IF ASC-LEVEL(ASC-INDEX2) = ASC-LEVEL(ASC-INDEX3)             24510000
238100        IF PS-NEED-NO-MATCH                                       24520000
238200           SET PS-ERROR,                                          24530000
238300               DP020-MSG-FATAL TO TRUE                            24540000
238400           SET PV-WORK-SUB     TO ASC-INDEX3                      24550000
238500           MOVE DP015-RED      TO MR-LEVEL-C(PV-WORK-SUB)         24560000
238600           MOVE DP015-REVERSE  TO MR-LEVEL-H(PV-WORK-SUB)         24570000
238700           MOVE -1             TO MR-END-MM-L(PV-WORK-SUB)        24580000
238800           SET PV-WORK-SUB     TO ASC-INDEX3                      24590000
238900           MOVE DP015-RED      TO MR-LEVEL-C(PV-WORK-SUB)         24600000
239000           MOVE DP015-REVERSE  TO MR-LEVEL-H(PV-WORK-SUB)         24610000
239100           MOVE PC-TSYMSG-00189 TO DP020-MSG-NUMBER               24620000
239200        ELSE                                                      24630000
239300           MOVE ASC-END-DATE-CYMD(ASC-INDEX3) TO PV-END-DATE      24640000
239400           MOVE ASC-START-DATE-CYMD(ASC-INDEX2) TO PV-START-DATE  24650000
239500           PERFORM 6205-CHECK-CONSECUTIVE-DATES                   24660000
239600           IF PS-DATES-NOT-CONSECUTIVE                            24670000
239700              SET PS-DONE,                                        24680000
239800                  PS-ERROR,                                       24690000
239900                  DP020-MSG-FATAL TO TRUE                         24700000
240000              SET PV-WORK-SUB     TO ASC-INDEX3                   24710000
240100              MOVE DP015-RED      TO MR-END-MM-C(PV-WORK-SUB)     24720000
240200                                     MR-END-DD-C(PV-WORK-SUB)     24730000
240300                                     MR-END-YY-C(PV-WORK-SUB)     24740000
240400              MOVE DP015-REVERSE  TO MR-END-MM-H(PV-WORK-SUB)     24750000
240500                                     MR-END-DD-H(PV-WORK-SUB)     24760000
240600                                     MR-END-YY-H(PV-WORK-SUB)     24770000
240700              MOVE -1             TO MR-END-MM-L(PV-WORK-SUB)     24780000
240800              SET PV-WORK-SUB     TO ASC-INDEX2                   24790000
240900                                                                  24800000
241000                 MOVE DP015-RED      TO MR-STRT-MM-C(PV-WORK-SUB) 24810000
241100                                        MR-STRT-DD-C(PV-WORK-SUB) 24820000
241200                                        MR-STRT-YY-C(PV-WORK-SUB) 24830000
241300                 MOVE DP015-REVERSE  TO MR-STRT-MM-H(PV-WORK-SUB) 24840000
241400                                        MR-STRT-DD-H(PV-WORK-SUB) 24850000
241500                                        MR-STRT-YY-H(PV-WORK-SUB) 24860000
241600              IF PS-DATES-OVERLAP                                 24870000
241700                  MOVE PC-TSYMSG-00189 TO DP020-MSG-NUMBER        24880000
241800              ELSE                                                24890000
241900                  MOVE PC-TSYMSG-00188 TO DP020-MSG-NUMBER        24900000
242000              END-IF                                              24910000
242100           ELSE                                                   24920000
242200              IF ASC-END-DATE-CYMD(ASC-INDEX2) =                  24930000
242300                 ASC-LEVEL-END-DATE-CYMD                          24940000
242400                 SET PS-NEED-NO-MATCH TO TRUE                     24950000
242500              END-IF                                              24960000
242600           END-IF                                                 24970000
242700        END-IF                                                    24980000
242800     ELSE                                                         24990000
242900                                                                  25000000
243000        SET PS-DONE TO TRUE                                       25010000
243100        SET PS-NEED-NO-MATCH TO TRUE                              25020000
243200                                                                  25030000
243300        IF ASC-END-DATE-CYMD(ASC-INDEX3) =                        25040000
243400           ASC-LEVEL-END-DATE-CYMD                                25050000
243500           SET PS-NEED-NO-MATCH TO TRUE                           25060000
243600        ELSE                                                      25070000
243700*  END DATE DOES NOT COVER MERCHANDISE AREA END DATE *            25080000
243800           SET PS-ERROR,                                          25090000
243900               DP020-MSG-FATAL TO TRUE                            25100000
244000           SET PV-WORK-SUB     TO ASC-INDEX3                      25110000
244100           MOVE DP015-RED      TO MR-END-MM-C(PV-WORK-SUB)        25120000
244200                                  MR-END-DD-C(PV-WORK-SUB)        25130000
244300                                  MR-END-YY-C(PV-WORK-SUB)        25140000
244400           MOVE DP015-REVERSE  TO MR-END-MM-H(PV-WORK-SUB)        25150000
244500                                  MR-END-DD-H(PV-WORK-SUB)        25160000
244600                                  MR-END-YY-H(PV-WORK-SUB)        25170000
244700           MOVE -1             TO MR-END-MM-L(PV-WORK-SUB)        25180000
244800           MOVE PC-TSYMSG-00188 TO DP020-MSG-NUMBER               25190000
244900        END-IF                                                    25200000
245000     END-IF.                                                      25210000
245100     SET ASC-INDEX3 UP BY 1.                                      25220000
245200     SET ASC-INDEX2 UP BY 1.                                      25230000
245300     EJECT                                                        25240000
245400                                                                  25250000
245500                                                                  25260000
245600 6205-CHECK-CONSECUTIVE-DATES.                                    25270000
245700******************************************************************25280000
245800* MAKE SURE THAT THE START DATE ON THE SECOND RECORD IS CONSECUTIV25290000
245900* WITH THE END DATE ON THE FIRST RECORD.                          25300000
246000*                                                                 25310000
246100******************************************************************25320000
246110     INITIALIZE DPG51                                             25330000
246120                DPG52                                             25340000
246130                DPG53                                             25350000
246140                DPG54                                             25360000
246150                DPG55                                             25370000
246160                DPG56.                                            25380000
246170     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      25390000
246191     SET DPG52-LK-DTE-ISO TO TRUE.                                25400000
246192     MOVE PV-START-DATE TO DPG52-DB2-ISO-DATE-N.                  25410000
246193     SET DPG53-LK-CMPR-DTE-ISO TO TRUE.                           25420000
246194     MOVE PV-END-DATE TO DPG53-DB2-ISO-DATE-N.                    25430000
246195     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                25440000
246196                                             DPG52                25450000
246197                                             DPG53                25460000
246198                                             DPG54                25470000
246199                                             DPG55                25480000
246200                                             DPG56.               25490000
246201     IF DPG54-NO-ERROR                                            25500000
246900        IF DPG55-DAYS-DIFFERENCE = PC-CONSECUTIVE-DAYS            25510000
247000           SET PS-DATES-CONSECUTIVE TO TRUE                       25520000
247100        ELSE                                                      25530000
247200           SET PS-DATES-NOT-CONSECUTIVE TO TRUE                   25540000
247300           IF DPG55-DAYS-DIFFERENCE < PC-CONSECUTIVE-DAYS         25550000
247400              SET PS-DATES-OVERLAP TO TRUE                        25560000
247500           ELSE                                                   25570000
247600              SET PS-DATES-GAP     TO TRUE                        25580000
247700           END-IF                                                 25590000
247800        END-IF                                                    25600000
247900     ELSE                                                         25610000
248000        SET DP013-XCTL-DISPLAY-RESTART                            25620000
248100            DP013-LOGIC-ABEND TO TRUE                             25630000
248200        MOVE '6205-CHECK-CONSECUTIVE-DATES' TO                    25640000
248300             DP013-PARAGRAPH                                      25650000
248400        MOVE 'INVALID DATES IN DATE COMPARE' TO                   25660000
248500             DP013-MESSAGE-TEXT(1)                                25670000
248600        MOVE DPG54-ERROR-MESSAGE TO                               25680000
248700             DP013-MESSAGE-TEXT(2)                                25690000
248800        PERFORM DP013-0000-PROCESS-ABEND                          25700000
248900     END-IF.                                                      25710000
249000     EJECT                                                        25720000
249100                                                                  25730000
249200 7000-ADD-MERCHANDISE-AREA.                                       25740000
249300                                                                  25750000
249400******************************************************************25760000
249500*  THIS PARAGRAPH WILL PERFORM THE ADD OF THE MERCHANDISE AREA    25770000
249600*  ITSELF TO TMDSEAR TABLE.                                       25780000
249700*                                                                 25790000
249800*  PERFORMED BY : 6000-PROCESS-MAINTAINANCE                       25800000
249900******************************************************************25810000
250000                                                                  25820000
250100                                                                  25830000
250200     MOVE ASC-COMPANY-NO        TO MDSEAR-OPERCO-NBR              25840000
250300                                   PV-LIST-SEQ-OPERCO.            25850000
250400     MOVE ASC-GMA-NO            TO MDSEAR-GMA-NBR                 25860000
250500                                   PV-LIST-SEQ-GMA.               25870000
250600     MOVE ASC-DMA-NO            TO MDSEAR-DMA-NBR                 25880000
250700                                   PV-LIST-SEQ-DMA.               25890000
250800     MOVE ASC-DPT-NO            TO MDSEAR-DEPT-NBR                25900000
250900                                   PV-LIST-SEQ-DPT.               25910000
251000     MOVE ASC-MCL-NO            TO MDSEAR-MAJ-CL-NBR              25920000
251100                                   PV-LIST-SEQ-MCL.               25930000
251200     MOVE ASC-SCL-NO            TO MDSEAR-SUB-CL-NBR              25940000
251300                                   PV-LIST-SEQ-SCL.               25950000
251400     MOVE PV-MDSEAR-LIST-SEQ-NBR-N     TO MDSEAR-LIST-SEQ-NBR.    25960000
251500                                                                  25970000
251600     PERFORM 9020-GET-DATALESS-KEY.                               25980000
251700     COMPUTE MDSEAR-DKEY = MDSEAR-DKEY + 1.                       25990000
251800     MOVE MDSEAR-DKEY TO ASC-MDSEAR-DKEY.                         26000000
251900                                                                  26010000
252000     IF ASC-ADD-GMA                                               26020000
252100        MOVE PC-GMA-LEVEL-CD    TO MDSEAR-MDSELV-CDE              26030000
252200        MOVE ASC-GMA-DESC       TO MDSEAR-DESC                    26040000
252300     ELSE                                                         26050000
252400        IF ASC-ADD-DMA                                            26060000
252500            MOVE PC-DMA-LEVEL-CD    TO MDSEAR-MDSELV-CDE          26070000
252600            MOVE ASC-DMA-DESC       TO MDSEAR-DESC                26080000
252700        ELSE                                                      26090000
252800            IF ASC-ADD-DPT                                        26100000
252900                MOVE PC-DPT-LEVEL-CD    TO MDSEAR-MDSELV-CDE      26110000
253000                MOVE ASC-DPT-DESC       TO MDSEAR-DESC            26120000
253100            ELSE                                                  26130000
253200                IF ASC-ADD-MCL                                    26140000
253300                    MOVE PC-MCL-LEVEL-CD    TO MDSEAR-MDSELV-CDE  26150000
253400                    MOVE ASC-MCL-DESC       TO MDSEAR-DESC        26160000
253500                ELSE                                              26170000
253600                    MOVE PC-SCL-LEVEL-CD    TO MDSEAR-MDSELV-CDE  26180000
253700                    MOVE ASC-SCL-DESC       TO MDSEAR-DESC        26190000
253800                END-IF                                            26200000
253900            END-IF                                                26210000
254000        END-IF                                                    26220000
254100     END-IF.                                                      26230000
254200                                                                  26240000
254300     MOVE   ASC-EDITED-DATE-YYYYMMDD TO                           26250000
254400                                   MDSEAR-CHG-DTE                 26260000
254500                                   MDSEAR-CRE-DTE.                26270000
254600     MOVE ASC-LEVEL-START-CC    TO PV-CHANGE-CENT.                26280000
254700     MOVE ASC-LEVEL-START-YY    TO PV-CHANGE-YY.                  26290000
254800     MOVE ASC-LEVEL-START-MM    TO PV-CHANGE-MM.                  26300000
254900     MOVE ASC-LEVEL-START-DD    TO PV-CHANGE-DD.                  26310000
255000     MOVE PV-CHANGE-DATE        TO MDSEAR-STRT-DTE.               26320000
255100*                                                                 26330000
255200     MOVE ASC-LEVEL-END-CC      TO PV-CHANGE-CENT.                26340000
255300     MOVE ASC-LEVEL-END-YY      TO PV-CHANGE-YY.                  26350000
255400     MOVE ASC-LEVEL-END-MM      TO PV-CHANGE-MM.                  26360000
255500     MOVE ASC-LEVEL-END-DD      TO PV-CHANGE-DD.                  26370000
255600     MOVE PV-CHANGE-DATE        TO MDSEAR-END-DTE.                26380000
255700*                                                                 26390000
255800*                                                                 26400000
255900     MOVE ASC-MERCH-TYPE        TO MDSEAR-GEN-MDSE-TYP-CDE        26410000
256000     MOVE ASC-BUYER-NUMBER      TO MDSEAR-BYR-NBR                 26420000
256100*                                                                 26430000
256200     PERFORM 9021-INSERT-MERCHANDISE-AREA.                        26440000
256300*                                                                 26450000
256400     IF PS-ROW-NOT-FOUND                                          26460000
256500         SET PS-ERROR         TO TRUE                             26470000
256600         SET DP020-MSG-FATAL  TO TRUE                             26480000
256700         MOVE PC-TSYMSG-00138 TO DP020-MSG-NUMBER                 26490000
256800         MOVE -1              TO MR-LEVEL-L(1)                    26500000
256900     END-IF.                                                      26510000
257000                                                                  26520000
257100 EJECT                                                            26530000
257200                                                                  26540000
257300 7010-PROCESS-RESPONSIBILITY.                                     26550000
257400                                                                  26560000
257500******************************************************************26570000
257600*  THIS PARAGRAPH WILL INSERT A RESPONSIBILITY AREA ROW TO THE    26580000
257700*  TRSPBAR TABLE FOR EVERY ASSIGNMENT ON THE SCREEN.              26590000
257800*                                                                 26600000
257900*  PERFORMED BY : 6000-PROCESS-MAINTAINANCE                       26610000
258000******************************************************************26620000
258100     PERFORM                                                      26630000
258200        VARYING ASC-INDEX FROM                                    26640000
258300        1 BY  1                                                   26650000
258400        UNTIL ASC-INDEX > ASC-LINES-ENTERED                       26660000
258500                                                                  26670000
258600        MOVE ASC-MDSEAR-DKEY           TO RSPBAR-MDSEAR-DKEY      26680000
258700        MOVE ASC-COMPANY-NO            TO RSPBAR-OPERCO-NBR       26690000
258800        MOVE ASC-WORKER-NBR(ASC-INDEX) TO RSPBAR-WORKER-NBR       26700000
258900        MOVE ASC-LEVEL(ASC-INDEX)     TO RSPBAR-RSPLVL-CDE        26710000
259000        MOVE ASC-START-CYMD-CC(ASC-INDEX) TO PV-CHANGE-CENT       26720000
259100        MOVE ASC-START-MM(ASC-INDEX)  TO PV-CHANGE-MM             26730000
259200        MOVE ASC-START-DD(ASC-INDEX)  TO PV-CHANGE-DD             26740000
259300        MOVE ASC-START-YY(ASC-INDEX)  TO PV-CHANGE-YY             26750000
259400        MOVE PV-CHANGE-DATE           TO RSPBAR-WORKER-STRT-DTE   26760000
259500*                                                                 26770000
259600        IF ASC-END-DATE(ASC-INDEX) = SPACES                       26780000
259700           MOVE PC-INFINITY-DATE TO ASC-END-DATE-CYMD-N(ASC-INDEX)26790000
259800        END-IF                                                    26800000
259900*                                                                 26810000
260000        MOVE ASC-END-CYMD-CC(ASC-INDEX) TO PV-CHANGE-CENT         26820000
260100        MOVE ASC-END-MM(ASC-INDEX)    TO PV-CHANGE-MM             26830000
260200        MOVE ASC-END-DD(ASC-INDEX)    TO PV-CHANGE-DD             26840000
260300        MOVE ASC-END-YY(ASC-INDEX)    TO PV-CHANGE-YY             26850000
260400        MOVE PV-CHANGE-DATE           TO RSPBAR-WORKER-END-DTE    26860000
260500        MOVE ASC-FIRST-NAME(ASC-INDEX) TO RSPBAR-WORKER-FIR-NAME  26870000
260600        MOVE ASC-LAST-NAME(ASC-INDEX) TO RSPBAR-WORKER-LAST-NAME  26880000
260700        PERFORM 9022-INSERT-RSPBAR-ROW                            26890000
260800                                                                  26900000
260900     END-PERFORM.                                                 26910000
261000     EJECT                                                        26920000
261100                                                                  26930000
261200 7020-ADD-DEPARTMENT.                                             26940000
261300                                                                  26950000
261400******************************************************************26960000
261500*  THIS PARAGRAPH WILL INSERT A DEPARTMENT ROW ON THE TMDSEDP     26970000
261600*                                                                 26980000
261700*  PERFORMED BY : 6000-PROCESS-MAINTAINANCE                       26990000
261800******************************************************************27000000
261900                                                                  27010000
262000     MOVE ASC-MDSEAR-DKEY            TO MDSEDP-MDSEAR-DKEY.       27020000
262100     MOVE ASC-EDITED-DATE-YYYYMMDD   TO MDSEDP-CHG-DTE            27030000
262200                                        MDSEDP-ARDEPT-CHG-DTE.    27040000
262300     MOVE ASC-BUS-GROUP              TO MDSEDP-MDSEBG-NBR.        27050000
262400     MOVE ASC-DEPT-DISCOUNT          TO MDSEDP-DPTDIS-CDE.        27060000
262500     MOVE ASC-AR-DESCRIP             TO MDSEDP-ARDEPT-DESC.       27070000
262600     MOVE ASC-CONSIGN-IND            TO MDSEDP-CONS-IND.          27080000
262700     MOVE ASC-SCRN-DAYS-BEF-SHIP-NBR TO MDSEDP-DAYS-BEF-SHIP-NBR  27090000
262800     MOVE ASC-SCRN-DAYS-AFT-CLR-NBR  TO MDSEDP-DAYS-AFT-CLR-NBR   27100000
262900     MOVE ASC-SKU-LVL-UPD-IND        TO MDSEDP-SKU-LVL-UPD-IND.   27110000
263000     MOVE ASC-FREIGHT-PERCENT        TO MDSEDP-PLAN-FRGT-PCT.     27120000
263100     MOVE ASC-STR-ZN-ID              TO MDSEDP-STR-ZN-ID.         27130000
263200     PERFORM 9023-INSERT-MDSEDP-ROW.                              27140000
263300                                                                  27150000
263400 7025-ADD-SHRINK.                                                 27160000
263500                                                                  27170000
263600******************************************************************27180000
263700*  THIS PARAGRAPH WILL INSERT A SHRINK PERCENT ROW IN TDPTSHK     27190000
263800*                                                                 27200000
263900*  PERFORMED BY : 6000-PROCESS-MAINTAINANCE                       27210000
264000******************************************************************27220000
264100                                                                  27230000
264200     INITIALIZE PV-WORK-TDPTSHK.                                  27240000
264300                                                                  27250000
264400***  ALWAYS UPDATE SHRINK PERCENT FOR CALENDAR MONTH JANUARY      27260000
C14666     MOVE ASC-BM-SHRINK-PERCENT       TO  PV-SHRINK-PCTN (1)      27270000
264600                                                                  27280000
264700***  ONLY UPDTE SHRINK PERCENT GOING FORWARD IF IT                27290000
264800***  IS NOT CALENDAR MONTH JANUARY (ASC-CAL-MN-NBR = 1)           27300000
264900     PERFORM VARYING PV-SUB                                       27310000
265000         FROM ASC-CAL-MN-NBR-N BY 1                               27320000
265100         UNTIL PV-SUB GREATER THAN 12                             27330000
265200            OR ASC-CAL-MN-NBR-N = 1                               27340000
265300                                                                  27350000
C14666         MOVE ASC-BM-SHRINK-PERCENT  TO  PV-SHRINK-PCTN (PV-SUB)  27360000
265500                                                                  27370000
265600     END-PERFORM.                                                 27380000
265700                                                                  27390000
265800     MOVE PV-WORK-TDPTSHK            TO  DCLTDPTSHK.              27400000
265900     MOVE ASC-SHNK-FSCL-YR-NBR       TO  DPTSHK-SHRINK-YR-NBR.    27410000
266000     MOVE ASC-MDSEAR-DKEY            TO  DPTSHK-MDSEAR-DKEY.      27420000
266100                                                                  27430000
C14666     MOVE 'N'                        TO DPTSHK-E-BUS-IND.         27440000
C14666     MOVE DP020-USERID               TO DPTSHK-LAST-UPD-BY-USR.   27450000
C14666                                                                  27460000
266200     PERFORM 9027-INSERT-DPTSHK-ROW.                              27470000
266300                                                                  27480000
266400     MOVE DPTSHK-SHRINK-YR-NBR TO PV-SHRINK-YR-NBR.               27490000
266500     SUBTRACT 1 FROM PV-SHRINK-YR-NBR.                            27500000
266600     MOVE PV-SHRINK-YR-NBR TO DPTSHK-SHRINK-YR-NBR.               27510000
266700     MOVE +0 TO DPTSHK-JAN-SHRINK-PCT DPTSHK-JUL-SHRINK-PCT       27520000
266800                DPTSHK-FEB-SHRINK-PCT DPTSHK-AUG-SHRINK-PCT       27530000
266900                DPTSHK-MAR-SHRINK-PCT DPTSHK-SEP-SHRINK-PCT       27540000
267000                DPTSHK-APR-SHRINK-PCT DPTSHK-OCT-SHRINK-PCT       27550000
267100                DPTSHK-MAY-SHRINK-PCT DPTSHK-NOV-SHRINK-PCT       27560000
267200                DPTSHK-JUN-SHRINK-PCT DPTSHK-DEC-SHRINK-PCT.      27570000
267300                                                                  27580000
267400     PERFORM 9027-INSERT-DPTSHK-ROW.                              27590000
C14666                                                                  27600000
C14666     INITIALIZE PV-WORK-TDPTSHK.                                  27610000
C14666                                                                  27620000
C14666*ALWAYS UPDATE SHRINK PERCENT FOR CALENDAR MONTH JANUARY          27630000
C14666     MOVE ASC-ECOM-SHRINK-PERCENT     TO  PV-SHRINK-PCTN (1)      27640000
C14666                                                                  27650000
C14666*ONLY UPDATE SHRINK PERCENT GOING FORWARD IF IT                   27660000
C14666*IS NOT CALENDAR MONTH JANUARY (ASC-CAL-MN-NBR = 1)               27670000
C14666     PERFORM VARYING PV-SUB                                       27680000
C14666         FROM ASC-CAL-MN-NBR-N BY 1                               27690000
C14666         UNTIL PV-SUB GREATER THAN 12                             27700000
C14666            OR ASC-CAL-MN-NBR-N = 1                               27710000
C14666                                                                  27720000
C14666         MOVE ASC-ECOM-SHRINK-PERCENT                             27730000
C14666                                     TO PV-SHRINK-PCTN (PV-SUB)   27740000
C14666                                                                  27750000
C14666     END-PERFORM.                                                 27760000
C14666                                                                  27770000
C14666     MOVE PV-WORK-TDPTSHK            TO DCLTDPTSHK.               27780000
C14666     MOVE ASC-SHNK-FSCL-YR-NBR       TO DPTSHK-SHRINK-YR-NBR.     27790000
C14666     MOVE ASC-MDSEAR-DKEY            TO DPTSHK-MDSEAR-DKEY.       27800000
C14666     MOVE 'Y'                        TO DPTSHK-E-BUS-IND.         27810000
C14666     MOVE DP020-USERID               TO DPTSHK-LAST-UPD-BY-USR.   27820000
C14666                                                                  27830000
C14666     PERFORM 9027-INSERT-DPTSHK-ROW.                              27840000
C14666                                                                  27850000
C14666     MOVE DPTSHK-SHRINK-YR-NBR TO PV-SHRINK-YR-NBR.               27860000
C14666     SUBTRACT 1 FROM PV-SHRINK-YR-NBR.                            27870000
C14666     MOVE PV-SHRINK-YR-NBR TO DPTSHK-SHRINK-YR-NBR.               27880000
C14666     MOVE +0 TO DPTSHK-JAN-SHRINK-PCT DPTSHK-JUL-SHRINK-PCT       27890000
C14666                DPTSHK-FEB-SHRINK-PCT DPTSHK-AUG-SHRINK-PCT       27900000
C14666                DPTSHK-MAR-SHRINK-PCT DPTSHK-SEP-SHRINK-PCT       27910000
C14666                DPTSHK-APR-SHRINK-PCT DPTSHK-OCT-SHRINK-PCT       27920000
C14666                DPTSHK-MAY-SHRINK-PCT DPTSHK-NOV-SHRINK-PCT       27930000
C14666                DPTSHK-JUN-SHRINK-PCT DPTSHK-DEC-SHRINK-PCT.      27940000
C14666                                                                  27950000
C14666     PERFORM 9027-INSERT-DPTSHK-ROW.                              27960000
C14666                                                                  27970000
267500/                                                                 27980000
267600 7030-ADD-CLASS.                                                  27990000
267700                                                                  28000000
267800******************************************************************28010000
267900*  THIS WILL ADD ONE ROW TO THE MDSECL TABLE                      28020000
268000*  PERFORMED BY : 6000-PROCESS-MAINTAINANCE                       28030000
268100******************************************************************28040000
268200     MOVE ASC-MDSEAR-DKEY            TO MDSECL-MDSEAR-DKEY.       28050000
268300     MOVE ASC-POS-DESCRIP            TO MDSECL-POS-DESC.          28060000
268400     MOVE ASC-TAX-DEFLT-IND          TO MDSECL-TAX-DFLT-IND.      28070000
268500     PERFORM 9024-INSERT-MDSECL-ROW.                              28080000
268600                                                                  28090000
268700 7040-ADD-APPL-SYS-AVAIL.                                         28100000
268800                                                                  28110000
268900******************************************************************28120000
269000*  ADD THE APPLICATION AVAILABILITY ROWS.                         28130000
269100*    1)  USING THE DKEY OF THE PARENT OF THE MDSEAR TO BE ADDED,  28140000
269200*        MATCH PARENT DKEYS ON MDSEAR AND APPL SYSTEM AVAIL.      28150000
269300*        GET THE APPL SYSTEM AVAIL INFORMATION AND INSERT A NEW RO28160000
269400*        (WITH THE NEW DKEY) FOR EVERY "PARENT ROW" FOUND.        28170000
269500*                                                                 28180000
269600*    2)  MAKE SURE THAT APPLICATION AVAILABILITY OF PARENT MDSEAR 28190000
269700*        IS WITHIN RANGE OF MDSEAR BEING ADDED. ADJUST START AND  28200000
269800*        END DATES AS NECESSARY. BYPASS APLAVL ROW IF IT IS OUTSID28210000
269900*        THE RANGE OF THE MERCHANDISE START AND END DATES         28220000
270000*        COMPLETELY.                                              28230000
270100*  PERFORMED BY : 6000-PROCESS-MAINTAINANCE                       28240000
270200******************************************************************28250000
270300                                                                  28260000
270400                                                                  28270000
270500     MOVE ASC-PARENT-MDSEAR-DKEY TO DK-MDSEAR-DKEY.               28280000
270600                                                                  28290000
270700     PERFORM 9025-OPEN-APLAVL-CURSOR.                             28300000
270800                                                                  28310000
270900     PERFORM 9030-FETCH-APPL-AVAIL-ROW.                           28320000
271000                                                                  28330000
271100     PERFORM UNTIL PS-ROW-NOT-FOUND                               28340000
271200                                                                  28350000
271300          MOVE APLAVL-MDSEAR-STRT-DTE TO PV-CHANGE-DATE           28360000
271400          MOVE PV-CHANGE-CENT         TO PV-TMP-DTE-CC1           28370000
271500          MOVE PV-CHANGE-YY           TO PV-TMP-DTE-YY1           28380000
271600          MOVE PV-CHANGE-MM           TO PV-TMP-DTE-MM1           28390000
271700          MOVE PV-CHANGE-DD           TO PV-TMP-DTE-DD1           28400000
271800                                                                  28410000
271900          MOVE APLAVL-MDSEAR-END-DTE  TO PV-CHANGE-DATE           28420000
272000          MOVE PV-CHANGE-CENT         TO PV-TMP-DTE-CC2           28430000
272100          MOVE PV-CHANGE-YY           TO PV-TMP-DTE-YY2           28440000
272200          MOVE PV-CHANGE-MM           TO PV-TMP-DTE-MM2           28450000
272300          MOVE PV-CHANGE-DD           TO PV-TMP-DTE-DD2           28460000
272400                                                                  28470000
272500                                                                  28480000
272600          IF (PV-TEMP-DATE-1 > ASC-LEVEL-END-DATE-CYMD) OR        28490000
272700             (PV-TEMP-DATE-2 < ASC-LEVEL-START-DATE-CYMD)         28500000
272800                                                                  28510000
272900              CONTINUE                                            28520000
273000          ELSE                                                    28530000
273100             MOVE ASC-MDSEAR-DKEY TO APLAVL-MDSEAR-DKEY           28540000
273200             MOVE ASC-COMPANY-NO  TO APLAVL-OPERCO-NBR            28550000
273300                                                                  28560000
273400             IF (PV-TEMP-DATE-2 < ASC-LEVEL-END-DATE-CYMD)        28570000
273500                CONTINUE                                          28580000
273600             ELSE                                                 28590000
273700                MOVE ASC-LEVEL-END-CC TO PV-CHANGE-CENT           28600000
273800                MOVE ASC-LEVEL-END-YY TO PV-CHANGE-YY             28610000
273900                MOVE ASC-LEVEL-END-MM TO PV-CHANGE-MM             28620000
274000                MOVE ASC-LEVEL-END-DD TO PV-CHANGE-DD             28630000
274100                MOVE PV-CHANGE-DATE     TO APLAVL-MDSEAR-END-DTE  28640000
274200             END-IF                                               28650000
274300                                                                  28660000
274400                                                                  28670000
274500             IF (PV-TEMP-DATE-1 <  ASC-LEVEL-START-DATE-CYMD)     28680000
274600                MOVE ASC-LEVEL-START-CC TO PV-CHANGE-CENT         28690000
274700                MOVE ASC-LEVEL-START-YY TO PV-CHANGE-YY           28700000
274800                MOVE ASC-LEVEL-START-MM TO PV-CHANGE-MM           28710000
274900                MOVE ASC-LEVEL-START-DD TO PV-CHANGE-DD           28720000
275000                MOVE PV-CHANGE-DATE     TO APLAVL-MDSEAR-STRT-DTE 28730000
275100             ELSE                                                 28740000
275200                CONTINUE                                          28750000
275300             END-IF                                               28760000
275400                                                                  28770000
275500             PERFORM 9040-INSERT-APLAVL-ROW                       28780000
275600                                                                  28790000
275700          END-IF                                                  28800000
275800             IF PS-ROW-NOT-FOUND                                  28810000
275900                SET PS-ERROR TO TRUE                              28820000
276000                SET DP020-MSG-FATAL TO TRUE                       28830000
276100                MOVE PC-TSYMSG-00138 TO DP020-MSG-NUMBER          28840000
276200             ELSE                                                 28850000
276300                MOVE ASC-PARENT-MDSEAR-DKEY TO DK-MDSEAR-DKEY     28860000
276400                PERFORM 9030-FETCH-APPL-AVAIL-ROW                 28870000
276500             END-IF                                               28880000
276600                                                                  28890000
276700     END-PERFORM.                                                 28900000
276800                                                                  28910000
276900     PERFORM 9041-CLOSE-APLAVL-CURSOR.                            28920000
277000                                                                  28930000
277100                                                                  28940000
277200     EJECT                                                        28950000
277300                                                                  28960000
277400 9000-GET-RESPBL-LEVEL.                                           28970000
277500******************************************************************28980000
277600*                                                                 28990000
277700******************************************************************29000000
277800                                                                  29010000
277900     PERFORM WITH TEST AFTER                                      29020000
278000         VARYING PV-RETRY-COUNTER                                 29030000
278100         FROM 1 BY 1                                              29040000
278200         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              29050000
278300                 OR (SQLCODE = 0)                                 29060000
278400                 OR (SQLCODE = +100))                             29070000
278500                                                                  29080000
278600                                                                  29090000
278700         EXEC SQL                                                 29100000
278800             SELECT RSPLVL_CDE                                    29110000
278900             INTO :RSPLVL-CDE                                     29120000
279000             FROM   TRSPLVL                                       29130000
279100             WHERE (RSPLVL_CDE  = :DK-RSPLVL-CDE)                 29140000
279200         END-EXEC                                                 29150000
279300                                                                  29160000
279400         EVALUATE TRUE                                            29170000
279500             WHEN SQLCODE = ZERO                                  29180000
279600                 SET PS-ROW-FOUND TO TRUE                         29190000
279700             WHEN SQLCODE = -904                                  29200000
279800             WHEN SQLCODE = -913                                  29210000
279900                  CONTINUE                                        29220000
280000             WHEN SQLCODE = +100                                  29230000
280100                  CONTINUE                                        29240000
280200             WHEN SQLWARN0 NOT = SPACES                           29250000
280300             WHEN SQLCODE < 0                                     29260000
280400             WHEN SQLCODE > 0                                     29270000
280500                 STRING ' RESPLVL CODE ' DK-RSPLVL-CDE            29280000
280600                        DELIMITED BY SIZE                         29290000
280700                        INTO DP013-MESSAGE-TEXT(2)                29300000
280800                 MOVE SQLCA TO DP013-SQLCA                        29310000
280900                 MOVE '9000-GET-RESPBLVL-CODE' TO                 29320000
281000                     DP013-PARAGRAPH                              29330000
281100                 MOVE 'TRSPLVL' TO DP013-DB2-TABLE-NAME(2)        29340000
281200                 SET DP013-DB2-ABEND TO TRUE                      29350000
281300                 SET DP013-NO-ROLLBACK TO TRUE                    29360000
281400                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           29370000
281500                 PERFORM DP013-0000-PROCESS-ABEND                 29380000
281600         END-EVALUATE                                             29390000
281700     END-PERFORM.                                                 29400000
281800                                                                  29410000
281900                                                                  29420000
282000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         29430000
282100         MOVE '9000-GET-RSPBLVL-CODE' TO                          29440000
282200                                     DP013-PARAGRAPH              29450000
282300         STRING ' RSPLVL CODE ' DK-RSPLVL-CDE                     29460000
282400                DELIMITED BY SIZE                                 29470000
282500                                INTO DP013-MESSAGE-TEXT(1)        29480000
282600         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 29490000
282700                                     DP013-MESSAGE-TEXT(2)        29500000
282800         MOVE SQLCA TO DP013-SQLCA                                29510000
282900         MOVE 'TRSPLVL' TO DP013-DB2-TABLE-NAME(1)                29520000
283000         SET DP013-DB2-ABEND                                      29530000
283100             DP013-NO-ROLLBACK                                    29540000
283200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   29550000
283300         PERFORM DP013-0000-PROCESS-ABEND                         29560000
283400     END-IF.                                                      29570000
283500     EJECT                                                        29580000
283600                                                                  29590000
283700                                                                  29600000
283800 9010-GET-WORKER-INFO.                                            29610000
283900******************************************************************29620000
284000*                                                                 29630000
284100******************************************************************29640000
284200                                                                  29650000
284300     PERFORM WITH TEST AFTER                                      29660000
284400         VARYING PV-RETRY-COUNTER                                 29670000
284500         FROM 1 BY 1                                              29680000
284600         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              29690000
284700                 OR (SQLCODE = 0)                                 29700000
284800                 OR (SQLCODE = +100))                             29710000
284900                                                                  29720000
285000                                                                  29730000
285100         EXEC SQL                                                 29740000
285200             SELECT WORKER_NBR,                                   29750000
285300                    LAST_NAME,                                    29760000
285400                    FIR_NAME                                      29770000
285500             INTO :WORKER-NBR,                                    29780000
285600                  :WORKER-LAST-NAME,                              29790000
285700                  :WORKER-FIR-NAME                                29800000
285800             FROM   TWORKER                                       29810000
285900             WHERE (UID_NBR  = :DK-UID-NBR)                       29820000
286000         END-EXEC                                                 29830000
286100                                                                  29840000
286200         EVALUATE TRUE                                            29850000
286300             WHEN SQLCODE = ZERO                                  29860000
286400                 SET PS-ROW-FOUND TO TRUE                         29870000
286500             WHEN SQLCODE = -904                                  29880000
286600             WHEN SQLCODE = -913                                  29890000
286700                  CONTINUE                                        29900000
286800             WHEN SQLCODE = +100                                  29910000
286900                  CONTINUE                                        29920000
287000             WHEN SQLWARN0 NOT = SPACES                           29930000
287100             WHEN SQLCODE < 0                                     29940000
287200             WHEN SQLCODE > 0                                     29950000
287300                 STRING ' WORKER UID = ' DK-UID-NBR               29960000
287400                        DELIMITED BY SIZE                         29970000
287500                        INTO DP013-MESSAGE-TEXT(2)                29980000
287600                 MOVE SQLCA TO DP013-SQLCA                        29990000
287700                 MOVE '9010-GET-WORKER-INFO' TO                   30000000
287800                     DP013-PARAGRAPH                              30010000
287900                 MOVE 'TWORKER' TO DP013-DB2-TABLE-NAME(2)        30020000
288000                 SET DP013-DB2-ABEND TO TRUE                      30030000
288100                 SET DP013-NO-ROLLBACK TO TRUE                    30040000
288200                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           30050000
288300                 PERFORM DP013-0000-PROCESS-ABEND                 30060000
288400         END-EVALUATE                                             30070000
288500     END-PERFORM.                                                 30080000
288600                                                                  30090000
288700                                                                  30100000
288800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         30110000
288900         MOVE '9010-GET-WORKER-INFO' TO                           30120000
289000                                     DP013-PARAGRAPH              30130000
289100         STRING ' WORKER ID = ' DK-UID-NBR                        30140000
289200                DELIMITED BY SIZE                                 30150000
289300                                INTO DP013-MESSAGE-TEXT(1)        30160000
289400         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 30170000
289500                                     DP013-MESSAGE-TEXT(2)        30180000
289600         MOVE SQLCA TO DP013-SQLCA                                30190000
289700         MOVE 'TWORKER' TO DP013-DB2-TABLE-NAME(1)                30200000
289800         SET DP013-DB2-ABEND                                      30210000
289900             DP013-NO-ROLLBACK                                    30220000
290000             DP013-XCTL-DISPLAY-RESTART TO TRUE                   30230000
290100         PERFORM DP013-0000-PROCESS-ABEND                         30240000
290200     END-IF.                                                      30250000
290300     EJECT                                                        30260000
290400                                                                  30270000
290500                                                                  30280000
290600 9020-GET-DATALESS-KEY.                                           30290000
290700******************************************************************30300000
290800*                                                                 30310000
290900******************************************************************30320000
291000                                                                  30330000
291100     PERFORM WITH TEST AFTER                                      30340000
291200         VARYING PV-RETRY-COUNTER                                 30350000
291300         FROM 1 BY 1                                              30360000
291400         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              30370000
291500                 OR (SQLCODE = 0)                                 30380000
291600                 OR (SQLCODE = +100))                             30390000
291700                                                                  30400000
291800                                                                  30410000
291900         EXEC SQL                                                 30420000
292000             SELECT MAX(MDSEAR_DKEY)                              30430000
292100             INTO :MDSEAR-DKEY                                    30440000
292200             FROM TMDSEAR                                         30450000
292300         END-EXEC                                                 30460000
292400                                                                  30470000
292500         EVALUATE TRUE                                            30480000
292600             WHEN SQLCODE = ZERO                                  30490000
292700                 SET PS-ROW-FOUND TO TRUE                         30500000
292800             WHEN SQLCODE = -904                                  30510000
292900             WHEN SQLCODE = -913                                  30520000
293000                  CONTINUE                                        30530000
293100             WHEN SQLCODE = +100                                  30540000
293200             WHEN SQLWARN0 NOT = SPACES                           30550000
293300             WHEN SQLCODE < 0                                     30560000
293400             WHEN SQLCODE > 0                                     30570000
293500                 MOVE 'ATTEMPTING TO GET MAX DKEY ON TABLE'       30580000
293600                        TO DP013-MESSAGE-TEXT(1)                  30590000
293700                 MOVE SQLCA TO DP013-SQLCA                        30600000
293800                 MOVE '9020-GET-DATALESS-KEY' TO                  30610000
293900                     DP013-PARAGRAPH                              30620000
294000                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        30630000
294100                 SET DP013-DB2-ABEND TO TRUE                      30640000
294200                 SET DP013-NO-ROLLBACK TO TRUE                    30650000
294300                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           30660000
294400                 PERFORM DP013-0000-PROCESS-ABEND                 30670000
294500         END-EVALUATE                                             30680000
294600     END-PERFORM.                                                 30690000
294700                                                                  30700000
294800                                                                  30710000
294900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         30720000
295000         MOVE '9020-GET-DATALESS-KEY' TO                          30730000
295100                                     DP013-PARAGRAPH              30740000
295200         MOVE 'ATTEMPTING TO GET MAX DKEY ON TABLE'               30750000
295300                                  TO DP013-MESSAGE-TEXT(1)        30760000
295400         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 30770000
295500                                     DP013-MESSAGE-TEXT(2)        30780000
295600         MOVE SQLCA TO DP013-SQLCA                                30790000
295700         MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                30800000
295800         SET DP013-DB2-ABEND                                      30810000
295900             DP013-NO-ROLLBACK                                    30820000
296000             DP013-XCTL-DISPLAY-RESTART TO TRUE                   30830000
296100         PERFORM DP013-0000-PROCESS-ABEND                         30840000
296200     END-IF.                                                      30850000
296300     EJECT                                                        30860000
296400                                                                  30870000
296500                                                                  30880000
296600 9021-INSERT-MERCHANDISE-AREA.                                    30890000
296700******************************************************************30900000
296800*    INSERT THE MERCHANDISE AREA TO BE ADDED.                     30910000
296900******************************************************************30920000
297000                                                                  30930000
297100     PERFORM WITH TEST AFTER                                      30940000
297200         VARYING PV-RETRY-COUNTER                                 30950000
297300         FROM 1 BY 1                                              30960000
297400         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              30970000
297500                 OR (SQLCODE = 0)                                 30980000
297600                 OR (SQLCODE = +100))                             30990000
297700                                                                  31000000
297800                                                                  31010000
297900         EXEC SQL                                                 31020000
298000             INSERT INTO TMDSEAR                                  31030000
298100             (OPERCO_NBR,                                         31040000
298200              GMA_NBR,                                            31050000
298300              DMA_NBR,                                            31060000
298400              DEPT_NBR,                                           31070000
298500              MAJ_CL_NBR,                                         31080000
298600              SUB_CL_NBR,                                         31090000
298700              MDSELV_CDE,                                         31100000
298800              MDSEAR_DKEY,                                        31110000
298900              CHG_DTE,                                            31120000
299000              CRE_DTE,                                            31130000
299100              STRT_DTE,                                           31140000
299200              END_DTE,                                            31150000
299300              GEN_MDSE_TYP_CDE,                                   31160000
299400              MDSEAR_DESC,                                        31170000
299500              BYR_NBR,                                            31180000
299600              LIST_SEQ_NBR)                                       31190000
299700              VALUES (:MDSEAR-OPERCO-NBR,                         31200000
299800                      :MDSEAR-GMA-NBR,                            31210000
299900                      :MDSEAR-DMA-NBR,                            31220000
300000                      :MDSEAR-DEPT-NBR,                           31230000
300100                      :MDSEAR-MAJ-CL-NBR,                         31240000
300200                      :MDSEAR-SUB-CL-NBR,                         31250000
300300                      :MDSEAR-MDSELV-CDE,                         31260000
300400                      :MDSEAR-DKEY,                               31270000
300500                      :MDSEAR-CHG-DTE,                            31280000
300600                      :MDSEAR-CRE-DTE,                            31290000
300700                      :MDSEAR-STRT-DTE,                           31300000
300800                      :MDSEAR-END-DTE,                            31310000
300900                      :MDSEAR-GEN-MDSE-TYP-CDE,                   31320000
301000                      :MDSEAR-DESC,                               31330000
301100                      :MDSEAR-BYR-NBR,                            31340000
301200                      :MDSEAR-LIST-SEQ-NBR)                       31350000
301300         END-EXEC                                                 31360000
301400                                                                  31370000
301500         EVALUATE TRUE                                            31380000
301600             WHEN SQLCODE = ZERO                                  31390000
301700                 SET PS-ROW-FOUND TO TRUE                         31400000
301800             WHEN SQLCODE = -904                                  31410000
301900             WHEN SQLCODE = -913                                  31420000
302000                  CONTINUE                                        31430000
302100             WHEN SQLCODE = -803                                  31440000
302200                  SET PS-ROW-NOT-FOUND TO TRUE                    31450000
302300             WHEN SQLCODE = +100                                  31460000
302400             WHEN SQLWARN0 NOT = SPACES                           31470000
302500             WHEN SQLCODE < 0                                     31480000
302600             WHEN SQLCODE > 0                                     31490000
302700                 STRING ' GMA = ' ASC-GMA-NO                      31500000
302800                        ' DMA = ' ASC-DMA-NO                      31510000
302900                        ' DPT = ' ASC-DPT-NO                      31520000
303000                        ' MCL = ' ASC-MCL-NO                      31530000
303100                        ' SCL = ' ASC-SCL-NO                      31540000
303200                        DELIMITED BY SIZE                         31550000
303300                      INTO DP013-MESSAGE-TEXT(1)                  31560000
303400                 MOVE SQLCA TO DP013-SQLCA                        31570000
303500                 MOVE '9021-INSERT-MERCHANDISE-AREA' TO           31580000
303600                     DP013-PARAGRAPH                              31590000
303700                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        31600000
303800                 SET DP013-DB2-ABEND TO TRUE                      31610000
303900                 SET DP013-ROLLBACK TO TRUE                       31620000
304000                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           31630000
304100                 PERFORM DP013-0000-PROCESS-ABEND                 31640000
304200         END-EVALUATE                                             31650000
304300     END-PERFORM.                                                 31660000
304400                                                                  31670000
304500                                                                  31680000
304600     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         31690000
304700                                                                  31700000
304800                 STRING ' GMA = ' ASC-GMA-NO                      31710000
304900                        ' DMA = ' ASC-DMA-NO                      31720000
305000                        ' DPT = ' ASC-DPT-NO                      31730000
305100                        ' MCL = ' ASC-MCL-NO                      31740000
305200                        ' SCL = ' ASC-SCL-NO                      31750000
305300                        DELIMITED BY SIZE                         31760000
305400                      INTO DP013-MESSAGE-TEXT(1)                  31770000
305500             MOVE '9021-INSERT-MERCHANDISE-AREA' TO               31780000
305600                                         DP013-PARAGRAPH          31790000
305700             MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO             31800000
305800                                         DP013-MESSAGE-TEXT(2)    31810000
305900             MOVE SQLCA TO DP013-SQLCA                            31820000
306000             MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)            31830000
306100             SET DP013-DB2-ABEND                                  31840000
306200                 DP013-ROLLBACK                                   31850000
306300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               31860000
306400             PERFORM DP013-0000-PROCESS-ABEND                     31870000
306500     END-IF.                                                      31880000
306600     EJECT                                                        31890000
306700                                                                  31900000
306800 9022-INSERT-RSPBAR-ROW.                                          31910000
306900******************************************************************31920000
307000*    INSERT THE RESPONSIBILITY ROWS.                              31930000
307100******************************************************************31940000
307200                                                                  31950000
307300     PERFORM WITH TEST AFTER                                      31960000
307400         VARYING PV-RETRY-COUNTER                                 31970000
307500         FROM 1 BY 1                                              31980000
307600         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              31990000
307700                 OR (SQLCODE = 0)                                 32000000
307800                 OR (SQLCODE = +100))                             32010000
307900                                                                  32020000
308000                                                                  32030000
308100         EXEC SQL                                                 32040000
308200             INSERT INTO TRSPBAR                                  32050000
308300             (MDSEAR_DKEY,                                        32060000
308400              WORKER_NBR,                                         32070000
308500              RSPLVL_CDE,                                         32080000
308600              WORKER_STRT_DTE,                                    32090000
308700              WORKER_END_DTE,                                     32100000
308800              WORKER_FIR_NAME,                                    32110000
308900              WORKER_LAST_NAME,                                   32120000
309000              OPERCO_NBR)                                         32130000
309100              VALUES (:RSPBAR-MDSEAR-DKEY,                        32140000
309200                      :RSPBAR-WORKER-NBR,                         32150000
309300                      :RSPBAR-RSPLVL-CDE,                         32160000
309400                      :RSPBAR-WORKER-STRT-DTE,                    32170000
309500                      :RSPBAR-WORKER-END-DTE,                     32180000
309600                      :RSPBAR-WORKER-FIR-NAME,                    32190000
309700                      :RSPBAR-WORKER-LAST-NAME,                   32200000
309800                      :RSPBAR-OPERCO-NBR)                         32210000
309900         END-EXEC                                                 32220000
310000                                                                  32230000
310100         EVALUATE TRUE                                            32240000
310200             WHEN SQLCODE = ZERO                                  32250000
310300                 SET PS-ROW-FOUND TO TRUE                         32260000
310400             WHEN SQLCODE = -904                                  32270000
310500             WHEN SQLCODE = -913                                  32280000
310600                  CONTINUE                                        32290000
310700             WHEN SQLWARN0 NOT = SPACES                           32300000
310800             WHEN SQLCODE < 0                                     32310000
310900             WHEN SQLCODE > 0                                     32320000
311000                 MOVE ASC-MDSEAR-DKEY TO PV-ERR-DKEY              32330000
311100                 MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT(1)     32340000
311200                 MOVE 'TRSPBAR' TO DP013-DB2-TABLE-NAME(1)        32350000
311300                 MOVE SQLCA TO DP013-SQLCA                        32360000
311400                 MOVE '9022-INSERT-RSPBAR-ROW' TO                 32370000
311500                     DP013-PARAGRAPH                              32380000
311600                 SET DP013-DB2-ABEND TO TRUE                      32390000
311700                 SET DP013-ROLLBACK TO TRUE                       32400000
311800                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           32410000
311900                 PERFORM DP013-0000-PROCESS-ABEND                 32420000
312000         END-EVALUATE                                             32430000
312100     END-PERFORM.                                                 32440000
312200                                                                  32450000
312300                                                                  32460000
312400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         32470000
312500                                                                  32480000
312600                 MOVE ASC-MDSEAR-DKEY TO PV-ERR-DKEY              32490000
312700                 MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT(1)     32500000
312800         MOVE '9022-INSERT-RSPBAR-ROW' TO                         32510000
312900                                     DP013-PARAGRAPH              32520000
313000         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 32530000
313100                                     DP013-MESSAGE-TEXT(2)        32540000
313200         MOVE SQLCA TO DP013-SQLCA                                32550000
313300         MOVE 'TRSPBAR' TO DP013-DB2-TABLE-NAME(1)                32560000
313400         SET DP013-DB2-ABEND                                      32570000
313500             DP013-ROLLBACK                                       32580000
313600             DP013-XCTL-DISPLAY-RESTART TO TRUE                   32590000
313700         PERFORM DP013-0000-PROCESS-ABEND                         32600000
313800     END-IF.                                                      32610000
313900     EJECT                                                        32620000
314000                                                                  32630000
314100 9023-INSERT-MDSEDP-ROW.                                          32640000
314200******************************************************************32650000
314300*    INSERT THE RESPONSIBILITY ROWS.                              32660000
314400******************************************************************32670000
314500                                                                  32680000
314600     PERFORM WITH TEST AFTER                                      32690000
314700         VARYING PV-RETRY-COUNTER                                 32700000
314800         FROM 1 BY 1                                              32710000
314900         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              32720000
315000                 OR (SQLCODE = 0)                                 32730000
315100                 OR (SQLCODE = +100))                             32740000
315200                                                                  32750000
315300                                                                  32760000
315400         EXEC SQL                                                 32770000
315500             INSERT INTO TMDSEDP                                  32780000
315600             (MDSEAR_DKEY,                                        32790000
315700              CHG_DTE,                                            32800000
315800              MDSEBG_NBR,                                         32810000
315900              DPTDIS_CDE,                                         32820000
316000              ARDEPT_CHG_DTE,                                     32830000
316100              ARDEPT_DESC,                                        32840000
316200              CONS_IND,                                           32850000
316300              DAYS_BEF_SHIP_NBR,                                  32860000
316400              DAYS_AFT_CLR_NBR,                                   32870000
316500              PLAN_FRGT_PCT,                                      32880000
316600              SKU_LVL_UPD_IND,                                    32890000
316700              VS_MGT_CNVER_IND,                                   32900000
316800              STR_ZN_ID)                                          32910000
316900              VALUES (:MDSEDP-MDSEAR-DKEY,                        32920000
317000                      :MDSEDP-CHG-DTE,                            32930000
317100                      :MDSEDP-MDSEBG-NBR,                         32940000
317200                      :MDSEDP-DPTDIS-CDE,                         32950000
317300                      :MDSEDP-ARDEPT-CHG-DTE,                     32960000
317400                      :MDSEDP-ARDEPT-DESC,                        32970000
317500                      :MDSEDP-CONS-IND,                           32980000
317600                      :MDSEDP-DAYS-BEF-SHIP-NBR,                  32990000
317700                      :MDSEDP-DAYS-AFT-CLR-NBR,                   33000000
317800                      :MDSEDP-PLAN-FRGT-PCT,                      33010000
317900                      :MDSEDP-SKU-LVL-UPD-IND,                    33020000
318000                      :PC-CNVER-IND,                              33030000
318100                      :MDSEDP-STR-ZN-ID)                          33040000
318200         END-EXEC                                                 33050000
318300                                                                  33060000
318400         EVALUATE TRUE                                            33070000
318500             WHEN SQLCODE = ZERO                                  33080000
318600                 SET PS-ROW-FOUND TO TRUE                         33090000
318700             WHEN SQLCODE = -904                                  33100000
318800             WHEN SQLCODE = -913                                  33110000
318900                  CONTINUE                                        33120000
319000             WHEN SQLWARN0 NOT = SPACES                           33130000
319100             WHEN SQLCODE < 0                                     33140000
319200             WHEN SQLCODE > 0                                     33150000
319300                 MOVE ASC-MDSEAR-DKEY TO PV-ERR-DKEY              33160000
319400                 MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT(1)     33170000
319500                 MOVE SQLCA TO DP013-SQLCA                        33180000
319600                 MOVE '9023-INSERT-MDSEDP-ROW' TO                 33190000
319700                     DP013-PARAGRAPH                              33200000
319800                 MOVE 'TMDSEDP' TO DP013-DB2-TABLE-NAME(1)        33210000
319900                 SET DP013-DB2-ABEND TO TRUE                      33220000
320000                 SET DP013-ROLLBACK TO TRUE                       33230000
320100                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           33240000
320200                 PERFORM DP013-0000-PROCESS-ABEND                 33250000
320300         END-EVALUATE                                             33260000
320400     END-PERFORM.                                                 33270000
320500                                                                  33280000
320600                                                                  33290000
320700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         33300000
320800         MOVE ASC-MDSEAR-DKEY TO PV-ERR-DKEY                      33310000
320900         MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT(1)             33320000
321000         MOVE '9023-INSERT-MDSEDP-ROW' TO                         33330000
321100                                     DP013-PARAGRAPH              33340000
321200         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 33350000
321300                                     DP013-MESSAGE-TEXT(2)        33360000
321400         MOVE SQLCA TO DP013-SQLCA                                33370000
321500         MOVE 'TMDSEDP' TO DP013-DB2-TABLE-NAME(1)                33380000
321600         SET DP013-DB2-ABEND                                      33390000
321700             DP013-ROLLBACK                                       33400000
321800             DP013-XCTL-DISPLAY-RESTART TO TRUE                   33410000
321900         PERFORM DP013-0000-PROCESS-ABEND                         33420000
322000     END-IF.                                                      33430000
322100     EJECT                                                        33440000
322200                                                                  33450000
322300                                                                  33460000
322400 9024-INSERT-MDSECL-ROW.                                          33470000
322500******************************************************************33480000
322600*    INSERT THE RESPONSIBILITY ROWS.                              33490000
322700******************************************************************33500000
322800                                                                  33510000
322900     PERFORM WITH TEST AFTER                                      33520000
323000         VARYING PV-RETRY-COUNTER                                 33530000
323100         FROM 1 BY 1                                              33540000
323200         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              33550000
323300                 OR (SQLCODE = 0)                                 33560000
323400                 OR (SQLCODE = +100))                             33570000
323500                                                                  33580000
323600                                                                  33590000
323700         EXEC SQL                                                 33600000
323800             INSERT INTO TMDSECL                                  33610000
323900             (MDSEAR_DKEY,                                        33620000
324000              POS_DESC,                                           33630000
324100              TAX_DFLT_IND)                                       33640000
324200              VALUES (:MDSECL-MDSEAR-DKEY,                        33650000
324300                      :MDSECL-POS-DESC,                           33660000
324400                      :MDSECL-TAX-DFLT-IND)                       33670000
324500         END-EXEC                                                 33680000
324600                                                                  33690000
324700         EVALUATE TRUE                                            33700000
324800             WHEN SQLCODE = ZERO                                  33710000
324900                 SET PS-ROW-FOUND TO TRUE                         33720000
325000             WHEN SQLCODE = -904                                  33730000
325100             WHEN SQLCODE = -913                                  33740000
325200                  CONTINUE                                        33750000
325300             WHEN SQLWARN0 NOT = SPACES                           33760000
325400             WHEN SQLCODE < 0                                     33770000
325500             WHEN SQLCODE > 0                                     33780000
325600                 MOVE ASC-MDSEAR-DKEY TO PV-ERR-DKEY              33790000
325700                 MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT(1)     33800000
325800                 MOVE SQLCA TO DP013-SQLCA                        33810000
325900                 MOVE '9024-INSERT-MDSEDP-ROW' TO                 33820000
326000                     DP013-PARAGRAPH                              33830000
326100                 MOVE 'TMDSECL' TO DP013-DB2-TABLE-NAME(1)        33840000
326200                 SET DP013-DB2-ABEND TO TRUE                      33850000
326300                 SET DP013-ROLLBACK TO TRUE                       33860000
326400                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           33870000
326500                 PERFORM DP013-0000-PROCESS-ABEND                 33880000
326600         END-EVALUATE                                             33890000
326700     END-PERFORM.                                                 33900000
326800                                                                  33910000
326900                                                                  33920000
327000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         33930000
327100         MOVE ASC-MDSEAR-DKEY TO PV-ERR-DKEY                      33940000
327200         MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT(1)             33950000
327300         MOVE '9024-INSERT-MDSEDP-ROW' TO                         33960000
327400                                     DP013-PARAGRAPH              33970000
327500         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 33980000
327600                                     DP013-MESSAGE-TEXT(2)        33990000
327700         MOVE SQLCA TO DP013-SQLCA                                34000000
327800         MOVE 'TMDSECL' TO DP013-DB2-TABLE-NAME(1)                34010000
327900         SET DP013-DB2-ABEND                                      34020000
328000             DP013-ROLLBACK                                       34030000
328100             DP013-XCTL-DISPLAY-RESTART TO TRUE                   34040000
328200         PERFORM DP013-0000-PROCESS-ABEND                         34050000
328300     END-IF.                                                      34060000
328400     EJECT                                                        34070000
328500                                                                  34080000
328600 9025-OPEN-APLAVL-CURSOR.                                         34090000
328700******************************************************************34100000
328800*    OPEN CURSOR FOR APPLICATION AVAILABILITY TABLE               34110000
328900******************************************************************34120000
329000                                                                  34130000
329100     PERFORM WITH TEST AFTER                                      34140000
329200         VARYING PV-RETRY-COUNTER                                 34150000
329300         FROM 1 BY 1                                              34160000
329400         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              34170000
329500                 OR (SQLCODE = 0)                                 34180000
329600                 OR (SQLCODE = +100))                             34190000
329700                                                                  34200000
329800                                                                  34210000
329900         EXEC SQL                                                 34220000
330000             OPEN APLAVL_CUR                                      34230000
330100         END-EXEC                                                 34240000
330200                                                                  34250000
330300         EVALUATE TRUE                                            34260000
330400             WHEN SQLCODE = ZERO                                  34270000
330500                 SET PS-ROW-FOUND TO TRUE                         34280000
330600             WHEN SQLCODE = -904                                  34290000
330700             WHEN SQLCODE = -913                                  34300000
330800                  CONTINUE                                        34310000
330900             WHEN SQLWARN0 NOT = SPACES                           34320000
331000             WHEN SQLCODE < 0                                     34330000
331100             WHEN SQLCODE > 0                                     34340000
331200                 MOVE SQLCA TO DP013-SQLCA                        34350000
331300                 MOVE '9025-OPEN-APLAVL-CURSOR' TO                34360000
331400                     DP013-PARAGRAPH                              34370000
331500                 MOVE 'TAPLAVL' TO DP013-DB2-TABLE-NAME(1)        34380000
331600                 SET DP013-DB2-ABEND TO TRUE                      34390000
331700                 SET DP013-ROLLBACK TO TRUE                       34400000
331800                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           34410000
331900                 PERFORM DP013-0000-PROCESS-ABEND                 34420000
332000         END-EVALUATE                                             34430000
332100     END-PERFORM.                                                 34440000
332200                                                                  34450000
332300                                                                  34460000
332400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         34470000
332500         MOVE '9025-OPEN-APLAVL-CURSOR' TO                        34480000
332600                                     DP013-PARAGRAPH              34490000
332700         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 34500000
332800                                     DP013-MESSAGE-TEXT(2)        34510000
332900         MOVE SQLCA TO DP013-SQLCA                                34520000
333000         MOVE 'TAPLAVL' TO DP013-DB2-TABLE-NAME(1)                34530000
333100         SET DP013-DB2-ABEND                                      34540000
333200             DP013-ROLLBACK                                       34550000
333300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   34560000
333400         PERFORM DP013-0000-PROCESS-ABEND                         34570000
333500     END-IF.                                                      34580000
333600     EJECT                                                        34590000
333700                                                                  34600000
333800 9026-GET-COMPANY-MDSEAR-DKEY.                                    34610000
333900******************************************************************34620000
334000*                                                                 34630000
334100******************************************************************34640000
334200                                                                  34650000
334300     PERFORM WITH TEST AFTER                                      34660000
334400         VARYING PV-RETRY-COUNTER                                 34670000
334500         FROM 1 BY 1                                              34680000
334600         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              34690000
334700                 OR (SQLCODE = 0)                                 34700000
334800                 OR (SQLCODE = +100))                             34710000
334900                                                                  34720000
335000                                                                  34730000
335100         EXEC SQL                                                 34740000
335200             SELECT MDSEAR_DKEY                                   34750000
335300             INTO :MDSEAR-DKEY                                    34760000
335400             FROM TMDSEAR                                         34770000
335500             WHERE (OPERCO_NBR = :DK-OPERCO-NBR) AND              34780000
335600                   (GMA_NBR    = :DK-GMA-NBR  ) AND               34790000
335700                   (DMA_NBR    = :DK-DMA-NBR  ) AND               34800000
335800                   (DEPT_NBR   = :DK-DEPT-NBR ) AND               34810000
335900                   (MAJ_CL_NBR = :DK-MAJ-CL-NBR) AND              34820000
336000                   (SUB_CL_NBR = :DK-SUB-CL-NBR) AND              34830000
336100                   (MDSELV_CDE = :DK-MDSELV-CDE) AND              34840000
336200                   (END_DTE    > DATE(CURRENT TIMESTAMP))         34850000
336300         END-EXEC                                                 34860000
336400                                                                  34870000
336500         EVALUATE TRUE                                            34880000
336600             WHEN SQLCODE = ZERO                                  34890000
336700                 SET PS-ROW-FOUND TO TRUE                         34900000
336800             WHEN SQLCODE = -904                                  34910000
336900             WHEN SQLCODE = -913                                  34920000
337000                  CONTINUE                                        34930000
337100             WHEN SQLCODE = +100                                  34940000
337200                  CONTINUE                                        34950000
337300             WHEN SQLWARN0 NOT = SPACES                           34960000
337400             WHEN SQLCODE < 0                                     34970000
337500             WHEN SQLCODE > 0                                     34980000
337600                 STRING ' WORKER UID = ' DK-UID-NBR               34990000
337700                        DELIMITED BY SIZE                         35000000
337800                        INTO DP013-MESSAGE-TEXT(2)                35010000
337900                 MOVE SQLCA TO DP013-SQLCA                        35020000
338000                 MOVE '9010-GET-WORKER-INFO' TO                   35030000
338100                     DP013-PARAGRAPH                              35040000
338200                 MOVE 'TWORKER' TO DP013-DB2-TABLE-NAME(2)        35050000
338300                 SET DP013-DB2-ABEND TO TRUE                      35060000
338400                 SET DP013-NO-ROLLBACK TO TRUE                    35070000
338500                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           35080000
338600                 PERFORM DP013-0000-PROCESS-ABEND                 35090000
338700         END-EVALUATE                                             35100000
338800     END-PERFORM.                                                 35110000
338900                                                                  35120000
339000                                                                  35130000
339100     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         35140000
339200         MOVE '9010-GET-WORKER-INFO' TO                           35150000
339300                                     DP013-PARAGRAPH              35160000
339400         STRING ' WORKER ID = ' DK-UID-NBR                        35170000
339500                DELIMITED BY SIZE                                 35180000
339600                                INTO DP013-MESSAGE-TEXT(1)        35190000
339700         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 35200000
339800                                     DP013-MESSAGE-TEXT(2)        35210000
339900         MOVE SQLCA TO DP013-SQLCA                                35220000
340000         MOVE 'TWORKER' TO DP013-DB2-TABLE-NAME(1)                35230000
340100         SET DP013-DB2-ABEND                                      35240000
340200             DP013-NO-ROLLBACK                                    35250000
340300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   35260000
340400         PERFORM DP013-0000-PROCESS-ABEND                         35270000
340500     END-IF.                                                      35280000
340600     EJECT                                                        35290000
340700                                                                  35300000
340800                                                                  35310000
340900 9027-INSERT-DPTSHK-ROW.                                          35320000
341000******************************************************************35330000
341100*    INSERT THE SHRINK PERCENT ROWS.                              35340000
341200******************************************************************35350000
341300                                                                  35360000
341400     PERFORM WITH TEST AFTER                                      35370000
341500         VARYING PV-RETRY-COUNTER                                 35380000
341600         FROM 1 BY 1                                              35390000
341700         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              35400000
341800                 OR (SQLCODE = 0)                                 35410000
341900                 OR (SQLCODE = +100))                             35420000
342000                                                                  35430000
342100                                                                  35440000
342200         EXEC SQL                                                 35450000
342300             INSERT INTO TDPTSHK                                  35460000
342400                (MDSEAR_DKEY                                      35470000
342500               , SHRINK_YR_NBR                                    35480000
342600               , CHG_TMST                                         35490000
342700               , JAN_SHRINK_PCT                                   35500000
342800               , FEB_SHRINK_PCT                                   35510000
342900               , MAR_SHRINK_PCT                                   35520000
343000               , APR_SHRINK_PCT                                   35530000
343100               , MAY_SHRINK_PCT                                   35540000
343200               , JUN_SHRINK_PCT                                   35550000
343300               , JUL_SHRINK_PCT                                   35560000
343400               , AUG_SHRINK_PCT                                   35570000
343500               , SEP_SHRINK_PCT                                   35580000
343600               , OCT_SHRINK_PCT                                   35590000
343700               , NOV_SHRINK_PCT                                   35600000
C14666               , DEC_SHRINK_PCT                                   35610000
C14666               , E_BUS_IND                                        35611000
C14666               , LAST_UPD_BY_USR                                  35613000
C14666                 )                                                35614000
343900             VALUES                                               35620000
344000                 (:DPTSHK-MDSEAR-DKEY                             35630000
344100               ,  :DPTSHK-SHRINK-YR-NBR                           35640000
344200               ,   CURRENT TIMESTAMP                              35650000
344300               ,  :DPTSHK-JAN-SHRINK-PCT                          35660000
344400               ,  :DPTSHK-FEB-SHRINK-PCT                          35670000
344500               ,  :DPTSHK-MAR-SHRINK-PCT                          35680000
344600               ,  :DPTSHK-APR-SHRINK-PCT                          35690000
344700               ,  :DPTSHK-MAY-SHRINK-PCT                          35700000
344800               ,  :DPTSHK-JUN-SHRINK-PCT                          35710000
344900               ,  :DPTSHK-JUL-SHRINK-PCT                          35720000
345000               ,  :DPTSHK-AUG-SHRINK-PCT                          35730000
345100               ,  :DPTSHK-SEP-SHRINK-PCT                          35740000
345200               ,  :DPTSHK-OCT-SHRINK-PCT                          35750000
345300               ,  :DPTSHK-NOV-SHRINK-PCT                          35760000
C14666               ,  :DPTSHK-DEC-SHRINK-PCT                          35770000
C14666               ,  :DPTSHK-E-BUS-IND                               35771000
C14666               ,  :DPTSHK-LAST-UPD-BY-USR                         35773000
C14666                  )                                               35774000
345500         END-EXEC                                                 35780000
345600                                                                  35790000
345700         EVALUATE TRUE                                            35800000
345800             WHEN SQLCODE = ZERO                                  35810000
345900                 SET PS-ROW-FOUND TO TRUE                         35820000
346000             WHEN SQLCODE = -904                                  35830000
346100             WHEN SQLCODE = -913                                  35840000
346200                  CONTINUE                                        35850000
346300             WHEN SQLWARN0 NOT = SPACES                           35860000
346400             WHEN SQLCODE < 0                                     35870000
346500             WHEN SQLCODE > 0                                     35880000
346600                 MOVE ASC-MDSEAR-DKEY TO PV-ERR-DKEY              35890000
346700                 MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT(1)     35900000
346800                 MOVE SQLCA TO DP013-SQLCA                        35910000
346900                 MOVE '9027-INSERT-DPTSHK-ROW' TO                 35920000
347000                     DP013-PARAGRAPH                              35930000
347100                 MOVE 'TDPTSHK' TO DP013-DB2-TABLE-NAME(1)        35940000
347200                 SET DP013-DB2-ABEND TO TRUE                      35950000
347300                 SET DP013-ROLLBACK TO TRUE                       35960000
347400                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           35970000
347500                 PERFORM DP013-0000-PROCESS-ABEND                 35980000
347600         END-EVALUATE                                             35990000
347700     END-PERFORM.                                                 36000000
347800                                                                  36010000
347900                                                                  36020000
348000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         36030000
348100         MOVE ASC-MDSEAR-DKEY TO PV-ERR-DKEY                      36040000
348200         MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT(1)             36050000
348300         MOVE '9027-INSERT-DPTSHK-ROW' TO                         36060000
348400                                     DP013-PARAGRAPH              36070000
348500         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 36080000
348600                                     DP013-MESSAGE-TEXT(2)        36090000
348700         MOVE SQLCA TO DP013-SQLCA                                36100000
348800         MOVE 'TDPTSHK' TO DP013-DB2-TABLE-NAME(1)                36110000
348900         SET DP013-DB2-ABEND                                      36120000
349000             DP013-ROLLBACK                                       36130000
349100             DP013-XCTL-DISPLAY-RESTART TO TRUE                   36140000
349200         PERFORM DP013-0000-PROCESS-ABEND                         36150000
349300     END-IF.                                                      36160000
349400                                                                  36170000
349500/                                                                 36180000
349600 9030-FETCH-APPL-AVAIL-ROW.                                       36190000
349700******************************************************************36200000
349800*    OPEN CURSOR FOR APPLICATION AVAILABILITY TABLE               36210000
349900******************************************************************36220000
350000                                                                  36230000
350100     PERFORM WITH TEST AFTER                                      36240000
350200         VARYING PV-RETRY-COUNTER                                 36250000
350300         FROM 1 BY 1                                              36260000
350400         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              36270000
350500                 OR (SQLCODE = 0)                                 36280000
350600                 OR (SQLCODE = +100))                             36290000
350700                                                                  36300000
350800                                                                  36310000
350900         EXEC SQL                                                 36320000
351000             FETCH APLAVL_CUR                                     36330000
351100             INTO :APLAVL-APLSYS-CDE,                             36340000
351200                  :APLAVL-MDSEAR-DKEY,                            36350000
351300                  :APLAVL-MDSEAR-STRT-DTE,                        36360000
351400                  :APLAVL-MDSEAR-END-DTE                          36370000
351500         END-EXEC                                                 36380000
351600                                                                  36390000
351700         EVALUATE TRUE                                            36400000
351800             WHEN SQLCODE = ZERO                                  36410000
351900                 SET PS-ROW-FOUND TO TRUE                         36420000
352000             WHEN SQLCODE = -904                                  36430000
352100             WHEN SQLCODE = -913                                  36440000
352200                  CONTINUE                                        36450000
352300             WHEN SQLCODE = +100                                  36460000
352400                 SET PS-ROW-NOT-FOUND TO TRUE                     36470000
352500             WHEN SQLWARN0 NOT = SPACES                           36480000
352600             WHEN SQLCODE < 0                                     36490000
352700             WHEN SQLCODE > 0                                     36500000
352800                 MOVE SQLCA TO DP013-SQLCA                        36510000
352900                 MOVE '9030-FETCH-APPL-AVAIL-ROW' TO              36520000
353000                     DP013-PARAGRAPH                              36530000
353100                 MOVE 'TAPLAVL' TO DP013-DB2-TABLE-NAME(1)        36540000
353200                 SET DP013-DB2-ABEND TO TRUE                      36550000
353300                 SET DP013-ROLLBACK TO TRUE                       36560000
353400                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           36570000
353500                 PERFORM DP013-0000-PROCESS-ABEND                 36580000
353600         END-EVALUATE                                             36590000
353700     END-PERFORM.                                                 36600000
353800                                                                  36610000
353900                                                                  36620000
354000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         36630000
354100         MOVE '9030-FETCH-APPL-AVAIL-ROW' TO                      36640000
354200                                     DP013-PARAGRAPH              36650000
354300         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 36660000
354400                                     DP013-MESSAGE-TEXT(2)        36670000
354500         MOVE SQLCA TO DP013-SQLCA                                36680000
354600         MOVE 'TAPLAVL' TO DP013-DB2-TABLE-NAME(1)                36690000
354700         SET DP013-DB2-ABEND                                      36700000
354800             DP013-ROLLBACK                                       36710000
354900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   36720000
355000         PERFORM DP013-0000-PROCESS-ABEND                         36730000
355100     END-IF.                                                      36740000
355200     EJECT                                                        36750000
355300                                                                  36760000
355400 9040-INSERT-APLAVL-ROW.                                          36770000
355500******************************************************************36780000
355600*    INSERT THE APPLICATION AVAILABILITY ROW.                     36790000
355700******************************************************************36800000
355800                                                                  36810000
355900     PERFORM WITH TEST AFTER                                      36820000
356000         VARYING PV-RETRY-COUNTER                                 36830000
356100         FROM 1 BY 1                                              36840000
356200         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              36850000
356300                 OR (SQLCODE = 0)                                 36860000
356400                 OR (SQLCODE = +100)                              36870000
356500                 OR (SQLCODE = -803))                             36880000
356600                                                                  36890000
356700                                                                  36900000
356800         EXEC SQL                                                 36910000
356900             INSERT INTO TAPLAVL                                  36920000
357000             (APLSYS_CDE,                                         36930000
357100              MDSEAR_DKEY,                                        36940000
357200              MDSEAR_STRT_DTE,                                    36950000
357300              MDSEAR_END_DTE,                                     36960000
357400              OPERCO_NBR)                                         36970000
357500              VALUES (:APLAVL-APLSYS-CDE,                         36980000
357600                      :APLAVL-MDSEAR-DKEY,                        36990000
357700                      :APLAVL-MDSEAR-STRT-DTE,                    37000000
357800                      :APLAVL-MDSEAR-END-DTE,                     37010000
357900                      :APLAVL-OPERCO-NBR)                         37020000
358000         END-EXEC                                                 37030000
358100                                                                  37040000
358200         EVALUATE TRUE                                            37050000
358300             WHEN SQLCODE = ZERO                                  37060000
358400                 SET PS-ROW-FOUND TO TRUE                         37070000
358500             WHEN SQLCODE = -904                                  37080000
358600             WHEN SQLCODE = -913                                  37090000
358700                  CONTINUE                                        37100000
358800             WHEN SQLCODE = -803                                  37110000
358900                  SET PS-ROW-NOT-FOUND TO TRUE                    37120000
359000             WHEN SQLCODE = +100                                  37130000
359100             WHEN SQLWARN0 NOT = SPACES                           37140000
359200             WHEN SQLCODE < 0                                     37150000
359300             WHEN SQLCODE > 0                                     37160000
359400                 MOVE SQLCA TO DP013-SQLCA                        37170000
359500                 MOVE '9040-INSERT-APLAVL-ROW' TO                 37180000
359600                       DP013-PARAGRAPH                            37190000
359700                 MOVE 'TAPLAVL' TO DP013-DB2-TABLE-NAME(1)        37200000
359800                 SET DP013-DB2-ABEND TO TRUE                      37210000
359900                 SET DP013-ROLLBACK TO TRUE                       37220000
360000                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           37230000
360100                 PERFORM DP013-0000-PROCESS-ABEND                 37240000
360200         END-EVALUATE                                             37250000
360300     END-PERFORM.                                                 37260000
360400                                                                  37270000
360500                                                                  37280000
360600     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         37290000
360700         MOVE '9040-INSERT-APLAVL-ROW' TO                         37300000
360800                                     DP013-PARAGRAPH              37310000
360900         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 37320000
361000                                     DP013-MESSAGE-TEXT(2)        37330000
361100         MOVE SQLCA TO DP013-SQLCA                                37340000
361200         MOVE 'TAPLAVL' TO DP013-DB2-TABLE-NAME(1)                37350000
361300         SET DP013-DB2-ABEND                                      37360000
361400             DP013-ROLLBACK                                       37370000
361500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   37380000
361600         PERFORM DP013-0000-PROCESS-ABEND                         37390000
361700     END-IF.                                                      37400000
361800     EJECT                                                        37410000
361900 9041-CLOSE-APLAVL-CURSOR.                                        37420000
362000******************************************************************37430000
362100*   CLOSE CURSOR FOR APPLICATION AVAILABILITY TABLE               37440000
362200******************************************************************37450000
362300                                                                  37460000
362400     PERFORM WITH TEST AFTER                                      37470000
362500         VARYING PV-RETRY-COUNTER                                 37480000
362600         FROM 1 BY 1                                              37490000
362700         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              37500000
362800                 OR (SQLCODE = 0)                                 37510000
362900                 OR (SQLCODE = +100))                             37520000
363000                                                                  37530000
363100                                                                  37540000
363200         EXEC SQL                                                 37550000
363300             CLOSE APLAVL_CUR                                     37560000
363400         END-EXEC                                                 37570000
363500                                                                  37580000
363600         EVALUATE TRUE                                            37590000
363700             WHEN SQLCODE = ZERO                                  37600000
363800                 SET PS-ROW-FOUND TO TRUE                         37610000
363900             WHEN SQLCODE = -904                                  37620000
364000             WHEN SQLCODE = -913                                  37630000
364100                  CONTINUE                                        37640000
364200             WHEN SQLWARN0 NOT = SPACES                           37650000
364300             WHEN SQLCODE < 0                                     37660000
364400             WHEN SQLCODE > 0                                     37670000
364500                 MOVE SQLCA TO DP013-SQLCA                        37680000
364600                 MOVE '9041-CLOSE-APLAVL-CURSOR' TO               37690000
364700                     DP013-PARAGRAPH                              37700000
364800                 MOVE 'TAPLAVL' TO DP013-DB2-TABLE-NAME(1)        37710000
364900                 SET DP013-DB2-ABEND TO TRUE                      37720000
365000                 SET DP013-ROLLBACK TO TRUE                       37730000
365100                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           37740000
365200                 PERFORM DP013-0000-PROCESS-ABEND                 37750000
365300         END-EVALUATE                                             37760000
365400     END-PERFORM.                                                 37770000
365500                                                                  37780000
365600                                                                  37790000
365700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         37800000
365800         MOVE '9041-CLOSE-APLAVL-CURSOR' TO                       37810000
365900                                     DP013-PARAGRAPH              37820000
366000         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 37830000
366100                                     DP013-MESSAGE-TEXT(2)        37840000
366200         MOVE SQLCA TO DP013-SQLCA                                37850000
366300         MOVE 'TAPLAVL' TO DP013-DB2-TABLE-NAME(1)                37860000
366400         SET DP013-DB2-ABEND                                      37870000
366500             DP013-ROLLBACK                                       37880000
366600             DP013-XCTL-DISPLAY-RESTART TO TRUE                   37890000
366700         PERFORM DP013-0000-PROCESS-ABEND                         37900000
366800     END-IF.                                                      37910000
366900     EJECT                                                        37920000
367000 9050-READ-TSQ.                                                   37930000
367100******************************************************************37940000
367200*    READ TEMPORARY STORAGE QUEUE                                 37950000
367300******************************************************************37960000
367400     EXEC CICS                                                    37970000
367500         READQ TS                                                 37980000
367600         QUEUE(ASC-TEMP-QUEUE-NAME)                               37990000
367700         INTO (MB104-MDSEAR-ADD-TSQUEUE)                          38000000
367800         LENGTH(ASC-TEMP-QUEUE-LENGTH)                            38010000
367900         ITEM(ASC-TSQ-ITEM-NBR)                                   38020000
368000         RESP(PV-CICS-RESPONSE)                                   38030000
368100     END-EXEC.                                                    38040000
368200                                                                  38050000
368300     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    38060000
368400         SET DP013-LOGIC-ABEND  TO TRUE                           38070000
368500         SET DP013-NO-ROLLBACK  TO TRUE                           38080000
368600         MOVE '9050-READ-TSQ'   TO DP013-PARAGRAPH                38090000
368700         MOVE 'RECEIVED ERROR MESSAGE WHILE READING TSQ' TO       38100000
368800                                      DP013-MESSAGE-TEXT(1)       38110000
368900         PERFORM DP013-0000-PROCESS-ABEND                         38120000
369000     END-IF.                                                      38130000
369100 EJECT                                                            38140000
369200                                                                  38150000
369300                                                                  38160000
369400 9999-RETURN-TO-PREV-TRAN.                                        38170000
369500******************************************************************38180000
369600*                                                                 38190000
369700******************************************************************38200000
369800     MOVE DP016-PF3  TO DP020-SRC-AID.                            38210000
369900                                                                  38220000
370000                                                                  38230000
370100 EJECT                                                            38240000
370200                                                                  38250000
370300 9900-COMMIT.                                                     38260000
370400     EXEC CICS                                                    38270000
370500         SYNCPOINT                                                38280000
370600     END-EXEC.                                                    38290000
370700                                                                  38300000
370800                                                                  38310000
370900 EJECT                                                            38320000
371000                                                                  38330000
371100******************************************************************38340000
371200*    FILL IN SCREEN HEADER MODULE                                 38350000
371300******************************************************************38360000
371400                                                                  38370000
371500     COPY DPPD002.                                                38380000
371600 EJECT                                                            38390000
371700******************************************************************38400000
371800*    RETURN TO CICS MODULE                                        38410000
371900******************************************************************38420000
372000                                                                  38430000
372100     COPY DPPD003.                                                38440000
372200 EJECT                                                            38450000
372300******************************************************************38460000
372400*    FORMAT MESSAGE LINES MODULE                                  38470000
372500******************************************************************38480000
372600                                                                  38490000
372700     COPY DPPD005.                                                38500000
372800 EJECT                                                            38510000
372900******************************************************************38520000
373000*    GET PANEL MODULE                                             38530000
373100******************************************************************38540000
373200                                                                  38550000
373300     COPY DPPD007.                                                38560000
373400 EJECT                                                            38570000
373500******************************************************************38580000
373600*    WRITE PANEL MODULE                                           38590000
373700******************************************************************38600000
373800                                                                  38610000
373900     COPY DPPD008.                                                38620000
374000 EJECT                                                            38630000
374100******************************************************************38640000
374200*    TOGGLE THE FUNCTION KEY LINE MODULE                          38650000
374300******************************************************************38660000
374400                                                                  38670000
374500     COPY DPPD009.                                                38680000
374600 EJECT                                                            38690000
374700******************************************************************38700000
374800*    ABEND PROCESSOR MODULE                                       38710000
374900******************************************************************38720000
375000                                                                  38730000
375100     COPY DPPD013.                                                38740000
375200 EJECT                                                            38750000
375300******************************************************************38760000
375400*    CHECK COMMUNICATION AREA MODULE                              38770000
375500******************************************************************38780000
375600                                                                  38790000
375700     COPY DPPD015.                                                38800000
375800 EJECT                                                            38810000
375900******************************************************************38820000
376000*    UPDATE TIME AND DATE MODULE                                  38830000
376100******************************************************************38840000
376200                                                                  38850000
376300     COPY DPPD017.                                                38860000
376400 EJECT                                                            38870000
