000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.             DLKRP001.                                00020061
000300 AUTHOR.                 PAUL JORGENSEN.                          00030061
000400 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040000
000500 DATE-WRITTEN.           APRIL, 2009.                             00050080
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800* THIS WILL PRODUCE THE 'DAILY LABOR ASSIGNMENTS REPORT'          00080061
001000                                                                  00100000
001100 ENVIRONMENT DIVISION.                                            00110000
001200 CONFIGURATION SECTION.                                           00120000
001300 SOURCE-COMPUTER.                        IBM-3090.                00130000
001400 OBJECT-COMPUTER.                        IBM-3090.                00140000
001500 INPUT-OUTPUT SECTION.                                            00150000
001600 FILE-CONTROL.                                                    00160000
002300                                                                  00170062
002100     SELECT  REPORT-FILE                                          00210000
002200         ASSIGN TO RPT01.                                         00220000
002300                                                                  00230000
002400 DATA DIVISION.                                                   00240000
002500 FILE SECTION.                                                    00250000
003200                                                                  00320000
003300 FD  REPORT-FILE                                                  00330000
003400     RECORDING MODE IS F                                          00340000
003500     LABEL RECORDS ARE STANDARD                                   00350000
003600     BLOCK CONTAINS 0 RECORDS.                                    00360000
003700 01  REPORT-RECORD                    PIC X(200).                 00370074
003800/                                                                 00380000
003900 WORKING-STORAGE SECTION.                                         00390000
004000 01  PS-SWITCHES.                                                 00400000
004100     05  PS-END-OF-CSR-SW             PIC X(01) VALUE 'N'.        00410070
004200         88  PS-END-OF-CSR                      VALUE 'Y'.        00420070
004100     05  PS-KOHLS-USR-ID-SW           PIC X(01) VALUE SPACE.      00421099
004200         88  PS-KOHLS-USR-ID                    VALUE 'K'.        00422099
004200         88  PS-TMP-USR-ID                      VALUE 'T'.        00423099
004300                                                                  00430000
004400 01  DK-DB-KEYS.                                                  00440000
004500     05  DK-STORE-NBR                 PIC S9(04) COMP VALUE ZERO. 00450000
004600     05  DK-LINE-NBR                  PIC S9(09) COMP VALUE ZERO. 00460000
004700                                                                  00470000
004800 01  ABEND-CODE                       PIC S9(04) VALUE ZERO       00480000
004900                                                 COMP SYNC.       00490000
005000     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 00500000
005100                                                                  00510000
       01  PD-PROCESSING-DATE.                                          00510172
018500     05  PD-PROCESS-DATE              PIC X(10) VALUE SPACES.     00511076
018600     05  PD-PROCESS-DATE-8            PIC X(08) VALUE SPACES.     00512076
                                                                        00513072
005200 01  SD-SYSTEM-DATE.                                              00520000
005300     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00530000
005400     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00540000
005500     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00550000
005600                                                                  00560000
005700 01  ST-SYSTEM-TIME.                                              00570000
005800     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00580000
005900     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00590000
006000     05  FILLER                     PIC  9(04)   VALUE ZERO.      00600000
006100                                                                  00610000
004200 01  DN-NULL-INDICATORS.                                          00611099
004300     05  DN-ASGMT-STOP-NULL-IND       PIC S9(04)  VALUE ZERO      00612099
004400                                                     COMP SYNC.   00613099
004300     05  DN-LVE-TMST-NULL-IND         PIC S9(04)  VALUE ZERO      00613199
004400                                                     COMP SYNC.   00613299
004300     05  DN-KOHLS-NULL-IND            PIC S9(04)  VALUE ZERO      00613399
004400                                                     COMP SYNC.   00613499
004500     05  DN-TMP-NULL-IND              PIC S9(04)  VALUE ZERO      00614099
004600                                                     COMP SYNC.   00615099
006200 01  PV-VARIABLES.                                                00620000
006300     05  PV-DB2-TMST                  PIC X(26) VALUE SPACES.     00630099
006400     05  PV-ASGMT-USER-COUNT          PIC S9(7) COMP-3            00631099
006500                                                VALUE ZERO.       00632099
006400     05  PV-READ-COUNT                PIC S9(7) COMP-3            00640000
006500                                                VALUE ZERO.       00650000
006600     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00660000
006700                                                VALUE ZERO.       00670000
006800     05  PV-PAGE-COUNT                PIC S9(7) COMP-3            00680000
006900                                                VALUE ZERO.       00690000
007000     05  PV-LINES-USED                PIC S9(4) COMP-3            00700000
007100                                                VALUE ZERO.       00710000
007000     05  PV-MINUTES-CALC              PIC S9(3) COMP-3            00711099
007100                                                VALUE ZERO.       00712099
007200     05  PV-RETRY-COUNTER             PIC S9(04) VALUE ZERO       00720000
007300                                                 COMP SYNC.       00730000
007400     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     00740000
007500     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     00750000
007600     05  PV-DISP-NUMBER               PIC Z,ZZZ,ZZ9.              00760000
007610     05  PV-DISP-LOC                  PIC ZZZ9.                   00761054
007700     05  PV-DISP-COUNT                PIC Z,ZZZ,ZZZ,ZZ9.          00770000
           05  PV-JOIN-LEAVE-TIME           PIC S9(9) COMP.             00771099
           05  PV-JOIN-LEAVE-TIME-1-6       PIC 9(6).                   00771199
           05  FILLER REDEFINES PV-JOIN-LEAVE-TIME-1-6.                 00771299
               10  PV-JOIN-LEAVE-1-2        PIC 9(2).                   00771399
               10  PV-JOIN-LEAVE-3-4        PIC 9(2).                   00771499
               10  PV-JOIN-LEAVE-5-6        PIC 9(2).                   00771599
           05  PV-ASGMT-OPEN-TIME           PIC S9(9) COMP.             00772099
           05  PV-ASGMT-OPEN-TIME-1-6       PIC 9(6).                   00773099
           05  FILLER REDEFINES PV-ASGMT-OPEN-TIME-1-6.                 00773199
               10  PV-ASGMT-OPEN-1-2        PIC 9(2).                   00774099
               10  PV-ASGMT-OPEN-3-4        PIC 9(2).                   00775099
               10  PV-ASGMT-OPEN-5-6        PIC 9(2).                   00775199
           05  PV-MINUTES-SECONDS.                                      00776099
               10  PV-MINUTES               PIC ZZZ.                    00777099
               10  FILLER                   PIC X(1)  VALUE ':'.        00778099
               10  PV-SECONDS               PIC 99.                     00779099
007800     05  PV-SAVE-DC-NBR               PIC 9(04) COMP VALUE ZERO.  00780076
007900     05  PV-SAVE-USER-ID              PIC X(08)      VALUE SPACES.00790076
009000                                                                  00900000
009100     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     00910000
009200     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     00920000
009220     05  PV-TMST.                                                 00922099
009230         10  PV-DATE                    PIC X(10).                00923099
009250         10  FILLER                     PIC X(01).                00925051
009260         10  PV-TIME                    PIC X(08).                00926099
009600         10  FILLER                     PIC X(07).                00960099
009800     05  PV-KEY-DATE.                                             00980051
009900         10  PV-KEY-MM               PIC X(02).                   00990051
010000         10  PV-KEY-SLASH-1          PIC X(01) VALUE '/'.         01000060
010100         10  PV-KEY-DD               PIC X(02).                   01010051
010200         10  PV-KEY-SLASH-2          PIC X(01) VALUE '/'.         01020060
010300         10  PV-KEY-YY               PIC X(02).                   01030051
012001                                                                  01200151
012002 01  PC-CONSTANTS.                                                01200200
012003     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'DLKRP001'. 01200361
012004     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE +75. 01200499
012005     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3  COMP.  01200500
012006                                                                  01200600
012007***  STANDARD REPORT HEADER FOR 200 COLUMN REPORT                 01200763
012008     COPY DPWS200O.                                               01200863
012009                                                                  01200900
012700 01  HL-HEADING-LINE-1.                                           01270000
012800     05  FILLER                      PIC  X(88)  VALUE SPACES.    01280099
012900     05  FILLER                      PIC  X(25)  VALUE            01290099
013000      'DAILY LABOR ASSIGNMENTS '.                                 01300067
015900 01  HL-HEADING-LINE-2.                                           01301099
016000     05  FILLER                      PIC  X(02) VALUE  SPACES.    01302099
016100     05  FILLER                      PIC  X(03) VALUE             01303099
               'DC '.                                                   01304099
           05  HL2-DC-NBR                  PIC  9(04).                  01304199
016300     05  FILLER                      PIC  X(01) VALUE  SPACES.    01305099
016501     05  FILLER                      PIC  X(05) VALUE  SPACES.    01308099
016502     05  FILLER                      PIC  X(04) VALUE  SPACES.    01309099
016504     05  FILLER                      PIC  X(12) VALUE  SPACES.    01309299
016505     05  FILLER                      PIC  X(04) VALUE  SPACES.    01309399
016507     05  FILLER                      PIC  X(17) VALUE  SPACES.    01309599
016508     05  FILLER                      PIC  X(16) VALUE  SPACES.    01309699
016510     05  FILLER                      PIC  X(04) VALUE  SPACES.    01309799
016511     05  FILLER                      PIC  X(15) VALUE  SPACES.    01309899
016600     05  FILLER                      PIC  X(06) VALUE  SPACES.    01309999
016700     05  FILLER                      PIC  X(05) VALUE  SPACES.    01310099
016900     05  FILLER                      PIC  X(02) VALUE  SPACES.    01310199
017000     05  FILLER                      PIC  X(05) VALUE  SPACES.    01310299
017200     05  FILLER                      PIC  X(01) VALUE  SPACES.    01310499
017300     05  FILLER                      PIC  X(06) VALUE  SPACES.    01310599
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    01310699
017600     05  FILLER                      PIC  X(05) VALUE  SPACES.    01310799
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    01310899
017600     05  FILLER                      PIC  X(09) VALUE  SPACES.    01310999
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    01311099
017600     05  FILLER                      PIC  X(09) VALUE  SPACES.    01311199
017500     05  FILLER                      PIC  X(02) VALUE  SPACES.    01311299
017600     05  FILLER                      PIC  X(10) VALUE  SPACES.    01311399
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    01311499
017600     05  FILLER                      PIC  X(10) VALUE  SPACES.    01311599
017800     05  FILLER                      PIC  X(07) VALUE  SPACES.    01311799
017800     05  FILLER                      PIC  X(10) VALUE  SPACES.    01311999
015900 01  HL-HEADING-LINE-2-A.                                         01312199
016000     05  FILLER                      PIC  X(02) VALUE  SPACES.    01312299
016100     05  FILLER                      PIC  X(07) VALUE  SPACES.    01312399
016300     05  FILLER                      PIC  X(01) VALUE  SPACES.    01312699
016501     05  FILLER                      PIC  X(05) VALUE  SPACES.    01312899
016502     05  FILLER                      PIC  X(04) VALUE  SPACES.    01312999
016504     05  FILLER                      PIC  X(12) VALUE  SPACES.    01313099
016505     05  FILLER                      PIC  X(04) VALUE  SPACES.    01313199
016507     05  FILLER                      PIC  X(17) VALUE  SPACES.    01313299
016508     05  FILLER                      PIC  X(16) VALUE  SPACES.    01313399
016510     05  FILLER                      PIC  X(04) VALUE  SPACES.    01313499
016511     05  FILLER                      PIC  X(15) VALUE  SPACES.    01313599
016600     05  FILLER                      PIC  X(06) VALUE  SPACES.    01313699
016700     05  FILLER                      PIC  X(05) VALUE  SPACES.    01313799
016900     05  FILLER                      PIC  X(02) VALUE  SPACES.    01313899
017000     05  FILLER                      PIC  X(05) VALUE             01313999
017100         'ASGMT'.                                                 01314099
017200     05  FILLER                      PIC  X(01) VALUE  SPACES.    01314199
017300     05  FILLER                      PIC  X(06) VALUE  SPACES.    01314299
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    01314399
017600     05  FILLER                      PIC  X(05) VALUE  SPACES.    01314499
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    01314599
017600     05  FILLER                      PIC  X(09) VALUE  SPACES.    01314699
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    01314799
017600     05  FILLER                      PIC  X(09) VALUE  SPACES.    01314899
017500     05  FILLER                      PIC  X(02) VALUE  SPACES.    01314999
017600     05  FILLER                      PIC  X(10) VALUE  SPACES.    01315099
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    01315199
017600     05  FILLER                      PIC  X(10) VALUE  SPACES.    01315299
017800     05  FILLER                      PIC  X(07) VALUE             01315399
017700         'ASSOC  '.                                               01315499
017800     05  FILLER                      PIC  X(10) VALUE             01315599
017700         'ASSOC     '.                                            01315699
015900 01  HL-HEADING-LINE-3.                                           01316099
016000     05  FILLER                      PIC  X(02) VALUE  SPACES.    01320099
016100     05  FILLER                      PIC  X(03) VALUE             01330099
016200         '   '.                                                   01340099
016300     05  FILLER                      PIC  X(01) VALUE  SPACES.    01350099
016400     05  FILLER                      PIC  X(04) VALUE             01360099
016500         '    '.                                                  01370099
016501     05  FILLER                      PIC  X(05) VALUE  SPACES.    01380099
016502     05  FILLER                      PIC  X(04) VALUE             01390099
016503         'WORK'.                                                  01400099
016504     05  FILLER                      PIC  X(12) VALUE  SPACES.    01410099
016505     05  FILLER                      PIC  X(04) VALUE             01420099
016503         'WORK'.                                                  01430099
016507     05  FILLER                      PIC  X(17) VALUE  SPACES.    01440099
016508     05  FILLER                      PIC  X(16) VALUE  SPACES.    01450099
016510     05  FILLER                      PIC  X(04) VALUE  SPACES.    01460099
016511     05  FILLER                      PIC  X(15) VALUE  SPACES.    01470099
016600     05  FILLER                      PIC  X(06) VALUE  SPACES.    01480099
016700     05  FILLER                      PIC  X(05) VALUE  SPACES.    01490099
016900     05  FILLER                      PIC  X(02) VALUE  SPACES.    01510099
017000     05  FILLER                      PIC  X(04) VALUE             01520099
017100         'STOP'.                                                  01530099
017200     05  FILLER                      PIC  X(02) VALUE  SPACES.    01540099
017300     05  FILLER                      PIC  X(06) VALUE  SPACES.    01550099
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    01560099
017600     05  FILLER                      PIC  X(05) VALUE  SPACES.    01570099
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    01590099
017600     05  FILLER                      PIC  X(09) VALUE  SPACES.    01600099
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    01620099
017600     05  FILLER                      PIC  X(09) VALUE  SPACES.    01630099
017500     05  FILLER                      PIC  X(02) VALUE  SPACES.    01650099
017600     05  FILLER                      PIC  X(10) VALUE  SPACES.    01660099
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    01680099
017600     05  FILLER                      PIC  X(10) VALUE  SPACES.    01690099
017800     05  FILLER                      PIC  X(07) VALUE             01720099
017700         ' TIME  '.                                               01730099
017800     05  FILLER                      PIC  X(10) VALUE             01740099
017700         'LVE       '.                                            01750099
015900 01  HL-HEADING-LINE-4.                                           01800099
016000     05  FILLER                      PIC  X(02) VALUE  SPACES.    01810099
016100     05  FILLER                      PIC  X(03) VALUE             01820099
016200         ' DC'.                                                   01830099
016300     05  FILLER                      PIC  X(01) VALUE  SPACES.    01840099
016400     05  FILLER                      PIC  X(04) VALUE             01850099
016500         'USER'.                                                  01860099
016501     05  FILLER                      PIC  X(05) VALUE  SPACES.    01870099
016502     05  FILLER                      PIC  X(04) VALUE             01880099
016503         'TYPE'.                                                  01890099
016504     05  FILLER                      PIC  X(12) VALUE  SPACES.    01900099
016505     05  FILLER                      PIC  X(04) VALUE             01910099
016503         'AREA'.                                                  01920099
016507     05  FILLER                      PIC  X(17) VALUE  SPACES.    01930099
016508     05  FILLER                      PIC  X(16) VALUE  SPACES.    01940099
016510     05  FILLER                      PIC  X(04) VALUE  SPACES.    01960099
016511     05  FILLER                      PIC  X(15) VALUE  SPACES.    01970099
016600     05  FILLER                      PIC  X(06) VALUE  SPACES.    01990099
016700     05  FILLER                      PIC  X(05) VALUE             02000099
016800         'ASGMT'.                                                 02010099
016900     05  FILLER                      PIC  X(02) VALUE  SPACES.    02020099
017000     05  FILLER                      PIC  X(03) VALUE             02030099
017100         'RSN'.                                                   02040099
017200     05  FILLER                      PIC  X(02) VALUE  SPACES.    02050099
017300     05  FILLER                      PIC  X(06) VALUE  SPACES.    02060099
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    02080099
017600     05  FILLER                      PIC  X(05) VALUE             02090099
017700         'TEAM '.                                                 02100099
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    02110099
017600     05  FILLER                      PIC  X(09) VALUE             02120099
017700         '         '.                                             02130099
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    02140099
017600     05  FILLER                      PIC  X(09) VALUE             02150099
017700         '         '.                                             02160099
017500     05  FILLER                      PIC  X(02) VALUE  SPACES.    02170099
017600     05  FILLER                      PIC  X(10) VALUE             02180099
017700         '          '.                                            02190099
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    02200099
017600     05  FILLER                      PIC  X(10) VALUE             02210099
017700         '          '.                                            02220099
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    02230099
017800     05  FILLER                      PIC  X(07) VALUE             02240099
017700         '   ON  '.                                               02250099
017800     05  FILLER                      PIC  X(10) VALUE             02260099
017700         'RSN       '.                                            02270099
015900 01  HL-HEADING-LINE-5.                                           02341699
016000     05  FILLER                      PIC  X(02) VALUE  SPACES.    02341799
016100     05  FILLER                      PIC  X(03) VALUE             02341899
016200         'NBR'.                                                   02341999
016300     05  FILLER                      PIC  X(01) VALUE  SPACES.    02342099
016400     05  FILLER                      PIC  X(02) VALUE             02343099
016500         'ID'.                                                    02344099
016501     05  FILLER                      PIC  X(07) VALUE  SPACES.    02345099
016502     05  FILLER                      PIC  X(04) VALUE             02346099
016503         'DESC'.                                                  02347099
016504     05  FILLER                      PIC  X(12) VALUE  SPACES.    02348099
016505     05  FILLER                      PIC  X(04) VALUE             02349099
016503         'DESC'.                                                  02350099
016507     05  FILLER                      PIC  X(17) VALUE  SPACES.    02351099
016508     05  FILLER                      PIC  X(16) VALUE             02352099
016509         'ASSIGNMENT START'.                                      02353099
016510     05  FILLER                      PIC  X(04) VALUE  SPACES.    02354099
016511     05  FILLER                      PIC  X(15) VALUE             02355099
016512         'ASSIGNMENT STOP'.                                       02356099
016600     05  FILLER                      PIC  X(07) VALUE  SPACES.    02357099
016700     05  FILLER                      PIC  X(04) VALUE             02358099
016800         'OPEN'.                                                  02359099
016900     05  FILLER                      PIC  X(02) VALUE  SPACES.    02359199
017000     05  FILLER                      PIC  X(03) VALUE             02359299
017100         'CDE'.                                                   02359399
017200     05  FILLER                      PIC  X(02) VALUE  SPACES.    02359499
017300     05  FILLER                      PIC  X(06) VALUE             02359599
017400         'EVENTS'.                                                02359699
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    02359799
017600     05  FILLER                      PIC  X(05) VALUE             02359899
017700         'ASGMT'.                                                 02359999
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    02360099
017600     05  FILLER                      PIC  X(09) VALUE             02360199
017700         'JOIN DATE'.                                             02360299
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    02360399
017600     05  FILLER                      PIC  X(09) VALUE             02360499
017700         'JOIN TIME'.                                             02360599
017500     05  FILLER                      PIC  X(02) VALUE  SPACES.    02360699
017600     05  FILLER                      PIC  X(10) VALUE             02360799
017700         'LEAVE DATE'.                                            02360899
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    02360999
017600     05  FILLER                      PIC  X(10) VALUE             02361099
017700         'LEAVE TIME'.                                            02361199
017500     05  FILLER                      PIC  X(01) VALUE  SPACES.    02361299
017800     05  FILLER                      PIC  X(07) VALUE             02361399
017700         'ASGMT  '.                                               02361499
017800     05  FILLER                      PIC  X(10) VALUE             02361599
017700         'CDE       '.                                            02361699
019800 01  HL-HEADING-LINE-6.                                           02361799
024200     05  FILLER                      PIC  X(01) VALUE  SPACES.    02361899
024201     05  FILLER                      PIC  X(04) VALUE             02361999
               '----'.                                                  02362099
024202     05  FILLER                      PIC  X(01) VALUE  SPACES.    02362199
024203     05  FILLER                      PIC  X(08) VALUE             02363099
               '--------'.                                              02363199
024204     05  FILLER                      PIC  X(01) VALUE  SPACES.    02364099
024205     05  FILLER                      PIC  X(15) VALUE             02365099
               '---------------'.                                       02365199
024206     05  FILLER                      PIC  X(01) VALUE  SPACES.    02366099
024207     05  FILLER                      PIC  X(20) VALUE             02367099
               '--------------------'.                                  02367199
025500     05  FILLER                      PIC  X(01) VALUE  SPACES.    02367299
025600     05  FILLER                      PIC  X(10) VALUE             02367399
               '----------'.                                            02367499
025801     05  FILLER                      PIC  X(01) VALUE  SPACES.    02367599
025802     05  FILLER                      PIC  X(08) VALUE             02367699
               '--------'.                                              02367799
025803     05  FILLER                      PIC  X(01) VALUE  SPACES.    02367899
025600     05  FILLER                      PIC  X(10) VALUE             02367999
               '----------'.                                            02368099
025801     05  FILLER                      PIC  X(01) VALUE  SPACES.    02368199
025802     05  FILLER                      PIC  X(08) VALUE             02368299
               '--------'.                                              02368399
025808     05  FILLER                      PIC  X(01) VALUE  SPACES.    02368499
025809     05  FILLER                      PIC  X(06) VALUE             02368599
               '------'.                                                02368699
025810     05  FILLER                      PIC  X(01) VALUE  SPACES.    02368799
025811     05  FILLER                      PIC  X(05) VALUE             02368899
               '-----'.                                                 02368999
025812     05  FILLER                      PIC  X(01) VALUE  SPACES.    02369099
025813     05  FILLER                      PIC  X(01) VALUE             02369199
               '-'.                                                     02369299
025814     05  FILLER                      PIC  X(06) VALUE SPACES.     02369399
026202     05  FILLER                      PIC  X(01) VALUE             02369499
               '-'.                                                     02369599
026203     05  FILLER                      PIC  X(05) VALUE  SPACES.    02369699
026204     05  FILLER                      PIC  X(10) VALUE             02369799
               '----------'.                                            02369899
026205     05  FILLER                      PIC  X(01) VALUE  SPACES.    02369999
026400     05  FILLER                      PIC  X(08) VALUE             02370099
               '--------'.                                              02370199
026401     05  FILLER                      PIC  X(02) VALUE  SPACES.    02370299
026402     05  FILLER                      PIC  X(10) VALUE             02370399
               '----------'.                                            02370499
026403     05  FILLER                      PIC  X(01) VALUE  SPACES.    02370599
026404     05  FILLER                      PIC  X(08) VALUE             02370699
               '--------'.                                              02370799
026500     05  FILLER                      PIC  X(02) VALUE  SPACES.    02370899
026600     05  FILLER                      PIC  X(06) VALUE             02370999
               '------'.                                                02371099
026601     05  FILLER                      PIC  X(02) VALUE  SPACES.    02371199
026602     05  FILLER                      PIC  X(05) VALUE             02371299
               '-----'.                                                 02371399
023600                                                                  02372000
023700 01  DL-DETAIL-LINE-1.                                            02380000
024200     05  FILLER                      PIC  X(01) VALUE  SPACES.    02420000
024201     05  DL-DC-NBR                   PIC  ZZ99.                   02420299
024202     05  FILLER                      PIC  X(01) VALUE  SPACES.    02420300
024203     05  DL-USER-ID                  PIC  X(08).                  02420465
024204     05  FILLER                      PIC  X(01) VALUE  SPACES.    02420500
024205     05  DL-WORK-TYPE-DESC           PIC  X(15).                  02420665
024206     05  FILLER                      PIC  X(01) VALUE  SPACES.    02420700
024207     05  DL-WORK-AREA-DESC           PIC  X(20).                  02420867
025500     05  FILLER                      PIC  X(01) VALUE  SPACES.    02550000
025600     05  DL-ASGMT-START-DATE         PIC  X(10).                  02560066
025801     05  FILLER                      PIC  X(01) VALUE  SPACES.    02580151
025802     05  DL-ASGMT-START-TIME         PIC  X(08).                  02580266
025803     05  FILLER                      PIC  X(01) VALUE  SPACES.    02580300
025600     05  DL-ASGMT-STOP-DATE          PIC  X(10).                  02580466
025801     05  FILLER                      PIC  X(01) VALUE  SPACES.    02580566
025802     05  DL-ASGMT-STOP-TIME          PIC  X(08).                  02580666
025808     05  FILLER                      PIC  X(01) VALUE  SPACES.    02580800
025809     05  DL-ASGMT-OPEN-TIME          PIC  X(06).                  02580998
025810     05  FILLER                      PIC  X(01) VALUE  SPACES.    02581000
025811     05  DL-ASGMT-STOP-RSN-CDE       PIC  X(05).                  02581166
025812     05  FILLER                      PIC  X(01) VALUE  SPACES.    02581498
025813     05  DL-EVENTS                   PIC  X(01).                  02581566
025814     05  FILLER                      PIC  X(06) VALUE SPACES.     02581666
026202     05  DL-TEAM-ASGMT               PIC  X(01).                  02620299
026203     05  FILLER                      PIC  X(05) VALUE  SPACES.    02620399
026204     05  DL-JOIN-DATE                PIC  X(10).                  02620466
026205     05  FILLER                      PIC  X(01) VALUE  SPACES.    02620500
026400     05  DL-JOIN-TIME                PIC  X(08).                  02640066
026401     05  FILLER                      PIC  X(02) VALUE  SPACES.    02640199
026402     05  DL-LEAVE-DATE               PIC  X(10).                  02640266
026403     05  FILLER                      PIC  X(01) VALUE  SPACES.    02640300
026404     05  DL-LEAVE-TIME               PIC  X(08).                  02640466
026500     05  FILLER                      PIC  X(02) VALUE  SPACES.    02650099
026600     05  DL-JOIN-LEAVE-TIME          PIC  X(06).                  02660098
026601     05  FILLER                      PIC  X(02) VALUE  SPACES.    02660199
026602     05  DL-ASSOC-LEAVE-RSN-CDE      PIC  X(05).                  02660266
026601     05  FILLER                      PIC  X(01) VALUE  SPACES.    02660396
028100                                                                  02810003
028200 01  EP-EMPTY-REPORT-LINE.                                        02820003
028300     05  FILLER                       PIC X(54)  VALUE SPACES.    02830000
028400     05  FILLER                       PIC X(25)  VALUE            02840000
028500         '******* NO DATA *********'.                             02850000
028600     05  FILLER                       PIC X(54)  VALUE SPACES.    02860000
028700 01  DL-BLANK-LINE                    PIC X(200) VALUE SPACES.    02870066
028800                                                                  02880000
028900 01  END-OF-REPORT-LINE.                                          02890000
029000     05  FILLER                  PIC  X(74)    VALUE SPACES.      02900099
029100     05  FILLER                  PIC  X(45)    VALUE              02910000
029200          '*******   E N D   O F   R E P O R T   *******'.        02920000
029300     05  FILLER                  PIC  X(43)    VALUE SPACES.      02930000
029400/                                                                 02940000
011800*                                                                 02950072
005800****************************************************************  02950172
      *    COMPANY CONTROL TABLE                                        02950272
011900     EXEC SQL                                                     02950372
012000          INCLUDE TCOCNTL                                         02950472
012100     END-EXEC.                                                    02950572
012200*                                                                 02950672
005800****************************************************************  02951071
005900*    DLT00003 - DLT_TEM_ASGMT                                  *  02952071
006000*    DLT00004 - DLT_ASGMT                                      *  02953071
006100*                                                              *  02954071
006200****************************************************************  02955071
006300                                                                  02956071
006400     EXEC SQL                                                     02957071
006500         INCLUDE DLT00004                                         02958071
006600     END-EXEC.                                                    02959071
006700                                                                  02959171
006800     EXEC SQL                                                     02959271
006900         INCLUDE DLT00003                                         02959371
007000     END-EXEC.                                                    02959471
007100                                                                  02959571
007900******************************************************************02959699
008000** DB2 FORMATTED MESSAGE AREA                                   **02959799
008100******************************************************************02959899
008200     COPY DPWS004.                                                02959999
008300*                                                                 02960099
008400*                                                                 02960199
029600     COPY SQLCA2.                                                 02961000
029700                                                                  02970000
029800     EXEC SQL                                                     02980000
029900         INCLUDE SQLCA                                            02990000
030000     END-EXEC.                                                    03000000
033600*----------------------------------------------------------------*03360000
033700*    CURSOR TO RETRIEVE ASSIGNMENTS                               03370062
033800*----------------------------------------------------------------*03380000
033900     EXEC SQL                                                     03390000
034000          DECLARE ASGMT-CSR CURSOR FOR                            03400062
           SELECT A.ASGMT_STRT_DTE                                      03410090
                , A.ASGMT_NBR_TXT                                       03411090
                , A.ASGMT_NBR_SEQ_NBR                                   03412091
                , A.ASGMT_STRT_TM                                       03420062
                , A.WK_TYP_DESC                                         03430090
                , A.WK_AREA_DESC                                        03431090
                , A.DC_NBR                                              03432090
                , A.ASGMT_STP_TMST                                      03440062
                , A.ASGMT_STP_RSN_CDE                                   03450062
               , A.LAST_USD_SEQ_NBR                                     03520062
               , B.KOHLS_USR_ID                                         03560076
               , B.TMP_USR_ID                                           03570099
               , B.JN_TMST                                              03580062
               , B.LVE_TMST                                             03590062
               , B.LVE_RSN_CDE                                          03600099
               , B.LVE_TMST - B.JN_TMST                                 03671062
               , A.ASGMT_STP_TMST -                                     03672062
                           (TIMESTAMP(A.ASGMT_STRT_DTE,A.ASGMT_STRT_TM))03672162
           FROM DLT_ASGMT A                                             03674099
              , DLT_TEM_ASGMT B                                         03675099
          WHERE A.ASGMT_STRT_DTE    = :PD-PROCESS-DATE                  03676099
            AND B.ASGMT_STRT_DTE    = A.ASGMT_STRT_DTE                  03677062
            AND B.ASGMT_NBR_TXT     = A.ASGMT_NBR_TXT                   03678062
            AND B.ASGMT_NBR_SEQ_NBR = A.ASGMT_NBR_SEQ_NBR               03679062
          ORDER BY A.ASGMT_STRT_DTE, A.DC_NBR, B.KOHLS_USR_ID,          03679299
                B.TMP_USR_ID , B.JN_TMST                                03679399
036800     END-EXEC.                                                    03680062
036900                                                                  03690000
037000****************************************************************  03700000
037100 PROCEDURE DIVISION.                                              03710000
037200****************************************************************  03720000
037300 0000-MAINLINE.                                                   03730000
037400                                                                  03740000
037500     PERFORM 1000-INITIALIZE                                      03750000
037600                                                                  03760000
056100     PERFORM 5100-OPEN-CURSOR.                                    03761074
056200     PERFORM 5200-FETCH-CURSOR                                    03762075
           IF NOT PS-END-OF-CSR                                         03763074
               MOVE DLT00004-DC-NBR       TO HL2-DC-NBR                 03765099
      *        MOVE DLT00004-DC-NBR       TO PV-SAVE-DC-NBR             03766099
               MOVE DL-USER-ID            TO PV-SAVE-USER-ID            03767099
037700         PERFORM 2000-PROCESS UNTIL PS-END-OF-CSR                 03770074
           ELSE                                                         03771074
               WRITE REPORT-RECORD FROM EP-EMPTY-REPORT-LINE            03771174
           END-IF                                                       03772074
056300     PERFORM 5300-CLOSE-CURSOR.                                   03773078
037800                                                                  03780000
037900     PERFORM 9000-EOJ.                                            03790000
038000                                                                  03800000
038200     STOP RUN.                                                    03820071
038300                                                                  03830000
038400 1000-INITIALIZE.                                                 03840000
038500                                                                  03850000
038600     DISPLAY ' DLKRP001 STARTED'                                  03860061
038700     EXEC SQL SET :PV-DB2-TMST = CURRENT TIMESTAMP END-EXEC       03870099
038800                                                                  03880000
038900     OPEN OUTPUT REPORT-FILE                                      03890000
039000* LOAD SYSTEM DATE INTO HEADINGS                                  03900000
039100     ACCEPT SD-SYSTEM-DATE FROM DATE.                             03910000
039200     ACCEPT ST-SYSTEM-TIME FROM TIME.                             03920000
039300                                                                  03930000
039400     MOVE SD-SYSTEM-DATE-YY      TO DP200O-RUN-YEAR.              03940063
039500     MOVE SD-SYSTEM-DATE-MM      TO DP200O-RUN-MONTH.             03950063
039600     MOVE SD-SYSTEM-DATE-DD      TO DP200O-RUN-DAY.               03960063
039700     MOVE ST-SYSTEM-HOUR         TO DP200O-RUN-HOUR.              03970063
039800     MOVE ST-SYSTEM-MINUTE       TO DP200O-RUN-MINUTE.            03980063
039900                                                                  03990000
040000     MOVE PC-CURRENT-PROGRAM-NAME                                 04000000
040100                                 TO DP200O-PROGRAM-NAME.          04010063
040200     MOVE 1                      TO DP200O-REPORT-NUMBER          04020063
040300                                    DP200O-PAGE-NUMBER            04030063
040400                                                                  04040000
040500*    PERFORM 8100-WRITE-MAIN-HEADINGS                             04050099
                                                                        04051072
      * * GET PROCESSING DATE                                           04052072
027600     EXEC SQL                                                     04060072
027700         SELECT                                                   04070072
027800             BTCH_PRC_DTE                                         04080072
027900             INTO :PD-PROCESS-DATE                                04081076
028000             FROM                                                 04082072
028100                TCOCNTL                                           04083072
028200             WHERE OPER_UNT_ID = 90                               04084072
028300     END-EXEC.                                                    04085072
           IF SQLCODE = ZERO                                            04085199
               CONTINUE                                                 04085299
           ELSE                                                         04085399
055700         MOVE '1000-INITIALIZE      '    TO PV-PARAGRAPH          04085499
053700         DISPLAY '**************************************'         04085599
053800         DISPLAY 'ERROR ISSUED ON                       '         04085699
053900         DISPLAY 'SELECT TCOCNTL                        '         04085799
054000         DISPLAY '**************************************'         04085899
054100         PERFORM 9200-SQL-ERROR                                   04085999
028400     END-IF.                                                      04086099
028500                                                                  04087072
028600     MOVE PD-PROCESS-DATE(1:4) TO PD-PROCESS-DATE-8 (1:4)         04088076
028700     MOVE PD-PROCESS-DATE(6:2) TO PD-PROCESS-DATE-8 (5:2)         04089076
028800     MOVE PD-PROCESS-DATE(9:2) TO PD-PROCESS-DATE-8 (7:2).        04089176
028900                                                                  04089272
029000     DISPLAY ' PROCESS DATE = ' PD-PROCESS-DATE-8.                04089399
040900                                                                  04090003
041700******************************************************************04170003
041800 2000-PROCESS.                                                    04180000
041900******************************************************************04190003
042000*    INITIALIZE DL-DETAIL-LINE-1.                                 04200099
042100                                                                  04210000
           IF DLT00004-DC-NBR = PV-SAVE-DC-NBR                          04212099
               CONTINUE                                                 04212199
           ELSE                                                         04212299
               MOVE DLT00004-DC-NBR    TO PV-SAVE-DC-NBR                04213099
                                          HL2-DC-NBR                    04213199
               MOVE DL-USER-ID         TO PV-SAVE-USER-ID               04214099
042900         PERFORM 8100-WRITE-MAIN-HEADINGS                         04214187
043000     END-IF                                                       04214287
                                                                        04215086
042200     IF DL-USER-ID = PV-SAVE-USER-ID                              04220099
042300         CONTINUE                                                 04230077
042400     ELSE                                                         04240000
               MOVE DL-USER-ID         TO PV-SAVE-USER-ID               04241099
042500         WRITE REPORT-RECORD FROM DL-BLANK-LINE                   04250000
042600               AFTER ADVANCING 1 LINES                            04260000
042700         ADD 1                   TO PV-LINES-USED                 04270000
042800         IF PV-LINES-USED > PC-END-OF-PAGE                        04280000
042900             PERFORM 8100-WRITE-MAIN-HEADINGS                     04290000
043000         END-IF                                                   04300000
043300     END-IF.                                                      04330000
043400                                                                  04340000
           MOVE DLT00004-DC-NBR             TO DL-DC-NBR.               04350099
           MOVE DLT00004-WK-TYP-DESC        TO DL-WORK-TYPE-DESC.       04350299
           MOVE DLT00004-WK-AREA-DESC       TO DL-WORK-AREA-DESC.       04350399
           MOVE DLT00004-ASGMT-STRT-DTE     TO DL-ASGMT-START-DATE.     04350499
           MOVE DLT00004-ASGMT-STRT-TM      TO DL-ASGMT-START-TIME.     04350599
           MOVE DLT00004-ASGMT-STP-TMST     TO PV-TMST.                 04350799
           MOVE PV-DATE                     TO DL-ASGMT-STOP-DATE.      04350899
           MOVE PV-TIME                     TO DL-ASGMT-STOP-TIME.      04350999
           MOVE PV-ASGMT-OPEN-TIME          TO PV-ASGMT-OPEN-TIME-1-6.  04351499
041700*                                                                 04351599
041700* TIMESTAMP DIFFERENCE IS RETURNED IN HHMMSS FORMAT.  IF THE HOURS04351699
041700* ARE GREATER THAN ZERO, CONVERT THEM TO MINUTES BY MULTIPLYING   04351799
041700* THE VALUE BY 60 AND ADDING IT TO THE MINUTES VALUE.             04351899
           IF  PV-ASGMT-OPEN-1-2 > 0                                    04351999
               COMPUTE PV-MINUTES-CALC = PV-ASGMT-OPEN-1-2 * 60         04352099
               COMPUTE PV-MINUTES = PV-MINUTES-CALC + PV-ASGMT-OPEN-3-4 04352199
           ELSE                                                         04352299
               MOVE PV-ASGMT-OPEN-3-4       TO PV-MINUTES               04352399
           END-IF.                                                      04352499
041700*                                                                 04352599
           MOVE PV-ASGMT-OPEN-5-6           TO PV-SECONDS.              04352699
           MOVE PV-MINUTES-SECONDS          TO DL-ASGMT-OPEN-TIME.      04352799
           EVALUATE DLT00004-ASGMT-STP-RSN-CDE                          04352899
                      WHEN 'T'   MOVE 'TIME'  TO DL-ASGMT-STOP-RSN-CDE  04352999
                      WHEN 'Q'   MOVE 'ISTOP' TO DL-ASGMT-STOP-RSN-CDE  04353099
                      WHEN 'S'   MOVE 'SMOVE' TO DL-ASGMT-STOP-RSN-CDE  04354099
                      WHEN 'M'   MOVE 'AMOVE' TO DL-ASGMT-STOP-RSN-CDE  04355099
                      WHEN OTHER MOVE ' '     TO DL-ASGMT-STOP-RSN-CDE  04356099
           END-EVALUATE.                                                04356196
           IF DLT00004-LAST-USD-SEQ-NBR = ZERO                          04357099
               MOVE 'N'                    TO DL-EVENTS                 04358099
                                              DL-TEAM-ASGMT             04358199
           ELSE                                                         04359096
               MOVE 'Y'                    TO DL-EVENTS                 04359199
               PERFORM 3000-TEAM-ASGMT-USERS                            04359299
           END-IF.                                                      04359396
           MOVE DLT00003-JN-TMST           TO PV-TMST.                  04359499
           MOVE PV-DATE                    TO DL-JOIN-DATE.             04359599
           MOVE PV-TIME                    TO DL-JOIN-TIME.             04359699
           MOVE DLT00003-LVE-TMST          TO PV-TMST.                  04359799
           MOVE PV-DATE                    TO DL-LEAVE-DATE.            04359899
           MOVE PV-TIME                    TO DL-LEAVE-TIME.            04359999
           MOVE PV-JOIN-LEAVE-TIME         TO PV-JOIN-LEAVE-TIME-1-6    04360099
041700*                                                                 04360199
041700* TIMESTAMP DIFFERENCE IS RETURNED IN HHMMSS FORMAT.  IF THE HOURS04360299
041700* ARE GREATER THAN ZERO, CONVERT THEM TO MINUTES BY MULTIPLYING   04360399
041700* THE VALUE BY 60 AND ADDING IT TO THE MINUTES VALUE.             04360499
           IF  PV-JOIN-LEAVE-1-2 > 0                                    04360599
               COMPUTE PV-MINUTES-CALC = PV-JOIN-LEAVE-1-2 * 60         04360699
               COMPUTE PV-MINUTES = PV-MINUTES-CALC + PV-JOIN-LEAVE-3-4 04360899
           ELSE                                                         04360999
               MOVE PV-JOIN-LEAVE-3-4      TO PV-MINUTES                04361099
           END-IF.                                                      04361199
041700*                                                                 04361299
           MOVE PV-JOIN-LEAVE-5-6          TO PV-SECONDS.               04361399
           MOVE PV-MINUTES-SECONDS         TO DL-JOIN-LEAVE-TIME        04362099
           EVALUATE DLT00003-LVE-RSN-CDE                                04370099
                      WHEN 'T'   MOVE 'TIME'  TO DL-ASSOC-LEAVE-RSN-CDE 04380099
                      WHEN 'Q'   MOVE 'ISTOP' TO DL-ASSOC-LEAVE-RSN-CDE 04390099
                      WHEN 'S'   MOVE 'SMOVE' TO DL-ASSOC-LEAVE-RSN-CDE 04400099
                      WHEN 'M'   MOVE 'AMOVE' TO DL-ASSOC-LEAVE-RSN-CDE 04410099
                      WHEN OTHER MOVE ' '     TO DL-ASSOC-LEAVE-RSN-CDE 04420099
           END-EVALUATE.                                                04430099
                                                                        04431099
           WRITE REPORT-RECORD FROM DL-DETAIL-LINE-1.                   04431199
042700     ADD 1                              TO PV-LINES-USED          04431299
 68205     IF PV-LINES-USED > PC-END-OF-PAGE                            04431399
068206         PERFORM 8100-WRITE-MAIN-HEADINGS                         04431499
           END-IF.                                                      04431599
                                                                        04440099
056200     PERFORM 5200-FETCH-CURSOR.                                   04831079
048500                                                                  04850000
041700******************************************************************04860091
041800 3000-TEAM-ASGMT-USERS.                                           04870099
           INITIALIZE PV-ASGMT-USER-COUNT                               04870199
           IF PS-KOHLS-USR-ID                                           04871099
               PERFORM 3010-TEAM-ASGMT-USERS                            04871199
           ELSE                                                         04871299
               PERFORM 3020-TEAM-ASGMT-USERS                            04871399
               END-IF.                                                  04871499
           IF PV-ASGMT-USER-COUNT > ZERO                                04871599
               MOVE 'Y' TO DL-TEAM-ASGMT                                04871699
           ELSE                                                         04871799
               MOVE 'N' TO DL-TEAM-ASGMT                                04871899
           END-IF.                                                      04871999
                                                                        04872099
       3010-TEAM-ASGMT-USERS.                                           04872199
      * *  THIS IS WHERE THE USER ID BEING PROCESSED IS KOHLS           04872299
055700     MOVE '3010-TEAM-ASGMT-USERS '    TO PV-PARAGRAPH.            04872399
049300     PERFORM                                                      04873099
049400         WITH TEST AFTER                                          04874099
049500         VARYING PV-RETRY-COUNTER                                 04875099
049600         FROM 1 BY 1                                              04876099
049700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               04877099
049900            OR  (SQLCODE = +0))                                   04879099
                                                                        04879199
056900         EXEC SQL                                                 04879299
               SELECT COUNT(*)                                          04879399
                 INTO :PV-ASGMT-USER-COUNT                              04879499
                 FROM DLT_TEM_ASGMT                                     04879599
                WHERE ASGMT_STRT_DTE    = :DLT00004-ASGMT-STRT-DTE      04879699
                  AND ASGMT_NBR_TXT     = :DLT00004-ASGMT-NBR-TXT       04879799
                  AND ASGMT_NBR_SEQ_NBR = :DLT00004-ASGMT-NBR-SEQ-NBR   04879899
                  AND KOHLS_USR_ID     <> :DL-USER-ID                   04879999
               END-EXEC                                                 04880099
057200                                                                  04880199
057300         EVALUATE TRUE                                            04880299
057400             WHEN SQLCODE = ZERO                                  04880399
057500             WHEN SQLCODE = -904                                  04880499
057600             WHEN SQLCODE = -913                                  04880599
057700                 CONTINUE                                         04880699
053600             WHEN SQLCODE < ZERO                                  04880799
053700                 DISPLAY '**************************************' 04880899
053800                 DISPLAY 'ERROR ISSUED ON                       ' 04880999
053900                 DISPLAY 'COUNT DLT_TEM_ASGMT                   ' 04881099
054000                 DISPLAY '**************************************' 04881199
054100                 PERFORM 9200-SQL-ERROR                           04881299
054300         END-EVALUATE                                             04881399
054400     END-PERFORM.                                                 04881499
                                                                        04881599
054600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    04881699
054700         SQLCODE NOT = ZERO                                       04881799
054800         DISPLAY '**************************************'         04881899
054900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         04881999
055000         DISPLAY 'COUNT DLT_TEM_ASGMT   '                         04882099
055100         DISPLAY '**************************************'         04882199
055200         PERFORM 9200-SQL-ERROR                                   04882299
055300     END-IF.                                                      04882399
                                                                        04884099
       3020-TEAM-ASGMT-USERS.                                           04885099
      * *  THIS IS WHERE THE USER ID BEING PROCESSED IS A TEMP          04886099
055700     MOVE '3020-TEAM-ASGMT-USERS '    TO PV-PARAGRAPH.            04887099
049300     PERFORM                                                      04888099
049400         WITH TEST AFTER                                          04889099
049500         VARYING PV-RETRY-COUNTER                                 04889199
049600         FROM 1 BY 1                                              04889299
049700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               04889399
049900            OR  (SQLCODE = +0))                                   04889499
                                                                        04889599
056900         EXEC SQL                                                 04889699
               SELECT COUNT(*)                                          04889799
                 INTO :PV-ASGMT-USER-COUNT                              04889899
                 FROM DLT_TEM_ASGMT                                     04889999
                WHERE ASGMT_STRT_DTE    = :DLT00004-ASGMT-STRT-DTE      04890099
                  AND ASGMT_NBR_TXT     = :DLT00004-ASGMT-NBR-TXT       04891099
                  AND ASGMT_NBR_SEQ_NBR = :DLT00004-ASGMT-NBR-SEQ-NBR   04892099
                  AND TMP_USR_ID       <> :DL-USER-ID                   04893099
               END-EXEC                                                 04894099
057200                                                                  04895099
057300         EVALUATE TRUE                                            04896099
057400             WHEN SQLCODE = ZERO                                  04897099
057500             WHEN SQLCODE = -904                                  04898099
057600             WHEN SQLCODE = -913                                  04899099
057700                 CONTINUE                                         04899199
053600             WHEN SQLCODE < ZERO                                  04899299
053700                 DISPLAY '**************************************' 04899399
053800                 DISPLAY 'ERROR ISSUED ON                       ' 04899499
053900                 DISPLAY 'COUNT DLT_TEM_ASGMT                   ' 04899599
054000                 DISPLAY '**************************************' 04899699
054100                 PERFORM 9200-SQL-ERROR                           04899799
054300         END-EVALUATE                                             04899899
054400     END-PERFORM.                                                 04899999
                                                                        04900099
054600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    04901099
054700         SQLCODE NOT = ZERO                                       04902099
054800         DISPLAY '**************************************'         04903099
054900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         04904099
055000         DISPLAY 'COUNT DLT_TEM_ASGMT   '                         04905099
055100         DISPLAY '**************************************'         04906099
055200         PERFORM 9200-SQL-ERROR                                   04907099
055300     END-IF.                                                      04908099
                                                                        04909099
041900******************************************************************04910091
056500*----------------------------------------------------------------*05650000
056600* OPEN THE CURSOR                                                 05660000
056700*----------------------------------------------------------------*05670000
056800 5100-OPEN-CURSOR.                                                05670179
055700     MOVE '5100-OPEN-CURSOR      '    TO PV-PARAGRAPH.            05670279
049300     PERFORM                                                      05671079
049400         WITH TEST AFTER                                          05672079
049500         VARYING PV-RETRY-COUNTER                                 05673079
049600         FROM 1 BY 1                                              05674079
049700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               05675079
049900            OR  (SQLCODE = +0))                                   05677079
                                                                        05678079
056900         EXEC SQL                                                 05690000
057000              OPEN ASGMT-CSR                                      05700070
057100         END-EXEC                                                 05710000
057200                                                                  05720000
057300         EVALUATE TRUE                                            05730000
057400             WHEN SQLCODE = ZERO                                  05740000
057500             WHEN SQLCODE = -904                                  05750000
057600             WHEN SQLCODE = -913                                  05760000
057700                 CONTINUE                                         05770000
053600             WHEN SQLCODE < ZERO                                  05821079
053700                 DISPLAY '**************************************' 05822079
053800                 DISPLAY 'ERROR ISSUED ON                       ' 05823079
053900                 DISPLAY 'OPEN ASGMT-CSR                        ' 05824079
054000                 DISPLAY '**************************************' 05825079
054100                 PERFORM 9200-SQL-ERROR                           05826079
054300         END-EVALUATE                                             05828079
054400     END-PERFORM.                                                 05829079
                                                                        05829182
054600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    05829282
054700         SQLCODE NOT = ZERO                                       05829382
054800         DISPLAY '**************************************'         05829482
054900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         05829582
055000         DISPLAY 'OPEN ASGMT-CSR         '                        05829682
055100         DISPLAY '**************************************'         05829782
055200         PERFORM 9200-SQL-ERROR                                   05829882
055300     END-IF.                                                      05829982
058300*                                                                 05830000
058400*----------------------------------------------------------------*05840000
058500*    FETCH THE CURSOR                                             05850000
058600*----------------------------------------------------------------*05860000
058700 5200-FETCH-CURSOR.                                               05870075
055700     MOVE '5200-FETCH-CURSOR     '    TO PV-PARAGRAPH.            05871084
049300     PERFORM                                                      05872084
049400         WITH TEST AFTER                                          05873084
049500         VARYING PV-RETRY-COUNTER                                 05874084
049600         FROM 1 BY 1                                              05875084
049700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               05876084
049800            OR  (SQLCODE = +100)                                  05877084
049900            OR  (SQLCODE = +0))                                   05878084
058800                                                                  05880000
058900         EXEC SQL                                                 05890092
059000         FETCH ASGMT-CSR                                          05900092
                INTO :DLT00004-ASGMT-STRT-DTE                           05910099
                   , :DLT00004-ASGMT-NBR-TXT                            05911099
                   , :DLT00004-ASGMT-NBR-SEQ-NBR                        05912099
                   , :DLT00004-ASGMT-STRT-TM                            05913099
                   , :DLT00004-WK-TYP-DESC                              05914099
                   , :DLT00004-WK-AREA-DESC                             05915099
                   , :DLT00004-DC-NBR                                   05916099
                   , :DLT00004-ASGMT-STP-TMST:DN-ASGMT-STOP-NULL-IND    05917099
                   , :DLT00004-ASGMT-STP-RSN-CDE                        05918099
                   , :DLT00004-LAST-USD-SEQ-NBR                         05919799
                   , :DLT00003-KOHLS-USR-ID:DN-KOHLS-NULL-IND           05920299
                   , :DLT00003-TMP-USR-ID:DN-TMP-NULL-IND               05920399
                   , :DLT00003-JN-TMST                                  05920499
                   , :DLT00003-LVE-TMST:DN-LVE-TMST-NULL-IND            05920599
                   , :DLT00003-LVE-RSN-CDE                              05920699
                   , :PV-JOIN-LEAVE-TIME:DN-LVE-TMST-NULL-IND           05921599
                   , :PV-ASGMT-OPEN-TIME:DN-ASGMT-STOP-NULL-IND         05921699
059200         END-EXEC                                                 05922099
059300                                                                  05930000
057300         EVALUATE TRUE                                            06021092
057400             WHEN SQLCODE = ZERO                                  06022092
                       INITIALIZE DL-DETAIL-LINE-1                      06022199
                       IF DN-KOHLS-NULL-IND = ZERO                      06022299
                           SET PS-KOHLS-USR-ID                          06022399
                                       TO TRUE                          06022499
                           MOVE DLT00003-KOHLS-USR-ID                   06022599
                                       TO DL-USER-ID                    06022699
                       ELSE                                             06022799
                           SET PS-TMP-USR-ID                            06022899
                                       TO TRUE                          06022999
                           MOVE DLT00003-TMP-USR-ID                     06023099
                                       TO DL-USER-ID                    06023199
                       END-IF                                           06023299
                       IF DN-ASGMT-STOP-NULL-IND = ZERO                 06023399
                           CONTINUE                                     06023499
                       ELSE                                             06023599
                           MOVE SPACES TO DLT00004-ASGMT-STP-TMST       06023699
                           MOVE ZERO   TO PV-ASGMT-OPEN-TIME            06023799
                       END-IF                                           06023899
                       IF DN-LVE-TMST-NULL-IND = ZERO                   06023999
                           CONTINUE                                     06024099
                       ELSE                                             06024199
                           MOVE SPACES TO DLT00003-LVE-TMST             06024299
                           MOVE ZERO   TO PV-JOIN-LEAVE-TIME            06024399
                       END-IF                                           06024499
057500             WHEN SQLCODE = -904                                  06024592
057600             WHEN SQLCODE = -913                                  06024692
057700                 CONTINUE                                         06025092
059800             WHEN SQLCODE = +100                                  06025192
059900                  SET PS-END-OF-CSR TO TRUE                       06025292
053600             WHEN SQLCODE < ZERO                                  06026092
053700                 DISPLAY '**************************************' 06027092
053800                 DISPLAY 'ERROR ISSUED ON                       ' 06028092
053900                 DISPLAY 'FETCH ASGMT-CSR                        '06029092
054000                 DISPLAY '**************************************' 06029192
054100                 PERFORM 9200-SQL-ERROR                           06029292
054300         END-EVALUATE                                             06029392
054400     END-PERFORM.                                                 06029492
                                                                        06029592
054600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    06029692
054700         SQLCODE NOT = ZERO                                       06029792
054800         DISPLAY '**************************************'         06029892
054900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         06029992
055000         DISPLAY 'FETCH ASGMT-CSR         '                       06030092
055100         DISPLAY '**************************************'         06030192
055200         PERFORM 9200-SQL-ERROR                                   06030292
055300     END-IF.                                                      06030392
060300                                                                  06031000
060400*----------------------------------------------------------------*06040000
060500* CLOSE THE CURSOR.                                               06050000
060600*----------------------------------------------------------------*06060000
060700 5300-CLOSE-CURSOR.                                               06070000
060800                                                                  06080000
060900     EXEC SQL                                                     06090000
061000          CLOSE ASGMT-CSR                                         06100070
061100     END-EXEC.                                                    06110000
061200                                                                  06120000
071800 8100-WRITE-MAIN-HEADINGS.                                        07180000
071900                                                                  07190000
072000     ADD 1                            TO PV-PAGE-COUNT.           07200000
072100     MOVE PV-PAGE-COUNT               TO DP200O-PAGE-NUMBER.      07210063
072200     MOVE ZERO                        TO PV-LINES-USED            07220000
072300                                                                  07230000
072400     WRITE REPORT-RECORD FROM DP200O-STANDRD-HEADER-200-COLS      07240099
072500                 AFTER ADVANCING PAGE                             07250000
072600                                                                  07260000
072700     WRITE REPORT-RECORD FROM HL-HEADING-LINE-1                   07270000
072800        AFTER ADVANCING 2 LINES.                                  07280000
073500     WRITE REPORT-RECORD FROM HL-HEADING-LINE-2                   07350099
073600        AFTER ADVANCING 1 LINES.                                  07360099
073500     WRITE REPORT-RECORD FROM HL-HEADING-LINE-2-A                 07360199
073600        AFTER ADVANCING 1 LINES.                                  07360299
073500     WRITE REPORT-RECORD FROM HL-HEADING-LINE-3                   07360399
073600        AFTER ADVANCING 1 LINES.                                  07360499
073500     WRITE REPORT-RECORD FROM HL-HEADING-LINE-4                   07360599
073600        AFTER ADVANCING 1 LINES.                                  07360699
073500     WRITE REPORT-RECORD FROM HL-HEADING-LINE-5                   07361099
073600        AFTER ADVANCING 1 LINES.                                  07362099
073500     WRITE REPORT-RECORD FROM HL-HEADING-LINE-6                   07363099
073600        AFTER ADVANCING 1 LINES.                                  07364099
073700     ADD 8                            TO PV-LINES-USED.           07370099
073800                                                                  07380000
074500*    INITIALIZE DP200O-LASER-NEW-PAGE-INDICATR.                   07450081
074700/                                                                 07470000
074800 9000-EOJ.                                                        07480000
074900                                                                  07490000
075000     WRITE REPORT-RECORD                                          07500000
075100       FROM END-OF-REPORT-LINE                                    07510000
075200         AFTER ADVANCING 2 LINES.                                 07520000
075300                                                                  07530000
075400     CLOSE REPORT-FILE.                                           07540080
075800/                                                                 07580000
075900 9100-ABEND.                                                      07590000
076000                                                                  07600000
076200     CLOSE REPORT-FILE                                            07620099
076300                                                                  07630000
076400     MOVE +4013                       TO ABEND-CODE.              07640000
076500     CALL 'ILBOABN0' USING ABEND-CODE.                            07650000
076600                                                                  07660000
076700 9200-SQL-ERROR.                                                  07670000
076800                                                                  07680000
076900     MOVE SQLCODE                     TO SQLCODE2.                07690000
077000     MOVE SQLERRD(3)                  TO SQLERRD3.                07700000
077100                                                                  07710000
077200     DISPLAY '** ABEND **         ** = SQLERROR'.                 07720000
077300     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        07730000
077400     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   07740000
077500     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                07750000
077600                                                                  07760000
077700     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                07770000
077800     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                07780000
077900     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 07790000
078000     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                07800000
078100                                                                  07810000
050900******************************************************************07811099
051000* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    07812099
051100* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         07813099
051200* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     07814099
051300* FORMAT.                                                         07815099
051400******************************************************************07816099
051500     COPY DPPD004.                                                07817099
078200                                                                  07820000
078300     MOVE +4013                       TO ABEND-CODE.              07830000
078400     CALL 'ILBOABN0' USING ABEND-CODE.                            07840000
078500                                                                  07850000
078600 9300-SQL-WARNING.                                                07860000
078700                                                                  07870000
078800     DISPLAY '9300-SQL-WARNING'.                                  07880000
078900     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        07890000
079000     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   07900000
079100     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                07910000
079200                                                                  07920000
079300     MOVE SQLCODE                     TO SQLCODE2.                07930000
079400     MOVE SQLERRD(3)                  TO SQLERRD3.                07940000
079500     DISPLAY '** ABEND **       ** = SQLWARNING'.                 07950000
079600     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  07960000
079700     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  07970000
079800     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  07980000
079900     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  07990000
080000     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  08000000
080100     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  08010000
080200     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  08020000
080300     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  08030000
080400     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  08040000
080500     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  08050000
080600                                                                  08060000
080700     MOVE +4013                       TO ABEND-CODE.              08070000
080800     CALL 'ILBOABN0' USING ABEND-CODE.                            08080000
080900                                                                  08090000
