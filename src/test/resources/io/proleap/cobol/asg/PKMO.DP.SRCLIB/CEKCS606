000100*-----------------------*                                         00010024
000200 IDENTIFICATION DIVISION.                                         00020024
000300*-----------------------*                                         00030024
000400 PROGRAM-ID.    CEKCS606.                                         00040024
000500 AUTHOR.        DENISE HAHN.                                      00050024
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060024
000700 DATE-WRITTEN.  12-14-1999.                                       00070024
000800 DATE-COMPILED.                                                   00080024
000900                                                                  00090024
001000***** NOTE:    THIS PROGRAM USES MQ SERIES AND MUST BE COMPILED   00100040
001100*****          WITH THE MQ SERIES SWITCH SET TO 'Y'.              00110040
001200*---------------------------------------------------------------* 00120024
001300*    S605 - CENTRAL STOCK INTERFACE - PULL ADD BY SKU           * 00130024
001400*---------------------------------------------------------------* 00140024
001500*----------------------------------------------------------------*00150085
001600* 04/28/2010 - DJK - CHANGES MADE FOR EFC2 WR 38216              *00160085
001700*----------------------------------------------------------------*00170085
001800* CHANGED 10/29/2021    BY JIM HUNTER      WR: CHG0263455         00180085
001900* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00190085
002000* MAKING THE CALL DYNAMIC VS STATIC.                              00200085
002100*----------------------------------------------------------------*00210085
002200* CHANGED 10/20/2022    BY JIM HUNTER      WR: CHG0276924         00220085
002300* ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00230085
002400* DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00240085
002401*-----------------------------------------------------------------00240185
001492* CHANGED 09/18/2023    BY JEAN KURK       WR: CHG0293403         00240290
001493* CODE LIMIT OF 999 LINES PER CS PULL                             00240390
001495*-----------------------------------------------------------------00240490
002402 EJECT                                                            00240524
002403 ENVIRONMENT DIVISION.                                            00240624
002404                                                                  00240724
002405 DATA DIVISION.                                                   00240824
002406                                                                  00240924
002407 WORKING-STORAGE SECTION.                                         00241024
002408                                                                  00241124
002409*    API CONTROL BLOCKS                                           00241224
002410                                                                  00241324
002420 01  MQM-OBJECT-DESCRIPTOR.                                       00242024
002500     COPY CMQODV.                                                 00250024
002600 01  MQM-MESSAGE-DESCRIPTOR.                                      00260024
002700     COPY CMQMDV.                                                 00270024
002800 01  MQM-GET-MESSAGE-OPTIONS.                                     00280024
002900     COPY CMQGMOV.                                                00290024
003000 01  MQM-PUT-MESSAGE-OPTIONS.                                     00300024
003100     COPY CMQPMOV.                                                00310024
003200                                                                  00320024
003300*    MQV CONTAINS CONSTANTS (FOR FILLING IN THE CONTROL BLOCKS)   00330024
003400*    AND RETURN CODES (FOR TESTING THE RESULT OF A CALL)          00340024
003500                                                                  00350024
003600 01  MQM-CONSTANTS.                                               00360024
003700     COPY CMQV.                                                   00370024
003800                                                                  00380024
003900*    XLKUT001 COPYBOOK.                                           00390056
004000     COPY XLWS001.                                                00400049
004001                                                                  00400185
004002*    XLKUT071 COPYBOOK.                                           00400256
004003     COPY XLWS071.                                                00400349
004100                                                                  00410024
004200 01  DK-DB2-KEYS.                                                 00420024
004300     15  DK-PULL-NUMBER                 PIC S9(09)  VALUE ZERO    00430024
004400                                                    COMP.         00440024
004500     15  DK-REF-NUMBER                  PIC  X(15)  VALUE SPACES. 00450024
004600     15  DK-LINE-NUMBER                 PIC S9(04)  VALUE ZERO    00460024
004700                                                    COMP.         00470024
004800     15  DK-LINE-STATUS                 PIC  X(02)  VALUE SPACES. 00480024
004900     05  DK-STORE-NUMBER                PIC  9(04)  VALUE 0.      00490085
005600                                                                  00560024
005700 01  PC-PROGRAM-CONSTANTS.                                        00570024
005710     05  PC-SPACE                  PIC  X(01)  VALUE ' '.         00571086
005800     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CE606A  '.  00580024
005900     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CEKM606 '.  00590024
006000     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CEKCS606'.  00600024
006100     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE 'CEKCS609'.  00610024
006200     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00620024
006300     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00630024
006400     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00640024
006500     05  PC-ONE                    PIC S9(01)  VALUE +1.          00650024
006600     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00660024
006700     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +12          00670024
006800                                               COMP SYNC.         00680024
006900     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +1           00690024
007000                                               COMP SYNC.         00700024
007100     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00710024
007200                                               COMP-3.            00720024
007300     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00730024
007400                                               COMP SYNC.         00740024
007500     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00750024
007600                                               COMP-3.            00760024
007700     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00770024
007800     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00780024
007900     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00790024
008000     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00800024
008100     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00810024
008200     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00820024
008300     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00830024
008400                                               COMP.              00840024
008500     05  PC-CA                     PIC  X(02)  VALUE 'CA'.        00850024
008600     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00860024
008700     05  PC-IP                     PIC  X(02)  VALUE 'IP'.        00870024
008800     05  PC-NW                     PIC  X(02)  VALUE 'NW'.        00880024
008900     05  PC-PD                     PIC  X(02)  VALUE 'PD'.        00890024
009000     05  PC-AD                     PIC  X(02)  VALUE 'AD'.        00900024
009100     05  PC-IN                     PIC  X(02)  VALUE 'IN'.        00910024
009200     05  PC-MA                     PIC  X(02)  VALUE 'MA'.        00920024
009300     05  PC-01                     PIC  X(02)  VALUE '01'.        00930024
009400     05  PC-MQCONN                 PIC X(08)   VALUE 'CSQCCONN'.  00940024
009500     05  PC-MQOPEN                 PIC X(08)   VALUE 'CSQCOPEN'.  00950024
009600     05  PC-MQINQ                  PIC X(08)   VALUE 'CSQCINQ'.   00960024
009700     05  PC-MQGET                  PIC X(08)   VALUE 'CSQCGET'.   00970024
009800     05  PC-MQPUT                  PIC X(08)   VALUE 'CSQCPUT'.   00980024
009900     05  PC-MQPUT1                 PIC X(08)   VALUE 'CSQCPUT1'.  00990026
010000     05  PC-MQCLOSE                PIC X(08)   VALUE 'CSQCCLOS'.  01000024
010100     05  PC-MQDISC                 PIC X(08)   VALUE 'CSQCDISC'.  01010024
010200     05  PC-QMGR-NAME              PIC X(04)   VALUE SPACES.      01020024
010300         88  PC-PROD-QMGR-NAME                 VALUE 'QKSP'.      01030024
010400         88  PC-TEST-QMGR-NAME                 VALUE 'QKST'.      01040024
010500         88  PC-QA-QMGR-NAME                   VALUE 'QKSQ'.      01050024
010600*                                                                 01060024
010700*----------------------------------------------------------------*01070024
010800*  DESCRIPTION CONSTANTS                                         *01080024
010900*----------------------------------------------------------------*01090024
011000     05  PC-ALL-DESC                PIC X(08)  VALUE 'ALL     '.  01100024
011100     05  PC-NEW-DESC                PIC X(08)  VALUE 'NEW     '.  01110024
011200     05  PC-PULL-STATUS-CANCELLED   PIC X(08)  VALUE 'CANCELED'.  01120024
011300     05  PC-IN-PROCESS-DESC         PIC X(08)  VALUE 'IN PROCS'.  01130024
011400     05  PC-DISTRIB-DESC            PIC X(08)  VALUE 'DISTRBTD'.  01140024
011500     05  PC-POSTED-DESC             PIC X(08)  VALUE 'POSTED  '.  01150024
011600     05  PC-ADAM-DESC               PIC X(08)  VALUE 'ADAM    '.  01160024
011700     05  PC-INFOREM-DESC            PIC X(08)  VALUE 'INFOREM '.  01170024
011800     05  PC-MANUAL-DESC             PIC X(08)  VALUE 'MANUAL  '.  01180024
011900     05  PC-UNKNOWN-DESC            PIC X(08)  VALUE 'UNKNOWN '.  01190024
012000     05  PC-PULL-NBR-SEQ-DESC       PIC X(10)  VALUE 'PULL # SEQ'.01200024
012100     05  PC-CRTE-DTE-SEQ-DESC       PIC X(10)  VALUE 'DATE SEQ  '.01210024
012200     05  PC-UNKNOWN-SKU-DESC        PIC X(15)                     01220024
012300                                           VALUE '** UNKNOWN **'. 01230024
012400*                                                                 01240024
012500*----------------------------------------------------------------*01250024
012600*  SYSTEM MESSAGES                                               *01260024
012700*----------------------------------------------------------------*01270024
012800*   00005 = INVALID VALUE                                        *01280024
012900*   00007 = REQUIRED ENTRY                                       *01290024
013000*   00008 = MUST BE NUMERIC                                      *01300024
013100*   00045 = INVALID FUNCTION KEY                                 *01310024
013200*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01320024
013300*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01330024
013400*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01340024
013500*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01350024
013600*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01360024
013700*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01370024
013800*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01380024
013900*   00069 - TOP OF LIST                                          *01390024
014000*   00070 - BOTTOM OF LIST                                       *01400024
014100*   00073 - SKU DOES NOT EXIST                                   *01410024
014200*   00100 - UPC DOES NOT EXIST                                   *01420024
014300*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01430024
014400*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01440024
014500*   00279 - MORE ITEMS TO DISPLAY                                *01450024
014600*   00746 = INVALID PRINTER DESTINATION                          *01460024
014700*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01470024
014800*   01563 = PRINTER ID MUST BE ENTERED FOR THIS SELECTION        *01480024
014900*   01961 = YOU MUST ENTER THE UNITS                             *01490024
015000*   02224 = CANNOT CONFIRM/UNCONFIRM DISTRO-PULL POSTED           01500024
015100*   02225 = CANNOT CONFIRM DISTRIBUTION - PULL CANCELLED          01510024
015200*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01520024
015300*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*01530024
015400*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *01540024
015500*   02245 = CANNOT UPDATE ACTUAL UNITS - PULL LINE ITEM HAS BEEN *01550024
015600*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*01560024
015700*   02254 - CANCEL  PULL - PRESS F2 TO CONFIRM                    01570024
015800*   02255 - UNCANCEL PULL - PRESS F2 TO CONFIRM                   01580024
015900*   02256 - CANCEL LINE ITEM - PRESS F2 TO CONFIRM                01590024
016000*   02257 - UNCANCEL LINE ITEM - PRESS F2 TO CONFIRM              01600024
016100*   02258 - CONFIRM PULL DISTRIBUTION - PRESS F2 TO CONFIRM       01610024
016200*   02259 - UNCONFIRM PULL DISTRIBUTION - PRESS F2 TO CONFIRM     01620024
016300*   02260 - CONFIRM LINE ITEM DISTRIBUTION - PRESS F2 TO CONFIRM  01630024
016400*   02261 - UNCONFIRM LINE ITEM DISTRIBUTION - PRESS F2 TO CONFIRM01640024
016500*   02262 - CONFIRM PULL - PRESS F2 TO CONFIRM                    01650024
016600*   02263 - UNCONFIRM PULL - PRESS F2 TO CONFIRM                  01660024
016700*   02264 - CONFIRM LINE ITEM - PRESS F2 TO CONFIRM               01670024
016800*   02265 - UNCONFIRM LINE ITEM - PRESS F2 TO CONFIRM             01680024
016900*   02266 - ALL SELECTED ITEMS MUST HAVE THE SAME STATUS          01690024
017000*   02267 - CANNOT CANCEL/UNCANCEL - PULL ALREADY POSTED/DISTRIBTD01700024
017100*   02268 - CANNOT CANCEL/UNCANCEL - LINE(S) ALREADY POSTED/DISTRB01710024
017200*   02269 - (UN)CANCEL PULL REQUEST FAILED                        01720024
017300*   02270 - (UN)CONFIRM PULL DISTRIBUTION REQUEST FAILED          01730024
017400*   02271 - (UN)CONFIRM PULL REQUEST FAILED                       01740024
017500*   02272 - CANNOT CONFIRM DISTRIBUTION - PULL STATUS IS DISTRIBTD01750024
017600*   02273 - CANNOT UNCONFIRM DISTRIBUTION - PULL STATUS NOT DISTRB01760024
017700*   02274 - (UN)CANCEL PULL REQUEST SUCCESSFUL                    01770024
017800*   02275 - (UN)CONFIRM PULL DISTRIBUTION REQUEST SUCCESSFUL      01780024
017900*   02276 - (UN)CONFIRM PULL REQUEST SUCCESSFUL                   01790024
018000*   02278 = ALL SELECTED LINES MUST HAVE THE SAME STATUS TO PER  *01800024
018100*   02287 - CONFIRM DISTRIBUTION FAILED - NO LINE(S) FOR PULL     01810024
018200*   02288 - CONFIRM DISTRIBUTION FAILED - LINE(S) MISSING DISTRB  01820024
018300*   02289 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS DISTRIBTD01830024
018400*   02290 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS POSTED   01840024
018500*   02291 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS CANCELLED01850024
018600*   02303 - ADD FAILED - SELECTION HAS ALREADY BEEN ADDED         01860024
018700*   02304 - LINE ITEM INFO MUST BE ADDED BEFORE ADDING STORE INFO 01870024
018800*   02309 - UPC INFORMATION IS NOT AVAILABLE FOR THIS SKU         01880024
018900*   02310 - SKU INFORMATION IS NOT AVAILABLE FOR THIS UPC         01890024
019000*   02314 - PULL QTY(ROQ) CANNOT BE GREATER THAN CENTRAL STOCK ON 01900033
019100*   02352 - LINES HAVE BEEN ADDED - USE F24 TO ADD STORE DISTRIBUT01910024
018400*   03821 - MAX # OF LINES EXCEEDED FOR THIS CENTRAL STOCK PULL   01911088
019200*   99901 - INVALID COMMAND WAS ENTERED                          *01920024
019300*----------------------------------------------------------------*01930024
019400     05  PC-TSYMSG-NUMBERS.                                       01940024
019500         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01950024
019600         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  01960024
019700         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01970024
019800         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01980024
019900         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01990024
020000         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  02000024
020100         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  02010024
020200         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  02020024
020300         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  02030024
020400         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  02040024
020500         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  02050024
020600         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  02060024
020700         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  02070024
020800         10  PC-TSYMSG-00073            PIC  9(05)  VALUE 00073.  02080024
020900         10  PC-TSYMSG-00100            PIC  9(05)  VALUE 00100.  02090024
021000         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  02100024
021100         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  02110024
021200         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  02120024
021300         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  02130024
021400         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  02140024
021500         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  02150024
021600         10  PC-TSYMSG-01961            PIC  9(05)  VALUE 01961.  02160024
021700         10  PC-TSYMSG-02224            PIC  9(05)  VALUE 02224.  02170024
021800         10  PC-TSYMSG-02225            PIC  9(05)  VALUE 02225.  02180024
021900         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  02190024
022000         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  02200024
022100         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  02210024
022200         10  PC-TSYMSG-02245            PIC  9(05)  VALUE 02245.  02220024
022300         10  PC-TSYMSG-02252            PIC  9(05)  VALUE 02252.  02230024
022400         10  PC-TSYMSG-02254            PIC  9(05)  VALUE 02254.  02240024
022500         10  PC-TSYMSG-02255            PIC  9(05)  VALUE 02255.  02250024
022600         10  PC-TSYMSG-02256            PIC  9(05)  VALUE 02256.  02260024
022700         10  PC-TSYMSG-02257            PIC  9(05)  VALUE 02257.  02270024
022800         10  PC-TSYMSG-02258            PIC  9(05)  VALUE 02258.  02280024
022900         10  PC-TSYMSG-02259            PIC  9(05)  VALUE 02259.  02290024
023000         10  PC-TSYMSG-02260            PIC  9(05)  VALUE 02260.  02300024
023100         10  PC-TSYMSG-02261            PIC  9(05)  VALUE 02261.  02310024
023200         10  PC-TSYMSG-02262            PIC  9(05)  VALUE 02262.  02320024
023300         10  PC-TSYMSG-02263            PIC  9(05)  VALUE 02263.  02330024
023400         10  PC-TSYMSG-02264            PIC  9(05)  VALUE 02264.  02340024
023500         10  PC-TSYMSG-02265            PIC  9(05)  VALUE 02265.  02350024
023600         10  PC-TSYMSG-02266            PIC  9(05)  VALUE 02266.  02360024
023700         10  PC-TSYMSG-02267            PIC  9(05)  VALUE 02267.  02370024
023800         10  PC-TSYMSG-02268            PIC  9(05)  VALUE 02268.  02380024
023900         10  PC-TSYMSG-02269            PIC  9(05)  VALUE 02269.  02390024
024000         10  PC-TSYMSG-02270            PIC  9(05)  VALUE 02270.  02400024
024100         10  PC-TSYMSG-02271            PIC  9(05)  VALUE 02271.  02410024
024200         10  PC-TSYMSG-02272            PIC  9(05)  VALUE 02272.  02420024
024300         10  PC-TSYMSG-02273            PIC  9(05)  VALUE 02273.  02430024
024400         10  PC-TSYMSG-02274            PIC  9(05)  VALUE 02274.  02440024
024500         10  PC-TSYMSG-02275            PIC  9(05)  VALUE 02275.  02450024
024600         10  PC-TSYMSG-02276            PIC  9(05)  VALUE 02276.  02460024
024700         10  PC-TSYMSG-02278            PIC  9(05)  VALUE 02278.  02470024
024800         10  PC-TSYMSG-02287            PIC  9(05)  VALUE 02287.  02480024
024900         10  PC-TSYMSG-02288            PIC  9(05)  VALUE 02288.  02490024
025000         10  PC-TSYMSG-02289            PIC  9(05)  VALUE 02289.  02500024
025100         10  PC-TSYMSG-02290            PIC  9(05)  VALUE 02290.  02510024
025200         10  PC-TSYMSG-02291            PIC  9(05)  VALUE 02291.  02520024
025300         10  PC-TSYMSG-02303            PIC  9(05)  VALUE 02303.  02530024
025400         10  PC-TSYMSG-02304            PIC  9(05)  VALUE 02304.  02540024
025500         10  PC-TSYMSG-02309            PIC  9(05)  VALUE 02309.  02550024
025600         10  PC-TSYMSG-02310            PIC  9(05)  VALUE 02310.  02560024
025700         10  PC-TSYMSG-02314            PIC  9(05)  VALUE 02314.  02570033
025800         10  PC-TSYMSG-02352            PIC  9(05)  VALUE 02352.  02580024
025900         10  PC-TSYMSG-02677            PIC  9(05)  VALUE 02677.  02590044
025200         10  PC-TSYMSG-03821            PIC  9(05)  VALUE 03821.  02591088
026000         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  02600024
026100                                                                  02610024
026200*                    MQ CALL ERROR MESSAGES                       02620024
026300 01  PE-PROGRAM-ERROR-MESSAGES.                                   02630024
026400     05  PE-MQ-ERROR-NUMBER           PIC X(02) VALUE '01'.       02640024
026500     05  PE-MQ-ERROR-MESSAGE.                                     02650024
026600         10  FILLER                   PIC X(08) VALUE             02660037
026700                                                'MQ ERR: '.       02670037
026800         10  PE-MQ-CALL-TYPE          PIC X(7)  VALUE SPACES.     02680037
026900             88  PE-MQ-CONNECT                  VALUE 'MQCONN '.  02690037
027000             88  PE-MQ-OPEN                     VALUE 'MQOPEN '.  02700037
027100             88  PE-MQ-INQ                      VALUE 'MQINQ  '.  02710037
027200             88  PE-MQ-GET                      VALUE 'MQGET  '.  02720037
027300             88  PE-MQ-PUT                      VALUE 'MQPUT  '.  02730037
027400             88  PE-MQ-PUT1                     VALUE 'MQPUT1 '.  02740037
027500             88  PE-MQ-CLOSE                    VALUE 'MQCLOSE'.  02750037
027600             88  PE-MQ-DISCONNECT               VALUE 'MQDISC '.  02760037
027700         10  FILLER                   PIC X(04) VALUE ' OF '.     02770037
027800         10  PE-MQ-QMANAGER           PIC X(05) VALUE SPACES.     02780037
027900         10  FILLER                   PIC X(01) VALUE SPACES.     02790037
028000         10  PE-MQ-QNAME              PIC X(20) VALUE SPACES.     02800037
028100         10  FILLER                   PIC X(10) VALUE             02810037
028200                                        'COMP CDE: '.             02820037
028300         10  PE-MQ-COMPLETION-CODE    PIC 9(04) VALUE ZEROS.      02830037
028400         10  FILLER                   PIC X(01) VALUE SPACES.     02840037
028500         10  FILLER                   PIC X(12) VALUE             02850037
028600                                      'REASON CDE: '.             02860037
028700         10  PE-MQ-REASON-CODE        PIC 9(04) VALUE ZEROS.      02870037
028800         10  FILLER                   PIC X(01) VALUE ' '.        02880037
028900         10  PE-MQ-REASON-DESC        PIC X(30) VALUE SPACES.     02890037
029000     05  PE-MQ-INFORMATIONAL-NUMBER   PIC X(02) VALUE '02'.       02900024
029100     05  PE-MQ-INFO-MESSAGE.                                      02910024
029200         10  FILLER                   PIC X(06) VALUE             02920024
029300                                                'QMGR: '.         02930024
029400         10  PE-MQ-QMGR               PIC X(10) VALUE SPACES.     02940024
029500         10  FILLER                   PIC X(18) VALUE             02950024
029600                                          'STORE STATS MSG: '.    02960024
029700         10  PE-MQ-STATS-MSG          PIC X(1032) VALUE SPACES.   02970024
029800     05  PE-DB2-ERROR-NUMBER          PIC X(02) VALUE '02'.       02980024
029900     05  PE-DB2-ERROR-MESSAGE.                                    02990024
030000         10  FILLER                   PIC X(11) VALUE             03000024
030100                                                'DB2 ERROR: '.    03010024
030200         10  FILLER                   PIC X(08) VALUE             03020024
030300                                                'SQLWARN='.       03030024
030400         10  PE-DB2-WARNING           PIC X(8)  VALUE SPACES.     03040024
030500         10  FILLER                   PIC X(08) VALUE             03050024
030600                                                'SQLCODE='.       03060024
030700         10  PE-DB2-CODE              PIC Z(8)9-  VALUE SPACES.   03070024
030800         10  FILLER                   PIC X(06) VALUE             03080024
030900                                                ' PARA='.         03090024
031000         10  PE-DB2-PARAGRAPH         PIC X(18)  VALUE SPACES.    03100024
031100         10  FILLER                   PIC X(08) VALUE             03110024
031200                                                ' ACTION='.       03120024
031300         10  PE-DB2-ACTION            PIC X(20)  VALUE SPACES.    03130024
031400                                                                  03140024
031500*                                                                 03150024
031600 01  PS-PROGRAM-SWITCHES.                                         03160024
031700     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'N'.    03170024
031800         88  PS-NO-ERROR                            VALUE 'N'.    03180024
031900         88  PS-ERROR                               VALUE 'Y'.    03190024
032000     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    03200024
032100         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    03210024
032200         88  PS-BLOCK-ERROR                         VALUE 'N'.    03220024
032300     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE 'N'.    03230024
032400         88  PS-CONFIRM-PROCESSING                  VALUE 'Y'.    03240024
032500         88  PS-NOT-CONFIRM-PROCESSING              VALUE 'N'.    03250024
032600     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    03260024
032700         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    03270024
032800         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    03280024
032900     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    03290024
033000         88  PS-COMMAREA-VALID                      VALUE 'Y'.    03300024
033100         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    03310024
033200     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    03320024
033300         88  PS-DONE                                VALUE 'Y'.    03330024
033400         88  PS-NOT-DONE                            VALUE 'N'.    03340024
033500     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    03350024
033600         88  PS-LIST-END                            VALUE 'Y'.    03360024
033700         88  PS-NO-LIST-END                         VALUE 'N'.    03370024
033800     05  PS-MQ-ERROR-SW                 PIC  X(01)  VALUE 'N'.    03380024
033900         88  PS-MQ-ERROR                            VALUE 'Y'.    03390024
034000         88  PS-NO-MQ-ERROR                         VALUE 'N'.    03400024
034100     05  PS-MQ-SETUP-SW                 PIC  X(01)  VALUE 'N'.    03410024
034200         88  PS-MQ-SETUP-COMPLETE                   VALUE 'Y'.    03420024
034300         88  PS-MQ-SETUP-NOT-COMPLETE               VALUE 'N'.    03430024
034400     05  PS-REDUCE-QTY-SW               PIC  X(01)  VALUE 'N'.    03440032
034500         88  PS-REDUCE-QTY                          VALUE 'Y'.    03450032
034600         88  PS-NO-REDUCE-QTY                       VALUE 'N'.    03460032
034700     05  PS-SKU-NOT-FOUND-SW            PIC  X(01)  VALUE 'N'.    03470032
034800         88  PS-SKU-NOT-FOUND                       VALUE 'Y'.    03480032
034900         88  PS-SKU-FOUND                           VALUE 'N'.    03490032
035000     05  PS-SKU-NOT-PROCESSED-SW        PIC  X(01)  VALUE 'N'.    03500032
035100         88  PS-SKU-NOT-PROCESSED                   VALUE 'Y'.    03510032
035200         88  PS-SKU-PROCESSED                       VALUE 'N'.    03520032
035300     05  PS-PROCESS-MQ-SW               PIC  X(01)  VALUE 'N'.    03530085
035400         88  PS-PROCESS-MQ-YES                      VALUE 'Y'.    03540085
035401         88  PS-PROCESS-MQ-NO                       VALUE 'N'.    03540185
035402*                                                                 03540224
035403 01  PV-PROGRAM-VARIABLES.                                        03540324
035500     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  03550024
035600                                        COMP SYNC.                03560024
035700     05  PV-DISPLAY-PULL-NBR            PIC  9(09)  VALUE ZEROES. 03570024
035800     05  PV-SUB                         PIC S9(04)  VALUE +0      03580024
035900                                                    COMP SYNC.    03590024
036000     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      03600024
036100                                                    COMP SYNC.    03610024
036200     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      03620024
036300                                                    COMP-3.       03630024
036400     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      03640024
036500                                                    COMP-3.       03650024
036600     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      03660024
036700                                                    COMP-3.       03670024
036800     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      03680024
036900                                                    COMP-3.       03690024
037000     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +1      03700024
037100                                                    COMP-3.       03710024
037200     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      03720024
037300                                                    COMP-3.       03730024
037400     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      03740024
037500                                                    COMP-3.       03750024
037600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      03760024
037700                                                    COMP SYNC.    03770024
037800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      03780024
037900                                                    COMP SYNC.    03790024
038000     05  PV-ITEM                        PIC S9(04)  VALUE +0      03800024
038100                                                    COMP SYNC.    03810024
038200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      03820024
038300                                                    COMP SYNC.    03830024
038400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      03840024
038500                                                    COMP SYNC.    03850024
038600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      03860024
038700                                                    COMP SYNC.    03870024
038800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      03880024
038900                                                    COMP SYNC.    03890024
039000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      03900024
039100                                                    COMP SYNC.    03910024
039200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03920024
039300                                                    COMP SYNC.    03930024
039400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03940024
039500                                                    COMP SYNC.    03950024
039600     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03960024
039700                                                    COMP SYNC.    03970024
039800     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03980024
039900                                                    COMP SYNC.    03990024
040000     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      04000024
040100                                                    COMP SYNC.    04010024
040200     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      04020024
040300                                                    COMP SYNC.    04030024
040400     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      04040024
040500                                                    COMP SYNC.    04050024
040600     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      04060024
040700                                                    COMP SYNC.    04070024
040800     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      04080024
040900                                                    COMP.         04090024
041000     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      04100024
041100                                                    COMP.         04110024
041200     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      04120024
041300                                                    COMP.         04130024
040600     05  PV-MAX-PULL-LINES              PIC S9(9) COMP VALUE 0.   04131087
041400     05  PV-SOFT-ABORT-MSG.                                       04140024
041500         10  FILLER            PIC X(12) VALUE ' CEKCS606 - '.    04150024
041600         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       04160024
041700         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    04170024
041800         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    04180024
041900         10  PV-SOFT-PARAGRAPH PIC X(30).                         04190024
042000     05  PV-MQ-SOFT-ABORT-MSG.                                    04200046
042100         10  FILLER            PIC X(12) VALUE ' CEKCS605 - '.    04210046
042200         10  FILLER            PIC X(09) VALUE 'RSN CODE '.       04220046
042300         10  PV-REASON-CODE    PIC ZZZZZZZZ9-.                    04230046
042400         10  FILLER            PIC X(03) VALUE ' - '.             04240046
042500         10  PV-MQ-REASON-TXT  PIC X(30).                         04250046
042600         10  FILLER            PIC X(06) VALUE 'PARA: '.          04260046
042700         10  PV-MQ-PARAGRAPH   PIC X(30).                         04270046
042800     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     04280024
042900                                                     COMP SYNC.   04290024
043000     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 04300024
043100     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 04310024
043200     05  PV-CICS-MSG-HOLD.                                        04320024
043300         10  FILLER                      PIC  X(01)  VALUE SPACE. 04330024
043400         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 04340024
043500     05  PV-CICS-MSG-HOLD2.                                       04350024
043600         10  FILLER                      PIC  X(01)  VALUE SPACE. 04360024
043700         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 04370024
043800                                                                  04380024
043900     05  PV-CREATE-TMST                 PIC X(26)   VALUE SPACES. 04390024
044000     05  PV-CREATE-TMST-R REDEFINES  PV-CREATE-TMST.              04400024
044100         10   PV-CREATE-CC              PIC X(02).                04410024
044200         10   PV-CREATE-YY              PIC X(02).                04420024
044300         10   FILLER                    PIC X(01).                04430024
044400         10   PV-CREATE-MM              PIC X(02).                04440024
044500         10   FILLER                    PIC X(01).                04450024
044600         10   PV-CREATE-DD              PIC X(02).                04460024
044700         10   FILLER                    PIC X(16).                04470024
044800     05  PV-CURRENT-DATE           PIC  X(10)  VALUE SPACES.      04480024
044900     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE.             04490024
045000         10  PV-CURRENT-YY         PIC  9(04).                    04500024
045100         10  FILLER                PIC  X(01).                    04510024
045200         10  PV-CURRENT-MM         PIC  9(02).                    04520024
045300         10  FILLER                PIC  X(01).                    04530024
045400         10  PV-CURRENT-DD         PIC  9(02).                    04540024
045500                                                                  04550024
045600     05  PV-TRANS-SOURCE-DESC.                                    04560024
045700         10  FILLER                PIC  X(05)   VALUE 'PULL '.    04570024
045800         10  PV-TRANS-PULL-NBR     PIC  X(09).                    04580024
045900         10  FILLER                PIC  X(26)   VALUE SPACES.     04590024
046000                                                                  04600024
046100     05  PV-CREATE-MMDDYY.                                        04610024
046200         10   PV-CREATE-EDIT-MM         PIC X(02)   VALUE SPACES. 04620024
046300         10   PV-CREATE-SLASH-1         PIC X(01)   VALUE SPACES. 04630024
046400         10   PV-CREATE-EDIT-DD         PIC X(02)   VALUE SPACES. 04640024
046500         10   PV-CREATE-SLASH-2         PIC X(01)   VALUE SPACES. 04650024
046600         10   PV-CREATE-EDIT-YY         PIC X(02)   VALUE SPACES. 04660024
046700     05  PV-STATUS-MMDDYY.                                        04670024
046800         10   PV-STATUS-EDIT-MM         PIC X(02)   VALUE SPACES. 04680024
046900         10   PV-STATUS-SLASH-1         PIC X(01)   VALUE SPACES. 04690024
047000         10   PV-STATUS-EDIT-DD         PIC X(02)   VALUE SPACES. 04700024
047100         10   PV-STATUS-SLASH-2         PIC X(01)   VALUE SPACES. 04710024
047200         10   PV-STATUS-EDIT-YY         PIC X(02)   VALUE SPACES. 04720024
047300     05  PV-SELECT-FROM-DATE.                                     04730024
047400         10   PV-SELECT-FROM-EDIT-MM    PIC X(02)   VALUE SPACES. 04740024
047500         10   PV-SELECT-FROM-SLASH-1    PIC X(01)   VALUE SPACES. 04750024
047600         10   PV-SELECT-FROM-EDIT-DD    PIC X(02)   VALUE SPACES. 04760024
047700         10   PV-SELECT-FROM-SLASH-2    PIC X(01)   VALUE SPACES. 04770024
047800         10   PV-SELECT-FROM-EDIT-YY    PIC X(04)   VALUE SPACES. 04780024
047900     05  PV-PULL-SOURCE                 PIC X(02)   VALUE SPACES. 04790024
048000         88   PV-SOURCE-ADAM                        VALUE 'AD'.   04800024
048100         88   PV-SOURCE-INFOREM                     VALUE 'IN'.   04810024
048200         88   PV-SOURCE-MANUAL                      VALUE 'MA'.   04820024
048210         88   PV-SOURCE-XREF                        VALUE 'XF'.   04821085
048300         88   PV-SOURCE-UNKNOWN                     VALUE SPACES. 04830024
048400     05  PV-PULL-STATUS                 PIC X(02)   VALUE SPACES. 04840024
048500         88   PV-PULL-STATUS-NEW                    VALUE 'NW'.   04850024
048600         88   PV-PULL-STATUS-CANCELLED              VALUE 'CA'.   04860024
048700         88   PV-PULL-STATUS-INPROCESS              VALUE 'IP'.   04870024
048800         88   PV-PULL-STATUS-DISTRIBTD              VALUE 'DS'.   04880024
048900         88   PV-PULL-STATUS-POSTED                 VALUE 'PD'.   04890024
049000     05  PV-LINE-STATUS                 PIC X(02)   VALUE SPACES. 04900024
049100         88   PV-LINE-STATUS-NEW                    VALUE 'NW'.   04910024
049200         88   PV-LINE-STATUS-CANCELLED              VALUE 'CA'.   04920024
049300         88   PV-LINE-STATUS-INPROCESS              VALUE 'IP'.   04930024
049400         88   PV-LINE-STATUS-DISTRIBTD              VALUE 'DS'.   04940024
049500         88   PV-LINE-STATUS-POSTED                 VALUE 'PD'.   04950024
049600     05  PV-CEPLIT-ITEM-QTY              PIC S9(09) VALUE ZEROES  04960024
049700                                                    COMP.         04970024
049800     05  PV-CEPLIT-REQ-QTY               PIC S9(09) VALUE ZEROES  04980024
049900                                                    COMP.         04990024
050000     05  PV-CEPLIT-ACTL-QTY              PIC S9(09) VALUE ZEROES  05000024
050100                                                    COMP.         05010024
050200     05  PV-CEPLDS-DISTRB-QTY            PIC S9(09) VALUE ZEROES  05020024
050300                                                    COMP.         05030024
050400     05  PV-CEPLDS-STORE-COUNT           PIC S9(09) VALUE ZEROES  05040024
050500                                                    COMP.         05050024
050600                                                                  05060024
050700     05  PV-TYPE-1                       PIC X(02)  VALUE SPACES. 05070024
050800         88   PV-TYPE-1-ADAM                        VALUE 'AD'.   05080024
050900         88   PV-TYPE-1-INFOREM                     VALUE 'IN'.   05090024
051000         88   PV-TYPE-1-MANUAL                      VALUE 'MA'.   05100024
051100     05  PV-TYPE-2                       PIC X(02)  VALUE SPACES. 05110024
051200         88   PV-TYPE-2-ADAM                        VALUE 'AD'.   05120024
051300         88   PV-TYPE-2-INFOREM                     VALUE 'IN'.   05130024
051400         88   PV-TYPE-2-MANUAL                      VALUE 'MA'.   05140024
051500     05  PV-TYPE-3                       PIC X(02)  VALUE SPACES. 05150024
051600         88   PV-TYPE-3-ADAM                        VALUE 'AD'.   05160024
051700         88   PV-TYPE-3-INFOREM                     VALUE 'IN'.   05170024
051800         88   PV-TYPE-3-MANUAL                      VALUE 'MA'.   05180024
051900                                                                  05190024
052000     05  PV-STATUS-1                     PIC X(02)  VALUE SPACES. 05200024
052100         88   PV-STATUS-1-NEW                       VALUE 'NW'.   05210024
052200         88   PV-STATUS-1-CANCELLED                 VALUE 'CA'.   05220024
052300         88   PV-STATUS-1-INPROCESS                 VALUE 'IP'.   05230024
052400         88   PV-STATUS-1-DISTRIBTD                 VALUE 'DS'.   05240024
052500         88   PV-STATUS-1-POSTED                    VALUE 'PD'.   05250024
052600     05  PV-STATUS-2                     PIC X(02)  VALUE SPACES. 05260024
052700         88   PV-STATUS-2-NEW                       VALUE 'NW'.   05270024
052800         88   PV-STATUS-2-CANCELLED                 VALUE 'CA'.   05280024
052900         88   PV-STATUS-2-INPROCESS                 VALUE 'IP'.   05290024
053000         88   PV-STATUS-2-DISTRIBTD                 VALUE 'DS'.   05300024
053100         88   PV-STATUS-2-POSTED                    VALUE 'PD'.   05310024
053200     05  PV-STATUS-3                     PIC X(02)  VALUE SPACES. 05320024
053300         88   PV-STATUS-3-NEW                       VALUE 'NW'.   05330024
053400         88   PV-STATUS-3-CANCELLED                 VALUE 'CA'.   05340024
053500         88   PV-STATUS-3-INPROCESS                 VALUE 'IP'.   05350024
053600         88   PV-STATUS-3-DISTRIBTD                 VALUE 'DS'.   05360024
053700         88   PV-STATUS-3-POSTED                    VALUE 'PD'.   05370024
053800     05  PV-STATUS-4                     PIC X(02)  VALUE SPACES. 05380024
053900         88   PV-STATUS-4-NEW                       VALUE 'NW'.   05390024
054000         88   PV-STATUS-4-CANCELLED                 VALUE 'CA'.   05400024
054100         88   PV-STATUS-4-INPROCESS                 VALUE 'IP'.   05410024
054200         88   PV-STATUS-4-DISTRIBTD                 VALUE 'DS'.   05420024
054300         88   PV-STATUS-4-POSTED                    VALUE 'PD'.   05430024
054400     05  PV-STATUS-5                     PIC X(02)  VALUE SPACES. 05440024
054500         88   PV-STATUS-5-NEW                       VALUE 'NW'.   05450024
054600         88   PV-STATUS-5-CANCELLED                 VALUE 'CA'.   05460024
054700         88   PV-STATUS-5-INPROCESS                 VALUE 'IP'.   05470024
054800         88   PV-STATUS-5-DISTRIBTD                 VALUE 'DS'.   05480024
054900         88   PV-STATUS-5-POSTED                    VALUE 'PD'.   05490024
055000                                                                  05500024
055100     05  PV-PULL-NUMBER                  PIC  9(08) VALUE ZEROES. 05510024
055200     05  PV-REF-NUMBER                   PIC  X(15) VALUE SPACES. 05520024
055300     05  PV-CS-LOCATION                  PIC  9(04) VALUE ZEROES. 05530024
055400     05  PV-LINE-NUMBER                  PIC  9(04) VALUE ZEROES. 05540024
055500     05  PV-CEPLIT-ITM-NBR               PIC  9(15) VALUE ZEROES. 05550024
055600     05  PV-LINE-ITEM                    PIC  9(15) VALUE ZEROES. 05560024
055700     05  PV-UPC                          PIC  9(15) VALUE ZEROES. 05570024
055800     05  PV-SKU-NUMBER                   PIC  X(10) VALUE SPACES. 05580024
055900     05  PV-SKU-NBR                      PIC  X(08) VALUE SPACES. 05590024
056000     05  PV-SKU-DESCRIPTION              PIC  X(15) VALUE SPACES. 05600024
056100     05  PV-LINE-STATUS-CDE              PIC  X(02) VALUE SPACES. 05610024
056200     05  PV-LINE-STATUS-DESC             PIC  X(09) VALUE SPACES. 05620024
056300     05  PV-NBR-STORES                   PIC  9(05) VALUE ZEROES. 05630024
056400     05  PV-REQ-PULL-UNITS               PIC  9(06) VALUE ZEROES. 05640024
056500     05  PV-ACT-PULL-UNITS               PIC  9(06) VALUE ZEROES. 05650024
056600     05  PV-DISTRBUTED-UNITS             PIC  9(06) VALUE ZEROES. 05660024
056700     05  PV-UPDATE-UNITS                 PIC  9(05) VALUE ZEROES. 05670024
056800                                                                  05680024
056900     05  PV-CS-PRINTER-ID                PIC  X(08) VALUE SPACES. 05690024
057000     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 05700024
057100     05  PV-PULL-STATUS-CDE              PIC  X(02) VALUE SPACES. 05710024
057200     05  PV-PULL-SOURCE-CDE              PIC  X(02) VALUE SPACES. 05720024
057300     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 05730024
057400     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 05740024
057500     05  PV-DIST-PULL-UNITS              PIC  9(06) VALUE ZEROES. 05750024
057600                                                                  05760024
057700     05  PV-SEL-TERM-ID                  PIC  X(04).              05770024
057800     05  PV-SEL-TASK-NUMBER              PIC  9(05).              05780024
057900     05  PV-SEL-SEQ                      PIC  9(01).              05790024
058000                                                                  05800024
058100     05  PV-LINES-POSTED-DISTRB          PIC S9(09)  COMP.        05810024
058200     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     05820024
058300                                                     COMP SYNC.   05830024
058400     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      05840024
058500     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      05850024
058600     05  PV-SEL-CNCL-CNT                 PIC S9(09)  COMP-3       05860024
058700                                                     VALUE ZEROES.05870024
058800     05  PV-SEL-UNCNCL-CNT               PIC S9(09)  COMP-3       05880024
058900                                                     VALUE ZEROES.05890024
059000     05  PV-NUMBER-OF-STORES             PIC  9(05)  VALUE ZEROES.05900024
059100     05  PV-4-DIGIT-STORE                PIC  Z(04)  VALUE ZEROES.05910024
059200     05  PV-SELECTED                     PIC S9(09)  VALUE ZEROES 05920024
059300                                                     COMP-3.      05930024
059400     05  PV-17-DIGIT-NUMBER              PIC  X(17)  VALUE ZEROES.05940024
059500     05  PV-17-DIGIT-NUMBER-R REDEFINES PV-17-DIGIT-NUMBER.       05950024
059600         10  PV-15-DIGIT-NUMBER          PIC  9(15).              05960024
059700         10  FILLER                      PIC  9(02).              05970024
059800     05  PV-QM-NAME                     PIC X(48).                05980024
059900     05  PV-MSGLENGTH            PIC S9(9) BINARY VALUE +1083.    05990024
060000     05  PV-DATA-LENGTH          PIC S9(9) BINARY.                06000024
060100     05  PV-SELECT-COUNT         PIC S9(9) BINARY VALUE 1.        06010024
060200     05  PV-SELECTOR-TABLE.                                       06020024
060300         10  PV-SELECTOR         PIC S9(9) BINARY OCCURS 1 TIMES. 06030024
060400     05  PV-INT-ATTR-COUNT       PIC S9(9) BINARY VALUE 0.        06040024
060500     05  PV-INT-ATTR-TABLE.                                       06050024
060600         10  PV-INT-ATTR         PIC S9(9) BINARY OCCURS 1 TIMES. 06060024
060700     05  PV-CHAR-ATTR-LENGTH     PIC S9(9) BINARY VALUE 48.       06070024
060800     05  PV-CHAR-ATTRS           PIC X(48).                       06080024
060900     05  PV-HCONN                PIC S9(9) BINARY VALUE 0.        06090024
061000     05  PV-GQ-HANDLE            PIC S9(9) BINARY VALUE 0.        06100024
061100     05  PV-PQ-HANDLE            PIC S9(9) BINARY VALUE 0.        06110024
061200     05  PV-OPEN-OPTIONS         PIC S9(9) BINARY.                06120024
061300     05  PV-COMPLETION-CODE      PIC S9(9) BINARY.                06130024
061400     05  PV-REASON               PIC S9(9) BINARY.                06140024
061500     05  PV-CON-REASON           PIC S9(9) BINARY.                06150024
061600     05  PV-OBJECTNAME           PIC X(48).                       06160024
061700     05  PV-OBJECTQMGRNAME       PIC X(48).                       06170024
061800     05  PV-INSUFFIFIENT-QTY     PIC X(40)                        06180033
061900               VALUE 'INSUFFICIENT QUANTITY FOR OPERATION'.       06190033
062000     05  PV-SKU-NOT-FOUND        PIC X(40)                        06200033
062100               VALUE 'SKU NOT FOUND'.                             06210033
062200     05  WS-MQCHECK              PIC  X(08)   VALUE 'MQR2C'.      06220037
062300     05  PV-MQ-REASON-TEXT       PIC  X(30)   VALUE SPACES.       06230037
062400                                                                  06240037
062500******************************************************************06250024
062600**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **06260024
062700**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **06270024
062800**  APPLICATION-SPECIFIC COMMAREA.                              **06280024
062900******************************************************************06290024
063000 01  LQW-LIST-QUEUE-WORK-AREA.                                    06300024
063100     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  06310024
063200     05  LQW-ITEM-ENTRIES               OCCURS 12 TIMES           06320024
063300                                        INDEXED BY LQW-IDX.       06330024
063400         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       06340024
063500         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               06350024
063600         10  LQW-SELECTED-SW            PIC  X(01).               06360024
063700             88  LQW-SELECT                         VALUE 'S'.    06370024
063800             88  LQW-DESELECT                       VALUE ' '.    06380024
063900         10  LQW-ACTION                 PIC  X(03).               06390024
064000             88  LQW-DEL                            VALUE 'DEL'.  06400024
064100             88  LQW-INQ                            VALUE 'INQ'.  06410024
064200             88  LQW-UPD                            VALUE 'UPD'.  06420024
064300             88  LQW-ERR                            VALUE 'ERR'.  06430024
064400             88  LQW-ADD                            VALUE 'ADD'.  06440024
064500         10  LQW-SKU                    PIC  X(10).               06450024
064600         10  LQW-UNITS                  PIC  Z(05).               06460024
064700         10  LQW-AVAIL-UNITS            PIC  Z(05).               06470028
064800         10  LQW-LINE-NBR               PIC  Z(04).               06480024
064900         10  LQW-SKU-DESCRIPTION        PIC  X(25).               06490024
065000         10  LQW-SKU-RETAIL             PIC  Z(05).99.            06500024
065100         10  LQW-UPC                    PIC  X(15).               06510024
065200         10  LQW-LINE-ITEM              PIC  9(15).               06520024
065300                                                                  06530024
065400*---------------------------------------------------------------* 06540024
065500* SELECTON QUEUE LAYOUT                                         * 06550024
065600*---------------------------------------------------------------* 06560024
065700     COPY CEWS003.                                                06570024
065800                                                                  06580024
065900*---------------------------------------------------------------* 06590024
066000* MQ SERIES MESSAGE LAYOUT                                        06600024
066100*---------------------------------------------------------------* 06610024
066200     COPY CERD016.                                                06620024
066300                                                                  06630024
066400*---------------------------------------------------------------* 06640024
066500*    MAP LAYOUT                                                 * 06650024
066600*---------------------------------------------------------------* 06660024
066700     COPY CEKM606.                                                06670024
066800*                                                                 06680024
066900 01  MR-OCCURS-LAYOUT                   REDEFINES  CE606AO.       06690024
067000     05  FILLER                         PIC X(148).               06700024
067100     05  MR-SCROLL-AREA                 OCCURS 12 TIMES.          06710024
067200         10  MR-SELECTL                 PIC S9(04) COMP.          06720024
067300         10  MR-SELECTA                 PIC  X(01).               06730024
067400         10  MR-SELECTC                 PIC  X(01).               06740024
067500         10  MR-SELECTH                 PIC  X(01).               06750024
067600         10  MR-SELECTI                 PIC  X(01).               06760024
067700                                                                  06770024
067800         10  MR-ACTIONL                 PIC S9(04) COMP.          06780024
067900         10  MR-ACTIONA                 PIC  X(01).               06790024
068000         10  MR-ACTIONC                 PIC  X(01).               06800024
068100         10  MR-ACTIONH                 PIC  X(01).               06810024
068200         10  MR-ACTION                  PIC  X(03).               06820024
068300                                                                  06830024
068400         10  MR-UPCL                    PIC S9(04) COMP.          06840024
068500         10  MR-UPCA                    PIC  X(01).               06850024
068600         10  MR-UPCC                    PIC  X(01).               06860024
068700         10  MR-UPCH                    PIC  X(01).               06870024
068800         10  MR-UPC-X.                                            06880024
068900             15  MR-UPC                 PIC  X(15).               06890024
069000                                                                  06900024
069100         10  MR-UNITSL                  PIC S9(04) COMP.          06910024
069200         10  MR-UNITSA                  PIC  X(01).               06920024
069300         10  MR-UNITSC                  PIC  X(01).               06930024
069400         10  MR-UNITSH                  PIC  X(01).               06940024
069500         10  MR-UNITS-X.                                          06950024
069600             15  MR-UNITS               PIC  Z(05).               06960024
069700                                                                  06970024
069800         10  MR-A-UNITSL                PIC S9(04) COMP.          06980024
069900         10  MR-A-UNITSA                PIC  X(01).               06990024
070000         10  MR-A-UNITSC                PIC  X(01).               07000024
070100         10  MR-A-UNITSH                PIC  X(01).               07010024
070200         10  MR-A-UNITS-X.                                        07020024
070300             15  MR-A-UNITS             PIC  Z(05).               07030024
070400                                                                  07040024
070500         10  MR-LINE-NUMBERL            PIC S9(04) COMP.          07050024
070600         10  MR-LINE-NUMBERA            PIC  X(01).               07060024
070700         10  MR-LINE-NUMBERC            PIC  X(01).               07070024
070800         10  MR-LINE-NUMBERH            PIC  X(01).               07080024
070900         10  MR-LINE-NUMBER-X.                                    07090024
071000             15  MR-LINE-NUMBER         PIC  Z(04).               07100024
071100                                                                  07110024
071200         10  MR-SKUL                    PIC S9(04) COMP.          07120024
071300         10  MR-SKUA                    PIC  X(01).               07130024
071400         10  MR-SKUC                    PIC  X(01).               07140024
071500         10  MR-SKUH                    PIC  X(01).               07150024
071600         10  MR-SKU                     PIC  X(10).               07160024
071700                                                                  07170024
071800         10  MR-SKU-DESCL               PIC S9(04) COMP.          07180024
071900         10  MR-SKU-DESCA               PIC  X(01).               07190024
072000         10  MR-SKU-DESCC               PIC  X(01).               07200024
072100         10  MR-SKU-DESCH               PIC  X(01).               07210024
072200         10  MR-SKU-DESC                PIC  X(16).               07220024
072300                                                                  07230024
072400         10  MR-SKU-RETAILL             PIC S9(04) COMP.          07240024
072500         10  MR-SKU-RETAILA             PIC  X(01).               07250024
072600         10  MR-SKU-RETAILC             PIC  X(01).               07260024
072700         10  MR-SKU-RETAILH             PIC  X(01).               07270024
072800         10  MR-SKU-RETAIL              PIC  Z(05).99.            07280024
072900                                                                  07290024
073000     05  FILLER                         PIC  X(12).               07300024
073100                                                                  07310024
073200*----------------------------------------------------------------*07320024
073300*  SENDING/RECEIVING AREA FOR THE                                *07330024
073400*  PRINTER VALIDATION ROUTING (DPKCS060)                         *07340024
073500*----------------------------------------------------------------*07350024
073600     COPY DPWS072.                                                07360024
073700                                                                  07370024
073800*---------------------------------------------------------------* 07380024
073900*    ATTRIBUTE SETTINGS COPYBOOK.                               * 07390024
074000*---------------------------------------------------------------* 07400024
074100     COPY DPWS015.                                                07410024
074200                                                                  07420024
074300     COPY EPWS000.                                                07430024
074400                                                                  07440024
074500*---------------------------------------------------------------* 07450024
074600*    FUNCTION KEYS COPYBOOK.                                    * 07460024
074700*---------------------------------------------------------------* 07470024
074800     COPY DPWS016.                                                07480024
074900                                                                  07490024
075000*---------------------------------------------------------------* 07500024
075100*    NUMERIC EDIT LAYOUT.                                       * 07510024
075200*---------------------------------------------------------------* 07520024
075300     COPY DPWS010I.                                               07530024
075400                                                                  07540063
075500*---------------------------------------------------------------* 07550024
075600*    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 07560085
075700*---------------------------------------------------------------* 07570024
075800     COPY DPWS030.                                                07580024
075810     COPY DPWS930.                                                07581085
075900                                                                  07590063
076000*---------------------------------------------------------------* 07600024
076100*    STANDARD COMMAREA.                                         * 07610024
076200*---------------------------------------------------------------* 07620024
076300     COPY DPWS020.                                                07630024
076400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                07640024
076500                                                                  07650024
076600*---------------------------------------------------------------* 07660024
076700* INTER-APPLICATION COMMAREA.                                   * 07670024
076800*   CEWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 07680024
076900*             SPEC SCREEN.                                      * 07690024
077000*   CEWS002 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 07700024
077100*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 07710024
077200*   CEWS006 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 07720024
077300*             THIS LIST PROGRAMMING -ADD BY SKU/UPC FUNCTION.   * 07730024
077400*---------------------------------------------------------------* 07740024
077500                                                                  07750024
077600         10  INTER-APPL-COMM-AREA       PIC X(200).               07760024
077700     COPY CEWS001.                                                07770024
077800     COPY CEWS002.                                                07780024
077900     COPY CEWS006.                                                07790024
078000*---------------------------------------------------------------* 07800024
078100*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 07810024
078200*---------------------------------------------------------------* 07820024
078300         10  ASC-SPECIFIC-COMMAREA.                               07830024
078400             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          07840024
078500             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 07850024
078600                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          07860024
078700             15  ASC-CURR-FCLTY-ID           PIC  X(04).          07870024
078800             15  ASC-CURR-FCLTY-ID-N REDEFINES                    07880024
078900                     ASC-CURR-FCLTY-ID       PIC  9(04).          07890024
079000             15  ASC-CS-LOC                  PIC  X(04).          07900024
079100             15  ASC-CS-LOC-R REDEFINES ASC-CS-LOC.               07910024
079200                 20  ASC-CS-LOC-N            PIC  9(04).          07920024
079300             15  ASC-CS-LOCATION-DESC        PIC  X(25).          07930024
079400             15  ASC-CS-PRINTER-ID           PIC  X(08).          07940024
079500             15  ASC-PULL-NBR                PIC  X(09).          07950024
079600             15  ASC-PULL-NBR-R REDEFINES ASC-PULL-NBR.           07960024
079700                 20  ASC-PULL-NBR-N          PIC  9(09).          07970024
079800             15  ASC-REF-NBR                 PIC  X(15).          07980024
079900             15  ASC-PULL-STATUS             PIC  X(02).          07990024
080000                 88  ASC-PULL-CANCELLED           VALUE 'CA'.     08000024
080100                 88  ASC-PULL-DISTRIBUTED         VALUE 'DS'.     08010024
080200                 88  ASC-PULL-IN-PROCESS          VALUE 'IP'.     08020024
080300                 88  ASC-PULL-NEW                 VALUE 'NW'.     08030024
080400                 88  ASC-PULL-POSTED              VALUE 'PD'.     08040024
080500             15  ASC-PULL-TYPE               PIC  X(02).          08050024
080600                 88  ASC-PULL-SRC-ADAM            VALUE 'MA'.     08060024
080700                 88  ASC-PULL-SRC-INFOREM         VALUE 'MR'.     08070024
080800                 88  ASC-PULL-SRC-MANUAL          VALUE 'UC'.     08080024
080810                 88  ASC-PULL-SRC-MANUAL          VALUE 'XF'.     08081085
080900             15  ASC-LAST-UPC-ENTERED        PIC  X(15).          08090024
081000             15  ASC-LAST-SKU-ENTERED        PIC  X(10).          08100024
081100             15  ASC-USER-ID                 PIC  X(08).          08110024
081200             15  ASC-STORE-NBR               PIC  9(05).          08120024
081300                                                                  08130024
081400             15  FILLER                      PIC  X(114).         08140024
081500*-----------------------------------------------------------------08150024
081600             15  ASC-BLK-SUB                  PIC S9(04) COMP     08160024
081700                                                         SYNC.    08170024
081800             15  ASC-ITEM-SUB                 PIC S9(04) COMP     08180024
081900                                                         SYNC.    08190024
082000             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  08200024
082100             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  08210024
082200             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  08220024
082300             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  08230024
082400             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  08240024
082500             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     08250024
082600                                                         SYNC.    08260024
082700             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  08270024
082800             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  08280024
082900             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         08290024
083000                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     08300024
083100                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     08310024
083200             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         08320024
083300                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     08330024
083400                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     08340024
083500             15  ASC-LIST-QUEUE-NAME.                             08350024
083600                 20  ASC-LIST-TERM-ID         PIC  X(04).         08360024
083700                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  08370024
083800                 20  ASC-LIST-SEQ             PIC  9(01).         08380024
083900                                                                  08390024
084000             15  ASC-START-ITEM-REQUEST.                          08400024
084100                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         08410024
084200                                                                  08420024
084300             15  ASC-SEL-SUB                  PIC S9(4) COMP.     08430024
084400             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     08440024
084500             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          08450024
084600                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 08460024
084700             15  ASC-SEL-QUEUE-NAME.                              08470024
084800                 20  ASC-SEL-TERM-ID          PIC  X(04).         08480024
084900                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  08490024
085000                 20  ASC-SEL-SEQ              PIC  9(01).         08500024
085100             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  08510024
085200                                                                  08520024
085300*-----------------------------------------------------------------08530024
085400                                                                  08540024
085500             15  ASC-BLOCK-ENTRIES OCCURS 1 TIMES.                08550024
085600                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  08560024
085700                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   08570024
085800                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   08580024
085900                                                                  08590024
086000                 20  ASC-ITEM-ARRAY.                              08600024
086100                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        08610024
086200                         30  ASC-LIST-ITEM-NUMBER                 08620024
086300                                                     PIC S9(09)   08630024
086400                                                     COMP-3.      08640024
086500                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  08650024
086600                             88  ASC-VALID-SELECT    VALUE ' '    08660024
086700                                                           'S'    08670024
086800                                                           'B'    08680024
086900                                                           'E'.   08690024
087000                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   08700024
087100                             88  ASC-TEMP-SELECT     VALUE 'S'.   08710024
087200                             88  ASC-TEMP-BEGIN      VALUE 'B'.   08720024
087300                             88  ASC-TEMP-END        VALUE 'E'.   08730024
087400                         30  ASC-SELECTED-SW         PIC  X(01).  08740024
087500                             88  ASC-NO-SELECT       VALUE ' '.   08750024
087600                             88  ASC-SELECT          VALUE 'S'.   08760024
087700                             88  ASC-BEGIN           VALUE 'B'.   08770024
087800                             88  ASC-END             VALUE 'E'.   08780024
087900                         30  ASC-ACTION              PIC  X(03).  08790024
088000                         30  ASC-SKU                 PIC  X(10).  08800024
088100                         30  ASC-UNITS               PIC  X(05).  08810024
088200                         30  ASC-UNITS-R REDEFINES ASC-UNITS.     08820024
088300                             35  ASC-UNITS-N         PIC  9(05).  08830024
088400                         30  ASC-AVAIL-UNITS         PIC  X(05).  08840024
088500                         30  ASC-AVAIL-UNITS-R REDEFINES          08850024
088600                             ASC-AVAIL-UNITS.                     08860024
088700                             35  ASC-AVAIL-UNITS-N   PIC  9(05).  08870024
088800                         30  ASC-LINE-NBR            PIC  X(04).  08880024
088900                         30  ASC-LINE-NBR-R REDEFINES             08890024
089000                                            ASC-LINE-NBR.         08900024
089100                             35  ASC-LINE-NBR-N      PIC  9(04).  08910024
089200                         30  ASC-SKU-DESCRIPTION     PIC  X(25).  08920024
089300                         30  ASC-SKU-RETAIL        PIC  9(05).99. 08930024
089400                         30  ASC-UPC               PIC  X(15).    08940024
089500                         30  ASC-UPC-R REDEFINES ASC-UPC.         08950024
089600                             35  ASC-UPC-N         PIC  9(15).    08960024
089700                         30  ASC-LINE-ITEM         PIC  X(15).    08970024
089800                         30  ASC-LINE-ITEM-R REDEFINES            08980024
089900                                             ASC-LINE-ITEM.       08990024
090000                             35  ASC-LINE-ITEM-N   PIC  9(15).    09000024
090100                                                                  09010024
090200*---------------------------------------------------------------* 09020024
090300*    ABEND PROCESSING COPYBOOK.                                 * 09030024
090400*---------------------------------------------------------------* 09040024
090500     COPY DPWS013.                                                09050024
090600                                                                  09060063
090700*---------------------------------------------------------------* 09070024
090800*    TCEPLRQ - CENTRAL STOCK PULL REQUESTS                      * 09080024
090900*---------------------------------------------------------------* 09090024
091000     EXEC SQL                                                     09100024
091100          INCLUDE TCEPLRQ                                         09110024
091200     END-EXEC.                                                    09120024
091300*---------------------------------------------------------------* 09130024
091400*    TCEPLDS - CENTRAL STOCK PULL DISTRIBUTION                  * 09140024
091500*---------------------------------------------------------------* 09150024
091600     EXEC SQL                                                     09160024
091700          INCLUDE TCEPLDS                                         09170024
091800     END-EXEC.                                                    09180024
091900*---------------------------------------------------------------* 09190024
092000*    TCEPLIT - CENTRAL STOCK PULL ITEMS                         * 09200024
092100*---------------------------------------------------------------* 09210024
092200     EXEC SQL                                                     09220024
092300          INCLUDE TCEPLIT                                         09230024
092400     END-EXEC.                                                    09240024
092500*---------------------------------------------------------------* 09250024
092600*    TCEPLST - CENTRAL STOCK PULL STATUS                        * 09260024
092700*---------------------------------------------------------------* 09270024
092800     EXEC SQL                                                     09280024
092900          INCLUDE TCEPLST                                         09290024
093000     END-EXEC.                                                    09300024
093100*---------------------------------------------------------------* 09310024
093200*    TUPCSKU - UPC TABLE                                        * 09320024
093300*---------------------------------------------------------------* 09330024
093400     EXEC SQL                                                     09340024
093500          INCLUDE TUPCSKU                                         09350024
093600     END-EXEC.                                                    09360024
094300*-----------------------------------------------------------------09430024
094400*  SQL AND COBOL DECLARATIONS FOR THE KOHLS/RETEK PARMS (TKRPRPM) 09440024
094500*-----------------------------------------------------------------09450024
094600     EXEC SQL                                                     09460024
094700          INCLUDE TKRPRPM                                         09470024
094800     END-EXEC.                                                    09480024
094900                                                                  09490024
095000*---------------------------------------------------------------* 09500024
095100*    DB2 AREA FOR COMMUNICATIONS                                * 09510024
095200*---------------------------------------------------------------* 09520024
095300     EXEC SQL                                                     09530024
095400          INCLUDE SQLCA                                           09540024
095500     END-EXEC.                                                    09550024
095600                                                                  09560024
095700*---------------------------------------------------------------* 09570024
095800*    LINE ITEM CURSOR                                           * 09580024
095900*---------------------------------------------------------------* 09590024
096000                                                                  09600024
096100     EXEC SQL                                                     09610024
096200          DECLARE LINE-ITEM-CSR CURSOR FOR                        09620024
096300              SELECT  CNSTK_REQ_PL_NBR                            09630024
096400                     ,PL_LNE_NBR                                  09640024
096500                     ,ITM_NBR                                     09650024
096600                     ,PL_REQ_QTY                                  09660024
096700                     ,ACTL_PL_QTY                                 09670024
096800                     ,STAT_CDE                                    09680024
096900                     ,UNT_RTL_AMT                                 09690024
097000                FROM  TCEPLIT                                     09700024
097100               WHERE  CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER          09710024
097200            ORDER BY  PL_LNE_NBR                                  09720024
097300     END-EXEC.                                                    09730024
097400                                                                  09740024
097500 LINKAGE SECTION.                                                 09750024
097600                                                                  09760024
097700 01  DFHCOMMAREA.                                                 09770024
097800     05  FILLER                         OCCURS  1 TO 4072 TIMES   09780024
097900                                        DEPENDING ON EIBCALEN.    09790024
098000         10  FILLER                     PIC X.                    09800024
098100                                                                  09810024
098200                                                                  09820063
098300 PROCEDURE DIVISION.                                              09830024
098400******************************************************************09840024
098500**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **09850024
098600**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **09860024
098700**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **09870024
098800******************************************************************09880024
098900 0000-MAIN-MODULE.                                                09890024
099000     INITIALIZE DP030-CICS-API-FIELDS.                            09900024
098400     PERFORM 7010-GET-MAX-LINES.                                  09901089
099100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09910024
099200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09920024
099300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09930024
099400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09940024
099500     MOVE LENGTH OF CE606AI        TO DP030-MAP-LENGTH (1).       09950024
099600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09960024
099700     PERFORM 0001-CALL-CICS-ARCH-API.                             09970024
099800*                                                                 09980024
099900     PERFORM 1000-CONTROL-PROCESSING                              09990024
100000*                                                                 10000024
100100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     10010024
100200     PERFORM 0001-CALL-CICS-ARCH-API.                             10020024
100300                                                                  10030024
100400******************************************************************10040024
100500**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **10050024
100600**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **10060024
100700******************************************************************10070024
100800 0001-CALL-CICS-ARCH-API.                                         10080024
100900     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      10090085
101000                                    DFHCOMMAREA                   10100085
101100                                    DP030-CICS-API-FIELDS         10110085
101200                                    DP020-STANDARD-COMMAREA       10120085
101300                                    CE606AI.                      10130085
101400*                                                                 10140085
101500     IF  DP030-RC-CALL-SUCCESSFUL                                 10150024
101600         CONTINUE                                                 10160024
101700     ELSE                                                         10170024
101800         SET DP013-NO-ROLLBACK                                    10180024
101900             DP013-XCTL-DISPLAY-RESTART                           10190024
102000             DP013-CICS-ABEND      TO TRUE                        10200024
102100         MOVE '0001-CALL-CICS-ARCH-API'                           10210024
102200                                   TO DP013-PARAGRAPH             10220024
102300         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O10230085
102400-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10240085
102500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10250024
102600         PERFORM DP013-0000-PROCESS-ABEND                         10260024
102700     END-IF.                                                      10270024
102800*----------------------------------------------------------------*10280024
102900* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10290024
103000* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10300024
103100*                                                                *10310024
103200* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10320024
103300*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10330024
103400*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10340024
103500*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10350024
103600*----------------------------------------------------------------*10360024
103700                                                                  10370024
103800 1000-CONTROL-PROCESSING.                                         10380024
103900                                                                  10390024
104000     EVALUATE TRUE                                                10400024
104100         WHEN DP020-NEXT-ACT-INITIAL                              10410024
104200             INITIALIZE ASC-SPECIFIC-COMMAREA                     10420024
104300             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            10430024
104400                                      ASC-SEL-TERM-ID             10440024
104500             MOVE DP020-SRC-TASK-NUMBER                           10450024
104600                                   TO ASC-LIST-TASK-NUMBER        10460024
104700                                      ASC-SEL-TASK-NUMBER         10470024
104800             MOVE PC-LIST-QUEUE-SEQ                               10480024
104900                                   TO ASC-LIST-SEQ                10490024
105000             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 10500024
105100             PERFORM 1100-PROCESS-INTER-APPL-COMM                 10510024
105200***-----$TEMPLATE NOTE$-------------------------------------------10520024
105300*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,10530024
105400*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  10540024
105500*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.10550024
105600***---------------------------------------------------------------10560024
105700             IF  PS-COMMAREA-NOT-VALID                            10570024
105800                 SET DP020-NEXT-ACT-APPL-ERROR                    10580024
105900                                   TO TRUE                        10590024
106000             ELSE                                                 10600024
106100                 PERFORM 4000-BUILD-INITIAL-PANEL                 10610024
106200             END-IF                                               10620024
106300                                                                  10630024
106400         WHEN DP020-NEXT-ACT-READ-MAP                             10640024
106500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10650024
106600                                   TO PV-TOP-ITEM                 10660024
106700             PERFORM 2000-PROCESS-PANEL                           10670024
106800                                                                  10680024
106900         WHEN DP020-NEXT-ACT-RETURN                               10690024
107000             MOVE 1  TO  ASC-ITEM-AT-TOP-OF-PANEL                 10700024
107100             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10710024
107200                                   TO PV-TOP-ITEM                 10720024
107300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10730024
107400             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 10740024
107500             PERFORM 3200-RESET-ATTRIBUTES                        10750024
107600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10760024
107700                                                                  10770024
107800         WHEN OTHER                                               10780024
107900             SET DP013-LOGIC-ABEND TO TRUE                        10790024
108000             SET DP013-NO-ROLLBACK TO TRUE                        10800024
108100             MOVE '1000-CONTROL-PROCESSING'                       10810024
108200                                   TO DP013-PARAGRAPH             10820024
108300             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10830024
108400                                   TO DP013-MESSAGE-TEXT(1)       10840024
108500             PERFORM DP013-0000-PROCESS-ABEND                     10850024
108600     END-EVALUATE.                                                10860024
108700                                                                  10870024
108800                                                                  10880024
108900*----------------------------------------------------------------*10890024
109000* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *10900024
109100* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *10910024
109200*----------------------------------------------------------------*10920024
109300 1100-PROCESS-INTER-APPL-COMM.                                    10930024
109400                                                                  10940024
109500     SET PS-COMMAREA-VALID         TO TRUE.                       10950024
109600     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     10960024
109700                                                                  10970024
109800     MOVE CE006-CURR-OPER-UNT-ID-N TO ASC-CURR-OPER-UNT-ID-N.     10980024
109900     MOVE CE006-CURR-FCLTY-ID-N    TO ASC-CURR-FCLTY-ID-N.        10990024
110000     MOVE CE006-CS-LOCATION        TO ASC-CS-LOC-N.               11000024
110100     MOVE CE006-CS-PRINTER-ID      TO ASC-CS-PRINTER-ID.          11010024
110200     MOVE CE006-PULL-NBR           TO ASC-PULL-NBR-N.             11020024
110300     MOVE CE006-REF-NBR            TO ASC-REF-NBR.                11030024
110400     MOVE CE006-USER-ID            TO ASC-USER-ID.                11040024
110500     MOVE CE006-STORE-NBR          TO ASC-STORE-NBR.              11050024
110510     MOVE CE006-PULL-TYPE          TO ASC-PULL-TYPE.              11051085
110600                                                                  11060024
110700*----------------------------------------------------------------*11070024
110800* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *11080024
110900* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *11090024
111000* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *11100024
111100* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *11110024
111200* FUNCTION KEYS CAN GET THIS FAR.                                *11120024
111300*----------------------------------------------------------------*11130024
111400                                                                  11140024
111500 2000-PROCESS-PANEL.                                              11150024
111600     EVALUATE TRUE                                                11160024
111700         WHEN DP020-SRC-AID = DP016-CLEAR                         11170024
111800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11180024
111900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11190024
112000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11200024
112100                                                                  11210024
112200         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11220024
112300             PERFORM 2050-DELETE-LIST-QUEUE                       11230024
112400             PERFORM 4000-BUILD-INITIAL-PANEL                     11240024
112500                                                                  11250024
112600         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    11260024
112700             PERFORM 2140-DESELECT-ALL-ITEMS                      11270024
112800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11280024
112900                                                                  11290024
113000         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  11300024
113100             PERFORM 2150-SELECT-ALL-ITEMS                        11310024
113200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11320024
113300                                                                  11330024
113400         WHEN OTHER                                               11340024
113500             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11350024
113600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11360024
113700                                                                  11370024
113800             IF  PS-NO-ERROR                                      11380024
113900                 SET DP030-CONTINUE-GO                            11390024
114000                                 TO TRUE                          11400024
114100                 PERFORM 2100-CHECK-FUNCTION-KEY                  11410024
114200             ELSE                                                 11420024
114300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11430024
114400                 SET DP030-OVERRIDE-GO                            11440024
114500                                 TO TRUE                          11450024
114600             END-IF                                               11460024
114700     END-EVALUATE.                                                11470024
114800 EJECT                                                            11480024
114900*----------------------------------------------------------------*11490024
115000*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *11500024
115100*----------------------------------------------------------------*11510024
115200 2050-DELETE-LIST-QUEUE.                                          11520024
115300                                                                  11530024
115400     EXEC CICS                                                    11540024
115500         DELETEQ TS                                               11550024
115600             QUEUE (ASC-LIST-QUEUE-NAME)                          11560024
115700             RESP  (PV-CICS-RESP)                                 11570024
115800     END-EXEC.                                                    11580024
115900                                                                  11590024
116000     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       11600024
116100        (PV-CICS-RESP = DFHRESP(QIDERR))                          11610024
116200         CONTINUE                                                 11620024
116300     ELSE                                                         11630024
116400         SET DP013-CICS-ABEND      TO TRUE                        11640024
116500         SET DP013-NO-ROLLBACK     TO TRUE                        11650024
116600                                                                  11660024
116700         MOVE '2050-DELETE-LIST-QUEUE'                            11670024
116800                                   TO DP013-PARAGRAPH             11680024
116900         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    11690024
117000                                   TO DP013-MESSAGE-TEXT (1)      11700024
117100         PERFORM DP013-0000-PROCESS-ABEND                         11710024
117200     END-IF.                                                      11720024
117300                                                                  11730024
117400     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  11740024
117500 EJECT                                                            11750024
117600*----------------------------------------------------------------*11760024
117700* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*11770024
117800* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *11780024
117900* CICS ARCHITECTURE API.                                         *11790024
118000*----------------------------------------------------------------*11800024
118100 2100-CHECK-FUNCTION-KEY.                                         11810024
118200                                                                  11820024
118300     EVALUATE TRUE                                                11830024
118400*                                                                 11840024
118500* F13 - ADD LINE ITEMS   (LOCAL-FUNC-01)                          11850024
118600*                                                                 11860024
118700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              11870024
118800             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              11880024
118900                 PERFORM 4700-PROCESS-ADD-FUNCTION                11890024
119000                     VARYING PV-ITEM  FROM 1 BY 1                 11900024
119100                     UNTIL PV-ITEM >  1                           11910024
119200                        OR PS-SOFT-ABORT-ERROR                    11920024
119300                 MOVE  +1  TO  PV-TOP-ITEM                        11930024
119400                               ASC-LIST-ITEM-NUMBER (1 1)         11940024
119500                               ASC-ITEM-AT-TOP-OF-PANEL           11950024
119600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11960024
119700             ELSE                                                 11970024
119800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11980024
119900                 SET DP030-OVERRIDE-GO                            11990024
120000                                   TO TRUE                        12000024
120100                 MOVE PC-TSYMSG-00057                             12010024
120200                                   TO DP020-MSG-NUMBER            12020024
120300                 SET DP020-MSG-WARNING                            12030024
120400                                   TO TRUE                        12040024
120500             END-IF                                               12050024
120600*                                                                 12060024
120700* F17 - ITEM LIST       (LOCAL-FUNC-03)                           12070024
120800*                                                                 12080024
120900         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              12090024
121000              MOVE  +1  TO  ASC-ITEM-AT-TOP-OF-PANEL              12100024
121100              INITIALIZE CE001-INTER-APPL-COMMAREA                12110024
121200                                                                  12120024
121300              MOVE ASC-CURR-OPER-UNT-ID-N                         12130024
121400                                    TO CE001-CURR-OPER-UNT-ID-N   12140024
121500              MOVE ASC-CURR-FCLTY-ID-N                            12150024
121600                                    TO CE001-CURR-FCLTY-ID-N      12160024
121700              MOVE ASC-CS-LOC       TO CE001-CS-LOCATION          12170024
121800              MOVE ASC-CS-PRINTER-ID                              12180024
121900                                    TO CE001-CS-PRINTER-ID        12190024
122000              MOVE ASC-PULL-NBR-N   TO CE001-PULL-NBR             12200024
122100              MOVE ASC-REF-NBR      TO CE001-REF-NBR              12210024
122200              SET  CE001-SELECT-ALL                               12220024
122300                   CE001-SELECT-SRC-ALL                           12230024
122400                   CE001-LIST-SEQ-CR-DTE TO TRUE                  12240024
122500              MOVE ZEROES           TO CE001-PULL-SELECT-DATE-FROM12250024
122600              MOVE ZEROES           TO CE001-PULL-SELECT-DATE-TO  12260024
122700              MOVE ASC-PULL-STATUS  TO CE001-CURR-PULL-STATUS     12270024
122800              MOVE ASC-PULL-TYPE    TO CE001-CURR-PULL-TYPE       12280024
122900                                                                  12290024
123000*                                                                 12300024
123100* F16 - ADD BY SKU       (LOCAL-FUNC-02)                          12310063
123200*                                                                 12320024
123300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              12330024
123400                                                                  12340024
123500              MOVE  +1  TO  ASC-ITEM-AT-TOP-OF-PANEL              12350024
123600              INITIALIZE CE006-INTER-APPL-COMMAREA                12360024
123700              MOVE ASC-CURR-OPER-UNT-ID-N                         12370024
123800                                      TO CE006-CURR-OPER-UNT-ID-N 12380024
123900              MOVE ASC-CURR-FCLTY-ID-N                            12390024
124000                                      TO CE006-CURR-FCLTY-ID-N    12400024
124100              MOVE ASC-CS-LOC         TO CE006-CS-LOCATION        12410024
124200              MOVE ASC-CS-PRINTER-ID  TO CE006-CS-PRINTER-ID      12420024
124300              MOVE ASC-PULL-NBR-N     TO CE006-PULL-NBR           12430024
124400              MOVE ASC-REF-NBR        TO CE006-REF-NBR            12440024
124500              MOVE ASC-USER-ID        TO CE006-USER-ID            12450024
124600              MOVE ASC-STORE-NBR      TO CE006-STORE-NBR          12460024
124700*                                                                 12470024
124800* F24 - ADD STORE       (LOCAL-FUNC-04)                           12480024
124900*                                                                 12490024
125000         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              12500024
125100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              12510024
125200                 INITIALIZE CE002-INTER-APPL-COMMAREA             12520024
125300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                12530024
125400                                TO CE002-NUMBER-OF-SELECTED-ITEMS 12540024
125500                 MOVE ASC-CURR-OPER-UNT-ID-N                      12550024
125600                                    TO CE002-CURR-OPER-UNT-ID-N   12560024
125700                 MOVE ASC-CURR-FCLTY-ID-N                         12570024
125800                                    TO CE002-CURR-FCLTY-ID-N      12580024
125900                 MOVE ASC-CS-LOC-N                                12590024
126000                                    TO CE002-CS-LOCATION          12600024
126100                 MOVE ASC-CS-PRINTER-ID                           12610024
126200                                    TO CE002-CS-PRINTER-ID        12620024
126300                 MOVE ASC-PULL-NBR-N                              12630024
126400                                    TO CE002-PULL-NBR             12640024
126500                 MOVE ASC-REF-NBR   TO CE002-REF-NBR              12650024
126600                 MOVE ASC-PULL-STATUS                             12660024
126700                                    TO CE002-PULL-SELECT-STATUS   12670024
126710                 MOVE ASC-PULL-TYPE TO CE002-CURR-PULL-TYPE       12671085
126800                 PERFORM 5000-PREPARE-SEL-QUEUE                   12680024
126900             ELSE                                                 12690024
127000                 SET DP030-OVERRIDE-GO                            12700024
127100                                   TO TRUE                        12710024
127200                 MOVE PC-TSYMSG-00057                             12720024
127300                                   TO DP020-MSG-NUMBER            12730024
127400                 SET DP020-MSG-WARNING                            12740024
127500                                   TO TRUE                        12750024
127600             END-IF                                               12760024
127700*                                                                 12770024
127800* ENTER KEY                                                       12780024
127900*                                                                 12790024
128000         WHEN DP020-SRC-AID = DP016-ENTER                         12800024
128100             MOVE +1 TO ASC-BLK-SUB                               12810024
128200             PERFORM 5100-WRITE-TEMP-STORAGE                      12820024
128300             MOVE 1  TO  ASC-LIST-ITEM-NUMBER (1 1)               12830024
128400             MOVE 1  TO  PV-TOP-ITEM                              12840024
128500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12850024
128600*                                                                 12860024
128700* OTHER KEY                                                       12870024
128800*                                                                 12880024
128900         WHEN OTHER                                               12890024
129000             SET DP013-NO-ROLLBACK                                12900024
129100                 DP013-XCTL-DISPLAY-RESTART                       12910024
129200                 DP013-CICS-ABEND  TO TRUE                        12920024
129300             MOVE '2100-CHECK-FUNCTION-KEY'                       12930024
129400                                   TO DP013-PARAGRAPH             12940024
129500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      12950024
129600                                   TO DP013-MESSAGE-TEXT (1)      12960024
129700             PERFORM DP013-0000-PROCESS-ABEND                     12970024
129800     END-EVALUATE.                                                12980024
129900*                                                                 12990024
130000*----------------------------------------------------------------*13000024
130100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *13010024
130200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *13020024
130300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *13030024
130400*    MESSAGE.                                                    *13040024
130500*----------------------------------------------------------------*13050024
130600                                                                  13060024
130700 2110-BROWSE-BACKWARD.                                            13070024
130800     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    13080024
130900         GIVING PV-TOP-ITEM.                                      13090024
131000*                                                                 13100024
131100     IF  ((PV-TOP-ITEM < +1)                                      13110024
131200       OR (PV-TOP-ITEM = +1))                                     13120024
131300         MOVE +1                   TO PV-TOP-ITEM                 13130024
131400*        -- TOP OF LIST --                                        13140024
131500         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            13150024
131600         SET DP020-MSG-INFORMATIONAL TO TRUE                      13160024
131700     END-IF.                                                      13170024
131800                                                                  13180024
131900 EJECT                                                            13190024
132000*----------------------------------------------------------------*13200024
132100*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *13210024
132200*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *13220024
132300*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *13230024
132400*----------------------------------------------------------------*13240024
132500                                                                  13250024
132600 2120-BROWSE-FORWARD.                                             13260024
132700                                                                  13270024
132800     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              13280024
132900         GIVING PV-TOP-ITEM.                                      13290024
133000     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   13300024
133100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13310024
133200                                   TO PV-TOP-ITEM                 13320024
133300*        -- BOTTOM OF LIST --                                     13330024
133400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            13340024
133500         SET DP020-MSG-INFORMATIONAL                              13350024
133600                                   TO TRUE                        13360024
133700     ELSE                                                         13370024
133800         COMPUTE PV-BOTTOM-ITEM =                                 13380024
133900             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 13390024
134000         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            13400024
134100*            -- BOTTOM OF LIST --                                 13410024
134200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            13420024
134300             SET DP020-MSG-INFORMATIONAL                          13430024
134400                                   TO TRUE                        13440024
134500         END-IF                                                   13450024
134600     END-IF.                                                      13460024
134700 EJECT                                                            13470024
134800*----------------------------------------------------------------*13480024
134900*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *13490024
135000*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *13500024
135100*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *13510024
135200*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *13520024
135300*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *13530024
135400*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *13540024
135500*----------------------------------------------------------------*13550024
135600                                                                  13560024
135700 2130-CHECK-FOR-JUMP-BROWSE.                                      13570024
135800     SET PS-NO-ERROR               TO TRUE.                       13580024
135900     IF (ASC-START-ITEM-REQUEST = SPACE)                          13590024
136000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13600024
136100                                   TO PV-TOP-ITEM                 13610024
136200     ELSE                                                         13620024
136300         MOVE ASC-START-ITEM-REQUEST                              13630024
136400                                   TO DP010I-UNEDITED-FIELD       13640024
136500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       13650024
136600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     13660024
136700         SET DP010I-NEGATIVE-NOT-ALLOWED                          13670024
136800                                   TO TRUE                        13680024
136900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13690085
136910              USING DP010I-NUMERIC-EDIT-AREA                      13691085
137000                                                                  13700024
137100         IF  NOT DP010I-ERROR-DETECTED                            13710024
137200             MOVE DP010I-NUMERIC-FIELD                            13720024
137300                                   TO  ASC-START-ITEM-REQUEST-N   13730024
137400             IF  ASC-START-ITEM-REQUEST-N > ZERO                  13740024
137500                 IF  ASC-START-ITEM-REQUEST-N >                   13750024
137600                                          ASC-NUMBER-OF-ITEMS-READ13760024
137700                     MOVE SPACE TO ASC-START-ITEM-REQUEST         13770024
137800                     COMPUTE PV-TOP-ITEM =                        13780024
137900                             ASC-NUMBER-OF-ITEMS-READ             13790024
138000                             - PC-ITEMS-PER-PANEL + 1             13800024
138100                     IF  PV-TOP-ITEM < +1                         13810024
138200                         MOVE +1   TO PV-TOP-ITEM                 13820024
138300                         MOVE PC-TSYMSG-00070                     13830024
138400                                   TO DP020-MSG-NUMBER            13840024
138500                         SET DP020-MSG-INFORMATIONAL              13850024
138600                                   TO TRUE                        13860024
138700                     END-IF                                       13870024
138800                 ELSE                                             13880024
138900                     MOVE ASC-START-ITEM-REQUEST-N                13890024
139000                                   TO PV-TOP-ITEM                 13900024
139100                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      13910024
139200                     COMPUTE PV-BOTTOM-ITEM =                     13920024
139300                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     13930024
139400                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ13940024
139500*                        -- BOTTOM OF LIST --                     13950024
139600                         MOVE PC-TSYMSG-00070                     13960024
139700                                   TO DP020-MSG-NUMBER            13970024
139800                         SET DP020-MSG-INFORMATIONAL              13980024
139900                                   TO TRUE                        13990024
140000                     END-IF                                       14000024
140100                 END-IF                                           14010024
140200             ELSE                                                 14020024
140300*                --- VALUE OUT OF RANGE ----                      14030024
140400                 MOVE PC-TSYMSG-00101                             14040024
140500                                   TO DP020-MSG-NUMBER            14050024
140600                 MOVE -1           TO ASEL01L                     14060024
140700                 SET DP030-SET-CURSOR-APPL-1                      14070024
140800                                   TO TRUE                        14080024
140900                 SET DP020-MSG-FATAL                              14090024
141000                                   TO TRUE                        14100024
141100                 SET PS-ERROR      TO TRUE                        14110024
141200             END-IF                                               14120024
141300                                                                  14130024
141400         ELSE                                                     14140024
141500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            14150024
141600             MOVE -1               TO ASEL01L                     14160024
141700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14170024
141800             SET DP020-MSG-FATAL   TO TRUE                        14180024
141900             SET PS-ERROR          TO TRUE                        14190024
142000         END-IF                                                   14200024
142100     END-IF.                                                      14210024
142200 EJECT                                                            14220024
142300*----------------------------------------------------------------*14230024
142400*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *14240024
142500*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *14250024
142600*----------------------------------------------------------------*14260024
142700 2140-DESELECT-ALL-ITEMS.                                         14270024
142800     MOVE +1                       TO ASC-BLK-SUB.                14280024
142900                                                                  14290024
143000     PERFORM 2141-CLEAR-SELECTED-INDS                             14300024
143100         VARYING ASC-ITEM-SUB                                     14310024
143200         FROM 1 BY 1                                              14320024
143300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14330024
143400                                                                  14340024
143500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14350024
143600                                   TO PV-LIST-ITEM-NUMBER.        14360024
143700                                                                  14370024
143800     MOVE  1  TO  PV-FIRST-BLOCK-IN-ARRAY.                        14380024
143900                                                                  14390024
144000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14400024
144100        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      14410024
144200         MOVE +1                   TO ASC-BLK-SUB                 14420024
144300                                                                  14430024
144400         PERFORM 5100-WRITE-TEMP-STORAGE                          14440024
144500                                                                  14450024
144600         MOVE +1                   TO PV-BLOCK-NUMBER             14460024
144700                                                                  14470024
144800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14480024
144900             PV-FIRST-BLOCK-IN-ARRAY - 1                          14490024
145000                                                                  14500024
145100         PERFORM                                                  14510024
145200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14520024
145300                                                                  14530024
145400             PERFORM 4410-READ-TEMP-STORAGE                       14540024
145500                                                                  14550024
145600             PERFORM 2141-CLEAR-SELECTED-INDS                     14560024
145700                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 14570024
145800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14580024
145900                                                                  14590024
146000             PERFORM 5100-WRITE-TEMP-STORAGE                      14600024
146100                                                                  14610024
146200             ADD +1                TO PV-BLOCK-NUMBER             14620024
146300                                                                  14630024
146400         END-PERFORM                                              14640024
146500                                                                  14650024
146600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14660024
146700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14670024
146800                                                                  14680024
146900         PERFORM                                                  14690024
147000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14700024
147100                   ASC-HIGHEST-BLOCK-WRITTEN                      14710024
147200                                                                  14720024
147300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14730024
147400                                   TO PV-BLOCK-NUMBER             14740024
147500                                                                  14750024
147600             PERFORM 4410-READ-TEMP-STORAGE                       14760024
147700                                                                  14770024
147800             PERFORM 2141-CLEAR-SELECTED-INDS                     14780024
147900                 VARYING ASC-ITEM-SUB                             14790024
148000                 FROM 1 BY 1                                      14800024
148100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14810024
148200                                                                  14820024
148300             PERFORM 5100-WRITE-TEMP-STORAGE                      14830024
148400                                                                  14840024
148500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14850024
148600                                                                  14860024
148700         END-PERFORM                                              14870024
148800                                                                  14880024
148900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14890024
149000                                   TO PV-BLOCK-NUMBER             14900024
149100                                                                  14910024
149200         PERFORM 4410-READ-TEMP-STORAGE                           14920024
149300     END-IF.                                                      14930024
149400                                                                  14940024
149500                                                                  14950024
149600     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 14960024
149700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.14970024
149800     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  14980024
149900                                                                  14990024
150000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15000024
150100                                                                  15010024
150200 EJECT                                                            15020024
150300*----------------------------------------------------------------*15030024
150400*    MARK EACH ITEM AS BEING NOT SELECTED.                       *15040024
150500*----------------------------------------------------------------*15050024
150600                                                                  15060024
150700 2141-CLEAR-SELECTED-INDS.                                        15070024
150800                                                                  15080024
150900     IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)              15090024
151000         SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)              15100024
151100             ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        15110024
151200             ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      15120024
151300                              TO TRUE                             15130024
151400     END-IF.                                                      15140024
151500                                                                  15150024
151600                                                                  15160024
151700*----------------------------------------------------------------*15170024
151800*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *15180024
151900*  FOR ALL ITEMS.                                                *15190024
152000*----------------------------------------------------------------*15200024
152100                                                                  15210024
152200 2150-SELECT-ALL-ITEMS.                                           15220024
152300                                                                  15230024
152400     INITIALIZE                       PV-SELECTED.                15240024
152500     MOVE +1                       TO ASC-BLK-SUB.                15250024
152600                                                                  15260024
152700     PERFORM 2151-SET-SELECTED-INDS                               15270024
152800         VARYING ASC-ITEM-SUB                                     15280024
152900         FROM 1 BY 1                                              15290024
153000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15300024
153100                                                                  15310024
153200                                                                  15320024
153300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15330024
153400                                   TO PV-LIST-ITEM-NUMBER.        15340024
153500                                                                  15350024
153600         MOVE  1  TO  PV-FIRST-BLOCK-IN-ARRAY.                    15360024
153700                                                                  15370024
153800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15380024
153900        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    15390024
154000         MOVE +1                   TO ASC-BLK-SUB                 15400024
154100                                                                  15410024
154200         PERFORM 5100-WRITE-TEMP-STORAGE                          15420024
154300                                                                  15430024
154400         MOVE +1                   TO PV-BLOCK-NUMBER             15440024
154500                                                                  15450024
154600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15460024
154700             PV-FIRST-BLOCK-IN-ARRAY - 1                          15470024
154800                                                                  15480024
154900         PERFORM                                                  15490024
155000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15500024
155100                                                                  15510024
155200             PERFORM 4410-READ-TEMP-STORAGE                       15520024
155300                                                                  15530024
155400             PERFORM 2151-SET-SELECTED-INDS                       15540024
155500                 VARYING ASC-ITEM-SUB                             15550024
155600                 FROM 1 BY 1                                      15560024
155700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15570024
155800                                                                  15580024
155900             PERFORM 5100-WRITE-TEMP-STORAGE                      15590024
156000                                                                  15600024
156100             ADD +1                TO PV-BLOCK-NUMBER             15610024
156200                                                                  15620024
156300         END-PERFORM                                              15630024
156400                                                                  15640024
156500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15650024
156600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15660024
156700                                                                  15670024
156800         PERFORM                                                  15680024
156900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15690024
157000                   ASC-HIGHEST-BLOCK-WRITTEN                      15700024
157100                                                                  15710024
157200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15720024
157300                                   TO PV-BLOCK-NUMBER             15730024
157400                                                                  15740024
157500             PERFORM 4410-READ-TEMP-STORAGE                       15750024
157600                                                                  15760024
157700             PERFORM 2151-SET-SELECTED-INDS                       15770024
157800                 VARYING ASC-ITEM-SUB                             15780024
157900                 FROM 1 BY 1                                      15790024
158000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15800024
158100                                                                  15810024
158200             PERFORM 5100-WRITE-TEMP-STORAGE                      15820024
158300                                                                  15830024
158400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15840024
158500                                                                  15850024
158600         END-PERFORM                                              15860024
158700                                                                  15870024
158800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15880024
158900                                   TO PV-BLOCK-NUMBER             15890024
159000                                                                  15900024
159100         PERFORM 4410-READ-TEMP-STORAGE                           15910024
159200     END-IF.                                                      15920024
159300                                                                  15930024
159400                                                                  15940024
159500     MOVE PV-SELECTED TO                                          15950024
159600                       ASC-NUMBER-OF-SELECTED-ITEMS.              15960024
159700                                                                  15970024
159800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15980024
159900                                                                  15990024
160000 EJECT                                                            16000024
160100*----------------------------------------------------------------*16010024
160200*    MARK EACH ITEM AS BEING SELECTED.                           *16020024
160300*----------------------------------------------------------------*16030024
160400                                                                  16040024
160500 2151-SET-SELECTED-INDS.                                          16050024
160600                                                                  16060024
160700     IF  ASC-LINE-ITEM-N(ASC-BLK-SUB ASC-ITEM-SUB) > 0            16070024
160800         ADD  1  TO  PV-SELECTED                                  16080024
160900         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16090024
161000             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16100024
161100                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        16110024
161200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16120024
161300                               TO  TRUE                           16130024
161400         END-IF                                                   16140024
161500     END-IF.                                                      16150024
161600******************************************************************16160024
161700** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **16170024
161800** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **16180024
161900******************************************************************16190024
162000 2200-MOVE-SCREEN-TO-COMMAREA.                                    16200024
162100                                                                  16210024
162200     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             16220024
162300     MOVE +1                       TO PV-SUB.                     16230024
162400*                                                                 16240024
162500     PERFORM 3100-SET-SUBSCRIPTS.                                 16250024
162600     IF  ASEL01L > ZERO                                           16260024
162700         MOVE 1                TO ASC-START-ITEM-REQUEST          16270024
162800     ELSE                                                         16280024
162900         INITIALIZE ASC-START-ITEM-REQUEST                        16290024
163000     END-IF.                                                      16300024
163100                                                                  16310024
163200     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          16320024
163300         VARYING PV-SUB                                           16330024
163400         FROM 1 BY 1                                              16340024
163500         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      16350024
163600******************************************************************16360024
163700** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**16370024
163800******************************************************************16380024
163900 2210-MOVE-LINES-TO-COMMAREA.                                     16390024
164000                                                                  16400024
164100     IF  MR-SELECTL (PV-SUB) > ZERO                               16410024
164200         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             16420024
164300         MOVE MR-SELECTI (PV-SUB)                                 16430024
164400                                   TO ASC-TEMP-SELECTED-SW        16440024
164500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16450024
164600     ELSE                                                         16460024
164700                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     16470024
164800                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        16480024
164900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16490024
165000     END-IF.                                                      16500024
165100                                                                  16510024
165200*                                                                 16520024
165300*** UPC NUMBER                                                    16530024
165400*                                                                 16540024
165500     IF  MR-UPCL (PV-SUB) > ZERO                                  16550024
165600         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             16560024
165700         IF  MR-UPC (PV-SUB) > SPACES                             16570024
165800             MOVE MR-UPC (PV-SUB) TO ASC-UPC                      16580024
165900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16590024
166000             MOVE ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB) TO           16600024
166100                                    DP010I-UNEDITED-FIELD         16610024
166200             MOVE LENGTH OF ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB)    16620024
166300                                 TO DP010I-MAXIMUM-DIGITS         16630024
166400             MOVE ZERO           TO DP010I-MAXIMUM-DECIMALS       16640024
166500             SET DP010I-NEGATIVE-NOT-ALLOWED                      16650024
166600                                     TO TRUE                      16660024
166700             CALL DP010I-NUMERIC-EDIT-ROUTINE                     16670085
166710                  USING DP010I-NUMERIC-EDIT-AREA                  16671085
166800                 IF  DP010I-ERROR-DETECTED                        16680024
166900                     CONTINUE                                     16690024
167000                 ELSE                                             16700024
167100                     MOVE DP010I-NUM-FIELD-17-DIG-0-DEC           16710024
167200                       TO PV-17-DIGIT-NUMBER                      16720024
167300                     MOVE PV-15-DIGIT-NUMBER                      16730024
167400                       TO ASC-UPC-N (ASC-BLK-SUB ASC-ITEM-SUB)    16740024
167500                     MOVE ASC-UPC-N (ASC-BLK-SUB ASC-ITEM-SUB)    16750024
167600                       TO MR-UPC (PV-SUB)                         16760024
167700                     MOVE ZEROES   TO ASC-LINE-ITEM-N             16770024
167800                                     (ASC-BLK-SUB, ASC-ITEM-SUB)  16780024
167900                 END-IF                                           16790024
168000             END-IF                                               16800024
168100     ELSE                                                         16810024
168200         IF  MR-UPCA (PV-SUB) = DP015-ERASE-EOF                   16820024
168300             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         16830024
168400             MOVE ZEROES       TO ASC-UPC-N                       16840024
168500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16850024
168600             MOVE ZEROES       TO ASC-LINE-ITEM-N                 16860024
168700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16870024
168800         END-IF                                                   16880024
168900     END-IF.                                                      16890024
169000                                                                  16900024
169100*                                                                 16910024
169200*** UNITS                                                         16920024
169300*                                                                 16930024
169400     IF  MR-UNITSL (PV-SUB) > ZERO                                16940024
169500         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             16950024
169600         MOVE MR-UNITS (PV-SUB) TO ASC-UNITS                      16960024
169700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16970024
169800         MOVE ASC-UNITS (ASC-BLK-SUB ASC-ITEM-SUB) TO             16980024
169900                                    DP010I-UNEDITED-FIELD         16990024
170000         MOVE LENGTH OF ASC-UNITS                                 17000024
170100                                 TO DP010I-MAXIMUM-DIGITS         17010024
170200         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       17020024
170300         SET DP010I-NEGATIVE-NOT-ALLOWED                          17030024
170400                                 TO TRUE                          17040024
170500         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17050085
170510              USING DP010I-NUMERIC-EDIT-AREA                      17051085
170600             IF  DP010I-ERROR-DETECTED                            17060024
170700                 CONTINUE                                         17070024
170800             ELSE                                                 17080024
170900                 MOVE DP010I-NUMERIC-FIELD                        17090024
171000                   TO ASC-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB)      17100024
171100                      MR-UNITS (PV-SUB)                           17110024
171200             END-IF                                               17120024
171300     ELSE                                                         17130024
171400         IF  MR-UNITSA (PV-SUB) = DP015-ERASE-EOF                 17140024
171500             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         17150024
171600             MOVE ZEROES       TO ASC-UNITS-N                     17160024
171700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17170024
171800         END-IF                                                   17180024
171900     END-IF.                                                      17190024
172000                                                                  17200024
172100     ADD +1                        TO ASC-ITEM-SUB.               17210024
172200                                                                  17220024
172300******************************************************************17230024
172400** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **17240024
172500** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **17250024
172600******************************************************************17260024
172700 3000-EDIT-DATA-IN-COMMAREA.                                      17270024
172800                                                                  17280085
172900     PERFORM 7000-PROCESS-MQ-CHECK.                               17290085
172901                                                                  17290185
172902     SET PS-NO-ERROR               TO TRUE.                       17290224
172903     PERFORM 3200-RESET-ATTRIBUTES.                               17290324
173000     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     17300024
173100                                                                  17310024
173200*-----------------------------------------------------------------17320024
173300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              17330024
173400* EDITTING IS DONE FROM THE BOTTOM UP.                            17340024
173500*-----------------------------------------------------------------17350024
173600                                                                  17360024
173700     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       17370024
173800         ASC-ITEMS-DISPLAYED - 1.                                 17380024
173900     PERFORM 3100-SET-SUBSCRIPTS.                                 17390024
174000                                                                  17400024
174100     MOVE ASC-CS-LOC-N    TO DK-STORE-NUMBER.                     17410085
174300     PERFORM 4600-GET-STORE-INFORMATION                           17430024
174400     EXEC SQL                                                     17440085
174500         SET :PV-CURRENT-DATE = CURRENT DATE                      17450085
174501     END-EXEC.                                                    17450185
174502*                                                                 17450224
174503     PERFORM 3300-EDIT-SELECTIONS                                 17450324
174600       VARYING PV-SUB FROM PV-SUB BY -1                           17460024
174700         UNTIL PV-SUB < +1.                                       17470024
174800*                                                                 17480024
174900     IF PS-MQ-SETUP-COMPLETE                                      17490024
174910       AND PS-PROCESS-MQ-YES                                      17491085
175000         PERFORM 8060-MQ-DISCONNECT                               17500025
175100     END-IF.                                                      17510024
175200*                                                                 17520024
175300     MOVE  +1  TO  ASC-START-OF-SELECTED-RANGE.                   17530024
175400     MOVE  +12 TO  ASC-END-OF-SELECTED-RANGE.                     17540024
175500*                                                                 17550024
175600     IF  PS-NO-ERROR                                              17560024
175700         PERFORM 3400-CHECK-RANGE-SEQUENCE                        17570024
175800     END-IF.                                                      17580024
175900*                                                                 17590024
176000     IF  ((PS-NO-ERROR)                                           17600024
176100       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   17610024
176200       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    17620024
176300             PERFORM 3500-MARK-RANGE-AS-SELECTED                  17630024
176400     END-IF.                                                      17640024
176500                                                                  17650024
176600                                                                  17660024
176700*----------------------------------------------------------------*17670024
176800*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *17680024
176900*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*17690024
177000*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *17700024
177100*                                                                *17710024
177200*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *17720024
177300*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *17730024
177400*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *17740024
177500*    US IN THE 2ND BLOCK OF THE ARRAY.                           *17750024
177600*----------------------------------------------------------------*17760024
177700 3100-SET-SUBSCRIPTS.                                             17770024
177800                                                                  17780024
177900*    MOVE  +1                      TO ASC-ITEM-SUB.               17790024
178000*    MOVE  +1                      TO ASC-BLK-SUB.                17800024
178100                                                                  17810024
178200     COMPUTE ASC-ITEM-SUB =                                       17820024
178300         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        17830024
178400                                                                  17840024
178500     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         17850024
178600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            17860024
178700                                                                  17870024
178800         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               17880024
178900     ELSE                                                         17890024
179000         MOVE +1                     TO ASC-BLK-SUB               17900024
179100     END-IF.                                                      17910024
179200                                                                  17920024
179300     IF  ASC-ITEM-SUB < +1                                        17930024
179400         MOVE  +1                  TO ASC-ITEM-SUB                17940024
179500     END-IF.                                                      17950024
179600******************************************************************17960024
179700** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **17970024
179800******************************************************************17980024
179900                                                                  17990024
180000 3200-RESET-ATTRIBUTES.                                           18000024
180100*                                                                 18010024
180200     PERFORM                                                      18020024
180300         VARYING PV-SUB                                           18030024
180400         FROM 1 BY 1                                              18040024
180500         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        18050024
180600         MOVE DP015-UNP-ALP-NOR-MDT                               18060024
180700                                   TO MR-SELECTA (PV-SUB)         18070024
180800                                      MR-UPCA (PV-SUB)            18080024
180900         MOVE DP015-UNP-ALP-NOR-OFF                               18090024
181000                                   TO MR-UNITSA (PV-SUB)          18100024
181100         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         18110024
181200                                      MR-UPCC (PV-SUB)            18120024
181300                                      MR-UNITSC (PV-SUB)          18130024
181400         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         18140024
181500                                      MR-UPCH (PV-SUB)            18150024
181600                                      MR-UNITSH (PV-SUB)          18160024
181700         MOVE DP015-ASK-DRK-OFF                                   18170024
181800                                   TO MR-SKU-RETAILA (PV-SUB)     18180024
181900     END-PERFORM.                                                 18190024
182000******************************************************************18200024
182100** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **18210024
182200** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **18220024
182300** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **18230024
182400** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **18240024
182500******************************************************************18250024
182600 3300-EDIT-SELECTIONS.                                            18260024
182700     IF  ASC-BLK-SUB  < +1                                        18270024
182800         MOVE +1  TO  ASC-BLK-SUB                                 18280024
182900     END-IF.                                                      18290024
183000                                                                  18300024
183100     EVALUATE TRUE                                                18310024
183200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18320024
183300             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         18330024
183400                 CONTINUE                                         18340024
183500         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         18350024
183600             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        18360024
183700                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   18370024
183800                 MOVE ASC-TEMP-SELECTED-SW                        18380024
183900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18390024
184000                                TO ASC-SELECTED-SW                18400024
184100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18410024
184200             END-IF                                               18420024
184300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18430024
184400                 = SPACE                                          18440024
184500             EVALUATE TRUE                                        18450024
184600                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       18460024
184700                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS18470024
184800                     MOVE SPACE TO ASC-SELECTED-SW                18480024
184900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18490024
185000                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        18500024
185100                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    18510024
185200                     MOVE SPACE TO ASC-SELECTED-SW                18520024
185300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18530024
185400                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          18540024
185500                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      18550024
185600                     MOVE SPACE TO ASC-SELECTED-SW                18560024
185700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18570024
185800             END-EVALUATE                                         18580024
185900         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           18590024
186000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18600024
186100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18610024
186200             END-IF                                               18620024
186300             PERFORM 3310-EDIT-RANGE                              18630024
186400         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             18640024
186500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18650024
186600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18660024
186700             END-IF                                               18670024
186800             PERFORM 3310-EDIT-RANGE                              18680024
186900         WHEN OTHER                                               18690024
187000             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           18700024
187100             SET DP020-MSG-FATAL    TO TRUE                       18710024
187200             MOVE -1                TO MR-SELECTL (PV-SUB)        18720024
187300             SET DP030-SET-CURSOR-APPL-1                          18730024
187400                                    TO TRUE                       18740024
187500             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        18750024
187600             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        18760024
187700             SET PS-ERROR TO TRUE                                 18770024
187800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18780024
187900                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     18790024
188000                 MOVE SPACE         TO ASC-SELECTED-SW            18800024
188100                                        (ASC-BLK-SUB ASC-ITEM-SUB)18810024
188200             END-IF                                               18820024
188300     END-EVALUATE.                                                18830024
188400                                                                  18840024
188500     PERFORM 3305-EDIT-LINES.                                     18850024
188600                                                                  18860024
188700                                                                  18870024
188800     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 18880024
188900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               18890024
189000     IF  ASC-ITEM-SUB < 1                                         18900024
189100         SUBTRACT +1 FROM ASC-BLK-SUB                             18910024
189200         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                18920024
189300     END-IF.                                                      18930024
189400                                                                  18940024
189500                                                                  18950024
189600*----------------------------------------------------------------*18960024
189700*  EDIT SELECTED LINES                                           *18970024
189800*----------------------------------------------------------------*18980024
189900 3305-EDIT-LINES.                                                 18990024
190000                                                                  19000024
190100     IF  ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES              19010024
190200         MOVE  ASC-ITEM-SUB                                       19020024
190300           TO  ASC-LIST-ITEM-NUMBER                               19030024
190400              (ASC-BLK-SUB ASC-ITEM-SUB)                          19040024
190500     END-IF.                                                      19050024
190600                                                                  19060024
190700     IF  ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES              19070024
190800         MOVE ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB)                  19080024
190900                                 TO DP010I-UNEDITED-FIELD         19090024
191000         MOVE LENGTH OF ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB)        19100024
191100                                 TO DP010I-MAXIMUM-DIGITS         19110024
191200         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       19120024
191300         SET DP010I-NEGATIVE-NOT-ALLOWED                          19130024
191400                                 TO TRUE                          19140024
191500         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19150085
191510              USING DP010I-NUMERIC-EDIT-AREA                      19151085
191600             IF  DP010I-ERROR-DETECTED                            19160024
191700                 SET PS-ERROR                                     19170024
191800                     DP020-MSG-FATAL TO  TRUE                     19180024
191900                 MOVE PC-TSYMSG-00008                             19190024
192000                                     TO DP020-MSG-NUMBER          19200024
192100                 MOVE DP015-RED      TO MR-UPCC (PV-SUB)          19210024
192200                 MOVE DP015-REVERSE  TO MR-UPCH (PV-SUB)          19220024
192300                 MOVE -1             TO MR-UPCL (PV-SUB)          19230024
192400                 SET DP030-SET-CURSOR-APPL-1                      19240024
192500                                     TO TRUE                      19250024
192600             ELSE                                                 19260024
192700                 MOVE DP010I-NUM-FIELD-17-DIG-0-DEC               19270024
192800                                     TO PV-17-DIGIT-NUMBER        19280024
192900                 MOVE PV-15-DIGIT-NUMBER                          19290024
193000                                     TO ASC-UPC-N                 19300024
193100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 19310024
193200                 MOVE  ASC-UPC-N (ASC-BLK-SUB ASC-ITEM-SUB)       19320024
193300                                     TO MR-UPC (PV-SUB)           19330024
193400             END-IF                                               19340024
193500     ELSE                                                         19350024
193600         MOVE  SPACES  TO  ASC-SKU-DESCRIPTION                    19360024
193700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 19370024
193800     END-IF.                                                      19380024
193900                                                                  19390024
194000     IF  ASC-UNITS (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES            19400024
194100         MOVE ASC-UNITS (ASC-BLK-SUB ASC-ITEM-SUB) TO             19410024
194200                                    DP010I-UNEDITED-FIELD         19420024
194300         MOVE LENGTH OF ASC-UNITS                                 19430024
194400                                 TO DP010I-MAXIMUM-DIGITS         19440024
194500         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       19450024
194600         SET DP010I-NEGATIVE-NOT-ALLOWED                          19460024
194700                                 TO TRUE                          19470024
194800         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19480085
194810              USING DP010I-NUMERIC-EDIT-AREA                      19481085
194900             IF  DP010I-ERROR-DETECTED                            19490024
195000                 SET PS-ERROR                                     19500024
195100                     DP020-MSG-FATAL TO  TRUE                     19510024
195200                 MOVE PC-TSYMSG-00008                             19520024
195300                                     TO DP020-MSG-NUMBER          19530024
195400                 MOVE DP015-RED      TO MR-UNITSC (PV-SUB)        19540024
195500                 MOVE DP015-REVERSE  TO MR-UNITSH (PV-SUB)        19550024
195600                 MOVE -1             TO MR-UNITSL (PV-SUB)        19560024
195700                 SET DP030-SET-CURSOR-APPL-1                      19570024
195800                                     TO TRUE                      19580024
195900             ELSE                                                 19590024
196000                 MOVE DP010I-NUMERIC-FIELD                        19600024
196100                                     TO ASC-UNITS-N               19610024
196200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 19620024
196300                                        MR-UNITS (PV-SUB)         19630024
196400             END-IF                                               19640024
196500     END-IF.                                                      19650024
196600                                                                  19660024
196700     EVALUATE TRUE                                                19670024
196800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              19680024
196900              EVALUATE TRUE                                       19690024
197000                  WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      19700024
197100                       IF XL071-E-BUS-IND = 'Y' AND               19710024
197200                          XL071-LOC-TYP-CDE = 'DS' AND            19720039
197300                          PS-MQ-SETUP-NOT-COMPLETE AND            19730024
197310                          PS-PROCESS-MQ-YES                       19731085
197400                           PERFORM 8000-MQ-SETUP                  19740024
197500                       END-IF                                     19750024
197600                       PERFORM 3600-ADD-EDITS                     19760024
197700                  WHEN OTHER                                      19770024
197800                       IF  ASC-UPC                                19780024
197900                               (ASC-BLK-SUB ASC-ITEM-SUB) > 0     19790024
198000                           IF XL071-E-BUS-IND = 'Y' AND           19800024
198100                              XL071-LOC-TYP-CDE = 'DS' AND        19810039
198200                              PS-MQ-SETUP-NOT-COMPLETE AND        19820024
198210                              PS-PROCESS-MQ-YES                   19821085
198300                               PERFORM 8000-MQ-SETUP              19830024
198400                           END-IF                                 19840024
198500                           PERFORM 3600-ADD-EDITS                 19850062
198600                       END-IF                                     19860024
198700              END-EVALUATE                                        19870024
198800                                                                  19880024
198900         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              19890024
199000              EVALUATE TRUE                                       19900024
199100                  WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      19910024
199200                       PERFORM 3700-ADD-STORE-EDITS               19920024
199300              END-EVALUATE                                        19930024
199400                                                                  19940024
199500         WHEN DP020-SRC-AID = DP016-ENTER                         19950024
199600              IF  ASC-UPC-N (ASC-BLK-SUB ASC-ITEM-SUB) > 0        19960024
199700                  IF XL071-E-BUS-IND = 'Y' AND                    19970024
199800                     XL071-LOC-TYP-CDE = 'DS' AND                 19980039
199900                     PS-MQ-SETUP-NOT-COMPLETE AND                 19990024
199910                     PS-PROCESS-MQ-YES                            19991085
200000                      PERFORM 8000-MQ-SETUP                       20000024
200100                  END-IF                                          20010024
200200                  PERFORM 3600-ADD-EDITS                          20020061
200300              END-IF                                              20030024
200400                                                                  20040024
200500     END-EVALUATE.                                                20050024
200600                                                                  20060024
200700******************************************************************20070024
200800** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **20080024
200900** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **20090024
201000** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**20100024
201100** THE ENDING.                                                  **20110024
201200******************************************************************20120024
201300 3310-EDIT-RANGE.                                                 20130024
201400     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                20140024
201500         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   20150024
201600             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)20160024
201700                                   TO ASC-SELECTED-SW             20170024
201800                                        (ASC-BLK-SUB ASC-ITEM-SUB)20180024
201900             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 20190024
202000         ELSE                                                     20200024
202100             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     20210024
202200                 CONTINUE                                         20220024
202300             ELSE                                                 20230024
202400*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        20240024
202500                 MOVE PC-TSYMSG-00054                             20250024
202600                                   TO DP020-MSG-NUMBER            20260024
202700                 SET DP020-MSG-FATAL                              20270024
202800                                   TO TRUE                        20280024
202900                 MOVE -1           TO MR-SELECTL (PV-SUB)         20290024
203000                 SET DP030-SET-CURSOR-APPL-1                      20300024
203100                                   TO TRUE                        20310024
203200                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         20320024
203300                 MOVE DP015-UNDERLINE                             20330024
203400                                   TO MR-SELECTH (PV-SUB)         20340024
203500                 SET PS-ERROR      TO TRUE                        20350024
203600             END-IF                                               20360024
203700         END-IF                                                   20370024
203800     ELSE                                                         20380024
203900         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     20390024
204000             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 20400024
204100                                   TO ASC-SELECTED-SW             20410024
204200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   20420024
204300             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   20430024
204400         ELSE                                                     20440024
204500             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       20450024
204600                 CONTINUE                                         20460024
204700             ELSE                                                 20470024
204800*                -- ONLY ONE END-OF-RANGE ALLOWED --              20480024
204900                 MOVE PC-TSYMSG-00055                             20490024
205000                                   TO DP020-MSG-NUMBER            20500024
205100                 SET DP020-MSG-FATAL                              20510024
205200                                   TO TRUE                        20520024
205300                 MOVE -1           TO MR-SELECTL (PV-SUB)         20530024
205400                 SET DP030-SET-CURSOR-APPL-1                      20540024
205500                                   TO TRUE                        20550024
205600                 SET PS-ERROR      TO TRUE                        20560024
205700             END-IF                                               20570024
205800         END-IF                                                   20580024
205900     END-IF.                                                      20590024
206000*                                                                 20600024
206100******************************************************************20610024
206200** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **20620024
206300** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **20630024
206400******************************************************************20640024
206500 3400-CHECK-RANGE-SEQUENCE.                                       20650024
206600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20660024
206700       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      20670024
206800       AND  ASC-START-OF-SELECTED-RANGE >                         20680024
206900                                         ASC-END-OF-SELECTED-RANGE20690024
207000*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                20700024
207100         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 20710024
207200         SET DP020-MSG-FATAL TO TRUE                              20720024
207300         SET PS-ERROR TO TRUE                                     20730024
207400         PERFORM 3410-POSITION-AT-ERROR                           20740024
207500     END-IF.                                                      20750024
207600******************************************************************20760024
207700** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **20770024
207800** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **20780024
207900** SHOULD BE POSITIONED ON A RANGE ERROR.                       **20790024
208000******************************************************************20800024
208100 3410-POSITION-AT-ERROR.                                          20810024
208200     SET DP030-SET-CURSOR-APPL-1                                  20820024
208300                                   TO TRUE.                       20830024
208400     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 20840024
208500                    - PV-TOP-ITEM + 1.                            20850024
208600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20860024
208700         CONTINUE                                                 20870024
208800     ELSE                                                         20880024
208900         MOVE -1                   TO MR-SELECTL (PV-SUB)         20890024
209000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20900024
209100         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20910024
209200     END-IF.                                                      20920024
209300*                                                                 20930024
209400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   20940024
209500                    - PV-TOP-ITEM + 1.                            20950024
209600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20960024
209700         CONTINUE                                                 20970024
209800     ELSE                                                         20980024
209900         MOVE -1                   TO MR-SELECTL (PV-SUB)         20990024
210000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         21000024
210100         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         21010024
210200     END-IF.                                                      21020024
210300 EJECT                                                            21030024
210400*----------------------------------------------------------------*21040024
210500*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *21050024
210600*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *21060024
210700*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *21070024
210800*----------------------------------------------------------------*21080024
210900                                                                  21090024
211000 3500-MARK-RANGE-AS-SELECTED.                                     21100024
211100     MOVE +1                       TO  ASC-BLK-SUB.               21110024
211200     PERFORM 3510-MARK-SELECTED-INDS                              21120024
211300         VARYING ASC-ITEM-SUB                                     21130024
211400         FROM 1 BY 1                                              21140024
211500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21150024
211600                                                                  21160024
211700                                                                  21170024
211800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               21180024
211900                                   TO  PV-LIST-ITEM-NUMBER.       21190024
212000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            21200024
212100         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         21210024
212200               PC-ITEMS-PER-PANEL).                               21220024
212300                                                                  21230024
212400     MOVE ASC-START-OF-SELECTED-RANGE                             21240024
212500                                   TO PV-START-OF-SELECTED-RANGE. 21250024
212600     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            21260024
212700         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  21270024
212800               PC-ITEMS-PER-PANEL).                               21280024
212900                                                                  21290024
213000     MOVE ASC-END-OF-SELECTED-RANGE                               21300024
213100                                   TO  PV-END-OF-SELECTED-RANGE.  21310024
213200     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             21320024
213300         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    21330024
213400               PC-ITEMS-PER-PANEL).                               21340024
213500     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             21350024
213600         PV-FIRST-BLOCK-IN-ARRAY + 1.                             21360024
213700                                                                  21370024
213800     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    21380024
213900        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        21390024
214000         MOVE +1                   TO ASC-BLK-SUB                 21400024
214100         PERFORM 5100-WRITE-TEMP-STORAGE                          21410024
214200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21420024
214300             PV-FIRST-BLOCK-IN-ARRAY - 1                          21430024
214400                                                                  21440024
214500         PERFORM                                                  21450024
214600             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      21460024
214700                   PV-PREV-BLOCK-IN-ARRAY                         21470024
214800             MOVE PV-FIRST-BLOCK-IN-RANGE                         21480024
214900                                   TO PV-BLOCK-NUMBER             21490024
215000             PERFORM 4410-READ-TEMP-STORAGE                       21500024
215100             PERFORM 3510-MARK-SELECTED-INDS                      21510024
215200                 VARYING ASC-ITEM-SUB                             21520024
215300                 FROM 1 BY 1                                      21530024
215400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21540024
215500             PERFORM 5100-WRITE-TEMP-STORAGE                      21550024
215600             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     21560024
215700         END-PERFORM                                              21570024
215800                                                                  21580024
215900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21590024
216000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21600024
216100         PERFORM                                                  21610024
216200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21620024
216300                   PV-LAST-BLOCK-IN-RANGE                         21630024
216400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          21640024
216500                                   TO PV-BLOCK-NUMBER             21650024
216600             PERFORM 4410-READ-TEMP-STORAGE                       21660024
216700             PERFORM 3510-MARK-SELECTED-INDS                      21670024
216800                 VARYING ASC-ITEM-SUB                             21680024
216900                 FROM 1 BY 1                                      21690024
217000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21700024
217100             PERFORM 5100-WRITE-TEMP-STORAGE                      21710024
217200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21720024
217300         END-PERFORM                                              21730024
217400                                                                  21740024
217500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21750024
217600                                   TO PV-BLOCK-NUMBER             21760024
217700         PERFORM 4410-READ-TEMP-STORAGE                           21770024
217800     END-IF.                                                      21780024
217900                                                                  21790024
218000     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 21800024
218100                                      ASC-END-OF-SELECTED-RANGE.  21810024
218200                                                                  21820024
218300 EJECT                                                            21830024
218400*----------------------------------------------------------------*21840024
218500* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *21850024
218600*----------------------------------------------------------------*21860024
218700                                                                  21870024
218800 3510-MARK-SELECTED-INDS.                                         21880024
218900                                                                  21890024
219000     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21900024
219100                                ASC-ITEM-SUB) >                   21910024
219200         ASC-START-OF-SELECTED-RANGE)                             21920024
219300     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21930024
219400                                ASC-ITEM-SUB) =                   21940024
219500         ASC-START-OF-SELECTED-RANGE)                             21950024
219600                                                                  21960024
219700         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     21970024
219800                                    ASC-ITEM-SUB) <               21980024
219900             ASC-END-OF-SELECTED-RANGE)                           21990024
220000         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     22000024
220100                                    ASC-ITEM-SUB) =               22010024
220200             ASC-END-OF-SELECTED-RANGE)                           22020024
220300                                                                  22030024
220400             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          22040024
220500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              22050024
220600                               TO TRUE                            22060024
220700             END-IF                                               22070024
220800         END-IF                                                   22080024
220900     END-IF.                                                      22090024
221000                                                                  22100024
221100                                                                  22110024
221200*----------------------------------------------------------------*22120024
221300* ADD EDITS                                                      *22130024
221400*----------------------------------------------------------------*22140024
221500 3600-ADD-EDITS.                                                  22150024
221600                                                                  22160024
221700     IF ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB)  >  SPACES             22170024
221800         CONTINUE                                                 22180024
221900     ELSE                                                         22190024
222000         SET PS-ERROR                                             22200024
222100             DP020-MSG-FATAL          TO TRUE                     22210024
222200          MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER         22220024
222300          MOVE DP015-RED              TO MR-UPCC (PV-SUB)         22230024
222400          MOVE DP015-REVERSE          TO MR-UPCH (PV-SUB)         22240024
222500          MOVE -1                     TO MR-UPCL (PV-SUB)         22250024
222600          SET DP030-SET-CURSOR-APPL-1 TO TRUE                     22260024
222700     END-IF.                                                      22270024
222800                                                                  22280024
222900     MOVE  ASC-UPC-N (ASC-BLK-SUB ASC-ITEM-SUB)                   22290024
223000                                                TO PV-UPC.        22300024
223100     IF  PS-NO-ERROR                                              22310024
223200         PERFORM 3615-GET-SKU-INFO                                22320024
223300     END-IF.                                                      22330024
223400                                                                  22340024
223500     IF  PS-NO-ERROR                                              22350024
223600         IF  ASC-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB) > 0           22360024
223700             CONTINUE                                             22370062
223800         ELSE                                                     22380062
223900         IF XL071-E-BUS-IND = 'Y' AND                             22390062
224000            XL071-LOC-TYP-CDE = 'DS'                              22400062
224100             CONTINUE                                             22410024
224200         ELSE                                                     22420024
224300             SET PS-ERROR                                         22430024
224400                 DP020-MSG-FATAL          TO TRUE                 22440024
224500              MOVE PC-TSYMSG-01961        TO DP020-MSG-NUMBER     22450024
224600              MOVE DP015-RED              TO MR-UNITSC (PV-SUB)   22460024
224700              MOVE DP015-REVERSE          TO MR-UNITSH (PV-SUB)   22470024
224800              MOVE -1                     TO MR-UNITSL (PV-SUB)   22480024
224900              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 22490024
225000         END-IF                                                   22500024
225100     END-IF.                                                      22510024
225200                                                                  22520024
225300     IF  PS-NO-ERROR                                              22530024
225400         IF  ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES     22540024
225500             SET PS-ERROR                                         22550024
225600                 DP020-MSG-FATAL          TO TRUE                 22560024
225700              MOVE PC-TSYMSG-02303        TO DP020-MSG-NUMBER     22570024
225800              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  22580024
225900              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  22590024
226000              MOVE -1                     TO MR-SELECTL (PV-SUB)  22600024
226100              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 22610024
226200         END-IF                                                   22620024
226300     END-IF.                                                      22630024
226400                                                                  22640024
226500     IF PS-NO-ERROR AND                                           22650024
226600        XL071-E-BUS-IND = 'Y' AND                                 22660024
226700        XL071-LOC-TYP-CDE = 'DS' AND                              22670039
226800        PS-MQ-SETUP-COMPLETE AND                                  22680024
226810        PS-PROCESS-MQ-YES                                         22681085
226900         INITIALIZE CE016-INV-TRANS-RECORD                        22690029
227000         MOVE PV-SKU-NBR       TO CE016-SKU-NUMBER                22700024
227100         MOVE ASC-CS-LOC-N     TO CE016-STORE-NUMBER              22710024
227200         SET CE016-TRANS-TYPE-GET TO TRUE                         22720024
227300         SET CE016-TRANS-SRC-CENTRAL-STOCK TO TRUE                22730024
227400         MOVE PV-CURRENT-DATE  TO CE016-TRANS-DATE                22740024
227500         MOVE ZERO             TO CE016-TRANS-RESV-QTY            22750024
227600                                  CE016-TRANS-AVAIL-QTY           22760024
227700         MOVE ASC-PULL-NBR     TO PV-TRANS-PULL-NBR               22770024
227800         MOVE PV-TRANS-SOURCE-DESC                                22780024
227900                               TO CE016-TRANS-SOURCE-DESC         22790024
228000         SET PS-NO-REDUCE-QTY TO TRUE                             22800032
228100         SET PS-SKU-FOUND     TO TRUE                             22810032
228200         SET PS-SKU-PROCESSED TO TRUE                             22820032
228300         PERFORM 8010-MQ-PUT1                                     22830025
228400         IF PS-NO-MQ-ERROR AND                                    22840025
228500            CE016-TRANS-SUCCESSFUL                                22850025
228600             MOVE CE016-TRANS-AVAIL-QTY    TO ASC-AVAIL-UNITS-N   22860024
228700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22870024
228800             IF ASC-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES   22880024
228900                 MOVE CE016-TRANS-AVAIL-QTY  TO ASC-UNITS-N       22890024
229000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22900024
229100             ELSE                                                 22910032
229200                 IF ASC-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB) >      22920032
229300                   ASC-AVAIL-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB)   22930032
229400                     SET PS-ERROR TO TRUE                         22940035
229500                     MOVE PC-TSYMSG-02314  TO  DP020-MSG-NUMBER   22950032
229600                     MOVE DP015-RED        TO MR-UNITSC (LQW-IDX) 22960032
229700                     MOVE DP015-REVERSE    TO MR-UNITSH (LQW-IDX) 22970032
229800                     MOVE -1               TO MR-UNITSL (LQW-IDX) 22980032
229900                 END-IF                                           22990032
230000             END-IF                                               23000024
230100         ELSE                                                     23010024
230200             MOVE ZERO                     TO ASC-AVAIL-UNITS-N   23020024
230300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     23030024
230400             IF PS-SKU-NOT-FOUND                                  23040035
230500                 SET PS-ERROR TO TRUE                             23050035
230600                 MOVE  '* INVALID UPC *' TO                       23060036
230700                    ASC-SKU-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)23070035
230800                 MOVE PC-TSYMSG-02677  TO  DP020-MSG-NUMBER       23080044
230900             END-IF                                               23090035
231000         END-IF                                                   23100024
231100     END-IF.                                                      23110024
231200                                                                  23120024
231300*----------------------------------------------------------------*23130024
231400* VALIDATE UPC NUMBER - GET SKU DESCRIPTION/RETAIL AMT            23140024
231500*----------------------------------------------------------------*23150024
231600 3615-GET-SKU-INFO.                                               23160047
231700     INITIALIZE  XL001-ITEM-COMMAREA.                             23170047
231800                                                                  23180047
231900     MOVE PV-UPC         TO  XL001-KEY-UPC-NBR.                   23190047
232000                                                                  23200047
232100        SET  XL001-BY-UPC-NBR                                     23210052
232200             XL001-SELECT-SKU                                     23220047
232300             XL001-SELECT-UPC                                     23230047
232400             XL001-SELECT-SKU-STR TO TRUE.                        23240047
232500                                                                  23250047
232600        CALL XL001-VSM-PGM USING  DFHEIBLK                        23260047
232700                                  XL001-COMMAREA                  23270047
232800                                  XL001-ITEM-COMMAREA.            23280047
232900                                                                  23290047
233000     EVALUATE TRUE                                                23300047
233100         WHEN XL001-UPC-SQLCODE = +0                              23310047
233200              PERFORM 3616-SELECT-SKU                             23320047
233300                                                                  23330047
233400         WHEN XL001-UPC-SQLCODE = +100                            23340047
233500              MOVE  ZEROES                                        23350047
233600                TO  ASC-LINE-ITEM (ASC-BLK-SUB ASC-ITEM-SUB)      23360047
233700              MOVE  '* INVALID UPC *'                             23370047
233800                TO  ASC-SKU-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)23380047
233900              MOVE  ZEROES                                        23390047
234000                TO  ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB)     23400047
234100              SET PS-ERROR                                        23410047
234200                  DP020-MSG-FATAL TO  TRUE                        23420047
234300               MOVE PC-TSYMSG-00100                               23430047
234400                                     TO DP020-MSG-NUMBER          23440047
234500               MOVE DP015-RED        TO MR-UPCC (PV-SUB)          23450047
234600               MOVE DP015-REVERSE    TO MR-UPCH (PV-SUB)          23460047
234700               MOVE -1               TO MR-UPCL (PV-SUB)          23470047
234800               SET DP030-SET-CURSOR-APPL-1                        23480047
234900                                     TO TRUE                      23490047
235000                                                                  23500047
235100         WHEN XL001-UPC-CONTENTION                                23510051
235200             MOVE XL001-UPC-SQLCODE         TO PV-SOFT-SQLCODE    23520047
235300             MOVE '3615-GET-SKU-INFO'       TO PV-SOFT-PARAGRAPH  23530047
235400             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  23540047
235500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     23550047
235600               TO PV-COMMAREA-LENGTH                              23560047
235700             EXEC CICS                                            23570047
235800                  WRITEQ TD                                       23580047
235900                   QUEUE  ('CSSL')                                23590047
236000                    FROM  (PV-CICS-MSG-AREA2)                     23600047
236100                  LENGTH  (PV-COMMAREA-LENGTH)                    23610047
236200                    RESP  (PV-CICS-RESP)                          23620047
236300             END-EXEC                                             23630047
236400             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          23640047
236500             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              23650047
236600             PERFORM 9900-SOFT-ABORT                              23660047
236700                                                                  23670047
236800         WHEN OTHER                                               23680047
236900              MOVE '3615-GET-SKU-INFO'                            23690047
237000                               TO DP013-PARAGRAPH                 23700047
237100              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           23710047
237200              STRING ' PULL-'           DELIMITED BY SIZE         23720047
237300                     PV-PULL-NUMBER     DELIMITED BY SIZE         23730047
237400                     '  -  LINE-'       DELIMITED BY SIZE         23740047
237500                     PV-LINE-NUMBER     DELIMITED BY SIZE         23750047
237600                     '  -  ITEM NBR-'   DELIMITED BY SIZE         23760047
237700                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         23770047
237800                     '  TRYING TO GET UPC INFORMATION'            23780056
237900                                        DELIMITED BY SIZE         23790047
238000                             INTO DP013-MESSAGE-TEXT (1)          23800047
238100              MOVE XL001-SQLCA TO DP013-SQLCA                     23810051
238200              MOVE 'XLKUT001'  TO DP013-DB2-TABLE-NAME (2)        23820047
238300              SET DP013-DB2-ABEND                                 23830047
238400                  DP013-XCTL-DISPLAY-RESTART                      23840047
238500                                   TO TRUE                        23850047
238600                  PERFORM DP013-0000-PROCESS-ABEND                23860047
238700     END-EVALUATE.                                                23870047
238800                                                                  23880047
238900 3616-SELECT-SKU.                                                 23890047
239000                                                                  23900047
239100     EVALUATE TRUE                                                23910047
239200         WHEN XL001-SKU-SQLCODE = +0                              23920047
239300              MOVE  XL001-ITM-NBR                                 23930050
239400                TO  ASC-LINE-ITEM (ASC-BLK-SUB ASC-ITEM-SUB)      23940047
239410              PERFORM 3680-INSPECT-XL001-SKU-DESC                 23941086
239500              MOVE  XL001-SKU-DESC                                23950047
239600                TO  ASC-SKU-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)23960047
239700              MOVE  XL001-SKU-NBR    TO PV-SKU-NUMBER             23970048
239800                                        PV-SKU-NBR                23980048
239900              MOVE  PV-SKU-NUMBER                                 23990051
240000                TO  ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB)            24000051
240100              PERFORM 3617-SELECT-SKU-STR                         24010048
240200                                                                  24020048
240300         WHEN XL001-SKU-SQLCODE = +100                            24030048
240400              MOVE  ZEROES                                        24040048
240500                TO  ASC-LINE-ITEM (ASC-BLK-SUB ASC-ITEM-SUB)      24050048
240600              MOVE  '* INVALID UPC *'                             24060048
240700                TO  ASC-SKU-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)24070048
240800              MOVE  ZEROES                                        24080048
240900                TO  ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB)     24090048
241000              SET PS-ERROR                                        24100048
241100                  DP020-MSG-FATAL TO  TRUE                        24110048
241200               MOVE PC-TSYMSG-00100                               24120048
241300                                     TO DP020-MSG-NUMBER          24130048
241400               MOVE DP015-RED        TO MR-UPCC (PV-SUB)          24140048
241500               MOVE DP015-REVERSE    TO MR-UPCH (PV-SUB)          24150048
241600               MOVE -1               TO MR-UPCL (PV-SUB)          24160048
241700               SET DP030-SET-CURSOR-APPL-1                        24170048
241800                                     TO TRUE                      24180048
241900                                                                  24190048
242000         WHEN XL001-SKU-CONTENTION                                24200051
242100             MOVE XL001-SKU-SQLCODE         TO PV-SOFT-SQLCODE    24210048
242200             MOVE '3616-SELECT-SKU'         TO PV-SOFT-PARAGRAPH  24220048
242300             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  24230048
242400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     24240048
242500               TO PV-COMMAREA-LENGTH                              24250048
242600             EXEC CICS                                            24260048
242700                  WRITEQ TD                                       24270048
242800                   QUEUE  ('CSSL')                                24280048
242900                    FROM  (PV-CICS-MSG-AREA2)                     24290048
243000                  LENGTH  (PV-COMMAREA-LENGTH)                    24300048
243100                    RESP  (PV-CICS-RESP)                          24310048
243200             END-EXEC                                             24320048
243300             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          24330048
243400             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              24340048
243500             PERFORM 9900-SOFT-ABORT                              24350048
243600                                                                  24360048
243700         WHEN OTHER                                               24370048
243800              MOVE ' 3616-SELECT-SKU'                             24380048
243900                               TO DP013-PARAGRAPH                 24390048
244000              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           24400048
244100              STRING ' PULL-'           DELIMITED BY SIZE         24410048
244200                     PV-PULL-NUMBER     DELIMITED BY SIZE         24420048
244300                     '  -  LINE-'       DELIMITED BY SIZE         24430048
244400                     PV-LINE-NUMBER     DELIMITED BY SIZE         24440048
244500                     '  -  ITEM NBR-'   DELIMITED BY SIZE         24450048
244600                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         24460048
244700                     '  TRYING TO GET SKU INFORMATION'            24470048
244800                                        DELIMITED BY SIZE         24480048
244900                             INTO DP013-MESSAGE-TEXT (1)          24490048
245000              MOVE XL001-SQLCA TO DP013-SQLCA                     24500051
245100              MOVE 'XLKUT001'  TO DP013-DB2-TABLE-NAME (2)        24510048
245200              SET DP013-DB2-ABEND                                 24520048
245300                  DP013-XCTL-DISPLAY-RESTART                      24530048
245400                                   TO TRUE                        24540048
245500                  PERFORM DP013-0000-PROCESS-ABEND                24550048
245600     END-EVALUATE.                                                24560048
245700                                                                  24570048
245800 3617-SELECT-SKU-STR.                                             24580048
245900                                                                  24590048
246000     EVALUATE TRUE                                                24600048
246100         WHEN XL001-SKU-STR-SQLCODE = +0                          24610048
246200           IF XL001-GP-QTY > 1                                    24620085
246300              COMPUTE ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB) = 24630085
246400                    XL001-GP-AMT / XL001-GP-QTY                   24640085
246401           ELSE                                                   24640185
246402              MOVE  XL001-UNT-RTL-AMT                             24640248
246403                TO  ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB)     24640348
246404           END-IF                                                 24640485
246405                                                                  24640548
246500         WHEN XL001-SKU-STR-SQLCODE = +100                        24650048
246600              MOVE  ZEROES                                        24660048
246700                TO  ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB)     24670048
246800              SET PS-ERROR                                        24680048
246900                  DP020-MSG-FATAL TO  TRUE                        24690048
247000               MOVE PC-TSYMSG-00100                               24700048
247100                                     TO DP020-MSG-NUMBER          24710048
247200               MOVE DP015-RED        TO MR-UPCC (PV-SUB)          24720048
247300               MOVE DP015-REVERSE    TO MR-UPCH (PV-SUB)          24730048
247400               MOVE -1               TO MR-UPCL (PV-SUB)          24740048
247500               SET DP030-SET-CURSOR-APPL-1                        24750048
247600                                     TO TRUE                      24760048
247700                                                                  24770048
247800         WHEN XL001-SKU-STR-CONTENTION                            24780051
247900             MOVE XL001-SKU-STR-SQLCODE     TO PV-SOFT-SQLCODE    24790048
248000             MOVE '3617-SELECT-SKU-STR'     TO PV-SOFT-PARAGRAPH  24800048
248100             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  24810048
248200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     24820048
248300               TO PV-COMMAREA-LENGTH                              24830048
248400             EXEC CICS                                            24840048
248500                  WRITEQ TD                                       24850048
248600                   QUEUE  ('CSSL')                                24860048
248700                    FROM  (PV-CICS-MSG-AREA2)                     24870048
248800                  LENGTH  (PV-COMMAREA-LENGTH)                    24880048
248900                    RESP  (PV-CICS-RESP)                          24890048
249000             END-EXEC                                             24900048
249100             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          24910048
249200             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              24920048
249300             PERFORM 9900-SOFT-ABORT                              24930048
249400                                                                  24940048
249500         WHEN OTHER                                               24950048
249600              MOVE '3617-SELECT-SKU-STR'                          24960048
249700                               TO DP013-PARAGRAPH                 24970048
249800              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           24980048
249900              STRING ' PULL-'           DELIMITED BY SIZE         24990048
250000                     PV-PULL-NUMBER     DELIMITED BY SIZE         25000048
250100                     '  -  LINE-'       DELIMITED BY SIZE         25010048
250200                     PV-LINE-NUMBER     DELIMITED BY SIZE         25020048
250300                     '  -  ITEM NBR-'   DELIMITED BY SIZE         25030048
250400                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         25040048
250500                     '  TRYING TO GET SKU STR INFORMATION'        25050056
250600                                        DELIMITED BY SIZE         25060048
250700                             INTO DP013-MESSAGE-TEXT (1)          25070048
250800              MOVE XL001-SQLCA TO DP013-SQLCA                     25080051
250900              MOVE 'XLKUT001'  TO DP013-DB2-TABLE-NAME (2)        25090048
251000              SET DP013-DB2-ABEND                                 25100048
251100                  DP013-XCTL-DISPLAY-RESTART                      25110048
251200                                   TO TRUE                        25120048
251300                  PERFORM DP013-0000-PROCESS-ABEND                25130048
251400     END-EVALUATE.                                                25140048
251500                                                                  25150048
251510*----------------------------------------------------------------*25151086
251520* INSPECT THE SKU DESCRIPTION FROM XLKUT001 TO CONVERT INVALID   *25152086
251530* CHARACTERS TO SPACES.                                          *25153086
251540*----------------------------------------------------------------*25154086
251550 3680-INSPECT-XL001-SKU-DESC.                                     25155086
251560                                                                  25156086
251580     MOVE SPACE TO  PC-SPACE.                                     25158086
251590     INSPECT XL001-SKU-DESC      REPLACING ALL                    25159086
251591         quote BY PC-SPACE.                                       25159186
251592     INSPECT XL001-SKU-DESC      REPLACING ALL                    25159286
251593         '&'   BY PC-SPACE.                                       25159386
251594     INSPECT XL001-SKU-DESC      REPLACING ALL                    25159486
251595         '"'   BY PC-SPACE.                                       25159586
251596     INSPECT XL001-SKU-DESC      REPLACING ALL                    25159686
251597         '<'   BY PC-SPACE.                                       25159786
251598     INSPECT XL001-SKU-DESC      REPLACING ALL                    25159886
251599         '>'   BY PC-SPACE.                                       25159986
251600*-------------------------                                        25160086
251601* ADDED CHECK FOR HEX 05                                          25160186
251602*-------------------------                                        25160286
251603     INSPECT XL001-SKU-DESC      REPLACING ALL                    25160386
251604         '	'   BY PC-SPACE.                                       25160486
251605     INSPECT XL001-SKU-DESC      REPLACING ALL                    25160586
251606         ''   BY PC-SPACE.                                       25160686
251607     INSPECT XL001-SKU-DESC      REPLACING ALL                    25160786
251608         ';'   BY PC-SPACE.                                       25160886
251609     INSPECT XL001-SKU-DESC      REPLACING ALL                    25160986
251610         LOW-VALUES BY PC-SPACE.                                  25161086
251611*-------------------------                                        25161186
251612* ADDED CHECK FOR HEX 3F                                          25161286
251613*-------------------------                                        25161386
251614     INSPECT XL001-SKU-DESC      REPLACING ALL                    25161486
251615         ''   BY PC-SPACE.                                       25161586
251616*-------------------------                                        25161686
251617* ADDED CHECK FOR HEX 71                                          25161786
251618*-------------------------                                        25161886
251619     INSPECT XL001-SKU-DESC      REPLACING ALL                    25161986
251620         ''   BY PC-SPACE.                                       25162086
251623                                                                  25162386
251630*----------------------------------------------------------------*25163024
251700* ADD STORE EDITS                                                *25170024
251800*----------------------------------------------------------------*25180024
251900 3700-ADD-STORE-EDITS.                                            25190024
252000                                                                  25200024
252100     IF  PS-NO-ERROR                                              25210024
252200         IF  ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES     25220024
252300             CONTINUE                                             25230024
252400         ELSE                                                     25240024
252500             SET PS-ERROR                                         25250024
252600                 DP020-MSG-FATAL          TO TRUE                 25260024
252700              MOVE PC-TSYMSG-02304        TO DP020-MSG-NUMBER     25270024
252800              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  25280024
252900              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  25290024
253000              MOVE -1                     TO MR-SELECTL (PV-SUB)  25300024
253100              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 25310024
253200         END-IF                                                   25320024
253300     END-IF.                                                      25330024
253400                                                                  25340024
253500                                                                  25350024
253600                                                                  25360024
253700*----------------------------------------------------------------*25370024
253800*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *25380024
253900*    INITIALIZE ALL COUNTERS AND FLAGS.                          *25390024
254000*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *25400024
254100*    DISPLAY THE PANEL TO USER.                                  *25410024
254200*----------------------------------------------------------------*25420024
254300 4000-BUILD-INITIAL-PANEL.                                        25430024
254400                                                                  25440024
254500     INITIALIZE                 ASC-BLOCK-ENTRIES (1)             25450024
254600     MOVE +1                 TO ASC-BLK-SUB.                      25460024
254700                                                                  25470024
254800     MOVE +0                 TO ASC-ITEM-SUB                      25480024
254900                                ASC-NUMBER-OF-ITEMS-READ          25490024
255000                                ASC-NUMBER-OF-SELECTED-ITEMS      25500024
255100                                ASC-HIGHEST-BLOCK-WRITTEN         25510024
255200                                ASC-START-OF-SELECTED-RANGE       25520024
255300                                ASC-END-OF-SELECTED-RANGE         25530024
255400                                ASC-ITEM-AT-TOP-OF-PANEL.         25540024
255500     MOVE  +12               TO ASC-NUMBER-OF-ITEMS-READ.         25550024
255600                                                                  25560024
255700                                                                  25570024
255800     MOVE -1                 TO MR-SELECTL (1)                    25580024
255900     SET DP030-SET-CURSOR-APPL-1                                  25590024
256000                             TO TRUE                              25600024
256100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        25610024
256200                                                                  25620024
256300*----------------------------------------------------------------*25630024
256400* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *25640024
256500*----------------------------------------------------------------*25650024
256600                                                                  25660024
256700 4400-MOVE-COMMAREA-TO-SCREEN.                                    25670024
256800     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             25680024
256900         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1))))         25690024
257000             MOVE +1    TO ASC-BLK-SUB                            25700024
257100             PERFORM 5100-WRITE-TEMP-STORAGE                      25710024
257200             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             25720024
257300                 GIVING PV-BLOCK-NUMBER                           25730024
257400                 REMAINDER PV-REMAINDER                           25740024
257500             IF  PV-REMAINDER > ZERO                              25750024
257600                 ADD +1 TO PV-BLOCK-NUMBER                        25760024
257700             END-IF                                               25770024
257800             MOVE +1    TO ASC-BLK-SUB                            25780024
257900             PERFORM 4410-READ-TEMP-STORAGE                       25790024
258000     END-IF.                                                      25800024
258100     MOVE +1            TO ASC-BLK-SUB.                           25810024
258200     COMPUTE ASC-ITEM-SUB =                                       25820024
258300         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              25830024
258400         + PC-ITEMS-PER-PANEL).                                   25840024
258500*                                                                 25850024
258600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        25860024
258700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            25870024
258800     END-IF.                                                      25880024
258900*                                                                 25890024
259000     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           25900024
259100         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                25910024
259200     PERFORM 4420-FORMAT-LIST-LINES                               25920024
259300         VARYING PV-SUB                                           25930024
259400         FROM PC-ITEMS-PER-PANEL BY -1                            25940024
259500         UNTIL PV-SUB < +1.                                       25950024
259600*                                                                 25960024
259700     COMPUTE ASC-ITEMS-DISPLAYED =                                25970024
259800         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          25980024
259900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            25990024
260000                                   TO ASELITO.                    26000024
260100                                                                  26010024
260200     MOVE ASC-CS-LOC-N               TO PV-4-DIGIT-STORE.         26020024
260300     MOVE PV-4-DIGIT-STORE           TO ALOCIDO.                  26030024
260400                                                                  26040024
260500     MOVE ASC-PULL-NBR-N             TO APULNOO                   26050024
260600                                        DK-PULL-NUMBER.           26060024
260700                                                                  26070024
260800     PERFORM 4510-GET-PULL-STATUS.                                26080024
260900     PERFORM 4520-GET-LINE-ITEM.                                  26090024
261000     IF  PV-CEPLIT-ITEM-QTY  >  0                                 26100024
261100         PERFORM 4530-GET-LAST-LINE                               26110024
261200     END-IF.                                                      26120024
261300                                                                  26130024
261400     MOVE PV-CEPLIT-ITEM-QTY         TO ALNENOO.                  26140024
261500     MOVE PV-CEPLIT-REQ-QTY          TO ATOTUTO.                  26150024
261600                                                                  26160024
261700     MOVE ASC-LAST-UPC-ENTERED       TO ALSTUPO.                  26170024
261800     MOVE ASC-LAST-SKU-ENTERED       TO ALSTSKO.                  26180024
261900                                                                  26190024
262000     EVALUATE TRUE                                                26200024
262100         WHEN ASC-PULL-CANCELLED                                  26210024
262200              MOVE PC-PULL-STATUS-CANCELLED TO APULSTO            26220024
262300         WHEN ASC-PULL-DISTRIBUTED                                26230024
262400              MOVE PC-DISTRIB-DESC          TO APULSTO            26240024
262500         WHEN ASC-PULL-IN-PROCESS                                 26250024
262600              MOVE PC-IN-PROCESS-DESC       TO APULSTO            26260024
262700         WHEN ASC-PULL-NEW                                        26270024
262800              MOVE PC-NEW-DESC              TO APULSTO            26280024
262900         WHEN ASC-PULL-POSTED                                     26290024
263000              MOVE PC-POSTED-DESC           TO APULSTO            26300024
263100         WHEN OTHER                                               26310024
263200              MOVE PC-UNKNOWN-DESC          TO APULSTO            26320024
263300     END-EVALUATE.                                                26330024
263400                                                                  26340024
263500     MOVE ASC-STORE-NBR                     TO ASTRNOO.           26350024
263600     IF  ASC-STORE-NBR  >  0                                      26360024
263700         MOVE  ASC-STORE-NBR  TO DK-STORE-NUMBER                  26370024
263800         PERFORM 4600-GET-STORE-INFORMATION                       26380024
263900         EXEC SQL                                                 26390085
264000             SET :PV-CURRENT-DATE = CURRENT DATE                  26400085
264001         END-EXEC                                                 26400185
264002     END-IF.                                                      26400224
264003     MOVE XL071-LOC-NM                      TO MSTRNMEO.          26400324
264100                                                                  26410024
264200*----------------------------------------------------------------*26420024
264300*                                                                *26430024
264400*----------------------------------------------------------------*26440024
264500 4410-READ-TEMP-STORAGE.                                          26450024
264600                                                                  26460024
264700     EXEC CICS                                                    26470024
264800         READQ TS                                                 26480024
264900             QUEUE (ASC-LIST-QUEUE-NAME)                          26490024
265000             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26500024
265100             ITEM  (PV-BLOCK-NUMBER)                              26510024
265200             RESP  (PV-CICS-RESP)                                 26520024
265300     END-EXEC.                                                    26530024
265400                                                                  26540024
265500     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       26550024
265600       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     26560024
265700         CONTINUE                                                 26570024
265800     ELSE                                                         26580024
265900         SET DP013-CICS-ABEND     TO TRUE                         26590024
266000         SET DP013-NO-ROLLBACK    TO TRUE                         26600024
266100         MOVE '4410-READ-TEMP-STORAGE'                            26610024
266200                                  TO DP013-PARAGRAPH              26620024
266300         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      26630024
266400                                  TO DP013-MESSAGE-TEXT(1)        26640024
266500         PERFORM DP013-0000-PROCESS-ABEND                         26650024
266600     END-IF.                                                      26660024
266700                                                                  26670024
266800     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             26680024
266900*                                                                 26690024
267000     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         26700024
267100         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               26710024
267200     END-IF.                                                      26720024
267300 EJECT                                                            26730024
267400*----------------------------------------------------------------*26740024
267500*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *26750024
267600*----------------------------------------------------------------*26760024
267700                                                                  26770024
267800 4420-FORMAT-LIST-LINES.                                          26780024
267900     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      26790024
268000         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                26800024
268100         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           26810024
268200                                    MR-UPCA (PV-SUB)              26820024
268300                                    MR-UNITSA (PV-SUB)            26830024
268400                                    MR-LINE-NUMBERA (PV-SUB)      26840024
268500                                    MR-SKU-RETAILA (PV-SUB)       26850024
268600                                    MR-A-UNITSA (PV-SUB)          26860024
268700         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           26870024
268800                                    MR-UPCH (PV-SUB)              26880024
268900                                    MR-UNITSH (PV-SUB)            26890024
269000                                    MR-LINE-NUMBERH (PV-SUB)      26900024
269100                                    MR-SKU-RETAILH (PV-SUB)       26910024
269200                                    MR-A-UNITSH (PV-SUB)          26920024
269300         MOVE SPACE              TO MR-SELECTI (PV-SUB)           26930024
269400                                    MR-ACTION (PV-SUB)            26940024
269500                                    MR-SKU-DESC (PV-SUB)          26950024
269600                                                                  26960024
269700         MOVE ZEROES             TO MR-UPC (PV-SUB)               26970024
269800                                    MR-UNITS (PV-SUB)             26980024
269900                                    MR-LINE-NUMBER (PV-SUB)       26990024
270000                                    MR-SKU-RETAIL (PV-SUB)        27000024
270100                                    MR-A-UNITS (PV-SUB)           27010024
270200     ELSE                                                         27020024
270300         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      27030024
270400                                                   > SPACE        27040024
270500             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 27050024
270600                                 TO MR-SELECTI (PV-SUB)           27060024
270700         ELSE                                                     27070024
270800             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      27080024
270900                                 TO MR-SELECTI (PV-SUB)           27090024
271000         END-IF                                                   27100024
271100*                                                                 27110024
271200         IF  DP030-SET-CURSOR-TRAILER                             27120024
271300             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)27130024
271400                 > SPACE)                                         27140024
271500               OR (PV-SUB = 1))                                   27150024
271600                SET DP030-SET-CURSOR-APPL-1 TO TRUE               27160024
271700                MOVE -1          TO MR-SELECTL (PV-SUB)           27170024
271800             END-IF                                               27180024
271900         END-IF                                                   27190024
272000*                                                                 27200024
272100         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               27210024
272200                                 TO MR-ACTION (PV-SUB)            27220024
272300         MOVE ASC-UPC-N (ASC-BLK-SUB ASC-ITEM-SUB)                27230024
272400                                 TO MR-UPC (PV-SUB)               27240024
272500         MOVE ASC-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB)              27250024
272600                                 TO MR-UNITS (PV-SUB)             27260024
272700         MOVE ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)             27270024
272800                                 TO MR-LINE-NUMBER (PV-SUB)       27280024
272900         MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB)                  27290024
273000                                 TO MR-SKU (PV-SUB)               27300024
273100         MOVE ASC-SKU-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)      27310024
273200                                 TO MR-SKU-DESC (PV-SUB)          27320024
273300         MOVE ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB)           27330024
273400                                 TO MR-SKU-RETAIL (PV-SUB)        27340024
273500         MOVE ASC-AVAIL-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB)        27350024
273600                                 TO MR-A-UNITS (PV-SUB)           27360024
273700                                                                  27370024
273800*2/2     IF  ASC-LINE-ITEM-N (ASC-BLK-SUB ASC-ITEM-SUB) > 0 AND   27380024
273900         IF  ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)    > SPACE   27390024
274000             MOVE DP015-ASK-NOR-MDT                               27400024
274100                                   TO MR-UPCA (PV-SUB)            27410024
274200                                      MR-UNITSA (PV-SUB)          27420024
274300             MOVE DP015-BLUE       TO MR-UPCC (PV-SUB)            27430024
274400                                      MR-UNITSC (PV-SUB)          27440024
274500             MOVE DP015-HL-OFF     TO MR-UPCH (PV-SUB)            27450024
274600                                      MR-UNITSH (PV-SUB)          27460024
274700         END-IF                                                   27470024
274800                                                                  27480024
274900         IF  ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > SPACE OR   27490024
275000             ASC-LINE-ITEM-N (ASC-BLK-SUB ASC-ITEM-SUB) > 0       27500024
275100             MOVE DP015-ASK-NOR-OFF                               27510024
275200                                 TO MR-SKU-RETAILA (PV-SUB)       27520024
275300                                    MR-A-UNITSA (PV-SUB)          27530024
275400         ELSE                                                     27540024
275500             MOVE DP015-ASK-DRK-OFF                               27550024
275600                                 TO MR-SKU-RETAILA (PV-SUB)       27560024
275700                                    MR-A-UNITSA (PV-SUB)          27570024
275800         END-IF                                                   27580024
275900                                                                  27590024
276000     SUBTRACT +1 FROM ASC-ITEM-SUB                                27600024
276100     IF  ASC-ITEM-SUB < + 1                                       27610024
276200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  27620024
276300         MOVE +1                 TO ASC-BLK-SUB                   27630024
276400     END-IF.                                                      27640024
276500                                                                  27650024
276600                                                                  27660024
276700*----------------------------------------------------------------*27670024
276800* GET PULL CURRENT STATUS                                        *27680024
276900*----------------------------------------------------------------*27690024
277000 4510-GET-PULL-STATUS.                                            27700024
277100                                                                  27710024
277200     MOVE  ASC-PULL-NBR-N  TO  DK-PULL-NUMBER                     27720024
277300                                                                  27730024
277400     EXEC SQL                                                     27740024
277500         SELECT  STAT_CDE                                         27750024
277600           INTO  :CEPLRQ-STAT-CDE                                 27760024
277700           FROM  TCEPLRQ                                          27770024
277800          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             27780024
277900     END-EXEC.                                                    27790024
278000                                                                  27800024
278100     EVALUATE TRUE                                                27810024
278200         WHEN SQLCODE = +0                                        27820024
278300              MOVE  CEPLRQ-STAT-CDE   TO  ASC-PULL-STATUS         27830024
278400         WHEN SQLCODE = -904                                      27840024
278500         WHEN SQLCODE = -911                                      27850024
278600         WHEN SQLCODE = -913                                      27860024
278700             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    27870024
278800             MOVE '4010-GET-PULL-STATUS '   TO PV-SOFT-PARAGRAPH  27880024
278900             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  27890024
279000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     27900024
279100               TO PV-COMMAREA-LENGTH                              27910024
279200             EXEC CICS                                            27920024
279300                  WRITEQ TD                                       27930024
279400                   QUEUE  ('CSSL')                                27940024
279500                    FROM  (PV-CICS-MSG-AREA2)                     27950024
279600                  LENGTH  (PV-COMMAREA-LENGTH)                    27960024
279700                    RESP  (PV-CICS-RESP)                          27970024
279800             END-EXEC                                             27980024
279900             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          27990024
280000             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              28000024
280100             PERFORM 9900-SOFT-ABORT                              28010024
280200         WHEN OTHER                                               28020024
280300              MOVE '4010-GET-PULL-STATUS '                        28030024
280400                               TO DP013-PARAGRAPH                 28040024
280500              MOVE 'GET PULL PULL STATUS     '                    28050024
280600                               TO DP013-MESSAGE-TEXT (1)          28060024
280700              MOVE SQLCA       TO DP013-SQLCA                     28070024
280800              MOVE 'TCEPLRQ '  TO DP013-DB2-TABLE-NAME (1)        28080024
280900              SET DP013-DB2-ABEND                                 28090024
281000                  DP013-XCTL-DISPLAY-RESTART                      28100024
281100                                   TO TRUE                        28110024
281200                  PERFORM DP013-0000-PROCESS-ABEND                28120024
281300     END-EVALUATE.                                                28130024
281400                                                                  28140024
281500                                                                  28150024
281600*----------------------------------------------------------------*28160024
281700* GET TOTAL NUMBER OF ACTIVE LINES & TOTAL NUMBER OF UNITS       *28170024
281800*----------------------------------------------------------------*28180024
281900 4520-GET-LINE-ITEM.                                              28190024
282000                                                                  28200024
282100     MOVE  ASC-PULL-NBR-N  TO  DK-PULL-NUMBER                     28210024
282200                                                                  28220024
282300     INITIALIZE  PV-CEPLIT-ITEM-QTY                               28230024
282400                 PV-CEPLIT-REQ-QTY.                               28240024
282500                                                                  28250024
282600     EXEC SQL                                                     28260024
282700         SELECT  COUNT(*)                                         28270024
282800                ,SUM(PL_REQ_QTY)                                  28280024
282900           INTO  :PV-CEPLIT-ITEM-QTY                              28290024
283000                ,:PV-CEPLIT-REQ-QTY  :PV-NULL-IND-1               28300024
283100           FROM  TCEPLIT                                          28310024
283200          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             28320024
283300            AND  STAT_CDE         IN  ('NW', 'IP', 'DS', 'PD')    28330024
283400     END-EXEC                                                     28340024
283500                                                                  28350024
283600     EVALUATE TRUE                                                28360024
283700         WHEN SQLCODE = +0                                        28370024
283800              CONTINUE                                            28380024
283900         WHEN SQLCODE = -904                                      28390024
284000         WHEN SQLCODE = -911                                      28400024
284100         WHEN SQLCODE = -913                                      28410024
284200             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    28420024
284300             MOVE '4020-GET-LINE-ITEM  '    TO PV-SOFT-PARAGRAPH  28430024
284400             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  28440024
284500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     28450024
284600               TO PV-COMMAREA-LENGTH                              28460024
284700             EXEC CICS                                            28470024
284800                  WRITEQ TD                                       28480024
284900                   QUEUE  ('CSSL')                                28490024
285000                    FROM  (PV-CICS-MSG-AREA2)                     28500024
285100                  LENGTH  (PV-COMMAREA-LENGTH)                    28510024
285200                    RESP  (PV-CICS-RESP)                          28520024
285300             END-EXEC                                             28530024
285400             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          28540024
285500             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              28550024
285600             PERFORM 9900-SOFT-ABORT                              28560024
285700         WHEN OTHER                                               28570024
285800              MOVE '4020-GET-LINE-ITEM'                           28580024
285900                               TO DP013-PARAGRAPH                 28590024
286000              MOVE 'GET PULL ITEM QUANTITIES '                    28600024
286100                               TO DP013-MESSAGE-TEXT (1)          28610024
286200              MOVE SQLCA       TO DP013-SQLCA                     28620024
286300              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        28630024
286400              SET DP013-DB2-ABEND                                 28640024
286500                  DP013-XCTL-DISPLAY-RESTART                      28650024
286600                                   TO TRUE                        28660024
286700                  PERFORM DP013-0000-PROCESS-ABEND                28670024
286800     END-EVALUATE.                                                28680024
286900                                                                  28690024
287000                                                                  28700024
287100*----------------------------------------------------------------*28710024
287200* GET LAST LINE ENTERED (MAX LINE NUMBER)                        *28720024
287300*----------------------------------------------------------------*28730024
287400 4530-GET-LAST-LINE.                                              28740024
287500                                                                  28750024
287600     MOVE  ASC-PULL-NBR-N  TO  DK-PULL-NUMBER                     28760024
287700                                                                  28770024
287800     INITIALIZE  ASC-LAST-UPC-ENTERED                             28780024
287900                 ASC-LAST-SKU-ENTERED.                            28790024
288000                                                                  28800024
288100     EXEC SQL                                                     28810024
288200          SELECT MAX(PL_LNE_NBR)                                  28820024
288300           INTO  :CEPLIT-PL-LNE-NBR :PV-NULL-IND-3                28830024
288400           FROM  TCEPLIT                                          28840024
288500          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             28850024
288600     END-EXEC                                                     28860024
288700                                                                  28870024
288800     EVALUATE TRUE                                                28880024
288900         WHEN SQLCODE = +0                                        28890024
289000              MOVE  CEPLIT-PL-LNE-NBR  TO  DK-LINE-NUMBER         28900024
289100              PERFORM 4540-GET-LAST-ITEM-NBR                      28910024
289200         WHEN SQLCODE = +100                                      28920024
289300              MOVE  SPACES  TO  ASC-LAST-UPC-ENTERED              28930024
289400         WHEN SQLCODE = -904                                      28940024
289500         WHEN SQLCODE = -911                                      28950024
289600         WHEN SQLCODE = -913                                      28960024
289700             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    28970024
289800             MOVE '4020-GET-LINE-ITEM  '    TO PV-SOFT-PARAGRAPH  28980024
289900             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  28990024
290000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     29000024
290100               TO PV-COMMAREA-LENGTH                              29010024
290200             EXEC CICS                                            29020024
290300                  WRITEQ TD                                       29030024
290400                   QUEUE  ('CSSL')                                29040024
290500                    FROM  (PV-CICS-MSG-AREA2)                     29050024
290600                  LENGTH  (PV-COMMAREA-LENGTH)                    29060024
290700                    RESP  (PV-CICS-RESP)                          29070024
290800             END-EXEC                                             29080024
290900             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          29090024
291000             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              29100024
291100             PERFORM 9900-SOFT-ABORT                              29110024
291200         WHEN OTHER                                               29120024
291300              MOVE '4030-GET-LAST-LINE'                           29130024
291400                               TO DP013-PARAGRAPH                 29140024
291500              MOVE 'GET LAST LINE NUMBER ENTERED'                 29150024
291600                               TO DP013-MESSAGE-TEXT (1)          29160024
291700              MOVE SQLCA       TO DP013-SQLCA                     29170024
291800              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        29180024
291900              SET DP013-DB2-ABEND                                 29190024
292000                  DP013-XCTL-DISPLAY-RESTART                      29200024
292100                                   TO TRUE                        29210024
292200                  PERFORM DP013-0000-PROCESS-ABEND                29220024
292300     END-EVALUATE.                                                29230024
292400                                                                  29240024
292500                                                                  29250024
292600*----------------------------------------------------------------*29260024
292700* GET LAST LINE ENTERED (MAX LINE NUMBER)                        *29270024
292800*----------------------------------------------------------------*29280024
292900 4540-GET-LAST-ITEM-NBR.                                          29290024
293000                                                                  29300024
293100     EXEC SQL                                                     29310024
293200          SELECT ITM_NBR                                          29320024
293300           INTO  :CEPLIT-ITM-NBR                                  29330024
293400           FROM  TCEPLIT                                          29340024
293500          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             29350024
293600            AND  PL_LNE_NBR        =  :DK-LINE-NUMBER             29360024
293700     END-EXEC                                                     29370024
293800                                                                  29380024
293900     EVALUATE TRUE                                                29390024
294000         WHEN SQLCODE = +0                                        29400024
294100              PERFORM 4550-GET-LAST-SKU                           29410024
294200*             PERFORM 4555-GET-LAST-UPC                           29420048
294300         WHEN SQLCODE = -904                                      29430024
294400         WHEN SQLCODE = -911                                      29440024
294500         WHEN SQLCODE = -913                                      29450024
294600             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    29460024
294700             MOVE '4540-GET-LAST-ITEM-NBR'  TO PV-SOFT-PARAGRAPH  29470024
294800             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  29480024
294900             MOVE LENGTH OF PV-CICS-MSG-AREA2                     29490024
295000               TO PV-COMMAREA-LENGTH                              29500024
295100             EXEC CICS                                            29510024
295200                  WRITEQ TD                                       29520024
295300                   QUEUE  ('CSSL')                                29530024
295400                    FROM  (PV-CICS-MSG-AREA2)                     29540024
295500                  LENGTH  (PV-COMMAREA-LENGTH)                    29550024
295600                    RESP  (PV-CICS-RESP)                          29560024
295700             END-EXEC                                             29570024
295800             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          29580024
295900             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              29590024
296000             PERFORM 9900-SOFT-ABORT                              29600024
296100         WHEN OTHER                                               29610024
296200              MOVE '4540-GET-LAST-ITEM-NBR'                       29620024
296300                               TO DP013-PARAGRAPH                 29630024
296400              MOVE 'GET ITEM NBR FOR LAST LINE ENTERED'           29640024
296500                               TO DP013-MESSAGE-TEXT (1)          29650024
296600              MOVE SQLCA       TO DP013-SQLCA                     29660024
296700              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        29670024
296800              SET DP013-DB2-ABEND                                 29680024
296900                  DP013-XCTL-DISPLAY-RESTART                      29690024
297000                                   TO TRUE                        29700024
297100                  PERFORM DP013-0000-PROCESS-ABEND                29710024
297200     END-EVALUATE.                                                29720024
297300                                                                  29730024
297400                                                                  29740024
297500*----------------------------------------------------------------*29750024
297600*  GET LAST SKU ENTERED                     WR/IR# 230ZZ         *29760051
297700*----------------------------------------------------------------*29770024
297800 4550-GET-LAST-SKU.                                               29780024
297900                                                                  29790048
298000     INITIALIZE  XL001-ITEM-COMMAREA.                             29800048
298100                                                                  29810024
298200     MOVE CEPLIT-ITM-NBR  TO  XL001-KEY-ITM-NBR.                  29820048
298300                                                                  29830024
298400     SET  XL001-BY-ITEM                                           29840048
298500          XL001-SELECT-SKU                                        29850048
298600          XL001-SELECT-UPC TO TRUE.                               29860048
298700                                                                  29870048
298800     CALL XL001-VSM-PGM USING  DFHEIBLK                           29880048
298900                               XL001-COMMAREA                     29890048
299000                               XL001-ITEM-COMMAREA.               29900048
299100     EVALUATE TRUE                                                29910024
299200         WHEN XL001-SKU-SQLCODE = +0                              29920048
299300              MOVE XL001-SKU-NBR   TO PV-SKU-NUMBER               29930048
299400              MOVE PV-SKU-NUMBER  TO  ASC-LAST-SKU-ENTERED        29940051
299500              PERFORM 4551-SELECT-UPC                             29950048
299600                                                                  29960048
299700         WHEN XL001-SKU-SQLCODE = +100                            29970048
299800              MOVE  '*UNKNOWN*'    TO  ASC-LAST-SKU-ENTERED       29980048
299900              MOVE  '*** UNKNOWN ***'                             29990048
300000                                   TO ASC-LAST-UPC-ENTERED        30000048
300100                                                                  30010048
300200         WHEN XL001-SKU-CONTENTION                                30020051
300300             MOVE XL001-SKU-SQLCODE         TO PV-SOFT-SQLCODE    30030048
300400             MOVE '4550-GET-LAST-SKU'       TO PV-SOFT-PARAGRAPH  30040024
300500             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  30050024
300600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     30060024
300700               TO PV-COMMAREA-LENGTH                              30070024
300800             EXEC CICS                                            30080024
300900                  WRITEQ TD                                       30090024
301000                   QUEUE  ('CSSL')                                30100024
301100                    FROM  (PV-CICS-MSG-AREA2)                     30110024
301200                  LENGTH  (PV-COMMAREA-LENGTH)                    30120024
301300                    RESP  (PV-CICS-RESP)                          30130024
301400             END-EXEC                                             30140024
301500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          30150024
301600             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              30160024
301700             PERFORM 9900-SOFT-ABORT                              30170024
301800                                                                  30180048
301900         WHEN OTHER                                               30190048
302000              MOVE ' 4550-GET-LAST-SKU'                           30200024
302100                               TO DP013-PARAGRAPH                 30210024
302200              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           30220024
302300              STRING ' PULL-'           DELIMITED BY SIZE         30230024
302400                     PV-PULL-NUMBER     DELIMITED BY SIZE         30240024
302500                     '  -  LINE-'       DELIMITED BY SIZE         30250024
302600                     PV-LINE-NUMBER     DELIMITED BY SIZE         30260024
302700                     '  -  ITEM NBR-'   DELIMITED BY SIZE         30270024
302800                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         30280024
302900                     '  TRYING TO GET LAST SKU NUMBER'            30290024
303000                                        DELIMITED BY SIZE         30300024
303100                             INTO DP013-MESSAGE-TEXT (1)          30310024
303200              MOVE XL001-SQLCA TO DP013-SQLCA                     30320051
303300              MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (2)        30330051
303400              SET DP013-DB2-ABEND                                 30340024
303500                  DP013-XCTL-DISPLAY-RESTART                      30350024
303600                                   TO TRUE                        30360024
303700                  PERFORM DP013-0000-PROCESS-ABEND                30370024
303800     END-EVALUATE.                                                30380024
303900                                                                  30390048
304000 4551-SELECT-UPC.                                                 30400048
304100                                                                  30410048
304200     EVALUATE TRUE                                                30420048
304300         WHEN XL001-UPC-SQLCODE = +0                              30430048
304400              MOVE  XL001-UPC-NBR      TO  ASC-LAST-UPC-ENTERED   30440056
304500                                                                  30450048
304600         WHEN XL001-UPC-SQLCODE = +100                            30460048
304700              MOVE  '*** UNKNOWN ***'  TO  ASC-LAST-UPC-ENTERED   30470048
304800                                                                  30480048
304900         WHEN XL001-UPC-SQLCODE = -811                            30490048
305000              MOVE  '*** MULTIPLE ***' TO  ASC-LAST-UPC-ENTERED   30500048
305100                                                                  30510048
305200         WHEN XL001-UPC-CONTENTION                                30520051
305300             MOVE XL001-UPC-SQLCODE         TO PV-SOFT-SQLCODE    30530048
305400             MOVE '4551-SELECT-UPC'         TO PV-SOFT-PARAGRAPH  30540048
305500             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  30550048
305600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     30560048
305700               TO PV-COMMAREA-LENGTH                              30570048
305800             EXEC CICS                                            30580048
305900                  WRITEQ TD                                       30590048
306000                   QUEUE  ('CSSL')                                30600048
306100                    FROM  (PV-CICS-MSG-AREA2)                     30610048
306200                  LENGTH  (PV-COMMAREA-LENGTH)                    30620048
306300                    RESP  (PV-CICS-RESP)                          30630048
306400             END-EXEC                                             30640048
306500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          30650048
306600             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              30660048
306700             PERFORM 9900-SOFT-ABORT                              30670048
306800                                                                  30680048
306900         WHEN OTHER                                               30690048
307000              MOVE ' 4551-SELECT-UPC'                             30700048
307100                               TO DP013-PARAGRAPH                 30710048
307200              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           30720048
307300              STRING ' PULL-'           DELIMITED BY SIZE         30730048
307400                     PV-PULL-NUMBER     DELIMITED BY SIZE         30740048
307500                     '  -  LINE-'       DELIMITED BY SIZE         30750048
307600                     PV-LINE-NUMBER     DELIMITED BY SIZE         30760048
307700                     '  -  ITEM NBR-'   DELIMITED BY SIZE         30770048
307800                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         30780048
307900                     '  TRYING TO GET LAST UPC NUMBER'            30790056
308000                                        DELIMITED BY SIZE         30800048
308100                             INTO DP013-MESSAGE-TEXT (1)          30810048
308200              MOVE XL001-SQLCA TO DP013-SQLCA                     30820051
308300              MOVE 'XLV_UPC '  TO DP013-DB2-TABLE-NAME (2)        30830048
308400              SET DP013-DB2-ABEND                                 30840048
308500                  DP013-XCTL-DISPLAY-RESTART                      30850048
308600                                   TO TRUE                        30860048
308700                  PERFORM DP013-0000-PROCESS-ABEND                30870048
308800     END-EVALUATE.                                                30880048
308900                                                                  30890085
309000                                                                  30900085
309100****************************************************************  30910085
309200*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION FOR        *  30920085
309300*                                                              *  30930085
309400****************************************************************  30940085
309500 4600-GET-STORE-INFORMATION.                                      30950085
309600                                                                  30960085
309700     INITIALIZE XL071-COMMAREA.                                   30970085
309800     MOVE DK-STORE-NUMBER TO XL071-LOCATION-NUMBER.               30980085
309900                                                                  30990085
310000     CALL XL071-LOCATION-MODULE USING                             31000085
310100                                DFHEIBLK                          31010085
310200                                XL071-COMMAREA                    31020085
310300                                XL071-COMMAREA-REC.               31030085
310400                                                                  31040085
310500     EVALUATE TRUE                                                31050085
310600         WHEN XL071-NO-ERRORS                                     31060085
310700              CONTINUE                                            31070085
310800                                                                  31080085
310900         WHEN OTHER                                               31090085
335500              MOVE ' 4600-GET-STORE-INFORMATION'                  33550000
335600                               TO DP013-PARAGRAPH                 33560000
335700              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           33570000
335800              STRING ' PULL-'                                     33580085
335900                     PV-PULL-NUMBER                               33590085
336000                     '  -  LINE-'                                 33600085
336100                     PV-LINE-NUMBER                               33610085
336200                     '  -  ITEM NBR-'                             33620085
336300                     PV-CEPLIT-ITM-NBR                            33630085
336400                     '  TRYING TO GET LAST SKU NUMBER'            33640000
336500                                        DELIMITED BY SIZE         33650000
336600                             INTO DP013-MESSAGE-TEXT (1)          33660000
336700              MOVE XL071-SQLCODE   TO SQLCODE                     33670085
336800              MOVE XL071-SQLCA     TO DP013-SQLCA                 33680085
336810              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    33681085
336900              SET DP013-DB2-ABEND                                 33690000
337000                  DP013-XCTL-DISPLAY-RESTART                      33700000
337100                                   TO TRUE                        33710000
337200                  PERFORM DP013-0000-PROCESS-ABEND                33720000
337300                                                                  33730085
337301     END-EVALUATE.                                                33730185
337302                                                                  33730224
337303*----------------------------------------------------------------*33730324
337304*  ADD FUNCTION                                                  *33730424
337305*----------------------------------------------------------------*33730524
337306 4700-PROCESS-ADD-FUNCTION.                                       33730624
337307                                                                  33730724
337308     MOVE +1                       TO ASC-BLK-SUB.                33730824
337309     PERFORM 5100-WRITE-TEMP-STORAGE.                             33730924
337310                                                                  33731024
337311     PERFORM 6112-READ-LIST-QUEUE.                                33731124
337312                                                                  33731224
337313     SET  LQW-IDX  TO   1.                                        33731324
337314                                                                  33731424
337315     IF PS-NO-SOFT-ABORT-ERROR                                    33731524
337316       IF PV-CICS-RESP = DFHRESP (NORMAL)                         33731624
337317         PERFORM                                                  33731724
337318         VARYING LQW-IDX  FROM 1 BY 1                             33731824
337319         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     33731924
337320            OR   PS-SOFT-ABORT-ERROR                              33732024
337321            OR   PS-ERROR                                         33732124
337322             IF  LQW-SELECT (LQW-IDX)                             33732224
337323                 PERFORM 4705-PROCESS-SELECTED-LINES              33732324
337324             END-IF                                               33732424
337325         END-PERFORM                                              33732524
337326       END-IF                                                     33732624
337327     END-IF.                                                      33732724
337328                                                                  33732824
337329     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           33732924
337330     PERFORM 6111-WRITE-LIST-QUEUE.                               33733024
337331                                                                  33733124
337332     MOVE +1                     TO  ASC-BLK-SUB.                 33733224
337333     PERFORM 4410-READ-TEMP-STORAGE.                              33733324
337334                                                                  33733424
337335                                                                  33733524
337336                                                                  33733624
337337*----------------------------------------------------------------*33733724
337338*                                                                *33733824
337339*----------------------------------------------------------------*33733924
337340 4705-PROCESS-SELECTED-LINES.                                     33734024
337341                                                                  33734124
337342     PERFORM 4710-ADD-LINES.                                      33734224
337343                                                                  33734324
337344     IF  PS-NO-ERROR                                              33734424
337345         SET DP020-MSG-INFORMATIONAL  TO  TRUE                    33734524
337346         MOVE PC-TSYMSG-02352  TO  DP020-MSG-NUMBER               33734624
337347     END-IF.                                                      33734724
337348                                                                  33734824
337349                                                                  33734924
337350*----------------------------------------------------------------*33735024
337351*                                                                *33735124
337352*                                                                *33735224
337353*----------------------------------------------------------------*33735324
337354 4710-ADD-LINES.                                                  33735424
337355                                                                  33735524
337356     MOVE ASC-PULL-NBR                   TO PV-PULL-NUMBER        33735624
337357                                            DK-PULL-NUMBER.       33735724
337358                                                                  33735824
337359     IF  LQW-SELECT (LQW-IDX)                                     33735924
337360         IF  PS-NO-ERROR                                          33736032
337361             IF XL071-E-BUS-IND = 'Y' AND                         33736140
337362                XL071-LOC-TYP-CDE = 'DS' AND                      33736241
337363                PS-PROCESS-MQ-YES                                 33736385
337364                 PERFORM 4740-RESERVE-QUANTITY                    33736432
337365                 IF PS-REDUCE-QTY                                 33736534
337366                     IF LQW-UNITS (LQW-IDX) =                     33736634
337367                                        LQW-AVAIL-UNITS (LQW-IDX) 33736734
337368                         MOVE CE016-TRANS-AVAIL-QTY TO            33736834
337369                                        LQW-UNITS (LQW-IDX)       33736934
337370                         PERFORM 4740-RESERVE-QUANTITY            33737034
337371                     ELSE                                         33737134
337372                         SET PS-ERROR TO TRUE                     33737234
337373                         MOVE PC-TSYMSG-02314 TO DP020-MSG-NUMBER 33737334
337374                         MOVE DP015-RED     TO MR-UNITSC (LQW-IDX)33737434
337375                         MOVE DP015-REVERSE TO MR-UNITSH (LQW-IDX)33737534
337376                         MOVE -1            TO MR-UNITSL (LQW-IDX)33737634
337377                     END-IF                                       33737734
337378                 END-IF                                           33737834
337379             ELSE                                                 33737934
337380                 SET CE016-TRANS-SUCCESSFUL TO TRUE               33738034
337381             END-IF                                               33738134
337382         END-IF                                                   33738234
337383                                                                  33738334
337384         IF  PS-NO-ERROR                                          33738424
337385             PERFORM 4715-GET-NEXT-LINE-NBR                       33738524
337386         END-IF                                                   33738624
337387                                                                  33738724
337388         IF  PS-NO-ERROR                                          33738824
337389             PERFORM 4720-INSERT-TCEPLIT                          33738924
337390         END-IF                                                   33739024
337391                                                                  33739124
337392         IF  PS-NO-ERROR                                          33739224
337393             PERFORM 4725-INSERT-TCEPLST                          33739324
337394         END-IF                                                   33739424
337395                                                                  33739524
337396         IF  PS-NO-ERROR                                          33739624
337397             IF  ASC-STORE-NBR  >  0                              33739724
337398                PERFORM 4730-INSERT-TCEPLDS                       33739824
337399             END-IF                                               33739924
337400         END-IF                                                   33740024
337401                                                                  33740124
337402         IF  PS-NO-ERROR                                          33740224
337403             EXEC CICS SYNCPOINT                                  33740324
337404             END-EXEC                                             33740424
337405         END-IF                                                   33740524
337406                                                                  33740624
337407         IF  PS-NO-ERROR                                          33740724
337408             MOVE  LQW-UPC (LQW-IDX)                              33740824
337409               TO  ASC-LAST-UPC-ENTERED                           33740924
337410         END-IF                                                   33741024
337411                                                                  33741124
337412     END-IF.                                                      33741225
337413                                                                  33741325
337414     IF PS-NO-ERROR AND                                           33741425
337415        CE016-TRANS-SUCCESSFUL                                    33741525
337416                                                                  33741625
337417         EXEC CICS SYNCPOINT                                      33741725
337418         END-EXEC                                                 33741825
337419                                                                  33741925
337420         SET  LQW-ADD (LQW-IDX)        TO  TRUE                   33742024
337421         MOVE LQW-SELECTED-SW (LQW-IDX)                           33742124
337422                              TO LQW-TEMP-SELECTED-SW (LQW-IDX)   33742224
337423     END-IF.                                                      33742324
337424                                                                  33742424
337425                                                                  33742524
337426*----------------------------------------------------------------*33742624
337427*                                                                *33742724
337428*----------------------------------------------------------------*33742824
337429 4715-GET-NEXT-LINE-NBR.                                          33742924
337430                                                                  33743024
337431     EXEC SQL                                                     33743124
337432          SELECT MAX(PL_LNE_NBR)                                  33743224
337433           INTO  :CEPLIT-PL-LNE-NBR                               33743324
337434           FROM  TCEPLIT                                          33743424
337435          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             33743524
337436     END-EXEC                                                     33743624
337437                                                                  33743724
337438     EVALUATE TRUE                                                33743824
337439         WHEN SQLCODE = +0                                        33743924
337440              MOVE  CEPLIT-PL-LNE-NBR  TO  DK-LINE-NUMBER         33744024
337441              ADD   1                  TO  DK-LINE-NUMBER         33744124
351100              IF DK-LINE-NUMBER    > PV-MAX-PULL-LINES            33744287
351300                  SET PS-ERROR         TO  TRUE                   33744387
141300                  MOVE PC-TSYMSG-03821  TO DP020-MSG-NUMBER       33744487
141400                  MOVE -1               TO ASEL01L                33744587
141500                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             33744687
141600                  SET DP020-MSG-FATAL   TO TRUE                   33744787
351100              ELSE                                                33744887
351300                  MOVE  DK-LINE-NUMBER TO  LQW-LINE-NBR(LQW-IDX)  33744987
351100              END-IF                                              33745087
337442*             MOVE  DK-LINE-NUMBER     TO  LQW-LINE-NBR(LQW-IDX)  33745187
337443         WHEN SQLCODE = -305                                      33745224
337444              MOVE  1                  TO  DK-LINE-NUMBER         33745324
337445              MOVE  DK-LINE-NUMBER     TO  LQW-LINE-NBR(LQW-IDX)  33745424
337446         WHEN SQLCODE = -904                                      33745524
337447         WHEN SQLCODE = -911                                      33745624
337448         WHEN SQLCODE = -913                                      33745724
337449             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    33745824
337450             MOVE '4715-GET-NEXT-LINE-NBR'  TO PV-SOFT-PARAGRAPH  33745924
337451             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  33746024
337452             MOVE LENGTH OF PV-CICS-MSG-AREA2                     33746124
337453               TO PV-COMMAREA-LENGTH                              33746224
337454             EXEC CICS                                            33746324
337455                  WRITEQ TD                                       33746424
337456                   QUEUE  ('CSSL')                                33746524
337457                    FROM  (PV-CICS-MSG-AREA2)                     33746624
337458                  LENGTH  (PV-COMMAREA-LENGTH)                    33746724
337459                    RESP  (PV-CICS-RESP)                          33746824
337460             END-EXEC                                             33746924
337461             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          33747024
337462             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              33747124
337463             PERFORM 9900-SOFT-ABORT                              33747224
337464         WHEN OTHER                                               33747324
337465              MOVE '4715-GET-NEXT-LINE-NBR'                       33747424
337466                               TO DP013-PARAGRAPH                 33747524
337467              MOVE 'GET NEXT LINE NUMBER'                         33747624
337468                               TO DP013-MESSAGE-TEXT (1)          33747724
337469              MOVE SQLCA       TO DP013-SQLCA                     33747824
337470              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        33747924
337471              SET DP013-DB2-ABEND                                 33748024
337472                  DP013-XCTL-DISPLAY-RESTART                      33748124
337473                                   TO TRUE                        33748224
337474                  PERFORM DP013-0000-PROCESS-ABEND                33748324
337475     END-EVALUATE.                                                33748424
337476                                                                  33748524
337477                                                                  33748624
337478*----------------------------------------------------------------*33748724
337479* INSERT ROW INTO CS PULL ITEM TABLE (TCEPLIT)                   *33748824
337480*----------------------------------------------------------------*33748924
337481 4720-INSERT-TCEPLIT.                                             33749024
337482                                                                  33749124
337483     MOVE  ASC-PULL-NBR-N           TO  CEPLIT-CNSTK-REQ-PL-NBR.  33749224
337484     MOVE  LQW-LINE-NBR (LQW-IDX)   TO  CEPLIT-PL-LNE-NBR.        33749324
337485     MOVE  LQW-LINE-ITEM (LQW-IDX)  TO  CEPLIT-ITM-NBR.           33749424
337486     MOVE  LQW-UNITS (LQW-IDX)      TO  CEPLIT-PL-REQ-QTY.        33749524
337487     MOVE  PC-NEW                   TO  CEPLIT-STAT-CDE.          33749624
337488     MOVE  LQW-SKU-RETAIL (LQW-IDX) TO  CEPLIT-UNT-RTL-AMT.       33749724
337489     MOVE  SPACES                   TO  CEPLIT-EXPRT-PRC-BTCH-ID. 33749824
337490                                                                  33749924
337491     EXEC SQL                                                     33750024
337492          INSERT                                                  33750124
337493          INTO  TCEPLIT                                           33750224
337494               (CNSTK_REQ_PL_NBR                                  33750324
337495               ,PL_LNE_NBR                                        33750424
337496               ,ITM_NBR                                           33750524
337497               ,PL_REQ_QTY                                        33750624
337498               ,ACTL_PL_QTY                                       33750724
337499               ,STAT_CDE                                          33750824
337500               ,UNT_RTL_AMT                                       33750924
337501               ,EXPRT_PRC_BTCH_ID)                                33751024
337502        VALUES                                                    33751124
337503              (:CEPLIT-CNSTK-REQ-PL-NBR                           33751224
337504              ,:CEPLIT-PL-LNE-NBR                                 33751324
337505              ,:CEPLIT-ITM-NBR                                    33751424
337506              ,:CEPLIT-PL-REQ-QTY                                 33751524
337507              ,NULL                                               33751624
337508              ,:CEPLIT-STAT-CDE                                   33751724
337509              ,:CEPLIT-UNT-RTL-AMT                                33751824
337510              ,:CEPLIT-EXPRT-PRC-BTCH-ID)                         33751924
337511     END-EXEC.                                                    33752024
337512                                                                  33752124
337513     EVALUATE TRUE                                                33752224
337514         WHEN SQLCODE = ZERO                                      33752324
337515              CONTINUE                                            33752424
337516                                                                  33752524
337517         WHEN SQLWARN0 NOT = +0                                   33752624
337518         WHEN SQLCODE < +0                                        33752724
337519         WHEN SQLCODE > +0                                        33752824
337520              SET PS-ERROR    TO TRUE                             33752924
337521              MOVE '4720-INSERT-TCEPLIT '                         33753024
337522                              TO DP013-PARAGRAPH                  33753124
337523              MOVE 'UNSUCCESSFUL INSERT IN CS ITEM      '         33753224
337524                              TO DP013-MESSAGE-TEXT (1)           33753324
337525              MOVE 'INSERT NEW REQUEST LINE ITEM        '         33753424
337526                              TO DP013-MESSAGE-TEXT (2)           33753524
337527              MOVE SQLCA      TO DP013-SQLCA                      33753624
337528              MOVE 'TCEPLIT ' TO DP013-DB2-TABLE-NAME (1)         33753724
337529              SET DP013-DB2-ABEND                                 33753824
337530                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            33754024
337600          PERFORM DP013-0000-PROCESS-ABEND                        33760024
337700     END-EVALUATE.                                                33770024
337800                                                                  33780024
337900                                                                  33790024
338000*----------------------------------------------------------------*33800024
338100* INSERT ROW INTO CS PULL STATUS TABLE (TCEPLST)                 *33810024
338200*----------------------------------------------------------------*33820024
338300 4725-INSERT-TCEPLST.                                             33830024
338400                                                                  33840024
338500     MOVE  ASC-PULL-NBR-N         TO  CEPLST-CNSTK-REQ-PL-NBR.    33850024
338600     MOVE  LQW-LINE-NBR (LQW-IDX) TO  CEPLST-PL-LNE-NBR.          33860024
338700     MOVE  PC-NEW                 TO  CEPLST-STAT-CDE.            33870024
338800     MOVE  ASC-USER-ID            TO  CEPLST-CRE-BY-USR-ID.       33880024
338900                                                                  33890024
339000     EXEC SQL                                                     33900024
339100          INSERT                                                  33910024
339200          INTO  TCEPLST                                           33920024
339300               (CNSTK_REQ_PL_NBR                                  33930024
339400               ,PL_LNE_NBR                                        33940024
339500               ,CRE_TMST                                          33950024
339600               ,STAT_CDE                                          33960024
339700               ,CRE_BY_USR_ID)                                    33970024
339800        VALUES                                                    33980024
339900              (:CEPLST-CNSTK-REQ-PL-NBR                           33990024
340000              ,:CEPLST-PL-LNE-NBR                                 34000024
340100              , CURRENT TIMESTAMP                                 34010024
340200              ,:CEPLST-STAT-CDE                                   34020024
340300              ,:CEPLST-CRE-BY-USR-ID)                             34030024
340400     END-EXEC.                                                    34040024
340500                                                                  34050024
340600     EVALUATE TRUE                                                34060024
340700         WHEN SQLCODE = ZERO                                      34070024
340800              CONTINUE                                            34080024
340900                                                                  34090024
341000         WHEN SQLWARN0 NOT = +0                                   34100024
341100         WHEN SQLCODE < +0                                        34110024
341200         WHEN SQLCODE > +0                                        34120024
341300              SET PS-ERROR    TO TRUE                             34130024
341400              MOVE '4725-INSERT-TCEPLST'                          34140024
341500                              TO DP013-PARAGRAPH                  34150024
341600              MOVE 'UNSUCCESSFUL INSERT IN CS STATUS TBL'         34160024
341700                              TO DP013-MESSAGE-TEXT (1)           34170024
341800              MOVE 'INSERT STATUS FOR LINE              '         34180024
341900                              TO DP013-MESSAGE-TEXT (2)           34190024
342000              MOVE SQLCA      TO DP013-SQLCA                      34200024
342100              MOVE 'TCEPLST ' TO DP013-DB2-TABLE-NAME (1)         34210024
342200              SET DP013-DB2-ABEND                                 34220024
342300                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            34230024
342400          PERFORM DP013-0000-PROCESS-ABEND                        34240024
342500     END-EVALUATE.                                                34250024
342600                                                                  34260024
342700                                                                  34270024
342800*----------------------------------------------------------------*34280024
342900* INSERT ROW INTO CS PULL DISTRIBUTION TABLE (TCEPLDS)           *34290024
343000*----------------------------------------------------------------*34300024
343100 4730-INSERT-TCEPLDS.                                             34310024
343200                                                                  34320024
343300     MOVE  ASC-PULL-NBR-N         TO  CEPLDS-CNSTK-REQ-PL-NBR.    34330024
343400     MOVE  LQW-LINE-NBR (LQW-IDX) TO  CEPLDS-PL-LNE-NBR.          34340024
343500     MOVE  ASC-STORE-NBR          TO  CEPLDS-STR-NBR.             34350024
343600     MOVE  LQW-UNITS (LQW-IDX)    TO  CEPLDS-REQ-ORD-QTY.         34360024
343700                                                                  34370024
343800     EXEC SQL                                                     34380024
343900          INSERT                                                  34390024
344000          INTO  TCEPLDS                                           34400024
344100               (CNSTK_REQ_PL_NBR                                  34410024
344200               ,PL_LNE_NBR                                        34420024
344300               ,STR_NBR                                           34430024
344400               ,REQ_ORD_QTY                                       34440024
344500               ,ACTL_DISTRB_QTY)                                  34450024
344600        VALUES                                                    34460024
344700              (:CEPLDS-CNSTK-REQ-PL-NBR                           34470024
344800              ,:CEPLDS-PL-LNE-NBR                                 34480024
344900              ,:CEPLDS-STR-NBR                                    34490024
345000              ,:CEPLDS-REQ-ORD-QTY                                34500024
345100              ,NULL)                                              34510024
345200     END-EXEC.                                                    34520024
345300                                                                  34530024
345400     EVALUATE TRUE                                                34540024
345500         WHEN SQLCODE = ZERO                                      34550024
345600              CONTINUE                                            34560024
345700                                                                  34570024
345800         WHEN SQLWARN0 NOT = +0                                   34580024
345900         WHEN SQLCODE < +0                                        34590024
346000         WHEN SQLCODE > +0                                        34600024
346100              SET PS-ERROR    TO TRUE                             34610024
346200              MOVE '4730-INSERT-TCEPLDS'                          34620024
346300                              TO DP013-PARAGRAPH                  34630024
346400              MOVE 'UNSUCCESSFUL INSERT IN CS DISTRB TBL'         34640024
346500                              TO DP013-MESSAGE-TEXT (1)           34650024
346600              MOVE 'INSERT DISTRIBUTION                 '         34660024
346700                              TO DP013-MESSAGE-TEXT (2)           34670024
346800              MOVE SQLCA      TO DP013-SQLCA                      34680024
346900              MOVE 'TCEPLDS ' TO DP013-DB2-TABLE-NAME (1)         34690024
347000              SET DP013-DB2-ABEND                                 34700024
347100                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            34710024
347200          PERFORM DP013-0000-PROCESS-ABEND                        34720024
347300     END-EVALUATE.                                                34730024
347400                                                                  34740024
347500                                                                  34750032
347600 4740-RESERVE-QUANTITY.                                           34760032
347700     INITIALIZE CE016-INV-TRANS-RECORD                            34770032
347800     MOVE LQW-SKU(LQW-IDX)     TO PV-SKU-NUMBER.                  34780032
347900     MOVE PV-SKU-NUMBER        TO PV-SKU-NBR.                     34790048
348000     MOVE PV-SKU-NBR           TO CE016-SKU-NUMBER.               34800032
348100     MOVE ASC-CS-LOC-N         TO CE016-STORE-NUMBER.             34810032
348200     SET CE016-TRANS-TYPE-X-TRANSFER TO TRUE.                     34820032
348300     SET CE016-TRANS-SRC-CENTRAL-STOCK TO TRUE.                   34830032
348400     MOVE ZERO                 TO CE016-TRANS-AVAIL-QTY.          34840032
348500     MOVE LQW-UNITS (LQW-IDX)  TO CE016-TRANS-RESV-QTY.           34850032
348600     MOVE PV-CURRENT-DATE TO CE016-TRANS-DATE.                    34860032
348700     MOVE ASC-PULL-NBR         TO PV-TRANS-PULL-NBR.              34870032
348800     MOVE PV-TRANS-SOURCE-DESC TO CE016-TRANS-SOURCE-DESC.        34880032
348900     SET PS-NO-REDUCE-QTY TO TRUE.                                34890032
349000     SET PS-SKU-FOUND     TO TRUE.                                34900032
349100     SET PS-SKU-PROCESSED TO TRUE.                                34910032
349200     PERFORM 8010-MQ-PUT1.                                        34920032
349300                                                                  34930024
349400*----------------------------------------------------------------*34940024
349500* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *34950024
349600* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *34960024
349700* FOR THE SELECTED ITEMS QUEUE.                                  *34970024
349800*                                                                *34980024
349900* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *34990024
350000* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *35000024
350100* THE ARRAY IS FULL.                                             *35010024
350200*----------------------------------------------------------------*35020024
350300                                                                  35030024
350400 5000-PREPARE-SEL-QUEUE.                                          35040024
350500                                                                  35050024
350600     MOVE +1                   TO  ASC-BLK-SUB.                   35060024
350700     PERFORM 5100-WRITE-TEMP-STORAGE.                             35070024
350800                                                                  35080024
350900     MOVE ASC-SEL-QUEUE-NAME   TO  CE002-SEL-QUEUE-NAME.          35090024
351000     PERFORM 6010-DELETE-SEL-QUEUE.                               35100024
351100                                                                  35110024
351200     SET ASC-UPDATE-TSQ        TO  TRUE.                          35120024
351300                                                                  35130024
351400     SET CE003-IDX             TO  1.                             35140024
351500     MOVE ZERO                 TO CE002-NUMBER-OF-TS-ITEMS.       35150024
351600     INITIALIZE CE003-SELECTED-ITEM-ARRAY.                        35160024
351700                                                                  35170024
351800     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           35180024
351900             VARYING PV-ITEM                                      35190024
352000             FROM 1 BY 1                                          35200024
352100             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     35210024
352200                                                                  35220024
352300     IF  CE003-IDX > 1                                            35230024
352400         PERFORM 5205-WRITE-SEL-QUEUE                             35240024
352500         ADD +1                TO CE002-NUMBER-OF-TS-ITEMS        35250024
352600     END-IF.                                                      35260024
352700                                                                  35270024
352800                                                                  35280024
352900*----------------------------------------------------------------*35290024
353000* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  THIS WILL ONLY *35300024
353100* CREATE ONE ENTRY IN THE SELECTION QUEUE.  THE NEXT PROGRAM     *35310024
353200* CAN ACCEPT MULTIPLE QUEUE ENTRIES, EACH CONTAINING A DIFFERENT *35320024
353300* LINE NUMBER.  SINCE THIS PROGRAM IS ONLY WORKING WITH ONE      *35330024
353400* LINE NUMBER IT WILL ONLY CREATE ONE ENTRY IN THE QUEUE.        *35340024
353500*                                                                *35350024
353600* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *35360024
353700* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *35370024
353800* THE ARRAY IS FULL.                                             *35380024
353900*----------------------------------------------------------------*35390024
354000 5000-PREPARE-SEL-QUEUE-1.                                        35400024
354100                                                                  35410024
354200     MOVE +1                   TO  ASC-BLK-SUB.                   35420024
354300     PERFORM 5100-WRITE-TEMP-STORAGE.                             35430024
354400                                                                  35440024
354500     MOVE ASC-SEL-QUEUE-NAME   TO  CE002-SEL-QUEUE-NAME.          35450024
354600     PERFORM 6010-DELETE-SEL-QUEUE.                               35460024
354700                                                                  35470024
354800     SET ASC-UPDATE-TSQ        TO  TRUE.                          35480024
354900                                                                  35490024
355000     MOVE ZERO                 TO CE002-NUMBER-OF-TS-ITEMS.       35500024
355100     INITIALIZE CE003-SELECTED-ITEM-ARRAY.                        35510024
355200                                                                  35520024
355300     PERFORM 5200-FILL-SEL-QUEUE-RECORD-1.                        35530024
355400                                                                  35540024
355500     PERFORM 5205-WRITE-SEL-QUEUE                                 35550024
355600     ADD +1                    TO CE002-NUMBER-OF-TS-ITEMS.       35560024
355700                                                                  35570024
355800                                                                  35580024
355900*----------------------------------------------------------------*35590024
356000*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *35600024
356100*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *35610024
356200*----------------------------------------------------------------*35620024
356300                                                                  35630024
356400 5100-WRITE-TEMP-STORAGE.                                         35640024
356500     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     35650024
356600                                   TO PV-LIST-ITEM-NUMBER.        35660024
356700     COMPUTE PV-BLOCK-NUMBER =                                    35670024
356800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    35680024
356900                                                                  35690024
357000     IF  ASC-HIGHEST-BLOCK-WRITTEN  >  +1                         35700024
357100         MOVE  +1  TO  ASC-HIGHEST-BLOCK-WRITTEN                  35710024
357200     END-IF.                                                      35720024
357300                                                                  35730024
357400     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             35740024
357500     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             35750024
357600         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      35760024
357700             PERFORM 5105-REWRITE-ASC-LISTQ                       35770024
357800         END-IF                                                   35780024
357900     ELSE                                                         35790024
358000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       35800024
358100         ASC-HIGHEST-BLOCK-WRITTEN + 1                            35810024
358200         PERFORM 5110-WRITE-ASC-LISTQ                             35820024
358300         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   35830024
358400     END-IF.                                                      35840024
358500                                                                  35850024
358600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             35860024
358700******************************************************************35870024
358800** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **35880024
358900** SPECIFIC COMMAREA.                                           **35890024
359000******************************************************************35900024
359100 5105-REWRITE-ASC-LISTQ.                                          35910024
359200     EXEC CICS                                                    35920024
359300         WRITEQ TS                                                35930024
359400             QUEUE (ASC-LIST-QUEUE-NAME)                          35940024
359500             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35950024
359600             ITEM  (PV-BLOCK-NUMBER)                              35960024
359700             REWRITE                                              35970024
359800             RESP  (PV-CICS-RESP)                                 35980024
359900     END-EXEC.                                                    35990024
360000                                                                  36000024
360100     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           36010024
360200         CONTINUE                                                 36020024
360300     ELSE                                                         36030024
360400         SET DP013-CICS-ABEND            TO TRUE                  36040024
360500         SET DP013-NO-ROLLBACK           TO TRUE                  36050024
360600         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       36060024
360700         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     36070024
360800                                         TO DP013-MESSAGE-TEXT(1) 36080024
360900         PERFORM DP013-0000-PROCESS-ABEND                         36090024
361000     END-IF.                                                      36100024
361100                                                                  36110024
361200******************************************************************36120024
361300** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **36130024
361400** SPECIFIC COMMAREA.                                           **36140024
361500******************************************************************36150024
361600 5110-WRITE-ASC-LISTQ.                                            36160024
361700     EXEC CICS                                                    36170024
361800         WRITEQ TS                                                36180024
361900             QUEUE (ASC-LIST-QUEUE-NAME)                          36190024
362000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               36200024
362100             ITEM  (PV-BLOCK-NUMBER)                              36210024
362200             RESP  (PV-CICS-RESP)                                 36220024
362300     END-EXEC.                                                    36230024
362400     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      36240024
362500         SET DP013-CICS-ABEND      TO TRUE                        36250024
362600         SET DP013-NO-ROLLBACK     TO TRUE                        36260024
362700         MOVE '5110-WRITE-ASC-LISTQ'                              36270024
362800                                   TO DP013-PARAGRAPH             36280024
362900         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           36290024
363000                                   TO DP013-MESSAGE-TEXT(1)       36300024
363100         PERFORM DP013-0000-PROCESS-ABEND                         36310024
363200     END-IF.                                                      36320024
363300 EJECT                                                            36330024
363400*----------------------------------------------------------------*36340024
363500* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *36350024
363600* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *36360024
363700*----------------------------------------------------------------*36370024
363800                                                                  36380024
363900 5200-FILL-SEL-QUEUE-RECORD.                                      36390024
364000                                                                  36400024
364100     PERFORM 6112-READ-LIST-QUEUE.                                36410024
364200                                                                  36420024
364300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       36430024
364400         PERFORM                                                  36440024
364500         VARYING LQW-IDX                                          36450024
364600         FROM 1 BY 1                                              36460024
364700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            36470024
364800           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          36480024
364900                                                                  36490024
365000             IF  LQW-SELECT (LQW-IDX)                             36500024
365100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              36510024
365200                                   TO CE003-ITEM (CE003-IDX)      36520024
365300                 MOVE SPACE        TO CE003-ACTION-SW (CE003-IDX) 36530024
365400                                                                  36540024
365500                 MOVE ASC-PULL-NBR TO  CE003-PULL-NUMBER          36550024
365600                                        (CE003-IDX)               36560024
365700                 MOVE ASC-REF-NBR  TO  CE003-REF-NUMBER           36570024
365800                                        (CE003-IDX)               36580024
365900                 MOVE ASC-CS-LOC   TO  CE003-CS-LOCATION          36590024
366000                                        (CE003-IDX)               36600024
366100                 MOVE ZEROES       TO  CE003-CREATE-DATE          36610024
366200                                        (CE003-IDX)               36620024
366300                 MOVE ASC-PULL-STATUS                             36630024
366400                                   TO  CE003-PULL-STATUS-CDE      36640024
366500                                        (CE003-IDX)               36650024
366600                 MOVE ZEROES       TO  CE003-NBR-ITEMS            36660024
366700                                        (CE003-IDX)               36670024
366800                 MOVE ZEROES       TO  CE003-NBR-STORES           36680024
366900                                        (CE003-IDX)               36690024
367000                 MOVE ZEROES       TO  CE003-REQ-PULL-UNITS       36700024
367100                                        (CE003-IDX)               36710024
367200                 MOVE ZEROES       TO  CE003-ACT-PULL-UNITS       36720024
367300                                        (CE003-IDX)               36730024
367400                 MOVE ZEROES       TO  CE003-DIST-PULL-UNITS      36740024
367500                                        (CE003-IDX)               36750024
367600                 MOVE ZEROES       TO  CE003-LINE-STATUS-CDE      36760024
367700                                        (CE003-IDX)               36770024
367800                 MOVE LQW-SKU (LQW-IDX)                           36780024
367900                                   TO  CE003-LINE-SKU             36790024
368000                                        (CE003-IDX)               36800024
368100                 MOVE LQW-SKU-RETAIL (LQW-IDX)                    36810024
368200                                   TO  CE003-LINE-SKU-RETAIL      36820024
368300                                        (CE003-IDX)               36830024
368400                 MOVE LQW-LINE-ITEM (LQW-IDX)                     36840024
368500                                   TO  CE003-LINE-ITEM            36850024
368600                                        (CE003-IDX)               36860024
368700                 MOVE LQW-LINE-NBR (LQW-IDX)                      36870024
368800                                   TO  CE003-LINE-NUMBER          36880024
368900                                        (CE003-IDX)               36890024
369000                                                                  36900024
369100                 SET CE003-IDX UP BY 1                            36910024
369200                 IF  CE003-IDX > CE003-MAX-ITEMS                  36920024
369300                     PERFORM 5205-WRITE-SEL-QUEUE                 36930024
369400                     ADD +1        TO CE002-NUMBER-OF-TS-ITEMS    36940024
369500                     INITIALIZE CE003-SELECTED-ITEM-ARRAY         36950024
369600                     SET CE003-IDX TO  1                          36960024
369700                 END-IF                                           36970024
369800             END-IF                                               36980024
369900         END-PERFORM                                              36990024
370000     END-IF.                                                      37000024
370100                                                                  37010024
370200                                                                  37020024
370300*----------------------------------------------------------------*37030024
370400*                                                                *37040024
370500*----------------------------------------------------------------*37050024
370600 5200-FILL-SEL-QUEUE-RECORD-1.                                    37060024
370700                                                                  37070024
370800     MOVE 1                 TO  CE003-ITEM (CE003-IDX)            37080024
370900     MOVE ASC-PULL-NBR-N    TO  CE003-PULL-NUMBER (CE003-IDX)     37090024
371000     MOVE ASC-REF-NBR       TO  CE003-REF-NUMBER (CE003-IDX)      37100024
371100     MOVE ZEROES            TO  CE003-LINE-NUMBER (CE003-IDX)     37110024
371200     MOVE ASC-CS-LOC-N      TO  CE003-CS-LOCATION (CE003-IDX)     37120024
371300     MOVE ZEROES            TO  CE003-CREATE-DATE (CE003-IDX)     37130024
371400     MOVE ASC-PULL-STATUS   TO  CE003-PULL-STATUS-CDE (CE003-IDX) 37140024
371500     MOVE ASC-PULL-TYPE     TO  CE003-PULL-SOURCE-CDE (CE003-IDX) 37150024
371600     MOVE ZEROES            TO  CE003-NBR-ITEMS (CE003-IDX)       37160024
371700                                CE003-NBR-STORES (CE003-IDX)      37170024
371800                                CE003-REQ-PULL-UNITS (CE003-IDX)  37180024
371900                                CE003-DIST-PULL-UNITS (CE003-IDX) 37190024
372000     MOVE SPACES            TO  CE003-LINE-STATUS-CDE (CE003-IDX) 37200024
372100     MOVE ZEROES            TO  CE003-LINE-SKU (CE003-IDX)        37210024
372200     MOVE ZEROES            TO  CE003-LINE-SKU-RETAIL (CE003-IDX).37220024
372300                                                                  37230024
372400                                                                  37240024
372500*----------------------------------------------------------------*37250024
372600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *37260024
372700*----------------------------------------------------------------*37270024
372800                                                                  37280024
372900 5205-WRITE-SEL-QUEUE.                                            37290024
373000                                                                  37300024
373100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            37310024
373200                                   TO CE003-SELECTED-ITEMS.       37320024
373300                                                                  37330024
373400     EXEC CICS                                                    37340024
373500          WRITEQ TS                                               37350024
373600              QUEUE (ASC-SEL-QUEUE-NAME)                          37360024
373700              FROM  (CE003-SELECT-RECORD)                         37370024
373800              ITEM  (PV-SEL-QUEUE-ITEM)                           37380024
373900              RESP  (PV-CICS-RESP)                                37390024
374000     END-EXEC.                                                    37400024
374100                                                                  37410024
374200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37420024
374300         CONTINUE                                                 37430024
374400     ELSE                                                         37440024
374500         SET DP013-CICS-ABEND      TO TRUE                        37450024
374600         SET DP013-NO-ROLLBACK     TO TRUE                        37460024
374700         MOVE '5205-WRITE-SEL-QUEUE'                              37470024
374800                                   TO DP013-PARAGRAPH             37480024
374900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          37490024
375000                                   TO DP013-MESSAGE-TEXT(1)       37500024
375100         PERFORM DP013-0000-PROCESS-ABEND                         37510024
375200     END-IF.                                                      37520024
375300 EJECT                                                            37530024
375400******************************************************************37540024
375500** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **37550024
375600** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **37560024
375700** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **37570024
375800** THE USER.                                                    **37580024
375900******************************************************************37590024
376000 6000-REFRESH-PANEL-FROM-TEMP.                                    37600024
376100     IF  ASC-UPDATE-TSQ                                           37610024
376200         SET ASC-NO-TSQ-UPDATE TO TRUE                            37620024
376300         MOVE ZERO                 TO PV-SAVE-ITEM                37630024
376400                                      PV-SEL-QUEUE-ITEM           37640024
376500         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        37650024
376600                                   TO PV-HOLD-SELECTED-ITEMS      37660024
376700         MOVE +1                   TO PV-ITEMS-PROCESSED          37670024
376800         PERFORM 6100-UPDATE-TSQ                                  37680024
376900             UNTIL PV-ITEMS-PROCESSED >                           37690024
377000                                     PV-HOLD-SELECTED-ITEMS       37700024
377100         INITIALIZE ASC-BLOCK-ENTRIES (1)                         37710024
377200     END-IF.                                                      37720024
377300                                                                  37730024
377400*----------------------------------------------------------------*37740024
377500*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *37750024
377600*----------------------------------------------------------------*37760024
377700 6010-DELETE-SEL-QUEUE.                                           37770024
377800                                                                  37780024
377900     EXEC CICS                                                    37790024
378000         DELETEQ TS                                               37800024
378100             QUEUE (ASC-SEL-QUEUE-NAME)                           37810024
378200             RESP  (PV-CICS-RESP)                                 37820024
378300     END-EXEC.                                                    37830024
378400*                                                                 37840024
378500     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      37850024
378600        (PV-CICS-RESP = DFHRESP(QIDERR)))                         37860024
378700         CONTINUE                                                 37870024
378800     ELSE                                                         37880024
378900         SET DP013-CICS-ABEND TO TRUE                             37890024
379000         SET DP013-NO-ROLLBACK TO TRUE                            37900024
379100         MOVE '6010-DELETE-SEL-QUEUE'                             37910024
379200                        TO DP013-PARAGRAPH                        37920024
379300         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         37930024
379400                        TO DP013-MESSAGE-TEXT (1)                 37940024
379500         PERFORM DP013-0000-PROCESS-ABEND                         37950024
379600     END-IF.                                                      37960024
379700                                                                  37970024
379800*----------------------------------------------------------------*37980024
379900*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *37990024
380000*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *38000024
380100*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *38010024
380200*    THE TEMP QUEUE.                                             *38020024
380300*----------------------------------------------------------------*38030024
380400                                                                  38040024
380500 6100-UPDATE-TSQ.                                                 38050024
380600                                                                  38060024
380700     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             38070024
380800     PERFORM 6105-READ-SEL-QUEUE.                                 38080024
380900     PERFORM                                                      38090024
381000         VARYING CE003-IDX                                        38100024
381100         FROM 1 BY 1                                              38110024
381200         UNTIL ((PV-ITEMS-PROCESSED >                             38120024
381300                              PV-HOLD-SELECTED-ITEMS)             38130024
381400         OR (CE003-IDX GREATER THAN CE003-MAX-ITEMS))             38140024
381500         IF  CE003-ACTION-SW (CE003-IDX) > SPACE                  38150024
381600             PERFORM 6110-PROCESS-ITEMS                           38160024
381700         END-IF                                                   38170024
381800         ADD +1                TO PV-ITEMS-PROCESSED              38180024
381900     END-PERFORM.                                                 38190024
382000     PERFORM 6111-WRITE-LIST-QUEUE.                               38200024
382100*----------------------------------------------------------------*38210024
382200*    READ THE LIST QUEUE RECORD.                                 *38220024
382300*----------------------------------------------------------------*38230024
382400                                                                  38240024
382500 6105-READ-SEL-QUEUE.                                             38250024
382600                                                                  38260024
382700     EXEC CICS                                                    38270024
382800          READQ TS                                                38280024
382900              QUEUE (ASC-SEL-QUEUE-NAME)                          38290024
383000              INTO  (CE003-SELECT-RECORD)                         38300024
383100              ITEM  (PV-SEL-QUEUE-ITEM)                           38310024
383200              RESP  (PV-CICS-RESP)                                38320024
383300     END-EXEC.                                                    38330024
383400*                                                                 38340024
383500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38350024
383600         CONTINUE                                                 38360024
383700     ELSE                                                         38370024
383800         SET DP013-CICS-ABEND      TO  TRUE                       38380024
383900         SET DP013-NO-ROLLBACK     TO  TRUE                       38390024
384000         MOVE '6105-READ-SEL-QUEUE'                               38400024
384100                                   TO  DP013-PARAGRAPH            38410024
384200         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           38420024
384300                                   TO  DP013-MESSAGE-TEXT(1)      38430024
384400         PERFORM DP013-0000-PROCESS-ABEND                         38440024
384500     END-IF.                                                      38450024
384600 EJECT                                                            38460024
384700*----------------------------------------------------------------*38470024
384800*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*38480024
384900*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*38490024
385000*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *38500024
385100*----------------------------------------------------------------*38510024
385200                                                                  38520024
385300 6110-PROCESS-ITEMS.                                              38530024
385400                                                                  38540024
385500     COMPUTE PV-ITEM = 1 + ((CE003-ITEM (CE003-IDX) - 1)          38550024
385600                     / PC-ITEMS-PER-PANEL).                       38560024
385700                                                                  38570024
385800     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           38580024
385900         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          38590024
386000             PERFORM 6111-WRITE-LIST-QUEUE                        38600024
386100         END-IF                                                   38610024
386200         MOVE PV-ITEM          TO PV-SAVE-ITEM                    38620024
386300                                                                  38630024
386400         PERFORM 6112-READ-LIST-QUEUE                             38640024
386500         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               38650024
386600             CONTINUE                                             38660024
386700         END-IF                                                   38670024
386800     END-IF.                                                      38680024
386900                                                                  38690024
387000     COMPUTE PV-SUB = (CE003-ITEM (CE003-IDX)                     38700024
387100                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              38710024
387200                                                                  38720024
387300     IF  CE003-ACTION-SW(CE003-IDX) > SPACE                       38730024
387400         MOVE  SPACE  TO  LQW-TEMP-SELECTED-SW (PV-SUB)           38740024
387500                          LQW-SELECTED-SW (PV-SUB)                38750024
387600     END-IF                                                       38760024
387700     EVALUATE TRUE                                                38770024
387800         WHEN CE003-INQ (CE003-IDX)                               38780024
387900              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             38790024
388000                                                                  38800024
388100         WHEN CE003-UPD (CE003-IDX)                               38810024
388200              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             38820024
388300                                                                  38830024
388400         WHEN CE003-DEL (CE003-IDX)                               38840024
388500              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             38850024
388600                                                                  38860024
388700         WHEN CE003-ERR (CE003-IDX)                               38870024
388800              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             38880024
388900     END-EVALUATE.                                                38890024
389000                                                                  38900024
389100     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                38910024
389200                                                                  38920024
389300*----------------------------------------------------------------*38930024
389400*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *38940024
389500*----------------------------------------------------------------*38950024
389600                                                                  38960024
389700 6111-WRITE-LIST-QUEUE.                                           38970024
389800                                                                  38980024
389900     EXEC CICS                                                    38990024
390000         WRITEQ TS                                                39000024
390100             QUEUE (ASC-LIST-QUEUE-NAME)                          39010024
390200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     39020024
390300             ITEM  (PV-SAVE-ITEM)                                 39030024
390400             REWRITE                                              39040024
390500             RESP  (PV-CICS-RESP)                                 39050024
390600     END-EXEC.                                                    39060024
390700*                                                                 39070024
390800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39080024
390900         CONTINUE                                                 39090024
391000     ELSE                                                         39100024
391100         SET DP013-CICS-ABEND  TO  TRUE                           39110024
391200         SET DP013-NO-ROLLBACK TO  TRUE                           39120024
391300         MOVE '6111-WRITE-LIST-QUEUE'                             39130024
391400                               TO  DP013-PARAGRAPH                39140024
391500         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  39150024
391600                               TO  DP013-MESSAGE-TEXT(1)          39160024
391700         PERFORM DP013-0000-PROCESS-ABEND                         39170024
391800     END-IF.                                                      39180024
391900                                                                  39190024
392000 EJECT                                                            39200024
392100*----------------------------------------------------------------*39210024
392200*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*39220024
392300*----------------------------------------------------------------*39230024
392400                                                                  39240024
392500 6112-READ-LIST-QUEUE.                                            39250024
392600                                                                  39260024
392700     EXEC CICS                                                    39270024
392800         READQ TS                                                 39280024
392900             QUEUE (ASC-LIST-QUEUE-NAME)                          39290024
393000             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     39300024
393100             ITEM  (PV-ITEM)                                      39310024
393200             RESP  (PV-CICS-RESP)                                 39320024
393300     END-EXEC.                                                    39330024
393400*                                                                 39340024
393500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39350024
393600         CONTINUE                                                 39360024
393700     ELSE                                                         39370024
393800         SET DP013-CICS-ABEND        TO TRUE                      39380024
393900         SET DP013-NO-ROLLBACK       TO TRUE                      39390024
394000         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           39400024
394100         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    39410024
394200                                     TO DP013-MESSAGE-TEXT(1)     39420024
394300         PERFORM DP013-0000-PROCESS-ABEND                         39430024
394400     END-IF.                                                      39440024
394500                                                                  39450024
394600 7000-PROCESS-MQ-CHECK.                                           39460085
394700     MOVE ASC-CS-LOC-N           TO KRPRPM-LOC-ID                 39470085
394800                                                                  39480085
394900     EXEC SQL                                                     39490085
395000        SELECT FUNC_TXT                                           39500085
395100          INTO :KRPRPM-FUNC-TXT                                   39510085
395200          FROM TKRPRPM                                            39520085
395300         WHERE   LOC_ID            = :KRPRPM-LOC-ID               39530085
395400           AND   INTFC_SYS_CDE     = 'KHL'                        39540085
395500           AND   SYS_PRC_FUNC_CDE  = 'CEPLMQ'                     39550085
395600           AND   FUNC_PRC_STAT_CDE = 'AC'                         39560085
395700           AND (CURRENT DATE                                      39570085
395800       BETWEEN DATE(FUNC_BEG_TMST) AND                            39580085
395900               DATE(FUNC_END_TMST) )                              39590085
396000     END-EXEC.                                                    39600085
396100                                                                  39610085
396200     EVALUATE SQLCODE                                             39620085
396300         WHEN ZERO                                                39630085
396400             MOVE KRPRPM-FUNC-TXT TO PS-PROCESS-MQ-SW             39640085
396500         WHEN +100                                                39650085
396600             SET PS-PROCESS-MQ-NO TO TRUE                         39660085
396700         WHEN OTHER                                               39670085
396800              MOVE '7000-PROCESS-MQ-CHECK'                        39680085
396900                               TO DP013-PARAGRAPH                 39690085
397000              MOVE 'SELECT MQ PROCESS PARM'                       39700085
397100                               TO DP013-MESSAGE-TEXT (1)          39710085
397200              MOVE SQLCA       TO DP013-SQLCA                     39720085
397300              SET DP013-DB2-ABEND                                 39730085
397400                               TO TRUE                            39740085
397500              PERFORM DP013-0000-PROCESS-ABEND                    39750085
397600     END-EVALUATE.                                                39760085
397601                                                                  39760185
417410 7010-GET-MAX-LINES.                                              39760289
417413                                                                  39760389
417414     EXEC SQL                                                     39760489
417415        SELECT FUNC_QTY                                           39760589
417416          INTO :PV-MAX-PULL-LINES                                 39760689
417417          FROM TKRPRPM                                            39760789
417419         WHERE   INTFC_SYS_CDE     = 'RDM'                        39760889
417420           AND   SYS_PRC_FUNC_CDE  = 'MXPLLN'                     39760989
417421           AND   FUNC_PRC_STAT_CDE = 'AC'                         39761089
417425     END-EXEC.                                                    39761189
417426                                                                  39761289
417427     EVALUATE SQLCODE                                             39761389
417428         WHEN ZERO                                                39761489
417429             CONTINUE                                             39761589
417432         WHEN OTHER                                               39761689
417433              MOVE '7010-GET-MAX-LINES'                           39761789
417434                               TO DP013-PARAGRAPH                 39761889
417435              MOVE 'SELECT MAX PULL LINES'                        39761989
417436                               TO DP013-MESSAGE-TEXT (1)          39762089
417437              MOVE SQLCA       TO DP013-SQLCA                     39762189
417438              SET DP013-DB2-ABEND                                 39762289
417439                               TO TRUE                            39762389
417440              PERFORM DP013-0000-PROCESS-ABEND                    39762489
417448     END-EVALUATE.                                                39762589
417450                                                                  39762689
397602                                                                  39762724
397603 8000-MQ-SETUP.                                                   39762824
397604                                                                  39762924
397605* DETERMINE THE SYSTEM                                            39763024
397606                                                                  39763124
397607     PERFORM EP000-0000-INITIALIZE.                               39763224
397608     IF EP000-PV-KOHLS-PROD-SYSTEM                                39763324
397609         SET PC-PROD-QMGR-NAME     TO TRUE                        39763424
397610     ELSE                                                         39763524
397611          IF EP000-PV-KOHLS-QA-SYSTEM                             39763624
397612              SET PC-QA-QMGR-NAME  TO TRUE                        39763724
397613          ELSE                                                    39763824
397614              SET PC-TEST-QMGR-NAME                               39763924
397615                                   TO TRUE                        39764024
397616          END-IF                                                  39764124
397617     END-IF.                                                      39764224
397618                                                                  39764324
397619* CONNECT TO THE QUEUE                                            39764424
397620                                                                  39764524
397621     SET PS-NO-MQ-ERROR            TO TRUE.                       39764624
397622     MOVE PC-QMGR-NAME             TO PV-QM-NAME.                 39764724
397623     CALL PC-MQCONN USING PV-QM-NAME                              39764824
397624                          PV-HCONN                                39764924
397625                          PV-COMPLETION-CODE                      39765024
397626                          PV-REASON.                              39765124
397627                                                                  39765224
397628*    IF CONNECTION FAILED THEN DISPLAY ERROR MESSAGE              39765324
397629*    AND EXIT                                                     39765424
397630                                                                  39765524
397631     MOVE PV-REASON TO PV-CON-REASON.                             39765624
397632     IF (PV-COMPLETION-CODE = MQCC-OK)                            39766024
397700         CONTINUE                                                 39770024
397800     ELSE                                                         39780024
397900         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       39790037
398000         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           39800037
398100         MOVE PV-QM-NAME           TO PE-MQ-QMANAGER              39810024
398200         SET  PE-MQ-CONNECT        TO TRUE                        39820024
398300         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       39830024
398400         MOVE PV-REASON            TO PE-MQ-REASON-CODE           39840024
398500         PERFORM 9900-MQ-ERROR                                    39850024
398600         SET PS-MQ-ERROR           TO TRUE                        39860024
398700         MOVE PC-TSYMSG-02677      TO DP020-MSG-NUMBER            39870044
398800     END-IF.                                                      39880024
398900     IF PS-NO-MQ-ERROR                                            39890024
399000         SET PS-MQ-SETUP-COMPLETE TO TRUE                         39900024
399100     END-IF.                                                      39910024
399200                                                                  39920024
399300                                                                  39930024
399400*----------------------------------------------------------------*39940025
399500*  PUT THE MQ MESSAGE ONTO THE QUEUE                              39950025
399600*----------------------------------------------------------------*39960025
399700                                                                  39970025
399800 8010-MQ-PUT1.                                                    39980025
399900                                                                  39990025
400000     PERFORM 8070-GET-QUEUE-NAME.                                 40000025
400100     MOVE PV-OBJECTNAME            TO MQOD-OBJECTNAME.            40010025
400200     PERFORM 8090-GET-QMGR-NAME.                                  40020025
400300     MOVE PV-OBJECTQMGRNAME        TO MQOD-OBJECTQMGRNAME.        40030025
400400     COMPUTE MQPMO-OPTIONS         = MQPMO-FAIL-IF-QUIESCING      40040025
400500                                   + MQPMO-SYNCPOINT.             40050025
400600     MOVE MQFMT-STRING             TO MQMD-FORMAT.                40060025
400700     MOVE LENGTH OF CE016-INV-TRANS-RECORD                        40070025
400800                                   TO PV-MSGLENGTH.               40080025
400900                                                                  40090025
401000                                                                  40100025
401100     CALL PC-MQPUT1 USING PV-HCONN                                40110025
401200                          MQM-OBJECT-DESCRIPTOR                   40120025
401300                          MQM-MESSAGE-DESCRIPTOR                  40130025
401400                          MQM-PUT-MESSAGE-OPTIONS                 40140025
401500                          PV-MSGLENGTH                            40150025
401600                          CE016-INV-TRANS-RECORD                  40160025
401700                          PV-COMPLETION-CODE                      40170025
401800                          PV-REASON.                              40180025
401900                                                                  40190025
402000     IF (PV-COMPLETION-CODE = MQCC-OK)                            40200025
402100         CONTINUE                                                 40210025
402200     ELSE                                                         40220025
402300         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       40230037
402400         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           40240037
402500         MOVE PV-OBJECTQMGRNAME    TO PE-MQ-QMANAGER              40250025
402600         SET  PE-MQ-PUT1           TO TRUE                        40260025
402700         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       40270025
402800         MOVE PV-REASON            TO PE-MQ-REASON-CODE           40280025
402900         MOVE PV-REASON            TO  PV-REASON-CODE             40290044
403000         MOVE PV-MQ-REASON-TEXT    TO  PV-MQ-REASON-TXT           40300044
403100         PERFORM 9900-MQ-ERROR                                    40310044
403200         PERFORM 8060-MQ-DISCONNECT                               40320044
403300         SET PS-MQ-ERROR           TO TRUE                        40330044
403400         MOVE '8010-MQ-PUT1'       TO  PV-MQ-PARAGRAPH            40340044
403500         MOVE PV-MQ-SOFT-ABORT-MSG      TO PV-CICS-MSG-AREA2      40350044
403600         MOVE LENGTH OF PV-CICS-MSG-AREA2                         40360044
403700              TO PV-COMMAREA-LENGTH                               40370044
403800         EXEC CICS                                                40380044
403900              WRITEQ TD                                           40390044
404000               QUEUE  ('CSSL')                                    40400044
404100                FROM  (PV-CICS-MSG-AREA2)                         40410044
404200              LENGTH  (PV-COMMAREA-LENGTH)                        40420044
404300                RESP  (PV-CICS-RESP)                              40430044
404400         END-EXEC                                                 40440044
404500         MOVE  PC-TSYMSG-02677  TO  DP020-MSG-NUMBER              40450044
404600         SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE                  40460044
404700         PERFORM 9900-SOFT-ABORT                                  40470044
404800     END-IF.                                                      40480025
404900                                                                  40490025
405000     IF PS-NO-MQ-ERROR                                            40500025
405100         PERFORM 8020-CICS-MQ-COMMIT                              40510025
405200     ELSE                                                         40520025
405300         PERFORM 8060-MQ-DISCONNECT                               40530025
405400     END-IF.                                                      40540025
405500*--------------------------------------------------------------*  40550024
405600*  COMMIT THE MQ PUT BY USING A CICS SYNCPOINT COMMAND.           40560024
405700*  (MQ COMMIT DOES NOT WORK IN CICS, THE SYNCPOINT MUST BE     *  40570024
405800*  USED)                                                          40580024
405900*--------------------------------------------------------------*  40590024
406000 8020-CICS-MQ-COMMIT.                                             40600025
406100                                                                  40610024
406200     EXEC CICS                                                    40620024
406300         SYNCPOINT                                                40630024
406400     END-EXEC.                                                    40640024
406500                                                                  40650024
406600     PERFORM 8030-MQ-GET-OPEN.                                    40660025
406700                                                                  40670024
406800*----------------------------------------------------------------*40680024
406900*  OPEN THE MESSAGE QUEUE THAT WILL GET THE RESPONSE MESSAGE     *40690024
407000*----------------------------------------------------------------*40700024
407100                                                                  40710024
407200 8030-MQ-GET-OPEN.                                                40720024
407300                                                                  40730024
407400     PERFORM 8080-GET-QUEUE-NAME.                                 40740025
407500     MOVE PV-OBJECTNAME            TO MQOD-OBJECTNAME.            40750043
407600     COMPUTE PV-OPEN-OPTIONS       = MQOO-INPUT-SHARED            40760024
407700                                   + MQOO-FAIL-IF-QUIESCING.      40770024
407800     MOVE PC-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        40780024
407900                                                                  40790024
408000     CALL PC-MQOPEN USING PV-HCONN                                40800024
408100                          MQM-OBJECT-DESCRIPTOR                   40810024
408200                          PV-OPEN-OPTIONS                         40820024
408300                          PV-GQ-HANDLE                            40830024
408400                          PV-COMPLETION-CODE                      40840024
408500                          PV-REASON.                              40850024
408600                                                                  40860024
408700     IF (PV-COMPLETION-CODE = MQCC-OK)                            40870024
408800         CONTINUE                                                 40880024
408900     ELSE                                                         40890024
409000         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       40900037
409100         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           40910037
409200         MOVE PV-OBJECTQMGRNAME    TO PE-MQ-QMANAGER              40920024
409300         MOVE PV-OBJECTNAME        TO PE-MQ-QNAME                 40930024
409400         SET  PE-MQ-OPEN           TO TRUE                        40940024
409500         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       40950044
409600         MOVE PV-REASON            TO PE-MQ-REASON-CODE           40960044
409700         MOVE PV-REASON            TO  PV-REASON-CODE             40970044
409800         MOVE PV-MQ-REASON-TEXT    TO  PV-MQ-REASON-TXT           40980044
409900         PERFORM 9900-MQ-ERROR                                    40990044
410000         PERFORM 8060-MQ-DISCONNECT                               41000044
410100         SET PS-MQ-ERROR           TO TRUE                        41010044
410200         MOVE '8030-MQ-GET-OPEN'   TO  PV-MQ-PARAGRAPH            41020044
410300         MOVE PV-MQ-SOFT-ABORT-MSG      TO PV-CICS-MSG-AREA2      41030044
410400         MOVE LENGTH OF PV-CICS-MSG-AREA2                         41040044
410500              TO PV-COMMAREA-LENGTH                               41050044
410600         EXEC CICS                                                41060044
410700              WRITEQ TD                                           41070044
410800               QUEUE  ('CSSL')                                    41080044
410900                FROM  (PV-CICS-MSG-AREA2)                         41090044
411000              LENGTH  (PV-COMMAREA-LENGTH)                        41100044
411100                RESP  (PV-CICS-RESP)                              41110044
411200         END-EXEC                                                 41120044
411300         MOVE  PC-TSYMSG-02677  TO  DP020-MSG-NUMBER              41130044
411400         SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE                  41140044
411500         PERFORM 9900-SOFT-ABORT                                  41150044
411600     END-IF.                                                      41160024
411700     IF PS-NO-MQ-ERROR                                            41170024
411800         PERFORM 8040-MQ-GET                                      41180024
411900     ELSE                                                         41190024
412000         PERFORM 8060-MQ-DISCONNECT                               41200025
412100     END-IF.                                                      41210024
412200                                                                  41220024
412300                                                                  41230024
412400*----------------------------------------------------------------*41240024
412500*  WAIT FOR THE MESSAGE TO COME BACK FROM THE LOADER PROGRAM     *41250024
412600*  INDICATING THAT THE DATABSE LOAD WAS SUCCESSFUL                41260024
412700*----------------------------------------------------------------*41270024
412800                                                                  41280024
412900 8040-MQ-GET.                                                     41290024
413000                                                                  41300024
413100     MOVE 60000                    TO MQGMO-WAITINTERVAL.         41310024
413200     MOVE MQMD-MSGID               TO MQMD-CORRELID.              41320024
413300     MOVE MQMI-NONE                TO MQMD-MSGID.                 41330024
413400     COMPUTE MQGMO-OPTIONS         = MQGMO-WAIT                   41340024
413500                                   + MQGMO-FAIL-IF-QUIESCING      41350027
413600                                   + MQGMO-CONVERT.               41360027
413700     MOVE PC-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        41370024
413800                                                                  41380024
413900                                                                  41390024
414000     CALL PC-MQGET USING PV-HCONN                                 41400024
414100                         PV-GQ-HANDLE                             41410024
414200                         MQM-MESSAGE-DESCRIPTOR                   41420024
414300                         MQM-GET-MESSAGE-OPTIONS                  41430024
414400                         PV-MSGLENGTH                             41440024
414500                         CE016-INV-TRANS-RECORD                   41450024
414600                         PV-DATA-LENGTH                           41460024
414700                         PV-COMPLETION-CODE                       41470024
414800                         PV-REASON.                               41480024
414900                                                                  41490024
415000     IF (PV-COMPLETION-CODE = MQCC-OK)                            41500024
415100         CONTINUE                                                 41510024
415200     ELSE                                                         41520024
415300         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       41530037
415400         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           41540037
415500         MOVE PV-OBJECTQMGRNAME    TO PE-MQ-QMANAGER              41550024
415600         MOVE PV-OBJECTNAME        TO PE-MQ-QNAME                 41560024
415700         SET  PE-MQ-GET            TO TRUE                        41570024
415800         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       41580044
415900         MOVE PV-REASON            TO PE-MQ-REASON-CODE           41590044
416000         MOVE PV-REASON            TO  PV-REASON-CODE             41600044
416100         MOVE PV-MQ-REASON-TEXT    TO  PV-MQ-REASON-TXT           41610044
416200         PERFORM 9900-MQ-ERROR                                    41620044
416300         PERFORM 8060-MQ-DISCONNECT                               41630044
416400         SET PS-MQ-ERROR           TO TRUE                        41640044
416500         MOVE '8040-MQ-GET'        TO  PV-MQ-PARAGRAPH            41650044
416600         MOVE PV-MQ-SOFT-ABORT-MSG      TO PV-CICS-MSG-AREA2      41660044
416700         MOVE LENGTH OF PV-CICS-MSG-AREA2                         41670044
416800              TO PV-COMMAREA-LENGTH                               41680044
416900         EXEC CICS                                                41690044
417000              WRITEQ TD                                           41700044
417100               QUEUE  ('CSSL')                                    41710044
417200                FROM  (PV-CICS-MSG-AREA2)                         41720044
417300              LENGTH  (PV-COMMAREA-LENGTH)                        41730044
417400                RESP  (PV-CICS-RESP)                              41740044
417500         END-EXEC                                                 41750044
417600         MOVE  PC-TSYMSG-02677  TO  DP020-MSG-NUMBER              41760044
417700         SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE                  41770044
417800         PERFORM 9900-SOFT-ABORT                                  41780044
417900     END-IF.                                                      41790024
418000     IF CE016-TRANS-NOT-SUCCESSFUL                                41800032
418100         IF CE016-TRANS-SOURCE-DESC = PV-INSUFFIFIENT-QTY         41810032
418200             SET PS-REDUCE-QTY TO TRUE                            41820032
418300         ELSE                                                     41830032
418400             IF CE016-TRANS-SOURCE-DESC = PV-SKU-NOT-FOUND        41840032
418500                 SET PS-SKU-NOT-FOUND TO TRUE                     41850032
418600             ELSE                                                 41860032
418700                 SET PS-SKU-NOT-PROCESSED TO TRUE                 41870032
418800             END-IF                                               41880032
418900         END-IF                                                   41890032
419000     END-IF.                                                      41900032
419100     PERFORM 8050-MQ-GET-CLOSE.                                   41910024
419200                                                                  41920024
419300*----------------------------------------------------------------*41930024
419400*  CLOSE THE QUEUE THAT WAS OPENED TO GET THE RESPONSE MESSAGE   *41940024
419500*----------------------------------------------------------------*41950024
419600                                                                  41960024
419700 8050-MQ-GET-CLOSE.                                               41970024
419800                                                                  41980024
419900     CALL PC-MQCLOSE USING PV-HCONN                               41990024
420000                           PV-GQ-HANDLE                           42000024
420100                           MQCO-NONE                              42010024
420200                           PV-COMPLETION-CODE                     42020024
420300                           PV-REASON.                             42030024
420400                                                                  42040024
420500     IF (PV-COMPLETION-CODE = MQCC-OK)                            42050024
420600         CONTINUE                                                 42060024
420700     ELSE                                                         42070024
420800         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       42080037
420900         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           42090037
421000         MOVE PV-OBJECTQMGRNAME    TO PE-MQ-QMANAGER              42100024
421100         MOVE PV-OBJECTNAME        TO PE-MQ-QNAME                 42110024
421200         SET  PE-MQ-CLOSE          TO TRUE                        42120024
421300         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       42130044
421400         MOVE PV-REASON            TO PE-MQ-REASON-CODE           42140044
421500         MOVE PV-REASON            TO  PV-REASON-CODE             42150044
421600         MOVE PV-MQ-REASON-TEXT    TO  PV-MQ-REASON-TXT           42160044
421700         PERFORM 9900-MQ-ERROR                                    42170044
421800         PERFORM 8060-MQ-DISCONNECT                               42180044
421900         SET PS-MQ-ERROR           TO TRUE                        42190044
422000         MOVE '8050-MQ-GET-CLOSE'  TO  PV-MQ-PARAGRAPH            42200044
422100         MOVE PV-MQ-SOFT-ABORT-MSG      TO PV-CICS-MSG-AREA2      42210044
422200         MOVE LENGTH OF PV-CICS-MSG-AREA2                         42220044
422300              TO PV-COMMAREA-LENGTH                               42230044
422400         EXEC CICS                                                42240044
422500              WRITEQ TD                                           42250044
422600               QUEUE  ('CSSL')                                    42260044
422700                FROM  (PV-CICS-MSG-AREA2)                         42270044
422800              LENGTH  (PV-COMMAREA-LENGTH)                        42280044
422900                RESP  (PV-CICS-RESP)                              42290044
423000         END-EXEC                                                 42300044
423100         MOVE  PC-TSYMSG-02677  TO  DP020-MSG-NUMBER              42310044
423200         SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE                  42320044
423300         PERFORM 9900-SOFT-ABORT                                  42330044
423400     END-IF.                                                      42340024
423500                                                                  42350024
423600                                                                  42360024
423700*----------------------------------------------------------------*42370024
423800*  DISCONNECT FROM THE QUEUE                                      42380024
423900*----------------------------------------------------------------*42390024
424000                                                                  42400024
424100 8060-MQ-DISCONNECT.                                              42410025
424200                                                                  42420024
424300     IF PV-CON-REASON              NOT EQUAL                      42430024
424400                                   MQRC-ALREADY-CONNECTED         42440024
424500         CALL PC-MQDISC USING PV-HCONN                            42450024
424600                              PV-COMPLETION-CODE                  42460024
424700                              PV-REASON                           42470024
424800         IF (PV-COMPLETION-CODE = MQCC-OK)                        42480024
424900             SET PS-MQ-SETUP-NOT-COMPLETE TO TRUE                 42490024
425000         ELSE                                                     42500024
425100             CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT   42510037
425200             MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC       42520037
425300             MOVE PV-OBJECTQMGRNAME TO PE-MQ-QMANAGER             42530024
425400             SET  PE-MQ-DISCONNECT TO TRUE                        42540024
425500             MOVE PV-COMPLETION-CODE                              42550024
425600                                   TO PE-MQ-COMPLETION-CODE       42560024
425700             MOVE PV-REASON        TO PE-MQ-REASON-CODE           42570024
425800             PERFORM 9900-MQ-ERROR                                42580024
425900         END-IF                                                   42590024
426000     END-IF.                                                      42600024
426100                                                                  42610024
426200***************************************************************** 42620024
426300 8070-GET-QUEUE-NAME.                                             42630025
426400*     SELECT THE GET QUEUE NAME.                                  42640024
426500***************************************************************** 42650024
426600                                                                  42660024
426700     MOVE SPACES             TO PV-OBJECTNAME.                    42670024
426800     EXEC SQL                                                     42680024
426900         SELECT FUNC_TXT                                          42690024
427000           INTO :KRPRPM-FUNC-TXT                                  42700024
427100           FROM TKRPRPM B                                         42710024
427200          WHERE SYS_PRC_FUNC_CDE  = 'RDMGQU'                      42720024
427300            AND LOC_ID            = 090                           42730024
427400            AND INTFC_SYS_CDE     = 'RDM'                         42740024
427500            AND FUNC_PRC_STAT_CDE = 'AC'                          42750024
427600            AND (CURRENT DATE                                     42760024
427700        BETWEEN DATE(FUNC_BEG_TMST) AND                           42770024
427800                DATE(FUNC_END_TMST) )                             42780024
427900     END-EXEC.                                                    42790024
428000                                                                  42800024
428100     EVALUATE SQLCODE                                             42810024
428200         WHEN ZERO                                                42820024
428300             MOVE KRPRPM-FUNC-TXT     TO PV-OBJECTNAME            42830024
428400         WHEN OTHER                                               42840024
428500              MOVE '8070-GET-QUEUE-NAME'                          42850025
428600                               TO DP013-PARAGRAPH                 42860024
428700              MOVE 'SELECT QUEUE NAME'                            42870024
428800                               TO DP013-MESSAGE-TEXT (1)          42880024
428900              MOVE SQLCA       TO DP013-SQLCA                     42890024
429000              SET DP013-DB2-ABEND                                 42900024
429100                               TO TRUE                            42910024
429200              PERFORM DP013-0000-PROCESS-ABEND                    42920024
429300     END-EVALUATE.                                                42930024
429400                                                                  42940024
429500***************************************************************** 42950024
429600 8080-GET-QUEUE-NAME.                                             42960025
429700*     SELECT THE PUT QUEUE NAME.                                  42970024
429800***************************************************************** 42980024
429900                                                                  42990024
430000     MOVE SPACES             TO PV-OBJECTNAME.                    43000024
430100     EXEC SQL                                                     43010024
430200         SELECT FUNC_TXT                                          43020024
430300           INTO :KRPRPM-FUNC-TXT                                  43030024
430400           FROM TKRPRPM B                                         43040024
430500          WHERE SYS_PRC_FUNC_CDE  = 'RDMPQU'                      43050024
430600            AND LOC_ID            = 090                           43060024
430700            AND INTFC_SYS_CDE     = 'RDM'                         43070024
430800            AND FUNC_PRC_STAT_CDE = 'AC'                          43080024
430900            AND (CURRENT DATE                                     43090024
431000        BETWEEN DATE(FUNC_BEG_TMST) AND                           43100024
431100                DATE(FUNC_END_TMST) )                             43110024
431200     END-EXEC.                                                    43120024
431300                                                                  43130024
431400     EVALUATE SQLCODE                                             43140024
431500         WHEN ZERO                                                43150024
431600             MOVE KRPRPM-FUNC-TXT     TO PV-OBJECTNAME            43160024
431700         WHEN OTHER                                               43170024
431800              MOVE '8080-GET-QUEUE-NAME'                          43180025
431900                               TO DP013-PARAGRAPH                 43190024
432000              MOVE 'SELECT QUEUE NAME'                            43200024
432100                               TO DP013-MESSAGE-TEXT (1)          43210024
432200              MOVE SQLCA       TO DP013-SQLCA                     43220024
432300              SET DP013-DB2-ABEND                                 43230024
432400                               TO TRUE                            43240024
432500              PERFORM DP013-0000-PROCESS-ABEND                    43250024
432600     END-EVALUATE.                                                43260024
432700                                                                  43270024
432800***************************************************************** 43280024
432900 8090-GET-QMGR-NAME.                                              43290024
433000*     SELECT QUEUE NAME.                                          43300024
433100***************************************************************** 43310024
433200                                                                  43320024
433300     MOVE SPACES             TO PV-OBJECTQMGRNAME.                43330024
433400     EXEC SQL                                                     43340024
433500         SELECT FUNC_TXT                                          43350024
433600           INTO :KRPRPM-FUNC-TXT                                  43360024
433700           FROM TKRPRPM B                                         43370024
433800          WHERE SYS_PRC_FUNC_CDE  = 'RDMQMG'                      43380024
433900            AND LOC_ID            = 090                           43390024
434000            AND INTFC_SYS_CDE     = 'RDM'                         43400024
434100            AND FUNC_PRC_STAT_CDE = 'AC'                          43410024
434200            AND (CURRENT DATE                                     43420024
434300        BETWEEN DATE(FUNC_BEG_TMST) AND                           43430024
434400                DATE(FUNC_END_TMST) )                             43440024
434500     END-EXEC.                                                    43450024
434600                                                                  43460024
434700     EVALUATE SQLCODE                                             43470024
434800         WHEN ZERO                                                43480024
434900             MOVE KRPRPM-FUNC-TXT     TO PV-OBJECTQMGRNAME        43490024
435000         WHEN OTHER                                               43500024
435100              MOVE '8090-GET-QMGR-NAME'                           43510024
435200                               TO DP013-PARAGRAPH                 43520024
435300              MOVE 'SELECT QUEUE MANAGER NAME'                    43530024
435400                               TO DP013-MESSAGE-TEXT (1)          43540024
435500              MOVE SQLCA       TO DP013-SQLCA                     43550024
435600              SET DP013-DB2-ABEND                                 43560024
435700                               TO TRUE                            43570024
435800              PERFORM DP013-0000-PROCESS-ABEND                    43580024
435900     END-EVALUATE.                                                43590024
436000                                                                  43600024
436100                                                                  43610024
436200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 43620024
436300* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *43630024
436400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 43640024
436500 9100-READ-SEL-QUEUE.                                             43650024
436600     EXEC CICS                                                    43660024
436700         READQ TS                                                 43670024
436800             QUEUE (ASC-SEL-QUEUE-NAME)                           43680024
436900             INTO  (CE003-SELECT-RECORD)                          43690024
437000             ITEM  (ASC-SEL-ITEM)                                 43700024
437100             RESP  (PV-CICS-RESP)                                 43710024
437200     END-EXEC.                                                    43720024
437300     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        43730024
437400         CONTINUE                                                 43740024
437500     ELSE                                                         43750024
437600         SET DP013-LOGIC-ABEND                                    43760024
437700             DP013-NO-ROLLBACK   TO   TRUE                        43770024
437800         MOVE '9100-READ-SEL-QUEUE'                               43780024
437900                                 TO   DP013-PARAGRAPH             43790024
438000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   43800024
438100                                 TO   DP013-MESSAGE-TEXT (1)      43810024
438200         PERFORM DP013-0000-PROCESS-ABEND                         43820024
438300     END-IF.                                                      43830024
438400                                                                  43840024
438500                                                                  43850024
438600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*43860024
438700* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *43870024
438800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 43880024
438900 9200-REWRITE-SEL-QUEUE.                                          43890024
439000                                                                  43900024
439100     EXEC CICS                                                    43910024
439200          WRITEQ TS                                               43920024
439300              QUEUE  (ASC-SEL-QUEUE-NAME)                         43930024
439400              FROM   (CE003-SELECT-RECORD)                        43940024
439500              ITEM   (ASC-SEL-ITEM)                               43950024
439600              RESP   (PV-CICS-RESP)                               43960024
439700              REWRITE                                             43970024
439800     END-EXEC.                                                    43980024
439900                                                                  43990024
440000     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   44000024
440100         SET DP013-CICS-ABEND                                     44010024
440200             DP013-NO-ROLLBACK     TO TRUE                        44020024
440300         MOVE '9200-REWRITE-SEL-QUEUE'                            44030024
440400                                   TO DP013-PARAGRAPH             44040024
440500         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   44050024
440600                                   TO DP013-MESSAGE-TEXT (1)      44060024
440700         PERFORM DP013-0000-PROCESS-ABEND                         44070024
440800     END-IF.                                                      44080024
440900                                                                  44090024
441000                                                                  44100024
441100*----------------------------------------------------------------*44110024
441200*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *44120024
441300*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *44130024
441400*----------------------------------------------------------------*44140024
441500 9900-SOFT-ABORT.                                                 44150024
441600                                                                  44160024
441700     EXEC CICS SYNCPOINT                                          44170024
441800          ROLLBACK                                                44180024
441900     END-EXEC.                                                    44190024
442000                                                                  44200024
442100     SET  PS-ERROR                                                44210024
442200          PS-SOFT-ABORT-ERROR                                     44220024
442300          DP020-MSG-FATAL       TO  TRUE.                         44230024
442400                                                                  44240024
442500                                                                  44250025
442600*-----------------------------------------------------------------44260025
442700*  MQ ERROR                                                       44270025
442800*-----------------------------------------------------------------44280025
442900 9900-MQ-ERROR.                                                   44290025
443000                                                                  44300025
443100     MOVE PE-MQ-ERROR-NUMBER TO EP000-SL-PI-MESSAGE-NUMBER.       44310025
443200     SET  EP000-SL-ERROR  TO  TRUE.                               44320025
443300     MOVE PC-ONE TO EP000-MESSAGE-LINE-COUNTER.                   44330025
443400     MOVE PE-MQ-ERROR-MESSAGE                                     44340025
443500           TO  EP000-MD-SYSTEM-LOG-MESSAGE                        44350025
443600               (EP000-MESSAGE-LINE-COUNTER).                      44360025
443700     PERFORM EP000-1000-POST-MESSAGE.                             44370025
443800                                                                  44380025
443900                                                                  44390024
444000*----------------------------------------------------------------*44400024
444100*    ABEND PROCESSOR MODULE                                      *44410024
444200*----------------------------------------------------------------*44420024
444300                                                                  44430024
444400     COPY DPPD013.                                                44440024
444500     COPY EPPD000.                                                44450024
444501                                                                  44450185
444502                                                                  44450224
444503                                                                  44450324
444504                                                                  44450424
444505                                                                  44450524
444506                                                                  44450624
