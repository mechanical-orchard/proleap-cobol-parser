000100 IDENTIFICATION DIVISION.                                         00010045
000200 TITLE 'SEASONAL SET DATA RETRIEVAL MODULE'.                      00020045
000300 PROGRAM-ID.    PCKUT025.                                         00030045
000400 AUTHOR.        GERMAN BANDA.                                     00040045
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050045
000600 DATE-WRITTEN.  OCTOBER 2002.                                     00060045
000700******************************************************************00070045
000800*    WR32562    06/14/2007   ADDED FIXT-OBJ-ID TO LABEL          *00080045
000900******************************************************************00090045
001000 DATE-COMPILED.                                                   00100045
001100 ENVIRONMENT DIVISION.                                            00110045
001200 CONFIGURATION SECTION.                                           00120045
001300 SOURCE-COMPUTER. IBM-3090.                                       00130045
001400 OBJECT-COMPUTER. IBM-3090.                                       00140045
001500                                                                  00150045
001600 DATA DIVISION.                                                   00160045
001700 WORKING-STORAGE SECTION.                                         00170045
001800 01  PV-PROGRAM-VARIABLES.                                        00180045
001900     05  PV-NULL-IND                  PIC S9(4) VALUE ZERO        00190045
002000                                                COMP SYNC.        00200045
002100     05  PV-CURRENT-DATE              PIC X(10) VALUE SPACES.     00210045
002200     05  PV-DB2-CURRENT-DATE          PIC X(10) VALUE SPACES.     00220045
002300     05  PV-HOLD-FIXT-LOC-NBR         PIC X(10) VALUE SPACES.     00230045
002400     05  PV-HOLD-FIXT-CORP-IN         PIC X(10) VALUE SPACES.     00240045
002500     05  PV-FIXT-FLR-PAD              PIC X(10) VALUE SPACES.     00250045
002800                                                                  00260045
002900     05  PV-DIVERT-WORK               PIC 9(04) VALUE ZEROES.     00270045
003000     05  PV-DIVERT-WORK-R REDEFINES PV-DIVERT-WORK.               00280045
003100         10  PV-DIVERT-POS-1-2        PIC 9(02).                  00290045
003200         10  PV-DIVERT-POS-3          PIC 9.                      00300045
003300         10  PV-DIVERT-POS-4          PIC 9.                      00310045
003400                                                                  00320045
003500     05  PV-FIXTURE-WORK              PIC 9(09) VALUE ZEROES.     00330045
003600     05  PV-FIXTURE-WORK-R REDEFINES PV-FIXTURE-WORK.             00340045
003700         10  PV-FIX-LEN-1-2       PIC 9(07).                      00350045
003800         10  PV-FIX-LEN-8         PIC 9.                          00360045
003900         10  PV-FIX-LEN-9         PIC 9.                          00370045
004000     05  PV-FIX-STRT              PIC 9.                          00380045
004100     05  PV-FIX-LNGTH             PIC 9.                          00390045
004200     05  PV-INTR-UPC-ID           PIC  S9(9) COMP.                00400045
004300     05  PV-MULTI-SKU-COUNT       PIC  S9(4) COMP SYNC VALUE +0.  00410045
004400     05  PV-COUNT-EFC-AT-RDC      PIC S9(09) COMP VALUE ZEROES.   00420045
004401                                                                  00430045
004410     05  PV-DISP-DIVERT-PFX-NBR   PIC  ZZZZ       VALUE ZEROES.   00440045
004500                                                                  00450045
004600 01  DK-KEYS.                                                     00460045
004700     05  DK-CL-NBR                    PIC X(03) VALUE ZERO.       00470045
004800     05  DK-SUBCLASS-NBR              PIC X(03).                  00480045
004900     05  DK-MAJCLASS-NBR              PIC X(02).                  00490045
005000     05  DK-SEASET-YR                 PIC X(4).                   00500045
005100     05  DK-SEASET-SHRT-NM            PIC X(5).                   00510045
005200     05  DK-LOC-NBR                   PIC S9(4) COMP.             00520045
005300     05  DK-STR-GP-TYP-CDE            PIC S9(4) COMP.             00530045
005400     05  DK-STR-GP-ID                 PIC S9(4) COMP.             00540045
005500                                                                  00550045
005600 01  PS-SWITCHES.                                                 00560045
005700     05  PS-ITEM-UPC-CSR-SW              PIC  X(01)  VALUE 'N'.   00570045
005800         88  PS-EO-ITEM-UPC-CSR                      VALUE 'Y'.   00580045
005900         88  PS-NOT-EO-ITEM-UPC-CSR                  VALUE 'N'.   00590045
006000     05  PS-OTBND-UPC-CSR-SW             PIC  X(01)  VALUE 'N'.   00600045
006100         88  PS-EO-OTBND-UPC-CSR                     VALUE 'Y'.   00610045
006200         88  PS-NOT-EO-OTBND-UPC-CSR                 VALUE 'N'.   00620045
006300     05  PS-PREPK-UPC-CSR-SW             PIC  X(01)  VALUE 'N'.   00630045
006400         88  PS-EO-PREPK-UPC-CSR                     VALUE 'Y'.   00640045
006500         88  PS-NOT-EO-PREPK-UPC-CSR                 VALUE 'N'.   00650045
006600     05  PS-STORE-UPC-CSR-SW             PIC  X(01)  VALUE 'N'.   00660045
006700         88  PS-EO-STORE-UPC-CSR                     VALUE 'Y'.   00670045
006800         88  PS-NOT-EO-STORE-UPC-CSR                 VALUE 'N'.   00680045
006900     05  PS-POG-REF-FLAGGED-SW           PIC  X(01)  VALUE 'N'.   00690045
007000         88  PS-POG-REF-FLAGGED                      VALUE 'Y'.   00700045
007100         88  PS-NO-POG-REF-FLAGGED                   VALUE 'N'.   00710045
008100     05  PS-SKU-ASSN-NO-CORP-INIT-SW     PIC  X(01)  VALUE 'N'.   00720045
008200         88  PS-SKU-ASSN-NO-CORP-INIT                VALUE 'Y'.   00730045
008300         88  PS-NO-SKU-ASSN-NO-CORP-INIT             VALUE 'N'.   00740045
008400     05  PS-NEW-STORE-SW                 PIC  X(01)  VALUE 'N'.   00750045
008500         88  PS-NEW-STORE-FOUND                      VALUE 'Y'.   00760045
008600         88  PS-NO-NEW-STORE-FOUND                   VALUE 'N'.   00770045
008700     05  PS-FIRST-SKU-ASSN-SW            PIC  X(01)  VALUE 'Y'.   00780045
008800         88  PS-FIRST-SKU-ASSN-YES                   VALUE 'Y'.   00790045
008900         88  PS-FIRST-SKU-ASSN-NO                    VALUE 'N'.   00800045
009300     05  PS-RECHECK-NO-CORP-INIT-SW      PIC  X(01)  VALUE 'N'.   00810045
009400         88  PS-RECHECK-CORP-INIT                    VALUE 'Y'.   00820045
009500         88  PS-RECHECK-CORP-INIT-NO                 VALUE 'N'.   00830045
009600     05  PS-MULT-SKU-SW                  PIC  X(01)  VALUE 'N'.   00840045
009700         88  PS-MULT-SKU-YES                         VALUE 'Y'.   00850045
009800         88  PS-MULT-SKU-NO                          VALUE 'N'.   00860045
009900     05  PS-RETAIL-PROC-FOR-EFC-SW       PIC  X(01)  VALUE 'N'.   00870045
010000         88  PS-RETAIL-PROC-FOR-EFC-YES              VALUE 'Y'.   00880045
010100         88  PS-RETAIL-PROC-FOR-EFC-NO               VALUE 'N'.   00890045
010200     05  PS-EFC-FREIGHT-FOR-DC-SW        PIC  X(01)  VALUE 'N'.   00900045
010300         88  PS-EFC-FREIGHT-FOR-DC-YES               VALUE 'Y'.   00910045
010400         88  PS-EFC-FREIGHT-FOR-DC-NO                VALUE 'N'.   00920045
010500                                                                  00930045
010600 01  PC-CONSTANTS.                                                00940045
010700     05  PC-00                           PIC  9(02)  VALUE 00.    00950045
010800     05  PC-LOCATION-MODULE              PIC  X(08)               00960045
010900                                         VALUE  'XLKUT071'.       00970045
011000/                                                                 00980045
011100*----------------------------------------------------------------*00990045
011200*  COPYBOOK USED TO FOR ITEM ACCESS MODULE                        01000045
011300*  (XLKUT001)                                                     01010045
011400*----------------------------------------------------------------*01020045
011500     COPY XLWS001.                                                01030045
011600/                                                                 01040045
011700***************************************************************** 01050045
011800*   XLWS071 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 01060045
011900*             LOCATION MODULE (XLKUT071)                        * 01070045
012000***************************************************************** 01080045
012100     COPY XLWS071.                                                01090045
012200/                                                                 01100045
012300*----------------------------------------------------------------*01110045
012400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT UPC  01120045
012500*  TABLE                                                          01130045
012600*----------------------------------------------------------------*01140045
012700     EXEC SQL                                                     01150045
012800         INCLUDE TSHUUPC                                          01160045
012900     END-EXEC.                                                    01170045
013000*----------------------------------------------------------------*01180045
013100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT UPC  01190045
013200*  OUTBOUND TABLE                                                 01200045
013300*----------------------------------------------------------------*01210045
013400     EXEC SQL                                                     01220045
013500         INCLUDE SUT00028                                         01230045
013600     END-EXEC.                                                    01240045
013700*----------------------------------------------------------------*01250045
013800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR TPURCHS                01260045
013900*----------------------------------------------------------------*01270045
014000     EXEC SQL                                                     01280045
014100         INCLUDE TPURCHS                                          01290045
014200     END-EXEC.                                                    01300045
014300*----------------------------------------------------------------*01310045
014400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SEASONAL SET TABLE 01320045
014500*----------------------------------------------------------------*01330045
014600     EXEC SQL                                                     01340045
014700         INCLUDE TSEASET                                          01350045
014800     END-EXEC.                                                    01360045
014900*----------------------------------------------------------------*01370045
015000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR LOGISTICS DOMAIN       01380045
015100*  LOCATION MASTER TABLE                                          01390045
015200*----------------------------------------------------------------*01400045
015300     EXEC SQL                                                     01410045
015400         INCLUDE XLT00010                                         01420045
015500     END-EXEC.                                                    01430045
015600*----------------------------------------------------------------*01440045
015700*  DB2 DCLGEN FOR LOGISTICS DOMAIN LOCATION MASTER STORE          01450045
015800*  GROUP MEMBERSHIP TABLE                                         01460045
015900*----------------------------------------------------------------*01470045
016000     EXEC SQL                                                     01480045
016100          INCLUDE XLT00018                                        01490045
016200     END-EXEC.                                                    01500045
016300*----------------------------------------------------------------*01510045
016400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR SKU TABLE              01520045
016500*  (XLT_SKU)                                                      01530045
016600*----------------------------------------------------------------*01540045
016700     EXEC SQL                                                     01550045
016800         INCLUDE XLT00003                                         01560045
016900     END-EXEC.                                                    01570045
017100*----------------------------------------------------------------*01580045
017200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR RECITM TABLE           01590045
017300*----------------------------------------------------------------*01600045
017400     EXEC SQL                                                     01610045
017500         INCLUDE TRECITM                                          01620045
017600     END-EXEC.                                                    01630045
017700*----------------------------------------------------------------*01640045
017800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR RECDIS TABLE           01650045
017900*----------------------------------------------------------------*01660045
018000     EXEC SQL                                                     01670045
018100         INCLUDE TRECDIS                                          01680045
018200     END-EXEC.                                                    01690045
020600*----------------------------------------------------------------*01700045
020700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR PARAMETER TABLE        01710045
020800*   (TKRPRPM )                                                    01720045
020900*----------------------------------------------------------------*01730045
021000     EXEC SQL                                                     01740045
021100         INCLUDE TKRPRPM                                          01750045
021200     END-EXEC.                                                    01760045
021300*----------------------------------------------------------------*01770045
021400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR DOMAIN UPC TABLE       01780045
021500*   (XLT_UPC )                                                    01790045
021600*----------------------------------------------------------------*01800045
021700     EXEC SQL                                                     01810045
021800         INCLUDE XLT00006                                         01820045
021900     END-EXEC.                                                    01830045
022000*----------------------------------------------------------------*01840045
022100*  DCLGEN WST_INTGRTN_TYP                                         01850045
022200*----------------------------------------------------------------*01860045
022300     EXEC SQL                                                     01870045
022400         INCLUDE WST00008                                         01880045
022500     END-EXEC.                                                    01890045
022600                                                                  01900045
022700*----------------------------------------------------------------*01910045
022800*  DCLGEN WST_ATTR_DEFN                                           01920045
022900*----------------------------------------------------------------*01930045
023000     EXEC SQL                                                     01940045
023100         INCLUDE WST00009                                         01950045
023200     END-EXEC.                                                    01960045
023300                                                                  01970045
023400*----------------------------------------------------------------*01980045
023500*  DCLGEN WST_ATTR_ELEM                                           01990045
023600*----------------------------------------------------------------*02000045
023700     EXEC SQL                                                     02010045
023800         INCLUDE WST00010                                         02020045
023900     END-EXEC.                                                    02030045
024000                                                                  02040045
024100*----------------------------------------------------------------*02050045
024200                                                                  02060045
024300     EXEC SQL                                                     02070045
024400          INCLUDE SQLCA                                           02080045
024500     END-EXEC.                                                    02090045
024600*---------------------------------------------------------------* 02100045
024700*  CURSOR TO RETURN ALL THE UPC'S IN A CARTON FROM INBOUND      * 02110045
024800*---------------------------------------------------------------* 02120045
024900     EXEC SQL                                                     02130045
025000          DECLARE ITEM_UPC_CSR CURSOR FOR                         02140045
025100           SELECT DISTINCT(UPC_NBR)                               02150045
025200           FROM TSHUUPC                                           02160045
025300           WHERE SHIPT_UNT_ID = :SHUUPC-SHIPT-UNT-ID              02170045
025400     END-EXEC                                                     02180045
025500                                                                  02190045
025600*---------------------------------------------------------------* 02200045
025700*  CURSOR TO RETURN ALL THE UPC'S IN A CARTON FROM OUTBOUND     * 02210045
025800*---------------------------------------------------------------* 02220045
025900     EXEC SQL                                                     02230045
026000          DECLARE ITEM_UPC_CSR_OTBND CURSOR FOR                   02240045
026100           SELECT DISTINCT(UPC_NBR)                               02250045
026200           FROM SUT_OTBND_UPC                                     02260045
026300           WHERE SHIPT_UNT_ID = :SUT00028-SHIPT-UNT-ID            02270045
026400     END-EXEC                                                     02280045
026500                                                                  02290045
028200*---------------------------------------------------------------* 02300045
028300*  CURSOR TO RETURN THE INTERNAL UPC ID FROM A PREPK            * 02310045
028400*---------------------------------------------------------------* 02320045
028500     EXEC SQL                                                     02330045
028600          DECLARE PREPK_INT_UPC_CSR CURSOR FOR                    02340045
028700            SELECT DISTINCT(ITM_NBR)                              02350045
028800             FROM  TRECITM A                                      02360045
028900             WHERE A.ORD_NBR             = :RECITM-ORD-NBR        02370045
029000               AND A.PREPK_ID            = :RECITM-PREPK-ID       02380045
029100               AND A.REC_SEQ_NBR         = :RECITM-REC-SEQ-NBR    02390045
029200               AND A.VER_STATUS_CDE      = 'A'                    02400045
029300     END-EXEC                                                     02410045
029400                                                                  02420045
031300*---------------------------------------------------------------* 02430045
031400*  CURSOR TO RETURN THE INTERNAL UPC ID FOR A STORE             * 02440045
031500*---------------------------------------------------------------* 02450045
031600     EXEC SQL                                                     02460045
031700          DECLARE STORE_UPC_CSR CURSOR FOR                        02470045
031800            SELECT DISTINCT(ITM_NBR)                              02480045
031900             FROM  TRECITM A                                      02490045
032000                ,  TRECDIS B                                      02500045
032100             WHERE A.ORD_NBR        =  B.ORD_NBR                  02510045
032200               AND A.REC_SEQ_NBR    =  B.REC_SEQ_NBR              02520045
032300               AND A.ORD_NBR        = :RECITM-ORD-NBR             02530045
032400               AND A.REC_SEQ_NBR    = :RECITM-REC-SEQ-NBR         02540045
032500               AND B.STR_NBR        = :RECDIS-STR-NBR             02550045
032600     END-EXEC                                                     02560045
032700                                                                  02570045
032800                                                                  02580045
032900 LINKAGE SECTION.                                                 02590045
033000     COPY PCWS240.                                                02600045
033100/                                                                 02610045
033200 PROCEDURE DIVISION USING PC240-ITEM-COMMAREA.                    02620045
033300                                                                  02630045
033400     SET PC240-SUCCESSFUL        TO TRUE.                         02640045
033500     MOVE 'N'                    TO PS-ITEM-UPC-CSR-SW            02650045
033600                                    PS-OTBND-UPC-CSR-SW           02660045
033700                                    PS-PREPK-UPC-CSR-SW           02670045
033800                                    PS-POG-REF-FLAGGED-SW         02680045
034000                                    PS-STORE-UPC-CSR-SW           02690045
034400                                    PS-SKU-ASSN-NO-CORP-INIT-SW   02700045
034500                                    PS-NEW-STORE-SW               02710045
034700                                    PS-RECHECK-NO-CORP-INIT-SW    02720045
034800                                    PS-MULT-SKU-SW.               02730045
034900     MOVE 'Y'                    TO PS-FIRST-SKU-ASSN-SW.         02740045
035100     MOVE ZERO                   TO PV-MULTI-SKU-COUNT.           02750045
035200     INITIALIZE DCLTSHUUPC                                        02760045
035300     MOVE PC240-KEY-PO TO  PURCHS-PO-NBR.                         02770045
035400                                                                  02780045
035600     PERFORM 0100-CHECK-SEASONAL-SET.                             02790045
035700     EXEC SQL                                                     02800045
035800        SET :PV-DB2-CURRENT-DATE = CURRENT DATE                   02810045
035900     END-EXEC.                                                    02820045
036000                                                                  02830045
036100     PERFORM 0400-SEL-LOCATION-OPN-DTE.                           02840045
036300                                                                  02850045
036400     IF PC240-SEASONAL-SET-FOUND                                  02860045
036500        PERFORM 0200-CHECK-DIVERT-CODE                            02870045
036600     END-IF                                                       02880045
036700                                                                  02890045
036800     IF PC240-SEASONAL-SET-FOUND                                  02900045
036900        PERFORM 0300-CHECK-FOR-POG-DATA                           02910045
037000     END-IF                                                       02920045
037100                                                                  02930045
037200*                                                                 02940045
037400*** NEED TO CHECK IF EFC FREIGHT FOR DC FOR ALL STORES            02950045
037500*** RETAIL STORES WILL NOT HAVE THE DIVERT ON THEM                02960045
037600*                                                                 02970045
037700     SET PS-RETAIL-PROC-FOR-EFC-NO                                02980045
037800         PS-EFC-FREIGHT-FOR-DC-NO    TO  TRUE.                    02990045
037900     IF  PC240-SEASONAL-SET-FOUND    AND                          03000045
038000         XLT00010-LOC-TYP-CDE  =  'DS'                            03010045
038200         PERFORM 0500-CHECK-RETAIL-DC-FOR-EFC                     03020045
038300     END-IF.                                                      03030045
038400*                                                                 03040045
038700*-- STORE OPEN DATE < CURRENT DATE                                03050045
038800     IF PS-NO-NEW-STORE-FOUND                                     03060045
038900        PERFORM 4000-PROCESS-EXISTNG-STORES                       03070045
039000     ELSE                                                         03080045
039100        PERFORM 5000-PROCESS-NEW-STORES                           03090045
039200     END-IF                                                       03100045
039300                                                                  03110045
039400     IF PC240-SUCCESSFUL AND NOT PC240-ITEM-NOT-FOUND             03120045
039500         PERFORM 9000-BUILD-OUTPUT                                03130045
039600     END-IF.                                                      03140045
039700                                                                  03150045
039720***  DISPLAY IS ONLY FOR TESTING ONLY                             03160045
039724***  MOVE PC240-DIVERT-PFX-NBR TO PV-DISP-DIVERT-PFX-NBR          03170045
039730***  DISPLAY  ' PCKUT025 BEFORE RETURN:  '                        03180045
039740***            PC240-SEASET-YR '-'                                03190045
039750***            PC240-SEASET-SHRT-NM '-'                           03200045
039760***            PC240-SEASET-NM  '-'                               03210045
039761***           'DIVERT PFX: ' PV-DISP-DIVERT-PFX-NBR.              03220045
039770                                                                  03230045
039800     MOVE SQLCA                       TO PC240-SQLCA              03240045
039900     GOBACK.                                                      03250045
040000                                                                  03260045
040100 0100-CHECK-SEASONAL-SET.                                         03270045
040200                                                                  03280045
040300*----------------------------------------------------------------*03290045
040400*  CHECK FOR A SEASONAL SET                                      *03300045
040500*----------------------------------------------------------------*03310045
040600     EXEC SQL                                                     03320045
040700        SELECT                                                    03330045
040800            A.SEASET_YR                                           03340045
040900           ,A.SEASET_SHRT_NM                                      03350045
041000           ,B.SEASET_NM                                           03360045
041100           ,B.SEASET_TYP_CDE                                      03370045
041200       INTO                                                       03380045
041300           :PURCHS-SEASET-YR                                      03390045
041400          ,:PURCHS-SEASET-SHRT-NM                                 03400045
041500          ,:SEASET-SEASET-NM                                      03410045
041600          ,:SEASET-SEASET-TYP-CDE                                 03420045
041700        FROM                                                      03430045
041800            TPURCHS A                                             03440045
041900          , TSEASET B                                             03450045
042000        WHERE PO_NBR           = :PURCHS-PO-NBR                   03460045
042100          AND A.SEASET_YR      = B.SEASET_YR                      03470045
042200          AND A.SEASET_SHRT_NM = B.SEASET_SHRT_NM                 03480045
042300          AND A.VER_STATUS_CDE = 'A'                              03490045
042400     END-EXEC.                                                    03500045
042500                                                                  03510045
042600     EVALUATE TRUE                                                03520045
042700         WHEN SQLCODE = ZERO                                      03530045
042800             SET PC240-SEASONAL-SET-FOUND TO TRUE                 03540045
042900         WHEN SQLCODE = +100                                      03550045
043000             MOVE PC-00 TO PC240-DIVERT-PFX-NBR                   03560045
043100                           SEASET-DIVERT-PFX-NBR                  03570045
043200             SET PC240-NO-SEASONAL-SET-FOUND TO TRUE              03580045
043300         WHEN SQLCODE = -904                                      03590045
043400         WHEN SQLCODE = -913                                      03600045
043500         WHEN SQLCODE = -911                                      03610045
043600             MOVE 1                   TO PC240-ERROR-NBR          03620045
043700             SET PC240-SQL-ERROR      TO TRUE                     03630045
043800         WHEN SQLWARN0 NOT = SPACES                               03640045
043900         WHEN SQLCODE NOT EQUAL ZERO                              03650045
044000             MOVE 2                   TO PC240-ERROR-NBR          03660045
044100             SET PC240-SQL-ERROR      TO TRUE                     03670045
044200     END-EVALUATE.                                                03680045
044300/                                                                 03690045
044400 0200-CHECK-DIVERT-CODE.                                          03700045
044500     EXEC SQL                                                     03710045
044600        SELECT                                                    03720045
044700             SEASET_YR                                            03730045
044800            ,SEASET_SHRT_NM                                       03740045
044900            ,SEASET_TYP_CDE                                       03750045
045000            ,SEASET_NM                                            03760045
045100            ,SEASET_STAT_CDE                                      03770045
045200            ,STR_STUP_BEG_DTE                                     03780045
045300            ,STR_STUP_END_DTE                                     03790045
045400            ,STR_RLSE_BEG_DTE                                     03800045
045500            ,STR_RLSE_END_DTE                                     03810045
045600            ,LAST_UPD_BY_USR_ID                                   03820045
045700            ,LAST_UPD_TMST                                        03830045
045800            ,DIVERT_PFX_NBR                                       03840045
045900            ,POG_SEASET_YR                                        03850045
046000            ,POG_SEASET_SHRT_NM                                   03860045
046100            ,POG_SEASET_IND                                       03870045
046200            ,CURRENT DATE                                         03880045
046300        INTO                                                      03890045
046400           :SEASET-SEASET-YR                                      03900045
046500          ,:SEASET-SEASET-SHRT-NM                                 03910045
046600          ,:SEASET-SEASET-TYP-CDE                                 03920045
046700          ,:SEASET-SEASET-NM                                      03930045
046800          ,:SEASET-SEASET-STAT-CDE                                03940045
046900          ,:SEASET-STR-STUP-BEG-DTE                               03950045
047000          ,:SEASET-STR-STUP-END-DTE                               03960045
047100          ,:SEASET-STR-RLSE-BEG-DTE                               03970045
047200          ,:SEASET-STR-RLSE-END-DTE                               03980045
047300          ,:SEASET-LAST-UPD-BY-USR-ID                             03990045
047400          ,:SEASET-LAST-UPD-TMST                                  04000045
047500          ,:SEASET-DIVERT-PFX-NBR                                 04010045
047600          ,:SEASET-POG-SEASET-YR                                  04020045
047700          ,:SEASET-POG-SEASET-SHRT-NM                             04030045
047800          ,:SEASET-POG-SEASET-IND                                 04040045
047900          ,:PV-DB2-CURRENT-DATE                                   04050045
048000        FROM TSEASET                                              04060045
048100        WHERE SEASET_YR       = :PURCHS-SEASET-YR                 04070045
048200          AND SEASET_SHRT_NM  = :PURCHS-SEASET-SHRT-NM            04080045
048300          AND SEASET_STAT_CDE = 'A'                               04090045
048400     END-EXEC.                                                    04100045
048500                                                                  04110045
048600     EVALUATE TRUE                                                04120045
048700         WHEN SQLCODE = ZERO                                      04130045
048800           IF PV-DB2-CURRENT-DATE > SEASET-STR-RLSE-END-DTE       04140045
048900               MOVE PC-00 TO PC240-DIVERT-PFX-NBR                 04150045
049000                             SEASET-DIVERT-PFX-NBR                04160045
049100           ELSE                                                   04170045
049200                                                                  04180045
049400               MOVE SEASET-DIVERT-PFX-NBR TO PV-DIVERT-WORK       04190045
049500               IF  SEASET-DIVERT-PFX-NBR  >  9                    04200045
049600                   MOVE PV-DIVERT-POS-3  TO  PC240-DIVERT-PFX-NBR 04210045
049700                                             SEASET-DIVERT-PFX-NBR04220045
049800               ELSE                                               04230045
049900                   MOVE PV-DIVERT-POS-4  TO  PC240-DIVERT-PFX-NBR 04240045
050000                                             SEASET-DIVERT-PFX-NBR04250045
050100               END-IF                                             04260045
050400                                                                  04270045
050500           END-IF                                                 04280045
050600         WHEN SQLCODE = +100                                      04290045
050700**SEASONAL SET NOT ACTIVE                                         04300045
050800             MOVE PC-00 TO PC240-DIVERT-PFX-NBR                   04310045
050900                           SEASET-DIVERT-PFX-NBR                  04320045
051000             SET PC240-NO-SEASONAL-SET-FOUND TO TRUE              04330045
051100         WHEN SQLCODE = -904                                      04340045
051200         WHEN SQLCODE = -913                                      04350045
051300         WHEN SQLCODE = -911                                      04360045
051400             MOVE 3                   TO PC240-ERROR-NBR          04370045
051500             SET PC240-SQL-ERROR      TO TRUE                     04380045
051600         WHEN SQLWARN0 NOT = SPACES                               04390045
051700         WHEN SQLCODE NOT EQUAL ZERO                              04400045
051800             MOVE 4                   TO PC240-ERROR-NBR          04410045
051900             SET PC240-SQL-ERROR      TO TRUE                     04420045
052000     END-EVALUATE.                                                04430045
052001                                                                  04440045
052010***  DISPLAY IS ONLY FOR TESTING ONLY                             04450045
052020***  DISPLAY  ' PCKUT025 0200-CHECK-DIVERT-CODE '                 04460045
052030***           ' PV-DIVERT-WORK: ' PV-DIVERT-WORK                  04470045
052040***           '  NAME:' SEASET-SEASET-SHRT-NM                     04480045
052050***           '  YEAR:' SEASET-SEASET-YR.                         04490045
052070                                                                  04500045
052100/                                                                 04510045
052200 0300-CHECK-FOR-POG-DATA.                                         04520045
052300***                                                               04530045
052400     MOVE PURCHS-SEASET-YR      TO DK-SEASET-YR                   04540045
052500     MOVE PURCHS-SEASET-SHRT-NM TO DK-SEASET-SHRT-NM              04550045
052600*-- LAST POG_SEASET_IND = Y WAS 2020                              04560045
052700     IF SEASET-POG-SEASET-IND = 'Y'                               04570045
052800        SET PS-POG-REF-FLAGGED TO TRUE                            04580045
052900     ELSE                                                         04590045
053000        IF (SEASET-POG-SEASET-YR    > SPACES) AND                 04600045
053100           (SEASET-POG-SEASET-SHRT-NM  > SPACES)                  04610045
053200           SET PS-POG-REF-FLAGGED TO TRUE                         04620045
053300           MOVE SEASET-POG-SEASET-YR      TO DK-SEASET-YR         04630045
053400           MOVE SEASET-POG-SEASET-SHRT-NM TO DK-SEASET-SHRT-NM    04640045
053500        ELSE                                                      04650045
053600           SET PS-NO-POG-REF-FLAGGED    TO TRUE                   04660045
053700     END-IF.                                                      04670045
053800/                                                                 04680045
056300                                                                  04690045
056400 0400-SEL-LOCATION-OPN-DTE.                                       04700045
056500                                                                  04710045
056600     SET PS-NO-NEW-STORE-FOUND TO TRUE                            04720045
056700     MOVE PC240-KEY-DEST-LOC TO XLT00010-LOC-NBR.                 04730045
056800                                                                  04740045
056900     EXEC SQL                                                     04750045
057000            SELECT OPN_DTE                                        04760045
057100                 , LOC_TYP_CDE                                    04770045
057200                 , E_BUS_IND                                      04780045
057300            INTO   :XLT00010-OPN-DTE                              04790045
057400                 , :XLT00010-LOC-TYP-CDE                          04800045
057500                 , :XLT00010-E-BUS-IND                            04810045
057600            FROM  XLT_LOC                                         04820045
057700            WHERE LOC_NBR          =  :XLT00010-LOC-NBR           04830045
057800     END-EXEC.                                                    04840045
057900                                                                  04850045
058000     EVALUATE TRUE                                                04860045
058100         WHEN SQLCODE = ZERO                                      04870045
058200            IF PV-DB2-CURRENT-DATE < XLT00010-OPN-DTE             04880045
058300               SET PS-NEW-STORE-FOUND TO TRUE                     04890045
058400            END-IF                                                04900045
058500         WHEN SQLCODE = +100                                      04910045
058600         WHEN SQLCODE = -305                                      04920045
058700            CONTINUE                                              04930045
058800         WHEN SQLCODE = -904                                      04940045
058900         WHEN SQLCODE = -913                                      04950045
059000         WHEN SQLCODE = -911                                      04960045
059100             MOVE 35                  TO PC240-ERROR-NBR          04970045
059200             SET PC240-SQL-ERROR      TO TRUE                     04980045
059300         WHEN SQLWARN0 NOT = SPACES                               04990045
059400         WHEN SQLCODE NOT EQUAL ZERO                              05000045
059500             MOVE 36                  TO PC240-ERROR-NBR          05010045
059600             SET PC240-SQL-ERROR      TO TRUE                     05020045
059700     END-EVALUATE.                                                05030045
059800/                                                                 05040045
059900                                                                  05050045
060000******************************************************************05060045
060100* FOR SEASONAL SETS FOR EFC STORES - CHECK IF THE FREIGHT STAYS  *05070045
060200* IN THE RETAIL DC - THIS WILL ALLOW ECOM FULFILLMENT FROM THE   *05080045
060300* RETAIL DC'S.                                                   *05090045
060500******************************************************************05100045
060600 0500-CHECK-RETAIL-DC-FOR-EFC.                                    05110045
060700                                                                  05120045
060800     MOVE PC240-KEY-SKU           TO XLT00003-SKU-NBR.            05130045
060900                                                                  05140045
061000     EXEC SQL                                                     05150045
061100          SELECT   COUNT(*)                                       05160045
061200            INTO  :PV-COUNT-EFC-AT-RDC                            05170045
061300            FROM                                                  05180045
061400                  WST_INTGRTN_TYP  A                              05190045
061500               ,  WST_ATTR_DEFN    B                              05200045
061600               ,  WST_ATTR_ELEM    C                              05210045
061700               ,  WST_ATTR_ELEM    D                              05220045
061800               ,  WST_ATTR_ELEM    E                              05230045
061900               ,  WST_ATTR_ELEM    F                              05240045
062000               ,  TSEASET          G                              05250045
062100          WHERE                                                   05260045
062200                A.INTGRTN_TYP_CDE   = 'EFCATRDC'                  05270045
062300            AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           05280045
062400            AND B.ATTR_DEFN_SEQ_NBR = 1                           05290045
062500            AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           05300045
062600            AND C.ATTR_DEFN_SEQ_NBR = 1                           05310045
062700            AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           05320045
062800            AND D.ATTR_DEFN_SEQ_NBR = 2                           05330045
062900            AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE           05340045
063000            AND E.ATTR_DEFN_SEQ_NBR = 3                           05350045
063100            AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE           05360045
063200            AND F.ATTR_DEFN_SEQ_NBR = 4                           05370045
063300            AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         05380045
063400            AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR         05390045
063500            AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR         05400045
063600            AND C.ATTR_ELEM_TXT     = G.SEASET_TYP_CDE            05410045
063700            AND D.ATTR_ELEM_TXT    <= 'ACTIVE'                    05420045
063800            AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP           05430045
063900            AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP           05440045
064000            AND G.SEASET_SHRT_NM   = :SEASET-SEASET-SHRT-NM       05450045
064100            AND G.SEASET_YR        = :SEASET-SEASET-YR            05460045
064200     END-EXEC.                                                    05470045
064300                                                                  05480045
064400     EVALUATE TRUE                                                05490045
064500         WHEN SQLCODE = ZERO                                      05500045
064600              IF  PV-COUNT-EFC-AT-RDC  >  0                       05510045
064700                  SET  PS-EFC-FREIGHT-FOR-DC-YES TO TRUE          05520045
064800              ELSE                                                05530045
064900                  SET  PS-EFC-FREIGHT-FOR-DC-NO  TO TRUE          05540045
065000              END-IF                                              05550045
065100                                                                  05560045
065200         WHEN SQLCODE = +100                                      05570045
065300              SET  PS-EFC-FREIGHT-FOR-DC-NO  TO  TRUE             05580045
065400                                                                  05590045
065500         WHEN SQLCODE = -904                                      05600045
065600         WHEN SQLCODE = -913                                      05610045
065700         WHEN SQLCODE = -911                                      05620045
065800             MOVE 49                  TO PC240-ERROR-NBR          05630045
065900             SET PC240-SQL-ERROR      TO TRUE                     05640045
066000         WHEN SQLWARN0 NOT = SPACES                               05650045
066100         WHEN SQLCODE NOT EQUAL ZERO                              05660045
066200             MOVE 50                  TO PC240-ERROR-NBR          05670045
066300             SET PC240-SQL-ERROR      TO TRUE                     05680045
066400     END-EVALUATE.                                                05690045
066500                                                                  05700045
066600***  DISPLAY IS ONLY FOR TESTING                                  05710045
066700***  DISPLAY  ' PCKUT025 SWITCH:'                                 05720045
066800***                     PS-EFC-FREIGHT-FOR-DC-SW                  05730045
066900***           '  NAME:' SEASET-SEASET-SHRT-NM                     05740045
067000***           '  YEAR:' SEASET-SEASET-YR.                         05750045
067100                                                                  05760045
067200                                                                  05770045
067300 1000-CHECK-IN-PROCESS.                                           05780045
067301                                                                  05790045
067400     MOVE PC240-KEY-CARTON-ID         TO SHUUPC-SHIPT-UNT-ID.     05800045
067500     MOVE PC240-KEY-DEST-LOC          TO DK-LOC-NBR.              05810045
067600     PERFORM 6000-PROCESS-CARTON-UPC.                             05820045
067700                                                                  05830045
067800                                                                  05840045
067900 2000-CASEPK-PROCESS.                                             05850045
067901                                                                  05860045
068000     MOVE PC240-KEY-DEST-LOC          TO DK-LOC-NBR.              05870045
068100     PERFORM 2050-SELECT-INTERNAL-UPC.                            05880045
068200                                                                  05890045
068300                                                                  05900045
072800******************************************************************05910045
072900 2050-SELECT-INTERNAL-UPC.                                        05920045
073000******************************************************************05930045
073100                                                                  05940045
073200     MOVE PC240-KEY-SKU           TO XLT00003-SKU-NBR.            05950045
073300                                                                  05960045
073400     EXEC SQL                                                     05970045
073500            SELECT INTR_UPC_ID                                    05980045
073600            INTO   :XLT00003-INTR-UPC-ID                          05990045
073700            FROM  XLT_SKU                                         06000045
073800            WHERE SKU_NBR          =  :XLT00003-SKU-NBR           06010045
073900     END-EXEC.                                                    06020045
074000                                                                  06030045
074100     EVALUATE TRUE                                                06040045
074200         WHEN SQLCODE = ZERO                                      06050045
074300*            MOVE XLT00003-INTR-UPC-ID TO XLT00031-INTR-UPC-ID    06060045
074310             MOVE XLT00003-INTR-UPC-ID TO PV-INTR-UPC-ID          06070045
074400         WHEN SQLCODE = -904                                      06080045
074500         WHEN SQLCODE = -913                                      06090045
074600         WHEN SQLCODE = -911                                      06100045
074700             MOVE 30                  TO PC240-ERROR-NBR          06110045
074800             SET PC240-SQL-ERROR      TO TRUE                     06120045
074900         WHEN SQLWARN0 NOT = SPACES                               06130045
075000         WHEN SQLCODE NOT EQUAL ZERO                              06140045
075100             MOVE 31                  TO PC240-ERROR-NBR          06150045
075200             SET PC240-SQL-ERROR      TO TRUE                     06160045
075300     END-EVALUATE.                                                06170045
075400/                                                                 06180045
075500******************************************************************06190045
075600 2100-PROCESS-CASE-PREPK.                                         06200045
075700******************************************************************06210045
075800     MOVE PC240-KEY-PO                TO RECITM-ORD-NBR.          06220045
075900     MOVE PC240-KEY-PREPK-ID          TO RECITM-PREPK-ID.         06230045
076000     MOVE PC240-KEY-REC-SEQ-NBR       TO RECITM-REC-SEQ-NBR.      06240045
076100     MOVE PC240-KEY-DEST-LOC          TO DK-LOC-NBR.              06250045
076200                                                                  06260045
076400     PERFORM 2200-PROCESS-PREPK-LINES.                            06270045
076410                                                                  06280045
076420                                                                  06290045
076500******************************************************************06300045
076700 2200-PROCESS-PREPK-LINES.                                        06310045
076800                                                                  06320045
076900      SET PS-NOT-EO-PREPK-UPC-CSR  TO TRUE.                       06330045
077100                                                                  06340045
077200      PERFORM 2300-OPEN-PREPK-CSR.                                06350045
077300      PERFORM 2400-FETCH-PREPK-CSR                                06360045
077400        UNTIL PS-EO-PREPK-UPC-CSR                                 06370045
077600      PERFORM 2500-CLOSE-PREPK-CSR.                               06380045
077700                                                                  06390045
077800******************************************************************06400045
077900 2300-OPEN-PREPK-CSR.                                             06410045
078000                                                                  06420045
078100         EXEC SQL                                                 06430045
078200              OPEN PREPK_INT_UPC_CSR                              06440045
078300         END-EXEC                                                 06450045
078400                                                                  06460045
078500                                                                  06470045
078600         EVALUATE TRUE                                            06480045
078700             WHEN SQLCODE = ZERO                                  06490045
078800                 CONTINUE                                         06500045
078900         WHEN SQLCODE = -904                                      06510045
079000         WHEN SQLCODE = -913                                      06520045
079100         WHEN SQLCODE = -911                                      06530045
079200             MOVE 15                  TO PC240-ERROR-NBR          06540045
079300             SET PC240-SQL-ERROR      TO TRUE                     06550045
079400         WHEN SQLWARN0 NOT = SPACES                               06560045
079500         WHEN SQLCODE NOT EQUAL ZERO                              06570045
079600             MOVE 16                  TO PC240-ERROR-NBR          06580045
079700             SET PC240-SQL-ERROR      TO TRUE                     06590045
079800         END-EVALUATE.                                            06600045
079900                                                                  06610045
080000 EJECT                                                            06620045
080100*----------------------------------------------------------------*06630045
080200*                                                                *06640045
080300*----------------------------------------------------------------*06650045
080400 2400-FETCH-PREPK-CSR.                                            06660045
080500                                                                  06670045
080600                                                                  06680045
080700     EXEC SQL                                                     06690045
080800        FETCH   PREPK_INT_UPC_CSR                                 06700045
080900        INTO   :RECITM-ITM-NBR                                    06710045
081000     END-EXEC.                                                    06720045
081100                                                                  06730045
081200     EVALUATE TRUE                                                06740045
081300       WHEN SQLCODE = ZEROS                                       06750045
081400            PERFORM 6400-CALL-XLKUT001                            06760045
081500       WHEN SQLCODE = +100                                        06770045
081600                SET  PS-EO-PREPK-UPC-CSR TO TRUE                  06780045
081700       WHEN SQLCODE = -904                                        06790045
081800       WHEN SQLCODE = -913                                        06800045
081900       WHEN SQLCODE = -911                                        06810045
082000           MOVE 17                  TO PC240-ERROR-NBR            06820045
082100           SET PC240-SQL-ERROR      TO TRUE                       06830045
082200       WHEN SQLWARN0 NOT = SPACES                                 06840045
082300       WHEN SQLCODE NOT EQUAL ZERO                                06850045
082400           MOVE 18                  TO PC240-ERROR-NBR            06860045
082500           SET PC240-SQL-ERROR      TO TRUE                       06870045
082600     END-EVALUATE.                                                06880045
082700                                                                  06890045
082800                                                                  06900045
082900 2500-CLOSE-PREPK-CSR.                                            06910045
083000                                                                  06920045
083100         EXEC SQL                                                 06930045
083200             CLOSE PREPK_INT_UPC_CSR                              06940045
083300         END-EXEC                                                 06950045
083400                                                                  06960045
083500                                                                  06970045
083600         EVALUATE TRUE                                            06980045
083700             WHEN SQLCODE = ZERO                                  06990045
083800                 CONTINUE                                         07000045
083900             WHEN SQLWARN0 NOT = SPACES                           07010045
084000             WHEN SQLCODE < ZERO                                  07020045
084100             WHEN SQLCODE > ZERO                                  07030045
084200                MOVE 19                  TO PC240-ERROR-NBR       07040045
084300                SET PC240-SQL-ERROR      TO TRUE                  07050045
084400         END-EVALUATE.                                            07060045
084500                                                                  07070045
084600                                                                  07080045
084700 EJECT                                                            07090045
084800 2600-PROCESS-SMOOTHING.                                          07100045
084900******************************************************************07110045
085000     MOVE PC240-KEY-PO                TO RECITM-ORD-NBR.          07120045
085100     MOVE PC240-KEY-REC-SEQ-NBR       TO RECITM-REC-SEQ-NBR.      07130045
085200     MOVE PC240-KEY-DEST-LOC          TO DK-LOC-NBR               07140045
085300                                         RECDIS-STR-NBR.          07150045
085400                                                                  07160045
085600     PERFORM 2700-PROCESS-STORE-ITEMS.                            07170045
085610                                                                  07180045
085800                                                                  07190045
085810******************************************************************07200045
085900 2700-PROCESS-STORE-ITEMS.                                        07210045
086000                                                                  07220045
086100      SET PS-NOT-EO-STORE-UPC-CSR  TO TRUE.                       07230045
086300                                                                  07240045
086400      PERFORM 2800-OPEN-STORE-CSR.                                07250045
086500      PERFORM 2850-FETCH-STORE-CSR                                07260045
086600        UNTIL PS-EO-STORE-UPC-CSR.                                07270045
086700                                                                  07280045
086800      PERFORM 2900-CLOSE-STORE-CSR.                               07290045
086900                                                                  07300045
087000******************************************************************07310045
087100 2800-OPEN-STORE-CSR.                                             07320045
087200                                                                  07330045
087300         EXEC SQL                                                 07340045
087400              OPEN STORE_UPC_CSR                                  07350045
087500         END-EXEC                                                 07360045
087600                                                                  07370045
087700                                                                  07380045
087800         EVALUATE TRUE                                            07390045
087900             WHEN SQLCODE = ZERO                                  07400045
088000                 CONTINUE                                         07410045
088100         WHEN SQLCODE = -904                                      07420045
088200         WHEN SQLCODE = -913                                      07430045
088300         WHEN SQLCODE = -911                                      07440045
088400             MOVE 25                  TO PC240-ERROR-NBR          07450045
088500             SET PC240-SQL-ERROR      TO TRUE                     07460045
088600         WHEN SQLWARN0 NOT = SPACES                               07470045
088700         WHEN SQLCODE NOT EQUAL ZERO                              07480045
088800             MOVE 26                  TO PC240-ERROR-NBR          07490045
088900             SET PC240-SQL-ERROR      TO TRUE                     07500045
089000         END-EVALUATE.                                            07510045
089100                                                                  07520045
089200 EJECT                                                            07530045
089300*----------------------------------------------------------------*07540045
089400*                                                                *07550045
089500*----------------------------------------------------------------*07560045
089600 2850-FETCH-STORE-CSR.                                            07570045
089700                                                                  07580045
089800                                                                  07590045
089900     EXEC SQL                                                     07600045
090000        FETCH   STORE_UPC_CSR                                     07610045
090100        INTO   :RECITM-ITM-NBR                                    07620045
090200     END-EXEC.                                                    07630045
090300                                                                  07640045
090400     EVALUATE TRUE                                                07650045
090500       WHEN SQLCODE = ZEROS                                       07660045
090600            PERFORM 6400-CALL-XLKUT001                            07670045
090700       WHEN SQLCODE = +100                                        07680045
090800                SET  PS-EO-STORE-UPC-CSR TO TRUE                  07690045
090900       WHEN SQLCODE = -904                                        07700045
091000       WHEN SQLCODE = -913                                        07710045
091100       WHEN SQLCODE = -911                                        07720045
091200           MOVE 27                  TO PC240-ERROR-NBR            07730045
091300           SET PC240-SQL-ERROR      TO TRUE                       07740045
091400       WHEN SQLWARN0 NOT = SPACES                                 07750045
091500       WHEN SQLCODE NOT EQUAL ZERO                                07760045
091600           MOVE 28                  TO PC240-ERROR-NBR            07770045
091700           SET PC240-SQL-ERROR      TO TRUE                       07780045
091800     END-EVALUATE.                                                07790045
091900                                                                  07800045
092000                                                                  07810045
092100 2900-CLOSE-STORE-CSR.                                            07820045
092200                                                                  07830045
092300         EXEC SQL                                                 07840045
092400             CLOSE STORE_UPC_CSR                                  07850045
092500         END-EXEC                                                 07860045
092600                                                                  07870045
092700                                                                  07880045
092800         EVALUATE TRUE                                            07890045
092900             WHEN SQLCODE = ZERO                                  07900045
093000                 CONTINUE                                         07910045
093100             WHEN SQLWARN0 NOT = SPACES                           07920045
093200             WHEN SQLCODE < ZERO                                  07930045
093300             WHEN SQLCODE > ZERO                                  07940045
093400                MOVE 29                  TO PC240-ERROR-NBR       07950045
093500                SET PC240-SQL-ERROR      TO TRUE                  07960045
093600         END-EVALUATE.                                            07970045
093700                                                                  07980045
093800                                                                  07990045
093900 EJECT                                                            08000045
094000 3000-CARTON-STATUS-PROCESS.                                      08010045
094100     MOVE PC240-KEY-CARTON-ID         TO SUT00028-SHIPT-UNT-ID.   08020045
094200     MOVE PC240-KEY-DEST-LOC          TO DK-LOC-NBR.              08030045
094300     PERFORM 7000-PROCESS-OTBND-CRTN.                             08040045
094400                                                                  08050045
094500                                                                  08060045
094600 4000-PROCESS-EXISTNG-STORES.                                     08070045
094700                                                                  08080045
094800                                                                  08090045
094900     IF PS-POG-REF-FLAGGED                                        08100045
095000        EVALUATE TRUE                                             08110045
095100            WHEN PC240-CHECK-IN                                   08120045
095200                PERFORM 1000-CHECK-IN-PROCESS                     08130045
095300            WHEN PC240-CSEPK-SPLIT                                08140045
095400            WHEN PC240-CSEPK-SPLIT-VRTL                           08150045
095500                IF PC240-PREPK-ORDER-YES                          08160045
095600                   PERFORM 2100-PROCESS-CASE-PREPK                08170045
095700                ELSE                                              08180045
095800                   PERFORM 2000-CASEPK-PROCESS                    08190045
095900                END-IF                                            08200045
096000            WHEN PC240-SMOOTHING                                  08210045
096100                PERFORM 2600-PROCESS-SMOOTHING                    08220045
096200            WHEN PC240-SET-NAME-ONLY                              08230045
096400                PERFORM 9000-BUILD-OUTPUT                         08240045
096500            WHEN PC240-CARTON-STATUS                              08250045
096600                PERFORM 3000-CARTON-STATUS-PROCESS                08260045
096700            WHEN OTHER                                            08270045
096800                SET PC240-INVALID-ACCESS TO TRUE                  08280045
096900        END-EVALUATE                                              08290045
097000     END-IF.                                                      08300045
097100                                                                  08310045
097200 5000-PROCESS-NEW-STORES.                                         08320045
097300                                                                  08330045
097400     EVALUATE TRUE                                                08340045
097500         WHEN PC240-CHECK-IN                                      08350045
097600             IF PC240-NO-SEASONAL-SET-FOUND                       08360045
097700                SET PS-RECHECK-CORP-INIT  TO TRUE                 08370045
097800                PERFORM 1000-CHECK-IN-PROCESS                     08380045
097900             ELSE                                                 08390045
098000                SET PS-RECHECK-CORP-INIT-NO TO TRUE               08400045
098100                PERFORM 1000-CHECK-IN-PROCESS                     08410045
098600             END-IF                                               08420045
098700         WHEN PC240-CSEPK-SPLIT                                   08430045
098800         WHEN PC240-CSEPK-SPLIT-VRTL                              08440045
098900             IF PC240-PREPK-ORDER-YES                             08450045
099000                IF PC240-NO-SEASONAL-SET-FOUND                    08460045
099100                   SET PS-RECHECK-CORP-INIT  TO TRUE              08470045
099200                   PERFORM 2100-PROCESS-CASE-PREPK                08480045
099300                ELSE                                              08490045
099400                   SET PS-RECHECK-CORP-INIT-NO TO TRUE            08500045
099500                   PERFORM 2100-PROCESS-CASE-PREPK                08510045
100000                END-IF                                            08520045
100100             ELSE                                                 08530045
100200                IF PC240-NO-SEASONAL-SET-FOUND                    08540045
100300                   SET PS-RECHECK-CORP-INIT  TO TRUE              08550045
100400                   PERFORM 2000-CASEPK-PROCESS                    08560045
100500                ELSE                                              08570045
100600                   SET PS-RECHECK-CORP-INIT-NO  TO TRUE           08580045
100700                   PERFORM 2000-CASEPK-PROCESS                    08590045
101200                END-IF                                            08600045
101300             END-IF                                               08610045
101400         WHEN PC240-SMOOTHING                                     08620045
101500             PERFORM 2600-PROCESS-SMOOTHING                       08630045
101600         WHEN PC240-SET-NAME-ONLY                                 08640045
101700             SET PS-NO-POG-REF-FLAGGED TO TRUE                    08650045
101800             PERFORM 9000-BUILD-OUTPUT                            08660045
101900         WHEN PC240-CARTON-STATUS                                 08670045
102000             IF PC240-NO-SEASONAL-SET-FOUND                       08680045
102100                SET PS-RECHECK-CORP-INIT TO TRUE                  08690045
102200                PERFORM 3000-CARTON-STATUS-PROCESS                08700045
102300             ELSE                                                 08710045
102400                SET PS-RECHECK-CORP-INIT-NO  TO TRUE              08720045
102500                PERFORM 3000-CARTON-STATUS-PROCESS                08730045
103000             END-IF                                               08740045
103100         WHEN OTHER                                               08750045
103200             SET PC240-INVALID-ACCESS TO TRUE                     08760045
103300     END-EVALUATE.                                                08770045
103400                                                                  08780045
103500 6000-PROCESS-CARTON-UPC.                                         08790045
103600                                                                  08800045
103700      SET PS-NOT-EO-ITEM-UPC-CSR TO TRUE.                         08810045
103900                                                                  08820045
104000      PERFORM 6100-OPEN-ITEM-UPC-CSR.                             08830045
104100      PERFORM 6200-FETCH-ITEM-UPC-CSR                             08840045
104200        UNTIL PS-EO-ITEM-UPC-CSR.                                 08850045
104400      PERFORM 6300-CLOSE-ITEM-UPC-CSR.                            08860045
104500                                                                  08870045
104600******************************************************************08880045
104700 6100-OPEN-ITEM-UPC-CSR.                                          08890045
104800                                                                  08900045
104900         EXEC SQL                                                 08910045
105000              OPEN ITEM_UPC_CSR                                   08920045
105100         END-EXEC                                                 08930045
105200                                                                  08940045
105300                                                                  08950045
105400         EVALUATE TRUE                                            08960045
105500             WHEN SQLCODE = ZERO                                  08970045
105600                 CONTINUE                                         08980045
105700         WHEN SQLCODE = -904                                      08990045
105800         WHEN SQLCODE = -913                                      09000045
105900         WHEN SQLCODE = -911                                      09010045
106000             MOVE 9                   TO PC240-ERROR-NBR          09020045
106100             SET PC240-SQL-ERROR      TO TRUE                     09030045
106200         WHEN SQLWARN0 NOT = SPACES                               09040045
106300         WHEN SQLCODE NOT EQUAL ZERO                              09050045
106400             MOVE 10                  TO PC240-ERROR-NBR          09060045
106500             SET PC240-SQL-ERROR      TO TRUE                     09070045
106600         END-EVALUATE.                                            09080045
106700                                                                  09090045
106800 EJECT                                                            09100045
106900*----------------------------------------------------------------*09110045
107000*                                                                *09120045
107100*----------------------------------------------------------------*09130045
107200 6200-FETCH-ITEM-UPC-CSR.                                         09140045
107300                                                                  09150045
107400                                                                  09160045
107500     EXEC SQL                                                     09170045
107600        FETCH   ITEM_UPC_CSR                                      09180045
107700        INTO   :SHUUPC-UPC-NBR                                    09190045
107800     END-EXEC.                                                    09200045
107900                                                                  09210045
108000     EVALUATE TRUE                                                09220045
108100       WHEN SQLCODE = ZEROS                                       09230045
108200            PERFORM 6400-CALL-XLKUT001                            09240045
108300       WHEN SQLCODE = +100                                        09250045
108400                SET  PS-EO-ITEM-UPC-CSR  TO TRUE                  09260045
108500       WHEN SQLCODE = -904                                        09270045
108600       WHEN SQLCODE = -913                                        09280045
108700       WHEN SQLCODE = -911                                        09290045
108800           MOVE 11                  TO PC240-ERROR-NBR            09300045
108900           SET PC240-SQL-ERROR      TO TRUE                       09310045
109000       WHEN SQLWARN0 NOT = SPACES                                 09320045
109100       WHEN SQLCODE NOT EQUAL ZERO                                09330045
109200           MOVE 12                  TO PC240-ERROR-NBR            09340045
109300           SET PC240-SQL-ERROR      TO TRUE                       09350045
109400     END-EVALUATE.                                                09360045
109500                                                                  09370045
109600                                                                  09380045
109700 6300-CLOSE-ITEM-UPC-CSR.                                         09390045
109800                                                                  09400045
109900         EXEC SQL                                                 09410045
110000             CLOSE ITEM_UPC_CSR                                   09420045
110100         END-EXEC                                                 09430045
110200                                                                  09440045
110300                                                                  09450045
110400         EVALUATE TRUE                                            09460045
110500             WHEN SQLCODE = ZERO                                  09470045
110600                 CONTINUE                                         09480045
110700             WHEN SQLWARN0 NOT = SPACES                           09490045
110800             WHEN SQLCODE < ZERO                                  09500045
110900             WHEN SQLCODE > ZERO                                  09510045
111000                MOVE 13                  TO PC240-ERROR-NBR       09520045
111100                SET PC240-SQL-ERROR      TO TRUE                  09530045
111200         END-EVALUATE.                                            09540045
111300                                                                  09550045
111400                                                                  09560045
111500 EJECT                                                            09570045
111600*----------------------------------------------------------------*09580045
111700 6400-CALL-XLKUT001.                                              09590045
111800                                                                  09600045
111900     EVALUATE TRUE                                                09610045
112000        WHEN PC240-CHECK-IN                                       09620045
112100           MOVE SHUUPC-UPC-NBR              TO XLT00006-UPC-NBR   09630045
112200           PERFORM 6410-SEL-INT-UPC-BY-UPC                        09640045
112300           MOVE XLT00006-INTR-UPC-ID        TO PV-INTR-UPC-ID     09650045
112400        WHEN PC240-CARTON-STATUS                                  09660045
112500           MOVE SUT00028-UPC-NBR            TO XLT00006-UPC-NBR   09670045
112600           PERFORM 6410-SEL-INT-UPC-BY-UPC                        09680045
112700           MOVE XLT00006-INTR-UPC-ID        TO PV-INTR-UPC-ID     09690045
112800        WHEN PC240-CARTON-STATUS                                  09700045
112900        WHEN PC240-SMOOTHING                                      09710045
113000        WHEN PC240-PREPK-ORDER-YES                                09720045
113100           MOVE RECITM-ITM-NBR              TO XLT00003-ITM-NBR   09730045
113200           PERFORM 6415-SEL-INT-UPC-BY-ITM                        09740045
113300           MOVE XLT00003-INTR-UPC-ID        TO PV-INTR-UPC-ID     09750045
113400     END-EVALUATE.                                                09760045
113500*--COMMENT MOVE OUT AS PART OF POG REMOVAL                        09770045
113600*    MOVE PV-INTR-UPC-ID    TO XLT00031-INTR-UPC-ID               09780045
113700     IF PS-NO-NEW-STORE-FOUND                                     09790045
114200           SET PS-EO-ITEM-UPC-CSR                                 09800045
114300               PS-EO-PREPK-UPC-CSR                                09810045
114400               PS-EO-STORE-UPC-CSR TO TRUE                        09820045
115200     END-IF.                                                      09830045
115300******************************************************************09840045
115400                                                                  09850045
115500 6410-SEL-INT-UPC-BY-UPC.                                         09860045
115600                                                                  09870045
115700     EXEC SQL                                                     09880045
115800          SELECT DISTINCT                                         09890045
115900                 INTR_UPC_ID                                      09900045
116000            INTO :XLT00006-INTR-UPC-ID                            09910045
116100            FROM XLT_UPC                                          09920045
116200           WHERE UPC_NBR           = :XLT00006-UPC-NBR            09930045
116300     END-EXEC.                                                    09940045
116400                                                                  09950045
116500     EVALUATE TRUE                                                09960045
116600         WHEN SQLCODE = ZERO                                      09970045
116700         WHEN SQLCODE = -811                                      09980045
116800         WHEN SQLCODE = +100                                      09990045
116900             CONTINUE                                             10000045
117000         WHEN SQLCODE = -904                                      10010045
117100         WHEN SQLCODE = -913                                      10020045
117200         WHEN SQLCODE = -911                                      10030045
117300             MOVE 37                  TO PC240-ERROR-NBR          10040045
117400             SET PC240-SQL-ERROR      TO TRUE                     10050045
117500         WHEN SQLWARN0 NOT = SPACES                               10060045
117600         WHEN SQLCODE NOT EQUAL ZERO                              10070045
117700             MOVE 38                  TO PC240-ERROR-NBR          10080045
117800             SET PC240-SQL-ERROR      TO TRUE                     10090045
117900     END-EVALUATE.                                                10100045
118000                                                                  10110045
118100 6415-SEL-INT-UPC-BY-ITM.                                         10120045
118200                                                                  10130045
118300     EXEC SQL                                                     10140045
118400          SELECT DISTINCT                                         10150045
118500                 INTR_UPC_ID                                      10160045
118600            INTO :XLT00003-INTR-UPC-ID                            10170045
118700            FROM XLT_SKU                                          10180045
118800           WHERE ITM_NBR           = :XLT00003-ITM-NBR            10190045
118900     END-EXEC.                                                    10200045
119000                                                                  10210045
119100     EVALUATE TRUE                                                10220045
119200         WHEN SQLCODE = ZERO                                      10230045
119300         WHEN SQLCODE = -811                                      10240045
119400         WHEN SQLCODE = +100                                      10250045
119500             CONTINUE                                             10260045
119600         WHEN SQLCODE = -904                                      10270045
119700         WHEN SQLCODE = -913                                      10280045
119800         WHEN SQLCODE = -911                                      10290045
119900             MOVE 39                  TO PC240-ERROR-NBR          10300045
120000             SET PC240-SQL-ERROR      TO TRUE                     10310045
120100         WHEN SQLWARN0 NOT = SPACES                               10320045
120200         WHEN SQLCODE NOT EQUAL ZERO                              10330045
120300             MOVE 40                  TO PC240-ERROR-NBR          10340045
120400             SET PC240-SQL-ERROR      TO TRUE                     10350045
120500     END-EVALUATE.                                                10360045
120600                                                                  10370045
148500 7000-PROCESS-OTBND-CRTN.                                         10380045
148600                                                                  10390045
148700      SET PS-NOT-EO-OTBND-UPC-CSR  TO TRUE.                       10400045
149000                                                                  10410045
149100      PERFORM 7100-OPEN-OTBND-UPC-CSR.                            10420045
149200      PERFORM 7200-FETCH-OTBND-UPC-CSR                            10430045
149300        UNTIL PS-EO-OTBND-UPC-CSR.                                10440045
149600      PERFORM 7300-CLOSE-OTBND-UPC-CSR.                           10450045
149700                                                                  10460045
149800******************************************************************10470045
149900 7100-OPEN-OTBND-UPC-CSR.                                         10480045
150000                                                                  10490045
150100         EXEC SQL                                                 10500045
150200              OPEN ITEM_UPC_CSR_OTBND                             10510045
150300         END-EXEC                                                 10520045
150400                                                                  10530045
150500                                                                  10540045
150600         EVALUATE TRUE                                            10550045
150700             WHEN SQLCODE = ZERO                                  10560045
150800                 CONTINUE                                         10570045
150900         WHEN SQLCODE = -904                                      10580045
151000         WHEN SQLCODE = -913                                      10590045
151100         WHEN SQLCODE = -911                                      10600045
151200             MOVE 20                  TO PC240-ERROR-NBR          10610045
151300             SET PC240-SQL-ERROR      TO TRUE                     10620045
151400         WHEN SQLWARN0 NOT = SPACES                               10630045
151500         WHEN SQLCODE NOT EQUAL ZERO                              10640045
151600             MOVE 21                  TO PC240-ERROR-NBR          10650045
151700             SET PC240-SQL-ERROR      TO TRUE                     10660045
151800         END-EVALUATE.                                            10670045
151900                                                                  10680045
152000 EJECT                                                            10690045
152100*----------------------------------------------------------------*10700045
152200*                                                                *10710045
152300*----------------------------------------------------------------*10720045
152400 7200-FETCH-OTBND-UPC-CSR.                                        10730045
152500                                                                  10740045
152600                                                                  10750045
152700     EXEC SQL                                                     10760045
152800        FETCH   ITEM_UPC_CSR_OTBND                                10770045
152900        INTO   :SUT00028-UPC-NBR                                  10780045
153000     END-EXEC.                                                    10790045
153100                                                                  10800045
153200     EVALUATE TRUE                                                10810045
153300       WHEN SQLCODE = ZEROS                                       10820045
153400            PERFORM 6400-CALL-XLKUT001                            10830045
153500       WHEN SQLCODE = +100                                        10840045
153600                SET  PS-EO-OTBND-UPC-CSR TO TRUE                  10850045
153700       WHEN SQLCODE = -904                                        10860045
153800       WHEN SQLCODE = -913                                        10870045
153900       WHEN SQLCODE = -911                                        10880045
154000           MOVE 22                  TO PC240-ERROR-NBR            10890045
154100           SET PC240-SQL-ERROR      TO TRUE                       10900045
154200       WHEN SQLWARN0 NOT = SPACES                                 10910045
154300       WHEN SQLCODE NOT EQUAL ZERO                                10920045
154400           MOVE 23                  TO PC240-ERROR-NBR            10930045
154500           SET PC240-SQL-ERROR      TO TRUE                       10940045
154600     END-EVALUATE.                                                10950045
154700                                                                  10960045
154800                                                                  10970045
154900 7300-CLOSE-OTBND-UPC-CSR.                                        10980045
155000                                                                  10990045
155100         EXEC SQL                                                 11000045
155200             CLOSE ITEM_UPC_CSR_OTBND                             11010045
155300         END-EXEC                                                 11020045
155400                                                                  11030045
155500                                                                  11040045
155600         EVALUATE TRUE                                            11050045
155700             WHEN SQLCODE = ZERO                                  11060045
155800                 CONTINUE                                         11070045
155900             WHEN SQLWARN0 NOT = SPACES                           11080045
156000             WHEN SQLCODE < ZERO                                  11090045
156100             WHEN SQLCODE > ZERO                                  11100045
156200                MOVE 24                  TO PC240-ERROR-NBR       11110045
156300                SET PC240-SQL-ERROR      TO TRUE                  11120045
156400         END-EVALUATE.                                            11130045
156500/                                                                 11140045
156600 7350-PROCESS-EC-REPURP-DVT.                                      11150045
156700                                                                  11160045
156800     EVALUATE TRUE                                                11170045
156900       WHEN PC240-CHECK-IN                                        11180045
157000           PERFORM 7352-COUNT                                     11190045
157100       WHEN PC240-SMOOTHING                                       11200045
157200           PERFORM 7353-COUNT                                     11210045
157300       WHEN PC240-CSEPK-SPLIT                                     11220045
157400       WHEN PC240-CSEPK-SPLIT-VRTL                                11230045
157500           IF ( PC240-PREPK-ORDER-YES )                           11240045
157600               PERFORM 7354-COUNT                                 11250045
157700               IF PS-MULT-SKU-YES                                 11260045
157800                  SET PC240-SEASONAL-SET-FOUND TO TRUE            11270045
157900               END-IF                                             11280045
158000           END-IF                                                 11290045
158100       WHEN PC240-CARTON-STATUS                                   11300045
158200           PERFORM 7355-COUNT                                     11310045
158300     END-EVALUATE.                                                11320045
158400/                                                                 11330045
158500 7352-COUNT.                                                      11340045
158600                                                                  11350045
158700     EXEC SQL                                                     11360045
158800         SELECT COUNT(UPC_NBR)                                    11370045
158900           INTO :PV-MULTI-SKU-COUNT                               11380045
159000           FROM TSHUUPC                                           11390045
159100          WHERE SHIPT_UNT_ID = :PC240-KEY-CARTON-ID               11400045
159200     END-EXEC.                                                    11410045
159300                                                                  11420045
159400     EVALUATE TRUE                                                11430045
159500         WHEN SQLCODE = ZERO                                      11440045
159600             IF ( PV-MULTI-SKU-COUNT > +1 )                       11450045
159700                 SET PS-MULT-SKU-YES TO TRUE                      11460045
159800             END-IF                                               11470045
159900         WHEN OTHER                                               11480045
160000             MOVE 46                  TO PC240-ERROR-NBR          11490045
160100             SET PC240-SQL-ERROR      TO TRUE                     11500045
160200     END-EVALUATE.                                                11510045
160300/                                                                 11520045
160400 7353-COUNT.                                                      11530045
160500                                                                  11540045
160600     EXEC SQL                                                     11550045
160700         SELECT COUNT(A.ITM_NBR)                                  11560045
160800           INTO :PV-MULTI-SKU-COUNT                               11570045
160900           FROM TRECITM A                                         11580045
161000              , TRECDIS B                                         11590045
161100          WHERE A.ORD_NBR        = B.ORD_NBR                      11600045
161200            AND A.REC_SEQ_NBR    = B.REC_SEQ_NBR                  11610045
161300            AND A.ORD_NBR        = :PURCHS-PO-NBR                 11620045
161400            AND A.REC_SEQ_NBR    = :PC240-KEY-REC-SEQ-NBR         11630045
161500            AND A.ORD_LNE_NBR    = B.ORD_LNE_NBR                  11640045
161600            AND B.STR_NBR        = :PC240-KEY-DEST-LOC            11650045
161700            AND A.VER_STATUS_CDE = 'A'                            11660045
161800     END-EXEC.                                                    11670046
162000                                                                  11690045
162100     EVALUATE TRUE                                                11700045
162200         WHEN SQLCODE = ZERO                                      11710045
162300             IF ( PV-MULTI-SKU-COUNT > +1 )                       11720045
162400                 SET PS-MULT-SKU-YES TO TRUE                      11730045
162500             END-IF                                               11740045
162600         WHEN OTHER                                               11750045
162700             MOVE 47                  TO PC240-ERROR-NBR          11760045
162800             SET PC240-SQL-ERROR      TO TRUE                     11770045
162900     END-EVALUATE.                                                11780045
163000/                                                                 11790045
163100 7354-COUNT.                                                      11800045
163200                                                                  11810045
163300     EXEC SQL                                                     11820045
163400         SELECT COUNT(A.ITM_NBR)                                  11830045
163500           INTO :PV-MULTI-SKU-COUNT                               11840045
163600           FROM TRECITM A                                         11850045
163700              , TRECDIS B                                         11860045
163800          WHERE A.ORD_NBR        = B.ORD_NBR                      11870045
163900            AND A.REC_SEQ_NBR    = B.REC_SEQ_NBR                  11880045
164000            AND A.ORD_NBR        = :PURCHS-PO-NBR                 11890045
164100            AND A.REC_SEQ_NBR    = :PC240-KEY-REC-SEQ-NBR         11900045
164200            AND A.ORD_LNE_NBR    = B.ORD_LNE_NBR                  11910045
164300            AND B.STR_NBR        = :PC240-KEY-DEST-LOC            11920045
164400            AND A.PREPK_ID       = :PC240-KEY-PREPK-ID            11930045
164500            AND A.VER_STATUS_CDE = 'A'                            11940045
164700     END-EXEC.                                                    11960045
164800                                                                  11970045
164900     EVALUATE TRUE                                                11980045
165000         WHEN SQLCODE = ZERO                                      11990045
165100             IF ( PV-MULTI-SKU-COUNT > +1 )                       12000045
165200                 SET PS-MULT-SKU-YES TO TRUE                      12010045
165300             END-IF                                               12020045
165400         WHEN OTHER                                               12030045
165500             MOVE 48                  TO PC240-ERROR-NBR          12040045
165600             SET PC240-SQL-ERROR      TO TRUE                     12050045
165700     END-EVALUATE.                                                12060045
165800/                                                                 12070045
165900 7355-COUNT.                                                      12080045
166000                                                                  12090045
166100     EXEC SQL                                                     12100045
166200         SELECT COUNT(UPC_NBR)                                    12110045
166300           INTO :PV-MULTI-SKU-COUNT                               12120045
166400           FROM SUT_OTBND_UPC                                     12130045
166500          WHERE SHIPT_UNT_ID = :PC240-KEY-CARTON-ID               12140045
166600     END-EXEC.                                                    12150045
166700                                                                  12160045
166800     EVALUATE TRUE                                                12170045
166900         WHEN SQLCODE = ZERO                                      12180045
167000             IF ( PV-MULTI-SKU-COUNT > +1 )                       12190045
167100                 SET PS-MULT-SKU-YES TO TRUE                      12200045
167200             END-IF                                               12210045
167300         WHEN OTHER                                               12220045
167400             MOVE 48                  TO PC240-ERROR-NBR          12230045
167500             SET PC240-SQL-ERROR      TO TRUE                     12240045
167600     END-EVALUATE.                                                12250045
167700/                                                                 12260045
167800 7400-ECOMM-STORE-DIVERT-PARM.                                    12270045
167900                                                                  12280045
168000     MOVE SPACES TO KRPRPM-FUNC-TXT.                              12290045
168100     MOVE +0     TO KRPRPM-FUNC-QTY.                              12300045
168200                                                                  12310045
168300     EXEC SQL                                                     12320045
168400        SELECT FUNC_TXT                                           12330045
168500              ,FUNC_QTY                                           12340045
168600          INTO :KRPRPM-FUNC-TXT                                   12350045
168700              ,:KRPRPM-FUNC-QTY                                   12360045
168800          FROM TKRPRPM                                            12370045
168900         WHERE SYS_PRC_FUNC_CDE  = 'ECSKDT'                       12380045
169000           AND FUNC_PRC_STAT_CDE = 'AC'                           12390045
169100           AND CURRENT TIMESTAMP > FUNC_BEG_TMST                  12400045
169200     END-EXEC.                                                    12410045
169300                                                                  12420045
169400     EVALUATE TRUE                                                12430045
169500         WHEN SQLCODE = ZERO                                      12440045
169600             MOVE KRPRPM-FUNC-QTY TO SEASET-DIVERT-PFX-NBR        12450045
169700             MOVE KRPRPM-FUNC-TXT TO SEASET-SEASET-SHRT-NM        12460045
169800                                     SEASET-SEASET-NM             12470045
169900         WHEN SQLCODE = +100                                      12480045
170000             MOVE +0              TO SEASET-DIVERT-PFX-NBR        12490045
170100             MOVE SPACES          TO SEASET-SEASET-SHRT-NM        12500045
170200                                     SEASET-SEASET-NM             12510045
170300         WHEN OTHER                                               12520045
170400             MOVE 45                  TO PC240-ERROR-NBR          12530045
170500             SET PC240-SQL-ERROR      TO TRUE                     12540045
170600     END-EVALUATE.                                                12550045
170700/                                                                 12560045
170800 9000-BUILD-OUTPUT.                                               12570045
170900                                                                  12580045
171000     IF  PS-EFC-FREIGHT-FOR-DC-YES                                12590045
171100         CONTINUE                                                 12600045
171200     ELSE                                                         12610045
171300         IF ( XLT00010-LOC-TYP-CDE = 'DS' ) AND                   12620045
171400            ( XLT00010-E-BUS-IND   = 'Y' )                        12630045
171500             SET PS-MULT-SKU-NO TO TRUE                           12640045
171600             PERFORM 7350-PROCESS-EC-REPURP-DVT                   12650045
171700             IF ( PS-MULT-SKU-YES )                               12660045
171800                 PERFORM 7400-ECOMM-STORE-DIVERT-PARM             12670045
172000             ELSE                                                 12680045
172100                MOVE ZEROES TO SEASET-DIVERT-PFX-NBR              12690045
172200             END-IF                                               12700045
172300         END-IF                                                   12710045
172400     END-IF.                                                      12720045
172500                                                                  12730045
172600*                                                                 12740045
172800*** IF SEASONAL SET IF PART OF A RED SEASONAL SET                 12750045
172900*** MEANING IT IS FOR EFC FREIGHT THAT WILL BE PROCESSED AND      12760045
173000*** FULFILLED FROM A RETAIL DC - IF THE STORE DESTINATION IS      12770045
173100*** AN E-STORE THEN USE THE SET DIVERT CODE                       12780045
173200*** IF THE DESTINATION IS A RETAIL STORE - MOVE 0 TO THE DIVERT   12790045
173300*** THIS WILL ALLOW THE EFC FREIGHT TO ROUTE TO A SPECIAL HOLDING 12800045
173400*** AREA IN THE DC FOR FULFILLMENT.                               12810045
173500*** THIS WILL ALSO ALLOW FOR THE FREIGHT FOR A RETAIL STORE TO BE 12820045
173600*** SENT TO THE STORE TRAILER IN SHIPPING.                        12830045
173700*                                                                 12840045
173800***  DISPLAY IS ONLY FOR TESTING                                  12850045
173900***  DISPLAY  ' PCKUT025 SWITCH:'                                 12860045
174000***                     PS-EFC-FREIGHT-FOR-DC-SW                  12870045
174100***           '  TYPE:' XLT00010-LOC-TYP-CDE                      12880045
174200***           '  EBUS:' XLT00010-E-BUS-IND.                       12890045
174300                                                                  12900045
174400     IF  PS-EFC-FREIGHT-FOR-DC-YES         AND                    12910045
174500         XLT00010-LOC-TYP-CDE     = 'DS'   AND                    12920045
174600         NOT XLT00010-E-BUS-IND   = 'Y'                           12930045
174700         MOVE ZEROES TO SEASET-DIVERT-PFX-NBR                     12940045
174800     END-IF.                                                      12950045
174900*                                                                 12960045
175100*                                                                 12970045
175200     IF  XLT00010-LOC-TYP-CDE    = 'CS'                           12980045
175300         MOVE ZEROES TO SEASET-DIVERT-PFX-NBR                     12990045
175400     END-IF                                                       13000045
175500                                                                  13010045
175600     MOVE SPACES                 TO PC240-FIXT-ID                 13020045
175700     IF PS-NO-NEW-STORE-FOUND                                     13030045
175800        PERFORM 9005-BUILD-FROM-SEASET                            13040045
175900     ELSE                                                         13050045
176000        PERFORM 9010-BUILD-SEASET-NEW-STR                         13060045
176100     END-IF.                                                      13070045
176200                                                                  13080045
176300 9005-BUILD-FROM-SEASET.                                          13090045
176400                                                                  13100045
177700          MOVE SPACES                TO PC240-FIXT-ID             13110045
177900                                                                  13120045
178000     IF PC240-SMOOTHING                                           13130045
178100        MOVE SPACES                     TO PC240-FIXT-ID          13140045
178200     END-IF                                                       13150045
178300                                                                  13160045
178400     MOVE SEASET-SEASET-SHRT-NM       TO PC240-SEASET-SHRT-NM     13170045
178500     MOVE SEASET-SEASET-NM            TO PC240-SEASET-NM          13180045
178600                                                                  13190045
178700     MOVE SEASET-SEASET-YR            TO PC240-SEASET-YR          13200045
178800     MOVE SEASET-SEASET-TYP-CDE       TO PC240-SEASET-TYP-CDE     13210045
178900     MOVE SEASET-SEASET-STAT-CDE      TO PC240-SEASET-STAT-CDE    13220045
179000     MOVE SEASET-STR-STUP-BEG-DTE     TO PC240-STR-STUP-BEG-DTE   13230045
179100     MOVE SEASET-STR-STUP-END-DTE     TO PC240-STR-STUP-END-DTE   13240045
179200     MOVE SEASET-STR-RLSE-BEG-DTE     TO PC240-STR-RLSE-BEG-DTE   13250045
179300     MOVE SEASET-STR-RLSE-END-DTE     TO PC240-STR-RLSE-END-DTE   13260045
179400     MOVE SEASET-LAST-UPD-BY-USR-ID   TO PC240-LAST-UPD-BY-USR-ID 13270045
179500     MOVE SEASET-LAST-UPD-TMST        TO PC240-LAST-UPD-TMST      13280045
179600     MOVE SEASET-DIVERT-PFX-NBR       TO PC240-DIVERT-PFX-NBR     13290045
179700     MOVE SEASET-POG-SEASET-YR        TO PC240-POG-SEASET-YR      13300045
179800     MOVE SEASET-POG-SEASET-SHRT-NM   TO PC240-POG-SEASET-SHRT-NM 13310045
179900     MOVE SEASET-POG-SEASET-IND       TO PC240-POG-SEASET-IND.    13320045
180000                                                                  13330045
180100 9010-BUILD-SEASET-NEW-STR.                                       13340045
182200                                                                  13350045
182500         MOVE SPACES        TO PC240-FIXT-ID                      13360045
183300                                                                  13370045
184200     IF PC240-SMOOTHING                                           13380045
184300        MOVE SPACES                     TO PC240-FIXT-ID          13390045
184400     END-IF                                                       13400045
184500                                                                  13410045
184600     MOVE SEASET-SEASET-SHRT-NM       TO PC240-SEASET-SHRT-NM     13420045
184700     MOVE SEASET-SEASET-NM            TO PC240-SEASET-NM          13430045
184800                                                                  13440045
184900     MOVE SEASET-SEASET-YR            TO PC240-SEASET-YR          13450045
185000     MOVE SEASET-SEASET-TYP-CDE       TO PC240-SEASET-TYP-CDE     13460045
185100     MOVE SEASET-SEASET-STAT-CDE      TO PC240-SEASET-STAT-CDE    13470045
185200     MOVE SEASET-STR-STUP-BEG-DTE     TO PC240-STR-STUP-BEG-DTE   13480045
185300     MOVE SEASET-STR-STUP-END-DTE     TO PC240-STR-STUP-END-DTE   13490045
185400     MOVE SEASET-STR-RLSE-BEG-DTE     TO PC240-STR-RLSE-BEG-DTE   13500045
185500     MOVE SEASET-STR-RLSE-END-DTE     TO PC240-STR-RLSE-END-DTE   13510045
185600     MOVE SEASET-LAST-UPD-BY-USR-ID   TO PC240-LAST-UPD-BY-USR-ID 13520045
185700     MOVE SEASET-LAST-UPD-TMST        TO PC240-LAST-UPD-TMST      13530045
185800     MOVE SEASET-DIVERT-PFX-NBR       TO PC240-DIVERT-PFX-NBR     13540045
185900     MOVE SEASET-POG-SEASET-YR        TO PC240-POG-SEASET-YR      13550045
186000     MOVE SEASET-POG-SEASET-SHRT-NM   TO PC240-POG-SEASET-SHRT-NM 13560045
186100     MOVE SEASET-POG-SEASET-IND       TO PC240-POG-SEASET-IND.    13570045
