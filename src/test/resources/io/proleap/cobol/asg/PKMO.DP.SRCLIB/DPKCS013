000100*                                                                 00010002
000200 IDENTIFICATION DIVISION.                                         00020003
000300*                                                                 00030003
000400 PROGRAM-ID.    DPKCS013.                                         00040003
000500*                                                                 00050003
000600 AUTHOR.        CALVIN BUSH.                                      00060003
000700 INSTALLATION.  KOHL'S DEPARTMENT STORES.                         00070003
000800 DATE-WRITTEN.  JULY, 1990.                                       00080003
000900 DATE-COMPILED.                                                   00090003
001000******************************************************************00100003
001100**  THIS PROGRAM IS THE COMMON CICS ABEND PROCESSOR.            **00110003
001200**                                                              **00120003
001300**  07/11/91  -  DO NOT DELETE THE TS QUEUES IF WE PLAN ON      **00130003
001400**               RETURNING TO THE CALLING TRANSACTION           **00140003
001500**                                                              **00150003
001600**               MADE BY: DAN FRANKLIN                          **00160003
001700**                                                              **00170003
001800**  12/09/92  -  DO NOT CHECK FOR ESCAPE SECURITY ON LINK-      **00180003
001900**               RETURN CALLS.  INCLUDED TS-QUEUE LOGIC ADDED   **00190003
002000**               BY DAN ON 7/11/91.  PARAGRAPHS:0000-ABEND-MAIN **00200003
002100**               LINE AND 7000-CHECK-ESCAPE-SECURITY.           **00210003
002200**               MADE BY: CAL BUSH                              **00220003
002300**  01/21/93  -  CHANGE COPYBOOK DPWS030 TO DPWS026 - NAME      **00230003
002400**               CHANGE ONLY.                                   **00240003
002500**               MADE BY: CAL BUSH                              **00250003
002600**  10/06/93  -  ADD LOGIC FOR OBJECT LOCKING.                    00260003
002700**               MADE BY: CAL BUSH                              **00270003
002800**  03/06/96  -  ADD LOGIC FOR CICS24X7 PROCESSING.             **00280003
002900**               CLEAN-UP ALL RECORDS ASSOCIATED WITH A TERMINAL**00290003
003000**               (IN THE KSDS SAVED COMMAREA VSAM FILE) WHEN A  **00300003
003100**               TRANSACTION ON THAT TERMINAL ABENDS.           **00310003
003200**               MADE BY: CHERI MASTEL                          **00320003
      **  12/22/03  -  MADE CHANGES FOR EXPANDING LOCATION FROM 3 TO  **00321014
      **               5 DIGITS.                                      **00322014
003300******************************************************************00330003
003400     EJECT                                                        00340003
003500 ENVIRONMENT DIVISION.                                            00350003
003600*                                                                 00360003
003700 DATA DIVISION.                                                   00370003
003800*                                                                 00380003
003900 WORKING-STORAGE SECTION.                                         00390003
004000*                                                                 00400003
004100 01  FD-FILE-DDNAME-AREA.                                         00410003
004200     05  FD-SAVED-COMMAREA-FILE  PIC X(8)     VALUE 'DPSAVCMK'.   00420003
004300*                                                                 00430003
004400 01  PC-PROGRAM-CONSTANTS.                                        00440003
004500     05  PC-ESCAPE-TRAN          PIC  X(04)  VALUE 'Z026'.        00450003
004600     05  PC-LOGOFF-TRAN          PIC  X(04)  VALUE 'Z011'.        00460003
004700     05  PC-ABEND-TRAN           PIC  X(04)  VALUE 'Z013'.        00470003
004800     05  PC-NAVIGATOR-TRAN       PIC  X(04)  VALUE 'Z008'.        00480003
004900     05  PC-LOGON-TRAN           PIC  X(04)  VALUE 'Z028'.        00490003
005000     05  PC-CURRENT-PROGRAM-NAME PIC  X(08)  VALUE 'DPKCS013'.    00500003
005100     05  PC-NAVIGATOR-PROGRAM    PIC  X(08)  VALUE 'DPKCS008'.    00510003
005200     05  PC-NAVIGATOR-COMMAREA   PIC  X(08)  VALUE 'ABENDED '.    00520003
005300     05  PC-OBJLOK-BASE-DD       PIC  X(08)  VALUE 'DPOBJLOK'.    00530003
005400     05  PC-OBJLOK-AIX-TASK-DD   PIC  X(08)  VALUE 'DPOBJLK1'.    00540003
005500     05  PC-NAVIGATOR-LENGTH     PIC S9(04)  VALUE +8             00550003
005600                                             COMP.                00560003
005700     05  PC-LOG-TABLE-MAX        PIC S9(04)  VALUE +52            00570003
005800                                             COMP.                00580003
005900     05  PC-STRING-POINTER-MAX   PIC S9(04)  VALUE +60            00590003
006000                                             COMP.                00600003
006100     05  PC-SSA-MAX              PIC S9(04)  VALUE +5             00610003
006200                                             COMP.                00620003
006300     05  PC-MAX-APPL-QUEUE-SEQ   PIC S9(04)  VALUE +5             00630003
006400                                             COMP.                00640003
006500     05  PC-DSECT-MAX            PIC S9(04)  VALUE +21            00650003
006600                                             COMP.                00660003
006700     05  PC-LOG-QUEUE-RESOURCE   PIC  X(04)  VALUE 'CSSL'.        00670003
006800     05  PC-LOG-QUEUE            PIC  X(04)  VALUE 'CSSL'.        00680003
006900     05  PC-MAP-NAME             PIC  X(08)  VALUE 'DP013A  '.    00690003
007000     05  PC-MAPSET-NAME          PIC  X(08)  VALUE 'DPKM013 '.    00700003
007100     05  PC-ESCAPE-FUNCTION      PIC  X(08)  VALUE 'ESCAPE  '.    00710003
007110     05  PC-SYS-CONSOLE          PIC  X(01)  VALUE X'02'.         00711008
007130     05  PC-NUM-ROUTES           PIC S9(09)  VALUE +1             00713004
007140                                             COMP.                00714004
007200     05  PC-NETNAME-LENGTH       PIC S9(04)  VALUE +8             00720003
007300                                             COMP.                00730003
007400*                                                                 00740003
007500 01  PV-PROGRAM-VARIABLES.                                        00750003
007600     05  PV-MSG-SUB              PIC S9(04)  VALUE +0             00760003
007700                                              COMP SYNC.          00770003
007800     05  PV-STRING-POINTER       PIC S9(04)  VALUE +1             00780003
007900                                              COMP SYNC.          00790003
008000     05  PV-SSA-SUB              PIC S9(04)  VALUE +0             00800003
008100                                              COMP SYNC.          00810003
008200     05  PV-TS-ITEM              PIC S9(04)  VALUE +1             00820003
008300                                              COMP SYNC.          00830003
008400     05  PV-NUMBER-LOG-LINES     PIC S9(04)  VALUE +0             00840003
008500                                              COMP SYNC.          00850003
008600     05  PV-CICS-RESPONSE        PIC S9(08)  VALUE +0             00860003
008700                                              COMP SYNC.          00870003
008800     05  PV-CICS-KEYLENGTH       PIC S9(04)  VALUE +0             00880003
008900                                             COMP SYNC.           00890003
009000     05  PV-MAP-LENGTH           PIC S9(04)  VALUE +0             00900003
009100                                              COMP SYNC.          00910003
009200     05  PV-PRT-TASK-NBR         PIC  9(07)   VALUE ZERO.         00920003
009300     05  PV-TRAN-ID              PIC  X(04)  VALUE SPACES.        00930003
009400     05  PV-NAVIGATOR-SYSID      PIC  X(04)  VALUE SPACES.        00940003
009500     05  PV-SYSID                PIC  X(04)  VALUE SPACES.        00950003
009510     05  PV-APPLID.                                               00951009
009520         10  FILLER              PIC  X(04)  VALUE SPACE.         00952010
009530         10  PV-APPLID-PROD-IND  PIC  X(01)  VALUE SPACE.         00953010
009531             88  PV-APPLID-PROD              VALUE 'P'.           00953109
009540         10  FILLER              PIC  X(03)  VALUE SPACE.         00954010
009600     05  PV-LOG-LINE.                                             00960003
009700         10  FILLER              PIC  X(22)  VALUE                00970003
009800             '*** ERROR ON TERMINAL '.                            00980003
009900         10  PV-LOG-TERMINAL     PIC  X(04)  VALUE SPACE.         00990003
010000         10  FILLER              PIC  X(06)  VALUE ' ===> '.      01000003
010100         10  PV-LOG-DATA         PIC  X(79)  VALUE SPACE.         01010003
010200     05  PV-NETNAME-DELETE-NUMREC                                 01020003
010300                                 PIC S9(04)   VALUE +0            01030003
010400                                              COMP SYNC.          01040003
010500*                                PIC  9(07)   VALUE ZERO.         01050003
010600*                                                                 01060003
010700     05  PV-UNPACK-NUMERIC       PIC 9(4)    VALUE ZERO.          01070012
010800     05  PV-DISPLAY-LINE-2.                                       01080003
010900         10  FILLER.                                              01090003
011000             15  FILLER          PIC  X(04)  VALUE 'KEY='.        01100012
011100             15  PV-DISPLAY-KEY  PIC  X(15)  VALUE SPACE.         01110012
011200             15  FILLER          PIC  X(01)  VALUE ','.           01120012
011300         10  FILLER.                                              01130003
011400             15  PV-DISPLAY-FIELD2-HDR                            01140003
011500                                 PIC  X(07)  VALUE SPACE.         01150012
011600             15  PV-DISPLAY-FIELD2                                01160003
011700                                 PIC  X(04)  VALUE SPACE.         01170012
011800             15  FILLER          PIC  X(01)  VALUE ','.           01180012
011900         10  FILLER.                                              01190003
012000             15  PV-DISPLAY-FIELD3-HDR                            01200003
012100                                 PIC  X(07)  VALUE SPACE.         01210012
012200             15  PV-DISPLAY-FIELD3                                01220003
012300                                 PIC  X(04)  VALUE SPACE.         01230012
           05  PV-LOCATION-X           PIC  X(05)  VALUE SPACES.        01231013
           05  PV-LOCATION-9  REDEFINES  PV-LOCATION-X                  01232013
                                       PIC  9(05).                      01233013
012400*                                                                 01240003
012500     05  TS-INFO-QUEUE-NAME.                                      01250003
012600         10  TS-INFO-QUEUE-TERMINAL                               01260003
012700                                 PIC X(04)   VALUE SPACE.         01270003
012800         10  FILLER              PIC X(04)   VALUE 'INFO'.        01280003
012900                                                                  01290003
013000     05  TS-APPL-MULT-QUEUE-ID.                                   01300003
013100         10  TS-APPL-MULT-QUEUE-TERM                              01310003
013200                                 PIC X(04)   VALUE SPACE.         01320003
013300         10  TS-APPL-MULT-QUEUE-TASK                              01330003
013400                                 PIC S9(5)   VALUE +0 COMP-3.     01340003
013500         10  TS-APPL-MULT-QUEUE-SEQ                               01350003
013600                                 PIC 9(01)   VALUE ZERO.          01360003
013700                                                                  01370003
013800 01  TS-TEMP-STORAGE-QUEU-INFO.                                   01380003
013900     05  TS-APPL-QUEUE-NAME.                                      01390003
014000         10  TS-APPL-QUEUE-TERMINAL                               01400003
014100                                 PIC  X(04)  VALUE SPACE.         01410003
014200         10  TS-APPL-QUEUE-TASK  PIC S9(07)  VALUE ZERO           01420003
014300                                             COMP-3.              01430003
014400*                                                                 01440003
014500 01  PS-PROGRAM-SWITCHES.                                         01450003
014600     05  PS-LOG-OVERFLOW-SW      PIC  X(01)  VALUE 'N'.           01460003
014700         88  PS-LOG-OVERFLOW                 VALUE 'Y'.           01470003
014710 01  OT-OPERATOR-TEXT.                                            01471003
014720         10  FILLER              PIC  X(10)  VALUE 'KTS700W - '.  01472003
014730         10  OT-APPLID           PIC  X(08)  VALUE SPACE.         01473003
014740         10  FILLER              PIC  X(03)  VALUE ' - '.         01474003
014750         10  OT-TRANID           PIC  X(04)  VALUE SPACE.         01475003
014760         10  FILLER              PIC  X(03)  VALUE ' - '.         01476003
014770         10  OT-PROGRAM          PIC  X(08)  VALUE SPACE.         01477003
014780         10  FILLER              PIC  X(22)  VALUE                01478003
014790             ' - TRANSACTION ABENDED'.                            01479003
014800*                                                                 01480003
014900 01  ST-SYSTEM-TIME-AREA.                                         01490003
015000     05  ST-ABSTIME              PIC S9(16)  VALUE ZERO           01500003
015100                                             COMP SYNC.           01510003
015200     05  ST-DATE.                                                 01520003
015300         10  ST-MONTH            PIC S9(08)  VALUE ZERO           01530003
015400                                             COMP.                01540003
015500         10  ST-DAY              PIC S9(08)  VALUE ZERO           01550003
015600                                             COMP.                01560003
015700         10  ST-YEAR             PIC S9(08)  VALUE ZERO           01570003
015800                                             COMP.                01580003
015900     05  ST-DISPLAY-DATE.                                         01590003
016000         10  ST-DISPLAY-MONTH    PIC  9(02)  VALUE ZERO.          01600003
016100         10  FILLER              PIC  X(01)  VALUE '/'.           01610003
016200         10  ST-DISPLAY-DAY      PIC  9(02)  VALUE ZERO.          01620003
016300         10  FILLER              PIC  X(01)  VALUE '/'.           01630003
016400         10  ST-DISPLAY-YEAR     PIC  9(04)  VALUE ZERO.          01640003
016500*                                                                 01650003
016600 01  NVL-COMMAREA-NOT-VALID-LINES.                                01660003
016700     05  NVL-NO-COMMAREA-LINE.                                    01670003
016800         10  FILLER              PIC  X(07)  VALUE SPACE.         01680003
016900         10  FILLER              PIC  X(46)  VALUE                01690003
017000             'NO COMMUNICATIONS AREA WAS PASSED TO THE ABEND'.    01700003
017100         10  FILLER              PIC  X(19)  VALUE                01710003
017200             ' PROCESSING PROGRAM'.                               01720003
017300         10  FILLER              PIC  X(07)  VALUE SPACE.         01730003
017400     05  NVL-BAD-COMMAREA-LINE.                                   01740003
017500         10  FILLER              PIC  X(03)  VALUE SPACE.         01750003
017600         10  FILLER              PIC  X(45)  VALUE                01760003
017700             'AN INVALID COMMUNICATIONS AREA WAS PASSED TO '.     01770003
017800         10  FILLER              PIC  X(28)  VALUE                01780003
017900             'THE ABEND PROCESSING PROGRAM'.                      01790003
018000         10  FILLER              PIC  X(03)  VALUE SPACE.         01800003
018100     05  NVL-EIB-WARNING.                                         01810003
018200         10  FILLER              PIC  X(10)  VALUE SPACE.         01820003
018300         10  FILLER              PIC  X(45)  VALUE                01830003
018400             'EIB FROM ABEND PROCESSING PROGRAM; NOT EIB AT'.     01840003
018500         10  FILLER              PIC  X(14)  VALUE                01850003
018600             ' TIME OF ERROR'.                                    01860003
018700         10  FILLER              PIC  X(10)  VALUE SPACE.         01870003
018800*                                                                 01880003
018900 01  OM-SCREEN-OVERFLOW-MSG.                                      01890003
019000     10  FILLER                  PIC  X(11)  VALUE SPACE.         01900003
019100     10  FILLER                  PIC  X(42)  VALUE                01910003
019200         '** PLEASE SEE THE CICS LOG FOR MORE ABEND '.            01920003
019300     10  FILLER                  PIC  X(14)  VALUE                01930003
019400         'INFORMATION **'.                                        01940003
019500     10  FILLER                  PIC  X(12)  VALUE SPACE.         01950003
019600*                                                                 01960003
019700**   FOLLOWING IS THE LAYOUT FOR THE DL/I INTERFACE BLOCK         01970003
019800**   USED IN PROCESSING A COMMAND-LEVEL IMS ABEND TYPE.           01980003
019900*                                                                 01990003
020000 01  DM-DLZDIB-MASK.                                              02000003
020100     05  DM-DIB-VERSION          PIC  X(02)  VALUE SPACE.         02010003
020200     05  DM-DIB-STATUS           PIC  X(02)  VALUE SPACE.         02020003
020300     05  DM-DIB-SEGMENT          PIC  X(08)  VALUE SPACE.         02030003
020400     05  DM-DIB-FIL01            PIC  X(01)  VALUE SPACE.         02040003
020500     05  DM-DIB-FIL02            PIC  X(01)  VALUE SPACE.         02050003
020600     05  DM-DIB-SEGMENT-LEVEL    PIC  X(02)  VALUE SPACE.         02060003
020700     05  DM-DIB-FEEDBACK-LENGTH  PIC S9(04)  VALUE ZERO           02070003
020800                                             COMP.                02080003
020900     05  DM-DIB-FIL03            PIC  X(06)  VALUE SPACE.         02090003
021000*                                                                 02100003
021100**   FOLLOWING IS THE LAYOUT FOR THE EXEC INTERFACE BLOCK         02110003
021200**   USED IN PROCESSING A THE EIB AREA PASSED BY THE CALLING      02120003
021300**   PROGRAM.                                                     02130003
021400*                                                                 02140003
021500 01  EIBM-EIBLK-MASK.                                             02150003
021600     05  EIBM-TIME         PIC S9(07)  VALUE ZERO                 02160003
021700                                       COMP-3.                    02170003
021800     05  EIBM-DATE         PIC S9(07)  VALUE ZERO                 02180003
021900                                       COMP-3.                    02190003
022000     05  EIBM-TRNID        PIC  X(04)  VALUE SPACE.               02200003
022100     05  EIBM-TASKN        PIC S9(07)  VALUE ZERO                 02210003
022200                                       COMP-3.                    02220003
022300     05  EIBM-TRMID        PIC  X(04)  VALUE SPACE.               02230003
022400     05  FILLER            PIC S9(04)  VALUE ZERO                 02240003
022500                                       COMP.                      02250003
022600     05  EIBM-CPOSN        PIC S9(04)  VALUE ZERO                 02260003
022700                                       COMP.                      02270003
022800     05  EIBM-CALEN        PIC S9(04)  VALUE ZERO                 02280003
022900                                       COMP.                      02290003
023000     05  EIBM-AID          PIC  X(01)  VALUE SPACE.               02300003
023100     05  EIBM-FN           PIC  X(02)  VALUE SPACE.               02310003
023200     05  EIBM-RCODE        PIC  X(06)  VALUE SPACE.               02320003
023300     05  EIBM-DS           PIC  X(08)  VALUE SPACE.               02330003
023400     05  EIBM-REQID        PIC  X(08)  VALUE SPACE.               02340003
023500     05  EIBM-RSRCE        PIC  X(08)  VALUE SPACE.               02350003
023600     05  EIBM-SYNC         PIC  X(01)  VALUE SPACE.               02360003
023700     05  EIBM-FREE         PIC  X(01)  VALUE SPACE.               02370003
023800     05  EIBM-RECV         PIC  X(01)  VALUE SPACE.               02380003
023900     05  EIBM-SEND         PIC  X(01)  VALUE SPACE.               02390003
024000     05  EIBM-ATT          PIC  X(01)  VALUE SPACE.               02400003
024100     05  EIBM-EOC          PIC  X(01)  VALUE SPACE.               02410003
024200     05  EIBM-FMH          PIC  X(01)  VALUE SPACE.               02420003
024300     05  EIBM-COMPL        PIC  X(01)  VALUE SPACE.               02430003
024400     05  EIBM-SIG          PIC  X(01)  VALUE SPACE.               02440003
024500     05  EIBM-CONF         PIC  X(01)  VALUE SPACE.               02450003
024600     05  EIBM-ERR          PIC  X(01)  VALUE SPACE.               02460003
024700     05  EIBM-ERRCD        PIC  X(04)  VALUE SPACE.               02470003
024800     05  EIBM-SYNRB        PIC  X(01)  VALUE SPACE.               02480003
024900     05  EIBM-NODAT        PIC  X(01)  VALUE SPACE.               02490003
025000     05  EIBM-RESP         PIC S9(08)  VALUE ZERO                 02500003
025100                                       COMP.                      02510003
025200     05  EIBM-RESP2        PIC S9(08)  VALUE ZERO                 02520003
025300                                       COMP.                      02530003
025400     05  EIBM-RLDBK        PIC  X(01)  VALUE SPACE.               02540003
025500*                                                                 02550003
025600 01  FDB-FORMAT-DB2-ERROR-FIELDS.                                 02560003
025700     05  FDB-MAX-MESSAGE-LINES     PIC S9(04)  VALUE +12          02570003
025800                                               COMP SYNC.         02580003
025900     05  FDB-ERROR-LINE-LENGTH     PIC S9(09)  VALUE +75          02590003
026000                                               COMP SYNC.         02600003
026100     05  FDB-FORMATTED-MESSAGE.                                   02610003
026200         10  FILLER                PIC S9(04)  VALUE +900         02620003
026300                                               COMP SYNC.         02630003
026400         10  FDB-MESSAGE-LINE      OCCURS 12 TIMES                02640003
026500                                   INDEXED BY FDB-MSG-IDX         02650003
026600                                   PIC  X(75).                    02660003
026700*                                                                 02670003
026800 01  FPCB-FORMAT-PCB.                                             02680003
026900     05  FPCB-DBNAME          PIC  X(08)  VALUE SPACE.            02690003
027000     05  FPCB-LEVEL-NUMBER    PIC  X(02)  VALUE SPACE.            02700003
027100     05  FPCB-STATUS-CODE     PIC  X(02)  VALUE SPACE.            02710003
027200     05  FPCB-PROC-OPTION     PIC  X(04)  VALUE SPACE.            02720003
027300     05  FPCB-JCL-ADDRESS     PIC  X(04)  VALUE SPACE.            02730003
027400     05  FPCB-SEGMENT-NAME    PIC  X(08)  VALUE SPACE.            02740003
027500     05  FPCB-KEY-LENGTH      PIC S9(05)  VALUE ZERO              02750003
027600                                          COMP.                   02760003
027700     05  FPCB-NUMBER-SEGS     PIC S9(05)  VALUE ZERO              02770003
027800                                          COMP.                   02780003
027900     05  FPCB-KEY-FEEDBACK    PIC  X(60)  VALUE ZERO.             02790003
028000*                                                                 02800003
028100 01  LT-LOG-LINE-TABLE.                                           02810003
028200     05  LT-LOG-LINE             OCCURS 52 TIMES                  02820003
028300                                 INDEXED BY LT-IDX.               02830003
028400         10  LT-ERROR-MESSAGE    PIC  X(79).                      02840003
028500*                                                                 02850003
028600**   PREFORMATTED LINES COMMON TO ALL ABEND TYPES                 02860003
028700*                                                                 02870003
028800 01  AL1-ABEND-LINE-1.                                            02880003
028900     05  FILLER                  PIC  X(12)  VALUE 'PROGRAM...: '.02890003
029000     05  AL1-PROGRAM             PIC  X(08)  VALUE SPACE.         02900003
029100     05  FILLER                  PIC  X(04)  VALUE SPACE.         02910003
029200     05  FILLER                  PIC  X(11)  VALUE 'PARAGRAPH: '. 02920003
029300     05  AL1-PARAGRAPH           PIC  X(30)  VALUE SPACE.         02930003
029400     05  FILLER                  PIC  X(14)  VALUE SPACE.         02940003
029500 01  AL2-ABEND-LINE-2.                                            02950003
029600     05  FILLER                  PIC  X(12)  VALUE 'USERID....: '.02960003
029700     05  AL2-USERID              PIC  X(08)  VALUE SPACE.         02970003
029800     05  FILLER                  PIC  X(06)  VALUE SPACE.         02980003
029900     05  FILLER                  PIC  X(09)  VALUE 'NETNAME: '.   02990003
030000     05  AL2-NETNAME             PIC  X(08)  VALUE SPACE.         03000003
030100     05  FILLER                  PIC  X(02)  VALUE SPACE.         03010003
030200     05  FILLER                  PIC  X(10)  VALUE 'LOCATION: '.  03020003
030300     05  AL2-LOCATION            PIC  X(05)  VALUE SPACE.         03030012
030400     05  FILLER                  PIC  X(19)  VALUE SPACE.         03040012
030500 01  AL3-ABEND-LINE-3.                                            03050003
030600     05  FILLER                  PIC  X(12)  VALUE                03060003
030700                                             'ABEND TYPE: '.      03070003
030800     05  AL3-ABEND-TYPE          PIC  X(01)  VALUE SPACE.         03080003
030900     05  FILLER                  PIC  X(07)  VALUE SPACE.         03090003
031000     05  FILLER                  PIC  X(15)  VALUE                03100003
031100                                             'ABEND CONTROL: '.   03110003
031200     05  AL3-ABEND-CONTROL       PIC  X(01)  VALUE SPACE.         03120003
031300     05  FILLER                  PIC  X(09)  VALUE SPACE.         03130003
031400     05  FILLER                  PIC  X(10)  VALUE                03140003
031500                                             'ROLLBACK: '.        03150003
031600     05  AL3-ROLLBACK            PIC  X(01)  VALUE SPACE.         03160003
031700     05  FILLER                  PIC  X(23)  VALUE SPACE.         03170003
031800 01  AL4-ABEND-LINE-4.                                            03180003
031900     05  FILLER                  PIC  X(11)  VALUE                03190003
032000                                             'MESSAGE...:'.       03200003
032100     05  FILLER                  PIC  X(68)  VALUE SPACE.         03210003
032200*                                                                 03220003
032300**   PREFORMATTED LINES FOR A CICS ABEND TYPE                     03230003
032400*                                                                 03240003
032500 01  CL1-CICS-LINE-1.                                             03250003
032600     05  FILLER                  PIC  X(15)  VALUE SPACE.         03260003
032700     05  FILLER                  PIC  X(48)  VALUE                03270003
032800         'THERE WAS AN ERROR ENCOUNTERED IN A CICS COMMAND'.      03280003
032900     05  FILLER                  PIC  X(16)  VALUE SPACE.         03290003
033000*                                                                 03300003
033100**   PREFORMATTED LINES FOR A DB2 ABEND TYPE                      03310003
033200*                                                                 03320003
033300 01  DL1-DB2-LINE-1.                                              03330003
033400     05  FILLER                  PIC  X(16)  VALUE SPACE.         03340003
033500     05  FILLER                  PIC  X(47)  VALUE                03350003
033600         'THERE WAS AN ERROR ENCOUNTERED IN A DB2 COMMAND'.       03360003
033700     05  FILLER                  PIC  X(16)  VALUE SPACE.         03370003
033800 01  DL2-DB2-LINE-2.                                              03380003
033900     05  FILLER                  PIC  X(43)  VALUE                03390003
034000         'THE FOLLOWING DB2 TABLE(S) MAY BE INVOLVED:'.           03400003
034100     05  FILLER                  PIC  X(36)  VALUE SPACE.         03410003
034200*                                                                 03420003
034300**   PREFORMATTED LINES FOR THE EIB AREA                          03430003
034400*                                                                 03440003
034500 01  EL1-EIB-LINE-1.                                              03450003
034600     05  FILLER                  PIC  X(28)  VALUE                03460003
034700         'EIB INFORMATION FOLLOWS:'.                              03470003
034800     05  FILLER                  PIC  X(51)  VALUE SPACE.         03480003
034900 01  EL2-EIB-LINE-2.                                              03490003
035000     05  FILLER                  PIC  X(02)  VALUE SPACE.         03500003
035100     05  FILLER                  PIC  X(10)  VALUE 'EIBTIME.: '.  03510003
035200     05  EL2-EIBTIME             PIC  9(07)+ VALUE ZERO.          03520003
035300     05  FILLER                  PIC  X(20)  VALUE SPACE.         03530003
035400     05  FILLER                  PIC  X(10)  VALUE 'EIBDATE.: '.  03540003
035500     05  EL2-EIBDATE             PIC  9(07)+ VALUE ZERO.          03550003
035600     05  FILLER                  PIC  X(21)  VALUE SPACE.         03560003
035700 01  EL3-EIB-LINE-3.                                              03570003
035800     05  FILLER                  PIC  X(02)  VALUE SPACE.         03580003
035900     05  FILLER                  PIC  X(10)  VALUE 'EIBTRNID: '.  03590003
036000     05  EL3-EIBTRNID            PIC  X(04)  VALUE SPACE.         03600003
036100     05  FILLER                  PIC  X(24)  VALUE SPACE.         03610003
036200     05  FILLER                  PIC  X(10)  VALUE 'EIBTASKN: '.  03620003
036300     05  EL3-EIBTASKN            PIC  9(07)+ VALUE ZERO.          03630003
036400     05  FILLER                  PIC  X(21)  VALUE SPACE.         03640003
036500 01  EL4-EIB-LINE-4.                                              03650003
036600     05  FILLER                  PIC  X(02)  VALUE SPACE.         03660003
036700     05  FILLER                  PIC  X(10)  VALUE 'EIBTRMID: '.  03670003
036800     05  EL4-EIBTRMID            PIC  X(04)  VALUE SPACE.         03680003
036900     05  FILLER                  PIC  X(24)  VALUE SPACE.         03690003
037000     05  FILLER                  PIC  X(10)  VALUE 'EIBCPOSN: '.  03700003
037100     05  EL4-EIBCPOSN            PIC  9(04)+ VALUE ZERO.          03710003
037200     05  FILLER                  PIC  X(24)  VALUE SPACE.         03720003
037300 01  EL5-EIB-LINE-5.                                              03730003
037400     05  FILLER                  PIC  X(02)  VALUE SPACE.         03740003
037500     05  FILLER                  PIC  X(10)  VALUE 'EIBCALEN: '.  03750003
037600     05  EL5-EIBCALEN            PIC  9(05)  VALUE ZERO.          03760003
037700     05  FILLER                  PIC  X(23)  VALUE SPACE.         03770003
037800     05  FILLER                  PIC  X(10)  VALUE 'EIBAID..: '.  03780003
037900     05  EL5-EIBAID              PIC  X(01)  VALUE SPACE.         03790003
038000     05  FILLER                  PIC  X(02)  VALUE ' ('.          03800003
038100     05  EL5-EIBAID-DESCRIPTION  PIC  X(05)  VALUE SPACE.         03810003
038200     05  FILLER                  PIC  X(01)  VALUE ')'.           03820003
038300     05  FILLER                  PIC  X(30)  VALUE SPACE.         03830003
038400 01  EL6-EIB-LINE-6.                                              03840003
038500     05  FILLER                  PIC  X(02)  VALUE SPACE.         03850003
038600     05  FILLER                  PIC  X(12)  VALUE                03860003
038700                                             'EIBFN...: X'''.     03870003
038800     05  EL6-EIBFN-HEX           PIC  X(04)  VALUE SPACE.         03880003
038900     05  FILLER                  PIC  X(01)  VALUE ''''.          03890003
039000     05  FILLER                  PIC  X(21)  VALUE SPACE.         03900003
039100     05  FILLER                  PIC  X(11)  VALUE                03910003
039200                                             'EIBRCODE:X'''.      03920003
039300     05  EL6-EIBRCODE-HEX        PIC  X(12)  VALUE SPACE.         03930003
039400     05  FILLER                  PIC  X(01)  VALUE ''''.          03940003
039500     05  FILLER                  PIC  X(15)  VALUE SPACE.         03950003
039600 01  EL7-EIB-LINE-7.                                              03960003
039700     05  FILLER                  PIC  X(02)  VALUE SPACE.         03970003
039800     05  FILLER                  PIC  X(10)  VALUE 'EIBRESP.: '.  03980003
039900     05  EL7-EIBRESP             PIC  9(08)  VALUE ZERO.          03990003
040000     05  FILLER                  PIC  X(02)  VALUE ' ('.          04000003
040100     05  EL7-EIBRESP-DESCRIPTION PIC  X(12)  VALUE SPACE.         04010003
040200     05  FILLER                  PIC  X(01)  VALUE ')'.           04020003
040300     05  FILLER                  PIC  X(05)  VALUE SPACE.         04030003
040400     05  FILLER                  PIC  X(10)  VALUE 'EIBRESP2: '.  04040003
040500     05  EL7-EIBRESP2            PIC  9(08)+ VALUE ZERO.          04050003
040600     05  FILLER                  PIC  X(20)  VALUE SPACE.         04060003
040700 01  EL8-EIB-LINE-8.                                              04070003
040800     05  FILLER                  PIC  X(02)  VALUE SPACE.         04080003
040900     05  FILLER                  PIC  X(10)  VALUE 'EIBDS...: '.  04090003
041000     05  EL8-EIBDS               PIC  X(08)  VALUE SPACE.         04100003
041100     05  FILLER                  PIC  X(20)  VALUE SPACE.         04110003
041200     05  FILLER                  PIC  X(10)  VALUE 'EIBREQID: '.  04120003
041300     05  EL8-EIBREQID-HEX        PIC  X(08)  VALUE SPACE.         04130003
041400     05  FILLER                  PIC  X(21)  VALUE SPACE.         04140003
041500 01  EL9-EIB-LINE-9.                                              04150003
041600     05  FILLER                  PIC  X(02)  VALUE SPACE.         04160003
041700     05  FILLER                  PIC  X(12)  VALUE                04170003
041800                                             'EIBRSRCE: X'''.     04180003
041900     05  EL9-EIBRSRCE-HEX        PIC  X(16)  VALUE SPACE.         04190003
042000     05  FILLER                  PIC  X(01)  VALUE ''''.          04200003
042100     05  FILLER                  PIC  X(09)  VALUE SPACE.         04210003
042200     05  FILLER                  PIC  X(12)  VALUE                04220003
042300                                             'EIBEOC..: X'''.     04230003
042400     05  EL9-EIBEOC-HEX          PIC  X(02)  VALUE SPACE.         04240003
042500     05  FILLER                  PIC  X(01)  VALUE ''''.          04250003
042600     05  FILLER                  PIC  X(24)  VALUE SPACE.         04260003
042700 01  EL10-EIB-LINE-10.                                            04270003
042800     05  FILLER                  PIC  X(02)  VALUE SPACE.         04280003
042900     05  FILLER                  PIC  X(12)  VALUE                04290003
043000                                             'EIBFREE.: X'''.     04300003
043100     05  EL10-EIBFREE-HEX        PIC  X(02)  VALUE SPACE.         04310003
043200     05  FILLER                  PIC  X(01)  VALUE ''''.          04320003
043300     05  FILLER                  PIC  X(23)  VALUE SPACE.         04330003
043400     05  FILLER                  PIC  X(12)  VALUE                04340003
043500                                             'EIBRECV.: X'''.     04350003
043600     05  EL10-EIBRECV-HEX        PIC  X(02)  VALUE SPACE.         04360003
043700     05  FILLER                  PIC  X(01)  VALUE ''''.          04370003
043800     05  FILLER                  PIC  X(24)  VALUE SPACE.         04380003
043900 01  EL11-EIB-LINE-11.                                            04390003
044000     05  FILLER                  PIC  X(02)  VALUE SPACE.         04400003
044100     05  FILLER                  PIC  X(12)  VALUE                04410003
044200                                             'EIBATT..: X'''.     04420003
044300     05  EL11-EIBATT-HEX         PIC  X(02)  VALUE SPACE.         04430003
044400     05  FILLER                  PIC  X(01)  VALUE ''''.          04440003
044500     05  FILLER                  PIC  X(23)  VALUE SPACE.         04450003
044600     05  FILLER                  PIC  X(12)  VALUE                04460003
044700                                             'EIBSYNC.: X'''.     04470003
044800     05  EL11-EIBSYNC-HEX        PIC  X(02)  VALUE SPACE.         04480003
044900     05  FILLER                  PIC  X(01)  VALUE ''''.          04490003
045000     05  FILLER                  PIC  X(24)  VALUE SPACE.         04500003
045100 01  EL12-EIB-LINE-12.                                            04510003
045200     05  FILLER                  PIC  X(02)  VALUE SPACE.         04520003
045300     05  FILLER                  PIC  X(12)  VALUE                04530003
045400                                             'EIBFMH..: X'''.     04540003
045500     05  EL12-EIBFMH-HEX         PIC  X(02)  VALUE SPACE.         04550003
045600     05  FILLER                  PIC  X(01)  VALUE ''''.          04560003
045700     05  FILLER                  PIC  X(23)  VALUE SPACE.         04570003
045800     05  FILLER                  PIC  X(12)  VALUE                04580003
045900                                             'EIBCOMPL: X'''.     04590003
046000     05  EL12-EIBCOMPL-HEX       PIC  X(02)  VALUE SPACE.         04600003
046100     05  FILLER                  PIC  X(01)  VALUE ''''.          04610003
046200     05  FILLER                  PIC  X(24)  VALUE SPACE.         04620003
046300 01  EL13-EIB-LINE-13.                                            04630003
046400     05  FILLER                  PIC  X(02)  VALUE SPACE.         04640003
046500     05  FILLER                  PIC  X(12)  VALUE                04650003
046600                                             'EIBSIG..: X'''.     04660003
046700     05  EL13-EIBSIG-HEX         PIC  X(02)  VALUE SPACE.         04670003
046800     05  FILLER                  PIC  X(01)  VALUE ''''.          04680003
046900     05  FILLER                  PIC  X(23)  VALUE SPACE.         04690003
047000     05  FILLER                  PIC  X(12)  VALUE                04700003
047100                                             'EIBCONF.: X'''.     04710003
047200     05  EL13-EIBCONF-HEX        PIC  X(02)  VALUE SPACE.         04720003
047300     05  FILLER                  PIC  X(01)  VALUE ''''.          04730003
047400     05  FILLER                  PIC  X(24)  VALUE SPACE.         04740003
047500 01  EL14-EIB-LINE-14.                                            04750003
047600     05  FILLER                  PIC  X(02)  VALUE SPACE.         04760003
047700     05  FILLER                  PIC  X(12)  VALUE                04770003
047800                                             'EIBERR..: X'''.     04780003
047900     05  EL14-EIBERR-HEX         PIC  X(02)  VALUE SPACE.         04790003
048000     05  FILLER                  PIC  X(01)  VALUE ''''.          04800003
048100     05  FILLER                  PIC  X(23)  VALUE SPACE.         04810003
048200     05  FILLER                  PIC  X(12)  VALUE                04820003
048300                                             'EIBERRCD: X'''.     04830003
048400     05  EL14-EIBERRCD-HEX       PIC  X(08)  VALUE SPACE.         04840003
048500     05  FILLER                  PIC  X(01)  VALUE ''''.          04850003
048600     05  FILLER                  PIC  X(18)  VALUE SPACE.         04860003
048700 01  EL15-EIB-LINE-15.                                            04870003
048800     05  FILLER                  PIC  X(02)  VALUE SPACE.         04880003
048900     05  FILLER                  PIC  X(12)  VALUE                04890003
049000                                             'EIBSYNRB: X'''.     04900003
049100     05  EL15-EIBSYNRB-HEX       PIC  X(02)  VALUE SPACE.         04910003
049200     05  FILLER                  PIC  X(01)  VALUE ''''.          04920003
049300     05  FILLER                  PIC  X(23)  VALUE SPACE.         04930003
049400     05  FILLER                  PIC  X(12)  VALUE                04940003
049500                                             'EIBNODAT: X'''.     04950003
049600     05  EL15-EIBNODAT-HEX       PIC  X(02)  VALUE SPACE.         04960003
049700     05  FILLER                  PIC  X(01)  VALUE ''''.          04970003
049800     05  FILLER                  PIC  X(24)  VALUE SPACE.         04980003
049900*                                                                 04990003
050000**   PREFORMATTED LINES FOR A CALL-LEVEL IMS ABEND TYPE           05000003
050100*                                                                 05010003
050200 01  IL1-IMS-CALL-LINE-1.                                         05020003
050300     05  FILLER                  PIC  X(12)  VALUE SPACE.         05030003
050400     05  FILLER                  PIC  X(54)  VALUE                05040003
050500         'THERE WAS AN ERROR ENCOUNTERED IN A CALL-LEVEL IMS I/O'.05050003
050600     05  FILLER                  PIC  X(13)  VALUE SPACE.         05060003
050700 01  IL2-IMS-CALL-LINE-2.                                         05070003
050800     05  FILLER                  PIC  X(10)  VALUE 'FUNCTION: '.  05080003
050900     05  IL2-FUNCTION            PIC  X(04)  VALUE SPACE.         05090003
051000     05  FILLER                  PIC  X(10)  VALUE '  STATUS: '.  05100003
051100     05  IL2-STATUS              PIC  X(02)  VALUE SPACE.         05110003
051200     05  FILLER                  PIC  X(12)  VALUE '  DATABASE: '.05120003
051300     05  IL2-DATABASE            PIC  X(08)  VALUE SPACE.         05130003
051400     05  FILLER                  PIC  X(11)  VALUE '  SEGMENT: '. 05140003
051500     05  IL2-SEGMENT             PIC  X(08)  VALUE SPACE.         05150003
051600     05  FILLER                  PIC  X(09)  VALUE '  LEVEL: '.   05160003
051700     05  IL2-LEVEL               PIC  X(02)  VALUE SPACE.         05170003
051800     05  FILLER                  PIC  X(03)  VALUE SPACE.         05180003
051900 01  IL3-IMS-CALL-LINE-3.                                         05190003
052000     05  FILLER                  PIC  X(10)  VALUE 'PROC OPT: '.  05200003
052100     05  IL3-PROC-OPT            PIC  X(04)  VALUE SPACE.         05210003
052200     05  FILLER                  PIC  X(24)  VALUE                05220003
052300                                 '   KEY FEEDBACK LENGTH: '.      05230003
052400     05  IL3-FEEDBACK-LENGTH     PIC  ZZZZ9  VALUE ZERO.          05240003
052500     05  FILLER                  PIC  X(31)  VALUE                05250003
052600         '   NUMBER OF KEYS IN FEEDBACK: '.                       05260003
052700     05  IL3-FEEDBACK-KEYS       PIC  ZZZZ9  VALUE ZERO.          05270003
052800 01  IL4-IMS-CALL-LINE-4.                                         05280003
052900     05  FILLER                  PIC  X(14)  VALUE                05290003
053000                                             'KEY FEEDBACK: '.    05300003
053100     05  IL4-KEY-FEEDBACK        PIC  X(60)  VALUE SPACE.         05310003
053200     05  FILLER                  PIC  X(15)  VALUE SPACE.         05320003
053300 01  IL5-IMS-CALL-LINE-5.                                         05330003
053400     05  IL5-SSA-LITERAL         PIC  X(14)  VALUE                05340003
053500                                             '       SSA''S: '.   05350003
053600     05  IL5-SSA                 PIC  X(50)  VALUE SPACE.         05360003
053700     05  FILLER                  PIC  X(05)  VALUE SPACE.         05370003
053800*                                                                 05380003
053900**   PREFORMATTED LINES FOR A LOGIC ABEND TYPE                    05390003
054000*                                                                 05400003
054100 01  LL1-LOGIC-LINE-1.                                            05410003
054200     05  FILLER                  PIC  X(25)  VALUE SPACE.         05420003
054300     05  FILLER                  PIC  X(29)  VALUE                05430003
054400         'A LOGIC ERROR WAS ENCOUNTERED'.                         05440003
054500     05  FILLER                  PIC  X(25)  VALUE SPACE.         05450003
054600*                                                                 05460003
054700**   PREFORMATTED LINES FOR A SECURITY ABEND TYPE                 05470003
054800*                                                                 05480003
054900 01  SL1-SECURITY-LINE-1.                                         05490003
055000     05  FILLER                  PIC  X(11)  VALUE SPACE.         05500003
055100     05  FILLER                  PIC  X(47)  VALUE                05510003
055200         'THERE WAS AN ERROR ENCOUNTERED IN THE SECURITY '.       05520003
055300     05  FILLER                  PIC  X(10)  VALUE 'SUBROUTINE'.  05530003
055400     05  FILLER                  PIC  X(11)  VALUE SPACE.         05540003
055500 01  SL2-SECURITY-LINE-2.                                         05550003
055600     05  FILLER                  PIC  X(15)  VALUE                05560003
055700                                             'RESOURCE TYPE: '.   05570003
055800     05  SL2-RESOURCE-TYPE       PIC  X(01)  VALUE SPACE.         05580003
055900     05  FILLER                  PIC  X(04)  VALUE SPACE.         05590003
056000     05  FILLER                  PIC  X(15)  VALUE                05600003
056100                                             'RESOURCE NAME: '.   05610003
056200     05  SL2-RESOURCE-NAME       PIC  X(08)  VALUE SPACE.         05620003
056300     05  FILLER                  PIC  X(03)  VALUE SPACE.         05630003
056400     05  FILLER                  PIC  X(12)  VALUE 'ERROR CODE: '.05640003
056500     05  SL2-ERROR-CODE          PIC  ZZZ9+  VALUE ZERO.          05650003
056600     05  FILLER                  PIC  X(16)  VALUE SPACE.         05660003
056700 01  SL3-SECURITY-LINE-3.                                         05670003
056800     05  FILLER                  PIC  X(15)  VALUE                05680003
056900                                             '  ACCESS TYPE: '.   05690003
057000     05  SL3-ACCESS-TYPE         PIC  X(01)  VALUE SPACE.         05700003
057100     05  FILLER                  PIC  X(19)  VALUE                05710003
057200                                 '   ACCESS ALLOWED: '.           05720003
057300     05  SL3-ACCESS-ALLOWED      PIC  X(01)  VALUE SPACE.         05730003
057400     05  FILLER                  PIC  X(43)  VALUE SPACE.         05740003
057500*                                                                 05750003
057600**   PREFORMATTED LINES FOR AN UNDEFINED ABEND TYPE               05760003
057700*                                                                 05770003
057800 01  UL1-UNDEFINED-LINE-1.                                        05780003
057900     05  FILLER                  PIC  X(19)  VALUE SPACE.         05790003
058000     05  FILLER                  PIC  X(40)  VALUE                05800003
058100         'THERE WAS AN UNDEFINED ERROR ENCOUNTERED'.              05810003
058200     05  FILLER                  PIC  X(20)  VALUE SPACE.         05820003
058300*                                                                 05830003
058400**   PREFORMATTED LINES FOR A COMMAND-LEVEL IMS ABEND TYPE        05840003
058500*                                                                 05850003
058600 01  XL1-IMS-EXEC-LINE-1.                                         05860003
058700     05  FILLER                  PIC  X(11)  VALUE SPACE.         05870003
058800     05  FILLER                  PIC  X(49)  VALUE                05880003
058900         'THERE WAS AN ERROR ENCOUNTERED IN A COMMAND-LEVEL'.     05890003
059000     05  FILLER                  PIC  X(08)  VALUE ' IMS I/O'.    05900003
059100     05  FILLER                  PIC  X(11)  VALUE SPACE.         05910003
059200 01  XL2-IMS-EXEC-LINE-2.                                         05920003
059300     05  FILLER                  PIC  X(09)  VALUE 'VERSION: '.   05930003
059400     05  XL2-VERSION             PIC  X(02)  VALUE SPACE.         05940003
059500     05  FILLER                  PIC  X(12)  VALUE '  FUNCTION: '.05950003
059600     05  XL2-FUNCTION            PIC  X(04)  VALUE SPACE.         05960003
059700     05  FILLER                  PIC  X(10)  VALUE '  STATUS: '.  05970003
059800     05  XL2-STATUS              PIC  X(02)  VALUE SPACE.         05980003
059900     05  FILLER                  PIC  X(11)  VALUE '  SEGMENT: '. 05990003
060000     05  XL2-SEGMENT             PIC  X(08)  VALUE SPACE.         06000003
060100     05  FILLER                  PIC  X(09)  VALUE '  LEVEL: '.   06010003
060200     05  XL2-LEVEL               PIC  X(02)  VALUE SPACE.         06020003
060300     05  FILLER                  PIC  X(10)  VALUE SPACE.         06030003
060400 01  XL3-IMS-EXEC-LINE-3.                                         06040003
060500     05  FILLER                  PIC  X(21)  VALUE                06050003
060600         'KEY FEEDBACK LENGTH: '.                                 06060003
060700     05  XL3-FEEDBACK-LENGTH     PIC  ZZZZ9  VALUE ZERO.          06070003
060800     05  FILLER                  PIC  X(53)  VALUE SPACE.         06080003
060900 01  XL4-IMS-EXEC-LINE-4.                                         06090003
061000     05  FILLER                  PIC  X(14)  VALUE                06100003
061100                                             'KEY FEEDBACK: '.    06110003
061200     05  XL4-KEY-FEEDBACK        PIC  X(60)  VALUE SPACE.         06120003
061300     05  FILLER                  PIC  X(05)  VALUE SPACE.         06130003
061400*                                                                 06140003
061500** ATTENTION IDENTIFIER DESCRIPTION TABLE                         06150003
061600*                                                                 06160003
061700 01  AC-AID-CONVERSION-TABLE.                                     06170003
061800     05  AC-ATTENTION-ID-ENTRIES.                                 06180003
061900         10  FILLER              PIC  X(06)  VALUE ' NULL '.      06190003
062000         10  FILLER              PIC  X(06)  VALUE '''ENTER'.     06200003
062100         10  FILLER              PIC  X(06)  VALUE '_CLEAR'.      06210003
062200         10  FILLER              PIC  X(06)  VALUE 'CLRP '.      06220003
062300         10  FILLER              PIC  X(06)  VALUE '=PEN  '.      06230003
062400         10  FILLER              PIC  X(06)  VALUE 'WOPID '.      06240003
062500         10  FILLER              PIC  X(06)  VALUE 'XMSRE '.      06250003
062600         10  FILLER              PIC  X(06)  VALUE 'HSTRF '.      06260003
062700         10  FILLER              PIC  X(06)  VALUE '"TRIG '.      06270003
062800         10  FILLER              PIC  X(06)  VALUE '%PA1  '.      06280003
062900         10  FILLER              PIC  X(06)  VALUE '>PA2  '.      06290003
063000         10  FILLER              PIC  X(06)  VALUE ',PA3  '.      06300003
063100         10  FILLER              PIC  X(06)  VALUE '1PF1  '.      06310003
063200         10  FILLER              PIC  X(06)  VALUE '2PF2  '.      06320003
063300         10  FILLER              PIC  X(06)  VALUE '3PF3  '.      06330003
063400         10  FILLER              PIC  X(06)  VALUE '4PF4  '.      06340003
063500         10  FILLER              PIC  X(06)  VALUE '5PF5  '.      06350003
063600         10  FILLER              PIC  X(06)  VALUE '6PF6  '.      06360003
063700         10  FILLER              PIC  X(06)  VALUE '7PF7  '.      06370003
063800         10  FILLER              PIC  X(06)  VALUE '8PF8  '.      06380003
063900         10  FILLER              PIC  X(06)  VALUE '9PF9  '.      06390003
064000         10  FILLER              PIC  X(06)  VALUE ':PF10 '.      06400003
064100         10  FILLER              PIC  X(06)  VALUE '#PF11 '.      06410003
064200         10  FILLER              PIC  X(06)  VALUE '@PF12 '.      06420003
064300         10  FILLER              PIC  X(06)  VALUE 'APF13 '.      06430003
064400         10  FILLER              PIC  X(06)  VALUE 'BPF14 '.      06440003
064500         10  FILLER              PIC  X(06)  VALUE 'CPF15 '.      06450003
064600         10  FILLER              PIC  X(06)  VALUE 'DPF16 '.      06460003
064700         10  FILLER              PIC  X(06)  VALUE 'EPF17 '.      06470003
064800         10  FILLER              PIC  X(06)  VALUE 'FPF18 '.      06480003
064900         10  FILLER              PIC  X(06)  VALUE 'GPF19 '.      06490003
065000         10  FILLER              PIC  X(06)  VALUE 'HPF20 '.      06500003
065100         10  FILLER              PIC  X(06)  VALUE 'IPF21 '.      06510003
065200         10  FILLER              PIC  X(06)  VALUE 'PF22 '.      06520003
065300         10  FILLER              PIC  X(06)  VALUE '.PF23 '.      06530003
065400         10  FILLER              PIC  X(06)  VALUE '<PF24 '.      06540003
065500     05  AC-ATTENTION-ID-ENTRY   REDEFINES                        06550003
065600                                 AC-ATTENTION-ID-ENTRIES          06560003
065700                                 OCCURS 36 TIMES                  06570003
065800                                 INDEXED BY AC-AID-IDX.           06580003
065900         10  AC-EIBAID           PIC  X(01).                      06590003
066000         10  AC-AID-NAME         PIC  X(05).                      06600003
066100*                                                                 06610003
066200** EIBRESP DESCRIPTION TABLE                                      06620003
066300*                                                                 06630003
066400 01  EC-EIBRESP-CONVERSION-TABLE.                                 06640003
066500     05  EC-EIBRESP-ENTRIES.                                      06650003
066600         10  FILLER              PIC S9(08)  VALUE +00            06660003
066700                                             COMP.                06670003
066800         10  FILLER              PIC  X(12)  VALUE 'NORMAL      '.06680003
066900         10  FILLER              PIC S9(08)  VALUE +01            06690003
067000                                             COMP.                06700003
067100         10  FILLER              PIC  X(12)  VALUE 'ERROR       '.06710003
067200         10  FILLER              PIC S9(08)  VALUE +02            06720003
067300                                             COMP.                06730003
067400         10  FILLER              PIC  X(12)  VALUE 'RDATT       '.06740003
067500         10  FILLER              PIC S9(08)  VALUE +03            06750003
067600                                             COMP.                06760003
067700         10  FILLER              PIC  X(12)  VALUE 'WRBRK       '.06770003
067800         10  FILLER              PIC S9(08)  VALUE +04            06780003
067900                                             COMP.                06790003
068000         10  FILLER              PIC  X(12)  VALUE 'EOF         '.06800003
068100         10  FILLER              PIC S9(08)  VALUE +05            06810003
068200                                             COMP.                06820003
068300         10  FILLER              PIC  X(12)  VALUE 'EODS        '.06830003
068400         10  FILLER              PIC S9(08)  VALUE +06            06840003
068500                                             COMP.                06850003
068600         10  FILLER              PIC  X(12)  VALUE 'EOC         '.06860003
068700         10  FILLER              PIC S9(08)  VALUE +07            06870003
068800                                             COMP.                06880003
068900         10  FILLER              PIC  X(12)  VALUE 'INBFMH      '.06890003
069000         10  FILLER              PIC S9(08)  VALUE +08            06900003
069100                                             COMP.                06910003
069200         10  FILLER              PIC  X(12)  VALUE 'ENDINPT     '.06920003
069300         10  FILLER              PIC S9(08)  VALUE +09            06930003
069400                                             COMP.                06940003
069500         10  FILLER              PIC  X(12)  VALUE 'NONVAL      '.06950003
069600         10  FILLER              PIC S9(08)  VALUE +10            06960003
069700                                             COMP.                06970003
069800         10  FILLER              PIC  X(12)  VALUE 'NOSTART     '.06980003
069900         10  FILLER              PIC S9(08)  VALUE +11            06990003
070000                                             COMP.                07000003
070100         10  FILLER              PIC  X(12)  VALUE 'TERMIDERR   '.07010003
070200         10  FILLER              PIC S9(08)  VALUE +12            07020003
070300                                             COMP.                07030003
070400         10  FILLER              PIC  X(12)  VALUE 'DSIDERR     '.07040003
070500         10  FILLER              PIC S9(08)  VALUE +13            07050003
070600                                             COMP.                07060003
070700         10  FILLER              PIC  X(12)  VALUE 'NOTFND      '.07070003
070800         10  FILLER              PIC S9(08)  VALUE +14            07080003
070900                                             COMP.                07090003
071000         10  FILLER              PIC  X(12)  VALUE 'DUPREC      '.07100003
071100         10  FILLER              PIC S9(08)  VALUE +15            07110003
071200                                             COMP.                07120003
071300         10  FILLER              PIC  X(12)  VALUE 'DUPKEY      '.07130003
071400         10  FILLER              PIC S9(08)  VALUE +16            07140003
071500                                             COMP.                07150003
071600         10  FILLER              PIC  X(12)  VALUE 'INVREQ      '.07160003
071700         10  FILLER              PIC S9(08)  VALUE +17            07170003
071800                                             COMP.                07180003
071900         10  FILLER              PIC  X(12)  VALUE 'IOERR       '.07190003
072000         10  FILLER              PIC S9(08)  VALUE +18            07200003
072100                                             COMP.                07210003
072200         10  FILLER              PIC  X(12)  VALUE 'NOSPACE     '.07220003
072300         10  FILLER              PIC S9(08)  VALUE +19            07230003
072400                                             COMP.                07240003
072500         10  FILLER              PIC  X(12)  VALUE 'NOTOPEN     '.07250003
072600         10  FILLER              PIC S9(08)  VALUE +20            07260003
072700                                             COMP.                07270003
072800         10  FILLER              PIC  X(12)  VALUE 'ENDFILE     '.07280003
072900         10  FILLER              PIC S9(08)  VALUE +21            07290003
073000                                             COMP.                07300003
073100         10  FILLER              PIC  X(12)  VALUE 'ILLOGIC     '.07310003
073200         10  FILLER              PIC S9(08)  VALUE +22            07320003
073300                                             COMP.                07330003
073400         10  FILLER              PIC  X(12)  VALUE 'LENGERR     '.07340003
073500         10  FILLER              PIC S9(08)  VALUE +23            07350003
073600                                             COMP.                07360003
073700         10  FILLER              PIC  X(12)  VALUE 'QZERO       '.07370003
073800         10  FILLER              PIC S9(08)  VALUE +24            07380003
073900                                             COMP.                07390003
074000         10  FILLER              PIC  X(12)  VALUE 'SIGNAL      '.07400003
074100         10  FILLER              PIC S9(08)  VALUE +25            07410003
074200                                             COMP.                07420003
074300         10  FILLER              PIC  X(12)  VALUE 'QBUSY       '.07430003
074400         10  FILLER              PIC S9(08)  VALUE +26            07440003
074500                                             COMP.                07450003
074600         10  FILLER              PIC  X(12)  VALUE 'ITEMERR     '.07460003
074700         10  FILLER              PIC S9(08)  VALUE +27            07470003
074800                                             COMP.                07480003
074900         10  FILLER              PIC  X(12)  VALUE 'PGMIDERR    '.07490003
075000         10  FILLER              PIC S9(08)  VALUE +28            07500003
075100                                             COMP.                07510003
075200         10  FILLER              PIC  X(12)  VALUE 'TRANSIDERR  '.07520003
075300         10  FILLER              PIC S9(08)  VALUE +29            07530003
075400                                             COMP.                07540003
075500         10  FILLER              PIC  X(12)  VALUE 'ENDDATA     '.07550003
075600         10  FILLER              PIC S9(08)  VALUE +30            07560003
075700                                             COMP.                07570003
075800         10  FILLER              PIC  X(12)  VALUE 'INVTSREQ    '.07580003
075900         10  FILLER              PIC S9(08)  VALUE +31            07590003
076000                                             COMP.                07600003
076100         10  FILLER              PIC  X(12)  VALUE 'EXPIRED     '.07610003
076200         10  FILLER              PIC S9(08)  VALUE +32            07620003
076300                                             COMP.                07630003
076400         10  FILLER              PIC  X(12)  VALUE 'RETPAGE     '.07640003
076500         10  FILLER              PIC S9(08)  VALUE +33            07650003
076600                                             COMP.                07660003
076700         10  FILLER              PIC  X(12)  VALUE 'RTEFAIL     '.07670003
076800         10  FILLER              PIC S9(08)  VALUE +34            07680003
076900                                             COMP.                07690003
077000         10  FILLER              PIC  X(12)  VALUE 'RTESOME     '.07700003
077100         10  FILLER              PIC S9(08)  VALUE +35            07710003
077200                                             COMP.                07720003
077300         10  FILLER              PIC  X(12)  VALUE 'TSIOERR     '.07730003
077400         10  FILLER              PIC S9(08)  VALUE +36            07740003
077500                                             COMP.                07750003
077600         10  FILLER              PIC  X(12)  VALUE 'MAPFAIL     '.07760003
077700         10  FILLER              PIC S9(08)  VALUE +37            07770003
077800                                             COMP.                07780003
077900         10  FILLER              PIC  X(12)  VALUE 'INVERRTERM  '.07790003
078000         10  FILLER              PIC S9(08)  VALUE +38            07800003
078100                                             COMP.                07810003
078200         10  FILLER              PIC  X(12)  VALUE 'INVMPSZ     '.07820003
078300         10  FILLER              PIC S9(08)  VALUE +39            07830003
078400                                             COMP.                07840003
078500         10  FILLER              PIC  X(12)  VALUE 'IGREQID     '.07850003
078600         10  FILLER              PIC S9(08)  VALUE +40            07860003
078700                                             COMP.                07870003
078800         10  FILLER              PIC  X(12)  VALUE 'OVERFLOW    '.07880003
078900         10  FILLER              PIC S9(08)  VALUE +41            07890003
079000                                             COMP.                07900003
079100         10  FILLER              PIC  X(12)  VALUE 'INVLDC      '.07910003
079200         10  FILLER              PIC S9(08)  VALUE +42            07920003
079300                                             COMP.                07930003
079400         10  FILLER              PIC  X(12)  VALUE 'NOSTG       '.07940003
079500         10  FILLER              PIC S9(08)  VALUE +43            07950003
079600                                             COMP.                07960003
079700         10  FILLER              PIC  X(12)  VALUE 'JIDERR      '.07970003
079800         10  FILLER              PIC S9(08)  VALUE +44            07980003
079900                                             COMP.                07990003
080000         10  FILLER              PIC  X(12)  VALUE 'QIDERR      '.08000003
080100         10  FILLER              PIC S9(08)  VALUE +45            08010003
080200                                             COMP.                08020003
080300         10  FILLER              PIC  X(12)  VALUE 'NOJBUFSP    '.08030003
080400         10  FILLER              PIC S9(08)  VALUE +46            08040003
080500                                             COMP.                08050003
080600         10  FILLER              PIC  X(12)  VALUE 'DSSTAT      '.08060003
080700         10  FILLER              PIC S9(08)  VALUE +47            08070003
080800                                             COMP.                08080003
080900         10  FILLER              PIC  X(12)  VALUE 'SELNERR     '.08090003
081000         10  FILLER              PIC S9(08)  VALUE +48            08100003
081100                                             COMP.                08110003
081200         10  FILLER              PIC  X(12)  VALUE 'FUNCERR     '.08120003
081300         10  FILLER              PIC S9(08)  VALUE +49            08130003
081400                                             COMP.                08140003
081500         10  FILLER              PIC  X(12)  VALUE 'UNEXPIN     '.08150003
081600         10  FILLER              PIC S9(08)  VALUE +50            08160003
081700                                             COMP.                08170003
081800         10  FILLER              PIC  X(12)  VALUE 'NOPASSBKRD  '.08180003
081900         10  FILLER              PIC S9(08)  VALUE +51            08190003
082000                                             COMP.                08200003
082100         10  FILLER              PIC  X(12)  VALUE 'NOPASSBKWR  '.08210003
082200         10  FILLER              PIC S9(08)  VALUE +53            08220003
082300                                             COMP.                08230003
082400         10  FILLER              PIC  X(12)  VALUE 'SYSIDERR    '.08240003
082500         10  FILLER              PIC S9(08)  VALUE +54            08250003
082600                                             COMP.                08260003
082700         10  FILLER              PIC  X(12)  VALUE 'ISCINVREQ   '.08270003
082800         10  FILLER              PIC S9(08)  VALUE +55            08280003
082900                                             COMP.                08290003
083000         10  FILLER              PIC  X(12)  VALUE 'ENQBUSY     '.08300003
083100         10  FILLER              PIC S9(08)  VALUE +56            08310003
083200                                             COMP.                08320003
083300         10  FILLER              PIC  X(12)  VALUE 'ENVDEFERR   '.08330003
083400         10  FILLER              PIC S9(08)  VALUE +57            08340003
083500                                             COMP.                08350003
083600         10  FILLER              PIC  X(12)  VALUE 'IGREQCD     '.08360003
083700         10  FILLER              PIC S9(08)  VALUE +58            08370003
083800                                             COMP.                08380003
083900         10  FILLER              PIC  X(12)  VALUE 'SESSIONERR  '.08390003
084000         10  FILLER              PIC S9(08)  VALUE +59            08400003
084100                                             COMP.                08410003
084200         10  FILLER              PIC  X(12)  VALUE 'SYSBUSY     '.08420003
084300         10  FILLER              PIC S9(08)  VALUE +60            08430003
084400                                             COMP.                08440003
084500         10  FILLER              PIC  X(12)  VALUE 'SESSBUSY    '.08450003
084600         10  FILLER              PIC S9(08)  VALUE +61            08460003
084700                                             COMP.                08470003
084800         10  FILLER              PIC  X(12)  VALUE 'NOTALLOC    '.08480003
084900         10  FILLER              PIC S9(08)  VALUE +62            08490003
085000                                             COMP.                08500003
085100         10  FILLER              PIC  X(12)  VALUE 'CBIDERR     '.08510003
085200         10  FILLER              PIC S9(08)  VALUE +64            08520003
085300                                             COMP.                08530003
085400         10  FILLER              PIC  X(12)  VALUE 'INVPARTNSET '.08540003
085500         10  FILLER              PIC S9(08)  VALUE +65            08550003
085600                                             COMP.                08560003
085700         10  FILLER              PIC  X(12)  VALUE 'INVPARTN    '.08570003
085800         10  FILLER              PIC S9(08)  VALUE +66            08580003
085900                                             COMP.                08590003
086000         10  FILLER              PIC  X(12)  VALUE 'PARTNFAIL   '.08600003
086100         10  FILLER              PIC S9(08)  VALUE +70            08610003
086200                                             COMP.                08620003
086300         10  FILLER              PIC  X(12)  VALUE 'NOTAUTH     '.08630003
086400         10  FILLER              PIC S9(08)  VALUE +80            08640003
086500                                             COMP.                08650003
086600         10  FILLER              PIC  X(12)  VALUE 'NOSPOOL     '.08660003
086700         10  FILLER              PIC S9(08)  VALUE +81            08670003
086800                                             COMP.                08680003
086900         10  FILLER              PIC  X(12)  VALUE 'TERMERR     '.08690003
087000         10  FILLER              PIC S9(08)  VALUE +82            08700003
087100                                             COMP.                08710003
087200         10  FILLER              PIC  X(12)  VALUE 'ROLLEDBACK  '.08720003
087300         10  FILLER              PIC S9(08)  VALUE +83            08730003
087400                                             COMP.                08740003
087500         10  FILLER              PIC  X(12)  VALUE 'END         '.08750003
087600         10  FILLER              PIC S9(08)  VALUE +84            08760003
087700                                             COMP.                08770003
087800         10  FILLER              PIC  X(12)  VALUE 'DISABLED    '.08780003
087900         10  FILLER              PIC S9(08)  VALUE +85            08790003
088000                                             COMP.                08800003
088100         10  FILLER              PIC  X(12)  VALUE 'ALLOCERR    '.08810003
088200         10  FILLER              PIC S9(08)  VALUE +86            08820003
088300                                             COMP.                08830003
088400         10  FILLER              PIC  X(12)  VALUE 'STRELERR    '.08840003
088500         10  FILLER              PIC S9(08)  VALUE +87            08850003
088600                                             COMP.                08860003
088700         10  FILLER              PIC  X(12)  VALUE 'OPENERR     '.08870003
088800         10  FILLER              PIC S9(08)  VALUE +88            08880003
088900                                             COMP.                08890003
089000         10  FILLER              PIC  X(12)  VALUE 'SPOLBUSY    '.08900003
089100         10  FILLER              PIC S9(08)  VALUE +89            08910003
089200                                             COMP.                08920003
089300         10  FILLER              PIC  X(12)  VALUE 'SPOLERR     '.08930003
089400         10  FILLER              PIC S9(08)  VALUE +90            08940003
089500                                             COMP.                08950003
089600         10  FILLER              PIC  X(12)  VALUE 'NODEIDER    '.08960003
089700     05  EC-EIBRESP-ENTRY        REDEFINES EC-EIBRESP-ENTRIES     08970003
089800                                 OCCURS 77 TIMES                  08980003
089900                                 ASCENDING KEY EC-EIBRESP         08990003
090000                                 INDEXED BY EC-RESP-IDX.          09000003
090100         10  EC-EIBRESP          PIC S9(08)  COMP.                09010003
090200         10  EC-CONDITION-NAME   PIC  X(12).                      09020003
090300*                                                                 09030003
090400**  KSDS VSAM FILE FOR SAVING EACH TRAN'S STANDARD COMMAREA LAYOUT09040003
090500*                                                                 09050003
090600     COPY DPRD515.                                                09060003
090700*                                                                 09070003
090800**   COMMAREA LAYOUT FOR STANDARD ABEND INFORMATION.              09080003
090900*                                                                 09090003
091000     COPY DPWS013.                                                09100003
091100*                                                                 09110003
091200**   LAYOUT FOR OBJECT LOCKING VSAM FILE.                         09120003
091300*                                                                 09130003
091400     COPY DPRD509.                                                09140003
091500*                                                                 09150003
091600**   LAYOUT FOR TEMP-STORAGE QUEUE INFORMATION.                   09160003
091700*                                                                 09170003
091800     COPY DPWS026.                                                09180003
091900*                                                                 09190003
092000**   HEX CONVERSION ROUTINE PARAMETER LIST                        09200003
092100*                                                                 09210003
092200     COPY DPWS012.                                                09220003
092300*                                                                 09230003
092400**   PARAMETER LIST FOR THE SECURITY SUBROUTINE                   09240003
092500*                                                                 09250003
092600     COPY DPWS008.                                                09260003
092700*                                                                 09270003
092800**   THE SYMBOLIC MAP                                             09280003
092900*                                                                 09290003
093000     COPY DPKM013.                                                09300003
093100*                                                                 09310003
093200**  THIS IS A REDEFINITION OF MAP DPKM013                         09320003
093300*                                                                 09330003
093400 01  DSECT-REDEFINITION REDEFINES DP013AO.                        09340003
093500     05  FILLER                  PIC  X(12).                      09350003
093600     05  DSECT-DATE-L            PIC S9(04)  COMP.                09360003
093700     05  DSECT-DATE-A            PIC  X(01).                      09370003
093800     05  DSECT-DATE-C            PIC  X(01).                      09380003
093900     05  DSECT-DATE-H            PIC  X(01).                      09390003
094000     05  DSECT-DATE              PIC  X(10).                      09400003
094100     05  DSECT-TIME-L            PIC S9(04)  COMP.                09410003
094200     05  DSECT-TIME-A            PIC  X(01).                      09420003
094300     05  DSECT-TIME-C            PIC  X(01).                      09430003
094400     05  DSECT-TIME-H            PIC  X(01).                      09440003
094500     05  DSECT-TIME              PIC  X(08).                      09450003
094600     05  DSECT-TERM-L            PIC S9(04)  COMP.                09460003
094700     05  DSECT-TERM-A            PIC  X(01).                      09470003
094800     05  DSECT-TERM-C            PIC  X(01).                      09480003
094900     05  DSECT-TERM-H            PIC  X(01).                      09490003
095000     05  DSECT-TERM              PIC  X(04).                      09500003
095100     05  DSECT-FREE-FORMAT-LINE  OCCURS 21 TIMES                  09510003
095200                                 INDEXED BY DSECT-IDX.            09520003
095300         10  DSECT-ABEND-LINE-L  PIC S9(04)  COMP.                09530003
095400         10  DSECT-ABEND-LINE-A  PIC  X(01).                      09540003
095500         10  DSECT-ABEND-LINE-C  PIC  X(01).                      09550003
095600         10  DSECT-ABEND-LINE-H  PIC  X(01).                      09560003
095700         10  DSECT-ABEND-LINE    PIC  X(79).                      09570003
095800     05  DSECT-MESSAGE-L         PIC S9(04)  COMP.                09580003
095900     05  DSECT-MESSAGE-A         PIC  X(01).                      09590003
096000     05  DSECT-MESSAGE-C         PIC  X(01).                      09600003
096100     05  DSECT-MESSAGE-H         PIC  X(01).                      09610003
096200     05  DSECT-MESSAGE           PIC  X(79).                      09620003
096300*                                                                 09630003
096400**   THE STANDARD CICS ATTRIBUTES                                 09640003
096500 LINKAGE SECTION.                                                 09650003
096600 01  DFHCOMMAREA                   PIC  X(964).                   09660003
096700     EJECT                                                        09670003
096800 PROCEDURE DIVISION.                                              09680003
096900 0000-ABEND-MAIN-LINE.                                            09690003
097000     MOVE LOW-VALUES       TO DP013AO.                            09700003
097100     IF  EIBCALEN > ZERO                                          09710003
097200         MOVE DFHCOMMAREA  TO DP013-PARAMETERS                    09720003
097300         IF  DP013-ABEND-COMMAREA                                 09730003
097400             IF  DP013-ROLLBACK                                   09740003
097500                 PERFORM 1000-SYNCPOINT-ROLLBACK                  09750003
097600             END-IF                                               09760003
097700             PERFORM 2000-FORMAT-ABEND-INFO                       09770003
097800             PERFORM 3000-LOG-ABEND-INFO                          09780003
097900             IF   DP013-XCTL-DISPLAY-RESTART                      09790003
098000               OR DP013-XCTL-DISPLAY-LOGOFF                       09800003
098100                 PERFORM 4000-DISPLAY-ABEND-SCREEN                09810003
098200             END-IF                                               09820003
098300             IF  DP013-LINK-RETURN                                09830003
098400                 PERFORM 9000-RETURN                              09840003
098500             ELSE                                                 09850003
098600                 PERFORM 7000-CHECK-ESCAPE-SECURITY               09860003
098700             END-IF                                               09870003
098800         ELSE                                                     09880003
098900             SET DP013-XCTL-DISPLAY-LOGOFF TO TRUE                09890003
099000             PERFORM 5000-FORMAT-NO-COMMAREA-ABEND                09900003
099100             PERFORM 3000-LOG-ABEND-INFO                          09910003
099200             PERFORM 4000-DISPLAY-ABEND-SCREEN                    09920003
099300             PERFORM 7000-CHECK-ESCAPE-SECURITY                   09930003
099400         END-IF                                                   09940003
099500     ELSE                                                         09950003
099600         SET DP013-XCTL-DISPLAY-LOGOFF TO TRUE                    09960003
099700         PERFORM 5000-FORMAT-NO-COMMAREA-ABEND                    09970003
099800         PERFORM 3000-LOG-ABEND-INFO                              09980003
099900         PERFORM 4000-DISPLAY-ABEND-SCREEN                        09990003
100000         PERFORM 7000-CHECK-ESCAPE-SECURITY                       10000003
100100     END-IF.                                                      10010003
100200*                                                                 10020003
100300     GOBACK.                                                      10030003
100400*                                                                 10040003
100500*                                                                 10050003
100600 1000-SYNCPOINT-ROLLBACK.                                         10060003
100700     EXEC CICS                                                    10070003
100800         SYNCPOINT                                                10080003
100900             ROLLBACK                                             10090003
101000     END-EXEC.                                                    10100003
101100*                                                                 10110003
101200*                                                                 10120003
101300 2000-FORMAT-ABEND-INFO.                                          10130003
101400     INITIALIZE LT-LOG-LINE-TABLE.                                10140003
101500     MOVE EIBTRMID TO PV-LOG-TERMINAL.                            10150003
101600     SET LT-IDX TO 1.                                             10160003
101700     EVALUATE TRUE                                                10170003
101800         WHEN DP013-SECURITY-ABEND                                10180003
101900             PERFORM 2100-FORMAT-SECURITY                         10190003
102000         WHEN DP013-DB2-ABEND                                     10200003
102100             PERFORM 2200-FORMAT-DB2                              10210003
102200         WHEN DP013-CALL-IMS-ABEND                                10220003
102300             PERFORM 2300-FORMAT-CALL-IMS                         10230003
102400         WHEN DP013-COMMAND-IMS-ABEND                             10240003
102500             PERFORM 2400-FORMAT-COMMAND-IMS                      10250003
102600         WHEN DP013-LOGIC-ABEND                                   10260003
102700             MOVE LL1-LOGIC-LINE-1 TO LT-ERROR-MESSAGE (LT-IDX)   10270003
102800             PERFORM 2410-FORMAT-COMMON-INFO                      10280003
102900         WHEN DP013-CICS-ABEND                                    10290003
103000             MOVE CL1-CICS-LINE-1  TO LT-ERROR-MESSAGE (LT-IDX)   10300003
103100             PERFORM 2410-FORMAT-COMMON-INFO                      10310003
103200         WHEN OTHER                                               10320003
103300             MOVE UL1-UNDEFINED-LINE-1                            10330003
103400                                   TO LT-ERROR-MESSAGE (LT-IDX)   10340003
103500             PERFORM 2410-FORMAT-COMMON-INFO                      10350003
103600     END-EVALUATE.                                                10360003
103700     MOVE DP013-DFHEIBLK           TO EIBM-EIBLK-MASK.            10370003
103800     PERFORM 5100-FORMAT-EIB.                                     10380003
103900*                                                                 10390003
104000*                                                                 10400003
104100 2100-FORMAT-SECURITY.                                            10410003
104200     MOVE DP013-SECURITY-INFO TO DP008-SECURITY-COMMAREA.         10420003
104300     MOVE SL1-SECURITY-LINE-1 TO LT-ERROR-MESSAGE (LT-IDX).       10430003
104400     PERFORM 2410-FORMAT-COMMON-INFO.                             10440003
104500*                                                                 10450003
104600     MOVE DP008-RESOURCE-TYPE TO SL2-RESOURCE-TYPE.               10460003
104700     MOVE DP008-RESOURCE-NAME TO SL2-RESOURCE-NAME.               10470003
104800     MOVE DP008-ERROR-CODE    TO SL2-ERROR-CODE.                  10480003
104900     PERFORM 5110-SET-LINE-INDEX.                                 10490003
105000     MOVE SL2-SECURITY-LINE-2 TO LT-ERROR-MESSAGE (LT-IDX).       10500003
105100*                                                                 10510003
105200     MOVE DP008-ACCESS-TYPE   TO SL3-ACCESS-TYPE.                 10520003
105300     MOVE DP008-ACCESS-SW     TO SL3-ACCESS-ALLOWED.              10530003
105400     PERFORM 5110-SET-LINE-INDEX.                                 10540003
105500     MOVE SL3-SECURITY-LINE-3 TO LT-ERROR-MESSAGE (LT-IDX).       10550003
105600*                                                                 10560003
105700*                                                                 10570003
105800 2200-FORMAT-DB2.                                                 10580003
105900     MOVE DL1-DB2-LINE-1      TO LT-ERROR-MESSAGE (LT-IDX).       10590003
106000     PERFORM 2410-FORMAT-COMMON-INFO.                             10600003
106100*                                                                 10610003
106200     PERFORM 5110-SET-LINE-INDEX.                                 10620003
106300     MOVE DL2-DB2-LINE-2      TO LT-ERROR-MESSAGE (LT-IDX).       10630003
106400     PERFORM 5110-SET-LINE-INDEX.                                 10640003
106500     STRING  DP013-DB2-TABLE-NAME (1) DELIMITED BY SPACE          10650003
106600             SPACE                    DELIMITED BY SIZE           10660003
106700             DP013-DB2-TABLE-NAME (2) DELIMITED BY SPACE          10670003
106800             SPACE                    DELIMITED BY SIZE           10680003
106900             DP013-DB2-TABLE-NAME (3) DELIMITED BY SPACE          10690003
107000             SPACE                    DELIMITED BY SIZE           10700003
107100             DP013-DB2-TABLE-NAME (4) DELIMITED BY SPACE          10710003
107200     INTO    LT-ERROR-MESSAGE (LT-IDX)                            10720003
107300     POINTER PV-STRING-POINTER.                                   10730003
107400*                                                                 10740003
107500     IF  PV-STRING-POINTER > PC-STRING-POINTER-MAX                10750003
107600         IF  DP013-DB2-TABLE-NAME (5) > SPACE                     10760003
107700             PERFORM 5110-SET-LINE-INDEX                          10770003
107800             MOVE DP013-DB2-TABLE-NAME (5)                        10780003
107900                              TO LT-ERROR-MESSAGE (LT-IDX)        10790003
108000         END-IF                                                   10800003
108100     ELSE                                                         10810003
108200         STRING  SPACE                    DELIMITED BY SIZE       10820003
108300                 DP013-DB2-TABLE-NAME (5) DELIMITED BY SPACE      10830003
108400         INTO    LT-ERROR-MESSAGE (LT-IDX)                        10840003
108500         POINTER PV-STRING-POINTER                                10850003
108600     END-IF.                                                      10860003
108700     PERFORM 2210-FORMAT-SQLCA.                                   10870003
108800*                                                                 10880003
108900*                                                                 10890003
109000 2210-FORMAT-SQLCA.                                               10900003
109100*                                                                 10910003
109200**   DISPLAY SQLCA INFORMATION IN A READABLE FORMAT               10920003
109300*                                                                 10930003
109400     CALL 'DSNTIAR' USING DP013-SQLCA                             10940003
109500                          FDB-FORMATTED-MESSAGE                   10950003
109600                          FDB-ERROR-LINE-LENGTH.                  10960003
109700*                                                                 10970003
109800     PERFORM                                                      10980003
109900         VARYING FDB-MSG-IDX                                      10990003
110000         FROM 1 BY 1                                              11000003
110100         UNTIL FDB-MSG-IDX > FDB-MAX-MESSAGE-LINES                11010003
110200             IF  FDB-MESSAGE-LINE (FDB-MSG-IDX) > SPACE           11020003
110300                 PERFORM 5110-SET-LINE-INDEX                      11030003
110400                 MOVE FDB-MESSAGE-LINE (FDB-MSG-IDX)              11040003
110500                                 TO LT-ERROR-MESSAGE (LT-IDX)     11050003
110600             END-IF                                               11060003
110700     END-PERFORM.                                                 11070003
110800*                                                                 11080003
110900*                                                                 11090003
111000 2300-FORMAT-CALL-IMS.                                            11100003
111100     MOVE IL1-IMS-CALL-LINE-1    TO LT-ERROR-MESSAGE (LT-IDX).    11110003
111200     PERFORM 2410-FORMAT-COMMON-INFO.                             11120003
111300*                                                                 11130003
111400     MOVE DP013-CALL-IMS-PCB     TO FPCB-FORMAT-PCB.              11140003
111500     MOVE DP013-CALL-IMS-FUNCTION TO IL2-FUNCTION.                11150003
111600     MOVE FPCB-STATUS-CODE        TO IL2-STATUS.                  11160003
111700     MOVE FPCB-DBNAME             TO IL2-DATABASE.                11170003
111800     MOVE FPCB-SEGMENT-NAME       TO IL2-SEGMENT.                 11180003
111900     MOVE FPCB-LEVEL-NUMBER       TO IL2-LEVEL.                   11190003
112000     PERFORM 5110-SET-LINE-INDEX.                                 11200003
112100     MOVE IL2-IMS-CALL-LINE-2     TO LT-ERROR-MESSAGE (LT-IDX).   11210003
112200*                                                                 11220003
112300     MOVE FPCB-PROC-OPTION        TO IL3-PROC-OPT.                11230003
112400     MOVE FPCB-KEY-LENGTH         TO IL3-FEEDBACK-LENGTH.         11240003
112500     MOVE FPCB-NUMBER-SEGS        TO IL3-FEEDBACK-KEYS.           11250003
112600     PERFORM 5110-SET-LINE-INDEX.                                 11260003
112700     MOVE IL3-IMS-CALL-LINE-3     TO LT-ERROR-MESSAGE (LT-IDX).   11270003
112800*                                                                 11280003
112900     MOVE FPCB-KEY-FEEDBACK       TO IL4-KEY-FEEDBACK.            11290003
113000     PERFORM 5110-SET-LINE-INDEX.                                 11300003
113100     MOVE IL4-IMS-CALL-LINE-4     TO LT-ERROR-MESSAGE (LT-IDX).   11310003
113200*                                                                 11320003
113300     PERFORM                                                      11330003
113400         VARYING PV-SSA-SUB                                       11340003
113500         FROM 1 BY 1                                              11350003
113600         UNTIL PV-SSA-SUB > PC-SSA-MAX                            11360003
113700             IF  DP013-CALL-IMS-SSA (PV-SSA-SUB) > SPACE          11370003
113800                 MOVE DP013-CALL-IMS-SSA (PV-SSA-SUB)             11380003
113900                                  TO IL5-SSA                      11390003
114000                 PERFORM 5110-SET-LINE-INDEX                      11400003
114100                 MOVE IL5-IMS-CALL-LINE-5                         11410003
114200                                  TO LT-ERROR-MESSAGE (LT-IDX)    11420003
114300                 MOVE SPACE       TO IL5-SSA-LITERAL              11430003
114400             END-IF                                               11440003
114500     END-PERFORM.                                                 11450003
114600*                                                                 11460003
114700*                                                                 11470003
114800 2400-FORMAT-COMMAND-IMS.                                         11480003
114900     MOVE XL1-IMS-EXEC-LINE-1    TO LT-ERROR-MESSAGE (LT-IDX).    11490003
115000     PERFORM 2410-FORMAT-COMMON-INFO.                             11500003
115100*                                                                 11510003
115200     MOVE DP013-CMD-IMS-DIB      TO DM-DLZDIB-MASK.               11520003
115300     MOVE DM-DIB-VERSION         TO XL2-VERSION.                  11530003
115400     MOVE DP013-CMD-IMS-FUNCTION TO XL2-FUNCTION.                 11540003
115500     MOVE DM-DIB-STATUS          TO XL2-STATUS.                   11550003
115600     MOVE DM-DIB-SEGMENT         TO XL2-SEGMENT.                  11560003
115700     MOVE DM-DIB-SEGMENT-LEVEL   TO XL2-LEVEL.                    11570003
115800     PERFORM 5110-SET-LINE-INDEX.                                 11580003
115900     MOVE XL2-IMS-EXEC-LINE-2    TO LT-ERROR-MESSAGE (LT-IDX).    11590003
116000*                                                                 11600003
116100     MOVE DM-DIB-FEEDBACK-LENGTH TO XL3-FEEDBACK-LENGTH.          11610003
116200     PERFORM 5110-SET-LINE-INDEX.                                 11620003
116300     MOVE XL3-IMS-EXEC-LINE-3    TO LT-ERROR-MESSAGE (LT-IDX).    11630003
116400*                                                                 11640003
116500     MOVE DP013-CMD-IMS-FEEDBACK TO XL4-KEY-FEEDBACK.             11650003
116600     PERFORM 5110-SET-LINE-INDEX.                                 11660003
116700     MOVE XL4-IMS-EXEC-LINE-4    TO LT-ERROR-MESSAGE (LT-IDX).    11670003
116800*                                                                 11680003
116900*                                                                 11690003
117000 2410-FORMAT-COMMON-INFO.                                         11700003
117100     MOVE DP013-PROGRAM           TO AL1-PROGRAM.                 11710003
117200     MOVE DP013-PARAGRAPH         TO AL1-PARAGRAPH.               11720003
117300     SET LT-IDX UP BY 1.                                          11730003
117400     MOVE AL1-ABEND-LINE-1        TO LT-ERROR-MESSAGE (LT-IDX).   11740003
117500*                                                                 11750003
117600** EIBTRMID WILL BE LOW-VALUES FOR NON-TERMINALLY ATTACHED        11760003
117700** APPLICATIONS  SO DON'T TRY TO READ THE 'INFO' TS QUEUE.        11770003
117800*                                                                 11780003
117900     IF  EIBTRMID > SPACE                                         11790003
118000         PERFORM 2411-GET-USER-FROM-TS                            11800003
118100         MOVE DP026-USERID        TO AL2-USERID                   11810003
118200         MOVE DP026-NETNAME       TO AL2-NETNAME                  11820003
118300         MOVE PV-LOCATION-X       TO AL2-LOCATION                 11830013
118400         SET LT-IDX UP BY 1                                       11840003
118500         MOVE AL2-ABEND-LINE-2    TO LT-ERROR-MESSAGE (LT-IDX)    11850003
118600     END-IF.                                                      11860003
118700*                                                                 11870003
118800     MOVE DP013-ABEND-TYPE-IND    TO AL3-ABEND-TYPE.              11880003
118900     MOVE DP013-ABEND-CONTROL-IND TO AL3-ABEND-CONTROL.           11890003
119000     MOVE DP013-ROLLBACK-IND      TO AL3-ROLLBACK.                11900003
119100     SET LT-IDX UP BY 1.                                          11910003
119200     MOVE AL3-ABEND-LINE-3        TO LT-ERROR-MESSAGE (LT-IDX).   11920003
119300*                                                                 11930003
119400     IF  DP013-MESSAGE-TABLE = SPACE                              11940003
119500         CONTINUE                                                 11950003
119600     ELSE                                                         11960003
119700         SET LT-IDX UP BY 1                                       11970003
119800         MOVE AL4-ABEND-LINE-4    TO LT-ERROR-MESSAGE (LT-IDX)    11980003
119900         PERFORM                                                  11990003
120000             VARYING PV-MSG-SUB                                   12000003
120100             FROM 1 BY 1                                          12010003
120200             UNTIL PV-MSG-SUB > 4                                 12020003
120300                 IF  DP013-MESSAGE-TEXT (PV-MSG-SUB) > SPACE      12030003
120400                     SET LT-IDX UP BY 1                           12040003
120500                     MOVE DP013-MESSAGE-TEXT (PV-MSG-SUB)         12050003
120600                              TO LT-ERROR-MESSAGE (LT-IDX)        12060011
120700                 END-IF                                           12070003
120800         END-PERFORM                                              12080003
120900     END-IF.                                                      12090003
121000*                                                                 12100003
121100*                                                                 12110003
121200 2411-GET-USER-FROM-TS.                                           12120003
121300     MOVE EIBTRMID             TO TS-INFO-QUEUE-TERMINAL.         12130003
121400     MOVE SPACE                TO PV-SYSID.                       12140003
121500     EXEC CICS                                                    12150003
121600         INQUIRE                                                  12160003
121700             TRANSACTION  (PC-LOGON-TRAN)                         12170003
121800             REMOTESYSTEM (PV-SYSID)                              12180003
121900     END-EXEC.                                                    12190003
122000*                                                                 12200003
122100     IF  PV-SYSID = SPACE                                         12210003
122200         EXEC CICS                                                12220003
122300             READQ TS                                             12230003
122400                 QUEUE (TS-INFO-QUEUE-NAME)                       12240003
122500                 INTO  (DP026-SIGN-ON-INFO)                       12250003
122600                 ITEM  (PV-TS-ITEM)                               12260003
122700                 RESP  (PV-CICS-RESPONSE)                         12270003
122800         END-EXEC                                                 12280003
122900     ELSE                                                         12290003
123000         EXEC CICS                                                12300003
123100             READQ TS                                             12310003
123200                 QUEUE (TS-INFO-QUEUE-NAME)                       12320003
123300                 INTO  (DP026-SIGN-ON-INFO)                       12330003
123400                 ITEM  (PV-TS-ITEM)                               12340003
123500                 SYSID (PV-SYSID)                                 12350003
123600                 LENGTH(LENGTH OF DP026-SIGN-ON-INFO)             12360003
123700                 RESP  (PV-CICS-RESPONSE)                         12370003
123800         END-EXEC                                                 12380003
123900     END-IF.                                                      12390003
124000*                                                                 12400003
124100     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       12410003
124200         MOVE DP026-LOCATION-NBR TO PV-LOCATION-9                 12420012
124300     ELSE                                                         12430003
124400         MOVE ALL '?'            TO DP026-USERID                  12440012
124500                                    DP026-NETNAME                 12450012
124600                                    PV-LOCATION-X                 12460013
124700     END-IF.                                                      12470003
124800*                                                                 12480003
124900*                                                                 12490003
125000 3000-LOG-ABEND-INFO.                                             12500003
125100     EXEC CICS                                                    12510003
125200         ENQ                                                      12520003
125300             RESOURCE (PC-LOG-QUEUE-RESOURCE)                     12530003
125400     END-EXEC.                                                    12540003
125500*                                                                 12550003
125600     SET PV-NUMBER-LOG-LINES TO LT-IDX.                           12560003
125700     PERFORM                                                      12570003
125800         VARYING LT-IDX                                           12580003
125900         FROM 1 BY 1                                              12590003
126000         UNTIL LT-IDX > PV-NUMBER-LOG-LINES                       12600003
126100             MOVE LT-LOG-LINE (LT-IDX) TO PV-LOG-DATA             12610003
126200             PERFORM 3100-WRITEQ-TD                               12620003
126300     END-PERFORM.                                                 12630003
126400*                                                                 12640003
126500     EXEC CICS                                                    12650003
126600         DEQ                                                      12660003
126700             RESOURCE (PC-LOG-QUEUE-RESOURCE)                     12670003
126800     END-EXEC.                                                    12680003
126810     PERFORM 3200-DISPLAY-OPER-MSG.                               12681003
126900*                                                                 12690003
127000*                                                                 12700003
127100 3100-WRITEQ-TD.                                                  12710003
127200     EXEC CICS                                                    12720003
127300         WRITEQ TD                                                12730003
127400             QUEUE (PC-LOG-QUEUE)                                 12740003
127500             FROM  (PV-LOG-LINE)                                  12750003
127600             RESP  (PV-CICS-RESPONSE)                             12760003
127700     END-EXEC.                                                    12770003
127800*                                                                 12780003
127900     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       12790003
128000         CONTINUE                                                 12800003
128100     ELSE                                                         12810003
128200         EXEC CICS                                                12820003
128300             ABEND                                                12830003
128400                 ABCODE (EIBTRMID)                                12840003
128500         END-EXEC                                                 12850003
128600     END-IF.                                                      12860003
128801***************************************************************** 12880103
128802** WRITE AN OPERATOR MESSAGE TO THE CONSOLE.  THE MESSAGE WILL ** 12880203
128803** BE PICKED-UP BY THE PROBLEM-TRACKING SYSTEM TO CUT A PITS   ** 12880303
128804** TICKET.  DO THE ACTUAL WRITE ONLY IF WE ARE IN PROD.        ** 12880409
128805***************************************************************** 12880503
128810 3200-DISPLAY-OPER-MSG.                                           12881003
128811     EXEC CICS                                                    12881103
128812         ASSIGN                                                   12881203
128813             APPLID (PV-APPLID)                                   12881303
128814     END-EXEC.                                                    12881403
128815*                                                                 12881509
128816     IF  PV-APPLID-PROD                                           12881609
128818         MOVE PV-APPLID      TO OT-APPLID                         12881809
128819         MOVE EIBM-TRNID     TO OT-TRANID                         12881909
128820         MOVE DP013-PROGRAM  TO OT-PROGRAM                        12882009
128822         PERFORM 3210-WRITE-OPER-MSG                              12882209
128823     END-IF.                                                      12882309
128824***************************************************************** 12882409
128825** WRITE THE MESSAGE TO THE OPERATOR CONSOLE.  PC-SYS-CONSOLE  ** 12882509
128826** ROUTE CODE INDICATES THE CONSOLE.  'EVENTUAL' ALLOWS THE    ** 12882609
128827** MESSAGE TO ROLL OFF THE SCREEN.                             ** 12882709
128828***************************************************************** 12882809
128831 3210-WRITE-OPER-MSG.                                             12883103
128832     EXEC CICS                                                    12883203
128833         WRITE                                                    12883303
128834             OPERATOR                                             12883403
128835                 TEXT       (OT-OPERATOR-TEXT)                    12883505
128836                 ROUTECODES (PC-SYS-CONSOLE)                      12883608
128837                 NUMROUTES  (PC-NUM-ROUTES)                       12883704
128838                 EVENTUAL                                         12883803
128839     END-EXEC.                                                    12883903
128840*                                                                 12884003
128850*                                                                 12885003
128900 4000-DISPLAY-ABEND-SCREEN.                                       12890003
129000     PERFORM 4100-UPDATE-SCREEN-HEADER.                           12900003
129100     PERFORM                                                      12910003
129200         VARYING DSECT-IDX                                        12920003
129300         FROM 1 BY 1                                              12930003
129400         UNTIL (DSECT-IDX > PC-DSECT-MAX                          12940003
129500           OR DSECT-IDX > PV-NUMBER-LOG-LINES)                    12950003
129600             SET LT-IDX TO DSECT-IDX                              12960003
129700             MOVE LT-ERROR-MESSAGE (LT-IDX)                       12970003
129800                                   TO DSECT-ABEND-LINE (DSECT-IDX)12980003
129900     END-PERFORM.                                                 12990003
130000     IF  DSECT-IDX > PC-DSECT-MAX                                 13000003
130100         SET DSECT-IDX DOWN BY 1                                  13010003
130200         MOVE OM-SCREEN-OVERFLOW-MSG                              13020003
130300                                   TO DSECT-ABEND-LINE (DSECT-IDX)13030003
130400     END-IF.                                                      13040003
130500     IF  DP013-XCTL-DISPLAY-LOGOFF                                13050003
130600         MOVE 'PRESS ENTER TO LOGOFF '                            13060003
130700                                   TO DSECT-MESSAGE               13070003
130800     ELSE                                                         13080003
130900         MOVE 'PRESS ENTER TO RESTART'                            13090003
131000                                   TO DSECT-MESSAGE               13100003
131100     END-IF.                                                      13110003
131200     PERFORM 4200-SEND-MAP.                                       13120003
131300*                                                                 13130003
131400*                                                                 13140003
131500 4100-UPDATE-SCREEN-HEADER.                                       13150003
131600     EXEC CICS                                                    13160003
131700         ASKTIME                                                  13170003
131800             ABSTIME (ST-ABSTIME)                                 13180003
131900     END-EXEC.                                                    13190003
132000     EXEC CICS                                                    13200003
132100         FORMATTIME                                               13210003
132200             ABSTIME     (ST-ABSTIME)                             13220003
132300             MONTHOFYEAR (ST-MONTH)                               13230003
132400             DAYOFMONTH  (ST-DAY)                                 13240003
132500             YEAR        (ST-YEAR)                                13250003
132600             TIME        (DSECT-TIME)                             13260003
132700             TIMESEP                                              13270003
132800     END-EXEC.                                                    13280003
132900     MOVE EIBTRMID         TO DSECT-TERM.                         13290003
133000     MOVE ST-MONTH         TO ST-DISPLAY-MONTH.                   13300003
133100     MOVE ST-DAY           TO ST-DISPLAY-DAY.                     13310003
133200     MOVE ST-YEAR          TO ST-DISPLAY-YEAR.                    13320003
133300     MOVE ST-DISPLAY-DATE  TO DSECT-DATE.                         13330003
133400*                                                                 13340003
133500*                                                                 13350003
133600 4200-SEND-MAP.                                                   13360003
133700     MOVE -1               TO DSECT-MESSAGE-L.                    13370003
133800     EXEC CICS SEND MAP    (PC-MAP-NAME)                          13380003
133900                    MAPSET (PC-MAPSET-NAME)                       13390003
134000                    FROM   (DP013AO)                              13400003
134100                    ERASE                                         13410003
134200                    CURSOR                                        13420003
134300                    FORMFEED                                      13430003
134400                    END-EXEC.                                     13440003
134500*                                                                 13450003
134600*                                                                 13460003
134700 5000-FORMAT-NO-COMMAREA-ABEND.                                   13470003
134800     INITIALIZE LT-LOG-LINE-TABLE.                                13480003
134900     MOVE EIBTRMID TO PV-LOG-TERMINAL.                            13490003
135000     SET LT-IDX TO 1.                                             13500003
135100     IF  EIBCALEN = ZERO                                          13510003
135200         MOVE NVL-NO-COMMAREA-LINE                                13520003
135300                                 TO LT-ERROR-MESSAGE (LT-IDX)     13530003
135400     ELSE                                                         13540003
135500         MOVE NVL-BAD-COMMAREA-LINE                               13550003
135600                                 TO LT-ERROR-MESSAGE (LT-IDX)     13560003
135700     END-IF.                                                      13570003
135800     SET LT-IDX UP BY 1.                                          13580003
135900     MOVE NVL-EIB-WARNING        TO LT-ERROR-MESSAGE (LT-IDX).    13590003
136000     MOVE DFHEIBLK               TO EIBM-EIBLK-MASK.              13600003
136100     PERFORM 5100-FORMAT-EIB.                                     13610003
136200*                                                                 13620003
136300*                                                                 13630003
136400 5100-FORMAT-EIB.                                                 13640003
136500     PERFORM 5110-SET-LINE-INDEX.                                 13650003
136600     MOVE EL1-EIB-LINE-1  TO LT-ERROR-MESSAGE (LT-IDX).           13660003
136700*                                                                 13670003
136800     MOVE EIBM-TIME       TO EL2-EIBTIME.                         13680003
136900     MOVE EIBM-DATE       TO EL2-EIBDATE.                         13690003
137000     PERFORM 5110-SET-LINE-INDEX.                                 13700003
137100     MOVE EL2-EIB-LINE-2  TO LT-ERROR-MESSAGE (LT-IDX).           13710003
137200*                                                                 13720003
137300     MOVE EIBM-TRNID      TO EL3-EIBTRNID.                        13730003
137400     MOVE EIBM-TASKN      TO EL3-EIBTASKN.                        13740003
137500     PERFORM 5110-SET-LINE-INDEX.                                 13750003
137600     MOVE EL3-EIB-LINE-3  TO LT-ERROR-MESSAGE (LT-IDX).           13760003
137700*                                                                 13770003
137800     MOVE EIBM-TRMID      TO EL4-EIBTRMID.                        13780003
137900     MOVE EIBM-CPOSN      TO EL4-EIBCPOSN.                        13790003
138000     PERFORM 5110-SET-LINE-INDEX.                                 13800003
138100     MOVE EL4-EIB-LINE-4  TO LT-ERROR-MESSAGE (LT-IDX).           13810003
138200*                                                                 13820003
138300     MOVE EIBM-CALEN      TO EL5-EIBCALEN.                        13830003
138400     MOVE EIBM-AID        TO EL5-EIBAID.                          13840003
138500     SET AC-AID-IDX TO 1.                                         13850003
138600     SEARCH AC-ATTENTION-ID-ENTRY                                 13860003
138700         AT END                                                   13870003
138800             MOVE ALL '?'            TO EL5-EIBAID-DESCRIPTION    13880003
138900         WHEN AC-EIBAID (AC-AID-IDX) = EIBM-AID                   13890003
139000             MOVE AC-AID-NAME (AC-AID-IDX)                        13900003
139100                                     TO EL5-EIBAID-DESCRIPTION    13910003
139200     END-SEARCH.                                                  13920003
139300     PERFORM 5110-SET-LINE-INDEX.                                 13930003
139400     MOVE EL5-EIB-LINE-5  TO LT-ERROR-MESSAGE (LT-IDX).           13940003
139500*                                                                 13950003
139600     MOVE EIBM-FN                    TO DP012-CONVERSION-FIELD.   13960003
139700     MOVE LENGTH OF EIBM-FN          TO DP012-LENGTH.             13970003
139800     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13980003
139900     IF  DP012-CALL-SUCCESSFUL                                    13990003
140000         MOVE DP012-CONVERTED-FIELD  TO EL6-EIBFN-HEX             14000003
140100     ELSE                                                         14010003
140200         MOVE ALL '?'                TO EL6-EIBFN-HEX             14020003
140300     END-IF.                                                      14030003
140400     MOVE EIBM-RCODE                 TO DP012-CONVERSION-FIELD.   14040003
140500     MOVE LENGTH OF EIBM-RCODE       TO DP012-LENGTH.             14050003
140600     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14060003
140700     IF  DP012-CALL-SUCCESSFUL                                    14070003
140800         MOVE DP012-CONVERTED-FIELD  TO EL6-EIBRCODE-HEX          14080003
140900     ELSE                                                         14090003
141000         MOVE ALL '?'                TO EL6-EIBRCODE-HEX          14100003
141100     END-IF.                                                      14110003
141200     PERFORM 5110-SET-LINE-INDEX.                                 14120003
141300     MOVE EL6-EIB-LINE-6             TO LT-ERROR-MESSAGE (LT-IDX).14130003
141400*                                                                 14140003
141500     MOVE EIBM-RESP                  TO EL7-EIBRESP.              14150003
141600     SET EC-RESP-IDX TO 1.                                        14160003
141700     SEARCH EC-EIBRESP-ENTRY                                      14170003
141800         AT END                                                   14180003
141900             MOVE ALL '?'            TO EL7-EIBRESP-DESCRIPTION   14190003
142000         WHEN EC-EIBRESP (EC-RESP-IDX) = EIBM-RESP                14200003
142100             MOVE EC-CONDITION-NAME (EC-RESP-IDX)                 14210003
142200                                     TO EL7-EIBRESP-DESCRIPTION   14220003
142300     END-SEARCH.                                                  14230003
142400     MOVE EIBM-RESP2                 TO EL7-EIBRESP2.             14240003
142500     PERFORM 5110-SET-LINE-INDEX.                                 14250003
142600     MOVE EL7-EIB-LINE-7             TO LT-ERROR-MESSAGE (LT-IDX).14260003
142700*                                                                 14270003
142800     MOVE EIBM-DS                    TO EL8-EIBDS.                14280003
142900*                                                                 14290003
143000     MOVE EIBM-REQID                 TO DP012-CONVERSION-FIELD.   14300003
143100     MOVE LENGTH OF EIBM-REQID       TO DP012-LENGTH.             14310003
143200     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14320003
143300     IF  DP012-CALL-SUCCESSFUL                                    14330003
143400         MOVE DP012-CONVERTED-FIELD  TO EL8-EIBREQID-HEX          14340003
143500     ELSE                                                         14350003
143600         MOVE ALL '?'                TO EL8-EIBREQID-HEX          14360003
143700     END-IF.                                                      14370003
143800     PERFORM 5110-SET-LINE-INDEX.                                 14380003
143900     MOVE EL8-EIB-LINE-8             TO LT-ERROR-MESSAGE (LT-IDX).14390003
144000*                                                                 14400003
144100     MOVE EIBM-RSRCE                 TO DP012-CONVERSION-FIELD.   14410003
144200     MOVE LENGTH OF EIBM-RSRCE       TO DP012-LENGTH.             14420003
144300     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14430003
144400     IF  DP012-CALL-SUCCESSFUL                                    14440003
144500         MOVE DP012-CONVERTED-FIELD  TO EL9-EIBRSRCE-HEX          14450003
144600     ELSE                                                         14460003
144700         MOVE ALL '?'                TO EL9-EIBRSRCE-HEX          14470003
144800     END-IF.                                                      14480003
144900*                                                                 14490003
145000     MOVE EIBM-EOC                   TO DP012-CONVERSION-FIELD.   14500003
145100     MOVE LENGTH OF EIBM-EOC         TO DP012-LENGTH.             14510003
145200     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14520003
145300     IF  DP012-CALL-SUCCESSFUL                                    14530003
145400         MOVE DP012-CONVERTED-FIELD  TO EL9-EIBEOC-HEX            14540003
145500     ELSE                                                         14550003
145600         MOVE ALL '?'                TO EL9-EIBEOC-HEX            14560003
145700     END-IF.                                                      14570003
145800     PERFORM 5110-SET-LINE-INDEX.                                 14580003
145900     MOVE EL9-EIB-LINE-9             TO LT-ERROR-MESSAGE (LT-IDX).14590003
146000*                                                                 14600003
146100     MOVE EIBM-FREE                  TO DP012-CONVERSION-FIELD.   14610003
146200     MOVE LENGTH OF EIBM-FREE        TO DP012-LENGTH.             14620003
146300     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14630003
146400     IF  DP012-CALL-SUCCESSFUL                                    14640003
146500         MOVE DP012-CONVERTED-FIELD  TO EL10-EIBFREE-HEX          14650003
146600     ELSE                                                         14660003
146700         MOVE ALL '?'                TO EL10-EIBFREE-HEX          14670003
146800     END-IF.                                                      14680003
146900     MOVE EIBM-RECV                  TO DP012-CONVERSION-FIELD.   14690003
147000     MOVE LENGTH OF EIBM-RECV        TO DP012-LENGTH.             14700003
147100     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14710003
147200     IF  DP012-CALL-SUCCESSFUL                                    14720003
147300         MOVE DP012-CONVERTED-FIELD  TO EL10-EIBRECV-HEX          14730003
147400     ELSE                                                         14740003
147500         MOVE ALL '?'                TO EL10-EIBRECV-HEX          14750003
147600     END-IF.                                                      14760003
147700     PERFORM 5110-SET-LINE-INDEX.                                 14770003
147800     MOVE EL10-EIB-LINE-10           TO LT-ERROR-MESSAGE (LT-IDX).14780003
147900*                                                                 14790003
148000     MOVE EIBM-ATT                   TO DP012-CONVERSION-FIELD.   14800003
148100     MOVE LENGTH OF EIBM-ATT         TO DP012-LENGTH.             14810003
148200     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14820003
148300     IF  DP012-CALL-SUCCESSFUL                                    14830003
148400         MOVE DP012-CONVERTED-FIELD  TO EL11-EIBATT-HEX           14840003
148500     ELSE                                                         14850003
148600         MOVE ALL '?'                TO EL11-EIBATT-HEX           14860003
148700     END-IF.                                                      14870003
148800     MOVE EIBM-SYNC                  TO DP012-CONVERSION-FIELD.   14880003
148900     MOVE LENGTH OF EIBM-SYNC        TO DP012-LENGTH.             14890003
149000     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14900003
149100     IF  DP012-CALL-SUCCESSFUL                                    14910003
149200         MOVE DP012-CONVERTED-FIELD  TO EL11-EIBSYNC-HEX          14920003
149300     ELSE                                                         14930003
149400         MOVE ALL '?'                TO EL11-EIBSYNC-HEX          14940003
149500     END-IF.                                                      14950003
149600     PERFORM 5110-SET-LINE-INDEX.                                 14960003
149700     MOVE EL11-EIB-LINE-11           TO LT-ERROR-MESSAGE (LT-IDX).14970003
149800*                                                                 14980003
149900     MOVE EIBM-FMH                   TO DP012-CONVERSION-FIELD.   14990003
150000     MOVE LENGTH OF EIBM-FMH         TO DP012-LENGTH.             15000003
150100     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              15010003
150200     IF  DP012-CALL-SUCCESSFUL                                    15020003
150300         MOVE DP012-CONVERTED-FIELD  TO EL12-EIBFMH-HEX           15030003
150400     ELSE                                                         15040003
150500         MOVE ALL '?'                TO EL12-EIBFMH-HEX           15050003
150600     END-IF.                                                      15060003
150700     MOVE EIBM-COMPL                 TO DP012-CONVERSION-FIELD.   15070003
150800     MOVE LENGTH OF EIBM-COMPL       TO DP012-LENGTH.             15080003
150900     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              15090003
151000     IF  DP012-CALL-SUCCESSFUL                                    15100003
151100         MOVE DP012-CONVERTED-FIELD  TO EL12-EIBCOMPL-HEX         15110003
151200     ELSE                                                         15120003
151300         MOVE ALL '?'                TO EL12-EIBCOMPL-HEX         15130003
151400     END-IF.                                                      15140003
151500     PERFORM 5110-SET-LINE-INDEX.                                 15150003
151600     MOVE EL12-EIB-LINE-12           TO LT-ERROR-MESSAGE (LT-IDX).15160003
151700*                                                                 15170003
151800     MOVE EIBM-SIG                   TO DP012-CONVERSION-FIELD.   15180003
151900     MOVE LENGTH OF EIBM-SIG         TO DP012-LENGTH.             15190003
152000     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              15200003
152100     IF  DP012-CALL-SUCCESSFUL                                    15210003
152200         MOVE DP012-CONVERTED-FIELD  TO EL13-EIBSIG-HEX           15220003
152300     ELSE                                                         15230003
152400         MOVE ALL '?'                TO EL13-EIBSIG-HEX           15240003
152500     END-IF.                                                      15250003
152600     MOVE EIBM-CONF                  TO DP012-CONVERSION-FIELD.   15260003
152700     MOVE LENGTH OF EIBM-CONF        TO DP012-LENGTH.             15270003
152800     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              15280003
152900     IF  DP012-CALL-SUCCESSFUL                                    15290003
153000         MOVE DP012-CONVERTED-FIELD  TO EL13-EIBCONF-HEX          15300003
153100     ELSE                                                         15310003
153200         MOVE ALL '?'                TO EL13-EIBCONF-HEX          15320003
153300     END-IF.                                                      15330003
153400     PERFORM 5110-SET-LINE-INDEX.                                 15340003
153500     MOVE EL13-EIB-LINE-13           TO LT-ERROR-MESSAGE (LT-IDX).15350003
153600*                                                                 15360003
153700     MOVE EIBM-ERR                   TO DP012-CONVERSION-FIELD.   15370003
153800     MOVE LENGTH OF EIBM-ERR         TO DP012-LENGTH.             15380003
153900     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              15390003
154000     IF  DP012-CALL-SUCCESSFUL                                    15400003
154100         MOVE DP012-CONVERTED-FIELD  TO EL14-EIBERR-HEX           15410003
154200     ELSE                                                         15420003
154300         MOVE ALL '?'                TO EL14-EIBERR-HEX           15430003
154400     END-IF.                                                      15440003
154500     MOVE EIBM-ERRCD                 TO DP012-CONVERSION-FIELD.   15450003
154600     MOVE LENGTH OF EIBM-ERRCD       TO DP012-LENGTH.             15460003
154700     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              15470003
154800     IF  DP012-CALL-SUCCESSFUL                                    15480003
154900         MOVE DP012-CONVERTED-FIELD  TO EL14-EIBERRCD-HEX         15490003
155000     ELSE                                                         15500003
155100         MOVE ALL '?'                TO EL14-EIBERRCD-HEX         15510003
155200     END-IF.                                                      15520003
155300     PERFORM 5110-SET-LINE-INDEX.                                 15530003
155400     MOVE EL14-EIB-LINE-14           TO LT-ERROR-MESSAGE (LT-IDX).15540003
155500*                                                                 15550003
155600     MOVE EIBM-SYNRB                 TO DP012-CONVERSION-FIELD.   15560003
155700     MOVE LENGTH OF EIBM-SYNRB       TO DP012-LENGTH.             15570003
155800     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              15580003
155900     IF  DP012-CALL-SUCCESSFUL                                    15590003
156000         MOVE DP012-CONVERTED-FIELD  TO EL15-EIBSYNRB-HEX         15600003
156100     ELSE                                                         15610003
156200         MOVE ALL '?'                TO EL15-EIBSYNRB-HEX         15620003
156300     END-IF.                                                      15630003
156400     MOVE EIBM-NODAT                 TO DP012-CONVERSION-FIELD.   15640003
156500     MOVE LENGTH OF EIBM-NODAT       TO DP012-LENGTH.             15650003
156600     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              15660003
156700     IF  DP012-CALL-SUCCESSFUL                                    15670003
156800         MOVE DP012-CONVERTED-FIELD  TO EL15-EIBNODAT-HEX         15680003
156900     ELSE                                                         15690003
157000         MOVE ALL '?'                TO EL15-EIBNODAT-HEX         15700003
157100     END-IF.                                                      15710003
157200     PERFORM 5110-SET-LINE-INDEX.                                 15720003
157300     MOVE EL15-EIB-LINE-15           TO LT-ERROR-MESSAGE (LT-IDX).15730003
157400*                                                                 15740003
157500*                                                                 15750003
157600 5110-SET-LINE-INDEX.                                             15760003
157700     IF  LT-IDX > PC-LOG-TABLE-MAX                                15770003
157800         SET PS-LOG-OVERFLOW TO TRUE                              15780003
157900     ELSE                                                         15790003
158000         SET LT-IDX UP BY 1                                       15800003
158100     END-IF.                                                      15810003
158200*                                                                 15820003
158300*                                                                 15830003
158400******************************************************************15840003
158500**  CLEAN UP TEMP STORAGE AND VSAM (SAVED COMMAREA) FILE.       **15850003
158600******************************************************************15860003
158700 6000-CLEAN-UP-TS-AND-VSAM.                                       15870003
158800     MOVE EIBTRMID              TO TS-APPL-QUEUE-TERMINAL         15880003
158900                                   TS-APPL-MULT-QUEUE-TERM.       15890003
159000     IF  DP013-SRC-TASK-NUMBER > ZERO                             15900003
159100         MOVE DP013-SRC-TASK-NUMBER TO TS-APPL-QUEUE-TASK         15910003
159200                                       DP509-TASK-NBR             15920003
159300         MOVE EIBM-TRNID            TO PV-TRAN-ID                 15930003
159400         PERFORM 6300-DELETE-TASK-RCD                             15940003
159500         PERFORM 6100-DELETE-TS-QUEUE                             15950003
159600     END-IF.                                                      15960003
159700*                                                                 15970003
159800     PERFORM                                                      15980003
159900         VARYING DP013-STACK-INDEX                                15990003
160000         FROM 1 BY 1                                              16000003
160100         UNTIL DP013-STACK-INDEX > DP013-STACK-MAX                16010003
160200         IF  DP013-STACK-TASK-NUMBER (DP013-STACK-INDEX) > ZERO   16020003
160300             MOVE DP013-STACK-TASK-NUMBER (DP013-STACK-INDEX)     16030003
160400                                TO TS-APPL-QUEUE-TASK             16040003
160500                                   DP509-TASK-NBR                 16050003
160600             MOVE DP013-STACK-TRAN-ID (DP013-STACK-INDEX)         16060003
160700                                TO PV-TRAN-ID                     16070003
160800             PERFORM 6300-DELETE-TASK-RCD                         16080003
160900             PERFORM 6100-DELETE-TS-QUEUE                         16090003
161000             PERFORM 6200-DELETE-APPL-MULT-TS-QUEUE               16100003
161100                 VARYING TS-APPL-MULT-QUEUE-SEQ                   16110003
161200                 FROM 1 BY 1                                      16120003
161300                 UNTIL TS-APPL-MULT-QUEUE-SEQ >                   16130003
161400                                            PC-MAX-APPL-QUEUE-SEQ 16140003
161500         END-IF                                                   16150003
161600     END-PERFORM.                                                 16160003
161700*                                                                 16170003
161800******************************************************************16180003
161900**  DELETE ALL RECORDS FROM DPSAVCMK ASSOCIATED WITH THE CURRENT**16190003
162000**  NETNAME.                                                    **16200003
162100******************************************************************16210003
162200     INITIALIZE                       DP515-KEY.                  16220003
162300     EXEC CICS                                                    16230003
162400         ASSIGN                                                   16240003
162500             NETNAME (DP515-NETNAME)                              16250003
162600     END-EXEC.                                                    16260003
162700*                                                                 16270003
162800     EXEC CICS                                                    16280003
162900         DELETE                                                   16290003
163000             FILE      (FD-SAVED-COMMAREA-FILE)                   16300003
163100             RIDFLD    (DP515-KEY)                                16310003
163200             RESP      (PV-CICS-RESPONSE)                         16320003
163300             KEYLENGTH (PC-NETNAME-LENGTH)                        16330003
163400             GENERIC                                              16340003
163500             NUMREC    (PV-NETNAME-DELETE-NUMREC)                 16350003
163600     END-EXEC.                                                    16360003
163700     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      16370003
163800       OR PV-CICS-RESPONSE = DFHRESP (NOTFND)                     16380003
163900         CONTINUE                                                 16390003
164000     ELSE                                                         16400003
164100         SET DP013-CICS-ABEND          TO TRUE                    16410003
164200         SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   16420003
164300         MOVE '6000-CLEAN-UP-TS-AND-VSAM' TO DP013-PARAGRAPH      16430003
164400         MOVE 'BAD STATUS ON DELETE FROM DPSAVCMK'                16440003
164500                                       TO DP013-MESSAGE-TEXT (1)  16450003
164600         MOVE DP515-KEY                TO PV-DISPLAY-KEY          16460003
164700         MOVE 'KEYLEN='                TO PV-DISPLAY-FIELD2-HDR   16470003
164800         MOVE PC-NETNAME-LENGTH        TO PV-UNPACK-NUMERIC       16480003
164900         MOVE PV-UNPACK-NUMERIC        TO PV-DISPLAY-FIELD2       16490003
165000         MOVE 'NUMREC='                TO PV-DISPLAY-FIELD3-HDR   16500003
165100         MOVE PV-NETNAME-DELETE-NUMREC TO PV-UNPACK-NUMERIC       16510003
165200         MOVE PV-UNPACK-NUMERIC        TO PV-DISPLAY-FIELD3       16520003
165300         MOVE PV-DISPLAY-LINE-2        TO DP013-MESSAGE-TEXT (2)  16530003
165400         MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM           16540003
165500         MOVE DFHEIBLK TO DP013-DFHEIBLK                          16550003
165600         PERFORM 2000-FORMAT-ABEND-INFO                           16560003
165700         PERFORM 3000-LOG-ABEND-INFO                              16570003
165800     END-IF.                                                      16580003
165900*                                                                 16590003
166000*                                                                 16600003
166100*                                                                 16610003
166200 6100-DELETE-TS-QUEUE.                                            16620003
166300     MOVE SPACE         TO PV-SYSID.                              16630003
166400     EXEC CICS                                                    16640003
166500         DELETEQ TS                                               16650003
166600             QUEUE (TS-APPL-QUEUE-NAME)                           16660003
166700             NOHANDLE                                             16670003
166800     END-EXEC.                                                    16680003
166900******************************************************************16690003
167000*  DELETE MULTIPLE APPLICATION TEMP STORAGE QUEUES.              *16700003
167100******************************************************************16710003
167200                                                                  16720003
167300 6200-DELETE-APPL-MULT-TS-QUEUE.                                  16730003
167400         EXEC CICS                                                16740003
167500             DELETEQ TS                                           16750003
167600                 QUEUE (TS-APPL-MULT-QUEUE-ID)                    16760003
167700                 NOHANDLE                                         16770003
167800         END-EXEC.                                                16780003
167900******************************************************************16790003
168000*  DELETE AN OBJECT LOCKS HELD FOR THE TASK.                     *16800003
168100******************************************************************16810003
168200                                                                  16820003
168300 6300-DELETE-TASK-RCD.                                            16830003
168400     EXEC CICS                                                    16840003
168500         INQUIRE                                                  16850003
168600             TRANSACTION  (PC-NAVIGATOR-TRAN)                     16860003
168700             REMOTESYSTEM (PV-NAVIGATOR-SYSID)                    16870003
168800     END-EXEC.                                                    16880003
168900                                                                  16890003
169000     IF PV-NAVIGATOR-SYSID = SPACES                               16900003
169100         EXEC CICS                                                16910003
169200             DELETE                                               16920003
169300                 FILE   (PC-OBJLOK-AIX-TASK-DD)                   16930003
169400                 RIDFLD (DP509-TASK-NBR)                          16940003
169500                 RESP   (PV-CICS-RESPONSE)                        16950003
169600         END-EXEC                                                 16960003
169700     ELSE                                                         16970003
169800         MOVE LENGTH OF DP509-TASK-NBR                            16980003
169900                               TO PV-CICS-KEYLENGTH               16990003
170000         EXEC CICS                                                17000003
170100             DELETE                                               17010003
170200                 FILE      (PC-OBJLOK-AIX-TASK-DD)                17020003
170300                 RIDFLD    (DP509-TASK-NBR)                       17030003
170400                 KEYLENGTH (PV-CICS-KEYLENGTH)                    17040003
170500                 SYSID     (PV-NAVIGATOR-SYSID)                   17050003
170600                 RESP      (PV-CICS-RESPONSE)                     17060003
170700         END-EXEC                                                 17070003
170800*                                                                 17080003
170900     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       17090003
171000                         OR DFHRESP(NOTFND)                       17100003
171100         CONTINUE                                                 17110003
171200     ELSE                                                         17120003
171300         SET DP013-CICS-ABEND                                     17130003
171400             DP013-LINK-RETURN                                    17140003
171500             DP013-NO-ROLLBACK TO TRUE                            17150003
171600         MOVE '6300-DELETE-TASK-RCD'    TO DP013-PARAGRAPH        17160003
171700         MOVE 'UNSUCCESSFUL ATTEMPT TO UNLOCK OBJECTS FOR ABEND'  17170003
171800                                TO DP013-MESSAGE-TEXT (1)         17180003
171900         MOVE DP509-TASK-NBR        TO PV-PRT-TASK-NBR            17190003
172000         MOVE PV-PRT-TASK-NBR       TO DP013-MESSAGE-TEXT (2)     17200003
172100         MOVE PC-CURRENT-PROGRAM-NAME TO DP013-PROGRAM            17210003
172200         MOVE DFHEIBLK TO DP013-DFHEIBLK                          17220003
172300         PERFORM 2000-FORMAT-ABEND-INFO                           17230003
172400         PERFORM 3000-LOG-ABEND-INFO                              17240003
172500     END-IF.                                                      17250003
172600*                                                                 17260003
172700*                                                                 17270003
172800 7000-CHECK-ESCAPE-SECURITY.                                      17280003
172900*                                                                 17290003
173000     SET DP008-RSRC-TYPE-FUNC    TO TRUE.                         17300003
173100     MOVE PC-ESCAPE-FUNCTION     TO DP008-FUNCTION-NAME.          17310003
173200     SET DP008-ACCESS-TYPE-USE   TO TRUE.                         17320003
173300     EXEC CICS LINK                                               17330003
173400               PROGRAM  (DP008-SECURITY-SUBROUTINE)               17340003
173500               COMMAREA (DP008-SECURITY-COMMAREA)                 17350003
173600               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          17360003
173700     END-EXEC.                                                    17370003
173800*    SET DP008-CALL-SUCCESSFUL                                    17380003
173900*        DP008-ACCESS-ALLOWED TO TRUE.                            17390003
174000     IF  DP008-CALL-SUCCESSFUL                                    17400003
174100         IF  DP008-ACCESS-ALLOWED                                 17410003
174200             PERFORM 6000-CLEAN-UP-TS-AND-VSAM                    17420003
174300             PERFORM 8000-RETURN-ESCAPE                           17430003
174400         ELSE                                                     17440003
174500             PERFORM 6000-CLEAN-UP-TS-AND-VSAM                    17450003
174600             IF  DP013-XCTL-DISPLAY-LOGOFF                        17460003
174700                 PERFORM 8000-RETURN-LOGOFF                       17470003
174800             ELSE                                                 17480003
174900                 PERFORM 8000-RETURN-NAVIGATOR                    17490003
175000             END-IF                                               17500003
175100         END-IF                                                   17510003
175200     ELSE                                                         17520003
175300         EXEC CICS ABEND                                          17530003
175400              ABCODE(PC-ABEND-TRAN)                               17540003
175500         END-EXEC                                                 17550003
175600     END-IF.                                                      17560003
175700*                                                                 17570003
175800 8000-RETURN-ESCAPE.                                              17580003
175900     EXEC CICS                                                    17590003
176000         RETURN                                                   17600003
176100             TRANSID  (PC-ESCAPE-TRAN)                            17610003
176200     END-EXEC.                                                    17620003
176300*                                                                 17630003
176400*                                                                 17640003
176500 8000-RETURN-LOGOFF.                                              17650003
176600     EXEC CICS                                                    17660003
176700         RETURN                                                   17670003
176800             TRANSID  (PC-LOGOFF-TRAN)                            17680003
176900     END-EXEC.                                                    17690003
177000*                                                                 17700003
177100*                                                                 17710003
177200 8000-RETURN-NAVIGATOR.                                           17720003
177300     EXEC CICS                                                    17730003
177400         RETURN                                                   17740003
177500             TRANSID  (PC-NAVIGATOR-TRAN)                         17750003
177600             COMMAREA (PC-NAVIGATOR-COMMAREA)                     17760003
177700             LENGTH   (PC-NAVIGATOR-LENGTH)                       17770003
177800     END-EXEC.                                                    17780003
177900*                                                                 17790003
178000*                                                                 17800003
178100 9000-RETURN.                                                     17810003
178200     EXEC CICS                                                    17820003
178300         RETURN                                                   17830003
178400     END-EXEC.                                                    17840003
