000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.             PCKUT790.                                00040000
000500 AUTHOR.                 EKTA AGRAWAL.                            00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORE.                  00060000
000700 DATE-WRITTEN            JUN, 2010.                               00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000* THIS PROGRAM IS A MODULE USED IN THE UNITS WORKED APPLICATION.  00100000
001100* IT WILL UPDATE THE SUMMARY WORKED DATABASE FOR THE IR CATONS    00110000
001210* THAT HAS BEEN SCANNED AND INSERTED TO THE OUTBOUND  LOCATION    00121000
001220* TABLE.                                                          00122000
001230* THIS MODULE IS CALLED FROM THE SUKRF502 AND SUKCS771 PROGRAM.   00123000
001240*                                                                 00124000
001500******************************************************************00150000
001600 ENVIRONMENT DIVISION.                                            00160000
001700 DATA DIVISION.                                                   00170000
001800******************************************************************00180000
001900 WORKING-STORAGE SECTION.                                         00190000
002000                                                                  00200000
002100                                                                  00210000
002200 01  DK-DB2-KEYS.                                                 00220000
002300     05  DK-CTN                   PIC S9(18)V COMP-3 VALUE +0.    00230000
002400     05  DK-PO-NBR                PIC S9(09)  COMP VALUE +0.      00240000
002500     05  DK-PO-LINE-NBR           PIC S9(09)  COMP VALUE +0.      00250000
002600     05  DK-OPER-UNT-ID           PIC S9(04)  COMP VALUE +0.      00260000
002700     05  DK-RCVR-SEQ-NBR          PIC S9(09)  COMP VALUE +0.      00270000
002800     05  DK-BUS-DTE               PIC  X(10).                     00280000
002900     05  DK-SHIFT-NBR             PIC S9(04)  COMP VALUE +0.      00290000
003000     05  DK-PRCG-AREA-CDE         PIC  X(06).                     00300000
003100                                                                  00310000
003200*----------------------------------------------------------------*00320000
003300*  PROGRAM CONSTANTS                                             *00330000
003400*----------------------------------------------------------------*00340000
003500 01  PC-PROGRAM-CONSTANTS.                                        00350000
003600     05  PC-END-TM                PIC  X(08) VALUE '24.00.00'.    00360000
003700     05  PC-BEG-TM                PIC  X(08) VALUE '00.00.00'.    00370000
003701     05  PC-V                     PIC  X(01)  VALUE 'V'.          00370100
003800                                                                  00380000
003900*----------------------------------------------------------------*00390000
004000*  PROGRAM SWITCHES                                              *00400000
004100*----------------------------------------------------------------*00410000
004200 01  PS-PROGRAM-SWITCHES.                                         00420000
004300     05  PS-END-OF-UPC-UNLOAD-CSR-SW     PIC  X(01)  VALUE 'N'.   00430000
004400         88  PS-END-OF-UPC-UNLOAD-CSR                VALUE 'Y'.   00440000
004500         88  PS-NOT-END-OF-UPC-UNLOAD-CSR            VALUE 'N'.   00450000
004600     05  PS-CHECK-OVERLAPPING-SHFTS-SW   PIC  X(01)  VALUE 'Y'.   00460000
004700         88  PS-CONTINUE-CHECKING                    VALUE 'Y'.   00470000
004800         88  PS-DONE-CHECKING                        VALUE 'N'.   00480000
004900     05  PS-WORK-STARTED-SW              PIC  X(01)  VALUE 'N'.   00490000
005000         88  PS-NO-WORK-STARTED                      VALUE 'N'.   00500000
005100         88  PS-WORK-STARTED                         VALUE 'Y'.   00510000
005200                                                                  00520000
005300*----------------------------------------------------------------*00530000
005400*  PROGRAM VARIABLES                                             *00540000
005500*----------------------------------------------------------------*00550000
005600 01  PV-PROGRAM-VARIABLES.                                        00560000
005700                                                                  00570000
005800     05  PV-DISPLAY-PULL-NBR             PIC 999999999-.          00580000
005900     05  PV-DISPLAY-PULL-LNE-NBR         PIC 999999999-.          00590000
006000     05  PV-DISPLAY-OPER-UNT-ID          PIC 9999-.               00600000
006100     05  PV-DISPLAY-RCVR-SEQ-NBR         PIC 999999999-.          00610000
006200     05  PV-DISPLAY-SHIPT-UNT-ID         PIC 999999999999999999-. 00620000
006300     05  PV-DISPLAY-SHIFT                PIC 9999-.               00630000
006400                                                                  00640000
006500     05  PV-RCVR-WRKD-QTY                PIC S9(09) VALUE +0      00650000
006600                                                    COMP.         00660000
006610     05  PV-SHPD-UNT-QTY                 PIC S9(09) VALUE +0      00661000
006620                                                    COMP.         00662000
006700     05  PV-EXTD-RTL-AMT                 PIC S9(09)V9(2) VALUE +0 00670000
006800                                                    COMP-3.       00680000
006900     05  PV-KEY-DATE                     PIC  X(10) VALUE SPACES. 00690000
007000     05  PV-KEY-DATE-R REDEFINES PV-KEY-DATE.                     00700000
007100         10  PV-KEY-CC                   PIC  9(02).              00710000
007200         10  PV-KEY-YY                   PIC  9(02).              00720000
007300         10  PV-DASH-1                   PIC  X(01).              00730000
007400         10  PV-KEY-MM                   PIC  9(02).              00740000
007500         10  PV-DASH-2                   PIC  X(01).              00750000
007600         10  PV-KEY-DD                   PIC  9(02).              00760000
007700                                                                  00770000
007800     05  PV-UPDT-CART-QTY                PIC S9(09) VALUE +0      00780000
007900                                                    COMP.         00790000
008000     05  PV-SHFT-NBR                     PIC  S9(4) COMP.         00800000
008100     05  PV-CURRENT-TMST                 PIC  X(26)  VALUE SPACES.00810000
008200     05  PV-CURRENT-TMST-R REDEFINES PV-CURRENT-TMST.             00820000
008300         10  PV-CURR-CC                  PIC  9(02).              00830000
008400         10  PV-CURR-YY                  PIC  9(02).              00840000
008500         10  FILLER                      PIC  X(01).              00850000
008600         10  PV-CURR-MM                  PIC  9(02).              00860000
008700         10  FILLER                      PIC  X(01).              00870000
008800         10  PV-CURR-DD                  PIC  9(02).              00880000
008900         10  FILLER                      PIC  X(01).              00890000
009000         10  PV-CURR-HH                  PIC  9(02).              00900000
009100         10  FILLER                      PIC  X(01).              00910000
009200         10  PV-CURR-MN                  PIC  9(02).              00920000
009300         10  FILLER                      PIC  X(01).              00930000
009400         10  PV-CURR-SS                  PIC  9(02).              00940000
009500         10  FILLER                      PIC  X(07).              00950000
009600     05  PV-BUSINES-DATE                 PIC  X(26)  VALUE SPACES.00960000
009700     05  PV-BUSINES-DATE-R REDEFINES PV-BUSINES-DATE.             00970000
009800         10  PV-BUSN-CC                  PIC  9(02).              00980000
009900         10  PV-BUSN-YY                  PIC  9(02).              00990000
010000         10  FILLER                      PIC  X(01).              01000000
010100         10  PV-BUSN-MM                  PIC  9(02).              01010000
010200         10  FILLER                      PIC  X(01).              01020000
010300         10  PV-BUSN-DD                  PIC  9(02).              01030000
010400         10  FILLER                      PIC  X(01).              01040000
010500         10  PV-BUSN-HH                  PIC  9(02).              01050000
010600         10  FILLER                      PIC  X(01).              01060000
010700         10  PV-BUSN-MN                  PIC  9(02).              01070000
010800         10  FILLER                      PIC  X(01).              01080000
010900         10  PV-BUSN-SS                  PIC  9(02).              01090000
011000         10  FILLER                      PIC  X(07).              01100000
011100     05  PV-BUSINES-DATE-PREV            PIC  X(26)  VALUE SPACES.01110000
011200     05  PV-BUSINES-DATE-R-PREV REDEFINES PV-BUSINES-DATE-PREV.   01120000
011300         10  PV-BUSN-CC-PREV             PIC  9(02).              01130000
011400         10  PV-BUSN-YY-PREV             PIC  9(02).              01140000
011500         10  FILLER                      PIC  X(01).              01150000
011600         10  PV-BUSN-MM-PREV             PIC  9(02).              01160000
011700         10  FILLER                      PIC  X(01).              01170000
011800         10  PV-BUSN-DD-PREV             PIC  9(02).              01180000
011900         10  FILLER                      PIC  X(01).              01190000
012000         10  PV-BUSN-HH-PREV             PIC  9(02).              01200000
012100         10  FILLER                      PIC  X(01).              01210000
012200         10  PV-BUSN-MN-PREV             PIC  9(02).              01220000
012300         10  FILLER                      PIC  X(01).              01230000
012400         10  PV-BUSN-SS-PREV             PIC  9(02).              01240000
012500         10  FILLER                      PIC  X(07).              01250000
012600     05  PV-TMST                         PIC  X(26)  VALUE SPACES.01260000
012700     05  PV-TIME                         PIC  X(08)  VALUE SPACES.01270000
012800     05  PV-WRKD-TMST                    PIC  X(26)  VALUE SPACES.01280000
012900     05  PV-SHIFT-TIME                   PIC  X(08)  VALUE SPACES.01290000
013000     05  PV-SHIFT-TIME-R REDEFINES PV-SHIFT-TIME.                 01300000
013100         10  PV-SHFT-HH                  PIC  9(02).              01310000
013200         10  PV-PERIOD-1                 PIC  X(01).              01320000
013300         10  PV-SHFT-MN                  PIC  9(02).              01330000
013400         10  PV-PERIOD-2                 PIC  X(01).              01340000
013500         10  PV-SHFT-SS                  PIC  9(02).              01350000
013600     05  PV-BUSINES-DTE.                                          01360000
013700         15  PV-BUSINESS-DTE-CC          PIC  9(2).               01370000
013800         15  PV-BUSINESS-DTE-YY          PIC  9(2).               01380000
013900         15  PV-BUSINESS-DASH-1          PIC  X(1).               01390000
014000         15  PV-BUSINESS-DTE-MM          PIC  9(2).               01400000
014100         15  PV-BUSINESS-DASH-2          PIC  X(1).               01410000
014200         15  PV-BUSINESS-DTE-DD          PIC  9(2).               01420000
014300/                                                                 01430000
014310*----------------------------------------------------------------*01431000
014320*  COPYBOOK USED TO FOR ITEM ACCESS MODULE (XLKUT001)             01432000
014330*----------------------------------------------------------------*01433000
014340     COPY XLWS001.                                                01434000
014350                                                                  01435000
014500*---------------------------------------------------------------* 01450000
014600*  DB2 AREA FOR THE PCT SHIFT TABLE (PCT_SHFT)                    01460000
014700*---------------------------------------------------------------* 01470000
014800     EXEC SQL                                                     01480000
014900         INCLUDE PCT00004                                         01490000
015000     END-EXEC.                                                    01500000
015100*---------------------------------------------------------------* 01510000
015200*  DB2 AREA FOR THE PCT SUMMARY WORKED TABLE (PCT_SUM_WRKD)       01520000
015300*---------------------------------------------------------------* 01530000
015400     EXEC SQL                                                     01540000
015500         INCLUDE PCT00005                                         01550000
015600     END-EXEC.                                                    01560000
015700*---------------------------------------------------------------* 01570000
015800*  DB2 AREA FOR THE PCT RCVR LINE DETAIL TABLE                    01580000
015900*  (PCT_RCVR_LNE_DTL)                                             01590000
016000*---------------------------------------------------------------* 01600000
016100     EXEC SQL                                                     01610000
016200         INCLUDE PCT00007                                         01620000
016300     END-EXEC.                                                    01630000
016400                                                                  01640000
016500*---------------------------------------------------------------* 01650000
016600*    RECVG SYSTEMS PARM TABLE                                     01660000
016700*---------------------------------------------------------------* 01670000
016800     EXEC SQL                                                     01680000
016900         INCLUDE TKRPRPM                                          01690000
017000     END-EXEC.                                                    01700000
017100                                                                  01710000
017200*----------------------------------------------------------------*01720000
017300*   OTBND SHIPT CARTON UPC TABLE (SUT_OTBND_UPC)                  01730000
017400*----------------------------------------------------------------*01740000
017500     EXEC SQL                                                     01750000
017600         INCLUDE SUT00028                                         01760000
017700     END-EXEC.                                                    01770000
017800*----------------------------------------------------------------*01780000
017900*  COMMUNICATIONS AREA FOR DB2                                   *01790000
018000*----------------------------------------------------------------*01800000
018100     EXEC SQL                                                     01810000
018200         INCLUDE SQLCA                                            01820000
018300     END-EXEC.                                                    01830000
018400                                                                  01840000
018500*---------------------------------------------------------------* 01850000
018600*  CURSOR TO SELECT UPC FOR EACH CARTON                         * 01860000
018700*---------------------------------------------------------------* 01870000
018800     EXEC SQL                                                     01880000
018900          DECLARE UPC_UNLOAD_CSR CURSOR FOR                       01890000
019000           SELECT DISTINCT(UPC_NBR)                               01900000
019100                , TRN_NBR                                         01910000
019200                , TRN_LNE_NBR                                     01920000
019300                , SHPD_UNT_QTY                                    01930000
019400           FROM SUT_OTBND_UPC                                     01940000
019500           WHERE SHIPT_UNT_ID = :DK-CTN                           01950000
019600     END-EXEC                                                     01960000
019700******************************************************************01970000
019800 LINKAGE SECTION.                                                 01980000
019900******************************************************************01990000
020000*----------------------------------------------------------------*02000000
020100* COMMAREA USED WHEN LINKING FROM A CALLING PROGRAM               02010000
020200*----------------------------------------------------------------*02020000
020300     COPY PCWS260.                                                02030000
020900******************************************************************02090000
021000 PROCEDURE DIVISION USING PC260-COMM-AREA.                        02100000
021100******************************************************************02110000
021200 0000-PROGRAM-MAINLINE.                                           02120000
021300                                                                  02130000
021400     DISPLAY 'INSIDE THE PCKUT790'.                               02140000
021700     INITIALIZE                        DK-CTN.                    02170000
021800     MOVE PC260-SHIPT-UNT-ID        TO DK-CTN.                    02180000
021900     MOVE PC260-OPER-UNT-ID         TO DK-OPER-UNT-ID.            02190000
022000                                                                  02200000
022100* GET THE CURRENT TIME                                            02210000
022200                                                                  02220000
022300     PERFORM 8000-GET-TIMESTAMP.                                  02230000
022400                                                                  02240000
022500* OPEN UPC_UNLOAD_CSR                                             02250000
022600                                                                  02260000
022700     PERFORM 7625-OPEN-UPC-UNLOAD-CSR.                            02270000
022800                                                                  02280000
022900* FETCH UPC_UNLOAD_CSR UNTILL END OF UPC                          02290000
023000                                                                  02300000
023100     SET PS-NOT-END-OF-UPC-UNLOAD-CSR TO TRUE.                    02310000
023200     PERFORM 7630-FETCH-UPC-UNLOAD-CSR                            02320000
023300           UNTIL PS-END-OF-UPC-UNLOAD-CSR.                        02330000
023400                                                                  02340000
023500* CLOSE UPC_UNLOAD_CSR                                            02350000
023600                                                                  02360000
023700     PERFORM 7640-CLOSE-UPC-UNLOAD-CSR.                           02370000
023800                                                                  02380000
023900* RETURN TO CALLING PROGRAM AT THE END OF UPC                     02390000
024000                                                                  02400000
024100     IF PS-END-OF-UPC-UNLOAD-CSR                                  02410000
024200        GOBACK.                                                   02420000
024300*                                                                 02430000
024400 8000-GET-TIMESTAMP.                                              02440000
024500***************************************************************** 02450000
024600*  FORMAT EXAMPLE 2000-01-01-00.00.00.000000                      02460000
024700                                                                  02470000
024800*    EXEC SQL                                                     02480000
024900*        SET :PV-TMST = CURRENT TIMESTAMP                         02490000
025000*    END-EXEC.                                                    02500000
025100                                                                  02510000
025200     EXEC SQL                                                     02520000
025300         SELECT CURRENT TIMESTAMP                                 02530000
025400         INTO :PV-TMST                                            02540000
025500         FROM SYSIBM.SYSDUMMY1                                    02550000
025600     END-EXEC.                                                    02560000
025700                                                                  02570000
025800     EVALUATE TRUE                                                02580000
025900       WHEN SQLCODE = ZERO                                        02590000
026000            CONTINUE                                              02600000
026100*           MOVE PV-TMST(1:4)     TO PV-REFORMAT-TMST-DTE-CY      02610000
026200*           MOVE PV-TMST(6:2)     TO PV-REFORMAT-TMST-DTE-MM      02620000
026300*           MOVE PV-TMST(9:2)     TO PV-REFORMAT-TMST-DTE-DD      02630000
026400*           MOVE PV-TMST(1:10)    TO PV-REFORMAT-DATE-EDIT        02640000
026500*           MOVE PV-TMST(12:8)    TO PV-REFORMAT-TIME-EDIT        02650000
026600                                                                  02660000
026700       WHEN SQLWARN0 NOT EQUAL SPACE                              02670000
026800       WHEN SQLCODE NOT EQUAL ZERO                                02680000
026900            MOVE '8000-GET-TIMESTAMP'                             02690000
027000                                     TO PC260-PARAGRAPH           02700000
027100                 MOVE 'GET-TIMESTAMP'                             02710000
027200                                     TO PC260-MESSAGE-TEXT        02720000
027300                 MOVE SQLCODE        TO PC260-BAD-SQL-CDE         02730000
027400                 SET PC260-DB2-FUNCTION-SELECT TO TRUE            02740000
027500                 SET PC260-MOD-UNSUCCESSFUL    TO TRUE            02750000
027600                 GOBACK                                           02760000
027700     END-EVALUATE.                                                02770000
027800                                                                  02780000
027900*----------------------------------------------------------------*02790000
028000 7625-OPEN-UPC-UNLOAD-CSR.                                        02800000
028100******************************************************************02810000
028200                                                                  02820000
028300         EXEC SQL                                                 02830000
028400              OPEN UPC_UNLOAD_CSR                                 02840000
028500         END-EXEC                                                 02850000
028600                                                                  02860000
028700                                                                  02870000
028800         EVALUATE TRUE                                            02880000
028900             WHEN SQLCODE = ZERO                                  02890000
029000                 CONTINUE                                         02900000
029100             WHEN SQLWARN0 NOT = SPACES                           02910000
029200             WHEN SQLCODE < ZERO                                  02920000
029300             WHEN SQLCODE > ZERO                                  02930000
029400                 MOVE '7625-OPEN-UPC-UNLOAD-CSR'                  02940000
029500                                          TO PC260-PARAGRAPH      02950000
029600                 MOVE 'OPEN UPC UNLOAD CSR- '                     02960000
029700                                          TO PC260-MESSAGE-TEXT   02970000
029800                 MOVE SQLCODE             TO PC260-BAD-SQL-CDE    02980000
029900                 MOVE 'SUT_OTBND_UPC '    TO PC260-BAD-TABLE-NAME 02990000
030000                 SET PC260-DB2-FUNCTION-OPEN   TO TRUE            03000000
030100                 SET PC260-MOD-UNSUCCESSFUL    TO TRUE            03010000
030110                 GOBACK                                           03011000
030200         END-EVALUATE.                                            03020000
030300                                                                  03030000
030400 EJECT                                                            03040000
030500*----------------------------------------------------------------*03050000
030600 7630-FETCH-UPC-UNLOAD-CSR.                                       03060000
030700*----------------------------------------------------------------*03070000
030800                                                                  03080000
030900     EXEC SQL                                                     03090000
031000        FETCH UPC_UNLOAD_CSR                                      03100000
031100        INTO   :SUT00028-UPC-NBR                                  03110000
031200              ,:SUT00028-TRN-NBR                                  03120000
031300              ,:SUT00028-TRN-LNE-NBR                              03130000
031400              ,:SUT00028-SHPD-UNT-QTY                             03140000
031500     END-EXEC.                                                    03150000
031600                                                                  03160000
031700     EVALUATE TRUE                                                03170000
031800       WHEN SQLCODE = ZEROS                                       03180000
031810            MOVE SUT00028-SHPD-UNT-QTY TO PV-SHPD-UNT-QTY         03181000
032000       WHEN SQLCODE = +100                                        03200000
032100                SET  PS-END-OF-UPC-UNLOAD-CSR TO TRUE             03210000
032200       WHEN OTHER                                                 03220000
032300             MOVE '7630-FETCH-UPC-UNLOAD-CSR'                     03230000
032400                             TO PC260-PARAGRAPH                   03240000
032500             MOVE SUT00028-TRN-NBR      TO PV-DISPLAY-PULL-NBR    03250000
032600             MOVE PC260-SHIPT-UNT-ID    TO PV-DISPLAY-SHIPT-UNT-ID03260000
032700             STRING  ' PULL NBR    - ' DELIMITED BY SIZE          03270000
032800                     PV-DISPLAY-PULL-NBR                          03280000
032900                                       DELIMITED BY SIZE          03290000
033000                     ' CTN ID - '      DELIMITED BY SIZE          03300000
033100                     PV-DISPLAY-SHIPT-UNT-ID                      03310000
033200                                       DELIMITED BY SIZE          03320000
033300                             INTO PC260-MESSAGE-TEXT              03330000
033400             MOVE SQLCODE    TO PC260-BAD-SQL-CDE                 03340000
033500             MOVE 'SUT_OTBND_UPC' TO PC260-BAD-TABLE-NAME         03350000
033600             SET PC260-DB2-FUNCTION-FETCH  TO TRUE                03360000
033700             SET PC260-MOD-UNSUCCESSFUL    TO TRUE                03370000
033710             GOBACK                                               03371000
033800     END-EVALUATE.                                                03380000
033900                                                                  03390000
034000     IF PS-NOT-END-OF-UPC-UNLOAD-CSR                              03400000
034100        PERFORM 8700-GET-TKRPRPM                                  03410000
034200        PERFORM 8800-GET-SHIFT                                    03420000
034300        PERFORM 8500-GET-RTL-AMT                                  03430000
034306        PERFORM 7200-CHECK-IF-WORK-STARTED                        03430600
034400        PERFORM 6500-BUILD-LINE-DETAIL                            03440000
034500        PERFORM 6530-BUILD-PCT-SUM-WORKED                         03450000
034600     END-IF.                                                      03460000
034700                                                                  03470000
034800 8500-GET-RTL-AMT.                                                03480000
034900        INITIALIZE XL001-ITEM-COMMAREA                            03490000
035000        SET XL001-SELECT-SKU-STR                                  03500000
035100            XL001-BY-UPC-NBR             TO TRUE                  03510000
035200                                                                  03520000
035300        MOVE SUT00028-UPC-NBR            TO XL001-KEY-UPC-NBR     03530000
035400        MOVE ZEROS                       TO XL001-KEY-STR-NBR     03540000
035500        PERFORM 8600-CALL-XLKUT001.                               03550000
035600*                                                                 03560000
035700 8600-CALL-XLKUT001.                                              03570000
035800                                                                  03580000
036010     CALL XL001-VSM-PGM USING DFHEIBLK                            03601000
036020                              XL001-COMMAREA                      03602000
036030                              XL001-ITEM-COMMAREA.                03603000
036040                                                                  03604000
036100     EVALUATE TRUE                                                03610000
036200         WHEN XL001-SUCCESSFUL                                    03620000
036300              MOVE XL001-UNT-RTL-AMT    TO PV-EXTD-RTL-AMT        03630000
036400         WHEN XL001-SQL-ERROR                                     03640000
036500         WHEN XL001-INVALID-ACCESS                                03650000
036600              MOVE '8600-CALL-XLKUT001' TO PC260-PARAGRAPH        03660000
036700              MOVE SUT00028-UPC-NBR     TO PC260-MESSAGE-TEXT     03670000
036800              MOVE SQLCA                TO PC260-BAD-SQL-CDE      03680000
036900              SET PC260-MOD-UNSUCCESSFUL    TO TRUE               03690000
036910              GOBACK                                              03691000
037000         WHEN OTHER                                               03700000
037100              MOVE '8600-CALL-XLKUT001' TO PC260-PARAGRAPH        03710000
037200              MOVE SUT00028-UPC-NBR     TO PC260-MESSAGE-TEXT     03720000
037300              MOVE SQLCODE              TO PC260-BAD-SQL-CDE      03730000
037400              SET PC260-MOD-UNSUCCESSFUL    TO TRUE               03740000
037410              GOBACK                                              03741000
037500     END-EVALUATE.                                                03750000
037600*----------------------------------------------------------------*03760000
037700*    RETRIEVE THE TIMEZN SYS-PRC-FUNC-CDE TO DETERMINE THE NUMBER 03770000
037800*    OF HOURS TO ADD OR SUBTRACT FROM THE CURRENT TIME INORDER    03780000
037900*    TO BE IN THE CORRECT TIMEZONE.                               03790000
038000*----------------------------------------------------------------*03800000
038100*                                                                 03810000
038200 8700-GET-TKRPRPM.                                                03820000
038300                                                                  03830000
038400     MOVE PV-TMST       TO PV-WRKD-TMST.                          03840000
038500                                                                  03850000
038600     EXEC SQL                                                     03860000
038700         SELECT (TIMESTAMP(:PV-WRKD-TMST)  + FUNC_QTY HOURS)      03870000
038800               ,(TIMESTAMP(:PV-WRKD-TMST)  + FUNC_QTY HOURS)      03880000
038900                 + 1 DAY                                          03890000
039000               ,(TIMESTAMP(:PV-WRKD-TMST)  + FUNC_QTY HOURS)      03900000
039100                 - 1 DAY                                          03910000
039200           INTO   :PV-CURRENT-TMST                                03920000
039300                 ,:PV-BUSINES-DATE                                03930000
039400                 ,:PV-BUSINES-DATE-PREV                           03940000
039500           FROM   TKRPRPM                                         03950000
039600          WHERE LOC_ID           = :DK-OPER-UNT-ID                03960000
039700            AND INTFC_SYS_CDE    = 'KHL'                          03970000
039800            AND SYS_PRC_FUNC_CDE = 'TIMEZN'                       03980000
039900            AND FUNC_PRC_STAT_CDE = 'AC'                          03990000
040000     END-EXEC.                                                    04000000
040100                                                                  04010000
040200     EVALUATE TRUE                                                04020000
040300         WHEN SQLCODE = +0                                        04030000
040400             MOVE PV-CURR-HH  TO PV-SHFT-HH                       04040000
040500             MOVE PV-CURR-MN  TO PV-SHFT-MN                       04050000
040600             MOVE PV-CURR-SS  TO PV-SHFT-SS                       04060000
040700             MOVE '.'         TO PV-PERIOD-1                      04070000
040800                                 PV-PERIOD-2                      04080000
040900         WHEN OTHER                                               04090000
041000             MOVE '8700-GET-TKRPRPM   '   TO PC260-PARAGRAPH      04100000
041100             MOVE DK-OPER-UNT-ID                                  04110000
041200                                        TO  PV-DISPLAY-OPER-UNT-ID04120000
041300             MOVE SUT00028-TRN-NBR      TO PV-DISPLAY-PULL-NBR    04130000
041400             MOVE ZEROS                 TO PV-DISPLAY-RCVR-SEQ-NBR04140000
041500             MOVE SUT00028-TRN-LNE-NBR  TO PV-DISPLAY-PULL-LNE-NBR04150000
041510             STRING  ' OPER UNIT - '                              04151000
041520                     PV-DISPLAY-OPER-UNT-ID                       04152000
041530                     ' PULL - '                                   04153000
041540                     PV-DISPLAY-PULL-NBR                          04154000
041550                     ' RCVR SEQ - '                               04155000
041560                     PV-DISPLAY-RCVR-SEQ-NBR                      04156000
041570                     ' PULL LNE - '                               04157000
041580                     PV-DISPLAY-PULL-LNE-NBR                      04158000
042300                                       DELIMITED BY SIZE          04230000
042400                             INTO PC260-MESSAGE-TEXT              04240000
042500             MOVE SQLCODE    TO PC260-BAD-SQL-CDE                 04250000
042600             MOVE 'TKRPRPM ' TO PC260-BAD-TABLE-NAME              04260000
042700             SET PC260-DB2-FUNCTION-SELECT TO TRUE                04270000
042800             SET PC260-MOD-UNSUCCESSFUL    TO TRUE                04280000
042810             GOBACK                                               04281000
042900     END-EVALUATE.                                                04290000
043000                                                                  04300000
043100*----------------------------------------------------------------*04310000
043200*    LOOK AT SHIFT TABLE TO SEE IF DATE NEEDS TO BE INCREMENTED.  04320000
043300*----------------------------------------------------------------*04330000
043400*                                                                 04340000
043500 8800-GET-SHIFT.                                                  04350000
043600                                                                  04360000
043700     EXEC SQL                                                     04370000
043800         SELECT SHFT_NBR, SHFT_BEG_TM, SHFT_END_TM                04380000
043900           INTO :PCT00004-SHFT-NBR                                04390000
044000              , :PCT00004-SHFT-BEG-TM                             04400000
044100              , :PCT00004-SHFT-END-TM                             04410000
044200           FROM   PCT_SHFT                                        04420000
044300          WHERE OPER_UNT_ID      = :DK-OPER-UNT-ID                04430000
044400            AND ((SHFT_BEG_TM <= :PV-SHIFT-TIME                   04440000
044500            AND   SHFT_END_TM >= :PV-SHIFT-TIME)                  04450000
044600             OR  (SHFT_END_TM >= :PV-SHIFT-TIME                   04460000
044700            AND   SHFT_BEG_TM > SHFT_END_TM)                      04470000
044800             OR  (SHFT_BEG_TM <= :PV-SHIFT-TIME                   04480000
044900            AND   SHFT_BEG_TM > SHFT_END_TM))                     04490000
045000     END-EXEC.                                                    04500000
045100                                                                  04510000
045200     EVALUATE TRUE                                                04520000
045300         WHEN SQLCODE = +0                                        04530000
045400             MOVE PCT00004-SHFT-NBR     TO PV-SHFT-NBR            04540000
045500             MOVE '-'                   TO PV-DASH-1              04550000
045600                                           PV-DASH-2              04560000
045700                                           PV-BUSINESS-DASH-1     04570000
045800                                           PV-BUSINESS-DASH-2     04580000
045900             IF  PCT00004-SHFT-BEG-TM > PCT00004-SHFT-END-TM      04590000
046000                 IF PCT00004-SHFT-NBR = 2                         04600000
046100                    PERFORM 8810-CHECK-OVERLAPPING-SHIFTS         04610000
046200                 END-IF                                           04620000
046300                 IF PS-DONE-CHECKING                              04630000
046400                    CONTINUE                                      04640000
046500                 ELSE                                             04650000
046600                   IF  PV-SHIFT-TIME >= PCT00004-SHFT-BEG-TM      04660000
046700                   AND PV-SHIFT-TIME < PC-END-TM                  04670000
046800                       MOVE PV-BUSN-CC    TO PV-BUSINESS-DTE-CC   04680000
046900                                             PV-KEY-CC            04690000
047000                       MOVE PV-BUSN-YY    TO PV-BUSINESS-DTE-YY   04700000
047100                                             PV-KEY-YY            04710000
047200                       MOVE PV-BUSN-MM    TO PV-BUSINESS-DTE-MM   04720000
047300                                             PV-KEY-MM            04730000
047400                       MOVE PV-BUSN-DD    TO PV-BUSINESS-DTE-DD   04740000
047500                                             PV-KEY-DD            04750000
047600                   ELSE                                           04760000
047700                       MOVE PV-CURR-CC    TO PV-BUSINESS-DTE-CC   04770000
047800                                             PV-KEY-CC            04780000
047900                       MOVE PV-CURR-YY    TO PV-BUSINESS-DTE-YY   04790000
048000                                             PV-KEY-YY            04800000
048100                       MOVE PV-CURR-MM    TO PV-BUSINESS-DTE-MM   04810000
048200                                             PV-KEY-MM            04820000
048300                       MOVE PV-CURR-DD    TO PV-BUSINESS-DTE-DD   04830000
048400                                             PV-KEY-DD            04840000
048500                   END-IF                                         04850000
048600                 END-IF                                           04860000
048700             ELSE                                                 04870000
048800                 MOVE PV-CURR-CC        TO PV-BUSINESS-DTE-CC     04880000
048900                                           PV-KEY-CC              04890000
049000                 MOVE PV-CURR-YY        TO PV-BUSINESS-DTE-YY     04900000
049100                                           PV-KEY-YY              04910000
049200                 MOVE PV-CURR-MM        TO PV-BUSINESS-DTE-MM     04920000
049300                                           PV-KEY-MM              04930000
049400                 MOVE PV-CURR-DD        TO PV-BUSINESS-DTE-DD     04940000
049500                                           PV-KEY-DD              04950000
049600             END-IF                                               04960000
049700         WHEN SQLCODE = +100                                      04970000
049800             SET PC260-MOD-BAD-NO-SHIFT    TO TRUE                04980000
049900             SET PC260-MOD-UNSUCCESSFUL    TO TRUE                04990000
049910             GOBACK                                               04991000
050000         WHEN OTHER                                               05000000
050100             MOVE '8800-GET-SHIFT     '   TO PC260-PARAGRAPH      05010000
050200             MOVE DK-OPER-UNT-ID TO  PV-DISPLAY-OPER-UNT-ID       05020000
050300             MOVE SUT00028-TRN-NBR     TO PV-DISPLAY-PULL-NBR     05030000
050400             MOVE ZEROS                TO PV-DISPLAY-RCVR-SEQ-NBR 05040000
050500             MOVE SUT00028-TRN-LNE-NBR TO PV-DISPLAY-PULL-LNE-NBR 05050000
050600             STRING  ' OPER UNIT   - '                            05060000
050700                     PV-DISPLAY-OPER-UNT-ID                       05070000
050800                     PV-DISPLAY-PULL-NBR                          05080000
050900                     ' - '                                        05090000
051000                     PV-DISPLAY-RCVR-SEQ-NBR                      05100000
051100                     ' - '                                        05110000
051200                     PV-DISPLAY-PULL-LNE-NBR                      05120000
051300                                       DELIMITED BY SIZE          05130000
051400                             INTO PC260-MESSAGE-TEXT              05140000
051500             MOVE SQLCODE    TO PC260-BAD-SQL-CDE                 05150000
051600             MOVE 'PCT_SHFT' TO PC260-BAD-TABLE-NAME              05160000
051700             SET PC260-DB2-FUNCTION-SELECT TO TRUE                05170000
051800             SET PC260-MOD-UNSUCCESSFUL    TO TRUE                05180000
051810             GOBACK                                               05181000
051900     END-EVALUATE.                                                05190000
052000                                                                  05200000
052100 8810-CHECK-OVERLAPPING-SHIFTS.                                   05210000
052200                                                                  05220000
052300     IF  (PCT00004-SHFT-BEG-TM  < PC-END-TM AND                   05230000
052400          PCT00004-SHFT-END-TM  > PC-BEG-TM )                     05240000
052500            IF PV-SHIFT-TIME > PCT00004-SHFT-BEG-TM AND           05250000
052600               PV-SHIFT-TIME < PC-END-TM                          05260000
052700                  MOVE PV-CURR-CC        TO PV-BUSINESS-DTE-CC    05270000
052800                                            PV-KEY-CC             05280000
052900                  MOVE PV-CURR-YY        TO PV-BUSINESS-DTE-YY    05290000
053000                                            PV-KEY-YY             05300000
053100                  MOVE PV-CURR-MM        TO PV-BUSINESS-DTE-MM    05310000
053200                                            PV-KEY-MM             05320000
053300                  MOVE PV-CURR-DD        TO PV-BUSINESS-DTE-DD    05330000
053400                                            PV-KEY-DD             05340000
053500                 SET PS-DONE-CHECKING    TO TRUE                  05350000
053600            ELSE                                                  05360000
053700                 MOVE PV-BUSN-CC-PREV    TO PV-BUSINESS-DTE-CC    05370000
053800                                            PV-KEY-CC             05380000
053900                 MOVE PV-BUSN-YY-PREV    TO PV-BUSINESS-DTE-YY    05390000
054000                                            PV-KEY-YY             05400000
054100                 MOVE PV-BUSN-MM-PREV    TO PV-BUSINESS-DTE-MM    05410000
054200                                            PV-KEY-MM             05420000
054300                 MOVE PV-BUSN-DD-PREV    TO PV-BUSINESS-DTE-DD    05430000
054400                                            PV-KEY-DD             05440000
054500                 SET PS-DONE-CHECKING    TO TRUE                  05450000
054600            END-IF                                                05460000
054700     ELSE                                                         05470000
054800            SET PS-CONTINUE-CHECKING TO TRUE                      05480000
054900     END-IF.                                                      05490000
055149                                                                  05514900
055150 7200-CHECK-IF-WORK-STARTED.                                      05515000
055155                                                                  05515500
055156     INITIALIZE DK-PO-NBR                                         05515600
055157                DK-RCVR-SEQ-NBR                                   05515700
055158                DK-BUS-DTE                                        05515800
055159                DK-SHIFT-NBR                                      05515900
055160                DK-PRCG-AREA-CDE.                                 05516000
055161                                                                  05516100
055162     MOVE SUT00028-TRN-NBR        TO DK-PO-NBR.                   05516200
055163     MOVE +0                      TO DK-RCVR-SEQ-NBR.             05516300
055164     MOVE PV-BUSINES-DTE          TO DK-BUS-DTE.                  05516400
055165     MOVE PV-SHFT-NBR             TO DK-SHIFT-NBR.                05516500
055166     MOVE PC260-PRCG-AREA-CDE     TO DK-PRCG-AREA-CDE.            05516600
055167                                                                  05516700
055168     EXEC SQL                                                     05516800
055169          SELECT PO_NBR                                           05516900
055170           INTO  :PCT00007-PO-NBR                                 05517000
055171            FROM PCT_RCVR_LNE_DTL                                 05517100
055172           WHERE PO_NBR              = :DK-PO-NBR                 05517200
055173             AND RCVR_SEQ_NBR        = :DK-RCVR-SEQ-NBR           05517300
055174             AND BUS_DTE             = :DK-BUS-DTE                05517400
055175             AND SHFT_NBR            = :DK-SHIFT-NBR              05517500
055176             AND PRCG_AREA_CDE       = :DK-PRCG-AREA-CDE          05517600
055177     END-EXEC.                                                    05517700
055178                                                                  05517800
055179     EVALUATE TRUE                                                05517900
055180         WHEN SQLCODE = ZERO                                      05518000
055181         WHEN SQLCODE = -811                                      05518100
055182             SET PS-WORK-STARTED  TO TRUE                         05518200
055183         WHEN SQLCODE = +100                                      05518300
055184             SET PS-NO-WORK-STARTED  TO TRUE                      05518400
055185         WHEN SQLWARN0 NOT = SPACES                               05518500
055186         WHEN SQLCODE NOT EQUAL ZERO                              05518600
055187             MOVE '7200-CHECK-IF-WORK-STARTED'                    05518700
055188                                   TO PC260-PARAGRAPH             05518800
055189             MOVE DK-PO-NBR        TO PV-DISPLAY-PULL-NBR         05518900
055190             MOVE DK-RCVR-SEQ-NBR                                 05519000
055191                                   TO PV-DISPLAY-RCVR-SEQ-NBR     05519100
055192             MOVE DK-SHIFT-NBR     TO PV-DISPLAY-SHIFT            05519200
055193             STRING 'PULL NBR:'        DELIMITED BY SIZE          05519300
055194                 PV-DISPLAY-PULL-NBR   DELIMITED BY SIZE          05519400
055195                 'RECV SEQ: '          DELIMITED BY SIZE          05519500
055196                 PV-DISPLAY-RCVR-SEQ-NBR                          05519600
055197                                       DELIMITED BY SIZE          05519700
055198                'BUS DATE:  '          DELIMITED BY SIZE          05519800
055199                DK-BUS-DTE             DELIMITED BY SIZE          05519900
055200                'SHIFT, PROCESS AREA '                            05520000
055201                                       DELIMITED BY SIZE          05520100
055202                PV-DISPLAY-SHIFT       DELIMITED BY SIZE          05520200
055203                ' '                    DELIMITED BY SIZE          05520300
055204                DK-PRCG-AREA-CDE       DELIMITED BY SIZE          05520400
055205                           INTO PC260-MESSAGE-TEXT                05520500
055206             MOVE SQLCODE    TO PC260-BAD-SQL-CDE                 05520600
055207             MOVE 'PCT00007' TO PC260-BAD-TABLE-NAME              05520700
055208             SET PC260-DB2-FUNCTION-SELECT TO TRUE                05520800
055209             SET PC260-MOD-UNSUCCESSFUL    TO TRUE                05520900
055210             GOBACK                                               05521000
055211     END-EVALUATE.                                                05521100
055212                                                                  05521200
055213 6500-BUILD-LINE-DETAIL.                                          05521300
055220     INITIALIZE DCLPCT00007.                                      05522000
055300                                                                  05530000
055400     MOVE SUT00028-TRN-NBR        TO PCT00007-PO-NBR.             05540000
055500     MOVE +0                      TO PCT00007-RCVR-SEQ-NBR.       05550000
055600     MOVE SUT00028-TRN-LNE-NBR    TO PCT00007-PO-LNE-NBR.         05560000
055700     MOVE PC260-TRANS-TYPE-CDE    TO PCT00007-ACTN-CDE.           05570000
055800     MOVE PV-WRKD-TMST            TO PCT00007-WRKD-UNT-TMST.      05580000
055900     MOVE PV-BUSINES-DTE          TO PCT00007-BUS-DTE.            05590000
056000     MOVE PC260-OPER-UNT-ID       TO PCT00007-OPER-UNT-ID.        05600000
056100     MOVE PV-SHFT-NBR             TO PCT00007-SHFT-NBR.           05610000
056200     MOVE PC260-PRCG-AREA-CDE     TO PCT00007-PRCG-AREA-CDE.      05620000
056300     MOVE PV-SHPD-UNT-QTY         TO PCT00007-UNT-QTY.            05630000
056400     MOVE +0                      TO PCT00007-CART-QTY            05640000
056500*    MOVE PV-EXTD-RTL-AMT         TO PCT00007-EXTD-RTL-AMT        05650000
056600                                                                  05660000
056610     COMPUTE PCT00007-EXTD-RTL-AMT =                              05661000
056620             PV-EXTD-RTL-AMT * PV-SHPD-UNT-QTY                    05662000
056700     PERFORM 7300-INSERT-LINE-DETAIL.                             05670000
056800                                                                  05680000
056900 7300-INSERT-LINE-DETAIL.                                         05690000
057000                                                                  05700000
057100     EXEC SQL                                                     05710000
057200        INSERT INTO PCT_RCVR_LNE_DTL                              05720000
057300               (PO_NBR                                            05730000
057400             ,  RCVR_SEQ_NBR                                      05740000
057500             ,  PO_LNE_NBR                                        05750000
057600             ,  ACTN_CDE                                          05760000
057700             ,  WRKD_UNT_TMST                                     05770000
057800             ,  BUS_DTE                                           05780000
057900             ,  OPER_UNT_ID                                       05790000
058000             ,  SHFT_NBR                                          05800000
058100             ,  UNT_QTY                                           05810000
058200             ,  CART_QTY                                          05820000
058300             ,  PRCG_AREA_CDE                                     05830000
058400             ,  EXTD_RTL_AMT)                                     05840000
058500        VALUES (:PCT00007-PO-NBR                                  05850000
058600             ,  :PCT00007-RCVR-SEQ-NBR                            05860000
058700             ,  :PCT00007-PO-LNE-NBR                              05870000
058800             ,  :PCT00007-ACTN-CDE                                05880000
058900             ,  :PCT00007-WRKD-UNT-TMST                           05890000
059000             ,  :PCT00007-BUS-DTE                                 05900000
059100             ,  :PCT00007-OPER-UNT-ID                             05910000
059200             ,  :PCT00007-SHFT-NBR                                05920000
059300             ,  :PCT00007-UNT-QTY                                 05930000
059400             ,  :PCT00007-CART-QTY                                05940000
059500             ,  :PCT00007-PRCG-AREA-CDE                           05950000
059600             ,  :PCT00007-EXTD-RTL-AMT)                           05960000
059700     END-EXEC.                                                    05970000
059800                                                                  05980000
059900     EVALUATE TRUE                                                05990000
060000         WHEN SQLCODE = ZERO                                      06000000
060100             CONTINUE                                             06010000
060200         WHEN SQLWARN0 NOT = SPACES                               06020000
060300         WHEN SQLCODE NOT EQUAL ZERO                              06030000
060400             MOVE '7300-INSERT-LINE-DETAIL'                       06040000
060500                             TO PC260-PARAGRAPH                   06050000
060600             MOVE PCT00007-PO-NBR     TO PV-DISPLAY-PULL-NBR      06060000
060700             MOVE ZEROS                                           06070000
060800                             TO PV-DISPLAY-RCVR-SEQ-NBR           06080000
060900             MOVE PCT00007-PO-LNE-NBR TO PV-DISPLAY-PULL-LNE-NBR  06090000
061000             MOVE PCT00007-SHFT-NBR   TO PV-DISPLAY-SHIFT         06100000
061100             STRING 'PULL NBR: '         DELIMITED BY SIZE        06110000
061200                 PV-DISPLAY-PULL-NBR     DELIMITED BY SIZE        06120000
061300                 'PULL LINE NBR: '       DELIMITED BY SIZE        06130000
061400                PV-DISPLAY-PULL-LNE-NBR  DELIMITED BY SIZE        06140000
061500                           INTO PC260-MESSAGE-TEXT                06150000
061600             MOVE SQLCODE    TO PC260-BAD-SQL-CDE                 06160000
061700             MOVE 'PCT00007' TO PC260-BAD-TABLE-NAME              06170000
061800             SET PC260-DB2-FUNCTION-INSERT TO TRUE                06180000
061900             SET PC260-MOD-UNSUCCESSFUL    TO TRUE                06190000
061910             GOBACK                                               06191000
062000     END-EVALUATE.                                                06200000
062100*                                                                 06210000
062200 6530-BUILD-PCT-SUM-WORKED.                                       06220000
062300                                                                  06230000
062400     INITIALIZE DCLPCT00005.                                      06240000
062500                                                                  06250000
062600     MOVE PV-BUSINES-DTE          TO PCT00005-BUS-DTE.            06260000
062700     MOVE PC260-OPER-UNT-ID       TO PCT00005-OPER-UNT-ID.        06270000
062800     MOVE PV-SHFT-NBR             TO PCT00005-SHFT-NBR.           06280000
062900     MOVE PC260-PRCG-AREA-CDE     TO PCT00005-PRCG-AREA-CDE.      06290000
063000     MOVE PV-SHPD-UNT-QTY         TO PCT00005-UNT-WRKD-QTY.       06300000
063100     MOVE +0                      TO PCT00005-CART-WRKD-QTY.      06310000
063200*    MOVE PV-EXTD-RTL-AMT         TO PCT00005-EXTD-RTL-WRKD-AMT.  06320000
063300     IF PS-NO-WORK-STARTED                                        06330000
063400         ADD  +1                  TO PV-RCVR-WRKD-QTY             06340000
063500     ELSE                                                         06350000
063600         MOVE +0                  TO PV-RCVR-WRKD-QTY             06360000
063700     END-IF.                                                      06370000
063701                                                                  06370100
063702     COMPUTE PCT00005-EXTD-RTL-WRKD-AMT =                         06370200
063703             PV-EXTD-RTL-AMT * PV-SHPD-UNT-QTY.                   06370300
063704                                                                  06370400
063710     PERFORM 7400-UPDATE-PCT-SUM-WORK.                            06371000
063711                                                                  06371100
063720     IF SQLCODE = +100                                            06372000
063730         PERFORM 7500-INSERT-PCT-SUM-WORK                         06373000
063740     END-IF.                                                      06374000
063750                                                                  06375000
063800*    PERFORM 7500-INSERT-PCT-SUM-WORK.                            06380000
063900                                                                  06390000
063910 7400-UPDATE-PCT-SUM-WORK.                                        06391000
063920                                                                  06392000
063960     EXEC SQL                                                     06396000
063970          UPDATE PCT_SUM_WRKD                                     06397000
063980          SET    PO_RCVR_WRKD_QTY = PO_RCVR_WRKD_QTY +            06398000
063990                                                :PV-RCVR-WRKD-QTY 06399000
063991               , UNT_WRKD_QTY    = UNT_WRKD_QTY + :PV-SHPD-UNT-QTY06399100
063992               , EXTD_RTL_WRKD_AMT = EXTD_RTL_WRKD_AMT +          06399200
063993                                     :PCT00005-EXTD-RTL-WRKD-AMT  06399300
063994          WHERE  BUS_DTE          = :DK-BUS-DTE                   06399400
063995            AND  OPER_UNT_ID      = :DK-OPER-UNT-ID               06399500
063996            AND  SHFT_NBR         = :DK-SHIFT-NBR                 06399600
063997            AND  PRCG_AREA_CDE    = :DK-PRCG-AREA-CDE             06399700
063998     END-EXEC.                                                    06399800
063999                                                                  06399900
064000     EVALUATE TRUE                                                06400000
064001         WHEN SQLCODE = ZERO                                      06400100
064002         WHEN SQLCODE = +100                                      06400200
064003             CONTINUE                                             06400300
064004         WHEN SQLWARN0 NOT = SPACES                               06400400
064005         WHEN SQLCODE NOT EQUAL ZERO                              06400500
064006             MOVE '7400-UPDATE-PCT-SUM-WORK'                      06400600
064007                             TO PC260-PARAGRAPH                   06400700
064008             MOVE DK-OPER-UNT-ID   TO PV-DISPLAY-OPER-UNT-ID      06400800
064009             MOVE DK-SHIFT-NBR     TO PV-DISPLAY-SHIFT            06400900
064010             STRING 'BUSINESS DATE '   DELIMITED BY SIZE          06401000
064011                 DK-BUS-DTE            DELIMITED BY SIZE          06401100
064012                'OPER UNIT '           DELIMITED BY SIZE          06401200
064013                 PV-DISPLAY-OPER-UNT-ID                           06401300
064014                                       DELIMITED BY SIZE          06401400
064017                'SHIFT NUMBER '        DELIMITED BY SIZE          06401700
064018                 PV-DISPLAY-SHIFT      DELIMITED BY SIZE          06401800
064020                 'PROCESS AREA: '      DELIMITED BY SIZE          06402000
064021                 DK-PRCG-AREA-CDE      DELIMITED BY SIZE          06402100
064022                           INTO PC260-MESSAGE-TEXT                06402200
064024             MOVE SQLCODE    TO PC260-BAD-SQL-CDE                 06402400
064025             MOVE 'PCT00005' TO PC260-BAD-TABLE-NAME              06402500
064026                                                                  06402600
064027             SET PC260-DB2-FUNCTION-UPDATE TO TRUE                06402700
064028             SET PC260-MOD-UNSUCCESSFUL    TO TRUE                06402800
064029             GOBACK                                               06402900
064034     END-EVALUATE.                                                06403400
064035                                                                  06403500
064040 7500-INSERT-PCT-SUM-WORK.                                        06404000
064100                                                                  06410000
064200     MOVE PV-RCVR-WRKD-QTY TO PCT00005-PO-RCVR-WRKD-QTY.          06420000
064300                                                                  06430000
064400     EXEC SQL                                                     06440000
064500        INSERT INTO PCT_SUM_WRKD                                  06450000
064600               (BUS_DTE                                           06460000
064700             ,  OPER_UNT_ID                                       06470000
064800             ,  SHFT_NBR                                          06480000
064900             ,  PRCG_AREA_CDE                                     06490000
065000             ,  UNT_WRKD_QTY                                      06500000
065100             ,  CART_WRKD_QTY                                     06510000
065200             ,  PO_RCVR_WRKD_QTY                                  06520000
065300             ,  EXTD_RTL_WRKD_AMT)                                06530000
065400        VALUES (:PCT00005-BUS-DTE                                 06540000
065500             ,  :PCT00005-OPER-UNT-ID                             06550000
065600             ,  :PCT00005-SHFT-NBR                                06560000
065700             ,  :PCT00005-PRCG-AREA-CDE                           06570000
065800             ,  :PCT00005-UNT-WRKD-QTY                            06580000
065900             ,  :PCT00005-CART-WRKD-QTY                           06590000
066000             ,  :PCT00005-PO-RCVR-WRKD-QTY                        06600000
066100             ,  :PCT00005-EXTD-RTL-WRKD-AMT)                      06610000
066200     END-EXEC.                                                    06620000
066300                                                                  06630000
066400     EVALUATE TRUE                                                06640000
066500         WHEN SQLCODE = ZERO                                      06650000
066600             CONTINUE                                             06660000
066700         WHEN SQLWARN0 NOT = SPACES                               06670000
066800         WHEN SQLCODE NOT EQUAL ZERO                              06680000
066900             MOVE '7500-INSERT-PCT-SUM-WORK'                      06690000
067000                             TO PC260-PARAGRAPH                   06700000
067100             MOVE PCT00005-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID  06710000
067200             STRING 'BUSINESS DATE '   DELIMITED BY SIZE          06720000
067300                 DK-BUS-DTE            DELIMITED BY SIZE          06730000
067400                    'OPER UNIT '       DELIMITED BY SIZE          06740000
067500                 PV-DISPLAY-OPER-UNT-ID                           06750000
067600                                       DELIMITED BY SIZE          06760000
067700                           INTO PC260-MESSAGE-TEXT                06770000
067800             MOVE SQLCODE    TO PC260-BAD-SQL-CDE                 06780000
067900             MOVE 'PCT00005' TO PC260-BAD-TABLE-NAME              06790000
068000             SET PC260-DB2-FUNCTION-INSERT TO TRUE                06800000
068100             SET PC260-MOD-UNSUCCESSFUL    TO TRUE                06810000
068110             GOBACK                                               06811000
068200     END-EVALUATE.                                                06820000
068300                                                                  06830000
068400*----------------------------------------------------------------*06840000
068500 7640-CLOSE-UPC-UNLOAD-CSR.                                       06850000
068600*----------------------------------------------------------------*06860000
068700                                                                  06870000
068800         EXEC SQL                                                 06880000
068900             CLOSE UPC_UNLOAD_CSR                                 06890000
069000         END-EXEC                                                 06900000
069100                                                                  06910000
069200                                                                  06920000
069300         EVALUATE TRUE                                            06930000
069400             WHEN SQLCODE = ZERO                                  06940000
069500                 CONTINUE                                         06950000
069600             WHEN SQLWARN0 NOT = SPACES                           06960000
069700             WHEN SQLCODE < ZERO                                  06970000
069800             WHEN SQLCODE > ZERO                                  06980000
069900                 MOVE '7640-CLOSE-UPC-UNLOAD-CSR'                 06990000
070000                                   TO PC260-PARAGRAPH             07000000
070100                 MOVE 'CLOSE UPC UNLOAD CSR- '                    07010000
070200                                   TO PC260-MESSAGE-TEXT          07020000
070300             MOVE 'SUT_OTBND_UPC ' TO PC260-BAD-TABLE-NAME        07030000
070400             MOVE SQLCODE    TO PC260-BAD-SQL-CDE                 07040000
070500             SET PC260-DB2-FUNCTION-INSERT TO TRUE                07050000
070600             SET PC260-MOD-UNSUCCESSFUL    TO TRUE                07060000
070610             GOBACK                                               07061000
070700         END-EVALUATE.                                            07070000
070800                                                                  07080000
