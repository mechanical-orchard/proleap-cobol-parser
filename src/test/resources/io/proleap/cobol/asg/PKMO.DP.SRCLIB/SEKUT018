000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.      SEKUT018.                                       00040000
000500 AUTHOR.          MIKE SOMMERS.                                   00050000
000600 DATE-WRITTEN.    MAY 2005.                                       00060000
000700                                                                  00070000
000800*        READ AN IDENTITY MANAGEMENT (LDAP) EXTRACT FILE AND A    00080000
000900*        CHANGE LOWER CASE USER ID'S TO UPPER CASE.               00090000
001000                                                                  00100000
001100 ENVIRONMENT DIVISION.                                            00110000
001200 CONFIGURATION SECTION.                                           00120000
001300 SOURCE-COMPUTER. IBM-3090.                                       00130000
001400 OBJECT-COMPUTER. IBM-3090.                                       00140000
001500                                                                  00150000
001600 INPUT-OUTPUT SECTION.                                            00160000
001700 FILE-CONTROL.                                                    00170000
001800     SELECT ID-MGMT-EXTRACT-FILE-IN    ASSIGN TO INP01.           00180000
001900     SELECT ID-MGMT-EXTRACT-FILE-OUT   ASSIGN TO OUT01.           00190000
002000     EJECT                                                        00200000
002100***************                                                   00210000
002200 DATA DIVISION.                                                   00220000
002300***************                                                   00230000
002400 FILE SECTION.                                                    00240000
002500 FD  ID-MGMT-EXTRACT-FILE-IN                                      00250000
002600                             BLOCK CONTAINS 0 RECORDS,            00260000
002700                             RECORD CONTAINS 242 CHARACTERS,      00270000
002800                             RECORDING MODE IS F,                 00280000
002900                             LABEL RECORDS ARE STANDARD,          00290000
003000                             DATA RECORD IS ID-MGMT-REC-IN.       00300000
003100 01  ID-MGMT-REC-IN          PIC X(242).                          00310000
003200                                                                  00320000
003300 FD  ID-MGMT-EXTRACT-FILE-OUT                                     00330000
003400                             BLOCK CONTAINS 0 RECORDS,            00340000
003500                             RECORD CONTAINS 242 CHARACTERS,      00350000
003510                             RECORDING MODE IS F,                 00351000
003520                             LABEL RECORDS ARE STANDARD,          00352000
003530                             DATA RECORD IS ID-MGMT-REC-OUT.      00353000
003540 01  ID-MGMT-REC-OUT         PIC X(242).                          00354000
003550                                                                  00355000
003570*************************                                         00357000
003580 WORKING-STORAGE SECTION.                                         00358000
003590*************************                                         00359000
003600******************************************************************00360000
003700*   IDENTITY MANAGEMENT EXTRACT RECORD LAYOUT                     00370000
003800******************************************************************00380000
003900     COPY SERD005.                                                00390000
004000                                                                  00400000
004110 01  ABEND-CODE                      PIC S9(4)     VALUE ZEROS    00411001
004120                                                   COMP SYNC.     00412001
004130                                                                  00413001
004140 01  PS-PROGRAM-SWITCHES.                                         00414001
004150     05  PS-END-OF-LDAP-FILE-SW  PIC X(1)          VALUE 'N'.     00415001
004160         88  PS-END-OF-LDAP-FILE                   VALUE 'Y'.     00416001
004170                                                                  00417001
004200 01  PC-PROGRAM-CONSTANTS.                                        00420001
005000     05  PC-LOWER-CASE-LETTERS   PIC X(26)    VALUE               00500000
005100         'abcdefghijklmnopqrstuvwxyz'.                            00510000
005200     05  PC-UPPER-CASE-LETTERS   PIC X(26)    VALUE               00520000
005300         'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.                            00530000
005800                                                                  00580000
005900********************                                              00590000
006000 PROCEDURE DIVISION.                                              00600000
006100********************                                              00610000
006600                                                                  00660000
006700     OPEN INPUT  ID-MGMT-EXTRACT-FILE-IN.                         00670000
006800     OPEN OUTPUT ID-MGMT-EXTRACT-FILE-OUT.                        00680000
006900                                                                  00690000
007000     PERFORM A100-READ-ID-MGMT-EXTRACT-FILE.                      00700000
007100     PERFORM B100-CONVERT-CASE                                    00710000
007200         UNTIL PS-END-OF-LDAP-FILE.                               00720000
007300                                                                  00730000
007400     CLOSE ID-MGMT-EXTRACT-FILE-IN                                00740000
007500           ID-MGMT-EXTRACT-FILE-OUT.                              00750000
007600                                                                  00760000
008100     STOP RUN.                                                    00810000
008200                                                                  00820000
008300********************************                                  00830000
008400 A100-READ-ID-MGMT-EXTRACT-FILE.                                  00840000
008500********************************                                  00850000
008900     READ ID-MGMT-EXTRACT-FILE-IN                                 00890000
008910         INTO SE005-LDAP-EXTRACT                                  00891000
009000         AT END                                                   00900000
009100              SET PS-END-OF-LDAP-FILE TO TRUE                     00910000
009200     END-READ.                                                    00920000
009400                                                                  00940000
009500*******************                                               00950000
009600 B100-CONVERT-CASE.                                               00960000
009700*******************                                               00970000
009800     IF (SE005-ASSOC-USR-ID NOT = SPACES)                         00980001
010100         INSPECT SE005-ASSOC-USR-ID                               01010000
010200             CONVERTING PC-LOWER-CASE-LETTERS                     01020000
010300             TO PC-UPPER-CASE-LETTERS                             01030000
010400     END-IF.                                                      01040000
010500                                                                  01050000
010600     PERFORM D100-WRITE-OUTPUT.                                   01060000
010700                                                                  01070000
010800     PERFORM A100-READ-ID-MGMT-EXTRACT-FILE.                      01080000
011000                                                                  01100000
011100*******************                                               01110000
011200 D100-WRITE-OUTPUT.                                               01120000
011300*******************                                               01130000
011400     WRITE ID-MGMT-REC-OUT FROM SE005-LDAP-EXTRACT.               01140000
