000100*-----------------------*                                         00010018
000200 IDENTIFICATION DIVISION.                                         00020018
000300*-----------------------*                                         00030099
000400 PROGRAM-ID.    SUKCS798.                                         00040018
000500 AUTHOR.        OMAN.                                             00050018
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060018
000700 DATE-WRITTEN.  OCTOBER  2008.                                    00070018
000800 DATE-COMPILED.                                                   00080018
000900*----------------------------------------------------------------*00090018
001000*    S798  - DIRECTIVE RELEASE CRITERIA SPECIFICATION            *00100073
001100*                                                                *00110018
001200*    PROGRAM GOES TO THREE SCREENS:                              *00120073
001300*                                                                *00130073
001400*    F17 - RCVRLLST - DIRECTIVE RELEASE RECEIVER LIST SCREEN     *00140073
001500*          SULDRRCR - SUKCS768 - FUNC-01 - FORMAT - 1            *00150073
001600*          OPER UNIT ID AND PO NBR ARE REQUIRED                  *00160073
001700*                                                                *00170073
001800*    F23 - LNERLLST - DIRECTIVE RELEASE LINE/PACK ID LIST SCREEN *00180073
001900*          SULDRLNE - SUKCS799 - FUNC-02 - FORMAT - 1            *00190073
002000*          EITHER  AUDIT CONTROL NUMBER                          *00200073
002100*              OR                                                *00210073
002200*          OPER UNIT ID, PO NBR, RECEIVER NBR ARE REQUIRED       *00220073
002300*          OPTIONAL VALUES ARE THE LINE OR PACK NUMBER.          *00230073
002400*                                                                *00240073
002500*    F24 - CTNRLLST - DIRECTIVE RELEASE CARTON LIST SCREEN       *00250073
002600*          SULDIRCN - SUKCS765 - FUNC-03 - FORMAT - 1            *00260073
002700*          OPER UNIT ID, AND CARTON ID ARE REQUIRED.             *00270073
002800*---------------------------------------------------------------* 00291099
001500*    CHANGES                                                     *00292099
      *    MADE BY: CHERI PARMLEY                                      *00293099
      *    DATE:    09/25/2014                                         *00294099
      *                                                                *00295099
      *    CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#    *00296099
      *    FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *CLP 09/25/2014      *00297099
      *                                                                *00298099
001600*----------------------------------------------------------------*00299099
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00299299
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00299399
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00299499
001130*                                                                 00299599
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00299699
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00299799
263968*---------------------------------------------------------------* 00299899
003000*                                                                *00300073
003100*----------------------------------------------------------------*00310018
003200 ENVIRONMENT DIVISION.                                            00320018
003300 DATA DIVISION.                                                   00330018
003400                                                                  00340018
003500 WORKING-STORAGE SECTION.                                         00350018
003600                                                                  00360018
003700 01  DK-DB2-KEYS.                                                 00370018
003800     05  DK-OPER-UNT-ID            PIC S9(04) COMP VALUE +0.      00380018
003900     05  DK-FCLTY-ID               PIC S9(04) COMP VALUE +0.      00390018
004000     05  DK-PO-NBR                 PIC S9(09) COMP VALUE +0.      00400022
004100     05  DK-RCVR-SEQ-NBR           PIC S9(09) COMP VALUE +0.      00410022
004200     05  DK-PO-LNE-NBR             PIC S9(09) COMP VALUE +0.      00420022
004300     05  DK-PREPK-ID               PIC S9(04) COMP VALUE +0.      00430023
004400     05  DK-PACK-TYPE              PIC X(14)       VALUE SPACES.  00440022
004500     05  DK-AUD-CNTL-NBR           PIC S9(09)  COMP VALUE +0.     00450022
004600                                                                  00460086
004610     05  DK-BRCDE-NBR            PIC  X(22)          VALUE SPACES.00461086
004620     05  DK-SML-BRCDE1         REDEFINES DK-BRCDE-NBR.            00462086
004630         10  DK-SML-BRCDE1-01-02 PIC  9(02).                      00463086
004640         10  DK-SML-BRCDE1-03-20 PIC  9(18).                      00464086
004650         10  DK-SML-BRCDE1-21-22 PIC  X(02).                      00465086
004660     05  DK-SML-BRCDE2         REDEFINES DK-BRCDE-NBR.            00466086
004670         10  DK-SML-BRCDE2-01-20 PIC  9(20).                      00467086
004680         10  DK-SML-BRCDE2-21-22 PIC  X(02).                      00468086
004690     05  DK-P2L-BRCDE1         REDEFINES DK-BRCDE-NBR.            00469086
004691         10  DK-P2L-BRCDE1-01-01 PIC  9(01).                      00469186
004692         10  DK-P2L-BRCDE1-02-22 PIC  9(21).                      00469286
004693     05  DK-P2L-BRCDE2         REDEFINES DK-BRCDE-NBR.            00469386
004694         10  DK-P2L-BRCDE2-01-22 PIC  9(22).                      00469486
004700                                                                  00470018
004800 01  PV-PROGRAM-VARIABLES.                                        00480018
004900     05  PV-CICS-RESPONSE          PIC S9(08)  VALUE ZEROES       00490018
005000                                   COMP SYNC.                     00500018
005100                                                                  00510018
005200     05  PV-RETRY-COUNTER          PIC S9(04)  VALUE +0           00520038
005300                                               COMP SYNC.         00530038
005400     05  PV-CHAR-COUNT             PIC S9(04)  VALUE +0 COMP.     00540087
005410     05  PV-COUNT-DIRECTIVES       PIC S9(04)  VALUE +0           00541087
005500                                               COMP SYNC.         00550039
005600     05  PV-CURRENT-TIMESTAMP      PIC X(26) VALUE SPACES.        00560018
005700     05  PV-CURRENT-TIMESTAMP-REDEF REDEFINES                     00570018
005800                    PV-CURRENT-TIMESTAMP.                         00580018
005900         10  PV-CURRENT-DATE-FMT   PIC  X(10).                    00590018
006000         10  PV-CURRENT-HYPHEN     PIC  X(01).                    00600018
006100         10  PV-CURRENT-TIME-FMT   PIC  X(15).                    00610018
006200                                                                  00620018
006300 01  PC-PROGRAM-CONSTANTS.                                        00630018
006400     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'SUK798'.   00640018
006500     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'SUKM798'.  00650018
006600     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'SUKCS798'. 00660018
006700     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE  'DPKCS060'. 00670018
006800     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE  'SUKCS798'. 00680018
006900     05  PC-CALENDAR-MODULE        PIC  X(08)  VALUE  'DPKUT500'. 00690018
007000     05  PC-01                     PIC  X(02)  VALUE  '01'.       00700018
007100     05  PC-DC                     PIC  X(02)  VALUE  'DC'.       00710018
007200     05  PC-CAROUSEL               PIC  X(08)  VALUE  'CAROUSEL'. 00720039
007300     05  PC-A                      PIC  X(01)  VALUE  'A'.        00730018
007400     05  PC-D                      PIC  X(01)  VALUE  'D'.        00740018
007500     05  PC-N                      PIC  X(01)  VALUE  'N'.        00750018
007600     05  PC-U                      PIC  X(01)  VALUE  'U'.        00760018
007700     05  PC-Y                      PIC  X(01)  VALUE  'Y'.        00770018
007800     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00780018
007900                                               COMP-3.            00790018
008000**   FOLLOWING ARE PACK TYPE DESCRIPTIONS                         00800076
008100**                                                                00810076
008200     05  PC-MULTIPLE-SKU-PPK       PIC  X(20)  VALUE              00820053
008300         'M-MULTI SKU PREPACK '.                                  00830053
008400     05  PC-SINGLE-SKU-PPK         PIC  X(20)  VALUE              00840053
008500         'S-SINGLE SKU PREPACK'.                                  00850053
008600     05  PC-INNER-PPK              PIC  X(20)  VALUE              00860053
008700         'I-INNER PREPACK     '.                                  00870053
008800     05  PC-BULK-PPK               PIC  X(20)  VALUE              00880053
008900         'B-BULK PACK         '.                                  00890053
009000     05  PC-CASEPACK               PIC  X(20)  VALUE              00900053
009100         'C-CASEPACK          '.                                  00910053
009200     05  PC-PACK-BY-STORE          PIC  X(20)  VALUE              00920067
009300         'PACK BY STORE       '.                                  00930053
009400     05  PC-OTHER                  PIC  X(20)  VALUE              00940066
009500         'OTHER - ?????       '.                                  00950066
009600*                                                                 00960018
009700 01  PS-PROGRAM-SWITCHES.                                         00970018
009800     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00980018
009900         88  PS-ERROR                          VALUE  'Y'.        00990018
010000         88  PS-NO-ERROR                       VALUE  'N'.        01000018
010100     05  PS-PREVIOUS-ERROR-SW      PIC  X(01)  VALUE  'N'.        01010099
010200         88  PS-PREVIOUS-ERROR                 VALUE  'Y'.        01020099
010310     05  PS-CARTON-ERROR-SW        PIC  X(01)  VALUE  'N'.        01031087
010320         88  PS-CARTON-ERROR                   VALUE  'Y'.        01032087
010330         88  PS-NO-CARTON-ERROR                VALUE  'N'.        01033087
010340     05  PS-CARTON-MSG-SW          PIC  X(01)  VALUE  ' '.        01034087
010350         88  PS-CARTON-MSG1                    VALUE  '1'.        01035087
010351         88  PS-CARTON-MSG2                    VALUE  '2'.        01035187
010352         88  PS-CARTON-MSG3                    VALUE  '3'.        01035287
010353         88  PS-CARTON-MSG4                    VALUE  '4'.        01035387
011300                                                                  01130018
011400*----------------------------------------------------------------*01140018
011500*  SYSTEM MESSAGES                                               *01150018
011600*----------------------------------------------------------------*01160018
011700*   00005 - INVALID VALUE                                         01170018
011800*   00007 - REQUIRED ENTRY                                        01180018
011900*   00008 - MUST BE NUMERIC                                       01190018
012000*   02571 - UNABLE TO UPD - CURRENT OPER UNT AND OPER UNIT ID ENTE01200018
012100*   02572 - INVALID VALUE - OPER UNIT ID MUST BE A DC LOCATION    01210018
012200*   02573 - ADD FUNCTION INVALID - DOOR ALREADY DEFINED FOR THE DC01220018
012300*   02574 - UPDATE FUNCTION INVALID - DOOR IS CURRENTLY NOT DEFINE01230018
012400*   02575 - STORE ASSIGNMNT FUNCTION ONLY VALID FOR DOOR TYPES SHI01240018
012500*----------------------------------------------------------------*01250018
012600 01  PC-TSYMSG-NUMBERS.                                           01260018
012700     05  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.          01270018
012800     05  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.          01280018
012900     05  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.          01290018
013000     05  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.          01300018
013010     05  PC-TSYMSG-00010       PIC  9(05)  VALUE  00010.          01301099
013100     05  PC-TSYMSG-01202       PIC  9(05)  VALUE  01202.          01310059
013200     05  PC-TSYMSG-01298       PIC  9(05)  VALUE  01298.          01320059
013300     05  PC-TSYMSG-01729       PIC  9(05)  VALUE  01729.          01330024
013400     05  PC-TSYMSG-02572       PIC  9(05)  VALUE  02572.          01340018
013500     05  PC-TSYMSG-02918       PIC  9(05)  VALUE  02918.          01350024
013600     05  PC-TSYMSG-03638       PIC  9(05)  VALUE  03638.          01360024
013700     05  PC-TSYMSG-03647       PIC  9(05)  VALUE  03647.          01370024
013800*                                                                 01380018
013900 01  PM-PROGRAM-MESSAGES.                                         01390018
014000     05  PM-ABEND-INFO-A.                                         01400018
014100         10  FILLER                PIC X(15)   VALUE              01410018
014200                                   'DP020-SRC-AID: '.             01420018
014300         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      01430018
014400         10  FILLER                PIC X(19)   VALUE              01440018
014500                                   '. DP020-FK-ACTION: '.         01450018
014600         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      01460018
014700         10  FILLER                PIC X(22)   VALUE              01470018
014800                                   '. DP020-FK-DISPN-IND: '.      01480018
014900         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      01490018
015000         10  FILLER                PIC X(01)   VALUE '.'.         01500018
015100         10  FILLER                PIC X(19)   VALUE SPACE.       01510018
015200                                                                  01520018
015300*----------------------------------------------------------------*01530018
015400*    MAP LAYOUT                                                  *01540018
015500*----------------------------------------------------------------*01550018
015600     COPY SUKM798.                                                01560018
015700                                                                  01570018
015800*----------------------------------------------------------------*01580018
015900*    ATTRIBUTE SETTINGS COPYBOOK.                                *01590018
016000*----------------------------------------------------------------*01600018
016100     COPY DPWS015.                                                01610018
016200                                                                  01620018
016300*----------------------------------------------------------------*01630018
016400*    FUNCTION KEYS COPYBOOK                                      *01640018
016500*----------------------------------------------------------------*01650018
016600     COPY DPWS016.                                                01660018
016700                                                                  01670018
016800******************************************************************01680018
016900** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01690018
017000** SUB-ROUTINE (DPKUT100).                                      **01700018
017100******************************************************************01710018
017200     COPY DPWS010I.                                               01720018
017300                                                                  01730018
017400******************************************************************01740018
017500**  DPKUT500 DATE VALIDATION SUBROUTINE                         **01750018
017600******************************************************************01760018
017700     COPY DPWS500.                                                01770018
017800                                                                  01780018
017900******************************************************************01790018
018100** PARAMETERS FOR CALLING CICS ARCHITECTURE API                 **01810099
018200******************************************************************01820018
018300     COPY DPWS030.                                                01830018
018300     COPY DPWS930.                                                01831099
018400                                                                  01840018
018500***************************************************************** 01850018
018600*    STANDARD COMMAREA.                                           01860018
018700***************************************************************** 01870018
018800     COPY DPWS020.                                                01880018
018900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01890018
019000                                                                  01900018
019100***************************************************************** 01910018
019200*    INTER-APPLICATION COMMAREA.                                  01920018
019300***************************************************************** 01930018
019400         10  INTER-APPL-COMM-AREA PIC X(200).                     01940018
019500     COPY SUWS097.                                                01950019
019600                                                                  01960018
019700***************************************************************** 01970018
019800*    SPECIFIC COMMAREA FOR SUKCS798.                              01980018
019900***************************************************************** 01990018
020000         10  ASC-SPECIFIC-COMMAREA.                               02000018
020100             15  ASC-OPER-UNT-ID             PIC  X(04).          02010018
020200             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID      02020018
020300                                             PIC  9(04).          02030018
020400             15  ASC-FCLTY-ID                PIC  X(04).          02040018
020500             15  ASC-FCLTY-ID-N REDEFINES ASC-FCLTY-ID            02050018
020600                                             PIC  Z(04).          02060018
020700             15  ASC-FCLTY-NME               PIC  X(25).          02070018
      *CLP 09/25/2014                                                   02071099
020800             15  ASC-PO-NBR                  PIC  X(08).          02080099
020900             15  ASC-PO-NBR-N REDEFINES ASC-PO-NBR                02090020
021000                                             PIC  9(08).          02100099
021100             15  ASC-RCVR-SEQ-NBR            PIC  X(04).          02110032
021200             15  ASC-RCVR-SEQ-NBR-N REDEFINES ASC-RCVR-SEQ-NBR    02120024
021300                                             PIC  9(04).          02130032
021400             15  ASC-PO-LNE-NBR              PIC  X(04).          02140032
021500             15  ASC-PO-LNE-NBR-N REDEFINES ASC-PO-LNE-NBR        02150032
021600                                             PIC  9(04).          02160032
021700             15  ASC-PACK-TYPE               PIC  X(20).          02170066
021800             15  ASC-PREPK-ID                PIC  X(04).          02180026
021900             15  ASC-PREPK-ID-N REDEFINES ASC-PREPK-ID            02190026
022000                                             PIC  9(04).          02200026
022100             15  ASC-AUD-CNTL-NBR            PIC  X(09).          02210026
022200             15  ASC-AUD-CNTL-NBR-N REDEFINES ASC-AUD-CNTL-NBR    02220026
022300                                             PIC  9(09).          02230026
022400             15  ASC-BRCDE-NBR               PIC  X(22).          02240026
022700             15  ASC-COUNT-DIRECTIVES        PIC  9(09).          02270076
022800             15  ASC-FUNCTION                PIC  X(01).          02280026
022900             15  FILLER                      PIC  X(40).          02290026
023000                                                                  02300018
023100*----------------------------------------------------------------*02310018
023200*    ABEND PROCESSING COPYBOOK.                                  *02320018
023300*----------------------------------------------------------------*02330018
023400     COPY DPWS013.                                                02340018
023500                                                                  02350018
023600*----------------------------------------------------------------*02360018
023700*    COMMAREA USED TO CALL XLKUT071                               02370018
023800*----------------------------------------------------------------*02380018
023900     COPY XLWS071.                                                02390018
024000                                                                  02400018
024100*----------------------------------------------------------------*02410018
024200*  COMMUNICATION AREAS FOR DB2                                    02420018
024300*----------------------------------------------------------------*02430018
024400     EXEC SQL                                                     02440018
024500         INCLUDE SQLCA                                            02450018
024600     END-EXEC.                                                    02460018
024700                                                                  02470020
024800*----------------------------------------------------------------*02480020
024900*                                                                 02490020
025000*----------------------------------------------------------------*02500020
025100     EXEC SQL                                                     02510020
025200         INCLUDE TRECEIV                                          02520020
025300     END-EXEC.                                                    02530020
025400                                                                  02540020
025500*----------------------------------------------------------------*02550020
025600*                                                                 02560020
025700*----------------------------------------------------------------*02570020
025800     EXEC SQL                                                     02580020
025900         INCLUDE TPURCHS                                          02590020
026000     END-EXEC.                                                    02600020
026100                                                                  02610020
026200*----------------------------------------------------------------*02620020
026300*                                                                 02630020
026400*----------------------------------------------------------------*02640020
026500     EXEC SQL                                                     02650020
026600         INCLUDE TRECITM                                          02660022
026700     END-EXEC.                                                    02670020
026800/                                                                 02680099
027600*----------------------------------------------------------------*02760022
027700*                                                                 02770022
027800*----------------------------------------------------------------*02780022
027900     EXEC SQL                                                     02790022
028000         INCLUDE SUT00102                                         02800022
028100     END-EXEC.                                                    02810022
028200/                                                                 02820099
028210*----------------------------------------------------------------*02821099
028220*    DB2 TABLE                                                    02822099
028230*----------------------------------------------------------------*02823099
028240     EXEC SQL                                                     02824099
028250          INCLUDE SUT00015                                        02825099
028260     END-EXEC.                                                    02826099
028270                                                                  02827099
028280*----------------------------------------------------------------*02828099
028290*    DB2 TABLE                                                    02829099
028291*----------------------------------------------------------------*02829199
028292     EXEC SQL                                                     02829299
028293          INCLUDE TSUCRDV                                         02829399
028294     END-EXEC.                                                    02829499
028295                                                                  02829599
028300/                                                                 02830099
028400 LINKAGE SECTION.                                                 02840018
028500                                                                  02850018
028600 01  DFHCOMMAREA.                                                 02860018
028700     05  FILLER                         OCCURS  1 TO 4072 TIMES   02870018
028800                                        DEPENDING ON EIBCALEN.    02880018
028900         10  FILLER                     PIC X.                    02890018
029000/                                                                 02900099
029200 PROCEDURE DIVISION.                                              02920018
029300***************************************************************** 02930018
029400** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02940018
029500** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02950018
029600** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02960018
029700**                                                             ** 02970018
029800** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02980018
029900** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 02990018
030000***************************************************************** 03000018
030100 0000-MAIN-MODULE.                                                03010018
030200     INITIALIZE DP030-CICS-API-FIELDS.                            03020018
030300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03030018
030400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03040018
030500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03050018
030600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03060018
030700     MOVE LENGTH OF SUK798I       TO DP030-MAP-LENGTH (1).        03070018
030800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03080018
030900     PERFORM 0001-CALL-CICS-ARCH-API.                             03090018
031000*                                                                 03100018
031100     PERFORM 1000-CONTROL-PROCESSING                              03110018
031200*                                                                 03120018
031300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03130018
031400     PERFORM 0001-CALL-CICS-ARCH-API.                             03140018
031500                                                                  03150018
031600*---------------------------------------------------------------- 03160018
031700 0001-CALL-CICS-ARCH-API.                                         03170018
031800*    CALL 'DPKCS030' USING DFHEIBLK                               03180099
031800     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03181099
031900                           DFHCOMMAREA                            03190018
032000                           DP030-CICS-API-FIELDS                  03200018
032100                           DP020-STANDARD-COMMAREA                03210018
032200                           SUK798I.                               03220018
032300*                                                                 03230018
032400     IF  DP030-RC-CALL-SUCCESSFUL                                 03240018
032500         CONTINUE                                                 03250018
032600     ELSE                                                         03260018
032700         SET DP013-NO-ROLLBACK                                    03270018
032800             DP013-XCTL-DISPLAY-RESTART                           03280018
032900             DP013-CICS-ABEND      TO TRUE                        03290018
033000         MOVE 'BEFORE 0000-MAIN-MODULE'                           03300018
033100                                   TO DP013-PARAGRAPH             03310018
033200*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX03320099
033300*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      03330099
033200         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03331099
033300-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03332099
033400         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      03340018
033500         PERFORM DP013-0000-PROCESS-ABEND                         03350018
033600     END-IF.                                                      03360018
033700                                                                  03370018
033800*----------------------------------------------------------------*03380018
033900*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03390018
034000*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03400018
034100*----------------------------------------------------------------*03410018
034200 1000-CONTROL-PROCESSING.                                         03420018
034300                                                                  03430018
034400     EVALUATE TRUE                                                03440018
034500         WHEN DP020-NEXT-ACT-INITIAL                              03450018
034600**  WHEN 1ST COMING TO THIS SCREEN                                03460099
034700             INITIALIZE ASC-SPECIFIC-COMMAREA                     03470018
034800             MOVE DP020-LOCATION-NBR TO ASC-OPER-UNT-ID           03480018
034900             MOVE -1                 TO APONBRL                   03490077
035000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  03500018
035100             PERFORM 4000-BUILD-INITIAL-PANEL                     03510018
035200             PERFORM 3200-RESET-ATTRIBUTES                        03520018
035300                                                                  03530018
035400         WHEN DP020-NEXT-ACT-RETURN                               03540018
035500**  WHEN RETURNING FROM ANOTHER SCREEN                            03550099
035510             INITIALIZE ASC-SPECIFIC-COMMAREA                     03551099
035520             MOVE DP020-LOCATION-NBR TO ASC-OPER-UNT-ID           03552099
035530             MOVE -1                 TO APONBRL                   03553099
035540             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  03554099
035550             PERFORM 4000-BUILD-INITIAL-PANEL                     03555099
035900             PERFORM 3200-RESET-ATTRIBUTES                        03590018
036000                                                                  03600018
036100         WHEN DP020-NEXT-ACT-READ-MAP                             03610018
036200**  WHEN DOING ANYTHING ON CURRENT SCREEN INCLUDING               03620099
036300**  PRESSING FKEYS TO GO TO ANOTHER SCREEN                        03630099
036400             PERFORM 2000-FKEY-PROCESSING                         03640018
036500                                                                  03650018
036600         WHEN OTHER                                               03660018
036700             SET DP013-LOGIC-ABEND                                03670018
036800                 DP013-NO-ROLLBACK TO TRUE                        03680018
036900             MOVE 'SUKCS798 - 1000-CONTROL-PROCESSING'            03690018
037000                                   TO  DP013-PARAGRAPH            03700018
037100             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   03710018
037200                                   TO  DP013-MESSAGE-TEXT(1)      03720018
037300             MOVE DP020-NEXT-APPL-ACTIVITY                        03730018
037400                                   TO DP013-MESSAGE-TEXT(2)       03740018
037500             PERFORM DP013-0000-PROCESS-ABEND                     03750018
037600     END-EVALUATE.                                                03760018
037700                                                                  03770018
037800*----------------------------------------------------------------*03780018
037900* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*03790018
038000* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*03800018
038100* EDITS.                                                         *03810018
038200*----------------------------------------------------------------*03820018
038300 2000-FKEY-PROCESSING.                                            03830018
038400                                                                  03840018
038500     EVALUATE TRUE                                                03850018
038510*                                                                 03851099
038520*CLEAR                                                            03852099
038530*                                                                 03853099
038700         WHEN DP020-SRC-AID = DP016-CLEAR                         03870018
038710             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03871099
038800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03880018
038901*                                                                 03890199
038902*ENTER                                                            03890299
038903*                                                                 03890399
038905         WHEN DP020-SRC-AID = DP016-ENTER                         03890599
038906             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03890699
038907             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03890799
038920*                                                                 03892099
039100*F5-REFRESH                                                       03910018
039110*                                                                 03911099
039200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03920018
039300             INITIALIZE ASC-SPECIFIC-COMMAREA                     03930018
039400             MOVE SPACES      TO AOPRUNTO                         03940018
039500                                 AOPRNMEO                         03950018
039600                                 APONBRO                          03960020
039700                                 ARCVNBRO                         03970020
039800                                 ALNENBRO                         03980020
039900                                 ARPCKTPO                         03990020
040000                                 APRPKIDO                         04000028
040100                                 AAUDNBRO                         04010065
040200                                 ACTNIDO                          04020064
040300                                 ADRLSDCO                         04030020
040400             MOVE DP020-LOCATION-NBR TO ASC-OPER-UNT-ID           04040018
040500             PERFORM 4000-BUILD-INITIAL-PANEL                     04050018
040600             PERFORM 3200-RESET-ATTRIBUTES                        04060018
040610             MOVE -1 TO APONBRL                                   04061099
040700                                                                  04070018
040800         WHEN OTHER                                               04080018
040900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 04090018
041000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04100018
041100             IF  ( PS-ERROR )                                     04110099
041110                  SET DP030-OVERRIDE-GO TO TRUE                   04111099
041120             ELSE                                                 04112099
041200                  SET DP030-CONTINUE-GO TO TRUE                   04120099
041300                  PERFORM 2100-CHECK-FUNCTION-KEY                 04130099
041400                  IF ( PS-ERROR )                                 04140099
041500                     SET DP030-OVERRIDE-GO TO TRUE                04150018
041600                  END-IF                                          04160099
041900             END-IF                                               04190018
042000     END-EVALUATE.                                                04200018
042100/                                                                 04210099
042200******************************************************************04220018
042300** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **04230018
042400** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **04240018
042500** FROM THE CICS ARCHITECTURE API.                              **04250018
042600******************************************************************04260018
042700 2100-CHECK-FUNCTION-KEY.                                         04270018
042710                                                                  04271099
042800     EVALUATE TRUE                                                04280018
043100*                                                                 04310099
043200*F17 RCVRLIST ----> (SULDRRCL) GOES TO SUKCS768                   04320055
043300*                    DIRECTIVE RELEASE RECEIVER LIST              04330057
043310*                                                                 04331099
043400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              04340018
043410              PERFORM 3001-F17-RELATIONAL-EDITS                   04341099
043420              IF ( PS-ERROR )                                     04342099
043421                  SET DP030-OVERRIDE-GO TO TRUE                   04342199
043422             ELSE                                                 04342299
043423                  SET DP030-CONTINUE-GO TO TRUE                   04342399
043500                  PERFORM 2110-PREPARE-INTER-APPL-COMM            04350099
043600                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            04360099
043610             END-IF                                               04361099
043620*                                                                 04362099
043800*F23 LNERLLST ----> (SULDRLNE) GOES TO SUKCS799                   04380055
043900*                    DIRECTIVE RELEASE LINE / PACK ID LIST        04390057
043910*                                                                 04391099
044000         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              04400055
044010              PERFORM 3002-F23-RELATIONAL-EDITS                   04401099
044020              IF ( PS-ERROR )                                     04402099
044030                  SET DP030-OVERRIDE-GO TO TRUE                   04403099
044040             ELSE                                                 04404099
044050                  SET DP030-CONTINUE-GO TO TRUE                   04405099
044060                  PERFORM 2110-PREPARE-INTER-APPL-COMM            04406099
044070                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            04407099
044080             END-IF                                               04408099
044090*                                                                 04409099
044400*F24 CTNRLLST ----> (SULDIRCN) GOES TO SUKCS765                   04440057
044500*                    DIRECTIVE RELEASE CARTON LIST                04450057
044510*                                                                 04451099
044600         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              04460055
044610              PERFORM 3003-F24-RELATIONAL-EDITS                   04461099
044620              IF ( PS-ERROR )                                     04462099
044630                  SET DP030-OVERRIDE-GO TO TRUE                   04463099
044640             ELSE                                                 04464099
044650                  SET DP030-CONTINUE-GO TO TRUE                   04465099
044660                  PERFORM 2110-PREPARE-INTER-APPL-COMM            04466099
044670                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            04467099
044680             END-IF                                               04468099
046200     END-EVALUATE.                                                04620018
046300/                                                                 04630099
046400******************************************************************04640018
046500** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **04650018
046600** INTER-APPLICATION COMMAREA.                                  **04660018
046700******************************************************************04670018
046800 2110-PREPARE-INTER-APPL-COMM.                                    04680018
046900                                                                  04690018
047000     INITIALIZE SU097-INTER-APPL-COMMAREA.                        04700024
047100                                                                  04710018
047200     MOVE ASC-OPER-UNT-ID          TO SU097-OPER-UNT-ID.          04720024
047300     MOVE ASC-FCLTY-NME            TO SU097-FCLTY-NME.            04730024
047400     MOVE ASC-PO-NBR               TO SU097-PO-NBR.               04740048
047500     MOVE ASC-RCVR-SEQ-NBR         TO SU097-RCVR-SEQ-NBR.         04750048
047600     MOVE ASC-PO-LNE-NBR           TO SU097-PO-LNE-NBR.           04760048
047700     MOVE ASC-PREPK-ID             TO SU097-PREPACK-ID.           04770049
047800     MOVE ASC-AUD-CNTL-NBR         TO SU097-AUD-CNTL-NBR.         04780048
047900     MOVE ASC-BRCDE-NBR            TO SU097-BRCDE-NBR.            04790048
048000     MOVE ASC-PACK-TYPE            TO SU097-PACK-TYPE.            04800075
048100/                                                                 04810099
048200******************************************************************04820099
048210* 2200-MOVE-SCREEN-TO-COMMAREA                                   *04821099
048300* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*04830018
048400* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *04840018
048401* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *04840199
048410******************************************************************04841099
048700 2200-MOVE-SCREEN-TO-COMMAREA.                                    04870018
048710*                                                                 04871099
048800*OPER UNT ID                                                      04880018
048810*                                                                 04881099
048900     IF  AOPRUNTL > ZERO                                          04890018
049000         MOVE AOPRUNTI      TO ASC-OPER-UNT-ID                    04900018
049100     ELSE                                                         04910018
049200         IF AOPRUNTF = DP015-ERASE-EOF                            04920018
049300            MOVE SPACES      TO ASC-OPER-UNT-ID                   04930018
049400         END-IF                                                   04940018
049500     END-IF.                                                      04950018
049510*                                                                 04951099
049700*PO NUMBER                                                        04970020
049710*                                                                 04971099
049800     IF  APONBRL > ZERO                                           04980020
049900         MOVE APONBRI       TO ASC-PO-NBR                         04990020
050000     ELSE                                                         05000018
050100         IF APONBRF = DP015-ERASE-EOF                             05010020
050200            MOVE SPACES      TO ASC-PO-NBR                        05020020
050300         END-IF                                                   05030018
050400     END-IF.                                                      05040018
050410*                                                                 05041099
050600*RECEIVER NUMBER                                                  05060020
050610*                                                                 05061099
050700     IF  ARCVNBRL > ZERO                                          05070020
050800         MOVE ARCVNBRI             TO ASC-RCVR-SEQ-NBR            05080031
050900     ELSE                                                         05090018
051000         IF  ARCVNBRF = DP015-ERASE-EOF                           05100020
051100             MOVE SPACE            TO ASC-RCVR-SEQ-NBR            05110031
051200         END-IF                                                   05120018
051300     END-IF.                                                      05130018
051310*                                                                 05131099
051500*LINE NUMBER                                                      05150020
051510*                                                                 05151099
051600     IF  ALNENBRL > ZERO                                          05160020
051700         MOVE ALNENBRI             TO ASC-PO-LNE-NBR              05170031
051800     ELSE                                                         05180018
051900         IF  ALNENBRF = DP015-ERASE-EOF                           05190020
052000             MOVE SPACE            TO ASC-PO-LNE-NBR              05200031
052100         END-IF                                                   05210018
052200     END-IF.                                                      05220018
052210*                                                                 05221099
052400* PACK ID                                                         05240020
052410*                                                                 05241099
052500     IF  APRPKIDL > ZERO                                          05250024
052600         MOVE APRPKIDI             TO ASC-PREPK-ID                05260024
052700     ELSE                                                         05270018
052800         IF  APRPKIDF = DP015-ERASE-EOF                           05280024
052900             MOVE SPACE            TO ASC-PREPK-ID                05290024
053000         END-IF                                                   05300018
053100     END-IF.                                                      05310018
053110*                                                                 05311099
053300* PROMPTED AUDIT                                                  05330020
053310*                                                                 05331099
053400     IF  AAUDNBRL > ZERO                                          05340065
053500         MOVE AAUDNBRI             TO ASC-AUD-CNTL-NBR            05350065
053600     ELSE                                                         05360018
053700         IF  AAUDNBRF = DP015-ERASE-EOF                           05370065
053800             MOVE SPACE            TO ASC-AUD-CNTL-NBR            05380020
053900         END-IF                                                   05390018
054000     END-IF.                                                      05400018
054010*                                                                 05401099
054200* CARTON ID                                                       05420020
054210*                                                                 05421099
054300     IF  ACTNIDL > ZERO                                           05430064
054400         MOVE ACTNIDI              TO ASC-BRCDE-NBR               05440064
054500     ELSE                                                         05450018
054600         IF  ACTNIDF = DP015-ERASE-EOF                            05460064
054700             MOVE SPACE            TO ASC-BRCDE-NBR               05470020
054800         END-IF                                                   05480018
054900     END-IF.                                                      05490018
055000/                                                                 05500099
055200******************************************************************05520018
055300* 3000-EDIT-DATA-IN-COMMAREA                                     *05530099
055400*     EDIT ENTERED FIELDS FOR VALID VALUES ONLY. RELATIONAL EDITS*05540099
055500* FOR PF KEY TRANSFERS ARE DONE IN PARA 3001-                    *05550099
055700******************************************************************05570018
055800 3000-EDIT-DATA-IN-COMMAREA.                                      05580018
055810                                                                  05581099
055900     PERFORM 3200-RESET-ATTRIBUTES.                               05590018
056000                                                                  05600099
056120     PERFORM 3010-VALIDATE-OPER-UNT-ID.                           05612099
060200     PERFORM 3020-VALIDATE-PO-NBR.                                06020099
060250     PERFORM 3030-VALIDATE-RECEIVER-NBR.                          06025099
060301     PERFORM 3040-VALIDATE-PO-LINE-NBR.                           06030199
060307     PERFORM 3050-VALIDATE-PACK-ID.                               06030799
060308     PERFORM 3055-VALIDATE-LINE-OR-PACK.                          06030899
060313     PERFORM 3060-VALIDATE-CNTL-NBR.                              06031399
060319     PERFORM 3070-VALIDATE-CARTON-ID.                             06031999
060330                                                                  06033099
060340     IF ( PS-NO-ERROR )                                           06034099
060341         MOVE -1 TO APONBRL                                       06034199
060350     END-IF.                                                      06035099
071000/                                                                 07100099
071100******************************************************************07110099
071110* 3001-F17-RELATIONAL-EDITS                                      *07111099
071120*     DETERMINE IF DATA COMBINATIONS ENTERED ARE OK BEFORE ALLOW-*07112099
071130* ING A PFKEY TRANSFER.                                          *07113099
071140******************************************************************07114099
071150 3001-F17-RELATIONAL-EDITS.                                       07115099
071160                                                                  07116099
071170     IF ( ASC-OPER-UNT-ID > SPACES ) AND                          07117099
071246        ( ASC-PO-NBR      > SPACES )                              07124699
071247         CONTINUE                                                 07124799
071248     ELSE                                                         07124899
071252         SET PS-ERROR                                             07125299
071253             DP020-MSG-FATAL         TO TRUE                      07125399
071254         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          07125499
071255         MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA                  07125599
071256                                        APONBRA                   07125699
071257         MOVE DP015-RED              TO AOPRUNTC                  07125799
071258                                        APONBRC                   07125899
071259         MOVE DP015-REVERSE          TO AOPRUNTH                  07125999
071260                                        APONBRH                   07126099
071267         MOVE -1                     TO AOPRUNTL                  07126799
071268         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      07126899
071269     END-IF.                                                      07126999
071348/                                                                 07134899
071349******************************************************************07134999
071350* 3002-F23-RELATIONAL-EDITS                                      *07135099
071360*     DETERMINE IF DATA COMBINATIONS ENTERED ARE OK BEFORE ALLOW-*07136099
071370* ING A PFKEY TRANSFER.                                          *07137099
071380******************************************************************07138099
071390 3002-F23-RELATIONAL-EDITS.                                       07139099
071400                                                                  07140099
071410     IF ( ASC-AUD-CNTL-NBR > SPACES )                             07141099
071411         IF ( ASC-PO-NBR       > SPACES   OR                      07141199
071421              ASC-RCVR-SEQ-NBR > SPACES   OR                      07142199
071422              ASC-PO-LNE-NBR   > SPACES   OR                      07142299
071423              ASC-PREPK-ID     > SPACES )                         07142399
071931             SET PS-ERROR                                         07193199
071932                 DP020-MSG-FATAL         TO TRUE                  07193299
071933             MOVE PC-TSYMSG-01202        TO DP020-MSG-NUMBER      07193399
071934             MOVE DP015-UNP-ALP-BRT-OFF  TO APONBRA               07193499
071935                                            ARCVNBRA              07193599
071936                                            ALNENBRA              07193699
071937                                            APRPKIDA              07193799
071938                                            AAUDNBRA              07193899
071939             MOVE DP015-RED              TO APONBRC               07193999
071940                                            ARCVNBRC              07194099
071941                                            ALNENBRC              07194199
071942                                            APRPKIDC              07194299
071943                                            AAUDNBRC              07194399
071944             MOVE DP015-REVERSE          TO APONBRH               07194499
071945                                            ARCVNBRH              07194599
071946                                            ALNENBRH              07194699
071947                                            APRPKIDH              07194799
071948                                            AAUDNBRH              07194899
071949             MOVE -1                     TO APONBRL               07194999
071950             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07195099
071951         END-IF                                                   07195199
071952     ELSE                                                         07195299
071953         IF ( ASC-PO-NBR       > SPACES   AND                     07195399
071954              ASC-RCVR-SEQ-NBR > SPACES )                         07195499
071955             CONTINUE                                             07195599
071956         ELSE                                                     07195699
071959             SET PS-ERROR                                         07195999
071960                 DP020-MSG-FATAL         TO TRUE                  07196099
071961             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      07196199
071962             MOVE DP015-UNP-ALP-BRT-OFF  TO APONBRA               07196299
071963                                            ARCVNBRA              07196399
071967             MOVE DP015-RED              TO APONBRC               07196799
071968                                            ARCVNBRC              07196899
071972             MOVE DP015-REVERSE          TO APONBRH               07197299
071973                                            ARCVNBRH              07197399
071977             MOVE -1                     TO APONBRL               07197799
071978             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07197899
071979         END-IF                                                   07197999
071980     END-IF.                                                      07198099
072026/                                                                 07202699
072027******************************************************************07202799
072028* 3003-F24-RELATIONAL-EDITS                                      *07202899
072029*     DETERMINE IF DATA COMBINATIONS ENTERED ARE OK BEFORE ALLOW-*07202999
072030* ING A PFKEY TRANSFER.                                          *07203099
072031******************************************************************07203199
072032 3003-F24-RELATIONAL-EDITS.                                       07203299
072033                                                                  07203399
072034     IF ( ASC-BRCDE-NBR > SPACES )                                07203499
072035         IF ( ASC-AUD-CNTL-NBR > SPACES   OR                      07203599
072036              ASC-PO-NBR       > SPACES   OR                      07203699
072037              ASC-RCVR-SEQ-NBR > SPACES   OR                      07203799
072038              ASC-PO-LNE-NBR   > SPACES   OR                      07203899
072039              ASC-PREPK-ID     > SPACES )                         07203999
072040             SET PS-ERROR                                         07204099
072041                 DP020-MSG-FATAL         TO TRUE                  07204199
072042             MOVE PC-TSYMSG-01202        TO DP020-MSG-NUMBER      07204299
072043             MOVE DP015-UNP-ALP-BRT-OFF  TO APONBRA               07204399
072044                                            ARCVNBRA              07204499
072045                                            ALNENBRA              07204599
072046                                            APRPKIDA              07204699
072047                                            AAUDNBRA              07204799
072048                                            ACTNIDA               07204899
072049             MOVE DP015-RED              TO APONBRC               07204999
072050                                            ARCVNBRC              07205099
072051                                            ALNENBRC              07205199
072052                                            APRPKIDC              07205299
072053                                            AAUDNBRC              07205399
072054                                            ACTNIDC               07205499
072055             MOVE DP015-REVERSE          TO APONBRH               07205599
072056                                            ARCVNBRH              07205699
072057                                            ALNENBRH              07205799
072058                                            APRPKIDH              07205899
072059                                            AAUDNBRH              07205999
072060                                            ACTNIDH               07206099
072061             MOVE -1                     TO APONBRL               07206199
072062             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07206299
072081         END-IF                                                   07208199
072082     ELSE                                                         07208299
072083         IF ( ASC-AUD-CNTL-NBR > SPACES )                         07208399
072084             IF ( ASC-PO-NBR       > SPACES   OR                  07208499
072085                  ASC-RCVR-SEQ-NBR > SPACES   OR                  07208599
072086                  ASC-PO-LNE-NBR   > SPACES   OR                  07208699
072087                  ASC-PREPK-ID     > SPACES )                     07208799
072088                 SET PS-ERROR                                     07208899
072089                     DP020-MSG-FATAL         TO TRUE              07208999
072090                 MOVE PC-TSYMSG-01202        TO DP020-MSG-NUMBER  07209099
072091                 MOVE DP015-UNP-ALP-BRT-OFF  TO APONBRA           07209199
072092                                                ARCVNBRA          07209299
072093                                                ALNENBRA          07209399
072094                                                APRPKIDA          07209499
072095                                                AAUDNBRA          07209599
072096                 MOVE DP015-RED              TO APONBRC           07209699
072097                                                ARCVNBRC          07209799
072098                                                ALNENBRC          07209899
072099                                                APRPKIDC          07209999
072100                                                AAUDNBRC          07210099
072101                 MOVE DP015-REVERSE          TO APONBRH           07210199
072102                                                ARCVNBRH          07210299
072103                                                ALNENBRH          07210399
072104                                                APRPKIDH          07210499
072105                                                AAUDNBRH          07210599
072106                 MOVE -1                     TO APONBRL           07210699
072107                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07210799
072108             END-IF                                               07210899
072109         ELSE                                                     07210999
072110             IF ( ASC-PO-NBR       > SPACES   AND                 07211099
072111                  ASC-RCVR-SEQ-NBR > SPACES )                     07211199
072112                 CONTINUE                                         07211299
072113             ELSE                                                 07211399
072114                 SET PS-ERROR                                     07211499
072115                     DP020-MSG-FATAL         TO TRUE              07211599
072116                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  07211699
072117                 MOVE DP015-UNP-ALP-BRT-OFF  TO APONBRA           07211799
072118                                                ARCVNBRA          07211899
072119                 MOVE DP015-RED              TO APONBRC           07211999
072120                                                ARCVNBRC          07212099
072121                 MOVE DP015-REVERSE          TO APONBRH           07212199
072122                                                ARCVNBRH          07212299
072123                 MOVE -1                     TO APONBRL           07212399
072124                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07212499
072125             END-IF                                               07212599
072126         END-IF                                                   07212699
072130     END-IF.                                                      07213099
072146/                                                                 07214699
072147****************************************************************  07214787
072148* 3010-VALIDATE-OPER-UNT-ID                                    *  07214899
072149****************************************************************  07214987
072150 3010-VALIDATE-OPER-UNT-ID.                                       07215087
072151                                                                  07215187
072152     IF  ASC-OPER-UNT-ID = SPACES                                 07215299
072153         SET PS-ERROR                                             07215399
072154             DP020-MSG-FATAL         TO TRUE                      07215499
072155         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          07215599
072156         MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA                  07215699
072157         MOVE DP015-RED              TO AOPRUNTC                  07215799
072158         MOVE DP015-REVERSE          TO AOPRUNTH                  07215899
072159         MOVE -1                     TO AOPRUNTL                  07215999
072160         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      07216099
072161         MOVE SPACES                 TO AOPRNMEO                  07216199
072162     ELSE                                                         07216299
072163         MOVE ASC-OPER-UNT-ID    TO DP010I-UNEDITED-FIELD         07216399
072164         MOVE LENGTH OF ASC-OPER-UNT-ID TO DP010I-MAXIMUM-DIGITS  07216499
072165         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       07216599
072166         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  07216699
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07216899
263968              USING DP010I-NUMERIC-EDIT-AREA                      07216999
072168         IF  DP010I-ERROR-DETECTED                                07217099
072169             SET PS-ERROR                                         07217199
072170                 DP020-MSG-FATAL         TO TRUE                  07217299
072171             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      07217399
072172             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA              07217499
072173             MOVE DP015-RED              TO AOPRUNTC              07217599
072174             MOVE DP015-REVERSE          TO AOPRUNTH              07217699
072175             MOVE -1                     TO AOPRUNTL              07217799
072176             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07217899
072177             MOVE SPACES                 TO AOPRNMEO              07217999
072178         ELSE                                                     07218099
072179             MOVE DP010I-NUMERIC-FIELD TO ASC-OPER-UNT-ID-N       07218199
072180             MOVE ASC-OPER-UNT-ID      TO AOPRUNTO                07218299
072181         END-IF                                                   07218399
072182     END-IF.                                                      07218499
072183                                                                  07218599
072184     IF ( PS-ERROR )                                              07218699
072185         CONTINUE                                                 07218799
072186     ELSE                                                         07218899
072187         PERFORM 3011-VALIDATE-OPER-UNT-ID                        07218999
072190     END-IF.                                                      07219099
072200/                                                                 07220099
078100****************************************************************  07810099
078110* 3011-VALIDATE-OPER-UNT-ID.                                   *  07811099
078120****************************************************************  07812099
078130 3011-VALIDATE-OPER-UNT-ID.                                       07813099
078140                                                                  07814099
078141     INITIALIZE XL071-COMMAREA.                                   07814199
078142     MOVE ASC-OPER-UNT-ID TO XL071-LOCATION-NUMBER.               07814299
078143                                                                  07814399
078144     CALL XL071-LOCATION-MODULE USING                             07814499
078145                                DFHEIBLK                          07814599
078146                                XL071-COMMAREA                    07814699
078147                                XL071-COMMAREA-REC.               07814799
078148                                                                  07814899
078149     EVALUATE TRUE                                                07814999
078150         WHEN XL071-NO-ERRORS                                     07815099
078151         WHEN XL071-DC-ASGMT-NOT-FND                              07815199
078152              MOVE XL071-LOC-NM TO ASC-FCLTY-NME                  07815299
078153                                   AOPRNMEO                       07815399
078154              IF XL071-LOC-TYP-CDE = PC-DC                        07815499
078155                 CONTINUE                                         07815599
078156              ELSE                                                07815699
078157                 SET PS-ERROR                                     07815799
078158                     DP020-MSG-FATAL         TO TRUE              07815899
078159                 MOVE PC-TSYMSG-02572        TO DP020-MSG-NUMBER  07815999
078160                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA          07816099
078161                 MOVE DP015-RED              TO AOPRUNTC          07816199
078162                 MOVE DP015-REVERSE          TO AOPRUNTH          07816299
078163                 MOVE -1                     TO AOPRUNTL          07816399
078164                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07816499
078165                 MOVE SPACES                 TO AOPRNMEO          07816599
078166              END-IF                                              07816699
078167                                                                  07816799
078168         WHEN XL071-LOC-NOT-FOUND                                 07816899
078169              MOVE 'NAME NOT FOUND'   TO ASC-FCLTY-NME            07816999
078170              SET PS-ERROR                                        07817099
078171                  DP020-MSG-FATAL         TO TRUE                 07817199
078172              MOVE PC-TSYMSG-02572        TO DP020-MSG-NUMBER     07817299
078173              MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA             07817399
078174              MOVE DP015-RED              TO AOPRUNTC             07817499
078175              MOVE DP015-REVERSE          TO AOPRUNTH             07817599
078176              MOVE -1                     TO AOPRUNTL             07817699
078177              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 07817799
078178              MOVE SPACES                 TO AOPRNMEO             07817899
078179                                                                  07817999
078180         WHEN OTHER                                               07818099
078181              MOVE '3011-VALIDATE-OPER-UNT-ID'                    07818199
078182                                  TO DP013-PARAGRAPH              07818299
078183              STRING 'SELECT STORE NUMBER - '                     07818399
078184                      XL071-LOCATION-NUMBER                       07818499
078185                     ' - BAD RETURN CODE FROM XLKUT071 - '        07818599
078186                      XL071-RETURN-CODE                           07818699
078187                      DELIMITED BY SIZE                           07818799
078188                      INTO DP013-MESSAGE-TEXT (1)                 07818899
078189              STRING 'SQLCODE - '                                 07818999
078190                      XL071-SQLCODE                               07819099
078191                     ' - '                                        07819199
078192                      XL071-DB2-TABLE                             07819299
078193                      DELIMITED BY SIZE                           07819399
078194                      INTO DP013-MESSAGE-TEXT (2)                 07819499
078195              MOVE XL071-SQLCA     TO DP013-SQLCA                 07819599
078196              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    07819699
078197              MOVE XL071-SQLCODE TO SQLCODE                       07819799
078198              SET DP013-DB2-ABEND                                 07819899
078199                  DP013-XCTL-DISPLAY-RESTART TO TRUE              07819999
078200              PERFORM DP013-0000-PROCESS-ABEND                    07820099
078201                                                                  07820199
078202     END-EVALUATE.                                                07820299
078203/                                                                 07820399
078204****************************************************************  07820499
078205* 3020-VALIDATE-PO-NBR.                                        *  07820599
078206****************************************************************  07820699
078600 3020-VALIDATE-PO-NBR.                                            07860021
078700                                                                  07870099
078791     IF ( ASC-PO-NBR = SPACES )                                   07879199
078792         CONTINUE                                                 07879299
078800     ELSE                                                         07880099
078801         MOVE ASC-PO-NBR         TO DP010I-UNEDITED-FIELD         07880199
078802         MOVE LENGTH OF ASC-PO-NBR TO DP010I-MAXIMUM-DIGITS       07880299
078803         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       07880399
078804         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  07880499
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07880699
263968              USING DP010I-NUMERIC-EDIT-AREA                      07880799
078806         IF ( DP010I-ERROR-DETECTED )                             07880899
078811             MOVE DP015-UNP-ALP-BRT-OFF  TO APONBRA               07881199
078812             MOVE DP015-RED              TO APONBRC               07881299
078813             MOVE DP015-REVERSE          TO APONBRH               07881399
078814             MOVE -1                     TO APONBRL               07881499
078815             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07881599
078816             MOVE SPACES                 TO AOPRNMEO              07881699
078817             IF ( PS-NO-ERROR )                                   07881799
078818                 SET PS-ERROR                                     07881899
078819                     DP020-MSG-FATAL     TO TRUE                  07881999
078820                 MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER      07882099
078821             END-IF                                               07882199
078822         ELSE                                                     07882299
078823             MOVE DP010I-NUMERIC-FIELD TO ASC-PO-NBR-N            07882399
078824             MOVE ASC-PO-NBR-N         TO APONBRO                 07882499
078825             PERFORM 3021-VALIDATE-PO-NBR                         07882599
078826         END-IF                                                   07882699
078827     END-IF.                                                      07882799
078828/                                                                 07882899
078829****************************************************************  07882999
078830* 3021-VALIDATE-PO-NBR.                                        *  07883099
078831****************************************************************  07883199
078832 3021-VALIDATE-PO-NBR.                                            07883299
078833                                                                  07883399
078840     MOVE ASC-PO-NBR-N   TO  DK-PO-NBR.                           07884030
078900                                                                  07890030
079000     EXEC SQL                                                     07900030
079100       SELECT  PO_NBR                                             07910030
079200         INTO :PURCHS-PO-NBR                                      07920030
079300         FROM  TPURCHS                                            07930030
079400        WHERE  VER_STATUS_CDE  = :PC-A                            07940030
079500         AND   PO_NBR          = :DK-PO-NBR                       07950052
079600     END-EXEC.                                                    07960030
079700                                                                  07970030
079800     EVALUATE TRUE                                                07980030
079900         WHEN SQLCODE = +0                                        07990030
080000              CONTINUE                                            08000030
080100         WHEN SQLCODE = +100                                      08010030
080500             MOVE DP015-UNP-ALP-BRT-OFF  TO APONBRA               08050030
080600             MOVE DP015-RED              TO APONBRC               08060030
080700             MOVE DP015-REVERSE          TO APONBRH               08070030
080800             MOVE -1                     TO APONBRL               08080030
080900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08090030
080910             IF ( PS-NO-ERROR )                                   08091099
080920                 SET PS-ERROR                                     08092099
080930                     DP020-MSG-FATAL     TO TRUE                  08093099
080931                 MOVE PC-TSYMSG-03647    TO DP020-MSG-NUMBER      08093199
080950             END-IF                                               08095099
081000         WHEN SQLWARN0 NOT = SPACES                               08100030
081100         WHEN SQLCODE < +0                                        08110030
081200         WHEN SQLCODE > +0                                        08120030
081300             MOVE '3021-VALIDATE-PO-NBR        '                  08130099
081400                                       TO DP013-PARAGRAPH         08140030
081500             MOVE 'BAD SELECT                     '               08150030
081600                                 TO DP013-MESSAGE-TEXT (1)        08160030
081700             MOVE SQLCA      TO DP013-SQLCA                       08170030
081800             MOVE 'TPURCHS     '  TO                              08180030
081900                                DP013-DB2-TABLE-NAME (1)          08190030
082000             SET DP013-DB2-ABEND                                  08200030
082100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               08210030
082200             PERFORM DP013-0000-PROCESS-ABEND                     08220030
082300     END-EVALUATE.                                                08230030
082400/                                                                 08240099
082410****************************************************************  08241099
082420* 3030-VALIDATE-RECEIVER-NBR.                                  *  08242099
082430****************************************************************  08243099
082900 3030-VALIDATE-RECEIVER-NBR.                                      08290030
083000                                                                  08300030
083090     IF ( ASC-RCVR-SEQ-NBR = SPACES )                             08309099
083092         CONTINUE                                                 08309299
083103     ELSE                                                         08310399
083104         MOVE ASC-RCVR-SEQ-NBR   TO DP010I-UNEDITED-FIELD         08310499
083105         MOVE LENGTH OF ASC-RCVR-SEQ-NBR TO                       08310599
083106                                     DP010I-MAXIMUM-DIGITS        08310699
083107         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       08310799
083108         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08310899
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08311099
263968              USING DP010I-NUMERIC-EDIT-AREA                      08311199
083110         IF  DP010I-ERROR-DETECTED                                08311299
083114             MOVE DP015-UNP-ALP-BRT-OFF  TO ARCVNBRA              08311499
083115             MOVE DP015-RED              TO ARCVNBRC              08311599
083116             MOVE DP015-REVERSE          TO ARCVNBRH              08311699
083117             MOVE -1                     TO ARCVNBRL              08311799
083118             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08311899
083119             MOVE SPACES                 TO AOPRNMEO              08311999
083120             IF ( PS-NO-ERROR )                                   08312099
083121                 SET PS-ERROR                                     08312199
083122                     DP020-MSG-FATAL     TO TRUE                  08312299
083123                 MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER      08312399
083124             END-IF                                               08312499
083125         ELSE                                                     08312599
083126             MOVE DP010I-NUMERIC-FIELD TO ASC-RCVR-SEQ-NBR-N      08312699
083127             MOVE ASC-RCVR-SEQ-NBR     TO ARCVNBRO                08312799
083128             PERFORM 3031-VALIDATE-RECEIVER-NBR                   08312899
083129         END-IF                                                   08312999
083130     END-IF.                                                      08313099
083131/                                                                 08313199
083132****************************************************************  08313299
083133* 3031-VALIDATE-RECEIVER-NBR.                                  *  08313399
083134****************************************************************  08313499
083135 3031-VALIDATE-RECEIVER-NBR.                                      08313599
083136                                                                  08313699
083137     IF ( ASC-PO-NBR-N NUMERIC )                                  08313799
083138         MOVE ASC-PO-NBR-N     TO DK-PO-NBR                       08313899
083139     ELSE                                                         08313999
083140         MOVE +0               TO DK-PO-NBR                       08314099
083150     END-IF.                                                      08315099
083160                                                                  08316099
083200     MOVE ASC-RCVR-SEQ-NBR TO DK-RCVR-SEQ-NBR.                    08320030
083300                                                                  08330030
083400     EXEC SQL                                                     08340030
083500         SELECT  PACK_BY_ST_IND                                   08350030
083600                ,PKGNG_CDE                                        08360030
083700           INTO  :RECEIV-PACK-BY-ST-IND                           08370030
083800                ,:RECEIV-PKGNG-CDE                                08380030
083900           FROM  TRECEIV                                          08390030
084000          WHERE  ORD_NBR       =  :DK-PO-NBR                      08400030
084100            AND  REC_SEQ_NBR   =  :DK-RCVR-SEQ-NBR                08410030
084200     END-EXEC.                                                    08420030
084300                                                                  08430030
084400     EVALUATE TRUE                                                08440030
084500         WHEN SQLCODE = +0                                        08450030
084600              IF RECEIV-PACK-BY-ST-IND = PC-Y                     08460067
084700                 MOVE PC-PACK-BY-STORE    TO ASC-PACK-TYPE        08470067
084710                                             ARPCKTPO             08471099
084800              ELSE                                                08480067
084900                  EVALUATE RECEIV-PKGNG-CDE                       08490099
085000                      WHEN 'M'                                    08500099
085100                          MOVE PC-MULTIPLE-SKU-PPK                08510099
085110                            TO ASC-PACK-TYPE                      08511099
085120                               ARPCKTPO                           08512099
085200                      WHEN 'S'                                    08520099
085300                          MOVE PC-SINGLE-SKU-PPK                  08530099
085310                            TO ASC-PACK-TYPE                      08531099
085320                               ARPCKTPO                           08532099
085400                      WHEN 'I'                                    08540099
085500                          MOVE PC-INNER-PPK                       08550099
085510                            TO ASC-PACK-TYPE                      08551099
085520                               ARPCKTPO                           08552099
085600                      WHEN 'B'                                    08560099
085700                          MOVE PC-BULK-PPK                        08570099
085710                            TO ASC-PACK-TYPE                      08571099
085720                               ARPCKTPO                           08572099
085800                      WHEN 'C'                                    08580099
085900                          MOVE PC-CASEPACK                        08590099
085910                            TO ASC-PACK-TYPE                      08591099
085920                               ARPCKTPO                           08592099
086000                      WHEN OTHER                                  08600099
086100                          MOVE PC-OTHER                           08610099
086110                            TO ASC-PACK-TYPE                      08611099
086120                               ARPCKTPO                           08612099
086200                  END-EVALUATE                                    08620099
086300              END-IF                                              08630067
086400                                                                  08640066
086500         WHEN SQLCODE = +100                                      08650030
086900             MOVE DP015-UNP-ALP-BRT-OFF  TO ARCVNBRA              08690030
087000             MOVE DP015-RED              TO ARCVNBRC              08700030
087100             MOVE DP015-REVERSE          TO ARCVNBRH              08710030
087200             MOVE -1                     TO ARCVNBRL              08720030
087300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08730030
087310             IF ( PS-NO-ERROR )                                   08731099
087320                 SET PS-ERROR                                     08732099
087330                     DP020-MSG-FATAL     TO TRUE                  08733099
087331                 MOVE PC-TSYMSG-01298    TO DP020-MSG-NUMBER      08733199
087350             END-IF                                               08735099
087400         WHEN SQLWARN0 NOT = SPACES                               08740030
087500         WHEN SQLCODE < +0                                        08750030
087600         WHEN SQLCODE > +0                                        08760030
087700             MOVE '3031-VALIDATE-RECEIVER-NBR  '                  08770099
087800                                       TO DP013-PARAGRAPH         08780030
087900             MOVE 'BAD SELECT                     '               08790030
088000                                 TO DP013-MESSAGE-TEXT (1)        08800030
088100             MOVE SQLCA      TO DP013-SQLCA                       08810030
088200             MOVE 'TRECEIV     '  TO                              08820030
088300                                DP013-DB2-TABLE-NAME (1)          08830030
088400             SET DP013-DB2-ABEND                                  08840030
088500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               08850030
088600             PERFORM DP013-0000-PROCESS-ABEND                     08860030
088700     END-EVALUATE.                                                08870030
088801/                                                                 08880199
088802****************************************************************  08880299
088803* 3040-VALIDATE-PO-LINE-NBR.                                  *   08880399
088804****************************************************************  08880499
088805 3040-VALIDATE-PO-LINE-NBR.                                       08880599
088806                                                                  08880699
088819     IF ( ASC-PO-LNE-NBR = SPACES )                               08881999
088820         CONTINUE                                                 08882099
088821     ELSE                                                         08882199
088822         MOVE ASC-PO-LNE-NBR     TO DP010I-UNEDITED-FIELD         08882299
088823         MOVE LENGTH OF ASC-PO-LNE-NBR TO DP010I-MAXIMUM-DIGITS   08882399
088824         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       08882499
088825         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08882599
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08882799
263968              USING DP010I-NUMERIC-EDIT-AREA                      08882899
088827         IF ( DP010I-ERROR-DETECTED )                             08882999
088828             SET PS-PREVIOUS-ERROR       TO TRUE                  08883099
088831             MOVE DP015-UNP-ALP-BRT-OFF  TO ALNENBRA              08883199
088832             MOVE DP015-RED              TO ALNENBRC              08883299
088833             MOVE DP015-REVERSE          TO ALNENBRH              08883399
088834             MOVE -1                     TO ALNENBRL              08883499
088835             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08883599
088836             IF ( PS-NO-ERROR )                                   08883699
088837                 SET PS-ERROR                                     08883799
088838                     DP020-MSG-FATAL     TO TRUE                  08883899
088839                 MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER      08883999
088840             END-IF                                               08884099
088841         ELSE                                                     08884199
088842             MOVE DP010I-NUMERIC-FIELD TO ASC-PO-LNE-NBR-N        08884299
088843             MOVE ASC-PO-LNE-NBR       TO ALNENBRO                08884399
088844             PERFORM 3041-VALIDATE-LINE-NBR                       08884499
088847         END-IF                                                   08884799
088848     END-IF.                                                      08884899
088849/                                                                 08884999
088850****************************************************************  08885099
088851* 3041-VALIDATE-RECEIVER-NBR.                                  *  08885199
088860****************************************************************  08886099
089300 3041-VALIDATE-LINE-NBR.                                          08930099
089400                                                                  08940030
089410     IF ( ASC-PO-NBR-N NUMERIC )                                  08941099
089420         MOVE ASC-PO-NBR-N     TO DK-PO-NBR                       08942099
089430     ELSE                                                         08943099
089440         MOVE +0               TO DK-PO-NBR                       08944099
089450     END-IF.                                                      08945099
089460                                                                  08946099
089470     IF ( ASC-RCVR-SEQ-NBR NUMERIC )                              08947099
089480         MOVE ASC-RCVR-SEQ-NBR TO DK-RCVR-SEQ-NBR                 08948099
089490     ELSE                                                         08949099
089500         MOVE +0               TO DK-RCVR-SEQ-NBR                 08950099
089510     END-IF.                                                      08951099
089520                                                                  08952099
089700     MOVE ASC-PO-LNE-NBR   TO DK-PO-LNE-NBR.                      08970031
089800                                                                  08980030
089900     EXEC SQL                                                     08990030
090000         SELECT  ORD_NBR                                          09000030
090100                ,REC_SEQ_NBR                                      09010030
090200                ,ORD_LNE_NBR                                      09020030
090300           INTO  :RECITM-ORD-NBR                                  09030030
090400                ,:RECITM-REC-SEQ-NBR                              09040030
090500                ,:RECITM-ORD-LNE-NBR                              09050030
090600           FROM  TRECITM                                          09060030
090700          WHERE  ORD_NBR        = :DK-PO-NBR                      09070030
090800            AND  REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR                09080030
090900            AND  ORD_LNE_NBR    = :DK-PO-LNE-NBR                  09090030
091000            AND  VER_STATUS_CDE = :PC-A                           09100030
091100     END-EXEC.                                                    09110030
091200                                                                  09120030
091300     EVALUATE TRUE                                                09130030
091400         WHEN SQLCODE = +0                                        09140030
091500              CONTINUE                                            09150030
091600         WHEN SQLCODE = +100                                      09160030
091700             SET PS-PREVIOUS-ERROR       TO TRUE                  09170099
092000             MOVE DP015-UNP-ALP-BRT-OFF  TO ALNENBRA              09200030
092100             MOVE DP015-RED              TO ALNENBRC              09210030
092200             MOVE DP015-REVERSE          TO ALNENBRH              09220030
092300             MOVE -1                     TO ALNENBRL              09230030
092400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09240030
092410             IF ( PS-NO-ERROR )                                   09241099
092420                 SET PS-ERROR                                     09242099
092430                     DP020-MSG-FATAL     TO TRUE                  09243099
092431                 MOVE PC-TSYMSG-01729    TO DP020-MSG-NUMBER      09243199
092450             END-IF                                               09245099
092500         WHEN SQLWARN0 NOT = SPACES                               09250030
092600         WHEN SQLCODE < +0                                        09260030
092700         WHEN SQLCODE > +0                                        09270030
092800             MOVE '3040-VALIDATE-LINE-NBR      '                  09280030
092900                                       TO DP013-PARAGRAPH         09290030
093000             MOVE 'BAD SELECT                     '               09300030
093100                                 TO DP013-MESSAGE-TEXT (1)        09310030
093200             MOVE SQLCA      TO DP013-SQLCA                       09320030
093300             MOVE 'TRECITM     '  TO                              09330030
093400                                DP013-DB2-TABLE-NAME (1)          09340030
093500             SET DP013-DB2-ABEND                                  09350030
093600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               09360030
093700             PERFORM DP013-0000-PROCESS-ABEND                     09370030
093800     END-EVALUATE.                                                09380030
093900/                                                                 09390099
093901****************************************************************  09390199
093902* 3050-VALIDATE-PACK-ID.                                       *  09390299
093903****************************************************************  09390399
093904 3050-VALIDATE-PACK-ID.                                           09390499
093905                                                                  09390599
093915     IF ( ASC-PREPK-ID = SPACES )                                 09391599
093916         CONTINUE                                                 09391699
093917     ELSE                                                         09391799
093918         MOVE ASC-PREPK-ID       TO DP010I-UNEDITED-FIELD         09391899
093919         MOVE LENGTH OF ASC-PREPK-ID TO DP010I-MAXIMUM-DIGITS     09391999
093920         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       09392099
093921         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09392199
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09392399
263968              USING DP010I-NUMERIC-EDIT-AREA                      09392499
093923         IF ( DP010I-ERROR-DETECTED )                             09392599
093924             SET PS-PREVIOUS-ERROR       TO TRUE                  09392699
093927             MOVE DP015-UNP-ALP-BRT-OFF  TO APRPKIDA              09392799
093928             MOVE DP015-RED              TO APRPKIDC              09392899
093929             MOVE DP015-REVERSE          TO APRPKIDH              09392999
093930             MOVE -1                     TO APRPKIDL              09393099
093931             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09393199
093932             IF ( PS-NO-ERROR )                                   09393299
093933                 SET PS-ERROR                                     09393399
093934                     DP020-MSG-FATAL     TO TRUE                  09393499
093935                 MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER      09393599
093936             END-IF                                               09393699
093937         ELSE                                                     09393799
093938             MOVE DP010I-NUMERIC-FIELD TO ASC-PREPK-ID-N          09393899
093939             MOVE ASC-PREPK-ID         TO APRPKIDO                09393999
093940             PERFORM 3051-VALIDATE-PACK-ID                        09394099
093941         END-IF                                                   09394199
093942     END-IF.                                                      09394299
093943/                                                                 09394399
093945****************************************************************  09394599
093946* 3051-VALIDATE-PACK-ID.                                       *  09394699
093950****************************************************************  09395099
094400 3051-VALIDATE-PACK-ID.                                           09440099
094500                                                                  09450083
094501     IF ( ASC-PO-NBR-N NUMERIC )                                  09450199
094502         MOVE ASC-PO-NBR-N     TO DK-PO-NBR                       09450299
094503     ELSE                                                         09450399
094504         MOVE +0               TO DK-PO-NBR                       09450499
094505     END-IF.                                                      09450599
094506                                                                  09450699
094507     IF ( ASC-RCVR-SEQ-NBR NUMERIC )                              09450799
094508         MOVE ASC-RCVR-SEQ-NBR TO DK-RCVR-SEQ-NBR                 09450899
094509     ELSE                                                         09450999
094510         MOVE +0               TO DK-RCVR-SEQ-NBR                 09451099
094511     END-IF.                                                      09451199
094512                                                                  09451299
094515     MOVE ASC-PREPK-ID     TO DK-PREPK-ID.                        09451583
094520                                                                  09452083
094600     EXEC SQL                                                     09460030
094700         SELECT  ORD_NBR                                          09470030
094800                ,REC_SEQ_NBR                                      09480030
094900                ,ORD_LNE_NBR                                      09490030
095000           INTO  :RECITM-ORD-NBR                                  09500030
095100                ,:RECITM-REC-SEQ-NBR                              09510030
095200                ,:RECITM-ORD-LNE-NBR                              09520030
095300           FROM  TRECITM                                          09530030
095400          WHERE  ORD_NBR        = :DK-PO-NBR                      09540030
095500            AND  REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR                09550030
095600            AND  PREPK_ID       = :DK-PREPK-ID                    09560030
095700            AND  VER_STATUS_CDE = :PC-A                           09570030
095800     END-EXEC.                                                    09580030
095900                                                                  09590030
096000     EVALUATE TRUE                                                09600030
096100         WHEN SQLCODE = +0                                        09610030
096110         WHEN SQLCODE = -811                                      09611082
096200              CONTINUE                                            09620030
096300         WHEN SQLCODE = +100                                      09630030
096400             SET PS-PREVIOUS-ERROR       TO TRUE                  09640099
096700             MOVE DP015-UNP-ALP-BRT-OFF  TO APRPKIDA              09670030
096800             MOVE DP015-RED              TO APRPKIDC              09680030
096900             MOVE DP015-REVERSE          TO APRPKIDH              09690030
097000             MOVE -1                     TO APRPKIDL              09700030
097100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09710030
097110             IF ( PS-NO-ERROR )                                   09711099
097120                 SET PS-ERROR                                     09712099
097130                     DP020-MSG-FATAL     TO TRUE                  09713099
097131                 MOVE PC-TSYMSG-03638    TO DP020-MSG-NUMBER      09713199
097150             END-IF                                               09715099
097200         WHEN SQLWARN0 NOT = SPACES                               09720030
097300         WHEN SQLCODE < +0                                        09730030
097400         WHEN SQLCODE > +0                                        09740030
097500             MOVE '3051-VALIDATE-PACK-ID       '                  09750099
097600                                       TO DP013-PARAGRAPH         09760030
097700             MOVE 'BAD SELECT                     '               09770030
097800                                 TO DP013-MESSAGE-TEXT (1)        09780030
097900             MOVE SQLCA      TO DP013-SQLCA                       09790030
098000             MOVE 'TRECITM     '  TO                              09800030
098100                                DP013-DB2-TABLE-NAME (1)          09810030
098200             SET DP013-DB2-ABEND                                  09820030
098300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               09830030
098400             PERFORM DP013-0000-PROCESS-ABEND                     09840030
098500     END-EVALUATE.                                                09850030
098600/                                                                 09860099
098601****************************************************************  09860199
098602* 3055-VALIDATE-LINE-OR-PACK                                   *  09860299
098603****************************************************************  09860399
098604 3055-VALIDATE-LINE-OR-PACK.                                      09860499
098605                                                                  09860599
098606     IF ( PS-PREVIOUS-ERROR )                                     09860699
098607         CONTINUE                                                 09860799
098608     ELSE                                                         09860899
098609         IF ( ASC-PO-LNE-NBR > SPACES ) AND                       09860999
098610            ( ASC-PREPK-ID   > SPACES )                           09861099
098611             MOVE DP015-UNP-ALP-BRT-OFF  TO ALNENBRA              09861199
098612                                            APRPKIDA              09861299
098613             MOVE DP015-RED              TO ALNENBRC              09861399
098614                                            APRPKIDC              09861499
098615             MOVE DP015-REVERSE          TO ALNENBRH              09861599
098616                                            APRPKIDH              09861699
098617             MOVE -1                     TO ALNENBRL              09861799
098618             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09861899
098619             IF ( PS-NO-ERROR )                                   09861999
098620                 SET PS-ERROR                                     09862099
098621                     DP020-MSG-FATAL     TO TRUE                  09862199
098622                 MOVE PC-TSYMSG-01202    TO DP020-MSG-NUMBER      09862299
098623             END-IF                                               09862399
098624         END-IF                                                   09862499
098625     END-IF.                                                      09862599
098626/                                                                 09862699
098627****************************************************************  09862799
098628* 3060-VALIDATE-CNTL-NBR.                                      *  09862899
098629****************************************************************  09862999
098630 3060-VALIDATE-CNTL-NBR.                                          09863099
098631                                                                  09863199
098632     IF ( ASC-AUD-CNTL-NBR = SPACES )                             09863299
098633         CONTINUE                                                 09863399
098634     ELSE                                                         09863499
098635         MOVE ASC-AUD-CNTL-NBR   TO DP010I-UNEDITED-FIELD         09863599
098636         MOVE LENGTH OF ASC-AUD-CNTL-NBR TO                       09863699
098637                                    DP010I-MAXIMUM-DIGITS         09863799
098638         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       09863899
098639         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09863999
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09864199
263968              USING DP010I-NUMERIC-EDIT-AREA                      09864299
098641         IF ( DP010I-ERROR-DETECTED )                             09864399
098642             MOVE DP015-UNP-ALP-BRT-OFF  TO AAUDNBRA              09864499
098643             MOVE DP015-RED              TO AAUDNBRC              09864599
098644             MOVE DP015-REVERSE          TO AAUDNBRH              09864699
098645             MOVE -1                     TO AAUDNBRL              09864799
098646             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09864899
098647             IF ( PS-NO-ERROR )                                   09864999
098648                 SET PS-ERROR                                     09865099
098649                     DP020-MSG-FATAL     TO TRUE                  09865199
098650                 MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER      09865299
098651             END-IF                                               09865399
098652         ELSE                                                     09865499
098653             MOVE DP010I-NUMERIC-FIELD TO ASC-AUD-CNTL-NBR-N      09865599
098654             MOVE ASC-AUD-CNTL-NBR     TO AAUDNBRO                09865699
098655             PERFORM 3061-VALIDATE-CNTL-NBR                       09865799
098656         END-IF                                                   09865899
098657     END-IF.                                                      09865999
098658/                                                                 09866099
098659****************************************************************  09866199
098660* 3061-VALIDATE-CNTL-NBR.                                      *  09866299
098670****************************************************************  09867099
099100 3061-VALIDATE-CNTL-NBR.                                          09910099
099200                                                                  09920030
099210     MOVE ASC-AUD-CNTL-NBR TO DK-AUD-CNTL-NBR.                    09921099
099220                                                                  09922099
099300     EXEC SQL                                                     09930030
099400         SELECT AUD_CNTL_NBR                                      09940099
099900           INTO  :SUT00015-AUD-CNTL-NBR                           09990099
100400           FROM  SUT_PO_AUD_REQ                                   10040099
100500          WHERE  AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                  10050099
100600     END-EXEC.                                                    10060021
100700                                                                  10070021
100800     EVALUATE TRUE                                                10080021
100900         WHEN SQLCODE = +0                                        10090021
101000              CONTINUE                                            10100021
101400         WHEN SQLCODE = +100                                      10140047
101800             MOVE DP015-UNP-ALP-BRT-OFF  TO AAUDNBRA              10180065
101900             MOVE DP015-RED              TO AAUDNBRC              10190065
102000             MOVE DP015-REVERSE          TO AAUDNBRH              10200065
102100             MOVE -1                     TO AAUDNBRL              10210065
102200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10220047
102210             IF ( PS-NO-ERROR )                                   10221099
102220                 SET PS-ERROR                                     10222099
102230                     DP020-MSG-FATAL     TO TRUE                  10223099
102231                 MOVE PC-TSYMSG-02918    TO DP020-MSG-NUMBER      10223199
102250             END-IF                                               10225099
102300         WHEN SQLWARN0 NOT = SPACES                               10230047
102400         WHEN SQLCODE < +0                                        10240047
102500         WHEN SQLCODE > +0                                        10250047
102600             MOVE '3060-VALIDATE-CNTL-NBR      '                  10260047
102700                                       TO DP013-PARAGRAPH         10270047
102800             MOVE 'BAD SELECT                     '               10280047
102900                                 TO DP013-MESSAGE-TEXT (1)        10290047
103000             MOVE SQLCA      TO DP013-SQLCA                       10300047
103100             MOVE 'SUT-PO-AUD-REQ'  TO                            10310047
103200                                DP013-DB2-TABLE-NAME (1)          10320047
103300             SET DP013-DB2-ABEND                                  10330047
103400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10340047
103500             PERFORM DP013-0000-PROCESS-ABEND                     10350047
103600     END-EVALUATE.                                                10360047
103700/                                                                 10370099
103800****************************************************************  10380099
103900* 3070-VALIDATE-CARTON-ID                                      *  10390099
104000****************************************************************  10400099
104100 3070-VALIDATE-CARTON-ID.                                         10410099
104200                                                                  10420099
104210     IF ( ASC-BRCDE-NBR = SPACES )                                10421099
104220         CONTINUE                                                 10422099
104230     ELSE                                                         10423099
104300         SET PS-NO-CARTON-ERROR  TO TRUE                          10430099
104400         INSPECT ASC-BRCDE-NBR                                    10440099
104410             REPLACING ALL LOW-VALUES BY SPACES                   10441099
104500         MOVE +0                 TO PV-CHAR-COUNT                 10450099
104600         INSPECT ASC-BRCDE-NBR                                    10460099
104610             TALLYING PV-CHAR-COUNT                               10461099
104700             FOR CHARACTERS BEFORE INITIAL SPACE                  10470099
105000         EVALUATE TRUE                                            10500099
105100           WHEN PV-CHAR-COUNT = +0                                10510099
105200             SET PS-CARTON-ERROR  TO TRUE                         10520099
105300             SET PS-CARTON-MSG1   TO TRUE                         10530099
105500           WHEN PV-CHAR-COUNT = +18                               10550099
105600             IF ( ASC-BRCDE-NBR(01:18) NUMERIC ) AND              10560099
105700                ( ASC-BRCDE-NBR(01:18) > ZEROS )                  10570099
105800                 MOVE 0             TO DK-SML-BRCDE1-01-02        10580099
105900                 MOVE ASC-BRCDE-NBR(01:18) TO DK-SML-BRCDE1-03-20 10590099
106000                 MOVE SPACES        TO DK-SML-BRCDE1-21-22        10600099
106100             ELSE                                                 10610099
106200                IF ( ASC-BRCDE-NBR(01:18) = ZEROS )               10620099
106300                    SET PS-CARTON-ERROR  TO TRUE                  10630099
106400                    SET PS-CARTON-MSG3   TO TRUE                  10640099
106500                ELSE                                              10650099
106600                    SET PS-CARTON-ERROR  TO TRUE                  10660099
106700                    SET PS-CARTON-MSG2   TO TRUE                  10670099
106800                END-IF                                            10680099
106900             END-IF                                               10690099
107000           WHEN PV-CHAR-COUNT = +20                               10700099
107100             IF ( ASC-BRCDE-NBR(01:20) NUMERIC ) AND              10710099
107200                ( ASC-BRCDE-NBR(01:20) > ZEROS )                  10720099
107300                 MOVE ASC-BRCDE-NBR(01:20) TO DK-SML-BRCDE2-01-20 10730099
107400                 MOVE SPACES        TO DK-SML-BRCDE1-21-22        10740099
107500             ELSE                                                 10750099
107600                 IF ( ASC-BRCDE-NBR(01:20) = ZEROS )              10760099
107700                    SET PS-CARTON-ERROR  TO TRUE                  10770099
107800                    SET PS-CARTON-MSG3   TO TRUE                  10780099
107900                 ELSE                                             10790099
108000                    SET PS-CARTON-ERROR  TO TRUE                  10800099
108100                    SET PS-CARTON-MSG2   TO TRUE                  10810099
108200                 END-IF                                           10820099
108300             END-IF                                               10830099
108400           WHEN PV-CHAR-COUNT = +21                               10840099
108500             IF ( ASC-BRCDE-NBR(01:21) NUMERIC ) AND              10850099
108600                ( ASC-BRCDE-NBR(01:21) > ZEROS )                  10860099
108700                 MOVE 0             TO DK-P2L-BRCDE1-01-01        10870099
108800                 MOVE ASC-BRCDE-NBR(01:21) TO DK-P2L-BRCDE1-02-22 10880099
108900             ELSE                                                 10890099
109000                 IF ( ASC-BRCDE-NBR(01:21) = ZEROS )              10900099
109100                    SET PS-CARTON-ERROR  TO TRUE                  10910099
109200                    SET PS-CARTON-MSG3   TO TRUE                  10920099
109300                 ELSE                                             10930099
109400                    SET PS-CARTON-ERROR  TO TRUE                  10940099
109500                    SET PS-CARTON-MSG2   TO TRUE                  10950099
109600                 END-IF                                           10960099
109700             END-IF                                               10970099
109800           WHEN PV-CHAR-COUNT = +22                               10980099
109900             IF ( ASC-BRCDE-NBR NUMERIC ) AND                     10990099
110000                ( ASC-BRCDE-NBR > ZEROS )                         11000099
110100                 MOVE ASC-BRCDE-NBR TO DK-P2L-BRCDE2-01-22        11010099
110200             ELSE                                                 11020099
110300                 IF ( ASC-BRCDE-NBR = ZEROS )                     11030099
110400                    SET PS-CARTON-ERROR  TO TRUE                  11040099
110500                    SET PS-CARTON-MSG3   TO TRUE                  11050099
110600                 ELSE                                             11060099
110700                    SET PS-CARTON-ERROR  TO TRUE                  11070099
110800                    SET PS-CARTON-MSG2   TO TRUE                  11080099
110900                 END-IF                                           11090099
111000             END-IF                                               11100099
111100           WHEN OTHER                                             11110099
111200             SET PS-CARTON-ERROR  TO TRUE                         11120099
111300             SET PS-CARTON-MSG4   TO TRUE                         11130099
111400         END-EVALUATE                                             11140099
111410     END-IF.                                                      11141099
111500                                                                  11150099
111600     IF ( PS-CARTON-ERROR )                                       11160099
111610         MOVE DP015-UNP-ALP-BRT-OFF  TO ACTNIDA                   11161099
111620         MOVE DP015-RED              TO ACTNIDC                   11162099
111630         MOVE DP015-REVERSE          TO ACTNIDH                   11163099
111640         MOVE -1                     TO ACTNIDL                   11164099
111650         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      11165099
111660         IF ( PS-NO-ERROR )                                       11166099
111700             EVALUATE TRUE                                        11170099
111800                 WHEN PS-CARTON-MSG2                              11180099
111900                     MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER     11190099
112000                 WHEN PS-CARTON-MSG3                              11200099
112100                     MOVE PC-TSYMSG-00010 TO DP020-MSG-NUMBER     11210099
112200                 WHEN PS-CARTON-MSG4                              11220099
112300                     MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER     11230099
112400             END-EVALUATE                                         11240099
112500             SET PS-ERROR                                         11250099
112600                 DP020-MSG-FATAL         TO TRUE                  11260099
113110         END-IF                                                   11311099
113120     END-IF.                                                      11312099
113200/                                                                 11320099
113228****************************************************************  11322899
113229* 3200-RESET-ATTRIBUTES                                        *  11322999
113230****************************************************************  11323099
113240 3200-RESET-ATTRIBUTES.                                           11324099
113250                                                                  11325099
113260     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       11326099
113270                                                                  11327099
113280     MOVE DP015-UNP-ALP-NOR-OFF TO AOPRUNTA                       11328099
113290                                   APONBRA                        11329099
113291                                   ARCVNBRA                       11329199
113292                                   ALNENBRA                       11329299
113293                                   APRPKIDA                       11329399
113294                                   AAUDNBRA                       11329499
113295                                   ACTNIDA.                       11329599
113296                                                                  11329699
113297     MOVE DP015-GREEN          TO AOPRUNTC                        11329799
113298                                   APONBRC                        11329899
113299                                   ARCVNBRC                       11329999
113300                                   ALNENBRC                       11330099
113301                                   APRPKIDC                       11330199
113302                                   AAUDNBRC                       11330299
113303                                   ACTNIDC.                       11330399
113304     MOVE DP015-UNDERLINE      TO AOPRUNTH                        11330499
113305                                   APONBRH                        11330599
113306                                   ARCVNBRH                       11330699
113307                                   ALNENBRH                       11330799
113308                                   APRPKIDH                       11330899
113309                                   AAUDNBRH                       11330999
113310                                   ACTNIDH.                       11331099
113311                                                                  11331199
113312     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       11331299
113313/                                                                 11331399
131400****************************************************************  13140099
131500* 4000-BUILD-INITIAL-PANEL                                     *  13150099
131600****************************************************************  13160099
135000 4000-BUILD-INITIAL-PANEL.                                        13500018
135100                                                                  13510018
135200     PERFORM 4100-GET-STORE-INFORMATION.                          13520018
135300     PERFORM 4200-COUNT-DIRTV-AVAIL.                              13530038
135400                                                                  13540018
135500     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        13550018
135600                                                                  13560018
135700     MOVE ASC-OPER-UNT-ID          TO AOPRUNTO.                   13570018
135800     MOVE ASC-FCLTY-NME            TO AOPRNMEO.                   13580018
135900                                                                  13590018
136000     MOVE ASC-PO-NBR-N             TO APONBRO.                    13600078
136100     MOVE ASC-RCVR-SEQ-NBR         TO ARCVNBRO.                   13610033
136200     MOVE ASC-PO-LNE-NBR           TO ALNENBRO.                   13620033
136300     MOVE ASC-PACK-TYPE            TO ARPCKTPO.                   13630050
136400     MOVE ASC-PREPK-ID             TO APRPKIDO.                   13640028
136500     MOVE ASC-AUD-CNTL-NBR         TO AAUDNBRO.                   13650065
136600     MOVE ASC-BRCDE-NBR            TO ACTNIDO.                    13660064
136700     MOVE ASC-COUNT-DIRECTIVES     TO ADRLSDCO.                   13670076
136800/                                                                 13680099
137410****************************************************************  13741099
137420* 4100-GET-STORE-INFORMATION                                   *  13742099
137430****************************************************************  13743099
137500 4100-GET-STORE-INFORMATION.                                      13750018
137600                                                                  13760018
137700     INITIALIZE XL071-COMMAREA.                                   13770018
137800     MOVE ASC-OPER-UNT-ID TO XL071-LOCATION-NUMBER.               13780018
137900                                                                  13790018
138000     CALL XL071-LOCATION-MODULE USING                             13800018
138100                                DFHEIBLK                          13810018
138200                                XL071-COMMAREA                    13820018
138300                                XL071-COMMAREA-REC.               13830018
138400                                                                  13840018
138500     EVALUATE TRUE                                                13850018
138600         WHEN XL071-NO-ERRORS                                     13860018
138700         WHEN XL071-DC-ASGMT-NOT-FND                              13870018
138800              MOVE XL071-LOC-NM TO ASC-FCLTY-NME                  13880018
138900                                                                  13890018
139000         WHEN XL071-LOC-NOT-FOUND                                 13900018
139100              MOVE 'STORE NAME NOT FOUND' TO ASC-FCLTY-NME        13910018
139200                                                                  13920018
139300         WHEN OTHER                                               13930018
139400              MOVE '4000-BUILD-INITIAL-PANEL'                     13940018
139500                                  TO DP013-PARAGRAPH              13950018
139600              STRING 'SELECT STORE NUMBER - '                     13960018
139700                      XL071-LOCATION-NUMBER                       13970018
139800                     ' - BAD RETURN CODE FROM XLKUT071 - '        13980018
139900                      XL071-RETURN-CODE                           13990018
140000                      DELIMITED BY SIZE                           14000018
140100                      INTO DP013-MESSAGE-TEXT (1)                 14010018
140200              STRING 'SQLCODE - '                                 14020018
140300                      XL071-SQLCODE                               14030018
140400                     ' - '                                        14040018
140500                      XL071-DB2-TABLE                             14050018
140600                      DELIMITED BY SIZE                           14060018
140700                      INTO DP013-MESSAGE-TEXT (2)                 14070018
140800              MOVE XL071-SQLCA     TO DP013-SQLCA                 14080018
140900              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    14090018
141000              MOVE XL071-SQLCODE TO SQLCODE                       14100018
141100              SET DP013-DB2-ABEND                                 14110018
141200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              14120018
141300              PERFORM DP013-0000-PROCESS-ABEND                    14130018
141400                                                                  14140018
141500     END-EVALUATE.                                                14150018
141600/                                                                 14160099
141610****************************************************************  14161099
141620* 4200-COUNT-DIRTV-AVAIL                                       *  14162099
141630****************************************************************  14163099
141640 4200-COUNT-DIRTV-AVAIL.                                          14164099
141650                                                                  14165099
141660     MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID.                     14166099
141670     MOVE ZEROES           TO ASC-COUNT-DIRECTIVES.               14167099
141680                                                                  14168099
141690***  EXEC SQL                                                     14169099
141691***      SELECT  COUNT(*)                                         14169199
141693***        INTO  :PV-COUNT-DIRECTIVES                             14169399
141695***        FROM  SUT_CART_DIRV_TRKG   A                           14169599
141696***       WHERE  A.OPER_UNT_ID       = :DK-OPER-UNT-ID            14169699
141697***         AND  A.LGCL_LOC_NM       = :PC-CAROUSEL               14169799
141698***         AND  A.CRE_TMST          =                            14169899
141699***                     (SELECT MAX(B.CRE_TMST)                   14169999
141700***                        FROM SUT_CART_DIRV_TRKG  B             14170099
141701***                       WHERE B.BRCDE_NBR = A.BRCDE_NBR)        14170199
141702***  END-EXEC.                                                    14170299
141703                                                                  14170399
141704     EXEC SQL                                                     14170499
141705         SELECT  COUNT(*)                                         14170599
141706           INTO  :PV-COUNT-DIRECTIVES                             14170699
141707           FROM  SUT_CART_DIRV_TRKG   A                           14170799
141708          WHERE  A.OPER_UNT_ID       = :DK-OPER-UNT-ID            14170899
141709            AND  A.LGCL_LOC_NM       = :PC-CAROUSEL               14170999
141717            AND  A.CRE_TMST          =                            14171799
141718                 (SELECT MAX(B.CRE_TMST)                          14171899
141719                    FROM SUT_CART_DIRV_TRKG  B                    14171999
141720                   WHERE B.BRCDE_NBR = A.BRCDE_NBR                14172099
141730                     AND  A.DIRV_RSN_CDE  NOT IN ('AUN',          14173099
141740                                                  'AUP',          14174099
141742                                                  'RCL',          14174299
141743                                                  'RLC',          14174399
141744                                                  'RLF',          14174499
141745                                                  'RLO')          14174599
141746                 )                                                14174699
141750     END-EXEC.                                                    14175099
141751                                                                  14175199
141752     EVALUATE TRUE                                                14175299
141753         WHEN SQLCODE = +0                                        14175399
141754              MOVE PV-COUNT-DIRECTIVES TO ASC-COUNT-DIRECTIVES    14175499
141755                                                                  14175599
141756         WHEN SQLCODE = +100                                      14175699
141757              CONTINUE                                            14175799
141758         WHEN SQLWARN0 NOT = SPACES                               14175899
141759         WHEN SQLCODE < +0                                        14175999
141760         WHEN SQLCODE > +0                                        14176099
141761             MOVE '3060-VALIDATE-CNTL-NBR      '                  14176199
141762                                       TO DP013-PARAGRAPH         14176299
141763             MOVE 'BAD SELECT                     '               14176399
141764                                 TO DP013-MESSAGE-TEXT (1)        14176499
141765             MOVE SQLCA      TO DP013-SQLCA                       14176599
141766             MOVE 'SUT-PO-AUD-REQ'  TO                            14176699
141767                                DP013-DB2-TABLE-NAME (1)          14176799
141768             SET DP013-DB2-ABEND                                  14176899
141769                 DP013-XCTL-DISPLAY-RESTART TO TRUE               14176999
141770             PERFORM DP013-0000-PROCESS-ABEND                     14177099
141771     END-EVALUATE.                                                14177199
141772/                                                                 14177299
141773****************************************************************  14177399
141774* 4400-MOVE-COMMAREA-TO-SCREEN                                 *  14177499
141780****************************************************************  14178099
142000 4400-MOVE-COMMAREA-TO-SCREEN.                                    14200018
142100     MOVE ASC-OPER-UNT-ID          TO AOPRUNTO.                   14210018
142200     MOVE ASC-FCLTY-NME            TO AOPRNMEO.                   14220018
142300                                                                  14230024
142400     MOVE ASC-PO-NBR-N             TO APONBRO.                    14240078
142500     MOVE ASC-RCVR-SEQ-NBR         TO ARCVNBRO.                   14250033
142600     MOVE ASC-PO-LNE-NBR           TO ALNENBRO.                   14260033
142700     MOVE ASC-PACK-TYPE            TO ARPCKTPO.                   14270050
142800     MOVE ASC-PREPK-ID             TO APRPKIDO.                   14280028
142900     MOVE ASC-AUD-CNTL-NBR         TO AAUDNBRO.                   14290065
143000     MOVE ASC-BRCDE-NBR            TO ACTNIDO.                    14300064
143100     MOVE ASC-COUNT-DIRECTIVES     TO ADRLSDCO.                   14310076
143200     MOVE -1                     TO APONBRL.                      14320077
143300     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         14330077
143400/                                                                 14340099
143410****************************************************************  14341099
143420* 6000-FORMAT-CURRENT-DATE                                     *  14342099
143430****************************************************************  14343099
144200 6000-FORMAT-CURRENT-DATE.                                        14420018
144300                                                                  14430018
144400     EXEC SQL                                                     14440018
144500        SET :PV-CURRENT-TIMESTAMP = CURRENT TIMESTAMP             14450018
144600     END-EXEC.                                                    14460018
144700                                                                  14470018
144800     EVALUATE TRUE                                                14480018
144900        WHEN SQLCODE = +0                                         14490018
145000            CONTINUE                                              14500018
145100        WHEN OTHER                                                14510018
145200            CONTINUE                                              14520018
145700     END-EVALUATE.                                                14570018
145800/                                                                 14580099
145900*----------------------------------------------------------------*14590018
146000*    ABEND PROCESSOR MODULE                                      *14600018
146100*----------------------------------------------------------------*14610018
146300     COPY DPPD013.                                                14630018
