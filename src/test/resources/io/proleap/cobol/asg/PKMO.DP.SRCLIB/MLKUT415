       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.    MLKUT415.                                         00020000
       AUTHOR.        BARBARA HULL.                                     00030000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
       DATE-WRITTEN.  07-23-98.                                         00050000
       DATE-COMPILED.                                                   00060000
      ******************************************************************00070000
      *                                                                 00080000
      * MLKUT415 - DESCRIPTION.............                             00090003
      *                                                                 00100000
      * THIS PROGRAM WILL CREATE THE DATA INTEGRITY EXTRACT FILE FOR    00110000
      * TMNDPT.                                                         00120000
      *                                                                 00130000
      *CHANGE HISTORY:                                                  00131012
      * WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES           00132012
      * ------- ---------- ----------- -------------------------------- 00133012
W26603* W26603  03-08-2004 ROD JANSSEN MERCH LEDGER STORE EXPANSION     00134012
W28582* W28582  08-20-2007 B.GRAHAM    ADD SECOND OUTPUT FILE           00135013
W28582*                                SELECTING ADDITIONAL INFO        00136013
W28582*                                INC000000035939                  00137018
      ******************************************************************00140000
      *                                                                 00150000
       ENVIRONMENT DIVISION.                                            00160000
      *                                                                 00170000
       CONFIGURATION SECTION.                                           00180000
      *                                                                 00190000
       SOURCE-COMPUTER.        IBM-3090.                                00200000
       OBJECT-COMPUTER.        IBM-3090.                                00210000
      *                                                                 00220000
       INPUT-OUTPUT SECTION.                                            00230000
       FILE-CONTROL.                                                    00240000
                                                                        00250000
           SELECT DATA-INTEGRITY-CTL-FILE                               00260000
               ASSIGN TO INP01.                                         00270000
                                                                        00280000
           SELECT DATA-INTEGRITY-EXTR-FILE                              00290000
               ASSIGN TO OUT01.                                         00300000
W28582                                                                  00301013
W28582     SELECT DATA-INTEGRITY-EXTR-FILE-2                            00302015
W28582         ASSIGN TO OUT02.                                         00303013
                                                                        00310000
      ******************************************************************00320000
       DATA DIVISION.                                                   00330000
      ******************************************************************00340000
                                                                        00350000
       FILE SECTION.                                                    00360000
                                                                        00370000
       FD  DATA-INTEGRITY-CTL-FILE                                      00380000
           LABEL RECORDS ARE STANDARD                                   00390000
           RECORDING MODE IS F                                          00400000
           BLOCK CONTAINS 0 RECORDS.                                    00410000
       01  DATA-INTEGRITY-CTL-REC      PIC X(80).                       00420000
                                                                        00430000
       FD  DATA-INTEGRITY-EXTR-FILE                                     00440000
           RECORDING MODE IS F                                          00450000
           LABEL RECORDS ARE STANDARD                                   00460000
           BLOCK CONTAINS 0 RECORDS.                                    00470000
                                                                        00480000
W26603 01  DATA-INTEGRITY-EXTR-REC     PIC X(120).                      00490012
W28582                                                                  00491013
W28582 FD  DATA-INTEGRITY-EXTR-FILE-2                                   00492013
W28582     RECORDING MODE IS F                                          00493013
W28582     LABEL RECORDS ARE STANDARD                                   00494013
W28582     BLOCK CONTAINS 0 RECORDS.                                    00495013
W28582                                                                  00496013
W28582 01  DATA-INTEGRITY-EXTR-REC-2   PIC X(200).                      00497015
                                                                        00500000
      *                                                                 00510000
      ******************************************************************00520000
       WORKING-STORAGE SECTION.                                         00530000
      ******************************************************************00540000
                                                                        00550000
       01  PS-PROGRAM-SWITCHES.                                         00560000
           05  PS-TMNDPT-DONE          PIC X       VALUE 'N'.           00570000
               88  PS-TMNDPT-IS-DONE               VALUE 'Y'.           00580000
               88  PS-TMNDPT-IS-NOT-DONE           VALUE 'N'.           00590000
                                                                        00600000
       01  PA-PROGRAM-ACCUMULATORS                 COMP-3.              00610001
           05  PA-TMNDPT-ROWS-FETCHED  PIC S9(13)  VALUE ZERO.          00620000
           05  PA-OUTPUT-RECS-WRITTEN  PIC S9(13)  VALUE ZERO.          00630000
W28582     05  PA-OUTPUT-RECS-WRITTEN-2                                 00631013
W28582                                 PIC S9(13)  VALUE ZERO.          00632013
                                                                        00640000
       01  CD-COUNTER-DISPLAY.                                          00650000
           05  CD-COUNT-HOLD1          PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.           00660000
                                                                        00670000
       01 ABEND-AREAS.                                                  00680000
           05 ABEND-CODE               PIC S9(04)  VALUE ZERO           00690000
                                                   COMP SYNC.           00700000
               88  AC-BAD-DATA                     VALUE +4003.         00710000
               88  AC-DB2-ERROR                    VALUE +4013.         00720000
           05  AA-ABEND-LIT            PIC X(40)   VALUE                00730000
                 '*****       ABEND'.                                   00740000
           05  AA-PROGRAM-LIT          PIC X(40)   VALUE                00750000
                   '*****   PROGRAM: MLKUT415'.                         00760000
           05  AA-PARAGRAPH-LIT.                                        00770000
               10  FILLER              PIC X(17)   VALUE                00780000
                   '***** PARAGRAPH: '.                                 00790000
               10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        00800000
           05  AA-MESSAGE-LINE.                                         00810000
               10  FILLER              PIC X(06)   VALUE '*****'.       00820000
               10  AA-MESSAGE          PIC X(127)  VALUE SPACES.        00830000
           05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                00840000
                   '*****    DB2 ERROR'.                                00850000
           05  AA-DB2-OPERATION-LIT.                                    00860000
               10  FILLER              PIC X(17)   VALUE                00870000
                   '***** OPERATION: '.                                 00880000
               10  AA-DB2-OPERATION.                                    00890000
                   15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.        00900000
                   15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.        00910000
           05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.        00920000
           05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.        00930000
           05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.        00940000
           05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.        00950000
                                                                        00960000
       EJECT                                                            00970000
                                                                        00980000
      *** DATA INTEGRITY CONTROL CARD                                   00990003
           COPY MLRD110.                                                01000007
                                                                        01010003
                                                                        01020003
      *** DATA INTEGRITY TMNDPT EXTRACT FILE                            01030003
W26603     COPY MLRD111.                                                01040012
W28582                                                                  01041013
W28582*** DATA INTEGRITY TMNDPT EXTRACT FILE 2                          01042013
W28582     COPY MLRD211.                                                01043013
                                                                        01050003
       EJECT                                                            01060003
                                                                        01070003
      ******************************************************************01080000
      *  DB2 ERROR MESSAGES FORMAT AREA.                                01090000
      ******************************************************************01100000
           COPY DPWS004.                                                01110007
                                                                        01120000
      ******************************************************************01130000
      *  DB2 ERRORS                                                     01140000
      ******************************************************************01150000
           COPY SQLCA2.                                                 01160000
                                                                        01170000
      ******************************************************************01180000
      *  DB2 COMMUNICATION AREA                                         01190000
      ******************************************************************01200000
           EXEC SQL                                                     01210000
                INCLUDE SQLCA                                           01220000
           END-EXEC.                                                    01230000
                                                                        01240000
      ******************************************************************01250000
      *  DB2 TMNDPT TABLE LAYOUT                                        01260000
      ******************************************************************01270000
           EXEC SQL                                                     01280000
                INCLUDE TMNDPT                                          01290000
           END-EXEC.                                                    01300000
                                                                        01310000
      ******************************************************************01320000
      *  DB2 TMNDPT CURSOR                                              01330000
      ******************************************************************01340000
           EXEC SQL                                                     01350000
               DECLARE TMNDPT_CURSOR CURSOR FOR                         01360000
                SELECT FSCL_MN_END_DTE,                                 01370000
                       FSCL_MN_NBR,                                     01380000
                       DEPT_NBR,                                        01390000
                       SLS_RTL_AMT,                                     01400000
                       MKDN_RTL_AMT,                                    01410000
                       MKUP_RTL_AMT,                                    01420000
                       XFER_IN_RTL_AMT,                                 01430000
                       XFER_OUT_RTL_AMT,                                01440000
                       RCPT_RTL_AMT,                                    01450000
                       RCPT_NET_COST_AMT,                               01460000
                       PADJ_RTL_AMT,                                    01470000
                       PADJ_NET_COST_AMT,                               01480000
                       INV_ADJ_RTL_AMT,                                 01490000
                       SHNK_RTL_AMT,                                    01500011
W28582                 END_INV_RTL_AMT,                                 01501013
W28582                 END_INV_COST_AMT,                                01502013
W28582                 GRO_MRGN_AMT                                     01503013
                  FROM TMNDPT                                           01510000
                 WHERE (FSCL_MN_END_DTE >= :ML110-STRT-DTE)             01520000
                   AND (FSCL_MN_END_DTE <= :ML110-END-DTE)              01530000
              ORDER BY FSCL_MN_END_DTE,                                 01540000
                       DEPT_NBR                                         01550000
W26603            WITH UR                                               01551012
           END-EXEC.                                                    01560000
                                                                        01570000
       EJECT                                                            01580000
                                                                        01590000
      ******************************************************************01600000
       PROCEDURE DIVISION.                                              01610000
      ******************************************************************01620000
                                                                        01630000
      ******************************************************************01640000
       0000-MAINLINE-MLKUT415.                                          01650008
      ******************************************************************01660000
      *                                                                 01670000
           PERFORM 1000-INITIALIZATION.                                 01680008
                                                                        01690000
           PERFORM 2000-MAIN-PROCESS.                                   01700008
                                                                        01710000
           PERFORM 8000-EOJ.                                            01720008
                                                                        01730000
           STOP RUN.                                                    01740000
                                                                        01750000
       EJECT                                                            01760000
                                                                        01770000
      ******************************************************************01780000
       1000-INITIALIZATION.                                             01790008
      ******************************************************************01800000
      *                                                                 01810000
           OPEN INPUT  DATA-INTEGRITY-CTL-FILE.                         01820000
W28582     OPEN OUTPUT DATA-INTEGRITY-EXTR-FILE                         01830013
W28582                 DATA-INTEGRITY-EXTR-FILE-2.                      01831013
                                                                        01840000
           PERFORM 4000-READ-CONTROL-CARD.                              01850008
                                                                        01860000
           DISPLAY ' '.                                                 01870000
           DISPLAY '*** MLKUT415 INPUT CONTROL CARD VALUES ***'         01880000
           DISPLAY ML110-DATA-INTEGRITY-CC-REC.                         01890000
                                                                        01900000
       EJECT                                                            01910000
                                                                        01920000
      ******************************************************************01930000
       2000-MAIN-PROCESS.                                               01940008
      ******************************************************************01950000
      *                                                                 01960000
           PERFORM 7100-OPEN-CURSOR-TMNDPT.                             01970008
                                                                        01980000
           PERFORM 7200-FETCH-TMNDPT.                                   01990008
                                                                        02000000
           PERFORM                                                      02010000
             UNTIL PS-TMNDPT-IS-DONE                                    02020000
               PERFORM 5000-WRITE-EXTRACT                               02030008
               PERFORM 7200-FETCH-TMNDPT                                02040008
           END-PERFORM.                                                 02050000
                                                                        02060000
           PERFORM 7300-CLOSE-CURSOR-TMNDPT.                            02070008
                                                                        02080000
       EJECT                                                            02090000
                                                                        02100000
      ******************************************************************02110008
       4000-READ-CONTROL-CARD.                                          02120008
      ******************************************************************02130008
      *                                                                 02140008
           READ DATA-INTEGRITY-CTL-FILE                                 02150008
             INTO ML110-DATA-INTEGRITY-CC-REC                           02160008
               AT END                                                   02170008
                   MOVE '4000-READ-CONTROL-CARD'                        02180008
                                       TO AA-PARAGRAPH-NAME             02190008
                   MOVE 'CONTROL CARD IS MISSING'                       02200008
                                       TO AA-MESSAGE                    02210008
                   MOVE +4001          TO ABEND-CODE                    02220008
                   PERFORM 9900-COMMON-ABEND-ROUTINE                    02230008
           END-READ.                                                    02240008
                                                                        02250008
       EJECT                                                            02260008
                                                                        02270008
      ******************************************************************02280000
       5000-WRITE-EXTRACT.                                              02290008
      ******************************************************************02300000
      *                                                                 02310000
           MOVE MNDPT-FSCL-MN-END-DTE  TO ML111-FSCL-MN-END-DTE.        02320000
           MOVE MNDPT-FSCL-MN-NBR      TO ML111-FSCL-MN-NBR.            02330000
           MOVE MNDPT-DEPT-NBR         TO ML111-DEPT-NBR.               02340000
           MOVE '00'                   TO ML111-MAJ-CL-NBR.             02350000
           MOVE '00'                   TO ML111-SUB-CL-NBR.             02360000
           MOVE 0                      TO ML111-STR-NBR.                02370000
           MOVE MNDPT-SLS-RTL-AMT      TO ML111-SLS-RTL-AMT.            02380000
           MOVE MNDPT-MKDN-RTL-AMT     TO ML111-MKDN-RTL-AMT.           02390000
           MOVE MNDPT-MKUP-RTL-AMT     TO ML111-MKUP-RTL-AMT.           02400000
           MOVE MNDPT-XFER-IN-RTL-AMT  TO ML111-XFER-IN-RTL-AMT.        02410000
           MOVE MNDPT-XFER-OUT-RTL-AMT TO ML111-XFER-OUT-RTL-AMT.       02420000
           MOVE MNDPT-RCPT-RTL-AMT     TO ML111-RCPT-RTL-AMT.           02430000
           MOVE MNDPT-RCPT-NET-COST-AMT                                 02440000
                                       TO ML111-RCPT-NET-COST-AMT.      02450000
           MOVE MNDPT-PADJ-RTL-AMT     TO ML111-PADJ-RTL-AMT.           02460000
           MOVE MNDPT-PADJ-NET-COST-AMT                                 02470000
                                       TO ML111-PADJ-NET-COST-AMT.      02480000
           MOVE MNDPT-INV-ADJ-RTL-AMT  TO ML111-INV-ADJ-RTL-AMT.        02490000
           MOVE MNDPT-SHNK-RTL-AMT     TO ML111-SHNK-RTL-AMT.           02500000
           MOVE MNDPT-END-INV-RTL-AMT  TO ML111-END-INV-RTL-AMT.        02501010
                                                                        02510000
           WRITE DATA-INTEGRITY-EXTR-REC                                02520000
               FROM ML111-DATA-INTEGRITY-EXTR-REC.                      02530000
           ADD 1                       TO PA-OUTPUT-RECS-WRITTEN.       02540000
W28582*                                                                 02541014
W28582     MOVE MNDPT-FSCL-MN-END-DTE  TO ML211-FSCL-MN-END-DTE.        02542014
W28582     MOVE MNDPT-FSCL-MN-NBR      TO ML211-FSCL-MN-NBR.            02543014
W28582     MOVE MNDPT-DEPT-NBR         TO ML211-DEPT-NBR.               02544014
W28582     MOVE '00'                   TO ML211-MAJ-CL-NBR.             02545014
W28582     MOVE '00'                   TO ML211-SUB-CL-NBR.             02546014
W28582     MOVE 0                      TO ML211-STR-NBR.                02547014
W28582     MOVE MNDPT-SLS-RTL-AMT      TO ML211-SLS-RTL-AMT.            02548014
W28582     MOVE MNDPT-MKDN-RTL-AMT     TO ML211-MKDN-RTL-AMT.           02549014
W28582     MOVE MNDPT-MKUP-RTL-AMT     TO ML211-MKUP-RTL-AMT.           02549114
W28582     MOVE MNDPT-XFER-IN-RTL-AMT  TO ML211-XFER-IN-RTL-AMT.        02549214
W28582     MOVE MNDPT-XFER-OUT-RTL-AMT TO ML211-XFER-OUT-RTL-AMT.       02549314
W28582     MOVE MNDPT-RCPT-RTL-AMT     TO ML211-RCPT-RTL-AMT.           02549414
W28582     MOVE MNDPT-RCPT-NET-COST-AMT                                 02549514
W28582                                 TO ML211-RCPT-NET-COST-AMT.      02549614
W28582     MOVE MNDPT-PADJ-RTL-AMT     TO ML211-PADJ-RTL-AMT.           02549714
W28582     MOVE MNDPT-PADJ-NET-COST-AMT                                 02549814
W28582                                 TO ML211-PADJ-NET-COST-AMT.      02549914
W28582     MOVE MNDPT-INV-ADJ-RTL-AMT  TO ML211-INV-ADJ-RTL-AMT.        02550014
W28582     MOVE MNDPT-SHNK-RTL-AMT     TO ML211-SHNK-RTL-AMT.           02550114
W28582     MOVE MNDPT-END-INV-RTL-AMT  TO ML211-END-INV-RTL-AMT.        02550214
W28582     MOVE ZEROS                  TO ML211-DKEY-NBR.               02550314
W28582     MOVE ZEROS                  TO ML211-END-INV-COST1-AMT.      02550416
W28582     MOVE MNDPT-END-INV-COST-AMT TO ML211-END-INV-COST2-AMT.      02550514
W28582     MOVE MNDPT-GRO-MRGN-AMT     TO ML211-ADJ-GRO-MRGN-AMT.       02550614
W28582                                                                  02550714
W28582     WRITE DATA-INTEGRITY-EXTR-REC-2                              02550814
W28582         FROM ML211-DATA-INTEGRITY-EXTR-REC.                      02550914
W28582     ADD 1                       TO PA-OUTPUT-RECS-WRITTEN-2.     02551014
                                                                        02552014
       EJECT                                                            02560000
                                                                        02570000
      ******************************************************************02580000
       7100-OPEN-CURSOR-TMNDPT.                                         02590008
      ******************************************************************02600000
      *                                                                 02610000
           EXEC SQL                                                     02620000
               OPEN TMNDPT_CURSOR                                       02630000
           END-EXEC.                                                    02640000
                                                                        02650000
           EVALUATE TRUE                                                02660000
               WHEN SQLCODE = 0                                         02670009
                   CONTINUE                                             02670109
               WHEN OTHER                                               02671009
                   MOVE '7100-OPEN-CURSOR-TMNDPT'                       02680008
                                       TO AA-PARAGRAPH-NAME             02690000
                   MOVE 'TMNDPT TABLE ERROR'                            02700000
                                       TO AA-MESSAGE                    02710000
                   MOVE 'OPEN CURSOR'  TO AA-DB2-OPERATION              02720000
                   PERFORM 9901-SQL-ERROR                               02730008
           END-EVALUATE.                                                02820000
                                                                        02830000
       EJECT                                                            02840000
                                                                        02850000
      ******************************************************************02860000
       7200-FETCH-TMNDPT.                                               02870008
      ******************************************************************02880000
      *                                                                 02890000
           EXEC SQL                                                     02900000
               FETCH TMNDPT_CURSOR                                      02910000
                INTO :MNDPT-FSCL-MN-END-DTE,                            02920000
                     :MNDPT-FSCL-MN-NBR,                                02930000
                     :MNDPT-DEPT-NBR,                                   02940000
                     :MNDPT-SLS-RTL-AMT,                                02950000
                     :MNDPT-MKDN-RTL-AMT,                               02960000
                     :MNDPT-MKUP-RTL-AMT,                               02970000
                     :MNDPT-XFER-IN-RTL-AMT,                            02980000
                     :MNDPT-XFER-OUT-RTL-AMT,                           02990000
                     :MNDPT-RCPT-RTL-AMT,                               03000000
                     :MNDPT-RCPT-NET-COST-AMT,                          03010000
                     :MNDPT-PADJ-RTL-AMT,                               03020000
                     :MNDPT-PADJ-NET-COST-AMT,                          03030000
                     :MNDPT-INV-ADJ-RTL-AMT,                            03040000
                     :MNDPT-SHNK-RTL-AMT,                               03050011
W28582               :MNDPT-END-INV-RTL-AMT,                            03051013
W28582               :MNDPT-END-INV-COST-AMT,                           03052013
W28582               :MNDPT-GRO-MRGN-AMT                                03053013
           END-EXEC.                                                    03060000
                                                                        03070000
           EVALUATE TRUE                                                03080000
               WHEN SQLCODE = 0                                         03090000
                   ADD +1              TO PA-TMNDPT-ROWS-FETCHED        03100000
               WHEN SQLCODE = +100                                      03110000
                   MOVE 'Y'            TO PS-TMNDPT-DONE                03120000
               WHEN OTHER                                               03130009
                   MOVE '7200-FETCH-TMNDPT'                             03140008
                                       TO AA-PARAGRAPH-NAME             03150000
                   MOVE 'TMNDPT TABLE ERROR'                            03160000
                                       TO AA-MESSAGE                    03170000
                   MOVE 'FETCH'        TO AA-DB2-OPERATION              03180000
                   PERFORM 9901-SQL-ERROR                               03190008
           END-EVALUATE.                                                03280000
                                                                        03290000
       EJECT                                                            03300000
                                                                        03310000
      ******************************************************************03320000
       7300-CLOSE-CURSOR-TMNDPT.                                        03330008
      ******************************************************************03340000
      *                                                                 03350000
           EXEC SQL                                                     03360000
               CLOSE TMNDPT_CURSOR                                      03370000
           END-EXEC.                                                    03380000
                                                                        03390000
           EVALUATE TRUE                                                03400000
               WHEN SQLCODE = 0                                         03401009
                   CONTINUE                                             03402009
               WHEN OTHER                                               03403009
                   MOVE '7300-CLOSE-CURSOR-TMNDPT'                      03420008
                                       TO AA-PARAGRAPH-NAME             03430000
                   MOVE 'TMNDPT TABLE ERROR'                            03440000
                                       TO AA-MESSAGE                    03450000
                   MOVE 'CLOSE CURSOR' TO AA-DB2-OPERATION              03460000
                   PERFORM 9901-SQL-ERROR                               03470008
           END-EVALUATE.                                                03560000
                                                                        03570000
       EJECT                                                            03580000
                                                                        03590000
      ******************************************************************03600008
       8000-EOJ.                                                        03610008
      ******************************************************************03620008
      *                                                                 03630008
           DISPLAY ' '.                                                 03640008
           DISPLAY '  PROGRAM MLKUT415 PROCESSING SUMMARY'.             03650008
           DISPLAY '  -----------------------------------'.             03660008
           DISPLAY ' '.                                                 03670008
      *                                                                 03680008
           MOVE PA-TMNDPT-ROWS-FETCHED TO CD-COUNT-HOLD1.               03690008
           DISPLAY 'TMNDPT ROWS FETCHED =       ' CD-COUNT-HOLD1.       03700008
      *                                                                 03710008
           MOVE PA-OUTPUT-RECS-WRITTEN TO CD-COUNT-HOLD1.               03720008
           DISPLAY 'EXTRACT RECORDS WRITTEN =   ' CD-COUNT-HOLD1.       03730008
W28582*                                                                 03731013
W28582     MOVE PA-OUTPUT-RECS-WRITTEN-2 TO CD-COUNT-HOLD1.             03732013
W28582     DISPLAY 'EXTRACT RECORDS 2 WRITTEN =   ' CD-COUNT-HOLD1.     03733013
      *                                                                 03740008
           DISPLAY ' '.                                                 03750008
                                                                        03760008
W28582     CLOSE DATA-INTEGRITY-CTL-FILE                                03770013
W28582           DATA-INTEGRITY-EXTR-FILE                               03780013
W28582           DATA-INTEGRITY-EXTR-FILE-2.                            03781017
                                                                        03790008
       EJECT                                                            03800008
                                                                        03810008
      ******************************************************************03820000
       9900-COMMON-ABEND-ROUTINE.                                       03830008
      ******************************************************************03840000
      *                                                                 03850000
           DISPLAY AA-ABEND-LIT.                                        03860000
           DISPLAY AA-PROGRAM-LIT.                                      03870000
           DISPLAY AA-PARAGRAPH-LIT.                                    03880000
           DISPLAY AA-MESSAGE-LINE.                                     03890000
           DISPLAY ABEND-CODE.                                          03900000
                                                                        03910000
           CALL 'ILBOABN0' USING ABEND-CODE.                            03920000
                                                                        03930000
       EJECT                                                            03940000
                                                                        03950000
      ******************************************************************03960000
       9901-SQL-ERROR.                                                  03970008
      ******************************************************************03980000
      *                                                                 03990000
           CLOSE DATA-INTEGRITY-CTL-FILE                                04000000
                 DATA-INTEGRITY-EXTR-FILE.                              04010000
                                                                        04020000
           DISPLAY AA-ABEND-LIT.                                        04030000
           DISPLAY AA-DB2-ERROR-LIT.                                    04040000
           DISPLAY AA-PROGRAM-LIT.                                      04050000
           DISPLAY AA-PARAGRAPH-LIT.                                    04060000
           DISPLAY AA-MESSAGE-LINE.                                     04070000
           DISPLAY AA-DB2-OPERATION-LIT.                                04080000
           SET AC-DB2-ERROR TO TRUE.                                    04090000
           MOVE +4013                  TO ABEND-CODE.                   04100000
                                                                        04110000
           COPY DPPD004.                                                04120000
           CALL 'ILBOABN0' USING ABEND-CODE.                            04130000
                                                                        04140000
