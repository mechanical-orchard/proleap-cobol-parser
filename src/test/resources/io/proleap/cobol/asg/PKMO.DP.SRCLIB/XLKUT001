000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'LOGISTICS DOMAIN ITEM ACCESS MODULE'.                     00020000
000300*    ******                IMPORTANT                 ******  *    00030000
000400*   WHEN THE PROGRAM CHANGES IT MUST BE COMPILED FOR         *    00040000
000500*   BOTH BATCH AND CICS                                      *    00050000
000600*   ALSO IT MUST BE PROMOTED TO QA AND PRODUCTION TWICE -    *    00060000
000700*   ONCE FOR BATCH AND ONCE FOR CICS                         *    00070000
000800*                                                            *    00080000
000801* * * CHANGES THAT DON'T USE VIEWS:                               00080100
000802* * *                                                             00080200
000803* * * 6/28/02 SKU-STAT-CDE TEMPORARILY UPDATED FROM TUPCPLS.      00080300
000804* * * IF SQLCODE IS ANYTHING BUT ZERO, SPACES WILL BE MOVED       00080400
000805* * * TO SKU-STAT-CDE.                                            00080500
000806* * * 2/7/03 PARAGRAPH 8100- ADDED FOR VSCHVL-CHARTC-SEQ-NBR      00080600
000807* * * TO POPULATE HANG FOLD DATA.                                 00080700
000808* * * IF SQLCODE IS ANYTHING BUT ZERO, SPACES WILL BE MOVED       00080800
000809* * * TO SKU-STAT-CDE.                                            00080900
000810*                                                                 00081000
000820 PROGRAM-ID.   XLKUT001.                                          00082000
000830 AUTHOR.        PAUL JORGENSEN.                                   00083000
000840 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00084000
000850 DATE-WRITTEN.  FEBRUARY 2002.                                    00085000
000860 DATE-COMPILED.                                                   00086000
000870 ENVIRONMENT DIVISION.                                            00087000
000880 CONFIGURATION SECTION.                                           00088000
000890 SOURCE-COMPUTER. IBM-3090.                                       00089000
000900 OBJECT-COMPUTER. IBM-3090.                                       00090000
001000                                                                  00100000
001100 DATA DIVISION.                                                   00110000
001200 WORKING-STORAGE SECTION.                                         00120000
001300 01  PV-STUFF.                                                    00130000
001400     05  PV-NULL-IND                  PIC S9(4) VALUE ZERO        00140000
001500                                                COMP SYNC.        00150000
001600     05  PV-UNT-COST-AMT-IND          PIC S9(4) VALUE ZERO        00160000
001700                                                COMP SYNC.        00170000
001800     05  PV-UNT-RTL-AMT-IND           PIC S9(4) VALUE ZERO        00180000
001900                                                COMP SYNC.        00190000
002000     05  PV-MEITGP-NBR-IND            PIC S9(4) VALUE ZERO        00200000
002100                                                COMP SYNC.        00210000
002200     05  PV-CURRENT-DATE              PIC X(10) VALUE SPACES.     00220000
002300     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         00230000
002400                                                COMP SYNC.        00240000
002500     05  PV-DEPT-NBR-N                PIC 9(04).                  00250000
002600     05  PV-DEPT-NBR-A REDEFINES PV-DEPT-NBR-N.                   00260000
002700         10  FILLER                   PIC X.                      00270000
002800         10  PV-DEPT-NBR-3CH          PIC X(03).                  00280000
002900     05  PV-MAJ-CL-NBR-N              PIC 9(04).                  00290000
003000     05  PV-MAJ-CL-NBR-A REDEFINES PV-MAJ-CL-NBR-N.               00300000
003100         10  FILLER                   PIC X(02).                  00310000
003200         10  PV-MAJ-CL-NBR-2CH        PIC X(02).                  00320000
003300     05  PV-SUB-CL-NBR-N              PIC 9(04).                  00330000
003400     05  PV-SUB-CL-NBR-A REDEFINES PV-SUB-CL-NBR-N.               00340000
003500         10  FILLER                   PIC X(01).                  00350000
003600         10  PV-SUB-CL-NBR-3CH.                                   00360000
003700             15  FILLER               PIC X(01).                  00370000
003800             15  PV-SUB-CL-NBR-2CH    PIC X(02).                  00380000
003900                                                                  00390000
004000 01  DK-KEYS.                                                     00400000
004100     05  DK-SUB-CL-NBR                PIC X(03).                  00410000
004200                                                                  00420000
004300*01  PS-SWITCHES.                                                 00430000
004400                                                                  00440000
004500 01  PC-CONSTANTS.                                                00450000
004600     05  PC-MAX-RETRIES              PIC S9(04) VALUE +3          00460000
004700                                                COMP.             00470000
004710     05  PC-F                        PIC X      VALUE 'F'.        00471000
004720     05  PC-H                        PIC X      VALUE 'H'.        00472000
004730     05  PC-INTERNAL-UPC-CDE         PIC X      VALUE 'I'.        00473000
004740     05  PC-M                        PIC X      VALUE 'M'.        00474000
004750     05  PC-U                        PIC X      VALUE 'U'.        00475000
004760     05  PC-HANG                     PIC X(20)  VALUE             00476000
004770         'HANG                '.                                  00477000
004780     05  PC-FOLD                     PIC X(20)  VALUE             00478000
004790         'FOLD                '.                                  00479000
004800     05  PC-MIXED                    PIC X(20)  VALUE             00480000
004810         'MIXED               '.                                  00481000
004820/                                                                 00482000
004830* * * XLV_SKU VIEW                                                00483000
004840     EXEC SQL                                                     00484000
004850         INCLUDE XLV00000                                         00485000
004860     END-EXEC.                                                    00486000
004870* * * XLV_VND_STYL VIEW                                           00487000
004880     EXEC SQL                                                     00488000
004890         INCLUDE XLV00001                                         00489000
004900     END-EXEC.                                                    00490000
005000* * * XLV_SKU_STR VIEW                                            00500000
005100     EXEC SQL                                                     00510000
005200         INCLUDE XLV00002                                         00520000
005300     END-EXEC.                                                    00530000
005400* * * XLV_UPC VIEW                                                00540000
005500     EXEC SQL                                                     00550000
005600         INCLUDE XLV00003                                         00560000
005700     END-EXEC.                                                    00570000
005800* * * XLV_WEB_SKU VIEW                                            00580000
005900     EXEC SQL                                                     00590000
006000         INCLUDE XLV00004                                         00600000
006100     END-EXEC.                                                    00610000
006200                                                                  00620000
006300     EXEC SQL                                                     00630000
006400         INCLUDE TUPCPLS                                          00640000
006500     END-EXEC.                                                    00650000
006600                                                                  00660000
006700*    FOLLOWING TABLES USED FOR HANG-FOLD DATA                     00670000
006800                                                                  00680000
006900     EXEC SQL                                                     00690000
007000         INCLUDE TVSCHVL                                          00700000
007100     END-EXEC.                                                    00710000
007200                                                                  00720000
007300     EXEC SQL                                                     00730000
007400         INCLUDE TMDSEAR                                          00740000
007410     END-EXEC.                                                    00741000
007420                                                                  00742000
007430     EXEC SQL                                                     00743000
007440         INCLUDE TDCVSVL                                          00744000
007450     END-EXEC.                                                    00745000
007460     EXEC SQL                                                     00746000
007470          INCLUDE SQLCA                                           00747000
007480     END-EXEC.                                                    00748000
007490                                                                  00749000
007500                                                                  00750000
007600 LINKAGE SECTION.                                                 00760000
007700     COPY XLWS001.                                                00770000
007800/                                                                 00780000
007900                                                                  00790000
008000 PROCEDURE DIVISION USING XL001-ITEM-COMMAREA.                    00800000
008100                                                                  00810000
008200     SET XL001-SUCCESSFUL        TO TRUE                          00820000
008300     INITIALIZE DCLXLV00000                                       00830000
008400                DCLXLV00001                                       00840000
008500                DCLXLV00002                                       00850000
008600                DCLXLV00003                                       00860000
008700                DCLXLV00004                                       00870000
008800                DCLTUPCPLS                                        00880000
008900                                                                  00890000
009000     EVALUATE TRUE                                                00900000
009100         WHEN XL001-BY-NUMERIC-SKU                                00910000
009200             PERFORM 1000-BY-NUMERIC-SKU                          00920000
009300         WHEN XL001-BY-ITEM                                       00930000
009400             PERFORM 2000-BY-ITEM-NBR                             00940000
009500         WHEN XL001-BY-UPC-NBR                                    00950000
009600             PERFORM 3000-BY-UPC-NBR                              00960000
009700         WHEN XL001-BY-INTR-UPC-ID                                00970000
009800             PERFORM 4000-BY-INTR-UPC-ID                          00980000
009900         WHEN OTHER                                               00990000
010000             SET XL001-INVALID-ACCESS TO TRUE                     01000000
010100     END-EVALUATE.                                                01010000
010200                                                                  01020000
010300*    IF XL001-SUCCESSFUL                                          01030000
010400         PERFORM 9000-BUILD-OUTPUT                                01040000
010500*    END-IF.                                                      01050000
010600                                                                  01060000
010700     MOVE SQLCA                       TO XL001-SQLCA              01070000
010800     GOBACK.                                                      01080000
010900                                                                  01090000
011000 1000-BY-NUMERIC-SKU.                                             01100000
011100     MOVE XL001-KEY-SKU               TO XLV00000-SKU-NBR         01110000
011200                                                                  01120000
011300     IF XL001-SELECT-SKU                                          01130000
011400         PERFORM 7010-SELECT-SKU-BY-SKU                           01140000
011500         IF XL001-SUCCESSFUL                                      01150000
                  IF XL001-SELECT-TUPCPLS                               01151000
011600               PERFORM 8000-GET-SKU-STAT-CDE                      01160000
                  ELSE                                                  01161000
                     MOVE SPACE TO UPCPLS-UPC-STAT-CDE                  01162000
                  END-IF                                                01163000
011700         END-IF                                                   01170000
011800     ELSE                                                         01180000
011810         PERFORM 1010-GET-INTR-UPC-ID-STYL-ID                     01181000
011820     END-IF                                                       01182000
011830                                                                  01183000
011840     IF XL001-SUCCESSFUL                                          01184000
011850         IF XL001-SELECT-VND-STYL                                 01185000
011860             PERFORM 7100-SELECT-VND-STYL                         01186000
011870**GB 5/05    PERFORM 8100-SELECT-HANG-FOLD                        01187000
011880         END-IF                                                   01188000
011890         IF XL001-SELECT-SKU-STR                                  01189000
011900             MOVE XL001-KEY-STR-NBR    TO XLV00002-STR-NBR        01190000
012000             PERFORM 7200-SELECT-SKU-STR                          01200000
012010         END-IF                                                   01201000
012020         IF XL001-SELECT-UPC                                      01202000
012030             PERFORM 7300-SELECT-UPC                              01203000
012040         END-IF                                                   01204000
012050         IF XL001-SELECT-WEB-SKU                                  01205000
012060             PERFORM 7400-SELECT-WEB-SKU                          01206000
012070         END-IF                                                   01207000
012080     END-IF.                                                      01208000
012090                                                                  01209000
012100 1010-GET-INTR-UPC-ID-STYL-ID.                                    01210000
012200                                                                  01220000
012300     PERFORM                                                      01230000
012400         WITH TEST AFTER                                          01240000
012500         VARYING PV-RETRY-COUNTER                                 01250000
012600         FROM 1 BY 1                                              01260000
012700         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  01270000
012800            OR SQLCODE = ZERO                                     01280000
012900            OR SQLCODE = +100                                     01290000
013000                                                                  01300000
013100         EXEC SQL                                                 01310000
013200             SELECT DISTINCT                                      01320000
013300                 INTR_UPC_ID                                      01330000
013400                ,STYL_ID                                          01340000
013500          INTO  :XLV00000-INTR-UPC-ID                             01350000
013600               ,:XLV00000-STYL-ID                                 01360000
013700          FROM                                                    01370000
013800             XLV_SKU                                              01380000
013900         WHERE SKU_NBR         = :XLV00000-SKU-NBR                01390000
014000           AND SKU_STAT_CDE <> '98'                               01400000
070510          WITH UR                                                 01401000
014100         END-EXEC                                                 01410000
014200                                                                  01420000
014300         EVALUATE TRUE                                            01430000
014400             WHEN SQLCODE = ZERO                                  01440000
014500             WHEN SQLCODE = -904                                  01450000
014600             WHEN SQLCODE = -913                                  01460000
014700             WHEN SQLCODE = -911                                  01470000
014800                 CONTINUE                                         01480000
014900             WHEN SQLWARN0 NOT = SPACES                           01490000
015000             WHEN SQLCODE NOT = ZERO                              01500000
015100                 MOVE +4             TO PV-RETRY-COUNTER          01510000
015200         END-EVALUATE                                             01520000
015300     END-PERFORM.                                                 01530000
015400*                                                                 01540000
015500     MOVE SQLCODE                 TO XL001-SKU-SQLCODE.           01550000
015600     IF SQLCODE NOT = ZERO                                        01560000
015700       AND PV-RETRY-COUNTER > PC-MAX-RETRIES                      01570000
015800         IF XL001-SKU-CONTENTION                                  01580000
015900             MOVE '1010-'         TO XL001-CONTENTION-ERR-PARA-NBR01590000
016000         ELSE                                                     01600000
016100             MOVE '1010-'         TO XL001-ERROR-PARAGRAPH-NBR    01610000
016200         END-IF                                                   01620000
016300         SET XL001-SQL-ERROR      TO TRUE                         01630000
016400     END-IF.                                                      01640000
016500/                                                                 01650000
016600 2000-BY-ITEM-NBR.                                                01660000
016700     MOVE XL001-KEY-ITM-NBR          TO XLV00000-ITM-NBR          01670000
016800                                                                  01680000
016900     IF XL001-SELECT-SKU                                          01690000
017000         PERFORM 7020-SELECT-SKU-BY-ITM                           01700000
017100         IF XL001-SUCCESSFUL                                      01710000
                  IF XL001-SELECT-TUPCPLS                               01711000
017200               PERFORM 8000-GET-SKU-STAT-CDE                      01720000
                  ELSE                                                  01721000
                     MOVE SPACE TO UPCPLS-UPC-STAT-CDE                  01722000
                  END-IF                                                01723000
017300         END-IF                                                   01730000
017400     ELSE                                                         01740000
017500         PERFORM 2010-GET-INTR-UPC-ID-STYL-ID                     01750000
017600     END-IF                                                       01760000
017700                                                                  01770000
017800     IF XL001-SUCCESSFUL                                          01780000
017900         IF XL001-SELECT-VND-STYL                                 01790000
018000             PERFORM 7100-SELECT-VND-STYL                         01800000
018100**GB 5/05    PERFORM 8100-SELECT-HANG-FOLD                        01810000
018200         END-IF                                                   01820000
018300         IF XL001-SELECT-SKU-STR                                  01830000
018400             MOVE XL001-KEY-STR-NBR    TO XLV00002-STR-NBR        01840000
018500             PERFORM 7200-SELECT-SKU-STR                          01850000
018600         END-IF                                                   01860000
018700         IF XL001-SELECT-UPC                                      01870000
018800             PERFORM 7300-SELECT-UPC                              01880000
018900         END-IF                                                   01890000
019000         IF XL001-SELECT-WEB-SKU                                  01900000
019100             PERFORM 7400-SELECT-WEB-SKU                          01910000
019200         END-IF                                                   01920000
019300     END-IF.                                                      01930000
019400                                                                  01940000
019500 2010-GET-INTR-UPC-ID-STYL-ID.                                    01950000
019600                                                                  01960000
019700     PERFORM                                                      01970000
019800         WITH TEST AFTER                                          01980000
019900         VARYING PV-RETRY-COUNTER                                 01990000
020000         FROM 1 BY 1                                              02000000
020100         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  02010000
020200            OR SQLCODE = ZERO                                     02020000
020300            OR SQLCODE = +100                                     02030000
020400                                                                  02040000
020500         EXEC SQL                                                 02050000
020600             SELECT DISTINCT                                      02060000
020700                 INTR_UPC_ID                                      02070000
020800                ,STYL_ID                                          02080000
020900          INTO  :XLV00000-INTR-UPC-ID                             02090000
021000               ,:XLV00000-STYL-ID                                 02100000
021100          FROM                                                    02110000
021200             XLV_SKU                                              02120000
021300         WHERE ITM_NBR         = :XLV00000-ITM-NBR                02130000
021400           AND SKU_STAT_CDE <> '98'                               02140000
070510          WITH UR                                                 02141000
021500         END-EXEC                                                 02150000
021600                                                                  02160000
021700         EVALUATE TRUE                                            02170000
021800             WHEN SQLCODE = ZERO                                  02180000
021900             WHEN SQLCODE = -904                                  02190000
022000             WHEN SQLCODE = -913                                  02200000
022100             WHEN SQLCODE = -911                                  02210000
022200                 CONTINUE                                         02220000
022300             WHEN SQLWARN0 NOT = SPACES                           02230000
022400             WHEN SQLCODE NOT = ZERO                              02240000
022500                 MOVE +4              TO PV-RETRY-COUNTER         02250000
022600         END-EVALUATE                                             02260000
022700     END-PERFORM.                                                 02270000
022800*                                                                 02280000
022900     MOVE SQLCODE                 TO XL001-SKU-SQLCODE.           02290000
023000     IF SQLCODE NOT = ZERO                                        02300000
023100       AND PV-RETRY-COUNTER > PC-MAX-RETRIES                      02310000
023200         IF XL001-SKU-CONTENTION                                  02320000
023300             MOVE '2010-'         TO XL001-CONTENTION-ERR-PARA-NBR02330000
023400         ELSE                                                     02340000
023500             MOVE '2010-'         TO XL001-ERROR-PARAGRAPH-NBR    02350000
023600         END-IF                                                   02360000
023700         SET XL001-SQL-ERROR      TO TRUE                         02370000
023800     END-IF.                                                      02380000
023900                                                                  02390000
024000 3000-BY-UPC-NBR.                                                 02400000
024100     MOVE XL001-KEY-UPC-NBR         TO XLV00003-UPC-NBR           02410000
024200     PERFORM 3010-GET-INTR-UPC-ID                                 02420000
024300                                                                  02430000
024400     IF XL001-SUCCESSFUL                                          02440000
024500         IF XL001-SELECT-SKU                                      02450000
024600             PERFORM 7000-SELECT-SKU                              02460000
024700             IF XL001-SUCCESSFUL                                  02470000
                      IF XL001-SELECT-TUPCPLS                           02471000
024800                   PERFORM 8000-GET-SKU-STAT-CDE                  02480000
                      ELSE                                              02481000
                         MOVE SPACE TO UPCPLS-UPC-STAT-CDE              02482000
                      END-IF                                            02483000
024900             END-IF                                               02490000
025000         END-IF                                                   02500000
025100         IF XL001-SELECT-VND-STYL                                 02510000
025200* * * IF SELECTING SKU, STYL-ID WILL BE PRESENT                   02520000
025300             IF XL001-SELECT-SKU                                  02530000
025400                 PERFORM 7100-SELECT-VND-STYL                     02540000
025500             ELSE                                                 02550000
025600                 PERFORM 7110-SELECT-VND-STYL-BY-UPC              02560000
025700             END-IF                                               02570000
025800**GB 5/05    PERFORM 8100-SELECT-HANG-FOLD                        02580000
025900         END-IF                                                   02590000
026000         IF XL001-SELECT-SKU-STR                                  02600000
026100             MOVE XL001-KEY-STR-NBR    TO XLV00002-STR-NBR        02610000
026200             PERFORM 7200-SELECT-SKU-STR                          02620000
026300         END-IF                                                   02630000
026400         IF XL001-SELECT-UPC                                      02640000
026500             PERFORM 7350-SELECT-UPC-BY-UPC                       02650000
026600         END-IF                                                   02660000
026700         IF XL001-SELECT-WEB-SKU                                  02670000
026800             PERFORM 7400-SELECT-WEB-SKU                          02680000
026900         END-IF                                                   02690000
027000     END-IF.                                                      02700000
027100                                                                  02710000
027200 3010-GET-INTR-UPC-ID.                                            02720000
027300                                                                  02730000
027400     PERFORM                                                      02740000
027500         WITH TEST AFTER                                          02750000
027600         VARYING PV-RETRY-COUNTER                                 02760000
027700         FROM 1 BY 1                                              02770000
027800         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  02780000
027900            OR SQLCODE = ZERO                                     02790000
028000            OR SQLCODE = +100                                     02800000
028100                                                                  02810000
028200         EXEC SQL                                                 02820000
028300             SELECT DISTINCT                                      02830000
028400                 INTR_UPC_ID                                      02840000
028500          INTO  :XLV00000-INTR-UPC-ID                             02850000
028600          FROM                                                    02860000
028700             XLV_UPC                                              02870000
028800         WHERE UPC_NBR       = :XLV00003-UPC-NBR                  02880000
070510          WITH UR                                                 02881000
028900         END-EXEC                                                 02890000
029000                                                                  02900000
029100         EVALUATE TRUE                                            02910000
029200             WHEN SQLCODE = ZERO                                  02920000
029300             WHEN SQLCODE = -904                                  02930000
029400             WHEN SQLCODE = -913                                  02940000
029500             WHEN SQLCODE = -911                                  02950000
029600                 CONTINUE                                         02960000
029700             WHEN SQLWARN0 NOT = SPACES                           02970000
029800             WHEN SQLCODE NOT = ZERO                              02980000
029900                 MOVE +4           TO PV-RETRY-COUNTER            02990000
030000         END-EVALUATE                                             03000000
030100     END-PERFORM.                                                 03010000
030200*                                                                 03020000
030300     MOVE SQLCODE                 TO XL001-UPC-SQLCODE.           03030000
030400     IF SQLCODE NOT = ZERO                                        03040000
030500       AND PV-RETRY-COUNTER > PC-MAX-RETRIES                      03050000
030600         IF XL001-UPC-CONTENTION                                  03060000
030700             MOVE '3010-'         TO XL001-CONTENTION-ERR-PARA-NBR03070000
030800         ELSE                                                     03080000
030900             MOVE '3010-'         TO XL001-ERROR-PARAGRAPH-NBR    03090000
031000         END-IF                                                   03100000
031100         SET XL001-SQL-ERROR      TO TRUE                         03110000
031200     END-IF.                                                      03120000
031300/                                                                 03130000
031400 4000-BY-INTR-UPC-ID.                                             03140000
031500     MOVE XL001-KEY-INTR-UPC-ID    TO XLV00000-INTR-UPC-ID        03150000
031600                                                                  03160000
031700     IF XL001-SELECT-SKU                                          03170000
031800         PERFORM 7000-SELECT-SKU                                  03180000
031900         IF XL001-SUCCESSFUL                                      03190000
                  IF XL001-SELECT-TUPCPLS                               03191000
032000               PERFORM 8000-GET-SKU-STAT-CDE                      03200000
                  ELSE                                                  03201000
                     MOVE SPACE TO UPCPLS-UPC-STAT-CDE                  03202000
                  END-IF                                                03203000
032100         END-IF                                                   03210000
032200     END-IF                                                       03220000
032300     IF XL001-SELECT-VND-STYL                                     03230000
032400* * * IF SELECTING SKU, STYL-ID WILL BE PRESENT                   03240000
032500         IF XL001-SELECT-SKU                                      03250000
032600             PERFORM 7100-SELECT-VND-STYL                         03260000
032700         ELSE                                                     03270000
032800             PERFORM 7110-SELECT-VND-STYL-BY-UPC                  03280000
032900         END-IF                                                   03290000
033000**GB 5/05PERFORM 8100-SELECT-HANG-FOLD                            03300000
033100     END-IF                                                       03310000
033200     IF XL001-SELECT-SKU-STR                                      03320000
033300         MOVE XL001-KEY-STR-NBR    TO XLV00002-STR-NBR            03330000
033400         PERFORM 7200-SELECT-SKU-STR                              03340000
033500     END-IF                                                       03350000
033600     IF XL001-SELECT-UPC                                          03360000
033700         PERFORM 7300-SELECT-UPC                                  03370000
033800     END-IF                                                       03380000
033900     IF XL001-SELECT-WEB-SKU                                      03390000
034000         PERFORM 7400-SELECT-WEB-SKU                              03400000
034100     END-IF.                                                      03410000
034200/                                                                 03420000
034300                                                                  03430000
034400 7000-SELECT-SKU.                                                 03440000
034500                                                                  03450000
034600     PERFORM                                                      03460000
034700         WITH TEST AFTER                                          03470000
034800         VARYING PV-RETRY-COUNTER                                 03480000
034900         FROM 1 BY 1                                              03490000
035000         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  03500000
035100            OR SQLCODE = ZERO                                     03510000
035200                                                                  03520000
035300         EXEC SQL                                                 03530000
035400             SELECT DISTINCT                                      03540000
035500                 STYL_ID                                          03550000
035600             ,   ITM_NBR                                          03560000
035700             ,   SKU_NBR                                          03570000
035800             ,   INNR_PK_QTY                                      03580000
035900             ,   OUTR_PK_QTY                                      03590000
036000             ,   SKU_DESC                                         03600000
036100             ,   KOHLS_SIZE_CDE                                   03610000
036200             ,   SIZE_DESC                                        03620000
036300             ,   NRF_CLOR_CDE                                     03630000
036400             ,   SHRT_CLOR_DESC                                   03640000
036500             ,   CSTM_CLOR_DESC                                   03650000
036600             ,   REGN_PRIC_IND                                    03660000
036700             ,   KY_ITM_IND                                       03670000
036800             ,   GP_CDE                                           03680000
036900             ,   SKU_STAT_CDE                                     03690000
037000         INTO                                                     03700000
037100                :XLV00000-STYL-ID                                 03710000
037200             ,  :XLV00000-ITM-NBR                                 03720000
037300             ,  :XLV00000-SKU-NBR                                 03730000
037400             ,  :XLV00000-INNR-PK-QTY                             03740000
037500             ,  :XLV00000-OUTR-PK-QTY                             03750000
037600             ,  :XLV00000-SKU-DESC                                03760000
037700             ,  :XLV00000-KOHLS-SIZE-CDE                          03770000
037800             ,  :XLV00000-SIZE-DESC                               03780000
037900             ,  :XLV00000-NRF-CLOR-CDE                            03790000
038000             ,  :XLV00000-SHRT-CLOR-DESC                          03800000
038100             ,  :XLV00000-CSTM-CLOR-DESC                          03810000
038200             ,  :XLV00000-REGN-PRIC-IND                           03820000
038300             ,  :XLV00000-KY-ITM-IND                              03830000
038400             ,  :XLV00000-GP-CDE                                  03840000
038500             ,  :XLV00000-SKU-STAT-CDE                            03850000
038600          FROM                                                    03860000
038700             XLV_SKU                                              03870000
038800         WHERE INTR_UPC_ID     = :XLV00000-INTR-UPC-ID            03880000
038900           AND SKU_STAT_CDE <> '98'                               03890000
070510          WITH UR                                                 03891000
039000         END-EXEC                                                 03900000
039100                                                                  03910000
039200         EVALUATE TRUE                                            03920000
039300             WHEN SQLCODE = ZERO                                  03930000
039400             WHEN SQLCODE = -904                                  03940000
039500             WHEN SQLCODE = -913                                  03950000
039600             WHEN SQLCODE = -911                                  03960000
039700                 CONTINUE                                         03970000
039800             WHEN SQLWARN0 NOT = SPACES                           03980000
039900             WHEN SQLCODE NOT = ZERO                              03990000
040000                 MOVE +4          TO PV-RETRY-COUNTER             04000000
040100         END-EVALUATE                                             04010000
040200     END-PERFORM.                                                 04020000
040300*                                                                 04030000
040400     MOVE SQLCODE                 TO XL001-SKU-SQLCODE.           04040000
040500     IF SQLCODE NOT = ZERO                                        04050000
040600       AND PV-RETRY-COUNTER > PC-MAX-RETRIES                      04060000
040700         IF XL001-SKU-CONTENTION                                  04070000
040800             MOVE '7000-'         TO XL001-CONTENTION-ERR-PARA-NBR04080000
040900         ELSE                                                     04090000
041000             MOVE '7000-'         TO XL001-ERROR-PARAGRAPH-NBR    04100000
041100         END-IF                                                   04110000
041200         SET XL001-SQL-ERROR      TO TRUE                         04120000
041300     END-IF.                                                      04130000
041400                                                                  04140000
041500 7010-SELECT-SKU-BY-SKU.                                          04150000
041600                                                                  04160000
041700     PERFORM                                                      04170000
041800         WITH TEST AFTER                                          04180000
041900         VARYING PV-RETRY-COUNTER                                 04190000
042000         FROM 1 BY 1                                              04200000
042100         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  04210000
042200            OR SQLCODE = ZERO                                     04220000
042300                                                                  04230000
042400         EXEC SQL                                                 04240000
042500             SELECT DISTINCT                                      04250000
042600                 INTR_UPC_ID                                      04260000
042700             ,   STYL_ID                                          04270000
042800             ,   ITM_NBR                                          04280000
042900             ,   INNR_PK_QTY                                      04290000
043000             ,   OUTR_PK_QTY                                      04300000
043100             ,   SKU_DESC                                         04310000
043200             ,   KOHLS_SIZE_CDE                                   04320000
043300             ,   SIZE_DESC                                        04330000
043400             ,   NRF_CLOR_CDE                                     04340000
043500             ,   SHRT_CLOR_DESC                                   04350000
043600             ,   CSTM_CLOR_DESC                                   04360000
043700             ,   REGN_PRIC_IND                                    04370000
043800             ,   KY_ITM_IND                                       04380000
043900             ,   GP_CDE                                           04390000
044000             ,   SKU_STAT_CDE                                     04400000
044100         INTO                                                     04410000
044200                :XLV00000-INTR-UPC-ID                             04420000
044300             ,  :XLV00000-STYL-ID                                 04430000
044400             ,  :XLV00000-ITM-NBR                                 04440000
044500             ,  :XLV00000-INNR-PK-QTY                             04450000
044600             ,  :XLV00000-OUTR-PK-QTY                             04460000
044700             ,  :XLV00000-SKU-DESC                                04470000
044800             ,  :XLV00000-KOHLS-SIZE-CDE                          04480000
044900             ,  :XLV00000-SIZE-DESC                               04490000
045000             ,  :XLV00000-NRF-CLOR-CDE                            04500000
045100             ,  :XLV00000-SHRT-CLOR-DESC                          04510000
045200             ,  :XLV00000-CSTM-CLOR-DESC                          04520000
045300             ,  :XLV00000-REGN-PRIC-IND                           04530000
045400             ,  :XLV00000-KY-ITM-IND                              04540000
045500             ,  :XLV00000-GP-CDE                                  04550000
045600             ,  :XLV00000-SKU-STAT-CDE                            04560000
045700          FROM                                                    04570000
045800             XLV_SKU                                              04580000
045900         WHERE SKU_NBR       = :XLV00000-SKU-NBR                  04590000
046000           AND SKU_STAT_CDE <> '98'                               04600000
070510          WITH UR                                                 04601000
046100         END-EXEC                                                 04610000
046200                                                                  04620000
046300         EVALUATE TRUE                                            04630000
046400             WHEN SQLCODE = ZERO                                  04640000
046500             WHEN SQLCODE = -904                                  04650000
046600             WHEN SQLCODE = -913                                  04660000
046700             WHEN SQLCODE = -911                                  04670000
046800                 CONTINUE                                         04680000
046900             WHEN SQLWARN0 NOT = SPACES                           04690000
047000             WHEN SQLCODE NOT = ZERO                              04700000
047100                 MOVE +4          TO PV-RETRY-COUNTER             04710000
047200         END-EVALUATE                                             04720000
047300     END-PERFORM.                                                 04730000
047400*                                                                 04740000
047500     MOVE SQLCODE                 TO XL001-SKU-SQLCODE.           04750000
047600     IF SQLCODE NOT = ZERO                                        04760000
047700       AND PV-RETRY-COUNTER > PC-MAX-RETRIES                      04770000
047800         IF XL001-SKU-CONTENTION                                  04780000
047900             MOVE '7010-'         TO XL001-CONTENTION-ERR-PARA-NBR04790000
048000         ELSE                                                     04800000
048100             MOVE '7010-'         TO XL001-ERROR-PARAGRAPH-NBR    04810000
048200         END-IF                                                   04820000
048300         SET XL001-SQL-ERROR      TO TRUE                         04830000
048400     END-IF.                                                      04840000
048500                                                                  04850000
048600 7020-SELECT-SKU-BY-ITM.                                          04860000
048700                                                                  04870000
048800     PERFORM                                                      04880000
048900         WITH TEST AFTER                                          04890000
049000         VARYING PV-RETRY-COUNTER                                 04900000
049100         FROM 1 BY 1                                              04910000
049200         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  04920000
049300            OR SQLCODE = ZERO                                     04930000
049400                                                                  04940000
049500         EXEC SQL                                                 04950000
049600             SELECT DISTINCT                                      04960000
049700                 INTR_UPC_ID                                      04970000
049800             ,   STYL_ID                                          04980000
049900             ,   SKU_NBR                                          04990000
050000             ,   INNR_PK_QTY                                      05000000
050100             ,   OUTR_PK_QTY                                      05010000
050200             ,   SKU_DESC                                         05020000
050300             ,   KOHLS_SIZE_CDE                                   05030000
050400             ,   SIZE_DESC                                        05040000
050500             ,   NRF_CLOR_CDE                                     05050000
050600             ,   SHRT_CLOR_DESC                                   05060000
050700             ,   CSTM_CLOR_DESC                                   05070000
050800             ,   REGN_PRIC_IND                                    05080000
050900             ,   KY_ITM_IND                                       05090000
051000             ,   GP_CDE                                           05100000
051100             ,   SKU_STAT_CDE                                     05110000
051200         INTO                                                     05120000
051300                :XLV00000-INTR-UPC-ID                             05130000
051400             ,  :XLV00000-STYL-ID                                 05140000
051500             ,  :XLV00000-SKU-NBR                                 05150000
051600             ,  :XLV00000-INNR-PK-QTY                             05160000
051700             ,  :XLV00000-OUTR-PK-QTY                             05170000
051800             ,  :XLV00000-SKU-DESC                                05180000
051900             ,  :XLV00000-KOHLS-SIZE-CDE                          05190000
052000             ,  :XLV00000-SIZE-DESC                               05200000
052100             ,  :XLV00000-NRF-CLOR-CDE                            05210000
052200             ,  :XLV00000-SHRT-CLOR-DESC                          05220000
052300             ,  :XLV00000-CSTM-CLOR-DESC                          05230000
052400             ,  :XLV00000-REGN-PRIC-IND                           05240000
052500             ,  :XLV00000-KY-ITM-IND                              05250000
052600             ,  :XLV00000-GP-CDE                                  05260000
052700             ,  :XLV00000-SKU-STAT-CDE                            05270000
052800          FROM                                                    05280000
052900             XLV_SKU                                              05290000
053000         WHERE ITM_NBR       = :XLV00000-ITM-NBR                  05300000
053100           AND SKU_STAT_CDE <> '98'                               05310000
070510          WITH UR                                                 05311000
053200         END-EXEC                                                 05320000
053300                                                                  05330000
053400         EVALUATE TRUE                                            05340000
053500             WHEN SQLCODE = ZERO                                  05350000
053600             WHEN SQLCODE = -904                                  05360000
053700             WHEN SQLCODE = -913                                  05370000
053800             WHEN SQLCODE = -911                                  05380000
053900                 CONTINUE                                         05390000
054000             WHEN SQLWARN0 NOT = SPACES                           05400000
054100             WHEN SQLCODE NOT = ZERO                              05410000
054200                 MOVE +4          TO PV-RETRY-COUNTER             05420000
054300         END-EVALUATE                                             05430000
054400     END-PERFORM.                                                 05440000
054500*                                                                 05450000
054600     MOVE SQLCODE                 TO XL001-SKU-SQLCODE.           05460000
054700     IF SQLCODE NOT = ZERO                                        05470000
054800       AND PV-RETRY-COUNTER > PC-MAX-RETRIES                      05480000
054900         IF XL001-SKU-CONTENTION                                  05490000
055000             MOVE '7020-'         TO XL001-CONTENTION-ERR-PARA-NBR05500000
055100         ELSE                                                     05510000
055200             MOVE '7020-'         TO XL001-ERROR-PARAGRAPH-NBR    05520000
055300         END-IF                                                   05530000
055400         SET XL001-SQL-ERROR      TO TRUE                         05540000
055500     END-IF.                                                      05550000
055600/                                                                 05560000
055700 7100-SELECT-VND-STYL.                                            05570000
055800                                                                  05580000
055900     PERFORM                                                      05590000
056000         WITH TEST AFTER                                          05600000
056100         VARYING PV-RETRY-COUNTER                                 05610000
056200         FROM 1 BY 1                                              05620000
056300         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  05630000
056400            OR SQLCODE = ZERO                                     05640000
056500                                                                  05650000
056600         EXEC SQL                                                 05660000
056700             SELECT DISTINCT                                      05670000
056800                 STYL_ID                                          05680000
056900             ,   DEPT_NBR                                         05690000
057000             ,   MAJ_CL_NBR                                       05700000
057100             ,   SUB_CL_NBR                                       05710000
057200             ,   VS_ID                                            05720000
057300             ,   VS_NBR                                           05730000
057400             ,   ENT_ID                                           05740000
057500             ,   STKR_NBR                                         05750000
057600             ,   TKT_TYP_DESC                                     05760000
057700             ,   HNG_FOLD_DESC                                    05770000
057800         INTO                                                     05780000
057900                :XLV00001-STYL-ID                                 05790000
058000             ,  :XLV00001-DEPT-NBR                                05800000
058100             ,  :XLV00001-MAJ-CL-NBR                              05810000
058200             ,  :XLV00001-SUB-CL-NBR                              05820000
058300             ,  :XLV00001-VS-ID                                   05830000
058400             ,  :XLV00001-VS-NBR                                  05840000
058500             ,  :XLV00001-ENT-ID                                  05850000
058600             ,  :XLV00001-STKR-NBR                                05860000
058700             ,  :XLV00001-TKT-TYP-DESC                            05870000
058800             ,  :XLV00001-HNG-FOLD-DESC                           05880000
058900          FROM                                                    05890000
059000             XLV_VND_STYL                                         05900000
059100         WHERE STYL_ID   = :XLV00000-STYL-ID                      05910000
070510          WITH UR                                                 05911000
059200         END-EXEC                                                 05920000
059300                                                                  05930000
059400         EVALUATE TRUE                                            05940000
059500             WHEN SQLCODE = ZERO                                  05950000
059600             WHEN SQLCODE = -904                                  05960000
059700             WHEN SQLCODE = -913                                  05970000
059800             WHEN SQLCODE = -911                                  05980000
059900                 CONTINUE                                         05990000
060000             WHEN SQLWARN0 NOT = SPACES                           06000000
060100             WHEN SQLCODE NOT = ZERO                              06010000
060200                 MOVE +4                  TO PV-RETRY-COUNTER     06020000
060300         END-EVALUATE                                             06030000
060400     END-PERFORM.                                                 06040000
060500*                                                                 06050000
060600     MOVE SQLCODE                 TO XL001-VND-STYL-SQLCODE.      06060000
060700     IF SQLCODE NOT = ZERO                                        06070000
060800       AND PV-RETRY-COUNTER > PC-MAX-RETRIES                      06080000
060900         IF XL001-VND-STYL-CONTENTION                             06090000
061000             MOVE '7100-'         TO XL001-CONTENTION-ERR-PARA-NBR06100000
061100         ELSE                                                     06110000
061200             MOVE '7100-'         TO XL001-ERROR-PARAGRAPH-NBR    06120000
061300         END-IF                                                   06130000
061400         SET XL001-SQL-ERROR      TO TRUE                         06140000
061500     END-IF.                                                      06150000
061600/                                                                 06160000
061700 7110-SELECT-VND-STYL-BY-UPC.                                     06170000
061800                                                                  06180000
061900     PERFORM                                                      06190000
062000         WITH TEST AFTER                                          06200000
062100         VARYING PV-RETRY-COUNTER                                 06210000
062200         FROM 1 BY 1                                              06220000
062300         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  06230000
062400            OR SQLCODE = ZERO                                     06240000
062500                                                                  06250000
062600         EXEC SQL                                                 06260000
062700             SELECT DISTINCT                                      06270000
062800                 B.STYL_ID                                        06280000
062900             ,   B.DEPT_NBR                                       06290000
063000             ,   B.MAJ_CL_NBR                                     06300000
063100             ,   B.SUB_CL_NBR                                     06310000
063200             ,   B.VS_ID                                          06320000
063300             ,   B.VS_NBR                                         06330000
063400             ,   B.ENT_ID                                         06340000
063500             ,   B.STKR_NBR                                       06350000
063600             ,   B.TKT_TYP_DESC                                   06360000
063700             ,   B.HNG_FOLD_DESC                                  06370000
063800         INTO                                                     06380000
063900                :XLV00001-STYL-ID                                 06390000
064000             ,  :XLV00001-DEPT-NBR                                06400000
064100             ,  :XLV00001-MAJ-CL-NBR                              06410000
064200             ,  :XLV00001-SUB-CL-NBR                              06420000
064300             ,  :XLV00001-VS-ID                                   06430000
064400             ,  :XLV00001-VS-NBR                                  06440000
064500             ,  :XLV00001-ENT-ID                                  06450000
064600             ,  :XLV00001-STKR-NBR                                06460000
064700             ,  :XLV00001-TKT-TYP-DESC                            06470000
064800             ,  :XLV00001-HNG-FOLD-DESC                           06480000
064900          FROM                                                    06490000
065000             XLV_SKU      A                                       06500000
065100            ,XLV_VND_STYL B                                       06510000
065200         WHERE A.INTR_UPC_ID   = :XLV00000-INTR-UPC-ID            06520000
065300           AND A.SKU_STAT_CDE <> '98'                             06530000
065400           AND A.STYL_ID       = B.STYL_ID                        06540000
070510          WITH UR                                                 06541000
065500         END-EXEC                                                 06550000
065600                                                                  06560000
065700         EVALUATE TRUE                                            06570000
065800             WHEN SQLCODE = ZERO                                  06580000
065900             WHEN SQLCODE = -904                                  06590000
066000             WHEN SQLCODE = -913                                  06600000
066100             WHEN SQLCODE = -911                                  06610000
066200                 CONTINUE                                         06620000
066300             WHEN SQLWARN0 NOT = SPACES                           06630000
066400             WHEN SQLCODE NOT = ZERO                              06640000
066500                 MOVE +4                  TO PV-RETRY-COUNTER     06650000
066600         END-EVALUATE                                             06660000
066700     END-PERFORM.                                                 06670000
066800*                                                                 06680000
066900     MOVE SQLCODE                 TO XL001-VND-STYL-SQLCODE.      06690000
067000     IF SQLCODE NOT = ZERO                                        06700000
067100       AND PV-RETRY-COUNTER > PC-MAX-RETRIES                      06710000
067200         IF XL001-VND-STYL-CONTENTION                             06720000
067300             MOVE '7110-'         TO XL001-CONTENTION-ERR-PARA-NBR06730000
067400         ELSE                                                     06740000
067500             MOVE '7110-'         TO XL001-ERROR-PARAGRAPH-NBR    06750000
067600         END-IF                                                   06760000
067700         SET XL001-SQL-ERROR      TO TRUE                         06770000
067800     END-IF.                                                      06780000
067900/                                                                 06790000
068000 7200-SELECT-SKU-STR.                                             06800000
068100                                                                  06810000
068200     PERFORM                                                      06820000
068300         WITH TEST AFTER                                          06830000
068400         VARYING PV-RETRY-COUNTER                                 06840000
068500         FROM 1 BY 1                                              06850000
068600         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  06860000
068700            OR SQLCODE = ZERO                                     06870000
068800                                                                  06880000
068900         EXEC SQL                                                 06890000
069000             SELECT DISTINCT                                      06900000
069100                 UNT_RTL_AMT                                      06910000
069200             ,   UNT_COST_AMT                                     06920000
069300             ,   GP_QTY                                           06930000
069400             ,   GP_AMT                                           06940000
069500             ,   STR_SKU_STAT_CDE                                 06950000
069600         INTO                                                     06960000
069700                :XLV00002-UNT-RTL-AMT                             06970000
069800             ,  :XLV00002-UNT-COST-AMT                            06980000
069900             ,  :XLV00002-GP-QTY                                  06990000
070000             ,  :XLV00002-GP-AMT                                  07000000
070100             ,  :XLV00002-STR-SKU-STAT-CDE                        07010000
070200          FROM                                                    07020000
070300             XLV_SKU_STR                                          07030000
070400         WHERE STR_NBR       = :XLV00002-STR-NBR                  07040000
070500           AND INTR_UPC_ID   = :XLV00000-INTR-UPC-ID              07050000
070510          WITH UR                                                 07051000
070600         END-EXEC                                                 07060000
070700                                                                  07070000
070800         EVALUATE TRUE                                            07080000
070900             WHEN SQLCODE = ZERO                                  07090000
071000             WHEN SQLCODE = -904                                  07100000
071100             WHEN SQLCODE = -913                                  07110000
071200             WHEN SQLCODE = -911                                  07120000
071300                 CONTINUE                                         07130000
071400             WHEN SQLWARN0 NOT = SPACES                           07140000
071500             WHEN SQLCODE NOT = ZERO                              07150000
071600                 MOVE +4                  TO PV-RETRY-COUNTER     07160000
071700         END-EVALUATE                                             07170000
071800     END-PERFORM.                                                 07180000
071900*                                                                 07190000
072000     MOVE SQLCODE                 TO XL001-SKU-STR-SQLCODE.       07200000
072100     IF SQLCODE NOT = ZERO                                        07210000
072200       AND PV-RETRY-COUNTER > PC-MAX-RETRIES                      07220000
072300         IF XL001-SKU-STR-CONTENTION                              07230000
072400             MOVE '7200-'         TO XL001-CONTENTION-ERR-PARA-NBR07240000
072500         ELSE                                                     07250000
072600             MOVE '7200-'         TO XL001-ERROR-PARAGRAPH-NBR    07260000
072700         END-IF                                                   07270000
072800         SET XL001-SQL-ERROR      TO TRUE                         07280000
072900     END-IF.                                                      07290000
073000/                                                                 07300000
073100 7300-SELECT-UPC.                                                 07310000
073200                                                                  07320000
073300     IF XL001-KEY-UPC-TYP-CDE = SPACE                             07330000
073400         MOVE PC-INTERNAL-UPC-CDE   TO XLV00003-UPC-TYP-CDE       07340000
073500     ELSE                                                         07350000
073600         MOVE XL001-KEY-UPC-TYP-CDE TO XLV00003-UPC-TYP-CDE       07360000
073700     END-IF                                                       07370000
073800                                                                  07380000
073900     PERFORM                                                      07390000
074000         WITH TEST AFTER                                          07400000
074100         VARYING PV-RETRY-COUNTER                                 07410000
074200         FROM 1 BY 1                                              07420000
074300         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  07430000
074400            OR SQLCODE = ZERO                                     07440000
074500            OR SQLCODE = +100                                     07450000
074600                                                                  07460000
074700         EXEC SQL                                                 07470000
074800             SELECT DISTINCT                                      07480000
074900                 UPC_ID                                           07490000
075000             ,   EDI_ORD_IND                                      07500000
075100             ,   CERTD_IND                                        07510000
075200             ,   CERTD_DTE                                        07520000
075300             ,   UPC_NBR                                          07530000
075400         INTO                                                     07540000
075500                :XLV00003-UPC-ID                                  07550000
075600             ,  :XLV00003-EDI-ORD-IND                             07560000
075700             ,  :XLV00003-CERTD-IND                               07570000
075800             ,  :XLV00003-CERTD-DTE                               07580000
075900             ,  :XLV00003-UPC-NBR                                 07590000
076000          FROM                                                    07600000
076100             XLV_UPC                                              07610000
076200         WHERE INTR_UPC_ID   = :XLV00000-INTR-UPC-ID              07620000
076300           AND UPC_TYP_CDE   = :XLV00003-UPC-TYP-CDE              07630000
070510          WITH UR                                                 07631000
076400         END-EXEC                                                 07640000
076500                                                                  07650000
076600         EVALUATE TRUE                                            07660000
076700             WHEN SQLCODE = ZERO                                  07670000
076800             WHEN SQLCODE = -904                                  07680000
076900             WHEN SQLCODE = -913                                  07690000
077000             WHEN SQLCODE = -911                                  07700000
077100                 CONTINUE                                         07710000
077200             WHEN SQLWARN0 NOT = SPACES                           07720000
077300             WHEN SQLCODE NOT = ZERO                              07730000
077400                 MOVE +4                  TO PV-RETRY-COUNTER     07740000
077500         END-EVALUATE                                             07750000
077600     END-PERFORM.                                                 07760000
077700*                                                                 07770000
077800     MOVE SQLCODE                 TO XL001-UPC-SQLCODE.           07780000
077900     IF SQLCODE NOT = ZERO                                        07790000
078000       AND PV-RETRY-COUNTER > PC-MAX-RETRIES                      07800000
078100         IF XL001-UPC-CONTENTION                                  07810000
078200             MOVE '7300-'         TO XL001-CONTENTION-ERR-PARA-NBR07820000
078300         ELSE                                                     07830000
078400             MOVE '7300-'         TO XL001-ERROR-PARAGRAPH-NBR    07840000
078500         END-IF                                                   07850000
078600         SET XL001-SQL-ERROR      TO TRUE                         07860000
078700     END-IF.                                                      07870000
078800/                                                                 07880000
078900 7350-SELECT-UPC-BY-UPC.                                          07890000
079000                                                                  07900000
079100     PERFORM                                                      07910000
079200         WITH TEST AFTER                                          07920000
079210         VARYING PV-RETRY-COUNTER                                 07921000
079220         FROM 1 BY 1                                              07922000
079230         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  07923000
079240            OR SQLCODE = ZERO                                     07924000
079250            OR SQLCODE = +100                                     07925000
079260                                                                  07926000
079270         EXEC SQL                                                 07927000
079280           SELECT                                                 07928000
079290                 UPC_ID                                           07929000
079300             ,   EDI_ORD_IND                                      07930000
079301             ,   CERTD_IND                                        07930100
079302             ,   CERTD_DTE                                        07930200
079303             ,   UPC_NBR                                          07930300
079304         INTO                                                     07930400
079305                :XLV00003-UPC-ID                                  07930500
079306             ,  :XLV00003-EDI-ORD-IND                             07930600
079307             ,  :XLV00003-CERTD-IND                               07930700
079308             ,  :XLV00003-CERTD-DTE                               07930800
079309             ,  :XLV00003-UPC-NBR                                 07930900
079310          FROM                                                    07931000
079311             XLV_UPC                                              07931100
079312         WHERE UPC_NBR       = :XLV00003-UPC-NBR                  07931200
070510          WITH UR                                                 07931300
079313         END-EXEC                                                 07931400
079314                                                                  07931500
079315         EVALUATE TRUE                                            07931600
079316             WHEN SQLCODE = ZERO                                  07931700
079317             WHEN SQLCODE = -904                                  07931800
079318             WHEN SQLCODE = -913                                  07931900
079319             WHEN SQLCODE = -911                                  07932000
079320                 CONTINUE                                         07932100
079321             WHEN SQLWARN0 NOT = SPACES                           07932200
079322             WHEN SQLCODE NOT = ZERO                              07932300
079323                 MOVE +4                  TO PV-RETRY-COUNTER     07932400
079324         END-EVALUATE                                             07932500
079325     END-PERFORM.                                                 07932600
079326*                                                                 07932700
079327     MOVE SQLCODE                 TO XL001-UPC-SQLCODE.           07932800
079328     IF SQLCODE NOT = ZERO                                        07932900
079329       AND PV-RETRY-COUNTER > PC-MAX-RETRIES                      07933000
079330         IF XL001-UPC-CONTENTION                                  07933100
079331             MOVE '7350-'         TO XL001-CONTENTION-ERR-PARA-NBR07933200
079332         ELSE                                                     07933300
079333             MOVE '7350-'         TO XL001-ERROR-PARAGRAPH-NBR    07933400
079334         END-IF                                                   07933500
079335         SET XL001-SQL-ERROR      TO TRUE                         07933600
079336     END-IF.                                                      07933700
079337/                                                                 07933800
079338 7400-SELECT-WEB-SKU.                                             07933900
079339                                                                  07934000
079340     PERFORM                                                      07934100
079350         WITH TEST AFTER                                          07935000
079360         VARYING PV-RETRY-COUNTER                                 07936000
079370         FROM 1 BY 1                                              07937000
079380         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  07938000
079390            OR SQLCODE = ZERO                                     07939000
079400                                                                  07940000
079500         EXEC SQL                                                 07950000
079600             SELECT DISTINCT                                      07960000
079700                 ASRT_BEG_DTE                                     07970000
079800             ,   ASRT_END_DTE                                     07980000
079900             ,   STRG_AREA_SEQ_NBR                                07990000
080000             ,   STRG_AREA_DESC                                   08000000
080100             ,   SHIP_WD_QTY                                      08010000
080200             ,   SHIP_DPTH_QTY                                    08020000
080300             ,   SHIP_HT_QTY                                      08030000
080400             ,   SHIP_WT_QTY                                      08040000
080500             ,   SHIP_DIM_SRC_CDE                                 08050000
080600             ,   PKG_SEQ_NBR                                      08060000
080700             ,   PKG_CDE_DESC                                     08070000
080800             ,   SHIP_RSTRC_SEQ_NBR                               08080000
080900             ,   SHIP_RSTRC_DESC                                  08090000
081000             ,   GFT_WRAP_AVL_IND                                 08100000
081100             ,   PRD_GP_NBR                                       08110000
081200             ,   PRD_GP_IND                                       08120000
081300             ,   SHIP_SRCHG_FEE_AMT                               08130000
081400             ,   SHIP_SRVC_SEQ_NBR                                08140000
081500             ,   SHIP_SRVC_DESC                                   08150000
081600             ,   SHIP_GP_SEQ_NBR                                  08160000
081700             ,   SHIP_GP_DESC                                     08170000
081800             ,   EFF_BEG_TMST                                     08180000
081900         INTO                                                     08190000
082000                :XLV00004-ASRT-BEG-DTE                            08200000
082100             ,  :XLV00004-ASRT-END-DTE                            08210000
082200             ,  :XLV00004-STRG-AREA-SEQ-NBR                       08220000
082300             ,  :XLV00004-STRG-AREA-DESC                          08230000
082400             ,  :XLV00004-SHIP-WD-QTY                             08240000
082500             ,  :XLV00004-SHIP-DPTH-QTY                           08250000
082600             ,  :XLV00004-SHIP-HT-QTY                             08260000
082700             ,  :XLV00004-SHIP-WT-QTY                             08270000
082800             ,  :XLV00004-SHIP-DIM-SRC-CDE                        08280000
082900             ,  :XLV00004-PKG-SEQ-NBR                             08290000
083000             ,  :XLV00004-PKG-CDE-DESC                            08300000
083100             ,  :XLV00004-SHIP-RSTRC-SEQ-NBR                      08310000
083200             ,  :XLV00004-SHIP-RSTRC-DESC                         08320000
083300             ,  :XLV00004-GFT-WRAP-AVL-IND                        08330000
083400             ,  :XLV00004-PRD-GP-NBR                              08340000
083500             ,  :XLV00004-PRD-GP-IND                              08350000
083600             ,  :XLV00004-SHIP-SRCHG-FEE-AMT                      08360000
083700             ,  :XLV00004-SHIP-SRVC-SEQ-NBR                       08370000
083800             ,  :XLV00004-SHIP-SRVC-DESC                          08380000
083900             ,  :XLV00004-SHIP-GP-SEQ-NBR                         08390000
084000             ,  :XLV00004-SHIP-GP-DESC                            08400000
084100             ,  :XLV00004-EFF-BEG-TMST                            08410000
084200          FROM XLV_WEB_SKU                                        08420000
084300         WHERE INTR_UPC_ID   = :XLV00000-INTR-UPC-ID              08430000
070510          WITH UR                                                 08431000
084400         END-EXEC                                                 08440000
084500                                                                  08450000
084600         EVALUATE TRUE                                            08460000
084700             WHEN SQLCODE = ZERO                                  08470000
084800             WHEN SQLCODE = -904                                  08480000
084900             WHEN SQLCODE = -913                                  08490000
085000             WHEN SQLCODE = -911                                  08500000
085100                 CONTINUE                                         08510000
085200             WHEN SQLWARN0 NOT = SPACES                           08520000
085300             WHEN SQLCODE NOT = ZERO                              08530000
085400                 MOVE +4                  TO PV-RETRY-COUNTER     08540000
085500         END-EVALUATE                                             08550000
085600     END-PERFORM.                                                 08560000
085700*                                                                 08570000
085800     MOVE SQLCODE                 TO XL001-WEB-SKU-SQLCODE.       08580000
085900     IF SQLCODE NOT = ZERO                                        08590000
086000       AND SQLCODE NOT = +100                                     08600000
086100       AND PV-RETRY-COUNTER > PC-MAX-RETRIES                      08610000
086200         IF XL001-WEB-SKU-CONTENTION                              08620000
086300             MOVE '7400-'         TO XL001-CONTENTION-ERR-PARA-NBR08630000
086400         ELSE                                                     08640000
086500             MOVE '7400-'         TO XL001-ERROR-PARAGRAPH-NBR    08650000
086600         END-IF                                                   08660000
086700         SET XL001-SQL-ERROR      TO TRUE                         08670000
086800     END-IF.                                                      08680000
086900/                                                                 08690000
087000 8000-GET-SKU-STAT-CDE.                                           08700000
087100     PERFORM                                                      08710000
087200         WITH TEST AFTER                                          08720000
087300         VARYING PV-RETRY-COUNTER                                 08730000
087400         FROM 1 BY 1                                              08740000
087500         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  08750000
087600            OR SQLCODE = ZERO                                     08760000
087700                                                                  08770000
087800         EXEC SQL                                                 08780000
087900             SELECT DISTINCT                                      08790000
088000                 UPC_STAT_CDE                                     08800000
088100               INTO                                               08810000
088200                :UPCPLS-UPC-STAT-CDE                              08820000
088210               FROM TUPCPLS                                       08821000
088220              WHERE  UPC_ID        = :XLV00000-INTR-UPC-ID        08822000
088230                AND  OPERCO_NBR    = '03'                         08823000
088240                AND  STR_NBR       = 0                            08824000
088250                AND  EFF_BEG_TMST <= CURRENT TIMESTAMP            08825000
088260                AND (EFF_END_TMST >= CURRENT TIMESTAMP            08826000
088270                 OR  EFF_END_TMST IS NULL)                        08827000
088280             WITH UR                                              08828000
088290         END-EXEC                                                 08829000
088291                                                                  08829100
088292         EVALUATE TRUE                                            08829200
088293             WHEN SQLCODE = ZERO                                  08829300
088294             WHEN SQLCODE = -904                                  08829400
088295             WHEN SQLCODE = -913                                  08829500
088296             WHEN SQLCODE = -911                                  08829600
088297                 CONTINUE                                         08829700
088298             WHEN SQLWARN0 NOT = SPACES                           08829800
088299             WHEN SQLCODE NOT = ZERO                              08829900
088300                 MOVE +4                  TO PV-RETRY-COUNTER     08830000
088301         END-EVALUATE                                             08830100
088302     END-PERFORM.                                                 08830200
088303     IF SQLCODE = ZERO                                            08830300
088304         CONTINUE                                                 08830400
088305     ELSE                                                         08830500
088306         MOVE SPACES               TO UPCPLS-UPC-STAT-CDE         08830600
088307     END-IF.                                                      08830700
088308                                                                  08830800
088309*8100-SELECT-HANG-FOLD.                                           08830900
088310*    MOVE XLV00001-SUB-CL-NBR      TO PV-SUB-CL-NBR-N             08831000
088311*    MOVE PV-SUB-CL-NBR-3CH        TO DK-SUB-CL-NBR               08831100
088312*    MOVE XLV00001-DEPT-NBR        TO PV-DEPT-NBR-N               08831200
088313*                                                                 08831300
088314*    PERFORM                                                      08831400
088315*        WITH TEST AFTER                                          08831500
088316*        VARYING PV-RETRY-COUNTER                                 08831600
088317*        FROM 1 BY 1                                              08831700
088318*        UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  08831800
088319*           OR SQLCODE = ZERO                                     08831900
088320*           OR SQLCODE = +100                                     08832000
088321*           OR SQLCODE = -811                                     08832100
088322*                                                                 08832200
088323*        EXEC SQL                                                 08832300
088324*           SELECT                                                08832400
088325*               HVL.CHARTC_SEQ_NBR                                08832500
088326*           END                                                   08832600
088327*           INTO                                                  08832700
088328*              :VSCHVL-CHARTC-SEQ-NBR                             08832800
088329*           FROM                                                  08832900
088330*                TMDSEAR EAR                                      08833000
088331*             ,  TDCVSVL SVL                                      08833100
088332*             ,  TVSCHVL HVL                                      08833200
088333*           WHERE                                                 08833300
088334*                EAR.MDSEAR_DKEY  = SVL.MDSEAR_ID                 08833400
088335*            AND SVL.CHARTC_CDE   = HVL.CHARTC_CDE                08833500
088336*            AND SVL.CHARTC_SEQ_NBR = HVL.CHARTC_SEQ_NBR          08833600
088337*                                                                 08833700
088338*            AND EAR.OPERCO_NBR   = '03'                          08833800
088339*            AND EAR.MDSELV_CDE   = 'SCL'                         08833900
088340*            AND EAR.DEPT_NBR     = :PV-DEPT-NBR-3CH              08834000
088341*            AND EAR.SUB_CL_NBR   = :DK-SUB-CL-NBR                08834100
088342*                                                                 08834200
088343*            AND SVL.CHARTC_CDE   = 10                            08834300
088344*            AND SVL.PRIM_IND     = 'Y'                           08834400
088345*                                                                 08834500
088346*            AND HVL.STAT_CDE     = 'A'                           08834600
088347*        END-EXEC                                                 08834700
088348*                                                                 08834800
088349*        EVALUATE TRUE                                            08834900
088350*            WHEN SQLCODE = ZERO                                  08835000
088351*            WHEN SQLCODE = -811                                  08835100
088352*            WHEN SQLCODE = +100                                  08835200
088353*            WHEN SQLCODE = -904                                  08835300
088354*            WHEN SQLCODE = -913                                  08835400
088355*            WHEN SQLCODE = -911                                  08835500
088356*                CONTINUE                                         08835600
088357*            WHEN SQLWARN0 NOT = SPACES                           08835700
088358*            WHEN SQLCODE NOT = ZERO                              08835800
088359*                MOVE +4               TO PV-RETRY-COUNTER        08835900
088360*        END-EVALUATE                                             08836000
088361*    END-PERFORM.                                                 08836100
088362*    IF SQLCODE = ZERO                                            08836200
088363*        CONTINUE                                                 08836300
088364*    ELSE                                                         08836400
088365*        MOVE ZERO                     TO VSCHVL-CHARTC-SEQ-NBR   08836500
088366*    END-IF.                                                      08836600
088367                                                                  08836700
088368 9000-BUILD-OUTPUT.                                               08836800
088369     MOVE XLV00000-INTR-UPC-ID         TO XL001-INTR-UPC-ID       08836900
088370     IF XL001-SELECT-SKU                                          08837000
088371         MOVE XLV00000-STYL-ID         TO XL001-STYL-ID           08837100
088372         MOVE XLV00000-ITM-NBR         TO XL001-ITM-NBR           08837200
088373         MOVE XLV00000-SKU-NBR         TO XL001-SKU-NBR           08837300
088374         MOVE XLV00000-INNR-PK-QTY     TO XL001-INNR-PACK-QTY     08837400
088375         MOVE XLV00000-OUTR-PK-QTY     TO XL001-OUTR-PACK-QTY     08837500
088376         MOVE XLV00000-SKU-DESC        TO XL001-SKU-DESC          08837600
088377         MOVE XLV00000-KOHLS-SIZE-CDE  TO XL001-KOHLS-SIZE-CDE    08837700
088378         MOVE XLV00000-SIZE-DESC       TO XL001-SIZE-DESC         08837800
088379         MOVE XLV00000-NRF-CLOR-CDE    TO XL001-NRF-CLOR-CDE      08837900
088380         MOVE XLV00000-SHRT-CLOR-DESC  TO XL001-SHRT-CLOR-DESC    08838000
088390         MOVE XLV00000-CSTM-CLOR-DESC  TO XL001-CSTM-CLOR-DESC    08839000
088400         MOVE XLV00000-REGN-PRIC-IND   TO XL001-REGN-PRIC-IND     08840000
088500         MOVE XLV00000-KY-ITM-IND      TO XL001-KY-ITM-IND        08850000
088600         MOVE XLV00000-GP-CDE          TO XL001-GP-CDE            08860000
088700         MOVE UPCPLS-UPC-STAT-CDE      TO XL001-SKU-STAT-CDE      08870000
088800     END-IF                                                       08880000
088900     IF XL001-SELECT-VND-STYL                                     08890000
089000         MOVE XLV00001-STYL-ID         TO XL001-STYL-ID           08900000
089100         MOVE XLV00001-DEPT-NBR        TO XL001-DEPT-NBR          08910000
089200                                          PV-DEPT-NBR-N           08920000
089300         MOVE PV-DEPT-NBR-3CH          TO XL001-DEPT-NBR-3CH      08930000
089400         MOVE XLV00001-MAJ-CL-NBR      TO XL001-MAJ-CL-NBR        08940000
089500                                          PV-MAJ-CL-NBR-N         08950000
089600         MOVE PV-MAJ-CL-NBR-2CH        TO XL001-MAJ-CL-NBR-2CH    08960000
089700         MOVE XLV00001-SUB-CL-NBR      TO XL001-SUB-CL-NBR        08970000
089800                                          PV-SUB-CL-NBR-N         08980000
089900         MOVE PV-SUB-CL-NBR-2CH        TO XL001-SUB-CL-NBR-2CH    08990000
090000         MOVE XLV00001-VS-ID           TO XL001-VS-ID             09000000
090100         MOVE XLV00001-VS-NBR          TO XL001-VS-NBR            09010000
090200         MOVE XLV00001-ENT-ID          TO XL001-ENT-ID            09020000
090300         MOVE XLV00001-STKR-NBR        TO XL001-STKR-NBR          09030000
090400         MOVE XLV00001-TKT-TYP-DESC    TO XL001-TKT-TYP-DESC      09040000
090500*GB 5/05 BEG                                                      09050000
090600         MOVE XLV00001-HNG-FOLD-DESC   TO XL001-HNG-FOLD-DESC     09060000
090700         EVALUATE XLV00001-HNG-FOLD-DESC                          09070000
090800             WHEN PC-HANG                                         09080000
090900                 MOVE PC-H             TO XL001-HNG-FOLD-CDE      09090000
091000             WHEN PC-FOLD                                         09100000
091100                 MOVE PC-F             TO XL001-HNG-FOLD-CDE      09110000
091200*            WHEN PC-MIXED                                        09120000
091300*                MOVE PC-M             TO XL001-HNG-FOLD-CDE      09130000
091400             WHEN SPACES                                          09140000
091410                 MOVE SPACES           TO XL001-HNG-FOLD-CDE      09141000
091420             WHEN OTHER                                           09142000
091430                 MOVE PC-U             TO XL001-HNG-FOLD-CDE      09143000
091440         END-EVALUATE                                             09144000
091450*GB 5/05 END                                                      09145000
091460*        EVALUATE VSCHVL-CHARTC-SEQ-NBR                           09146000
091470*            WHEN 1                                               09147000
091480*                MOVE PC-H             TO XL001-HNG-FOLD-CDE      09148000
091490*                MOVE PC-HANG          TO XL001-HNG-FOLD-DESC     09149000
091491*            WHEN 2                                               09149100
091492*                MOVE PC-F             TO XL001-HNG-FOLD-CDE      09149200
091493*                MOVE PC-FOLD          TO XL001-HNG-FOLD-DESC     09149300
091494*            WHEN 3                                               09149400
091495*                MOVE PC-M             TO XL001-HNG-FOLD-CDE      09149500
091496*                MOVE PC-MIXED         TO XL001-HNG-FOLD-DESC     09149600
091497*            WHEN OTHER                                           09149700
091498*                MOVE SPACES           TO XL001-HNG-FOLD-CDE      09149800
091499*                                         XL001-HNG-FOLD-DESC     09149900
091500*        END-EVALUATE                                             09150000
091510     END-IF                                                       09151000
091520     IF XL001-SELECT-SKU-STR                                      09152000
091530         MOVE XLV00002-UNT-RTL-AMT     TO XL001-UNT-RTL-AMT       09153000
091540         MOVE XLV00002-UNT-COST-AMT    TO XL001-UNT-COST-AMT      09154000
091550         MOVE XLV00002-GP-QTY          TO XL001-GP-QTY            09155000
091560         MOVE XLV00002-GP-AMT          TO XL001-GP-AMT            09156000
091570         MOVE XLV00002-STR-SKU-STAT-CDE                           09157000
091580                                       TO XL001-STR-SKU-STAT-CDE  09158000
091590     END-IF                                                       09159000
091600     IF XL001-SELECT-UPC                                          09160000
091700         MOVE XLV00003-UPC-ID          TO XL001-UPC-ID            09170000
091800         MOVE XLV00003-EDI-ORD-IND     TO XL001-EDI-ORD-IND       09180000
091900         MOVE XLV00003-CERTD-IND       TO XL001-CERTD-IND         09190000
092000         MOVE XLV00003-CERTD-DTE       TO XL001-CERTD-DTE         09200000
092100         MOVE XLV00003-UPC-NBR         TO XL001-UPC-NBR           09210000
092200     END-IF                                                       09220000
092300     IF XL001-SELECT-WEB-SKU                                      09230000
092400         MOVE XLV00004-ASRT-BEG-DTE    TO XL001-ASRT-BEG-DTE      09240000
092500         MOVE XLV00004-ASRT-END-DTE    TO XL001-ASRT-END-DTE      09250000
092600         MOVE XLV00004-STRG-AREA-SEQ-NBR                          09260000
092700                                       TO XL001-STRG-AREA-SEQ-NBR 09270000
092800         MOVE XLV00004-STRG-AREA-DESC  TO XL001-STRG-AREA-DESC    09280000
092900         MOVE XLV00004-SHIP-WD-QTY     TO XL001-SHIP-WD-QTY       09290000
093000         MOVE XLV00004-SHIP-DPTH-QTY   TO XL001-SHIP-DPTH-QTY     09300000
093100         MOVE XLV00004-SHIP-HT-QTY     TO XL001-SHIP-HT-QTY       09310000
093200         MOVE XLV00004-SHIP-WT-QTY     TO XL001-SHIP-WT-QTY       09320000
093300         MOVE XLV00004-SHIP-DIM-SRC-CDE                           09330000
093400                                       TO XL001-SHIP-DIM-SRC-CDE  09340000
093500         MOVE XLV00004-PKG-SEQ-NBR     TO XL001-PKG-SEQ-NBR       09350000
093600         MOVE XLV00004-PKG-CDE-DESC    TO XL001-PKG-CDE-DESC      09360000
093700         MOVE XLV00004-SHIP-RSTRC-SEQ-NBR                         09370000
093800                                      TO XL001-SHIP-RSTRC-SEQ-NBR 09380000
093900         MOVE XLV00004-SHIP-RSTRC-DESC TO XL001-SHIP-RSTRC-DESC   09390000
094000         MOVE XLV00004-GFT-WRAP-AVL-IND                           09400000
094100                                       TO XL001-GFT-WRAP-AVL-IND  09410000
094200         MOVE XLV00004-PRD-GP-NBR      TO XL001-PRD-GP-NBR        09420000
094300         MOVE XLV00004-PRD-GP-IND      TO XL001-PRD-GP-IND        09430000
094400         MOVE XLV00004-SHIP-SRCHG-FEE-AMT                         09440000
094500                                      TO XL001-SHIP-SRCHG-FEE-AMT 09450000
094600         MOVE XLV00004-SHIP-SRVC-SEQ-NBR                          09460000
094700                                       TO XL001-SHIP-SRVC-SEQ-NBR 09470000
094800         MOVE XLV00004-SHIP-SRVC-DESC  TO XL001-SHIP-SRVC-DESC    09480000
094900         MOVE XLV00004-SHIP-GP-SEQ-NBR TO XL001-SHIP-GP-SEQ-NBR   09490000
095000         MOVE XLV00004-SHIP-GP-DESC    TO XL001-SHIP-GP-DESC      09500000
095100         MOVE XLV00004-EFF-BEG-TMST    TO XL001-EFF-BEG-TMST      09510000
095200     END-IF.                                                      09520000
