000100******************************************************************00010046
000200 IDENTIFICATION DIVISION.                                         00020046
000300******************************************************************00030046
000400                                                                  00040046
000500 PROGRAM-ID.             RVKRP014.                                00050046
000600 AUTHOR.                 MICHAEL WALTERS.                         00060046
000700 INSTALLATION.           KOHLS.                                   00070046
000800 DATE-WRITTEN            AUGUST, 1995.                            00080046
000900 DATE-COMPILED.                                                   00090046
001000                                                                  00100046
001100******************************************************************00110046
001200*  THIS PROGRAM CREATES  VENDOR REURN AGREEMENT REPORT.  THE INPUT00120046
001300*  COMES IN BY RECORD TYPE, GMM, DMM, BUYER, VENDOR RANK, VENDOR  00130046
001400*  NAME AND DEPT. THE REPORT IS USED BY THE BUYERS.               00140046
001500******************************************************************00150046
001600                                                                  00160046
001700******************************************************************00170046
001800 ENVIRONMENT DIVISION.                                            00180046
001900******************************************************************00190046
002000                                                                  00200046
002100 CONFIGURATION SECTION.                                           00210046
002200                                                                  00220046
002300 SOURCE-COMPUTER.        IBM-3090.                                00230046
002400 OBJECT-COMPUTER.        IBM-3090.                                00240046
002500                                                                  00250046
002600 INPUT-OUTPUT SECTION.                                            00260046
002700                                                                  00270046
002800 FILE-CONTROL.                                                    00280046
002900                                                                  00290046
003000     SELECT RTV-REPORT-EXTRACT                                    00300046
003100         ASSIGN TO IN01.                                          00310046
003200                                                                  00320046
003300     SELECT DI-DEFECT-ITEM-REPORT                                 00330046
003400         ASSIGN TO RPT01.                                         00340046
003500                                                                  00350046
003600******************************************************************00360046
003700 DATA DIVISION.                                                   00370046
003800******************************************************************00380046
003900                                                                  00390046
004000 FILE SECTION.                                                    00400046
004100                                                                  00410046
004200 FD  RTV-REPORT-EXTRACT                                           00420046
004300     RECORDING MODE IS F                                          00430046
004400     LABEL RECORDS ARE STANDARD                                   00440046
004500     BLOCK CONTAINS 0 RECORDS.                                    00450046
004600                                                                  00460046
004700 01  RTV-REPORT-EXTRACT-RECORD       PIC  X(200).                 00470046
004800                                                                  00480046
004900 FD  DI-DEFECT-ITEM-REPORT                                        00490046
005000     RECORDING MODE IS F                                          00500046
005100     LABEL RECORDS ARE STANDARD                                   00510046
005200     BLOCK CONTAINS 0 RECORDS.                                    00520046
005300                                                                  00530046
005400 01  DI-DEFECT-ITEM-LINE             PIC  X(132).                 00540046
005500                                                                  00550046
005600******************************************************************00560046
005700 WORKING-STORAGE SECTION.                                         00570046
005800******************************************************************00580046
005900*                                                                 00590046
006000*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                00600046
006100*                                                                 00610046
006200     COPY DPWS132O.                                               00620046
006300                                                                  00630046
006400*                                                                 00640046
006500*  RECORD LAYOUT OF THE RTV EXTRACT FILE.                         00650046
006600*                                                                 00660046
006700     COPY RVRD002.                                                00670046
006800                                                                  00680046
006900 01  ABEND-CODE                          PIC S9(04) VALUE +0      00690046
007000                                                     COMP SYNC.   00700046
007100 01  PH2-PAGE-HEADING-QUARTERLY.                                  00710046
007200     05  FILLER                          PIC  X(45)  VALUE SPACE. 00720046
007300     05  FILLER                          PIC  X(42)  VALUE        00730046
007400         'VENDOR RETURN-AGREEMENT REPORT (QUARTERLY)'.            00740046
007500     05  FILLER                          PIC  X(46)  VALUE SPACE. 00750046
007600                                                                  00760046
007700 01  PH2-PAGE-HEADING-REQUEST.                                    00770046
007800     05  FILLER                          PIC  X(42)  VALUE SPACE. 00780046
007900     05  FILLER                          PIC  X(48)  VALUE        00790046
008000         'VENDOR RETURN-AGREEMENT REPORT (SPECIAL REQUEST)'.      00800046
008100     05  FILLER                          PIC  X(43)  VALUE SPACE. 00810046
008200                                                                  00820046
008300 01  PH3-PAGE-HEADING-3.                                          00830046
008400     05  FILLER                          PIC  X(44)  VALUE SPACE. 00840046
008500     05  FILLER                          PIC  X(12)  VALUE        00850046
008600         'BEGIN DATE: '.                                          00860046
008700     05  PH3-START-DATE                  PIC  X(10)  VALUE SPACE. 00870046
008800     05  FILLER                          PIC  X(13)  VALUE        00880046
008900         ' - END DATE: '.                                         00890046
009000     05  PH3-END-DATE                    PIC  X(10)  VALUE SPACE. 00900046
009100     05  FILLER                          PIC  X(42)  VALUE SPACE. 00910046
009200                                                                  00920046
009300 01  PH4-GMM-PAGE-HEADING-4.                                      00930046
009400     05 FILLER                           PIC  X(06)  VALUE        00940046
009500         'GMM:  '.                                                00950046
009600     05 PH4-GMM-NMBR                     PIC  X(02)  VALUE SPACE. 00960046
009700     05 FILLER                           PIC  X(03)  VALUE        00970046
009800         ' - '.                                                   00980046
009900     05 PH4-GMM-NAME                     PIC  X(30) VALUE SPACE.  00990046
010000                                                                  01000046
010100 01  PH5-DMM-PAGE-HEADING-5.                                      01010046
010200     05 FILLER                           PIC  X(06)  VALUE        01020046
010300         'DMM:  '.                                                01030046
010400     05 PH5-DMM-NMBR                     PIC  X(02)  VALUE SPACE. 01040046
010500     05 FILLER                           PIC  X(03)  VALUE        01050046
010600         ' - '.                                                   01060046
010700     05 PH5-DMM-NAME                     PIC  X(30) VALUE SPACE.  01070046
010800                                                                  01080046
010900 01  PH6-BUYER-PAGE-HEADING-6.                                    01090046
011000     05 FILLER                           PIC  X(05)  VALUE        01100046
011100         'BYR: '.                                                 01110046
011200     05 PH6-BUYER-NMBR                   PIC  X(03)  VALUE SPACE. 01120046
011300     05 FILLER                           PIC  X(03)  VALUE        01130046
011400         ' - '.                                                   01140046
011500     05 PH6-BUYER-NAME                   PIC  X(30) VALUE SPACE.  01150046
011600                                                                  01160046
011700 01  DH1-DETAIL-HEADING-1.                                        01170046
011800     05  FILLER                          PIC  X(20)  VALUE        01180046
011900         '                    '.                                  01190046
012000     05  FILLER                          PIC  X(02)  VALUE SPACES.01200046
012100     05  FILLER                          PIC  X(04)  VALUE        01210046
012200         'VEND'.                                                  01220046
012300     05  FILLER                          PIC  X(02)  VALUE SPACES.01230046
012400     05  FILLER                          PIC  X(03)  VALUE        01240046
012500         'DPT'.                                                   01250046
012600     05  FILLER                          PIC  X(02)  VALUE SPACES.01260046
012700     05  FILLER                          PIC  X(20)  VALUE        01270046
012800         ' DEPARTMENT         '.                                  01280046
012900     05  FILLER                          PIC  X(02)  VALUE SPACES.01290046
013000     05  FILLER                          PIC  X(11)  VALUE        01300046
013100         'RTRN AGRMNT'.                                           01310046
013200     05  FILLER                          PIC  X(03)  VALUE SPACES.01320046
013300     05  FILLER                          PIC  X(17)  VALUE        01330046
013400         '        COST OF  '.                                     01340046
013500     05  FILLER                          PIC  X(04)  VALUE SPACES.01350046
013600     05  FILLER                          PIC  X(17)  VALUE        01360046
013700         '        COST OF  '.                                     01370046
013800     05  FILLER                          PIC  X(04)  VALUE SPACES.01380046
013900     05  FILLER                          PIC  X(06)  VALUE        01390046
014000         'RETURN'.                                                01400046
014100     05  FILLER                          PIC  X(03)  VALUE SPACES.01410046
014200     05  FILLER                          PIC  X(10)  VALUE        01420046
014300         'NEGOTIATED'.                                            01430046
014400                                                                  01440046
014500 01  DH2-DETAIL-HEADING-2.                                        01450046
014600     05  FILLER                          PIC  X(20)  VALUE        01460046
014700         ' VENDOR NAME        '.                                  01470046
014800     05  FILLER                          PIC  X(02)  VALUE SPACES.01480046
014900     05  FILLER                          PIC  X(04)  VALUE        01490046
015000         'RANK'.                                                  01500046
015100     05  FILLER                          PIC  X(02)  VALUE SPACES.01510046
015200     05  FILLER                          PIC  X(03)  VALUE        01520046
015300         'NBR'.                                                   01530046
015400     05  FILLER                          PIC  X(02)  VALUE SPACES.01540046
015500     05  FILLER                          PIC  X(20)  VALUE        01550046
015600         ' DESCRIPTION        '.                                  01560046
015700     05  FILLER                          PIC  X(02)  VALUE SPACES.01570046
015800     05  FILLER                          PIC  X(03)  VALUE        01580046
015900         'D&R'.                                                   01590046
016000     05  FILLER                          PIC  X(01)  VALUE SPACES.01600046
016100     05  FILLER                          PIC  X(03)  VALUE        01610046
016200         'D&D'.                                                   01620046
016300     05  FILLER                          PIC  X(01)  VALUE SPACES.01630046
016400     05  FILLER                          PIC  X(03)  VALUE        01640046
016500         'MOS'.                                                   01650046
016600     05  FILLER                          PIC  X(03)  VALUE SPACES.01660046
016700     05  FILLER                          PIC  X(17)  VALUE        01670046
016800         '      PURCHASES  '.                                     01680046
016900     05  FILLER                          PIC  X(04)  VALUE SPACES.01690046
017000     05  FILLER                          PIC  X(17)  VALUE        01700046
017100         '        RETURNS  '.                                     01710046
017200     05  FILLER                          PIC  X(03)  VALUE SPACES.01720046
017300     05  FILLER                          PIC  X(07)  VALUE        01730046
017400         'PERCENT'.                                               01740046
017500     05  FILLER                          PIC  X(06)  VALUE SPACES.01750046
017600     05  FILLER                          PIC  X(07)  VALUE        01760046
017700         'PERCENT'.                                               01770046
017800                                                                  01780046
017900 01  DHD-DETAIL-HEADING-DASHES.                                   01790046
018000     05  FILLER                          PIC  X(20) VALUE ALL '_'.01800046
018100     05  FILLER                          PIC  X(02)  VALUE SPACES.01810046
018200     05  FILLER                          PIC  X(04) VALUE ALL '_'.01820046
018300     05  FILLER                          PIC  X(02)  VALUE SPACES.01830046
018400     05  FILLER                          PIC  X(03) VALUE ALL '_'.01840046
018500     05  FILLER                          PIC  X(02)  VALUE SPACES.01850046
018600     05  FILLER                          PIC  X(20) VALUE ALL '_'.01860046
018700     05  FILLER                          PIC  X(02) VALUE SPACES. 01870046
018800     05  FILLER                          PIC  X(03) VALUE ALL '_'.01880046
018900     05  FILLER                          PIC  X(01) VALUE SPACES. 01890046
019000     05  FILLER                          PIC  X(03) VALUE ALL '_'.01900046
019100     05  FILLER                          PIC  X(01) VALUE SPACES. 01910046
019200     05  FILLER                          PIC  X(03) VALUE ALL '_'.01920046
019300     05  FILLER                          PIC  X(01) VALUE SPACES. 01930046
019400     05  FILLER                          PIC  X(19) VALUE ALL '_'.01940046
019500     05  FILLER                          PIC  X(01) VALUE SPACES. 01950046
019600     05  FILLER                          PIC  X(19) VALUE ALL '_'.01960046
019700     05  FILLER                          PIC  X(02) VALUE SPACES. 01970046
019800     05  FILLER                          PIC  X(10) VALUE ALL '_'.01980046
019900     05  FILLER                          PIC  X(02) VALUE SPACES. 01990046
020000     05  FILLER                          PIC  X(10) VALUE ALL '_'.02000046
020100                                                                  02010046
020200 01  DL-DETAIL-LINE.                                              02020046
020300     05  DL-VENDOR-NAME                  PIC  X(20).              02030046
020400     05  FILLER                          PIC  X(02)  VALUE SPACES.02040046
020500     05  DL-RANK-X.                                               02050046
020600         10  DL-RANK                     PIC  9(04).              02060046
020700     05  FILLER                          PIC  X(02)  VALUE SPACES.02070046
020800     05  DL-DPT-NBR                      PIC  X(03).              02080046
020900     05  FILLER                          PIC  X(02)  VALUE SPACES.02090046
021000     05  DL-DPT-DESC                     PIC  X(20).              02100046
021100     05  FILLER                          PIC  X(02)  VALUE SPACES.02110046
021200     05  DL-DEBIT-AND-RETURN-IND         PIC  X(03)  VALUE SPACES.02120046
021300     05  FILLER                          PIC  X(01)  VALUE SPACES.02130046
021400     05  DL-DEBIT-AND-DISPOSE-IND        PIC  X(03)  VALUE SPACES.02140046
021500     05  FILLER                          PIC  X(01)  VALUE SPACES.02150046
021600     05  DL-MARK-OUT-OF-STOCK-IND        PIC  X(03)  VALUE SPACES.02160046
021700*    05  FILLER                          PIC  X(01)  VALUE SPACES.02170046
021800*    05  DL-PURCHS-COST                  PIC  ZZZ,ZZZ,ZZZ,ZZ9.99-.02180046
021900     05  DL-PURCHS-COST                  PIC ZZZZ,ZZZ,ZZZ,ZZ9.99-.02190046
022000*    05  FILLER                          PIC  X(01)  VALUE SPACES.02200046
022100*    05  DL-RETURN-COST                  PIC  ZZZ,ZZZ,ZZZ,ZZ9.99-.02210046
022200     05  DL-RETURN-COST                  PIC ZZZZ,ZZZ,ZZZ,ZZ9.99-.02220046
022300     05  FILLER                          PIC  X(02)  VALUE SPACES.02230046
022400     05  DL-COST-RETURN-PERCENT          PIC  ZZZ,ZZ9.99.         02240046
022500     05  FILLER                          PIC  X(04)  VALUE SPACES.02250046
022600     05  DL-NEGOTIATED-PERCENT           PIC  ZZZ9.999.           02260046
022700                                                                  02270046
022800 01  TL-TOTAL-LINE-DASHES.                                        02280046
022900     05  FILLER                          PIC  X(20) VALUE SPACES. 02290046
023000     05  FILLER                          PIC  X(02) VALUE SPACES. 02300046
023100     05  FILLER                          PIC  X(04) VALUE SPACES. 02310046
023200     05  FILLER                          PIC  X(02) VALUE SPACES. 02320046
023300     05  FILLER                          PIC  X(03) VALUE SPACES. 02330046
023400     05  FILLER                          PIC  X(01) VALUE SPACES. 02340046
023500     05  FILLER                          PIC  X(34) VALUE SPACES. 02350046
023600     05  FILLER                          PIC  X(01) VALUE SPACES. 02360046
023700     05  FILLER                          PIC  X(19) VALUE ALL '_'.02370046
023800     05  FILLER                          PIC  X(01) VALUE SPACES. 02380046
023900     05  FILLER                          PIC  X(19) VALUE ALL '_'.02390046
024000     05  FILLER                          PIC  X(02) VALUE SPACES. 02400046
024100     05  FILLER                          PIC  X(10) VALUE ALL '_'.02410046
024200                                                                  02420046
024300 01  TL-TOTAL-LINE.                                               02430046
024400     05  FILLER                          PIC  X(20) VALUE SPACES. 02440046
024500     05  FILLER                          PIC  X(02) VALUE SPACES. 02450046
024600     05  FILLER                          PIC  X(04) VALUE SPACES. 02460046
024700     05  FILLER                          PIC  X(02) VALUE SPACES. 02470046
024800     05  FILLER                          PIC  X(03) VALUE SPACES. 02480046
024900     05  FILLER                          PIC  X(01) VALUE SPACES. 02490046
025000     05  TL-TOTAL-DESCRIPTION            PIC  X(34) VALUE SPACES  02500046
025100                                                    JUST RIGHT.   02510046
025200*    05  FILLER                          PIC  X(01) VALUE SPACES. 02520046
025300     05  TL-PURCHS-COST                  PIC ZZZZ,ZZZ,ZZZ,ZZ9.99-.02530046
025400*    05  FILLER                          PIC  X(01) VALUE SPACES. 02540046
025500     05  TL-RETURN-COST                  PIC ZZZZ,ZZZ,ZZZ,ZZ9.99-.02550046
025600     05  FILLER                          PIC  X(02) VALUE SPACES. 02560046
025700     05  TL-COST-RETURN-PERCENT          PIC  ZZZ,ZZ9.99.         02570046
025800                                                                  02580046
025900 01  BLANK-LINE.                                                  02590046
026000     05  FILLER                          PIC  X(132) VALUE SPACE. 02600046
026100                                                                  02610046
026200 01  END-OF-REPORT-LINE.                                          02620046
026300     05  FILLER                          PIC  X(52)  VALUE SPACE. 02630046
026400     05  FILLER                          PIC  X(25)  VALUE        02640046
026500         '***** END OF REPORT *****'.                             02650046
026600     05  FILLER                          PIC  X(55)  VALUE SPACE. 02660046
026700                                                                  02670046
026800 01  ER-EMPTY-REPORT-LINE.                                        02680046
026900     05  FILLER                          PIC  X(42)  VALUE SPACE. 02690046
027000     05  FILLER                          PIC  X(48)  VALUE        02700046
027100         '*******   THERE IS NO DATA TO REPORT     *******'.      02710046
027200     05  FILLER                          PIC  X(42)  VALUE SPACE. 02720046
027300                                                                  02730046
027400 01  PA-PROGRAM-ACCUMULATORS.                                     02740046
027500     05  PA-VND-TOTALS.                                           02750046
027600         10 PA-VND-PURCHS-COST      PIC S9(12)V99    VALUE +0     02760046
027700                                                     COMP-3.      02770046
027800         10 PA-VND-RETURN-COST      PIC S9(12)V99    VALUE +0     02780046
027900                                                     COMP-3.      02790046
028000     05  PA-BUYER-TOTALS.                                         02800046
028100         10 PA-BUYER-PURCHS-COST    PIC S9(12)V99    VALUE +0     02810046
028200                                                     COMP-3.      02820046
028300         10 PA-BUYER-RETURN-COST    PIC S9(12)V99    VALUE +0     02830046
028400                                                     COMP-3.      02840046
028500     05  PA-DMM-TOTALS.                                           02850046
028600         10 PA-DMM-PURCHS-COST      PIC S9(12)V99    VALUE +0     02860046
028700                                                     COMP-3.      02870046
028800         10 PA-DMM-RETURN-COST      PIC S9(12)V99    VALUE +0     02880046
028900                                                     COMP-3.      02890046
029000     05  PA-GMM-TOTALS.                                           02900046
029100         10 PA-GMM-PURCHS-COST      PIC S9(12)V99    VALUE +0     02910046
029200                                                     COMP-3.      02920046
029300         10 PA-GMM-RETURN-COST      PIC S9(12)V99    VALUE +0     02930046
029400                                                     COMP-3.      02940046
029500     05  PA-GRAND-TOTALS.                                         02950046
029600         10 PA-TOTAL-PURCHS-COST    PIC S9(12)V99    VALUE +0     02960046
029700                                                     COMP-3.      02970046
029800         10 PA-TOTAL-RETURN-COST    PIC S9(12)V99    VALUE +0     02980046
029900                                                     COMP-3.      02990046
030000                                                                  03000046
030100 01  PC-CONSTANTS.                                                03010046
030200     05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +55    03020046
030300                                                     COMP SYNC.   03030046
030400                                                                  03040046
030500 01  PS-PROGRAM-SWITCHES.                                         03050046
030600     05  PS-END-OF-EXTRACT-FILE-IND      PIC  X(01)  VALUE 'N'.   03060046
030700         88  PS-END-OF-EXTRACT-FILE                  VALUE 'Y'.   03070046
030800         88  PS-NOT-END-OF-EXTRACT-FILE              VALUE 'N'.   03080046
030900                                                                  03090046
031000     05  PS-NO-DATA-IND                  PIC  X(01)  VALUE 'N'.   03100046
031100         88  PS-NO-DATA                              VALUE 'N'.   03110046
031200         88  PS-DATA                                 VALUE 'Y'.   03120046
031300                                                                  03130046
031400 01  PV-PROGRAM-VARIABLES.                                        03140046
031500     05  PV-PERCENT                      PIC S9(06)V9(5)          03150046
031600                                                 VALUE +0 COMP.   03160046
031700     05  PV-PAGE-COUNT                   PIC S9(04) VALUE +0 COMP.03170046
031800     05  PV-LINE-COUNT                   PIC S9(04) VALUE +0 COMP.03180046
031900     05  PV-RETURN-COST                  PIC S9(11)V99            03190046
032000                                                 VALUE +0 COMP.   03200046
032100     05  PV-PURCHS-COST                  PIC S9(11)V99            03210046
032200                                                 VALUE +0 COMP.   03220046
032300     05  PV-FIELD-NAME                   PIC  X(30)  VALUE SPACES.03230046
032400     05  PV-HOLD-DMM-NMBR                PIC  X(02).              03240046
032500     05  PV-HOLD-DMM-NAME                PIC  X(30).              03250046
032600     05  PV-HOLD-GMM-NMBR                PIC  X(02).              03260046
032700     05  PV-HOLD-GMM-NAME                PIC  X(30).              03270046
032800     05  PV-HOLD-BUYER-NMBR              PIC  X(03).              03280046
032900     05  PV-HOLD-BUYER-NAME              PIC  X(30).              03290046
033000     05  PV-HOLD-VENDOR-DUNNS            PIC  X(09).              03300046
033100     05  PV-HOLD-VENDOR-NAME             PIC  X(25).              03310046
033200     05  PV-HOLD-RANK-X.                                          03320046
033300         10  PV-HOLD-RANK                PIC  9(04).              03330046
033400     05  PV-RPT-TYPE                     PIC  X(1).               03340046
033500         88  PV-QUARTERLY-REPORT         VALUE 'Q'.               03350046
033600         88  PV-REQUEST-REPORT           VALUE 'R'.               03360046
033700     05  PV-START-DATE.                                           03370046
033800         10  PV-START-MONTH              PIC  9(02).              03380046
033900         10  FILLER                      PIC  X(01) VALUE '/'.    03390046
034000         10  PV-START-DAY                PIC  9(02).              03400046
034100         10  FILLER                      PIC  X(01) VALUE '/'.    03410046
034200         10  PV-START-CENTURY            PIC  9(02).              03420046
034300         10  PV-START-YEAR               PIC  9(02).              03430046
034400     05  PV-END-DATE.                                             03440046
034500         10  PV-END-MONTH                PIC  9(02).              03450046
034600         10  FILLER                      PIC  X(01) VALUE '/'.    03460046
034700         10  PV-END-DAY                  PIC  9(02).              03470046
034800         10  FILLER                      PIC  X(01) VALUE '/'.    03480046
034900         10  PV-END-CENTURY              PIC  9(02).              03490046
035000         10  PV-END-YEAR                 PIC  9(02).              03500046
035100                                                                  03510046
035200 01  ST-SYSTEM-TIME.                                              03520046
035300     05  ST-SYSTEM-HOUR                  PIC  9(02)  VALUE ZEROS. 03530046
035400     05  ST-SYSTEM-MINUTE                PIC  9(02)  VALUE ZEROS. 03540046
035500                                                                  03550046
035600* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 03560046
035700 PROCEDURE DIVISION.                                              03570046
035800* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 03580046
035900                                                                  03590046
036000******************************************************************03600046
036100*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    03610046
036200******************************************************************03620046
036300 0000-PROGRAM-MAINLINE.                                           03630046
036400     PERFORM 1000-INITIALIZE.                                     03640046
036500                                                                  03650046
036600     PERFORM 2000-CREATE-REPORT                                   03660046
036700         UNTIL PS-END-OF-EXTRACT-FILE.                            03670046
036800                                                                  03680046
036900     PERFORM 9000-EOJ-ROUTINE.                                    03690046
037000     STOP RUN.                                                    03700046
037100                                                                  03710046
037200******************************************************************03720046
037300*  1000-INITIALIZE -  OPENS ALL FILES, SETS UP HEADINGS, CONTROL  03730046
037400*    BREAK FIELDS AND PRINTS INITIAL HEADINGS TO REPORT FILE      03740046
037500******************************************************************03750046
037600 1000-INITIALIZE.                                                 03760046
037700     OPEN OUTPUT DI-DEFECT-ITEM-REPORT                            03770046
037800          INPUT  RTV-REPORT-EXTRACT.                              03780046
037900                                                                  03790046
038000     SET PS-NOT-END-OF-EXTRACT-FILE TO TRUE.                      03800046
038100                                                                  03810046
038200     PERFORM 7000-READ-EXTRACT-FILE.                              03820046
038300                                                                  03830046
038400     IF PS-END-OF-EXTRACT-FILE                                    03840046
038500         SET PS-NO-DATA          TO TRUE                          03850046
038600         WRITE DI-DEFECT-ITEM-LINE                                03860046
038700             FROM ER-EMPTY-REPORT-LINE                            03870046
038800             AFTER ADVANCING 3 LINES                              03880046
038900         WRITE DI-DEFECT-ITEM-LINE                                03890046
039000             FROM END-OF-REPORT-LINE                              03900046
039100             AFTER ADVANCING 2 LINES                              03910046
039200     ELSE                                                         03920046
039300         IF RV002-DETAIL-REC                                      03930046
039400             DISPLAY '** ABEND **'                                03940046
039500             DISPLAY '** PROGRAM = RVKRP014 **'                   03950046
039600             DISPLAY '** PARAGRAPH = 1000-INITIALIZE.     **'     03960046
039700             DISPLAY '** FIRST RECORD NOT THE DATE RECORD **'     03970046
039800             MOVE +4003 TO ABEND-CODE                             03980046
039900             CALL 'ILBOABN0' USING ABEND-CODE                     03990046
040000         ELSE                                                     04000046
040100             SET PS-DATA           TO TRUE                        04010046
040200                                                                  04020046
040300             MOVE RV002-RPT-TYPE   TO PV-RPT-TYPE                 04030046
040400                                                                  04040046
040500             MOVE RV002-END-MM     TO PV-END-MONTH                04050046
040600             MOVE RV002-END-DD     TO PV-END-DAY                  04060046
040700             MOVE RV002-END-CC     TO PV-END-CENTURY              04070046
040800             MOVE RV002-END-YY     TO PV-END-YEAR                 04080046
040900                                                                  04090046
041000             MOVE RV002-BEGIN-MM   TO PV-START-MONTH              04100046
041100             MOVE RV002-BEGIN-DD   TO PV-START-DAY                04110046
041200             MOVE RV002-BEGIN-CC   TO PV-START-CENTURY            04120046
041300             MOVE RV002-BEGIN-YY   TO PV-START-YEAR               04130046
041400                                                                  04140046
041500             MOVE PV-START-DATE    TO PH3-START-DATE              04150046
041600             MOVE PV-END-DATE      TO PH3-END-DATE                04160046
041700                                                                  04170046
041800             MOVE RV002-CURR-YY    TO DP132O-RUN-YEAR             04180046
041900             MOVE RV002-CURR-MM    TO DP132O-RUN-MONTH            04190046
042000             MOVE RV002-CURR-DD    TO DP132O-RUN-DAY              04200046
042100                                                                  04210046
042200             ACCEPT ST-SYSTEM-TIME FROM TIME                      04220046
042300             MOVE ST-SYSTEM-HOUR   TO DP132O-RUN-HOUR             04230046
042400             MOVE ST-SYSTEM-MINUTE TO DP132O-RUN-MINUTE           04240046
042500                                                                  04250046
042600             MOVE 'RVKRP014'       TO DP132O-PROGRAM-NAME         04260046
042700             MOVE 1                TO DP132O-REPORT-NUMBER        04270046
042800                                                                  04280046
042900             MOVE PC-MAX-REPORT-LINES TO PV-LINE-COUNT            04290046
043000             MOVE +0               TO PV-PAGE-COUNT               04300046
043100                                                                  04310046
043200             INITIALIZE DL-DETAIL-LINE                            04320046
043300                        PA-PROGRAM-ACCUMULATORS                   04330046
043400             PERFORM 7000-READ-EXTRACT-FILE                       04340046
043500             MOVE RV002-VENDOR-DUNNS  TO PV-HOLD-VENDOR-DUNNS     04350046
043600             MOVE RV002-VENDOR-NAME   TO DL-VENDOR-NAME           04360046
043700                                         PV-HOLD-VENDOR-NAME      04370046
043800             MOVE RV002-BUYER-NAME    TO PV-HOLD-BUYER-NAME       04380046
043900                                         PH6-BUYER-NAME           04390046
044000             MOVE RV002-BUYER-NMBR    TO PV-HOLD-BUYER-NMBR       04400046
044100                                         PH6-BUYER-NMBR           04410046
044200             MOVE RV002-DMM-NAME      TO PV-HOLD-DMM-NAME         04420046
044300                                         PH5-DMM-NAME             04430046
044400             MOVE RV002-DMM-NMBR      TO PV-HOLD-DMM-NMBR         04440046
044500                                         PH5-DMM-NMBR             04450046
044600             MOVE RV002-GMM-NAME      TO PV-HOLD-GMM-NAME         04460046
044700                                         PH4-GMM-NAME             04470046
044800             MOVE RV002-GMM-NMBR      TO PV-HOLD-GMM-NMBR         04480046
044900                                         PH4-GMM-NMBR             04490046
045000                                                                  04500046
045100             IF RV002-ZERO-VENDOR-RANK                            04510046
045200                MOVE 'N/A'          TO DL-RANK-X                  04520046
045300                                        PV-HOLD-RANK-X            04530046
045400             ELSE                                                 04540046
045500                IF RV002-UNKOWN-VENDOR-RANK                       04550046
045600                   MOVE '    '       TO DL-RANK-X                 04560046
045700                                         PV-HOLD-RANK-X           04570046
045800                ELSE                                              04580046
045900                   MOVE RV002-VENDOR-RANK TO DL-RANK              04590046
046000                                             PV-HOLD-RANK         04600046
046100                END-IF                                            04610046
046200             END-IF                                               04620046
046300         END-IF                                                   04630046
046400     END-IF.                                                      04640046
046500                                                                  04650046
046600                                                                  04660046
046700******************************************************************04670046
046800* 2000-CREATE-REPORT                                              04680046
046900* PROCESS:  THIS PARAGRAPH CHECKS THE CONTROL BREAKS AND PRINTS   04690046
047000*           THE DETAIL LINES                                      04700046
047100******************************************************************04710046
047200 2000-CREATE-REPORT.                                              04720046
047300     IF RV002-GMM-NMBR               = PV-HOLD-GMM-NMBR           04730046
047400        IF RV002-DMM-NMBR            = PV-HOLD-DMM-NMBR           04740046
047500           IF RV002-BUYER-NMBR       = PV-HOLD-BUYER-NMBR         04750046
047600              IF RV002-VENDOR-DUNNS  = PV-HOLD-VENDOR-DUNNS       04760046
047700                  CONTINUE                                        04770046
047800              ELSE                                                04780046
047900                  PERFORM 2200-VENDOR-BREAK                       04790046
048000              END-IF                                              04800046
048100           ELSE                                                   04810046
048200               PERFORM 2300-BUYER-BREAK                           04820046
048300           END-IF                                                 04830046
048400        ELSE                                                      04840046
048500            PERFORM 2400-DMM-BREAK                                04850046
048600        END-IF                                                    04860046
048700     ELSE                                                         04870046
048800        PERFORM 2500-GMM-BREAK                                    04880046
048900     END-IF.                                                      04890046
049000                                                                  04900046
049100     PERFORM 2100-PRINT-REPORT-DETAIL.                            04910046
049200                                                                  04920046
049300     PERFORM 7000-READ-EXTRACT-FILE.                              04930046
049400                                                                  04940046
049500******************************************************************04950046
049600* 2100-PRINT-REPORT-DETAIL                                        04960046
049700* PROCESS:  THIS PARAGRAPH PRINT THE DETAIL LINES FOR THE REPORT  04970046
049800******************************************************************04980046
049900 2100-PRINT-REPORT-DETAIL.                                        04990046
050000     MOVE RV002-DEPT-NMBR            TO DL-DPT-NBR.               05000046
050100     MOVE RV002-DEPT-DESC            TO DL-DPT-DESC.              05010046
050200                                                                  05020046
050300     IF RV002-DEBIT-AND-RETURN                                    05030046
050400         MOVE 'YES'                  TO DL-DEBIT-AND-RETURN-IND   05040046
050500     ELSE                                                         05050046
050600         MOVE '   '                  TO DL-DEBIT-AND-RETURN-IND   05060046
050700     END-IF.                                                      05070046
050800                                                                  05080046
050900     IF RV002-DEBIT-AND-DISPOSE                                   05090046
051000         MOVE 'YES'                  TO DL-DEBIT-AND-DISPOSE-IND  05100046
051100     ELSE                                                         05110046
051200         MOVE '   '                  TO DL-DEBIT-AND-DISPOSE-IND  05120046
051300     END-IF.                                                      05130046
051400                                                                  05140046
051500     IF RV002-MARK-OUT-OF-STOCK                                   05150046
051600         MOVE 'YES'                  TO DL-MARK-OUT-OF-STOCK-IND  05160046
051700     ELSE                                                         05170046
051800         MOVE '   '                  TO DL-MARK-OUT-OF-STOCK-IND  05180046
051900     END-IF.                                                      05190046
052000                                                                  05200046
052100     MOVE RV002-PURCH-COST           TO DL-PURCHS-COST.           05210046
052200     MOVE 'PA-VND-PURCHS-COST'       TO PV-FIELD-NAME.            05220046
052300     COMPUTE PA-VND-PURCHS-COST =                                 05230046
052400           ( PA-VND-PURCHS-COST + RV002-PURCH-COST)               05240046
052500     ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                   05250046
052600                                                                  05260046
052700     MOVE RV002-RETURN-COST          TO DL-RETURN-COST.           05270046
052800     MOVE 'PA-VND-RETURN-COST'       TO PV-FIELD-NAME.            05280046
052900     COMPUTE PA-VND-RETURN-COST =                                 05290046
053000           ( PA-VND-RETURN-COST + RV002-RETURN-COST)              05300046
053100     ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                   05310046
053200                                                                  05320046
053300     IF RV002-RETURN-COST = 0                                     05330046
053400     OR RV002-PURCH-COST = 0                                      05340046
053500         MOVE 0                      TO DL-COST-RETURN-PERCENT    05350046
053600     ELSE                                                         05360046
053700         COMPUTE PV-PERCENT ROUNDED =                             05370046
053800           (RV002-RETURN-COST / RV002-PURCH-COST * 100)           05380046
053900         MOVE PV-PERCENT             TO DL-COST-RETURN-PERCENT    05390046
054000     END-IF.                                                      05400046
054100                                                                  05410046
054200     MOVE RV002-NEGOTIATED-PCT TO DL-NEGOTIATED-PERCENT.          05420046
054300                                                                  05430046
054400******************************************************************05440046
054500* IF BOTH THE RETURN-COST AND THE PURCH-COST = 0 THEN             05450046
054600*     DO NOT PRINT THE RECORD ON THE REPORT, CONTINUE ON TO       05460046
054700*     NEXT RECORD                                                 05470046
054800******************************************************************05480046
054900     IF RV002-RETURN-COST = 0 AND RV002-PURCH-COST = 0            05490046
055000         CONTINUE                                                 05500046
055100     ELSE                                                         05510046
055200         PERFORM 8000-PRINT-REPORT-LINE                           05520046
055300***      MOVE SPACES                 TO DL-VENDOR-NAME            05530047
055400***                                     DL-RANK-X                 05540047
055500     END-IF.                                                      05550046
055600                                                                  05560046
055700******************************************************************05570046
055800* 2200-VENDOR-BREAK.                                              05580046
055900* PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC NEEDED FOR A    05590046
056000*           BREAK IN VENDOR DUNNS NUMBER                          05600046
056100******************************************************************05610046
056200 2200-VENDOR-BREAK.                                               05620046
056300     MOVE 'PA-BUYER-PURCHS-COST'     TO PV-FIELD-NAME.            05630046
056400     COMPUTE PA-BUYER-PURCHS-COST =                               05640046
056500           ( PA-BUYER-PURCHS-COST + PA-VND-PURCHS-COST)           05650046
056600     ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                   05660046
056700                                                                  05670046
056800     MOVE 'PA-BUYER-RETURN-COST'     TO PV-FIELD-NAME.            05680046
056900     COMPUTE PA-BUYER-RETURN-COST =                               05690046
057000           ( PA-BUYER-RETURN-COST + PA-VND-RETURN-COST)           05700046
057100     ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                   05710046
057200                                                                  05720046
057300     INITIALIZE PA-VND-TOTALS.                                    05730046
057400                                                                  05740046
057500     MOVE RV002-VENDOR-DUNNS         TO PV-HOLD-VENDOR-DUNNS.     05750046
057600     MOVE RV002-VENDOR-NAME          TO DL-VENDOR-NAME            05760046
057700                                        PV-HOLD-VENDOR-NAME.      05770046
057800                                                                  05780046
057900     IF RV002-ZERO-VENDOR-RANK                                    05790046
058000        MOVE 'N/A'                 TO DL-RANK-X                   05800046
058100                                        PV-HOLD-RANK-X            05810046
058200     ELSE                                                         05820046
058300        IF RV002-UNKOWN-VENDOR-RANK                               05830046
058400           MOVE '????'              TO DL-RANK-X                  05840046
058500                                        PV-HOLD-RANK-X            05850046
058600        ELSE                                                      05860046
058700           MOVE RV002-VENDOR-RANK    TO DL-RANK                   05870046
058800                                        PV-HOLD-RANK              05880046
058900        END-IF                                                    05890046
059000     END-IF.                                                      05900046
059100                                                                  05910046
059200******************************************************************05920046
059300* 2300-BUYER-BREAK.                                              *05930046
059400* PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC NEEDED FOR A   *05940046
059500*           BREAK IN BUYER NUMBER                                *05950046
059600******************************************************************05960046
059700 2300-BUYER-BREAK.                                                05970046
059800     PERFORM 2200-VENDOR-BREAK.                                   05980046
059900                                                                  05990046
060000     MOVE 'BUYER TOTALS: '           TO TL-TOTAL-DESCRIPTION      06000046
060100     MOVE PA-BUYER-PURCHS-COST       TO PV-PURCHS-COST            06010046
060200     MOVE PA-BUYER-RETURN-COST       TO PV-RETURN-COST            06020046
060300                                                                  06030046
060400     PERFORM 8100-WRITE-TOTAL-LINE.                               06040046
060500                                                                  06050046
060600     MOVE 'PA-DMM-PURCHS-COST'       TO PV-FIELD-NAME.            06060046
060700     COMPUTE PA-DMM-PURCHS-COST =                                 06070046
060800           ( PA-DMM-PURCHS-COST + PA-BUYER-PURCHS-COST)           06080046
060900     ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                   06090046
061000                                                                  06100046
061100     MOVE 'PA-DMM-RETURN-COST'       TO PV-FIELD-NAME.            06110046
061200     COMPUTE PA-DMM-RETURN-COST =                                 06120046
061300           ( PA-DMM-RETURN-COST + PA-BUYER-RETURN-COST)           06130046
061400     ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                   06140046
061500                                                                  06150046
061600     INITIALIZE PA-BUYER-TOTALS.                                  06160046
061700                                                                  06170046
061800     MOVE PC-MAX-REPORT-LINES        TO PV-LINE-COUNT.            06180046
061900                                                                  06190046
062000     MOVE RV002-BUYER-NAME           TO PV-HOLD-BUYER-NAME        06200046
062100                                        PH6-BUYER-NAME.           06210046
062200     MOVE RV002-BUYER-NMBR           TO PV-HOLD-BUYER-NMBR        06220046
062300                                        PH6-BUYER-NMBR.           06230046
062400                                                                  06240046
062500******************************************************************06250046
062600* 2400-DMM-BREAK.                                                 06260046
062700* PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC NEEDED FOR A    06270046
062800*           BREAK IN DMM NUMBER                                   06280046
062900******************************************************************06290046
063000 2400-DMM-BREAK.                                                  06300046
063100     PERFORM 2300-BUYER-BREAK.                                    06310046
063200                                                                  06320046
063300     MOVE 'DMM TOTALS: '             TO TL-TOTAL-DESCRIPTION      06330046
063400     MOVE PA-DMM-PURCHS-COST         TO PV-PURCHS-COST            06340046
063500     MOVE PA-DMM-RETURN-COST         TO PV-RETURN-COST            06350046
063600                                                                  06360046
063700     PERFORM 8100-WRITE-TOTAL-LINE.                               06370046
063800                                                                  06380046
063900     MOVE 'PA-GMM-PURCHS-COST'       TO PV-FIELD-NAME.            06390046
064000     COMPUTE PA-GMM-PURCHS-COST =                                 06400046
064100           ( PA-GMM-PURCHS-COST + PA-DMM-PURCHS-COST)             06410046
064200     ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                   06420046
064300                                                                  06430046
064400     MOVE 'PA-GMM-RETURN-COST'       TO PV-FIELD-NAME.            06440046
064500     COMPUTE PA-GMM-RETURN-COST =                                 06450046
064600           ( PA-GMM-RETURN-COST + PA-DMM-RETURN-COST)             06460046
064700     ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                   06470046
064800                                                                  06480046
064900     INITIALIZE PA-DMM-TOTALS.                                    06490046
065000                                                                  06500046
065100     MOVE RV002-DMM-NAME             TO PV-HOLD-DMM-NAME          06510046
065200                                        PH5-DMM-NAME.             06520046
065300     MOVE RV002-DMM-NMBR             TO PV-HOLD-DMM-NMBR          06530046
065400                                        PH5-DMM-NMBR.             06540046
065500                                                                  06550046
065600******************************************************************06560046
065700* 2500-GMM-BREAK.                                                 06570046
065800* PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC NEEDED FOR A    06580046
065900*           BREAK IN GMM NUMBER                                   06590046
066000******************************************************************06600046
066100 2500-GMM-BREAK.                                                  06610046
066200     PERFORM 2400-DMM-BREAK.                                      06620046
066300                                                                  06630046
066400     MOVE 'GMM TOTALS: '             TO TL-TOTAL-DESCRIPTION      06640046
066500     MOVE PA-GMM-PURCHS-COST         TO PV-PURCHS-COST            06650046
066600     MOVE PA-GMM-RETURN-COST         TO PV-RETURN-COST            06660046
066700                                                                  06670046
066800     PERFORM 8100-WRITE-TOTAL-LINE.                               06680046
066900                                                                  06690046
067000     MOVE 'PA-TOTAL-PURCHS-COST'     TO PV-FIELD-NAME.            06700046
067100     COMPUTE PA-TOTAL-PURCHS-COST =                               06710046
067200           ( PA-TOTAL-PURCHS-COST + PA-GMM-PURCHS-COST)           06720046
067300     ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                   06730046
067400                                                                  06740046
067500     MOVE 'PA-TOTAL-RETURN-COST'     TO PV-FIELD-NAME.            06750046
067600     COMPUTE PA-TOTAL-RETURN-COST =                               06760046
067700           ( PA-TOTAL-RETURN-COST + PA-GMM-RETURN-COST)           06770046
067800     ON SIZE ERROR PERFORM 9100-OVERFLOW-ERROR.                   06780046
067900                                                                  06790046
068000     INITIALIZE PA-GMM-TOTALS.                                    06800046
068100                                                                  06810046
068200     MOVE RV002-GMM-NAME             TO PV-HOLD-GMM-NAME          06820046
068300                                        PH4-GMM-NAME.             06830046
068400     MOVE RV002-GMM-NMBR             TO PV-HOLD-GMM-NMBR          06840046
068500                                        PH4-GMM-NMBR.             06850046
068600                                                                  06860046
068700******************************************************************06870046
068800* 7000-READ-EXTRACT-FILE.                                        *06880046
068900*  THIS PROCEDURE WILL READ ONE EXTRACT RECORD FROM THE EXTRACT  *06890046
069000*  FLAT FILE.                                                    *06900046
069100******************************************************************06910046
069200 7000-READ-EXTRACT-FILE.                                          06920046
069300     READ RTV-REPORT-EXTRACT                                      06930046
069400         INTO RV002-RETURN-AGREE-EXTRACT-REC                      06940046
069500         AT END SET PS-END-OF-EXTRACT-FILE TO TRUE.               06950046
069600                                                                  06960046
069700******************************************************************06970046
069800* 8000-PRINT-REPORT-LINE - CHECKS IF THE PAGE SIZE HAS BEEN EX-   06980046
069900* CEEDED.  IF SO, THE HEADING LINES ARE WRITTEN AND THE LINE COUNT06990046
070000* INITIALIZED.  THE DETAIL LINE IS THEN WRITTEN.                  07000046
070100******************************************************************07010046
070200 8000-PRINT-REPORT-LINE.                                          07020046
070300     ADD +1 TO PV-LINE-COUNT.                                     07030046
070400                                                                  07040046
070500     IF PV-LINE-COUNT >= PC-MAX-REPORT-LINES                      07050046
070600         PERFORM 8300-WRITE-PAGE-HEADING                          07060046
070700         PERFORM 8400-WRITE-COLUMN-HEADING                        07070046
070800         MOVE PV-HOLD-VENDOR-NAME     TO DL-VENDOR-NAME           07080046
070900         MOVE PV-HOLD-RANK-X          TO DL-RANK-X                07090046
071000     END-IF.                                                      07100046
071100                                                                  07110046
071200     WRITE DI-DEFECT-ITEM-LINE                                    07120046
071300         FROM DL-DETAIL-LINE                                      07130046
071400         AFTER ADVANCING 1 LINES.                                 07140046
071500                                                                  07150046
071600******************************************************************07160046
071700* 8100-WRITE-TOTAL-LINE - PRINTS A TOTAL LINE TO THE REPORT.      07170046
071800******************************************************************07180046
071900 8100-WRITE-TOTAL-LINE.                                           07190046
072000     MOVE PV-PURCHS-COST         TO TL-PURCHS-COST.               07200046
072100     MOVE PV-RETURN-COST         TO TL-RETURN-COST.               07210046
072200                                                                  07220046
072300     IF PV-PURCHS-COST  = 0                                       07230046
072400     OR PV-RETURN-COST  = 0                                       07240046
072500        MOVE 0                   TO TL-COST-RETURN-PERCENT        07250046
072600     ELSE                                                         07260046
072700        COMPUTE PV-PERCENT =                                      07270046
072800            ((PV-RETURN-COST / PV-PURCHS-COST) * 100)             07280046
072900        MOVE PV-PERCENT          TO TL-COST-RETURN-PERCENT        07290046
073000     END-IF.                                                      07300046
073100                                                                  07310046
073200     WRITE DI-DEFECT-ITEM-LINE                                    07320046
073300         FROM TL-TOTAL-LINE-DASHES                                07330046
073400         AFTER ADVANCING 0 LINES.                                 07340046
073500                                                                  07350046
073600     WRITE DI-DEFECT-ITEM-LINE                                    07360046
073700         FROM TL-TOTAL-LINE                                       07370046
073800         AFTER ADVANCING 1 LINES.                                 07380046
073900                                                                  07390046
074000     ADD +1 TO PV-LINE-COUNT.                                     07400046
074100                                                                  07410046
074200     PERFORM 8200-WRITE-BLANK-LINE.                               07420046
074300                                                                  07430046
074400******************************************************************07440046
074500* 8200-WRITE-BLANK-LINE - WRITES A BLANK LINE TO THE REPORT.      07450046
074600******************************************************************07460046
074700 8200-WRITE-BLANK-LINE.                                           07470046
074800     WRITE DI-DEFECT-ITEM-LINE                                    07480046
074900         FROM BLANK-LINE                                          07490046
075000         AFTER ADVANCING 1 LINES.                                 07500046
075100                                                                  07510046
075200     ADD +1                        TO PV-LINE-COUNT.              07520046
075300                                                                  07530046
075400******************************************************************07540046
075500* 8300-WRITE-PAGE-HEADING - WRITE THE PAGE AND DETAIL HEADINGS FOR07550046
075600* THE DEFECTIVE ITEM REPORT.                                      07560046
075700******************************************************************07570046
075800 8300-WRITE-PAGE-HEADING.                                         07580046
075900     ADD +1 TO PV-PAGE-COUNT.                                     07590046
076000     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    07600046
076100                                                                  07610046
076200     WRITE DI-DEFECT-ITEM-LINE                                    07620046
076300         FROM DP132O-STANDRD-HEADER-132-COLS                      07630046
076400         AFTER ADVANCING PAGE.                                    07640046
076500                                                                  07650046
076600     IF PV-QUARTERLY-REPORT                                       07660046
076700         WRITE DI-DEFECT-ITEM-LINE                                07670046
076800             FROM PH2-PAGE-HEADING-QUARTERLY                      07680046
076900             AFTER ADVANCING 1 LINES                              07690046
077000     ELSE                                                         07700046
077100         WRITE DI-DEFECT-ITEM-LINE                                07710046
077200             FROM PH2-PAGE-HEADING-REQUEST                        07720046
077300             AFTER ADVANCING 1 LINES                              07730046
077400     END-IF.                                                      07740046
077500                                                                  07750046
077600     WRITE DI-DEFECT-ITEM-LINE                                    07760046
077700         FROM PH3-PAGE-HEADING-3                                  07770046
077800         AFTER ADVANCING 1 LINES.                                 07780046
077900                                                                  07790046
078000     WRITE DI-DEFECT-ITEM-LINE                                    07800046
078100         FROM PH4-GMM-PAGE-HEADING-4                              07810046
078200         AFTER ADVANCING 1 LINES.                                 07820046
078300                                                                  07830046
078400     WRITE DI-DEFECT-ITEM-LINE                                    07840046
078500         FROM PH5-DMM-PAGE-HEADING-5                              07850046
078600         AFTER ADVANCING 1 LINES.                                 07860046
078700                                                                  07870046
078800     WRITE DI-DEFECT-ITEM-LINE                                    07880046
078900         FROM PH6-BUYER-PAGE-HEADING-6                            07890046
079000         AFTER ADVANCING 1 LINES.                                 07900046
079100                                                                  07910046
079200     MOVE +6     TO PV-LINE-COUNT.                                07920046
079300                                                                  07930046
079400******************************************************************07940046
079500* 8400-WRITE-COLUMN-HEADING - WRITE THE COLUMN HEADINGS FOR       07950046
079600* THE DEFECTIVE ITEM REPORT.                                      07960046
079700******************************************************************07970046
079800 8400-WRITE-COLUMN-HEADING.                                       07980046
079900     WRITE DI-DEFECT-ITEM-LINE                                    07990046
080000         FROM DH1-DETAIL-HEADING-1                                08000046
080100         AFTER ADVANCING 2 LINES.                                 08010046
080200                                                                  08020046
080300     WRITE DI-DEFECT-ITEM-LINE                                    08030046
080400         FROM DH2-DETAIL-HEADING-2                                08040046
080500         AFTER ADVANCING 1 LINES.                                 08050046
080600                                                                  08060046
080700     WRITE DI-DEFECT-ITEM-LINE                                    08070046
080800         FROM DHD-DETAIL-HEADING-DASHES                           08080046
080900         AFTER ADVANCING 0 LINES.                                 08090046
081000                                                                  08100046
081100     ADD +3       TO PV-LINE-COUNT.                               08110046
081200                                                                  08120046
081300******************************************************************08130046
081400* 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER  08140046
081500* CURSOR AND THE REPORT FILE.                                     08150046
081600******************************************************************08160046
081700 9000-EOJ-ROUTINE.                                                08170046
081800     PERFORM 2500-GMM-BREAK.                                      08180046
081900                                                                  08190046
082000     MOVE 'GRAND TOTAL: '            TO TL-TOTAL-DESCRIPTION      08200046
082100     MOVE PA-TOTAL-PURCHS-COST       TO PV-PURCHS-COST            08210046
082200     MOVE PA-TOTAL-RETURN-COST       TO PV-RETURN-COST            08220046
082300                                                                  08230046
082400     PERFORM 8100-WRITE-TOTAL-LINE.                               08240046
082500                                                                  08250046
082600     WRITE DI-DEFECT-ITEM-LINE                                    08260046
082700         FROM END-OF-REPORT-LINE                                  08270046
082800         AFTER ADVANCING 1 LINES.                                 08280046
082900                                                                  08290046
083000     CLOSE DI-DEFECT-ITEM-REPORT                                  08300046
083100           RTV-REPORT-EXTRACT.                                    08310046
083200                                                                  08320046
083300******************************************************************08330046
083400* 9100-OVERFLOW-ERROR - IF ONE OF THE ACCUMULATOR FIELDS          08340046
083500* ROLLS OVER (IE THE NUMBER IS TOO BIG TO FIT) THIS PARAGRAPH     08350046
083600* WILL ABEND THE PROGRAM                                          08360046
083700******************************************************************08370046
083800 9100-OVERFLOW-ERROR.                                             08380046
083900     DISPLAY '** ABEND     **'.                                   08390046
084000     DISPLAY '** PROGRAM   ** = RVKRP014'.                        08400046
084100     DISPLAY '** PROGRAM ACCUMULATOR OVERFLOW ERROR **'.          08410046
084200     DISPLAY '** THE DATA CREATES A TOTALS VALUE LARGER THAN '.   08420046
084300     DISPLAY '** THE FIELD SET-UP TO HANDLE IT.  INCREASE THE'.   08430046
084400     DISPLAY '** THE FOLLOWING FIELD SIZE: '.                     08440046
084500     DISPLAY PV-FIELD-NAME.                                       08450046
084600     MOVE +4004 TO ABEND-CODE.                                    08460046
084700     CALL 'ILBOABN0' USING ABEND-CODE.                            08470046
084800******************************************************************08480046
084900**************************** END OF RVKRP014 *********************08490046
085000******************************************************************08500046
