000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    TMKCS531.                                         00020000
000300 AUTHOR.        VIRGENE LENNEMAN                                  00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  04-28-98.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700*----------------------------------------------------------------*00070000
000800*    E531 - TROUBLE MANAGEMENT CRITERIA SPECIFICATION            *00080000
000900*                   FOR THE DISTRIBUTION CENTERS                 *00090000
001000*    THIS PROGRAM ALLOWS THE USER ENTER DATA TO BE USED BY       *00100000
001100*    SUBSEQUENT PROGRAMS TO CREATE A LIST OF TROUBLE RECORDS     *00110000
001200*    ASSOCIATED WITH A PO OR PO LINE FOR AN OPERATING UNIT,      *00120000
001300*    BUYER  OR DEPARTMENT                                        *00130000
001400*    THE LIST CAN BE IN ARRIVAL DATE SEQUENCE OR OLDEST TO NEWEST*00140000
001500*        TROUBLE SEQUENCE                                        *00150000
001600*    TROUBLE CAN BE CREATED FOR A PO                             *00160000
001700*    CAN NAVIGATE TO THE RECEIVER ITEM LIST SCREEN TO CREATE     *00170000
001800*        LINE LEVEL TROUBLE                                      *00180000
001900*----------------------------------------------------------------*00190000
001910******************************************************************00191099
001920* CHANGE HISTORY:                                                *00192000
001930*    CHANGES                                                     *00193000
001940*     MADE BY: VENKATSUBBU (COGNIZANT)                           *00194000
001950*     DATE:    10/08/2014                                        *00195000
001960*                                                                *00196000
001970*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#  *00197000
001980*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *TV 10/08/2014     *00198099
001990******************************************************************00199000
001992* CHANGED 11/04/2021    BY JIM HUNTER      WR: CHG0263627         00199299
001993* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00199399
001994* MAKING THE CALL DYNAMIC VS STATIC.                              00199499
001996******************************************************************00199699
001997* CHANGED 11/09/2022    BY JIM HUNTER      WR: CHG0278008         00199799
001998* ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00199899
001999* DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00199999
002000*-----------------------------------------------------------------00200099
002010                                                                  00201000
002100 ENVIRONMENT DIVISION.                                            00210000
002200 DATA DIVISION.                                                   00220000
002300 WORKING-STORAGE SECTION.                                         00230000
002400                                                                  00240000
002500 01  PC-PROGRAM-CONSTANTS.                                        00250000
002600     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'TM531A  '. 00260000
002700     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'TMKM531 '. 00270000
002800     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'TMKCS531'. 00280000
002900     05  PC-MAX-RETRIES            PIC S9(04)  VALUE    +3.       00290000
003000     05  PC-KOHLS-OPER-CO          PIC  X(02)  VALUE   '03'.      00300000
003100     05  PC-CORPORATE-OFFICE       PIC  9(04)  VALUE    0090.     00310000
003200     05  PC-ACTIVE-STATUS          PIC  X(01)  VALUE   'A'.       00320000
003300     05  PC-DPT                    PIC  X(03)  VALUE   'DPT'.     00330000
003400     05  PC-BYR                    PIC  X(03)  VALUE   'BYR'.     00340000
003500     05  PC-ABY                    PIC  X(03)  VALUE   'ABY'.     00350000
003600     05  PC-DMA                    PIC  X(03)  VALUE   'DMA'.     00360000
003700     05  PC-GMA                    PIC  X(03)  VALUE   'GMA'.     00370000
003800     05  PC-B                      PIC  X(01)  VALUE   'B'.       00380000
003900     05  PC-A                      PIC  X(01)  VALUE   'A'.       00390000
004000     05  PC-D                      PIC  X(01)  VALUE   'D'.       00400000
004100     05  PC-N                      PIC  X(01)  VALUE   'N'.       00410000
004200     05  PC-I                      PIC  X(01)  VALUE   'I'.       00420000
004300     05  PC-R                      PIC  X(01)  VALUE   'R'.       00430000
004400     05  PC-S                      PIC  X(01)  VALUE   'S'.       00440000
004500     05  PC-0001                   PIC S9(04)  VALUE  +0001.      00450000
004600     05  PC-0000                   PIC S9(04)  VALUE  +0000.      00460000
004700     05  PC-9999                   PIC S9(04)  VALUE  +9999.      00470000
004800******************* SYSTEM MESSAGES ****************************  00480000
004900     05  PC-TSYMSG-NUMBERS.                                       00490000
005000*  INVALID ENTRY                                                  00500000
005100         10  PC-TSYMSG-00005       PIC  9(05)  VALUE 00005.       00510000
005200*  REQUIRED ENTRY                                                 00520000
005300         10  PC-TSYMSG-00007       PIC  9(05)  VALUE 00007.       00530000
005400*  MUST BE NUMBERIC                                               00540000
005500         10  PC-TSYMSG-00008       PIC  9(05)  VALUE 00008.       00550000
005600*  INVALID DATE                                                   00560000
005700         10  PC-TSYMSG-00009       PIC  9(05)  VALUE 00009.       00570000
005800*  PURCHASE ORDER DOES NOT EXIST                                  00580000
005900         10  PC-TSYMSG-00083       PIC  9(05)  VALUE 00083.       00590000
006000*  FROM DATE MUST BE LESS THAN OR EQUAL TO THE TO DATE            00600000
006100         10  PC-TSYMSG-00395       PIC  9(05)  VALUE 00395.       00610000
006200*  ENTER AN "S" TO SELECT                                         00620000
006300         10  PC-TSYMSG-00397       PIC  9(05)  VALUE 00397.       00630000
006400*  DEPARTMENT NUMBER IS REQUIRED FOR SELECTED FUNCTION            00640000
006500         10  PC-TSYMSG-00486       PIC  9(05)  VALUE 00486.       00650000
006600*  WAIT 15 SECONDS;RETRY FUNCTION AGAIN, IF UNSUCCESSFUL          00660000
006700*  CALL HELP DESK                                                 00670000
006800         10  PC-TSYMSG-00551       PIC  9(05)  VALUE 00551.       00680000
006900*  PURCHASE ORDER NOT FOUND                                       00690000
007000         10  PC-TSYMSG-00726       PIC  9(05)  VALUE 00726.       00700000
007100*  RECEIVER SEQUENCE NUMBER REQUIRED                              00710000
007200         10  PC-TSYMSG-00737       PIC  9(05)  VALUE 00737.       00720000
007300*  NOT AUTHORIZED TO VIEW THIS INFORMATION                        00730000
007400         10  PC-TSYMSG-00840       PIC  9(05)  VALUE 00840.       00740000
007500*  ONLY ONE MAY BE SELECTED                                       00750000
007600         10  PC-TSYMSG-00973       PIC  9(05)  VALUE 00973.       00760000
007700*  DEPARTMENT, BUYER OR PO NBR REQUIRED FOR LIST                  00770000
007800         10  PC-TSYMSG-01029       PIC  9(05)  VALUE 01029.       00780000
007900*  INVALID TROUBLE SELECTION REASON ENTERED                       00790000
008000*  NOTE: THIS MESSAGE IS RETURNED FROM LIST SCREEN PGM TMKCS532   00800000
008100         10  PC-TSYMSG-01030       PIC  9(05)  VALUE 01030.       00810000
008200*  PO NUMBER AND RECEIVER REQUIRED                                00820000
008300         10  PC-TSYMSG-01245       PIC  9(05)  VALUE 01245.       00830000
008400*  RECEIVER NOT FOUND                                             00840000
008500         10  PC-TSYMSG-01298       PIC  9(05)  VALUE 01298.       00850000
008600*  A SYSTEM ERROR HAS OCCURRED - CONTACT HELP DESK                00860000
008700         10  PC-TSYMSG-01570       PIC  9(05)  VALUE 01570.       00870000
008800*  ONLY ONE MAY BE ENTERED                                        00880000
008900         10  PC-TSYMSG-01693       PIC  9(05)  VALUE 01693.       00890000
009000*  ONE MUST BE SELECTED                                           00900000
009100         10  PC-TSYMSG-01698       PIC  9(05)  VALUE 01698.       00910000
009200*  LIST SEQUENCE REQUIRED FOR THIS FUNCTION                       00920000
009300         10  PC-TSYMSG-01739       PIC  9(05)  VALUE 01739.       00930000
009400*  ONLY DEPARTMENT, PO, PO/RECEIVER MAY BE ENTERED FOR THIS       00940000
009500*  FUNCTION                                                       00950000
009600         10  PC-TSYMSG-01740       PIC  9(05)  VALUE 01740.       00960000
009700*  INVALID OPERATING UNIT                                         00970000
009800         10  PC-TSYMSG-01741       PIC  9(05)  VALUE 01741.       00980000
009810*  PO AND/OR RECEIVER NOT FOUND                                   00981000
009820         10  PC-TSYMSG-01772       PIC  9(05)  VALUE 01772.       00982000
009821*  SET CODE ENTERED DOES NOT EXIST - PLEASE RETRY                 00982199
009822         10  PC-TSYMSG-03736       PIC  9(05)  VALUE 03736.       00982299
009823*  INCLUDE/EXCLUDED MUST BE SELECTED WITH SEASONAL SET            00982399
009824         10  PC-TSYMSG-03822       PIC  9(05)  VALUE 03822.       00982499
009830*                                                                 00983000
009840 01  PS-PROGRAM-SWITCHES.                                         00984000
009850     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00985000
009860         88  PS-ERROR                          VALUE  'Y'.        00986000
009870         88  PS-NO-ERROR                       VALUE  'N'.        00987000
009880     05  PS-SQL-ERROR-SW           PIC  X(01)  VALUE  'N'.        00988000
009890         88  PS-SQL-ERROR                      VALUE  'Y'.        00989000
009900         88  PS-NO-SQL-ERROR                   VALUE  'N'.        00990000
010000     05  PS-DEFAULT-OPER-UNT-SW    PIC  X(01)  VALUE  'Y'.        01000000
010100         88  PS-DEFAULT-OPER-UNT               VALUE  'Y'.        01010000
010200         88  PS-NOT-DEFAULT-OPER-UNT           VALUE  'N'.        01020000
010300     05  PS-ERROR-MSG-SW           PIC  X(01)  VALUE  ' '.        01030000
010400         88  PS-PO-RCVR-NOT-FOUND              VALUE  'P'.        01040000
010500         88  PS-RETRY-EXCEEDED                 VALUE  'X'.        01050000
010600         88  PS-SEVERE-ERROR                   VALUE  'S'.        01060000
010700     05  PS-OPER-UNT-SW            PIC  X(01)  VALUE  'N'.        01070000
010800         88  PS-OPER-UNT-ENTERED               VALUE  'Y'.        01080000
010900         88  PS-OPER-UNT-NOT-ENTERED           VALUE  'N'.        01090000
011000     05  PS-DEPT-NBR-SW            PIC  X(01)  VALUE  'N'.        01100000
011100         88  PS-DEPT-NBR-ENTERED               VALUE  'Y'.        01110000
011200         88  PS-DEPT-NBR-NOT-ENTERED           VALUE  'N'.        01120000
011300     05  PS-BUYR-NBR-SW            PIC  X(01)  VALUE  'N'.        01130000
011400         88  PS-BUYR-NBR-ENTERED               VALUE  'Y'.        01140000
011500         88  PS-BUYR-NBR-NOT-ENTERED           VALUE  'N'.        01150000
011600     05  PS-PO-NBR-SW              PIC  X(01)  VALUE  'N'.        01160000
011700         88  PS-PO-NBR-ENTERED                 VALUE  'Y'.        01170000
011800         88  PS-PO-NBR-NOT-ENTERED             VALUE  'N'.        01180000
011900     05  PS-RCVR-SEQ-SW            PIC  X(01)  VALUE  'N'.        01190000
012000         88  PS-RCVR-SEQ-ENTERED               VALUE  'Y'.        01200000
012100         88  PS-RCVR-SEQ-NOT-ENTERED           VALUE  'N'.        01210000
012200     05  PS-LIST-SEQ-SW            PIC  X(01)  VALUE  'N'.        01220000
012300         88  PS-LIST-SEQ-ENTERED               VALUE  'Y'.        01230000
012400         88  PS-LIST-SEQ-NOT-ENTERED           VALUE  'N'.        01240000
012500     05  PS-RESP-AREA-SW           PIC  X(01)  VALUE  'N'.        01250000
012600         88  PS-RESP-AREA-ENTERED              VALUE  'Y'.        01260000
012700         88  PS-RESP-AREA-NOT-ENTERED          VALUE  'N'.        01270000
012800     05  PS-RCVR-STAT-SW           PIC  X(01)  VALUE  'N'.        01280000
012900         88  PS-RCVR-STAT-ENTERED              VALUE  'Y'.        01290000
013000         88  PS-RCVR-STAT-NOT-ENTERED          VALUE  'N'.        01300000
013100     05  PS-TRBL-RESN-SW           PIC  X(01)  VALUE  'N'.        01310000
013200         88  PS-TRBL-RESN-ENTERED              VALUE  'Y'.        01320000
013300         88  PS-TRBL-RESN-NOT-ENTERED          VALUE  'N'.        01330000
013400     05  PS-HOURS-SW               PIC  X(01)  VALUE  'N'.        01340000
013500         88  PS-HOURS-ENTERED                  VALUE  'Y'.        01350000
013600         88  PS-HOURS-NOT-ENTERED              VALUE  'N'.        01360000
013700     05  PS-DAYS-SW                PIC  X(01)  VALUE  'N'.        01370000
013800         88  PS-DAYS-ENTERED                   VALUE  'Y'.        01380000
013900         88  PS-DAYS-NOT-ENTERED               VALUE  'N'.        01390000
013910     05  PS-VALID-SET-SW           PIC  X(01)  VALUE  'N'.        01391099
013920         88  PS-VALID-SET                      VALUE  'Y'.        01392099
013930         88  PS-VALID-SET-NO                   VALUE  'N'.        01393099
014000*                                                                 01400000
014100 01  PV-PROGRAM-VARIABLES.                                        01410000
014200     05  PV-SQL-SUB                PIC S9(04)  VALUE +0           01420000
014300                                               COMP SYNC.         01430000
014400     05  PV-RETRY-COUNTER          PIC S9(04)  VALUE ZERO         01440000
014500                                               COMP SYNC.         01450000
014600     05  PV-COMMAREA-LENGTH        PIC S9(04)  VALUE +0           01460000
014700                                               COMP SYNC.         01470000
014800     05  PV-DB2-COUNT              PIC S9(09)  VALUE +0           01480000
014900                                               COMP-3.            01490000
015000     05  PV-UNPACK-OPER-UNT-ID     PIC  9(04)  VALUE ZERO.        01500000
015100     05  PV-TIMESTAMP              PIC  X(26)  VALUE SPACES.      01510000
015200     05  PV-SAVE-OPER-UNT          PIC  X(04)  VALUE SPACES.      01520000
015300     05  PV-SAVE-OPER-UNT-N REDEFINES                             01530000
015400         PV-SAVE-OPER-UNT          PIC  9(04).                    01540000
015500     05  PV-LOC-5-NM.                                             01550000
015600         10  PV-DC                 PIC  X(02)  VALUE SPACES.      01560000
015700         10  FILLER                PIC  X(01)  VALUE SPACES.      01570000
015800         10  PV-DC-NME             PIC  X(02)  VALUE SPACES.      01580000
015900     05  PV-LOC-4-CHAR-NM.                                        01590000
016000         10  PV-DC-NME-4           PIC  X(02)  VALUE SPACES.      01600000
016100         10  PV-DC-4               PIC  X(02)  VALUE SPACES.      01610000
016110     05  PV-TRBL-CODE              PIC  X(03)  VALUE SPACES.      01611000
016120     05  PV-TRBL-DESC              PIC  X(20)  VALUE SPACES.      01612000
016200*                                                                 01620000
016300 01  DK-DB2-KEYS.                                                 01630000
016400     05  DK-OPER-UNT-ID            PIC S9(04)  COMP VALUE +0.     01640000
016500     05  DK-FCLTY-ID               PIC S9(04)  COMP VALUE +0.     01650000
016600     05  DK-PO-NBR                 PIC S9(09)  COMP VALUE +0.     01660000
016700     05  DK-REC-SEQ-NBR            PIC S9(09)  COMP VALUE +0.     01670000
016800     05  DK-LOW-REC-SEQ-NBR        PIC S9(09)  COMP VALUE +0.     01680000
016900     05  DK-HI-REC-SEQ-NBR         PIC S9(09)  COMP VALUE +0.     01690000
017000     05  DK-DEPT-NBR               PIC  X(03)  VALUE SPACES.      01700000
017100     05  DK-DEPT-NBR-N             REDEFINES                      01710000
017200         DK-DEPT-NBR               PIC  9(03).                    01720000
017300     05  DK-BYR-NBR                PIC  X(03)  VALUE SPACES.      01730000
017400     05  DK-BYR-NBR-N              REDEFINES                      01740000
017500         DK-BYR-NBR                PIC  9(03).                    01750000
017600     05  DK-DMA-NBR                PIC  X(02)  VALUE SPACES.      01760000
017700     05  DK-DMA-NBR-N              REDEFINES                      01770000
017800         DK-DMA-NBR                PIC  9(02).                    01780000
017900     05  DK-GMA-NBR                PIC  X(02)  VALUE SPACES.      01790000
018000     05  DK-GMA-NBR-N              REDEFINES                      01800000
018100         DK-GMA-NBR                PIC  9(02).                    01810000
018200     05  DK-STORE-NMBR             PIC  9(04)  VALUE ZERO.        01820000
018300/                                                                 01830000
018400     COPY TMKM531.                                                01840000
018500/                                                                 01850000
018600*    ATTRIBUTE SETTINGS COPYBOOK.                                *01860000
018700                                                                  01870000
018800     COPY DPWS015.                                                01880000
018900                                                                  01890000
019000*    FUNCTION KEYS COPYBOOK                                      *01900000
019100                                                                  01910000
019200     COPY DPWS016.                                                01920000
019300/                                                                 01930000
019400** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01940000
019500** SUB-ROUTINE (DPKUT100).                                      **01950000
019600     COPY DPWS010I.                                               01960000
019700/                                                                 01970000
019800*  WORK AREA PASSED IN CALL TO DPKUT500                          *01980000
019900     COPY DPWS500.                                                01990000
020000/                                                                 02000000
020100*  LOGISTICS LOCATION DOMAIN (XLKUT071)                          *02010000
020200     COPY XLWS071.                                                02020000
020300/                                                                 02030000
020310*---------------------------------------------------------------* 02031099
020320*    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 02032099
020330*---------------------------------------------------------------* 02033099
020400     COPY DPWS030.                                                02040000
020410     COPY DPWS930.                                                02041099
020500/                                                                 02050000
020600*    STANDARD COMMAREA.                                           02060000
020700                                                                  02070000
020800     COPY DPWS020.                                                02080000
020900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02090000
021000         10  INTER-APPL-COMM-AREA PIC X(200).                     02100000
021100**** USED FOR TROUBLE LISTS FROM DC CRIT SPEC                     02110000
021200     COPY TMWS005.                                                02120000
021300**** USED FOR TROUBLE CREATE SCREEEN (MNEMONIC TMATRBL)           02130000
021400     COPY TMWS001.                                                02140000
021500**** USED FOR RECEIVER ITEM LIST (MNEMONIC RCLRCITM)              02150000
021600     COPY RCWS012.                                                02160000
021700***************************************************************** 02170000
021800*    SPECIFIC COMMMAREA FOR TMKCS531.                             02180000
021900***************************************************************** 02190000
022000         10  ASC-SPECIFIC-COMMAREA.                               02200000
022100             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09)          02210000
022200                                                    COMP-3.       02220000
022300             15  ASC-NUMBER-OF-TS-ITEMS         PIC S9(05)        02230000
022400                                                    COMP-3.       02240000
022500             15  ASC-SEL-QUEUE-NAME             PIC X(8).         02250000
022600             15  ASC-OPER-UNT-ID                PIC X(04).        02260000
022700             15  ASC-OPER-UNT-ID-N    REDEFINES                   02270000
022800                 ASC-OPER-UNT-ID                PIC 9(04).        02280000
022900             15  ASC-FCLTY-ID                   PIC X(04).        02290000
023000             15  ASC-FCLTY-ID-N    REDEFINES                      02300000
023100                 ASC-FCLTY-ID                   PIC 9(04).        02310000
023200             15  ASC-FCLTY-NME                  PIC X(20).        02320000
023300             15  ASC-FCLTY-SHORT-NME            PIC X(04).        02330000
023400             15  ASC-DEPT                       PIC X(03).        02340000
023500             15  ASC-DEPT-N REDEFINES                             02350000
023600                 ASC-DEPT                       PIC 9(03).        02360000
023700             15  ASC-BUYER-NBR                  PIC X(03).        02370000
023800             15  ASC-BUYER-NBR-N REDEFINES                        02380000
023900                 ASC-BUYER-NBR                  PIC 9(03).        02390000
024000             15  ASC-DMM                        PIC X(02).        02400000
024100             15  ASC-DMM-N REDEFINES                              02410000
024200                 ASC-DMM                        PIC 9(02).        02420000
024300*TV 10/08/2014 CHANGE STARTS                                      02430099
024310             15  ASC-PO-NBR                     PIC X(08).        02431000
024400             15  ASC-PO-NBR-N REDEFINES                           02440000
024500                 ASC-PO-NBR                     PIC 9(08).        02450000
024510*TV 10/08/2014 CHANGE ENDS                                        02451099
024600             15  ASC-RCVR-SEQ-NBR               PIC X(04).        02460000
024700             15  ASC-RCVR-SEQ-NBR-N REDEFINES                     02470000
024800                 ASC-RCVR-SEQ-NBR               PIC 9(04).        02480000
024900             15  ASC-LIST-SEQ.                                    02490000
025000                 20  ASC-LS-ARRIVAL-DT          PIC X(01).        02500000
025100                 20  ASC-LS-OLD-NEW-TRBL        PIC X(01).        02510000
025200             15  ASC-RESPONSIBILITY-AREA.                         02520000
025300                 20  ASC-RA-BUYER-ANALYST       PIC X(01).        02530000
025400                 20  ASC-RA-BUYER-ANALYST-DC    PIC X(01).        02540000
025500                 20  ASC-RA-DC                  PIC X(01).        02550000
025600             15  ASC-NOTIF-STATUS               PIC X(01).        02560000
025700             15  ASC-RCVR-STATUS-ARRIVED        PIC X(01).        02570000
025800             15  ASC-RCVR-STATUS-ENROUTE        PIC X(01).        02580000
025900             15  ASC-TRBL-REASON                PIC X(03).        02590000
026000             15  ASC-TRBL-RSN-DESC              PIC X(20).        02600000
026100             15  ASC-NOTIF-STATUS               PIC X(01).        02610000
026200                 88  ASC-ALL-NOTIF-STATS        VALUE ' '.        02620000
026300                 88  ASC-RESOLVD-STAT-ONLY      VALUE 'R'.        02630000
026400                 88  ASC-UNRSLVD-STAT-ONLY      VALUE 'U'.        02640000
026500             15  ASC-STAT-NEW                   PIC X(01).        02650000
026600             15  ASC-STAT-IN-PRC                PIC X(01).        02660000
026700             15  ASC-STAT-RSLVD                 PIC X(01).        02670000
026800             15  ASC-STAT-ACKNW                 PIC X(01).        02680000
026900             15  ASC-LIST-TRBL-HOURS            PIC X(02).        02690000
027000             15  ASC-LIST-TRBL-HOURS-N REDEFINES                  02700000
027100                 ASC-LIST-TRBL-HOURS            PIC 9(02).        02710000
027200             15  ASC-LIST-TRBL-DAYS             PIC X(01).        02720000
027300             15  ASC-LIST-TRBL-DAYS-N REDEFINES                   02730000
027400                 ASC-LIST-TRBL-DAYS             PIC 9(01).        02740000
027500             15  ASC-NAVIGATION-SW              PIC X(01).        02750000
027501                 88  ASC-TRBL-LIST              VALUE 'T'.        02750100
027502                 88  ASC-NAVIGATION-NONE        VALUE ' '.        02750200
027503*                                                                 02750399
027510             15  ASC-INCLD-SET                  PIC X(001).       02751099
027511                 88  ASC-INCLD-SET-CDE    VALUE 'S'.              02751199
027513                 88  ASC-INCLD-SET-VALID  VALUE 'S', ' '.         02751399
027515             15  ASC-EXCLD-SET                  PIC X(001).       02751599
027516                 88  ASC-EXCLD-SET-CDE    VALUE 'S'.              02751699
027518                 88  ASC-EXCLD-SET-VALID  VALUE 'S', ' '.         02751899
027520                                                                  02752099
027521             15  ASC-SET-CODE-1                 PIC X(005).       02752199
027522             15  ASC-SET-YEAR-1                 PIC X(004).       02752299
027523             15  ASC-SET-CODE-2                 PIC X(005).       02752399
027524             15  ASC-SET-YEAR-2                 PIC X(004).       02752499
027525             15  ASC-SET-CODE-3                 PIC X(005).       02752599
027526             15  ASC-SET-YEAR-3                 PIC X(004).       02752699
027527             15  ASC-SET-CODE-4                 PIC X(005).       02752799
027528             15  ASC-SET-YEAR-4                 PIC X(004).       02752899
027529             15  ASC-SET-CODE-5                 PIC X(005).       02752999
027530             15  ASC-SET-YEAR-5                 PIC X(004).       02753099
027531             15  ASC-SET-CODE-6                 PIC X(005).       02753199
027532             15  ASC-SET-YEAR-6                 PIC X(004).       02753299
027533*                                                                 02753399
027534             15  FILLER                         PIC X(030).       02753499
027540*                                                                 02754099
027600/                                                                 02760000
027700*    ABEND PROCESSING COPYBOOK.                                  *02770000
027800                                                                  02780000
027900     COPY DPWS013.                                                02790000
028000/                                                                 02800000
028100*  SQL AND COBOL DECLARATIONS FOR THE MERCHANDISE AREA TABLE     *02810000
028200                                                                  02820000
028300     EXEC SQL                                                     02830000
028400         INCLUDE TMDSEAR                                          02840000
028500     END-EXEC.                                                    02850000
028600/                                                                 02860000
028700*  SQL AND COBOL DECLARATIONS FOR THE RESPONSIBILITY AREA TABLE  *02870000
028800                                                                  02880000
028900     EXEC SQL                                                     02890000
029000         INCLUDE TRSPBAR                                          02900000
029100     END-EXEC.                                                    02910000
029200/                                                                 02920000
029300*  SQL AND COBOL DECLARATIONS FOR THE PURCHASE ORDER TABLE       *02930000
029400                                                                  02940000
029500     EXEC SQL                                                     02950000
029600         INCLUDE TPURCHS                                          02960000
029700     END-EXEC.                                                    02970000
029800/                                                                 02980000
029900*  SQL AND COBOL DECLARATIONS FOR THE RECEIVER TABLE             *02990000
030000                                                                  03000000
030100     EXEC SQL                                                     03010000
030200         INCLUDE TRECEIV                                          03020000
030300     END-EXEC.                                                    03030000
030400                                                                  03040099
030401* SEASONAL SET                                                    03040199
030410     EXEC SQL                                                     03041099
030420         INCLUDE TSEASET                                          03042099
030430     END-EXEC.                                                    03043099
030440/                                                                 03044099
030500     EXEC SQL                                                     03050000
030600         INCLUDE SQLCA                                            03060000
030700     END-EXEC.                                                    03070000
030800/                                                                 03080000
030900 LINKAGE SECTION.                                                 03090000
031000                                                                  03100000
031100 01  DFHCOMMAREA.                                                 03110000
031200     05  FILLER                         OCCURS  1 TO 4072 TIMES   03120000
031300                                        DEPENDING ON EIBCALEN.    03130000
031400         10  FILLER                     PIC X.                    03140000
031500                                                                  03150000
031600                                                                  03160000
031700 PROCEDURE DIVISION.                                              03170000
031800                                                                  03180000
031900 0000-MAIN-MODULE.                                                03190000
032000     INITIALIZE DP030-CICS-API-FIELDS.                            03200000
032100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03210000
032200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03220000
032300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03230000
032400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03240000
032500     MOVE LENGTH OF TM531AI        TO DP030-MAP-LENGTH (1).       03250000
032600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03260000
032700     PERFORM 0001-CALL-CICS-ARCH-API.                             03270000
032800                                                                  03280000
032900     PERFORM 1000-CONTROL-PROCESSING                              03290000
033000                                                                  03300000
033100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03310000
033200     PERFORM 0001-CALL-CICS-ARCH-API.                             03320000
033300                                                                  03330000
033400 0001-CALL-CICS-ARCH-API.                                         03340000
033500     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03350099
033600                                    DFHCOMMAREA                   03360099
033700                                    DP030-CICS-API-FIELDS         03370099
033800                                    DP020-STANDARD-COMMAREA       03380099
033900                                    TM531AI.                      03390099
034000                                                                  03400000
034100     IF  DP030-RC-CALL-SUCCESSFUL                                 03410000
034200         CONTINUE                                                 03420000
034300     ELSE                                                         03430000
034400         SET DP013-NO-ROLLBACK                                    03440000
034500             DP013-XCTL-DISPLAY-RESTART                           03450000
034600             DP013-CICS-ABEND      TO TRUE                        03460000
034700         MOVE 'BEFORE 0000-MAIN-MODULE' TO DP013-PARAGRAPH        03470000
034710         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03471099
034720-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03472099
035000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      03500000
035100         PERFORM DP013-0000-PROCESS-ABEND                         03510000
035200     END-IF.                                                      03520000
035300/                                                                 03530000
035400 1000-CONTROL-PROCESSING.                                         03540000
035500     EVALUATE TRUE                                                03550000
035600         WHEN DP020-NEXT-ACT-INITIAL                              03560000
035700             INITIALIZE ASC-SPECIFIC-COMMAREA                     03570000
035800             MOVE DP020-LOCATION-NBR TO PV-UNPACK-OPER-UNT-ID     03580000
035900             IF  PV-UNPACK-OPER-UNT-ID = PC-CORPORATE-OFFICE      03590000
036000                 MOVE SPACES     TO ASC-OPER-UNT-ID               03600000
036100                                    ASC-FCLTY-ID                  03610000
036200                                    ASC-FCLTY-NME                 03620000
036300             ELSE                                                 03630000
036400                 MOVE PV-UNPACK-OPER-UNT-ID                       03640000
036500                                 TO ASC-OPER-UNT-ID               03650000
036600                 MOVE 0001       TO ASC-FCLTY-ID                  03660000
036700             END-IF                                               03670000
036800             PERFORM 4000-BUILD-INITIAL-PANEL                     03680000
036900                                                                  03690000
037000         WHEN DP020-NEXT-ACT-READ-MAP                             03700000
037100             PERFORM 2000-FKEY-PROCESSING                         03710000
037200                                                                  03720000
037300         WHEN DP020-NEXT-ACT-RETURN                               03730000
037310             IF  ASC-TRBL-LIST                                    03731000
037320                 MOVE TM005-TRBL-REASON   TO  PV-TRBL-CODE        03732000
037330                 MOVE TM005-TRBL-RSN-DESC TO  PV-TRBL-DESC        03733000
037360                                                                  03736099
037361                 INITIALIZE ASC-SPECIFIC-COMMAREA                 03736100
037362                 MOVE  TM005-OPER-UNT-ID  TO  ASC-OPER-UNT-ID     03736200
037363                 MOVE  0001               TO  ASC-FCLTY-ID        03736300
037364                                                                  03736499
037365                 MOVE TM005-INCLD-SET     TO  ASC-INCLD-SET       03736599
037366                 MOVE TM005-EXCLD-SET     TO  ASC-EXCLD-SET       03736699
037367                 MOVE TM005-SET-CODE-1    TO  ASC-SET-CODE-1      03736799
037368                 MOVE TM005-SET-YEAR-1    TO  ASC-SET-YEAR-1      03736899
037369                 MOVE TM005-SET-CODE-2    TO  ASC-SET-CODE-2      03736999
037370                 MOVE TM005-SET-YEAR-2    TO  ASC-SET-YEAR-2      03737099
037371                 MOVE TM005-SET-CODE-3    TO  ASC-SET-CODE-3      03737199
037372                 MOVE TM005-SET-YEAR-3    TO  ASC-SET-YEAR-3      03737299
037373                 MOVE TM005-SET-CODE-4    TO  ASC-SET-CODE-4      03737399
037374                 MOVE TM005-SET-YEAR-4    TO  ASC-SET-YEAR-4      03737499
037375                 MOVE TM005-SET-CODE-5    TO  ASC-SET-CODE-5      03737599
037376                 MOVE TM005-SET-YEAR-5    TO  ASC-SET-YEAR-5      03737699
037377                 MOVE TM005-SET-CODE-6    TO  ASC-SET-CODE-6      03737799
037378                 MOVE TM005-SET-YEAR-6    TO  ASC-SET-YEAR-6      03737899
037379                                                                  03737999
037380                 PERFORM 4000-BUILD-INITIAL-PANEL                 03738000
037381                 PERFORM 3200-RESET-ATTRIBUTES                    03738100
037382                 MOVE PV-TRBL-CODE       TO  ASC-TRBL-REASON      03738200
037383                                             ATRESNO              03738300
037390                 MOVE PV-TRBL-DESC       TO  ASC-TRBL-RSN-DESC    03739000
037392             ELSE                                                 03739200
037400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             03740000
037500                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               03750000
037510             END-IF                                               03751000
037600                                                                  03760000
037700         WHEN OTHER                                               03770000
037800             SET DP013-LOGIC-ABEND                                03780000
037900                 DP013-NO-ROLLBACK TO TRUE                        03790000
038000             MOVE '1000-CONTROL-PROCESSING' TO  DP013-PARAGRAPH   03800000
038100             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   03810000
038200                                   TO  DP013-MESSAGE-TEXT(1)      03820000
038300             MOVE DP020-NEXT-APPL-ACTIVITY                        03830000
038400                                   TO DP013-MESSAGE-TEXT(2)       03840000
038500             PERFORM DP013-0000-PROCESS-ABEND                     03850000
038600     END-EVALUATE.                                                03860000
038700/                                                                 03870000
038800 2000-FKEY-PROCESSING.                                            03880000
038900     EVALUATE TRUE                                                03890000
039000         WHEN DP020-SRC-AID = DP016-CLEAR                         03900000
039100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03910000
039200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03920000
039300                                                                  03930000
039400         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03940099
039500             INITIALIZE ASC-SPECIFIC-COMMAREA                     03950000
039510             MOVE DP020-LOCATION-NBR TO PV-UNPACK-OPER-UNT-ID     03951000
039520             IF  PV-UNPACK-OPER-UNT-ID = PC-CORPORATE-OFFICE      03952000
039530                 MOVE SPACES     TO ASC-OPER-UNT-ID               03953000
039540                                    ASC-FCLTY-ID                  03954000
039550                                    ASC-FCLTY-NME                 03955000
039551                                    ASC-INCLD-SET                 03955199
039554                                    ASC-EXCLD-SET                 03955499
039558                                    ASC-SET-CODE-1                03955899
039559                                    ASC-SET-YEAR-1                03955999
039560                                    ASC-SET-CODE-2                03956099
039561                                    ASC-SET-YEAR-2                03956199
039562                                    ASC-SET-CODE-3                03956299
039563                                    ASC-SET-YEAR-3                03956399
039564                                    ASC-SET-CODE-4                03956499
039565                                    ASC-SET-YEAR-4                03956599
039566                                    ASC-SET-CODE-5                03956699
039567                                    ASC-SET-YEAR-5                03956799
039568                                    ASC-SET-CODE-6                03956899
039569                                    ASC-SET-YEAR-6                03956999
039587             ELSE                                                 03958799
039588                 MOVE PV-UNPACK-OPER-UNT-ID                       03958899
039589                                 TO ASC-OPER-UNT-ID               03958999
039590                 MOVE 0001       TO ASC-FCLTY-ID                  03959000
039591                 MOVE SPACES     TO ASC-INCLD-SET                 03959199
039592                                    ASC-EXCLD-SET                 03959299
039593                                    ASC-SET-CODE-1                03959399
039594                                    ASC-SET-YEAR-1                03959499
039595                                    ASC-SET-CODE-2                03959599
039596                                    ASC-SET-YEAR-2                03959699
039597                                    ASC-SET-CODE-3                03959799
039598                                    ASC-SET-YEAR-3                03959899
039599                                    ASC-SET-CODE-4                03959999
039600                                    ASC-SET-YEAR-4                03960099
039601                                    ASC-SET-CODE-5                03960199
039602                                    ASC-SET-YEAR-5                03960299
039603                                    ASC-SET-CODE-6                03960399
039604                                    ASC-SET-YEAR-6                03960499
039605             END-IF                                               03960500
039610             PERFORM 4000-BUILD-INITIAL-PANEL                     03961000
039700             PERFORM 3200-RESET-ATTRIBUTES                        03970000
039800                                                                  03980000
039900         WHEN OTHER                                               03990000
040000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 04000000
040100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04010000
040200             IF  PS-NO-ERROR                                      04020000
040300                 SET DP030-CONTINUE-GO TO TRUE                    04030000
040400                 PERFORM 2100-CHECK-FUNCTION-KEY                  04040000
040500             ELSE                                                 04050000
040600                 SET DP030-OVERRIDE-GO TO TRUE                    04060000
040700             END-IF                                               04070000
040800     END-EVALUATE.                                                04080000
040900/                                                                 04090000
041000 2100-CHECK-FUNCTION-KEY.                                         04100000
041100     EVALUATE TRUE                                                04110000
041200         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               04120000
041300         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               04130000
041400         WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               04140000
041500         WHEN DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)               04150000
041600         WHEN DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)               04160000
041700             PERFORM 2110-PREPARE-INTER-APPL-COMM                 04170000
041800                                                                  04180000
041810         WHEN DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)               04181000
041811             SET  ASC-TRBL-LIST  TO  TRUE                         04181100
041820             PERFORM 2110-PREPARE-INTER-APPL-COMM                 04182000
041830                                                                  04183000
041900         WHEN DP020-SRC-AID = DP016-ENTER                         04190000
042000             CONTINUE                                             04200000
042100                                                                  04210000
042200         WHEN OTHER                                               04220000
042300             SET DP013-NO-ROLLBACK                                04230000
042400                 DP013-XCTL-DISPLAY-RESTART                       04240000
042500                 DP013-CICS-ABEND  TO TRUE                        04250000
042600             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    04260000
042700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      04270000
042800                                   TO DP013-MESSAGE-TEXT (1)      04280000
042900             PERFORM DP013-0000-PROCESS-ABEND                     04290000
043000     END-EVALUATE.                                                04300000
043100/                                                                 04310000
043200 2110-PREPARE-INTER-APPL-COMM.                                    04320000
043201                                                                  04320199
043300     EVALUATE TRUE                                                04330000
043400         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               04340000
043500             INITIALIZE TM001-INTER-APPL-COMMAREA                 04350000
043600             MOVE ASC-OPER-UNT-ID  TO TM001-OPER-UNT-ID           04360000
043700             MOVE ASC-FCLTY-ID     TO TM001-FCLTY-ID              04370000
043800             MOVE ASC-PO-NBR       TO TM001-PO-NBR                04380000
043900             MOVE ASC-RCVR-SEQ-NBR TO TM001-RCVR-SEQ-NBR          04390000
044000         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               04400000
044100         WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               04410000
044200         WHEN DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)               04420000
044210         WHEN DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)               04421000
044300             INITIALIZE TM005-INTER-APPL-COMMAREA                 04430000
044400             IF  ASC-OPER-UNT-ID = SPACES                         04440000
044500                 MOVE ZEROS           TO TM005-OPER-UNT-ID        04450000
044600             ELSE                                                 04460000
044700                 MOVE ASC-OPER-UNT-ID TO TM005-OPER-UNT-ID        04470000
044800             END-IF                                               04480000
044900             MOVE ASC-FCLTY-ID    TO TM005-FCLTY-ID               04490000
045000             MOVE ASC-FCLTY-NME   TO TM005-FCLTY-NME              04500000
045100             MOVE ASC-FCLTY-SHORT-NME TO TM005-FCLTY-SHORT-NME    04510000
045200             MOVE ASC-DEPT        TO TM005-DEPT                   04520000
045300             MOVE ASC-BUYER-NBR   TO TM005-BUYER                  04530000
045310*TV 10/08/2014 CHANGE STARTS                                      04531099
045400*            MOVE ASC-PO-NBR      TO TM005-PO-NBR                 04540000
045410             MOVE ASC-PO-NBR-N    TO TM005-PO-NBR-N               04541000
045420*TV 10/08/2014 CHANGE ENDS                                        04542099
045500             MOVE ASC-RCVR-SEQ-NBR TO TM005-RCVR-SEQ-NBR          04550000
045600             IF ASC-LS-ARRIVAL-DT = PC-S                          04560000
045700                 SET TM005-LS-ARRIVAL  TO TRUE                    04570000
045800             END-IF                                               04580000
045900             IF ASC-LS-OLD-NEW-TRBL = PC-S                        04590000
046000                 SET TM005-LS-OLDEST-TRBL TO TRUE                 04600000
046100             END-IF                                               04610000
046200***  BUYER, ANALYST AND DC IS THE DEFAULT FOR RESPOSIBILITY AREA  04620000
046300             SET TM005-RA-BUY-ANALYST-DC-SW TO TRUE               04630000
046400             MOVE PC-B TO TM005-RA-BUYER                          04640000
046500             MOVE PC-A TO TM005-RA-ANALYST                        04650000
046600             MOVE PC-D TO TM005-RA-DC                             04660000
046700             IF ASC-RA-BUYER-ANALYST = PC-S                       04670000
046800                 SET TM005-RA-BUY-ANALYST-SW TO TRUE              04680000
046900                 MOVE PC-B TO TM005-RA-BUYER                      04690000
047000                 MOVE PC-A TO TM005-RA-ANALYST                    04700000
047100                 MOVE SPACE TO TM005-RA-DC                        04710000
047200             END-IF                                               04720000
047300             IF ASC-RA-DC = PC-S                                  04730000
047400                 SET TM005-RA-DC-SW TO TRUE                       04740000
047500                 MOVE SPACE TO TM005-RA-BUYER                     04750000
047600                 MOVE SPACE TO TM005-RA-ANALYST                   04760000
047700                 MOVE PC-D TO TM005-RA-DC                         04770000
047800             END-IF                                               04780000
047900****    THE DEFAULT FOR NOTIF. STATUS IS ALL                      04790000
048000****    DEPENDS ON F KEY PRESSED                                  04800000
048100             EVALUATE TRUE                                        04810000
048200                 WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)       04820000
048300****************     RESOLVED TROUBLE, NOT ACKNOWLEDGED           04830000
048400                     SET TM005-RESOLVD-STAT-ONLY TO TRUE          04840000
048500                     MOVE PC-R TO TM005-STAT-RSLVD                04850000
048510                                                                  04851099
048520                     MOVE ASC-INCLD-SET    TO TM005-INCLD-SET     04852099
048540                     MOVE ASC-EXCLD-SET    TO TM005-EXCLD-SET     04854099
048560                     MOVE ASC-SET-CODE-1   TO TM005-SET-CODE-1    04856099
048580                     MOVE ASC-SET-YEAR-1   TO TM005-SET-YEAR-1    04858099
048591                     MOVE ASC-SET-CODE-2   TO TM005-SET-CODE-2    04859199
048593                     MOVE ASC-SET-YEAR-2   TO TM005-SET-YEAR-2    04859399
048595                     MOVE ASC-SET-CODE-3   TO TM005-SET-CODE-3    04859599
048597                     MOVE ASC-SET-YEAR-3   TO TM005-SET-YEAR-3    04859799
048599                     MOVE ASC-SET-CODE-4   TO TM005-SET-CODE-4    04859999
048601                     MOVE ASC-SET-YEAR-4   TO TM005-SET-YEAR-4    04860199
048603                     MOVE ASC-SET-CODE-5   TO TM005-SET-CODE-5    04860399
048605                     MOVE ASC-SET-YEAR-5   TO TM005-SET-YEAR-5    04860599
048607                     MOVE ASC-SET-CODE-6   TO TM005-SET-CODE-6    04860799
048609                     MOVE ASC-SET-YEAR-6   TO TM005-SET-YEAR-6    04860999
048633                                                                  04863399
048640                 WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)       04864000
048700****************     UNRESOLVED TROUBLE                           04870000
048800                     SET TM005-UNRSLVD-STAT-ONLY TO TRUE          04880000
048900                     MOVE PC-N TO TM005-STAT-NEW                  04890000
049000                     MOVE PC-I TO TM005-STAT-IN-PRC               04900000
049001                                                                  04900199
049002                     MOVE ASC-INCLD-SET    TO TM005-INCLD-SET     04900299
049003                     MOVE ASC-EXCLD-SET    TO TM005-EXCLD-SET     04900399
049004                     MOVE ASC-SET-CODE-1   TO TM005-SET-CODE-1    04900499
049005                     MOVE ASC-SET-YEAR-1   TO TM005-SET-YEAR-1    04900599
049006                     MOVE ASC-SET-CODE-2   TO TM005-SET-CODE-2    04900699
049007                     MOVE ASC-SET-YEAR-2   TO TM005-SET-YEAR-2    04900799
049008                     MOVE ASC-SET-CODE-3   TO TM005-SET-CODE-3    04900899
049009                     MOVE ASC-SET-YEAR-3   TO TM005-SET-YEAR-3    04900999
049010                     MOVE ASC-SET-CODE-4   TO TM005-SET-CODE-4    04901099
049011                     MOVE ASC-SET-YEAR-4   TO TM005-SET-YEAR-4    04901199
049012                     MOVE ASC-SET-CODE-5   TO TM005-SET-CODE-5    04901299
049013                     MOVE ASC-SET-YEAR-5   TO TM005-SET-YEAR-5    04901399
049014                     MOVE ASC-SET-CODE-6   TO TM005-SET-CODE-6    04901499
049015                     MOVE ASC-SET-YEAR-6   TO TM005-SET-YEAR-6    04901599
049120                                                                  04912099
049130                 WHEN DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)       04913000
049200****************     ALL RESOLVED AND UNRESOLVED TROUBLE          04920000
049300                     SET TM005-ALL-NOTIF-STATS TO TRUE            04930000
049400                     MOVE PC-R TO TM005-STAT-RSLVD                04940000
049500                     MOVE PC-A TO TM005-STAT-ACKNW                04950000
049600                     MOVE PC-N TO TM005-STAT-NEW                  04960000
049700                     MOVE PC-I TO TM005-STAT-IN-PRC               04970000
049710                                                                  04971099
049720                     MOVE ASC-INCLD-SET    TO TM005-INCLD-SET     04972099
049730                     MOVE ASC-EXCLD-SET    TO TM005-EXCLD-SET     04973099
049740                     MOVE ASC-SET-CODE-1   TO TM005-SET-CODE-1    04974099
049750                     MOVE ASC-SET-YEAR-1   TO TM005-SET-YEAR-1    04975099
049760                     MOVE ASC-SET-CODE-2   TO TM005-SET-CODE-2    04976099
049770                     MOVE ASC-SET-YEAR-2   TO TM005-SET-YEAR-2    04977099
049780                     MOVE ASC-SET-CODE-3   TO TM005-SET-CODE-3    04978099
049790                     MOVE ASC-SET-YEAR-3   TO TM005-SET-YEAR-3    04979099
049791                     MOVE ASC-SET-CODE-4   TO TM005-SET-CODE-4    04979199
049792                     MOVE ASC-SET-YEAR-4   TO TM005-SET-YEAR-4    04979299
049793                     MOVE ASC-SET-CODE-5   TO TM005-SET-CODE-5    04979399
049794                     MOVE ASC-SET-YEAR-5   TO TM005-SET-YEAR-5    04979499
049795                     MOVE ASC-SET-CODE-6   TO TM005-SET-CODE-6    04979599
049796                     MOVE ASC-SET-YEAR-6   TO TM005-SET-YEAR-6    04979699
049797                                                                  04979799
049800             END-EVALUATE                                         04980000
049900****    ARRIVED AND ENROUTE IS THE DEFAULT FOR RECEIVER STATUS    04990000
050000             SET TM005-RCVR-STAT-ARR-ENR TO TRUE                  05000000
050100             IF ASC-RCVR-STATUS-ARRIVED = PC-S                    05010000
050200                 SET TM005-RCVR-STAT-ARRIVED TO TRUE              05020000
050300             END-IF                                               05030000
050400             IF ASC-RCVR-STATUS-ENROUTE = PC-S                    05040000
050500                 SET TM005-RCVR-STAT-ENROUTE TO TRUE              05050000
050600             END-IF                                               05060000
050700             MOVE ASC-TRBL-REASON   TO TM005-TRBL-REASON          05070000
050800             MOVE ASC-TRBL-RSN-DESC TO TM005-TRBL-RSN-DESC        05080000
050900         WHEN DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)               05090000
051000****************     FOR RECEIVER ITEM LIST SCREEN                05100000
051100             INITIALIZE RC012-INTER-APPL-COMMAREA                 05110000
051200             MOVE ASC-PO-NBR       TO RC012-PO-NBR                05120000
051300             MOVE ASC-RCVR-SEQ-NBR TO RC012-REC-SEQ-NBR           05130000
051400             MOVE ASC-OPER-UNT-ID  TO RC012-OPER-UNT-ID           05140000
051500             MOVE ASC-FCLTY-ID     TO RC012-FCLTY-ID              05150000
051600     END-EVALUATE.                                                05160000
051700/                                                                 05170000
051800 2200-MOVE-SCREEN-TO-COMMAREA.                                    05180000
051900     IF  AOPRIDL  > ZERO                                          05190000
052000         MOVE AOPRIDI    TO ASC-OPER-UNT-ID                       05200000
052100     ELSE                                                         05210000
052200         IF  AOPRIDF = DP015-ERASE-EOF                            05220000
052300             MOVE SPACE  TO ASC-OPER-UNT-ID                       05230000
052400         END-IF                                                   05240000
052500     END-IF.                                                      05250000
052600                                                                  05260000
052700     IF  ADPTNRL > ZERO                                           05270000
052800         MOVE ADPTNRI   TO ASC-DEPT                               05280000
052900     ELSE                                                         05290000
053000         IF  ADPTNRF = DP015-ERASE-EOF                            05300000
053100             MOVE SPACE  TO ASC-DEPT                              05310000
053200         END-IF                                                   05320000
053300     END-IF.                                                      05330000
053400                                                                  05340000
053500     IF  ABYRNRL > ZERO                                           05350000
053600         MOVE ABYRNRI   TO ASC-BUYER-NBR                          05360000
053700     ELSE                                                         05370000
053800         IF  ABYRNRF = DP015-ERASE-EOF                            05380000
053900             MOVE SPACE  TO ASC-BUYER-NBR                         05390000
054000         END-IF                                                   05400000
054100     END-IF.                                                      05410000
054200                                                                  05420000
054300     IF  APONBRL > ZERO                                           05430000
054400         MOVE APONBRI    TO ASC-PO-NBR                            05440000
054500     ELSE                                                         05450000
054600         IF  APONBRF = DP015-ERASE-EOF                            05460000
054700             MOVE SPACE  TO ASC-PO-NBR                            05470000
054800         END-IF                                                   05480000
054900     END-IF.                                                      05490000
055000                                                                  05500000
055100     IF  ARCVSQL > ZERO                                           05510000
055200         MOVE ARCVSQI   TO ASC-RCVR-SEQ-NBR                       05520000
055300     ELSE                                                         05530000
055400         IF  ARCVSQF = DP015-ERASE-EOF                            05540000
055500             MOVE SPACE  TO ASC-RCVR-SEQ-NBR                      05550000
055600         END-IF                                                   05560000
055700     END-IF.                                                      05570000
055800                                                                  05580000
055900     IF  ASEQARL > ZERO                                           05590000
056000         MOVE ASEQARI   TO ASC-LS-ARRIVAL-DT                      05600000
056100     ELSE                                                         05610000
056200         IF  ASEQARF = DP015-ERASE-EOF                            05620000
056300             MOVE SPACE  TO ASC-LS-ARRIVAL-DT                     05630000
056400         END-IF                                                   05640000
056500     END-IF.                                                      05650000
056600                                                                  05660000
056700     IF  ASEQOTL > ZERO                                           05670000
056800         MOVE ASEQOTI   TO ASC-LS-OLD-NEW-TRBL                    05680000
056900     ELSE                                                         05690000
057000         IF  ASEQOTF = DP015-ERASE-EOF                            05700000
057100             MOVE SPACE  TO ASC-LS-OLD-NEW-TRBL                   05710000
057200         END-IF                                                   05720000
057300     END-IF.                                                      05730000
057400                                                                  05740000
057500     IF  ABYANLL > ZERO                                           05750000
057600         MOVE ABYANLI   TO ASC-RA-BUYER-ANALYST                   05760000
057700     ELSE                                                         05770000
057800         IF  ABYANLF = DP015-ERASE-EOF                            05780000
057900             MOVE SPACE  TO ASC-RA-BUYER-ANALYST                  05790000
058000         END-IF                                                   05800000
058100     END-IF.                                                      05810000
058200                                                                  05820000
058300     IF  ADCTRL > ZERO                                            05830000
058400         MOVE ADCTRI   TO ASC-RA-DC                               05840000
058500     ELSE                                                         05850000
058600         IF  ADCTRF = DP015-ERASE-EOF                             05860000
058700             MOVE SPACE  TO ASC-RA-DC                             05870000
058800         END-IF                                                   05880000
058900     END-IF.                                                      05890000
059000                                                                  05900000
059100***** RCVR CAN EITHER BE ARRIVED OR ENROUTE, DEFAULT IS BOTH      05910000
059200     IF  ARCARVL > ZERO                                           05920000
059300         MOVE ARCARVI   TO ASC-RCVR-STATUS-ARRIVED                05930000
059400     ELSE                                                         05940000
059500         IF  ARCARVF = DP015-ERASE-EOF                            05950000
059600             MOVE SPACE  TO ASC-RCVR-STATUS-ARRIVED               05960000
059700         END-IF                                                   05970000
059800     END-IF.                                                      05980000
059900                                                                  05990000
060000     IF  ARCENRL > ZERO                                           06000000
060100         MOVE ARCENRI   TO ASC-RCVR-STATUS-ENROUTE                06010000
060200     ELSE                                                         06020000
060300         IF  ARCENRF = DP015-ERASE-EOF                            06030000
060400             MOVE SPACE  TO ASC-RCVR-STATUS-ENROUTE               06040000
060500         END-IF                                                   06050000
060600     END-IF.                                                      06060000
060700                                                                  06070000
060800     IF  ATRESNL > ZERO                                           06080000
060900         MOVE ATRESNI   TO ASC-TRBL-REASON                        06090000
061000     ELSE                                                         06100000
061100         IF  ATRESNF = DP015-ERASE-EOF                            06110000
061200             MOVE SPACE  TO ASC-TRBL-REASON                       06120000
061300         END-IF                                                   06130000
061400     END-IF.                                                      06140000
061401                                                                  06140199
061402     IF  AINCLDL  > ZERO                                          06140299
061403         MOVE AINCLDI    TO ASC-INCLD-SET                         06140399
061404     ELSE                                                         06140499
061405         IF  AINCLDF  = DP015-ERASE-EOF                           06140599
061406             MOVE SPACE  TO ASC-INCLD-SET                         06140699
061407         END-IF                                                   06140799
061408     END-IF.                                                      06140899
061409                                                                  06140999
061410     IF  AEXCLDL  > ZERO                                          06141099
061411         MOVE AEXCLDI    TO ASC-EXCLD-SET                         06141199
061412     ELSE                                                         06141299
061413         IF  AEXCLDF  = DP015-ERASE-EOF                           06141399
061414             MOVE SPACE  TO ASC-EXCLD-SET                         06141499
061415         END-IF                                                   06141599
061416     END-IF.                                                      06141699
061417                                                                  06141799
061418     IF  ASTCD1L > ZERO                                           06141899
061419         MOVE ASTCD1I   TO ASC-SET-CODE-1                         06141999
061420     ELSE                                                         06142099
061421         IF  ASTCD1F = DP015-ERASE-EOF                            06142199
061422             MOVE SPACE  TO ASC-SET-CODE-1                        06142299
061423         END-IF                                                   06142399
061424     END-IF.                                                      06142499
061425                                                                  06142599
061426     IF  ASTYR1L > ZERO                                           06142699
061427         MOVE ASTYR1I   TO ASC-SET-YEAR-1                         06142799
061428     ELSE                                                         06142899
061429         IF  ASTYR1F = DP015-ERASE-EOF                            06142999
061430             MOVE SPACE  TO ASC-SET-YEAR-1                        06143099
061431         END-IF                                                   06143199
061432     END-IF.                                                      06143299
061433                                                                  06143399
061434     IF  ASTCD2L > ZERO                                           06143499
061435         MOVE ASTCD2I   TO ASC-SET-CODE-2                         06143599
061436     ELSE                                                         06143699
061437         IF  ASTCD2F = DP015-ERASE-EOF                            06143799
061438             MOVE SPACE  TO ASC-SET-CODE-2                        06143899
061439         END-IF                                                   06143999
061440     END-IF.                                                      06144099
061441                                                                  06144199
061442     IF  ASTYR2L > ZERO                                           06144299
061443         MOVE ASTYR2I   TO ASC-SET-YEAR-2                         06144399
061444     ELSE                                                         06144499
061445         IF  ASTYR2F = DP015-ERASE-EOF                            06144599
061446             MOVE SPACE  TO ASC-SET-YEAR-2                        06144699
061447         END-IF                                                   06144799
061448     END-IF.                                                      06144899
061449                                                                  06144999
061450     IF  ASTCD3L > ZERO                                           06145099
061451         MOVE ASTCD3I   TO ASC-SET-CODE-3                         06145199
061452     ELSE                                                         06145299
061453         IF  ASTCD3F = DP015-ERASE-EOF                            06145399
061454             MOVE SPACE  TO ASC-SET-CODE-3                        06145499
061455         END-IF                                                   06145599
061456     END-IF.                                                      06145699
061457                                                                  06145799
061458     IF  ASTYR3L > ZERO                                           06145899
061459         MOVE ASTYR3I   TO ASC-SET-YEAR-3                         06145999
061460     ELSE                                                         06146099
061461         IF  ASTYR3F = DP015-ERASE-EOF                            06146199
061462             MOVE SPACE  TO ASC-SET-YEAR-3                        06146299
061463         END-IF                                                   06146399
061464     END-IF.                                                      06146499
061465                                                                  06146599
061466     IF  ASTCD4L > ZERO                                           06146699
061467         MOVE ASTCD4I   TO ASC-SET-CODE-4                         06146799
061468     ELSE                                                         06146899
061469         IF  ASTCD4F = DP015-ERASE-EOF                            06146999
061470             MOVE SPACE  TO ASC-SET-CODE-4                        06147099
061471         END-IF                                                   06147199
061472     END-IF.                                                      06147299
061473                                                                  06147399
061474     IF  ASTYR4L > ZERO                                           06147499
061475         MOVE ASTYR4I   TO ASC-SET-YEAR-4                         06147599
061476     ELSE                                                         06147699
061477         IF  ASTYR4F = DP015-ERASE-EOF                            06147799
061478             MOVE SPACE  TO ASC-SET-YEAR-4                        06147899
061479         END-IF                                                   06147999
061480     END-IF.                                                      06148099
061481                                                                  06148199
061482     IF  ASTCD5L > ZERO                                           06148299
061483         MOVE ASTCD5I   TO ASC-SET-CODE-5                         06148399
061484     ELSE                                                         06148499
061485         IF  ASTCD5F = DP015-ERASE-EOF                            06148599
061486             MOVE SPACE  TO ASC-SET-CODE-5                        06148699
061487         END-IF                                                   06148799
061488     END-IF.                                                      06148899
061489                                                                  06148999
061490     IF  ASTYR5L > ZERO                                           06149099
061491         MOVE ASTYR5I   TO ASC-SET-YEAR-5                         06149199
061492     ELSE                                                         06149299
061493         IF  ASTYR5F = DP015-ERASE-EOF                            06149399
061494             MOVE SPACE  TO ASC-SET-YEAR-5                        06149499
061495         END-IF                                                   06149599
061496     END-IF.                                                      06149699
061497                                                                  06149799
061498     IF  ASTCD6L > ZERO                                           06149899
061499         MOVE ASTCD6I   TO ASC-SET-CODE-6                         06149999
061500     ELSE                                                         06150099
061501         IF  ASTCD6F = DP015-ERASE-EOF                            06150199
061502             MOVE SPACE  TO ASC-SET-CODE-6                        06150299
061503         END-IF                                                   06150399
061504     END-IF.                                                      06150499
061505                                                                  06150599
061506     IF  ASTYR6L > ZERO                                           06150699
061507         MOVE ASTYR6I   TO ASC-SET-YEAR-6                         06150799
061508     ELSE                                                         06150899
061509         IF  ASTYR6F = DP015-ERASE-EOF                            06150999
061510             MOVE SPACE  TO ASC-SET-YEAR-6                        06151099
061511         END-IF                                                   06151199
061512     END-IF.                                                      06151299
061513                                                                  06151399
061540                                                                  06154000
061600 3000-EDIT-DATA-IN-COMMAREA.                                      06160000
061700     PERFORM 3200-RESET-ATTRIBUTES.                               06170000
061800     PERFORM 3010-INITIAL-EDITS.                                  06180000
061900                                                                  06190000
062000     IF PS-NO-ERROR                                               06200000
062010         EVALUATE TRUE                                            06201000
062020             WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)          06202000
062040                  CONTINUE                                        06204000
062050             WHEN OTHER                                           06205000
062100                  PERFORM 3100-REMAINING-EDITS                    06210000
062110         END-EVALUATE                                             06211000
062200     END-IF.                                                      06220000
062300                                                                  06230000
062400     IF  PS-NO-ERROR                                              06240000
062500         MOVE -1                   TO ADPTNRL                     06250000
062600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      06260000
062700     END-IF.                                                      06270000
062800                                                                  06280000
062900 3010-INITIAL-EDITS.                                              06290000
063000     PERFORM 3025-CHK-RCVR-STAT.                                  06300000
063100     PERFORM 3030-CHK-RESP-AREA.                                  06310000
063200     PERFORM 3035-CHK-LIST-SEQ.                                   06320000
063300     PERFORM 3040-CHK-RCVR-SEQ.                                   06330000
063400     PERFORM 3045-CHK-PO-NBR.                                     06340000
063500     PERFORM 3055-CHK-BYR-NBR.                                    06350000
063600     PERFORM 3060-CHK-DEPT-NBR.                                   06360000
063700     PERFORM 3065-CHK-OPER-UNT.                                   06370000
063710     PERFORM 3070-CHK-SET-OPTIONS.                                06371099
063800                                                                  06380000
063900 3025-CHK-RCVR-STAT.                                              06390000
064000     IF (ASC-RCVR-STATUS-ARRIVED > SPACE) AND                     06400000
064100        (ASC-RCVR-STATUS-ENROUTE > SPACE)                         06410000
064200         SET PS-ERROR                                             06420000
064300             DP020-MSG-FATAL TO TRUE                              06430000
064400         MOVE PC-TSYMSG-01693 TO DP020-MSG-NUMBER                 06440000
064500         MOVE DP015-UNP-ALP-BRT-OFF TO ARCARVA                    06450000
064600                                       ARCENRA                    06460000
064700         MOVE DP015-RED             TO ARCARVC                    06470000
064800                               ARCENRC                            06480000
064900         MOVE DP015-REVERSE TO ARCARVH                            06490000
065000                               ARCENRH                            06500000
065100         MOVE -1                    TO ARCARVL                    06510000
065200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      06520000
065300     ELSE                                                         06530000
065400         IF ASC-RCVR-STATUS-ARRIVED > SPACE                       06540000
065500             IF ASC-RCVR-STATUS-ARRIVED NOT = 'S'                 06550000
065600                 SET PS-ERROR                                     06560000
065700                     DP020-MSG-FATAL TO TRUE                      06570000
065800                 MOVE PC-TSYMSG-00397 TO DP020-MSG-NUMBER         06580000
065900                 MOVE DP015-UNP-ALP-BRT-OFF TO ARCARVA            06590000
066000                 MOVE DP015-RED TO ARCARVC                        06600000
066100                 MOVE DP015-REVERSE TO ARCARVH                    06610000
066200                 MOVE -1              TO ARCARVL                  06620000
066300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              06630000
066400             ELSE                                                 06640000
066500                 SET PS-RCVR-STAT-ENTERED TO TRUE                 06650000
066600             END-IF                                               06660000
066700         END-IF                                                   06670000
066800         IF ASC-RCVR-STATUS-ENROUTE > SPACE                       06680000
066900             IF ASC-RCVR-STATUS-ENROUTE NOT = 'S'                 06690000
067000                 SET PS-ERROR                                     06700000
067100                     DP020-MSG-FATAL TO TRUE                      06710000
067200                 MOVE PC-TSYMSG-00397 TO DP020-MSG-NUMBER         06720000
067300                 MOVE DP015-UNP-ALP-BRT-OFF TO ARCENRA            06730000
067400                 MOVE DP015-RED TO ARCENRC                        06740000
067500                 MOVE DP015-REVERSE TO ARCENRH                    06750000
067600                 MOVE -1              TO ARCENRL                  06760000
067700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              06770000
067800             ELSE                                                 06780000
067900                 SET PS-RCVR-STAT-ENTERED TO TRUE                 06790000
068000             END-IF                                               06800000
068100         END-IF                                                   06810000
068200     END-IF.                                                      06820000
068300                                                                  06830000
068400 3030-CHK-RESP-AREA.                                              06840000
068500**** CHECK RESPONSIBILITY AREA  -- DEFAULT IS ALL TROUBLE OR CAN* 06850000
068600**** CHOOSE EITHER BUYER/ANALYST OR ONLY DC TROUBLE             * 06860000
068700**** RESPONSIBILITY AREA MAY BE SELECTED FOR F13, F20, F21, F22 * 06870000
068800****      IT MAY NOT BE SELECTED FOR ANY OTHER KEY    *********** 06880000
068900     IF (ASC-RA-BUYER-ANALYST > SPACES)                           06890000
069000         IF ASC-RA-BUYER-ANALYST NOT = 'S'                        06900000
069100             SET PS-ERROR                                         06910000
069200                 DP020-MSG-FATAL TO TRUE                          06920000
069300             MOVE PC-TSYMSG-00397 TO DP020-MSG-NUMBER             06930000
069400             MOVE DP015-UNP-ALP-BRT-OFF TO ABYANLA                06940000
069500             MOVE DP015-RED            TO ABYANLC                 06950000
069600             MOVE DP015-REVERSE TO ABYANLH                        06960000
069700             MOVE -1                   TO ABYANLL                 06970000
069800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06980000
069900         ELSE                                                     06990000
070000             IF ASC-RA-DC > SPACES                                07000000
070100                 SET PS-ERROR                                     07010000
070200                     DP020-MSG-FATAL TO TRUE                      07020000
070300                 MOVE PC-TSYMSG-01693 TO DP020-MSG-NUMBER         07030000
070400                 MOVE DP015-UNP-ALP-BRT-OFF TO ABYANLA            07040000
070500                                               ADCTRA             07050000
070600                 MOVE DP015-RED TO ABYANLC                        07060000
070700                                   ADCTRC                         07070000
070800                 MOVE DP015-REVERSE TO ABYANLH                    07080000
070900                                       ADCTRH                     07090000
071000                 MOVE -1                TO ABYANLL                07100000
071100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07110000
071200             END-IF                                               07120000
071300         END-IF                                                   07130000
071400     END-IF                                                       07140000
071500     IF (ASC-RA-DC > SPACES)                                      07150000
071600         IF ASC-RA-DC NOT = 'S'                                   07160000
071700             SET PS-ERROR                                         07170000
071800                 DP020-MSG-FATAL TO TRUE                          07180000
071900             MOVE PC-TSYMSG-00397 TO DP020-MSG-NUMBER             07190000
072000             MOVE DP015-UNP-ALP-BRT-OFF TO ADCTRA                 07200000
072100             MOVE DP015-RED            TO ADCTRC                  07210000
072200             MOVE DP015-REVERSE TO ADCTRH                         07220000
072300             MOVE -1                   TO ADCTRL                  07230000
072400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07240000
072500         END-IF                                                   07250000
072600     END-IF                                                       07260000
072700                                                                  07270000
072800     IF ((ASC-RA-BUYER-ANALYST > SPACES) OR                       07280000
072900          (ASC-RA-DC > SPACES)) AND PS-NO-ERROR                   07290000
073000         SET PS-RESP-AREA-ENTERED    TO TRUE                      07300000
073100     END-IF.                                                      07310000
073200                                                                  07320000
073300 3035-CHK-LIST-SEQ.                                               07330000
073400****** CHECK LIST SEQUENCE  *********************************     07340000
073500****** SEQUENCE MUST BE SELECTED FOR F20, F21 F22     *******     07350000
073600****** SEQUENCE MAY NOT BE SELECTED FOR ANY OTHER KEY *******     07360000
073700     IF (ASC-LS-ARRIVAL-DT = SPACES) AND                          07370000
073800        (ASC-LS-OLD-NEW-TRBL = SPACES)                            07380000
073900         SET PS-ERROR                                             07390000
074000             DP020-MSG-FATAL TO TRUE                              07400000
074100             MOVE PC-TSYMSG-01739 TO DP020-MSG-NUMBER             07410000
074200             MOVE DP015-UNP-ALP-BRT-OFF TO ASEQARA                07420000
074300                                           ASEQOTA                07430000
074400             MOVE DP015-RED TO ASEQARC                            07440000
074500                               ASEQOTC                            07450000
074600             MOVE DP015-REVERSE TO ASEQARH                        07460000
074700                                   ASEQOTH                        07470000
074800         MOVE -1                TO ASEQARL                        07480000
074900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      07490000
075000     END-IF                                                       07500000
075100     IF (ASC-LS-ARRIVAL-DT > SPACES)                              07510000
075200         IF ASC-LS-ARRIVAL-DT NOT = 'S'                           07520000
075300             SET PS-ERROR                                         07530000
075400                 DP020-MSG-FATAL TO TRUE                          07540000
075500             MOVE PC-TSYMSG-00397 TO DP020-MSG-NUMBER             07550000
075600             MOVE DP015-UNP-ALP-BRT-OFF TO ASEQARA                07560000
075700             MOVE DP015-RED            TO ASEQARC                 07570000
075800             MOVE DP015-REVERSE TO ASEQARH                        07580000
075900             MOVE -1                   TO ASEQARL                 07590000
076000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07600000
076100         ELSE                                                     07610000
076200             IF ASC-LS-OLD-NEW-TRBL > SPACES                      07620000
076300                 SET PS-ERROR                                     07630000
076400                     DP020-MSG-FATAL TO TRUE                      07640000
076500                 MOVE PC-TSYMSG-00973 TO DP020-MSG-NUMBER         07650000
076600                 MOVE DP015-UNP-ALP-BRT-OFF TO ASEQARA            07660000
076700                                               ASEQOTA            07670000
076800                 MOVE DP015-RED TO ASEQARC                        07680000
076900                                   ASEQOTC                        07690000
077000                 MOVE DP015-REVERSE TO ASEQARH                    07700000
077100                                       ASEQOTH                    07710000
077200                 MOVE -1                TO ASEQARL                07720000
077300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07730000
077400             END-IF                                               07740000
077500         END-IF                                                   07750000
077600     END-IF                                                       07760000
077700                                                                  07770000
077800     IF (ASC-LS-OLD-NEW-TRBL > SPACES)                            07780000
077900         IF ASC-LS-OLD-NEW-TRBL NOT = 'S'                         07790000
078000             SET PS-ERROR                                         07800000
078100                 DP020-MSG-FATAL TO TRUE                          07810000
078200             MOVE PC-TSYMSG-00397 TO DP020-MSG-NUMBER             07820000
078300             MOVE DP015-UNP-ALP-BRT-OFF TO ASEQOTA                07830000
078400             MOVE DP015-RED            TO ASEQOTC                 07840000
078500             MOVE DP015-REVERSE TO ASEQOTH                        07850000
078600             MOVE -1                   TO ASEQOTL                 07860000
078700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07870000
078800         END-IF                                                   07880000
078900     END-IF.                                                      07890000
079000                                                                  07900000
079100     IF (ASC-LS-ARRIVAL-DT > SPACES)                              07910000
079200     OR (ASC-LS-OLD-NEW-TRBL > SPACES)                            07920000
079300         SET PS-LIST-SEQ-ENTERED TO TRUE                          07930000
079400     END-IF.                                                      07940000
079500                                                                  07950000
079600                                                                  07960000
079700 3040-CHK-RCVR-SEQ.                                               07970000
079800**** CHECK RECEIVER SEQ. NBR                                      07980000
079900     IF (ASC-RCVR-SEQ-NBR > SPACE)                                07990000
080000         MOVE ASC-RCVR-SEQ-NBR TO DP010I-UNEDITED-FIELD           08000000
080100         MOVE LENGTH OF ASC-RCVR-SEQ-NBR                          08010000
080200                              TO DP010I-MAXIMUM-DIGITS            08020000
080300         MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS      08030000
080400         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08040000
080510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08051099
080520              USING DP010I-NUMERIC-EDIT-AREA                      08052099
080600         IF DP010I-ERROR-DETECTED                                 08060000
080700             SET PS-ERROR                                         08070000
080800                 DP020-MSG-FATAL TO TRUE                          08080000
080900             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             08090000
081000             MOVE DP015-UNP-ALP-BRT-OFF TO ARCVSQA                08100000
081100             MOVE DP015-RED TO ARCVSQC                            08110000
081200             MOVE DP015-REVERSE TO ARCVSQH                        08120000
081300             MOVE -1               TO ARCVSQL                     08130000
081400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08140000
081500         ELSE                                                     08150000
081600             MOVE DP010I-NUMERIC-FIELD                            08160000
081700                                TO ASC-RCVR-SEQ-NBR-N             08170000
081800             MOVE ASC-RCVR-SEQ-NBR-N                              08180000
081900                                TO DK-LOW-REC-SEQ-NBR             08190000
082000             MOVE ASC-RCVR-SEQ-NBR-N                              08200000
082100                                TO DK-HI-REC-SEQ-NBR              08210000
082200             SET PS-RCVR-SEQ-ENTERED TO TRUE                      08220000
082300         END-IF                                                   08230000
082400     END-IF.                                                      08240000
082500                                                                  08250000
082600 3045-CHK-PO-NBR.                                                 08260000
082700**** CHECK PO NUMBER                                              08270000
082800     IF (ASC-PO-NBR > SPACE)                                      08280000
082900         MOVE ASC-PO-NBR           TO DP010I-UNEDITED-FIELD       08290000
083000         MOVE LENGTH OF ASC-PO-NBR                                08300000
083100                               TO DP010I-MAXIMUM-DIGITS           08310000
083200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     08320000
083300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08330000
083410         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08341099
083420              USING DP010I-NUMERIC-EDIT-AREA                      08342099
083500         IF DP010I-ERROR-DETECTED                                 08350000
083600             SET PS-ERROR                                         08360000
083700                 DP020-MSG-FATAL TO TRUE                          08370000
083800             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             08380000
083900             MOVE DP015-UNP-ALP-BRT-OFF TO APONBRA                08390000
084000             MOVE DP015-RED TO APONBRC                            08400000
084100             MOVE DP015-REVERSE TO APONBRH                        08410000
084200             MOVE -1               TO APONBRL                     08420000
084300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08430000
084400         ELSE                                                     08440000
084500             MOVE DP010I-NUMERIC-FIELD TO ASC-PO-NBR-N            08450000
084600             MOVE ASC-PO-NBR-N TO DK-PO-NBR                       08460000
084700             SET PS-PO-NBR-ENTERED TO TRUE                        08470000
084800             IF ASC-RCVR-SEQ-NBR-N > 0                            08480000
084900                 CONTINUE                                         08490000
085000             ELSE                                                 08500000
085100                 MOVE PC-0000         TO DK-LOW-REC-SEQ-NBR       08510000
085200                 MOVE PC-9999         TO DK-HI-REC-SEQ-NBR        08520000
085300             END-IF                                               08530000
085400     END-IF.                                                      08540000
085500                                                                  08550000
085600                                                                  08560000
085700 3055-CHK-BYR-NBR.                                                08570000
085800********* CHECK FOR NUMERIC BUYER NUMBER                          08580000
085900     IF (ASC-BUYER-NBR > SPACES)                                  08590000
086000         MOVE ASC-BUYER-NBR            TO DP010I-UNEDITED-FIELD   08600000
086100         MOVE LENGTH OF ASC-BUYER-NBR                             08610000
086200                               TO DP010I-MAXIMUM-DIGITS           08620000
086300         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     08630000
086400         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08640000
086510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08651099
086520              USING DP010I-NUMERIC-EDIT-AREA                      08652099
086600         IF DP010I-ERROR-DETECTED                                 08660000
086700             SET PS-ERROR                                         08670000
086800                 DP020-MSG-FATAL TO TRUE                          08680000
086900             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             08690000
087000             MOVE DP015-UNP-ALP-BRT-OFF TO ABYRNRA                08700000
087100             MOVE DP015-RED TO ABYRNRC                            08710000
087200             MOVE DP015-REVERSE TO ABYRNRH                        08720000
087300             MOVE -1               TO ABYRNRL                     08730000
087400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08740000
087500         ELSE                                                     08750000
087600             MOVE DP010I-NUMERIC-FIELD TO ASC-BUYER-NBR-N         08760000
087700                                          DK-BYR-NBR-N            08770000
087800             SET PS-BUYR-NBR-ENTERED TO TRUE                      08780000
087900         END-IF                                                   08790000
088000     END-IF.                                                      08800000
088100                                                                  08810000
088200 3060-CHK-DEPT-NBR.                                               08820000
088300********* CHECK FOR NUMERIC DEPT NUMBER                           08830000
088400     IF (ASC-DEPT > SPACES)                                       08840000
088500         MOVE ASC-DEPT             TO DP010I-UNEDITED-FIELD       08850000
088600         MOVE LENGTH OF ASC-DEPT TO DP010I-MAXIMUM-DIGITS         08860000
088700         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     08870000
088800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08880000
088910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08891099
088920              USING DP010I-NUMERIC-EDIT-AREA                      08892099
089000         IF DP010I-ERROR-DETECTED                                 08900000
089100             SET PS-ERROR                                         08910000
089200                 DP020-MSG-FATAL TO TRUE                          08920000
089300             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             08930000
089400             MOVE DP015-UNP-ALP-BRT-OFF TO ADPTNRA                08940000
089500             MOVE DP015-RED TO ADPTNRC                            08950000
089600             MOVE DP015-REVERSE TO ADPTNRH                        08960000
089700             MOVE -1               TO ADPTNRL                     08970000
089800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08980000
089900         ELSE                                                     08990000
090000             MOVE DP010I-NUMERIC-FIELD TO ASC-DEPT-N              09000000
090100                                          DK-DEPT-NBR-N           09010000
090200             SET PS-DEPT-NBR-ENTERED TO TRUE                      09020000
090300         END-IF                                                   09030000
090400     END-IF.                                                      09040000
090500                                                                  09050000
090600 3065-CHK-OPER-UNT.                                               09060000
090700     IF  ASC-OPER-UNT-ID > SPACE                                  09070000
090800         MOVE ASC-OPER-UNT-ID      TO DP010I-UNEDITED-FIELD       09080000
090900         MOVE LENGTH OF ASC-OPER-UNT-ID  TO DP010I-MAXIMUM-DIGITS 09090000
091000         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09100000
091100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09110000
091210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09121099
091220              USING DP010I-NUMERIC-EDIT-AREA                      09122099
091300         IF  DP010I-ERROR-DETECTED                                09130000
091400             SET PS-ERROR                                         09140000
091500                 DP020-MSG-FATAL   TO TRUE                        09150000
091600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09160000
091700             MOVE DP015-UNP-ALP-BRT-OFF                           09170000
091800                                   TO AOPRIDA                     09180000
091900             MOVE DP015-RED        TO AOPRIDC                     09190000
092000             MOVE DP015-REVERSE    TO AOPRIDH                     09200000
092100             MOVE -1               TO AOPRIDL                     09210000
092200             MOVE SPACES           TO ASC-FCLTY-NME               09220000
092300                                      ASC-FCLTY-SHORT-NME         09230000
092400                                      AOPDESO                     09240000
092500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09250000
092600         ELSE                                                     09260000
092700             MOVE DP010I-NUMERIC-FIELD TO ASC-OPER-UNT-ID-N       09270000
092800             MOVE ASC-OPER-UNT-ID-N    TO DK-OPER-UNT-ID          09280000
092900             SET PS-OPER-UNT-ENTERED TO TRUE                      09290000
093000         END-IF                                                   09300000
093100      END-IF.                                                     09310000
093200                                                                  09320000
093201                                                                  09320199
093202*-----------------------------------------------------------------09320299
093203* EDIT OPTIONS SELECTED IN REGARD TO SEASONAL SET                -09320399
093207*-----------------------------------------------------------------09320799
093210 3070-CHK-SET-OPTIONS.                                            09321099
093220                                                                  09322099
093245* ONLY 1 OPTION CAN BE SELECTED (INCLUDE OR EXCLUDE)              09324599
093246                                                                  09324699
093247     IF  ASC-INCLD-SET   > SPACE  AND                             09324799
093248         ASC-EXCLD-SET   > SPACE                                  09324899
093255             SET PS-ERROR                                         09325599
093256                 DP020-MSG-FATAL   TO TRUE                        09325699
093257             MOVE PC-TSYMSG-00973  TO DP020-MSG-NUMBER            09325799
093258             MOVE DP015-UNP-ALP-BRT-OFF                           09325899
093259                                   TO AINCLDA                     09325999
093260                                      AEXCLDA                     09326099
093261             MOVE DP015-RED        TO AINCLDC                     09326199
093262                                      AEXCLDC                     09326299
093263             MOVE DP015-REVERSE    TO AINCLDH                     09326399
093264                                      AEXCLDH                     09326499
093265             MOVE -1               TO AINCLDL                     09326599
093269             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09326999
093275     END-IF.                                                      09327599
093276                                                                  09327699
093277      IF  PS-NO-ERROR                                             09327799
093279          IF  ASC-INCLD-SET-VALID                                 09327999
093280              CONTINUE                                            09328099
093281          ELSE                                                    09328199
093282              SET PS-ERROR                                        09328299
093283                  DP020-MSG-FATAL   TO TRUE                       09328399
093284              MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER           09328499
093285              MOVE DP015-UNP-ALP-BRT-OFF                          09328599
093286                                    TO AINCLDA                    09328699
093288              MOVE DP015-RED        TO AINCLDC                    09328899
093290              MOVE DP015-REVERSE    TO AINCLDH                    09329099
093292              MOVE -1               TO AINCLDL                    09329299
093293              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 09329399
093295         END-IF                                                   09329599
093297     END-IF.                                                      09329799
093298                                                                  09329899
093299     IF  PS-NO-ERROR                                              09329999
093301         IF  ASC-EXCLD-SET-VALID                                  09330199
093302              CONTINUE                                            09330299
093303          ELSE                                                    09330399
093304              SET PS-ERROR                                        09330499
093305                  DP020-MSG-FATAL   TO TRUE                       09330599
093306              MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER           09330699
093307              MOVE DP015-UNP-ALP-BRT-OFF                          09330799
093308                                    TO AEXCLDA                    09330899
093309              MOVE DP015-RED        TO AEXCLDC                    09330999
093310              MOVE DP015-REVERSE    TO AEXCLDH                    09331099
093311              MOVE -1               TO AEXCLDL                    09331199
093312              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 09331299
093314         END-IF                                                   09331499
093316     END-IF.                                                      09331699
093317                                                                  09331799
093318     IF  PS-NO-ERROR                                              09331899
093319         IF  ASC-SET-CODE-1  > SPACES  OR                         09331999
093320             ASC-SET-YEAR-1  > SPACES                             09332099
093321             SET PS-VALID-SET  TO  TRUE                           09332199
093322             MOVE ASC-SET-CODE-1 TO SEASET-SEASET-SHRT-NM         09332299
093323             MOVE ASC-SET-YEAR-1 TO SEASET-SEASET-YR              09332399
093324             PERFORM 3075-CHECK-TSEASET                           09332499
093325             IF  PS-VALID-SET                                     09332599
093326                 CONTINUE                                         09332699
093327             ELSE                                                 09332799
093328                  SET PS-ERROR                                    09332899
093329                      DP020-MSG-FATAL   TO TRUE                   09332999
093330                  MOVE PC-TSYMSG-03736  TO DP020-MSG-NUMBER       09333099
093331                  MOVE DP015-UNP-ALP-BRT-OFF                      09333199
093332                                        TO ASTCD1A                09333299
093333                                           ASTYR1A                09333399
093334                  MOVE DP015-RED        TO ASTCD1C                09333499
093335                                           ASTYR1C                09333599
093336                  MOVE DP015-REVERSE    TO ASTCD1H                09333699
093337                                           ASTYR1H                09333799
093338                  MOVE -1               TO ASTYR1L                09333899
093339                                           ASTCD1L                09333999
093340                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             09334099
093342             END-IF                                               09334299
093343         END-IF                                                   09334399
093344                                                                  09334499
093347         IF  ASC-SET-CODE-2  > SPACES  OR                         09334799
093348             ASC-SET-YEAR-2  > SPACES                             09334899
093349             SET PS-VALID-SET  TO  TRUE                           09334999
093350             MOVE ASC-SET-CODE-2 TO SEASET-SEASET-SHRT-NM         09335099
093351             MOVE ASC-SET-YEAR-2 TO SEASET-SEASET-YR              09335199
093352             PERFORM 3075-CHECK-TSEASET                           09335299
093353             IF  PS-VALID-SET                                     09335399
093354                 CONTINUE                                         09335499
093355             ELSE                                                 09335599
093356                  SET PS-ERROR                                    09335699
093357                      DP020-MSG-FATAL   TO TRUE                   09335799
093358                  MOVE PC-TSYMSG-03736  TO DP020-MSG-NUMBER       09335899
093359                  MOVE DP015-UNP-ALP-BRT-OFF                      09335999
093360                                        TO ASTCD2A                09336099
093361                                           ASTYR2A                09336199
093362                  MOVE DP015-RED        TO ASTCD2C                09336299
093363                                           ASTYR2C                09336399
093364                  MOVE DP015-REVERSE    TO ASTCD2H                09336499
093365                                           ASTYR2H                09336599
093366                  MOVE -1               TO ASTYR2L                09336699
093367                                           ASTCD2L                09336799
093368                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             09336899
093369             END-IF                                               09336999
093370         END-IF                                                   09337099
093371                                                                  09337199
093372         IF  ASC-SET-CODE-3  > SPACES  OR                         09337299
093373             ASC-SET-YEAR-3  > SPACES                             09337399
093374             SET PS-VALID-SET  TO  TRUE                           09337499
093375             MOVE ASC-SET-CODE-3 TO SEASET-SEASET-SHRT-NM         09337599
093376             MOVE ASC-SET-YEAR-3 TO SEASET-SEASET-YR              09337699
093377             PERFORM 3075-CHECK-TSEASET                           09337799
093378             IF  PS-VALID-SET                                     09337899
093379                 CONTINUE                                         09337999
093380             ELSE                                                 09338099
093381                  SET PS-ERROR                                    09338199
093382                      DP020-MSG-FATAL   TO TRUE                   09338299
093383                  MOVE PC-TSYMSG-03736  TO DP020-MSG-NUMBER       09338399
093384                  MOVE DP015-UNP-ALP-BRT-OFF                      09338499
093385                                        TO ASTCD3A                09338599
093386                                           ASTYR3A                09338699
093387                  MOVE DP015-RED        TO ASTCD3C                09338799
093388                                           ASTYR3C                09338899
093389                  MOVE DP015-REVERSE    TO ASTCD3H                09338999
093390                                           ASTYR3H                09339099
093391                  MOVE -1               TO ASTYR3L                09339199
093392                                           ASTCD3L                09339299
093393                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             09339399
093394             END-IF                                               09339499
093395         END-IF                                                   09339599
093396                                                                  09339699
093397         IF  ASC-SET-CODE-4  > SPACES  OR                         09339799
093398             ASC-SET-YEAR-4  > SPACES                             09339899
093399             SET PS-VALID-SET  TO  TRUE                           09339999
093400             MOVE ASC-SET-CODE-4 TO SEASET-SEASET-SHRT-NM         09340099
093401             MOVE ASC-SET-YEAR-4 TO SEASET-SEASET-YR              09340199
093402             PERFORM 3075-CHECK-TSEASET                           09340299
093403             IF  PS-VALID-SET                                     09340399
093404                 CONTINUE                                         09340499
093405             ELSE                                                 09340599
093406                  SET PS-ERROR                                    09340699
093407                      DP020-MSG-FATAL   TO TRUE                   09340799
093408                  MOVE PC-TSYMSG-03736  TO DP020-MSG-NUMBER       09340899
093409                  MOVE DP015-UNP-ALP-BRT-OFF                      09340999
093410                                        TO ASTCD4A                09341099
093411                                           ASTYR4A                09341199
093412                  MOVE DP015-RED        TO ASTCD4C                09341299
093413                                           ASTYR4C                09341399
093414                  MOVE DP015-REVERSE    TO ASTCD4H                09341499
093415                                           ASTYR4H                09341599
093416                  MOVE -1               TO ASTYR4L                09341699
093417                                           ASTCD4L                09341799
093418                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             09341899
093419             END-IF                                               09341999
093420         END-IF                                                   09342099
093421                                                                  09342199
093422         IF  ASC-SET-CODE-5  > SPACES  OR                         09342299
093423             ASC-SET-YEAR-5  > SPACES                             09342399
093424             SET PS-VALID-SET  TO  TRUE                           09342499
093425             MOVE ASC-SET-CODE-5 TO SEASET-SEASET-SHRT-NM         09342599
093426             MOVE ASC-SET-YEAR-5 TO SEASET-SEASET-YR              09342699
093427             PERFORM 3075-CHECK-TSEASET                           09342799
093428             IF  PS-VALID-SET                                     09342899
093429                 CONTINUE                                         09342999
093430             ELSE                                                 09343099
093431                  SET PS-ERROR                                    09343199
093432                      DP020-MSG-FATAL   TO TRUE                   09343299
093433                  MOVE PC-TSYMSG-03736  TO DP020-MSG-NUMBER       09343399
093434                  MOVE DP015-UNP-ALP-BRT-OFF                      09343499
093435                                        TO ASTCD5A                09343599
093436                                           ASTYR5A                09343699
093437                  MOVE DP015-RED        TO ASTCD5C                09343799
093438                                           ASTYR5C                09343899
093439                  MOVE DP015-REVERSE    TO ASTCD5H                09343999
093440                                           ASTYR5H                09344099
093441                  MOVE -1               TO ASTYR5L                09344199
093442                                           ASTCD5L                09344299
093443                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             09344399
093444             END-IF                                               09344499
093445         END-IF                                                   09344599
093446                                                                  09344699
093447         IF  ASC-SET-CODE-6  > SPACES  OR                         09344799
093448             ASC-SET-YEAR-6  > SPACES                             09344899
093449             SET PS-VALID-SET  TO  TRUE                           09344999
093450             MOVE ASC-SET-CODE-6 TO SEASET-SEASET-SHRT-NM         09345099
093451             MOVE ASC-SET-YEAR-6 TO SEASET-SEASET-YR              09345199
093452             PERFORM 3075-CHECK-TSEASET                           09345299
093453             IF  PS-VALID-SET                                     09345399
093454                 CONTINUE                                         09345499
093455             ELSE                                                 09345599
093456                  SET PS-ERROR                                    09345699
093457                      DP020-MSG-FATAL   TO TRUE                   09345799
093458                  MOVE PC-TSYMSG-03736  TO DP020-MSG-NUMBER       09345899
093459                  MOVE DP015-UNP-ALP-BRT-OFF                      09345999
093460                                        TO ASTCD6A                09346099
093461                                           ASTYR6A                09346199
093462                  MOVE DP015-RED        TO ASTCD6C                09346299
093463                                           ASTYR6C                09346399
093464                  MOVE DP015-REVERSE    TO ASTCD6H                09346499
093465                                           ASTYR6H                09346599
093466                  MOVE -1               TO ASTYR6L                09346699
093467                                           ASTCD6L                09346799
093468                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             09346899
093469             END-IF                                               09346999
093470         END-IF                                                   09347099
093471     END-IF.                                                      09347199
093484                                                                  09348499
093485     IF  PS-NO-ERROR                                              09348599
093486         IF  ASC-INCLD-SET   > SPACE  AND                         09348699
093487             ASC-SET-CODE-1  = SPACES AND                         09348799
093488             ASC-SET-YEAR-1  = SPACES AND                         09348899
093489             ASC-SET-CODE-2  = SPACES AND                         09348999
093490             ASC-SET-YEAR-2  = SPACES AND                         09349099
093491             ASC-SET-CODE-3  = SPACES AND                         09349199
093492             ASC-SET-YEAR-3  = SPACES AND                         09349299
093493             ASC-SET-CODE-4  = SPACES AND                         09349399
093494             ASC-SET-YEAR-4  = SPACES AND                         09349499
093495             ASC-SET-CODE-5  = SPACES AND                         09349599
093496             ASC-SET-YEAR-5  = SPACES AND                         09349699
093497             ASC-SET-CODE-6  = SPACES AND                         09349799
093498             ASC-SET-YEAR-6  = SPACES                             09349899
093499                 SET PS-ERROR                                     09349999
093500                     DP020-MSG-FATAL   TO TRUE                    09350099
093501                 MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER        09350199
093502                 MOVE DP015-UNP-ALP-BRT-OFF                       09350299
093503                                       TO ASTCD1A                 09350399
093504                                          ASTYR1A                 09350499
093505                                          AINCLDA                 09350599
093506                 MOVE DP015-RED        TO ASTCD1C                 09350699
093507                                          ASTYR1C                 09350799
093508                 MOVE DP015-REVERSE    TO ASTCD1H                 09350899
093509                                          ASTYR1H                 09350999
093510                 MOVE -1               TO ASTYR1L                 09351099
093511                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09351199
093512         END-IF                                                   09351299
093513     END-IF.                                                      09351399
093514                                                                  09351499
093515     IF  PS-NO-ERROR                                              09351599
093516         IF  ASC-EXCLD-SET   > SPACE  AND                         09351699
093517             ASC-SET-CODE-1  = SPACES AND                         09351799
093518             ASC-SET-YEAR-1  = SPACES AND                         09351899
093519             ASC-SET-CODE-2  = SPACES AND                         09351999
093520             ASC-SET-YEAR-2  = SPACES AND                         09352099
093521             ASC-SET-CODE-3  = SPACES AND                         09352199
093522             ASC-SET-YEAR-3  = SPACES AND                         09352299
093523             ASC-SET-CODE-4  = SPACES AND                         09352399
093524             ASC-SET-YEAR-4  = SPACES AND                         09352499
093525             ASC-SET-CODE-5  = SPACES AND                         09352599
093526             ASC-SET-YEAR-5  = SPACES AND                         09352699
093527             ASC-SET-CODE-6  = SPACES AND                         09352799
093528             ASC-SET-YEAR-6  = SPACES                             09352899
093529                 SET PS-ERROR                                     09352999
093530                     DP020-MSG-FATAL   TO TRUE                    09353099
093531                 MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER        09353199
093532                 MOVE DP015-UNP-ALP-BRT-OFF                       09353299
093533                                       TO ASTCD1A                 09353399
093534                                          ASTYR1A                 09353499
093535                                          AEXCLDA                 09353599
093536                 MOVE DP015-RED        TO ASTCD1C                 09353699
093537                                          ASTYR1C                 09353799
093538                 MOVE DP015-REVERSE    TO ASTCD1H                 09353899
093539                                          ASTYR1H                 09353999
093540                 MOVE -1               TO ASTYR1L                 09354099
093541                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09354199
093542          END-IF                                                  09354299
093543      END-IF.                                                     09354399
093544                                                                  09354499
093545                                                                  09354599
093546     IF  PS-NO-ERROR                                              09354699
093547         IF  (ASC-INCLD-SET  = SPACE  AND                         09354799
093548              ASC-EXCLD-SET  = SPACE)      AND                    09354899
093549             (ASC-SET-CODE-1  > SPACES OR                         09354999
093550              ASC-SET-YEAR-1  > SPACES OR                         09355099
093551              ASC-SET-CODE-2  > SPACES OR                         09355199
093552              ASC-SET-YEAR-2  > SPACES OR                         09355299
093553              ASC-SET-CODE-3  > SPACES OR                         09355399
093554              ASC-SET-YEAR-3  > SPACES OR                         09355499
093555              ASC-SET-CODE-4  > SPACES OR                         09355599
093556              ASC-SET-YEAR-4  > SPACES OR                         09355699
093557              ASC-SET-CODE-5  > SPACES OR                         09355799
093558              ASC-SET-YEAR-5  > SPACES OR                         09355899
093559              ASC-SET-CODE-6  > SPACES OR                         09355999
093560              ASC-SET-YEAR-6  > SPACES)                           09356099
093561                 SET PS-ERROR                                     09356199
093562                     DP020-MSG-FATAL   TO TRUE                    09356299
093563                 MOVE PC-TSYMSG-03822  TO DP020-MSG-NUMBER        09356399
093570                 MOVE DP015-UNP-ALP-BRT-OFF                       09357099
093571                                       TO AINCLDA                 09357199
093572                                          AEXCLDA                 09357299
093574                 MOVE DP015-RED        TO AINCLDC                 09357499
093575                                          AEXCLDC                 09357599
093576                 MOVE DP015-REVERSE    TO AINCLDH                 09357699
093577                                          AEXCLDH                 09357799
093578                 MOVE -1               TO AINCLDL                 09357899
093579                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09357999
093580          END-IF                                                  09358099
093581      END-IF.                                                     09358199
093582                                                                  09358299
093583                                                                  09358399
093584 3075-CHECK-TSEASET.                                              09358499
093585                                                                  09358599
093586     PERFORM                                                      09358699
093587         WITH TEST AFTER                                          09358799
093588         VARYING PV-RETRY-COUNTER                                 09358899
093589         FROM 1 BY 1                                              09358999
093590         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09359099
093591                   OR (SQLCODE = ZERO OR +100 OR -811))           09359199
093592*                                                                 09359299
093593         EXEC SQL                                                 09359399
093594             SELECT SEASET_STAT_CDE                               09359499
093595               INTO :SEASET-SEASET-STAT-CDE                       09359599
093596               FROM TSEASET                                       09359699
093597              WHERE SEASET_YR      =  :SEASET-SEASET-YR           09359799
093598                AND SEASET_SHRT_NM =  :SEASET-SEASET-SHRT-NM      09359899
093599               WITH UR                                            09359999
093600         END-EXEC                                                 09360099
093601                                                                  09360199
093602         EVALUATE TRUE                                            09360299
093603             WHEN SQLCODE = ZERO                                  09360399
093604                 SET  PS-VALID-SET  TO  TRUE                      09360499
093605             WHEN SQLCODE = +100                                  09360599
093606                 SET  PS-VALID-SET-NO  TO  TRUE                   09360699
093607             WHEN SQLCODE = -904                                  09360799
093608             WHEN SQLCODE = -913                                  09360899
093609                 CONTINUE                                         09360999
093610             WHEN SQLWARN0 NOT = SPACE                            09361099
093611             WHEN SQLCODE NOT = ZERO                              09361199
093612                 SET PS-SEVERE-ERROR TO TRUE                      09361299
093613                 MOVE '3075-CHECK-TSEASET' TO DP013-PARAGRAPH     09361399
093614                 MOVE 'SELECT SEASONAL SET  '                     09361499
093615                                      TO DP013-MESSAGE-TEXT (1)   09361599
093616                 MOVE SQLCA           TO DP013-SQLCA              09361699
093617                 MOVE 'TSEASET '      TO DP013-DB2-TABLE-NAME (1) 09361799
093618                 SET DP013-DB2-ABEND                              09361899
093619                     DP013-NO-ROLLBACK                            09361999
093620                     DP013-LINK-RETURN TO TRUE                    09362099
093621                 PERFORM DP013-0000-PROCESS-ABEND                 09362199
093622         END-EVALUATE                                             09362299
093623     END-PERFORM.                                                 09362399
093624                                                                  09362499
093625     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09362599
093626         SET PS-RETRY-EXCEEDED TO TRUE                            09362699
093627         MOVE '3075-CHECK-TSEASET' TO DP013-PARAGRAPH             09362799
093628         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     09362899
093629                                   TO DP013-MESSAGE-TEXT (1)      09362999
093630         MOVE SQLCA                TO DP013-SQLCA                 09363099
093631         MOVE 'TSEASET '           TO DP013-DB2-TABLE-NAME (1)    09363199
093632         SET DP013-DB2-ABEND                                      09363299
093633             DP013-NO-ROLLBACK                                    09363399
093634             DP013-LINK-RETURN TO TRUE                            09363499
093635         PERFORM DP013-0000-PROCESS-ABEND                         09363599
093636     END-IF.                                                      09363699
093637                                                                  09363799
093638                                                                  09363899
093639                                                                  09363999
093640**** FURTHER EDITS FOR RELATIONSHIP BETWEEN FIELDS OR             09364099
093641**** IF A FIELD ENTERED IS VALID FOR F-KEY PRESSED                09364199
093642 3100-REMAINING-EDITS.                                            09364299
093650     IF PS-OPER-UNT-ENTERED                                       09365000
093700         PERFORM 3110-CHK2-OPER-UNT.                              09370000
093800                                                                  09380000
093900     PERFORM 3115-CHK2-DEPT-BYR-PO-REL.                           09390000
094000                                                                  09400000
094100     IF PS-DEPT-NBR-ENTERED OR                                    09410000
094200        PS-BUYR-NBR-ENTERED OR                                    09420000
094300        PS-PO-NBR-ENTERED OR                                      09430000
094400        PS-RCVR-SEQ-ENTERED                                       09440000
094500         IF PS-PO-NBR-ENTERED OR                                  09450000
094600            PS-RCVR-SEQ-ENTERED                                   09460000
094700            PERFORM 3120-CHK2-PO-RCVR-SEQ                         09470000
094800         END-IF                                                   09480000
094900         IF PS-DEPT-NBR-ENTERED                                   09490000
095000             PERFORM 3125-VALIDATE-DEPT-NBR                       09500000
095100         END-IF                                                   09510000
095200         IF PS-BUYR-NBR-ENTERED                                   09520000
095300             PERFORM 3130-VALIDATE-BUYR-NBR                       09530000
095400         END-IF                                                   09540000
095500     END-IF.                                                      09550000
095600                                                                  09560000
095700     EVALUATE TRUE                                                09570000
095800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09580000
095900             IF PS-PO-NBR-ENTERED                                 09590000
096000                 CONTINUE                                         09600000
096100             ELSE                                                 09610000
096200                 SET PS-ERROR                                     09620000
096300                     DP020-MSG-FATAL TO TRUE                      09630000
096400                 MOVE PC-TSYMSG-01698 TO DP020-MSG-NUMBER         09640000
096500                 MOVE DP015-UNP-ALP-BRT-OFF TO APONBRA            09650000
096600                 MOVE DP015-RED TO APONBRC                        09660000
096700                 MOVE DP015-REVERSE TO APONBRH                    09670000
096800                 MOVE -1            TO APONBRL                    09680000
096900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09690000
097000             END-IF                                               09700000
097100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09710000
097200             PERFORM 3140-CHK2-LIST-SEQ                           09720000
097300             PERFORM 3145-CHK2-VALID-OPTIONS                      09730000
097400         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09740000
097500             PERFORM 3140-CHK2-LIST-SEQ                           09750000
097600             PERFORM 3145-CHK2-VALID-OPTIONS                      09760000
097700         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              09770000
097800             PERFORM 3140-CHK2-LIST-SEQ                           09780000
097900             PERFORM 3150-CHK2-VALID-ALL-TRBL                     09790000
098000         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              09800000
098100             PERFORM 3155-CHK2-RCVR-ITEM-LIST                     09810000
098200         WHEN OTHER                                               09820000
098300             CONTINUE                                             09830000
098400     END-EVALUATE.                                                09840000
098500                                                                  09850000
098600 3110-CHK2-OPER-UNT.                                              09860000
098700     IF ASC-OPER-UNT-ID-N = PV-SAVE-OPER-UNT                      09870000
098800         CONTINUE                                                 09880000
098900     ELSE                                                         09890000
099000         SET PS-NOT-DEFAULT-OPER-UNT TO TRUE                      09900000
099100     END-IF                                                       09910000
099200     IF PS-DEFAULT-OPER-UNT                                       09920000
099300         CONTINUE                                                 09930000
099400     ELSE                                                         09940000
099500*********** IF OPER UNIT CHANGED FROM DEFAULT, VALIDATE NEW ONE   09950000
099600         IF ASC-OPER-UNT-ID = SPACES                              09960000
099700             CONTINUE                                             09970000
099800         ELSE                                                     09980000
099900             PERFORM 3300-VALIDATE-OPER-UNT-ID                    09990000
100000             IF PS-ERROR                                          10000000
100100                 SET DP020-MSG-FATAL           TO TRUE            10010000
100200                 MOVE PC-TSYMSG-01741 TO DP020-MSG-NUMBER         10020000
100300                 MOVE DP015-UNP-ALP-BRT-OFF TO AOPRIDA            10030000
100400                 MOVE DP015-RED                TO AOPRIDC         10040000
100500                 MOVE DP015-REVERSE            TO AOPRIDH         10050000
100600                 MOVE -1                       TO AOPRIDL         10060000
100700                 MOVE SPACES                   TO ASC-FCLTY-NME   10070000
100800                                      ASC-FCLTY-SHORT-NME         10080000
100900                                          AOPDESO                 10090000
101000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10100000
101100             ELSE                                                 10110000
101200                 MOVE ASC-OPER-UNT-ID-N TO AOPRIDO                10120000
101300                                           DK-OPER-UNT-ID         10130000
101400             END-IF                                               10140000
101500         END-IF                                                   10150000
101600     END-IF.                                                      10160000
101700                                                                  10170000
101800 3115-CHK2-DEPT-BYR-PO-REL.                                       10180000
101900** CHECK IF OPERATING UNIT IS BLANK AND                           10190000
102000** DEPT, BUYER & PO ARE BLANK                                     10200000
102100     IF (ASC-OPER-UNT-ID  = SPACES) AND                           10210000
102200          ((ASC-DEPT = SPACES) AND                                10220000
102300            (ASC-BUYER-NBR = SPACES) AND                          10230000
102400            (ASC-PO-NBR = SPACES))                                10240000
102500         SET PS-ERROR                                             10250000
102600             DP020-MSG-FATAL TO TRUE                              10260000
102700         MOVE PC-TSYMSG-01698 TO DP020-MSG-NUMBER                 10270000
102800         MOVE DP015-UNP-ALP-BRT-OFF TO ADPTNRA                    10280000
102900                                       ABYRNRA                    10290000
103000                                       APONBRA                    10300000
103100                                       AOPRIDA                    10310000
103200         MOVE DP015-RED             TO ADPTNRC                    10320000
103300                                       ABYRNRC                    10330000
103400                                       APONBRC                    10340000
103500                                       AOPRIDC                    10350000
103600         MOVE DP015-REVERSE TO ADPTNRH                            10360000
103700                               ABYRNRH                            10370000
103800                               APONBRH                            10380000
103900                               AOPRIDH                            10390000
104000         MOVE -1                TO AOPRIDL                        10400000
104100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10410000
104200     END-IF                                                       10420000
104300                                                                  10430000
104400** IF SELECTED, ONLY ONE MAY BE SELECTED                          10440000
104500** CHECK IF DEPT, BUYER & PO ARE > SPACES                         10450000
104600         IF (ASC-DEPT > SPACES) AND                               10460000
104700            (ASC-BUYER-NBR > SPACES) AND                          10470000
104800            (ASC-PO-NBR > SPACES)                                 10480000
104900             SET PS-ERROR                                         10490000
105000                 DP020-MSG-FATAL TO TRUE                          10500000
105100             MOVE PC-TSYMSG-01693 TO DP020-MSG-NUMBER             10510000
105200             MOVE DP015-UNP-ALP-BRT-OFF TO ADPTNRA                10520000
105300                                           ABYRNRA                10530000
105400                                           APONBRA                10540000
105500             MOVE DP015-RED         TO ADPTNRC                    10550000
105600                                       ABYRNRC                    10560000
105700                                       APONBRC                    10570000
105800             MOVE DP015-REVERSE TO ADPTNRH                        10580000
105900                                   ABYRNRH                        10590000
106000                                   APONBRH                        10600000
106100             MOVE -1            TO ADPTNRL                        10610000
106200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10620000
106300         END-IF                                                   10630000
106400                                                                  10640000
106500** CHECK IF DEPT AND BUYER ARE ENTERED                            10650000
106600         IF (ASC-DEPT > SPACES) AND                               10660000
106700            (ASC-BUYER-NBR > SPACES) AND                          10670000
106800            (ASC-PO-NBR = SPACES)                                 10680000
106900             SET PS-ERROR                                         10690000
107000                 DP020-MSG-FATAL TO TRUE                          10700000
107100             MOVE PC-TSYMSG-01693 TO DP020-MSG-NUMBER             10710000
107200             MOVE DP015-UNP-ALP-BRT-OFF TO ADPTNRA                10720000
107300                                           ABYRNRA                10730000
107400             MOVE DP015-RED TO ADPTNRC                            10740000
107500                               ABYRNRC                            10750000
107600             MOVE DP015-REVERSE TO ADPTNRH                        10760000
107700                                   ABYRNRH                        10770000
107800             MOVE -1           TO ADPTNRL                         10780000
107900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10790000
108000         END-IF                                                   10800000
108100                                                                  10810000
108200** CHECK IF DEPT AND PO ARE ENTERED                               10820000
108300         IF (ASC-DEPT > SPACES) AND                               10830000
108400            (ASC-BUYER-NBR = SPACES) AND                          10840000
108500            (ASC-PO-NBR > SPACES)                                 10850000
108600             SET PS-ERROR                                         10860000
108700                 DP020-MSG-FATAL TO TRUE                          10870000
108800             MOVE PC-TSYMSG-01693 TO DP020-MSG-NUMBER             10880000
108900             MOVE DP015-UNP-ALP-BRT-OFF TO ADPTNRA                10890000
109000                                           APONBRA                10900000
109100             MOVE DP015-RED TO ADPTNRC                            10910000
109200                               APONBRC                            10920000
109300             MOVE DP015-REVERSE TO ADPTNRH                        10930000
109400                                   APONBRH                        10940000
109500             MOVE -1           TO ADPTNRL                         10950000
109600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10960000
109700         END-IF                                                   10970000
109800                                                                  10980000
109900** CHECK IF BUYER AND PO ARE ENTERED                              10990000
110000         IF (ASC-DEPT = SPACES) AND                               11000000
110100            (ASC-BUYER-NBR > SPACES) AND                          11010000
110200            (ASC-PO-NBR > SPACES)                                 11020000
110300             SET PS-ERROR                                         11030000
110400                 DP020-MSG-FATAL TO TRUE                          11040000
110500             MOVE PC-TSYMSG-01693 TO DP020-MSG-NUMBER             11050000
110600             MOVE DP015-UNP-ALP-BRT-OFF TO ABYRNRA                11060000
110700                                           APONBRA                11070000
110800             MOVE DP015-RED TO ABYRNRC                            11080000
110900                               APONBRC                            11090000
111000             MOVE DP015-REVERSE TO ABYRNRH                        11100000
111100                                   APONBRH                        11110000
111200             MOVE -1           TO ABYRNRL                         11120000
111300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11130000
111400         END-IF.                                                  11140000
111500                                                                  11150000
111600 3120-CHK2-PO-RCVR-SEQ.                                           11160000
111700     PERFORM 3600-SELECT-PO                                       11170000
111800     IF PS-PO-RCVR-NOT-FOUND                                      11180000
111900         SET PS-ERROR                                             11190000
112000             DP020-MSG-FATAL TO TRUE                              11200000
112100             MOVE PC-TSYMSG-01772 TO DP020-MSG-NUMBER             11210000
112200         IF PS-PO-NBR-ENTERED                                     11220000
112300             MOVE DP015-UNP-ALP-BRT-OFF TO APONBRA                11230000
112400             MOVE DP015-RED TO APONBRC                            11240000
112500             MOVE DP015-REVERSE TO APONBRH                        11250000
112600             MOVE -1                TO APONBRL                    11260000
112700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11270000
112800         END-IF                                                   11280000
112900         IF PS-RCVR-SEQ-ENTERED                                   11290000
113000             MOVE DP015-UNP-ALP-BRT-OFF TO ARCVSQA                11300000
113100             MOVE DP015-RED TO ARCVSQC                            11310000
113200             MOVE DP015-REVERSE TO ARCVSQH                        11320000
113300             MOVE -1                TO ARCVSQL                    11330000
113400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11340000
113500         END-IF                                                   11350000
113600     END-IF                                                       11360000
113700     IF PS-RETRY-EXCEEDED                                         11370000
113800         SET PS-ERROR                                             11380000
113900             DP020-MSG-FATAL TO TRUE                              11390000
114000         MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER                 11400000
114100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      11410000
114200     END-IF                                                       11420000
114300     IF PS-SEVERE-ERROR                                           11430000
114400         SET PS-ERROR                                             11440000
114500             DP020-MSG-FATAL TO TRUE                              11450000
114600         MOVE PC-TSYMSG-01570 TO DP020-MSG-NUMBER                 11460000
114700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      11470000
114800     END-IF                                                       11480000
114900     IF ASC-PO-NBR = SPACES OR ZEROS                              11490000
115000         SET PS-ERROR                                             11500000
115100             DP020-MSG-FATAL TO TRUE                              11510000
115200         MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER                 11520000
115300         MOVE DP015-UNP-ALP-BRT-OFF TO APONBRA                    11530000
115400         MOVE DP015-RED TO APONBRC                                11540000
115500         MOVE DP015-REVERSE TO APONBRH                            11550000
115600         MOVE -1                    TO APONBRL                    11560000
115700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      11570000
115800     END-IF.                                                      11580000
115900                                                                  11590000
116000 3125-VALIDATE-DEPT-NBR.                                          11600000
116100****** DOES THE ENTERED DEPARTMENT NUMBER ACTUALLY EXIST          11610000
116200     INITIALIZE PV-DB2-COUNT                                      11620000
116300     PERFORM 3700-COUNT-DEPT                                      11630000
116400     IF PV-DB2-COUNT = +0                                         11640000
116500         SET PS-ERROR                                             11650000
116600             DP020-MSG-FATAL TO TRUE                              11660000
116700             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             11670000
116800             MOVE DP015-UNP-ALP-BRT-OFF TO ADPTNRA                11680000
116900             MOVE DP015-RED TO ADPTNRC                            11690000
117000             MOVE DP015-REVERSE TO ADPTNRH                        11700000
117100             MOVE -1            TO ADPTNRL                        11710000
117200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11720000
117300     END-IF.                                                      11730000
117400 3130-VALIDATE-BUYR-NBR.                                          11740000
117500****** DOES THE ENTERED BUYER NUMBER ACTUALLY EXIST               11750000
117600     INITIALIZE PV-DB2-COUNT                                      11760000
117700     PERFORM 3750-COUNT-BUYR                                      11770000
117800     IF PV-DB2-COUNT = +0                                         11780099
117900         SET PS-ERROR                                             11790000
118000             DP020-MSG-FATAL TO TRUE                              11800000
118100             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             11810000
118200             MOVE DP015-UNP-ALP-BRT-OFF TO ABYRNRA                11820000
118300             MOVE DP015-RED TO ABYRNRC                            11830000
118400             MOVE DP015-REVERSE TO ABYRNRH                        11840000
118500             MOVE -1            TO ABYRNRL                        11850000
118600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11860000
118700     END-IF.                                                      11870000
118800                                                                  11880000
118900 3140-CHK2-LIST-SEQ.                                              11890000
119000     IF PS-LIST-SEQ-ENTERED                                       11900000
119100         CONTINUE                                                 11910000
119200     ELSE                                                         11920000
119300         SET PS-ERROR                                             11930000
119400             DP020-MSG-FATAL TO TRUE                              11940000
119500         MOVE PC-TSYMSG-01739 TO DP020-MSG-NUMBER                 11950000
119600         MOVE DP015-UNP-ALP-BRT-OFF TO ASEQARA                    11960000
119700                                       ASEQOTA                    11970000
119800         MOVE DP015-RED TO ASEQARC                                11980000
119900                           ASEQOTC                                11990000
120000         MOVE DP015-REVERSE TO ASEQARH                            12000000
120100                               ASEQOTH                            12010000
120200         MOVE -1                    TO ASEQARL                    12020000
120300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      12030000
120400     END-IF.                                                      12040000
120500                                                                  12050000
120600 3145-CHK2-VALID-OPTIONS.                                         12060000
120700     IF PS-OPER-UNT-ENTERED OR                                    12070000
120800        PS-DEPT-NBR-ENTERED OR                                    12080000
120900        PS-BUYR-NBR-ENTERED OR                                    12090000
121000        PS-PO-NBR-ENTERED                                         12100000
121100         CONTINUE                                                 12110000
121200     ELSE                                                         12120000
121300         SET PS-ERROR                                             12130000
121400             DP020-MSG-FATAL TO TRUE                              12140000
121500         MOVE PC-TSYMSG-01698 TO DP020-MSG-NUMBER                 12150000
121600         MOVE DP015-UNP-ALP-BRT-OFF TO AOPRIDA                    12160000
121700                                       ADPTNRA                    12170000
121800                                       ABYRNRA                    12180000
121900                                       APONBRA                    12190000
122000         MOVE DP015-RED         TO AOPRIDC                        12200000
122100                                   ADPTNRC                        12210000
122200                                   ABYRNRC                        12220000
122300                                   APONBRC                        12230000
122400         MOVE DP015-REVERSE TO AOPRIDH                            12240000
122500                               ADPTNRH                            12250000
122600                               ABYRNRH                            12260000
122700                               APONBRH                            12270000
122800         MOVE -1                TO ADPTNRL                        12280000
122900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      12290000
123000     END-IF.                                                      12300000
123100                                                                  12310000
123200******************************************************************12320000
123300**** DEPT. OR PO MUST BE ENTERED IF 'ALL TRBL' LIST FKEY USED    *12330000
123400******************************************************************12340000
123500 3150-CHK2-VALID-ALL-TRBL.                                        12350000
123600     IF PS-DEPT-NBR-ENTERED OR                                    12360000
123700        PS-PO-NBR-ENTERED                                         12370000
123800         CONTINUE                                                 12380000
123900     ELSE                                                         12390000
124000         PERFORM 3152-NON-VALID-ENTRIES                           12400000
124100     END-IF.                                                      12410000
124200                                                                  12420000
124300 3152-NON-VALID-ENTRIES.                                          12430000
124400     IF  PS-DEPT-NBR-NOT-ENTERED OR                               12440000
124500         PS-PO-NBR-NOT-ENTERED                                    12450000
124600             SET PS-ERROR                                         12460000
124700                 DP020-MSG-FATAL TO TRUE                          12470000
124800             MOVE PC-TSYMSG-01740 TO DP020-MSG-NUMBER             12480000
124900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12490000
125000         IF PS-PO-NBR-NOT-ENTERED                                 12500000
125100             MOVE DP015-UNP-ALP-BRT-OFF TO APONBRA                12510000
125200             MOVE DP015-RED     TO APONBRC                        12520000
125300             MOVE DP015-REVERSE TO APONBRH                        12530000
125400             MOVE -1            TO APONBRL                        12540000
125500         END-IF                                                   12550000
125600         IF PS-DEPT-NBR-NOT-ENTERED                               12560000
125700             MOVE DP015-UNP-ALP-BRT-OFF TO ADPTNRA                12570000
125800             MOVE DP015-RED     TO ADPTNRC                        12580000
125900             MOVE DP015-REVERSE TO ADPTNRH                        12590000
126000             MOVE -1            TO ADPTNRL                        12600000
126100         END-IF                                                   12610000
126200     END-IF.                                                      12620000
126300                                                                  12630000
126400     IF  PS-BUYR-NBR-ENTERED                                      12640000
126500         SET PS-ERROR                                             12650000
126600             DP020-MSG-FATAL TO TRUE                              12660000
126700         MOVE PC-TSYMSG-01740 TO DP020-MSG-NUMBER                 12670000
126800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      12680000
126900         MOVE DP015-UNP-ALP-BRT-OFF TO ABYRNRA                    12690000
127000         MOVE DP015-RED     TO ABYRNRC                            12700000
127100         MOVE DP015-REVERSE TO ABYRNRH                            12710000
127200         MOVE -1            TO ABYRNRL                            12720000
127300     END-IF.                                                      12730000
127400                                                                  12740000
127500 3155-CHK2-RCVR-ITEM-LIST.                                        12750000
127600     IF PS-OPER-UNT-ENTERED AND PS-PO-NBR-ENTERED AND             12760000
127700        PS-RCVR-SEQ-ENTERED                                       12770000
127800         CONTINUE                                                 12780000
127900     ELSE                                                         12790000
128000         IF PS-OPER-UNT-NOT-ENTERED AND                           12800000
128100            PS-PO-NBR-NOT-ENTERED AND                             12810000
128200            PS-RCVR-SEQ-NOT-ENTERED                               12820000
128300             SET PS-ERROR                                         12830000
128400                 DP020-MSG-FATAL TO TRUE                          12840000
128500             MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER             12850000
128600             MOVE DP015-UNP-ALP-BRT-OFF TO AOPRIDA                12860000
128700                                           APONBRA                12870000
128800                                           ARCVSQA                12880000
128900             MOVE DP015-RED TO AOPRIDC                            12890000
129000                               APONBRC                            12900000
129100                               ARCVSQC                            12910000
129200             MOVE DP015-REVERSE TO AOPRIDH                        12920000
129300                                   APONBRH                        12930000
129400                                   ARCVSQH                        12940000
129500             MOVE -1                TO AOPRIDL                    12950000
129600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12960000
129700         END-IF                                                   12970000
129800         IF PS-OPER-UNT-ENTERED AND                               12980000
129900            PS-PO-NBR-NOT-ENTERED AND                             12990000
130000            PS-RCVR-SEQ-NOT-ENTERED                               13000000
130100             SET PS-ERROR                                         13010000
130200                 DP020-MSG-FATAL TO TRUE                          13020000
130300             MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER             13030000
130400             MOVE DP015-UNP-ALP-BRT-OFF TO APONBRA                13040000
130500                                           ARCVSQA                13050000
130600             MOVE DP015-RED TO APONBRC                            13060000
130700                               ARCVSQC                            13070000
130800             MOVE DP015-REVERSE TO APONBRH                        13080000
130900                                   ARCVSQH                        13090000
131000             MOVE -1                TO APONBRL                    13100000
131100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13110000
131200         END-IF                                                   13120000
131300         IF PS-OPER-UNT-ENTERED AND                               13130000
131400            PS-PO-NBR-ENTERED AND                                 13140000
131500            PS-RCVR-SEQ-NOT-ENTERED                               13150000
131600             SET PS-ERROR                                         13160000
131700                 DP020-MSG-FATAL TO TRUE                          13170000
131800             MOVE PC-TSYMSG-00737 TO DP020-MSG-NUMBER             13180000
131900             MOVE DP015-UNP-ALP-BRT-OFF TO ARCVSQA                13190000
132000             MOVE DP015-RED TO ARCVSQC                            13200000
132100             MOVE DP015-REVERSE TO ARCVSQH                        13210000
132200             MOVE -1                TO ARCVSQL                    13220000
132300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13230000
132400         END-IF                                                   13240000
132500         IF PS-DEPT-NBR-ENTERED OR                                13250000
132600            PS-BUYR-NBR-ENTERED                                   13260000
132700             SET PS-ERROR                                         13270000
132800                 DP020-MSG-FATAL TO TRUE                          13280000
132900             MOVE PC-TSYMSG-01245 TO DP020-MSG-NUMBER             13290000
133000             IF PS-DEPT-NBR-ENTERED                               13300000
133100                 MOVE DP015-UNP-ALP-BRT-OFF TO ADPTNRA            13310000
133200                 MOVE DP015-RED TO ADPTNRC                        13320000
133300                 MOVE DP015-REVERSE TO ADPTNRH                    13330000
133400                 MOVE -1        TO ADPTNRL                        13340000
133500             END-IF                                               13350000
133600             IF PS-BUYR-NBR-ENTERED                               13360000
133700                 MOVE DP015-UNP-ALP-BRT-OFF TO ABYRNRA            13370000
133800                 MOVE DP015-RED TO ABYRNRC                        13380000
133900                 MOVE DP015-REVERSE TO ABYRNRH                    13390000
134000                 MOVE -1        TO ABYRNRL                        13400000
134100             END-IF                                               13410000
134200             IF PS-ERROR                                          13420000
134300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13430000
134400             END-IF                                               13440000
134500         END-IF                                                   13450000
134600     END-IF.                                                      13460000
134700/                                                                 13470000
134800 3200-RESET-ATTRIBUTES.                                           13480000
134900     MOVE DP015-UNP-ALP-NOR-OFF    TO AOPRIDA                     13490000
135000                                      ADPTNRA                     13500000
135100                                      ABYRNRA                     13510000
135200                                      APONBRA                     13520000
135300                                      ARCVSQA                     13530000
135400                                      ASEQARA                     13540000
135500                                      ASEQOTA                     13550000
135600                                      ABYANLA                     13560000
135700                                      ADCTRA                      13570000
135800                                      ARCARVA                     13580000
135900                                      ARCENRA                     13590000
136000                                      ATRESNA                     13600099
136010                                      AINCLDA                     13601099
136020                                      AEXCLDA                     13602099
136030                                      ASTCD1A                     13603099
136040                                      ASTYR1A                     13604099
136050                                      ASTCD2A                     13605099
136060                                      ASTYR2A                     13606099
136070                                      ASTCD3A                     13607099
136080                                      ASTYR3A                     13608099
136090                                      ASTCD4A                     13609099
136091                                      ASTYR4A                     13609199
136092                                      ASTCD5A                     13609299
136093                                      ASTYR5A                     13609399
136094                                      ASTCD6A                     13609499
136095                                      ASTYR6A.                    13609599
136100                                                                  13610000
136200     MOVE DP015-GREEN              TO AOPRIDC                     13620000
136300                                      ADPTNRC                     13630000
136400                                      ABYRNRC                     13640000
136500                                      APONBRC                     13650000
136600                                      ARCVSQC                     13660000
136700                                      ASEQARC                     13670000
136800                                      ASEQOTC                     13680000
136900                                      ABYANLC                     13690000
137000                                      ADCTRC                      13700000
137100                                      ARCARVC                     13710000
137200                                      ARCENRC                     13720000
137300                                      ATRESNC                     13730099
137310                                      AINCLDC                     13731099
137320                                      AEXCLDC                     13732099
137330                                      ASTCD1C                     13733099
137340                                      ASTYR1C                     13734099
137350                                      ASTCD2C                     13735099
137360                                      ASTYR2C                     13736099
137370                                      ASTCD3C                     13737099
137380                                      ASTYR3C                     13738099
137390                                      ASTCD4C                     13739099
137391                                      ASTYR4C                     13739199
137392                                      ASTCD5C                     13739299
137393                                      ASTYR5C                     13739399
137394                                      ASTCD6C                     13739499
137395                                      ASTYR6C.                    13739599
137400                                                                  13740000
137500     MOVE DP015-UNDERLINE          TO AOPRIDH                     13750000
137600                                      ADPTNRH                     13760000
137700                                      ABYRNRH                     13770000
137800                                      APONBRH                     13780000
137900                                      ARCVSQH                     13790000
138000                                      ASEQARH                     13800000
138100                                      ASEQOTH                     13810000
138200                                      ABYANLH                     13820000
138300                                      ADCTRH                      13830000
138400                                      ARCARVH                     13840000
138500                                      ARCENRH                     13850000
138600                                      ATRESNH                     13860099
138610                                      AINCLDH                     13861099
138620                                      AEXCLDH                     13862099
138630                                      ASTCD1H                     13863099
138640                                      ASTYR1H                     13864099
138650                                      ASTCD2H                     13865099
138660                                      ASTYR2H                     13866099
138670                                      ASTCD3H                     13867099
138680                                      ASTYR3H                     13868099
138690                                      ASTCD4H                     13869099
138691                                      ASTYR4H                     13869199
138692                                      ASTCD5H                     13869299
138693                                      ASTYR5H                     13869399
138694                                      ASTCD6H                     13869499
138695                                      ASTYR6H.                    13869599
138700                                                                  13870000
138800****************************************************************  13880000
138900* THIS PARAGRAPH WILL BE USED TO VALIDATE THE OPER-UNT-ID AND     13890000
139000*     BRING BACK THE LOCATION NAME                                13900000
139100****************************************************************  13910000
139200 3300-VALIDATE-OPER-UNT-ID.                                       13920000
139300     INITIALIZE XL071-COMMAREA-REC.                               13930000
139400                                                                  13940000
139500     MOVE ASC-OPER-UNT-ID-N  TO XL071-LOCATION-NUMBER.            13950000
139600                                                                  13960000
139700     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    13970000
139800                                      XL071-COMMAREA              13980000
139900                                      XL071-COMMAREA-REC.         13990000
140000                                                                  14000000
140100     EVALUATE TRUE                                                14010000
140200         WHEN XL071-NO-ERRORS                                     14020000
140300             MOVE XL071-LOC-NM   TO ASC-FCLTY-NME                 14030000
140400                                    AOPDESO                       14040000
140500             MOVE XL071-LOC-5-ABBR-NM TO PV-LOC-5-NM              14050000
140600             MOVE PV-DC-NME           TO PV-DC-NME-4              14060000
140700             MOVE PV-DC               TO PV-DC-4                  14070000
140800             MOVE PV-LOC-4-CHAR-NM    TO ASC-FCLTY-SHORT-NME      14080000
140900         WHEN XL071-LOC-NOT-FOUND                                 14090000
141000             SET PS-ERROR          TO TRUE                        14100000
141100             MOVE SPACES TO ASC-FCLTY-NME                         14110000
141200                            ASC-FCLTY-SHORT-NME                   14120000
141300         WHEN XL071-SQLCODE-N = -904                              14130000
141400         WHEN XL071-SQLCODE-N = -913                              14140000
141500             MOVE SPACES TO ASC-FCLTY-NME                         14150000
141600                            ASC-FCLTY-SHORT-NME                   14160000
141700         WHEN XL071-BAD-DB2-RETURN                                14170000
141800             MOVE '3300-VALIDATE-OPER-UNT-ID'                     14180000
141900                              TO DP013-PARAGRAPH                  14190000
142000             MOVE 'SELECT OPERATING UNIT ID'                      14200000
142100                              TO DP013-MESSAGE-TEXT (1)           14210000
142200             MOVE XL071-SQLCA     TO DP013-SQLCA                  14220000
142300             MOVE 'XLT_LOC '      TO DP013-DB2-TABLE-NAME (1)     14230000
142400             SET DP013-DB2-ABEND                                  14240000
142500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               14250000
142600             PERFORM DP013-0000-PROCESS-ABEND                     14260000
142700     END-EVALUATE.                                                14270000
142800                                                                  14280000
142900/                                                                 14290000
143000*----------------------------------------------------------------*14300000
143100*    CHECK THAT THE PURCHASE ORDER AND/OR REC SEQ NBR EXISTS     *14310000
143200*----------------------------------------------------------------*14320000
143300 3600-SELECT-PO.                                                  14330000
143400     PERFORM                                                      14340000
143500         WITH TEST AFTER                                          14350000
143600         VARYING PV-RETRY-COUNTER                                 14360000
143700         FROM 1 BY 1                                              14370000
143800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14380000
143900                   OR (SQLCODE = ZERO OR +100 OR -811))           14390000
144000*                                                                 14400000
144100         EXEC SQL                                                 14410000
144200             SELECT ORD_NBR                                       14420000
144300                  , REC_SEQ_NBR                                   14430000
144400               INTO :RECEIV-ORD-NBR                               14440000
144500                  , :RECEIV-REC-SEQ-NBR                           14450000
144600               FROM TRECEIV                                       14460000
144700              WHERE ORD_NBR       = :DK-PO-NBR                    14470000
144800                AND REC_SEQ_NBR  BETWEEN :DK-LOW-REC-SEQ-NBR      14480000
144900                                     AND :DK-HI-REC-SEQ-NBR       14490000
145000                AND VER_STATUS_CDE = :PC-ACTIVE-STATUS            14500000
145010               WITH UR                                            14501000
145100         END-EXEC                                                 14510000
145200                                                                  14520000
145300         EVALUATE TRUE                                            14530000
145400             WHEN SQLCODE = ZERO                                  14540000
145500             WHEN SQLCODE = -811                                  14550000
145600                 CONTINUE                                         14560000
145700             WHEN SQLCODE = +100                                  14570000
145800                 SET PS-PO-RCVR-NOT-FOUND TO TRUE                 14580000
145900             WHEN SQLCODE = -904                                  14590000
146000             WHEN SQLCODE = -913                                  14600000
146100                 CONTINUE                                         14610000
146200             WHEN SQLWARN0 NOT = SPACE                            14620000
146300             WHEN SQLCODE NOT = ZERO                              14630000
146400                 SET PS-SEVERE-ERROR TO TRUE                      14640000
146500                 MOVE '3600-SELECT-PO' TO DP013-PARAGRAPH         14650000
146600                 MOVE 'SELECT PO/REC SEQ NBR'                     14660000
146700                                      TO DP013-MESSAGE-TEXT (1)   14670000
146800                 MOVE SQLCA           TO DP013-SQLCA              14680000
146900                 MOVE 'TRECEIV '      TO DP013-DB2-TABLE-NAME (1) 14690000
147000                 SET DP013-DB2-ABEND                              14700000
147100                     DP013-NO-ROLLBACK                            14710000
147200                     DP013-LINK-RETURN TO TRUE                    14720000
147300                 PERFORM DP013-0000-PROCESS-ABEND                 14730000
147400         END-EVALUATE                                             14740000
147500     END-PERFORM.                                                 14750000
147600                                                                  14760000
147700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14770000
147800         SET PS-RETRY-EXCEEDED TO TRUE                            14780000
147900         MOVE '3600-SELECT-PO' TO DP013-PARAGRAPH                 14790000
148000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     14800000
148100                                   TO DP013-MESSAGE-TEXT (1)      14810000
148200         MOVE SQLCA                TO DP013-SQLCA                 14820000
148300         MOVE 'TRECEIV '           TO DP013-DB2-TABLE-NAME (1)    14830000
148400         SET DP013-DB2-ABEND                                      14840000
148500             DP013-NO-ROLLBACK                                    14850000
148600             DP013-LINK-RETURN TO TRUE                            14860000
148700         PERFORM DP013-0000-PROCESS-ABEND                         14870000
148800     END-IF.                                                      14880000
148900                                                                  14890000
149000 3700-COUNT-DEPT.                                                 14900000
149100     PERFORM                                                      14910000
149200         WITH TEST AFTER                                          14920000
149300         VARYING PV-RETRY-COUNTER                                 14930000
149400         FROM 1 BY 1                                              14940000
149500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14950000
149600             OR (SQLCODE = +0)                                    14960000
149700             OR (SQLCODE = +100))                                 14970000
149800                                                                  14980000
149900         EXEC SQL                                                 14990000
150000              SELECT COUNT(*)                                     15000000
150100                INTO :PV-DB2-COUNT                                15010000
150200                FROM TMDSEAR A                                    15020000
150300               WHERE                                              15030000
150400                     A.DEPT_NBR   = :DK-DEPT-NBR                  15040000
150500                 AND A.MDSELV_CDE  = 'DPT'                        15050000
150600                 AND A.OPERCO_NBR  = '03'                         15060000
150700                 AND A.STRT_DTE <= CURRENT DATE                   15070000
150800                 AND A.END_DTE  >= CURRENT DATE                   15080000
150801               FETCH FIRST 1 ROW ONLY                             15080100
150810                WITH UR                                           15081000
150900         END-EXEC                                                 15090000
151000                                                                  15100000
151100         EVALUATE TRUE                                            15110000
151200             WHEN SQLCODE = +0                                    15120000
151300             WHEN SQLCODE = +100                                  15130000
151400             WHEN SQLCODE = -904                                  15140000
151500             WHEN SQLCODE = -913                                  15150000
151600                  CONTINUE                                        15160000
151700                                                                  15170000
151800             WHEN SQLWARN0 NOT = SPACES                           15180000
151900             WHEN SQLCODE < +0                                    15190000
152000             WHEN SQLCODE > +0                                    15200000
152100                  MOVE '3700-COUNT-DEPT' TO DP013-PARAGRAPH       15210000
152200                  MOVE 'UNSUCCESSFUL COUNT ON MDSEAR'             15220000
152300                                  TO DP013-MESSAGE-TEXT (1)       15230000
152400                  MOVE SQLCA      TO DP013-SQLCA                  15240000
152500                  MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)     15250000
152600                  SET DP013-DB2-ABEND                             15260000
152700                      DP013-XCTL-DISPLAY-RESTART TO TRUE          15270000
152800                  PERFORM DP013-0000-PROCESS-ABEND                15280000
152900         END-EVALUATE                                             15290000
153000     END-PERFORM.                                                 15300000
153100                                                                  15310000
153200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15320000
153300         MOVE '3700-COUNT-DEPT' TO DP013-PARAGRAPH                15330000
153400         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TMDSEAR'          15340000
153500                                  TO DP013-MESSAGE-TEXT (1)       15350000
153600         MOVE SQLCA               TO DP013-SQLCA                  15360000
153700         MOVE 'TMDSEAR '          TO DP013-DB2-TABLE-NAME (1)     15370000
153800         SET DP013-DB2-ABEND                                      15380000
153900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   15390000
154000         PERFORM DP013-0000-PROCESS-ABEND                         15400000
154100     END-IF.                                                      15410000
154200                                                                  15420000
154300                                                                  15430000
154400 3750-COUNT-BUYR.                                                 15440000
154500     PERFORM                                                      15450000
154600         WITH TEST AFTER                                          15460000
154700         VARYING PV-RETRY-COUNTER                                 15470000
154800         FROM 1 BY 1                                              15480000
154900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15490000
155000             OR (SQLCODE = +0)                                    15500000
155100             OR (SQLCODE = +100))                                 15510000
155200                                                                  15520000
155300         EXEC SQL                                                 15530000
155400            SELECT                                                15540000
155500                  COUNT(*)                                        15550000
155600              INTO :PV-DB2-COUNT                                  15560000
155700              FROM                                                15570000
155800                  TMDSEAR A                                       15580000
155900                                                                  15590000
156000             WHERE                                                15600000
156100                  A.OPERCO_NBR = '03'                             15610000
156200              AND A.STRT_DTE  <= CURRENT DATE                     15620000
156300              AND A.END_DTE   >= CURRENT DATE                     15630000
156400              AND A.MDSELV_CDE = 'DPT'                            15640000
156500              AND A.BYR_NBR    = :DK-BYR-NBR                      15650000
156501             FETCH FIRST 1 ROW ONLY                               15650100
156510              WITH UR                                             15651000
156600         END-EXEC                                                 15660000
156700                                                                  15670000
156800         EVALUATE TRUE                                            15680000
156900             WHEN SQLCODE = +0                                    15690000
157000             WHEN SQLCODE = +100                                  15700000
157100             WHEN SQLCODE = -904                                  15710000
157200             WHEN SQLCODE = -913                                  15720000
157300                  CONTINUE                                        15730000
157400                                                                  15740000
157500             WHEN SQLWARN0 NOT = SPACES                           15750000
157600             WHEN SQLCODE < +0                                    15760000
157700             WHEN SQLCODE > +0                                    15770000
157800                  MOVE '3750-COUNT-BUYR' TO DP013-PARAGRAPH       15780000
157900                  MOVE 'UNSUCCESSFUL COUNT ON MDSEAR'             15790000
158000                                  TO DP013-MESSAGE-TEXT (1)       15800000
158100                  MOVE SQLCA      TO DP013-SQLCA                  15810000
158200                  MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)     15820000
158300                  SET DP013-DB2-ABEND                             15830000
158400                      DP013-XCTL-DISPLAY-RESTART TO TRUE          15840000
158500                  PERFORM DP013-0000-PROCESS-ABEND                15850000
158600         END-EVALUATE                                             15860000
158700     END-PERFORM.                                                 15870000
158800                                                                  15880000
158900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15890000
159000         MOVE '3750-COUNT-BUYR' TO DP013-PARAGRAPH                15900000
159100         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TMDSEAR'          15910000
159200                                  TO DP013-MESSAGE-TEXT (1)       15920000
159300         MOVE SQLCA               TO DP013-SQLCA                  15930000
159400         MOVE 'TMDSEAR '          TO DP013-DB2-TABLE-NAME (1)     15940000
159500         SET DP013-DB2-ABEND                                      15950000
159600             DP013-XCTL-DISPLAY-RESTART TO TRUE                   15960000
159700         PERFORM DP013-0000-PROCESS-ABEND                         15970000
159800     END-IF.                                                      15980000
159900                                                                  15990000
160000/                                                                 16000000
160100 4000-BUILD-INITIAL-PANEL.                                        16010000
160200     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        16020000
160300     MOVE -1                       TO ADPTNRL.                    16030000
160400                                                                  16040000
160500     SET PS-NO-SQL-ERROR                                          16050000
160600         PS-DEFAULT-OPER-UNT       TO TRUE.                       16060000
160700                                                                  16070000
160800     MOVE PC-0001                  TO DK-FCLTY-ID                 16080000
160900                                      ASC-FCLTY-ID.               16090000
161000                                                                  16100000
161100     IF ASC-OPER-UNT-ID = SPACES                                  16110000
161200         MOVE  -1       TO AOPRIDL                                16120000
161300     ELSE                                                         16130000
161400         MOVE ASC-OPER-UNT-ID-N     TO AOPRIDO                    16140000
161500                                       DK-OPER-UNT-ID             16150000
161600                                       PV-SAVE-OPER-UNT           16160000
161700         PERFORM 3300-VALIDATE-OPER-UNT-ID                        16170000
161800     END-IF.                                                      16180000
161900                                                                  16190000
162000**** DEFAULT TO ARRIVAL DATE LIST SEQUENCE                        16200000
162100     MOVE PC-S TO ASC-LS-ARRIVAL-DT                               16210000
162200                  ASEQARO.                                        16220000
162300                                                                  16230000
162400                                                                  16240000
162500 4400-MOVE-COMMAREA-TO-SCREEN.                                    16250000
162600     MOVE ASC-OPER-UNT-ID-N        TO AOPRIDO.                    16260000
162700     MOVE ASC-FCLTY-NME            TO AOPDESO.                    16270000
162800     MOVE ASC-DEPT-N               TO ADPTNRO.                    16280000
162900     MOVE ASC-BUYER-NBR-N          TO ABYRNRO.                    16290000
163000     MOVE ASC-PO-NBR-N             TO APONBRO.                    16300000
163100     MOVE ASC-RCVR-SEQ-NBR-N       TO ARCVSQO.                    16310000
163200     MOVE ASC-LS-ARRIVAL-DT        TO ASEQARO.                    16320000
163300     MOVE ASC-LS-OLD-NEW-TRBL      TO ASEQOTO.                    16330000
163400     MOVE ASC-RA-BUYER-ANALYST     TO ABYANLO.                    16340000
163500     MOVE ASC-RA-DC                TO ADCTRO.                     16350000
163600     MOVE ASC-RCVR-STATUS-ARRIVED  TO ARCARVO.                    16360000
163700     MOVE ASC-RCVR-STATUS-ENROUTE  TO ARCENRO.                    16370000
163800     MOVE ASC-TRBL-REASON          TO ATRESNO.                    16380000
163801                                                                  16380199
163810     MOVE ASC-INCLD-SET            TO AINCLDO.                    16381099
163811     MOVE ASC-EXCLD-SET            TO AEXCLDO.                    16381199
163812     MOVE ASC-SET-CODE-1           TO ASTCD1O.                    16381299
163813     MOVE ASC-SET-YEAR-1           TO ASTYR1O.                    16381399
163820     MOVE ASC-SET-CODE-2           TO ASTCD2O.                    16382099
163830     MOVE ASC-SET-YEAR-2           TO ASTYR2O.                    16383099
163840     MOVE ASC-SET-CODE-3           TO ASTCD3O.                    16384099
163850     MOVE ASC-SET-YEAR-3           TO ASTYR3O.                    16385099
163860     MOVE ASC-SET-CODE-4           TO ASTCD4O.                    16386099
163870     MOVE ASC-SET-YEAR-4           TO ASTYR4O.                    16387099
163880     MOVE ASC-SET-CODE-5           TO ASTCD5O.                    16388099
163890     MOVE ASC-SET-YEAR-5           TO ASTYR5O.                    16389099
163891     MOVE ASC-SET-CODE-6           TO ASTCD6O.                    16389199
163892     MOVE ASC-SET-YEAR-6           TO ASTYR6O.                    16389299
163893                                                                  16389399
164037                                                                  16403700
164040                                                                  16404000
164100**************************************************************    16410000
164200*     ABEND PROCESSING PARAGRAPH                             *    16420000
164300**************************************************************    16430000
164400     COPY DPPD013.                                                16440000
