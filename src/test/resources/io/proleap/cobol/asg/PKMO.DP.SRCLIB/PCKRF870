000100 IDENTIFICATION DIVISION.                                         00010006
000200 TITLE 'MANIFESTING - OPEN A TRAILER ON A SHIPPING DOCK'.         00020006
000300                                                                  00030006
000400 PROGRAM-ID.             PCKRF870.                                00040006
000500 AUTHOR.                 DENNIS STEFFEN.                          00050006
000600 INSTALLATION.           KOHLS.                                   00060006
000700 DATE-WRITTEN.           APRIL 2001.                              00070006
000800 DATE-COMPILED.                                                   00080006
000900 ENVIRONMENT DIVISION.                                            00090006
001000 DATA DIVISION.                                                   00100006
001100                                                                  00110006
001200 WORKING-STORAGE SECTION.                                         00120006
001300                                                                  00130006
001400 01  DK-DB2-KEYS.                                                 00140029
001500     05  DK-OPER-UNT-ID               PIC S9(04) VALUE 0 COMP.    00150029
001600 01  PC-PROGRAM-CONSTANTS.                                        00160029
001700     05  PC-TRANID                    PIC X(04) VALUE 'E870'.     00170029
001800     05  PC-DLX                       PIC X(03) VALUE 'DLX'.      00180034
001900     05  PC-DLSHPI                    PIC X(06) VALUE 'DLSHPI'.   00190034
002000     05  PC-Y                         PIC X(01) VALUE 'Y'.        00200034
002100     05  PC-SHIPPING                  PIC X(08) VALUE 'SHIPPING'. 00210035
002200     05  PC-TRAILER-OPEN              PIC X(12) VALUE             00220035
002300         'TRAILER OPEN'.                                          00230035
002400     05  PV-CICS-MSG-AREA2            PIC X(100) VALUE SPACES.    00240035
002500     05  PV-ERROR-MESSAGE             PIC X(45) VALUE SPACES.     00250035
002600     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRF870'. 00260006
002700     05  PC-TRLR-AUDIT-START-PGM      PIC X(08) VALUE 'PCKRF892'. 00270006
002800     05  PC-STARTED-TRLR-AUD-PGM      PIC X(08) VALUE 'PCKRF893'. 00280006
002900     05  PC-TRAILER-AUDIT-TO-PGM      PIC X(08) VALUE 'PCKRF895'. 00290006
003000     05  PC-RAND-PGM                  PIC X(08) VALUE 'DPKUT902'. 00300006
003100     05  PC-DUMMY-TIMESTAMP           PIC X(26) VALUE             00310006
003200            '9999-09-09-09.09.09.999999'.                         00320006
003220     05  PV-SCAC-CDE                  PIC X(04) VALUE SPACES.             
003230     05  PV-TRLR-ID                   PIC X(12) VALUE SPACES.             
003240     05  PV-OTBND-TRIP-ID             PIC S9(09) COMP.                    
003300                                                                   0330006
003400                                                                  00340006
003500* ERROR MESSAGES                                                 *00350006
003600     05  PC-UNRECOGNIZED-PF-KEY-MSG   PIC X(19) VALUE             00360006
003700                                           'UNRECOGNIZED PF KEY'. 00370006
003800     05  PC-ENTER-THROUGH-MENU-MSG    PIC X(19) VALUE             00380006
003900                                           'ENTER THROUGH MENU '. 00390006
004000     05  PC-TRANS-UNAVAILABLE-MSG     PIC X(19) VALUE             00400006
004100                                           'TRANS NOT AVAILABLE'. 00410006
004200     05  PC-WRONG-FACILITY            PIC X(19) VALUE             00420006
004300                                           'WRG FCLTY - F2 CONF'. 00430006
004400     05  PC-FKEY-MSG                  PIC X(19) VALUE             00440006
004500                                           'F4-OPEN            '. 00450006
004600     05  PC-FKEY-CONT-MSG             PIC X(19) VALUE             00460006
004700                                           'F2-CONTINUE        '. 00470006
004800                                                                  00480006
004900 01  PS-PROGRAM-SWITCHES.                                         00490006
005000     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       00500006
005100         88  PS-ERRORS-YES                        VALUE 'Y'.      00510006
005200         88  PS-ERRORS-NO                         VALUE 'N'.      00520006
005300     05  PS-XCTL-SW                   PIC X(04)   VALUE SPACES.   00530006
005400         88  PS-XCTL-E871                       VALUE 'E871'.     00540006
005500         88  PS-XCTL-E874                       VALUE 'E874'.     00550006
005600     05  PS-VALID-INPUT-SW            PIC X(01) VALUE 'N'.        00560006
005700         88  PS-VALID-INPUT                       VALUE 'Y'.      00570006
005800         88  PS-INVALID-INPUT                     VALUE 'N'.      00580006
005900     05  PS-TCNTRID-SW                PIC X(01) VALUE 'N'.        00590006
006000         88  PS-TCNTRID-YES                       VALUE 'Y'.      00600006
006100         88  PS-TCNTRID-NO                        VALUE 'N'.      00610006
006200     05  PS-TCNDCDR-SW                PIC X(01) VALUE 'N'.        00620006
006300         88  PS-TCNDCDR-YES                       VALUE 'Y'.      00630006
006400         88  PS-TCNDCDR-NO                        VALUE 'N'.      00640006
006500     05  PS-TRLR-OPEN-SW              PIC X(04) VALUE SPACES.     00650006
006600         88  PS-TRLR-OPEN-THIS-DOOR             VALUE 'THIS'.     00660006
006700         88  PS-TRLR-OPEN-DIFF-DOOR             VALUE 'DIFF'.     00670006
006800     05  PS-STORE-DOOR-SW             PIC X(01) VALUE SPACES.     00680006
006900         88  PS-NO-DOORS-THIS-STORE             VALUE 'N'.        00690006
007000         88  PS-ONE-DOOR-THIS-STORE             VALUE 'O'.        00700006
007100         88  PS-MLT-DOORS-THIS-STORE            VALUE 'M'.        00710006
007200     05  PC-STORE-DOOR-CSR-SW         PIC X(01) VALUE 'N'.        00720006
007300         88  PS-END-STORE-DOOR-CSR              VALUE 'Y'.        00730006
007400         88  PS-NOT-END-STORE-DOOR-CSR          VALUE 'N'.        00740006
007500     05  PS-DOOR-DEST-EDIT-SW         PIC X(01) VALUE 'Y'.        00750006
007600         88  PS-SKIP-DOOR-DEST-EDITS            VALUE 'N'.        00760006
007700         88  PS-DO-DOOR-DEST-EDITS              VALUE 'Y'.        00770006
007800     05  PS-SERIAL-SW                 PIC X(01) VALUE 'N'.        00780006
007900         88  PS-SERIAL-NO                       VALUE 'N'.        00790006
008000         88  PS-SERIAL-YES                      VALUE 'Y'.        00800006
008100     05  PS-ACTIVE-TRIP-SW            PIC X(01) VALUE 'N'.        00810006
008200         88  PS-ACTIVE-TRIP-EXISTS              VALUE 'Y'.        00820006
008300         88  PS-NO-ACTIVE-TRIP-EXISTS           VALUE 'N'.        00830006
008400     05  PS-DOOR-MISMATCH-ERROR-SW    PIC X(01) VALUE 'N'.        00840008
008500         88  PS-DOOR-MISMATCH-ERROR             VALUE 'Y'.        00850008
008600         88  PS-NO-DOOR-MISMATCH-ERROR          VALUE 'N'.        00860008
008700     05  PS-MULT-DOORS-ALLOWED-SW     PIC X(01) VALUE 'N'.        00870030
008800         88  PS-MULT-DOORS-ALLOWED              VALUE 'Y'.        00880029
008900         88  PS-NO-MULT-DOORS                   VALUE 'N'.        00890029
009000     05  PS-DOOR-GROUP-FOUND-SW       PIC X(01) VALUE 'N'.        00900038
009100         88  PS-DOOR-GROUP-FOUND-YES            VALUE 'Y'.        00910038
009200         88  PS-DOOR-GROUP-FOUND-NO             VALUE 'N'.        00920038
009201     05  PS-LOCATION-TYPE-SW          PIC X(02) VALUE 'NN'.       00900038
009210         88  PS-LOCATION-DC                     VALUE 'DC'.               
009230         88  PS-LOCATION-STORE                  VALUE 'DS'.               
009250         88  PS-LOCATION-NOT-DC-STORE           VALUE 'NN'.               
009251     05  PS-STORAGE-DOOR-SW           PIC X(01) VALUE 'Y'.        00900038
009260         88  PS-STORAGE-DOOR                    VALUE 'Y'.                
009270         88  PS-NOT-STORAGE-DOOR                VALUE 'N'.                
009300                                                                  00930006
009400                                                                  00940006
009500 01  PV-PROGRAM-VARIABLES.                                        00950006
009600     05  PV-DOOR-COUNT                PIC S9(03) COMP-3.          00960006
009700     05  PV-DB2-COUNT                 PIC S9(03) COMP-3.          00970006
009800     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        00980006
009900                                                     COMP SYNC.   00990006
010000     05  PV-MESSAGE-AREA              PIC  X(19)  VALUE SPACE.    01000006
010100     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     01010006
010200                                                     COMP SYNC.   01020006
010300     05  PV-TRANSFER-PROGRAM          PIC  X(08)  VALUE SPACE.    01030006
010400                                                                  01040006
010500     05  PV-DISPLAY-DOOR-ID           PIC  X(04)  VALUE SPACE.    01050006
010600     05  PV-DISPLAY-OPER              PIC  9(04)  VALUE ZEROES.   01060006
010700     05  PV-DISPLAY-SEQ-NBR           PIC  9(11)  VALUE ZEROES.   01070079
010800     05  PV-DISPLAY-DEST              PIC  9(04)  VALUE ZEROES.   01080006
010900     05  PV-DISPLAY-SRL-NBR           PIC  9(09)  VALUE ZEROES.   01090006
011000     05  PV-DISPLAY-SCAC              PIC  X(04)  VALUE SPACES.   01100006
011100     05  PV-DISPLAY-TRLR-ID           PIC  X(12)  VALUE ZEROES.   01110006
011200     05  PV-DISPLAY-TRIP              PIC  9(09)  VALUE ZEROES.   01120006
011300     05  PV-CURRENT-TIMESTAMP         PIC X(26) VALUE SPACES.     01130053
011400                                                                  01140006
011500                                                                  01150006
011600 01  PV-LOG-MSG.                                                  01160006
011700     05  FILLER                       PIC X(12) VALUE             01170006
011800         ' E870 ERROR '.                                          01180006
011900     05  FILLER                       PIC X(06) VALUE             01190006
012000         'USER= '.                                                01200006
012100     05  PV-USER-ID                   PIC X(08) VALUE SPACES.     01210006
012200     05  FILLER                       PIC X(10) VALUE             01220006
012300         ' SQLCODE= '.                                            01230006
012400     05  PV-SQLCODE                   PIC -9(03).                 01240006
012500     05  FILLER                       PIC X(06) VALUE             01250006
012600         ' ERR= '.                                                01260006
012700     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       01270006
012800     05  FILLER                       PIC X(07) VALUE             01280006
012900         ' DOOR= '.                                               01290006
013000     05  PV-DISPLAY-DOOR              PIC X(04) VALUE ZEROES.     01300006
013100/                                                                 01310006
013200 01  PV-MSG-48.                                                   00810000
013300     05  FILLER                       PIC X(01) VALUE SPACES.             
013400     05  PV-MSG-TIME-48               PIC X(15) VALUE SPACES.     00820000
013500                                                                          
013600     05  FILLER                       PIC X(19) VALUE             00820000
013700         ' E870 SERIAL ERROR '.                                   00830000
013800                                                                          
013900     05  FILLER                       PIC X(05) VALUE             00840000
014000         'LOC= '.                                                 00850000
014100     05  PV-LOC-48                    PIC 9(04) VALUE ZEROES.     00860000
014200                                                                          
014300     05  FILLER                       PIC X(07) VALUE             00930000
014400         ' DOOR= '.                                               00940000
014500     05  PV-DOOR-48                   PIC X(04) VALUE SPACES.     00950000
014600                                                                          
014700     05  FILLER                       PIC X(07) VALUE             00930000
014800         ' SRL#= '.                                               00940000
014900     05  PV-SERIAL-48                 PIC 9(09) VALUE ZEROES.     00950000
015000                                                                          
015100     05  FILLER                       PIC X(07) VALUE             00840000
015200         ' USER= '.                                               00850000
015300     05  PV-USER-ID-48                PIC X(08) VALUE SPACES.     00860000
015400                                                                          
015500     05  FILLER                       PIC X(07) VALUE             00840000
015600         ' FKEY= '.                                               00850000
015700     05  PV-FKEY-48                   PIC X(1) VALUE SPACES.      00860000
015800                                                                          
015900     05  FILLER                       PIC X(07) VALUE             00840000
016000         ' DEST= '.                                               00850000
016100     05  PV-DEST-48                   PIC 9(04) VALUE ZEROES.     00860000
016200                                                                          
016300     05  FILLER                       PIC X(07) VALUE             00840000
016400         ' SCAC= '.                                               00850000
016500     05  PV-SCAC-48                   PIC X(04) VALUE SPACES.     00860000
016600                                                                          
016700     05  FILLER                       PIC X(01) VALUE             00840000
016800         ' '.                                                     00850000
016900     05  PV-LAST-PGM-48               PIC X(08) VALUE SPACES.     00860000
017000                                                                          
017100/                                                                 00960000
017200 01  PV-EDITING-FIELDS.                                           01320006
017300     05  PV-SCREEN-DOOR               PIC X(04).                  01330006
017400     05  PV-SCREEN-DEST               PIC X(04).                  01340006
017500     05  PV-SCREEN-SERIAL-NBR         PIC X(09).                  01350006
017600     05  PV-EMPTY-PALLETS             PIC X(04).                  01360006
017700                                                                  01370006
017800/                                                                 01380006
017900 01  CA-COMMAREA.                                                 01390006
018000     COPY PCWS233.                                                01400006
018100     05  CA-PRIVATE-COMMAREA          PIC X(100).                 01410006
018200     05  CA-REDEFINED-COMMAREA REDEFINES CA-PRIVATE-COMMAREA.     01420006
018300         10  CA-CURR-DOOR             PIC X(04).                  01430006
018400         10  CA-CURR-DEST             PIC 9(04).                  01440006
018500         10  CA-CURR-SERIAL-NBR       PIC 9(09).                  01450006
018600         10  CA-EMPTY-PALLETS         PIC 9(04).                  01460006
018700/                                                                 01470006
018800*  MAP LAYOUT                                                     01480006
018900     COPY PCKM870.                                                01490006
019000                                                                  01500006
019100* HELP SCREEN COMMAREA                                            01510006
019200     COPY PCWS192.                                                01520006
019300* HELP SCREEN WORK AREA                                           01530006
019400     COPY PCWS188.                                                01540006
019500* AUDIT PROCESSING COPYBOOK                                       01550006
019600     COPY PCWS045.                                                01560006
019700*         USED WHEN CALLING DLKUP001 TO SECURE NEXT SEQUENCE #    01570052
019800     COPY DLWS001.                                                01580045
019900*         USED TO CONSISTENTLY FORMAT KEY FIELDS.                 01590079
020000     COPY DLWS011.                                                01600045
020100*         USED WHEN CALLING DLKCS410                              01610052
020200     COPY DLWS016.                                                01620031
020300*         USED WHEN CALLING XLKUP033 TO INSERT BUSINESS EVENTS    01630052
020400     COPY XLWS072.                                                01640033
020500     COPY PCWS242.                                                01650033
020600/                                                                 01660006
020700     COPY DPWS010I.                                               01670006
020800*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01680006
020900     COPY DPWS015.                                                01690006
021000                                                                  01700006
021100*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01710006
021200     COPY DFHAID.                                                 01720006
021300                                                                  01730006
021400*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01740006
021500     COPY DPWS013.                                                01750006
021600                                                                  01760006
021700*  RANDOM NUMBER ROUTINE                                          01770006
021800     COPY DPWS902.                                                01780006
021900                                                                  01790006
022000/                                                                 01800006
022100*    DC DOOR MASTER                                               01810006
022200     EXEC SQL                                                     01820006
022300         INCLUDE TCNDCDR                                          01830006
022400     END-EXEC.                                                    01840006
022500*    DC DOOR TYPES                                                01850006
022600     EXEC SQL                                                     01860006
022700         INCLUDE TCNDRTY                                          01870006
022800     END-EXEC.                                                    01880006
022900                                                                  01890006
023000*    DC DOOR/STORE CONNECTION                                     01900006
023100     EXEC SQL                                                     01910006
023200         INCLUDE TCNDRST                                          01920006
023300     END-EXEC.                                                    01930006
023400                                                                  01940006
023500*    SUT_TRIP_WRKR_AUD                                            01950010
023600     EXEC SQL                                                     01960010
023700         INCLUDE SUT00006                                         01970010
023800     END-EXEC.                                                    01980010
023900                                                                  01990010
024000*    TRAILER ID MASTER                                            02000006
024100     EXEC SQL                                                     02010006
024200         INCLUDE TCNTRID                                          02020006
024300     END-EXEC.                                                    02030006
024400                                                                  02040006
024500*    OUTBOUND TRAILER TRIP                                        02050006
024600     EXEC SQL                                                     02060006
024700         INCLUDE TSUOBTR                                          02070006
024800     END-EXEC.                                                    02080006
024900                                                                  02090006
025000*    OUTBOUND TRAILER TRIP STATUS                                 02100006
025100     EXEC SQL                                                     02110006
025200         INCLUDE TSUOBTS                                          02120006
025300     END-EXEC.                                                    02130006
025400                                                                  02140006
025500*    OUTBOUND TRAILER TRIP STATUS CODES                           02150006
025600     EXEC SQL                                                     02160006
025700         INCLUDE TSUOBSC                                          02170006
025800     END-EXEC.                                                    02180006
025900                                                                  02190006
026000*    PARAMETER TABLE                                              02200029
026100     EXEC SQL                                                     02210029
026200         INCLUDE TKRPRPM                                          02220029
026300     END-EXEC.                                                    02230029
026400                                                                  02240029
026500*    AUDIT TRAILER TRIP TABLE                                     02250006
026600     EXEC SQL                                                     02260006
026700         INCLUDE SUT00004                                         02270006
026800     END-EXEC.                                                    02280006
026900*    STATUS ASSOCIATIONS                                          02290006
027000     EXEC SQL                                                     02300006
027100         INCLUDE SUT00005                                         02310006
027200     END-EXEC.                                                    02320006
027300                                                                  02330006
027400*    AUDIT CREATE TABLE                                           02340006
027500     EXEC SQL                                                     02350006
027600         INCLUDE TSUNAUD                                          02360006
027700     END-EXEC.                                                    02370006
027800                                                                  02380031
027810*    XLT_LOC TABLE                                                02340006
027820     EXEC SQL                                                     02350006
027830         INCLUDE XLT00010                                         02360006
027840     END-EXEC.                                                    02370006
027850                                                                  02380031
027900*    DOOR GROUP TEMPLATE                                          02390052
028000     EXEC SQL                                                     02400031
028100         INCLUDE DLT00000                                         02410031
028200     END-EXEC.                                                    02420031
028300                                                                  02430031
028400*    DOOR GROUP                                                   02440052
028500     EXEC SQL                                                     02450031
028600         INCLUDE DLT00001                                         02460031
028700     END-EXEC.                                                    02470031
028800                                                                  02480006
028900/                                                                 02490006
029000*    LIST ALL DOORS THAT SERVICE A STORE.  A STORE SHOULD ONLY    02500006
029100*    BE ASSIGNED TO ONE DOOR BUT A DOOR CAN SERVE MULTIPLE STORES 02510006
029200*    ALTHOUGH IT USUALLY SERVES ONLY ONE.                         02520006
029300                                                                  02530006
029400     EXEC SQL                                                     02540006
029500         DECLARE STORE-DOOR-CSR CURSOR FOR                        02550006
029600         SELECT                                                   02560006
029700             DRST.DOOR_ID                                         02570006
029800         FROM TCNDRST DRST                                        02580006
029900         ,    TCNDCDR DCDR                                        02590006
030000         ,    TCNDRTY DRTY                                        02600006
030100         WHERE                                                    02610006
030200             DRST.OPER_UNT_ID         = :PC233-OPER-UNT-ID        02620006
030300         AND DRST.STR_NBR             = :PC233-STR-NBR            02630006
030400         AND DCDR.DOOR_ID             = DRST.DOOR_ID              02640006
030500         AND DRST.OPER_UNT_ID         = DCDR.OPER_UNT_ID          02650006
030600         AND DCDR.DOOR_TYP_CDE IN ('SH', 'DS', 'ST')              02660016
030700         AND CURRENT TIMESTAMP BETWEEN                            02670006
030800              DRST.STRT_TMST AND DRST.END_TMST                    02680006
030900         AND  DCDR.DOOR_TYP_CDE       = DRTY.DOOR_TYP_CDE         02690006
031000         AND  DRTY.DIVERT_TYP_CDE     = 'D'                       02700006
031100         FOR FETCH ONLY                                           02710006
031200     END-EXEC.                                                    02720006
031300                                                                  02730006
031400                                                                  02740006
031500     EXEC SQL                                                     02750006
031600         INCLUDE SQLCA                                            02760006
031700     END-EXEC.                                                    02770006
031800                                                                  02780006
031900 LINKAGE SECTION.                                                 02790006
032000 01  DFHCOMMAREA.                                                 02800006
032100     05  FILLER                         OCCURS  1 TO 4072 TIMES   02810006
032200                                      DEPENDING ON EIBCALEN.      02820006
032300         10  FILLER                   PIC X.                      02830006
032400/                                                                 02840006
032500 PROCEDURE DIVISION.                                              02850006
032600 0000-PROGRAM-MAINLINE.                                           02860006
032700                                                                  02870006
032800***  INITIALIZE CA-COMMAREA                                       02880006
032900     INITIALIZE PC045-COMMAREA-REC.                               02890006
033000     MOVE DFHCOMMAREA                 TO CA-COMMAREA              02900006
033100     MOVE PC233-HOST-SAVE-AREA        TO PC045-COMMAREA-REC       02910006
033200                                                                  02920006
033300     EVALUATE TRUE                                                02930006
033400         WHEN EIBCALEN = ZERO                                     02940006
033500             MOVE PC-ENTER-THROUGH-MENU-MSG                       02950006
033600                                      TO PV-MESSAGE-AREA          02960006
033700             PERFORM 8110-RETURN                                  02970006
033800                                                                  02980006
033900         WHEN EIBTRNID = 'E878'                                   02990006
034000*            COMING FROM THE (UN)LOAD APPLICATION                 03000006
034100             MOVE -1                  TO ADOORL                   03010006
034200             MOVE PC233-DOOR-ID       TO ADOORO                   03020006
034300             MOVE PC233-STR-NBR       TO ADESTO                   03030006
034400             MOVE PC233-SERIAL-NBR    TO ASERIALO                 03040006
034500             MOVE PC233-OWNER-SCAC-ID TO ASCACO                   03050006
034600             MOVE PC233-TRIP-ID       TO ATRIPO                   03060006
034700             MOVE ZEROES              TO APALLO                   03070006
034800             SET PC233-PROCESS-SCREEN TO TRUE                     03080006
034900             MOVE 'PCKRF878'          TO PC233-MENU-PROGRAM       03090006
035000             MOVE DP015-ASK-NOR-MDT   TO APALLA                   03100006
035100             PERFORM 8000-SEND-MAP                                03110006
035200             PERFORM 8100-RETURN-TRANID                           03120006
035300                                                                  03130006
035400         WHEN EIBTRNID = 'E895'                                   03140006
035500*            COMING FROM THE TRAILER AUDIT APPLICATION            03150006
035600             MOVE -1                  TO ADOORL                   03160006
035700             INITIALIZE               PC233-DOOR-ID               03170006
035800                                      PC233-TRIP-ID               03180006
035900                                      PC233-SERIAL-NBR            03190006
036000                                      PC233-OWNER-SCAC-ID         03200006
036100                                      PC233-CARTON                03210006
036200                                      PC233-TRAILER               03220006
036300             MOVE ZEROES               TO APALLO                  03230006
036400             MOVE PC233-STR-NBR        TO ADESTO                  03240006
036500             MOVE DP015-ASK-NOR-MDT    TO ADESTA                  03250006
036600             SET  PC233-PROCESS-SCREEN TO TRUE                    03260006
036700             MOVE PC-FKEY-MSG     TO AMSGLNO                      03270006
036800             PERFORM 8000-SEND-MAP                                03280006
036900             PERFORM 8100-RETURN-TRANID                           03290006
037000                                                                  03300006
037100         WHEN EIBTRNID = 'Z278'                                   03310006
037200*            RETURNING FROM F1 HELP INFO SCREEN                   03320006
037300             MOVE DFHCOMMAREA         TO PC192-COMMAREA           03330006
037400             MOVE PC192-HOST-SAVE-AREA                            03340006
037500                                      TO CA-COMMAREA              03350006
037600             SET PC233-PROCESS-SCREEN TO TRUE                     03360006
037700             MOVE PC192-HOST-SAVE-MAP TO PC870AO                  03370006
037800             MOVE -1                  TO ADOORL                   03380006
037900             PERFORM 8000-SEND-MAP                                03390006
038000             PERFORM 8100-RETURN-TRANID                           03400006
038100                                                                  03410006
038200         WHEN PC233-INITIALIZE-SCREEN                             03420006
038300         WHEN EIBAID = DFHCLEAR                                   03430006
038400             SET PC233-PROCESS-SCREEN TO TRUE                     03440006
038500             PERFORM 1000-INITIALIZE                              03450006
038600             PERFORM 8000-SEND-MAP                                03460006
038700             PERFORM 8100-RETURN-TRANID                           03470006
038800                                                                  03480006
038900         WHEN EIBAID = DFHPF2                                     03490006
039000             PERFORM 8020-RECEIVE-MAP                             03500006
039100             IF PC045-CREATE-DEST-TRIP                            03510006
039200                MOVE PC-STARTED-TRLR-AUD-PGM TO                   03520006
039300                                    PV-TRANSFER-PROGRAM           03530006
039400                PERFORM 8200-XCTL                                 03540006
039500             ELSE                                                 03550006
039600                MOVE -1                  TO ADOORL                03560006
039700                MOVE PC-UNRECOGNIZED-PF-KEY-MSG                   03570006
039800                                         TO AMSGLNO               03580006
039900                PERFORM 8000-SEND-MAP                             03590006
040000                PERFORM 8100-RETURN-TRANID                        03600006
040100             END-IF                                               03610006
040200                                                                  03620006
040300         WHEN EIBAID = DFHPF3                                     03630006
040400             IF PC233-ROOT-PROGRAM = PC-TRLR-AUDIT-START-PGM      03640006
040500                MOVE PC-TRLR-AUDIT-START-PGM                      03650006
040600                                        TO PV-TRANSFER-PROGRAM    03660006
040700             ELSE                                                 03670006
040800                MOVE PC233-MENU-PROGRAM  TO PV-TRANSFER-PROGRAM   03680006
040900             END-IF                                               03690006
041000             PERFORM 8200-XCTL                                    03700006
041100                                                                  03710006
041200         WHEN EIBAID = DFHPF4                                     03720006
041300*            UPDATE DATABASE                                      03730006
041400             PERFORM 8020-RECEIVE-MAP                             03740006
041500                                                                  03750006
041600             IF PC045-CREATE-DEST-TRIP                            03760006
041700                 MOVE -1                  TO ADOORL               03770006
041800                 MOVE PC-UNRECOGNIZED-PF-KEY-MSG                  03780006
041900                                          TO AMSGLNO              03790006
042000                 PERFORM 8000-SEND-MAP                            03800006
042100                 PERFORM 8100-RETURN-TRANID                       03810006
042200             END-IF                                               03820006
042300                                                                  03830006
042400             PERFORM 2100-EDIT-INPUT                              03840006
042500             IF PS-ERRORS-NO                                      03850006
042600                 PERFORM 2000-PROCESS-SCREEN-FIELDS               03860006
042700             END-IF                                               03870006
042800                                                                  03880006
042900                                                                  03890006
043000             IF PS-ERRORS-NO                                      03900006
043100                IF PC233-ROOT-PROGRAM = PC-TRLR-AUDIT-START-PGM   03910006
043200                   MOVE PC-FKEY-CONT-MSG TO AMSGLNO               03920006
043300                   PERFORM 7350-UPDATE-AUD-TRLR-TRIP              03930006
043400                   PERFORM 7360-UPDATE-TSUNAUD                    03940006
043500                   SET PC045-CREATE-DEST-TRIP TO TRUE             03950006
043600                   MOVE PC233-TRIP-ID     TO ATRIPO               03960006
043700                                             PC045-AUD-TO-TRIP-ID 03970006
043800                   MOVE PC045-COMMAREA-REC                        03980006
043900                                          TO PC233-HOST-SAVE-AREA 03990006
044000                   MOVE DP015-ASK-NOR-MDT TO ADOORA               04000006
044100                                             ADESTA               04010006
044200                                             ASERIALA             04020006
044300                                             ASCACA               04030006
044400                                             ATRLRA               04040006
044500                                             ATRIPA               04050006
044600                                             APALLA               04060006
044700                   MOVE -1                TO APALLL               04070017
044800                   PERFORM 8000-SEND-MAP                          04080006
044900                   PERFORM 8100-RETURN-TRANID                     04090006
045000                END-IF                                            04100006
045100             END-IF                                               04110006
045200                                                                  04120006
045300             IF PS-ERRORS-NO                                      04130006
045400                 IF PC233-DIVERT-NBR > ZERO                       04140006
045500                       AND PC233-DIVERT-LOC-ID > SPACES           04150006
045600                     MOVE 'PCKRF874'  TO PV-TRANSFER-PROGRAM      04160006
045700                     MOVE 'PCKRF869'  TO PC233-MENU-PROGRAM       04170006
045800                     MOVE 'PCKRF870'  TO PC233-ROOT-PROGRAM       04180006
045900                     PERFORM 8200-XCTL                            04190006
046000                 ELSE                                             04200006
046100                     MOVE '** TRAILER OPENED **'                  04210006
046200                                      TO AMSGLNO                  04220006
046300                     MOVE -1          TO ADOORO                   04230006
046400                     PERFORM 8000-SEND-MAP                        04240006
046500                     PERFORM 8100-RETURN-TRANID                   04250006
046600                 END-IF                                           04260006
046700             ELSE                                                 04270006
046800                 IF PS-XCTL-E871                                  04280006
046900                     PERFORM 8210-XCTL-ERROR-SCREEN               04290006
047000                 ELSE                                             04300006
047100                     MOVE -1              TO APALLL               04310017
047200                     PERFORM 8000-SEND-MAP                        04320006
047300                     PERFORM 8100-RETURN-TRANID                   04330006
047400                 END-IF                                           04340006
047500             END-IF                                               04350006
047600                                                                  04360006
047700         WHEN EIBAID = DFHPF8                                     04370006
047800             MOVE 'PCKRF880'          TO PV-TRANSFER-PROGRAM      04380006
047900             PERFORM 8200-XCTL                                    04390006
048000                                                                  04400006
048100         WHEN EIBAID = DFHPF9                                     04410006
048200             MOVE 'PCKRF743'          TO PV-TRANSFER-PROGRAM      04420006
048300             PERFORM 8200-XCTL                                    04430006
048400                                                                  04440006
048500         WHEN EIBAID = DFHENTER                                   04450006
048600*            EDIT ONLY                                            04460006
048700             PERFORM 8020-RECEIVE-MAP                             04470006
048800             PERFORM 2100-EDIT-INPUT                              04480006
048900                                                                  04490006
049000             IF PS-ERRORS-YES                                     04500006
049100                 IF PS-XCTL-E871                                  04510006
049200                     PERFORM 8210-XCTL-ERROR-SCREEN               04520006
049300                 ELSE                                             04530006
049400                     PERFORM 8000-SEND-MAP                        04540006
049500                     PERFORM 8100-RETURN-TRANID                   04550006
049600                 END-IF                                           04560006
049700             ELSE                                                 04570006
049800                 MOVE -1              TO APALLL                   04580017
049900                 MOVE PC-FKEY-MSG     TO AMSGLNO                  04590006
050000                 PERFORM 8000-SEND-MAP                            04600006
050100                 PERFORM 8100-RETURN-TRANID                       04610006
050200             END-IF                                               04620006
050300                                                                  04630006
050400         WHEN EIBAID = DFHPF1                                     04640006
050500             PERFORM 8020-RECEIVE-MAP                             04650006
050600             MOVE PC870AO             TO PC192-HOST-SAVE-MAP      04660006
050700             PERFORM 1200-HELP-SCREEN                             04670006
050800                                                                  04680006
050900         WHEN OTHER                                               04690006
051000             PERFORM 8020-RECEIVE-MAP                             04700006
051100             MOVE -1                  TO ADOORL                   04710006
051200             MOVE PC-UNRECOGNIZED-PF-KEY-MSG                      04720006
051300                                      TO AMSGLNO                  04730006
051400             PERFORM 8000-SEND-MAP                                04740006
051500             PERFORM 8100-RETURN-TRANID                           04750006
051600     END-EVALUATE.                                                04760006
051700                                                                  04770006
051800     GOBACK.                                                      04780006
051900                                                                  04790006
052000 1000-INITIALIZE.                                                 04800006
052100                                                                  04810006
052200     MOVE SPACES                      TO AMSGLNO                  04820006
052300*                                        ADOORO                   04830006
052400*    MOVE DP015-ASK-NOR-MDT           TO AQTYA                    04840006
052500     MOVE -1                          TO ADOORL                   04850006
052600                                                                  04860006
052700     IF PC233-ROOT-PROGRAM   =    PC-TRLR-AUDIT-START-PGM         04870006
052800        MOVE PC233-STR-NBR        TO ADESTO                       04880006
052900        MOVE DP015-ASK-NOR-MDT    TO ADESTA                       04890006
053000        INITIALIZE CA-REDEFINED-COMMAREA                          04900006
053100                   PC233-DOOR-ID                                  04910006
053200                   PC233-TRIP-ID                                  04920006
053300                   PC233-SERIAL-NBR                               04930006
053400                   PC233-OWNER-SCAC-ID                            04940006
053500                   PC233-CARTON                                   04950006
053600                   PC233-TRAILER                                  04960006
053700                   PC233-SEAL-ID                                  04970006
053800                   PC233-ERROR-FIELDS                             04980006
053900     ELSE                                                         04990006
054000        INITIALIZE CA-REDEFINED-COMMAREA                          05000006
054100* DRS              PC233-DOOR-ID                                  05010006
054200                   PC233-TRIP-ID                                  05020006
054300                   PC233-SERIAL-NBR                               05030006
054400* DRS              PC233-STR-NBR                                  05040006
054500                   PC233-OWNER-SCAC-ID                            05050006
054600                   PC233-CARTON                                   05060006
054700                   PC233-TRAILER                                  05070006
054800                   PC233-SEAL-ID                                  05080006
054900                   PC233-ERROR-FIELDS                             05090006
055000        MOVE PC233-STR-NBR        TO ADESTO                       05100006
055100        MOVE PC233-DOOR-ID        TO ADOORO                       05110006
055200     END-IF                                                       05120006
055300                                                                  05130006
055400                                                                  05140006
055500     SET PC233-OPEN-TRLR              TO TRUE                     05150006
055600     MOVE PC-TRANID                   TO PC233-TRAN-ID            05160006
055700                                                                  05170006
055800     MOVE PC233-USER-ID               TO PV-USER-ID.              05180006
055900     MOVE PC-FKEY-MSG                 TO AMSGLNO.                 05190006
056000                                                                  05200006
056100*    MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      05210006
056200                                                                  05220006
056300 1200-HELP-SCREEN.                                                05230006
056400     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      05240006
056500     MOVE PC-CURRENT-PROGRAM-NAME     TO PC192-PROGRAM-NAME       05250006
056600     COPY PCPD188.                                                05260006
056700     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      05270006
056800     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     05280006
056900     PERFORM 8220-XCTL-TO-HELP.                                   05290006
057000                                                                  05300006
057100/                                                                 05310006
057200 2000-PROCESS-SCREEN-FIELDS.                                      05320006
057300                                                                  05330006
057400     MOVE PC045-DOOR-TYP-CDE   TO SUOBTR-DOOR-TYP-CDE             05340006
057500                                                                  05350006
057600     PERFORM 7300-SELECT-TSUOBTS.                                 05360006
057700     IF (SUOBTS-TRIP-STAT-CDE = 'SU' OR 'AR' OR 'DR')             05370022
057800                    OR SQLCODE = +100                             05380022
057900         PERFORM 2300-ASSIGN-NEW-TRIP-ID                          05390006
058000         IF PC233-ROOT-PROGRAM = PC-TRLR-AUDIT-START-PGM          05400006
058100            MOVE PC045-DOOR-TYP-CDE  TO SUOBTR-DOOR-TYP-CDE       05410006
058200         END-IF                                                   05420006
058300     ELSE                                                         05430006
058400         IF SUOBTS-TRIP-STAT-CDE = 'SO'                           05440024
058500                   AND SQLCODE = +0                               05450024
058600             MOVE SUOBTR-DEST-OPER-UNT-ID TO                      05460024
058700                                   PC233-ERROR-STR-NBR            05470025
058800             MOVE PC233-SERIAL-NBR  TO PC233-ERROR-SRL-NBR        05480025
058900             MOVE 45 TO PC233-PGM-MSG-NBR                         05490026
059000             SET  PS-XCTL-E871                                    05500025
059100                  PS-ERRORS-YES        TO TRUE                    05510025
059200         ELSE                                                     05520024
059300             MOVE PC233-TRIP-ID       TO SUOBTR-OTBND-TRIP-ID     05530024
059400         END-IF                                                   05540024
059500     END-IF.                                                      05550006
059600                                                                  05560006
059700     IF PC233-TRIP-ID = ZERO                                              
059800         PERFORM 8212-MSG-48                                      16710003
059900     END-IF.                                                              
060000                                                                  05120000
060100     IF PS-ERRORS-NO                                              05570024
060200         IF SUOBTR-DOOR-TYP-CDE = SPACES OR LOW-VALUES            05580024
060300             PERFORM 7010-SELECT-TCNDCDR                          05590024
060400             MOVE CNDCDR-DOOR-TYP-CDE     TO SUOBTR-DOOR-TYP-CDE  05600024
060500         END-IF                                                   05610024
060600                                                                  05620024
060700         PERFORM 3000-MANAGE-ASSIGNMENTS                          05630031
060800         PERFORM 7200-INSERT-TSUOBTR                              05640024
060900         PERFORM 8400-GET-TIMESTAMP                               05650054
061000         PERFORM 7250-INSERT-TSUOBTS                              05660024
061010         IF PS-ERRORS-NO                                                  
061100             PERFORM 7400-INSERT-WRKR-AUD                                 
061200             IF PC233-P4-INTERFACE-YES                                    
061300                PERFORM 4900-CALL-XLKUP033                                
061400             END-IF                                                       
061410         END-IF                                                           
061500     END-IF.                                                      05710072
061600                                                                  05720006
061700/                                                                 05730006
061800 2100-EDIT-INPUT.                                                 05740006
061900                                                                  05750006
062000     SET PS-ERRORS-NO                 TO TRUE                     05760006
062100     MOVE SPACES                      TO AMSGLNO                  05770006
062200                                                                  05780006
062300     IF ADOORA = DP015-ERASE-EOF                                  05790006
062400         MOVE SPACES                  TO PV-SCREEN-DOOR           05800006
062500     ELSE                                                         05810006
062600         MOVE ADOORI                  TO PV-SCREEN-DOOR           05820006
062700     END-IF                                                       05830006
062800                                                                  05840006
062900     IF ADESTA = DP015-ERASE-EOF                                  05850006
063000         MOVE ZEROES                  TO PV-SCREEN-DEST           05860006
063100     ELSE                                                         05870006
063200         MOVE ADESTI                  TO PV-SCREEN-DEST           05880006
063300     END-IF                                                       05890006
063400                                                                  05900006
063500     IF ASERIALA = DP015-ERASE-EOF                                05910006
063600         MOVE ZEROES                  TO PV-SCREEN-SERIAL-NBR     05920006
063700     ELSE                                                         05930006
063800         MOVE ASERIALI                TO PV-SCREEN-SERIAL-NBR     05940006
063900     END-IF                                                       05950006
064000                                                                  05960006
064100     IF APALLA = DP015-ERASE-EOF                                  05970006
064200         MOVE ZEROES                  TO PV-EMPTY-PALLETS         05980006
064300     ELSE                                                         05990006
064400         MOVE APALLI                  TO PV-EMPTY-PALLETS         06000006
064500     END-IF                                                       06010006
064600                                                                  06020006
064700     PERFORM 2110-PRE-EDITS                                       06030006
064800*    (VALIDATE NUMERIC FIELDS AND LOAD CA-CURR FIELDS)            06040006
064900                                                                  06050006
065000     IF PS-ERRORS-NO                                              06060006
065100         IF CA-CURR-SERIAL-NBR > ZERO                             06070006
065200             PERFORM 2120-EDIT-SERIAL-NBR                         06080006
065300         ELSE                                                     06090006
065400             SET PS-SERIAL-NO         TO TRUE                     06100006
065500         END-IF                                                   06110006
065600                                                                  06120006
065700         IF CA-CURR-DOOR > SPACES                                 06130006
065800             MOVE CA-CURR-DOOR        TO PC233-DOOR-ID            06140006
065900             PERFORM 2130-EDIT-DOOR                               06150006
066000         END-IF                                                   06160006
066100     END-IF.                                                      06170006
066200                                                                  06180006
066300* POPULATE DOOR AND STORE DEPENDING ON WHAT WAS SCANNED           06190006
066400                                                                  06200006
066500     IF PS-ERRORS-NO                                              06210006
066600                                                                  06220006
066700     EVALUATE TRUE                                                06230006
066800         WHEN CA-CURR-DEST > ZERO AND CA-CURR-DOOR > SPACES       06240006
066900*            (BOTH WERE ENTERED)                                  06250006
067000             CONTINUE                                             06260006
067100                                                                  06270006
067200         WHEN CA-CURR-DOOR > SPACES                               06280006
067300*            (ENTERED DOOR BUT NOT DEST)                          06290006
067400                                                                  06300006
067500             PERFORM 7060-SELECT-TCNDRST                          06310006
067600*              IS THERE ONLY ONE STORE FOR THIS DOOR?             06320006
067700                                                                  06330006
067800             IF SQLCODE = ZERO                                    06340006
067900*              YES THERE IS ONLY ONE STORE FOR THIS DOOR          06350006
068000                 MOVE CNDRST-STR-NBR  TO ADESTO                   06360006
068100                                         PC233-STR-NBR            06370006
068200                 MOVE DP015-ASK-NOR-MDT                           06380006
068300                                      TO ADESTA                   06390006
068400                                                                  06400006
068500                 PERFORM 7070-CHECK-OPEN-TRAILERS                 06410006
068600*              IS THERE AN OPEN TRAILER ASSIGNED TO THIS DOOR?    06420006
068700                                                                  06430006
068800                 IF SQLCODE = ZERO                                06440006
068900*              YES THERE IS AN OPEN TRAILER ASSIGNED TO THIS DOOR 06450006
069000                     MOVE SUOBTR-TRLR-SRL-NBR                     06460006
069100                                      TO ASERIALO                 06470006
069200                                         PC233-SERIAL-NBR         06480006
069300                     MOVE SUOBTS-OTBND-TRIP-ID                    06490006
069400                                      TO ATRIPO                   06500006
069500                                         PC233-TRIP-ID            06510006
069600                     MOVE ZEROES      TO PC233-EMPTY-PALLETS      06520006
069700                                         CA-EMPTY-PALLETS         06530006
069800                                         APALLO                   06540006
069900                     MOVE DP015-ASK-NOR-MDT   TO APALLA           06550006
070000                     PERFORM 7000-SELECT-TCNTRID                  06560006
070100                     IF PS-TCNTRID-YES                            06570006
070200                         MOVE CNTRID-SCAC-CDE                     06580006
070300                                      TO ASCACO                   06590006
070400                                         PC233-OWNER-SCAC-ID      06600006
070500                         MOVE CNTRID-TRLR-ID                      06610006
070600                                      TO PC233-TRAILER            06620006
070700                                         ATRLRO                   06630006
070800                         MOVE CNTRID-TRLR-SIZE-MU                 06640006
070900                                      TO ALENGTHO                 06650006
071000                     END-IF                                       06660006
071100                                                                  06670006
071200*                ELSE                                             06680006
071300*                    SET PS-ERRORS-YES                            06690006
071400*                                     TO TRUE                     06700006
071500*                    MOVE -1          TO ADESTL                   06710006
071600*                    MOVE '   DEST REQUIRED   '                   06720006
071700*                                     TO AMSGLNO                  06730006
071800                 END-IF                                           06740006
071900             END-IF                                               06750006
072000                                                                  06760006
072100         WHEN CA-CURR-DEST > ZERO                                 06770006
072200*            (ENTERED DEST BUT NOT DOOR)                          06780006
072300                                                                  06790006
072400             PERFORM 7080-SELECT-TCNDRST                          06800006
072500*            IS STORE ALSO AT ANOTHER DOOR?                       06810006
072600                                                                  06820006
072700             IF SQLCODE = ZERO                                    06830006
072800                 MOVE CNDRST-DOOR-ID  TO PC233-DOOR-ID            06840006
072900                                         ADOORO                   06850006
073000*            THE STORE IS ASSIGNED TO ONLY ONE DOOR               06860006
073100                                                                  06870006
073200                 PERFORM 7090-SELECT-TCNDRST                      06880006
073300*            IS THERE ONLY ONE TRAILER ASSIGNED TO THIS STORE?    06890006
073400                                                                  06900006
073500                 EVALUATE SQLCODE                                 06910006
073600                                                                  06920006
073700                 WHEN ZERO                                        06930006
073800*                 THERE IS ONLY ONE TRAILER ASSIGNED TO THIS STORE06940006
073900                     MOVE SUOBTR-TRLR-SRL-NBR                     06950006
074000                                      TO ASERIALO                 06960006
074100                                         PC233-SERIAL-NBR         06970006
074200                     MOVE SUOBTR-OTBND-TRIP-ID                    06980006
074300                                      TO ATRIPO                   06990006
074400                                         PC233-TRIP-ID            07000006
074500                     PERFORM 7000-SELECT-TCNTRID                  07010006
074600                     IF PS-TCNTRID-YES                            07020006
074700                         MOVE CNTRID-SCAC-CDE                     07030006
074800                                      TO ASCACO                   07040006
074900                                         PC233-OWNER-SCAC-ID      07050006
075000                         MOVE CNTRID-TRLR-ID                      07060006
075100                                      TO PC233-TRAILER            07070006
075200                                         ATRLRO                   07080006
075300                         MOVE CNTRID-TRLR-SIZE-MU                 07090006
075400                                      TO ALENGTHO                 07100006
075500                     END-IF                                       07110006
075600                                                                  07120006
075700                 WHEN -811                                        07130006
075800*               THERE ARE MULTIPLE TRAILERS ASSIGNED TO THIS STORE07140006
075900                         MOVE SUOBTS-DOOR-ID                      07150006
076000                                      TO ADOORO                   07160006
076100                                         PC233-DOOR-ID            07170006
076200                 WHEN OTHER                                       07180006
076300*                UNABLE TO PRE-LOAD DOOR.  USER MUST ENTER VALUE  07190006
076400                     SET PS-ERRORS-YES                            07200006
076500                                      TO TRUE                     07210006
076600*                    MOVE -1          TO ADOORL                   07220006
076700*                    MOVE '   DOOR REQUIRED   '                   07230006
076800*                                     TO AMSGLNO                  07240006
076900                 END-EVALUATE                                     07250006
077000             END-IF                                               07260006
077100         WHEN OTHER                                               07270006
077200*            (NEITHER DEST NOR DOOR WAS ENTERED)                  07280006
077300             IF PC233-SERIAL-NBR > ZERO                           07290006
077400                 PERFORM 7100-GET-STR-DOOR-FROM-TRAILER           07300006
077500                 IF SQLCODE = ZERO                                07310006
077600                     MOVE SUOBTS-DOOR-ID                          07320006
077700                                      TO ADOORO                   07330006
077800                                         PC233-DOOR-ID            07340006
077900                     MOVE SUOBTR-DEST-OPER-UNT-ID                 07350006
078000                                      TO ADESTO                   07360006
078100                                         PC233-STR-NBR            07370006
078200                     MOVE ZEROES      TO PC233-EMPTY-PALLETS      07380006
078300                                         CA-EMPTY-PALLETS         07390006
078400                                         APALLO                   07400006
078500                     MOVE DP015-ASK-NOR-MDT   TO APALLA           07410006
078600                 END-IF                                           07420006
078700             ELSE                                                 07430006
078800                 SET PS-ERRORS-YES                                07440006
078900                                      TO TRUE                     07450006
079000                 MOVE -1              TO ADOORL                   07460006
079100                 MOVE 'DOOR/DEST REQUIRED '                       07470006
079200                                      TO AMSGLNO                  07480006
079300             END-IF                                               07490006
079400         END-EVALUATE                                             07500006
079500                                                                  07510006
079600     END-IF.                                                      07520006
079700                                                                  07530006
079800     IF PS-ERRORS-NO                                              07540006
079900         IF PC233-DOOR-ID > SPACES AND PC233-STR-NBR > ZERO       07550006
080000                  AND PC233-SERIAL-NBR > ZERO                     07560006
080100             CONTINUE                                             07570006
080200         ELSE                                                     07580006
080300             SET PS-ERRORS-YES        TO TRUE                     07590006
080400             IF PC233-SERIAL-NBR = ZERO                           07600006
080500                 MOVE -1              TO ASERIALL                 07610006
080600                 MOVE '  SER NBR REQUIRED '                       07620006
080700                                      TO AMSGLNO                  07630006
080800             END-IF                                               07640006
080900             IF PC233-STR-NBR = ZERO                              07650006
081000                         MOVE -1      TO ADESTL                   07660006
081100                         MOVE '   DEST REQUIRED   '               07670006
081200                                      TO AMSGLNO                  07680006
081300             END-IF                                               07690006
081400             IF PC233-DOOR-ID = SPACES                            07700006
081500                 MOVE -1              TO ADOORL                   07710006
081600                 MOVE '   DOOR REQUIRED   '                       07720006
081700                                      TO AMSGLNO                  07730006
081800             END-IF                                               07740006
081900         END-IF                                                   07750006
082000     END-IF                                                       07760006
082100                                                                  07770006
082200     IF PS-ERRORS-NO                                              07780006
082300         PERFORM 2200-CONSISTENCY-EDITS                           07790006
082400     END-IF.                                                      07800006
082500                                                                  07810006
082600 2110-PRE-EDITS.                                                  07820006
082700     MOVE PV-SCREEN-SERIAL-NBR        TO DP010I-UNEDITED-FIELD    07830006
082800     MOVE LENGTH OF PV-SCREEN-SERIAL-NBR                          07840006
082900                                      TO DP010I-MAXIMUM-DIGITS    07850006
083000     MOVE ZERO                        TO DP010I-MAXIMUM-DECIMALS  07860006
083100     SET DP010I-NEGATIVE-NOT-ALLOWED  TO TRUE                     07870006
083210     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
083220                         USING DP010I-NUMERIC-EDIT-AREA                   
083300     IF DP010I-ERROR-DETECTED                                     07890006
083400         SET PS-ERRORS-YES            TO TRUE                     07900006
083500         MOVE -1                      TO ASERIALL                 07910006
083600                                                                  07920006
083700         MOVE 'SER NBR NOT NUMERIC '                              07930006
083800                                      TO AMSGLNO                  07940006
083900     ELSE                                                         07950006
084000         MOVE DP010I-NUMERIC-FIELD    TO CA-CURR-SERIAL-NBR       07960006
084100                                         PC233-SERIAL-NBR         07970006
084200     END-IF.                                                      07980006
084300                                                                  07990006
084400     MOVE PV-SCREEN-DEST              TO DP010I-UNEDITED-FIELD    08000006
084500     MOVE LENGTH OF PV-SCREEN-DEST    TO DP010I-MAXIMUM-DIGITS    08010006
084600     MOVE ZERO                        TO DP010I-MAXIMUM-DECIMALS  08020006
084700     SET DP010I-NEGATIVE-NOT-ALLOWED  TO TRUE                     08030006
084710     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
084720                         USING DP010I-NUMERIC-EDIT-AREA                   
084900     IF DP010I-ERROR-DETECTED                                     08050006
085000         SET PS-ERRORS-YES            TO TRUE                     08060006
085100         MOVE -1                      TO ADESTL                   08070006
085200                                                                  08080006
085300         MOVE ' DEST NOT NUMERIC  '   TO AMSGLNO                  08090006
085400     ELSE                                                         08100006
085500         MOVE DP010I-NUMERIC-FIELD    TO CA-CURR-DEST             08110006
085600                                         PC233-STR-NBR            08120006
085700     END-IF.                                                      08130006
085800                                                                  08140006
085900     MOVE PV-SCREEN-DOOR              TO CA-CURR-DOOR.            08150006
086000                                                                  08160006
086100                                                                  08170006
086200     MOVE PV-EMPTY-PALLETS            TO DP010I-UNEDITED-FIELD    08180006
086300     MOVE LENGTH OF PV-EMPTY-PALLETS                              08190006
086400                                      TO DP010I-MAXIMUM-DIGITS    08200006
086500     MOVE ZERO                        TO DP010I-MAXIMUM-DECIMALS  08210006
086600     SET DP010I-NEGATIVE-NOT-ALLOWED  TO TRUE                     08220006
086710     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
086720                         USING DP010I-NUMERIC-EDIT-AREA                   
086800     IF DP010I-ERROR-DETECTED                                     08240006
086900         SET PS-ERRORS-YES            TO TRUE                     08250006
087000         MOVE -1                      TO APALLL                   08260006
087100                                                                  08270006
087200         MOVE 'PALLETS NOT NUMERIC '                              08280006
087300                                      TO AMSGLNO                  08290006
087400     ELSE                                                         08300006
087500         MOVE DP010I-NUMERIC-FIELD    TO CA-EMPTY-PALLETS         08310006
087600                                         PC233-EMPTY-PALLETS      08320006
087700     END-IF.                                                      08330006
087800                                                                  08340006
087900/                                                                 08350006
088000* THE FOLLOWING EDITS CHECK THE VALIDITY OF ENTITIES IN           08360006
088100* THEMSELVES NOT HOW THEY MIGHT RELATE TO OTHER FIELDS ON         08370006
088200* THE SCREEN.                                                     08380006
088300                                                                  08390006
088400 2120-EDIT-SERIAL-NBR.                                            08400006
088500* IS THIS SERIAL NBR CONNECTED TO A SCAC/TRAILER AT ALL?          08410006
088600     PERFORM 7000-SELECT-TCNTRID                                  08420006
088700     IF PS-TCNTRID-NO                                             08430006
088800         SET PS-SERIAL-NO                                         08440006
088900             PS-ERRORS-YES            TO TRUE                     08450006
089000         MOVE -1                      TO ASERIALL                 08460006
089100                                                                  08470006
089200         MOVE ' TRAILER NOT FOUND '   TO AMSGLNO                  08480006
089300     ELSE                                                         08490006
089400         SET PS-SERIAL-YES            TO TRUE                     08500006
089500         MOVE CNTRID-SCAC-CDE         TO ASCACO                   08510006
089600                                         PC233-OWNER-SCAC-ID      08520006
089700         MOVE CNTRID-TRLR-ID          TO PC233-TRAILER            08530006
089800                                         ATRLRO                   08540006
089900         MOVE CNTRID-TRLR-SIZE-MU     TO ALENGTHO                 08550006
090000     END-IF.                                                      08560006
090100                                                                  08570006
090200 2130-EDIT-DOOR.                                                  08580006
090300* IS THIS A SHIPPING OR SHUTTLE DOOR IN THE CURRENT LOCATION?     08590006
090400     PERFORM 7010-SELECT-TCNDCDR                                  08600006
090500                                                                  08610006
090600     IF PS-TCNDCDR-YES                                            08620006
090700         IF CA-CURR-DEST = ZERO                                   08630006
090800             PERFORM 7011-SELECT-TCNDRST                          08640006
090900         END-IF                                                   08650006
091000         IF CNDCDR-DOOR-TYP-CDE = 'SH' OR 'DS' OR 'ST'            08660006
091100             SET PS-DO-DOOR-DEST-EDITS                            08670006
091200                                      TO TRUE                     08680006
091210***  DMH - BEGIN 6/6/06                                                   
091300***      ELSE                                                     08690006
091400***      IF CNDCDR-DOOR-TYP-CDE = 'ST'                            08700018
091500***          SET PS-SKIP-DOOR-DEST-EDITS                          08710018
091600***                                   TO TRUE                     08720018
091610***  DMH - END 6/6/06                                                     
091620                                                                          
091700* DMH - BEGIN 4/20/2004 - BEGIN                                   08721087
091800         ELSE                                                     08721187
091900         IF CNDCDR-DOOR-TYP-CDE = 'SG'                            08721287
092000             MOVE 47 TO PC233-PGM-MSG-NBR                         08721388
092100             SET  PS-XCTL-E871                                    08721487
092200                  PS-ERRORS-YES        TO TRUE                    08721587
092300* DMH - BEGIN 4/20/2004 - END                                     08722087
092301                                                                          
092310* DMH - BEGIN 1/21/2005 - BEGIN                                   08721087
092311* MUST BE A SHIPPING(SH), SHUTTLE (DS) OR STORAGE(ST) DOOR        08721087
092320         ELSE                                                     08721187
092330         IF (CNDCDR-DOOR-TYP-CDE NOT = 'SH'  AND                  08721287
092331             CNDCDR-DOOR-TYP-CDE NOT = 'DS'  AND                  08721287
092332             CNDCDR-DOOR-TYP-CDE NOT = 'ST')                      08721287
092340             MOVE 49 TO PC233-PGM-MSG-NBR                         08721388
092350             SET  PS-XCTL-E871                                    08721487
092360                  PS-ERRORS-YES        TO TRUE                    08721587
092370* DMH - BEGIN 1/21/2005 - END                                     08722087
092380                                                                          
092400         ELSE                                                     08730018
092500             IF CNDCDR-DIVERT-NBR = ZERO                          08740006
092600                 SET PS-SKIP-DOOR-DEST-EDITS                      08750006
092700                                      TO TRUE                     08760006
092800             ELSE                                                 08770006
092900                 SET PS-DO-DOOR-DEST-EDITS                        08780006
093000                                      TO TRUE                     08790006
093100             END-IF                                               08800006
093200         END-IF                                                   08810006
093210*** 6/6  END-IF                                                   08810006
093300         END-IF                                                   08811087
093400         END-IF                                                   08820018
093500     ELSE                                                         08830006
093600         SET PS-ERRORS-YES            TO TRUE                     08840006
093700         MOVE -1                      TO ADOORL                   08850006
093800         MOVE ' DOOR NOT DEFINED  '   TO AMSGLNO                  08860006
093900     END-IF.                                                      08870006
094000                                                                  08880006
094100 2200-CONSISTENCY-EDITS.                                          08890006
094200*  CHECK THE RELATIONSHIPS BETWEEN THE FIELDS.                    08900006
094300                                                                  08910006
094400     PERFORM 2205-GET-TRAILER-INFO.                               08920006
094500                                                                  08930006
094600     IF PS-ERRORS-NO                                              08940006
094700         PERFORM 2210-TRLR-AT-ANOTHER-DOOR                        08950006
094800     END-IF                                                       08960006
094900                                                                  08970006
095000     IF PS-ERRORS-NO                                              08980006
095100         PERFORM 2220-DIFF-TRLR-AT-THIS-DOOR                      08990006
095200     END-IF                                                       09000006
095300                                                                  09010006
095400     IF PC233-LAST-PROGRAM = PC-TRAILER-AUDIT-TO-PGM              09020006
095500         SET PS-SKIP-DOOR-DEST-EDITS TO TRUE                      09030006
095600     END-IF                                                       09040006
095700                                                                  09050006
095800     IF PS-ERRORS-NO AND PS-DO-DOOR-DEST-EDITS                    09060006
095900         PERFORM 2230-CHECK-STORES-THIS-DOOR                      09070006
096000     END-IF                                                       09080006
096100                                                                  09090006
096200     IF  PS-ERRORS-NO AND PS-ACTIVE-TRIP-EXISTS                   09100007
096300         IF  SUOBTS-TRIP-STAT-CDE NOT EQUAL 'SU'                  09110007
096400             PERFORM 2235-VALIDATE-INTENDED-ACTION                09120007
096500         END-IF                                                   09130007
096600     END-IF                                                       09140006
096700                                                                  09150006
096800     IF PS-ERRORS-NO AND PS-ACTIVE-TRIP-EXISTS                    09160006
096900         PERFORM 2240-IS-TRAILER-CLOSED                           09170006
097000     END-IF.                                                      09180006
097100                                                                  09190006
097200 2205-GET-TRAILER-INFO.                                           09200006
097300     PERFORM 7050-SELECT-TRAILER-STATUS.                          09210006
097400     MOVE SUOBTS-OTBND-TRIP-ID        TO ATRIPO                   09220006
097500                                         PC233-TRIP-ID            09230006
097600     MOVE CNTRID-SCAC-CDE             TO PC233-OWNER-SCAC-ID      09240006
097700                                         PC233-ERROR-SCAC-ID      09250006
097800     MOVE CNTRID-TRLR-ID              TO PC233-ERROR-TRLR-ID.     09260006
097900     MOVE CNTRID-TRLR-SRL-NBR         TO PC233-ERROR-SRL-NBR.     09270006
098000                                                                  09280006
098100 2210-TRLR-AT-ANOTHER-DOOR.                                       09290006
098200     PERFORM 7020-FIND-OTHER-DOOR.                                09300006
098300                                                                  09310006
098400 2220-DIFF-TRLR-AT-THIS-DOOR.                                     09320006
098500     PERFORM 7030-FIND-OTHER-TRLR.                                09330006
098600                                                                  09340006
098700 2230-CHECK-STORES-THIS-DOOR.                                     09350006
098800*    OPEN A CURSOR THAT IS A LIST OF ALL DOORS ASSIGNED FOR THE   09360006
098900*    GIVEN STORE.  THERE SHOULD ONLY BE ONE DOOR FOR ANY STORE.   09370006
099000                                                                  09380006
099100     MOVE ZERO                        TO PV-DOOR-COUNT            09390006
099200                                                                  09400006
099300     PERFORM 7043-CK-MULT-STOR-DOOR.                              09410029
099400                                                                  09420029
099500     PERFORM 7040-OPEN-STORE-DOOR-CSR.                            09430006
099600     PERFORM 7041-FETCH-STORE-DOOR-CSR UNTIL                      09440006
099700             PS-END-STORE-DOOR-CSR                                09450006
099800     PERFORM 7042-CLOSE-STORE-DOOR-CSR.                           09460006
099900                                                                  09470006
099910*** DMH - BEGIN 6/6/06                                            09470006
099911     IF  CNDCDR-DOOR-TYP-CDE = 'ST'                                       
099912         SET  PS-STORAGE-DOOR  TO  TRUE                                   
099913         PERFORM 7044-CHECK-DEST-DC                                       
099914     ELSE                                                                 
099915         SET  PS-NOT-STORAGE-DOOR  TO  TRUE                               
099916     END-IF.                                                              
099917*** DMH - END   6/6/06                                            09470006
099920                                                                  09470006
100000     EVALUATE TRUE                                                09480006
100010     WHEN PS-STORAGE-DOOR                                         09490006
100011          IF  PS-LOCATION-DC                                              
100020              CONTINUE                                                    
100030          ELSE                                                            
100031              SET  PC233-STRG-TRLR-MUST-BE-DC  TO  TRUE                   
100032              MOVE PC233-STR-NBR       TO PC233-ERROR-STR-NBR             
100034              SET PS-XCTL-E871                                            
100035                  PS-ERRORS-YES        TO TRUE                            
100040          END-IF                                                          
100050                                                                          
100100     WHEN PS-ONE-DOOR-THIS-STORE                                  09490006
100200         CONTINUE                                                 09500006
100300     WHEN PS-MLT-DOORS-THIS-STORE                                 09510006
100400         SET  PC233-STORE-OTHER-DOOR  TO TRUE                     09520006
100500         MOVE PC233-STR-NBR           TO PC233-ERROR-STR-NBR      09530006
100600*        MOVE 'MULT'                  TO PC233-ERROR-DOOR-NBR     09540006
100700             SET PS-XCTL-E871                                     09550006
100800                 PS-ERRORS-YES        TO TRUE                     09560006
100900     WHEN PS-NO-DOORS-THIS-STORE                                  09570006
101000         SET  PC233-STORE-OTHER-DOOR  TO TRUE                     09580006
101100         MOVE PC233-STR-NBR           TO PC233-ERROR-STR-NBR      09590006
101200         MOVE 'NONE'                  TO PC233-ERROR-DOOR-NBR     09600006
101300             SET PS-XCTL-E871                                     09610006
101400                 PS-ERRORS-YES        TO TRUE                     09620006
101500     END-EVALUATE.                                                09630006
101600/                                                                 09640006
101700 2235-VALIDATE-INTENDED-ACTION.                                   09650006
101800     PERFORM 7110-CHECK-STATUS-CODES.                             09660006
101900     IF SQLCODE = +100                                            09670006
102000         SET PS-ERRORS-YES            TO TRUE                     09680006
102100         MOVE -1                      TO ADOORL                   09690006
102200         PERFORM 7111-SELECT-TSUOBSC                              09700006
102300         STRING                                                   09710006
102400             'STATUS: '                                           09720006
102500             SUOBSC-STAT-SHRT-DESC                                09730006
102600             DELIMITED BY SIZE      INTO AMSGLNO                  09740006
102700     END-IF.                                                      09750006
102800/                                                                 09760006
102900 2240-IS-TRAILER-CLOSED.                                          09770006
103000                                                                  09780006
103100* SWITCH IS SET IN PARA 2205-GET-TRAILER-INFO                     09790006
103200     IF PS-ACTIVE-TRIP-EXISTS                                     09800006
103300         EVALUATE TRUE                                            09810006
103400         WHEN SUOBTS-TRIP-STAT-CDE = 'DO'                         09820006
103500             SET PS-ERRORS-YES        TO TRUE                     09830006
103600             MOVE -1                  TO ADOORL                   09840006
103700                                                                  09850006
103800             MOVE SUOBTS-OTBND-TRIP-ID                            09860006
103900                                      TO ATRIPO                   09870006
104000                                         PC233-TRIP-ID            09880006
104100             MOVE ' TRLR ALREADY OPEN '                           09890006
104200                                      TO AMSGLNO                  09900006
104300         WHEN SUOBTS-TRIP-STAT-CDE = 'DC' OR 'AK'                 09910019
104400             IF PS-DOOR-MISMATCH-ERROR                            09920011
104500               MOVE 43 TO PC233-PGM-MSG-NBR                       09930014
104600               SET  PS-XCTL-E871                                  09940012
104700                    PS-ERRORS-YES        TO TRUE                  09950012
104800             ELSE                                                 09960011
104900               MOVE CNTRID-SCAC-CDE  TO PC233-ERROR-SCAC-ID       09970011
105000               MOVE CNTRID-TRLR-ID    TO PC233-ERROR-TRLR-ID      09980011
105100               MOVE SUOBTS-OTBND-TRIP-ID                          09990011
105200                                      TO PC233-ERROR-TRIP-ID      10000011
105300                                         PC233-TRIP-ID            10010011
105400               MOVE PC233-SERIAL-NBR  TO PC233-ERROR-SRL-NBR      10020011
105500               MOVE 'PCKRF875'        TO PC233-NEXT-PROGRAM       10030011
105600               SET  PC233-TRAILER-CLOSED  TO TRUE                 10040011
105700               SET  PS-XCTL-E871                                  10050011
105800                    PS-ERRORS-YES        TO TRUE                  10060011
105900           END-IF                                                 10070011
106000         END-EVALUATE                                             10080006
106100     END-IF.                                                      10090006
106200                                                                  10100006
106300 2300-ASSIGN-NEW-TRIP-ID.                                         10110006
106400                                                                  10120006
106500     CALL PC-RAND-PGM USING DFHEIBLK                              10130006
106600                              DFHCOMMAREA                         10140006
106700                              DP902-RANDNBR-ROUTINE-FIELDS.       10150006
106800                                                                  10160006
106900     IF DP902-SUCCESSFUL                                          10170006
107000         MOVE DP902-RANDOM-NUMBER     TO SUOBTR-OTBND-TRIP-ID     10180006
107100                                         SUOBTS-OTBND-TRIP-ID     10190006
107200                                         PC233-TRIP-ID            10200006
107300     ELSE                                                         10210006
107400         SET PS-ERRORS-YES            TO TRUE                     10220006
107500         MOVE 1                       TO PV-ERROR-NBR             10230006
107600                                         PC233-ERROR-NBR          10240006
107700         PERFORM 9903-WRITE-CICS-LOG                              10250006
107800         MOVE '2100-ASSIGN-NEW-TRIP-ID'                           10260006
107900                                      TO PC233-PARAGRAPH          10270006
108000         MOVE 'PCKRF870 - RANDOM NBR ROUTINE'                     10280006
108100                                      TO PC233-MESSAGE-TEXT(1)    10290006
108200         MOVE SQLCA                   TO PC233-SQLCA              10300006
108300         MOVE 'NONE   '               TO PC233-DB2-TABLE-NAME(1)  10310006
108400         SET PC233-ABEND              TO TRUE                     10320006
108500         MOVE 99                      TO PC233-PGM-MSG-NBR        10330006
108600         PERFORM 8210-XCTL-ERROR-SCREEN                           10340006
108700     END-IF.                                                      10350006
108800/                                                                 10360006
108900                                                                  10370031
109000****************************************************************  10380031
109100*    DETERMINES WHETHER INTERFACING OR MANAGING OF ASSIGNMENTS *  10390064
109200*    NEEDS TO BE DONE.                                         *  10400031
109300****************************************************************  10410031
109400 3000-MANAGE-ASSIGNMENTS.                                         10420031
109500                                                                  10430031
109600     EVALUATE TRUE                                                10440045
109700         WHEN PC233-P4-INTERFACE-YES                              10450045
109800              PERFORM 3100-FIND-DOOR-GROUP                        10460045
109900                                                                  10470045
110000         WHEN PC233-P4-INTERFACE-NO                               10480045
110100              CONTINUE                                            10490045
110200                                                                  10500045
110300         WHEN OTHER                                               10510049
110400              PERFORM 3200-SELECT-TKRPRPM-DLSHPI                  10520045
110500                                                                  10530045
110600              IF PC233-P4-INTERFACE-YES                           10540045
110700                 PERFORM 3100-FIND-DOOR-GROUP                     10550045
110800              END-IF                                              10560045
110900                                                                  10570045
111000     END-EVALUATE.                                                10580045
111100                                                                  10590045
111200****************************************************************  10600045
111300*    PC233-DOOR-ID IS THE DOOR NUMBER THAT THEY ARE WORKING AT.*  10610049
111400*          IF IT IS EQUAL TO THE PC233-P4-DOOR-ID, THEN WE     *  10620049
111500*          ARE DONE BECAUSE AN ASSIGNMENT HAS ALREADY BEEN     *  10630049
111600*          ESTABLISHED.                                        *  10640049
111700****************************************************************  10650045
111800 3100-FIND-DOOR-GROUP.                                            10660045
111900                                                                  10670045
112000     IF PC233-P4-DOOR-ID = PC233-DOOR-ID                          10680072
112100        INITIALIZE DL001-ASGMT-COMMAREA                           10690072
112200                                                                  10700072
112300        MOVE PC233-ASGMT-STRT-DTE    TO DL001-KEY-START-DTE       10710073
112400        MOVE PC233-ASGMT-NBR-TXT     TO DL001-KEY-NBR-TXT         10720072
112500        MOVE PC233-ASGMT-NBR-SEQ-NBR TO DL001-KEY-NBR-SEQ-NBR     10730072
112600        PERFORM 4000-CALL-DLKUP001                                10740072
112700        IF DL001-ASGMT-CLOSED-RETURN                              10750084
112800            PERFORM 3600-CALL-DLKCS410                            10760085
112900        END-IF                                                    10770085
113000     ELSE                                                         10780072
113100        PERFORM 3400-DETERMINE-DOOR-GROUP                         10790045
113200                                                                  10800045
113300        IF PS-DOOR-GROUP-FOUND-YES                                10810045
113400           IF DLT00001-DOOR-GP-NBR =                              10820075
113500                                    PC233-P4-DOOR-GP-NBR          10830075
113600             MOVE PC233-DOOR-ID TO PC233-P4-DOOR-ID               10840083
113700             INITIALIZE DL001-ASGMT-COMMAREA                      10850085
113800             MOVE PC233-ASGMT-STRT-DTE    TO DL001-KEY-START-DTE  10860083
113900             MOVE PC233-ASGMT-NBR-TXT     TO DL001-KEY-NBR-TXT    10870083
114000             MOVE PC233-ASGMT-NBR-SEQ-NBR TO DL001-KEY-NBR-SEQ-NBR10880083
114100             PERFORM 4000-CALL-DLKUP001                           10890083
114200             IF DL001-ASGMT-CLOSED-RETURN                         10900083
114300                PERFORM 3400-DETERMINE-DOOR-GROUP                 10910083
114400                PERFORM 3600-CALL-DLKCS410                        10920083
114500                PERFORM 4000-CALL-DLKUP001                        10930083
114600             END-IF                                               10940083
114700           ELSE                                                   10950045
114800              PERFORM 3600-CALL-DLKCS410                          10960049
114900              INITIALIZE DL001-ASGMT-COMMAREA                     10970072
115000                                                                  10980072
115100              MOVE DL016-ESO-ASGMT-START-DTE   TO                 10990072
115200                                            DL001-KEY-START-DTE   11000072
115300              MOVE DL016-ESO-ASGMT-NBR-TXT     TO                 11010072
115400                                            DL001-KEY-NBR-TXT     11020072
115500              MOVE DL016-ESO-ASGMT-NBR-SEQ-NBR TO                 11030072
115600                                            DL001-KEY-NBR-SEQ-NBR 11040072
115700              PERFORM 4000-CALL-DLKUP001                          11050049
115800              IF DL001-ASGMT-CLOSED-RETURN                        11060050
115900                 PERFORM 3600-CALL-DLKCS410                       11070050
116000              END-IF                                              11080050
116100              MOVE PC233-DOOR-ID TO PC233-P4-DOOR-ID              11090060
116200              MOVE DLT00001-DOOR-GP-NBR TO                        11100075
116300                                    PC233-P4-DOOR-GP-NBR          11110075
116400           END-IF                                                 11120050
116500        END-IF                                                    11130045
116600     END-IF.                                                      11140031
116700                                                                  11150031
116800                                                                  11160031
116900****************************************************************  11170031
117000*    DETERMINES WHETHER INTERFACING OF MANAGING OF ASSIGNMENTS *  11180031
117100*    NEEDS TO BE DONE.                                         *  11190031
117200****************************************************************  11200031
117300 3200-SELECT-TKRPRPM-DLSHPI.                                      11210045
117400                                                                  11220031
117500     EXEC SQL                                                     11230031
117600       SELECT                                                     11240031
117700               FUNC_TXT                                           11250031
117800         INTO                                                     11260031
117900              :KRPRPM-FUNC-TXT                                    11270031
118000         FROM  TKRPRPM                                            11280031
118100        WHERE  LOC_ID            = :PC233-OPER-UNT-ID             11290031
118200          AND  INTFC_SYS_CDE     = :PC-DLX                        11300031
118300          AND  SYS_PRC_FUNC_CDE  = :PC-DLSHPI                     11310031
118400                                                                  11320031
118500     END-EXEC.                                                    11330031
118600                                                                  11340031
118700     EVALUATE TRUE                                                11350031
118800         WHEN SQLCODE = ZERO                                      11360031
118900              IF KRPRPM-FUNC-TXT = 'Y'                            11370032
119000                 SET PC233-P4-INTERFACE-YES TO TRUE               11380032
119100              ELSE                                                11390032
119200                 SET PC233-P4-INTERFACE-NO  TO TRUE               11400032
119300              END-IF                                              11410032
119400         WHEN SQLCODE = +100                                      11420032
119500              SET PC233-P4-INTERFACE-NO  TO TRUE                  11430032
119600         WHEN SQLCODE = -904                                      11440032
119700         WHEN SQLCODE = -913                                      11450032
119800         WHEN SQLCODE = -911                                      11460032
119900              MOVE 16                  TO PV-ERROR-NBR            11470032
120000              PERFORM 9903-WRITE-CICS-LOG                         11480032
120100              PERFORM 9000-SOFT-ABORT                             11490032
120200         WHEN SQLWARN0 NOT = SPACES                               11500032
120300         WHEN SQLCODE NOT EQUAL ZERO                              11510032
120400              SET PC233-P4-INTERFACE-NO  TO TRUE                  11520032
120500              PERFORM 3500-FORMAT-COMMON-DATA                     11530066
120600                                                                  11540066
120700              MOVE '3200-SELECT-TKRPRPM-DLSHPI'                   11550066
120800                                       TO PC233-PARAGRAPH         11560066
120900              STRING PC-CURRENT-PROGRAM-NAME                      11570066
121000                     ' - LOOKUP LABOR INTERFACING'                11580066
121100                      DELIMITED BY SIZE                           11590066
121200                      INTO PC233-MESSAGE-TEXT(1)                  11600066
121300              MOVE SQLCA               TO PC233-SQLCA             11610066
121400              MOVE 'TKRPRPM'           TO PC233-DB2-TABLE-NAME(1) 11620066
121500              SET PC233-ABEND          TO TRUE                    11630066
121600              MOVE 99                  TO PC233-PGM-MSG-NBR       11640066
121700              PERFORM 8210-XCTL-ERROR-SCREEN                      11650066
121800     END-EVALUATE.                                                11660032
121900                                                                  11670032
122000****************************************************************  11680032
122100*    FIND THE DOOR GROUP FOR THE DOOR.                         *  11690049
122200*                                                              *  11700032
122300****************************************************************  11710032
122400 3400-DETERMINE-DOOR-GROUP.                                       11720045
122500                                                                  11730032
122600     EXEC SQL                                                     11740032
122700       SELECT                                                     11750032
122800               GP.DOOR_GP_NBR                                     11760075
122900         INTO                                                     11770032
123000              :DLT00001-DOOR-GP-NBR                               11780075
123100         FROM  DLT_DOOR_GP      GP                                11790032
123200              ,DLT_DOOR_GP_TMPL TMPL                              11800032
123300                                                                  11810032
123400        WHERE  TMPL.DC_NBR        = :PC233-OPER-UNT-ID            11820032
123500          AND  GP.DOOR_ID         = :PC233-DOOR-ID                11830049
123600          AND  GP.DOOR_GP_TMPL_ID = TMPL.DOOR_GP_TMPL_ID          11840032
123700          AND  TMPL.ACTV_IND      = :PC-Y                         11850049
123800                                                                  11860032
123900     END-EXEC.                                                    11870032
124000                                                                  11880032
124100     EVALUATE TRUE                                                11890032
124200         WHEN SQLCODE = ZERO                                      11900032
124300              SET PS-DOOR-GROUP-FOUND-YES TO TRUE                 11910032
124301                                                                          
124302* DMH - 01/21/2005 - BEGIN                                                
124310         WHEN SQLCODE = +100                                      11900032
124311             MOVE 50 TO PC233-PGM-MSG-NBR                         05490026
124312             SET  PS-XCTL-E871                                    05500025
124313                  PS-ERRORS-YES        TO TRUE                    05510025
124314                                                                          
124315* DMH - 01/21/2005 - END                                                  
124320                                                                          
124400         WHEN SQLCODE = -904                                      11920032
124500         WHEN SQLCODE = -913                                      11930032
124600         WHEN SQLCODE = -911                                      11940032
124700              MOVE 16                  TO PV-ERROR-NBR            11950032
124800              PERFORM 9903-WRITE-CICS-LOG                         11960032
124900              PERFORM 9000-SOFT-ABORT                             11970032
125000         WHEN SQLWARN0 NOT = SPACES                               11980032
125100         WHEN SQLCODE NOT EQUAL ZERO                              11990032
125200              SET PS-DOOR-GROUP-FOUND-NO  TO TRUE                 12000032
125300              PERFORM 3500-FORMAT-COMMON-DATA                     12010066
125400                                                                  12020066
125500              MOVE '3400-DETERMINE-DOOR-NUMBER'                   12030066
125600                                       TO PC233-PARAGRAPH         12040066
125700              STRING PC-CURRENT-PROGRAM-NAME                      12050066
125800                     ' - FIND DOOR GROUP         '                12060066
125900                      DELIMITED BY SIZE                           12070066
126000                      INTO PC233-MESSAGE-TEXT(1)                  12080066
126100              MOVE SQLCA               TO PC233-SQLCA             12090066
126200              MOVE 'DLT_DOOR_GP'       TO PC233-DB2-TABLE-NAME(1) 12100066
126300              MOVE 'DLT_DOOR_GP_TMPL'  TO PC233-DB2-TABLE-NAME(2) 12110066
126400              SET PC233-ABEND          TO TRUE                    12120066
126500              MOVE 99                  TO PC233-PGM-MSG-NBR       12130066
126600              PERFORM 8210-XCTL-ERROR-SCREEN                      12140066
126700                                                                  12150066
126800     END-EVALUATE.                                                12160032
126900                                                                  12170032
127000****************************************************************  12180032
127100*                                                              *  12190032
127200*                                                              *  12200032
127300****************************************************************  12210032
127400 3500-FORMAT-COMMON-DATA.                                         12220066
127500                                                                  12230032
127600     MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER.              12240066
127700     MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID.           12250066
127800     MOVE PC233-ASGMT-NBR-SEQ-NBR TO PV-DISPLAY-SEQ-NBR.          12260079
127900     MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST.              12270066
128000     MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR.           12280066
128100     MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC.              12290066
128200     MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP.              12300066
128300     STRING  ' OPER-'                                             12310066
128400             PV-DISPLAY-OPER                                      12320066
128500             '  DOOR-'                                            12330066
128600             PV-DISPLAY-DOOR-ID                                   12340066
128700             '  DEST-'                                            12350066
128800             PV-DISPLAY-DEST        DELIMITED BY SIZE             12360066
128900             INTO                                                 12370066
129000             PC233-MESSAGE-TEXT(2).                               12380066
129100     STRING  ' TRLR SRL#-'                                        12390066
129200             PV-DISPLAY-SRL-NBR                                   12400066
129300             '   SCAC-'                                           12410066
129400             PV-DISPLAY-SCAC                                      12420066
129500             '   TRIP-'                                           12430066
129600             PV-DISPLAY-TRIP        DELIMITED BY SIZE             12440066
129700             INTO                                                 12450066
129800             PC233-MESSAGE-TEXT(3).                               12460066
129900                                                                  12470066
130000     MOVE 17                  TO PV-ERROR-NBR                     12480067
130100                                PC233-ERROR-NBR.                  12490066
130200     PERFORM 9903-WRITE-CICS-LOG.                                 12500067
130300                                                                  12510066
130400****************************************************************  12520066
130500*                                                              *  12530066
130600*                                                              *  12540066
130700****************************************************************  12550066
130800 3600-CALL-DLKCS410.                                              12560066
130900                                                                  12570066
131000     INITIALIZE  DL016-PGM-COMMAREA.                              12580032
131100     SET DL016-ESTABLISH-ASGMT TO TRUE.                           12590032
131200     SET DL016-COMMIT-UPDATE   TO TRUE.                           12600032
131300                                                                  12610032
131400     MOVE PC-CURRENT-PROGRAM-NAME TO DL016-CALLING-PGM-NM.        12620032
131500     MOVE PC233-USER-ID TO DL016-SIGN-ON-USR-ID.                  12630032
131600                                                                  12640032
131700     SET  DL011-AN-SHIP-WRK-TYP TO TRUE.                          12650032
131800     MOVE DL011-KEY-ASGMT-NBR-WRK-TYP TO DL016-ASGMT-NBR-WRK-TYP. 12660032
131900                                                                  12670032
132000     SET  DL011-SHIP-WRK-TYP TO TRUE.                             12680032
132100     MOVE DL011-KEY-WK-TYP TO DL016-EAI-WK-TYP-DESC.              12690032
132200                                                                  12700032
132300     MOVE DLT00001-DOOR-GP-NBR TO                                 12710075
132400                                   DL011-SD-WRK-AREA-DOOR-GROUP.  12720032
132500     MOVE DL011-SHIP-DOORGRP-WRK-AREA TO DL016-EAI-WK-AREA-DESC.  12730032
132600                                                                  12740032
132700     MOVE PC233-OPER-UNT-ID TO DL016-EAI-DC-NBR.                  12750032
132800     MOVE PC233-USER-ID     TO DL016-EAI-CRE-BY-USR-ID.           12760032
132900     SET  DL016-EAI-USR-IS-UNKNOWN TO TRUE.                       12770032
133000                                                                  12780032
133100     MOVE LENGTH OF DL016-PGM-COMMAREA                            12790032
133200                                      TO PV-COMMAREA-LENGTH.      12800032
133300                                                                  12810032
133400     EXEC CICS LINK                                               12820032
133500         PROGRAM  (DL016-USER-PGM)                                12830032
133600         COMMAREA (DL016-PGM-COMMAREA)                            12840032
133700         LENGTH   (PV-COMMAREA-LENGTH)                            12850032
133800         RESP     (PV-CICS-RESPONSE)                              12860032
133900     END-EXEC.                                                    12870032
134000                                                                  12880032
134100     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      12890032
134200                                                                  12900032
134300     EVALUATE TRUE                                                12910032
134400         WHEN DL016-SUCCESSFUL                                    12920032
134500              MOVE DL016-ESO-ASGMT-START-DTE TO                   12930056
134600                             PC233-ASGMT-STRT-DTE                 12940056
134700              MOVE DL016-ESO-ASGMT-NBR-TXT   TO                   12950056
134800                             PC233-ASGMT-NBR-TXT                  12960056
134900              MOVE DL016-ESO-ASGMT-NBR-SEQ-NBR TO                 12970056
135000                             PC233-ASGMT-NBR-SEQ-NBR              12980056
135100                                                                  12990032
135200         WHEN DL016-SQL-ERROR                                     13000032
135300              STRING ' DLKCS410 SQL ERROR FOR USER ID-'           13010032
135400                      PC233-USER-ID                               13020032
135500                      DELIMITED BY SIZE                           13030032
135600                      INTO PV-ERROR-MESSAGE                       13040032
135700                                                                  13050032
135800              PERFORM 3700-FORMAT-ERROR-MESSAGE                   13060049
135900                                                                  13070032
136000         WHEN DL016-CALLED-MODULE-FAILURE                         13080032
136100              STRING ' DLKCS410 CALLED MODULE FAILURE FOR '       13090032
136200                      PC233-USER-ID                               13100032
136300                      DELIMITED BY SIZE                           13110032
136400                      INTO PV-ERROR-MESSAGE                       13120032
136500                                                                  13130032
136600              PERFORM 3700-FORMAT-ERROR-MESSAGE                   13140049
136700                                                                  13150032
136800         WHEN DL016-INVALID-ACCESS                                13160032
136900              STRING ' DLKCS410 INVALID ACCESS FAILURE FOR '      13170032
137000                      PC233-USER-ID                               13180032
137100                      DELIMITED BY SIZE                           13190032
137200                      INTO PV-ERROR-MESSAGE                       13200032
137300                                                                  13210032
137400              PERFORM 3700-FORMAT-ERROR-MESSAGE                   13220049
137500                                                                  13230032
137600         WHEN OTHER                                               13240032
137700              STRING ' DLKCS410 OTHER TYPE FAILURE FOR '          13250032
137800                      PC233-USER-ID                               13260032
137900                      DELIMITED BY SIZE                           13270032
138000                      INTO PV-ERROR-MESSAGE                       13280032
138100                                                                  13290032
138200              PERFORM 3700-FORMAT-ERROR-MESSAGE                   13300049
138300                                                                  13310032
138400     END-EVALUATE                                                 13320032
138500     ELSE                                                         13330032
138600         MOVE '3600-CALL-DLKCS410' TO PC233-PARAGRAPH             13340049
138700         MOVE PV-CICS-RESPONSE     TO PC233-MESSAGE-TEXT (1)      13350032
138800         MOVE 'BAD RETURN FROM DLKCS410' TO                       13360032
138900                                      PC233-MESSAGE-TEXT (2)      13370032
139000         MOVE 2                    TO PC233-ERROR-NBR             13380032
139100         SET PC233-ABEND           TO TRUE                        13390032
139200         MOVE 99                   TO PC233-PGM-MSG-NBR           13400032
139300         PERFORM 8210-XCTL-ERROR-SCREEN                           13410032
139400     END-IF.                                                      13420032
139500                                                                  13430033
139600****************************************************************  13440033
139700*                                                              *  13450033
139800*                                                              *  13460033
139900****************************************************************  13470033
140000 3700-FORMAT-ERROR-MESSAGE.                                       13480049
140100                                                                  13490042
140200     PERFORM 3500-FORMAT-COMMON-DATA.                             13500066
140300                                                                  13510066
140400     MOVE DL016-ASGMT-SQLCODE    TO PV-SQLCODE.                   13520044
140500                                                                  13530042
140600     INITIALIZE PV-CICS-MSG-AREA2.                                13540042
140700     STRING ' PCKRF870-' DL016-USER-PGM                           13550043
140800            ' -- ' DL016-CALL-MOD-FAIL-SQL-PARA                   13560042
140900            ' -- ' DL016-CALL-MOD-FAIL-NM                         13570042
141000            ' -- ' DL016-CALL-MOD-FAIL-ERR-CDE                    13580042
141100            ' -- ' PV-SQLCODE                                     13590066
141200             DELIMITED BY SIZE                                    13600042
141300             INTO PV-CICS-MSG-AREA2.                              13610042
141400     PERFORM 999A-WRITE-CSSL-MSG.                                 13620042
141500                                                                  13630049
141600****************************************************************  13640049
141700*                                                              *  13650049
141800*                                                              *  13660049
141900****************************************************************  13670049
142000 4000-CALL-DLKUP001.                                              13680049
142100                                                                  13690049
142200     SET DL001-BY-ASGMT-KEY                                       13700049
142300         DL001-COMMIT-UPDATE                                      13710049
142400         DL001-FIND-NEXT-ASGMT    TO TRUE.                        13720049
142500                                                                  13730049
142600     MOVE +1 TO DL001-NBR-OF-NBRS-NEED-QTY.                       13740049
142700                                                                  13750049
142800     SET DL001-FIND-NEXT-ASGMT    TO TRUE.                        13760049
142900                                                                  13770049
143000     MOVE PC-CURRENT-PROGRAM-NAME TO DL001-ORIG-CALLING-PGM-NM.   13780049
143100                                                                  13790049
143200     CALL DL001-USER-PGM USING DFHEIBLK                           13800049
143300                              DL001-COMMAREA                      13810049
143400                              DL001-ASGMT-COMMAREA.               13820049
143500                                                                  13830049
143600     EVALUATE TRUE                                                13840049
143700         WHEN DL001-SUCCESSFUL                                    13850049
143800              IF DL001-ASGMT-NEXT-USED                            13860084
143900                 MOVE DL001-NXT-START-DTE                         13870084
144000                               TO PC233-ASGMT-STRT-DTE            13880084
144100                 MOVE DL001-NXT-NBR-TXT                           13890084
144200                               TO PC233-ASGMT-NBR-TXT             13900084
144300                 MOVE DL001-NXT-NBR-SEQ-NBR                       13910084
144400                               TO PC233-ASGMT-NBR-SEQ-NBR         13920084
144500              END-IF                                              13930084
144600                                                                  13940049
144700         WHEN DL001-ASGMT-CLOSED-RETURN                           13950049
144800              CONTINUE                                            13960049
144900                                                                  13970049
145000         WHEN OTHER                                               13980049
145100              PERFORM 3500-FORMAT-COMMON-DATA                     13990066
145200                                                                  14000066
145300              MOVE DL001-ASGMT-SQLCODE TO  PV-SQLCODE             14010049
145400                                                                  14020049
145500              INITIALIZE PV-CICS-MSG-AREA2                        14030049
145600              STRING ' PCKRF870-' DL001-USER-PGM                  14040049
145700                      ' -- ' DL001-SQL-ERROR-PARA                 14050049
145800                      ' -- ' DL001-CALL-MOD-FAIL-NM               14060049
145900                      ' -- ' DL001-CALL-MOD-FAIL-ERR-CDE          14070049
146000                      ' -- ' PV-SQLCODE                           14080066
146100                       DELIMITED BY SIZE                          14090049
146200                       INTO PV-CICS-MSG-AREA2                     14100049
146300              MOVE LENGTH OF PV-CICS-MSG-AREA2                    14110065
146400                                             TO PV-COMMAREA-LENGTH14120049
146500              PERFORM 999A-WRITE-CSSL-MSG                         14130065
146600                                                                  14140049
146700     END-EVALUATE.                                                14150049
146800                                                                  14160033
146900                                                                  14170033
147000****************************************************************  14180033
147100*                                                              *  14190033
147200*                                                              *  14200033
147300****************************************************************  14210033
147400 4900-CALL-XLKUP033.                                              14220049
147500                                                                  14230033
147600     INITIALIZE XL072-EAI-EXPORT-COMMAREA.                        14240033
147700                                                                  14250033
147800     SET  XL072-PC-APP-ID   TO TRUE.                              14260056
147900     MOVE PC-SHIPPING       TO XL072-EVNT-OBJ-TXT.                14270033
148000     MOVE PC-TRAILER-OPEN   TO XL072-EVNT-OBJ-ACTN-TXT.           14280033
148100     MOVE PC233-USER-ID     TO XL072-CRE-BY-USR-ID.               14290033
148200     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM.            14300035
148300     MOVE PC233-TRIP-ID     TO XL072-EVNT-KY-1-NBR.               14310033
148400     MOVE PC233-OPER-UNT-ID TO XL072-EVNT-KY-2-NBR.               14320033
148500     MOVE PC233-P4-DOOR-GP-NBR TO XL072-EVNT-KY-3-NBR.            14330075
148600     MOVE PC233-P4-DOOR-ID  TO XL072-EVNT-KY-1-TXT.               14340033
148700     MOVE PV-CURRENT-TIMESTAMP TO XL072-EVNT-KY-1-TMST.           14350055
148800                                                                  14360033
148900     INITIALIZE PC242-DTL-TXT-AREA.                               14370033
149000                                                                  14380033
149100     SET PC242-OPEN-OTBND-TRLR TO TRUE.                           14390033
149200     MOVE PC233-ASGMT-STRT-DTE                                    14400038
149300                               TO PC242-AH-ASGMT-STRT-DTE.        14410033
149400     MOVE PC233-ASGMT-NBR-TXT                                     14420038
149500                               TO PC242-AH-ASGMT-NBR-TXT.         14430033
149600     MOVE PC233-ASGMT-NBR-SEQ-NBR                                 14440038
149700                               TO PC242-AH-ASGMT-NBR-SEQ-NBR.     14450033
149800     MOVE DL001-SEQ-START-NBR                                     14460057
149900                               TO PC242-AH-ASGMT-SEQ-DTL-NBR.     14470082
150000                                                                  14480033
150100                                                                  14490033
150200     SET  XL072-PCWS242-COPYBOOK   TO TRUE.                       14500033
150300     SET  XL072-COMMIT-UPDATE      TO TRUE.                       14510058
150400     MOVE PC242-DTL-TXT-AREA       TO XL072-DTL-TXT.              14520033
150500                                                                  14530033
150600     CALL XL072-USER-PGM USING DFHEIBLK                           14540033
150700                              XL072-COMMAREA                      14550033
150800                              XL072-EAI-EXPORT-COMMAREA.          14560033
150900                                                                  14570033
151000     EVALUATE TRUE                                                14580033
151100         WHEN XL072-SUCCESSFUL                                    14590033
151200              CONTINUE                                            14600033
151300         WHEN OTHER                                               14610033
151400              PERFORM 3500-FORMAT-COMMON-DATA                     14620066
151500                                                                  14630066
151600              INITIALIZE PV-CICS-MSG-AREA2                        14640033
151700              STRING ' PCKRF870-4900- '                           14650049
151800                      PV-DISPLAY-OPER   '-'                       14660033
151900                      PC233-ASGMT-STRT-DTE  ' - '                 14670036
152000                      PC233-ASGMT-NBR-TXT   ' - '                 14680036
152100                      PV-DISPLAY-SEQ-NBR ' - '                    14690080
152200                      PC233-USER-ID ' - '                         14700035
152300                     'SQLCODE=' PV-SQLCODE                        14710038
152400                     ' - RETURN CODE=' XL072-RETURN-CODE          14720033
152500                                                DELIMITED BY SIZE 14730033
152600                                           INTO PV-CICS-MSG-AREA2 14740033
152700              MOVE LENGTH OF PV-CICS-MSG-AREA2                    14750065
152800                                             TO PV-COMMAREA-LENGTH14760033
152900              PERFORM 999A-WRITE-CSSL-MSG                         14770065
153000                                                                  14780033
153100              INITIALIZE PV-CICS-MSG-AREA2                        14790033
153200              MOVE XL072-EAI-DB-SQLCODE  TO  PV-SQLCODE           14800066
153300              STRING ' PCKRF870-' XL072-USER-PGM                  14810036
153400                      ' -- ' XL072-SQL-ERROR-PARA                 14820033
153500                      ' -- ' XL072-CALL-MOD-FAIL-NM               14830033
153600                      ' -- ' XL072-CALL-MOD-FAIL-ERR-CDE          14840033
153700                       PV-SQLCODE                                 14850066
153800                       DELIMITED BY SIZE                          14860066
153900                       INTO PV-CICS-MSG-AREA2                     14870066
154000              MOVE LENGTH OF PV-CICS-MSG-AREA2                    14880066
154100                                             TO PV-COMMAREA-LENGTH14890033
154200              PERFORM 999A-WRITE-CSSL-MSG                         14900065
154300                                                                  14910033
154400              INITIALIZE PV-CICS-MSG-AREA2                        14920033
154500              STRING ' PCKRF870-' XL072-USER-PGM                  14930036
154600                      ' -- ' XL072-SQLCA                          14940033
154700                                                DELIMITED BY SIZE 14950033
154800                                           INTO PV-CICS-MSG-AREA2 14960033
154900              MOVE LENGTH OF PV-CICS-MSG-AREA2                    14970065
155000                                             TO PV-COMMAREA-LENGTH14980033
155100              PERFORM 999A-WRITE-CSSL-MSG                         14990065
155200                                                                  15000033
155300              MOVE 3                   TO PV-ERROR-NBR            15010066
155400                                          PC233-ERROR-NBR         15020066
155500              PERFORM 9903-WRITE-CICS-LOG                         15030066
155600              MOVE '7000-SELECT-TCNTRID'                          15040066
155700                                       TO PC233-PARAGRAPH         15050066
155800              MOVE 'PCKRF870 - CHECK TRAILER EXISTENCE'           15060066
155900                                       TO PC233-MESSAGE-TEXT(1)   15070066
156000              MOVE SQLCA               TO PC233-SQLCA             15080066
156100              MOVE 'TCNTRID'           TO PC233-DB2-TABLE-NAME(1) 15090066
156200              SET PC233-ABEND          TO TRUE                    15100066
156300              MOVE 99                  TO PC233-PGM-MSG-NBR       15110066
156400              PERFORM 8210-XCTL-ERROR-SCREEN                      15120066
156500                                                                  15130033
156600     END-EVALUATE.                                                15140033
156700                                                                  15150033
156800 7000-SELECT-TCNTRID.                                             15160033
156900                                                                  15170033
157000     EXEC SQL                                                     15180033
157100         SELECT                                                   15190033
157200             TRID.SCAC_CDE                                        15200006
157300         ,   TRID.TRLR_ID                                         15210006
157400         ,   TRID.TRLR_SIZE_MU                                    15220006
157500         INTO                                                     15230006
157600           :CNTRID-SCAC-CDE                                       15240006
157700         , :CNTRID-TRLR-ID                                        15250006
157800         , :CNTRID-TRLR-SIZE-MU                                   15260006
157900         FROM                                                     15270006
158000            TCNTRID TRID                                          15280006
158100         WHERE TRID.TRLR_SRL_NBR     = :PC233-SERIAL-NBR          15290006
158200     END-EXEC.                                                    15300006
158300                                                                  15310006
158400     EVALUATE TRUE                                                15320006
158500         WHEN SQLCODE = ZERO                                      15330006
158600             SET PS-TCNTRID-YES       TO TRUE                     15340006
158700         WHEN SQLCODE = +100                                      15350006
158800             SET PS-TCNTRID-NO        TO TRUE                     15360006
158900         WHEN SQLCODE = -904                                      15370006
159000         WHEN SQLCODE = -913                                      15380006
159100         WHEN SQLCODE = -911                                      15390006
159200             MOVE 2                   TO PV-ERROR-NBR             15400006
159300             PERFORM 9903-WRITE-CICS-LOG                          15410006
159400             PERFORM 9000-SOFT-ABORT                              15420006
159500         WHEN SQLWARN0 NOT = SPACES                               15430006
159600         WHEN SQLCODE NOT EQUAL ZERO                              15440006
159700              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      15450006
159800              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   15460006
159900              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      15470006
160000              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   15480006
160100              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      15490006
160200              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      15500006
160300              STRING  ' OPER-'               DELIMITED BY SIZE    15510006
160400                      PV-DISPLAY-OPER        DELIMITED BY SIZE    15520006
160500                      '  DOOR-'              DELIMITED BY SIZE    15530006
160600                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    15540006
160700                      '  DEST-'              DELIMITED BY SIZE    15550006
160800                      PV-DISPLAY-DEST        DELIMITED BY SIZE    15560006
160900                                        INTO                      15570006
161000                                        PC233-MESSAGE-TEXT(2)     15580006
161100             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    15590006
161200                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    15600006
161300                      '   SCAC-'             DELIMITED BY SIZE    15610006
161400                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    15620006
161500                      '   TRIP-'             DELIMITED BY SIZE    15630006
161600                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    15640006
161700                                        INTO                      15650006
161800                                        PC233-MESSAGE-TEXT(3)     15660006
161900                                                                  15670006
162000             MOVE 3                   TO PV-ERROR-NBR             15680006
162100                                         PC233-ERROR-NBR          15690006
162200             PERFORM 9903-WRITE-CICS-LOG                          15700006
162300             MOVE '7000-SELECT-TCNTRID'                           15710006
162400                                      TO PC233-PARAGRAPH          15720006
162500             MOVE 'PCKRF870 - CHECK TRAILER EXISTENCE'            15730006
162600                                      TO PC233-MESSAGE-TEXT(1)    15740006
162700             MOVE SQLCA               TO PC233-SQLCA              15750006
162800             MOVE 'TCNTRID'           TO PC233-DB2-TABLE-NAME(1)  15760006
162900             SET PC233-ABEND          TO TRUE                     15770006
163000             MOVE 99                  TO PC233-PGM-MSG-NBR        15780006
163100             PERFORM 8210-XCTL-ERROR-SCREEN                       15790006
163200     END-EVALUATE.                                                15800006
163300/                                                                 15810006
163400 7010-SELECT-TCNDCDR.                                             15820006
163500                                                                  15830006
163600     EXEC SQL                                                     15840006
163700         SELECT                                                   15850006
163800             DCDR.DOOR_TYP_CDE                                    15860006
163900         ,   DCDR.DIVERT_NBR                                      15870006
164000         ,   DCDR.DIVERT_LOC_ID                                   15880006
164100         INTO                                                     15890006
164200             :CNDCDR-DOOR-TYP-CDE                                 15900006
164300         ,   :CNDCDR-DIVERT-NBR                                   15910006
164400         ,   :CNDCDR-DIVERT-LOC-ID                                15920006
164500         FROM TCNDCDR DCDR                                        15930006
164600         ,    TCNDRTY DRTY                                        15940006
164700         WHERE                                                    15950006
164800             DCDR.OPER_UNT_ID         = :PC233-OPER-UNT-ID        15960006
164900             AND DCDR.DOOR_ID         = :PC233-DOOR-ID            15970006
165000             AND  DCDR.DOOR_TYP_CDE   = DRTY.DOOR_TYP_CDE         15980006
165100             AND  DRTY.DIVERT_TYP_CDE = 'D'                       15990006
165200                                                                  16000006
165300     END-EXEC.                                                    16010006
165400                                                                  16020006
165500     EVALUATE TRUE                                                16030006
165600         WHEN SQLCODE = ZERO                                      16040006
165700             MOVE CNDCDR-DIVERT-NBR   TO PC233-DIVERT-NBR         16050006
165800             MOVE CNDCDR-DIVERT-LOC-ID                            16060006
165900                                      TO PC233-DIVERT-LOC-ID      16070006
166000             SET PS-TCNDCDR-YES       TO TRUE                     16080006
166100         WHEN SQLCODE = +100                                      16090006
166200             SET PS-TCNDCDR-NO        TO TRUE                     16100006
166300         WHEN SQLCODE = -904                                      16110006
166400         WHEN SQLCODE = -913                                      16120006
166500         WHEN SQLCODE = -911                                      16130006
166600             MOVE 4                   TO PV-ERROR-NBR             16140006
166700             PERFORM 9903-WRITE-CICS-LOG                          16150006
166800             PERFORM 9000-SOFT-ABORT                              16160006
166900         WHEN SQLWARN0 NOT = SPACES                               16170006
167000         WHEN SQLCODE NOT EQUAL ZERO                              16180006
167100              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      16190006
167200              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   16200006
167300              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      16210006
167400              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   16220006
167500              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      16230006
167600              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      16240006
167700              STRING  ' OPER-'               DELIMITED BY SIZE    16250006
167800                      PV-DISPLAY-OPER        DELIMITED BY SIZE    16260006
167900                      '  DOOR-'              DELIMITED BY SIZE    16270006
168000                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    16280006
168100                      '  DEST-'              DELIMITED BY SIZE    16290006
168200                      PV-DISPLAY-DEST        DELIMITED BY SIZE    16300006
168300                                        INTO                      16310006
168400                                        PC233-MESSAGE-TEXT(2)     16320006
168500             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    16330006
168600                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    16340006
168700                      '   SCAC-'             DELIMITED BY SIZE    16350006
168800                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    16360006
168900                      '   TRIP-'             DELIMITED BY SIZE    16370006
169000                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    16380006
169100                                        INTO                      16390006
169200                                        PC233-MESSAGE-TEXT(3)     16400006
169300                                                                  16410006
169400             MOVE 5                   TO PV-ERROR-NBR             16420006
169500                                         PC233-ERROR-NBR          16430006
169600             PERFORM 9903-WRITE-CICS-LOG                          16440006
169700             MOVE '7010-SELECT-TCNDCDR'                           16450006
169800                                      TO PC233-PARAGRAPH          16460006
169900             MOVE 'PCKRF870 - CHECK DOOR ID'                      16470006
170000                                      TO PC233-MESSAGE-TEXT(1)    16480006
170100             MOVE SQLCA               TO PC233-SQLCA              16490006
170200             MOVE 'TCNDCDR'           TO PC233-DB2-TABLE-NAME(1)  16500006
170300             SET PC233-ABEND          TO TRUE                     16510006
170400             MOVE 99                  TO PC233-PGM-MSG-NBR        16520006
170500             PERFORM 8210-XCTL-ERROR-SCREEN                       16530006
170600     END-EVALUATE.                                                16540006
170700                                                                  16550006
170800 7011-SELECT-TCNDRST.                                             16560006
170900                                                                  16570006
171000     EXEC SQL                                                     16580006
171100         SELECT                                                   16590006
171200             DRST.STR_NBR                                         16600006
171300         INTO                                                     16610006
171400             :CNDRST-STR-NBR                                      16620006
171500         FROM TCNDRST DRST                                        16630006
171600         WHERE                                                    16640006
171700             DRST.OPER_UNT_ID         = :PC233-OPER-UNT-ID        16650006
171800             AND DRST.DOOR_ID         = :PC233-DOOR-ID            16660006
171900             AND CURRENT TIMESTAMP BETWEEN                        16670006
172000                  DRST.STRT_TMST AND DRST.END_TMST                16680006
172100     END-EXEC.                                                    16690006
172200                                                                  16700006
172300     EVALUATE TRUE                                                16710006
172400         WHEN SQLCODE = ZERO                                      16720006
172500             MOVE CNDRST-STR-NBR      TO PC233-STR-NBR            16730006
172600                                         ADESTO                   16740006
172700         WHEN SQLCODE = +100                                      16750006
172800         WHEN SQLCODE = -811                                      16760006
172900             MOVE ZEROES              TO PC233-STR-NBR            16770006
173000                                         ADESTO                   16780006
173100         WHEN SQLCODE = -904                                      16790006
173200         WHEN SQLCODE = -913                                      16800006
173300         WHEN SQLCODE = -911                                      16810006
173400             MOVE 6                   TO PV-ERROR-NBR             16820006
173500             PERFORM 9903-WRITE-CICS-LOG                          16830006
173600             PERFORM 9000-SOFT-ABORT                              16840006
173700         WHEN SQLWARN0 NOT = SPACES                               16850006
173800         WHEN SQLCODE NOT EQUAL ZERO                              16860006
173900              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      16870006
174000              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   16880006
174100              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      16890006
174200              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   16900006
174300              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      16910006
174400              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      16920006
174500              STRING  ' OPER-'               DELIMITED BY SIZE    16930006
174600                      PV-DISPLAY-OPER        DELIMITED BY SIZE    16940006
174700                      '  DOOR-'              DELIMITED BY SIZE    16950006
174800                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    16960006
174900                      '  DEST-'              DELIMITED BY SIZE    16970006
175000                      PV-DISPLAY-DEST        DELIMITED BY SIZE    16980006
175100                                        INTO                      16990006
175200                                        PC233-MESSAGE-TEXT(2)     17000006
175300             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    17010006
175400                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    17020006
175500                      '   SCAC-'             DELIMITED BY SIZE    17030006
175600                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    17040006
175700                      '   TRIP-'             DELIMITED BY SIZE    17050006
175800                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    17060006
175900                                        INTO                      17070006
176000                                        PC233-MESSAGE-TEXT(3)     17080006
176100                                                                  17090006
176200             MOVE 7                   TO PV-ERROR-NBR             17100006
176300                                         PC233-ERROR-NBR          17110006
176400             PERFORM 9903-WRITE-CICS-LOG                          17120006
176500             MOVE '7011-SELECT-TCNDRST'                           17130006
176600                                      TO PC233-PARAGRAPH          17140006
176700             MOVE 'PCKRF870 - CHECK DOOR ID'                      17150006
176800                                      TO PC233-MESSAGE-TEXT(1)    17160006
176900             MOVE SQLCA               TO PC233-SQLCA              17170006
177000             MOVE 'TCNDRST'           TO PC233-DB2-TABLE-NAME(1)  17180006
177100             SET PC233-ABEND          TO TRUE                     17190006
177200             MOVE 99                  TO PC233-PGM-MSG-NBR        17200006
177300             PERFORM 8210-XCTL-ERROR-SCREEN                       17210006
177400     END-EVALUATE.                                                17220006
177500                                                                  17230006
177600 7020-FIND-OTHER-DOOR.                                            17240006
177700                                                                  17250006
177800     EXEC SQL                                                     17260006
177900         SELECT                                                   17270006
178000             OBTS.DOOR_ID                                         17280006
178100         ,   OBTS.OTBND_TRIP_ID                                   17290006
178200         INTO                                                     17300006
178300             :SUOBTS-DOOR-ID                                      17310006
178400         ,   :SUOBTS-OTBND-TRIP-ID                                17320006
178500         FROM                                                     17330006
178600             TSUOBTR OBTR                                         17340006
178700       ,     TSUOBTS OBTS                                         17350006
178800       WHERE                                                      17360006
178900           OBTR.TRLR_SRL_NBR                = :PC233-SERIAL-NBR   17370006
179000           AND OBTR.TRIP_ACTV_CDE           = 'A'                 17380006
179100           AND OBTR.OTBND_TRIP_ID           = OBTS.OTBND_TRIP_ID  17390006
179200           AND OBTS.TRIP_STAT_CDE           = 'DO'                17400006
179300           AND (OBTS.DOOR_ID                <> :PC233-DOOR-ID     17410006
179400                  OR                                                      
179500             OBTR.DEST_OPER_UNT_ID          <> :PC233-STR-NBR)            
179600           AND OBTS.OTBND_STAT_TMST =                             17420006
179700                                                                  17430006
179800        ( SELECT MAX (OBTS1.OTBND_STAT_TMST )                     17440006
179900            FROM                                                  17450006
180000              TSUOBTS OBTS1                                       17460006
180100            WHERE                                                 17470006
180200              OBTS.OTBND_TRIP_ID        = OBTS1.OTBND_TRIP_ID)    17480006
180300     END-EXEC.                                                    17490006
180400                                                                  17500006
180500     EVALUATE TRUE                                                17510006
180600         WHEN SQLCODE = ZERO                                      17520006
180700*           (THE TRAILER IS OPEN AT ONE OTHER DOOR)               17530006
180800             MOVE SUOBTS-DOOR-ID      TO PC233-ERROR-DOOR-NBR     17540006
180900             MOVE SUOBTS-OTBND-TRIP-ID                            17550006
181000                                      TO PC233-ERROR-TRIP-ID      17560006
181100             MOVE PC233-SERIAL-NBR                                17570006
181200                                      TO PC233-ERROR-SRL-NBR      17580006
181300             SET PC233-DOOR-ALREADY-OPEN  TO  TRUE                17590006
181400             SET PS-TRLR-OPEN-DIFF-DOOR                           17600006
181500                 PS-XCTL-E871                                     17610006
181600                 PS-ERRORS-YES        TO TRUE                     17620006
181700         WHEN SQLCODE = -811                                      17630006
181800*           (THE TRAILER IS AT MULTIPLE DOORS                     17640006
181900*                     OTHER THAN THE CURRENT ONE)                 17650006
182000             SET  PC233-DOOR-ALREADY-OPEN  TO  TRUE               17660006
182100             MOVE 'MULT'              TO PC233-ERROR-DOOR-NBR     17670006
182200             MOVE SUOBTS-OTBND-TRIP-ID                            17680006
182300                                      TO PC233-ERROR-TRIP-ID      17690006
182400             SET PS-TRLR-OPEN-DIFF-DOOR                           17700006
182500                 PS-XCTL-E871                                     17710006
182600                 PS-ERRORS-YES        TO TRUE                     17720006
182700         WHEN SQLCODE = +100                                      17730006
182800*           (THE TRAILER IS ONLY AT THE CURRENT DOOR)             17740006
182900             SET PS-TRLR-OPEN-THIS-DOOR                           17750006
183000                                      TO TRUE                     17760006
183100         WHEN SQLCODE = -904                                      17770006
183200         WHEN SQLCODE = -913                                      17780006
183300         WHEN SQLCODE = -911                                      17790006
183400             MOVE 8                   TO PV-ERROR-NBR             17800006
183500             PERFORM 9903-WRITE-CICS-LOG                          17810006
183600             PERFORM 9000-SOFT-ABORT                              17820006
183700         WHEN SQLWARN0 NOT = SPACES                               17830006
183800         WHEN SQLCODE NOT EQUAL ZERO                              17840006
183900              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      17850006
184000              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   17860006
184100              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      17870006
184200              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   17880006
184300              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      17890006
184400              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      17900006
184500              STRING  ' OPER-'               DELIMITED BY SIZE    17910006
184600                      PV-DISPLAY-OPER        DELIMITED BY SIZE    17920006
184700                      '  DOOR-'              DELIMITED BY SIZE    17930006
184800                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    17940006
184900                      '  DEST-'              DELIMITED BY SIZE    17950006
185000                      PV-DISPLAY-DEST        DELIMITED BY SIZE    17960006
185100                                        INTO                      17970006
185200                                        PC233-MESSAGE-TEXT(2)     17980006
185300             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    17990006
185400                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    18000006
185500                      '   SCAC-'             DELIMITED BY SIZE    18010006
185600                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    18020006
185700                      '   TRIP-'             DELIMITED BY SIZE    18030006
185800                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    18040006
185900                                        INTO                      18050006
186000                                        PC233-MESSAGE-TEXT(3)     18060006
186100                                                                  18070006
186200             MOVE 9                   TO PV-ERROR-NBR             18080006
186300                                         PC233-ERROR-NBR          18090006
186400             PERFORM 9903-WRITE-CICS-LOG                          18100006
186500             MOVE '7020-FIND-OTHER-DOOR'                          18110006
186600                                      TO PC233-PARAGRAPH          18120006
186700             MOVE 'PCKRF870 - CHECK DOOR ID'                      18130006
186800                                      TO PC233-MESSAGE-TEXT(1)    18140006
186900             MOVE SQLCA               TO PC233-SQLCA              18150006
187000             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  18160006
187100             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(2)  18170006
187200             SET PC233-ABEND          TO TRUE                     18180006
187300             MOVE 99                  TO PC233-PGM-MSG-NBR        18190006
187400             PERFORM 8210-XCTL-ERROR-SCREEN                       18200006
187500     END-EVALUATE.                                                18210006
187600/                                                                 18220006
187700 7030-FIND-OTHER-TRLR.                                            18230006
187800                                                                  18240006
187900     EXEC SQL                                                     18250006
188000         SELECT                                                   18260006
188100             TRID.SCAC_CDE                                        18270006
188200         ,   TRID.TRLR_ID                                         18280006
188300         ,   OBTS.OTBND_TRIP_ID                                   18290006
188400         INTO                                                     18300006
188500             :CNTRID-SCAC-CDE                                     18310006
188600         ,   :CNTRID-TRLR-ID                                      18320006
188700         ,   :SUOBTS-OTBND-TRIP-ID                                18330006
188800         FROM TSUOBTS OBTS                                        18340006
188900         ,    TSUOBTR OBTR                                        18350006
189000         ,    TCNTRID TRID                                        18360006
189100         WHERE                                                    18370006
189200             OBTS.OTBND_TRIP_ID       = OBTR.OTBND_TRIP_ID        18380006
189300         AND OBTR.TRLR_SRL_NBR        <> :PC233-SERIAL-NBR        18390006
189400         AND OBTR.TRLR_SRL_NBR        = TRID.TRLR_SRL_NBR         18400006
189500         AND OBTR.TRIP_ACTV_CDE       = 'A'                       18410006
189600         AND OBTS.STAT_OPER_UNT_ID    = :PC233-OPER-UNT-ID        18420006
189700         AND OBTS.DOOR_ID             =  :PC233-DOOR-ID           18430006
189800         AND OBTS.TRIP_STAT_CDE       = 'DO'                      18440006
189900         AND OBTS.OTBND_STAT_TMST  =                              18450006
190000           ( SELECT                                               18460006
190100                 MAX(OBTS1.OTBND_STAT_TMST)                       18470006
190200                 FROM                                             18480006
190300                 TSUOBTS OBTS1                                    18490006
190400                 WHERE OBTS1.OTBND_TRIP_ID = OBTS.OTBND_TRIP_ID   18500006
190500            )                                                     18510006
190600                                                                  18520006
190700     END-EXEC.                                                    18530006
190800                                                                  18540006
190900     EVALUATE TRUE                                                18550006
191000         WHEN SQLCODE = ZERO                                      18560006
191100         WHEN SQLCODE = -811                                      18570023
191200             MOVE CNTRID-SCAC-CDE     TO PC233-ERROR-SCAC-ID      18580006
191300             MOVE CNTRID-TRLR-ID      TO PC233-ERROR-TRLR-ID      18590006
191400             MOVE SUOBTS-OTBND-TRIP-ID                            18600006
191500                                      TO PC233-ERROR-TRIP-ID      18610006
191600             MOVE PC233-DOOR-ID       TO PC233-ERROR-DOOR-NBR     18620006
191700             SET PC233-TRLR-OPENED-OTHER-DOOR                     18630006
191800                                      TO TRUE                     18640006
191900             SET PS-TRLR-OPEN-DIFF-DOOR                           18650006
192000                 PS-XCTL-E871                                     18660006
192100                 PS-ERRORS-YES        TO TRUE                     18670006
192200         WHEN SQLCODE = +100                                      18680006
192300             CONTINUE                                             18690006
192400         WHEN SQLCODE = -904                                      18700006
192500         WHEN SQLCODE = -913                                      18710006
192600         WHEN SQLCODE = -911                                      18720006
192700             MOVE 10                  TO PV-ERROR-NBR             18730006
192800             PERFORM 9903-WRITE-CICS-LOG                          18740006
192900             PERFORM 9000-SOFT-ABORT                              18750006
193000         WHEN SQLWARN0 NOT = SPACES                               18760006
193100         WHEN SQLCODE NOT EQUAL ZERO                              18770006
193200              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      18780006
193300              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   18790006
193400              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      18800006
193500              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   18810006
193600              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      18820006
193700              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      18830006
193800              STRING  ' OPER-'               DELIMITED BY SIZE    18840006
193900                      PV-DISPLAY-OPER        DELIMITED BY SIZE    18850006
194000                      '  DOOR-'              DELIMITED BY SIZE    18860006
194100                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    18870006
194200                      '  DEST-'              DELIMITED BY SIZE    18880006
194300                      PV-DISPLAY-DEST        DELIMITED BY SIZE    18890006
194400                                        INTO                      18900006
194500                                        PC233-MESSAGE-TEXT(2)     18910006
194600             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    18920006
194700                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    18930006
194800                      '   SCAC-'             DELIMITED BY SIZE    18940006
194900                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    18950006
195000                      '   TRIP-'             DELIMITED BY SIZE    18960006
195100                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    18970006
195200                                        INTO                      18980006
195300                                        PC233-MESSAGE-TEXT(3)     18990006
195400                                                                  19000006
195500             MOVE 11                  TO PV-ERROR-NBR             19010006
195600                                         PC233-ERROR-NBR          19020006
195700             PERFORM 9903-WRITE-CICS-LOG                          19030006
195800             MOVE '7030-FIND-OTHER-TRLR'                          19040006
195900                                      TO PC233-PARAGRAPH          19050006
196000             MOVE 'PCKRF870 - CHECK TRLR AT ANOTHER DOOR'         19060006
196100                                      TO PC233-MESSAGE-TEXT(1)    19070006
196200             MOVE SQLCA               TO PC233-SQLCA              19080006
196300             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  19090006
196400             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(2)  19100006
196500             MOVE 'TCNTRID'           TO PC233-DB2-TABLE-NAME(3)  19110006
196600             SET PC233-ABEND          TO TRUE                     19120006
196700             MOVE 99                  TO PC233-PGM-MSG-NBR        19130006
196800             PERFORM 8210-XCTL-ERROR-SCREEN                       19140006
196900     END-EVALUATE.                                                19150006
197000/                                                                 19160006
197100 7040-OPEN-STORE-DOOR-CSR.                                        19170006
197200     EXEC SQL                                                     19180006
197300         OPEN STORE-DOOR-CSR                                      19190006
197400     END-EXEC.                                                    19200006
197500                                                                  19210006
197600     EVALUATE TRUE                                                19220006
197700         WHEN SQLCODE = ZERO                                      19230006
197800             SET PS-NOT-END-STORE-DOOR-CSR                        19240006
197900                                      TO TRUE                     19250006
198000         WHEN SQLCODE = -904                                      19260006
198100         WHEN SQLCODE = -913                                      19270006
198200         WHEN SQLCODE = -911                                      19280006
198300             MOVE 12                  TO PV-ERROR-NBR             19290006
198400             PERFORM 9903-WRITE-CICS-LOG                          19300006
198500             PERFORM 9000-SOFT-ABORT                              19310006
198600         WHEN SQLWARN0 NOT = SPACES                               19320006
198700         WHEN SQLCODE NOT EQUAL ZERO                              19330006
198800              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      19340006
198900              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   19350006
199000              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      19360006
199100              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   19370006
199200              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      19380006
199300              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      19390006
199400              STRING  ' OPER-'               DELIMITED BY SIZE    19400006
199500                      PV-DISPLAY-OPER        DELIMITED BY SIZE    19410006
199600                      '  DOOR-'              DELIMITED BY SIZE    19420006
199700                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    19430006
199800                      '  DEST-'              DELIMITED BY SIZE    19440006
199900                      PV-DISPLAY-DEST        DELIMITED BY SIZE    19450006
200000                                        INTO                      19460006
200100                                        PC233-MESSAGE-TEXT(2)     19470006
200200             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    19480006
200300                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    19490006
200400                      '   SCAC-'             DELIMITED BY SIZE    19500006
200500                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    19510006
200600                      '   TRIP-'             DELIMITED BY SIZE    19520006
200700                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    19530006
200800                                        INTO                      19540006
200900                                        PC233-MESSAGE-TEXT(3)     19550006
201000                                                                  19560006
201100             MOVE 13                  TO PV-ERROR-NBR             19570006
201200                                         PC233-ERROR-NBR          19580006
201300             PERFORM 9903-WRITE-CICS-LOG                          19590006
201400             MOVE '7040-OPEN-STORE-DOOR-CSR'                      19600006
201500                                      TO PC233-PARAGRAPH          19610006
201600             MOVE 'PCKRF870 - FETCH STORES FOR A DOOR'            19620006
201700                                      TO PC233-MESSAGE-TEXT(1)    19630006
201800             MOVE SQLCA               TO PC233-SQLCA              19640006
201900             MOVE 'TCNDRST'           TO PC233-DB2-TABLE-NAME(1)  19650006
202000             SET PC233-ABEND          TO TRUE                     19660006
202100             MOVE 99                  TO PC233-PGM-MSG-NBR        19670006
202200             PERFORM 8210-XCTL-ERROR-SCREEN                       19680006
202300     END-EVALUATE.                                                19690006
202400                                                                  19700006
202500                                                                  19710006
202600 7041-FETCH-STORE-DOOR-CSR.                                       19720006
202700                                                                  19730006
202800     EXEC SQL                                                     19740006
202900         FETCH STORE-DOOR-CSR                                     19750006
203000         INTO                                                     19760006
203100             :CNDRST-DOOR-ID                                      19770006
203200     END-EXEC.                                                    19780006
203300                                                                  19790006
203400     EVALUATE TRUE                                                19800006
203500         WHEN SQLCODE = ZERO                                      19810006
203600             ADD 1                    TO PV-DOOR-COUNT            19820006
203700             IF CNDRST-DOOR-ID = PC233-DOOR-ID                    19830006
203800                 SET PS-ONE-DOOR-THIS-STORE                       19840006
203900                                      TO TRUE                     19850006
204000             ELSE                                                 19860006
204100                 IF  PS-MULT-DOORS-ALLOWED  AND                   19870029
204200                     PS-ONE-DOOR-THIS-STORE                       19880029
204300                     CONTINUE                                     19890029
204400                 ELSE                                             19900029
204500                     MOVE CNDRST-DOOR-ID  TO PC233-ERROR-DOOR-NBR 19910029
204600                     SET PS-MLT-DOORS-THIS-STORE  TO TRUE         19920029
204700                 END-IF                                           19930029
204800             END-IF                                               19940006
204900         WHEN SQLCODE = +100                                      19950006
205000             SET PS-END-STORE-DOOR-CSR                            19960006
205100                                      TO TRUE                     19970006
205200             IF PV-DOOR-COUNT = ZERO                              19980006
205300                 SET PS-NO-DOORS-THIS-STORE                       19990006
205400                                      TO TRUE                     20000006
205500             END-IF                                               20010006
205600         WHEN SQLCODE = -904                                      20020006
205700         WHEN SQLCODE = -913                                      20030006
205800         WHEN SQLCODE = -911                                      20040006
205900             MOVE 14                  TO PV-ERROR-NBR             20050006
206000             PERFORM 9903-WRITE-CICS-LOG                          20060006
206100             PERFORM 9000-SOFT-ABORT                              20070006
206200         WHEN SQLWARN0 NOT = SPACES                               20080006
206300         WHEN SQLCODE NOT EQUAL ZERO                              20090006
206400              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      20100006
206500              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   20110006
206600              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      20120006
206700              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   20130006
206800              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      20140006
206900              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      20150006
207000              STRING  ' OPER-'               DELIMITED BY SIZE    20160006
207100                      PV-DISPLAY-OPER        DELIMITED BY SIZE    20170006
207200                      '  DOOR-'              DELIMITED BY SIZE    20180006
207300                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    20190006
207400                      '  DEST-'              DELIMITED BY SIZE    20200006
207500                      PV-DISPLAY-DEST        DELIMITED BY SIZE    20210006
207600                                        INTO                      20220006
207700                                        PC233-MESSAGE-TEXT(2)     20230006
207800             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    20240006
207900                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    20250006
208000                      '   SCAC-'             DELIMITED BY SIZE    20260006
208100                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    20270006
208200                      '   TRIP-'             DELIMITED BY SIZE    20280006
208300                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    20290006
208400                                        INTO                      20300006
208500                                        PC233-MESSAGE-TEXT(3)     20310006
208600                                                                  20320006
208700             MOVE 15                  TO PV-ERROR-NBR             20330006
208800                                         PC233-ERROR-NBR          20340006
208900             PERFORM 9903-WRITE-CICS-LOG                          20350006
209000             MOVE '7041-FETCH-STORE-DOOR-CSR'                     20360006
209100                                      TO PC233-PARAGRAPH          20370006
209200             MOVE 'PCKRF870 - FETCH STORES FOR A DOOR'            20380006
209300                                      TO PC233-MESSAGE-TEXT(1)    20390006
209400             MOVE SQLCA               TO PC233-SQLCA              20400006
209500             MOVE 'TCNDRST'           TO PC233-DB2-TABLE-NAME(1)  20410006
209600             SET PC233-ABEND          TO TRUE                     20420006
209700             MOVE 99                  TO PC233-PGM-MSG-NBR        20430006
209800             PERFORM 8210-XCTL-ERROR-SCREEN                       20440006
209900     END-EVALUATE.                                                20450006
210000                                                                  20460006
210100                                                                  20470006
210200                                                                  20480006
210300 7042-CLOSE-STORE-DOOR-CSR.                                       20490006
210400     EXEC SQL                                                     20500006
210500         CLOSE STORE-DOOR-CSR                                     20510006
210600     END-EXEC.                                                    20520006
210700                                                                  20530006
210800     EVALUATE TRUE                                                20540006
210900         WHEN SQLCODE = ZERO                                      20550006
211000             CONTINUE                                             20560006
211100         WHEN SQLWARN0 NOT = SPACES                               20570006
211200         WHEN SQLCODE NOT EQUAL ZERO                              20580006
211300              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      20590006
211400              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   20600006
211500              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      20610006
211600              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   20620006
211700              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      20630006
211800              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      20640006
211900              STRING  ' OPER-'               DELIMITED BY SIZE    20650006
212000                      PV-DISPLAY-OPER        DELIMITED BY SIZE    20660006
212100                      '  DOOR-'              DELIMITED BY SIZE    20670006
212200                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    20680006
212300                      '  DEST-'              DELIMITED BY SIZE    20690006
212400                      PV-DISPLAY-DEST        DELIMITED BY SIZE    20700006
212500                                        INTO                      20710006
212600                                        PC233-MESSAGE-TEXT(2)     20720006
212700             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    20730006
212800                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    20740006
212900                      '   SCAC-'             DELIMITED BY SIZE    20750006
213000                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    20760006
213100                      '   TRIP-'             DELIMITED BY SIZE    20770006
213200                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    20780006
213300                                        INTO                      20790006
213400                                        PC233-MESSAGE-TEXT(3)     20800006
213500                                                                  20810006
213600             MOVE 16                  TO PV-ERROR-NBR             20820006
213700                                         PC233-ERROR-NBR          20830006
213800             PERFORM 9903-WRITE-CICS-LOG                          20840006
213900             MOVE '7042-CLOSE-STORE-DOOR-CSR'                     20850076
214000                                      TO PC233-PARAGRAPH          20860006
214100             MOVE 'PCKRF870 - FETCH STORES FOR A DOOR'            20870006
214200                                      TO PC233-MESSAGE-TEXT(1)    20880006
214300             MOVE SQLCA               TO PC233-SQLCA              20890006
214400             MOVE 'TCNDRST'           TO PC233-DB2-TABLE-NAME(1)  20900006
214500             SET PC233-ABEND          TO TRUE                     20910006
214600             MOVE 99                  TO PC233-PGM-MSG-NBR        20920006
214700             PERFORM 8210-XCTL-ERROR-SCREEN                       20930006
214800     END-EVALUATE.                                                20940006
214900                                                                  20950029
215000                                                                  20960029
215100 7043-CK-MULT-STOR-DOOR.                                          20970029
215200                                                                  20980029
215300     MOVE PC233-OPER-UNT-ID  TO  DK-OPER-UNT-ID.                  20990030
215400                                                                  21000029
215500     EXEC SQL                                                     21010029
215600         SELECT FUNC_TXT                                          21020029
215700         INTO  :KRPRPM-FUNC-TXT                                   21030030
215800         FROM  TKRPRPM                                            21040029
215900         WHERE LOC_ID            = :DK-OPER-UNT-ID                21050029
216000           AND SYS_PRC_FUNC_CDE  = 'MLTDOR'                       21060029
216100           AND INTFC_SYS_CDE     = 'KHL'                          21070029
216200           AND FUNC_PRC_STAT_CDE = 'AC'                           21080029
216300           AND FUNC_TXT          = 'Y'                            21090029
216400     END-EXEC.                                                    21100029
216500                                                                  21110029
216600     EVALUATE TRUE                                                21120029
216700         WHEN SQLCODE = ZERO                                      21130029
216800             SET PS-MULT-DOORS-ALLOWED  TO TRUE                   21140029
216900         WHEN SQLCODE = +100                                      21150029
217000             SET PS-NO-MULT-DOORS       TO TRUE                   21160029
217100         WHEN SQLCODE = -904                                      21170029
217200         WHEN SQLCODE = -913                                      21180029
217300         WHEN SQLCODE = -911                                      21190029
217400             MOVE 2                   TO PV-ERROR-NBR             21200029
217500             PERFORM 9903-WRITE-CICS-LOG                          21210029
217600             PERFORM 9000-SOFT-ABORT                              21220029
217700         WHEN SQLWARN0 NOT = SPACES                               21230029
217800         WHEN SQLCODE NOT EQUAL ZERO                              21240029
217900              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      21250029
218000              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   21260029
218100              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      21270029
218200              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   21280029
218300              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      21290029
218400              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      21300029
218500              STRING  ' OPER-'               DELIMITED BY SIZE    21310029
218600                      PV-DISPLAY-OPER        DELIMITED BY SIZE    21320029
218700                      '  DOOR-'              DELIMITED BY SIZE    21330029
218800                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    21340029
218900                      '  DEST-'              DELIMITED BY SIZE    21350029
219000                      PV-DISPLAY-DEST        DELIMITED BY SIZE    21360029
219100                                        INTO                      21370029
219200                                        PC233-MESSAGE-TEXT(2)     21380029
219300             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    21390029
219400                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    21400029
219500                      '   SCAC-'             DELIMITED BY SIZE    21410029
219600                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    21420029
219700                      '   TRIP-'             DELIMITED BY SIZE    21430029
219800                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    21440029
219900                                        INTO                      21450029
220000                                        PC233-MESSAGE-TEXT(3)     21460029
220100                                                                  21470029
220200             MOVE 3                   TO PV-ERROR-NBR             21480029
220300                                         PC233-ERROR-NBR          21490029
220400             PERFORM 9903-WRITE-CICS-LOG                          21500029
220500             MOVE '7043-CK-MULT-STOR-DOOR'                        21510029
220600                                      TO PC233-PARAGRAPH          21520029
220700             MOVE 'PCKRF870 - CHECK MULT DOOR ALLOW FOR STORE'    21530029
220800                                      TO PC233-MESSAGE-TEXT(1)    21540029
220900             MOVE SQLCA               TO PC233-SQLCA              21550029
221000             MOVE 'TKRPRPM'           TO PC233-DB2-TABLE-NAME(1)  21560029
221100             SET PC233-ABEND          TO TRUE                     21570029
221200             MOVE 99                  TO PC233-PGM-MSG-NBR        21580029
221300             PERFORM 8210-XCTL-ERROR-SCREEN                       21590029
221400     END-EVALUATE.                                                21600029
221500                                                                          
221501                                                                          
221502*** DMH - BEGIN 6/6/06                                                    
221510 7044-CHECK-DEST-DC.                                                      
221511                                                                          
221512     MOVE PC233-STR-NBR      TO  XLT00010-LOC-NBR.                        
221513                                                                          
221514     EXEC SQL                                                             
221515         SELECT LOC_TYP_CDE                                               
221516         INTO  :XLT00010-LOC-TYP-CDE                                      
221517         FROM  XLT_LOC                                                    
221518         WHERE LOC_NBR           = :XLT00010-LOC-NBR                      
221523     END-EXEC.                                                            
221524                                                                          
221525     EVALUATE TRUE                                                        
221526         WHEN SQLCODE = ZERO                                              
221527              EVALUATE XLT00010-LOC-TYP-CDE                               
221528                  WHEN 'DC'                                               
221529                       SET  PS-LOCATION-DC  TO  TRUE                      
221530                  WHEN 'DS'                                               
221531                       SET  PS-LOCATION-STORE  TO  TRUE                   
221532                  WHEN OTHER                                              
221533                       SET  PS-LOCATION-NOT-DC-STORE TO  TRUE             
221534              END-EVALUATE                                                
221535         WHEN SQLCODE = +100                                              
221536              SET  PS-LOCATION-NOT-DC-STORE  TO  TRUE                     
221538         WHEN SQLCODE = -904                                              
221539         WHEN SQLCODE = -913                                              
221540         WHEN SQLCODE = -911                                              
221541             MOVE 2                   TO PV-ERROR-NBR                     
221542             PERFORM 9903-WRITE-CICS-LOG                                  
221543             PERFORM 9000-SOFT-ABORT                                      
221544         WHEN SQLWARN0 NOT = SPACES                                       
221545         WHEN SQLCODE NOT EQUAL ZERO                                      
221546              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER              
221547              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID           
221548              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST              
221549              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR           
221550              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC              
221551              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP              
221552              STRING  ' OPER-'               DELIMITED BY SIZE            
221553                      PV-DISPLAY-OPER        DELIMITED BY SIZE            
221554                      '  DOOR-'              DELIMITED BY SIZE            
221555                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE            
221556                      '  DEST-'              DELIMITED BY SIZE            
221557                      PV-DISPLAY-DEST        DELIMITED BY SIZE            
221558                                        INTO                              
221559                                        PC233-MESSAGE-TEXT(2)             
221560             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE            
221561                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE            
221562                      '   SCAC-'             DELIMITED BY SIZE            
221563                      PV-DISPLAY-SCAC        DELIMITED BY SIZE            
221564                      '   TRIP-'             DELIMITED BY SIZE            
221565                      PV-DISPLAY-TRIP        DELIMITED BY SIZE            
221566                                        INTO                              
221567                                        PC233-MESSAGE-TEXT(3)             
221568                                                                          
221569             MOVE 3                   TO PV-ERROR-NBR                     
221570                                         PC233-ERROR-NBR                  
221571             PERFORM 9903-WRITE-CICS-LOG                                  
221572             MOVE '7044-CHECK-DEST-DC'                                    
221573                                      TO PC233-PARAGRAPH                  
221574             MOVE 'PCKRF870 - CHECK STRG DOOR DEST = DC      '            
221575                                      TO PC233-MESSAGE-TEXT(1)            
221576             MOVE SQLCA               TO PC233-SQLCA                      
221577             MOVE 'XLT_LOC'           TO PC233-DB2-TABLE-NAME(1)          
221578             SET PC233-ABEND          TO TRUE                             
221579             MOVE 99                  TO PC233-PGM-MSG-NBR                
221580             PERFORM 8210-XCTL-ERROR-SCREEN                               
221581     END-EVALUATE.                                                        
221582                                                                          
221583                                                                          
221590*** DMH - END   6/6/06                                                    
221600                                                                          
221610                                                                          
221700 7050-SELECT-TRAILER-STATUS.                                      21630006
221800                                                                  21640006
221900     INITIALIZE  SUOBTS-OTBND-TRIP-ID                             21650006
222000                 CNTRID-TRLR-ID                                   21660006
222100                 CNTRID-TRLR-SRL-NBR                              21670006
222200                 SUOBTS-TRIP-STAT-CDE                             21680006
222300                                                                  21690006
222400     EXEC SQL                                                     21700006
222500       SELECT                                                     21710006
222600           OBTS.OTBND_TRIP_ID                                     21720006
222700       ,   TRID.TRLR_ID                                           21730006
222800       ,   TRID.TRLR_SRL_NBR                                      21740006
222900       ,   OBTS.TRIP_STAT_CDE                                     21750006
223000       ,   OBTR.DEST_OPER_UNT_ID                                  21760008
223010       ,   OBTR.ORGN_OPER_UNT_ID                                          
223100       INTO                                                       21770006
223200           :SUOBTS-OTBND-TRIP-ID                                  21780006
223300       ,   :CNTRID-TRLR-ID                                        21790006
223400       ,   :CNTRID-TRLR-SRL-NBR                                   21800006
223500       ,   :SUOBTS-TRIP-STAT-CDE                                  21810006
223600       ,   :SUOBTR-DEST-OPER-UNT-ID                               21820008
223610       ,   :SUOBTR-ORGN-OPER-UNT-ID                               21820008
223700       FROM TSUOBTS OBTS                                          21830006
223800       ,    TSUOBTR OBTR                                          21840006
223900       ,    TCNTRID TRID                                          21850006
224000       WHERE                                                      21860006
224100           OBTR.TRLR_SRL_NBR        = :PC233-SERIAL-NBR           21880086
224200       AND OBTR.TRIP_ACTV_CDE       = 'A'                         21890006
224300       AND OBTR.TRLR_SRL_NBR        = TRID.TRLR_SRL_NBR           21900006
224400       AND OBTS.OTBND_TRIP_ID       = OBTR.OTBND_TRIP_ID          21910006
224500                                                                  21920006
224600       AND OBTS.OTBND_STAT_TMST =                                 21930006
224700           (SELECT MAX(OBTS1.OTBND_STAT_TMST)                     21940006
224800               FROM TSUOBTS OBTS1                                 21950006
224900               ,    TSUOBTR OBTR1                                 21960006
225000               WHERE                                              21970006
225100                 OBTR1.TRLR_SRL_NBR        = :PC233-SERIAL-NBR    21980006
225200               AND  OBTS1.OTBND_TRIP_ID    = OBTR1.OTBND_TRIP_ID) 21990006
225300                                                                  22000006
225400     END-EXEC.                                                    22010006
225500                                                                  22020006
225600     EVALUATE TRUE                                                22030006
225700         WHEN SQLCODE = ZERO                                      22040006
225800             IF  SUOBTS-TRIP-STAT-CDE = ('AR' OR 'DR' OR          22050028
225900                                         'SO' OR 'SU')            22060028
226000                 SET PS-NO-ACTIVE-TRIP-EXISTS  TO  TRUE           22070021
226100                 INITIALIZE  SUOBTS-OTBND-TRIP-ID                 22080020
226200                             CNTRID-TRLR-ID                       22090020
226300                             CNTRID-TRLR-SRL-NBR                  22100020
226400                             SUOBTS-TRIP-STAT-CDE                 22110020
226500             ELSE                                                 22120020
226600                 SET PS-ACTIVE-TRIP-EXISTS  TO  TRUE              22130021
226610*** DMH 6/20/2017 BEGIN                                                   
226611                 IF  SUOBTS-TRIP-STAT-CDE = 'DC'  AND                     
226612                     NOT SUOBTR-ORGN-OPER-UNT-ID                          
226613                         = PC233-OPER-UNT-ID                              
226614                     SET PS-DOOR-MISMATCH-ERROR  TO TRUE          22170020
226615                 ELSE                                                     
226620*** DMH 6/20/2017 END                                                     
226700                     IF  SUOBTR-DEST-OPER-UNT-ID = PC233-STR-NBR  22140020
226800                         CONTINUE                                 22150020
226900                     ELSE                                         22160020
227000                         SET PS-DOOR-MISMATCH-ERROR  TO TRUE      22170020
227100                     END-IF                                               
227110                 END-IF                                           22180020
227200             END-IF                                               22190020
227300                                                                  22200020
227400         WHEN SQLCODE = +100                                      22210006
227500             SET PS-NO-ACTIVE-TRIP-EXISTS                         22220006
227600                                      TO TRUE                     22230006
227700         WHEN SQLCODE = -904                                      22240006
227800         WHEN SQLCODE = -913                                      22250006
227900         WHEN SQLCODE = -911                                      22260006
228000             MOVE 17                  TO PV-ERROR-NBR             22270006
228100             PERFORM 9903-WRITE-CICS-LOG                          22280006
228200             PERFORM 9000-SOFT-ABORT                              22290006
228300         WHEN SQLWARN0 NOT = SPACES                               22300006
228400         WHEN SQLCODE NOT EQUAL ZERO                              22310006
228500              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      22320006
228600              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   22330006
228700              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      22340006
228800              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   22350006
228900              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      22360006
229000              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      22370006
229100              STRING  ' OPER-'               DELIMITED BY SIZE    22380006
229200                      PV-DISPLAY-OPER        DELIMITED BY SIZE    22390006
229300                      '  DOOR-'              DELIMITED BY SIZE    22400006
229400                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    22410006
229500                      '  DEST-'              DELIMITED BY SIZE    22420006
229600                      PV-DISPLAY-DEST        DELIMITED BY SIZE    22430006
229700                                        INTO                      22440006
229800                                        PC233-MESSAGE-TEXT(2)     22450006
229900             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    22460006
230000                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    22470006
230100                      '   SCAC-'             DELIMITED BY SIZE    22480006
230200                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    22490006
230300                      '   TRIP-'             DELIMITED BY SIZE    22500006
230400                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    22510006
230500                                        INTO                      22520006
230600                                        PC233-MESSAGE-TEXT(3)     22530006
230700                                                                  22540006
230800             MOVE 18                  TO PV-ERROR-NBR             22550006
230900                                         PC233-ERROR-NBR          22560006
231000             PERFORM 9903-WRITE-CICS-LOG                          22570006
231100             MOVE '7050-SELECT-TRAILER-STATUS'                    22580006
231200                                      TO PC233-PARAGRAPH          22590006
231300             MOVE 'PCKRF870 - CHECK TRLR AT ANOTHER DOOR'         22600006
231400                                      TO PC233-MESSAGE-TEXT(1)    22610006
231500             MOVE SQLCA               TO PC233-SQLCA              22620006
231600             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  22630006
231700             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(2)  22640006
231800             SET PC233-ABEND          TO TRUE                     22650006
231900             MOVE 99                  TO PC233-PGM-MSG-NBR        22660006
232000             PERFORM 8210-XCTL-ERROR-SCREEN                       22670006
232100     END-EVALUATE.                                                22680006
232200/                                                                 22690006
232300 7060-SELECT-TCNDRST.                                             22700006
232400                                                                  22710006
232500     EXEC SQL                                                     22720006
232600         SELECT  ST.STR_NBR                                       22730006
232700         INTO  :CNDRST-STR-NBR                                    22740006
232800         FROM TCNDRST ST                                          22750006
232900         WHERE ST.OPER_UNT_ID = :PC233-OPER-UNT-ID                22760006
233000           AND ST.DOOR_ID     = :PC233-DOOR-ID                    22770006
233100           AND CURRENT TIMESTAMP BETWEEN                          22780015
233200               ST.STRT_TMST AND ST.END_TMST                       22790015
233300     END-EXEC                                                     22800006
233400                                                                  22810006
233500     EVALUATE TRUE                                                22820006
233600         WHEN SQLCODE = ZERO                                      22830006
233700         WHEN SQLCODE = +100                                      22840006
233800         WHEN SQLCODE = -811                                      22850006
233900             CONTINUE                                             22860006
234000         WHEN SQLCODE = -904                                      22870006
234100         WHEN SQLCODE = -913                                      22880006
234200         WHEN SQLCODE = -911                                      22890006
234300             MOVE 19                  TO PV-ERROR-NBR             22900006
234400             PERFORM 9903-WRITE-CICS-LOG                          22910006
234500             PERFORM 9000-SOFT-ABORT                              22920006
234600         WHEN SQLWARN0 NOT = SPACES                               22930006
234700         WHEN SQLCODE NOT EQUAL ZERO                              22940006
234800              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      22950006
234900              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   22960006
235000              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      22970006
235100              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   22980006
235200              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      22990006
235300              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      23000006
235400              STRING  ' OPER-'               DELIMITED BY SIZE    23010006
235500                      PV-DISPLAY-OPER        DELIMITED BY SIZE    23020006
235600                      '  DOOR-'              DELIMITED BY SIZE    23030006
235700                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    23040006
235800                      '  DEST-'              DELIMITED BY SIZE    23050006
235900                      PV-DISPLAY-DEST        DELIMITED BY SIZE    23060006
236000                                        INTO                      23070006
236100                                        PC233-MESSAGE-TEXT(2)     23080006
236200             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    23090006
236300                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    23100006
236400                      '   SCAC-'             DELIMITED BY SIZE    23110006
236500                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    23120006
236600                      '   TRIP-'             DELIMITED BY SIZE    23130006
236700                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    23140006
236800                                        INTO                      23150006
236900                                        PC233-MESSAGE-TEXT(3)     23160006
237000                                                                  23170006
237100             MOVE 20                  TO PV-ERROR-NBR             23180006
237200                                         PC233-ERROR-NBR          23190006
237300             PERFORM 9903-WRITE-CICS-LOG                          23200006
237400             MOVE '7060-SELECT-TSUOBTS'                           23210006
237500                                      TO PC233-PARAGRAPH          23220006
237600             MOVE 'PCKRF870 - CHECK TRLR AT ANOTHER DOOR'         23230006
237700                                      TO PC233-MESSAGE-TEXT(1)    23240006
237800             MOVE SQLCA               TO PC233-SQLCA              23250006
237900             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(1)  23260006
238000             SET PC233-ABEND          TO TRUE                     23270006
238100             MOVE 99                  TO PC233-PGM-MSG-NBR        23280006
238200             PERFORM 8210-XCTL-ERROR-SCREEN                       23290006
238300     END-EVALUATE.                                                23300006
238400/                                                                 23310006
238500 7070-CHECK-OPEN-TRAILERS.                                        23320006
238600                                                                  23330006
238700     EXEC SQL                                                     23340006
238800         SELECT OBTS.OTBND_TRIP_ID                                23350006
238900         ,      OBTR.TRLR_SRL_NBR                                 23360006
239000         INTO :SUOBTS-OTBND-TRIP-ID                               23370006
239100         ,    :SUOBTR-TRLR-SRL-NBR                                23380006
239200         FROM TSUOBTS OBTS                                        23390006
239300         ,    TSUOBTR OBTR                                        23400006
239400         WHERE OBTS.TRIP_STAT_CDE     = 'DO'                      23410006
239500         AND OBTS.DOOR_ID             = :PC233-DOOR-ID            23420006
239600         AND OBTR.ORGN_OPER_UNT_ID    = :PC233-OPER-UNT-ID        23430006
239700         AND OBTR.OTBND_TRIP_ID       = OBTS.OTBND_TRIP_ID        23440006
239800         AND OBTS.OTBND_STAT_TMST     =                           23450006
239900         (                                                        23460006
240000          SELECT                                                  23470006
240100            MAX(OBTS1.OTBND_STAT_TMST)                            23480006
240200            FROM TSUOBTS OBTS1                                    23490006
240300            WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID        23500006
240400         )                                                        23510006
240500     END-EXEC.                                                    23520006
240600                                                                  23530006
240700     EVALUATE TRUE                                                23540006
240800         WHEN SQLCODE = ZERO                                      23550006
240900         WHEN SQLCODE = +100                                      23560006
241000         WHEN SQLCODE = -811                                      23570006
241100             CONTINUE                                             23580006
241200         WHEN SQLCODE = -904                                      23590006
241300         WHEN SQLCODE = -913                                      23600006
241400         WHEN SQLCODE = -911                                      23610006
241500             MOVE 21                  TO PV-ERROR-NBR             23620006
241600             PERFORM 9903-WRITE-CICS-LOG                          23630006
241700             PERFORM 9000-SOFT-ABORT                              23640006
241800         WHEN SQLWARN0 NOT = SPACES                               23650006
241900         WHEN SQLCODE NOT EQUAL ZERO                              23660006
242000              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      23670006
242100              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   23680006
242200              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      23690006
242300              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   23700006
242400              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      23710006
242500              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      23720006
242600              STRING  ' OPER-'               DELIMITED BY SIZE    23730006
242700                      PV-DISPLAY-OPER        DELIMITED BY SIZE    23740006
242800                      '  DOOR-'              DELIMITED BY SIZE    23750006
242900                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    23760006
243000                      '  DEST-'              DELIMITED BY SIZE    23770006
243100                      PV-DISPLAY-DEST        DELIMITED BY SIZE    23780006
243200                                        INTO                      23790006
243300                                        PC233-MESSAGE-TEXT(2)     23800006
243400             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    23810006
243500                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    23820006
243600                      '   SCAC-'             DELIMITED BY SIZE    23830006
243700                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    23840006
243800                      '   TRIP-'             DELIMITED BY SIZE    23850006
243900                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    23860006
244000                                        INTO                      23870006
244100                                        PC233-MESSAGE-TEXT(3)     23880006
244200                                                                  23890006
244300             MOVE 22                  TO PV-ERROR-NBR             23900006
244400                                         PC233-ERROR-NBR          23910006
244500             PERFORM 9903-WRITE-CICS-LOG                          23920006
244600             MOVE '7070-CHECK-OPEN-TRAILERS'                      23930006
244700                                      TO PC233-PARAGRAPH          23940006
244800             MOVE 'PCKRF870 - CHECK OPEN TRAILERS AT DOOR'        23950006
244900                                      TO PC233-MESSAGE-TEXT(1)    23960006
245000             MOVE SQLCA               TO PC233-SQLCA              23970006
245100             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  23980006
245200             SET PC233-ABEND          TO TRUE                     23990006
245300             MOVE 99                  TO PC233-PGM-MSG-NBR        24000006
245400             PERFORM 8210-XCTL-ERROR-SCREEN                       24010006
245500     END-EVALUATE.                                                24020006
245600/                                                                 24030006
245700 7080-SELECT-TCNDRST.                                             24040006
245800     EXEC SQL                                                     24050006
245900         SELECT                                                   24060006
246000             DRST.DOOR_ID                                         24070006
246100         INTO                                                     24080006
246200             :CNDRST-DOOR-ID                                      24090006
246300         FROM TCNDRST DRST                                        24100006
246400         WHERE                                                    24110006
246500             DRST.OPER_UNT_ID         = :PC233-OPER-UNT-ID        24120006
246600         AND DRST.STR_NBR             = :PC233-STR-NBR            24130006
246700         AND CURRENT TIMESTAMP BETWEEN                            24140006
246800              DRST.STRT_TMST AND DRST.END_TMST                    24150006
246900     END-EXEC.                                                    24160006
247000                                                                  24170006
247100     EVALUATE TRUE                                                24180006
247200         WHEN SQLCODE = ZERO                                      24190006
247300         WHEN SQLCODE = +100                                      24200006
247400         WHEN SQLCODE = -811                                      24210006
247500             CONTINUE                                             24220006
247600         WHEN SQLCODE = -904                                      24230006
247700         WHEN SQLCODE = -913                                      24240006
247800         WHEN SQLCODE = -911                                      24250006
247900             MOVE 23                  TO PV-ERROR-NBR             24260006
248000             PERFORM 9903-WRITE-CICS-LOG                          24270006
248100             PERFORM 9000-SOFT-ABORT                              24280006
248200         WHEN SQLWARN0 NOT = SPACES                               24290006
248300         WHEN SQLCODE NOT EQUAL ZERO                              24300006
248400              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      24310006
248500              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   24320006
248600              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      24330006
248700              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   24340006
248800              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      24350006
248900              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      24360006
249000              STRING  ' OPER-'               DELIMITED BY SIZE    24370006
249100                      PV-DISPLAY-OPER        DELIMITED BY SIZE    24380006
249200                      '  DOOR-'              DELIMITED BY SIZE    24390006
249300                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    24400006
249400                      '  DEST-'              DELIMITED BY SIZE    24410006
249500                      PV-DISPLAY-DEST        DELIMITED BY SIZE    24420006
249600                                        INTO                      24430006
249700                                        PC233-MESSAGE-TEXT(2)     24440006
249800             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    24450006
249900                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    24460006
250000                      '   SCAC-'             DELIMITED BY SIZE    24470006
250100                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    24480006
250200                      '   TRIP-'             DELIMITED BY SIZE    24490006
250300                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    24500006
250400                                        INTO                      24510006
250500                                        PC233-MESSAGE-TEXT(3)     24520006
250600                                                                  24530006
250700             MOVE 24                  TO PV-ERROR-NBR             24540006
250800                                         PC233-ERROR-NBR          24550006
250900             PERFORM 9903-WRITE-CICS-LOG                          24560006
251000             MOVE '7080-SELECT-TCNDRST'                           24570006
251100                                      TO PC233-PARAGRAPH          24580006
251200             MOVE 'PCKRF870 - CHECK OPEN TRAILERS AT DOOR'        24590006
251300                                      TO PC233-MESSAGE-TEXT(1)    24600006
251400             MOVE SQLCA               TO PC233-SQLCA              24610006
251500             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  24620006
251600             SET PC233-ABEND          TO TRUE                     24630006
251700             MOVE 99                  TO PC233-PGM-MSG-NBR        24640006
251800             PERFORM 8210-XCTL-ERROR-SCREEN                       24650006
251900     END-EVALUATE.                                                24660006
252000/                                                                 24670006
252100 7090-SELECT-TCNDRST.                                             24680006
252200     EXEC SQL                                                     24690006
252300         SELECT OBTS.DOOR_ID                                      24700006
252400            ,   OBTR.TRLR_SRL_NBR                                 24710006
252500            ,   OBTR.OTBND_TRIP_ID                                24720006
252600         INTO :SUOBTS-DOOR-ID                                     24730006
252700            , :SUOBTR-TRLR-SRL-NBR                                24740006
252800            , :SUOBTR-OTBND-TRIP-ID                               24750006
252900         FROM TSUOBTR OBTR                                        24760006
253000         ,    TSUOBTS OBTS                                        24770006
253100         WHERE                                                    24780006
253200             OBTR.DEST_OPER_UNT_ID = :PC233-STR-NBR               24790006
253300             AND OBTR.TRIP_ACTV_CDE = 'A'                         24800006
253400             AND OBTS.OTBND_TRIP_ID = OBTR.OTBND_TRIP_ID          24810006
253500         AND OBTS.OTBND_STAT_TMST =                               24820006
253600         (                                                        24830006
253700          SELECT                                                  24840006
253800            MAX(OBTS1.OTBND_STAT_TMST)                            24850006
253900            FROM TSUOBTS OBTS1                                    24860006
254000            WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID        24870006
254100         )                                                        24880006
254200     END-EXEC                                                     24890006
254300                                                                  24900006
254400     EVALUATE TRUE                                                24910006
254500         WHEN SQLCODE = ZERO                                      24920006
254600         WHEN SQLCODE = +100                                      24930006
254700         WHEN SQLCODE = -811                                      24940006
254800             CONTINUE                                             24950006
254900         WHEN SQLCODE = -904                                      24960006
255000         WHEN SQLCODE = -913                                      24970006
255100         WHEN SQLCODE = -911                                      24980006
255200             MOVE 25                  TO PV-ERROR-NBR             24990006
255300             PERFORM 9903-WRITE-CICS-LOG                          25000006
255400             PERFORM 9000-SOFT-ABORT                              25010006
255500         WHEN SQLWARN0 NOT = SPACES                               25020006
255600         WHEN SQLCODE NOT EQUAL ZERO                              25030006
255700              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      25040006
255800              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   25050006
255900              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      25060006
256000              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   25070006
256100              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      25080006
256200              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      25090006
256300              STRING  ' OPER-'               DELIMITED BY SIZE    25100006
256400                      PV-DISPLAY-OPER        DELIMITED BY SIZE    25110006
256500                      '  DOOR-'              DELIMITED BY SIZE    25120006
256600                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    25130006
256700                      '  DEST-'              DELIMITED BY SIZE    25140006
256800                      PV-DISPLAY-DEST        DELIMITED BY SIZE    25150006
256900                                        INTO                      25160006
257000                                        PC233-MESSAGE-TEXT(2)     25170006
257100             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    25180006
257200                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    25190006
257300                      '   SCAC-'             DELIMITED BY SIZE    25200006
257400                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    25210006
257500                      '   TRIP-'             DELIMITED BY SIZE    25220006
257600                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    25230006
257700                                        INTO                      25240006
257800                                        PC233-MESSAGE-TEXT(3)     25250006
257900                                                                  25260006
258000             MOVE 26                  TO PV-ERROR-NBR             25270006
258100                                         PC233-ERROR-NBR          25280006
258200             PERFORM 9903-WRITE-CICS-LOG                          25290006
258300             MOVE '7090-SELECT-TCNDRST'                           25300006
258400                                      TO PC233-PARAGRAPH          25310006
258500             MOVE 'PCKRF870 - CHECK OPEN TRAILERS AT DOOR'        25320006
258600                                      TO PC233-MESSAGE-TEXT(1)    25330006
258700             MOVE SQLCA               TO PC233-SQLCA              25340006
258800             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  25350006
258900             SET PC233-ABEND          TO TRUE                     25360006
259000             MOVE 99                  TO PC233-PGM-MSG-NBR        25370006
259100             PERFORM 8210-XCTL-ERROR-SCREEN                       25380006
259200     END-EVALUATE.                                                25390006
259300/                                                                 25400006
259400 7100-GET-STR-DOOR-FROM-TRAILER.                                  25410006
259500                                                                  25420006
259600     EXEC SQL                                                     25430006
259700         SELECT OBTS.DOOR_ID                                      25440006
259800         ,      OBTR.DEST_OPER_UNT_ID                             25450006
259900         INTO :SUOBTS-DOOR-ID                                     25460006
260000         ,    :SUOBTR-DEST-OPER-UNT-ID                            25470006
260100         FROM TSUOBTR OBTR                                        25480006
260200         ,    TSUOBTS OBTS                                        25490006
260300         WHERE                                                    25500006
260400             OBTR.TRLR_SRL_NBR      = :PC233-SERIAL-NBR           25510006
260500             AND OBTR.TRIP_ACTV_CDE = 'A'                         25520006
260600             AND OBTS.TRIP_STAT_CDE IN ('DO', 'DC')               25530006
260700             AND OBTS.OTBND_TRIP_ID = OBTR.OTBND_TRIP_ID          25540006
260800         AND OBTS.OTBND_STAT_TMST =                               25550006
260900         (                                                        25560006
261000          SELECT                                                  25570006
261100            MAX(OBTS1.OTBND_STAT_TMST)                            25580006
261200            FROM TSUOBTS OBTS1                                    25590006
261300            WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID        25600006
261400         )                                                        25610006
261500     END-EXEC                                                     25620006
261600                                                                  25630006
261700     EVALUATE TRUE                                                25640006
261800         WHEN SQLCODE = ZERO                                      25650006
261900         WHEN SQLCODE = +100                                      25660006
262000         WHEN SQLCODE = -811                                      25670006
262100             CONTINUE                                             25680006
262200         WHEN SQLCODE = -904                                      25690006
262300         WHEN SQLCODE = -913                                      25700006
262400         WHEN SQLCODE = -911                                      25710006
262500             MOVE 27                  TO PV-ERROR-NBR             25720006
262600             PERFORM 9903-WRITE-CICS-LOG                          25730006
262700             PERFORM 9000-SOFT-ABORT                              25740006
262800         WHEN SQLWARN0 NOT = SPACES                               25750006
262900         WHEN SQLCODE NOT EQUAL ZERO                              25760006
263000              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      25770006
263100              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   25780006
263200              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      25790006
263300              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   25800006
263400              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      25810006
263500              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      25820006
263600              STRING  ' OPER-'               DELIMITED BY SIZE    25830006
263700                      PV-DISPLAY-OPER        DELIMITED BY SIZE    25840006
263800                      '  DOOR-'              DELIMITED BY SIZE    25850006
263900                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    25860006
264000                      '  DEST-'              DELIMITED BY SIZE    25870006
264100                      PV-DISPLAY-DEST        DELIMITED BY SIZE    25880006
264200                                        INTO                      25890006
264300                                        PC233-MESSAGE-TEXT(2)     25900006
264400             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    25910006
264500                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    25920006
264600                      '   SCAC-'             DELIMITED BY SIZE    25930006
264700                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    25940006
264800                      '   TRIP-'             DELIMITED BY SIZE    25950006
264900                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    25960006
265000                                        INTO                      25970006
265100                                        PC233-MESSAGE-TEXT(3)     25980006
265200                                                                  25990006
265300             MOVE 28                  TO PV-ERROR-NBR             26000006
265400                                         PC233-ERROR-NBR          26010006
265500             PERFORM 9903-WRITE-CICS-LOG                          26020006
265600             MOVE '7100-GET-STR-DOOR-FROM-TRAILER'                26030006
265700                                      TO PC233-PARAGRAPH          26040006
265800             MOVE 'PCKRF870 - GET STORE/DOOR INFO FROM TRLR'      26050006
265900                                      TO PC233-MESSAGE-TEXT(1)    26060006
266000             MOVE SQLCA               TO PC233-SQLCA              26070006
266100             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  26080006
266200             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(2)  26090006
266300             SET PC233-ABEND          TO TRUE                     26100006
266400             MOVE 99                  TO PC233-PGM-MSG-NBR        26110006
266500             PERFORM 8210-XCTL-ERROR-SCREEN                       26120006
266600     END-EVALUATE.                                                26130006
266700                                                                  26140006
266800 7110-CHECK-STATUS-CODES.                                         26150006
266900                                                                  26160006
267000* THE PRTY OF THE INTENDED STATUS MUST BE GREATER THAN OR EQUAL   26170006
267100* TO THE BACKWARD PRTY OF THE CURRENT STATUS.                     26180006
267200* I.E WILL I BE ALLOWED TO CREATE A NEW TRIP FOR THIS TRAILER     26190006
267300* CONSIDERING THE CURRENT STATUS OF THE TRIP?                     26200006
267400                                                                  26210006
267500                                                                  26220006
267600     EXEC SQL                                                     26230006
267700          SELECT CURR_TRIP_STAT_CDE                               26240006
267800          INTO :SUT00005-CURR-TRIP-STAT-CDE                       26250006
267900          FROM SUT_STAT_ASSN SUT                                  26260006
268000          WHERE                                                   26270006
268100             SUT.CURR_TRIP_STAT_CDE = :SUOBTS-TRIP-STAT-CDE       26280006
268200         AND SUT.NEXT_TRIP_STAT_CDE = 'DO'                        26290006
268300     END-EXEC                                                     26300006
268400                                                                  26310006
268500     EVALUATE TRUE                                                26320006
268600         WHEN SQLCODE = ZERO                                      26330006
268700         WHEN SQLCODE = +100                                      26340006
268800         WHEN SQLCODE = -811                                      26350006
268900             CONTINUE                                             26360006
269000         WHEN SQLCODE = -904                                      26370006
269100         WHEN SQLCODE = -913                                      26380006
269200         WHEN SQLCODE = -911                                      26390006
269300             MOVE 29                  TO PV-ERROR-NBR             26400006
269400             PERFORM 9903-WRITE-CICS-LOG                          26410006
269500             PERFORM 9000-SOFT-ABORT                              26420006
269600         WHEN SQLWARN0 NOT = SPACES                               26430006
269700         WHEN SQLCODE NOT EQUAL ZERO                              26440006
269800              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      26450006
269900              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   26460006
270000              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      26470006
270100              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   26480006
270200              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      26490006
270300              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      26500006
270400              STRING  ' OPER-'               DELIMITED BY SIZE    26510006
270500                      PV-DISPLAY-OPER        DELIMITED BY SIZE    26520006
270600                      '  DOOR-'              DELIMITED BY SIZE    26530006
270700                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    26540006
270800                      '  DEST-'              DELIMITED BY SIZE    26550006
270900                      PV-DISPLAY-DEST        DELIMITED BY SIZE    26560006
271000                                        INTO                      26570006
271100                                        PC233-MESSAGE-TEXT(2)     26580006
271200             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    26590006
271300                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    26600006
271400                      '   SCAC-'             DELIMITED BY SIZE    26610006
271500                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    26620006
271600                      '   TRIP-'             DELIMITED BY SIZE    26630006
271700                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    26640006
271800                                        INTO                      26650006
271900                                        PC233-MESSAGE-TEXT(3)     26660006
272000                                                                  26670006
272100             MOVE 30                  TO PV-ERROR-NBR             26680006
272200                                         PC233-ERROR-NBR          26690006
272300             PERFORM 9903-WRITE-CICS-LOG                          26700006
272400             MOVE '7110-CHECK-STATUS-CODES'                       26710006
272500                                      TO PC233-PARAGRAPH          26720006
272600             MOVE 'PCKRF870 - IS ACTION ALLOWABLE'                26730006
272700                                      TO PC233-MESSAGE-TEXT(1)    26740006
272800             MOVE SQLCA               TO PC233-SQLCA              26750006
272900             MOVE 'SUT_STAT_ASSN'     TO PC233-DB2-TABLE-NAME(1)  26760006
273000             SET PC233-ABEND          TO TRUE                     26770006
273100             MOVE 99                  TO PC233-PGM-MSG-NBR        26780006
273200             PERFORM 8210-XCTL-ERROR-SCREEN                       26790006
273300     END-EVALUATE.                                                26800006
273400                                                                  26810006
273500 7111-SELECT-TSUOBSC.                                             26820006
273600                                                                  26830006
273700     EXEC SQL                                                     26840006
273800          SELECT STAT_SHRT_DESC                                   26850006
273900          INTO :SUOBSC-STAT-SHRT-DESC                             26860006
274000          FROM TSUOBSC                                            26870006
274100          WHERE                                                   26880006
274200             TRIP_STAT_CDE = :SUOBTS-TRIP-STAT-CDE                26890006
274300     END-EXEC                                                     26900006
274400                                                                  26910006
274500                                                                  26920006
274600     EVALUATE TRUE                                                26930006
274700         WHEN SQLCODE = ZERO                                      26940006
274800         WHEN SQLCODE = +100                                      26950006
274900         WHEN SQLCODE = -811                                      26960006
275000             CONTINUE                                             26970006
275100         WHEN SQLCODE = -904                                      26980006
275200         WHEN SQLCODE = -913                                      26990006
275300         WHEN SQLCODE = -911                                      27000006
275400             MOVE 31                  TO PV-ERROR-NBR             27010006
275500             PERFORM 9903-WRITE-CICS-LOG                          27020006
275600             PERFORM 9000-SOFT-ABORT                              27030006
275700         WHEN SQLWARN0 NOT = SPACES                               27040006
275800         WHEN SQLCODE NOT EQUAL ZERO                              27050006
275900              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      27060006
276000              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   27070006
276100              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      27080006
276200              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   27090006
276300              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      27100006
276400              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      27110006
276500              STRING  ' OPER-'               DELIMITED BY SIZE    27120006
276600                      PV-DISPLAY-OPER        DELIMITED BY SIZE    27130006
276700                      '  DOOR-'              DELIMITED BY SIZE    27140006
276800                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    27150006
276900                      '  DEST-'              DELIMITED BY SIZE    27160006
277000                      PV-DISPLAY-DEST        DELIMITED BY SIZE    27170006
277100                                        INTO                      27180006
277200                                        PC233-MESSAGE-TEXT(2)     27190006
277300             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    27200006
277400                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    27210006
277500                      '   SCAC-'             DELIMITED BY SIZE    27220006
277600                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    27230006
277700                      '   TRIP-'             DELIMITED BY SIZE    27240006
277800                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    27250006
277900                                        INTO                      27260006
278000                                        PC233-MESSAGE-TEXT(3)     27270006
278100                                                                  27280006
278200             MOVE 32                  TO PV-ERROR-NBR             27290006
278300                                         PC233-ERROR-NBR          27300006
278400             PERFORM 9903-WRITE-CICS-LOG                          27310006
278500             MOVE '7111-SELECT-TSUOBSC'                           27320006
278600                                      TO PC233-PARAGRAPH          27330006
278700             MOVE 'PCKRF870 - GET STATUS DESCRIPTION'             27340006
278800                                      TO PC233-MESSAGE-TEXT(1)    27350006
278900             MOVE SQLCA               TO PC233-SQLCA              27360006
279000             MOVE 'TSUOBSC'           TO PC233-DB2-TABLE-NAME(1)  27370006
279100             SET PC233-ABEND          TO TRUE                     27380006
279200             MOVE 99                  TO PC233-PGM-MSG-NBR        27390006
279300             PERFORM 8210-XCTL-ERROR-SCREEN                       27400006
279400     END-EVALUATE.                                                27410006
279500/                                                                 27420006
279600 7200-INSERT-TSUOBTR.                                             27430006
279700                                                                  27440006
279800     INITIALIZE SUOBTR-BOL-ID                                     27450006
279900                                                                  27460006
280000     EXEC SQL                                                     27470006
280100       INSERT INTO TSUOBTR                                        27480006
280200           ( OTBND_TRIP_ID                                        27490006
280300            ,ORGN_OPER_UNT_ID                                     27500006
280400            ,DEST_OPER_UNT_ID                                     27510006
280500            ,TRLR_SRL_NBR                                         27520006
280600            ,BOL_ID                                               27530006
280700            ,EST_ARRVL_TMST                                       27540006
280800            ,TRIP_ACTV_CDE                                        27550006
280900            ,DOOR_TYP_CDE                                         27560006
281000           )                                                      27570006
281100                                                                  27580006
281200       VALUES                                                     27590006
281300                                                                  27600006
281400           (                                                      27610006
281500             :SUOBTR-OTBND-TRIP-ID                                27620006
281600           , :PC233-OPER-UNT-ID                                   27630006
281700           , :PC233-STR-NBR                                       27640006
281800           , :PC233-SERIAL-NBR                                    27650006
281900           , :SUOBTR-BOL-ID                                       27660006
282000           , :PC-DUMMY-TIMESTAMP                                  27670006
282100           , 'A'                                                  27680006
282200           , :SUOBTR-DOOR-TYP-CDE                                 27690006
282300         )                                                        27700006
282400                                                                  27710006
282500     END-EXEC.                                                    27720006
282600                                                                  27730006
282700                                                                  27740006
282800     EVALUATE TRUE                                                27750006
282900         WHEN SQLCODE = ZERO                                      27760006
283000             CONTINUE                                             27770006
283100         WHEN SQLCODE = -904                                      27780006
283200         WHEN SQLCODE = -913                                      27790006
283300         WHEN SQLCODE = -911                                      27800006
283400             MOVE 33                  TO PV-ERROR-NBR             27810006
283500             PERFORM 9903-WRITE-CICS-LOG                          27820006
283600             PERFORM 9000-SOFT-ABORT                              27830006
283700         WHEN SQLWARN0 NOT = SPACES                               27840006
283800         WHEN SQLCODE NOT EQUAL ZERO                              27850006
283900              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      27860006
284000              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   27870006
284100              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      27880006
284200              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   27890006
284300              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      27900006
284400              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      27910006
284500              STRING  ' OPER-'               DELIMITED BY SIZE    27920006
284600                      PV-DISPLAY-OPER        DELIMITED BY SIZE    27930006
284700                      '  DOOR-'              DELIMITED BY SIZE    27940006
284800                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    27950006
284900                      '  DEST-'              DELIMITED BY SIZE    27960006
285000                      PV-DISPLAY-DEST        DELIMITED BY SIZE    27970006
285100                                        INTO                      27980006
285200                                        PC233-MESSAGE-TEXT(2)     27990006
285300             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    28000006
285400                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    28010006
285500                      '   SCAC-'             DELIMITED BY SIZE    28020006
285600                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    28030006
285700                      '   TRIP-'             DELIMITED BY SIZE    28040006
285800                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    28050006
285900                                        INTO                      28060006
286000                                        PC233-MESSAGE-TEXT(3)     28070006
286100                                                                  28080006
286200             MOVE 34                  TO PV-ERROR-NBR             28090006
286300                                         PC233-ERROR-NBR          28100006
286400             PERFORM 9903-WRITE-CICS-LOG                          28110006
286500             MOVE '7200-INSERT-TSUOBTR'                           28120006
286600                                      TO PC233-PARAGRAPH          28130006
286700             MOVE 'PCKRF870 - CREATE NEW TRAILER TRIP'            28140006
286800                                      TO PC233-MESSAGE-TEXT(1)    28150006
286900             MOVE SQLCA               TO PC233-SQLCA              28160006
287000             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(1)  28170006
287100             SET PC233-ABEND          TO TRUE                     28180006
287200             MOVE 99                  TO PC233-PGM-MSG-NBR        28190006
287300             PERFORM 8210-XCTL-ERROR-SCREEN                       28200006
287400     END-EVALUATE.                                                28210006
287500                                                                  28220006
287600 7250-INSERT-TSUOBTS.                                             28230006
287700                                                                  28240006
287800     INITIALIZE SUOBTS-TRLR-SEAL-ID                               28250006
287900                SUOBTS-SHIP-DRV-LAST-NM                           28260006
288000                SUOBTS-SHIP-DRV-FRST-NM                           28270006
288100                SUOBTS-SHIP-DRV-ID                                28280006
288200                SUOBTS-TRLR-PRKG-LOC-DESC                         28290006
288300                SUOBTS-TRLR-PRKG-SLOT-NBR                         28300006
288400                                                                  28310006
288500     EXEC SQL                                                     28320006
288600       INSERT INTO TSUOBTS                                        28330006
288700           ( OTBND_TRIP_ID                                        28340006
288800            ,OTBND_STAT_TMST                                      28350006
288900            ,TRIP_STAT_CDE                                        28360006
289000            ,STAT_OPER_UNT_ID                                     28370006
289100            ,OTBND_STAT_USR_ID                                    28380006
289200            ,DOOR_ID                                              28390006
289300            ,TRLR_SEAL_ID                                         28400006
289400            ,SHIP_SCAC_CDE                                        28410006
289500            ,SHIP_DRV_LAST_NM                                     28420006
289600            ,SHIP_DRV_FRST_NM                                     28430006
289700            ,SHIP_DRV_ID                                          28440006
289800            ,TRLR_PRKG_LOC_DESC                                   28450006
289900            ,TRLR_PRKG_SLOT_NBR                                   28460006
290000            ,FINCL_POST_TMST                                      28470006
290100            ,CPCTY_PCT                                            28480006
290200            ,UNUSD_PLLT_QTY                                       28490006
290300            ,LOD_BR_QTY                                           28500006
290400           )                                                      28510006
290500       VALUES                                                     28520006
290600         (                                                        28530006
290700             :SUOBTR-OTBND-TRIP-ID                                28540006
290800           , :PV-CURRENT-TIMESTAMP                                28550056
290900           , 'DO'                                                 28560006
291000           , :PC233-OPER-UNT-ID                                   28570006
291100           , :PC233-USER-ID                                       28580006
291200           , :PC233-DOOR-ID                                       28590006
291300           , :SUOBTS-TRLR-SEAL-ID                                 28600006
291400           , :PC233-OWNER-SCAC-ID                                 28610006
291500           , :SUOBTS-SHIP-DRV-LAST-NM                             28620006
291600           , :SUOBTS-SHIP-DRV-FRST-NM                             28630006
291700           , :SUOBTS-SHIP-DRV-ID                                  28640006
291800           , :SUOBTS-TRLR-PRKG-LOC-DESC                           28650006
291900           , :SUOBTS-TRLR-PRKG-SLOT-NBR                           28660006
292000           , :PC-DUMMY-TIMESTAMP                                  28670006
292100           , 0                                                    28680006
292200           , :PC233-EMPTY-PALLETS                                 28690006
292300           , 0                                                    28700006
292400         )                                                        28710006
292500     END-EXEC.                                                    28720006
292600                                                                  28730006
292700     EVALUATE TRUE                                                28740006
292800         WHEN SQLCODE = ZERO                                      28750006
292801*** DMH 2/17/09 - BEGIN                                                   
292810***          CONTINUE                                             28770006
292820             PERFORM 7260-VALIDATE-NO-MULT-TRIPS                          
292823*** DMH 2/17/09 - END                                                     
292830                                                                          
292900         WHEN SQLCODE = +100                                      28760006
293000             CONTINUE                                             28770006
293100         WHEN SQLCODE = -904                                      28780006
293200         WHEN SQLCODE = -913                                      28790006
293300         WHEN SQLCODE = -911                                      28800006
293400             MOVE 35                  TO PV-ERROR-NBR             28810006
293500             PERFORM 9903-WRITE-CICS-LOG                          28820006
293600             PERFORM 9000-SOFT-ABORT                              28830006
293700         WHEN SQLWARN0 NOT = SPACES                               28840006
293800         WHEN SQLCODE NOT EQUAL ZERO                              28850006
293900              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      28860006
294000              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   28870006
294100              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      28880006
294200              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   28890006
294300              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      28900006
294400              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      28910006
294500              STRING  ' OPER-'               DELIMITED BY SIZE    28920006
294600                      PV-DISPLAY-OPER        DELIMITED BY SIZE    28930006
294700                      '  DOOR-'              DELIMITED BY SIZE    28940006
294800                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    28950006
294900                      '  DEST-'              DELIMITED BY SIZE    28960006
295000                      PV-DISPLAY-DEST        DELIMITED BY SIZE    28970006
295100                                        INTO                      28980006
295200                                        PC233-MESSAGE-TEXT(2)     28990006
295300             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    29000006
295400                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    29010006
295500                      '   SCAC-'             DELIMITED BY SIZE    29020006
295600                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    29030006
295700                      '   TRIP-'             DELIMITED BY SIZE    29040006
295800                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    29050006
295900                                        INTO                      29060006
296000                                        PC233-MESSAGE-TEXT(3)     29070006
296100                                                                  29080006
296200             MOVE 36                  TO PV-ERROR-NBR             29090006
296300                                         PC233-ERROR-NBR          29100006
296400             PERFORM 9903-WRITE-CICS-LOG                          29110006
296500             MOVE '7250-INSERT-TSUOBTS'                           29120006
296600                                      TO PC233-PARAGRAPH          29130006
296700             MOVE 'PCKRF870 - CREATE OPEN TRAILER TRIP STATUS'    29140006
296800                                      TO PC233-MESSAGE-TEXT(1)    29150006
296900             MOVE SQLCA               TO PC233-SQLCA              29160006
297000             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(1)  29170006
297100             SET PC233-ABEND          TO TRUE                     29180006
297200             MOVE 99                  TO PC233-PGM-MSG-NBR        29190006
297300             PERFORM 8210-XCTL-ERROR-SCREEN                       29200006
297400     END-EVALUATE.                                                29210006
297500                                                                  29220006
297501*****************************************************************         
297502* VERIFY THAT ONLY ONE TRAILER IS OPEN AT DOOR - OTHERWISE      *         
297503* ROLLBACK CHANGE AND DISPLAY TRAILER THAT IS STILL OPEN        *         
297504* DMH - 2/17/09                                                 *         
297505*****************************************************************         
297510 7260-VALIDATE-NO-MULT-TRIPS.                                             
297511                                                                          
297512     EXEC SQL                                                             
297513         SELECT                                                           
297514             TRID.SCAC_CDE                                                
297515         ,   TRID.TRLR_ID                                                 
297516         ,   OBTS.OTBND_TRIP_ID                                           
297517         INTO                                                             
297518             :PV-SCAC-CDE                                                 
297519         ,   :PV-TRLR-ID                                                  
297520         ,   :PV-OTBND-TRIP-ID                                            
297521         FROM TSUOBTS OBTS                                                
297522         ,    TSUOBTR OBTR                                                
297523         ,    TCNTRID TRID                                                
297524         WHERE                                                            
297525             OBTS.OTBND_TRIP_ID       = OBTR.OTBND_TRIP_ID                
297526         AND OBTR.TRLR_SRL_NBR        <> :PC233-SERIAL-NBR                
297527         AND OBTR.TRLR_SRL_NBR        = TRID.TRLR_SRL_NBR                 
297528         AND OBTR.TRIP_ACTV_CDE       = 'A'                               
297529         AND OBTS.STAT_OPER_UNT_ID    = :PC233-OPER-UNT-ID                
297530         AND OBTS.DOOR_ID             =  :PC233-DOOR-ID                   
297531         AND OBTS.TRIP_STAT_CDE       = 'DO'                              
297532         AND OBTS.OTBND_STAT_TMST  =                                      
297533           ( SELECT                                                       
297534                 MAX(OBTS1.OTBND_STAT_TMST)                               
297535                 FROM                                                     
297536                 TSUOBTS OBTS1                                            
297537                 WHERE OBTS1.OTBND_TRIP_ID = OBTS.OTBND_TRIP_ID           
297538            )                                                             
297539             WITH UR                                                      
297540                                                                          
297541     END-EXEC.                                                            
297542                                                                          
297543     EVALUATE TRUE                                                        
297544         WHEN SQLCODE = ZERO                                              
297545         WHEN SQLCODE = -811                                              
297546             MOVE PV-SCAC-CDE         TO PC233-ERROR-SCAC-ID              
297547             MOVE PV-TRLR-ID          TO PC233-ERROR-TRLR-ID              
297548             MOVE PV-OTBND-TRIP-ID                                        
297549                                      TO PC233-ERROR-TRIP-ID              
297550             MOVE PC233-DOOR-ID       TO PC233-ERROR-DOOR-NBR             
297551             SET PC233-TRLR-OPENED-OTHER-DOOR                             
297552                                      TO TRUE                             
297553             SET PS-TRLR-OPEN-DIFF-DOOR                                   
297554                 PS-XCTL-E871                                             
297555                 PS-ERRORS-YES        TO TRUE                             
297556             EXEC CICS                                                    
297557                  SYNCPOINT ROLLBACK                                      
297558             END-EXEC                                                     
297559                                                                          
297560         INITIALIZE PV-CICS-MSG-AREA2                                     
297561         MOVE ' PCKRF870 - ANOTHER TRAILER ALREADY OPENED '               
297562           TO PV-CICS-MSG-AREA2                                           
297563         MOVE LENGTH OF PV-CICS-MSG-AREA2                                 
297564           TO PV-COMMAREA-LENGTH                                          
297565         EXEC CICS                                                        
297566              WRITEQ TD                                                   
297567               QUEUE  ('CSSL')                                            
297568                FROM  (PV-CICS-MSG-AREA2)                                 
297569              LENGTH  (PV-COMMAREA-LENGTH)                                
297570                RESP  (PV-CICS-RESPONSE)                                  
297571         END-EXEC                                                         
297572                                                                          
297573             MOVE PV-SCAC-CDE         TO PC233-ERROR-SCAC-ID              
297574             MOVE PV-TRLR-ID          TO PC233-ERROR-TRLR-ID              
297575             MOVE PV-OTBND-TRIP-ID    TO  PV-DISPLAY-TRIP                 
297576             MOVE PC233-OPER-UNT-ID   TO  PV-DISPLAY-OPER                 
297577                                                                          
297578         INITIALIZE PV-CICS-MSG-AREA2                                     
297579         STRING ' PCKRF870 - '  PV-SCAC-CDE                               
297580                ' - '           PV-TRLR-ID                                
297581                ' - '           PV-DISPLAY-TRIP                           
297582                ' - '           PV-DISPLAY-OPER                           
297583                ' - '           PC233-DOOR-ID                             
297584                                DELIMITED BY SIZE                         
297585                           INTO PV-CICS-MSG-AREA2                         
297586         MOVE LENGTH OF PV-CICS-MSG-AREA2                                 
297587           TO PV-COMMAREA-LENGTH                                          
297588         EXEC CICS                                                        
297589              WRITEQ TD                                                   
297590               QUEUE  ('CSSL')                                            
297591                FROM  (PV-CICS-MSG-AREA2)                                 
297592              LENGTH  (PV-COMMAREA-LENGTH)                                
297593                RESP  (PV-CICS-RESPONSE)                                  
297594         END-EXEC                                                         
297595                                                                          
297596                                                                          
297597         WHEN SQLCODE = +100                                              
297598             CONTINUE                                                     
297599         WHEN SQLCODE = -904                                              
297600         WHEN SQLCODE = -913                                              
297601         WHEN SQLCODE = -911                                              
297602             MOVE 7260                TO PV-ERROR-NBR                     
297603             PERFORM 9903-WRITE-CICS-LOG                                  
297604             PERFORM 9000-SOFT-ABORT                                      
297605         WHEN SQLWARN0 NOT = SPACES                                       
297606         WHEN SQLCODE NOT EQUAL ZERO                                      
297607              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER              
297608              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID           
297609              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST              
297610              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR           
297611              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC              
297612              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP              
297613              STRING  ' OPER-'                                            
297614                      PV-DISPLAY-OPER                                     
297615                      '  DOOR-'                                           
297616                      PV-DISPLAY-DOOR-ID                                  
297617                      '  DEST-'                                           
297618                      PV-DISPLAY-DEST        DELIMITED BY SIZE            
297619                                        INTO                              
297620                                        PC233-MESSAGE-TEXT(2)             
297621             STRING   ' TRLR SRL#-'                                       
297622                      PV-DISPLAY-SRL-NBR                                  
297623                      '   SCAC-'                                          
297624                      PV-DISPLAY-SCAC                                     
297625                      '   TRIP-'                                          
297626                      PV-DISPLAY-TRIP        DELIMITED BY SIZE            
297627                                        INTO                              
297628                                        PC233-MESSAGE-TEXT(3)             
297629                                                                          
297630             MOVE 11                  TO PV-ERROR-NBR                     
297631                                         PC233-ERROR-NBR                  
297632             PERFORM 9903-WRITE-CICS-LOG                                  
297633             MOVE '7250-FIND-OTHER-TRLR'                                  
297634                                      TO PC233-PARAGRAPH                  
297635             MOVE 'PCKRF870 - CHECK TRLR AT ANOTHER DOOR'                 
297636                                      TO PC233-MESSAGE-TEXT(1)            
297637             MOVE SQLCA               TO PC233-SQLCA                      
297638             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)          
297639             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(2)          
297640             MOVE 'TCNTRID'           TO PC233-DB2-TABLE-NAME(3)          
297641             SET PC233-ABEND          TO TRUE                             
297642             MOVE 99                  TO PC233-PGM-MSG-NBR                
297643             PERFORM 8210-XCTL-ERROR-SCREEN                               
297644     END-EVALUATE.                                                        
297645                                                                          
297646                                                                          
297650                                                                  29230006
297700 7300-SELECT-TSUOBTS.                                             29240006
297800                                                                  29250006
297900     INITIALIZE SUOBTS-OTBND-TRIP-ID                              29300006
298000                SUOBTR-DEST-OPER-UNT-ID                           29310024
298100                SUOBTS-TRIP-STAT-CDE                              29320006
298200                                                                          
298300     EXEC SQL                                                     29260006
298400        SELECT OBTR.OTBND_TRIP_ID                                 29270006
298500             , OBTR.DEST_OPER_UNT_ID                              29280024
298600             , OBTS.TRIP_STAT_CDE                                 29290006
298700         INTO :SUOBTS-OTBND-TRIP-ID                               29300006
298800             ,:SUOBTR-DEST-OPER-UNT-ID                            29310024
298900             ,:SUOBTS-TRIP-STAT-CDE                               29320006
299000        FROM TSUOBTR OBTR                                         29330006
299100        ,    TSUOBTS OBTS                                         29340006
299200        WHERE                                                     29350006
299300             OBTR.TRLR_SRL_NBR     = :PC233-SERIAL-NBR            29360006
299400         AND OBTR.TRIP_ACTV_CDE    = 'A'                          29370006
299500         AND OBTR.OTBND_TRIP_ID    = OBTS.OTBND_TRIP_ID           29380006
299600         AND OBTS.OTBND_STAT_TMST  =                              29390006
299700             (SELECT MAX(OBTS1.OTBND_STAT_TMST)                   29400006
299800                FROM TSUOBTS OBTS1                                29410006
299900                    ,TSUOBTR OBTR1                                29420006
300000                WHERE                                             29430006
300100                      OBTR1.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID   29440006
300200                  AND OBTR1.TRLR_SRL_NBR  = :PC233-SERIAL-NBR     29450006
300300                  AND OBTR1.TRIP_ACTV_CDE = 'A'                   29460006
300400              )                                                   29470006
300500     END-EXEC.                                                    29480006
300600                                                                  29490006
300700     EVALUATE TRUE                                                29500006
300800         WHEN SQLCODE = ZERO                                      29510006
300900         WHEN SQLCODE = +100                                      29520006
301000         WHEN SQLCODE = -811                                      29530006
301100             MOVE SUOBTS-OTBND-TRIP-ID TO PC233-TRIP-ID           29300006
301200         WHEN SQLCODE = -904                                      29550006
301300         WHEN SQLCODE = -913                                      29560006
301400         WHEN SQLCODE = -911                                      29570006
301500             MOVE 37                  TO PV-ERROR-NBR             29580006
301600             PERFORM 9903-WRITE-CICS-LOG                          29590006
301700             PERFORM 9000-SOFT-ABORT                              29600006
301800         WHEN SQLWARN0 NOT = SPACES                               29610006
301900         WHEN SQLCODE NOT EQUAL ZERO                              29620006
302000              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      29630006
302100              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   29640006
302200              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      29650006
302300              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   29660006
302400              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      29670006
302500              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      29680006
302600              STRING  ' OPER-'               DELIMITED BY SIZE    29690006
302700                      PV-DISPLAY-OPER        DELIMITED BY SIZE    29700006
302800                      '  DOOR-'              DELIMITED BY SIZE    29710006
302900                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    29720006
303000                      '  DEST-'              DELIMITED BY SIZE    29730006
303100                      PV-DISPLAY-DEST        DELIMITED BY SIZE    29740006
303200                                        INTO                      29750006
303300                                        PC233-MESSAGE-TEXT(2)     29760006
303400             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    29770006
303500                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    29780006
303600                      '   SCAC-'             DELIMITED BY SIZE    29790006
303700                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    29800006
303800                      '   TRIP-'             DELIMITED BY SIZE    29810006
303900                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    29820006
304000                                        INTO                      29830006
304100                                        PC233-MESSAGE-TEXT(3)     29840006
304200                                                                  29850006
304300             MOVE 38                  TO PV-ERROR-NBR             29860006
304400                                         PC233-ERROR-NBR          29870006
304500             PERFORM 9903-WRITE-CICS-LOG                          29880006
304600             MOVE '7300-SELECT-TSUOBTS'                           29890006
304700                                      TO PC233-PARAGRAPH          29900006
304800             MOVE 'PCKRF870 - IS ACTION ALLOWABLE'                29910006
304900                                      TO PC233-MESSAGE-TEXT(1)    29920006
305000             MOVE SQLCA               TO PC233-SQLCA              29930006
305100             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  29940006
305200             SET PC233-ABEND          TO TRUE                     29950006
305300             MOVE 99                  TO PC233-PGM-MSG-NBR        29960006
305400             PERFORM 8210-XCTL-ERROR-SCREEN                       29970006
305500     END-EVALUATE.                                                29980006
305600                                                                  29990006
305700******************************************************************30000006
305800* WHEN IN THE AUDIT FUNCTION, UPDATE THE SUT_AUD_TRLR_TRIP WITH   30010006
305900* THE NEWLY CREATED DEST TRIP ID                                  30020006
306000******************************************************************30030006
306100 7350-UPDATE-AUD-TRLR-TRIP.                                       30040006
306200                                                                  30050006
306300     MOVE PC045-AUDIT-CNTL-NBR TO SUT00004-AUD-CNTL-NBR.          30060006
306400     MOVE PC233-TRIP-ID        TO SUT00004-DEST-OTBND-TRIP-ID.    30070006
306500                                                                  30080006
306600     EXEC SQL                                                     30090006
306700       UPDATE SUT_AUD_TRLR_TRIP                                   30100006
306800       SET    DEST_OTBND_TRIP_ID = :SUT00004-DEST-OTBND-TRIP-ID   30110006
306900       WHERE  AUD_CNTL_NBR       = :SUT00004-AUD-CNTL-NBR         30120006
307000     END-EXEC.                                                    30130006
307100                                                                  30140006
307200     EVALUATE TRUE                                                30150006
307300         WHEN SQLCODE = ZERO                                      30160006
307400         WHEN SQLCODE = +100                                      30170006
307500             CONTINUE                                             30180006
307600         WHEN SQLCODE = -904                                      30190006
307700         WHEN SQLCODE = -913                                      30200006
307800         WHEN SQLCODE = -911                                      30210006
307900             MOVE 39                  TO PV-ERROR-NBR             30220006
308000             PERFORM 9903-WRITE-CICS-LOG                          30230006
308100             PERFORM 9000-SOFT-ABORT                              30240006
308200         WHEN SQLWARN0 NOT = SPACES                               30250006
308300         WHEN SQLCODE NOT EQUAL ZERO                              30260006
308400              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      30270006
308500              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   30280006
308600              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      30290006
308700              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   30300006
308800              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      30310006
308900              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      30320006
309000              STRING  ' OPER-'               DELIMITED BY SIZE    30330006
309100                      PV-DISPLAY-OPER        DELIMITED BY SIZE    30340006
309200                      '  DOOR-'              DELIMITED BY SIZE    30350006
309300                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    30360006
309400                      '  DEST-'              DELIMITED BY SIZE    30370006
309500                      PV-DISPLAY-DEST        DELIMITED BY SIZE    30380006
309600                                        INTO                      30390006
309700                                        PC233-MESSAGE-TEXT(2)     30400006
309800             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    30410006
309900                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    30420006
310000                      '   SCAC-'             DELIMITED BY SIZE    30430006
310100                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    30440006
310200                      '   TRIP-'             DELIMITED BY SIZE    30450006
310300                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    30460006
310400                                        INTO                      30470006
310500                                        PC233-MESSAGE-TEXT(3)     30480006
310600                                                                  30490006
310700             MOVE 40                  TO PV-ERROR-NBR             30500006
310800                                         PC233-ERROR-NBR          30510006
310900             PERFORM 9903-WRITE-CICS-LOG                          30520006
311000             MOVE '7350-UPDATE-AUD-TRLR-TRIP'                     30530006
311100                                      TO PC233-PARAGRAPH          30540006
311200             MOVE 'PCKRF870 - CREATE OPEN TRAILER TRIP STATUS'    30550006
311300                                      TO PC233-MESSAGE-TEXT(1)    30560006
311400             MOVE SQLCA               TO PC233-SQLCA              30570006
311500             MOVE 'SUT_AUD_TRLR_TRIP' TO PC233-DB2-TABLE-NAME(1)  30580006
311600             SET PC233-ABEND          TO TRUE                     30590006
311700             MOVE 99                  TO PC233-PGM-MSG-NBR        30600006
311800             PERFORM 8210-XCTL-ERROR-SCREEN                       30610006
311900     END-EVALUATE.                                                30620006
312000                                                                  30630006
312100 7360-UPDATE-TSUNAUD.                                             30640006
312200                                                                  30650006
312300     MOVE PC045-AUDIT-CNTL-NBR TO SUNAUD-AUD-CNTL-NBR.            30660006
312400     MOVE PC045-DEST-TYP-CDE   TO SUNAUD-DEST-TYP-CDE.            30670006
312500                                                                  30680006
312600     EXEC SQL                                                     30690006
312700          UPDATE TSUNAUD                                          30700006
312800             SET                                                  30710006
312900                  DEST_TYP_CDE       = :SUNAUD-DEST-TYP-CDE       30720006
313000           WHERE  AUD_CNTL_NBR       = :SUNAUD-AUD-CNTL-NBR       30730006
313100     END-EXEC.                                                    30740006
313200                                                                  30750006
313300     EVALUATE TRUE                                                30760006
313400         WHEN SQLCODE = ZERO                                      30770006
313500         WHEN SQLCODE = +100                                      30780006
313600             CONTINUE                                             30790006
313700         WHEN SQLCODE = -904                                      30800006
313800         WHEN SQLCODE = -913                                      30810006
313900         WHEN SQLCODE = -911                                      30820006
314000             MOVE 41                  TO PV-ERROR-NBR             30830006
314100             PERFORM 9903-WRITE-CICS-LOG                          30840006
314200             PERFORM 9000-SOFT-ABORT                              30850006
314300         WHEN SQLWARN0 NOT = SPACES                               30860006
314400         WHEN SQLCODE NOT EQUAL ZERO                              30870006
314500              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      30880006
314600              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   30890006
314700              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      30900006
314800              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   30910006
314900              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      30920006
315000              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      30930006
315100              STRING  ' OPER-'               DELIMITED BY SIZE    30940006
315200                      PV-DISPLAY-OPER        DELIMITED BY SIZE    30950006
315300                      '  DOOR-'              DELIMITED BY SIZE    30960006
315400                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    30970006
315500                      '  DEST-'              DELIMITED BY SIZE    30980006
315600                      PV-DISPLAY-DEST        DELIMITED BY SIZE    30990006
315700                                        INTO                      31000006
315800                                        PC233-MESSAGE-TEXT(2)     31010006
315900             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    31020006
316000                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    31030006
316100                      '   SCAC-'             DELIMITED BY SIZE    31040006
316200                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    31050006
316300                      '   TRIP-'             DELIMITED BY SIZE    31060006
316400                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    31070006
316500                                        INTO                      31080006
316600                                        PC233-MESSAGE-TEXT(3)     31090006
316700                                                                  31100006
316800             MOVE 42                  TO PV-ERROR-NBR             31110006
316900                                         PC233-ERROR-NBR          31120006
317000             PERFORM 9903-WRITE-CICS-LOG                          31130006
317100             MOVE '7360-UPDATE-TSUNAUD  '                         31140006
317200                                      TO PC233-PARAGRAPH          31150006
317300             MOVE 'PCKRF870 - CREATE OPEN TRAILER TRIP STATUS'    31160006
317400                                      TO PC233-MESSAGE-TEXT(1)    31170006
317500             MOVE SQLCA               TO PC233-SQLCA              31180006
317600             MOVE 'TSUNAUD  '         TO PC233-DB2-TABLE-NAME(1)  31190006
317700             SET PC233-ABEND          TO TRUE                     31200006
317800             MOVE 99                  TO PC233-PGM-MSG-NBR        31210006
317900             PERFORM 8210-XCTL-ERROR-SCREEN                       31220006
318000     END-EVALUATE.                                                31230006
318100                                                                  31240006
318200/                                                                 31250006
318300                                                                  31260009
318400 7400-INSERT-WRKR-AUD.                                            31270009
318500     EXEC SQL                                                     31280009
318600         INSERT INTO SUT_TRIP_WRKR_AUD                            31290009
318700             (                                                    31300009
318800               OTBND_TRIP_ID                                      31310009
318900             , USR_ID                                             31320009
319000             , CRE_TMST                                           31330009
319100             , CRE_BY_PGM_NM                                      31340009
319200                 )                                                31350009
319300                                                                  31360009
319400             VALUES                                               31370009
319500                                                                  31380009
319600                 (                                                31390009
319700                 :PC233-TRIP-ID                                   31400009
319800             ,   :PC233-USER-ID                                   31410009
319900             ,   CURRENT TIMESTAMP                                31420009
320000             ,   :PC-CURRENT-PROGRAM-NAME                         31430009
320100                 )                                                31440009
320200     END-EXEC.                                                    31450009
320300                                                                  31460009
320400     EVALUATE TRUE                                                31470009
320500         WHEN SQLCODE = ZERO                                      31480009
320600             CONTINUE                                             31490009
320700         WHEN SQLCODE = -904                                      31500009
320800         WHEN SQLCODE = -913                                      31510009
320900         WHEN SQLCODE = -911                                      31520009
321000             MOVE 12                  TO PV-ERROR-NBR             31530009
321100             PERFORM 9903-WRITE-CICS-LOG                          31540009
321200             PERFORM 9000-SOFT-ABORT                              31550009
321300         WHEN SQLWARN0 NOT = SPACES                               31560009
321400         WHEN SQLCODE NOT EQUAL ZERO                              31570009
321500              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      31580009
321600              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   31590009
321700              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      31600009
321800              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   31610009
321900              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      31620009
322000              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      31630009
322100              STRING  ' OPER-'               DELIMITED BY SIZE    31640009
322200                      PV-DISPLAY-OPER        DELIMITED BY SIZE    31650009
322300                      '  DOOR-'              DELIMITED BY SIZE    31660009
322400                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    31670009
322500                      '  DEST-'              DELIMITED BY SIZE    31680009
322600                      PV-DISPLAY-DEST        DELIMITED BY SIZE    31690009
322700                                        INTO                      31700009
322800                                        PC233-MESSAGE-TEXT(2)     31710009
322900             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    31720009
323000                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    31730009
323100                      '   SCAC-'             DELIMITED BY SIZE    31740009
323200                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    31750009
323300                      '   TRIP-'             DELIMITED BY SIZE    31760009
323400                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    31770009
323500                                        INTO                      31780009
323600                                        PC233-MESSAGE-TEXT(3)     31790009
323700                                                                  31800009
323800             MOVE 13                  TO PV-ERROR-NBR             31810009
323900                                         PC233-ERROR-NBR          31820009
324000             PERFORM 9903-WRITE-CICS-LOG                          31830009
324100             MOVE '7400-INSERT-WRKR-AUD'                          31840009
324200                                      TO PC233-PARAGRAPH          31850009
324300             MOVE 'PCKRF870 - INSERT WORKER AUDIT'                31860009
324400                                      TO PC233-MESSAGE-TEXT(1)    31870009
324500             MOVE SQLCA               TO PC233-SQLCA              31880009
324600             MOVE 'SUT00006'          TO PC233-DB2-TABLE-NAME(1)  31890009
324700             SET PC233-ABEND          TO TRUE                     31900009
324800             MOVE 99                  TO PC233-PGM-MSG-NBR        31910009
324900             PERFORM 8210-XCTL-ERROR-SCREEN                       31920009
325000     END-EVALUATE.                                                31930009
325100/                                                                 31940009
325200                                                                  31950009
325300                                                                  31960006
325400 8000-SEND-MAP.                                                   31970006
325500                                                                  31980006
325600      IF PC233-ROOT-PROGRAM = PC-TRLR-AUDIT-START-PGM             31990006
325700         MOVE PC233-STR-NBR        TO ADESTO                      32000006
325800         MOVE DP015-ASK-NOR-MDT    TO ADESTA                      32010006
325900      END-IF.                                                     32020006
326000                                                                  32030006
326100                                                                  32040006
326200     EXEC CICS                                                    32050006
326300         SEND MAP       ('PC870A')                                32060006
326400              MAPSET    ('PCKM870')                               32070006
326500              ERASE                                               32080006
326600              CURSOR                                              32090006
326700              RESP      (PV-CICS-RESPONSE)                        32100006
326800     END-EXEC.                                                    32110006
326900                                                                  32120006
327000     EVALUATE TRUE                                                32130006
327100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 32140006
327200             CONTINUE                                             32150006
327300         WHEN OTHER                                               32160006
327400             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          32170006
327500             MOVE 'PCKRF870 - UNABLE TO SEND MAP'                 32180006
327600                                      TO DP013-MESSAGE-TEXT (1)   32190006
327700             SET DP013-CICS-ABEND                                 32200006
327800                 DP013-ROLLBACK       TO TRUE                     32210006
327900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               32220006
328000     END-EVALUATE.                                                32230006
328100                                                                  32240006
328200 8010-SEND-DATA-ONLY.                                             32250006
328300                                                                  32260006
328400     EXEC CICS                                                    32270006
328500         SEND MAP       ('PC870A')                                32280006
328600              MAPSET    ('PCKM870')                               32290006
328700              CURSOR                                              32300006
328800              DATAONLY                                            32310006
328900              RESP      (PV-CICS-RESPONSE)                        32320006
329000     END-EXEC.                                                    32330006
329100                                                                  32340006
329200     EVALUATE TRUE                                                32350006
329300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 32360006
329400             CONTINUE                                             32370006
329500         WHEN OTHER                                               32380006
329600             MOVE '8010-SEND-DATA-ONLY'                           32390006
329700                                      TO DP013-PARAGRAPH          32400006
329800             MOVE 'PCKRF870 - UNABLE TO SEND DATA'                32410006
329900                                      TO DP013-MESSAGE-TEXT (1)   32420006
330000             SET DP013-CICS-ABEND                                 32430006
330100                 DP013-ROLLBACK       TO TRUE                     32440006
330200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               32450006
330300     END-EVALUATE.                                                32460006
330400                                                                  32470006
330500 8020-RECEIVE-MAP.                                                32480006
330600                                                                  32490006
330700     EXEC CICS                                                    32500006
330800         RECEIVE MAP    ('PC870A')                                32510006
330900                 MAPSET ('PCKM870')                               32520006
331000                 RESP   (PV-CICS-RESPONSE)                        32530006
331100     END-EXEC.                                                    32540006
331200                                                                  32550006
331300     EVALUATE TRUE                                                32560006
331400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 32570006
331500             CONTINUE                                             32580006
331600         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                32590006
331700             CONTINUE                                             32600006
331800         WHEN OTHER                                               32610006
331900            MOVE '8020-RECEIVE-MAP'   TO DP013-PARAGRAPH          32620006
332000            MOVE 'PCKRF870 - UNABLE TO RECEIVE MAP'               32630006
332100                                      TO DP013-MESSAGE-TEXT (1)   32640006
332200            SET DP013-LOGIC-ABEND     TO TRUE                     32650006
332300            SET DP013-ROLLBACK        TO TRUE                     32660006
332400            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                32670006
332500     END-EVALUATE.                                                32680006
332600                                                                  32690006
332700 8100-RETURN-TRANID.                                              32700006
332800                                                                  32710006
332900     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       32720006
333000     EXEC CICS                                                    32730006
333100         RETURN TRANSID  (PC-TRANID)                              32740006
333200                COMMAREA (CA-COMMAREA)                            32750006
333300                LENGTH   (PV-COMMAREA-LENGTH)                     32760006
333400                RESP     (PV-CICS-RESPONSE)                       32770006
333500     END-EXEC.                                                    32780006
333600                                                                  32790006
333700     EVALUATE TRUE                                                32800006
333800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 32810006
333900             CONTINUE                                             32820006
334000         WHEN OTHER                                               32830006
334100             MOVE '8100-RETURN-TRANIND'                           32840006
334200                                      TO DP013-PARAGRAPH          32850006
334300             MOVE 'PCKRF870 - UNABLE TO RETURN TO TRANID'         32860006
334400                 TO DP013-MESSAGE-TEXT (1)                        32870006
334500             SET DP013-CICS-ABEND     TO TRUE                     32880006
334600             SET DP013-ROLLBACK       TO TRUE                     32890006
334700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               32900006
334800     END-EVALUATE.                                                32910006
334900                                                                  32920006
335000 8110-RETURN.                                                     32930006
335100                                                                  32940006
335200     EXEC CICS                                                    32950006
335300         SEND FROM (PV-MESSAGE-AREA)                              32960006
335400              LENGTH (19)                                         32970006
335500              ERASE                                               32980006
335600     END-EXEC.                                                    32990006
335700                                                                  33000006
335800     EXEC CICS                                                    33010006
335900         RETURN                                                   33020006
336000     END-EXEC.                                                    33030006
336100                                                                  33040006
336200 8200-XCTL.                                                       33050006
336300     SET PC233-INITIALIZE-SCREEN      TO TRUE.                    33060006
336400     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      33070006
336500     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       33080006
336600                                                                  33090006
336700     EXEC CICS                                                    33100006
336800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    33110006
336900               COMMAREA  (CA-COMMAREA)                            33120006
337000               LENGTH    (PV-COMMAREA-LENGTH)                     33130006
337100               RESP      (PV-CICS-RESPONSE)                       33140006
337200     END-EXEC.                                                    33150006
337300                                                                  33160006
337400     EVALUATE TRUE                                                33170006
337500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 33180006
337600             CONTINUE                                             33190006
337700         WHEN OTHER                                               33200006
337800             MOVE '8200-XCTL'                                     33210006
337900                                      TO DP013-PARAGRAPH          33220006
338000             MOVE 'PCKRF870 - UNABLE TO XCTL TO PROGRAM: '        33230006
338100                                      TO DP013-MESSAGE-TEXT (1)   33240006
338200             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   33250006
338300             SET DP013-CICS-ABEND                                 33260006
338400                 DP013-ROLLBACK       TO TRUE                     33270006
338500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               33280006
338600             MOVE PC-TRANS-UNAVAILABLE-MSG                        33290006
338700                                      TO AMSGLNO                  33300006
338800             SET PC233-PROCESS-SCREEN TO TRUE                     33310006
338900             MOVE -1                  TO ADOORL                   33320006
339000             PERFORM 8000-SEND-MAP                                33330006
339100             PERFORM 8100-RETURN-TRANID                           33340006
339200     END-EVALUATE.                                                33350006
339300                                                                  33360006
339400 8210-XCTL-ERROR-SCREEN.                                          33370006
339500     IF NOT PC233-ABEND                                           33380006
339600         SET PC233-INITIALIZE-SCREEN  TO TRUE                     33390006
339700     END-IF                                                       33400006
339800     IF PC233-PGM-MSG-NBR = ZERO                                  33410006
339900         SET  PC233-UNDEFINED-ERROR   TO TRUE                     33420006
340000     END-IF                                                       33430006
340100                                                                  33440006
340200     MOVE DFHEIBLK                    TO PC233-DFHEIBLK.          33450006
340300     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      33460006
340400     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       33470006
340500     MOVE 'PCKRF871'                  TO PV-TRANSFER-PROGRAM      33480006
340600                                                                  33490006
340700     EXEC CICS                                                    33500006
340800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    33510006
340900               COMMAREA  (CA-COMMAREA)                            33520006
341000               LENGTH    (PV-COMMAREA-LENGTH)                     33530006
341100               RESP      (PV-CICS-RESPONSE)                       33540006
341200     END-EXEC.                                                    33550006
341300                                                                  33560006
341400     EVALUATE TRUE                                                33570006
341500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 33580006
341600             CONTINUE                                             33590006
341700         WHEN OTHER                                               33600006
341800             MOVE '8200-XCTL'                                     33610006
341900                                      TO DP013-PARAGRAPH          33620006
342000             MOVE 'PCKRF870 - UNABLE TO XCTL TO PROGRAM: '        33630006
342100                                      TO DP013-MESSAGE-TEXT (1)   33640006
342200             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   33650006
342300             SET DP013-CICS-ABEND                                 33660006
342400                 DP013-ROLLBACK       TO TRUE                     33670006
342500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               33680006
342600             MOVE PC-TRANS-UNAVAILABLE-MSG                        33690006
342700                                      TO AMSGLNO                  33700006
342800             SET PC233-PROCESS-SCREEN TO TRUE                     33710006
342900             MOVE -1                  TO ADOORL                   33720006
343000             PERFORM 8000-SEND-MAP                                33730006
343100             PERFORM 8100-RETURN-TRANID                           33740006
343200     END-EVALUATE.                                                33750006
343300/                                                                 33760006
343400 8212-MSG-48.                                                     16710003
343500     EXEC SQL                                                             
343600         SELECT                                                           
343700             SUBSTR(CHAR(CURRENT TIMESTAMP),12,15)                        
343800         INTO                                                             
343900             :PV-MSG-TIME-48                                      00820000
344000         FROM SYSIBM.SYSDUMMY1                                            
344100     END-EXEC                                                             
344200                                                                          
344300     MOVE PC233-OPER-UNT-ID           TO PV-LOC-48                00860000
344400     MOVE PC233-DOOR-ID               TO PV-DOOR-48               00950000
344500                                         PC233-ERROR-DOOR-NBR             
344600     MOVE PC233-SERIAL-NBR            TO PV-SERIAL-48             00950000
344700                                         PC233-ERROR-SRL-NBR              
344800                                                                          
344900     MOVE PC233-USER-ID               TO PV-USER-ID-48            00860000
345000                                                                          
345100     EVALUATE TRUE                                                        
345200     WHEN EIBAID = DFHENTER                                               
345300         MOVE 'E'                     TO PV-FKEY-48                       
345400     WHEN EIBAID = DFHCLEAR                                               
345500         MOVE 'C'                     TO PV-FKEY-48                       
345600     WHEN OTHER                                                           
345700        MOVE EIBAID                   TO PV-FKEY-48               00860000
345800     END-EVALUATE                                                         
345900                                                                          
346000     MOVE PC233-STR-NBR               TO PV-DEST-48               00860000
346100                                                                          
346200     MOVE PC233-OWNER-SCAC-ID         TO PV-SCAC-48               00860000
346300                                                                          
346400     MOVE PC233-LAST-PROGRAM          TO PV-LAST-PGM-48           00860000
346500                                                                  16820003
346600     MOVE 48                          TO PV-ERROR-NBR             16900003
346700                                         PC233-ERROR-NBR          16910003
346800                                         PC233-PGM-MSG-NBR        16910003
346900                                                                  16920003
347000     PERFORM 9948-WRITE-CICS-LOG                                  17140000
347100     PERFORM 8210-XCTL-ERROR-SCREEN.                              17000003
347200/                                                                 17000103
347300 8220-XCTL-TO-HELP.                                               33780006
347400                                                                  33790006
347500     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       33800006
347600                                                                  33810006
347700     EXEC CICS                                                    33820006
347800         XCTL                                                     33830006
347900             PROGRAM   (PV-TRANSFER-PROGRAM)                      33840006
348000             COMMAREA  (PC192-COMMAREA)                           33850006
348100             LENGTH    (PV-COMMAREA-LENGTH)                       33860006
348200             RESP      (PV-CICS-RESPONSE)                         33870006
348300     END-EXEC.                                                    33880006
348400                                                                  33890006
348500     EVALUATE TRUE                                                33900006
348600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 33910006
348700              CONTINUE                                            33920006
348800         WHEN OTHER                                               33930006
348900             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          33940006
349000             MOVE 'PCKRF870 - UNABLE TO XCTL TO PROGRAM: '        33950006
349100                                      TO DP013-MESSAGE-TEXT (1)   33960006
349200             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   33970006
349300             SET DP013-CICS-ABEND                                 33980006
349400                 DP013-ROLLBACK       TO TRUE                     33990006
349500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               34000006
349600             MOVE PC-TRANS-UNAVAILABLE-MSG                        34010006
349700                                      TO AMSGLNO                  34020006
349800             SET PC233-PROCESS-SCREEN TO TRUE                     34030006
349900             MOVE -1                  TO ADOORL                   34040006
350000             PERFORM 8000-SEND-MAP                                34050006
350100             PERFORM 8100-RETURN-TRANID                           34060006
350200     END-EVALUATE.                                                34070006
350300                                                                  34080053
350400****************************************************************  34090053
350500*    RETRIEVE THE CURRENT TIMESTAMP TO USE WHEN UPDATING ROWS. *  34100053
350600*                                                              *  34110053
350700****************************************************************  34120053
350800                                                                  34130053
350900 8400-GET-TIMESTAMP.                                              34140053
351000                                                                  34150053
351100     EXEC SQL                                                     34160053
351200                                                                  34170053
351300         SET :PV-CURRENT-TIMESTAMP  = CURRENT TIMESTAMP           34180053
351400                                                                  34190053
351500     END-EXEC.                                                    34200053
351600                                                                  34210070
351700     EVALUATE SQLCODE                                             34220070
351800         WHEN 0                                                   34230070
351900              CONTINUE                                            34240070
352000                                                                  34250070
352100         WHEN OTHER                                               34260070
352200              PERFORM 3500-FORMAT-COMMON-DATA                     34270070
352300                                                                  34280070
352400              MOVE '8400-GET-TIMESTAMP'                           34290070
352500                                       TO PC233-PARAGRAPH         34300070
352600              STRING PC-CURRENT-PROGRAM-NAME                      34310070
352700                     ' - GET CURRENT TIMESTAMP   '                34320070
352800                      DELIMITED BY SIZE                           34330070
352900                      INTO PC233-MESSAGE-TEXT(1)                  34340070
353000              MOVE SQLCA               TO PC233-SQLCA             34350070
353100              SET PC233-ABEND          TO TRUE                    34360070
353200              MOVE 99                  TO PC233-PGM-MSG-NBR       34370070
353300              PERFORM 8210-XCTL-ERROR-SCREEN                      34380070
353400                                                                  34390070
353500     END-EVALUATE.                                                34400070
353600                                                                  34410053
353700/                                                                 34420006
353800 9000-SOFT-ABORT.                                                 34430006
353900                                                                  34440006
354000     EXEC CICS                                                    34450006
354100         SYNCPOINT ROLLBACK                                       34460006
354200     END-EXEC                                                     34470006
354300                                                                  34480006
354400     SET  PC233-DATABASE-BUSY         TO TRUE                     34490006
354500     MOVE SQLCODE                     TO PC233-SQLCODE            34500006
354600     PERFORM 8210-XCTL-ERROR-SCREEN.                              34510006
354700                                                                  34520006
354800                                                                  34530006
354900 9903-WRITE-CICS-LOG.                                             34540006
355000                                                                  34550006
355100     MOVE SQLCODE                     TO PV-SQLCODE               34560006
355200     MOVE PC233-DOOR-ID               TO PV-DISPLAY-DOOR          34570006
355300     MOVE PC233-USER-ID               TO PV-USER-ID               34580006
355400                                                                  34590006
355500     EXEC CICS                                                    34600006
355600         WRITEQ TD                                                34610006
355700             QUEUE  ('CSSL')                                      34620006
355800             FROM   (PV-LOG-MSG)                                  34630006
355900             RESP   (PV-CICS-RESPONSE)                            34640006
356000     END-EXEC.                                                    34650006
356100                                                                  34660006
356200 9948-WRITE-CICS-LOG.                                             17140000
356300                                                                  17150000
356400     EXEC CICS                                                    17200000
356500         WRITEQ TD                                                17210000
356600             QUEUE  ('CSSL')                                      17220000
356700             FROM   (PV-MSG-48)                                   17230000
356800             RESP   (PV-CICS-RESPONSE)                            17240000
356900     END-EXEC.                                                    17250000
357000                                                                  17260000
357100 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  34670006
357200                                                                  34680006
357300     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           34690006
357400     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          34700006
357500     INITIALIZE DP013-SRC-TASK-NUMBER                             34710006
357600                DP013-STACK.                                      34720006
357700     SET DP013-LINK-RETURN            TO TRUE.                    34730006
357800                                                                  34740006
357900     EXEC CICS                                                    34750006
358000         LINK                                                     34760006
358100             PROGRAM   (DP013-NAME)                               34770006
358200             COMMAREA  (DP013-PARAMETERS)                         34780006
358300             LENGTH    (DP013-LENGTH)                             34790006
358400     END-EXEC.                                                    34800006
358500                                                                  34810044
358600 999A-WRITE-CSSL-MSG.                                             34820044
358700                                                                  34830044
358800     MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH.      34840044
358900                                                                  34850044
359000     EXEC CICS                                                    34860044
359100         WRITEQ TD                                                34870044
359200             QUEUE  ('CSSL')                                      34880044
359300             FROM   (PV-CICS-MSG-AREA2)                           34890044
359400           LENGTH   (PV-COMMAREA-LENGTH)                          34900044
359500             RESP   (PV-CICS-RESPONSE)                            34910044
359600     END-EXEC.                                                    34920044
359700                                                                  34930044
