000100******************************************************************00010000
000200*  I M P O R T A N T --- WHEN COMPILING THIS PROGRAM THE SOCKET  *00020000
000300* SWITCH ON THE 2ND COMPILE SCREEN NEEDS TO BE SET TO 'Y'.  THIS *00030000
000400* PROGRAM IS USING "EZASOKET".                                   *00040000
000500******************************************************************00050000
000600 IDENTIFICATION DIVISION.                                         00060000
000700 PROGRAM-ID.    RCKCS254.                                         00070000
000800 AUTHOR.        LARRY SCHLEICHER                                  00080000
000900 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00090000
001000 DATE-WRITTEN.  04-01-94                                          00100000
001100 DATE-COMPILED.                                                   00110000
001200******************************************************************00120000
001300*    E254 - TICKET REQUEST SELECTION LIST                         00130000
001400*                                                                 00140000
001500*    DISPLAYS ALL PURCHASE ORDER OR RECEIPT LINE ITEMS.           00150000
001600*    THE USER CAN SELECT LINES TO PRINT TICKETS.                  00160000
001700*                                                                 00170000
001800*    THE DP030-OVERRIDE-APPL-ERROR SWITCH IS SET TO TRUE WHEN     00180000
001900*        ENTERING THE PROGRAM IN ORDER TO GIVE CONTROL BACK TO THE00190000
002000*        LIST WHEN A NEXT-ACT-APPL-ERROR IS SENT BACK FROM THE    00200000
002100*        UPDATE.  THE DP030-RC-APPL-ERROR IS CHECKED TO DETERMINE 00210000
002200*        IF A NEXT-ACT-APPL-ERROR IS BEING RETURNED TO THE LIST.  00220000
002300*                                                                 00230000
002400*    06/30/94 SHENG TSANG                                         00240000
002500*        MADE CHANGES TO ALLOW VENDOR UPC BE PRINTED ON TICKETS   00250000
002600*        BY DEFAULT. IF VENDOR UPC DOES NOT PRESENT OR HAS        00260000
002700*        MULTIPLES, USE KOHLS INTERNAL UPC.                       00270000
002800*                                                                 00280000
002900*        TWO VERTICAL BARS ARE USED AS DELIMITERS DUE TO CONVERTOR00290000
003000*        FILTERING PROBLEM. CHANGES MADE TO COPYBOOK MPRD049.     00300000
003100*                                                                 00310000
003200*    05/15/06 DAN HINTZ                                           00320000
003300*        CHANGES WERE MADE TO ADD TCP/IP SOCKET CALLS TO THE      00330000
003400*        PROGRAM TO SUPPORT COMMUNICATION WITH THE NEW AVERY      00340000
003500*        DENNISON TICKET SYSTEM AT THE PATTERSON DC.  IF THERE    00350000
003600*        IS AN ENTRY FOR THE TICKET OFFICE IN THE TKRPRPM TABLE,  00360000
003700*        THEN IT IS SET UP TO USE THE NEW TICKETING SYSTEM.  WHEN 00370000
003800*        CONVERTING TICKET OFFICES FROM THE OLD SYSTEM TO THE NEW 00380000
003900*        SYSTEM, THE IP ADDRESS OF THE TICKET OFFICE NEEDS TO BE  00390000
004000*        ADDED TO TKRPRPM AND AN ENTRY FOR THE TICKET OFFICE NEEDS00400000
004100*        TO BE ADDED TO TKRPRCD.  THERE ARE NO CHANGES THAT NEED  00410000
004200*        TO BE MADE TO THIS PROGRAM A TICKET OFFICE IS CONVERTED, 00420000
004300*        OR WHEN THE IP ADDRESS OF A TICKET OFFICE CHANGES.       00430000
004400******************************************************************00440000
004500*  CHANGED 10/13/2014    BY COGNIZANT       WR: CHG0094517        00450033
004600*                                                                 00460033
004700* EXTENDED PO# FROM 7 TO 8 DIGITS WHERE NEEDED.                   00470033
004800*-----------------------------------------------------------------00480033
004900* CHANGED 08/15/2022    BY BARB SCHULTZ    WR: CHG0273427         00490033
005000* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00500033
005100* MAKING THE CALL DYNAMIC VS STATIC.                              00510033
005101*-----------------------------------------------------------------00510133
005102 ENVIRONMENT DIVISION.                                            00510200
005103 DATA DIVISION.                                                   00510300
005104 WORKING-STORAGE SECTION.                                         00510400
005105                                                                  00510500
005106 01  PC-PROGRAM-CONSTANTS.                                        00510600
005107     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'RC254A  '. 00510700
005108     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'RCKM254 '. 00510800
005200     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'RCKCS254'. 00520000
005400     05  PC-MAX-EXTRA-TICKET-PERCENT  PIC 9(4)  VALUE 200.        00540000
005500     05  PC-LIST-QUEUE-SEQ            PIC 9     VALUE 1.          00550000
005600     05  PC-SEL-QUEUE-SEQ             PIC 9     VALUE 2.          00560000
005700     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +9          00570000
005800                                                COMP SYNC.        00580000
005900     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00590000
006000                                                COMP SYNC.        00600000
006100     05  PC-MAX-ITEMS                 PIC S9(4) VALUE +9999       00610000
006200                                                COMP SYNC.        00620000
006300     05  PC-MAX-RETRIES               PIC S9(4) VALUE +3          00630000
006400                                                COMP SYNC.        00640000
006500     05  PC-DTL-REC-LENGTH            PIC 9(08) VALUE 210         00650000
006600                                                COMP SYNC.        00660000
006700     05  PC-MAX-PC-TICKET-QUANTITY    PIC  9(05) VALUE 99999.     00670000
006800     05  PC-CITA                      PIC  X(03) VALUE 'CIT'.     00680000
006900     05  PC-DIRECTORY-PATH            PIC  X(16) VALUE            00690000
007000         '\APPS\RC\FORMAT\'.                                      00700000
007300     05  PC-SPACE                     PIC X(01) VALUE ' '.        00730000
007400     05  PC-HHP                       PIC X(03) VALUE 'HHP'.      00740000
007500     05  PC-HP                        PIC X(03) VALUE 'HP '.      00750000
007600     05  PC-PRINT                     PIC X(03) VALUE 'P  '.      00760000
007700     05  PC-PUT                       PIC  X(03)  VALUE 'PUT'.    00770000
007800     05  PC-INIT                      PIC  X(04)  VALUE 'INIT'.   00780000
007900     05  PC-TERM                      PIC  X(04)  VALUE 'TERM'.   00790000
008000     05  PC-SEVEN                     PIC  9(01) VALUE 7.         00800000
008100     05  PC-TEN                       PIC  9(06) VALUE 10.        00810000
008200     05  PC-GIFT-WITH-PURCHASE        PIC X(03) VALUE '999'.      00820000
008300     05  PC-ALL-ZERO-UPC-CODE         PIC  9(13)  VALUE ZEROS.    00830000
008400     05  PC-Y                         PIC  X(01)  VALUE 'Y'.      00840000
008500     05  PC-SIX                       PIC  9(01)  VALUE 6.        00850000
008600     05  PC-FALL                      PIC  X(01)  VALUE 'F'.      00860000
008700     05  PC-SPRING                    PIC  X(01)  VALUE 'S'.      00870000
008800     05  PC-MULT-SPECIAL-INSTRS-MSG      PIC  X(50)  VALUE        00880000
008900         'MULT SPECIAL INSTRUCTIONS EXIST, SEE ONLINE SYSTEM'.    00890000
009000     05  PC-INTER-APPL-CODES.                                     00900000
009100         10  PC-INTER-APPL-CRIT-SPEC    PIC  X(04)  VALUE '1'.    00910000
009200         10  PC-INTER-APPL-WO-REC-LIST  PIC  X(04)  VALUE '2'.    00920000
009300         10  PC-INTER-APPL-TKT-MENU     PIC  X(04)  VALUE '3'.    00930000
009400         10  PC-INTER-APPL-RCV-ITM-LST  PIC  X(01)  VALUE '4'.    00940000
009500                                                                  00950000
009600     05  PC-TSYMSG-NUMBERS.                                       00960000
009700         10  PC-TSYMSG-00005          PIC 9(5)  VALUE 00005.      00970000
009800*            INVALID VALUE                                        00980000
009900         10  PC-TSYMSG-00007          PIC 9(5)  VALUE 00007.      00990000
010000*            REQUIRED ENTRY                                       01000000
010100         10  PC-TSYMSG-00008          PIC 9(5)  VALUE 00008.      01010000
010200*            MUST BE NUMERIC                                      01020000
010300         10  PC-TSYMSG-00034          PIC 9(5)  VALUE 00034.      01030000
010400*            ADD(S) SUCCESSFUL                                    01040000
010500         10  PC-TSYMSG-00050          PIC 9(5)  VALUE 00050.      01050000
010600*            NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  01060000
010700         10  PC-TSYMSG-00051          PIC 9(5)  VALUE 00051.      01070000
010800*            NO END OF RANGE HAS BEEN SPECIFIED                   01080000
010900         10  PC-TSYMSG-00052          PIC 9(5)  VALUE 00052.      01090000
011000*            END OF RANGE PRECEDES START OF RANGE                 01100000
011100         10  PC-TSYMSG-00053          PIC 9(5)  VALUE 00053.      01110000
011200*            NO START OF RANGE HAS BEEN SPECIFIED                 01120000
011300         10  PC-TSYMSG-00054          PIC 9(5)  VALUE 00054.      01130000
011400*            ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   01140000
011500         10  PC-TSYMSG-00055          PIC 9(5)  VALUE 00055.      01150000
011600*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     01160000
011700         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      01170000
011800*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       01180000
011900         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      01190000
012000*            TOP OF LIST                                          01200000
012100         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      01210000
012200*            BOTTOM OF LIST                                       01220000
012300         10  PC-TSYMSG-00083          PIC 9(5)  VALUE 00083.      01230000
012400*            PURCHASE ORDER DOES NOT EXIST                        01240000
012500         10  PC-TSYMSG-00101          PIC 9(5)  VALUE 00101.      01250000
012600*            VALUE MUST BE GREATER THAN ZERO AND < 1,000,000      01260000
012700         10  PC-TSYMSG-00117          PIC 9(05)  VALUE 00117.     01270000
012800*            CANNOT ADD - RECORD ALREADY EXISTS                   01280000
012900         10  PC-TSYMSG-00279          PIC 9(5)  VALUE 00279.      01290000
013000*            MORE ITEMS TO DISPLAY                                01300000
013100         10  PC-TSYMSG-00948          PIC 9(5)  VALUE 00948.      01310000
013200*            INVALID TICKET FORMAT                                01320000
013300         10  PC-TSYMSG-01436          PIC 9(5)  VALUE 01436.      01330000
013400*            PRINT REQUEST FOR &VAR LINES HAS BEEN SUBMITTED      01340000
013500         10  PC-TSYMSG-03037          PIC 9(5)  VALUE 03037.      01350000
013600*            TICKETS NOT CREATED FOR THE LINE(S) WITH NO UPC FOUND01360000
013700         10  PC-TSYMSG-03358          PIC 9(5)  VALUE 03358.      01370000
013800*            INCOMPLETE INFO ON SEL LINE -- CANNOT PRINT TICKETS  01380000
013900                                                                  01390000
014000 01  PS-PROGRAM-SWITCHES.                                         01400000
014100*DH  05  PS-SEASON-CODE-EDIT-FAILED-IND  PIC  X(01)  VALUE 'N'.   01410000
014200*DH      88  PS-SEASON-CODE-EDIT-FAILED              VALUE 'Y'.   01420000
014300     05  PS-SPECIAL-INSTRS-IND        PIC  X    VALUE SPACE.      01430000
014400         88  PS-NO-SPECIAL-INSTRS-FOUND         VALUE 'N'.        01440000
014500         88  PS-MULT-SPECIAL-INSTRS-FOUND       VALUE 'Y'.        01450000
014600     05  PS-INVALID-TICKET-FORMAT-IND PIC  X    VALUE 'N'.        01460000
014700         88  PS-INVALID-TICKET-FORMAT           VALUE 'Y'.        01470000
014800         88  PS-VALID-TICKET-FORMAT             VALUE 'N'.        01480000
014900     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        01490000
015000         88  PS-NO-ERROR                        VALUE 'N'.        01500000
015100         88  PS-ERROR                           VALUE 'Y'.        01510000
015200     05  PS-PKITEM-SW                 PIC  X    VALUE 'N'.        01520000
015300         88  PS-PKITEM-NOT-FOUND                VALUE 'N'.        01530000
015400         88  PS-PKITEM-FOUND                    VALUE 'Y'.        01540000
015500     05  PS-PO-FOUND-SW               PIC  X    VALUE 'N'.        01550000
015600         88  PS-PO-FOUND                        VALUE 'Y'.        01560000
015700         88  PS-PO-NOT-FOUND                    VALUE 'N'.        01570000
015800     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01580000
015900         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01590000
016000         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01600000
016100     05  PS-SAVE-HEADER-INFO-SW         PIC  X(01)  VALUE 'N'.    01610000
016200         88  PS-SAVE-HEADER-INFO                    VALUE 'Y'.    01620000
016300         88  PS-DONT-SAVE-HEADER-INFO               VALUE 'N'.    01630000
016400     05  PS-CREATE-HEADER-SW            PIC  X(01)  VALUE 'N'.    01640000
016500         88  PS-CREATE-HEADER                       VALUE 'Y'.    01650000
016600         88  PS-HEADER-CREATED                      VALUE 'N'.    01660000
016700     05  PS-MULTI-PRICE-HEADER-SW       PIC  X(01)  VALUE 'N'.    01670000
016800         88  PS-MULTI-PRICE-HEADER                  VALUE 'Y'.    01680000
016900     05  PS-DOMAIN-INFO-FOUND-SW        PIC  X(01)  VALUE 'N'.    01690000
017000         88  PS-DOMAIN-INFO-FOUND                   VALUE 'Y'.    01700000
017100         88  PS-DOMAIN-INFO-NOT-FOUND               VALUE 'N'.    01710000
017200     05  PS-UPC-NBR-FOUND-SW            PIC  X(01)  VALUE 'N'.    01720000
017300         88  PS-UPC-NBR-FOUND                       VALUE 'Y'.    01730000
017400         88  PS-UPC-NBR-NOT-FOUND                   VALUE 'N'.    01740000
017500     05  PS-RESET-SWITCHES-SW           PIC  X(01)  VALUE 'N'.    01750000
017600         88  PS-RESET-SWITCHES                      VALUE 'Y'.    01760000
017700         88  PS-DO-NOT-RESET-SWITCHES               VALUE 'N'.    01770000
017800     05  PS-SOCKET-ERROR-SW             PIC  X(01)  VALUE 'N'.    01780000
017900         88  PS-SOCKET-ERROR                        VALUE 'Y'.    01790000
018000         88  PS-NO-SOCKET-ERROR                     VALUE 'N'.    01800000
018100     05  PS-TICKET-SYSTEM-COMM-SW       PIC  X(01)  VALUE 'D'.    01810000
018200         88  PS-USE-DRS-COMM                        VALUE 'D'.    01820000
018300         88  PS-USE-TCP-IP-COMM                     VALUE 'T'.    01830000
018400                                                                  01840000
018500 01  DN-NULL-INDICATORS.                                          01850000
018600     05  DN-DCTFAS-TKT-FMT-NULL       PIC S9(4) COMP VALUE +0.    01860000
018700     05  DN-DCFAAS-FCLTY-ID-NULL      PIC S9(4) COMP VALUE +0.    01870000
018800     05  DN-SUM-QTY-NULL              PIC S9(4) COMP VALUE +0.    01880000
018900                                                                  01890000
019000 01  DK-DB2-KEYS.                                                 01900000
019100     05  DK-OPER-UNT-ID               PIC S9(4) COMP.             01910000
019200     05  DK-FCLTY-ID                  PIC S9(4) COMP.             01920000
019300     05  DK-PO-NBR                    PIC S9(9) COMP.             01930000
019400     05  DK-REC-SEQ-NBR               PIC S9(9) COMP.             01940000
019500     05  DK-LINE-NBR                  PIC S9(9) COMP.             01950000
019600     05  DK-ENT-ID                    PIC S9(9) COMP.             01960000
019700     05  DK-ITM-NBR                   PIC S9(15)V COMP-3.         01970000
019800                                                                  01980000
019900***************************************************************** 01990000
020000**   COMMUNICATIONS PORT NUMBER IS 3000                           02000000
020100***************************************************************** 02010000
020200 01  CP-COM-HEX-PORT                  PIC  X(02) VALUE            02020000
020300                                                     X'0BB8'.     02030000
020400 01  CP-COM-PORT REDEFINES CP-COM-HEX-PORT                        02040000
020500                                     PIC  9(04)  COMP.            02050000
020600*                                                                 02060000
020700*    THIS IS THE BUFFER AREA BEING USED TO FOR THE TCP/IP SOCKET  02070000
020800*    CALLS.  THIS VARIABLE MUST BE THE SAME LENGTH AS THE VALUE   02080000
020900*    SPECIFIED IN "PC-DTL-REC-LENGTH"  IT MUST ALSO BE THE SAME   02090000
021000*    LENGTH AS "DL-DETAIL-LINE".                                  02100000
021100 01  TCP-BUF.                                                     02110000
021200     05 TCP-BUF-DATA                  PIC X(210) VALUE SPACE.     02120000
021300                                                                  02130000
021400 01  PV-PROGRAM-VARIABLES.                                        02140000
021500     05  PV-SAVE-COMM-DATA            PIC  X(264).                02150000
021600     05  PV-STICKER-NBR-ZZ999         PIC  ZZ999.                 02160000
021700     05  PV-NUMBER-OF-SELECTED-ITEMS  PIC  9(03).                 02170000
021800*DH  05  PV-SEASON-CODE.                                          02180000
021900*DH      10  PV-SEASON-CODE-SEASON    PIC  X(01)  VALUE SPACE.    02190000
022000*DH          88  PV-VAILD-SEASON-CODES               VALUE        02200000
022100*DH              'F' 'S'.                                         02210000
022200*DH      10  PV-SEASON-CODE-SCND-DGT-OF-YR                        02220000
022300*DH                                   PIC  X(01)  VALUE SPACE.    02230000
022400*DH      10  PV-SEASON-CODE-MONTH     PIC  9(01)  VALUE ZEROS.    02240000
022500     05  PV-DATE.                                                 02250000
022600         10  PV-MONTH                    PIC  9(02)  VALUE ZEROS. 02260000
022700         10  FILLER REDEFINES PV-MONTH.                           02270000
022800             15  PV-FIRST-DIGIT-OF-MONTH PIC  9(01).              02280000
022900             15  PV-SECOND-DIGIT-OF-MONTH                         02290000
023000                                         PIC  9(01).              02300000
023100         10  PV-DAY                      PIC  X(02)  VALUE SPACE. 02310000
023200         10  PV-YEAR.                                             02320000
023300             15  PV-FIRST-DIGIT-OF-YEAR  PIC  X(01)  VALUE SPACE. 02330000
023400             15  PV-SECOND-DIGIT-OF-YEAR PIC  X(01)  VALUE SPACE. 02340000
023500     05  PV-DISPLAY-KEYS.                                         02350000
023600         10  PV-DISPLAY-ORD-NBR          PIC  9(09)  VALUE ZEROS  02360000
023700                                                BLANK WHEN ZEROS. 02370000
023800         10  FILLER                      PIC  X(02)  VALUE SPACE. 02380000
023900         10  PV-DISPLAY-RCVR-SEQ-NBR     PIC  9(09)  VALUE ZEROS  02390000
024000                                                BLANK WHEN ZEROS. 02400000
024100         10  FILLER                      PIC  X(02)  VALUE SPACE. 02410000
024200         10  PV-DISPLAY-ORD-LNE-NBR      PIC  9(04)  VALUE ZEROS  02420000
024300                                                BLANK WHEN ZEROS. 02430000
024400         10  FILLER                      PIC  X(02)  VALUE SPACE. 02440000
024500         10  PV-DISPLAY-WORK-ORD-SEQ-NBR PIC  9(04)  VALUE ZEROS  02450000
024600                                                BLANK WHEN ZEROS. 02460000
024700         10  FILLER                      PIC  X(02)  VALUE SPACE. 02470000
024800         10  PV-DISPLAY-OPER-UNT-ID      PIC  9(04)  VALUE ZEROS  02480000
024900                                                BLANK WHEN ZEROS. 02490000
025000         10  FILLER                      PIC  X(02)  VALUE SPACE. 02500000
025100         10  PV-DISPLAY-FCLTY-ID         PIC  9(04)  VALUE ZEROS  02510000
025200                                                BLANK WHEN ZEROS. 02520000
025300     05  PV-DEPT-CLASS.                                           02530000
025400         10  PV-DC-DEPT-NMBR             PIC  9(03)  VALUE ZERO.  02540000
025500         10  PV-DASH                     PIC  X(01)  VALUE SPACE. 02550000
025600         10  PV-DC-MAJOR-CLASS           PIC  9(02)  VALUE ZERO.  02560000
025700     05  PV-JOB-ID.                                               02570000
025800         10  PV-PO-REC-SEQ.                                       02580000
025900             15  PV-KEY-PO-NBR        PIC  9(08).                 02590000
026000             15  FILLER               PIC  X(01)  VALUE '-'.      02600000
026100             15  PV-KEY-REC-SEQ-NBR   PIC  9(03).                 02610000
026200         10  FILLER                   PIC  X(08)  VALUE SPACES.   02620000
026300     05  PV-TICKET-QUANTITY           PIC  9(06)  VALUE ZEROS.    02630000
026400     05  PV-DIRECTORY-PATH            PIC  X(23)  VALUE SPACES.   02640000
026500     05  PV-TKT-FMT-ID                PIC  X(06)  VALUE SPACES.   02650000
026600     05  PV-TKT-OFFICE.                                           02660000
026700         10  PV-TKT-OFFICE-1-3        PIC  X(03).                 02670000
026800         10  PV-TKT-OFFICE-FILL       PIC  X(03).                 02680000
026900     05  PV-TOTAL-TICKET-QUANTITY     PIC  9(06)  VALUE ZEROS.    02690000
027000     05  PV-NBR-SEL-ITEMS             PIC  9(09)  VALUE ZEROS.    02700000
027100     05  PV-NMBR-OF-TICKETS           PIC  9(05)  VALUE ZEROS.    02710000
027200     05  PV-NMBR-OF-TICKETS-4-DGT     PIC  9(04)  VALUE ZEROS.    02720000
027300     05  PV-DETAIL-CONTROL-NMBR.                                  02730000
027400         10  PV-PO-LINE-NMBR-DETAIL   PIC  X(03)  VALUE SPACE.    02740000
027500         10  PV-QUANTITY-SEQ-NMBR     PIC  9(02)  VALUE ZEROS.    02750000
027600         10  FILLER                   PIC  X(02)  VALUE SPACE.    02760000
027700     05  PV-HEADER-CONTROL-NMBR.                                  02770000
027800         10  PV-RIGHTMOST4-DIGITS-OF-KEYREC                       02780000
027900                                      PIC  X(04)  VALUE SPACE.    02790000
028000         10  PV-PO-LINE-NMBR-HEADER   PIC  X(03)  VALUE SPACE.    02800000
028100     05  PV-LINES-NOT-PRINTED         PIC S9(04)  VALUE ZERO      02810000
028200                                                COMP SYNC.        02820000
028300     05  PV-SELECT-COUNTER            PIC S9(04)  VALUE ZERO      02830000
028400                                                COMP SYNC.        02840000
028500     05  PV-SUB                       PIC S9(4) VALUE ZERO        02850000
028600                                                COMP SYNC.        02860000
028700     05  PV-GP-QTY                    PIC  9.                     02870000
028800     05  PV-GP-RTL-1                  PIC  9.99.                  02880000
028900     05  PV-GP-RTL-2                  PIC  99.99.                 02890000
029000     05  PV-GP-RTL-DOLLAR-2           PIC $$9.99.                 02900000
029100     05  PV-GP-RTL-DOLLAR-1           PIC $9.99.                  02910000
029200     05  PV-GP-QTY-SLASH.                                         02920000
029300         10  PV-GP-QTY-1              PIC  9(01).                 02930000
029400         10  PV-GP-SLASH              PIC  X(01) VALUE '/'.       02940000
029500     05  PV-QUANTITY                  PIC S9(09) VALUE ZERO       02950000
029600                                                 COMP-3.          02960000
029700     05  PV-SUM-QTY                   PIC S9(09) VALUE ZERO       02970000
029800                                                 COMP-3.          02980000
029900     05  PV-REC-SEQ-NBR               PIC  9(3).                  02990000
030000     05  PV-REMAINDER                 PIC S9(4) VALUE ZERO        03000000
030100                                                COMP SYNC.        03010000
030200     05  PV-READ-COUNT                PIC S9(9) VALUE ZERO        03020000
030300                                                COMP-3.           03030000
030400     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE ZERO        03040000
030500                                                COMP-3.           03050000
030600     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE ZERO        03060000
030700                                                COMP-3.           03070000
030800     05  PV-ITEM-IN-USE               PIC S9(9) VALUE ZERO        03080000
030900                                                COMP-3.           03090000
031000     05  PV-TOP-ITEM                  PIC S9(9) VALUE ZERO        03100000
031100                                                COMP-3.           03110000
031200     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE ZERO        03120000
031300                                                COMP-3.           03130000
031400     05  PV-TEMP-BLOCK-NUMBER         PIC S9(9) VALUE ZERO        03140000
031500                                                COMP-3.           03150000
031600     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE ZERO        03160000
031700                                                COMP SYNC.        03170000
031800     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        03180000
031900                                                COMP SYNC.        03190000
032000     05  PV-ITEM                      PIC S9(4) VALUE ZERO        03200000
032100                                                COMP SYNC.        03210000
032200     05  PV-SEL-QUEUE-ITEM            PIC S9(4) VALUE ZERO        03220000
032300                                                COMP SYNC.        03230000
032400     05  PV-SAVE-ITEM                 PIC S9(4) VALUE ZERO        03240000
032500                                                COMP SYNC.        03250000
032600     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE ZERO        03260000
032700                                                COMP SYNC.        03270000
032800     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE ZERO        03280000
032900                                                COMP SYNC.        03290000
033000     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE ZERO        03300000
033100                                                COMP SYNC.        03310000
033200     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        03320000
033300                                                COMP SYNC.        03330000
033400     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        03340000
033500                                                COMP SYNC.        03350000
033600     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(4) VALUE ZERO        03360000
033700                                                COMP SYNC.        03370000
033800     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(4) VALUE ZERO        03380000
033900                                                COMP SYNC.        03390000
034000     05  PV-START-OF-SELECTED-RANGE   PIC S9(4) VALUE ZERO        03400000
034100                                                COMP SYNC.        03410000
034200     05  PV-END-OF-SELECTED-RANGE     PIC S9(4) VALUE ZERO        03420000
034300                                                COMP SYNC.        03430000
034400     05  PV-SQL-SUB                   PIC S9(4) VALUE ZERO        03440000
034500                                                COMP SYNC.        03450000
034600     05  PV-REC-IND                   PIC S9(4) VALUE ZERO        03460000
034700                                                COMP SYNC.        03470000
034800     05  PV-DISTRO-IND                PIC S9(4) VALUE ZERO        03480000
034900                                                COMP SYNC.        03490000
035000     05  PV-EXPTED-IND                PIC S9(4) VALUE ZERO        03500000
035100                                                COMP SYNC.        03510000
035200     05  PV-VERIFIED-IND              PIC S9(4) VALUE ZERO        03520000
035300                                                COMP SYNC.        03530000
035400     05  PV-REC-ITEMS                 PIC S9(9) VALUE ZERO        03540000
035500                                                COMP SYNC.        03550000
035600     05  PV-SUM-EXPTED-QTY            PIC S9(9) VALUE ZERO        03560000
035700                                                COMP SYNC.        03570000
035800     05  PV-SUM-VERIFIED-QTY          PIC S9(9) VALUE ZERO        03580000
035900                                                COMP SYNC.        03590000
036000     05  PV-SUM-DISTRO-QTY            PIC S9(9) VALUE ZERO        03600000
036100                                                COMP SYNC.        03610000
036200     05  PV-SUM-STR-DISTRO-QTY        PIC S9(9) VALUE ZERO        03620000
036300                                                COMP SYNC.        03630000
036400     05  PV-OPEN-TO-REC               PIC S9(6) VALUE ZERO.       03640000
036500     05  PV-ITM-NBR-X.                                            03650000
036600         10  PV-ITM-NBR               PIC 9(15) VALUE ZEROS.      03660000
036700     05  PV-OPER-UNT-ID-X.                                        03670000
036800         10  PV-OPER-UNT-ID           PIC 9(04) VALUE ZEROS.      03680000
036900     05  PV-STATUS-CDE                PIC X(02) VALUE SPACES.     03690000
037000         88  PV-VALID-STATUS-CDE                VALUE 'AP', 'AC'. 03700000
037100     05  PV-DRS-ABEND-DISPLAY-LINE1.                              03710000
037200         10  FILLER                      PIC  X(14)  VALUE        03720000
037300             'DRRB ID = DRRB'.                                    03730000
037400         10  FILLER                      PIC  X(02)  VALUE SPACE. 03740000
037500         10  FILLER                      PIC  X(12)  VALUE        03750000
037600             'DRRB FUNC = '.                                      03760000
037700         10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE. 03770000
037800         10  FILLER                      PIC  X(02)  VALUE SPACE. 03780000
037900         10  FILLER                      PIC  X(11)  VALUE        03790000
038000             'DRRB RID = '.                                       03800000
038100         10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE. 03810000
038200         10  FILLER                      PIC  X(02)  VALUE SPACE. 03820000
038300         10  FILLER                      PIC  X(15)  VALUE        03830000
038400             'DRRB OPTIONS = '.                                   03840000
038500         10  PV-DRS-DRRB-OPTIONS         PIC  X(08)  VALUE SPACE. 03850000
038600     05  PV-DRS-ABEND-DISPLAY-LINE2.                              03860000
038700         10  FILLER                      PIC  X(10)  VALUE        03870000
038800             'DRRB RC = '.                                        03880000
038900         10  PV-DRS-DRRB-RC              PIC  X(04)  VALUE SPACE. 03890000
039000         10  FILLER                      PIC  X(02)  VALUE SPACE. 03900000
039100         10  FILLER                      PIC  X(18)  VALUE        03910000
039200             'DRRB ATTR-ERROR = '.                                03920000
039300         10  PV-DRS-ATTR-ERROR           PIC  X(02)  VALUE SPACE. 03930000
039400         10  FILLER                      PIC  X(02)  VALUE SPACE. 03940000
039500         10  FILLER                      PIC  X(12)  VALUE        03950000
039600             'DRRB DRDC = '.                                      03960000
039700         10  PV-DRS-DRRB-DRDC            PIC  X(04)  VALUE SPACE. 03970000
039800         10  FILLER                      PIC  X(02)  VALUE SPACE. 03980000
039900         10  FILLER                      PIC  X(13)  VALUE        03990000
040000             'DRRB LINES = '.                                     04000000
040100         10  PV-DRS-DRRB-LINES           PIC  X(04)  VALUE SPACE. 04010000
040200                                                                  04020000
040300*** THESE LINES ARE NEEDED TO DETERMINE THE CICS REGION'          04030000
040400     05  PV-SYS-ID-4                     PIC  X(04) VALUE SPACES. 04040000
040500     05  PV-SYS-ID                       PIC  X(03) VALUE SPACES. 04050000
040600         88  PC-ALL-TEST-SYSTEM                     VALUE 'CIQ',  04060000
040700                                                          'CIT',  04070000
040800                                                          'CIL'.  04080000
040900         88  PC-TEST-SYSTEM                         VALUE 'CIT'.  04090000
041000         88  PC-QA-SYSTEM                           VALUE 'CIQ'.  04100000
041100         88  PC-LEARNING-SYSTEM                     VALUE 'CIL'.  04110000
041200         88  PC-PROD-SYSTEM                         VALUE 'CIP'.  04120000
041300                                                                  04130000
041400*** THESE LINES ARE NEEDED FOR TCP/IP SOCKET CALLS                04140000
041500     05  PV-RETCODE                      PIC  9(08)- VALUE ZERO.  04150000
041600     05  PV-ERRNO                        PIC  9(08)- VALUE ZERO.  04160000
041700     05  PV-SOCK-ID                      PIC  9(04)  VALUE ZERO.  04170000
041800     05  PV-TCPLENG                      PIC  9(08)  VALUE ZERO.  04180000
041900     05  PV-FLAG                         PIC  9(08)  VALUE ZERO.  04190000
042100     05  PV-FUNC-TXT.                                             04210000
042200         10  PV-IP-ADDRESS-TXT           PIC  X(15)  VALUE SPACES.04220000
042400         10  FILLER                      PIC  X(01)  VALUE SPACES.04240000
042401         10  PV-DIRECTORY-DRIVE-TXT      PIC  X(07)  VALUE SPACES.04240133
042402         10  FILLER                      PIC  X(02)  VALUE SPACES.04240200
042403     05  PV-IP-ADDR                      PIC  9(08)  VALUE ZERO.  04240300
042404     05  PV-IP-ADDRESS.                                           04240400
042405         10  PV-IP-ADDR-NUM1             PIC  9(03).              04240500
042406             88  PV-IP-ADDR-NUM1-VALID       VALUE 1 THRU 255.    04240600
042407         10  PV-IP-ADDR-DOT1             PIC  X(01).              04240700
042500             88  PV-IP-ADDR-DOT1-VALID       VALUE '.'.           04250000
042600         10  PV-IP-ADDR-NUM2             PIC  9(03).              04260000
042700             88  PV-IP-ADDR-NUM2-VALID       VALUE 1 THRU 255.    04270000
042800         10  PV-IP-ADDR-DOT2             PIC  X(01).              04280000
042900             88  PV-IP-ADDR-DOT2-VALID       VALUE '.'.           04290000
043000         10  PV-IP-ADDR-NUM3             PIC  9(03).              04300000
043100             88  PV-IP-ADDR-NUM3-VALID       VALUE 1 THRU 255.    04310000
043200         10  PV-IP-ADDR-DOT3             PIC  X(01).              04320000
043300             88  PV-IP-ADDR-DOT3-VALID       VALUE '.'.           04330000
043400         10  PV-IP-ADDR-NUM4             PIC  9(03).              04340000
043500             88  PV-IP-ADDR-NUM4-VALID       VALUE 1 THRU 255.    04350000
043600     05  PV-HEX-FIELD.                                            04360000
043700         10  PV-HEX-FIELD-1              PIC  X(01).              04370000
043800         10  PV-HEX-FIELD-2              PIC  X(01).              04380000
043900         10  PV-HEX-FIELD-3              PIC  X(01).              04390000
044000         10  PV-HEX-FIELD-4              PIC  X(01).              04400000
044100     05  PV-HEX-FIELD-NUMBER REDEFINES PV-HEX-FIELD               04410000
044200                                         PIC  9(08)  COMP.        04420000
044300     05  PV-HEX-NUMERIC                  PIC  9(04) BINARY.       04430000
044400     05  PV-HEX-CHAR REDEFINES PV-HEX-NUMERIC.                    04440000
044500         10  PV-HEX-CHAR-1               PIC  X(01).              04450000
044600         10  PV-HEX-CHAR-2               PIC  X(01).              04460000
044700     05  PV-XMIT-STAT-CDE                PIC  X(01) VALUE SPACES. 04470000
044800*** END OF LINES NEEDED FOR TCP/IP SOCKET CALLS                   04480000
044900**                                                                04490000
045000*** DISPLAY THE LINE BEING SENT DOWN VIA A TCP/IP SOCKET CALL.    04500000
045100*** WHEN ADDING DATA TO DL-DETAIL-LINE, THE FOLLOWING LINES WILL  04510000
045200*** NEED TO BE ADJUSTED, OR THE DISPLAY IN THE CICS LOG MAY BE    04520000
045300*** OFF JUST A BIT.                                               04530000
045400     05  PV-DETAIL-LINE.                                          04540000
045500         10  PV-DETAIL-LINE-POS-1-97     PIC  X(97)  VALUE SPACES.04550000
045600         10  PV-DETAIL-LINE-POS-98-177   PIC  X(80)  VALUE SPACES.04560000
045700         10  PV-DETAIL-LINE-POS-178-210  PIC  X(33)  VALUE SPACES.04570000
045800     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACES.04580000
045900******************************************************************04590000
046000*                      PROGRAM TIME                               04600000
046100******************************************************************04610000
046200 01  PT-SYSTEM-TIME.                                              04620000
046300     05  PT-SYS-TIME                     PIC S9(06) VALUE 0.      04630000
046400     05  FILLER                                                   04640000
046500         REDEFINES PT-SYS-TIME.                                   04650000
046600         10  PT-SYS-HHMM                 PIC S9(04).              04660000
046700         10  FILLER                      PIC X(02).               04670000
046800                                                                  04680000
046900     05  PT-DISPLAY-TIME                 PIC  9(04).              04690000
047000     05  FILLER REDEFINES PT-DISPLAY-TIME.                        04700000
047100         10  PT-DISPLAY-HH               PIC  9(02).              04710000
047200         10  PT-DISPLAY-MM               PIC  9(02).              04720000
047300                                                                  04730000
047400******************************************************************04740000
047500*                       INFO MESSAGE                              04750000
047600******************************************************************04760000
047700 01  LE-START-MESSAGE.                                            04770000
047800     05  LE-INFO-NMBR                 PIC X(15) VALUE             04780000
047900                                      ' **** E254 ****'.          04790000
048000     05  FILLER                       PIC X(03) VALUE ' / '.      04800000
048100     05  FILLER                       PIC X(40) VALUE             04810000
048200         'PROGRAM RCKCS254 SOCKET CALL STARTED AT '.              04820000
048300     05  LE-PRT-TIME.                                             04830000
048400         10  LE-PRT-HH                PIC 9(02).                  04840000
048500         10  FILLER                   PIC X(01) VALUE ':'.        04850000
048600         10  LE-PRT-MM                PIC 9(02).                  04860000
048700     05  FILLER                       PIC X(03) VALUE ' / '.      04870000
048800     05  FILLER                       PIC X(14) VALUE SPACES.     04880000
048900                                                                  04890000
049000 01  LE-END-MESSAGE.                                              04900000
049100     05  LE-END-INFO-NMBR             PIC X(15) VALUE             04910000
049200                                      ' **** E254 ****'.          04920000
049300     05  FILLER                       PIC X(03) VALUE ' / '.      04930000
049400     05  FILLER                       PIC X(38) VALUE             04940000
049500         'PROGRAM RCKCS254 SOCKET CALL ENDED AT '.                04950000
049600     05  LE-END-PRT-TIME.                                         04960000
049700         10  LE-END-PRT-HH            PIC 9(02).                  04970000
049800         10  FILLER                   PIC X(01) VALUE ':'.        04980000
049900         10  LE-END-PRT-MM            PIC 9(02).                  04990000
050000     05  FILLER                       PIC X(03) VALUE ' / '.      05000000
050100     05  FILLER                       PIC X(16) VALUE SPACES.     05010000
050200                                                                  05020000
050300*** THIS IS THE DETAIL LINE BEING SENT TO THE TICKET SYSTEM PC.   05030000
050400*** THE LINES ARE TERMINATED WITH AN CARRIAGE RETURN / LINEFEED   05040000
050500*** CHARACTERS (X'0D25').  TURN 'HEX ON' TO SEE THEM IN THE LAST  05050000
050600*** TWO BYTES OF DL-DETAIL-LINE.                                  05060000
050700*** DL-DETAIL-LINE.                                               05070000
050800 01  DL-DETAIL-LINE.                                              05080000
050900     05  DL-RECEIVER                  PIC X(12) VALUE SPACES.     05090000
051000     05  FILLER                       PIC X(01) VALUE ','.        05100000
051100     05  DL-VNDR-NAME                 PIC X(20) VALUE SPACES.     05110000
051200     05  FILLER                       PIC X(01) VALUE ','.        05120000
051300     05  DL-PRINTER-LOCATION          PIC X(06) VALUE SPACES.     05130000
051400     05  FILLER                       PIC X(01) VALUE ','.        05140000
051500     05  DL-PO-LINE                   PIC X(04) VALUE SPACES.     05150000
051600     05  FILLER                       PIC X(01) VALUE ','.        05160000
051700     05  DL-QTY                       PIC 9(05) VALUE ZEROS.      05170000
051800     05  FILLER                       PIC X(01) VALUE ','.        05180000
051900     05  DL-TOTAL-SKU                 PIC 9(03) VALUE ZEROS.      05190000
052000     05  FILLER                       PIC X(01) VALUE ','.        05200000
052100     05  DL-FORMAT-NAME               PIC X(33) VALUE SPACES.     05210000
052200     05  FILLER                       PIC X(01) VALUE ','.        05220000
052300     05  DL-DEPT                      PIC X(03) VALUE SPACES.     05230000
052400     05  FILLER                       PIC X(01) VALUE ','.        05240000
052500     05  DL-CLASS                     PIC X(02) VALUE SPACES.     05250000
052600     05  FILLER                       PIC X(01) VALUE ','.        05260000
052700     05  DL-SUB-CLASS                 PIC X(02) VALUE SPACES.     05270000
052800     05  FILLER                       PIC X(01) VALUE ','.        05280000
052900     05  DL-RETAIL                    PIC X(07) VALUE SPACES.     05290000
053000     05  FILLER                       PIC X(01) VALUE ','.        05300000
053100     05  DL-STYLE                     PIC X(12) VALUE SPACES.     05310000
053200     05  FILLER                       PIC X(01) VALUE ','.        05320000
053300     05  DL-UPC                       PIC X(13) VALUE SPACES.     05330000
053400     05  FILLER                       PIC X(01) VALUE ','.        05340000
053500     05  DL-SIZE                      PIC X(10) VALUE SPACES.     05350000
053600     05  FILLER                       PIC X(01) VALUE ','.        05360000
053700     05  DL-COLOR                     PIC X(10) VALUE SPACES.     05370000
053800     05  FILLER                       PIC X(01) VALUE ','.        05380000
053900     05  DL-STICKER-NBR               PIC X(05) VALUE SPACES.     05390000
054000     05  FILLER                       PIC X(01) VALUE ','.        05400000
054100     05  DL-MULTICOUNT                PIC X(02) VALUE SPACES.     05410000
054200     05  FILLER                       PIC X(01) VALUE ','.        05420000
054300     05  DL-MULTIPRICE                PIC X(06) VALUE SPACES.     05430000
054400     05  FILLER                       PIC X(01) VALUE ','.        05440000
054500     05  DL-OPTION-BLK                PIC X(03) VALUE SPACES.     05450000
054600     05  FILLER                       PIC X(01) VALUE ','.        05460000
054700     05  DL-SHOE-NAME                 PIC X(23) VALUE SPACES.     05470000
054800     05  FILLER                       PIC X(01) VALUE ','.        05480000
054900     05  DL-RETAIL-GWP                PIC X(04) VALUE SPACES.     05490000
055000     05  FILLER                       PIC X(01) VALUE ','.        05500000
055100     05  DL-PUT-AWAY-CODE             PIC X(02) VALUE SPACES.     05510000
055200     05  FILLER                       PIC X(02) VALUE X'0D25'.    05520000
055300                                                                  05530000
055400 01  LQW-LIST-QUEUE-WORK-AREA.                                    05540000
055500     05  LQW-BLOCK-MODIFIED           PIC X(01)  VALUE SPACE.     05550000
055600     05  LQW-ITEM-ENTRIES             OCCURS 9 TIMES              05560000
055700                                      INDEXED BY LQW-IDX.         05570000
055800         10  LQW-LIST-ITEM-NUMBER     PIC S9(9)  COMP-3.          05580000
055900         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  05590000
056000         10  LQW-SELECTED-SW          PIC X(01).                  05600000
056100             88  LQW-SELECT                      VALUE 'S'.       05610000
056200             88  LQW-DESELECT                    VALUE ' '.       05620000
056300         10  LQW-PO-LNE-NBR           PIC 9(09).                  05630000
056400         10  FILLER REDEFINES LQW-PO-LNE-NBR.                     05640000
056500             15  FILLER               PIC X(06).                  05650000
056600             15  LQW-PO-LNE-NBR-X     PIC X(03).                  05660000
056700         10  LQW-UNT-QTY-X.                                       05670000
056800             15  LQW-UNT-QTY          PIC 9(05).                  05680000
056900         10  LQW-ITM-NBR              PIC S9(15)V COMP-3.         05690000
057000         10  LQW-MAJOR-CLASS-X.                                   05700000
057100             15  LQW-MAJOR-CLASS      PIC 9(02).                  05710000
057200         10  LQW-SUB-CLASS-X.                                     05720000
057300             15  LQW-SUB-CLASS        PIC 9(02).                  05730000
057400         10  LQW-UPC                  PIC X(13).                  05740000
057500         10  LQW-VEND-STYL            PIC X(20).                  05750000
057600         10  LQW-SIZE                 PIC X(10).                  05760000
057700         10  LQW-TABLE-SIZE           PIC X(10).                  05770000
057800         10  LQW-COLOR                PIC X(10).                  05780000
057900         10  LQW-TABLE-COLOR          PIC X(10).                  05790000
058000         10  LQW-UNT-RTL-PR-X.                                    05800000
058100             15  LQW-UNT-RTL-PR       PIC 9(06)V99.               05810000
058200         10  FILLER REDEFINES LQW-UNT-RTL-PR-X.                   05820000
058300             15  FILLER               PIC X(01).                  05830000
058400             15  LQW-UNT-RTL-PRICE    PIC X(07).                  05840000
058500         10  FILLER REDEFINES LQW-UNT-RTL-PR-X.                   05850000
058600             15  FILLER               PIC X(05).                  05860000
058700             15  LQW-UNT-RTL-PRICE-3  PIC X(03).                  05870000
058800         10  FILLER REDEFINES LQW-UNT-RTL-PR-X.                   05880000
058900             15  FILLER               PIC X(02).                  05890000
059000             15  LQW-UNT-RTL-PRICE-6  PIC X(06).                  05900000
059100         10  LQW-GP-RTL-QTY           PIC 9(01).                  05910000
059200         10  LQW-GP-RTL               PIC 9(02)V99.               05920000
059300         10  FILLER REDEFINES LQW-GP-RTL.                         05930000
059400             15  LQW-GP-RTL-X         PIC X(04).                  05940000
059500         10  LQW-OPT-BLK              PIC X(03).                  05950000
059600                                                                  05960000
059700******************************************************************05970000
059800*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           05980000
059900******************************************************************05990000
060000     COPY PCWS016.                                                06000000
060100                                                                  06010000
060200******************************************************************06020000
060300*    BMS MAP                                                      06030000
060400******************************************************************06040000
060500     COPY RCKM254.                                                06050000
060600                                                                  06060000
060700 01  MR-OCCURS-LAYOUT                 REDEFINES RC254AO.          06070000
060800     05  FILLER                       PIC X(230).                 06080000
060900     05  MR-SCROLL-AREA               OCCURS 9 TIMES.             06090000
061000         10  MR-SELECTL               PIC S9(4) COMP.             06100000
061100         10  MR-SELECTA               PIC X.                      06110000
061200         10  MR-SELECTC               PIC X.                      06120000
061300         10  MR-SELECTH               PIC X.                      06130000
061400         10  MR-SELECTI               PIC X.                      06140000
061500                                                                  06150000
061600         10  MR-LINE-NBR-L            PIC S9(4) COMP.             06160000
061700         10  MR-LINE-NBR-A            PIC X.                      06170000
061800         10  MR-LINE-NBR-C            PIC X.                      06180000
061900         10  MR-LINE-NBR-H            PIC X.                      06190000
062000         10  MR-LINE-NBR.                                         06200000
062100             15  MR-LINE-NBR-EDITED                               06210000
062200                                      PIC ZZ9.                    06220000
062300                                                                  06230000
062400         10  MR-QUANT-L               PIC S9(4) COMP.             06240000
062500         10  MR-QUANT-A               PIC X.                      06250000
062600         10  MR-QUANT-C               PIC X.                      06260000
062700         10  MR-QUANT-H               PIC X.                      06270000
062800         10  MR-QUANT.                                            06280000
062900             15  MR-QUANT-EDITED                                  06290000
063000                                      PIC ZZZZ9.                  06300000
063100                                                                  06310000
063200         10  MR-CLASS-L               PIC S9(4) COMP.             06320000
063300         10  MR-CLASS-A               PIC X.                      06330000
063400         10  MR-CLASS-C               PIC X.                      06340000
063500         10  MR-CLASS-H               PIC X.                      06350000
063600         10  MR-CLASS                 PIC X(05).                  06360000
063700                                                                  06370000
063800         10  MR-UPC-L                 PIC S9(4) COMP.             06380000
063900         10  MR-UPC-A                 PIC X.                      06390000
064000         10  MR-UPC-C                 PIC X.                      06400000
064100         10  MR-UPC-H                 PIC X.                      06410000
064200         10  MR-UPC                   PIC X(13).                  06420000
064300                                                                  06430000
064400         10  MR-STYLE-L               PIC S9(4) COMP.             06440000
064500         10  MR-STYLE-A               PIC X.                      06450000
064600         10  MR-STYLE-C               PIC X.                      06460000
064700         10  MR-STYLE-H               PIC X.                      06470000
064800         10  MR-STYLE                 PIC X(12).                  06480000
064900                                                                  06490000
065000         10  MR-SIZE-L                PIC S9(4) COMP.             06500000
065100         10  MR-SIZE-A                PIC X.                      06510000
065200         10  MR-SIZE-C                PIC X.                      06520000
065300         10  MR-SIZE-H                PIC X.                      06530000
065400         10  MR-SIZE                  PIC X(05).                  06540000
065500                                                                  06550000
065600         10  MR-COLOR-L               PIC S9(4) COMP.             06560000
065700         10  MR-COLOR-A               PIC X.                      06570000
065800         10  MR-COLOR-C               PIC X.                      06580000
065900         10  MR-COLOR-H               PIC X.                      06590000
066000         10  MR-COLOR                 PIC X(05).                  06600000
066100                                                                  06610000
066200         10  MR-RETAIL-L              PIC S9(4) COMP.             06620000
066300         10  MR-RETAIL-A              PIC X.                      06630000
066400         10  MR-RETAIL-C              PIC X.                      06640000
066500         10  MR-RETAIL-H              PIC X.                      06650000
066600         10  MR-RETAIL.                                           06660000
066700             15  MR-RETAIL-EDITED     PIC ZZZZZ.99.               06670000
066800                                                                  06680000
066900         10  MR-GP-RETAIL-L           PIC S9(4) COMP.             06690000
067000         10  MR-GP-RETAIL-A           PIC X.                      06700000
067100         10  MR-GP-RETAIL-C           PIC X.                      06710000
067200         10  MR-GP-RETAIL-H           PIC X.                      06720000
067300         10  MR-GP-RETAIL             PIC X(07).                  06730000
067400                                                                  06740000
067500         10  MR-OPT-BLK-L             PIC S9(4) COMP.             06750000
067600         10  MR-OPT-BLK-A             PIC X.                      06760000
067700         10  MR-OPT-BLK-C             PIC X.                      06770000
067800         10  MR-OPT-BLK-H             PIC X.                      06780000
067900         10  MR-OPT-BLK               PIC X(03).                  06790000
068000                                                                  06800000
068100                                                                  06810000
068200******************************************************************06820000
068300*    BMS ATTRIBUTES                                               06830000
068400******************************************************************06840000
068500     COPY DPWS015.                                                06850000
068600                                                                  06860000
068700******************************************************************06870000
068800*    FUNCTION KEYS                                                06880000
068900******************************************************************06890000
069000     COPY DPWS016.                                                06900000
069100                                                                  06910000
069200******************************************************************06920000
069300*    PARAMETER LIST FOR NUMERIC EDIT SUBROUTINE                   06930000
069400******************************************************************06940000
069500     COPY DPWS010I.                                               06950000
069600                                                                  06960000
069700******************************************************************06970000
069800*SOCKET COMMANDS CODES NEED FOR THE TCP/IP SOCKET CALLS-EZASOKET *06980000
069900******************************************************************06990000
070000     COPY DPWS081.                                                07000000
070100                                                                  07010000
070200******************************************************************07020000
070300*  RECORD LAYOUT FOR THE ON-LINE TICKETING SYSTEM DATA STREAM     07030000
070400*  TO DRS (DYNAMIC REPORT SYSTEM)                                 07040000
070500******************************************************************07050000
070600     COPY MPRD049.                                                07060001
070900                                                                  07090000
071000******************************************************************07100000
071100*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            07110000
071200******************************************************************07120000
071300     COPY DRRD003.                                                07130000
071400                                                                  07140000
071500******************************************************************07150000
071600*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES        07160000
071700******************************************************************07170000
071800     COPY DRRD004.                                                07180000
071900                                                                  07190000
072000                                                                  07200000
072100******************************************************************07210000
072200*    PARAMETER LIST FOR CICS API                                  07220000
072300******************************************************************07230000
072400     COPY DPWS030.                                                07240000
072410     COPY DPWS930.                                                07241034
072500                                                                  07250000
072600******************************************************************07260000
072700*    GLOBAL COMMUNICATION AREA                                    07270000
072800******************************************************************07280000
072900     COPY DPWS020.                                                07290000
073000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                07300000
073100                                                                  07310000
073200******************************************************************07320000
073300*    INTER-APPLICATION COMMUNICATION AREA                         07330000
073400*    RCWS015 = INPUT FROM PACK SLIP HEADER MAINTENANCE PROGRAM    07340000
073500******************************************************************07350000
073600         10  INTER-APPL-COMM-AREA       PIC X(200).               07360000
073700     COPY PCWS000.                                                07370000
073800     COPY POWS017.                                                07380000
073900                                                                  07390000
074000******************************************************************07400000
074100*    APPLICATION SPECIFIC COMMUNICATION AREA                      07410000
074200******************************************************************07420000
074300         10  ASC-SPECIFIC-COMMAREA.                               07430000
074400             15  ASC-LIST-HEADER-INFO.                            07440000
074500                 20  ASC-KEY-OPER-UNT-ID        PIC S9(4) COMP.   07450000
074600                 20  ASC-KEY-FCLTY-ID           PIC S9(4) COMP.   07460000
074700                 20  ASC-KEY-FCLTY-DESC         PIC  X(30).       07470000
074800                 20  ASC-KEY-PO-NBR.                              07480000
074900                     25  ASC-KEY-PO-NBR-N       PIC  9(08).       07490000
075000                 20  ASC-KEY-REC-SEQ-NBR        PIC S9(9).        07500000
075100                 20  ASC-KEY-LINE-NBR           PIC S9(4) COMP.   07510000
075200                 20  ASC-DEPT-NBR.                                07520003
075210                     25  ASC-DEPT-NBR-N         PIC 9(03).        07521003
075300                 20  ASC-KEY-VENDOR-NAME        PIC  X(30).       07530000
075400                 20  ASC-SPECIAL-INSTUCTIONS    PIC  X(30).       07540000
075500                 20  ASC-PRINTER                PIC  X(06).       07550000
075600                 20  ASC-TKT-OFFICE             PIC  X(06).       07560000
075700                 20  ASC-TKT-FORMAT             PIC  X(06).       07570000
075800*DH              20  ASC-SEASON-CDE             PIC  X(03).       07580000
075900                 20  ASC-EXTRA-TKTS             PIC  X(03).       07590000
076000                 20  ASC-EXTRA-TKTS-N REDEFINES ASC-EXTRA-TKTS    07600000
076100                                                PIC  9(03).       07610000
076200                 20  ASC-EXTRA-TKT-PCT          PIC  X(03).       07620000
076300                 20  ASC-EXTRA-TKT-PCT-N REDEFINES                07630000
076400                     ASC-EXTRA-TKT-PCT          PIC  9(03).       07640000
076500                 20  ASC-OPT-BLOCK              PIC  X(04).       07650000
076600                 20  ASC-STICKER-NBR            PIC  9(05).       07660000
076700                 20  ASC-VER-NBR                PIC  9(09).       07670000
076800                 20  ASC-SAVE-TKT-FORMAT        PIC  X(06).       07680000
076900                 20  ASC-INT-APPL-FORMAT        PIC  X(01).       07690000
077000                     88 ASC-WORK-ORDER-REC-LIST VALUE '2'.        07700000
077100                 20  ASC-DISPLAY-SIZE           PIC  X(01).       07710000
077200                 20  ASC-DISPLAY-COLOR          PIC  X(01).       07720000
077300                 20  ASC-DISPLAY-OPT-BLK        PIC  X(01).       07730000
077400             15  ASC-BLOCK-ENTRIES  OCCURS 2 TIMES.               07740000
077500                 20  ASC-BLOCK-MODIFIED-SW           PIC X.       07750000
077600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   07760000
077700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   07770000
077800                                                                  07780000
077900                 20  ASC-ITEM-ARRAY.                              07790000
078000                     25  ASC-ITEM-ENTRIES  OCCURS 9 TIMES.        07800000
078100                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    07810000
078200                                                     COMP-3.      07820000
078300                         30  ASC-TEMP-SELECTED-SW    PIC X.       07830000
078400                             88  ASC-VALID-SELECT    VALUE ' '    07840000
078500                                                           'S'    07850000
078600                                                           'B'    07860000
078700                                                           'E'.   07870000
078800                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   07880000
078900                             88  ASC-TEMP-SELECT     VALUE 'S'.   07890000
079000                             88  ASC-TEMP-BEGIN      VALUE 'B'.   07900000
079100                             88  ASC-TEMP-END        VALUE 'E'.   07910000
079200                         30  ASC-SELECTED-SW         PIC  X.      07920000
079300                             88  ASC-NO-SELECT       VALUE ' '.   07930000
079400                             88  ASC-SELECT          VALUE 'S'.   07940000
079500                             88  ASC-BEGIN           VALUE 'B'.   07950000
079600                             88  ASC-END             VALUE 'E'.   07960000
079700                         30  ASC-PO-LNE-NBR          PIC  9(09).  07970000
079800                         30  ASC-UNT-QTY             PIC  X(05).  07980000
079900                         30  ASC-UNT-QTY-N REDEFINES ASC-UNT-QTY  07990000
080000                                                     PIC  9(05).  08000000
080100                         30  ASC-ITM-NBR             PIC S9(15)V  08010000
080200                                                         COMP-3.  08020000
080300                         30  ASC-MAJOR-CLASS-X.                   08030000
080400                             35  ASC-MAJOR-CLASS     PIC  9(02).  08040000
080500                         30  ASC-SUB-CLASS-X.                     08050000
080600                             35  ASC-SUB-CLASS       PIC  9(02).  08060000
080700                         30  ASC-UPC-X.                           08070000
080800                             35  ASC-UPC             PIC  9(13).  08080000
080900                         30  ASC-VEND-STYL           PIC  X(20).  08090000
081000                         30  ASC-SIZE                PIC  X(10).  08100000
081100                         30  ASC-TABLE-SIZE          PIC  X(10).  08110000
081200                         30  ASC-COLOR               PIC  X(10).  08120000
081300                         30  ASC-TABLE-COLOR         PIC  X(10).  08130000
081400                         30  ASC-UNT-RTL-PR          PIC 9(06)V99.08140000
081500                         30  ASC-GP-RTL-QTY          PIC 9(01).   08150000
081600                         30  ASC-GP-RTL              PIC 9(02)V99.08160000
081700                         30  ASC-OPT-BLK             PIC  X(03).  08170000
081800             15  ASC-BLK-SUB                         PIC S9(4)    08180000
081900                                                     COMP SYNC.   08190000
082000             15  ASC-ITEM-SUB                        PIC S9(4)    08200000
082100                                                     COMP SYNC.   08210000
082200             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(9)    08220000
082300                                                     COMP-3.      08230000
082400             15  ASC-ITEMS-DISPLAYED                 PIC S999     08240000
082500                                                     COMP-3.      08250000
082600             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(9)    08260000
082700                                                     COMP-3.      08270000
082800             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(9)    08280000
082900                                                     COMP-3.      08290000
083000             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(4)    08300000
083100                                                     COMP SYNC.   08310000
083200             15  ASC-START-OF-SELECTED-RANGE         PIC S9(9)    08320000
083300                                                     COMP-3.      08330000
083400             15  ASC-END-OF-SELECTED-RANGE           PIC S9(9)    08340000
083500                                                     COMP-3.      08350000
083600             15  ASC-ITEMS-LEFT-INDICATOR                         08360000
083700                                        PIC X(01).                08370000
083800                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     08380000
083900                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     08390000
084000             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       08400000
084100                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   08410000
084200                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   08420000
084300             15  ASC-LIST-QUEUE-NAME.                             08430000
084400                 20  ASC-LIST-TERM-ID                PIC X(4).    08440000
084500                 20  ASC-LIST-TASK-NUMBER            PIC S9(5)    08450000
084600                                                     COMP-3.      08460000
084700                 20  ASC-LIST-SEQ                    PIC 9.       08470000
084800             15  ASC-SEL-QUEUE-NAME.                              08480000
084900                 20  ASC-SEL-TERM-ID                 PIC X(4).    08490000
085000                 20  ASC-SEL-TASK-NUMBER             PIC S9(5)    08500000
085100                                                     COMP-3.      08510000
085200                 20  ASC-SEL-SEQ                     PIC 9.       08520000
085300             15  ASC-START-ITEM-REQUEST.                          08530000
085400                 20  ASC-START-ITEM-REQUEST-N        PIC 9(7).    08540000
085500             15  ASC-PURITM-VER-NBR                  PIC S9(9)    08550000
085600                                                     COMP.        08560000
085700             15  ASC-CURSOR-SW                       PIC X(01).   08570000
085800                 88  ASC-PO-CURSOR                   VALUE 'P'.   08580000
085900                 88  ASC-REC-CURSOR                  VALUE 'R'.   08590000
086000                 88  ASC-LINE-CURSOR                 VALUE 'L'.   08600000
086100             15  ASC-USE-SELECTION-QUEUE-IND                      08610000
086200                                        PIC  X(01).               08620000
086300                 88  ASC-USE-SELECTION-QUEUE        VALUE 'Y'.    08630000
086400             15  ASC-SEL-QUEUE-NAME-IN  PIC  X(08).               08640000
086500             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05)  COMP-3.       08650000
086600             15  ASC-NUMBER-OF-SELECTED-ITEMS                     08660000
086700                                        PIC S9(09)  COMP-3.       08670000
086800             15  ASC-SEL-SUB            PIC S9(04)  COMP.         08680000
086900             15  ASC-SEL-ITEM           PIC S9(04)  COMP.         08690000
087000             15  ASC-HOLD-INTER-APPL                 PIC X(200).  08700000
087100                                                                  08710000
087200******************************************************************08720000
087300*    ABEND PROCESSING                                             08730000
087400******************************************************************08740000
087500     COPY DPWS013.                                                08750000
087600                                                                  08760000
087700******************************************************************08770000
087800*    DB2 SQL COMMUNICATION AREA                                   08780000
087900******************************************************************08790000
088000     EXEC SQL                                                     08800000
088100          INCLUDE SQLCA                                           08810000
088200     END-EXEC.                                                    08820000
088300                                                                  08830000
088400******************************************************************08840000
088500*    DB2 DCLGEN FOR RECEIVER TABLE                                08850000
088600******************************************************************08860000
088700     EXEC SQL                                                     08870000
088800          INCLUDE TRECEIV                                         08880000
088900     END-EXEC.                                                    08890000
089000                                                                  08900000
089100******************************************************************08910000
089200*    DB2 DCLGEN FOR RECEIPT ITEM TABLE                            08920000
089300******************************************************************08930000
089400     EXEC SQL                                                     08940000
089500          INCLUDE TRECITM                                         08950000
089600     END-EXEC.                                                    08960000
089700                                                                  08970000
089800******************************************************************08980000
089900*    DB2 DCLGEN FOR RECEIPT DISTRIBUTION TABLE                    08990000
090000******************************************************************09000000
090100     EXEC SQL                                                     09010000
090200          INCLUDE TRECDIS                                         09020000
090300     END-EXEC.                                                    09030000
090400                                                                  09040000
090500******************************************************************09050000
090600*    DB2 DCLGEN FOR PURCHASE ORDER ITEM TABLE                     09060000
090700******************************************************************09070000
090800     EXEC SQL                                                     09080000
090900          INCLUDE TPURITM                                         09090000
091000     END-EXEC.                                                    09100000
091100                                                                  09110000
091200******************************************************************09120000
091300*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          09130000
091400******************************************************************09140000
091500     EXEC SQL                                                     09150000
091600          INCLUDE TPURCHS                                         09160000
091700     END-EXEC.                                                    09170000
091800                                                                  09180000
091900*                                                                 09190000
092000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LOCATION DOMAIN    09200000
092100*  TABLE.                                                         09210000
092200*                                                                 09220000
092300     EXEC SQL                                                     09230000
092400          INCLUDE XLT00010                                        09240000
092500     END-EXEC.                                                    09250000
092600                                                                  09260000
092700******************************************************************09270000
092800*    DB2 DCLGEN FOR MERCHANDISE STORE DISTRIBUTION PLAN TABLE     09280000
092900******************************************************************09290000
093000     EXEC SQL                                                     09300000
093100          INCLUDE TMESTDS                                         09310000
093200     END-EXEC.                                                    09320000
093300                                                                  09330000
093400******************************************************************09340000
093500*    DB2 DCLGEN FOR TICKET FORMAT TABLE                           09350000
093600******************************************************************09360000
093700     EXEC SQL                                                     09370000
093800          INCLUDE TTKTFMT                                         09380000
093900     END-EXEC.                                                    09390000
094000                                                                  09400000
094100                                                                  09410000
094200******************************************************************09420000
094300*    DB2 DCLGEN FOR PRINT STOCK TABLE                             09430000
094400******************************************************************09440000
094500     EXEC SQL                                                     09450000
094600          INCLUDE TPRTSTK                                         09460000
094700     END-EXEC.                                                    09470000
094800                                                                  09480000
094900                                                                  09490000
095000******************************************************************09500000
095100*    DB2 DCLGEN FOR THE STATUS CODE TABLE                         09510000
095200******************************************************************09520000
095300     EXEC SQL                                                     09530000
095400          INCLUDE TSTATCD                                         09540000
095500     END-EXEC.                                                    09550000
095600                                                                  09560000
095700******************************************************************09570000
095800*    DB2 DCLGEN FOR VENDOR ENTERPRISE NAME TABLE                  09580000
095900******************************************************************09590000
096000     EXEC SQL                                                     09600000
096100          INCLUDE TENTNME                                         09610000
096200     END-EXEC.                                                    09620000
096300                                                                  09630000
096400******************************************************************09640000
096500*    DB2 DCLGEN FOR THE PO PURCHASE INSTRUCTION                   09650000
096600******************************************************************09660000
096700     EXEC SQL                                                     09670000
096800          INCLUDE TPOINST                                         09680000
096900     END-EXEC.                                                    09690000
097000                                                                  09700000
097100******************************************************************09710000
097200*    DB2 DCLGEN FOR THE PO INSTRUCTION CODES                      09720000
097300******************************************************************09730000
097400     EXEC SQL                                                     09740000
097500          INCLUDE TINSTCD                                         09750000
097600     END-EXEC.                                                    09760000
097700                                                                  09770000
097800******************************************************************09780000
097900*    DB2 DCLGEN FOR THE XL-SKU DOMAIN TABLE                       09790000
098000******************************************************************09800000
098100     EXEC SQL                                                     09810000
098200          INCLUDE XLT00003                                        09820000
098300     END-EXEC.                                                    09830000
098400                                                                  09840000
098500******************************************************************09850000
098600*    DB2 DCLGEN FOR THE XL-VENDOR STYLE DOMAIN TABLE              09860000
098700******************************************************************09870000
098800     EXEC SQL                                                     09880000
098900          INCLUDE XLT00004                                        09890000
099000     END-EXEC.                                                    09900000
099100                                                                  09910000
099200******************************************************************09920000
099300*    DB2 DCLGEN FOR THE XLT-UPC TABLE                             09930000
099400******************************************************************09940000
099500     EXEC SQL                                                     09950000
099600          INCLUDE XLT00006                                        09960000
099700     END-EXEC.                                                    09970000
099800                                                                  09980000
099900******************************************************************09990000
100000*    DB2 DCLGEN FOR THE KOHLS PROCESSING FUNCTION CODE TABLE      10000000
100100******************************************************************10010000
100200     EXEC SQL                                                     10020000
100300          INCLUDE TKRPRCD                                         10030000
100400     END-EXEC.                                                    10040000
100500                                                                  10050000
100600******************************************************************10060000
100700*    DB2 DCLGEN FOR THE KOHLS PROCESSING PARAMETERS TABLE         10070000
100800******************************************************************10080000
100900     EXEC SQL                                                     10090000
101000          INCLUDE TKRPRPM                                         10100000
101100     END-EXEC.                                                    10110000
101200                                                                  10120000
101201*    XLT_MAJ_CL                                                   10120133
101202     EXEC SQL                                                     10120200
101203          INCLUDE XLT00022                                        10120300
101204     END-EXEC.                                                    10120400
101205                                                                  10120500
101300******************************************************************10130000
101400*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PURCHASE ORDER ITEMS  10140000
101500******************************************************************10150000
101600     EXEC SQL                                                     10160000
101700          DECLARE PURITM-CURSOR CURSOR FOR                        10170000
101800           SELECT B.CL_NBR,                                       10180000
101900                  B.GP_QTY,                                       10190000
102000                  B.GP_RTL_AMT,                                   10200000
102100                  B.UNT_RTL_PR_AMT,                               10210000
102200                  B.UNT_QTY,                                      10220000
102300                  B.ITM_NBR,                                      10230000
102400                  B.VEND_STYL_NAME,                               10240000
102500                  B.COLOR_DESC,                                   10250000
102600                  B.SIZE_DESC,                                    10260000
102700                  B.APP_PO_LNE_NBR                                10270000
102800             FROM TPURCHS      A,                                 10280000
102900                  TPURITM      B,                                 10290000
103000                  TSTATCD      C                                  10300000
103100            WHERE A.PO_NBR         = :DK-PO-NBR                   10310000
103200              AND A.PO_NBR         = B.PO_NBR                     10320000
103300              AND A.VER_STATUS_CDE = 'A'                          10330000
103400              AND B.VER_STATUS_CDE = 'A'                          10340000
103500              AND C.STATUS_TYP_CDE = 'P'                          10350000
103600              AND C.STATUS_CLS     = 'ACT'                        10360000
103700              AND C.STATUS_CDE     = B.STATUS_CDE                 10370000
103800         ORDER BY APP_PO_LNE_NBR                                  10380000
103900     END-EXEC.                                                    10390000
104000                                                                  10400000
104100******************************************************************10410000
104200*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF RECEIPT ITEMS         10420000
104300******************************************************************10430000
104400     EXEC SQL                                                     10440000
104500          DECLARE RECITM-CURSOR CURSOR FOR                        10450000
104600           SELECT B.CL_NBR,                                       10460000
104700                  B.GP_QTY,                                       10470000
104800                  B.GP_RTL_AMT,                                   10480000
104900                  B.UNT_RTL_PR_AMT,                               10490000
105000                  B.ITM_NBR,                                      10500000
105100                  B.VEND_STYL_NAME,                               10510000
105200                  B.COLOR_DESC,                                   10520000
105300                  B.SIZE_DESC,                                    10530000
105400                  B.APP_PO_LNE_NBR,                               10540000
105500                  C.DTL_CK_ITM_QTY,                               10550000
105600                  C.PKSL_ITM_QTY                                  10560000
105700             FROM TRECEIV      A,                                 10570000
105800                  TPURITM      B,                                 10580000
105900                  TRECITM      C                                  10590000
106000            WHERE A.OPER_UNT_ID    = :DK-OPER-UNT-ID              10600000
106100              AND A.ORD_NBR        = :DK-PO-NBR                   10610000
106200              AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR              10620000
106300              AND A.ORD_NBR        = B.PO_NBR                     10630000
106400              AND A.VER_STATUS_CDE = 'A'                          10640000
106500              AND A.OPER_UNT_ID    = C.OPER_UNT_ID                10650000
106600              AND A.FCLTY_ID       = C.FCLTY_ID                   10660000
106700              AND C.VER_STATUS_CDE = 'A'                          10670000
106800              AND A.ORD_NBR        = C.ORD_NBR                    10680000
106900              AND A.REC_SEQ_NBR    = C.REC_SEQ_NBR                10690000
107000              AND B.APP_PO_LNE_NBR = C.ORD_LNE_NBR                10700000
107100              AND B.VER_NBR        = C.PO_VER_NBR                 10710000
107200         ORDER BY APP_PO_LNE_NBR                                  10720000
107300     END-EXEC.                                                    10730000
107400                                                                  10740000
107500******************************************************************10750000
107600*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF RECEIPT LINE          10760000
107700******************************************************************10770000
107800     EXEC SQL                                                     10780000
107900          DECLARE RECLNE-CURSOR CURSOR FOR                        10790000
108000           SELECT B.CL_NBR,                                       10800000
108100                  B.GP_QTY,                                       10810000
108200                  B.GP_RTL_AMT,                                   10820000
108300                  B.UNT_RTL_PR_AMT,                               10830000
108400                  B.ITM_NBR,                                      10840000
108500                  B.VEND_STYL_NAME,                               10850000
108600                  B.COLOR_DESC,                                   10860000
108700                  B.SIZE_DESC,                                    10870000
108800                  B.APP_PO_LNE_NBR                                10880000
108900             FROM TRECITM      A,                                 10890000
109000                  TPURITM      B                                  10900000
109100            WHERE A.OPER_UNT_ID    = :DK-OPER-UNT-ID              10910000
109200              AND A.ORD_NBR        = :DK-PO-NBR                   10920000
109300              AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR              10930000
109400              AND A.ORD_NBR        = B.PO_NBR                     10940000
109500              AND A.PO_VER_NBR     = B.VER_NBR                    10950000
109600              AND A.ORD_LNE_NBR    = :DK-LINE-NBR                 10960000
109700              AND A.ORD_LNE_NBR    = B.APP_PO_LNE_NBR             10970000
109800              AND A.VER_STATUS_CDE = 'A'                          10980000
109900         ORDER BY APP_PO_LNE_NBR                                  10990000
110000     END-EXEC.                                                    11000000
110100                                                                  11010000
110200                                                                  11020000
110300 LINKAGE SECTION.                                                 11030000
110400                                                                  11040000
110500 01  DFHCOMMAREA.                                                 11050000
110600     05  FILLER                       OCCURS 1 TO 4072 TIMES      11060000
110700                                      DEPENDING ON EIBCALEN.      11070000
110800         10  FILLER                   PIC X.                      11080000
110900                                                                  11090000
111000                                                                  11100000
111100 PROCEDURE DIVISION.                                              11110000
111200                                                                  11120000
111300 0000-MAIN-MODULE.                                                11130000
111400                                                                  11140000
111500     INITIALIZE DP030-CICS-API-FIELDS.                            11150000
111600                                                                  11160000
111700     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         11170000
111800     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            11180000
111900     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           11190000
112000     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         11200000
112100     MOVE LENGTH OF RC254AI      TO DP030-MAP-LENGTH (1).         11210000
112200     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       11220000
112300     SET DP030-OVERRIDE-APPL-ERROR                                11230000
112400                                 TO TRUE.                         11240000
112500                                                                  11250000
112600     PERFORM 0001-CALL-CICS-ARCH-API.                             11260000
112700                                                                  11270000
112800     PERFORM 1000-CONTROL-PROCESSING.                             11280000
112900                                                                  11290000
113000     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       11300000
113100                                                                  11310000
113200     PERFORM 0001-CALL-CICS-ARCH-API.                             11320000
113300                                                                  11330000
113400 0001-CALL-CICS-ARCH-API.                                         11340000
113500                                                                  11350000
113610     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      11361034
113700                                    DFHCOMMAREA                   11370034
113800                                    DP030-CICS-API-FIELDS         11380034
113900                                    DP020-STANDARD-COMMAREA       11390034
114000                                    RC254AI.                      11400034
114100                                                                  11410000
114200     IF DP030-RC-CALL-SUCCESSFUL OR                               11420000
114300        DP030-RC-APPL-ERROR                                       11430000
114400         CONTINUE                                                 11440000
114500     ELSE                                                         11450000
114600         SET DP013-CICS-ABEND                                     11460000
114700             DP013-NO-ROLLBACK                                    11470000
114800             DP013-XCTL-DISPLAY-RESTART                           11480000
114900                                 TO TRUE                          11490000
115000         MOVE '0001-CALL-CICS-ARCH-API'                           11500000
115100                                 TO DP013-PARAGRAPH               11510000
115120         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O11512034
115130-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      11513034
115400         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        11540000
115500                                                                  11550000
115600         PERFORM DP013-0000-PROCESS-ABEND.                        11560000
115700                                                                  11570000
115800 1000-CONTROL-PROCESSING.                                         11580000
115900                                                                  11590000
116000     EVALUATE TRUE                                                11600000
116100                                                                  11610000
116200         WHEN DP030-RC-APPL-ERROR                                 11620000
116300              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       11630000
116400                                 TO PV-TOP-ITEM                   11640000
116500              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      11650000
116600                                                                  11660000
116700              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                11670000
116800                                                                  11680000
116900              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  11690000
117000                                                                  11700000
117100              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                11710000
117200                                                                  11720000
117300                                                                  11730000
117400         WHEN DP020-NEXT-ACT-INITIAL                              11740000
117500              INITIALIZE ASC-SPECIFIC-COMMAREA                    11750000
117600              MOVE EIBTRMID      TO ASC-LIST-TERM-ID              11760000
117700                                    ASC-SEL-TERM-ID               11770000
117800              MOVE DP020-SRC-TASK-NUMBER                          11780000
117900                                 TO ASC-LIST-TASK-NUMBER          11790000
118000                                    ASC-SEL-TASK-NUMBER           11800000
118100              MOVE PC-LIST-QUEUE-SEQ                              11810000
118200                                 TO ASC-LIST-SEQ                  11820000
118300              MOVE PC-SEL-QUEUE-SEQ                               11830000
118400                                 TO ASC-SEL-SEQ                   11840000
118500              SET PS-NO-ERROR    TO TRUE                          11850000
118600                                                                  11860000
118700              PERFORM 1100-PROCESS-INTER-APPL-COMM                11870000
118800                                                                  11880000
118900              IF  PS-COMMAREA-NOT-VALID                           11890000
119000                  SET DP020-MSG-FATAL                             11900000
119100                      DP020-NEXT-ACT-APPL-ERROR                   11910000
119200                                    TO TRUE                       11920000
119300              ELSE                                                11930000
119400                  MOVE INTER-APPL-COMM-AREA                       11940000
119500                                 TO ASC-HOLD-INTER-APPL           11950000
119600                  PERFORM 4000-BUILD-INITIAL-PANEL                11960000
119700              END-IF                                              11970000
119800                                                                  11980000
119900                                                                  11990000
120000         WHEN DP020-NEXT-ACT-READ-MAP                             12000000
120100              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       12010000
120200                                 TO PV-TOP-ITEM                   12020000
120300                                                                  12030000
120400              PERFORM 2000-PROCESS-PANEL                          12040000
120500                                                                  12050000
120600                                                                  12060000
120700         WHEN DP020-NEXT-ACT-RETURN                               12070000
120800              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       12080000
120900                                 TO PV-TOP-ITEM                   12090000
121000              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      12100000
121100              MOVE ASC-HOLD-INTER-APPL                            12110000
121200                                 TO INTER-APPL-COMM-AREA          12120000
121300                                                                  12130000
121400                                                                  12140000
121500              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  12150000
121600                                                                  12160000
121700              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                12170000
121800                                                                  12180000
121900                                                                  12190000
122000         WHEN OTHER                                               12200000
122100              SET DP013-LOGIC-ABEND                               12210000
122200                  DP013-NO-ROLLBACK                               12220000
122300                                 TO TRUE                          12230000
122400              MOVE '1000-CONTROL-PROCESSING'                      12240000
122500                                 TO DP013-PARAGRAPH               12250000
122600              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   12260000
122700                                 TO DP013-MESSAGE-TEXT(1)         12270000
122800                                                                  12280000
122900              PERFORM DP013-0000-PROCESS-ABEND                    12290000
123000                                                                  12300000
123100     END-EVALUATE.                                                12310000
123200                                                                  12320000
123300 1100-PROCESS-INTER-APPL-COMM.                                    12330000
123400                                                                  12340000
123500     SET PS-COMMAREA-VALID       TO TRUE.                         12350000
123600     MOVE SPACE                  TO ASC-START-ITEM-REQUEST.       12360000
123700     MOVE PC000-INTER-APPL-FORMAT-CODE                            12370000
123800                                 TO ASC-INT-APPL-FORMAT.          12380000
123900     EVALUATE PC000-INTER-APPL-FORMAT-CODE                        12390000
124000         WHEN PC-INTER-APPL-CRIT-SPEC                             12400000
124100         WHEN PC-INTER-APPL-TKT-MENU                              12410000
124200         WHEN PC-INTER-APPL-RCV-ITM-LST                           12420000
124300             PERFORM 1200-ESTABLISH-ASC-AREA                      12430000
124400                                                                  12440000
124500         WHEN PC-INTER-APPL-WO-REC-LIST                           12450000
124600             PERFORM 1200-ESTABLISH-ASC-AREA                      12460000
124700             SET ASC-USE-SELECTION-QUEUE                          12470000
124800                                  TO TRUE                         12480000
124900             MOVE PC000-NUMBER-OF-SELECTED-ITEMS                  12490000
125000                                  TO ASC-NUMBER-OF-SELECTED-ITEMS 12500000
125100             MOVE PC000-NUMBER-OF-TS-ITEMS                        12510000
125200                                  TO ASC-NUMBER-OF-TS-ITEMS       12520000
125300             MOVE PC000-SEL-QUEUE-NAME                            12530000
125400                                  TO ASC-SEL-QUEUE-NAME-IN        12540000
125500             PERFORM 1120-PREPARE-LIST-ENTRY                      12550000
125600                                                                  12560000
125700     END-EVALUATE.                                                12570000
125800                                                                  12580000
125900*----------------------------------------------------------------*12590000
126000*  ENTRY IS FROM A LIST. GET THE KEYS FROM THE TEMP STORAGE      *12600000
126100*  QUEUE PASSED FROM THE LIST.                                   *12610000
126200*----------------------------------------------------------------*12620000
126300                                                                  12630000
126400 1120-PREPARE-LIST-ENTRY.                                         12640000
126500      MOVE PC016-MAX-ITEMS         TO ASC-SEL-SUB.                12650000
126600      MOVE ZERO                    TO ASC-SEL-ITEM.               12660000
126700                                                                  12670000
126800 1200-ESTABLISH-ASC-AREA.                                         12680000
126900     MOVE PC000-OPERATING-UNIT-ID  TO ASC-KEY-OPER-UNT-ID.        12690000
127000     MOVE PC000-FACILITY-ID        TO ASC-KEY-FCLTY-ID.           12700000
127100     MOVE PC000-PO-NBR-N           TO ASC-KEY-PO-NBR-N.           12710000
127200     MOVE ASC-KEY-PO-NBR-N         TO DK-PO-NBR.                  12720000
127300     MOVE PC000-REC-SEQ-NBR-N      TO ASC-KEY-REC-SEQ-NBR         12730000
127400                                      DK-REC-SEQ-NBR.             12740000
127500     MOVE PC000-LINE-NBR-N         TO ASC-KEY-LINE-NBR.           12750000
127600     MOVE PC000-TKT-FORMAT         TO ASC-TKT-FORMAT.             12760000
127700     MOVE 'N'                      TO ASC-DISPLAY-SIZE.           12770000
127800     MOVE 'N'                      TO ASC-DISPLAY-COLOR.          12780000
127900     MOVE 'N'                      TO ASC-DISPLAY-OPT-BLK.        12790000
128000     PERFORM 4330-VALIDATE-PO.                                    12800000
128100     IF PS-PO-NOT-FOUND                                           12810000
128200         MOVE PC-TSYMSG-00083      TO DP020-MSG-NUMBER            12820000
128300         SET PS-ERROR                                             12830000
128400             PS-COMMAREA-NOT-VALID                                12840000
128500             DP020-MSG-FATAL   TO TRUE                            12850000
128600     ELSE                                                         12860000
128700         MOVE PURCHS-DEPT-NBR      TO ASC-DEPT-NBR                12870000
128800         MOVE PURCHS-ENT-ID        TO DK-ENT-ID                   12880000
128900         MOVE PURCHS-VER-NBR       TO ASC-VER-NBR                 12890000
129000         PERFORM 4340-GET-VENDOR-NAME                             12900000
129100     END-IF.                                                      12910000
129200                                                                  12920000
129300 2000-PROCESS-PANEL.                                              12930000
129400                                                                  12940000
129500     EVALUATE TRUE                                                12950000
129600                                                                  12960000
129700         WHEN DP020-SRC-AID = DP016-CLEAR                         12970000
129800              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      12980000
129900                                                                  12990000
130000              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  13000000
130100                                                                  13010000
130200              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                13020000
130300                                                                  13030000
130400                                                                  13040000
130500         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    13050000
130600                                                                  13060000
130700              PERFORM 2050-DELETE-LIST-QUEUE                      13070000
130800              EVALUATE PC000-INTER-APPL-FORMAT-CODE               13080000
130900                  WHEN PC-INTER-APPL-CRIT-SPEC                    13090000
131000                      PERFORM 1200-ESTABLISH-ASC-AREA             13100000
131100                                                                  13110000
131200                  WHEN PC-INTER-APPL-WO-REC-LIST                  13120000
131300                      PERFORM 1200-ESTABLISH-ASC-AREA             13130000
131400                      SET ASC-USE-SELECTION-QUEUE                 13140000
131500                                           TO TRUE                13150000
131600                      MOVE PC000-NUMBER-OF-SELECTED-ITEMS         13160000
131700                                  TO ASC-NUMBER-OF-SELECTED-ITEMS 13170000
131800                      MOVE PC000-NUMBER-OF-TS-ITEMS               13180000
131900                                  TO ASC-NUMBER-OF-TS-ITEMS       13190000
132000                      MOVE PC000-SEL-QUEUE-NAME                   13200000
132100                                  TO ASC-SEL-QUEUE-NAME-IN        13210000
132200                      PERFORM 1120-PREPARE-LIST-ENTRY             13220000
132300                                                                  13230000
132400              END-EVALUATE                                        13240000
132500                                                                  13250000
132600              PERFORM 4000-BUILD-INITIAL-PANEL                    13260000
132700                                                                  13270000
132800                                                                  13280000
132900         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   13290000
133000                                                                  13300000
133100              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                13310000
133200                                                                  13320000
133300              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  13330000
133400                                                                  13340000
133500              PERFORM 2140-DESELECT-ALL-ITEMS                     13350000
133600                                                                  13360000
133700              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                13370000
133800                                                                  13380000
133900                                                                  13390000
134000         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 13400000
134100                                                                  13410000
134200              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                13420000
134300                                                                  13430000
134400              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  13440000
134500                                                                  13450000
134600              PERFORM 2150-SELECT-ALL-ITEMS                       13460000
134700                                                                  13470000
134800              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                13480000
134900                                                                  13490000
135000                                                                  13500000
135100                                                                  13510000
135200         WHEN OTHER                                               13520000
135300                                                                  13530000
135400              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                13540000
135500                                                                  13550000
135600              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  13560000
135700                                                                  13570000
135800              IF PS-NO-ERROR                                      13580000
135900                  SET DP030-CONTINUE-GO                           13590000
136000                                 TO TRUE                          13600000
136100                                                                  13610000
136200                  PERFORM 2100-CHECK-FUNCTION-KEY                 13620000
136300                                                                  13630000
136400              ELSE                                                13640000
136500                  SET DP030-OVERRIDE-GO                           13650000
136600                                 TO TRUE                          13660000
136700              END-IF                                              13670000
136800                                                                  13680000
136900     END-EVALUATE.                                                13690000
137000                                                                  13700000
137100 2050-DELETE-LIST-QUEUE.                                          13710000
137200                                                                  13720000
137300     EXEC CICS DELETEQ TS QUEUE (ASC-LIST-QUEUE-NAME)             13730000
137400                          RESP  (PV-CICS-RESP)                    13740000
137500                          END-EXEC.                               13750000
137600                                                                  13760000
137700     IF (PV-CICS-RESP = DFHRESP (NORMAL)) OR                      13770000
137800        (PV-CICS-RESP = DFHRESP (QIDERR))                         13780000
137900         CONTINUE                                                 13790000
138000     ELSE                                                         13800000
138100         SET DP013-CICS-ABEND                                     13810000
138200             DP013-NO-ROLLBACK   TO TRUE                          13820000
138300         MOVE '2050-DELETE-LIST-QUEUE'                            13830000
138400                                 TO DP013-PARAGRAPH               13840000
138500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE DELETE' 13850000
138600                                 TO DP013-MESSAGE-TEXT (1)        13860000
138700                                                                  13870000
138800         PERFORM DP013-0000-PROCESS-ABEND                         13880000
138900     END-IF.                                                      13890000
139000                                                                  13900000
139100     MOVE ZERO                   TO ASC-HIGHEST-BLOCK-WRITTEN.    13910000
139200                                                                  13920000
139300 2100-CHECK-FUNCTION-KEY.                                         13930000
139400                                                                  13940000
139500     EVALUATE TRUE                                                13950000
139600         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 13960000
139700              INITIALIZE PO017-INTER-APPL-COMMAREA                13970000
139800              MOVE ASC-KEY-PO-NBR-N                               13980000
139900                                 TO PO017-PO-NBR                  13990000
140000                                                                  14000000
140100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              14010000
140200              IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              14020000
140300                  MOVE +1                   TO ASC-BLK-SUB        14030000
140400                  PERFORM 5100-WRITE-TEMP-STORAGE                 14040000
140500                  ADD +1                    TO ASC-BLK-SUB        14050000
140600                  PERFORM 5100-WRITE-TEMP-STORAGE                 14060000
140700                                                                  14070000
140800                  PERFORM 4500-PROCESS-TICKET-REQ                 14080000
140900              ELSE                                                14090000
141000                  IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO          14100000
141100                      SET ASC-NO-TSQ-UPDATE                       14110000
141200                                 TO TRUE                          14120000
141300                      SET DP030-OVERRIDE-GO                       14130000
141400                          DP020-MSG-WARNING                       14140000
141500                                 TO TRUE                          14150000
141600                      MOVE PC-TSYMSG-00057                        14160000
141700                                 TO DP020-MSG-NUMBER              14170000
141800                  END-IF                                          14180000
141900              END-IF                                              14190000
142000                                                                  14200000
142100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              14210000
142200             IF ASC-DISPLAY-SIZE = 'N'                            14220000
142300                 MOVE 'Y' TO ASC-DISPLAY-SIZE                     14230000
142400             ELSE                                                 14240000
142500                 MOVE 'N' TO ASC-DISPLAY-SIZE                     14250000
142600             END-IF                                               14260000
142700             MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL       14270000
142800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14280000
142900                                                                  14290000
143000         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              14300000
143100             IF ASC-DISPLAY-COLOR = 'N'                           14310000
143200                 MOVE 'Y' TO ASC-DISPLAY-COLOR                    14320000
143300             ELSE                                                 14330000
143400                 MOVE 'N' TO ASC-DISPLAY-COLOR                    14340000
143500             END-IF                                               14350000
143600             MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL       14360000
143700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14370000
143800                                                                  14380000
143900         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              14390000
144000             IF ASC-DISPLAY-OPT-BLK = 'N'                         14400000
144100                 MOVE 'Y' TO ASC-DISPLAY-OPT-BLK                  14410000
144200             ELSE                                                 14420000
144300                 MOVE 'N' TO ASC-DISPLAY-OPT-BLK                  14430000
144400             END-IF                                               14440000
144500             MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL       14450000
144600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14460000
144700                                                                  14470000
144800         WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                 14480000
144900             MOVE +1             TO PV-TOP-ITEM                   14490000
145000                                                                  14500000
145100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14510000
145200                                                                  14520000
145300             PERFORM 3200-RESET-ATTRIBUTES                        14530000
145400                                                                  14540000
145500                                                                  14550000
145600         WHEN DP020-FK-PREV-PAGE (DP020-SRC-AID)                  14560000
145700                                                                  14570000
145800             PERFORM 2110-BROWSE-BACKWARD                         14580000
145900                                                                  14590000
146000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14600000
146100                                                                  14610000
146200             PERFORM 3200-RESET-ATTRIBUTES                        14620000
146300                                                                  14630000
146400                                                                  14640000
146500         WHEN DP020-FK-NEXT-PAGE (DP020-SRC-AID)                  14650000
146600                                                                  14660000
146700             PERFORM 2120-BROWSE-FORWARD                          14670000
146800                                                                  14680000
146900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14690000
147000                                                                  14700000
147100             PERFORM 3200-RESET-ATTRIBUTES                        14710000
147200                                                                  14720000
147300                                                                  14730000
147400         WHEN DP020-SRC-AID = DP016-ENTER                         14740000
147500                                                                  14750000
147600             PERFORM 2160-CHECK-FOR-JUMP-BROWSE                   14760000
147700                                                                  14770000
147800             IF PS-NO-ERROR                                       14780000
147900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14790000
148000             END-IF                                               14800000
148100                                                                  14810000
148200                                                                  14820000
148300         WHEN OTHER                                               14830000
148400             SET DP013-CICS-ABEND                                 14840000
148500                 DP013-NO-ROLLBACK                                14850000
148600                 DP013-XCTL-DISPLAY-RESTART                       14860000
148700                                 TO TRUE                          14870000
148800             MOVE '2100-CHECK-FUNCTION-KEY'                       14880000
148900                                 TO DP013-PARAGRAPH               14890000
149000             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      14900000
149100                                 TO DP013-MESSAGE-TEXT (1)        14910000
149200                                                                  14920000
149300             PERFORM DP013-0000-PROCESS-ABEND                     14930000
149400     END-EVALUATE.                                                14940000
149500                                                                  14950000
149600 2110-BROWSE-BACKWARD.                                            14960000
149700                                                                  14970000
149800     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    14980000
149900         GIVING PV-TOP-ITEM.                                      14990000
150000                                                                  15000000
150100     IF PV-TOP-ITEM NOT > +1                                      15010000
150200         MOVE +1                 TO PV-TOP-ITEM                   15020000
150300         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              15030000
150400         SET DP020-MSG-INFORMATIONAL                              15040000
150500                                 TO TRUE.                         15050000
150600                                                                  15060000
150700 2120-BROWSE-FORWARD.                                             15070000
150800                                                                  15080000
150900     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              15090000
151000         GIVING PV-TOP-ITEM.                                      15100000
151100                                                                  15110000
151200     IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    15120000
151300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15130000
151400                                 TO PV-TOP-ITEM                   15140000
151500         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              15150000
151600         SET DP020-MSG-INFORMATIONAL                              15160000
151700                                 TO TRUE                          15170000
151800     ELSE                                                         15180000
151900         COMPUTE PV-BOTTOM-ITEM =                                 15190000
152000             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 15200000
152100         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             15210000
152200             MOVE PC-TSYMSG-00070                                 15220000
152300                                 TO DP020-MSG-NUMBER              15230000
152400             SET DP020-MSG-INFORMATIONAL                          15240000
152500                                 TO TRUE.                         15250000
152600                                                                  15260000
152700 2160-CHECK-FOR-JUMP-BROWSE.                                      15270000
152800                                                                  15280000
152900     SET PS-NO-ERROR             TO TRUE.                         15290000
153000                                                                  15300000
153100     IF ASC-START-ITEM-REQUEST = SPACE                            15310000
153200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15320000
153300                                 TO PV-TOP-ITEM                   15330000
153400     ELSE                                                         15340000
153500         MOVE ASC-START-ITEM-REQUEST                              15350000
153600                                 TO DP010I-UNEDITED-FIELD         15360000
153700         MOVE +5                 TO DP010I-MAXIMUM-DIGITS         15370000
153800         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       15380000
153900         SET DP010I-NEGATIVE-NOT-ALLOWED                          15390000
154000                                 TO TRUE                          15400000
154100                                                                  15410000
154200         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15420000
154210              USING DP010I-NUMERIC-EDIT-AREA                      15421033
154300                                                                  15430000
154400         IF NOT DP010I-ERROR-DETECTED                             15440000
154500             MOVE DP010I-NUMERIC-FIELD                            15450000
154600                                 TO ASC-START-ITEM-REQUEST-N      15460000
154700             IF ASC-START-ITEM-REQUEST-N > ZERO                   15470000
154800                IF ASC-START-ITEM-REQUEST-N >                     15480000
154900                                          ASC-NUMBER-OF-ITEMS-READ15490000
155000                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        15500000
155100                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ15510000
155200                                          - PC-ITEMS-PER-PANEL + 115520000
155300                    IF PV-TOP-ITEM < +1                           15530000
155400                        MOVE +1  TO PV-TOP-ITEM                   15540000
155500                        MOVE PC-TSYMSG-00070                      15550000
155600                                 TO DP020-MSG-NUMBER              15560000
155700                        SET DP020-MSG-INFORMATIONAL               15570000
155800                                 TO TRUE                          15580000
155900                    END-IF                                        15590000
156000                ELSE                                              15600000
156100                    MOVE ASC-START-ITEM-REQUEST-N                 15610000
156200                                 TO PV-TOP-ITEM                   15620000
156300                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        15630000
156400                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        15640000
156500                                            PC-ITEMS-PER-PANEL - 115650000
156600                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  15660000
156700                         MOVE PC-TSYMSG-00070                     15670000
156800                                 TO DP020-MSG-NUMBER              15680000
156900                         SET DP020-MSG-INFORMATIONAL              15690000
157000                                 TO TRUE                          15700000
157100                    END-IF                                        15710000
157200                END-IF                                            15720000
157300             ELSE                                                 15730000
157400                 MOVE PC-TSYMSG-00101                             15740000
157500                                 TO DP020-MSG-NUMBER              15750000
157600                 SET DP030-SET-CURSOR-APPL-1                      15760000
157700                                 TO TRUE                          15770000
157800                 MOVE -1         TO ASTRTITL                      15780000
157900                 MOVE DP015-UNP-NUM-BRT-MDT                       15790000
158000                                 TO ASTRTITA                      15800000
158100                 MOVE DP015-RED  TO ASTRTITC                      15810000
158200                 MOVE DP015-REVERSE                               15820000
158300                                 TO ASTRTITH                      15830000
158400                 SET PS-ERROR                                     15840000
158500                     DP020-MSG-FATAL                              15850000
158600                                 TO TRUE                          15860000
158700             END-IF                                               15870000
158800         ELSE                                                     15880000
158900             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             15890000
159000             SET DP030-SET-CURSOR-APPL-1                          15900000
159100                                 TO TRUE                          15910000
159200             MOVE -1             TO ASTRTITL                      15920000
159300             MOVE DP015-UNP-NUM-BRT-MDT                           15930000
159400                                 TO ASTRTITA                      15940000
159500             MOVE DP015-RED      TO ASTRTITC                      15950000
159600             MOVE DP015-REVERSE  TO ASTRTITH                      15960000
159700             SET PS-ERROR                                         15970000
159800                 DP020-MSG-FATAL TO TRUE                          15980000
159900         END-IF                                                   15990000
160000     END-IF.                                                      16000000
160100                                                                  16010000
160200 2140-DESELECT-ALL-ITEMS.                                         16020000
160300                                                                  16030000
160400     MOVE +1                     TO ASC-BLK-SUB.                  16040000
160500                                                                  16050000
160600     PERFORM 2141-CLEAR-SELECTED-INDS                             16060000
160700             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    16070000
160800             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           16080000
160900                                                                  16090000
161000     ADD +1                      TO ASC-BLK-SUB.                  16100000
161100                                                                  16110000
161200     PERFORM 2141-CLEAR-SELECTED-INDS                             16120000
161300             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    16130000
161400             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           16140000
161500                                                                  16150000
161600     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              16160000
161700                                 TO PV-LIST-ITEM-NUMBER.          16170000
161800                                                                  16180000
161900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16190000
162000             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).16200000
162100                                                                  16210000
162200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16220000
162300              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)16230000
162400         MOVE +1                 TO ASC-BLK-SUB                   16240000
162500                                                                  16250000
162600         PERFORM 5100-WRITE-TEMP-STORAGE                          16260000
162700                                                                  16270000
162800         MOVE +1                 TO PV-BLOCK-NUMBER               16280000
162900                                                                  16290000
163000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16300000
163100                                       PV-FIRST-BLOCK-IN-ARRAY - 116310000
163200                                                                  16320000
163300         PERFORM                                                  16330000
163400           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         16340000
163500                                                                  16350000
163600                 PERFORM 4410-READ-TEMP-STORAGE                   16360000
163700                                                                  16370000
163800                 PERFORM 2141-CLEAR-SELECTED-INDS                 16380000
163900                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        16390000
164000                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL16400000
164100                                                                  16410000
164200                 PERFORM 5100-WRITE-TEMP-STORAGE                  16420000
164300                                                                  16430000
164400                 ADD +1          TO PV-BLOCK-NUMBER               16440000
164500                                                                  16450000
164600         END-PERFORM                                              16460000
164700                                                                  16470000
164800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16480000
164900                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY16490000
165000                                                                  16500000
165100         PERFORM                                                  16510000
165200           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         16520000
165300                                         ASC-HIGHEST-BLOCK-WRITTEN16530000
165400                                                                  16540000
165500                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      16550000
165600                                 TO PV-BLOCK-NUMBER               16560000
165700                                                                  16570000
165800                 PERFORM 4410-READ-TEMP-STORAGE                   16580000
165900                                                                  16590000
166000                 PERFORM 2141-CLEAR-SELECTED-INDS                 16600000
166100                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        16610000
166200                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL16620000
166300                                                                  16630000
166400                 PERFORM 5100-WRITE-TEMP-STORAGE                  16640000
166500                                                                  16650000
166600                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        16660000
166700                                                                  16670000
166800         END-PERFORM                                              16680000
166900                                                                  16690000
167000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16700000
167100                                 TO PV-BLOCK-NUMBER               16710000
167200                                                                  16720000
167300         PERFORM 4410-READ-TEMP-STORAGE                           16730000
167400                                                                  16740000
167500     END-IF.                                                      16750000
167600                                                                  16760000
167700     MOVE ZERO                   TO ASC-NUMBER-OF-SELECTED-ITEMS  16770000
167800                                    ASC-START-OF-SELECTED-RANGE   16780000
167900                                    ASC-END-OF-SELECTED-RANGE.    16790000
168000                                                                  16800000
168100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16810000
168200                                                                  16820000
168300 2141-CLEAR-SELECTED-INDS.                                        16830000
168400                                                                  16840000
168500     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO16850000
168600        IF NOT ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           16860000
168700            SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          16870000
168800                ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     16880000
168900                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  16890000
169000                                 TO TRUE.                         16900000
169100                                                                  16910000
169200 2150-SELECT-ALL-ITEMS.                                           16920000
169300                                                                  16930000
169400     MOVE +1                     TO ASC-BLK-SUB.                  16940000
169500                                                                  16950000
169600     PERFORM 2151-SET-SELECTED-INDS                               16960000
169700             VARYING ASC-ITEM-SUB FROM 1 BY 1                     16970000
169800             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           16980000
169900                                                                  16990000
170000     ADD +1                      TO ASC-BLK-SUB.                  17000000
170100                                                                  17010000
170200     PERFORM 2151-SET-SELECTED-INDS                               17020000
170300             VARYING ASC-ITEM-SUB FROM 1 BY 1                     17030000
170400             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           17040000
170500                                                                  17050000
170600     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              17060000
170700                                 TO PV-LIST-ITEM-NUMBER.          17070000
170800                                                                  17080000
170900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17090000
171000             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).17100000
171100                                                                  17110000
171200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17120000
171300              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)17130000
171400         MOVE +1                 TO ASC-BLK-SUB                   17140000
171500                                                                  17150000
171600         PERFORM 5100-WRITE-TEMP-STORAGE                          17160000
171700                                                                  17170000
171800         MOVE +1                 TO PV-BLOCK-NUMBER               17180000
171900                                                                  17190000
172000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17200000
172100                                       PV-FIRST-BLOCK-IN-ARRAY - 117210000
172200                                                                  17220000
172300         PERFORM                                                  17230000
172400           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         17240000
172500                                                                  17250000
172600                 PERFORM 4410-READ-TEMP-STORAGE                   17260000
172700                                                                  17270000
172800                 PERFORM 2151-SET-SELECTED-INDS                   17280000
172900                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        17290000
173000                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL17300000
173100                                                                  17310000
173200                 PERFORM 5100-WRITE-TEMP-STORAGE                  17320000
173300                                                                  17330000
173400                 ADD +1          TO PV-BLOCK-NUMBER               17340000
173500                                                                  17350000
173600         END-PERFORM                                              17360000
173700                                                                  17370000
173800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17380000
173900                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY17390000
174000                                                                  17400000
174100         PERFORM                                                  17410000
174200           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         17420000
174300                                         ASC-HIGHEST-BLOCK-WRITTEN17430000
174400                                                                  17440000
174500                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      17450000
174600                                 TO PV-BLOCK-NUMBER               17460000
174700                                                                  17470000
174800                 PERFORM 4410-READ-TEMP-STORAGE                   17480000
174900                                                                  17490000
175000                 PERFORM 2151-SET-SELECTED-INDS                   17500000
175100                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        17510000
175200                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL17520000
175300                                                                  17530000
175400                 PERFORM 5100-WRITE-TEMP-STORAGE                  17540000
175500                                                                  17550000
175600                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        17560000
175700                                                                  17570000
175800         END-PERFORM                                              17580000
175900                                                                  17590000
176000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17600000
176100                                 TO PV-BLOCK-NUMBER               17610000
176200                                                                  17620000
176300         PERFORM 4410-READ-TEMP-STORAGE                           17630000
176400     END-IF.                                                      17640000
176500                                                                  17650000
176600     MOVE ASC-NUMBER-OF-ITEMS-READ                                17660000
176700                                 TO ASC-NUMBER-OF-SELECTED-ITEMS. 17670000
176800                                                                  17680000
176900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17690000
177000                                                                  17700000
177100 2151-SET-SELECTED-INDS.                                          17710000
177200                                                                  17720000
177300     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO17730000
177400        IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              17740000
177500            SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             17750000
177600                ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        17760000
177700                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  17770000
177800                                 TO TRUE                          17780000
177900        END-IF                                                    17790000
178000     END-IF.                                                      17800000
178100                                                                  17810000
178200 2200-MOVE-SCREEN-TO-COMMAREA.                                    17820000
178300                                                                  17830000
178400     MOVE PV-TOP-ITEM            TO PV-ITEM-IN-USE.               17840000
178500     MOVE +1                     TO PV-SUB.                       17850000
178600                                                                  17860000
178700     PERFORM 3100-SET-SUBSCRIPTS.                                 17870000
178800                                                                  17880000
178900     IF APRINTRL > ZERO                                           17890000
179000         MOVE APRINTRI           TO ASC-PRINTER                   17900000
179100     ELSE                                                         17910000
179200         IF APRINTRF = DP015-ERASE-EOF                            17920000
179300             MOVE SPACES         TO ASC-PRINTER                   17930000
179400         END-IF                                                   17940000
179500     END-IF.                                                      17950000
179600                                                                  17960000
179700     IF  ATKTOFFL > ZERO                                          17970000
179800         MOVE  ATKTOFFI          TO ASC-TKT-OFFICE                17980000
179900     ELSE                                                         17990000
180000         IF  ATKTOFFF = DP015-ERASE-EOF                           18000000
180100             MOVE SPACES         TO ASC-TKT-OFFICE                18010000
180200         END-IF                                                   18020000
180300     END-IF.                                                      18030000
180400                                                                  18040000
180500******************************************************************18050000
180600* AS OF 3/14/2002, WE NO LONGER WISH TO PRINT THE SEASON CODE ON *18060000
180700* ANY OF THE TICKETS.  I AM COMMENTING OUT THE CODE FOR NOW SO   *18070000
180800* THAT WE CAN COME BACK TO IT JUST IN CASE THE TICKETING OFFICE  *18080000
180900* WANTS TO DISPLAY THE SEASON CODE ONCE AGAIN ON THE TICKETS.    *18090000
181000*                                                                *18100000
181100*                                 -- DAN HINTZ (NEW SKU PROJECT) *18110000
181200******************************************************************18120000
181300*DH  IF ASSNCDEL > ZERO                                           18130000
181400*DH      MOVE ASSNCDEI           TO ASC-SEASON-CDE                18140000
181500*DH  ELSE                                                         18150000
181600*DH      IF ASSNCDEF = DP015-ERASE-EOF                            18160000
181700*DH          MOVE SPACES         TO ASC-SEASON-CDE                18170000
181800*DH      END-IF                                                   18180000
181900*DH  END-IF.                                                      18190000
182000                                                                  18200000
182100     IF  AXTKTSL > ZERO                                           18210000
182200         MOVE AXTKTSI            TO ASC-EXTRA-TKTS                18220000
182300     ELSE                                                         18230000
182400         IF  AXTKTSF = DP015-ERASE-EOF                            18240000
182500             MOVE SPACES         TO ASC-EXTRA-TKTS                18250000
182600         END-IF                                                   18260000
182700     END-IF.                                                      18270000
182800                                                                  18280000
182900     IF AXTKTPCL > ZERO                                           18290000
183000         MOVE AXTKTPCI           TO ASC-EXTRA-TKT-PCT             18300000
183100     ELSE                                                         18310000
183200         IF AXTKTPCF = DP015-ERASE-EOF                            18320000
183300             MOVE SPACES         TO ASC-EXTRA-TKT-PCT             18330000
183400         END-IF                                                   18340000
183500     END-IF.                                                      18350000
183600                                                                  18360000
183700     IF AOPTBLKL > ZERO                                           18370000
183800         MOVE AOPTBLKI           TO ASC-OPT-BLOCK                 18380000
183900     ELSE                                                         18390000
184000         IF AOPTBLKF = DP015-ERASE-EOF                            18400000
184100             MOVE SPACES         TO ASC-OPT-BLOCK                 18410000
184200         END-IF                                                   18420000
184300     END-IF.                                                      18430000
184400                                                                  18440000
184500     IF ASTRTITL > ZERO                                           18450000
184600         MOVE ASTRTITI           TO ASC-START-ITEM-REQUEST        18460000
184700     ELSE                                                         18470000
184800         IF ASTRTITF = DP015-ERASE-EOF                            18480000
184900             INITIALIZE ASC-START-ITEM-REQUEST                    18490000
185000         END-IF                                                   18500000
185100     END-IF.                                                      18510000
185200                                                                  18520000
185300     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          18530000
185400             VARYING PV-SUB  FROM 1 BY 1                          18540000
185500             UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED.                18550000
185600                                                                  18560000
185700 2210-MOVE-LINES-TO-COMMAREA.                                     18570000
185800                                                                  18580000
185900     IF MR-SELECTL (PV-SUB) > ZERO                                18590000
186000         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  18600000
186100                                 TO TRUE                          18610000
186200         MOVE MR-SELECTI (PV-SUB)                                 18620000
186300                                 TO ASC-TEMP-SELECTED-SW          18630000
186400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18640000
186500     ELSE                                                         18650000
186600         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 18660000
186700             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 18670000
186800                                 TO TRUE                          18680000
186900             MOVE SPACE          TO ASC-TEMP-SELECTED-SW          18690000
187000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18700000
187100         END-IF                                                   18710000
187200     END-IF.                                                      18720000
187300                                                                  18730000
187400     IF MR-QUANT-L        (PV-SUB) > ZERO                         18740000
187500         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  18750000
187600                                 TO TRUE                          18760000
187700         MOVE MR-QUANT        (PV-SUB)                            18770000
187800                                 TO  ASC-UNT-QTY                  18780000
187900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18790000
188000     ELSE                                                         18800000
188100         IF   MR-QUANT-A      (PV-SUB) = DP015-ERASE-EOF          18810000
188200             MOVE ZEROS          TO  ASC-UNT-QTY                  18820000
188300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18830000
188400             SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)              18840000
188500                                 TO TRUE                          18850000
188600         END-IF                                                   18860000
188700     END-IF.                                                      18870000
188800                                                                  18880000
188900     IF MR-SIZE-L         (PV-SUB) > ZERO                         18890000
189000         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  18900000
189100                                 TO TRUE                          18910000
189200         MOVE MR-SIZE         (PV-SUB)                            18920000
189300                                 TO  ASC-SIZE                     18930000
189400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18940000
189500     ELSE                                                         18950000
189600         IF   MR-SIZE-A       (PV-SUB) = DP015-ERASE-EOF          18960000
189700             MOVE LOW-VALUES     TO  ASC-SIZE                     18970000
189800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18980000
189900             SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)              18990000
190000                                 TO TRUE                          19000000
190100         END-IF                                                   19010000
190200     END-IF.                                                      19020000
190300                                                                  19030000
190400     IF MR-COLOR-L        (PV-SUB) > ZERO                         19040000
190500         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  19050000
190600                                 TO TRUE                          19060000
190700         MOVE MR-COLOR        (PV-SUB)                            19070000
190800                                 TO  ASC-COLOR                    19080000
190900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19090000
191000     ELSE                                                         19100000
191100         IF   MR-COLOR-A      (PV-SUB) = DP015-ERASE-EOF          19110000
191200             MOVE LOW-VALUES     TO  ASC-COLOR                    19120000
191300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19130000
191400             SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)              19140000
191500                                 TO TRUE                          19150000
191600         END-IF                                                   19160000
191700     END-IF.                                                      19170000
191800                                                                  19180000
191900     IF MR-OPT-BLK-L      (PV-SUB) > ZERO                         19190000
192000         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  19200000
192100                                 TO TRUE                          19210000
192200         MOVE MR-OPT-BLK      (PV-SUB)                            19220000
192300                                 TO  ASC-OPT-BLK                  19230000
192400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19240000
192500     ELSE                                                         19250000
192600         IF   MR-OPT-BLK-A    (PV-SUB) = DP015-ERASE-EOF          19260000
192700             MOVE SPACES         TO  ASC-OPT-BLK                  19270000
192800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19280000
192900             SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)              19290000
193000                                 TO TRUE                          19300000
193100         END-IF                                                   19310000
193200     END-IF.                                                      19320000
193300                                                                  19330000
193400     ADD +1                      TO ASC-ITEM-SUB.                 19340000
193500                                                                  19350000
193600     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         19360000
193700         ADD  +1                 TO ASC-BLK-SUB                   19370000
193800         MOVE +1                 TO ASC-ITEM-SUB                  19380000
193900     END-IF.                                                      19390000
194000                                                                  19400000
194100/                                                                 19410000
194200******************************************************************19420000
194300* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *19430000
194400* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *19440000
194500******************************************************************19450000
194600 2300-GET-NEXT-RECORD.                                            19460000
194700                                                                  19470000
194800     ADD +1                        TO ASC-SEL-SUB.                19480000
194900     IF ASC-SEL-SUB > PC016-MAX-ITEMS                             19490000
195000         ADD +1                    TO ASC-SEL-ITEM                19500000
195100         MOVE +1                   TO ASC-SEL-SUB                 19510000
195200     END-IF.                                                      19520000
195300     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 19530000
195400         PERFORM 9100-READ-SEL-QUEUE                              19540000
195500         IF PC016-ITEM (ASC-SEL-SUB) > ZERO                       19550000
195600**DH1124     MOVE PC016-CL (ASC-SEL-SUB) TO  PURITM-CL-NBR        19560000
195700             MOVE PC016-GP-QTY (ASC-SEL-SUB)                      19570000
195800                                         TO  PURITM-GP-QTY        19580000
195900             MOVE PC016-GP-RTL-AMT (ASC-SEL-SUB)                  19590000
196000                                         TO  PURITM-GP-RTL-AMT    19600000
196100             MOVE PC016-UNT-RTL-PR-AMT (ASC-SEL-SUB)              19610000
196200                                         TO  PURITM-UNT-RTL-PR-AMT19620000
196300             MOVE PC016-ITM-NBR (ASC-SEL-SUB)                     19630000
196400                                         TO  PURITM-ITM-NBR       19640000
196500             MOVE PC016-VEND-STYL-NAME (ASC-SEL-SUB)              19650000
196600                                         TO  PURITM-VEND-STYL-NAME19660000
196700             MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                  19670000
196800                                         TO  PURITM-APP-PO-LNE-NBR19680000
196900             MOVE PC016-DTL-CK-ITM-QTY (ASC-SEL-SUB)              19690000
197000                                         TO  RECITM-DTL-CK-ITM-QTY19700000
197100             MOVE PC016-PKSL-ITM-QTY (ASC-SEL-SUB)                19710000
197200                                         TO  RECITM-PKSL-ITM-QTY  19720000
197300             PERFORM 9200-REWRITE-LIST-QUEUE                      19730000
197400         ELSE                                                     19740000
197500              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 19750000
197600         END-IF                                                   19760000
197700     ELSE                                                         19770000
197800         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      19780000
197900     END-IF.                                                      19790000
198000                                                                  19800000
198100 3000-EDIT-DATA-IN-COMMAREA.                                      19810000
198200                                                                  19820000
198300     SET PS-NO-ERROR             TO TRUE.                         19830000
198400                                                                  19840000
198500     PERFORM 3200-RESET-ATTRIBUTES.                               19850000
198600                                                                  19860000
198700     MOVE ASC-KEY-OPER-UNT-ID     TO DK-OPER-UNT-ID.              19870000
198800     MOVE ASC-KEY-FCLTY-ID        TO DK-FCLTY-ID.                 19880000
198900                                                                  19890000
199000******************************************************************19900000
199100* AS OF 3/14/2002, WE NO LONGER WISH TO PRINT THE SEASON CODE ON *19910000
199200* ANY OF THE TICKETS.  I AM COMMENTING OUT THE CODE FOR NOW SO   *19920000
199300* THAT WE CAN COME BACK TO IT JUST IN CASE THE TICKETING OFFICE  *19930000
199400* WANTS TO DISPLAY THE SEASON CODE ONCE AGAIN ON THE TICKETS.    *19940000
199500*                                                                *19950000
199600*                                 -- DAN HINTZ (NEW SKU PROJECT) *19960000
199700******************************************************************19970000
199800*DH                                                               19980000
199900*DH  IF ASC-SEASON-CDE NOT = SPACES                               19990000
200000*DH      MOVE ASC-SEASON-CDE TO PV-SEASON-CODE                    20000000
200100*DH      IF NOT PV-VAILD-SEASON-CODES                             20010000
200200*DH          SET PS-SEASON-CODE-EDIT-FAILED TO TRUE               20020000
200300*DH      END-IF                                                   20030000
200400*DH      IF PV-SEASON-CODE-SCND-DGT-OF-YR NOT NUMERIC             20040000
200500*DH          SET PS-SEASON-CODE-EDIT-FAILED TO TRUE               20050000
200600*DH      END-IF                                                   20060000
200700*DH      IF PV-SEASON-CODE-MONTH NOT NUMERIC                      20070000
200800*DH          SET PS-SEASON-CODE-EDIT-FAILED TO TRUE               20080000
200900*DH      ELSE                                                     20090000
201000*DH          IF ((PV-SEASON-CODE-MONTH NOT > ZERO) OR             20100000
201100*DH              (PV-SEASON-CODE-MONTH NOT < PC-SEVEN))           20110000
201200*DH              SET PS-SEASON-CODE-EDIT-FAILED TO TRUE           20120000
201300*DH          END-IF                                               20130000
201400*DH      END-IF                                                   20140000
201500*DH      IF PS-SEASON-CODE-EDIT-FAILED                            20150000
201600*DH          SET PS-ERROR                                         20160000
201700*DH              DP020-MSG-FATAL TO TRUE                          20170000
201800*DH          MOVE PC-TSYMSG-00005                                 20180000
201900*DH                              TO DP020-MSG-NUMBER              20190000
202000*DH          MOVE DP015-UNP-ALP-BRT-OFF                           20200000
202100*DH                              TO ASSNCDEA                      20210000
202200*DH          MOVE DP015-RED      TO ASSNCDEC                      20220000
202300*DH          MOVE DP015-REVERSE  TO ASSNCDEH                      20230000
202400*DH          MOVE -1             TO ASSNCDEL                      20240000
202500*DH          SET DP030-SET-CURSOR-APPL-1                          20250000
202600*DH                              TO TRUE                          20260000
202700*DH      END-IF                                                   20270000
202800*DH  END-IF.                                                      20280000
202900                                                                  20290000
203000     IF ASC-TKT-OFFICE = SPACES                                   20300000
203100         SET PS-ERROR                                             20310000
203200             DP020-MSG-FATAL TO TRUE                              20320000
203300         MOVE PC-TSYMSG-00007                                     20330000
203400                             TO DP020-MSG-NUMBER                  20340000
203500         MOVE DP015-UNP-ALP-BRT-OFF                               20350000
203600                             TO ATKTOFFA                          20360000
203700         MOVE DP015-RED      TO ATKTOFFC                          20370000
203800         MOVE DP015-REVERSE  TO ATKTOFFH                          20380000
203900         MOVE -1             TO ATKTOFFL                          20390000
204000         SET DP030-SET-CURSOR-APPL-1                              20400000
204100                             TO TRUE                              20410000
204200     END-IF.                                                      20420000
204300                                                                  20430000
204400     IF NOT PS-ERROR                                              20440000
204500         PERFORM 3020-VALIDATE-FORMAT                             20450000
204600         IF SQLCODE = +100                                        20460000
204700             SET PS-ERROR                                         20470000
204800                 DP020-MSG-FATAL TO TRUE                          20480000
204900             MOVE PC-TSYMSG-00005                                 20490000
205000                                 TO DP020-MSG-NUMBER              20500000
205100             MOVE DP015-UNP-ALP-BRT-OFF                           20510000
205200                                 TO ATKTOFFA                      20520000
205300             MOVE DP015-RED      TO ATKTOFFC                      20530000
205400             MOVE DP015-REVERSE  TO ATKTOFFH                      20540000
205500             MOVE -1             TO ATKTOFFL                      20550000
205600             SET DP030-SET-CURSOR-APPL-1                          20560000
205700                                 TO TRUE                          20570000
205800         END-IF                                                   20580000
205900     END-IF.                                                      20590000
206000                                                                  20600000
206100     IF ASC-EXTRA-TKT-PCT NOT = SPACES                            20610000
206200         MOVE ASC-EXTRA-TKT-PCT TO DP010I-UNEDITED-FIELD          20620000
206300         MOVE LENGTH OF ASC-EXTRA-TKT-PCT                         20630000
206400                                 TO DP010I-MAXIMUM-DIGITS         20640000
206500         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       20650000
206600         SET DP010I-NEGATIVE-NOT-ALLOWED                          20660000
206700                                 TO TRUE                          20670000
206800         CALL DP010I-NUMERIC-EDIT-ROUTINE                         20680000
206810              USING DP010I-NUMERIC-EDIT-AREA                      20681033
206900         IF  DP010I-ERROR-DETECTED                                20690000
207000             SET PS-ERROR                                         20700000
207100                 DP020-MSG-FATAL TO TRUE                          20710000
207200             MOVE PC-TSYMSG-00008                                 20720000
207300                                 TO DP020-MSG-NUMBER              20730000
207400             MOVE DP015-UNP-ALP-BRT-OFF                           20740000
207500                                 TO AXTKTPCA                      20750000
207600             MOVE DP015-RED      TO AXTKTPCC                      20760000
207700             MOVE DP015-REVERSE  TO AXTKTPCH                      20770000
207800             MOVE -1             TO AXTKTPCL                      20780000
207900             SET DP030-SET-CURSOR-APPL-1                          20790000
208000                                 TO TRUE                          20800000
208100         ELSE                                                     20810000
208200             MOVE DP010I-NUMERIC-FIELD                            20820000
208300                                 TO ASC-EXTRA-TKT-PCT-N           20830000
208400             MOVE ASC-EXTRA-TKT-PCT-N                             20840000
208500                                 TO AXTKTPCO                      20850000
208600             IF ASC-EXTRA-TKT-PCT-N >                             20860000
208700                               PC-MAX-EXTRA-TICKET-PERCENT        20870000
208800                 SET PS-ERROR                                     20880000
208900                     DP020-MSG-FATAL TO TRUE                      20890000
209000                 MOVE PC-TSYMSG-00005                             20900000
209100                                     TO DP020-MSG-NUMBER          20910000
209200                 MOVE DP015-UNP-ALP-BRT-OFF                       20920000
209300                                     TO AXTKTPCA                  20930000
209400                 MOVE DP015-RED      TO AXTKTPCC                  20940000
209500                 MOVE DP015-REVERSE  TO AXTKTPCH                  20950000
209600                 MOVE -1             TO AXTKTPCL                  20960000
209700                 SET DP030-SET-CURSOR-APPL-1                      20970000
209800                                     TO TRUE                      20980000
209900             END-IF                                               20990000
210000         END-IF                                                   21000000
210100     END-IF.                                                      21010000
210200                                                                  21020000
210300     IF ASC-EXTRA-TKTS NOT = SPACES                               21030000
210400         MOVE ASC-EXTRA-TKTS TO DP010I-UNEDITED-FIELD             21040000
210500         MOVE LENGTH OF ASC-EXTRA-TKTS                            21050000
210600                                 TO DP010I-MAXIMUM-DIGITS         21060000
210700         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       21070000
210800         SET DP010I-NEGATIVE-NOT-ALLOWED                          21080000
210900                                 TO TRUE                          21090000
211000         CALL DP010I-NUMERIC-EDIT-ROUTINE                         21100000
211010              USING DP010I-NUMERIC-EDIT-AREA                      21101033
211100         IF  DP010I-ERROR-DETECTED                                21110000
211200             SET PS-ERROR                                         21120000
211300                 DP020-MSG-FATAL TO TRUE                          21130000
211400             MOVE PC-TSYMSG-00008                                 21140000
211500                                 TO DP020-MSG-NUMBER              21150000
211600             MOVE DP015-UNP-ALP-BRT-OFF                           21160000
211700                                 TO AXTKTSA                       21170000
211800             MOVE DP015-RED      TO AXTKTSC                       21180000
211900             MOVE DP015-REVERSE  TO AXTKTSH                       21190000
212000             MOVE -1             TO AXTKTSL                       21200000
212100             SET DP030-SET-CURSOR-APPL-1                          21210000
212200                                 TO TRUE                          21220000
212300         ELSE                                                     21230000
212400             MOVE DP010I-NUMERIC-FIELD                            21240000
212500                                 TO ASC-EXTRA-TKTS-N              21250000
212600             MOVE ASC-EXTRA-TKTS-N                                21260000
212700                                 TO AXTKTSO                       21270000
212800         END-IF                                                   21280000
212900     END-IF.                                                      21290000
213000                                                                  21300000
213100     IF ASC-EXTRA-TKTS = SPACES AND                               21310000
213200        ASC-EXTRA-TKT-PCT = SPACES                                21320000
213300         IF PRTSTK-EXTRA-TKTS-NBR = ZERO                          21330000
213400             MOVE PRTSTK-EXTRA-TKTS-PCT TO ASC-EXTRA-TKT-PCT-N    21340000
213500         ELSE                                                     21350000
213600             MOVE PRTSTK-EXTRA-TKTS-NBR TO ASC-EXTRA-TKTS-N       21360000
213700         END-IF                                                   21370000
213800     ELSE                                                         21380000
213900         IF ASC-EXTRA-TKTS NOT = SPACES AND                       21390000
214000            ASC-EXTRA-TKTS NOT = ZERO AND                         21400000
214100            ASC-EXTRA-TKT-PCT NOT = SPACES AND                    21410000
214200            ASC-EXTRA-TKT-PCT NOT = ZERO                          21420000
214300             SET PS-ERROR                                         21430000
214400                 DP020-MSG-FATAL TO TRUE                          21440000
214500             MOVE PC-TSYMSG-00005                                 21450000
214600                                 TO DP020-MSG-NUMBER              21460000
214700             MOVE DP015-UNP-ALP-BRT-OFF                           21470000
214800                                 TO AXTKTSA                       21480000
214900             MOVE DP015-RED      TO AXTKTSC                       21490000
215000             MOVE DP015-REVERSE  TO AXTKTSH                       21500000
215100             MOVE -1             TO AXTKTSL                       21510000
215200             SET DP030-SET-CURSOR-APPL-1                          21520000
215300                                 TO TRUE                          21530000
215400             MOVE DP015-UNP-ALP-BRT-OFF                           21540000
215500                                 TO AXTKTPCA                      21550000
215600             MOVE DP015-RED      TO AXTKTPCC                      21560000
215700             MOVE DP015-REVERSE  TO AXTKTPCH                      21570000
215800         END-IF                                                   21580000
215900     END-IF.                                                      21590000
216000                                                                  21600000
216100     IF ASC-PRINTER = SPACES                                      21610000
216200         SET PS-ERROR                                             21620000
216300             DP020-MSG-FATAL TO TRUE                              21630000
216400         MOVE PC-TSYMSG-00007                                     21640000
216500                             TO DP020-MSG-NUMBER                  21650000
216600         MOVE DP015-UNP-ALP-BRT-OFF                               21660000
216700                             TO APRINTRA                          21670000
216800         MOVE DP015-RED      TO APRINTRC                          21680000
216900         MOVE DP015-REVERSE  TO APRINTRH                          21690000
217000         MOVE -1             TO APRINTRL                          21700000
217100         SET DP030-SET-CURSOR-APPL-1                              21710000
217200                             TO TRUE                              21720000
217300     END-IF.                                                      21730000
217400                                                                  21740000
217500     IF PS-VALID-TICKET-FORMAT AND                                21750000
217600        ASC-OPT-BLOCK NOT = SPACES AND                            21760000
217700        TKTFMT-OPT-BLK-LBLS-IND = 'N'                             21770000
217800         SET PS-ERROR                                             21780000
217900             DP020-MSG-FATAL TO TRUE                              21790000
218000         MOVE PC-TSYMSG-00005                                     21800000
218100                             TO DP020-MSG-NUMBER                  21810000
218200         MOVE DP015-UNP-ALP-BRT-OFF                               21820000
218300                             TO AOPTBLKA                          21830000
218400         MOVE DP015-RED      TO AOPTBLKC                          21840000
218500         MOVE DP015-REVERSE  TO AOPTBLKH                          21850000
218600         MOVE -1             TO AOPTBLKL                          21860000
218700         SET DP030-SET-CURSOR-APPL-1                              21870000
218800                             TO TRUE                              21880000
218900     END-IF.                                                      21890000
219000                                                                  21900000
219100     MOVE ASC-ITEMS-DISPLAYED    TO PV-SUB.                       21910000
219200     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       21920000
219300                                          ASC-ITEMS-DISPLAYED - 1.21930000
219400     PERFORM 3100-SET-SUBSCRIPTS.                                 21940000
219500                                                                  21950000
219600     PERFORM 3300-EDIT-SELECTIONS                                 21960000
219700             VARYING PV-SUB  FROM PV-SUB BY -1                    21970000
219800             UNTIL   PV-SUB < +1.                                 21980000
219900                                                                  21990000
220000 3010-VALIDATE-FORMAT.                                            22000000
220100                                                                  22010000
220200     EXEC SQL                                                     22020000
220300          SELECT DISTINCT                                         22030000
220400                 A.TKT_FMT_ID,                                    22040000
220500                 A.TYP_CDE,                                       22050000
220600                 A.OPT_BLK_TAGS_IND,                              22060000
220700                 A.PRT_SIZE_IND,                                  22070000
220800                 A.PRT_COLOR_IND,                                 22080000
220900                 A.PRT_GP_PR_IND,                                 22090000
221000                 A.PAPER_TYP_ID,                                  22100000
221100                 A.OPT_BLK_LBLS_IND,                              22110000
221200                 A.STKR_NBR_REQ_IND,                              22120000
221300                 B.EXTRA_TKTS_PCT,                                22130000
221400                 B.EXTRA_TKTS_NBR                                 22140000
221500            INTO :PV-TKT-FMT-ID,                                  22150000
221600                 :TKTFMT-TYP-CDE,                                 22160000
221700                 :TKTFMT-OPT-BLK-TAGS-IND,                        22170000
221800                 :TKTFMT-PRT-SIZE-IND,                            22180000
221900                 :TKTFMT-PRT-COLOR-IND,                           22190000
222000                 :TKTFMT-PRT-GP-PR-IND,                           22200000
222100                 :TKTFMT-PAPER-TYP-ID,                            22210000
222200                 :TKTFMT-OPT-BLK-LBLS-IND,                        22220000
222300                 :TKTFMT-STKR-NBR-REQ-IND,                        22230000
222400                 :PRTSTK-EXTRA-TKTS-PCT,                          22240000
222500                 :PRTSTK-EXTRA-TKTS-NBR                           22250000
222600            FROM TTKTFMT A,                                       22260000
222700                 TPRTSTK B                                        22270000
222800           WHERE A.OPER_UNT_ID    = :DK-OPER-UNT-ID               22280000
222900             AND A.FCLTY_ID       = :DK-FCLTY-ID                  22290000
223000             AND A.TKT_FMT_ID     = :ASC-TKT-FORMAT               22300000
223100             AND A.PAPER_TYP_ID   = B.PAPER_TYPE_ID               22310000
223200     END-EXEC.                                                    22320000
223300                                                                  22330000
223400     EVALUATE TRUE                                                22340000
223500         WHEN SQLCODE = ZERO                                      22350000
223600         WHEN SQLCODE = +100                                      22360000
223700         WHEN SQLCODE = -811                                      22370000
223800              CONTINUE                                            22380000
223900                                                                  22390000
224000         WHEN SQLWARN0 NOT = SPACES                               22400000
224100         WHEN SQLCODE  NOT = ZERO                                 22410000
224200              MOVE '3010-VALIDATE-FORMAT'                         22420000
224300                             TO DP013-PARAGRAPH                   22430000
224400              MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'           22440000
224500                             TO DP013-MESSAGE-TEXT (1)            22450000
224600              MOVE SQLCA     TO DP013-SQLCA                       22460000
224700              MOVE 'TTKTFMT' TO DP013-DB2-TABLE-NAME (1)          22470000
224800              MOVE 'TPRTSTK' TO DP013-DB2-TABLE-NAME (1)          22480000
224900              SET DP013-DB2-ABEND                                 22490000
225000                  DP013-XCTL-DISPLAY-RESTART                      22500000
225100                             TO TRUE                              22510000
225200                                                                  22520000
225300              PERFORM DP013-0000-PROCESS-ABEND                    22530000
225400     END-EVALUATE.                                                22540000
225500                                                                  22550000
225600                                                                  22560000
225700                                                                  22570000
225800 3020-VALIDATE-FORMAT.                                            22580000
225900                                                                  22590000
226000       EXEC SQL                                                   22600000
226100            SELECT DISTINCT                                       22610000
226200                   A.TKT_FMT_ID,                                  22620000
226300                   A.TYP_CDE,                                     22630000
226400                   A.OPT_BLK_TAGS_IND,                            22640000
226500                   A.PRT_SIZE_IND,                                22650000
226600                   A.PRT_COLOR_IND,                               22660000
226700                   A.PRT_GP_PR_IND,                               22670000
226800                   A.PAPER_TYP_ID,                                22680000
226900                   A.OPT_BLK_LBLS_IND,                            22690000
227000                   A.STKR_NBR_REQ_IND,                            22700000
227100                   A.TKT_OFF_ADR_ID,                              22710000
227200                   B.EXTRA_TKTS_PCT,                              22720000
227300                   B.EXTRA_TKTS_NBR                               22730000
227400              INTO :PV-TKT-FMT-ID,                                22740000
227500                   :TKTFMT-TYP-CDE,                               22750000
227600                   :TKTFMT-OPT-BLK-TAGS-IND,                      22760000
227700                   :TKTFMT-PRT-SIZE-IND,                          22770000
227800                   :TKTFMT-PRT-COLOR-IND,                         22780000
227900                   :TKTFMT-PRT-GP-PR-IND,                         22790000
228000                   :TKTFMT-PAPER-TYP-ID,                          22800000
228100                   :TKTFMT-OPT-BLK-LBLS-IND,                      22810000
228200                   :TKTFMT-STKR-NBR-REQ-IND,                      22820000
228300                   :TKTFMT-TKT-OFF-ADR-ID,                        22830000
228400                   :PRTSTK-EXTRA-TKTS-PCT,                        22840000
228500                   :PRTSTK-EXTRA-TKTS-NBR                         22850000
228600              FROM TTKTFMT A,                                     22860000
228700                   TPRTSTK B                                      22870000
228800             WHERE A.OPER_UNT_ID    = :DK-OPER-UNT-ID             22880000
228900               AND A.FCLTY_ID       = :DK-FCLTY-ID                22890000
229000               AND A.TKT_FMT_ID     = :ASC-TKT-FORMAT             22900000
229100               AND A.TKT_OFF_ID     = :ASC-TKT-OFFICE             22910000
229200               AND A.PAPER_TYP_ID   = B.PAPER_TYPE_ID             22920000
229300       END-EXEC.                                                  22930000
229400                                                                  22940000
229500     EVALUATE TRUE                                                22950000
229600         WHEN SQLCODE = ZERO                                      22960000
229700         WHEN SQLCODE = +100                                      22970000
229800              CONTINUE                                            22980000
229900                                                                  22990000
230000         WHEN SQLWARN0 NOT = SPACES                               23000000
230100         WHEN SQLCODE  NOT = ZERO                                 23010000
230200              MOVE '3020-VALIDATE-FORMAT'                         23020000
230300                             TO DP013-PARAGRAPH                   23030000
230400              MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'           23040000
230500                             TO DP013-MESSAGE-TEXT (1)            23050000
230600              MOVE SQLCA     TO DP013-SQLCA                       23060000
230700              MOVE 'TTKTFMT' TO DP013-DB2-TABLE-NAME (1)          23070000
230800              MOVE 'TPRTSTK' TO DP013-DB2-TABLE-NAME (1)          23080000
230900              SET DP013-DB2-ABEND                                 23090000
231000                  DP013-XCTL-DISPLAY-RESTART                      23100000
231100                             TO TRUE                              23110000
231200                                                                  23120000
231300              PERFORM DP013-0000-PROCESS-ABEND                    23130000
231400     END-EVALUATE.                                                23140000
231500                                                                  23150000
231600                                                                  23160000
231700 3100-SET-SUBSCRIPTS.                                             23170000
231800                                                                  23180000
231900     COMPUTE ASC-ITEM-SUB =                                       23190000
232000                (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.23200000
232100                                                                  23210000
232200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         23220000
232300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            23230000
232400         MOVE PC-MAX-BLOCKS-IN-ARRAY                              23240000
232500                                 TO ASC-BLK-SUB                   23250000
232600     ELSE                                                         23260000
232700         MOVE +1                 TO ASC-BLK-SUB                   23270000
232800     END-IF.                                                      23280000
232900                                                                  23290000
233000 3200-RESET-ATTRIBUTES.                                           23300000
233100                                                                  23310000
233200     MOVE DP015-UNP-ALP-NOR-OFF  TO ASTRTITA                      23320000
233300                                    APRINTRA                      23330000
233400                                    AXTKTSA                       23340000
233500                                    ATKTOFFA                      23350000
233600                                    AXTKTPCA                      23360000
233700                                    ASTRTITA                      23370000
233800                                    AOPTBLKA.                     23380000
233900*DH                                 ASSNCDEA.                     23390000
234000     MOVE DP015-PRO-NOR-OFF      TO ATKTFMTA.                     23400000
234100     MOVE DP015-GREEN            TO ASTRTITC                      23410000
234200                                    APRINTRC                      23420000
234300                                    AXTKTSC                       23430000
234400                                    ATKTOFFC                      23440000
234500                                    AXTKTPCC                      23450000
234600                                    AOPTBLKC.                     23460000
234700*DH                                 ASSNCDEC.                     23470000
234800     MOVE DP015-BLUE             TO ATKTFMTC.                     23480000
234900     MOVE DP015-UNDERLINE        TO ASTRTITH                      23490000
235000                                    APRINTRH                      23500000
235100                                    AXTKTSH                       23510000
235200                                    ATKTOFFH                      23520000
235300                                    AXTKTPCH                      23530000
235400                                    AOPTBLKH.                     23540000
235500*DH                                 ASSNCDEH.                     23550000
235600     MOVE DP015-HL-OFF           TO ATKTFMTH.                     23560000
235700                                                                  23570000
235800     IF DP020-NEXT-ACT-RETURN OR                                  23580000
235900        DP020-NEXT-ACT-READ-MAP                                   23590000
236000         PERFORM VARYING PV-SUB  FROM 1 BY 1                      23600000
236100                 UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED             23610000
236200                 MOVE DP015-UNP-ALP-NOR-OFF                       23620000
236300                                 TO MR-SELECTA (PV-SUB)           23630000
236400                                    MR-SIZE-A (PV-SUB)            23640000
236500                                    MR-COLOR-A (PV-SUB)           23650000
236600                                    MR-OPT-BLK-A (PV-SUB)         23660000
236700                 MOVE DP015-UNP-NUM-NOR-OFF                       23670000
236800                                 TO MR-QUANT-A (PV-SUB)           23680000
236900                 MOVE DP015-GREEN                                 23690000
237000                                 TO MR-SELECTC (PV-SUB)           23700000
237100                                    MR-QUANT-C (PV-SUB)           23710000
237200                                    MR-SIZE-C (PV-SUB)            23720000
237300                                    MR-COLOR-C (PV-SUB)           23730000
237400                                    MR-OPT-BLK-C (PV-SUB)         23740000
237500                 MOVE DP015-UNDERLINE                             23750000
237600                                 TO MR-SELECTH (PV-SUB)           23760000
237700                                    MR-QUANT-H (PV-SUB)           23770000
237800                                    MR-SIZE-H (PV-SUB)            23780000
237900                                    MR-COLOR-H (PV-SUB)           23790000
238000                                    MR-OPT-BLK-H (PV-SUB)         23800000
238100         END-PERFORM                                              23810000
238200     ELSE                                                         23820000
238300         PERFORM VARYING PV-SUB  FROM 1 BY 1                      23830000
238400                 UNTIL   PV-SUB > PC-ITEMS-PER-PANEL              23840000
238500                 MOVE DP015-UNP-ALP-NOR-OFF                       23850000
238600                                 TO MR-SELECTA (PV-SUB)           23860000
238700                                    MR-SIZE-A (PV-SUB)            23870000
238800                                    MR-COLOR-A (PV-SUB)           23880000
238900                                    MR-OPT-BLK-A (PV-SUB)         23890000
239000                 MOVE DP015-UNP-NUM-NOR-OFF                       23900000
239100                                 TO MR-QUANT-A (PV-SUB)           23910000
239200                 MOVE DP015-GREEN                                 23920000
239300                                 TO MR-SELECTC (PV-SUB)           23930000
239400                                    MR-QUANT-C (PV-SUB)           23940000
239500                                    MR-SIZE-C (PV-SUB)            23950000
239600                                    MR-COLOR-C (PV-SUB)           23960000
239700                                    MR-OPT-BLK-C (PV-SUB)         23970000
239800                 MOVE DP015-UNDERLINE                             23980000
239900                                 TO MR-SELECTH (PV-SUB)           23990000
240000                                    MR-QUANT-H (PV-SUB)           24000000
240100                                    MR-SIZE-H (PV-SUB)            24010000
240200                                    MR-COLOR-H (PV-SUB)           24020000
240300                                    MR-OPT-BLK-H (PV-SUB)         24030000
240400         END-PERFORM                                              24040000
240500     END-IF.                                                      24050000
240600                                                                  24060000
240700 3300-EDIT-SELECTIONS.                                            24070000
240800                                                                  24080000
240900     EVALUATE TRUE                                                24090000
241000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   24100000
241100                   ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     24110000
241200              CONTINUE                                            24120000
241300                                                                  24130000
241400         WHEN ASC-TEMP-SELECT   (ASC-BLK-SUB ASC-ITEM-SUB)        24140000
241500              IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        24150000
241600                  ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS  24160000
241700                  MOVE ASC-TEMP-SELECTED-SW                       24170000
241800                                        (ASC-BLK-SUB ASC-ITEM-SUB)24180000
241900                                 TO ASC-SELECTED-SW               24190000
242000                                        (ASC-BLK-SUB ASC-ITEM-SUB)24200000
242100              END-IF                                              24210000
242200                                                                  24220000
242300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   24230000
242400                                                             SPACE24240000
242500              EVALUATE TRUE                                       24250000
242600                  WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)     24260000
242700                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS24270000
242800                     MOVE SPACE  TO ASC-SELECTED-SW               24280000
242900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     24290000
243000                                                                  24300000
243100                  WHEN ASC-BEGIN   (ASC-BLK-SUB ASC-ITEM-SUB)     24310000
243200                       MOVE ZERO TO ASC-START-OF-SELECTED-RANGE   24320000
243300                       MOVE SPACE                                 24330000
243400                                 TO ASC-SELECTED-SW               24340000
243500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     24350000
243600                                                                  24360000
243700                  WHEN ASC-END     (ASC-BLK-SUB ASC-ITEM-SUB)     24370000
243800                       MOVE ZERO TO ASC-END-OF-SELECTED-RANGE     24380000
243900                       MOVE SPACE                                 24390000
244000                                 TO ASC-SELECTED-SW               24400000
244100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     24410000
244200             END-EVALUATE                                         24420000
244300                                                                  24430000
244400         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           24440000
244500              IF ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)           24450000
244600                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   24460000
244700              END-IF                                              24470000
244800                                                                  24480000
244900              PERFORM 3310-EDIT-RANGE                             24490000
245000                                                                  24500000
245100         WHEN ASC-TEMP-END  (ASC-BLK-SUB ASC-ITEM-SUB)            24510000
245200              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24520000
245300                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   24530000
245400              END-IF                                              24540000
245500                                                                  24550000
245600              PERFORM 3310-EDIT-RANGE                             24560000
245700                                                                  24570000
245800         WHEN OTHER                                               24580000
245900              MOVE PC-TSYMSG-00005                                24590000
246000                                 TO DP020-MSG-NUMBER              24600000
246100              SET PS-ERROR                                        24610000
246200                  DP020-MSG-FATAL                                 24620000
246300                  DP030-SET-CURSOR-APPL-1                         24630000
246400                                 TO TRUE                          24640000
246500              MOVE -1            TO MR-SELECTL (PV-SUB)           24650000
246600              MOVE DP015-RED     TO MR-SELECTC (PV-SUB)           24660000
246700              MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)           24670000
246800              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24680000
246900                  SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    24690000
247000                  MOVE SPACE     TO ASC-SELECTED-SW               24700000
247100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     24710000
247200              END-IF                                              24720000
247300     END-EVALUATE.                                                24730000
247400                                                                  24740000
247500     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     24750000
247600         IF ASC-UNT-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES       24760000
247700             MOVE ASC-UNT-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          24770000
247800                                 TO DP010I-UNEDITED-FIELD         24780000
247900             MOVE LENGTH OF ASC-UNT-QTY                           24790000
248000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     24800000
248100                                   TO DP010I-MAXIMUM-DIGITS       24810000
248200             MOVE ZERO             TO DP010I-MAXIMUM-DECIMALS     24820000
248300             SET DP010I-NEGATIVE-NOT-ALLOWED                      24830000
248400                                   TO TRUE                        24840000
248500             CALL DP010I-NUMERIC-EDIT-ROUTINE                     24850000
248510                  USING DP010I-NUMERIC-EDIT-AREA                  24851033
248600                                                                  24860000
248700             IF  DP010I-ERROR-DETECTED                            24870000
248800                 SET PS-ERROR                                     24880000
248900                     DP020-MSG-FATAL                              24890000
249000                     DP030-SET-CURSOR-APPL-1                      24900000
249100                                   TO TRUE                        24910000
249200                 MOVE PC-TSYMSG-00008                             24920000
249300                                   TO DP020-MSG-NUMBER            24930000
249400                 MOVE DP015-UNP-NUM-BRT-OFF                       24940000
249500                                   TO MR-QUANT-A (PV-SUB)         24950000
249600                 MOVE -1           TO MR-QUANT-L (PV-SUB)         24960000
249700                 MOVE DP015-RED    TO MR-QUANT-C (PV-SUB)         24970000
249800                 MOVE DP015-REVERSE                               24980000
249900                                   TO MR-QUANT-H (PV-SUB)         24990000
250000                 SET DP030-SET-CURSOR-APPL-1                      25000000
250100                                   TO TRUE                        25010000
250200                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     25020000
250300             ELSE                                                 25030000
250400                 MOVE DP010I-NUMERIC-FIELD                        25040000
250500                                   TO ASC-UNT-QTY-N               25050000
250600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   25060000
250700             END-IF                                               25070000
250800         END-IF                                                   25080000
250900                                                                  25090000
251000         IF ASC-OPT-BLK (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES AND   25100000
251100            TKTFMT-OPT-BLK-TAGS-IND = 'N'                         25110000
251200             SET PS-ERROR                                         25120000
251300                 DP020-MSG-FATAL                                  25130000
251400                 DP030-SET-CURSOR-APPL-1                          25140000
251500                               TO TRUE                            25150000
251600             MOVE PC-TSYMSG-00005                                 25160000
251700                               TO DP020-MSG-NUMBER                25170000
251800             MOVE DP015-UNP-NUM-BRT-OFF                           25180000
251900                               TO MR-OPT-BLK-A (PV-SUB)           25190000
252000             MOVE -1           TO MR-OPT-BLK-L (PV-SUB)           25200000
252100             MOVE DP015-RED    TO MR-OPT-BLK-C (PV-SUB)           25210000
252200             MOVE DP015-REVERSE                                   25220000
252300                               TO MR-OPT-BLK-H (PV-SUB)           25230000
252400             SET DP030-SET-CURSOR-APPL-1                          25240000
252500                               TO TRUE                            25250000
252600         END-IF                                                   25260000
252700                                                                  25270000
252800         IF ASC-SIZE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES AND      25280000
252900            TKTFMT-PRT-SIZE-IND = 'N'                             25290000
253000             SET PS-ERROR                                         25300000
253100                 DP020-MSG-FATAL                                  25310000
253200                 DP030-SET-CURSOR-APPL-1                          25320000
253300                               TO TRUE                            25330000
253400             MOVE PC-TSYMSG-00005                                 25340000
253500                               TO DP020-MSG-NUMBER                25350000
253600             MOVE DP015-UNP-NUM-BRT-OFF                           25360000
253700                               TO MR-SIZE-A (PV-SUB)              25370000
253800             MOVE -1           TO MR-SIZE-L (PV-SUB)              25380000
253900             MOVE DP015-RED    TO MR-SIZE-C (PV-SUB)              25390000
254000             MOVE DP015-REVERSE                                   25400000
254100                               TO MR-SIZE-H (PV-SUB)              25410000
254200             SET DP030-SET-CURSOR-APPL-1                          25420000
254300                               TO TRUE                            25430000
254400         END-IF                                                   25440000
254500                                                                  25450000
254600         IF ASC-COLOR (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES AND     25460000
254700            TKTFMT-PRT-COLOR-IND = 'N'                            25470000
254800             SET PS-ERROR                                         25480000
254900                 DP020-MSG-FATAL                                  25490000
255000                 DP030-SET-CURSOR-APPL-1                          25500000
255100                               TO TRUE                            25510000
255200             MOVE PC-TSYMSG-00005                                 25520000
255300                               TO DP020-MSG-NUMBER                25530000
255400             MOVE DP015-UNP-NUM-BRT-OFF                           25540000
255500                               TO MR-COLOR-A (PV-SUB)             25550000
255600             MOVE -1           TO MR-COLOR-L (PV-SUB)             25560000
255700             MOVE DP015-RED    TO MR-COLOR-C (PV-SUB)             25570000
255800             MOVE DP015-REVERSE                                   25580000
255900                               TO MR-COLOR-H (PV-SUB)             25590000
256000             SET DP030-SET-CURSOR-APPL-1                          25600000
256100                               TO TRUE                            25610000
256200         END-IF                                                   25620000
256300                                                                  25630000
256400     END-IF.                                                      25640000
256500                                                                  25650000
256600     SUBTRACT +1 FROM PV-ITEM-IN-USE                              25660000
256700                      ASC-ITEM-SUB.                               25670000
256800                                                                  25680000
256900     IF ASC-ITEM-SUB < 1                                          25690000
257000         SUBTRACT +1 FROM ASC-BLK-SUB                             25700000
257100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  25710000
257200     END-IF.                                                      25720000
257300                                                                  25730000
257400 3310-EDIT-RANGE.                                                 25740000
257500                                                                  25750000
257600     IF ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                 25760000
257700        IF ASC-START-OF-SELECTED-RANGE = ZERO                     25770000
257800            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  25780000
257900                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  25790000
258000            MOVE PV-ITEM-IN-USE  TO ASC-START-OF-SELECTED-RANGE   25800000
258100        ELSE                                                      25810000
258200            IF ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE       25820000
258300                CONTINUE                                          25830000
258400            ELSE                                                  25840000
258500                MOVE PC-TSYMSG-00054                              25850000
258600                                 TO DP020-MSG-NUMBER              25860000
258700                SET DP020-MSG-FATAL                               25870000
258800                    PS-ERROR                                      25880000
258900                    DP030-SET-CURSOR-APPL-1                       25890000
259000                                 TO TRUE                          25900000
259100                MOVE -1          TO MR-SELECTL (PV-SUB)           25910000
259200                MOVE DP015-RED   TO MR-SELECTC (PV-SUB)           25920000
259300                MOVE DP015-UNDERLINE                              25930000
259400                                 TO MR-SELECTH (PV-SUB)           25940000
259500            END-IF                                                25950000
259600        END-IF                                                    25960000
259700     ELSE                                                         25970000
259800         IF ASC-END-OF-SELECTED-RANGE = ZERO                      25980000
259900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 25990000
260000                    TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 26000000
260100             MOVE PV-ITEM-IN-USE TO ASC-END-OF-SELECTED-RANGE     26010000
260200         ELSE                                                     26020000
260300             IF ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE        26030000
260400                 CONTINUE                                         26040000
260500             ELSE                                                 26050000
260600                MOVE PC-TSYMSG-00055                              26060000
260700                                 TO DP020-MSG-NUMBER              26070000
260800                SET DP020-MSG-FATAL                               26080000
260900                    PS-ERROR                                      26090000
261000                    DP030-SET-CURSOR-APPL-1                       26100000
261100                                 TO TRUE                          26110000
261200                MOVE -1          TO MR-SELECTL (PV-SUB)           26120000
261300             END-IF                                               26130000
261400         END-IF                                                   26140000
261500     END-IF.                                                      26150000
261600                                                                  26160000
261700                                                                  26170000
261800 4000-BUILD-INITIAL-PANEL.                                        26180000
261900                                                                  26190000
262000     INITIALIZE ASC-BLOCK-ENTRIES (1)                             26200000
262100                ASC-BLOCK-ENTRIES (2).                            26210000
262200                                                                  26220000
262300     MOVE +1                       TO ASC-BLK-SUB.                26230000
262400     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       26240000
262500                                                                  26250000
262600     MOVE ZERO                     TO ASC-ITEM-SUB                26260000
262700                                      ASC-NUMBER-OF-ITEMS-READ    26270000
262800                                      ASC-NUMBER-OF-SELECTED-ITEMS26280000
262900                                      ASC-HIGHEST-BLOCK-WRITTEN   26290000
263000                                      ASC-START-OF-SELECTED-RANGE 26300000
263100                                      ASC-END-OF-SELECTED-RANGE   26310000
263200                                      ASC-ITEM-AT-TOP-OF-PANEL.   26320000
263300                                                                  26330000
263400     MOVE ASC-KEY-OPER-UNT-ID     TO DK-OPER-UNT-ID.              26340000
263500     MOVE ASC-KEY-FCLTY-ID        TO DK-FCLTY-ID.                 26350000
263600                                                                  26360000
263700     IF ASC-TKT-FORMAT > SPACES                                   26370000
263800         PERFORM 3010-VALIDATE-FORMAT                             26380000
263900         IF SQLCODE = +0 OR                                       26390000
264000            SQLCODE = -811                                        26400000
264100             CONTINUE                                             26410000
264200         ELSE                                                     26420000
264300             SET PS-ERROR                                         26430000
264400                 DP020-MSG-FATAL TO TRUE                          26440000
264500             MOVE PC-TSYMSG-00948                                 26450000
264600                                 TO DP020-MSG-NUMBER              26460000
264700             MOVE DP015-UNP-ALP-BRT-OFF                           26470000
264800                                 TO ATKTFMTA                      26480000
264900             MOVE DP015-RED      TO ATKTFMTC                      26490000
265000             MOVE DP015-REVERSE  TO ATKTFMTH                      26500000
265100             MOVE -1             TO ATKTFMTL                      26510000
265200             SET DP030-SET-CURSOR-APPL-1                          26520000
265300                 PS-INVALID-TICKET-FORMAT                         26530000
265400                                 TO TRUE                          26540000
265500         END-IF                                                   26550000
265600         IF PS-SAVE-HEADER-INFO                                   26560000
265700             NEXT SENTENCE                                        26570000
265800         ELSE                                                     26580000
265900             IF PRTSTK-EXTRA-TKTS-NBR = ZERO                      26590000
266000                 MOVE PRTSTK-EXTRA-TKTS-PCT TO ASC-EXTRA-TKT-PCT-N26600000
266100             ELSE                                                 26610000
266200                 MOVE PRTSTK-EXTRA-TKTS-NBR TO ASC-EXTRA-TKTS-N   26620000
266300             END-IF                                               26630000
266400         END-IF                                                   26640000
266500     END-IF.                                                      26650000
266600     MOVE ASC-TKT-FORMAT         TO ASC-SAVE-TKT-FORMAT.          26660000
266700                                                                  26670000
266800                                                                  26680000
266900     IF ASC-WORK-ORDER-REC-LIST                                   26690000
267000         PERFORM 4300-READ-ITEMS-FROM-DB                          26700000
267100     ELSE                                                         26710000
267200         PERFORM 4100-PREPARE-CURSOR                              26720000
267300                                                                  26730000
267400         PERFORM 4010-OPEN-CURSOR                                 26740000
267500                                                                  26750000
267600         PERFORM 4300-READ-ITEMS-FROM-DB                          26760000
267700                                                                  26770000
267800         PERFORM 4020-CLOSE-CURSOR                                26780000
267900     END-IF.                                                      26790000
268000                                                                  26800000
268100     MOVE +1                       TO PV-TOP-ITEM.                26810000
268200                                                                  26820000
268300     PERFORM 7000-GET-SPECIAL-INSTRS.                             26830000
268400     MOVE SPACES               TO  ASC-SPECIAL-INSTUCTIONS.       26840000
268500     IF  PS-MULT-SPECIAL-INSTRS-FOUND                             26850000
268600         MOVE PC-MULT-SPECIAL-INSTRS-MSG                          26860000
268700                               TO  ASC-SPECIAL-INSTUCTIONS        26870000
268800     ELSE                                                         26880000
268900         IF  PS-NO-SPECIAL-INSTRS-FOUND                           26890000
269000             CONTINUE                                             26900000
269100         ELSE                                                     26910000
269200             MOVE INSTCD-INSTR-DESC                               26920000
269300                               TO  ASC-SPECIAL-INSTUCTIONS        26930000
269400         END-IF                                                   26940000
269500     END-IF.                                                      26950000
269600*DH                                                               26960000
269700*DH  THE FOLLOWING TWO LINES OF CODE CAN BE REMOVED.              26970000
269800*DH  I AM COMMENTING THEM OUT FOR NOW.  IF TESTING GOES WELL,     26980000
269900*DH  THESE LINES CAN BE DELETED!!!                                26990000
270000*DH                                                               27000000
270100*DH  MOVE ASC-KEY-OPER-UNT-ID     TO DK-OPER-UNT-ID.              27010000
270200*DH  MOVE ASC-KEY-FCLTY-ID        TO DK-FCLTY-ID.                 27020000
270300     IF PS-SAVE-HEADER-INFO                                       27030000
270400         NEXT SENTENCE                                            27040000
270500     ELSE                                                         27050000
270600         MOVE SPACES TO ASC-TKT-OFFICE                            27060000
270700                        ASC-PRINTER                               27070000
270800                                                                  27080000
270900******************************************************************27090000
271000* AS OF 3/14/2002, WE NO LONGER WISH TO PRINT THE SEASON CODE ON *27100000
271100* ANY OF THE TICKETS.  I AM COMMENTING OUT THE CODE FOR NOW SO   *27110000
271200* THAT WE CAN COME BACK TO IT JUST IN CASE THE TICKETING OFFICE  *27120000
271300* WANTS TO DISPLAY THE SEASON CODE ONCE AGAIN ON THE TICKETS.    *27130000
271400*                                                                *27140000
271500*                                 -- DAN HINTZ (NEW SKU PROJECT) *27150000
271600******************************************************************27160000
271700*DH                                                               27170000
271800*DH      EXEC CICS                                                27180000
271900*DH          ASKTIME ABSTIME (ST-ABSTIME)                         27190000
272000*DH      END-EXEC                                                 27200000
272100*DH                                                               27210000
272200*DH      EXEC CICS                                                27220000
272300*DH          FORMATTIME ABSTIME (ST-ABSTIME)                      27230000
272400*DH                     MMDDYY  (PV-DATE)                         27240000
272500*DH      END-EXEC                                                 27250000
272600*DH                                                               27260000
272700*DH      IF PV-MONTH > PC-SIX                                     27270000
272800*DH          MOVE PC-FALL TO PV-SEASON-CODE-SEASON                27280000
272900*DH          COMPUTE PV-SEASON-CODE-MONTH =                       27290000
273000*DH              PV-MONTH - 6                                     27300000
273100*DH      ELSE                                                     27310000
273200*DH          MOVE PC-SPRING TO PV-SEASON-CODE-SEASON              27320000
273300*DH          MOVE PV-MONTH  TO PV-SEASON-CODE-MONTH               27330000
273400*DH      END-IF                                                   27340000
273500*DH      MOVE PV-SECOND-DIGIT-OF-YEAR                             27350000
273600*DH          TO PV-SEASON-CODE-SCND-DGT-OF-YR                     27360000
273700*DH      MOVE PV-SEASON-CODE                TO ASC-SEASON-CDE     27370000
273800*DH  END-IF.                                                      27380000
273900                                                                  27390000
274000     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          27400000
274100         SET DP020-NEXT-ACT-APPL-ERROR                            27410000
274200                                   TO TRUE                        27420000
274300         SET DP020-MSG-FATAL       TO TRUE                        27430000
274400         MOVE PC-TSYMSG-00050      TO DP020-MSG-NUMBER            27440000
274500     ELSE                                                         27450000
274600         MOVE -1                   TO APRINTRL                    27460000
274700         SET DP030-SET-CURSOR-APPL-1                              27470000
274800                                   TO TRUE                        27480000
274900         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     27490000
275000     END-IF.                                                      27500000
275100                                                                  27510000
275200/                                                                 27520000
275300*----------------------------------------------------------------*27530000
275400* OPEN THE APPROPRIATE CURSOR                                    *27540000
275500*----------------------------------------------------------------*27550000
275600                                                                  27560000
275700 4010-OPEN-CURSOR.                                                27570000
275800                                                                  27580000
275900                                                                  27590000
276000     EVALUATE TRUE                                                27600000
276100                                                                  27610000
276200        WHEN  ASC-PO-CURSOR                                       27620000
276300              EXEC SQL                                            27630000
276400                  OPEN PURITM-CURSOR                              27640000
276500              END-EXEC                                            27650000
276600              MOVE 'OPEN PO-CSR'                                  27660000
276700                               TO DP013-MESSAGE-TEXT (1)          27670000
276800                                                                  27680000
276900        WHEN  ASC-REC-CURSOR                                      27690000
277000              EXEC SQL                                            27700000
277100                  OPEN RECITM-CURSOR                              27710000
277200              END-EXEC                                            27720000
277300              MOVE 'OPEN REC-CSR'                                 27730000
277400                               TO DP013-MESSAGE-TEXT (1)          27740000
277500                                                                  27750000
277600        WHEN  ASC-LINE-CURSOR                                     27760000
277700              EXEC SQL                                            27770000
277800                  OPEN RECLNE-CURSOR                              27780000
277900              END-EXEC                                            27790000
278000              MOVE 'OPEN LINE-CSR'                                27800000
278100                               TO DP013-MESSAGE-TEXT (1)          27810000
278200                                                                  27820000
278300     END-EVALUATE.                                                27830000
278400                                                                  27840000
278500     EVALUATE TRUE                                                27850000
278600         WHEN SQLCODE = +0                                        27860000
278700              CONTINUE                                            27870000
278800         WHEN SQLWARN0 NOT = SPACE                                27880000
278900         WHEN SQLCODE  NOT = +0                                   27890000
279000              MOVE '4010-OPEN-CURSOR'                             27900000
279100                               TO DP013-PARAGRAPH                 27910000
279200              MOVE 'OPEN CURSOR'                                  27920000
279300                               TO DP013-MESSAGE-TEXT (1)          27930000
279400              MOVE SQLCA       TO DP013-SQLCA                     27940000
279500              MOVE 'TPURCHS'   TO DP013-DB2-TABLE-NAME (1)        27950000
279600              MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (2)        27960000
279700              MOVE 'TSTATCD'   TO DP013-DB2-TABLE-NAME (3)        27970000
279800              MOVE 'TRECEIV'   TO DP013-DB2-TABLE-NAME (4)        27980000
279900              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (5)        27990000
280000              SET DP013-DB2-ABEND                                 28000000
280100                               TO TRUE                            28010000
280200              PERFORM DP013-0000-PROCESS-ABEND                    28020000
280300     END-EVALUATE.                                                28030000
280400                                                                  28040000
280500/                                                                 28050000
280600*----------------------------------------------------------------*28060000
280700* CLOSE THE APPROPRIATE CURSOR                                   *28070000
280800*----------------------------------------------------------------*28080000
280900                                                                  28090000
281000 4020-CLOSE-CURSOR.                                               28100000
281100                                                                  28110000
281200     EVALUATE TRUE                                                28120000
281300        WHEN  ASC-PO-CURSOR                                       28130000
281400              EXEC SQL                                            28140000
281500                  CLOSE PURITM-CURSOR                             28150000
281600              END-EXEC                                            28160000
281700              MOVE 'CLOSE PO-CSR'                                 28170000
281800                               TO DP013-MESSAGE-TEXT (1)          28180000
281900                                                                  28190000
282000        WHEN  ASC-REC-CURSOR                                      28200000
282100              EXEC SQL                                            28210000
282200                  CLOSE RECITM-CURSOR                             28220000
282300              END-EXEC                                            28230000
282400              MOVE 'CLOSE REC-CSR'                                28240000
282500                               TO DP013-MESSAGE-TEXT (1)          28250000
282600                                                                  28260000
282700        WHEN  ASC-LINE-CURSOR                                     28270000
282800              EXEC SQL                                            28280000
282900                  CLOSE RECLNE-CURSOR                             28290000
283000              END-EXEC                                            28300000
283100              MOVE 'CLOSE LINE-CSR'                               28310000
283200                               TO DP013-MESSAGE-TEXT (1)          28320000
283300                                                                  28330000
283400     END-EVALUATE.                                                28340000
283500                                                                  28350000
283600     EVALUATE TRUE                                                28360000
283700         WHEN SQLCODE = +0                                        28370000
283800              CONTINUE                                            28380000
283900         WHEN SQLWARN0 NOT = SPACE                                28390000
284000         WHEN SQLCODE  NOT = +0                                   28400000
284100              MOVE '4020-CLOSE-CURSOR'                            28410000
284200                                   TO DP013-PARAGRAPH             28420000
284300              MOVE 'CLOSE CURSOR'  TO DP013-MESSAGE-TEXT (1)      28430000
284400              MOVE SQLCA           TO DP013-SQLCA                 28440000
284500              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    28450000
284600              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (2)    28460000
284700              MOVE 'TSTATCD'       TO DP013-DB2-TABLE-NAME (3)    28470000
284800              MOVE 'TRECEIV'       TO DP013-DB2-TABLE-NAME (4)    28480000
284900              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (5)    28490000
285000              SET DP013-DB2-ABEND  TO TRUE                        28500000
285100              PERFORM DP013-0000-PROCESS-ABEND                    28510000
285200     END-EVALUATE.                                                28520000
285300                                                                  28530000
285400/                                                                 28540000
285500*----------------------------------------------------------------*28550000
285600*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *28560000
285700*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSROR.               *28570000
285800*----------------------------------------------------------------*28580000
285900                                                                  28590000
286000 4100-PREPARE-CURSOR.                                             28600000
286100                                                                  28610000
286200     IF ASC-KEY-REC-SEQ-NBR = ZERO                                28620000
286300         SET ASC-PO-CURSOR TO TRUE                                28630000
286400     ELSE                                                         28640000
286500         IF ASC-KEY-LINE-NBR = ZERO                               28650000
286600             SET ASC-REC-CURSOR TO TRUE                           28660000
286700         ELSE                                                     28670000
286800             SET ASC-LINE-CURSOR TO TRUE                          28680000
286900         END-IF                                                   28690000
287000     END-IF.                                                      28700000
287100                                                                  28710000
287200     MOVE ASC-KEY-REC-SEQ-NBR     TO DK-REC-SEQ-NBR.              28720000
287300     MOVE ASC-KEY-LINE-NBR        TO DK-LINE-NBR.                 28730000
287400                                                                  28740000
287500/                                                                 28750000
287600*----------------------------------------------------------------*28760000
287700*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *28770000
287800*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *28780000
287900*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *28790000
288000*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *28800000
288100*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *28810000
288200*                                                                *28820000
288300*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *28830000
288400*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *28840000
288500*    UPON INITIALIZATION.                                        *28850000
288600*----------------------------------------------------------------*28860000
288700                                                                  28870000
288800 4300-READ-ITEMS-FROM-DB.                                         28880000
288900                                                                  28890000
289000     PERFORM                                                      28900000
289100         VARYING PV-READ-COUNT                                    28910000
289200         FROM 1 BY 1                                              28920000
289300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    28930000
289400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         28940000
289500                                                                  28950000
289600         PERFORM 4310-FETCH                                       28960000
289700                                                                  28970000
289800         IF  ASC-ITEMS-LEFT-ON-DB                                 28980000
289900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                28990000
290000                 ADD +1            TO ASC-ITEM-SUB                29000000
290100             ELSE                                                 29010000
290200                 ADD +1            TO ASC-BLK-SUB                 29020000
290300                 MOVE +1           TO ASC-ITEM-SUB                29030000
290400                                                                  29040000
290500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         29050000
290600                     MOVE +1       TO ASC-BLK-SUB                 29060000
290700                     SET ASC-BLOCK-MODIFIED (1)                   29070000
290800                                   TO TRUE                        29080000
290900                     PERFORM 5100-WRITE-TEMP-STORAGE              29090000
291000                     MOVE ASC-BLOCK-ENTRIES                       29100000
291100                               (PC-MAX-BLOCKS-IN-ARRAY)           29110000
291200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 29120000
291300                     ADD +1        TO ASC-BLK-SUB                 29130000
291400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   29140000
291500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      29150000
291600                                   TO TRUE                        29160000
291700                 END-IF                                           29170000
291800             END-IF                                               29180000
291900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    29190000
292000             MOVE ASC-NUMBER-OF-ITEMS-READ                        29200000
292100                                   TO ASC-LIST-ITEM-NUMBER        29210000
292200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29220000
292300             MOVE PURITM-ITM-NBR   TO DK-ITM-NBR                  29230000
292400                                      ASC-ITM-NBR                 29240000
292500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29250000
292600             SET PS-DOMAIN-INFO-NOT-FOUND                         29260000
292700                                   TO TRUE                        29270000
292800*        WHEN WE HAVE A VALID ITEM NUMBER FOR THE ITEM, WE CAN USE29280000
292900*        DATA THAT IS ON THE DOMAIN TABLES.  IF THE DATA IS NOT   29290000
293000*        FOUND ON THE DOMAIN TABLES, WE WILL DISPLAY "*'S" FOR THE29300000
293100*        MAJOR CLASS, SUB CLASS, VENDOR STYLE, COLOR, AND SIZE    29310000
293200*        FIELDS.  WE WILL NOT ALLOW TICKETS TO BE PRINTED FOR     29320000
293300*        THESE LINES (THAT EDIT WILL BE TAKEN CARE OF LATER IN THE29330000
293400*        PROGRAM).                                                29340000
293500             IF  PURITM-ITM-NBR > 0                               29350000
293600                 PERFORM 4320-GET-DOMAIN-DATA                     29360000
293700             END-IF                                               29370000
293800             IF  PS-DOMAIN-INFO-FOUND                             29380000
293900                 MOVE XLT00004-SUB-CL-NBR                         29390000
294000                                   TO ASC-SUB-CLASS               29400000
294100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29410000
294200                 MOVE XLT00004-MAJ-CL-NBR                         29420000
294300                                   TO ASC-MAJOR-CLASS             29430000
294400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29440000
294500             ELSE                                                 29450000
294600*        MOVE "*'S" TO THE MAJOR CLASS AND SUB CLASS FIELDS ON THE29460000
294700*        SCREEN.                                                  29470000
294800                 MOVE '**'         TO ASC-SUB-CLASS-X             29480000
294900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29490000
295000                                      ASC-MAJOR-CLASS-X           29500000
295100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29510000
295200             END-IF                                               29520000
295300             IF PURITM-GP-QTY > 1                                 29530000
295400                 MOVE PURITM-GP-QTY TO ASC-GP-RTL-QTY             29540000
295500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29550000
295600                 MOVE PURITM-GP-RTL-AMT                           29560000
295700                                   TO ASC-GP-RTL                  29570000
295800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29580000
295900             ELSE                                                 29590000
296000                 MOVE ZERO         TO ASC-GP-RTL-QTY              29600000
296100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29610000
296200                                      ASC-GP-RTL                  29620000
296300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29630000
296400             END-IF                                               29640000
296500             MOVE PURITM-UNT-RTL-PR-AMT                           29650000
296600                                   TO ASC-UNT-RTL-PR              29660000
296700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29670000
296800             MOVE PV-QUANTITY                                     29680000
296900                                   TO ASC-UNT-QTY-N               29690000
297000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29700000
297100                                                                  29710000
297200             IF PURITM-ITM-NBR = ZERO                             29720000
297300                 MOVE '*** NOT FOUND'                             29730000
297400                                   TO ASC-UPC-X                   29740000
297500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29750000
297600             ELSE                                                 29760000
297700                 MOVE PURITM-ITM-NBR                              29770000
297800                                   TO DK-ITM-NBR                  29780000
297900                 PERFORM 4360-SELECT-VENDOR-UPC                   29790000
298000                 EVALUATE SQLCODE                                 29800000
298100                     WHEN ZERO                                    29810000
298200                         MOVE XLT00006-UPC-NBR                    29820000
298300                                   TO ASC-UPC                     29830000
298400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29840000
298500                     WHEN OTHER                                   29850000
298600                         PERFORM 4370-SELECT-INTERNAL-UPC         29860000
298700                 END-EVALUATE                                     29870000
298800             END-IF                                               29880000
298900             IF  PS-DOMAIN-INFO-FOUND                             29890000
299000                 MOVE XLT00004-VS-NBR                             29900000
299100                                   TO ASC-VEND-STYL               29910000
299200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29920000
299300             ELSE                                                 29930000
299400                 MOVE '********************'                      29940000
299500                                   TO ASC-VEND-STYL               29950000
299600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29960000
299700             END-IF                                               29970000
299800             IF TKTFMT-PRT-COLOR-IND = 'Y'                        29980000
299900                 IF  PS-DOMAIN-INFO-FOUND                         29990000
300000                     MOVE XLT00003-CSTM-CLOR-DESC                 30000000
300100                                   TO ASC-TABLE-COLOR             30010000
300200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30020000
300300                 ELSE                                             30030000
300400                     MOVE '**********'                            30040000
300500                                   TO ASC-TABLE-COLOR             30050000
300600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30060000
300700                 END-IF                                           30070000
300800             END-IF                                               30080000
300900             IF TKTFMT-PRT-SIZE-IND = 'Y'                         30090000
301000                 IF  PS-DOMAIN-INFO-FOUND                         30100000
301100                     MOVE XLT00003-SIZE-DESC                      30110000
301200                                   TO ASC-TABLE-SIZE              30120000
301300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30130000
301400                 ELSE                                             30140000
301500                     MOVE '**********'                            30150000
301600                                   TO ASC-TABLE-SIZE              30160000
301700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30170000
301800                 END-IF                                           30180000
301900             END-IF                                               30190000
302000             MOVE PURITM-APP-PO-LNE-NBR                           30200000
302100                                   TO ASC-PO-LNE-NBR              30210000
302200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30220000
302300         END-IF                                                   30230000
302400     END-PERFORM.                                                 30240000
302500                                                                  30250000
302600     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          30260000
302700         MOVE +1                   TO ASC-BLK-SUB                 30270000
302800         PERFORM 5100-WRITE-TEMP-STORAGE                          30280000
302900         ADD +1                    TO ASC-BLK-SUB                 30290000
303000         PERFORM 5100-WRITE-TEMP-STORAGE                          30300000
303100                                                                  30310000
303200         MOVE 1                    TO ASC-BLK-SUB                 30320000
303300                                      PV-BLOCK-NUMBER             30330000
303400         PERFORM 4410-READ-TEMP-STORAGE                           30340000
303500         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             30350000
303600             MOVE 2                TO ASC-BLK-SUB                 30360000
303700                                      PV-BLOCK-NUMBER             30370000
303800             PERFORM 4410-READ-TEMP-STORAGE                       30380000
303900         END-IF                                                   30390000
304000     END-IF.                                                      30400000
304100                                                                  30410000
304200                                                                  30420000
304300 4310-FETCH.                                                      30430000
304400                                                                  30440000
304500     EVALUATE TRUE                                                30450000
304600        WHEN  ASC-PO-CURSOR                                       30460000
304700              EXEC SQL                                            30470000
304800                  FETCH PURITM-CURSOR                             30480000
304900                   INTO :PURITM-CL-NBR                            30490000
305000                       ,:PURITM-GP-QTY                            30500000
305100                       ,:PURITM-GP-RTL-AMT                        30510000
305200                       ,:PURITM-UNT-RTL-PR-AMT                    30520000
305300                       ,:PV-QUANTITY                              30530000
305400                       ,:PURITM-ITM-NBR                           30540000
305500                       ,:PURITM-VEND-STYL-NAME                    30550000
305600                       ,:PURITM-COLOR-DESC                        30560000
305700                       ,:PURITM-SIZE-DESC                         30570000
305800                       ,:PURITM-APP-PO-LNE-NBR                    30580000
305900              END-EXEC                                            30590000
306000                                                                  30600000
306100        WHEN  ASC-REC-CURSOR                                      30610000
306200              EXEC SQL                                            30620000
306300                  FETCH RECITM-CURSOR                             30630000
306400                   INTO :PURITM-CL-NBR                            30640000
306500                       ,:PURITM-GP-QTY                            30650000
306600                       ,:PURITM-GP-RTL-AMT                        30660000
306700                       ,:PURITM-UNT-RTL-PR-AMT                    30670000
306800                       ,:PURITM-ITM-NBR                           30680000
306900                       ,:PURITM-VEND-STYL-NAME                    30690000
307000                       ,:PURITM-COLOR-DESC                        30700000
307100                       ,:PURITM-SIZE-DESC                         30710000
307200                       ,:PURITM-APP-PO-LNE-NBR                    30720000
307300                       ,:RECITM-DTL-CK-ITM-QTY                    30730000
307400                       ,:RECITM-PKSL-ITM-QTY                      30740000
307500              END-EXEC                                            30750000
307600                                                                  30760000
307700        WHEN  ASC-LINE-CURSOR                                     30770000
307800              EXEC SQL                                            30780000
307900                  FETCH RECLNE-CURSOR                             30790000
308000                   INTO :PURITM-CL-NBR                            30800000
308100                       ,:PURITM-GP-QTY                            30810000
308200                       ,:PURITM-GP-RTL-AMT                        30820000
308300                       ,:PURITM-UNT-RTL-PR-AMT                    30830000
308400                       ,:PURITM-ITM-NBR                           30840000
308500                       ,:PURITM-VEND-STYL-NAME                    30850000
308600                       ,:PURITM-COLOR-DESC                        30860000
308700                       ,:PURITM-SIZE-DESC                         30870000
308800                       ,:PURITM-APP-PO-LNE-NBR                    30880000
308900              END-EXEC                                            30890000
309000                                                                  30900000
309100        WHEN  ASC-WORK-ORDER-REC-LIST                             30910000
309200            PERFORM 2300-GET-NEXT-RECORD                          30920000
309300            MOVE +0 TO SQLCODE                                    30930000
309400                                                                  30940000
309500     END-EVALUATE.                                                30950000
309600                                                                  30960000
309700     EVALUATE TRUE                                                30970000
309800         WHEN SQLCODE = +0                                        30980000
309900              CONTINUE                                            30990000
310000                                                                  31000000
310100         WHEN SQLCODE = +100                                      31010000
310200              SET ASC-NO-ITEMS-LEFT-ON-DB                         31020000
310300                                   TO TRUE                        31030000
310400                                                                  31040000
310500         WHEN SQLWARN0 NOT = SPACE                                31050000
310600         WHEN SQLCODE < +0                                        31060000
310700         WHEN SQLCODE > +0                                        31070000
310800              MOVE '4310-FETCH-CURSOR'                            31080000
310900                                   TO DP013-PARAGRAPH             31090000
311000              MOVE 'FETCH TRAILER CURSOR'                         31100000
311100                                   TO DP013-MESSAGE-TEXT (1)      31110000
311200              MOVE SQLCA           TO DP013-SQLCA                 31120000
311300              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    31130000
311400              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (2)    31140000
311500              MOVE 'TSTATCD'       TO DP013-DB2-TABLE-NAME (3)    31150000
311600              MOVE 'TRECEIV'       TO DP013-DB2-TABLE-NAME (4)    31160000
311700              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (5)    31170000
311800              SET DP013-DB2-ABEND  TO TRUE                        31180000
311900              PERFORM DP013-0000-PROCESS-ABEND                    31190000
312000     END-EVALUATE.                                                31200000
312100                                                                  31210000
312200     IF SQLCODE = +0                                              31220000
312300         EVALUATE TRUE                                            31230000
312400            WHEN  ASC-PO-CURSOR                                   31240000
312500                PERFORM 4326-SUM-MESTDS                           31250000
312600                IF PV-SUM-QTY <  PV-QUANTITY                      31260000
312700                    COMPUTE PV-QUANTITY = PV-QUANTITY -           31270000
312800                                      PV-SUM-QTY                  31280000
312900                ELSE                                              31290000
313000                    MOVE 0 TO PV-QUANTITY                         31300000
313100                END-IF                                            31310000
313200                                                                  31320000
313300            WHEN  ASC-REC-CURSOR OR                               31330000
313400                  ASC-WORK-ORDER-REC-LIST                         31340000
313500                IF RECITM-DTL-CK-ITM-QTY > ZERO                   31350000
313600                    MOVE RECITM-DTL-CK-ITM-QTY TO                 31360000
313700                                       PV-QUANTITY                31370000
313800                ELSE                                              31380000
313900                    MOVE RECITM-PKSL-ITM-QTY TO                   31390000
314000                                       PV-QUANTITY                31400000
314100                END-IF                                            31410000
314200                PERFORM 4327-SUM-RECDIS                           31420000
314300                IF PV-SUM-QTY <  PV-QUANTITY                      31430000
314400                    COMPUTE PV-QUANTITY = PV-QUANTITY -           31440000
314500                                      PV-SUM-QTY                  31450000
314600                ELSE                                              31460000
314700                    MOVE 0 TO PV-QUANTITY                         31470000
314800                END-IF                                            31480000
314900                                                                  31490000
315000            WHEN  ASC-LINE-CURSOR                                 31500000
315100                PERFORM 4325-GET-AMOUNT                           31510000
315200                PERFORM 4327-SUM-RECDIS                           31520000
315300                IF PV-SUM-QTY <  PV-QUANTITY                      31530000
315400                    COMPUTE PV-QUANTITY = PV-QUANTITY -           31540000
315500                                      PV-SUM-QTY                  31550000
315600                ELSE                                              31560000
315700                    MOVE 0 TO PV-QUANTITY                         31570000
315800                END-IF                                            31580000
315900                                                                  31590000
316000         END-EVALUATE                                             31600000
316100     END-IF.                                                      31610000
316200                                                                  31620000
316300                                                                  31630000
316400******************************************************************31640000
316500*    FETCH THE INFORMATION FROM THE XLT_SKU AND XLT_VND_STYL     *31650000
316600*    DOMAIN TABLES.                                              *31660000
316700******************************************************************31670000
316800 4320-GET-DOMAIN-DATA.                                            31680000
316900                                                                  31690000
317000     EXEC SQL                                                     31700000
317100          SELECT A.CSTM_CLOR_DESC                                 31710000
317200               , A.SIZE_DESC                                      31720000
317300               , B.MAJ_CL_NBR                                     31730000
317400               , B.SUB_CL_NBR                                     31740000
317500               , B.VS_NBR                                         31750000
317600            INTO :XLT00003-CSTM-CLOR-DESC                         31760000
317700               , :XLT00003-SIZE-DESC                              31770000
317800               , :XLT00004-MAJ-CL-NBR                             31780000
317900               , :XLT00004-SUB-CL-NBR                             31790000
318000               , :XLT00004-VS-NBR                                 31800000
318100            FROM XLT_SKU A                                        31810000
318200               , XLT_VND_STYL B                                   31820000
318300           WHERE A.ITM_NBR      = :DK-ITM-NBR                     31830000
318400             AND A.STYL_ID      = B.STYL_ID                       31840000
318500     END-EXEC.                                                    31850000
318600                                                                  31860000
318700     EVALUATE TRUE                                                31870000
318800         WHEN SQLCODE = ZERO                                      31880000
318900              SET PS-DOMAIN-INFO-FOUND                            31890000
319000                             TO TRUE                              31900000
319100         WHEN SQLCODE = +100                                      31910000
319200              SET PS-DOMAIN-INFO-NOT-FOUND                        31920000
319300                             TO TRUE                              31930000
319400         WHEN SQLWARN0 NOT = SPACES                               31940000
319500         WHEN SQLCODE  NOT = ZERO                                 31950000
319600              MOVE '4320-GET-DOMAIN-DATA'                         31960000
319700                             TO DP013-PARAGRAPH                   31970000
319800              MOVE 'UNSUCCESSFUL SELECT OF DOMAIN TABLE DATA'     31980000
319900                             TO DP013-MESSAGE-TEXT (1)            31990000
320000              MOVE SQLCA     TO DP013-SQLCA                       32000000
320100              MOVE 'XLT_SKU' TO DP013-DB2-TABLE-NAME (1)          32010000
320200              MOVE 'XLT_VND_STYL'                                 32020000
320300                             TO DP013-DB2-TABLE-NAME (2)          32030000
320400              SET DP013-DB2-ABEND                                 32040000
320500                  DP013-XCTL-DISPLAY-RESTART                      32050000
320600                             TO TRUE                              32060000
320700                                                                  32070000
320800              PERFORM DP013-0000-PROCESS-ABEND                    32080000
320900     END-EVALUATE.                                                32090000
321000                                                                  32100000
321100                                                                  32110000
321200 4325-GET-AMOUNT.                                                 32120000
321300                                                                  32130000
321400     EXEC SQL                                                     32140000
321500          SELECT DTL_CK_ITM_QTY,                                  32150000
321600                 PKSL_ITM_QTY                                     32160000
321700            INTO :RECITM-DTL-CK-ITM-QTY,                          32170000
321800                 :RECITM-PKSL-ITM-QTY                             32180000
321900            FROM TRECITM                                          32190000
322000           WHERE OPER_UNT_ID    = :DK-OPER-UNT-ID                 32200000
322100*            AND FCLTY_ID       = :DK-FCLTY-ID                    32210000
322200             AND VER_STATUS_CDE = 'A'                             32220000
322300             AND ORD_NBR        = :DK-PO-NBR                      32230000
322400             AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 32240000
322500             AND ORD_LNE_NBR    = :DK-LINE-NBR                    32250000
322600     END-EXEC.                                                    32260000
322700                                                                  32270000
322800     EVALUATE TRUE                                                32280000
322900         WHEN SQLCODE = ZERO                                      32290000
323000         WHEN SQLCODE = +100                                      32300000
323100              CONTINUE                                            32310000
323200                                                                  32320000
323300         WHEN SQLWARN0 NOT = SPACES                               32330000
323400         WHEN SQLCODE  NOT = ZERO                                 32340000
323500              MOVE '4325-GET-AMOUNT'                              32350000
323600                             TO DP013-PARAGRAPH                   32360000
323700              MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'           32370000
323800                             TO DP013-MESSAGE-TEXT (1)            32380000
323900              MOVE SQLCA     TO DP013-SQLCA                       32390000
324000              MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)          32400000
324100              SET DP013-DB2-ABEND                                 32410000
324200                  DP013-XCTL-DISPLAY-RESTART                      32420000
324300                             TO TRUE                              32430000
324400                                                                  32440000
324500              PERFORM DP013-0000-PROCESS-ABEND                    32450000
324600     END-EVALUATE.                                                32460000
324700                                                                  32470000
324800     IF SQLCODE = ZERO                                            32480000
324900          IF RECITM-DTL-CK-ITM-QTY > ZERO                         32490000
325000              MOVE RECITM-DTL-CK-ITM-QTY TO                       32500000
325100                                 PV-QUANTITY                      32510000
325200          ELSE                                                    32520000
325300              MOVE RECITM-PKSL-ITM-QTY TO                         32530000
325400                                 PV-QUANTITY                      32540000
325500          END-IF                                                  32550000
325600     END-IF.                                                      32560000
325700                                                                  32570000
325800 4326-SUM-MESTDS.                                                 32580000
325900     MOVE ZERO                     TO PV-SUM-QTY.                 32590000
326000                                                                  32600000
326100     EXEC SQL                                                     32610000
326200          SELECT SUM(STR_DISTRO_QTY)                              32620000
326300            INTO :PV-SUM-QTY :DN-SUM-QTY-NULL                     32630000
326400            FROM TMESTDS A                                        32640000
326500               , XLT_LOC B                                        32650000
326600           WHERE A.PO_NBR     = :DK-PO-NBR                        32660000
326700             AND A.PO_LNE_NBR = :PURITM-APP-PO-LNE-NBR            32670000
326800             AND A.STR_NBR    = B.LOC_NBR                         32680000
326900             AND B.LOC_TYP_CDE   IN ('DC', 'RV')                  32690000
327000     END-EXEC.                                                    32700000
327100                                                                  32710000
327200     EVALUATE TRUE                                                32720000
327300         WHEN SQLCODE = +0                                        32730000
327400              IF PV-SUM-QTY < 0                                   32740000
327500                  MOVE 0 TO PV-SUM-QTY                            32750000
327600              END-IF                                              32760000
327700         WHEN SQLCODE = +100                                      32770000
327800              CONTINUE                                            32780000
327900         WHEN SQLWARN0 NOT = SPACES                               32790000
328000         WHEN SQLCODE  NOT = ZERO                                 32800000
328100              MOVE '4326-SUM-MESTDS'                              32810000
328200                             TO DP013-PARAGRAPH                   32820000
328300              MOVE 'UNSUCCESSFUL SELECT OF MERCH DISTRO'          32830000
328400                             TO DP013-MESSAGE-TEXT (1)            32840000
328500              MOVE SQLCA     TO DP013-SQLCA                       32850000
328600              MOVE 'TMESTDS' TO DP013-DB2-TABLE-NAME (1)          32860000
328700              MOVE 'XLT_LOC' TO DP013-DB2-TABLE-NAME (2)          32870000
328800              SET DP013-DB2-ABEND                                 32880000
328900                  DP013-XCTL-DISPLAY-RESTART                      32890000
329000                             TO TRUE                              32900000
329100                                                                  32910000
329200              PERFORM DP013-0000-PROCESS-ABEND                    32920000
329300     END-EVALUATE.                                                32930000
329400                                                                  32940000
329500 4327-SUM-RECDIS.                                                 32950000
329600     MOVE ZERO                     TO PV-SUM-QTY.                 32960000
329700                                                                  32970000
329800     EXEC SQL                                                     32980000
329900          SELECT SUM(EXPTED_ITM_QTY)                              32990000
330000            INTO :PV-SUM-QTY :DN-SUM-QTY-NULL                     33000000
330100            FROM TRECDIS A                                        33010000
330200               , XLT_LOC B                                        33020000
330300           WHERE A.ORD_NBR        = :DK-PO-NBR                    33030000
330400             AND A.ORD_LNE_NBR    = :PURITM-APP-PO-LNE-NBR        33040000
330500             AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               33050000
330600             AND A.STR_NBR        = B.LOC_NBR                     33060000
330700             AND A.VER_STATUS_CDE = 'A'                           33070000
330800             AND B.LOC_TYP_CDE    IN ('DC', 'RV')                 33080000
330900     END-EXEC.                                                    33090000
331000                                                                  33100000
331100     EVALUATE TRUE                                                33110000
331200         WHEN SQLCODE = +0                                        33120000
331300              IF PV-SUM-QTY < 0                                   33130000
331400                  MOVE 0 TO PV-SUM-QTY                            33140000
331500              END-IF                                              33150000
331600         WHEN SQLCODE = +100                                      33160000
331700              CONTINUE                                            33170000
331800         WHEN SQLWARN0 NOT = SPACES                               33180000
331900         WHEN SQLCODE  NOT = ZERO                                 33190000
332000              MOVE '4327-SUM-RECDIS'                              33200000
332100                             TO DP013-PARAGRAPH                   33210000
332200              MOVE 'UNSUCCESSFUL SELECT OF RECEIV DISTRO'         33220000
332300                             TO DP013-MESSAGE-TEXT (1)            33230000
332400              MOVE SQLCA     TO DP013-SQLCA                       33240000
332500              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          33250000
332600              MOVE 'XLT_LOC' TO DP013-DB2-TABLE-NAME (2)          33260000
332700              SET DP013-DB2-ABEND                                 33270000
332800                  DP013-XCTL-DISPLAY-RESTART                      33280000
332900                             TO TRUE                              33290000
333000                                                                  33300000
333100              PERFORM DP013-0000-PROCESS-ABEND                    33310000
333200     END-EVALUATE.                                                33320000
333300                                                                  33330000
333400                                                                  33340000
333500 4330-VALIDATE-PO.                                                33350000
333600                                                                  33360000
333700     EXEC SQL                                                     33370000
333800          SELECT A.DEPT_NBR,                                      33380000
333900                 A.ENT_ID,                                        33390000
334000                 A.VER_NBR                                        33400000
334100            INTO :PURCHS-DEPT-NBR,                                33410000
334200                 :PURCHS-ENT-ID,                                  33420000
334300                 :PURCHS-VER-NBR                                  33430000
334400            FROM TPURCHS A,                                       33440000
334500                 TSTATCD B                                        33450000
334600           WHERE A.PO_NBR       = :DK-PO-NBR                      33460000
334700             AND A.VER_STATUS_CDE = 'A'                           33470000
334800             AND B.STATUS_TYP_CDE = 'P'                           33480000
334900             AND B.STATUS_CLS    IN ('ACT', 'CMP')                33490000
335000             AND B.STATUS_CDE = A.STATUS_CDE                      33500000
335100     END-EXEC.                                                    33510000
335200                                                                  33520000
335300     EVALUATE TRUE                                                33530000
335400         WHEN SQLCODE = ZERO                                      33540000
335500         WHEN SQLCODE = +100                                      33550000
335600              CONTINUE                                            33560000
335700                                                                  33570000
335800         WHEN SQLWARN0 NOT = SPACES                               33580000
335900         WHEN SQLCODE  NOT = ZERO                                 33590000
336000              MOVE '4330-VALIDATE-PO'                             33600000
336100                             TO DP013-PARAGRAPH                   33610000
336200              MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'           33620000
336300                             TO DP013-MESSAGE-TEXT (1)            33630000
336400              MOVE SQLCA     TO DP013-SQLCA                       33640000
336500              MOVE 'TPURCHS' TO DP013-DB2-TABLE-NAME (1)          33650000
336600              MOVE 'TSTATCD' TO DP013-DB2-TABLE-NAME (2)          33660000
336700              SET DP013-DB2-ABEND                                 33670000
336800                  DP013-XCTL-DISPLAY-RESTART                      33680000
336900                             TO TRUE                              33690000
337000                                                                  33700000
337100              PERFORM DP013-0000-PROCESS-ABEND                    33710000
337200     END-EVALUATE.                                                33720000
337300                                                                  33730000
337400     IF SQLCODE = ZERO                                            33740000
337500         SET PS-PO-FOUND TO TRUE                                  33750000
337600     ELSE                                                         33760000
337700         SET PS-PO-NOT-FOUND TO TRUE                              33770000
337800     END-IF.                                                      33780000
337900                                                                  33790000
338000 4340-GET-VENDOR-NAME.                                            33800000
338100                                                                  33810000
338200     EXEC SQL                                                     33820000
338300          SELECT ENT_NAME_DESC                                    33830000
338400            INTO :ENTNME-ENT-NAME-DESC                            33840000
338500            FROM TENTNME                                          33850000
338600           WHERE ENT_ID           = :DK-ENT-ID                    33860000
338700             AND TYPE_CDE         = '01'                          33870000
338800     END-EXEC.                                                    33880000
338900                                                                  33890000
339000     EVALUATE TRUE                                                33900000
339100         WHEN SQLCODE = ZERO                                      33910000
339200         WHEN SQLCODE = +100                                      33920000
339300              CONTINUE                                            33930000
339400                                                                  33940000
339500         WHEN SQLWARN0 NOT = SPACES                               33950000
339600         WHEN SQLCODE  NOT = ZERO                                 33960000
339700              MOVE '4340-GET-VENDOR-NAME'                         33970000
339800                             TO DP013-PARAGRAPH                   33980000
339900              MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'           33990000
340000                             TO DP013-MESSAGE-TEXT (1)            34000000
340100              MOVE SQLCA     TO DP013-SQLCA                       34010000
340200              MOVE 'TENTNME' TO DP013-DB2-TABLE-NAME (1)          34020000
340300              SET DP013-DB2-ABEND                                 34030000
340400                  DP013-XCTL-DISPLAY-RESTART                      34040000
340500                             TO TRUE                              34050000
340600                                                                  34060000
340700              PERFORM DP013-0000-PROCESS-ABEND                    34070000
340800     END-EVALUATE.                                                34080000
340900                                                                  34090000
341000     EVALUATE TRUE                                                34100000
341100         WHEN SQLCODE = ZERO                                      34110000
341200             MOVE ENTNME-ENT-NAME-DESC                            34120000
341300                                 TO ASC-KEY-VENDOR-NAME           34130000
341400         WHEN SQLCODE = +100                                      34140000
341500             MOVE 'VENDOR NOT FOUND'                              34150000
341600                                 TO ASC-KEY-VENDOR-NAME           34160000
341700     END-EVALUATE.                                                34170000
341800                                                                  34180000
341900                                                                  34190000
342000***************************************************************** 34200000
342100* FETCH THE VENDOR UPC FROM THE NEW XLT_UPC TABLE. THERE SHOULD * 34210000
342200* ONLY BE ONE VENDOR UPC BEING SENT EDI.  IF WE DO NOT FIND A   * 34220000
342300* VENDOR UPC, WE WILL FETCH THE INTERNAL UPC FROM THE TABLE AND * 34230000
342400* USE THAT ONE.                                                 * 34240000
342500***************************************************************** 34250000
342600 4360-SELECT-VENDOR-UPC.                                          34260000
342700                                                                  34270000
342800     INITIALIZE DCLXLT00006.                                      34280000
342900                                                                  34290000
343000     EXEC SQL                                                     34300000
343100          SELECT B.UPC_NBR                                        34310000
343200            INTO :XLT00006-UPC-NBR                                34320000
343300            FROM XLT_SKU A                                        34330000
343400               , XLT_UPC B                                        34340000
343500           WHERE A.ITM_NBR        = :DK-ITM-NBR                   34350000
343600             AND A.INTR_UPC_ID    = B.INTR_UPC_ID                 34360000
343700             AND B.UPC_TYP_CDE    = 'V'                           34370000
343800             AND EDI_ORD_IND    = 'Y'                             34380000
343900     END-EXEC.                                                    34390000
344000                                                                  34400000
344100     EVALUATE TRUE                                                34410000
344200         WHEN SQLCODE = ZERO                                      34420000
344300         WHEN SQLCODE = +100                                      34430000
344400         WHEN SQLCODE = -811                                      34440000
344500              CONTINUE                                            34450000
344600                                                                  34460000
344700         WHEN SQLWARN0 NOT = SPACES                               34470000
344800         WHEN SQLCODE  NOT = ZERO                                 34480000
344900              MOVE '4360-SELECT-VENDOR-UPC'                       34490000
345000                             TO DP013-PARAGRAPH                   34500000
345100              MOVE 'UNSUCCESSFUL SELECT OF VENDOR UPC'            34510000
345200                             TO DP013-MESSAGE-TEXT (1)            34520000
345300              MOVE PURITM-ITM-NBR                                 34530000
345400                             TO PV-ITM-NBR                        34540000
345500              STRING 'PURITM ITEM NUMBER = ' DELIMITED BY SIZE    34550000
345600                     PV-ITM-NBR-X            DELIMITED BY SIZE    34560000
345700                           INTO DP013-MESSAGE-TEXT (2)            34570000
345800              MOVE SQLCA     TO DP013-SQLCA                       34580000
345900              MOVE 'XLT_SKU' TO DP013-DB2-TABLE-NAME (1)          34590000
346000              MOVE 'XLT_UPC' TO DP013-DB2-TABLE-NAME (2)          34600000
346100              SET DP013-DB2-ABEND                                 34610000
346200                  DP013-XCTL-DISPLAY-RESTART                      34620000
346300                             TO TRUE                              34630000
346400              PERFORM DP013-0000-PROCESS-ABEND                    34640000
346500     END-EVALUATE.                                                34650000
346600                                                                  34660000
346700                                                                  34670000
346800****************************************************************  34680000
346900* FETCH THE INTERNAL UPC FROM THE XLT_UPC TABLE.  WE ARE USING *  34690000
347000* 'FETCH FIRST ROW ONLY' TO FORCE DB2 TO BRING BACK ONLY ONE   *  34700000
347100* ROW FROM THE QUERY.  THIS METHOD IS MUCH MORE EFFICIENT THAN *  34710000
347200* CHECKING FOR A -811.  THIS METHOD IS NEW IN DB2V7.           *  34720000
347300****************************************************************  34730000
347400 4370-SELECT-INTERNAL-UPC.                                        34740000
347500                                                                  34750000
347600     INITIALIZE DCLXLT00006.                                      34760000
347700                                                                  34770000
347800     EXEC SQL                                                     34780000
347900          SELECT B.UPC_NBR                                        34790000
348000            INTO :XLT00006-UPC-NBR                                34800000
348100            FROM XLT_SKU A                                        34810000
348200               , XLT_UPC B                                        34820000
348300           WHERE A.ITM_NBR        = :DK-ITM-NBR                   34830000
348400             AND A.INTR_UPC_ID    = B.INTR_UPC_ID                 34840000
348500             AND B.UPC_TYP_CDE    = 'I'                           34850000
348600           FETCH FIRST ROW ONLY                                   34860000
348700     END-EXEC.                                                    34870000
348800                                                                  34880000
348900     EVALUATE TRUE                                                34890000
349000         WHEN SQLCODE = ZERO                                      34900000
349100              MOVE XLT00006-UPC-NBR                               34910000
349200                             TO ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB)34920000
349300                                                                  34930000
349400         WHEN SQLWARN0 NOT = SPACES                               34940000
349500         WHEN SQLCODE  NOT = ZERO                                 34950000
349600              MOVE '4370-SELECT-INTERNAL-UPC'                     34960000
349700                             TO DP013-PARAGRAPH                   34970000
349800              MOVE 'UNSUCCESSFUL SELECT OF INTERNAL UPC'          34980000
349900                             TO DP013-MESSAGE-TEXT (1)            34990000
350000              MOVE PURITM-ITM-NBR                                 35000000
350100                             TO PV-ITM-NBR                        35010000
350200              STRING 'PURITM ITEM NUMBER = ' DELIMITED BY SIZE    35020000
350300                     PV-ITM-NBR-X            DELIMITED BY SIZE    35030000
350400                           INTO DP013-MESSAGE-TEXT (2)            35040000
350500              MOVE SQLCA     TO DP013-SQLCA                       35050000
350600              MOVE 'XLT_SKU' TO DP013-DB2-TABLE-NAME (1)          35060000
350700              MOVE 'XLT_UPC' TO DP013-DB2-TABLE-NAME (2)          35070000
350800              SET DP013-DB2-ABEND                                 35080000
350900                  DP013-XCTL-DISPLAY-RESTART                      35090000
351000                             TO TRUE                              35100000
351100              PERFORM DP013-0000-PROCESS-ABEND                    35110000
351200     END-EVALUATE.                                                35120000
351300                                                                  35130000
351400                                                                  35140000
351500***************************************************************   35150000
351600* THE FAMILY SHOE LABEL NEEDS THE SKU DESCRIPTION, AND THERE  *   35160000
351700* IS NOT ENOUGH ROOM IN THE COMMAREA.  WILL CALL THIS ONCE FOR*   35170000
351800* EACH SKU.                                                   *   35180000
351900***************************************************************   35190000
352000 4380-GET-SKU-DESCRIPTION.                                        35200000
352100                                                                  35210000
352200     EXEC SQL                                                     35220000
352300          SELECT                                                  35230000
352400                 A.SKU_DESC                                       35240000
352500               , B.STKR_NBR                                       35250000
352600            INTO                                                  35260000
352700                 :XLT00003-SKU-DESC                               35270000
352800               , :XLT00004-STKR-NBR                               35280000
352900            FROM XLT_SKU      A                                   35290000
353000               , XLT_VND_STYL B                                   35300000
353100           WHERE A.ITM_NBR           = :DK-ITM-NBR                35310000
353200             AND A.STYL_ID           = B.STYL_ID                  35320000
353300     END-EXEC.                                                    35330000
353400                                                                  35340000
353500     EVALUATE TRUE                                                35350000
353600     WHEN SQLCODE = ZERO                                          35360000
353700     WHEN SQLCODE = -811                                          35370000
353800         CONTINUE                                                 35380000
353900     WHEN SQLCODE = +100                                          35390000
354000         MOVE SPACES TO XLT00003-SKU-DESC                         35400000
354100         MOVE ZEROS  TO XLT00004-STKR-NBR                         35410000
354200     WHEN OTHER                                                   35420000
354300          MOVE '4380-GET-SKU-DESCRIPTION'                         35430000
354400                              TO DP013-PARAGRAPH                  35440000
354500          MOVE 'UNSUCCESSFUL SELECT OF SKU INFORMATION'           35450000
354600                              TO DP013-MESSAGE-TEXT (1)           35460000
354700          MOVE PURITM-ITM-NBR TO PV-ITM-NBR                       35470000
354800          STRING 'PURITM ITEM NUMBER = ' DELIMITED BY SIZE        35480000
354900                     PV-ITM-NBR-X        DELIMITED BY SIZE        35490000
355000                            INTO  DP013-MESSAGE-TEXT (2)          35500000
355100          MOVE SQLCA          TO DP013-SQLCA                      35510000
355200          MOVE 'XLT_SKU'      TO DP013-DB2-TABLE-NAME (1)         35520000
355300          MOVE 'XLT_VND_STYL' TO DP013-DB2-TABLE-NAME (2)         35530000
355400          SET DP013-DB2-ABEND                                     35540000
355500              DP013-XCTL-DISPLAY-RESTART                          35550000
355600                              TO TRUE                             35560000
355700          PERFORM DP013-0000-PROCESS-ABEND                        35570000
355800     END-EVALUATE.                                                35580000
355900                                                                  35590000
356000                                                                  35600000
356100************************                                          35610000
356200 4400-MOVE-COMMAREA-TO-SCREEN.                                    35620000
356300                                                                  35630000
356400     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)) AND         35640000
356500           (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1))) OR         35650000
356600           (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            35660000
356700             MOVE +1             TO ASC-BLK-SUB                   35670000
356800                                                                  35680000
356900             PERFORM 5100-WRITE-TEMP-STORAGE                      35690000
357000                                                                  35700000
357100             ADD +1              TO ASC-BLK-SUB                   35710000
357200                                                                  35720000
357300             PERFORM 5100-WRITE-TEMP-STORAGE                      35730000
357400                                                                  35740000
357500             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             35750000
357600                 GIVING PV-BLOCK-NUMBER                           35760000
357700                 REMAINDER PV-REMAINDER                           35770000
357800             IF PV-REMAINDER > ZERO                               35780000
357900                 ADD +1          TO PV-BLOCK-NUMBER               35790000
358000             END-IF                                               35800000
358100             MOVE +1             TO ASC-BLK-SUB                   35810000
358200                                                                  35820000
358300             PERFORM 4410-READ-TEMP-STORAGE                       35830000
358400                                                                  35840000
358500             ADD +1              TO ASC-BLK-SUB                   35850000
358600                                    PV-BLOCK-NUMBER               35860000
358700                                                                  35870000
358800             PERFORM 4410-READ-TEMP-STORAGE                       35880000
358900                                                                  35890000
359000     END-IF.                                                      35900000
359100                                                                  35910000
359200     MOVE +1                     TO ASC-BLK-SUB.                  35920000
359300     COMPUTE ASC-ITEM-SUB =                                       35930000
359400         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              35940000
359500                       + PC-ITEMS-PER-PANEL).                     35950000
359600                                                                  35960000
359700     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         35970000
359800         ADD +1                  TO ASC-BLK-SUB                   35980000
359900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            35990000
360000     END-IF.                                                      36000000
360100                                                                  36010000
360200     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           36020000
360300         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                36030000
360400                                                                  36040000
360500     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        36050000
360600                                                                  36060000
360700     PERFORM 4420-FORMAT-LIST-LINES                               36070000
360800         VARYING PV-SUB  FROM PC-ITEMS-PER-PANEL BY -1            36080000
360900         UNTIL   PV-SUB < +1.                                     36090000
361000                                                                  36100000
361100     COMPUTE ASC-ITEMS-DISPLAYED =                                36110000
361200                   ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).36120000
361300     MOVE PV-TOP-ITEM            TO ASC-ITEM-AT-TOP-OF-PANEL      36130000
361400                                    ASTRTITO.                     36140000
361500     MOVE ASC-ITEM-AT-BOT-OF-PANEL                                36150000
361600                                 TO AENDITO.                      36160000
361700     MOVE ASC-NUMBER-OF-ITEMS-READ                                36170000
361800                                 TO ATOTITO.                      36180000
361900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            36190000
362000                                 TO ASELITO.                      36200000
362100                                                                  36210000
362200     MOVE ASC-KEY-OPER-UNT-ID    TO AOPRUO.                       36220000
362300     MOVE ASC-KEY-FCLTY-ID       TO AFCLTYO.                      36230000
362400     MOVE ASC-KEY-FCLTY-DESC     TO AFCLTDO.                      36240000
362500     MOVE ASC-PRINTER            TO APRINTRO.                     36250000
362600     MOVE ASC-TKT-OFFICE         TO ATKTOFFO.                     36260000
362700     MOVE ASC-TKT-FORMAT         TO ATKTFMTO.                     36270000
362800*DH  MOVE ASC-SEASON-CDE         TO ASSNCDEO.                     36280000
362900     MOVE ASC-EXTRA-TKTS         TO AXTKTSO.                      36290000
363000     MOVE ASC-EXTRA-TKT-PCT      TO AXTKTPCO.                     36300000
363100     MOVE ASC-OPT-BLOCK          TO AOPTBLKO.                     36310000
363200     MOVE ASC-SPECIAL-INSTUCTIONS                                 36320000
363300                                 TO ASPINSTO.                     36330000
363400     IF ASC-KEY-REC-SEQ-NBR = ZERO                                36340000
363500         MOVE ASC-KEY-PO-NBR-N   TO ARCVRO                        36350000
363600     ELSE                                                         36360000
363700         MOVE ASC-KEY-REC-SEQ-NBR TO PV-REC-SEQ-NBR               36370000
363800         STRING                                                   36380000
363900              ASC-KEY-PO-NBR-N                                    36390000
364000              '-'                                                 36400000
364100              PV-REC-SEQ-NBR                                      36410000
364200              DELIMITED BY SIZE  INTO ARCVRO                      36420000
364300     END-IF.                                                      36430000
364400     MOVE ASC-DEPT-NBR           TO ADPTNBRO.                     36440000
364500     MOVE ASC-KEY-VENDOR-NAME    TO AVDRNMEO.                     36450000
364600                                                                  36460000
364700     IF DP020-MSG-NUMBER-X = SPACE                                36470000
364800        IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ    36480000
364900            MOVE PC-TSYMSG-00279 TO DP020-MSG-NUMBER              36490000
365000            SET DP020-MSG-INFORMATIONAL                           36500000
365100                                 TO TRUE                          36510000
365200        END-IF                                                    36520000
365300     END-IF.                                                      36530000
365400                                                                  36540000
365500 4410-READ-TEMP-STORAGE.                                          36550000
365600                                                                  36560000
365700     EXEC CICS READQ TS                                           36570000
365800               QUEUE (ASC-LIST-QUEUE-NAME)                        36580000
365900               INTO  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            36590000
366000               ITEM  (PV-BLOCK-NUMBER)                            36600000
366100               RESP  (PV-CICS-RESP)                               36610000
366200     END-EXEC.                                                    36620000
366300                                                                  36630000
366400     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     36640000
366500         (PV-CICS-RESP = DFHRESP (ITEMERR)))                      36650000
366600         CONTINUE                                                 36660000
366700     ELSE                                                         36670000
366800         SET DP013-CICS-ABEND                                     36680000
366900             DP013-NO-ROLLBACK   TO TRUE                          36690000
367000         MOVE '4410-READ-TEMP-STORAGE'                            36700000
367100                                 TO DP013-PARAGRAPH               36710000
367200         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   36720000
367300                                 TO DP013-MESSAGE-TEXT (1)        36730000
367400                                                                  36740000
367500         PERFORM DP013-0000-PROCESS-ABEND                         36750000
367600     END-IF.                                                      36760000
367700                                                                  36770000
367800     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     36780000
367900                                 TO TRUE.                         36790000
368000                                                                  36800000
368100     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          36810000
368200         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               36820000
368300     END-IF.                                                      36830000
368400                                                                  36840000
368500 4420-FORMAT-LIST-LINES.                                          36850000
368600                                                                  36860000
368700     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       36870000
368800         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                36880000
368900         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA       (PV-SUB)     36890000
369000                                    MR-QUANT-A       (PV-SUB)     36900000
369100                                    MR-SIZE-A        (PV-SUB)     36910000
369200                                    MR-COLOR-A       (PV-SUB)     36920000
369300                                    MR-OPT-BLK-A     (PV-SUB)     36930000
369400         MOVE SPACE              TO MR-SELECTI       (PV-SUB)     36940000
369500                                    MR-LINE-NBR      (PV-SUB)     36950000
369600                                    MR-QUANT         (PV-SUB)     36960000
369700                                    MR-CLASS         (PV-SUB)     36970000
369800                                    MR-UPC           (PV-SUB)     36980000
369900                                    MR-STYLE         (PV-SUB)     36990000
370000                                    MR-SIZE          (PV-SUB)     37000000
370100                                    MR-COLOR         (PV-SUB)     37010000
370200                                    MR-RETAIL        (PV-SUB)     37020000
370300                                    MR-GP-RETAIL     (PV-SUB)     37030000
370400                                    MR-OPT-BLK       (PV-SUB)     37040000
370500                                                                  37050000
370600     ELSE                                                         37060000
370700         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >     37070000
370800                                                             SPACE37080000
370900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 37090000
371000                                 TO MR-SELECTI (PV-SUB)           37100000
371100         ELSE                                                     37110000
371200             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      37120000
371300                                 TO MR-SELECTI (PV-SUB)           37130000
371400         END-IF                                                   37140000
371500                                                                  37150000
371600         IF DP030-SET-CURSOR-TRAILER                              37160000
371700            IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >  37170000
371800                                                             SPACE37180000
371900               OR PV-SUB = 1                                      37190000
372000                SET DP030-SET-CURSOR-APPL-1                       37200000
372100                                 TO TRUE                          37210000
372200                MOVE -1          TO MR-SELECTL (PV-SUB)           37220000
372300            END-IF                                                37230000
372400         END-IF                                                   37240000
372500                                                                  37250000
372600         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            37260000
372700             MOVE ASC-PO-LNE-NBR     (ASC-BLK-SUB ASC-ITEM-SUB)   37270000
372800                                 TO MR-LINE-NBR-EDITED (PV-SUB)   37280000
372900             MOVE ASC-UNT-QTY-N      (ASC-BLK-SUB ASC-ITEM-SUB)   37290000
373000                                 TO MR-QUANT-EDITED    (PV-SUB)   37300000
373100             STRING ASC-MAJOR-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)    37310000
373200                    ' '                                           37320000
373300                    ASC-SUB-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)      37330000
373400                    DELIMITED BY SIZE                             37340000
373500                               INTO MR-CLASS           (PV-SUB)   37350000
373600             MOVE ASC-UPC-X          (ASC-BLK-SUB ASC-ITEM-SUB)   37360000
373700                                 TO MR-UPC             (PV-SUB)   37370000
373800**                                                                37380000
373900** HIGHLIGHT UPC IN YELLOW WHEN IT IS NOT FOUND                   37390000
374000**                                                                37400000
374100             IF  ASC-UPC-X (ASC-BLK-SUB ASC-ITEM-SUB) =           37410000
374200                                                   '*** NOT FOUND'37420000
374300                 MOVE DP015-YELLOW                                37430000
374400                                 TO MR-UPC-C (PV-SUB)             37440000
374500             ELSE                                                 37450000
374600                 MOVE DP015-BLUE TO MR-UPC-C (PV-SUB)             37460000
374700             END-IF                                               37470000
374800             MOVE ASC-VEND-STYL      (ASC-BLK-SUB ASC-ITEM-SUB)   37480000
374900                                 TO MR-STYLE           (PV-SUB)   37490000
375000             IF ASC-DISPLAY-SIZE = 'Y'                            37500000
375100                 IF ASC-SIZE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES  37510000
375200                     MOVE ASC-SIZE   (ASC-BLK-SUB ASC-ITEM-SUB)   37520000
375300                                 TO MR-SIZE            (PV-SUB)   37530000
375400                 ELSE                                             37540000
375500                   IF ASC-SIZE (ASC-BLK-SUB ASC-ITEM-SUB) =       37550000
375600                                             LOW-VALUES           37560000
375700                     MOVE SPACES TO MR-SIZE            (PV-SUB)   37570000
375800                   ELSE                                           37580000
375900                     MOVE ASC-TABLE-SIZE                          37590000
376000                                 (ASC-BLK-SUB ASC-ITEM-SUB)       37600000
376100                                 TO MR-SIZE            (PV-SUB)   37610000
376200                   END-IF                                         37620000
376300                 END-IF                                           37630000
376400             ELSE                                                 37640000
376500                 IF ASC-SIZE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES  37650000
376600                     MOVE ASC-SIZE   (ASC-BLK-SUB ASC-ITEM-SUB)   37660000
376700                                 TO MR-SIZE            (PV-SUB)   37670000
376800                 ELSE                                             37680000
376900                     MOVE SPACES TO MR-SIZE            (PV-SUB)   37690000
377000                 END-IF                                           37700000
377100             END-IF                                               37710000
377200             IF ASC-DISPLAY-COLOR = 'Y'                           37720000
377300                 IF ASC-COLOR (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES 37730000
377400                     MOVE ASC-COLOR (ASC-BLK-SUB ASC-ITEM-SUB)    37740000
377500                                 TO MR-COLOR           (PV-SUB)   37750000
377600                 ELSE                                             37760000
377700                   IF ASC-COLOR (ASC-BLK-SUB ASC-ITEM-SUB) =      37770000
377800                                              LOW-VALUES          37780000
377900                     MOVE SPACES TO MR-COLOR           (PV-SUB)   37790000
378000                   ELSE                                           37800000
378100                     MOVE ASC-TABLE-COLOR                         37810000
378200                                 (ASC-BLK-SUB ASC-ITEM-SUB)       37820000
378300                                 TO MR-COLOR           (PV-SUB)   37830000
378400                   END-IF                                         37840000
378500                 END-IF                                           37850000
378600             ELSE                                                 37860000
378700                 IF ASC-COLOR (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES 37870000
378800                     MOVE ASC-COLOR (ASC-BLK-SUB ASC-ITEM-SUB)    37880000
378900                                 TO MR-COLOR           (PV-SUB)   37890000
379000                 ELSE                                             37900000
379100                     MOVE SPACES TO MR-COLOR           (PV-SUB)   37910000
379200                 END-IF                                           37920000
379300             END-IF                                               37930000
379400             MOVE ASC-UNT-RTL-PR     (ASC-BLK-SUB ASC-ITEM-SUB)   37940000
379500                                 TO MR-RETAIL-EDITED   (PV-SUB)   37950000
379600                                                                  37960000
379700******************************************************************37970000
379800*  IF THERE IS GROUP PRICING, FORMAT THE GROUP PRICE AS GROUP     37980000
379900*  QUANTITY, SLASH, GROUP PRICE (IE 3/7.00).  I AM USING TWO      37990000
380000*  DIFFERENT PRICE FIELDS TO ALLOW FOR GROUP PRICES 9.99 AND LOWER38000000
380100*  ALONG WITH GROUP PRICES 10.00 TO 99.99.  THIS WILL LINE UP THE 38010000
380200*  GROUP PRICE FIELD BETTER ON THE MAP.                           38020000
380300******************************************************************38030000
380400             IF ASC-GP-RTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > 1     38040000
380500                 MOVE ASC-GP-RTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB)   38050000
380600                                     TO PV-GP-QTY                 38060000
380700                 IF  ASC-GP-RTL (ASC-BLK-SUB ASC-ITEM-SUB) < 10.0038070000
380800                     MOVE ASC-GP-RTL (ASC-BLK-SUB ASC-ITEM-SUB)   38080000
380900                                     TO PV-GP-RTL-1               38090000
381000                     STRING  PC-SPACE                             38100000
381100                             PV-GP-QTY                            38110000
381200                             '/'                                  38120000
381300                             PV-GP-RTL-1                          38130000
381400                             DELIMITED BY SIZE                    38140000
381500                                   INTO MR-GP-RETAIL (PV-SUB)     38150000
381600                 ELSE                                             38160000
381700                     MOVE ASC-GP-RTL (ASC-BLK-SUB ASC-ITEM-SUB)   38170000
381800                                     TO PV-GP-RTL-2               38180000
381900                     STRING  PV-GP-QTY                            38190000
382000                             '/'                                  38200000
382100                             PV-GP-RTL-2                          38210000
382200                             DELIMITED BY SIZE                    38220000
382300                                   INTO MR-GP-RETAIL (PV-SUB)     38230000
382400                 END-IF                                           38240000
382500             ELSE                                                 38250000
382600                 MOVE SPACES         TO MR-GP-RETAIL (PV-SUB)     38260000
382700             END-IF                                               38270000
382800                                                                  38280000
382900             MOVE ASC-OPT-BLK        (ASC-BLK-SUB ASC-ITEM-SUB)   38290000
383000                                     TO MR-OPT-BLK   (PV-SUB)     38300000
383100         END-IF                                                   38310000
383200     END-IF.                                                      38320000
383300                                                                  38330000
383400     SUBTRACT +1 FROM ASC-ITEM-SUB.                               38340000
383500                                                                  38350000
383600     IF ASC-ITEM-SUB < +1                                         38360000
383700         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  38370000
383800         MOVE +1                 TO ASC-BLK-SUB.                  38380000
383900                                                                  38390000
384000 4430-CHECK-FOR-BEGIN-AND-END.                                    38400000
384100                                                                  38410000
384200     IF ASC-START-OF-SELECTED-RANGE > ZERO                        38420000
384300        IF ASC-END-OF-SELECTED-RANGE = ZERO                       38430000
384400            MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              38440000
384500            SET DP020-MSG-WARNING                                 38450000
384600                                 TO TRUE                          38460000
384700                                                                  38470000
384800            PERFORM 4431-POSITION-AT-WARNING                      38480000
384900                                                                  38490000
385000         END-IF                                                   38500000
385100     ELSE                                                         38510000
385200         IF ASC-END-OF-SELECTED-RANGE > ZERO                      38520000
385300             MOVE PC-TSYMSG-00053                                 38530000
385400                                 TO DP020-MSG-NUMBER              38540000
385500             SET DP020-MSG-WARNING                                38550000
385600                                 TO TRUE                          38560000
385700                                                                  38570000
385800             PERFORM 4431-POSITION-AT-WARNING                     38580000
385900                                                                  38590000
386000         END-IF                                                   38600000
386100     END-IF.                                                      38610000
386200                                                                  38620000
386300 4431-POSITION-AT-WARNING.                                        38630000
386400                                                                  38640000
386500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               38650000
386600                                                  PV-TOP-ITEM + 1.38660000
386700     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       38670000
386800         CONTINUE                                                 38680000
386900     ELSE                                                         38690000
387000         SET DP030-SET-CURSOR-APPL-1                              38700000
387100                                 TO TRUE                          38710000
387200         MOVE -1                 TO MR-SELECTL (PV-SUB)           38720000
387300         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           38730000
387400         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           38740000
387500     END-IF.                                                      38750000
387600                                                                  38760000
387700     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.38770000
387800                                                                  38780000
387900     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       38790000
388000         CONTINUE                                                 38800000
388100     ELSE                                                         38810000
388200         SET DP030-SET-CURSOR-APPL-1                              38820000
388300                                 TO TRUE                          38830000
388400         MOVE -1                 TO MR-SELECTL (PV-SUB)           38840000
388500         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           38850000
388600         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           38860000
388700     END-IF.                                                      38870000
388800                                                                  38880000
388900******************************************************************38890000
389000* THIS MODULE INITIALIZES DRS (DYNAMIC REPORT SYSTEM) AND         38900000
389100* ESTABLISHES THE DESTINATION OF THE TICKETS BASED UPON THE       38910000
389200* TICKET OFFICE SELECTED.                                         38920000
389300*                                                                 38930000
389400* 05/15/06 DAN HINTZ                                              38940000
389500* CODE WAS ADDED TO INITIALIZE FOR DRS CALLS OR TCP/IP SOCKET     38950000
389600* CALLS, BASED ON THE TICKET OFFICE THAT WAS SELECTED.            38960000
389700******************************************************************38970000
389800 4500-PROCESS-TICKET-REQ.                                         38980000
389900                                                                  38990000
390000     MOVE PC-INIT TO DRS01-DRRB-FUNC.                             39000000
390100                                                                  39010000
390200     MOVE TKTFMT-TKT-OFF-ADR-ID TO DRS02-DRIB-DEST                39020000
390300     MOVE ASC-TKT-OFFICE TO PV-TKT-OFFICE                         39030000
390400                                                                  39040000
390500*  DETERMINE IF THE TICKET OFFICE IS SET UP FOR THE CURRENT T200 *39050000
390600*  TICKET SYSTEM, OR THE NEW LMS TICKET SYSTEM.  IF A ROW IS     *39060000
390700*  FOUND IN TKRPRPM, THEN THE TICKET OFFICE IS SET UP FOR LMS.   *39070000
390800*  THIS ROW WILL CONTAIN THE IP ADDRESS NEEDED FOR THE TCP/IP    *39080000
390900*  SOCKET CALL, ALONG WITH THE DIRECTORY PATH (DRIVE LETTER AND  *39090000
390901*  PATH (IE. D:\PROD, E:\TEST, ETC.).  A FLAG WILL ALSO BE SET   *39090133
390902*  TO USE TCP/IP SOCKET CALLS FOR THE TICKET REQUEST.  IF A ROW  *39090200
391000*  IF A ROW IS NOT FOUND IN THE TKRPRPM TABLE, THEN THE TICKET   *39100000
391100*  OFFICE IS STILL USING THE T200 TICKET SYSTEM.  A FLAG WILL BE *39110000
391200*  SET TO USE DRS COMMANDS FOR THE TICKET REQUEST.  THE FLAG IS  *39120000
391400*  BEING SET IN PARAGRAPH "4940-FETCH-IP-ADDR".                  *39140000
391500                                                                  39150000
391600     PERFORM 4940-FETCH-IP-ADDR.                                  39160000
391700                                                                  39170000
391800     IF PV-TKT-OFFICE-1-3 = 'XXX'                                 39180000
391900         MOVE 'R'     TO DRS02-DRIB-CLASS                         39190000
392000         MOVE 'N'     TO DRS02-DRIB-HOLD                          39200000
392100         MOVE 'LOCAL' TO DRS02-DRIB-DEST                          39210000
392200     END-IF.                                                      39220000
392300                                                                  39230000
392400     MOVE DRS02-DRIB-HEADER TO DRS01-COMM-DRIB-HDR.               39240000
392500     MOVE DRS02-DRIB-ATTRIB TO DRS01-COMM-DRIB-AT1.               39250000
392600                                                                  39260000
392700     IF  PS-USE-TCP-IP-COMM                                       39270000
392800         MOVE KRPRPM-FUNC-TXT TO PV-FUNC-TXT                      39280000
392801         STRING PV-DIRECTORY-DRIVE-TXT  DELIMITED BY SIZE         39280133
392802                PC-DIRECTORY-PATH       DELIMITED BY SIZE         39280200
392803                            INTO PV-DIRECTORY-PATH                39280300
392804         PERFORM 4800-INITIALIZE-SOCKET-CALL                      39280400
392900     ELSE                                                         39290000
392910         MOVE SPACES          TO PV-DIRECTORY-PATH                39291033
393000         PERFORM 4555-LINK-TO-DRS                                 39300000
393100     END-IF.                                                      39310000
393200                                                                  39320000
393300     PERFORM 5000-PREPARE-SEL-QUEUE.                              39330000
393400                                                                  39340000
393500     MOVE PC-TERM TO DRS01-DRRB-FUNC.                             39350000
393600                                                                  39360000
393700     IF  PS-USE-TCP-IP-COMM                                       39370000
393800         PERFORM 4930-CLOSE-SOCKET                                39380000
393900     ELSE                                                         39390000
394000         PERFORM 4555-LINK-TO-DRS                                 39400000
394100     END-IF.                                                      39410000
394200                                                                  39420000
394300     IF  PV-LINES-NOT-PRINTED > 0                                 39430000
394400         IF  PS-DOMAIN-INFO-NOT-FOUND                             39440000
394500             MOVE PC-TSYMSG-03358                                 39450000
394600                                 TO DP020-MSG-NUMBER              39460000
394700         ELSE                                                     39470000
394800             IF  PS-UPC-NBR-NOT-FOUND                             39480000
394900                 MOVE PC-TSYMSG-03037                             39490000
395000                                 TO DP020-MSG-NUMBER              39500000
395100             END-IF                                               39510000
395200         END-IF                                                   39520000
395300     ELSE                                                         39530000
395400         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        39540000
395500                                 TO PV-NBR-SEL-ITEMS              39550000
395600         MOVE PV-NBR-SEL-ITEMS   TO DP020-MSG-TEXT                39560000
395700         MOVE PC-TSYMSG-01436    TO DP020-MSG-NUMBER              39570000
395800     END-IF.                                                      39580000
395900                                                                  39590000
396000******************************************************************39600000
396100* THIS MODULE CREATES DATA STREAMS FOR BUILDING ONE.  BUILDING    39610000
396200* ONE DATA STREAMS ARE CREATED IN HEADER, ONE TO MANY DETAILS AND 39620000
396300* TRAILER FORMAT.                                                 39630000
396400******************************************************************39640000
396500                                                                  39650000
396600 4505-PROCESS-TICKET-REQ.                                         39660000
396700     MOVE ASC-KEY-PO-NBR-N                                        39670000
396800                        TO PV-KEY-PO-NBR                          39680000
396900     MOVE ASC-KEY-REC-SEQ-NBR                                     39690000
397000                        TO PV-KEY-REC-SEQ-NBR                     39700000
397100     MOVE PV-JOB-ID     TO MP049O-HDR-JOB-ID.                     39710000
397200     SET PS-DOMAIN-INFO-NOT-FOUND                                 39720000
397300         PS-UPC-NBR-NOT-FOUND                                     39730000
397400         PS-RESET-SWITCHES                                        39740000
397500         PS-CREATE-HEADER TO TRUE.                                39750000
397600     PERFORM VARYING PV-ITEM  FROM 1 BY 1                         39760000
397700             UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN          39770000
397800       PERFORM 6112-READ-LIST-QUEUE                               39780000
397900       PERFORM                                                    39790000
398000       VARYING LQW-IDX  FROM 1 BY 1                               39800000
398100       UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                    39810000
398200               LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO              39820000
398300                                                                  39830000
398400******************************************************************39840000
398500* WE ARE CHECKING TO SEE IF EITHER THE UPC NUMBER OR THE DOMAIN   39850000
398600* TABLE INFORMATION ARE NOT FOUND FOR THE SELECTED LINE, SO WE    39860000
398700* CAN DISPLAY THE APPROPRIATE ERROR MESSAGE.  IF THE MAJOR CLASS  39870000
398800* FIELD CONTAINS '**', THE DOMAIN TABLE INFORMATION FOR THE LINE  39880000
398900* CANNOT BE FOUND AND WE WILL DISPLAY THE APPROPRIATE MESSAGE.    39890000
399000* OTHERWISE, IF THE UPC NUMBER FIELD CONTAINS '*** NOT FOUND',    39900000
399100* THE UPC NUMBER FOR THE LINE CANNOT BE FOUND AND THE APPROPRIATE 39910000
399200* MESSAGE WILL BE DISPLAYED.                                      39920000
399300******************************************************************39930000
399400         IF LQW-SELECT (LQW-IDX)                                  39940000
399500             IF LQW-MAJOR-CLASS-X (LQW-IDX) = '**'                39950000
399600                 ADD 1          TO PV-LINES-NOT-PRINTED           39960000
399700                 SET PS-UPC-NBR-FOUND                             39970000
399800                     PS-DO-NOT-RESET-SWITCHES                     39980000
399900                                TO TRUE                           39990000
400000             ELSE                                                 40000000
400100                 IF  LQW-UPC (LQW-IDX) = '*** NOT FOUND'          40010000
400200                     ADD 1      TO PV-LINES-NOT-PRINTED           40020000
400300                     SET PS-DOMAIN-INFO-FOUND                     40030000
400400                         PS-DO-NOT-RESET-SWITCHES                 40040000
400500                                TO TRUE                           40050000
400600                 ELSE                                             40060000
400700                     IF  PS-RESET-SWITCHES                        40070000
400800                         SET PS-DOMAIN-INFO-FOUND                 40080000
400900                             PS-UPC-NBR-FOUND                     40090000
401000                                TO TRUE                           40100000
401100                     END-IF                                       40110000
401200                     PERFORM 4525-COMPUTE-TICKET-REQ              40120000
401300                     INITIALIZE PV-QUANTITY-SEQ-NMBR              40130000
401400                     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)              40140000
401500                                TO PV-PO-LINE-NMBR-DETAIL         40150000
401600                     PERFORM 4515-CREATE-DTL-LINE                 40160000
401700                 END-IF                                           40170000
401800             END-IF                                               40180000
401900         END-IF                                                   40190000
402000       END-PERFORM                                                40200000
402100     END-PERFORM.                                                 40210000
402200                                                                  40220000
402300* WE ONLY NEED TO SEND A TRAILER RECORD FOR THE T200 TICKET SYSTEM40230000
402400* THAT WE ARE COMMUNICATING WITH USING DRS CALLS (EXISTING TICKET 40240000
402500* SYSTEM).  THE NEW AVERY DENNISON LABEL MANAGEMENT SYSTEM (LMS)  40250000
402600* DOES NOT REQUIRE A TRAILER RECORD TO BE SENT.                   40260000
402700     IF  PS-USE-DRS-COMM                                          40270000
402800         PERFORM 4550-MOVE-TRAILER-RECORD                         40280000
402900         PERFORM 4555-LINK-TO-DRS                                 40290000
403000     END-IF.                                                      40300000
403100                                                                  40310000
403200                                                                  40320000
403300******************************************************************40330000
403400* THIS MODULE CREATES A DETAIL LINE WHICH IS SENT TO DRS (DYNAMIC 40340000
403500* REPORT SYSTEM).  IF THE TICKET QUANTITY EXCEEDS THE 9999 LIMIT  40350000
403600* A SECOND DETAIL LINE IS CREATED WITH A UNIQUE CONTROL NUMBER.   40360000
403700* THE UNIQUE CONTROL NUMBER IS REQUIRED BECAUSE CURRENT SYSTEM    40370000
403800* CONSTRAINTS ON THE DENNISON TICKETING SYSTEM WILL NOT HANDLE    40380000
403900* MULTIPLE DETAIL LINES WITH THE SAME CONTROL NUMBER.             40390000
404000******************************************************************40400000
404100                                                                  40410000
404200 4515-CREATE-DTL-LINE.                                            40420000
404300     PERFORM                                                      40430000
404400         UNTIL PV-TICKET-QUANTITY                                 40440000
404500                   < PC-MAX-PC-TICKET-QUANTITY                    40450000
404600         MOVE PC-MAX-PC-TICKET-QUANTITY TO PV-NMBR-OF-TICKETS     40460000
404700         PERFORM 4540-BUILD-TICKET-DTL-REC                        40470000
404800         IF  PS-USE-TCP-IP-COMM                                   40480000
404900             INSPECT DL-DETAIL-LINE REPLACING ALL                 40490000
405000                 '' BY SPACES                                    40500000
405100             INSPECT DL-DETAIL-LINE REPLACING ALL                 40510000
405200                 ';' BY SPACES                                    40520000
405300             INSPECT DL-DETAIL-LINE REPLACING ALL                 40530000
405400                 LOW-VALUES BY SPACES                             40540000
405401             INSPECT DL-VNDR-NAME REPLACING ALL                   40540133
405402                 ',' BY SPACES                                    40540200
405403             INSPECT DL-STYLE REPLACING ALL                       40540333
405404                 ',' BY SPACES                                    40540400
405405             INSPECT DL-SIZE REPLACING ALL                        40540533
405406                 ',' BY SPACES                                    40540600
405407             INSPECT DL-COLOR REPLACING ALL                       40540733
405408                 ',' BY SPACES                                    40540800
405409             INSPECT DL-SHOE-NAME REPLACING ALL                   40540900
405410                 ',' BY SPACES                                    40541000
405500                                                                  40550000
405600             MOVE PC-DTL-REC-LENGTH TO DP081-TCPLENG              40560000
405700                                       DP081-NBR-BYTES            40570000
405800             PERFORM 8100-SEND-DATA-TO-LPMS                       40580000
405900         ELSE                                                     40590000
406000             MOVE PC-PUT TO DRS01-DRRB-FUNC                       40600000
406100             PERFORM 4555-LINK-TO-DRS                             40610000
406200         END-IF                                                   40620000
406300         COMPUTE PV-TICKET-QUANTITY =                             40630000
406400          PV-TICKET-QUANTITY - PC-MAX-PC-TICKET-QUANTITY          40640000
406500         ADD 1 TO PV-QUANTITY-SEQ-NMBR                            40650000
406600     END-PERFORM.                                                 40660000
406700                                                                  40670000
406800     IF PV-TICKET-QUANTITY NOT = ZERO                             40680000
406900         MOVE PV-TICKET-QUANTITY TO PV-NMBR-OF-TICKETS            40690000
407000         PERFORM 4540-BUILD-TICKET-DTL-REC                        40700000
407100         IF  PS-USE-TCP-IP-COMM                                   40710000
407200             INSPECT DL-DETAIL-LINE REPLACING ALL                 40720000
407300                 '' BY SPACES                                    40730000
407400             INSPECT DL-DETAIL-LINE REPLACING ALL                 40740000
407500                 ';' BY SPACES                                    40750000
407600             INSPECT DL-DETAIL-LINE REPLACING ALL                 40760000
407700                 LOW-VALUES BY SPACES                             40770000
407701             INSPECT DL-VNDR-NAME REPLACING ALL                   40770133
407702                 ',' BY SPACES                                    40770200
407703             INSPECT DL-STYLE REPLACING ALL                       40770333
407704                 ',' BY SPACES                                    40770400
407705             INSPECT DL-SIZE REPLACING ALL                        40770533
407706                 ',' BY SPACES                                    40770600
407707             INSPECT DL-COLOR REPLACING ALL                       40770733
407708                 ',' BY SPACES                                    40770800
407709             INSPECT DL-SHOE-NAME REPLACING ALL                   40770900
407710                 ',' BY SPACES                                    40771000
407800                                                                  40780000
407900             MOVE PC-DTL-REC-LENGTH TO DP081-TCPLENG              40790000
408000                                       DP081-NBR-BYTES            40800000
408100             PERFORM 8100-SEND-DATA-TO-LPMS                       40810000
408200         ELSE                                                     40820000
408300             MOVE PC-PUT TO DRS01-DRRB-FUNC                       40830000
408400             PERFORM 4555-LINK-TO-DRS                             40840000
408500         END-IF                                                   40850000
408600     END-IF.                                                      40860000
408700                                                                  40870000
408800******************************************************************40880000
408900* THIS MODULE CREATES A TOTAL LINE WHICH IS SENT TO DRS (DYNAMIC  40890000
409000* REPORT SYSTEM).  IF THE TICKET QUANTITY EXCEEDS THE 9999 LIMIT  40900000
409100* A SECOND DETAIL LINE IS CREATED WITH A UNIQUE CONTROL NUMBER.   40910000
409200* THE UNIQUE CONTROL NUMBER IS REQUIRED BECAUSE CURRENT SYSTEM    40920000
409300* CONSTRAINTS ON THE DENNISON TICKETING SYSTEM WILL NOT HANDLE    40930000
409400* MULTIPLE DETAIL LINES WITH THE SAME CONTROL NUMBER.             40940000
409500******************************************************************40950000
409600                                                                  40960000
409700 4520-CREATE-TOTAL-DTL.                                           40970000
409800     PERFORM                                                      40980000
409900         UNTIL PV-TOTAL-TICKET-QUANTITY                           40990000
410000                   < PC-MAX-PC-TICKET-QUANTITY                    41000000
410100         MOVE PC-MAX-PC-TICKET-QUANTITY TO PV-NMBR-OF-TICKETS     41010000
410200         PERFORM 4540-BUILD-TICKET-DTL-REC                        41020000
410300         MOVE PC-PUT TO DRS01-DRRB-FUNC                           41030000
410400         PERFORM 4555-LINK-TO-DRS                                 41040000
410500         COMPUTE PV-TOTAL-TICKET-QUANTITY =                       41050000
410600          PV-TOTAL-TICKET-QUANTITY - PC-MAX-PC-TICKET-QUANTITY    41060000
410700         ADD 1 TO PV-QUANTITY-SEQ-NMBR                            41070000
410800     END-PERFORM.                                                 41080000
410900                                                                  41090000
411000     IF PV-TOTAL-TICKET-QUANTITY NOT = ZERO                       41100000
411100         MOVE PV-TOTAL-TICKET-QUANTITY TO PV-NMBR-OF-TICKETS      41110000
411200         PERFORM 4540-BUILD-TICKET-DTL-REC                        41120000
411300         MOVE PC-PUT TO DRS01-DRRB-FUNC                           41130000
411400         PERFORM 4555-LINK-TO-DRS                                 41140000
411500     END-IF.                                                      41150000
411600                                                                  41160000
411700******************************************************************41170000
411800* THIS MODULE COMPUTES THE NUMBER OF TICKETS REQUIRED FOR EACH    41180000
411900* LINE ITEM SELECTED FOR TICKETS.  THERE IS A DEFAULT VALUE FOR   41190000
412000* EACH TICKET FORMAT WHICH MAY BE OVERRIDDEN BY THE USER.  THE    41200000
412100* EVALUATE FIRST DETERMINES IF THE USER KEYED AN EXTRA TICKET     41210000
412200* COUNT OR PERCENT.  IF THEY DID, THIS VALUE IS USED, OTHERWISE   41220000
412300* THE DEFAULT IS USED.                                            41230000
412400******************************************************************41240000
412500                                                                  41250000
412600 4525-COMPUTE-TICKET-REQ.                                         41260000
412700     EVALUATE TRUE                                                41270000
412800         WHEN ASC-EXTRA-TKTS NOT = SPACES AND                     41280000
412900              ASC-EXTRA-TKTS NOT = ZEROES                         41290000
413000             COMPUTE PV-TICKET-QUANTITY ROUNDED =                 41300000
413100                ASC-EXTRA-TKTS-N + LQW-UNT-QTY (LQW-IDX)          41310000
413200         WHEN ASC-EXTRA-TKTS NOT = SPACES AND                     41320000
413300              ASC-EXTRA-TKTS  = ZEROES                            41330000
413400             COMPUTE PV-TICKET-QUANTITY ROUNDED =                 41340000
413500                 LQW-UNT-QTY (LQW-IDX)                            41350000
413600         WHEN ASC-EXTRA-TKT-PCT NOT = SPACES AND                  41360000
413700              ASC-EXTRA-TKT-PCT NOT = ZEROES AND                  41370000
413800              LQW-UNT-QTY (LQW-IDX) > ZERO                        41380000
413900             COMPUTE PV-TICKET-QUANTITY ROUNDED =                 41390000
414000                (ASC-EXTRA-TKT-PCT-N  * LQW-UNT-QTY (LQW-IDX))    41400000
414100                   / 100 + LQW-UNT-QTY (LQW-IDX)                  41410000
414200         WHEN PRTSTK-EXTRA-TKTS-NBR = ZERO AND                    41420000
414300              LQW-UNT-QTY (LQW-IDX) > ZERO                        41430000
414400             COMPUTE PV-TICKET-QUANTITY ROUNDED =                 41440000
414500                (PRTSTK-EXTRA-TKTS-PCT * LQW-UNT-QTY (LQW-IDX))   41450000
414600                          / 100 + LQW-UNT-QTY (LQW-IDX)           41460000
414700         WHEN OTHER                                               41470000
414800             COMPUTE PV-TICKET-QUANTITY ROUNDED =                 41480000
414900                PRTSTK-EXTRA-TKTS-NBR                             41490000
415000                   + LQW-UNT-QTY (LQW-IDX)                        41500000
415100     END-EVALUATE.                                                41510000
415200                                                                  41520000
415300     COMPUTE PV-TOTAL-TICKET-QUANTITY =                           41530000
415400         PV-TOTAL-TICKET-QUANTITY + PV-TICKET-QUANTITY.           41540000
415500                                                                  41550000
415600******************************************************************41560000
415700* THIS MODULE BUILDS A HEADER DATA STREAM WHICH IS SENT TO THE    41570000
415800* DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC REPORT SYSTEM).      41580000
415900* THE FOLLOWING TICKET FORMATS ARE CONVERTED TO MATCH THE FORMATS 41590000
416000* AS DEFINED ON THE DENNISON TICKETING SYSTEM:  T9180 BECOMES     41600000
416100* T9180D AND L9150 BECOMES L9150C.                                41610000
416200******************************************************************41620000
416300                                                                  41630000
416400 4535-BUILD-HDR-RECORD.                                           41640000
416500     INITIALIZE DL-FORMAT-NAME.                                   41650000
416600                                                                  41660000
416700     IF (PV-TKT-FMT-ID = 'LABEL') AND                             41670000
416800        (LQW-GP-RTL-QTY (LQW-IDX) > ZERO)                         41680000
416900         MOVE 'LABEL  '                                           41690000
417000                    TO MP049O-HDR-FORMAT-NAME                     41700000
417100         STRING PV-DIRECTORY-PATH DELIMITED BY SIZE               41710000
417200                'LABEL.LBL'       DELIMITED BY SIZE               41720000
417300                  INTO DL-FORMAT-NAME                             41730000
417400         MOVE 'LABEL   '                                          41740000
417500                    TO MP049O-HDR-STOCK-TYPE                      41750000
417600         SET PS-MULTI-PRICE-HEADER TO TRUE                        41760000
417700                                                                  41770000
417800     ELSE                                                         41780000
417900         IF (PV-TKT-FMT-ID   = 'EASYOF'  OR                       41790000
418000             PV-TKT-FMT-ID   = 'ESYGWP'  OR                       41800000
418100             PV-TKT-FMT-ID   = 'GUMSOC') AND                      41810000
418200            (LQW-GP-RTL-QTY (LQW-IDX) > ZERO) AND                 41820000
418300            (ASC-TKT-FORMAT NOT = 'ESYGWP')                       41830000
418400             MOVE 'EASYOF '                                       41840000
418500                        TO MP049O-HDR-FORMAT-NAME                 41850000
418600             STRING PV-DIRECTORY-PATH DELIMITED BY SIZE           41860000
418700                    'EASYOF.LBL'      DELIMITED BY SIZE           41870000
418800                      INTO DL-FORMAT-NAME                         41880000
418900             MOVE 'EASYOF  '                                      41890000
419000                        TO MP049O-HDR-STOCK-TYPE                  41900000
419100             SET PS-MULTI-PRICE-HEADER TO TRUE                    41910000
419200                                                                  41920000
419300         ELSE                                                     41930000
419400             MOVE ASC-TKT-FORMAT                                  41940000
419500                        TO MP049O-HDR-FORMAT-NAME                 41950000
419600                           DL-FORMAT-NAME                         41960000
419700             STRING PV-DIRECTORY-PATH DELIMITED BY SIZE           41970000
419800                    ASC-TKT-FORMAT    DELIMITED BY ' '            41980000
419900                    '.LBL'            DELIMITED BY SIZE           41990000
420000                      INTO DL-FORMAT-NAME                         42000000
420100             MOVE TKTFMT-PAPER-TYP-ID                             42010000
420200                        TO MP049O-HDR-STOCK-TYPE                  42020000
420300         END-IF                                                   42030000
420400     END-IF.                                                      42040000
420500                                                                  42050000
420600* WE ONLY NEED TO SEND A HEADER RECORD FOR THE T200 TICKET SYSTEM 42060000
420700* THAT WE ARE COMMUNICATING WITH USING DRS CALLS (EXISTING TICKET 42070000
420800* SYSTEM).  THE NEW AVERY DENNISON LABEL MANAGEMENT SYSTEM (LMS)  42080000
420900* DOES NOT REQUIRE A HEADER RECORD TO BE SENT.                    42090000
421000     IF  PS-USE-DRS-COMM                                          42100000
421100         MOVE SPACES               TO DRS01-COMM-CTL              42110000
421200         MOVE MP049O-HEADER-RECORD TO DRS01-COMM-DATA             42120000
421300         MOVE PC-PUT               TO DRS01-DRRB-FUNC             42130000
421400         PERFORM 4555-LINK-TO-DRS                                 42140000
421500     END-IF.                                                      42150000
421600                                                                  42160000
421700******************************************************************42170000
421800* THIS MODULE EVALUATES WHICH DATA STREAM FORMAT WILL BE BUILT    42180000
421900* FOR THE TICKET FORMAT SELECTED AND SENDS CONTROL TO THE         42190000
422000* APPROPRIATE MODULE.                                             42200000
422100******************************************************************42210000
422200                                                                  42220000
422300 4540-BUILD-TICKET-DTL-REC.                                       42230000
422400     INITIALIZE DL-RECEIVER                                       42240000
422500                DL-VNDR-NAME                                      42250000
422600                DL-PRINTER-LOCATION                               42260000
422700                DL-PO-LINE                                        42270000
422800                DL-QTY                                            42280000
422900                DL-DEPT                                           42290000
423000                DL-CLASS                                          42300000
423100                DL-SUB-CLASS                                      42310000
423200                DL-RETAIL                                         42320000
423300                DL-RETAIL-GWP                                     42330000
423400                DL-STYLE                                          42340000
423500                DL-UPC                                            42350000
423600                DL-SIZE                                           42360000
423700                DL-COLOR                                          42370000
423800                DL-STICKER-NBR                                    42380000
423900                DL-OPTION-BLK                                     42390000
424000                DL-MULTICOUNT                                     42400000
424100                DL-MULTIPRICE                                     42410000
424200                DL-OPTION-BLK                                     42420000
424300                DL-SHOE-NAME                                      42430000
424400                DL-PUT-AWAY-CODE.                                 42440000
424500                                                                  42450000
424600     EVALUATE PV-TKT-FMT-ID                                       42460000
424700         WHEN 'ID'                                                42470000
424800             PERFORM 4610-BLD-ID-LABEL-DTL                        42480000
424900         WHEN 'EASYOF'                                            42490000
425000         WHEN 'GUMSOC'                                            42500000
425100         WHEN 'ESYGWP'                                            42510000
425200             PERFORM 4620-BLD-EASY-OFF-LABEL-DTL                  42520000
425300         WHEN 'JEWST'                                             42530000
425400             PERFORM 4630-BLD-JEWST-LABEL-DTL                     42540000
425500         WHEN 'LABEL'                                             42550000
425600             PERFORM 4640-BLD-LABEL-LABEL-DTL                     42560000
425700         WHEN 'TAG'                                               42570000
425800         WHEN 'TAGGWP'                                            42580000
425900         WHEN 'HTAG'                                              42590000
426000         WHEN 'HNGSOC'                                            42600000
426100             PERFORM 4650-BLD-TAG-LABEL-DTL                       42610000
426200         WHEN 'SUPRES'                                            42620000
426300             PERFORM 4660-BLD-SUPRESS-LABEL-DTL                   42630000
426400         WHEN 'FAMILY'                                            42640000
426500             PERFORM 4670-BLD-FAMILY-LABEL-DTL                    42650000
426600         WHEN 'SHOSUP'                                            42660000
426700             PERFORM 4675-BLD-SUPRES-SHOE-LABEL-DTL               42670000
426800         WHEN 'PRICE '                                            42680000
426900             PERFORM 4685-BLD-PRICE-LABEL-DTL                     42690000
427000     END-EVALUATE.                                                42700000
427100     IF PS-CREATE-HEADER                                          42710000
427200         MOVE DRS01-COMMAREA TO PV-SAVE-COMM-DATA                 42720000
427300         PERFORM 4535-BUILD-HDR-RECORD                            42730000
427400         SET PS-HEADER-CREATED TO TRUE                            42740000
427500         MOVE PV-SAVE-COMM-DATA TO DRS01-COMMAREA                 42750000
427600     END-IF.                                                      42760000
427700                                                                  42770000
427800******************************************************************42780000
427900* THIS MODULE MOVES A TRAILER DATA STREAM WHICH IS SENT TO THE    42790000
428000* DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC REPORT SYSTEM).      42800000
428100******************************************************************42810000
428200                                                                  42820000
428300 4550-MOVE-TRAILER-RECORD.                                        42830000
428400     MOVE SPACES                        TO DRS01-COMM-CTL.        42840000
428500     MOVE MP049O-TICKET-TRAILER-RECORD  TO DRS01-COMM-DATA.       42850000
428600     MOVE PC-PUT                        TO DRS01-DRRB-FUNC.       42860000
428700                                                                  42870000
428800******************************************************************42880000
428900* THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     42890000
429000******************************************************************42900000
429100                                                                  42910000
429200 4555-LINK-TO-DRS.                                                42920000
429300                                                                  42930000
429400     EXEC CICS                                                    42940000
429500         LINK                                                     42950000
429600             PROGRAM   ('DRS1INTC')                               42960000
429700             COMMAREA  (DRS01-COMMAREA)                           42970000
429800     END-EXEC.                                                    42980000
429900                                                                  42990000
430000     EVALUATE TRUE                                                43000000
430100         WHEN DRS01-DRRB-RC = ZERO                                43010000
430200             CONTINUE                                             43020000
430300         WHEN OTHER                                               43030000
430400             MOVE '4555-LINK-TO-DRS'    TO DP013-PARAGRAPH        43040000
430500             SET DP013-OTHER-ABEND      TO TRUE                   43050000
430600             MOVE DRS01-DRRB-FUNC       TO PV-DRS-DRRB-FUNC       43060000
430700             MOVE DRS01-DRRB-RID        TO PV-DRS-DRRB-RID        43070000
430800             MOVE DRS01-DRRD-OPTIONS    TO PV-DRS-DRRB-OPTIONS    43080000
430900             MOVE DRS01-DRRB-RC         TO PV-DRS-DRRB-RC         43090000
431000             MOVE DRS01-DRRB-ATTR-ERROR TO PV-DRS-ATTR-ERROR      43100000
431100             MOVE DRS01-DRRB-DRDC       TO PV-DRS-DRRB-DRDC       43110000
431200             MOVE DRS01-DRRB01-LINES    TO PV-DRS-DRRB-LINES      43120000
431300             MOVE PV-DRS-ABEND-DISPLAY-LINE1                      43130000
431400                                        TO DP013-MESSAGE-TEXT (1) 43140000
431500             MOVE PV-DRS-ABEND-DISPLAY-LINE2                      43150000
431600                                        TO DP013-MESSAGE-TEXT (2) 43160000
431700             PERFORM DP013-0000-PROCESS-ABEND                     43170000
431800     END-EVALUATE.                                                43180000
431900                                                                  43190000
432000                                                                  43200000
432100******************************************************************43210000
432200* THIS MODULE BUILDS THE DATA STREAM FOR A COMPANION TICKET WITH  43220000
432300* ONE DESCRIPTION LINE (SHOE STICKER) WHICH IS SENT TO THE        43230000
432400* DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC REPORT SYSTEM).      43240000
432500*                                                                 43250000
432600* ANOTHER DATA STREAM (DL-DETAIL-LINE) IS ALSO GETTING CREATED.   43260000
432700* IF THE TICKET OFFICE IS USING THE LMS TICKET SYSTEM, THIS NEW   43270000
432800* DATA STREAM WILL BE SENT TO THE AVERY DENNISON TICKET SYSTEM,   43280000
432900* USING TCP/IP SOCKET CALLS.                                      43290000
433000******************************************************************43300000
433100                                                                  43310000
433200 4610-BLD-ID-LABEL-DTL.                                           43320000
433300     IF PS-CREATE-HEADER                                          43330000
433400         MOVE PC-HHP                TO MP049O-ID-TASK             43340000
433500     ELSE                                                         43350000
433600         MOVE PC-PRINT              TO MP049O-ID-TASK             43360000
433700     END-IF.                                                      43370000
433800                                                                  43380000
433900     MOVE PV-PO-REC-SEQ             TO MP049O-ID-RECEIVER         43390000
434000                                       DL-RECEIVER.               43400000
434100     MOVE ASC-KEY-VENDOR-NAME       TO MP049O-ID-VNDR-NAME        43410000
434200                                       DL-VNDR-NAME.              43420000
434300     MOVE ASC-PRINTER               TO MP049O-ID-LOCATION         43430000
434400                                       DL-PRINTER-LOCATION.       43440000
434500****  4380-GET-SKU-DESCRIPTION IS PERFORMED TO GET STICKER-NBR    43450000
434600     MOVE LQW-ITM-NBR (LQW-IDX)     TO DK-ITM-NBR.                43460000
434700     PERFORM 4380-GET-SKU-DESCRIPTION.                            43470000
434800     MOVE XLT00004-STKR-NBR         TO ASC-STICKER-NBR            43480000
434900                                       PV-STICKER-NBR-ZZ999.      43490000
435000     MOVE PV-STICKER-NBR-ZZ999      TO MP049O-ID-STICKERNO        43500000
435100                                       DL-STICKER-NBR.            43510000
435200     MOVE PV-NMBR-OF-TICKETS        TO PV-NMBR-OF-TICKETS-4-DGT   43520000
435300                                       MP049O-ID-SYS-QTY.         43530000
435400     MOVE PV-NMBR-OF-TICKETS-4-DGT  TO MP049O-ID-QTY              43540000
435500                                       DL-QTY.                    43550000
435600     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                              43560000
435700                                    TO MP049O-ID-PO-LINE          43570000
435800                                       DL-PO-LINE.                43580000
435900     MOVE SPACES                    TO DRS01-COMM-CTL.            43590000
436000     MOVE MP049O-DETAIL-ID          TO DRS01-COMM-DATA.           43600000
436100                                                                  43610000
436200******************************************************************43620000
436300* THIS MODULE BUILDS THE DATA STREAM FOR EASY OFF STICKER LABELS  43630000
436400* WHICH IS SENT TO THE DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC 43640000
436500* REPORT SYSTEM).                                                 43650000
436600*                                                                 43660000
436700* ANOTHER DATA STREAM (DL-DETAIL-LINE) IS ALSO GETTING CREATED.   43670000
436800* IF THE TICKET OFFICE IS USING THE LMS TICKET SYSTEM, THIS NEW   43680000
436900* DATA STREAM WILL BE SENT TO THE AVERY DENNISON TICKET SYSTEM,   43690000
437000* USING TCP/IP SOCKET CALLS.                                      43700000
437100******************************************************************43710000
437200                                                                  43720000
437300 4620-BLD-EASY-OFF-LABEL-DTL.                                     43730000
437400     IF ASC-TKT-FORMAT    = 'ESYGWP'                              43740000
437500         IF PS-CREATE-HEADER                                      43750000
437600             MOVE PC-HHP              TO MP049O-EASYGWP-TASK      43760000
437700         ELSE                                                     43770000
437800             MOVE PC-HP               TO MP049O-EASYGWP-TASK      43780000
437900         END-IF                                                   43790000
438000         MOVE PV-PO-REC-SEQ           TO MP049O-EASYGWP-RECEIVER  43800000
438100                                         DL-RECEIVER              43810000
438200         MOVE ASC-KEY-VENDOR-NAME     TO MP049O-EASYGWP-VNDR-NAME 43820000
438300                                         DL-VNDR-NAME             43830000
438400         MOVE ASC-PRINTER             TO MP049O-EASYGWP-LOCATION  43840000
438500                                         DL-PRINTER-LOCATION      43850000
438600         MOVE ASC-DEPT-NBR            TO MP049O-EASYGWP-DEPT      43860000
438700                                         DL-DEPT                  43870000
438800         MOVE LQW-MAJOR-CLASS (LQW-IDX)                           43880000
438900                                      TO MP049O-EASYGWP-CLASS     43890000
439000                                         DL-CLASS                 43900000
439100         MOVE LQW-SUB-CLASS (LQW-IDX) TO MP049O-EASYGWP-SUB-CLASS 43910000
439200                                         DL-SUB-CLASS             43920000
439300         MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                         43930000
439400                                      TO MP049O-EASYGWP-RETAIL    43940000
439500                                         DL-RETAIL                43950000
439600         MOVE LQW-UNT-RTL-PR-X  (LQW-IDX)                         43960000
439700                                      TO DL-RETAIL-GWP            43970000
439800*DH      MOVE ASC-SEASON-CDE          TO MP049O-EASYGWP-SEASON    43980000
439900         MOVE LQW-UPC (LQW-IDX)       TO MP049O-EASYGWP-UPC       43990000
440000                                         DL-UPC                   44000000
440100         MOVE LQW-VEND-STYL(LQW-IDX)  TO MP049O-EASYGWP-STYLE     44010000
440200                                         DL-STYLE                 44020000
440300* PO LINE IS NEEDED FOR NEW TICKET SYSTEM AT PATTERSON.  THIS     44030000
440400* VARIABLE IS PART OF THE DATASET NAME FOR THE FILE THAT CONTAINS 44040000
440500* THE DATA STREAM THAT WAS SENT TO AVERY WATCH FOR PROCESSING.    44050000
440600         MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                          44060000
440700                                      TO DL-PO-LINE               44070000
440800                                                                  44080000
440900         MOVE PV-NMBR-OF-TICKETS   TO PV-NMBR-OF-TICKETS-4-DGT    44090000
441000                                      MP049O-EASYGWP-SYS-QTY      44100000
441100         MOVE PV-NMBR-OF-TICKETS-4-DGT TO MP049O-EASYGWP-QTY      44110000
441200                                          DL-QTY                  44120000
441300         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        44130000
441400                                   TO PV-NUMBER-OF-SELECTED-ITEMS 44140000
441500         MOVE PV-NUMBER-OF-SELECTED-ITEMS                         44150000
441600                                      TO MP049O-EASYGWP-TOTAL-SKU 44160000
441700                                         DL-TOTAL-SKU             44170000
441800         MOVE SPACES                  TO DRS01-COMM-CTL           44180000
441900         MOVE MP049O-DETAIL-EASYGWP   TO DRS01-COMM-DATA          44190000
442000     ELSE                                                         44200000
442100         IF PS-CREATE-HEADER                                      44210000
442200             MOVE PC-HHP              TO MP049O-EASYOFF-TASK      44220000
442300         ELSE                                                     44230000
442400             MOVE PC-HP               TO MP049O-EASYOFF-TASK      44240000
442500         END-IF                                                   44250000
442600         MOVE PV-PO-REC-SEQ           TO MP049O-EASYOFF-RECEIVER  44260000
442700                                         DL-RECEIVER              44270000
442800         MOVE ASC-KEY-VENDOR-NAME                                 44280000
442900                                      TO MP049O-EASYOFF-VNDR-NAME 44290000
443000                                         DL-VNDR-NAME             44300000
443100         MOVE ASC-PRINTER             TO MP049O-EASYOFF-LOCATION  44310000
443200                                         DL-PRINTER-LOCATION      44320000
443300         MOVE ASC-DEPT-NBR            TO MP049O-EASYOFF-DEPT      44330000
443400                                         DL-DEPT                  44340000
443500         MOVE LQW-MAJOR-CLASS (LQW-IDX)                           44350000
443600                                      TO MP049O-EASYOFF-CLASS     44360000
443700                                         DL-CLASS                 44370000
443800         MOVE LQW-SUB-CLASS (LQW-IDX) TO MP049O-EASYOFF-SUB-CLASS 44380000
443900                                         DL-SUB-CLASS             44390000
444000*DH      MOVE ASC-SEASON-CDE          TO MP049O-EASYOFF-SEASON    44400000
444100         MOVE LQW-UNT-RTL-PR-X  (LQW-IDX)                         44410000
444200                                      TO MP049O-EASYOFF-RETAIL    44420000
444300         MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                         44430000
444400                                      TO DL-RETAIL                44440000
444500         IF ((LQW-GP-RTL-QTY (LQW-IDX) = ZERO)                    44450000
444600                   OR                                             44460000
444700             (LQW-UNT-RTL-PR (LQW-IDX) = ZERO))                   44470000
444800             MOVE SPACES              TO MP049O-EASYOFF-MULTICOUNT44480000
444900                                         DL-MULTICOUNT            44490000
445000         ELSE                                                     44500000
445100             MOVE LQW-GP-RTL-QTY (LQW-IDX)                        44510000
445200                                      TO  PV-GP-QTY-1             44520000
445300             MOVE PV-GP-QTY-SLASH     TO MP049O-EASYOFF-MULTICOUNT44530000
445400                                         DL-MULTICOUNT            44540000
445500         END-IF                                                   44550000
445600                                                                  44560000
445700         IF ((LQW-GP-RTL (LQW-IDX) = ZERO)                        44570000
445800                   OR                                             44580000
445900             (LQW-UNT-RTL-PR (LQW-IDX) = ZERO))                   44590000
446000             MOVE SPACES          TO MP049O-EASYOFF-MULTIPRICE    44600000
446100                                     DL-MULTIPRICE                44610000
446200         ELSE                                                     44620000
446300             IF LQW-GP-RTL (LQW-IDX) < 10.00                      44630000
446400                MOVE LQW-GP-RTL   (LQW-IDX)                       44640000
446500                                  TO PV-GP-RTL-DOLLAR-1           44650000
446600                MOVE PV-GP-RTL-DOLLAR-1                           44660000
446700                                  TO MP049O-EASYOFF-MULTIPRICE    44670000
446800                                     DL-MULTIPRICE                44680000
446900             ELSE                                                 44690000
447000                MOVE LQW-GP-RTL   (LQW-IDX)                       44700000
447100                                  TO PV-GP-RTL-DOLLAR-2           44710000
447200                MOVE PV-GP-RTL-DOLLAR-2                           44720000
447300                                  TO MP049O-EASYOFF-MULTIPRICE    44730000
447400                                     DL-MULTIPRICE                44740000
447500             END-IF                                               44750000
447600         END-IF                                                   44760000
447700         MOVE LQW-UPC (LQW-IDX)       TO MP049O-EASYOFF-UPC       44770000
447800                                         DL-UPC                   44780000
447900         MOVE LQW-VEND-STYL(LQW-IDX)  TO MP049O-EASYOFF-STYLE     44790000
448000                                         DL-STYLE                 44800000
448100         MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                          44810000
448200                                      TO MP049O-EASYOFF-PO-LINE   44820000
448300                                         DL-PO-LINE               44830000
448400                                                                  44840000
448500         MOVE PV-NMBR-OF-TICKETS      TO PV-NMBR-OF-TICKETS-4-DGT 44850000
448600                                         MP049O-EASYOFF-SYS-QTY   44860000
448700         MOVE PV-NMBR-OF-TICKETS-4-DGT                            44870000
448800                                      TO MP049O-EASYOFF-QTY       44880000
448900                                         DL-QTY                   44890000
449000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        44900000
449100                                    TO PV-NUMBER-OF-SELECTED-ITEMS44910000
449200         MOVE PV-NUMBER-OF-SELECTED-ITEMS                         44920000
449300                                      TO MP049O-EASYOFF-TOTAL-SKU 44930000
449400                                         DL-TOTAL-SKU             44940000
449500         MOVE SPACES                  TO DRS01-COMM-CTL           44950000
449600         MOVE MP049O-DETAIL-EASYOFF                               44960000
449700                                      TO DRS01-COMM-DATA          44970000
449800     END-IF.                                                      44980000
449900                                                                  44990000
450000******************************************************************45000000
450100* THIS MODULE BUILDS THE DATA STREAM FOR SMALL GUM LABELS WHICH   45010000
450200* IS SENT TO THE DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC       45020000
450300* REPORT SYSTEM).                                                 45030000
450400*                                                                 45040000
450500* ANOTHER DATA STREAM (DL-DETAIL-LINE) IS ALSO GETTING CREATED.   45050000
450600* IF THE TICKET OFFICE IS USING THE LMS TICKET SYSTEM, THIS NEW   45060000
450700* DATA STREAM WILL BE SENT TO THE AVERY DENNISON TICKET SYSTEM,   45070000
450800* USING TCP/IP SOCKET CALLS.                                      45080000
450900******************************************************************45090000
451000                                                                  45100000
451100 4630-BLD-JEWST-LABEL-DTL.                                        45110000
451200     IF PS-CREATE-HEADER                                          45120000
451300         MOVE PC-HHP              TO MP049O-JEWST-TASK            45130000
451400     ELSE                                                         45140000
451500         MOVE PC-HP               TO MP049O-JEWST-TASK            45150000
451600     END-IF.                                                      45160000
451700     MOVE PV-PO-REC-SEQ           TO MP049O-JEWST-RECEIVER        45170000
451800                                     DL-RECEIVER.                 45180000
451900     MOVE ASC-KEY-VENDOR-NAME     TO MP049O-JEWST-VNDR-NAME       45190000
452000                                     DL-VNDR-NAME.                45200000
452100     MOVE ASC-PRINTER             TO MP049O-JEWST-LOCATION        45210000
452200                                     DL-PRINTER-LOCATION.         45220000
452300     MOVE ASC-DEPT-NBR            TO MP049O-JEWST-DEPT            45230000
452400                                     DL-DEPT.                     45240000
452500     MOVE LQW-MAJOR-CLASS (LQW-IDX)                               45250000
452600                                  TO MP049O-JEWST-CLASS           45260000
452700                                     DL-CLASS.                    45270000
452800     MOVE LQW-SUB-CLASS (LQW-IDX) TO MP049O-JEWST-SUB-CLASS       45280000
452900                                     DL-SUB-CLASS.                45290000
453000     MOVE LQW-UPC (LQW-IDX)       TO MP049O-JEWST-UPC             45300000
453100                                     DL-UPC.                      45310000
453200     MOVE LQW-VEND-STYL(LQW-IDX)  TO MP049O-JEWST-STYLE           45320000
453300                                     DL-STYLE.                    45330000
453400     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                              45340000
453500                                  TO MP049O-JEWST-PO-LINE         45350000
453600                                     DL-PO-LINE.                  45360000
453700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            45370000
453800                                  TO PV-NUMBER-OF-SELECTED-ITEMS  45380000
453900     MOVE PV-NUMBER-OF-SELECTED-ITEMS                             45390000
454000                                  TO MP049O-JEWST-TOTAL-SKU       45400000
454100                                     DL-TOTAL-SKU.                45410000
454200                                                                  45420000
454300*DH  MOVE ASC-SEASON-CDE          TO MP049O-JEWST-SEASON.         45430000
454400     MOVE LQW-UNT-RTL-PR-X  (LQW-IDX)                             45440000
454500                                  TO MP049O-JEWST-RETAIL          45450000
454600     MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                             45460000
454700                                  TO DL-RETAIL.                   45470000
454800     MOVE PV-NMBR-OF-TICKETS      TO PV-NMBR-OF-TICKETS-4-DGT     45480000
454900                                     MP049O-JEWST-SYS-QTY.        45490000
455000     MOVE PV-NMBR-OF-TICKETS-4-DGT                                45500000
455100                                  TO MP049O-JEWST-QTY             45510000
455200                                     DL-QTY.                      45520000
455300     MOVE SPACES                  TO DRS01-COMM-CTL.              45530000
455400     MOVE MP049O-DETAIL-JEWST     TO DRS01-COMM-DATA.             45540000
455500                                                                  45550000
455600******************************************************************45560000
455700* THIS MODULE BUILDS THE DATA STREAMS FOR THE VENDOR UPC GUM LABEL45570000
455800* WHICH IS SENT TO THE DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC 45580000
455900* REPORT SYSTEM).                                                 45590000
456000*                                                                 45600000
456100* ANOTHER DATA STREAM (DL-DETAIL-LINE) IS ALSO GETTING CREATED.   45610000
456200* IF THE TICKET OFFICE IS USING THE LMS TICKET SYSTEM, THIS NEW   45620000
456300* DATA STREAM WILL BE SENT TO THE AVERY DENNISON TICKET SYSTEM,   45630000
456400* USING TCP/IP SOCKET CALLS.                                      45640000
456500******************************************************************45650000
456600                                                                  45660000
456700 4640-BLD-LABEL-LABEL-DTL.                                        45670000
456800     IF PS-CREATE-HEADER                                          45680000
456900         MOVE PC-HHP               TO MP049O-LABEL-TASK           45690000
457000     ELSE                                                         45700000
457100         MOVE PC-HP                TO MP049O-LABEL-TASK           45710000
457200     END-IF.                                                      45720000
457300     MOVE PV-PO-REC-SEQ            TO MP049O-LABEL-RECEIVER       45730000
457400                                      DL-RECEIVER.                45740000
457500     MOVE ASC-KEY-VENDOR-NAME      TO MP049O-LABEL-VNDR-NAME      45750000
457600                                      DL-VNDR-NAME.               45760000
457700     MOVE ASC-PRINTER              TO MP049O-LABEL-LOCATION       45770000
457800                                      DL-PRINTER-LOCATION.        45780000
457900     MOVE ASC-DEPT-NBR             TO MP049O-LABEL-DEPT           45790000
458000                                      DL-DEPT.                    45800000
458100     MOVE LQW-MAJOR-CLASS (LQW-IDX)                               45810000
458200                                   TO MP049O-LABEL-CLASS          45820000
458300                                      DL-CLASS.                   45830000
458400     MOVE LQW-SUB-CLASS (LQW-IDX)  TO MP049O-LABEL-SUB-CLASS      45840000
458500                                      DL-SUB-CLASS.               45850000
458600     MOVE LQW-UPC (LQW-IDX)        TO MP049O-LABEL-UPC            45860000
458700                                      DL-UPC.                     45870000
458800     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                              45880000
458900                                   TO MP049O-LABEL-PO-LINE        45890000
459000                                      DL-PO-LINE.                 45900000
459100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            45910000
459200                                   TO PV-NUMBER-OF-SELECTED-ITEMS.45920000
459300     MOVE PV-NUMBER-OF-SELECTED-ITEMS                             45930000
459400                                   TO MP049O-LABEL-TOTAL-SKU      45940000
459500                                      DL-TOTAL-SKU.               45950000
459600     MOVE LQW-VEND-STYL (LQW-IDX)  TO MP049O-LABEL-STYLE          45960000
459700                                      DL-STYLE.                   45970000
459800                                                                  45980000
459900     IF ASC-DISPLAY-SIZE = 'Y'                                    45990000
460000         IF LQW-SIZE (LQW-IDX) > SPACES                           46000000
460100             MOVE LQW-SIZE (LQW-IDX)                              46010000
460200                                   TO MP049O-LABEL-SIZE           46020000
460300                                      DL-SIZE                     46030000
460400         ELSE                                                     46040000
460500             IF LQW-SIZE (LQW-IDX) = LOW-VALUES                   46050000
460600                 MOVE SPACES       TO MP049O-LABEL-SIZE           46060000
460700                                      DL-SIZE                     46070000
460800             ELSE                                                 46080000
460900                 MOVE LQW-TABLE-SIZE (LQW-IDX)                    46090000
461000                                   TO MP049O-LABEL-SIZE           46100000
461100                                      DL-SIZE                     46110000
461200             END-IF                                               46120000
461300         END-IF                                                   46130000
461400     ELSE                                                         46140000
461500         IF LQW-SIZE (LQW-IDX) > SPACES                           46150000
461600             MOVE LQW-SIZE (LQW-IDX)                              46160000
461700                                   TO MP049O-LABEL-SIZE           46170000
461800                                      DL-SIZE                     46180000
461900         ELSE                                                     46190000
462000             MOVE SPACES           TO MP049O-LABEL-SIZE           46200000
462100                                      DL-SIZE                     46210000
462200         END-IF                                                   46220000
462300     END-IF.                                                      46230000
462400*DH  MOVE ASC-SEASON-CDE       TO MP049O-LABEL-SEASON             46240000
462500     IF ASC-DISPLAY-COLOR = 'Y'                                   46250000
462600         IF LQW-COLOR (LQW-IDX) > SPACES                          46260000
462700             MOVE LQW-COLOR (LQW-IDX)                             46270000
462800                                   TO MP049O-LABEL-COLOR          46280000
462900                                      DL-COLOR                    46290000
463000         ELSE                                                     46300000
463100             IF LQW-COLOR (LQW-IDX) = LOW-VALUES                  46310000
463200                 MOVE SPACES       TO MP049O-LABEL-COLOR          46320000
463300                                      DL-COLOR                    46330000
463400             ELSE                                                 46340000
463500                 MOVE LQW-TABLE-COLOR (LQW-IDX)                   46350000
463600                                   TO MP049O-LABEL-COLOR          46360000
463700                                      DL-COLOR                    46370000
463800             END-IF                                               46380000
463900         END-IF                                                   46390000
464000     ELSE                                                         46400000
464100         IF LQW-COLOR (LQW-IDX) > SPACES                          46410000
464200             MOVE LQW-COLOR (LQW-IDX)                             46420000
464300                                   TO MP049O-LABEL-COLOR          46430000
464400                                      DL-COLOR                    46440000
464500         ELSE                                                     46450000
464600             MOVE SPACES           TO MP049O-LABEL-COLOR          46460000
464700                                      DL-COLOR                    46470000
464800         END-IF                                                   46480000
464900     END-IF.                                                      46490000
465000     MOVE ASC-OPT-BLOCK            TO MP049O-LABEL-OPTION-BLK     46500000
465100                                      DL-OPTION-BLK.              46510000
465200     MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                             46520000
465300                                   TO MP049O-LABEL-RETAIL         46530000
465400                                      DL-RETAIL.                  46540000
465500                                                                  46550000
465600     IF ((LQW-GP-RTL-QTY (LQW-IDX) = ZERO)                        46560000
465700               OR                                                 46570000
465800         (LQW-UNT-RTL-PR (LQW-IDX) = ZERO))                       46580000
465900         MOVE SPACES               TO MP049O-LABEL-MULTICOUNT     46590000
466000                                      DL-MULTICOUNT               46600000
466100     ELSE                                                         46610000
466200         MOVE LQW-GP-RTL-QTY (LQW-IDX)                            46620000
466300                                   TO PV-GP-QTY-1                 46630000
466400         MOVE PV-GP-QTY-SLASH                                     46640000
466500                                   TO MP049O-LABEL-MULTICOUNT     46650000
466600                                      DL-MULTICOUNT               46660000
466700     END-IF.                                                      46670000
466800                                                                  46680000
466900     IF ((LQW-GP-RTL (LQW-IDX) = ZERO)                            46690000
467000               OR                                                 46700000
467100         (LQW-UNT-RTL-PR (LQW-IDX) = ZERO))                       46710000
467200         MOVE SPACES               TO MP049O-LABEL-MULTIPRICE     46720000
467300                                      DL-MULTIPRICE               46730000
467400     ELSE                                                         46740000
467500         IF LQW-GP-RTL (LQW-IDX) < 10.00                          46750000
467600            MOVE LQW-GP-RTL   (LQW-IDX)                           46760000
467700                                   TO PV-GP-RTL-DOLLAR-1          46770000
467800            MOVE PV-GP-RTL-DOLLAR-1                               46780000
467900                                   TO MP049O-LABEL-MULTIPRICE     46790000
468000                                      DL-MULTIPRICE               46800000
468100         ELSE                                                     46810000
468200            MOVE LQW-GP-RTL   (LQW-IDX)                           46820000
468300                                   TO PV-GP-RTL-DOLLAR-2          46830000
468400            MOVE PV-GP-RTL-DOLLAR-2                               46840000
468500                                   TO MP049O-LABEL-MULTIPRICE     46850000
468600                                      DL-MULTIPRICE               46860000
468700         END-IF                                                   46870000
468800     END-IF.                                                      46880000
468900                                                                  46890000
469000     MOVE PV-NMBR-OF-TICKETS       TO PV-NMBR-OF-TICKETS-4-DGT    46900000
469100                                      MP049O-LABEL-SYS-QTY.       46910000
469200     MOVE PV-NMBR-OF-TICKETS-4-DGT TO MP049O-LABEL-QTY            46920000
469300                                      DL-QTY.                     46930000
469400     MOVE MP049O-DETAIL-LABEL      TO DRS01-COMM-DATA.            46940000
469500                                                                  46950000
469600     MOVE SPACES                   TO DRS01-COMM-CTL.             46960000
469700                                                                  46970000
469800******************************************************************46980000
469900* THIS MODULE BUILDS THE DATA STREAMS FOR THE VENDOR UPC HANG TAG 46990000
470000* AND VENDOR UPC SALE HANG TAG WHICH IS SENT TO THE DENNISON      47000000
470100* TICKETING SYSTEM VIA DRS (DYNAMIC REPORT SYSTEM).               47010000
470200*                                                                 47020000
470300* ANOTHER DATA STREAM (DL-DETAIL-LINE) IS ALSO GETTING CREATED.   47030000
470400* IF THE TICKET OFFICE IS USING THE LMS TICKET SYSTEM, THIS NEW   47040000
470500* DATA STREAM WILL BE SENT TO THE AVERY DENNISON TICKET SYSTEM,   47050000
470600* USING TCP/IP SOCKET CALLS.                                      47060000
470700******************************************************************47070000
470800                                                                  47080000
470900 4650-BLD-TAG-LABEL-DTL.                                          47090000
471000     IF ASC-TKT-FORMAT    = 'TAGGWP'                              47100000
471100         IF PS-CREATE-HEADER                                      47110000
471200             MOVE PC-HHP           TO MP049O-TAGGWP-TASK          47120000
471300         ELSE                                                     47130000
471400             MOVE PC-HP            TO MP049O-TAGGWP-TASK          47140000
471500         END-IF                                                   47150000
471600         MOVE PV-PO-REC-SEQ        TO MP049O-TAGGWP-RECEIVER      47160000
471700                                      DL-RECEIVER                 47170000
471800         MOVE ASC-KEY-VENDOR-NAME  TO MP049O-TAGGWP-VNDR-NAME     47180000
471900                                      DL-VNDR-NAME                47190000
472000         MOVE ASC-PRINTER          TO MP049O-TAGGWP-LOCATION      47200000
472100                                      DL-PRINTER-LOCATION         47210000
472200         MOVE ASC-DEPT-NBR         TO MP049O-TAGGWP-DEPT          47220000
472300                                      DL-DEPT                     47230000
472400         MOVE LQW-MAJOR-CLASS (LQW-IDX)                           47240000
472500                                   TO MP049O-TAGGWP-CLASS         47250000
472600                                      DL-CLASS                    47260000
472700         MOVE LQW-SUB-CLASS (LQW-IDX)                             47270000
472800                                   TO MP049O-TAGGWP-SUB-CLASS     47280000
472900                                      DL-SUB-CLASS                47290000
473000         MOVE LQW-UPC (LQW-IDX)    TO MP049O-TAGGWP-UPC           47300000
473100                                      DL-UPC                      47310000
473200         MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                         47320000
473300                                   TO MP049O-TAGGWP-RETAIL        47330000
473400                                      DL-RETAIL                   47340000
473500         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        47350000
473600                                   TO PV-NUMBER-OF-SELECTED-ITEMS 47360000
473700         MOVE PV-NUMBER-OF-SELECTED-ITEMS                         47370000
473800                                   TO MP049O-TAGGWP-TOTAL-SKU     47380000
473900                                      DL-TOTAL-SKU                47390000
474000                                                                  47400000
474100*DH      MOVE ASC-SEASON-CDE       TO MP049O-TAGGWP-SEASON        47410000
474200         MOVE LQW-VEND-STYL (LQW-IDX)                             47420000
474300                                   TO MP049O-TAGGWP-STYLE         47430000
474400                                      DL-STYLE                    47440000
474500         IF ASC-DISPLAY-SIZE = 'Y'                                47450000
474600             IF LQW-SIZE (LQW-IDX) > SPACES                       47460000
474700                 MOVE LQW-SIZE (LQW-IDX)                          47470000
474800                                   TO MP049O-TAGGWP-SIZE          47480000
474900                                      DL-SIZE                     47490000
475000             ELSE                                                 47500000
475100                 IF LQW-SIZE (LQW-IDX) = LOW-VALUES               47510000
475200                     MOVE SPACES   TO MP049O-TAGGWP-SIZE          47520000
475300                                      DL-SIZE                     47530000
475400                 ELSE                                             47540000
475500                     MOVE LQW-TABLE-SIZE (LQW-IDX)                47550000
475600                                   TO MP049O-TAGGWP-SIZE          47560000
475700                                      DL-SIZE                     47570000
475800                 END-IF                                           47580000
475900             END-IF                                               47590000
476000         ELSE                                                     47600000
476100             IF LQW-SIZE (LQW-IDX) > SPACES                       47610000
476200                 MOVE LQW-SIZE (LQW-IDX)                          47620000
476300                                   TO MP049O-TAGGWP-SIZE          47630000
476400                                      DL-SIZE                     47640000
476500             ELSE                                                 47650000
476600                 MOVE SPACES       TO MP049O-TAGGWP-SIZE          47660000
476700                                      DL-SIZE                     47670000
476800             END-IF                                               47680000
476900         END-IF                                                   47690000
477000         IF ASC-DISPLAY-COLOR = 'Y'                               47700000
477100             IF LQW-COLOR (LQW-IDX) > SPACES                      47710000
477200                 MOVE LQW-COLOR (LQW-IDX)                         47720000
477300                                   TO MP049O-TAGGWP-COLOR         47730000
477400                                      DL-COLOR                    47740000
477500             ELSE                                                 47750000
477600                 IF LQW-COLOR (LQW-IDX) = LOW-VALUES              47760000
477700                     MOVE SPACES   TO MP049O-TAGGWP-COLOR         47770000
477800                                      DL-COLOR                    47780000
477900                 ELSE                                             47790000
478000                     MOVE LQW-TABLE-COLOR (LQW-IDX)               47800000
478100                                   TO MP049O-TAGGWP-COLOR         47810000
478200                                      DL-COLOR                    47820000
478300                 END-IF                                           47830000
478400             END-IF                                               47840000
478500         ELSE                                                     47850000
478600             IF LQW-COLOR (LQW-IDX) > SPACES                      47860000
478700                 MOVE LQW-COLOR (LQW-IDX)                         47870000
478800                                   TO MP049O-TAGGWP-COLOR         47880000
478900                                      DL-COLOR                    47890000
479000             ELSE                                                 47900000
479100                 MOVE SPACES       TO MP049O-TAGGWP-COLOR         47910000
479200                                      DL-COLOR                    47920000
479300             END-IF                                               47930000
479400         END-IF                                                   47940000
479500         MOVE LQW-OPT-BLK (LQW-IDX)                               47950000
479600                                   TO MP049O-TAGGWP-OPTION-BLK    47960000
479700                                      DL-OPTION-BLK               47970000
479800* PO LINE IS NEEDED FOR NEW TICKET SYSTEM AT PATTERSON.  THIS     47980000
479900* VARIABLE IS PART OF THE DATASET NAME FOR THE FILE THAT CONTAINS 47990000
480000* THE DATA STREAM THAT WAS SENT TO AVERY WATCH FOR PROCESSING.    48000000
480100         MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                          48010000
480200                                   TO DL-PO-LINE                  48020000
480300                                                                  48030000
480400         MOVE PV-NMBR-OF-TICKETS   TO PV-NMBR-OF-TICKETS-4-DGT    48040000
480500                                      MP049O-TAGGWP-SYS-QTY       48050000
480600         MOVE PV-NMBR-OF-TICKETS-4-DGT                            48060000
480700                                   TO MP049O-TAGGWP-QTY           48070000
480800                                      DL-QTY                      48080000
480900         MOVE SPACES               TO DRS01-COMM-CTL              48090000
481000         MOVE MP049O-DETAIL-TAGGWP TO DRS01-COMM-DATA             48100000
481100     ELSE                                                         48110000
481200         IF PS-CREATE-HEADER                                      48120000
481300             MOVE PC-HHP           TO MP049O-TAG-TASK             48130000
481400         ELSE                                                     48140000
481500             MOVE PC-HP            TO MP049O-TAG-TASK             48150000
481600         END-IF                                                   48160000
481700         MOVE PV-PO-REC-SEQ        TO MP049O-TAG-RECEIVER         48170000
481800                                      DL-RECEIVER                 48180000
481900         MOVE ASC-KEY-VENDOR-NAME  TO MP049O-TAG-VNDR-NAME        48190000
482000                                      DL-VNDR-NAME                48200000
482100         MOVE ASC-PRINTER          TO MP049O-TAG-LOCATION         48210000
482200                                      DL-PRINTER-LOCATION         48220000
482300         MOVE ASC-DEPT-NBR         TO MP049O-TAG-DEPT             48230000
482400                                      DL-DEPT                     48240000
482500         MOVE LQW-MAJOR-CLASS (LQW-IDX)                           48250000
482600                                   TO MP049O-TAG-CLASS            48260000
482700                                      DL-CLASS                    48270000
482800         MOVE LQW-SUB-CLASS (LQW-IDX)                             48280000
482900                                   TO MP049O-TAG-SUB-CLASS        48290000
483000                                      DL-SUB-CLASS                48300000
483100         MOVE LQW-UPC (LQW-IDX)    TO MP049O-TAG-UPC              48310000
483200                                      DL-UPC                      48320000
483300         MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                          48330000
483400                                   TO MP049O-TAG-PO-LINE          48340000
483500                                      DL-PO-LINE                  48350000
483600         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        48360000
483700                                   TO PV-NUMBER-OF-SELECTED-ITEMS 48370000
483800         MOVE PV-NUMBER-OF-SELECTED-ITEMS                         48380000
483900                                   TO MP049O-TAG-TOTAL-SKU        48390000
484000                                      DL-TOTAL-SKU                48400000
484100                                                                  48410000
484200*DH      MOVE ASC-SEASON-CDE       TO MP049O-TAG-SEASON           48420000
484300         MOVE LQW-VEND-STYL (LQW-IDX)                             48430000
484400                                   TO MP049O-TAG-STYLE            48440000
484500                                      DL-STYLE                    48450000
484600         IF ASC-DISPLAY-SIZE = 'Y'                                48460000
484700             IF LQW-SIZE (LQW-IDX) > SPACES                       48470000
484800                 MOVE LQW-SIZE (LQW-IDX)                          48480000
484900                                   TO MP049O-TAG-SIZE             48490000
485000                                      DL-SIZE                     48500000
485100             ELSE                                                 48510000
485200                 IF LQW-SIZE (LQW-IDX) = LOW-VALUES               48520000
485300                     MOVE SPACES   TO MP049O-TAG-SIZE             48530000
485400                                      DL-SIZE                     48540000
485500                   ELSE                                           48550000
485600                     MOVE LQW-TABLE-SIZE (LQW-IDX)                48560000
485700                                   TO MP049O-TAG-SIZE             48570000
485800                                      DL-SIZE                     48580000
485900                 END-IF                                           48590000
486000             END-IF                                               48600000
486100         ELSE                                                     48610000
486200             IF LQW-SIZE (LQW-IDX) > SPACES                       48620000
486300                 MOVE LQW-SIZE (LQW-IDX)                          48630000
486400                                   TO MP049O-TAG-SIZE             48640000
486500                                      DL-SIZE                     48650000
486600             ELSE                                                 48660000
486700                 MOVE SPACES       TO MP049O-TAG-SIZE             48670000
486800                                      DL-SIZE                     48680000
486900             END-IF                                               48690000
487000         END-IF                                                   48700000
487100         IF ASC-DISPLAY-COLOR = 'Y'                               48710000
487200             IF LQW-COLOR (LQW-IDX) > SPACES                      48720000
487300                 MOVE LQW-COLOR (LQW-IDX)                         48730000
487400                                   TO MP049O-TAG-COLOR            48740000
487500                                      DL-COLOR                    48750000
487600             ELSE                                                 48760000
487700                 IF LQW-COLOR (LQW-IDX) = LOW-VALUES              48770000
487800                     MOVE SPACES   TO MP049O-TAG-COLOR            48780000
487900                                      DL-COLOR                    48790000
488000                 ELSE                                             48800000
488100                     MOVE LQW-TABLE-COLOR (LQW-IDX)               48810000
488200                                   TO MP049O-TAG-COLOR            48820000
488300                                      DL-COLOR                    48830000
488400                 END-IF                                           48840000
488500             END-IF                                               48850000
488600         ELSE                                                     48860000
488700             IF LQW-COLOR (LQW-IDX) > SPACES                      48870000
488800                 MOVE LQW-COLOR (LQW-IDX)                         48880000
488900                                   TO MP049O-TAG-COLOR            48890000
489000                                      DL-COLOR                    48900000
489100             ELSE                                                 48910000
489200                 MOVE SPACES       TO MP049O-TAG-COLOR            48920000
489300                                      DL-COLOR                    48930000
489400             END-IF                                               48940000
489500         END-IF                                                   48950000
489600         MOVE LQW-OPT-BLK (LQW-IDX)                               48960000
489700                                   TO MP049O-TAG-OPTION-BLK       48970000
489800                                      DL-OPTION-BLK               48980000
489900         MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                         48990000
490000                                   TO MP049O-TAG-RETAIL           49000000
490100                                      DL-RETAIL                   49010000
490200                                                                  49020000
490300         IF ((LQW-GP-RTL-QTY (LQW-IDX) = ZERO)                    49030000
490400                   OR                                             49040000
490500             (LQW-UNT-RTL-PR (LQW-IDX) = ZERO))                   49050000
490600             MOVE SPACES           TO MP049O-TAG-MULTICOUNT       49060000
490700                                      DL-MULTICOUNT               49070000
490800         ELSE                                                     49080000
490900             MOVE LQW-GP-RTL-QTY   (LQW-IDX)                      49090000
491000                                   TO  PV-GP-QTY-1                49100000
491100             MOVE PV-GP-QTY-SLASH                                 49110000
491200                                   TO MP049O-TAG-MULTICOUNT       49120000
491300                                      DL-MULTICOUNT               49130000
491400         END-IF                                                   49140000
491500                                                                  49150000
491600         IF ((LQW-GP-RTL (LQW-IDX) = ZERO)                        49160000
491700                       OR                                         49170000
491800             (LQW-UNT-RTL-PR (LQW-IDX) = ZERO))                   49180000
491900             MOVE SPACES           TO MP049O-TAG-MULTIPRICE       49190000
492000                                      DL-MULTIPRICE               49200000
492100         ELSE                                                     49210000
492200             IF LQW-GP-RTL (LQW-IDX) < 10.00                      49220000
492300                MOVE LQW-GP-RTL   (LQW-IDX)                       49230000
492400                                   TO PV-GP-RTL-DOLLAR-1          49240000
492500                MOVE PV-GP-RTL-DOLLAR-1                           49250000
492600                                   TO MP049O-TAG-MULTIPRICE       49260000
492700                                      DL-MULTIPRICE               49270000
492800             ELSE                                                 49280000
492900                MOVE LQW-GP-RTL   (LQW-IDX)                       49290000
493000                                   TO PV-GP-RTL-DOLLAR-2          49300000
493100                MOVE PV-GP-RTL-DOLLAR-2                           49310000
493200                                   TO MP049O-TAG-MULTIPRICE       49320000
493300                                      DL-MULTIPRICE               49330000
493400             END-IF                                               49340000
493500         END-IF                                                   49350000
493600                                                                  49360000
493700         MOVE PV-NMBR-OF-TICKETS   TO PV-NMBR-OF-TICKETS-4-DGT    49370000
493800                                      MP049O-TAG-SYS-QTY          49380000
493900         MOVE PV-NMBR-OF-TICKETS-4-DGT                            49390000
494000                                   TO MP049O-TAG-QTY              49400000
494100                                      DL-QTY                      49410000
494200         MOVE SPACES               TO DRS01-COMM-CTL              49420000
494300         MOVE MP049O-DETAIL-TAG    TO DRS01-COMM-DATA             49430000
494400     END-IF.                                                      49440000
494500                                                                  49450000
494600******************************************************************49460000
494700* THIS MODULE BUILDS THE DATA STREAM FOR SUPRESSED LABELS WHICH   49470000
494800* IS SENT TO THE DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC       49480000
494900* REPORT SYSTEM).                                                 49490000
495000*                                                                 49500000
495100* ANOTHER DATA STREAM (DL-DETAIL-LINE) IS ALSO GETTING CREATED.   49510000
495200* IF THE TICKET OFFICE IS USING THE LMS TICKET SYSTEM, THIS NEW   49520000
495300* DATA STREAM WILL BE SENT TO THE AVERY DENNISON TICKET SYSTEM,   49530000
495400* USING TCP/IP SOCKET CALLS.                                      49540000
495500******************************************************************49550000
495600                                                                  49560000
495700 4660-BLD-SUPRESS-LABEL-DTL.                                      49570000
495800                                                                  49580000
495900     IF PS-CREATE-HEADER                                          49590000
496000         MOVE PC-HHP               TO MP049O-SUPRES-TASK          49600000
496100     ELSE                                                         49610000
496200         MOVE PC-HP                TO MP049O-SUPRES-TASK          49620000
496300     END-IF.                                                      49630000
496400     MOVE PV-PO-REC-SEQ            TO MP049O-SUPRES-RECEIVER      49640000
496500                                      DL-RECEIVER.                49650000
496600     MOVE ASC-KEY-VENDOR-NAME      TO MP049O-SUPRES-VNDR-NAME     49660000
496700                                      DL-VNDR-NAME.               49670000
496800     MOVE ASC-PRINTER              TO MP049O-SUPRES-LOCATION      49680000
496900                                      DL-PRINTER-LOCATION.        49690000
497000     MOVE ASC-DEPT-NBR             TO MP049O-SUPRES-DEPT          49700000
497100                                      DL-DEPT.                    49710000
497200     MOVE LQW-MAJOR-CLASS (LQW-IDX)                               49720000
497300                                   TO MP049O-SUPRES-CLASS         49730000
497400                                      DL-CLASS.                   49740000
497500     MOVE LQW-SUB-CLASS (LQW-IDX)  TO MP049O-SUPRES-SUB-CLASS     49750000
497600                                      DL-SUB-CLASS.               49760000
497700                                                                  49770000
497800     MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                             49780000
497900                                   TO MP049O-SUPRES-RETAIL        49790000
498000                                      DL-RETAIL.                  49800000
498100     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                              49810000
498200                                   TO MP049O-SUPRES-PO-LINE       49820000
498300                                      DL-PO-LINE.                 49830000
498400                                                                  49840000
498500     MOVE PV-NMBR-OF-TICKETS       TO PV-NMBR-OF-TICKETS-4-DGT    49850000
498600                                      MP049O-SUPRES-SYS-QTY.      49860000
498700     MOVE PV-NMBR-OF-TICKETS-4-DGT TO MP049O-SUPRES-QTY           49870000
498800                                      DL-QTY.                     49880000
498900     MOVE SPACES                   TO DRS01-COMM-CTL.             49890000
499000     MOVE MP049O-DETAIL-SUPRES     TO DRS01-COMM-DATA.            49900000
499100                                                                  49910000
499200******************************************************************49920000
499300* THIS MODULE BUILDS THE DATA STREAM FOR FAMILY LABELS WHICH      49930000
499400* IS SENT TO THE DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC       49940000
499500* REPORT SYSTEM).                                                 49950000
499600*                                                                 49960000
499700* ANOTHER DATA STREAM (DL-DETAIL-LINE) IS ALSO GETTING CREATED.   49970000
499800* IF THE TICKET OFFICE IS USING THE LMS TICKET SYSTEM, THIS NEW   49980000
499900* DATA STREAM WILL BE SENT TO THE AVERY DENNISON TICKET SYSTEM,   49990000
500000* USING TCP/IP SOCKET CALLS.                                      50000000
500100******************************************************************50010000
500200                                                                  50020000
500300 4670-BLD-FAMILY-LABEL-DTL.                                       50030000
500400                                                                  50040000
500500     IF PS-CREATE-HEADER                                          50050000
500600         MOVE PC-HHP               TO MP049O-FAMILY-TASK          50060000
500700     ELSE                                                         50070000
500800         MOVE PC-HP                TO MP049O-FAMILY-TASK          50080000
500900     END-IF.                                                      50090000
501000     MOVE PV-PO-REC-SEQ            TO MP049O-FAMILY-RECEIVER      50100000
501100                                      DL-RECEIVER.                50110000
501200     MOVE ASC-KEY-VENDOR-NAME      TO MP049O-FAMILY-VNDR-NAME     50120000
501300                                      DL-VNDR-NAME.               50130000
501400     MOVE ASC-PRINTER              TO MP049O-FAMILY-LOCATION      50140000
501500                                      DL-PRINTER-LOCATION.        50150000
501510                                                                  50151033
501600     MOVE ASC-DEPT-NBR             TO MP049O-FAMILY-DEPT          50160000
501700                                      DL-DEPT.                    50170000
501710     MOVE ASC-DEPT-NBR-N           TO XLT00022-DEPT-NBR           50171033
501800     MOVE LQW-MAJOR-CLASS (LQW-IDX)                               50180000
501900                                   TO MP049O-FAMILY-CLASS         50190000
502000                                      DL-CLASS                    50200000
502100                                      XLT00022-MAJ-CL-NBR         50210033
578700     PERFORM 7050-GET-PUT-AWAY-CDE                                57870000
578800     MOVE XLT00022-PUT-AWY-CDE     TO MP049O-FAMILY-PUT-AWY-CDE   57880033
578900                                      DL-PUT-AWAY-CODE            57890033
578901                                                                  57890133
578902     MOVE LQW-SUB-CLASS (LQW-IDX)  TO MP049O-FAMILY-SUB-CLASS     57890200
578903                                      DL-SUB-CLASS.               57890300
578904     MOVE LQW-UPC (LQW-IDX)        TO MP049O-FAMILY-UPC           57890400
578905                                      DL-UPC.                     57890500
578906     MOVE LQW-VEND-STYL (LQW-IDX)  TO MP049O-FAMILY-STYLE         57890600
578907                                      DL-STYLE.                   57890700
578908     IF ASC-DISPLAY-SIZE = 'Y'                                    57890800
578909         IF LQW-SIZE (LQW-IDX) > SPACES                           57890900
578910             MOVE LQW-SIZE (LQW-IDX)                              57891000
578911                                   TO MP049O-FAMILY-SIZE          57891100
578912                                      DL-SIZE                     57891200
578913         ELSE                                                     57891300
578914             IF LQW-SIZE (LQW-IDX) = LOW-VALUES                   57891400
578915                 MOVE SPACES       TO MP049O-FAMILY-SIZE          57891500
578916                                      DL-SIZE                     57891600
578917             ELSE                                                 57891700
578918                 MOVE LQW-TABLE-SIZE (LQW-IDX)                    57891800
578919                                   TO MP049O-FAMILY-SIZE          57891900
578920                                      DL-SIZE                     57892000
578921             END-IF                                               57892100
578922         END-IF                                                   57892200
578923     ELSE                                                         57892300
578924         IF LQW-SIZE (LQW-IDX) > SPACES                           57892400
578925             MOVE LQW-SIZE (LQW-IDX)                              57892500
578926                                   TO MP049O-FAMILY-SIZE          57892600
578927                                      DL-SIZE                     57892700
578928         ELSE                                                     57892800
578929             MOVE SPACES           TO MP049O-FAMILY-SIZE          57892900
578930                                      DL-SIZE                     57893000
578931         END-IF                                                   57893100
578932     END-IF.                                                      57893200
578933                                                                  57893300
578934     IF ASC-DISPLAY-COLOR = 'Y'                                   57893400
578935         IF LQW-COLOR (LQW-IDX) > SPACES                          57893500
578936             MOVE LQW-COLOR (LQW-IDX)                             57893600
578937                                   TO MP049O-FAMILY-COLOR         57893700
578938                                      DL-COLOR                    57893800
578939         ELSE                                                     57893900
578940             IF LQW-COLOR (LQW-IDX) = LOW-VALUES                  57894000
578941                 MOVE SPACES       TO MP049O-FAMILY-COLOR         57894100
578942                                      DL-COLOR                    57894200
578943             ELSE                                                 57894300
578944                 MOVE LQW-TABLE-COLOR (LQW-IDX)                   57894400
578945                                   TO MP049O-FAMILY-COLOR         57894500
578946                                      DL-COLOR                    57894600
578947             END-IF                                               57894700
578948         END-IF                                                   57894800
578949     ELSE                                                         57894900
578950         IF LQW-COLOR (LQW-IDX) > SPACES                          57895000
578951             MOVE LQW-COLOR (LQW-IDX)                             57895100
578952                                   TO MP049O-FAMILY-COLOR         57895200
578953                                      DL-COLOR                    57895300
578954         ELSE                                                     57895400
578955             MOVE SPACES           TO MP049O-FAMILY-COLOR         57895500
578956                                      DL-COLOR                    57895600
578957         END-IF                                                   57895700
578958     END-IF.                                                      57895800
578959                                                                  57895900
578960     MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                             57896000
578961                                   TO MP049O-FAMILY-RETAIL        57896100
578962                                      DL-RETAIL.                  57896200
578963     MOVE LQW-ITM-NBR (LQW-IDX)    TO DK-ITM-NBR.                 57896300
578964     PERFORM 4380-GET-SKU-DESCRIPTION.                            57896400
578965     MOVE XLT00003-SKU-DESC        TO MP049O-FAMILY-SHOE-NAME     57896500
578966                                      DL-SHOE-NAME.               57896600
578967                                                                  57896700
578968     MOVE XLT00004-STKR-NBR        TO ASC-STICKER-NBR             57896800
578969                                      PV-STICKER-NBR-ZZ999.       57896900
578970     MOVE PV-STICKER-NBR-ZZ999     TO MP049O-FAMILY-STICKERNO     57897000
578971                                      DL-STICKER-NBR.             57897100
578972     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                              57897200
578973                                   TO MP049O-FAMILY-PO-LINE       57897300
578974                                      DL-PO-LINE.                 57897400
578975     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            57897500
578976                                   TO PV-NUMBER-OF-SELECTED-ITEMS.57897600
578977     MOVE PV-NUMBER-OF-SELECTED-ITEMS                             57897700
578978                                   TO MP049O-FAMILY-TOTAL-SKU     57897800
578979                                      DL-TOTAL-SKU.               57897900
578980                                                                  57898000
578981     MOVE PV-NMBR-OF-TICKETS       TO PV-NMBR-OF-TICKETS-4-DGT    57898100
578982                                      MP049O-FAMILY-SYS-QTY.      57898200
578983     MOVE PV-NMBR-OF-TICKETS-4-DGT TO MP049O-FAMILY-QTY           57898300
578984                                      DL-QTY.                     57898400
578985     MOVE SPACES                   TO DRS01-COMM-CTL.             57898500
578986     MOVE MP049O-DETAIL-FAMILY     TO DRS01-COMM-DATA.            57898600
578987                                                                  57898700
578988******************************************************************57898800
578989* THIS MODULE BUILDS THE DATA STREAM FOR SUPPRESSED SHOE LABELS   57898900
578990* WHICH IS SENT TO THE DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC 57899000
578991* REPORT SYSTEM).                                                 57899100
578992*                                                                 57899200
578993* ANOTHER DATA STREAM (DL-DETAIL-LINE) IS ALSO GETTING CREATED.   57899300
578994* IF THE TICKET OFFICE IS USING THE LMS TICKET SYSTEM, THIS NEW   57899400
578995* DATA STREAM WILL BE SENT TO THE AVERY DENNISON TICKET SYSTEM,   57899500
578996* USING TCP/IP SOCKET CALLS.                                      57899600
578997******************************************************************57899700
578998                                                                  57899800
578999 4675-BLD-SUPRES-SHOE-LABEL-DTL.                                  57899900
579000                                                                  57900000
579001     IF PS-CREATE-HEADER                                          57900100
579002         MOVE PC-HHP            TO MP049O-SUPRES-SHOE-TASK        57900200
579003     ELSE                                                         57900300
579004         MOVE PC-HP             TO MP049O-SUPRES-SHOE-TASK        57900400
579005     END-IF.                                                      57900500
579006     MOVE PV-PO-REC-SEQ         TO MP049O-SUPRES-SHOE-RECEIVER    57900600
579007                                   DL-RECEIVER.                   57900700
579008     MOVE ASC-KEY-VENDOR-NAME   TO MP049O-SUPRES-SHOE-VNDR-NAME   57900800
579009                                   DL-VNDR-NAME.                  57900900
579010     MOVE ASC-PRINTER           TO MP049O-SUPRES-SHOE-LOCATION    57901000
579011                                   DL-PRINTER-LOCATION.           57901100
579012     MOVE ASC-DEPT-NBR          TO MP049O-SUPRES-SHOE-DEPT        57901200
579013                                   DL-DEPT.                       57901300
579014     MOVE ASC-DEPT-NBR-N           TO XLT00022-DEPT-NBR           57901403
579015                                                                  57901533
579016     MOVE LQW-MAJOR-CLASS (LQW-IDX)                               57901600
579017                                TO MP049O-SUPRES-SHOE-CLASS       57901700
579018                                   DL-CLASS                       57901800
579019                                   XLT00022-MAJ-CL-NBR            57901900
579020     PERFORM 7050-GET-PUT-AWAY-CDE                                57902000
579030     MOVE XLT00022-PUT-AWY-CDE     TO MP049O-SUPRES-PUT-AWY-CDE   57903033
579040                                      DL-PUT-AWAY-CODE            57904033
579041                                                                  57904133
579042     MOVE LQW-SUB-CLASS (LQW-IDX)                                 57904200
579043                                TO MP049O-SUPRES-SHOE-SUB-CLASS   57904300
579044                                   DL-SUB-CLASS.                  57904400
579045     MOVE LQW-VEND-STYL (LQW-IDX)                                 57904500
579046                                TO MP049O-SUPRES-SHOE-STYLE       57904600
579047                                   DL-STYLE.                      57904700
579048     MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                             57904800
579049                                TO MP049O-SUPRES-SHOE-RETAIL      57904900
579050                                   DL-RETAIL.                     57905000
579051                                                                  57905100
579052* 4380-GET-SKU-DESCRIPTION IS PERFORMED TO GET STICKER NUMBER     57905200
579053     MOVE LQW-ITM-NBR (LQW-IDX) TO DK-ITM-NBR.                    57905300
579054     PERFORM 4380-GET-SKU-DESCRIPTION                             57905400
579055     MOVE XLT00004-STKR-NBR     TO ASC-STICKER-NBR                57905500
579056                                   PV-STICKER-NBR-ZZ999.          57905600
579057     MOVE PV-STICKER-NBR-ZZ999  TO MP049O-SUPRES-SHOE-STICKERNO   57905700
579058                                   DL-STICKER-NBR.                57905800
579059     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                              57905900
579060                                TO MP049O-SUPRES-SHOE-PO-LINE     57906000
579061                                   DL-PO-LINE.                    57906100
579062     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            57906200
579063                                TO PV-NUMBER-OF-SELECTED-ITEMS.   57906300
579064     MOVE PV-NUMBER-OF-SELECTED-ITEMS                             57906400
579065                                TO MP049O-SUPRES-SHOE-TOTAL-SKU   57906500
579066                                   DL-TOTAL-SKU.                  57906600
579067                                                                  57906700
579068     MOVE PV-NMBR-OF-TICKETS    TO PV-NMBR-OF-TICKETS-4-DGT       57906800
579069                                   MP049O-SUPRES-SHOE-SYS-QTY.    57906900
579070     MOVE PV-NMBR-OF-TICKETS-4-DGT                                57907000
579071                                TO MP049O-SUPRES-SHOE-QTY         57907100
579072                                   DL-QTY.                        57907200
579073     MOVE SPACES                TO DRS01-COMM-CTL.                57907300
579074     MOVE MP049O-DETAIL-SUPRES-SHOE                               57907400
579075                                TO DRS01-COMM-DATA.               57907500
579076                                                                  57907600
579077******************************************************************57907700
579078* THIS MODULE BUILDS THE DATA STREAM FOR THE PRICE TICKET FORMAT  57907800
579079* WHICH IS SENT TO THE DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC 57907900
579080* REPORT SYSTEM).                                                 57908000
579081*                                                                 57908100
579082* ANOTHER DATA STREAM (DL-DETAIL-LINE) IS ALSO GETTING CREATED.   57908200
579083* IF THE TICKET OFFICE IS 'TKT20' OR 'TKT21', THIS NEW DATA       57908300
579084* STREAM WILL BE SENT TO THE AVERY DENNISON TICKET SYSTEM, USING  57908400
579085* TCP/IP SOCKET CALLS.                                            57908500
579086******************************************************************57908600
579087                                                                  57908700
579088 4685-BLD-PRICE-LABEL-DTL.                                        57908800
579089                                                                  57908900
579090     IF PS-CREATE-HEADER                                          57909000
579091         MOVE PC-HHP               TO MP049O-PRICE-TASK           57909100
579092     ELSE                                                         57909200
579093         MOVE PC-HP                TO MP049O-PRICE-TASK           57909300
579094     END-IF.                                                      57909400
579095     MOVE PV-PO-REC-SEQ            TO MP049O-PRICE-RECEIVER       57909500
579096                                      DL-QTY.                     57909600
579097     MOVE ASC-KEY-VENDOR-NAME      TO MP049O-PRICE-VNDR-NAME      57909700
579098                                      DL-VNDR-NAME.               57909800
579099     MOVE ASC-PRINTER              TO MP049O-PRICE-LOCATION       57909900
579100                                      DL-PRINTER-LOCATION.        57910000
579101                                                                  57910100
579102     MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                             57910200
579103                                   TO MP049O-PRICE-RETAIL         57910300
579104                                      DL-RETAIL.                  57910400
579105                                                                  57910500
579106     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                              57910600
579107                                   TO MP049O-PRICE-PO-LINE        57910700
579108                                      DL-PO-LINE.                 57910800
579109                                                                  57910900
579110     MOVE PV-NMBR-OF-TICKETS       TO PV-NMBR-OF-TICKETS-4-DGT    57911000
579111                                      MP049O-PRICE-SYS-QTY.       57911100
579112     MOVE PV-NMBR-OF-TICKETS-4-DGT TO MP049O-PRICE-QTY            57911200
579113                                      DL-QTY.                     57911300
579114     MOVE SPACES                   TO DRS01-COMM-CTL.             57911400
579115     MOVE MP049O-DETAIL-PRICE      TO DRS01-COMM-DATA.            57911500
579116                                                                  57911600
579117                                                                  57911700
579118****************************************************************  57911800
579119*    WRITE MESSAGE TO CICS LOG WITH SOCKET CALL START-UP INFO, *  57911900
579120*    FORMAT THE IP ADDRESS, CALL THE SOCKET AND CONNECT TO THE *  57912000
579121*    SOCKET.                                                   *  57912100
579122****************************************************************  57912200
579123 4800-INITIALIZE-SOCKET-CALL.                                     57912300
579124     MOVE EIBTIME                    TO PT-SYS-TIME.              57912400
579125     MOVE PT-SYS-HHMM                TO PT-DISPLAY-TIME.          57912500
579126     MOVE PT-DISPLAY-HH              TO LE-PRT-HH.                57912600
579127     MOVE PT-DISPLAY-MM              TO LE-PRT-MM.                57912700
579128     MOVE LE-START-MESSAGE           TO PV-CICS-MSG-AREA.         57912800
579129     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         57912900
579130                                                                  57913000
579131     MOVE ' 4800-INITIALIZE-SOCKET-CALL'                          57913100
579132                                     TO PV-CICS-MSG-AREA.         57913200
579133     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         57913300
579134                                                                  57913400
579135     PERFORM 4900-FORMAT-IP-ADDR.                                 57913500
579136                                                                  57913600
579137     PERFORM 4910-CALL-SOCKET.                                    57913700
579138                                                                  57913800
579139     IF  PS-NO-SOCKET-ERROR                                       57913900
579140         PERFORM 4920-CONNECT-SOCKET                              57914000
579141     END-IF.                                                      57914100
579142                                                                  57914200
579143******************************************************************57914300
579144*  THIS PARAGRAPH WILL TAKE EACH NUMERIC PORTION OF THE IP       *57914400
579145*  ADDRESS AND CONVERT EACH PORTION INTO ITS HEX VALUE.  THE     *57914500
579146*  HEX VALUE WILL THEN BE MOVED TO A FIELD WHICH WILL STACK THE  *57914600
579147*  FOUR HEX VALUES SIDE BY SIDE INTO A FIELD DEFINED AS X(04).   *57914700
579148*  THIS VALUE IS THEN WHAT IS USED BY THE SOCKETS LOGIC FOR THE  *57914800
579149*  IP ADDRESS.                                                   *57914900
579150******************************************************************57915000
579151 4900-FORMAT-IP-ADDR.                                             57915100
579152     MOVE ' 4900-FORMAT-IP-ADDR'                                  57915200
579153                              TO PV-CICS-MSG-AREA.                57915300
579154     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         57915400
579155                                                                  57915500
579156     MOVE KRPRPM-FUNC-TXT     TO PV-FUNC-TXT.                     57915600
579157     MOVE PV-IP-ADDRESS-TXT   TO PV-IP-ADDRESS.                   57915700
579158                                                                  57915800
579159     MOVE PV-IP-ADDR-NUM1     TO PV-HEX-NUMERIC.                  57915900
579160     MOVE PV-HEX-CHAR-2       TO PV-HEX-FIELD-1.                  57916000
579161                                                                  57916100
579162     MOVE PV-IP-ADDR-NUM2     TO PV-HEX-NUMERIC.                  57916200
579163     MOVE PV-HEX-CHAR-2       TO PV-HEX-FIELD-2.                  57916300
579164                                                                  57916400
579165     MOVE PV-IP-ADDR-NUM3     TO PV-HEX-NUMERIC.                  57916500
579166     MOVE PV-HEX-CHAR-2       TO PV-HEX-FIELD-3.                  57916600
579167                                                                  57916700
579168     MOVE PV-IP-ADDR-NUM4     TO PV-HEX-NUMERIC.                  57916800
579169     MOVE PV-HEX-CHAR-2       TO PV-HEX-FIELD-4.                  57916900
579170                                                                  57917000
579171     MOVE PV-HEX-FIELD-NUMBER TO DP081-NAME-IP-ADDR.              57917100
579172                                                                  57917200
579173     MOVE DP081-NAME-IP-ADDR  TO PV-IP-ADDR.                      57917300
579174     STRING                                                       57917400
579175            ' DP081-NAME-IP-ADDR = '  PV-IP-ADDR                  57917500
579176     DELIMITED BY SIZE                                            57917600
579177     INTO PV-CICS-MSG-AREA.                                       57917700
579178     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         57917800
579179                                                                  57917900
579180                                                                  57918000
579181******************************************************************57918100
579182*  CALL SOCKET                                                   *57918200
579183******************************************************************57918300
579184 4910-CALL-SOCKET.                                                57918400
579185     MOVE ' 4910-CALL-SOCKET' TO PV-CICS-MSG-AREA.                57918500
579186     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         57918600
579187                                                                  57918700
579188     CALL 'EZASOKET'                                              57918800
579189         USING DP081-SOCKET-CMD                                   57918900
579190               DP081-AF-INET                                      57919000
579191               DP081-SOCK-TYPE                                    57919100
579192               DP081-PROTOCOL                                     57919200
579193               DP081-ERRNO                                        57919300
579194               DP081-RETCODE.                                     57919400
579195                                                                  57919500
579196     MOVE DP081-RETCODE TO DP081-SOCK-ID.                         57919600
579197                                                                  57919700
579198     MOVE DP081-RETCODE TO  PV-RETCODE.                           57919800
579199     MOVE DP081-ERRNO   TO  PV-ERRNO.                             57919900
579200     STRING                                                       57920000
579201            ' RETURN CODE - '     DELIMITED BY SIZE               57920100
579202            PV-RETCODE            DELIMITED BY SIZE               57920200
579203            'ERROR NUMBER - '     DELIMITED BY SIZE               57920300
579204            PV-RETCODE            DELIMITED BY SIZE               57920400
579205                                  INTO PV-CICS-MSG-AREA.          57920500
579206     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         57920600
579207                                                                  57920700
579208     IF DP081-RETCODE < ZERO                                      57920800
579209        SET  PS-SOCKET-ERROR             TO TRUE                  57920900
579210        MOVE PC-CURRENT-PROGRAM-NAME     TO DP081-TCP-IP-PGM-NAME 57921000
579211        SET  DP081-TCP-IP-SOCKET-ERR     TO TRUE                  57921100
579212        MOVE DP081-ERRNO                 TO DP081-TCP-IP-ERR-NBR  57921200
579213        MOVE DP081-TCP-IP-LOGGING-MSG    TO PV-CICS-MSG-AREA      57921300
579214        PERFORM 9990-WRITE-CICS-FOR-SOCKETS                       57921400
579215     END-IF.                                                      57921500
579216                                                                  57921600
579217******************************************************************57921700
579218*  CONNECT THE PATH (SOCKET).                                    *57921800
579219******************************************************************57921900
579220 4920-CONNECT-SOCKET.                                             57922000
579221     MOVE ' 4920-CONNECT-SOCKET' TO PV-CICS-MSG-AREA.             57922100
579222     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         57922200
579223                                                                  57922300
579224     MOVE DP081-AF-INET         TO DP081-NAME-FAMILY.             57922400
579225     MOVE CP-COM-PORT           TO DP081-NAME-PORT.               57922500
579226                                                                  57922600
579227     STRING                                                       57922700
579228            ' DP081-SOCK-NAME - '      DELIMITED BY SIZE          57922800
579229            DP081-SOCK-NAME            DELIMITED BY SIZE          57922900
579230            'DP081-SOCK-ID - '         DELIMITED BY SIZE          57923000
579231            PV-SOCK-ID                 DELIMITED BY SIZE          57923100
579232                                       INTO PV-CICS-MSG-AREA.     57923200
579233     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         57923300
579234                                                                  57923400
579235     CALL 'EZASOKET'                                              57923500
579236         USING DP081-CONNECT-CMD                                  57923600
579237               DP081-SOCK-ID                                      57923700
579238               DP081-SOCK-NAME                                    57923800
579239               DP081-ERRNO                                        57923900
579240               DP081-RETCODE.                                     57924000
579241                                                                  57924100
579242     MOVE DP081-RETCODE  TO  PV-RETCODE.                          57924200
579243     MOVE DP081-ERRNO    TO  PV-ERRNO.                            57924300
579244                                                                  57924400
579245     MOVE ' *** EZASOKET CONNECT ***'  TO PV-CICS-MSG-AREA.       57924500
579246     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         57924600
579247                                                                  57924700
579248     STRING ' DP081-RETCODE - '        DELIMITED BY SIZE          57924800
579249            PV-RETCODE                 DELIMITED BY SIZE          57924900
579250            ' DP081-ERRNO - '          DELIMITED BY SIZE          57925000
579251            PV-ERRNO                   DELIMITED BY SIZE          57925100
579252                                       INTO PV-CICS-MSG-AREA.     57925200
579253     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         57925300
579254                                                                  57925400
579255     IF DP081-RETCODE < ZERO                                      57925500
579256        SET  PS-SOCKET-ERROR              TO TRUE                 57925600
579257        MOVE PC-CURRENT-PROGRAM-NAME      TO DP081-TCP-IP-PGM-NAME57925700
579258        SET  DP081-TCP-IP-CONNECT-ERR     TO TRUE                 57925800
579259        MOVE DP081-ERRNO                  TO DP081-TCP-IP-ERR-NBR 57925900
579260        MOVE DP081-TCP-IP-LOGGING-MSG     TO PV-CICS-MSG-AREA     57926000
579261        PERFORM 9990-WRITE-CICS-FOR-SOCKETS                       57926100
579262     ELSE                                                         57926200
579263        MOVE ' CONNECT SOCKET SUCCESSFUL'  TO PV-CICS-MSG-AREA    57926300
579264        PERFORM 9990-WRITE-CICS-FOR-SOCKETS                       57926400
579265     END-IF.                                                      57926500
579266                                                                  57926600
579267******************************************************************57926700
579268*  CLOSE THE SOCKET                                              *57926800
579269******************************************************************57926900
579270 4930-CLOSE-SOCKET.                                               57927000
579271     MOVE ' 4930-CLOSE-SOCKET'             TO PV-CICS-MSG-AREA.   57927100
579272     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         57927200
579273                                                                  57927300
579274     CALL 'EZASOKET'                                              57927400
579275         USING DP081-CLOSE-CMD                                    57927500
579276               DP081-SOCK-ID                                      57927600
579277               DP081-ERRNO                                        57927700
579278               DP081-RETCODE.                                     57927800
579279                                                                  57927900
579280     IF DP081-RETCODE < ZERO                                      57928000
579281        SET  PS-SOCKET-ERROR              TO TRUE                 57928100
579282        MOVE PC-CURRENT-PROGRAM-NAME      TO DP081-TCP-IP-PGM-NAME57928200
579283        SET  DP081-TCP-IP-CLOSE-ERR       TO TRUE                 57928300
579284        MOVE DP081-ERRNO                  TO DP081-TCP-IP-ERR-NBR 57928400
579285        MOVE DP081-TCP-IP-LOGGING-MSG     TO PV-CICS-MSG-AREA     57928500
579286        PERFORM 9990-WRITE-CICS-FOR-SOCKETS                       57928600
579287     ELSE                                                         57928700
579288        MOVE ' CLOSE SOCKET SUCCESSFUL'   TO PV-CICS-MSG-AREA     57928800
579289        PERFORM 9990-WRITE-CICS-FOR-SOCKETS                       57928900
579290     END-IF.                                                      57929000
579291                                                                  57929100
579292*----------------------------------------------------------------*57929200
579293*  WRITE MESSAGE TO CICS LOG W/TRAN ENDING INFO                   57929300
579294*----------------------------------------------------------------*57929400
579295     MOVE EIBTIME                    TO PT-SYS-TIME.              57929500
579296     MOVE PT-SYS-HHMM                TO PT-DISPLAY-TIME.          57929600
579297     MOVE PT-DISPLAY-HH              TO LE-END-PRT-HH.            57929700
579298     MOVE PT-DISPLAY-MM              TO LE-END-PRT-MM.            57929800
579299     MOVE LE-END-MESSAGE             TO PV-CICS-MSG-AREA.         57929900
579300     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         57930000
579301                                                                  57930100
579302                                                                  57930200
579303****************************************************************  57930300
579304* FETCH THE IP ADDRESS OF THE SERVER WHERE WE ARE SENDING THE  *  57930400
579305* TICKET REQUEST.  ALSO, SET A FLAG TO USE TCP/IP SOCKET CALLS *  57930500
579306* TO COMMUNICATE WITH THE TICKETING SYSTEM.  IF A ROW IS NOT   *  57930600
579307* FOUND, SET A FLAG TO US DRS COMMANDS TO COMMUNICATE WITH THE *  57930700
579308* TICKETING SYSTEM.                                            *  57930800
579309****************************************************************  57930900
579310 4940-FETCH-IP-ADDR.                                              57931000
579311     INITIALIZE KRPRPM-FUNC-TXT.                                  57931100
579312     MOVE ASC-KEY-OPER-UNT-ID     TO DK-OPER-UNT-ID.              57931200
579313     SET PS-USE-DRS-COMM          TO TRUE.                        57931300
579314                                                                  57931400
579315     EXEC SQL                                                     57931500
579316          SELECT                                                  57931600
579317                 B.FUNC_TXT                                       57931700
579318            INTO                                                  57931800
579319                 :KRPRPM-FUNC-TXT                                 57931900
579320            FROM                                                  57932000
579321                 TKRPRCD  A                                       57932100
579322               , TKRPRPM  B                                       57932200
579323           WHERE A.SYS_PRC_FUNC_CDE  = :ASC-TKT-OFFICE            57932300
579324             AND A.SYS_PRC_FUNC_CDE  = B.SYS_PRC_FUNC_CDE         57932400
579325             AND B.LOC_ID            = :DK-OPER-UNT-ID            57932500
579326             AND B.INTFC_SYS_CDE     = 'AVY'                      57932600
579327     END-EXEC.                                                    57932700
579328                                                                  57932800
579329     EVALUATE TRUE                                                57932900
579330     WHEN SQLCODE = ZERO                                          57933000
579331         SET PS-USE-TCP-IP-COMM                                   57933100
579332                              TO TRUE                             57933200
579333     WHEN SQLCODE = +100                                          57933300
579334         MOVE SPACES          TO KRPRPM-FUNC-TXT                  57933400
579335         SET PS-USE-DRS-COMM                                      57933500
579336                              TO TRUE                             57933600
579337     WHEN OTHER                                                   57933700
579338         MOVE '4940-FETCH-IP-ADDR'                                57933800
579339                              TO DP013-PARAGRAPH                  57933900
579340         MOVE 'UNSUCCESSFUL SELECT OF IP ADDRESS INFO'            57934000
579341                              TO DP013-MESSAGE-TEXT (1)           57934100
579342         MOVE ASC-KEY-OPER-UNT-ID                                 57934200
579343                              TO PV-OPER-UNT-ID                   57934300
579344         STRING 'REQUESTED TICKET OFFICE = ' DELIMITED BY SIZE    57934400
579345                 ASC-TKT-OFFICE              DELIMITED BY SIZE    57934500
579346                '  REQUESTING DC = '         DELIMITED BY SIZE    57934600
579347                 PV-OPER-UNT-ID-X            DELIMITED BY SIZE    57934700
579348                            INTO  DP013-MESSAGE-TEXT (2)          57934800
579349         MOVE SQLCA           TO DP013-SQLCA                      57934900
579350         MOVE 'TKRPRPM'       TO DP013-DB2-TABLE-NAME (1)         57935000
579351         SET DP013-DB2-ABEND                                      57935100
579352             DP013-XCTL-DISPLAY-RESTART                           57935200
579353                              TO TRUE                             57935300
579354         PERFORM DP013-0000-PROCESS-ABEND                         57935400
579355     END-EVALUATE.                                                57935500
579356                                                                  57935600
579357                                                                  57935700
579358 5000-PREPARE-SEL-QUEUE.                                          57935800
579359                                                                  57935900
579360     MOVE +1                     TO ASC-BLK-SUB.                  57936000
579361                                                                  57936100
579362     PERFORM 5100-WRITE-TEMP-STORAGE.                             57936200
579363                                                                  57936300
579364     ADD +1                      TO ASC-BLK-SUB.                  57936400
579365                                                                  57936500
579366     PERFORM 5100-WRITE-TEMP-STORAGE.                             57936600
579367                                                                  57936700
579368                                                                  57936800
579369     PERFORM 6010-DELETE-SEL-QUEUE.                               57936900
579370                                                                  57937000
579371     SET ASC-UPDATE-TSQ          TO TRUE.                         57937100
579372     SET PC016-IDX               TO 1.                            57937200
579373     INITIALIZE PC016-SELECTED-ITEM-ARRAY.                        57937300
579374                                                                  57937400
579375     IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                    57937500
579376         INITIALIZE PV-LINES-NOT-PRINTED                          57937600
579377         PERFORM 4505-PROCESS-TICKET-REQ                          57937700
579378     ELSE                                                         57937800
579379         MOVE ASC-KEY-PO-NBR-N   TO DK-PO-NBR                     57937900
579380         PERFORM 5300-SEARCH-FOR-SELECTION                        57938000
579381             VARYING PV-ITEM  FROM 1 BY 1                         57938100
579382             UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN          57938200
579383             IF PS-ERROR                                          57938300
579384                 MOVE PC-TSYMSG-00117                             57938400
579385                                 TO DP020-MSG-NUMBER              57938500
579386             ELSE                                                 57938600
579387                 MOVE PC-TSYMSG-00034                             57938700
579388                                 TO DP020-MSG-NUMBER              57938800
579389             END-IF                                               57938900
579390     END-IF.                                                      57939000
579391                                                                  57939100
579392     IF PC016-IDX > 1                                             57939200
579393         PERFORM 5205-WRITE-SEL-QUEUE                             57939300
579394     END-IF.                                                      57939400
579395                                                                  57939500
579396 5100-WRITE-TEMP-STORAGE.                                         57939600
579397                                                                  57939700
579398     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    57939800
579399                                 TO PV-LIST-ITEM-NUMBER.          57939900
579400     COMPUTE PV-BLOCK-NUMBER = 1 +                                57940000
579401                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).57940100
579402                                                                  57940200
579403     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           57940300
579404        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       57940400
579405                                                                  57940500
579406            PERFORM 5105-REWRITE-ASC-LISTQ                        57940600
579407                                                                  57940700
579408        END-IF                                                    57940800
579409     ELSE                                                         57940900
579410         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       57941000
579411                                     ASC-HIGHEST-BLOCK-WRITTEN + 157941100
579412         PERFORM 5110-WRITE-ASC-LISTQ                             57941200
579413                                                                  57941300
579414         ADD +1                  TO ASC-HIGHEST-BLOCK-WRITTEN     57941400
579415     END-IF.                                                      57941500
579416                                                                  57941600
579417     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     57941700
579418                                 TO TRUE.                         57941800
579419                                                                  57941900
579420 5105-REWRITE-ASC-LISTQ.                                          57942000
579421                                                                  57942100
579422     EXEC CICS WRITEQ TS                                          57942200
579423               QUEUE   (ASC-LIST-QUEUE-NAME)                      57942300
579424               FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))           57942400
579425               ITEM    (PV-BLOCK-NUMBER)                          57942500
579426               REWRITE                                            57942600
579427               RESP    (PV-CICS-RESP)                             57942700
579428     END-EXEC.                                                    57942800
579429                                                                  57942900
579430     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       57943000
579431         SET DP013-CICS-ABEND                                     57943100
579432             DP013-NO-ROLLBACK   TO TRUE                          57943200
579433         MOVE '5105-REWRITE-ASC-LISTQ'                            57943300
579434                                 TO DP013-PARAGRAPH               57943400
579435         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'57943500
579436                                 TO DP013-MESSAGE-TEXT (1)        57943600
579437         PERFORM DP013-0000-PROCESS-ABEND                         57943700
579438     END-IF.                                                      57943800
579439                                                                  57943900
579440 5110-WRITE-ASC-LISTQ.                                            57944000
579441                                                                  57944100
579442     EXEC CICS WRITEQ TS                                          57944200
579443               QUEUE (ASC-LIST-QUEUE-NAME)                        57944300
579444               FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            57944400
579445               ITEM  (PV-BLOCK-NUMBER)                            57944500
579446               RESP  (PV-CICS-RESP)                               57944600
579447     END-EXEC.                                                    57944700
579448                                                                  57944800
579449     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      57944900
579450         SET DP013-CICS-ABEND                                     57945000
579451             DP013-NO-ROLLBACK   TO TRUE                          57945100
579452         MOVE '5110-WRITE-ASC-LISTQ'                              57945200
579453                                 TO DP013-PARAGRAPH               57945300
579454         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  57945400
579455                                 TO DP013-MESSAGE-TEXT (1)        57945500
579456         PERFORM DP013-0000-PROCESS-ABEND                         57945600
579457     END-IF.                                                      57945700
579458                                                                  57945800
579459                                                                  57945900
579460 5205-WRITE-SEL-QUEUE.                                            57946000
579461                                                                  57946100
579462     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            57946200
579463                                 TO PC016-SELECTED-ITEMS.         57946300
579464                                                                  57946400
579465     EXEC CICS WRITEQ TS                                          57946500
579466               QUEUE (ASC-SEL-QUEUE-NAME)                         57946600
579467               FROM  (PC016-TS-SEL-REC)                           57946700
579468               ITEM  (PV-SEL-QUEUE-ITEM)                          57946800
579469               RESP  (PV-CICS-RESP)                               57946900
579470     END-EXEC.                                                    57947000
579471                                                                  57947100
579472     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       57947200
579473         SET DP013-CICS-ABEND                                     57947300
579474             DP013-NO-ROLLBACK   TO TRUE                          57947400
579475         MOVE '5205-WRITE-SEL-QUEUE'                              57947500
579476                                 TO DP013-PARAGRAPH               57947600
579477         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE WRITE'   57947700
579478                                 TO DP013-MESSAGE-TEXT (1)        57947800
579479         PERFORM DP013-0000-PROCESS-ABEND                         57947900
579480     END-IF.                                                      57948000
579481                                                                  57948100
579482 5300-SEARCH-FOR-SELECTION.                                       57948200
579483                                                                  57948300
579484     PERFORM 6112-READ-LIST-QUEUE.                                57948400
579485                                                                  57948500
579486     IF PV-CICS-RESP = DFHRESP (NORMAL)                           57948600
579487         PERFORM                                                  57948700
579488         VARYING LQW-IDX  FROM 1 BY 1                             57948800
579489         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  57948900
579490                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            57949000
579491                                                                  57949100
579492             IF LQW-SELECT (LQW-IDX)                              57949200
579493                 IF PS-PKITEM-FOUND                               57949300
579494                     SET PS-ERROR                                 57949400
579495                                 TO TRUE                          57949500
579496                 END-IF                                           57949600
579497             END-IF                                               57949700
579498         END-PERFORM                                              57949800
579499     END-IF.                                                      57949900
579500                                                                  57950000
579501                                                                  57950100
579502 6000-REFRESH-PANEL-FROM-TEMP.                                    57950200
579503                                                                  57950300
579504     IF ASC-UPDATE-TSQ                                            57950400
579505         SET ASC-NO-TSQ-UPDATE   TO TRUE                          57950500
579506         MOVE ZERO               TO PV-SAVE-ITEM                  57950600
579507                                    PV-SEL-QUEUE-ITEM             57950700
579508         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        57950800
579509                                 TO PV-HOLD-SELECTED-ITEMS        57950900
579510         PERFORM 6100-UPDATE-TSQ                                  57951000
579511           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS57951100
579512                                                                  57951200
579513         PERFORM 6010-DELETE-SEL-QUEUE                            57951300
579514                                                                  57951400
579515         INITIALIZE ASC-BLOCK-ENTRIES (1)                         57951500
579516                    ASC-BLOCK-ENTRIES (2)                         57951600
579517                                                                  57951700
579518         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 57951800
579519                GIVING    PV-BLOCK-NUMBER                         57951900
579520                REMAINDER PV-REMAINDER                            57952000
579521                                                                  57952100
579522         IF PV-REMAINDER > ZERO                                   57952200
579523             ADD +1              TO PV-BLOCK-NUMBER               57952300
579524         END-IF                                                   57952400
579525                                                                  57952500
579526         MOVE +1                 TO ASC-BLK-SUB                   57952600
579527                                                                  57952700
579528         PERFORM 4410-READ-TEMP-STORAGE                           57952800
579529                                                                  57952900
579530         ADD +1                  TO ASC-BLK-SUB                   57953000
579531                            PV-BLOCK-NUMBER                       57953100
579532         PERFORM 4410-READ-TEMP-STORAGE                           57953200
579533                                                                  57953300
579534     END-IF.                                                      57953400
579535                                                                  57953500
579536 6010-DELETE-SEL-QUEUE.                                           57953600
579537                                                                  57953700
579538     EXEC CICS DELETEQ TS                                         57953800
579539               QUEUE (ASC-SEL-QUEUE-NAME)                         57953900
579540               RESP  (PV-CICS-RESP)                               57954000
579541     END-EXEC.                                                    57954100
579542                                                                  57954200
579543     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     57954300
579544         (PV-CICS-RESP = DFHRESP (QIDERR)))                       57954400
579545         CONTINUE                                                 57954500
579546     ELSE                                                         57954600
579547         SET DP013-CICS-ABEND                                     57954700
579548             DP013-NO-ROLLBACK   TO TRUE                          57954800
579549         MOVE '6010-DELETE-SEL-QUEUE'                             57954900
579550                                 TO DP013-PARAGRAPH               57955000
579551         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE DELETE'  57955100
579552                                 TO DP013-MESSAGE-TEXT (1)        57955200
579553         PERFORM DP013-0000-PROCESS-ABEND                         57955300
579554     END-IF.                                                      57955400
579555                                                                  57955500
579556 6100-UPDATE-TSQ.                                                 57955600
579557                                                                  57955700
579558     ADD 1                       TO PV-SEL-QUEUE-ITEM.            57955800
579559                                                                  57955900
579560     PERFORM 6105-READ-SEL-QUEUE.                                 57956000
579561                                                                  57956100
579562     PERFORM                                                      57956200
579563     VARYING PC016-IDX  FROM 1 BY 1                               57956300
579564     UNTIL   PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS OR       57956400
579565             PC016-IDX > PC016-MAX-ITEMS                          57956500
579566                                                                  57956600
579567         IF PC016-ACTION-SW (PC016-IDX) > SPACE                   57956700
579568            PERFORM 6110-PROCESS-ITEMS                            57956800
579569         END-IF                                                   57956900
579570                                                                  57957000
579571         ADD +1                  TO PV-ITEMS-PROCESSED            57957100
579572     END-PERFORM.                                                 57957200
579573                                                                  57957300
579574     PERFORM 6111-WRITE-LIST-QUEUE.                               57957400
579575                                                                  57957500
579576                                                                  57957600
579577 6105-READ-SEL-QUEUE.                                             57957700
579578                                                                  57957800
579579     EXEC CICS READQ TS                                           57957900
579580               QUEUE (ASC-SEL-QUEUE-NAME)                         57958000
579581               INTO  (PC016-TS-SEL-REC)                           57958100
579582               ITEM  (PV-SEL-QUEUE-ITEM)                          57958200
579583               RESP  (PV-CICS-RESP)                               57958300
579584     END-EXEC.                                                    57958400
579585                                                                  57958500
579586     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       57958600
579587         SET DP013-CICS-ABEND                                     57958700
579588             DP013-NO-ROLLBACK   TO TRUE                          57958800
579589         MOVE '6105-READ-SEL-QUEUE'                               57958900
579590                                 TO DP013-PARAGRAPH               57959000
579591         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE READ'    57959100
579592                                 TO DP013-MESSAGE-TEXT (1)        57959200
579593         PERFORM DP013-0000-PROCESS-ABEND                         57959300
579594     END-IF.                                                      57959400
579595                                                                  57959500
579596 6110-PROCESS-ITEMS.                                              57959600
579597                                                                  57959700
579598     COMPUTE PV-ITEM = 1 + ((PC016-ITEM (PC016-IDX) - 1)          57959800
579599                                            / PC-ITEMS-PER-PANEL).57959900
579600                                                                  57960000
579601     IF PV-ITEM NOT = PV-SAVE-ITEM                                57960100
579602        IF PV-SAVE-ITEM NOT = ZERO                                57960200
579603                                                                  57960300
579604            PERFORM 6111-WRITE-LIST-QUEUE                         57960400
579605                                                                  57960500
579606        END-IF                                                    57960600
579607        MOVE PV-ITEM             TO PV-SAVE-ITEM                  57960700
579608                                                                  57960800
579609        PERFORM 6112-READ-LIST-QUEUE                              57960900
579610                                                                  57961000
579611     END-IF.                                                      57961100
579612                                                                  57961200
579613     COMPUTE PV-SUB = (PC016-ITEM (PC016-IDX) -                   57961300
579614                                    LQW-LIST-ITEM-NUMBER (1)) + 1.57961400
579615     SET LQW-DESELECT (PV-SUB)   TO TRUE                          57961500
579616     MOVE LQW-SELECTED-SW (PV-SUB)                                57961600
579617                                 TO LQW-TEMP-SELECTED-SW (PV-SUB).57961700
579618                                                                  57961800
579619     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                57961900
579620                                                                  57962000
579621 6111-WRITE-LIST-QUEUE.                                           57962100
579622                                                                  57962200
579623     EXEC CICS WRITEQ TS                                          57962300
579624               QUEUE (ASC-LIST-QUEUE-NAME)                        57962400
579625               FROM  (LQW-LIST-QUEUE-WORK-AREA)                   57962500
579626               ITEM  (PV-SAVE-ITEM)                               57962600
579627               REWRITE                                            57962700
579628               RESP  (PV-CICS-RESP)                               57962800
579629     END-EXEC.                                                    57962900
579630                                                                  57963000
579631     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       57963100
579632         SET DP013-CICS-ABEND                                     57963200
579633             DP013-NO-ROLLBACK   TO TRUE                          57963300
579634         MOVE '6111-WRITE-LIST-QUEUE'                             57963400
579635                                 TO DP013-PARAGRAPH               57963500
579636         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'57963600
579637                                 TO DP013-MESSAGE-TEXT(1)         57963700
579638         PERFORM DP013-0000-PROCESS-ABEND                         57963800
579639     END-IF.                                                      57963900
579640                                                                  57964000
579641 6112-READ-LIST-QUEUE.                                            57964100
579642                                                                  57964200
579643     EXEC CICS READQ TS                                           57964300
579644               QUEUE (ASC-LIST-QUEUE-NAME)                        57964400
579645               INTO  (LQW-LIST-QUEUE-WORK-AREA)                   57964500
579646               ITEM  (PV-ITEM)                                    57964600
579647               RESP  (PV-CICS-RESP)                               57964700
579648     END-EXEC.                                                    57964800
579649                                                                  57964900
579650     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       57965000
579651         SET DP013-CICS-ABEND                                     57965100
579652             DP013-NO-ROLLBACK   TO TRUE                          57965200
579653         MOVE '6112-READ-LIST-QUEUE'                              57965300
579654                                 TO DP013-PARAGRAPH               57965400
579655         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   57965500
579656                                 TO DP013-MESSAGE-TEXT(1)         57965600
579657         PERFORM DP013-0000-PROCESS-ABEND                         57965700
579658     END-IF.                                                      57965800
579659                                                                  57965900
579660 7000-GET-SPECIAL-INSTRS.                                         57966000
579661     INITIALIZE DCLTPOINST                                        57966100
579662                DCLTINSTCD.                                       57966200
579663                                                                  57966300
579664     PERFORM                                                      57966400
579665         WITH TEST AFTER                                          57966500
579666         VARYING PV-SELECT-COUNTER                                57966600
579667         FROM 1 BY 1                                              57966700
579668         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              57966800
579669            OR  (SQLCODE = ZERO)                                  57966900
579700            OR  (SQLCODE = +100)                                  57970000
579800            OR  (SQLCODE = -811))                                 57980000
579900                                                                  57990000
580000         EXEC SQL                                                 58000000
580100             SELECT  B.INSTR_DESC                                 58010000
580200               INTO  :INSTCD-INSTR-DESC                           58020000
580300               FROM  TPOINST A,                                   58030000
580400                     TINSTCD B                                    58040000
580500              WHERE  (A.PO_NBR     =  :DK-PO-NBR                  58050000
580600                AND   A.RECIP_CDE  =  'DC'                        58060000
580700                AND   A.INSTR_NBR  =  B.INSTR_NBR)                58070000
580800         END-EXEC                                                 58080000
580900                                                                  58090000
581000         EVALUATE TRUE                                            58100000
581100             WHEN SQLCODE = -904                                  58110000
581200             WHEN SQLCODE = -913                                  58120000
581300                 CONTINUE                                         58130000
581400             WHEN SQLCODE = +100                                  58140000
581500                 SET PS-NO-SPECIAL-INSTRS-FOUND    TO  TRUE       58150000
581600             WHEN SQLCODE = -811                                  58160000
581700                 SET PS-MULT-SPECIAL-INSTRS-FOUND  TO  TRUE       58170000
581800             WHEN SQLWARN0 NOT = SPACES                           58180000
581900             WHEN SQLCODE < ZERO                                  58190000
582000             WHEN SQLCODE > ZERO                                  58200000
582100                  MOVE '7000-GET-SPECIAL-INSTRS'                  58210000
582200                                     TO DP013-PARAGRAPH           58220000
582300                  MOVE 'SELECT SPECIAL INSTRUCTIONS  KEYS = '     58230000
582400                                     TO DP013-MESSAGE-TEXT (1)    58240000
582500                  MOVE DK-PO-NBR     TO PV-DISPLAY-ORD-NBR        58250000
582600                  MOVE PV-DISPLAY-KEYS                            58260000
582700                                     TO DP013-MESSAGE-TEXT (2)    58270000
582800                  MOVE SQLCA         TO DP013-SQLCA               58280000
582900                  MOVE 'TPOINST'     TO DP013-DB2-TABLE-NAME (1)  58290000
583000                  MOVE 'TINSTCD'     TO DP013-DB2-TABLE-NAME (2)  58300000
583100                  SET DP013-DB2-ABEND                             58310000
583200                                     TO TRUE                      58320000
583300                  SET DP013-NO-ROLLBACK                           58330000
583400                                     TO TRUE                      58340000
583500                  PERFORM 9999-WRITE-CICS-LOG-MSG                 58350000
583600             WHEN SQLCODE = ZERO                                  58360000
583700                 CONTINUE                                         58370000
583800         END-EVALUATE                                             58380000
583900     END-PERFORM.                                                 58390000
584000                                                                  58400000
584100     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES                       58410000
584200         MOVE '7000-GET-SPECIAL-INSTRS'                           58420000
584300                                     TO DP013-PARAGRAPH           58430000
584400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     58440000
584500                                     TO DP013-MESSAGE-TEXT (1)    58450000
584600         MOVE 'THE SPECIAL INSTRUCTIONS.  KEYS = '                58460000
584700                                     TO DP013-MESSAGE-TEXT (2)    58470000
584800         MOVE DK-PO-NBR              TO PV-DISPLAY-ORD-NBR        58480000
584900         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    58490000
585000         MOVE SQLCA                  TO DP013-SQLCA               58500000
585100         MOVE 'TPOINST'              TO DP013-DB2-TABLE-NAME (1)  58510000
585200         MOVE 'TINSTCD'              TO DP013-DB2-TABLE-NAME (2)  58520000
585300         SET DP013-DB2-ABEND         TO TRUE                      58530000
585400         SET DP013-NO-ROLLBACK       TO TRUE                      58540000
585500         PERFORM 9999-WRITE-CICS-LOG-MSG                          58550000
585600     END-IF.                                                      58560000
585700                                                                  58570000
585800/                                                                 58580000
585801 7050-GET-PUT-AWAY-CDE.                                           58580133
585802                                                                  58580200
585803     INITIALIZE XLT00022-PUT-AWY-CDE                              58580333
585804                                                                  58580433
585805     PERFORM                                                      58580500
585806         WITH TEST AFTER                                          58580600
585807         VARYING PV-SELECT-COUNTER                                58580700
585808         FROM 1 BY 1                                              58580800
585809         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              58580900
585810            OR  (SQLCODE = ZERO)                                  58581000
585811            OR  (SQLCODE = +100)                                  58581100
585812            OR  (SQLCODE = -811))                                 58581200
585813                                                                  58581300
585814         EXEC SQL                                                 58581400
585815             SELECT  A.PUT_AWY_CDE                                58581500
585816               INTO  :XLT00022-PUT-AWY-CDE                        58581600
585817               FROM  XLT_MAJ_CL A                                 58581700
585818              WHERE   A.DEPT_NBR   =  :XLT00022-DEPT-NBR          58581800
585819                AND   A.MAJ_CL_NBR =  :XLT00022-MAJ-CL-NBR        58581900
585820         END-EXEC                                                 58582000
585821                                                                  58582100
585822         EVALUATE TRUE                                            58582200
585823             WHEN SQLCODE = ZERO                                  58582300
585824             WHEN SQLCODE = +100                                  58582400
585825                 CONTINUE                                         58582533
585826             WHEN SQLCODE = -904                                  58582600
585827             WHEN SQLCODE = -911                                  58582700
585828             WHEN SQLCODE = -913                                  58582800
585829                 CONTINUE                                         58582900
585830             WHEN SQLWARN0 NOT = SPACES                           58583000
585831             WHEN SQLCODE < ZERO                                  58583100
585832             WHEN SQLCODE > ZERO                                  58583200
585833                  MOVE '7050-GET-PUT-AWAY-CDE'                    58583300
585834                                     TO DP013-PARAGRAPH           58583400
585835                  MOVE 'SELECT PUT AWAY CDE -- KEYS = '           58583500
585836                                     TO DP013-MESSAGE-TEXT (1)    58583600
585837                                                                  58583700
585838                 MOVE ASC-DEPT-NBR-N     TO   PV-DC-DEPT-NMBR     58583800
585839                 MOVE '-'            TO   PV-DASH                 58583900
585840                 MOVE LQW-MAJOR-CLASS (LQW-IDX)                   58584000
585841                                     TO   PV-DC-MAJOR-CLASS       58584100
585842                  MOVE PV-DEPT-CLASS                              58584200
585843                                     TO DP013-MESSAGE-TEXT (2)    58584300
585844                  MOVE SQLCA         TO DP013-SQLCA               58584400
585845                  MOVE 'XLT_MAJ_CL'  TO DP013-DB2-TABLE-NAME (1)  58584500
585846                  SET DP013-DB2-ABEND                             58584600
585847                                     TO TRUE                      58584700
585848                  SET DP013-NO-ROLLBACK                           58584800
585849                                     TO TRUE                      58584900
585850                  PERFORM 9999-WRITE-CICS-LOG-MSG                 58585000
585851         END-EVALUATE                                             58585100
585852     END-PERFORM.                                                 58585200
585853                                                                  58585300
585854     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES                       58585400
585855         MOVE '7050-GET-PUT-AWAY-CDE'                             58585500
585856                                     TO DP013-PARAGRAPH           58585600
585857         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     58585700
585858                                     TO DP013-MESSAGE-TEXT (1)    58585800
585859         MOVE 'SELECT PUT AWAY CDE -- KEYS = '                    58585900
585860                                     TO DP013-MESSAGE-TEXT (2)    58586000
585861                                                                  58586100
585862         MOVE ASC-DEPT-NBR-N     TO   PV-DC-DEPT-NMBR             58586200
585863         MOVE '-'            TO   PV-DASH                         58586300
585864         MOVE LQW-MAJOR-CLASS (LQW-IDX)                           58586400
585865                                     TO   PV-DC-MAJOR-CLASS       58586500
585866         MOVE PV-DEPT-CLASS          TO DP013-MESSAGE-TEXT (3)    58586600
585867         MOVE SQLCA                  TO DP013-SQLCA               58586700
585868         MOVE 'XLT_MAJ_CL'           TO DP013-DB2-TABLE-NAME (1)  58586800
585869         SET DP013-DB2-ABEND         TO TRUE                      58586900
585870         SET DP013-NO-ROLLBACK       TO TRUE                      58587000
585871         PERFORM 9999-WRITE-CICS-LOG-MSG                          58587100
585872     END-IF.                                                      58587200
585873                                                                  58587300
585900******************************************************************58590000
586000*  CONNECT THE PATH (SOCKET) AND SEND THE DATA TO THE TICKET     *58600000
586100*  SYSTEM PC RUNNING AVERY LMS.                                  *58610000
586200******************************************************************58620000
586300 8100-SEND-DATA-TO-LPMS.                                          58630000
586400     MOVE ' 8100-SEND-DATA-TO-LPMS' TO PV-CICS-MSG-AREA.          58640000
586500     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         58650000
586600                                                                  58660000
586700     MOVE LOW-VALUES              TO TCP-BUF.                     58670000
586800     MOVE DL-DETAIL-LINE          TO TCP-BUF.                     58680000
586900                                                                  58690000
587000*----------------------------------------------------*            58700000
587100* DISPLAY RECORD TO BE DOWNLOADED (CSSL); THIS WILL  *            58710000
587200* BE DONE IN TWO LINES -- POS 1-96 ON LINE 1 AND     *            58720000
587300* POS 97-176 ON LINE 2.                              *            58730000
587400*----------------------------------------------------*            58740000
587500     MOVE DL-DETAIL-LINE          TO PV-DETAIL-LINE.              58750000
587600     STRING ' <'                     DELIMITED BY SIZE            58760000
587700            PV-DETAIL-LINE-POS-1-97  DELIMITED BY SIZE            58770000
587800            '>'                      DELIMITED BY SIZE            58780000
587900                                INTO PV-CICS-MSG-AREA.            58790000
588000     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         58800000
588100*                                                                 58810000
588200     STRING ' <'                      DELIMITED BY SIZE           58820000
588300            PV-DETAIL-LINE-POS-98-177 DELIMITED BY SIZE           58830000
588400            '>'                       DELIMITED BY SIZE           58840000
588500                                INTO PV-CICS-MSG-AREA.            58850000
588600     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         58860000
588700*                                                                 58870000
588800     STRING ' <'                       DELIMITED BY SIZE          58880000
588900            PV-DETAIL-LINE-POS-178-210 DELIMITED BY SIZE          58890000
589000            '>'                        DELIMITED BY SIZE          58900000
589100                                INTO PV-CICS-MSG-AREA.            58910000
589200     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         58920000
589300*                                                                 58930000
589400*-----------------------------------------------------*           58940000
589500* DISPLAY TCP LENGTH (CSSL)                           *           58950000
589600*-----------------------------------------------------*           58960000
589700     MOVE  DP081-TCPLENG               TO  PV-TCPLENG.            58970000
589800     STRING ' DP081-TCPLENG - '        DELIMITED BY SIZE          58980000
589900            PV-TCPLENG                 DELIMITED BY SIZE          58990000
590000                                       INTO PV-CICS-MSG-AREA.     59000000
590100     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         59010000
590200                                                                  59020000
590300*-----------------------------------------------------*           59030000
590400*  CONVERT FROM EBCDIC TO ASCII                       *           59040000
590500*-----------------------------------------------------*           59050000
590600     CALL 'EZACIC04'                                              59060000
590700         USING DP081-TOASCII-TOKEN                                59070000
590800               TCP-BUF                                            59080000
590900               DP081-TCPLENG.                                     59090000
591000                                                                  59100000
591100*-----------------------------------------------------*           59110000
591200* DISPLAY TCP TOKEN (CSSL)                            *           59120000
591300*-----------------------------------------------------*           59130000
591400     STRING ' DP081-TCP-TOKEN - '      DELIMITED BY SIZE          59140000
591500            DP081-TCP-TOKEN            DELIMITED BY SIZE          59150000
591600                                       INTO PV-CICS-MSG-AREA.     59160000
591700     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         59170000
591800*                                                                 59180000
591900*-----------------------------------------------------*           59190000
592000* DISPLAY SEND COMMAND (CSSL)                         *           59200000
592100*-----------------------------------------------------*           59210000
592200     MOVE  DP081-SOCK-ID               TO  PV-SOCK-ID.            59220000
592300     STRING ' SEND COMMAND IS - '      DELIMITED BY SIZE          59230000
592400            DP081-SEND-CMD             DELIMITED BY SIZE          59240000
592500            ' SOCKET ID IS - '         DELIMITED BY SIZE          59250000
592600            PV-SOCK-ID                 DELIMITED BY SIZE          59260000
592700                                       INTO PV-CICS-MSG-AREA.     59270000
592800     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         59280000
592900*                                                                 59290000
593000*-----------------------------------------------------*           59300000
593100* DISPLAY TCP LENGTH 2 (CSSL)                         *           59310000
593200*-----------------------------------------------------*           59320000
593300     MOVE  DP081-TCPLENG               TO  PV-TCPLENG.            59330000
593400     MOVE  DP081-FLAG                  TO  PV-FLAG.               59340000
593500     STRING ' DP081-TCPLENG 2 - '      DELIMITED BY SIZE          59350000
593600            PV-TCPLENG                 DELIMITED BY SIZE          59360000
593700            '  DP081-FLAG - '          DELIMITED BY SIZE          59370000
593800            PV-FLAG                    DELIMITED BY SIZE          59380000
593900                                       INTO PV-CICS-MSG-AREA.     59390000
594000     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         59400000
594100                                                                  59410000
594200*-----------------------------------------------------*           59420000
594300* SEND THE DATA DOWN TO THE TICKETING SYSTEM PC USING *           59430000
594400* THE SOCKET.                                         *           59440000
594500*-----------------------------------------------------*           59450000
594600**** SET  DP081-OUT-OF-BAND-FLAG TO TRUE.                         59460000
594610     SET  DP081-NO-FLAG          TO TRUE.                         59461033
594700                                                                  59470000
594800     CALL 'EZASOKET'                                              59480000
594900         USING DP081-SEND-CMD                                     59490000
595000               DP081-SOCK-ID                                      59500000
595100               DP081-FLAG                                         59510000
595200               DP081-NBR-BYTES                                    59520000
595300               TCP-BUF                                            59530000
595400               DP081-ERRNO                                        59540000
595500               DP081-RETCODE.                                     59550000
595600                                                                  59560000
595700*-----------------------------------------------------*           59570000
595800* DISPLAY RETURN CODE & ERROR NUMBER                  *           59580000
595900*-----------------------------------------------------*           59590000
596000     MOVE  DP081-RETCODE  TO  PV-RETCODE.                         59600000
596100     MOVE  DP081-ERRNO    TO  PV-ERRNO.                           59610000
596200     STRING ' DP081-RETCODE - '        DELIMITED BY SIZE          59620000
596300            PV-RETCODE                 DELIMITED BY SIZE          59630000
596400            '  DP081-ERRNO - '         DELIMITED BY SIZE          59640000
596500            PV-ERRNO                   DELIMITED BY SIZE          59650000
596600                                       INTO PV-CICS-MSG-AREA.     59660000
596700     PERFORM 9990-WRITE-CICS-FOR-SOCKETS.                         59670000
596800                                                                  59680000
596900     IF  DP081-RETCODE < ZERO                                     59690000
597000         SET  PS-SOCKET-ERROR             TO TRUE                 59700000
597100         MOVE PC-CURRENT-PROGRAM-NAME     TO DP081-TCP-IP-PGM-NAME59710000
597200         SET  DP081-TCP-IP-SEND-TO-ERR    TO TRUE                 59720000
597300         MOVE DP081-ERRNO                 TO DP081-TCP-IP-ERR-NBR 59730000
597400         MOVE DP081-TCP-IP-LOGGING-MSG    TO PV-CICS-MSG-AREA     59740000
597500         PERFORM 9990-WRITE-CICS-FOR-SOCKETS                      59750000
597600     ELSE                                                         59760000
597700         MOVE ' SEND SUCCESSFUL'                                  59770000
597800                                      TO PV-CICS-MSG-AREA         59780000
597900         PERFORM 9990-WRITE-CICS-FOR-SOCKETS                      59790000
598000     END-IF.                                                      59800000
598100                                                                  59810000
598200                                                                  59820000
598300******************************************************************59830000
598400* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *59840000
598500******************************************************************59850000
598600 9100-READ-SEL-QUEUE.                                             59860000
598700     EXEC CICS                                                    59870000
598800         READQ TS                                                 59880000
598900             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        59890000
599000             INTO  (PC016-TS-SEL-REC)                             59900000
599100             ITEM  (ASC-SEL-ITEM)                                 59910000
599200             RESP  (PV-CICS-RESP)                                 59920000
599300     END-EXEC.                                                    59930000
599400                                                                  59940000
599500     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        59950000
599600         CONTINUE                                                 59960000
599700     ELSE                                                         59970000
599800         SET DP013-LOGIC-ABEND                                    59980000
599900             DP013-NO-ROLLBACK     TO TRUE                        59990000
600000         MOVE '9100-READ-SEL-QUEUE'                               60000000
600100                                   TO DP013-PARAGRAPH             60010000
600200         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    60020000
600300                                   TO DP013-MESSAGE-TEXT (1)      60030000
600400         PERFORM DP013-0000-PROCESS-ABEND                         60040000
600500     END-IF.                                                      60050000
600600                                                                  60060000
600700/                                                                 60070000
600800******************************************************************60080000
600900* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *60090000
601000******************************************************************60100000
601100 9200-REWRITE-LIST-QUEUE.                                         60110000
601200     EXEC CICS                                                    60120000
601300          WRITEQ TS                                               60130000
601400              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     60140000
601500              FROM    (PC016-TS-SEL-REC)                          60150000
601600              ITEM    (ASC-SEL-ITEM)                              60160000
601700              RESP    (PV-CICS-RESP)                              60170000
601800              REWRITE                                             60180000
601900     END-EXEC.                                                    60190000
602000                                                                  60200000
602100     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    60210000
602200         SET DP013-CICS-ABEND                                     60220000
602300             DP013-NO-ROLLBACK     TO TRUE                        60230000
602400         MOVE '9200-REWRITE-LIST-QUEUE'                           60240000
602500                                   TO DP013-PARAGRAPH             60250000
602600         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   60260000
602700                                   TO DP013-MESSAGE-TEXT (1)      60270000
602800         PERFORM DP013-0000-PROCESS-ABEND                         60280000
602900     END-IF.                                                      60290000
603000                                                                  60300000
603100/                                                                 60310000
603200******************************************************************60320000
603300*    ABEND PROCESSING                                             60330000
603400******************************************************************60340000
603500     COPY DPPD013.                                                60350000
603600                                                                  60360000
603700******************************************************************60370000
603800*  WRITE TO CSSL LOG FOR THE TCP/IP SOCKET CALLS                  60380000
603900******************************************************************60390000
604000 9990-WRITE-CICS-FOR-SOCKETS.                                     60400000
604100                                                                  60410000
604200     EXEC CICS                                                    60420000
604300         WRITEQ TD                                                60430000
604400         QUEUE('CSSL')                                            60440000
604500         FROM(PV-CICS-MSG-AREA)                                   60450000
604600         RESP(PV-CICS-RESP)                                       60460000
604700     END-EXEC.                                                    60470000
604800                                                                  60480000
604900     MOVE SPACES TO PV-CICS-MSG-AREA.                             60490000
605000                                                                  60500000
605100                                                                  60510000
605200 9999-WRITE-CICS-LOG-MSG.                                         60520000
605300     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              60530000
605400     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             60540000
605500     INITIALIZE DP013-SRC-TASK-NUMBER                             60550000
605600                DP013-STACK.                                      60560000
605700     SET DP013-LINK-RETURN         TO TRUE.                       60570000
605800                                                                  60580000
605900     EXEC CICS                                                    60590000
606000         XCTL                                                     60600000
606100             PROGRAM   (DP013-NAME)                               60610000
606200             COMMAREA  (DP013-PARAMETERS)                         60620000
606300             LENGTH    (DP013-LENGTH)                             60630000
606400     END-EXEC.                                                    60640000
606500                                                                  60650000
