000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             ARKUT082.                                00050001
000600 AUTHOR.                 KAREN GIVENS.                            00060001
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            02-14-2012.                              00080001
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001100* THE PURPOSE OF THIS PROGRAM IS TO READ THROUGH FIRST DATA       00120041
001100* CARDHOLDER MASTER SOURCE FILE TO VERIFY THAT WE RECEIVED ALL    00130041
001100* THE RECORDS FROM FD AND TO PRODUCE OTHER OUTPUT DATASETS        00140041
001100* THAT CONTAIN RECORD COUNTS.                                     00150041
001100* THIS PROGRAM WILL WRITE OUT AN EXACT COPY OF THE CARDHOLDER     00160041
001100* MASTER SOURCE FILE WITHOUT HEADER AND TRAILER RECORDS.          00170041
001100* THIS PROGRAM WILL WRITE OUT 11 OUTPUT COUNT FILES.              00180041
001500******************************************************************00190000
      *  2012-03-22    REIGH      FIX LOGIC FOR HRSK-ACS COUNTER        00191042
      ******************************************************************00192042
C86513******************************************************************00193043
C86513* 17/07/2014  COGNIZANT   CHG0086513                              00194044
C86513*  - ADDED NEW FIELDS IN THE CARD MASTER FILE AS PART OF THE      00195043
C86513*    FD JULY MAJOR RELEASE                                        00196043
C86513******************************************************************00197043
C95928******************************************************************00198047
C95928* 10/21/2014  COGNIZANT   CHG0095928                              00199047
C95928*  - ADDED NEW FIELDS IN THE CARD MASTER FILE AS PART OF THE      00199147
C95928*    FD OCT  MAJOR RELEASE                                        00199248
C95928******************************************************************00199347
C18039******************************************************************00199449
C18039* 27/07/2015  COGNIZANT   CHG0118039                              00199549
C18039*  - ADDED NEW FIELDS IN THE CARD MASTER FILE AS PART OF THE      00199649
C18039*    FD JUL'15  MAJOR RELEASE                                     00199750
C18039******************************************************************00199849
FD1601******************************************************************00199952
FD1601* 01/18/2015  COGNIZANT   CHG0131733                              00200052
FD1601*  - ADDED NEW FIELDS IN THE CARD MASTER FILE AS PART OF THE      00200152
FD1601*    FD JAN'16  MAJOR RELEASE                                     00200252
FD1601******************************************************************00200352
FD1607******************************************************************00200454
FD1607* 06/20/2016  COGNIZANT   CHG0146102                              00200554
FD1607*  - ADDED NEW FIELDS IN THE CARD MASTER FILE AS PART OF THE      00200654
FD1607*    FD JULY'16  MAJOR RELEASE                                    00200754
FD1607******************************************************************00200854
FD1607******************************************************************00200955
FD1704* 04/21/2017  COGNIZANT   CHG0166796                              00201055
FD1704*  - ADDED NEW FIELDS IN THE CARD MASTER FILE AS PART OF THE      00201155
FD1704*    FD APR'17  MAJOR RELEASE                                     00201255
FD1704******************************************************************00201355
FD1607******************************************************************00201456
FD1707* 07/21/2017  COGNIZANT   CHG0173282                              00201556
FD1707*  - ADDED NEW FIELDS IN THE CARD MASTER FILE AS PART OF THE      00201656
FD1707*    FD JUL'17  MAJOR RELEASE                                     00201756
FD1707******************************************************************00201856
001600                                                                  00202055
001700******************************************************************00210000
001800 ENVIRONMENT DIVISION.                                            00220000
001900******************************************************************00230000
002000                                                                  00240000
002100 CONFIGURATION SECTION.                                           00250000
002200                                                                  00260000
002300 SOURCE-COMPUTER.        IBM-3090.                                00270000
002400 OBJECT-COMPUTER.        IBM-3090.                                00280000
002500                                                                  00290000
002600 INPUT-OUTPUT SECTION.                                            00300000
002700                                                                  00310000
002800 FILE-CONTROL.                                                    00320000
002900                                                                  00330000
003000     SELECT CARD-MASTER-IN-FILE                                   00340000
003100         ASSIGN TO INP01.                                         00350000
003300     SELECT CARD-MASTER-OUT-FILE                                  00360000
003400         ASSIGN TO OUT01.                                         00370000
003401     SELECT TOTAL-NBR-BASE-SGMTS-FILE                             00380003
003402         ASSIGN TO OUT02.                                         00390000
003403     SELECT TOTAL-NBR-HIST-SGMTS-FILE                             00400003
003404         ASSIGN TO OUT03.                                         00410000
003405     SELECT TOTAL-NBR-MONETARY-SGMTS-FILE                         00420003
003406         ASSIGN TO OUT04.                                         00430000
003407     SELECT TOTAL-NBR-CUST-SGMTS-FILE                             00440003
003408         ASSIGN TO OUT05.                                         00450001
003409     SELECT TOTAL-NBR-BHVSCR-SGMTS-FILE                           00460003
003410         ASSIGN TO OUT06.                                         00470001
003411     SELECT TOTAL-NBR-DELSEGS-SGMTS-FILE                          00480003
003412         ASSIGN TO OUT07.                                         00490001
003413     SELECT TOTAL-NBR-DELITEMS-SGMTS-FILE                         00500003
003414         ASSIGN TO OUT08.                                         00510001
003415     SELECT TOTAL-NBR-SLSSYD-SGMTS-FILE                           00520003
003416         ASSIGN TO OUT09.                                         00530001
003417     SELECT TOTAL-NBR-HRSKACS-SGMTS-FILE                          00540004
003418         ASSIGN TO OUT10.                                         00550002
003419     SELECT TOTAL-NBR-MISC1-SGMTS-FILE                            00560003
003420         ASSIGN TO OUT11.                                         00570002
003421     SELECT TOTAL-NBR-MISC2-SGMTS-FILE                            00580003
003422         ASSIGN TO OUT12.                                         00590002
003500                                                                  00600000
003600******************************************************************00610000
003700 DATA DIVISION.                                                   00620000
003800******************************************************************00630000
003900                                                                  00640000
004000 FILE SECTION.                                                    00650000
004100                                                                  00660000
004200 FD CARD-MASTER-IN-FILE                                           00670000
004300     RECORDING MODE V                                             00680000
004400     LABEL RECORDS ARE STANDARD                                   00690000
004600     BLOCK CONTAINS 0 RECORDS                                     00700020
004600     RECORD IS VARYING IN SIZE                                    00710020
004600               FROM 120 TO 23548                                  00720020
004600                   DEPENDING ON IN-REC-LENGTH.                    00730020
004601 01 IN-MASTER-RECORD.                                             00740009
004602    05 IN-MASTER-RECORD-ID          PIC X(06).                    00750009
005000       88  IN-MSTR-HEADER           VALUE "00HD01".               00760014
005000       88  IN-MSTR-TRAILER          VALUE "99TL01".               00770014
005001       88  IN-MSTR-RECORD           VALUE "01MST1"  "01MST2"      00780011
005002                                          "01MST3"  "01MST4".     00790011
005003       88  IN-MSTR-RECORD-01        VALUE "01MST1".               00800009
005004       88  IN-MSTR-RECORD-02        VALUE "01MST2".               00810009
005005       88  IN-MSTR-RECORD-03        VALUE "01MST3".               00820009
005006       88  IN-MSTR-RECORD-04        VALUE "01MST4".               00830009
005007       88  IN-FLAP-RECORD           VALUE "02FLAP".               00840009
005008       88  IN-BFLP-RECORD           VALUE "03BFLP".               00850009
005009       88  IN-MTHO-RECORD           VALUE "04MTHO".               00860009
005010       88  IN-CHKP-RECORD           VALUE "05CHKP".               00870009
005011       88  IN-CIT-RECORD            VALUE "12CIT ".               00880009
005012       88  IN-DSPT-RECORD           VALUE "10DSPT".               00890009
005014    05 FILLER                       PIC X(23542).                 00900023
005015************************************************************      00910009
006200* FOR 01 LEVELS, ADD 10 BYTES TO ACCOUNT FOR REC IDENTIFIER.      00920007
006300************************************************************      00930007
006400 01 IN-MSTR-REC                     PIC X(16336).                 00940020
006400 01 IN-FLAP-REC                     PIC X(3931).                  00950020
006902 01 IN-BFLP-REC                     PIC X(137).                   00960027
006903 01 IN-MTHO-REC                     PIC X(12226).                 00970020
006904 01 IN-CHKP-REC                     PIC X(14213).                 00980020
006905 01 IN-CIT-REC                      PIC X(120).                   00990020
006906 01 IN-DSPT-REC                     PIC X(23548).                 01000007
006907                                                                  01010000
006908 FD CARD-MASTER-OUT-FILE                                          01020000
006909     RECORDING MODE IS V                                          01030002
006910     LABEL RECORDS ARE STANDARD                                   01040002
006912     BLOCK CONTAINS 0 RECORDS                                     01050020
004600     RECORD IS VARYING IN SIZE                                    01060020
004600               FROM 120 TO 23548                                  01070020
004600                   DEPENDING ON OUT-REC-LENGTH.                   01080020
006913************************************************************      01090007
006914* FOR 01 LEVELS, ADD 10 BYTES TO ACCOUNT FOR REC IDENTIFIER.      01100007
006915************************************************************      01110007
006400 01 OUT-MSTR-REC                    PIC X(16336).                 01120020
006916 01 OUT-FLAP-REC                    PIC X(3931).                  01130020
006917 01 OUT-BFLP-REC                    PIC X(137).                   01140027
006918 01 OUT-MTHO-REC                    PIC X(12226).                 01150020
006919 01 OUT-CHKP-REC                    PIC X(14213).                 01160020
006920 01 OUT-CIT-REC                     PIC X(120).                   01170020
006921 01 OUT-DSPT-REC                    PIC X(23548).                 01180007
006922                                                                  01190000
006923 FD TOTAL-NBR-BASE-SGMTS-FILE                                     01200002
006924     RECORDING MODE IS F                                          01210000
006925     BLOCK CONTAINS 0 RECORDS                                     01220000
006926     LABEL RECORDS ARE STANDARD.                                  01230000
006927 01  TOTAL-NBR-BASE-SGMTS-REC        PIC X(80).                   01240002
006928                                                                  01250000
006929 FD TOTAL-NBR-HIST-SGMTS-FILE                                     01260002
006930     RECORDING MODE IS F                                          01270000
006931     BLOCK CONTAINS 0 RECORDS                                     01280000
006932     LABEL RECORDS ARE STANDARD.                                  01290000
006933 01  TOTAL-NBR-HIST-SGMTS-REC        PIC X(80).                   01300002
006934                                                                  01310000
006935 FD TOTAL-NBR-MONETARY-SGMTS-FILE                                 01320002
006936     RECORDING MODE IS F                                          01330000
006937     BLOCK CONTAINS 0 RECORDS                                     01340000
006938     LABEL RECORDS ARE STANDARD.                                  01350000
006939 01  TOTAL-NBR-MONETARY-SGMTS-REC    PIC X(80).                   01360002
006940                                                                  01370002
006941 FD TOTAL-NBR-CUST-SGMTS-FILE                                     01380002
006942     RECORDING MODE IS F                                          01390002
006943     BLOCK CONTAINS 0 RECORDS                                     01400002
006944     LABEL RECORDS ARE STANDARD.                                  01410002
006945 01  TOTAL-NBR-CUST-SGMTS-REC        PIC X(80).                   01420002
006946                                                                  01430002
006947 FD TOTAL-NBR-BHVSCR-SGMTS-FILE                                   01440002
006948     RECORDING MODE IS F                                          01450002
006949     BLOCK CONTAINS 0 RECORDS                                     01460002
006950     LABEL RECORDS ARE STANDARD.                                  01470002
006951 01  TOTAL-NBR-BHVSCR-SGMTS-REC      PIC X(80).                   01480002
006952                                                                  01490002
006953 FD TOTAL-NBR-DELSEGS-SGMTS-FILE                                  01500002
006954     RECORDING MODE IS F                                          01510002
006955     BLOCK CONTAINS 0 RECORDS                                     01520002
006956     LABEL RECORDS ARE STANDARD.                                  01530002
006957 01  TOTAL-NBR-DELSEGS-SGMTS-REC     PIC X(80).                   01540002
006958                                                                  01550002
006959 FD TOTAL-NBR-DELITEMS-SGMTS-FILE                                 01560002
006960     RECORDING MODE IS F                                          01570002
006961     BLOCK CONTAINS 0 RECORDS                                     01580002
006962     LABEL RECORDS ARE STANDARD.                                  01590002
006963 01  TOTAL-NBR-DELITEMS-SGMTS-REC    PIC X(80).                   01600002
006964                                                                  01610002
006965 FD TOTAL-NBR-SLSSYD-SGMTS-FILE                                   01620002
006966     RECORDING MODE IS F                                          01630002
006967     BLOCK CONTAINS 0 RECORDS                                     01640002
006968     LABEL RECORDS ARE STANDARD.                                  01650002
006969 01  TOTAL-NBR-SLSSYD-SGMTS-REC      PIC X(80).                   01660002
006970                                                                  01670002
006971 FD TOTAL-NBR-HRSKACS-SGMTS-FILE                                  01680002
006972     RECORDING MODE IS F                                          01690002
006973     BLOCK CONTAINS 0 RECORDS                                     01700002
006974     LABEL RECORDS ARE STANDARD.                                  01710002
006975 01  TOTAL-NBR-HRSKACS-SGMTS-REC     PIC X(80).                   01720002
006976                                                                  01730002
006977 FD TOTAL-NBR-MISC1-SGMTS-FILE                                    01740002
006978     RECORDING MODE IS F                                          01750002
006979     BLOCK CONTAINS 0 RECORDS                                     01760002
006980     LABEL RECORDS ARE STANDARD.                                  01770002
006981 01  TOTAL-NBR-MISC1-SGMTS-REC       PIC X(80).                   01780002
006982                                                                  01790002
006983 FD TOTAL-NBR-MISC2-SGMTS-FILE                                    01800002
006984     RECORDING MODE IS F                                          01810002
006985     BLOCK CONTAINS 0 RECORDS                                     01820002
006986     LABEL RECORDS ARE STANDARD.                                  01830002
006987 01  TOTAL-NBR-MISC2-SGMTS-REC       PIC X(80).                   01840002
006988                                                                  01850002
006989 WORKING-STORAGE SECTION.                                         01860000
006990******************************************************************01870000
006991*                        ABEND CODES                              01880000
006992******************************************************************01890000
006993     COPY ARWS052.                                                01900000
006994                                                                  01910000
006995******************************************************************01920000
006996*                        SWITCHES                                 01930000
006997******************************************************************01940000
006998 01 PS-PROGRAM-SWITCHES.                                          01950000
006999    05 PS-PROCESSING-SW               PIC X      VALUE SPACES.    01960000
007000       88 PS-CONTINUE-PROCESSING                 VALUE 'Y'.       01970000
007001       88 PS-STOP-PROCESSING                     VALUE 'N'.       01980000
007002                                                                  01990000
007003******************************************************************02000000
007004*                        CONSTANTS                                02010000
007005******************************************************************02020000
007100 01 PC-PROGRAM-CONSTANTS.                                         02030000
007200    05 PC-PROGRAM-NAME                PIC X(8)   VALUE 'ARKUT082'.02040002
007300                                                                  02050000
007400******************************************************************02060000
007500*                        VARIABLES                                02070000
007600******************************************************************02080000
007700 01 PV-PROGRAM-VARIABLES.                                         02090000
008000    05 PV-READ-COUNT                  PIC S9(9)  VALUE ZEROES     02100000
008100                                                 COMP.            02110000
008101    05 PV-CRDMAST-COUNT               PIC S9(9)  VALUE ZEROES     02120002
008102                                                 COMP.            02130000
008103    05 PV-BASE-COUNT                  PIC S9(9)  VALUE ZEROES     02140002
008104                                                 COMP.            02150000
008105    05 PV-HIST-COUNT                  PIC S9(9)  VALUE ZEROES     02160002
008106                                                 COMP.            02170000
008107    05 PV-MONETARY-COUNT              PIC S9(9)  VALUE ZEROES     02180002
008108                                                 COMP.            02190000
008109    05 PV-CUST-COUNT                  PIC S9(9)  VALUE ZEROES     02200002
008110                                                 COMP.            02210000
008111    05 PV-BHVSCR-COUNT                PIC S9(9)  VALUE ZEROES     02220002
008112                                                 COMP.            02230000
008113    05 PV-DELSEGS-COUNT               PIC S9(9)  VALUE ZEROES     02240002
008114                                                 COMP.            02250000
008115    05 PV-DELITEMS-COUNT              PIC S9(9)  VALUE ZEROES     02260002
008116                                                 COMP.            02270000
008117    05 PV-SLSSYD-COUNT                PIC S9(9)  VALUE ZEROES     02280002
008118                                                 COMP.            02290002
008119    05 PV-HRSKACS-COUNT               PIC S9(9)  VALUE ZEROES     02300002
008120                                                 COMP.            02310002
008121    05 PV-MISC1-COUNT                 PIC S9(9)  VALUE ZEROES     02320002
008122                                                 COMP.            02330002
008123    05 PV-MISC2-COUNT                 PIC S9(9)  VALUE ZEROES     02340002
008124                                                 COMP.            02350002
008123    05 PV-MSTRTLR-COUNT               PIC S9(9)  VALUE ZEROES     02360014
008124                                                 COMP.            02370014
008200    05 PV-BTCH-DATE.                                              02380000
008300       10 PV-BTCH-DATE-YYYY           PIC 9(04)  VALUE ZEROS.     02390000
008400       10 PV-BTCH-DATE-MM             PIC 9(02)  VALUE ZEROS.     02400000
008500       10 PV-BTCH-DATE-DD             PIC 9(02)  VALUE ZEROS.     02410000
008600    05 PV-BTCH-NBR.                                               02420000
008700       10 PV-BTCH-SEQ-NBR             PIC 9(1)   VALUE ZERO.      02430000
008800       10 PV-BTCH-MM                  PIC 9(2)   VALUE ZEROS.     02440000
008900       10 PV-BTCH-DD                  PIC 9(2)   VALUE ZEROS.     02450000
009202    05 PV-TRAILER-REC-CNT             PIC S9(11) VALUE ZEROES.    02460033
008920    77 IN-REC-LENGTH                  PIC 9(5)   VALUE ZEROS.     02470020
008920    77 OUT-REC-LENGTH                 PIC 9(5)   VALUE ZEROS.     02480020
009000******************************************************************02490002
009100*                        WORK AREA                                02500002
009200******************************************************************02510002
009201 01 IN-TRAILER-RECORD.                                            02520033
009203    05 FILLER                       PIC X(67) VALUE SPACES.       02530033
009202    05 IN-TRAILER-REC-CNT           PIC S9(11) VALUE ZEROES.      02540033
009203    05 FILLER                       PIC X(239) VALUE SPACES.      02550033
009204                                                                  02560011
009201 01 OUT-TOTAL-RECORD.                                             02570033
009202    05 OUT-TOTAL-RECORD-COUNT       PIC 9(10) VALUE ZEROES.       02580033
009203    05 FILLER                       PIC X(70) VALUE SPACES.       02590033
009204                                                                  02600033
009205******************************************************************02610002
009206*                        COPYBOOKS                                02620000
009207******************************************************************02630000
009300                                                                  02640000
009400******************************************************************02650000
009500* FD COMBINED CARDHOLDER MASTER LAYOUT - VARIABLE FORMAT (INPUT)  02660017
009600******************************************************************02670000
009700     COPY ARRD079.                                                02680013
009300                                                                  02690020
009900******************************************************************02700000
010000 PROCEDURE DIVISION.                                              02710000
010100******************************************************************02720000
010200*--------------*                                                  02730000
010300 0000-MAINLINE.                                                   02740000
010400*--------------*                                                  02750000
010500                                                                  02760000
010600     PERFORM Z050-INITIALIZE.                                     02770000
010700                                                                  02780000
010800     PERFORM 1000-PROCESS-CARD-MASTER-FILE.                       02790000
010900                                                                  02800000
011000     PERFORM Z100-END-PROC.                                       02810000
011100                                                                  02820000
011200     STOP RUN.                                                    02830000
011300                                                                  02840000
011400*-------------------------------*                                 02850000
011500 1000-PROCESS-CARD-MASTER-FILE.                                   02860000
011600*-------------------------------*                                 02870000
011700     SET PS-CONTINUE-PROCESSING TO TRUE.                          02880000
011800                                                                  02890000
011900     PERFORM 4000-READ-CARD-MASTER.                               02900000
012000                                                                  02910000
012100     PERFORM 2000-PROCESS-CARD-MASTER                             02920000
012200       UNTIL PS-STOP-PROCESSING.                                  02930000
012201                                                                  02940002
012202     PERFORM 5000-WRITE-OUTPUT-FILES.                             02950002
012203                                                                  02960002
012400*-------------------------------*                                 02970000
012500 2000-PROCESS-CARD-MASTER.                                        02980000
012600*-------------------------------*                                 02990000
013900                                                                  03000009
013901     IF IN-MSTR-HEADER                                            03010014
014604        PERFORM 4000-READ-CARD-MASTER                             03020009
014603     ELSE                                                         03030014
014603        IF IN-MSTR-TRAILER                                        03040014
013902           MOVE IN-MASTER-RECORD TO IN-TRAILER-RECORD             03050033
013902           MOVE IN-TRAILER-REC-CNT  TO PV-TRAILER-REC-CNT         03060033
014604           PERFORM 4000-READ-CARD-MASTER                          03070014
014603        ELSE                                                      03080014
013902           MOVE IN-MASTER-RECORD TO AR79-MASTER-DATA              03090032
013903           PERFORM 2100-PROCESS-MASTER-COUNTS                     03100014
013904           PERFORM 5100-WRITE-MSTR-REC                            03110014
013905           PERFORM 4000-READ-CARD-MASTER                          03120014
014605        END-IF                                                    03130014
014605     END-IF.                                                      03140014
014606                                                                  03150009
014607*-------------------------------*                                 03160009
014608 2100-PROCESS-MASTER-COUNTS.                                      03170009
014609*-------------------------------*                                 03180009
014613                                                                  03190009
014614     IF (IN-MSTR-RECORD-01                                        03200007
014615     OR  IN-MSTR-RECORD-02                                        03210007
014616     OR  IN-MSTR-RECORD-03                                        03220007
014617     OR  IN-MSTR-RECORD-04)                                       03230007
014618        ADD +1                      TO PV-BASE-COUNT              03240002
014619     END-IF.                                                      03250002
014620                                                                  03260002
014621     IF (IN-MSTR-RECORD-02                                        03270007
014622     OR  IN-MSTR-RECORD-03                                        03280007
014623     OR  IN-MSTR-RECORD-04)                                       03290007
014624        ADD +1                      TO PV-HIST-COUNT              03300002
014625     END-IF.                                                      03310002
014626                                                                  03320002
014627     IF (IN-MSTR-RECORD-03                                        03330007
014628     OR  IN-MSTR-RECORD-04)                                       03340007
014629        ADD +1                      TO PV-MONETARY-COUNT          03350002
014630     END-IF.                                                      03360002
014631                                                                  03370002
014632     IF (IN-MSTR-RECORD-01                                        03380007
014633     OR  IN-MSTR-RECORD-02                                        03390007
014634     OR  IN-MSTR-RECORD-03                                        03400007
014635     OR  IN-MSTR-RECORD-04)                                       03410007
014636        ADD AR79-NO-CUSTOMER-SEGS   TO PV-CUST-COUNT              03420021
014637     END-IF.                                                      03430002
014638                                                                  03440002
014639     IF (IN-MSTR-RECORD-01                                        03450007
014640     OR  IN-MSTR-RECORD-02                                        03460007
014641     OR  IN-MSTR-RECORD-03                                        03470007
014642     OR  IN-MSTR-RECORD-04)                                       03480007
014643        ADD AR79-NO-BEHAVIOR-SEGS   TO PV-BHVSCR-COUNT            03490021
014644     END-IF.                                                      03500002
014645                                                                  03510002
014646     IF IN-MSTR-RECORD-04                                         03520002
014647        ADD +1                      TO PV-DELSEGS-COUNT           03530002
014648     END-IF.                                                      03540002
014649                                                                  03550002
014650     IF IN-MSTR-RECORD-04                                         03560002
014651        ADD AR79-NO-DEL-ITEMS       TO PV-DELITEMS-COUNT          03570021
014652     END-IF.                                                      03580002
014653                                                                  03590002
014654     IF (IN-MSTR-RECORD-01                                        03600007
014655     OR  IN-MSTR-RECORD-02                                        03610007
014656     OR  IN-MSTR-RECORD-03                                        03620007
014657     OR  IN-MSTR-RECORD-04)                                       03630007
014658        ADD AR79-NO-SLS-SYD-SEGS    TO PV-SLSSYD-COUNT            03640021
014659     END-IF.                                                      03650002
014660                                                                  03660002
014661     IF (IN-MSTR-RECORD-01                                        03670007
014662     OR  IN-MSTR-RECORD-02                                        03680007
014663     OR  IN-MSTR-RECORD-03                                        03690007
014664     OR  IN-MSTR-RECORD-04)                                       03700007
014665        ADD AR79-NO-HRSK-ACS-SEGS   TO PV-HRSKACS-COUNT           03710042
014666     END-IF.                                                      03720002
014667                                                                  03730002
014668     IF (IN-MSTR-RECORD-01                                        03740007
014669     OR  IN-MSTR-RECORD-02                                        03750007
014670     OR  IN-MSTR-RECORD-03                                        03760007
014671     OR  IN-MSTR-RECORD-04)                                       03770007
014672        ADD AR79-NO-NEW-MISC-SEGS   TO PV-MISC1-COUNT             03780021
014673     END-IF.                                                      03790002
014674                                                                  03800002
014675     IF (IN-MSTR-RECORD-01                                        03810007
014676     OR  IN-MSTR-RECORD-02                                        03820007
014677     OR  IN-MSTR-RECORD-03                                        03830007
014678     OR  IN-MSTR-RECORD-04)                                       03840007
014679        ADD AR79-NO-NEW-MISC2-SEGS  TO PV-MISC2-COUNT             03850021
014680     END-IF.                                                      03860002
014681                                                                  03870007
029321*-------------------------------*                                 03880002
029322 4000-READ-CARD-MASTER.                                           03890002
029323*-------------------------------*                                 03900002
029325     READ CARD-MASTER-IN-FILE                                     03910002
029327       AT END                                                     03920024
029328        SET PS-STOP-PROCESSING TO TRUE                            03930010
029329     END-READ.                                                    03940002
029330                                                                  03950002
029331     IF NOT PS-STOP-PROCESSING                                    03960002
029332        ADD 1 TO PV-READ-COUNT                                    03970002
029333     END-IF.                                                      03980002
029334                                                                  03990002
029335*-------------------------------*                                 04000002
029336 5000-WRITE-OUTPUT-FILES.                                         04010002
029337*-------------------------------*                                 04020002
029338     PERFORM 5200-WRITE-BASE-REC.                                 04030002
029339     PERFORM 5300-WRITE-HIST-REC.                                 04040002
029340     PERFORM 5400-WRITE-MONETARY-REC.                             04050002
029341     PERFORM 5500-WRITE-CUST-REC.                                 04060002
029342     PERFORM 5600-WRITE-BHVSCR-REC.                               04070002
029343     PERFORM 5700-WRITE-DELSEGS-REC.                              04080005
029344     PERFORM 5800-WRITE-DELITEMS-REC.                             04090002
029345     PERFORM 5900-WRITE-SLSSYD-REC.                               04100002
029346     PERFORM 6000-WRITE-HRSKACS-REC.                              04110002
029347     PERFORM 6100-WRITE-MISC1-REC.                                04120002
029348     PERFORM 6200-WRITE-MISC2-REC.                                04130002
029349                                                                  04140002
029350*-------------------------------*                                 04150000
029351 5100-WRITE-MSTR-REC.                                             04160002
029352*-------------------------------*                                 04170000
029337                                                                  04180020
029350     MOVE IN-REC-LENGTH TO OUT-REC-LENGTH.                        04190031
029351                                                                  04200031
029352     EVALUATE TRUE                                                04210031
029337         WHEN IN-MSTR-RECORD-01                                   04220031
029350             MOVE IN-MSTR-REC (1:IN-REC-LENGTH)                   04230031
029351               TO OUT-MSTR-REC                                    04240031
029352             WRITE OUT-MSTR-REC                                   04250031
029337                                                                  04260020
029338         WHEN IN-MSTR-RECORD-02                                   04270020
029350             MOVE IN-MSTR-REC (1:IN-REC-LENGTH)                   04280031
029351               TO OUT-MSTR-REC                                    04290031
029352             WRITE OUT-MSTR-REC                                   04300031
029337                                                                  04310031
029339         WHEN IN-MSTR-RECORD-03                                   04320020
029350             MOVE IN-MSTR-REC (1:IN-REC-LENGTH)                   04330031
029351               TO OUT-MSTR-REC                                    04340031
029352             WRITE OUT-MSTR-REC                                   04350031
029337                                                                  04360031
029344         WHEN IN-MSTR-RECORD-04                                   04370020
029350             MOVE IN-MSTR-REC (1:IN-REC-LENGTH)                   04380031
029351               TO OUT-MSTR-REC                                    04390031
029352             WRITE OUT-MSTR-REC                                   04400031
029337                                                                  04410031
029349         WHEN IN-FLAP-RECORD                                      04420020
029350             MOVE IN-FLAP-REC (1:IN-REC-LENGTH)                   04430031
029351               TO OUT-FLAP-REC                                    04440031
029352             WRITE OUT-FLAP-REC                                   04450031
029337                                                                  04460031
029341         WHEN IN-BFLP-RECORD                                      04470020
029350             MOVE IN-BFLP-REC (1:IN-REC-LENGTH)                   04480031
029351               TO OUT-BFLP-REC                                    04490031
029342             WRITE OUT-BFLP-REC                                   04500028
029345                                                                  04510020
029346         WHEN IN-MTHO-RECORD                                      04520020
029352             MOVE IN-MTHO-REC (1:IN-REC-LENGTH)                   04530031
029337               TO OUT-MTHO-REC                                    04540031
029347             WRITE OUT-MTHO-REC                                   04550020
029337                                                                  04560020
029338         WHEN IN-CHKP-RECORD                                      04570020
029350             MOVE IN-CHKP-REC (1:IN-REC-LENGTH)                   04580031
029351               TO OUT-CHKP-REC                                    04590031
029352             WRITE OUT-CHKP-REC                                   04600031
029337                                                                  04610020
029338         WHEN IN-CIT-RECORD                                       04620020
029350             MOVE IN-CIT-REC (1:IN-REC-LENGTH)                    04630031
029351               TO OUT-CIT-REC                                     04640031
029352             WRITE OUT-CIT-REC                                    04650031
029337                                                                  04660020
029338         WHEN IN-DSPT-RECORD                                      04670020
029350             MOVE IN-DSPT-REC (1:IN-REC-LENGTH)                   04680031
029351               TO OUT-DSPT-REC                                    04690031
029339             WRITE OUT-DSPT-REC                                   04700020
029342                                                                  04710020
029347                                                                  04720020
029348     END-EVALUATE.                                                04730020
029349                                                                  04740020
029375                                                                  04750015
029376     ADD 1                                                        04760008
029377        TO PV-CRDMAST-COUNT.                                      04770008
029378                                                                  04780000
029379*-------------------------------*                                 04790000
029380 5200-WRITE-BASE-REC.                                             04800002
029381*-------------------------------*                                 04810000
029382     MOVE PV-BASE-COUNT                                           04820002
029383       TO OUT-TOTAL-RECORD-COUNT                                  04830002
029384     WRITE TOTAL-NBR-BASE-SGMTS-REC                               04840002
029385        FROM OUT-TOTAL-RECORD.                                    04850002
029386                                                                  04860000
029387*-------------------------------*                                 04870000
029388 5300-WRITE-HIST-REC.                                             04880002
029389*-------------------------------*                                 04890000
029390     MOVE PV-HIST-COUNT                                           04900002
029391       TO OUT-TOTAL-RECORD-COUNT                                  04910002
029392     WRITE TOTAL-NBR-HIST-SGMTS-REC                               04920002
029393        FROM OUT-TOTAL-RECORD.                                    04930002
029394                                                                  04940000
029395*-------------------------------*                                 04950000
029396 5400-WRITE-MONETARY-REC.                                         04960002
029397*-------------------------------*                                 04970000
029398     MOVE PV-MONETARY-COUNT                                       04980002
029399       TO OUT-TOTAL-RECORD-COUNT                                  04990002
029400     WRITE TOTAL-NBR-MONETARY-SGMTS-REC                           05000002
029401        FROM OUT-TOTAL-RECORD.                                    05010002
029402                                                                  05020002
029403*-------------------------------*                                 05030000
029404 5500-WRITE-CUST-REC.                                             05040002
029405*-------------------------------*                                 05050000
029406     MOVE PV-CUST-COUNT                                           05060002
029407       TO OUT-TOTAL-RECORD-COUNT                                  05070002
029408     WRITE TOTAL-NBR-CUST-SGMTS-REC                               05080002
029409        FROM OUT-TOTAL-RECORD.                                    05090002
029410                                                                  05100000
029411*-------------------------------*                                 05110000
029412 5600-WRITE-BHVSCR-REC.                                           05120002
029413*-------------------------------*                                 05130000
029414     MOVE PV-BHVSCR-COUNT                                         05140002
029415       TO OUT-TOTAL-RECORD-COUNT                                  05150002
029416     WRITE TOTAL-NBR-BHVSCR-SGMTS-REC                             05160002
029417        FROM OUT-TOTAL-RECORD.                                    05170002
029418                                                                  05180000
029419*-------------------------------*                                 05190000
029420 5700-WRITE-DELSEGS-REC.                                          05200004
029421*-------------------------------*                                 05210000
029422     MOVE PV-DELSEGS-COUNT                                        05220004
029423       TO OUT-TOTAL-RECORD-COUNT                                  05230002
029424     WRITE TOTAL-NBR-DELSEGS-SGMTS-REC                            05240004
029425        FROM OUT-TOTAL-RECORD.                                    05250002
029426                                                                  05260000
029427*-------------------------------*                                 05270000
029428 5800-WRITE-DELITEMS-REC.                                         05280002
029429*-------------------------------*                                 05290000
029430     MOVE PV-DELITEMS-COUNT                                       05300002
029431       TO OUT-TOTAL-RECORD-COUNT                                  05310002
029432     WRITE TOTAL-NBR-DELITEMS-SGMTS-REC                           05320002
029433        FROM OUT-TOTAL-RECORD.                                    05330002
029434                                                                  05340000
029435*-------------------------------*                                 05350002
029436 5900-WRITE-SLSSYD-REC.                                           05360002
029437*-------------------------------*                                 05370002
029438     MOVE PV-SLSSYD-COUNT                                         05380002
029439       TO OUT-TOTAL-RECORD-COUNT                                  05390002
029440     WRITE TOTAL-NBR-SLSSYD-SGMTS-REC                             05400002
029441        FROM OUT-TOTAL-RECORD.                                    05410002
029442                                                                  05420002
029443*-------------------------------*                                 05430002
029444 6000-WRITE-HRSKACS-REC.                                          05440002
029445*-------------------------------*                                 05450002
029446     MOVE PV-HRSKACS-COUNT                                        05460002
029447       TO OUT-TOTAL-RECORD-COUNT                                  05470002
029448     WRITE TOTAL-NBR-HRSKACS-SGMTS-REC                            05480002
029449        FROM OUT-TOTAL-RECORD.                                    05490002
029450                                                                  05500002
029451*-------------------------------*                                 05510002
029452 6100-WRITE-MISC1-REC.                                            05520002
029453*-------------------------------*                                 05530002
029454     MOVE PV-MISC1-COUNT                                          05540002
029455       TO OUT-TOTAL-RECORD-COUNT                                  05550002
029456     WRITE TOTAL-NBR-MISC1-SGMTS-REC                              05560002
029457        FROM OUT-TOTAL-RECORD.                                    05570002
029458                                                                  05580002
029459*-------------------------------*                                 05590002
029460 6200-WRITE-MISC2-REC.                                            05600002
029461*-------------------------------*                                 05610002
029462     MOVE PV-MISC2-COUNT                                          05620002
029463       TO OUT-TOTAL-RECORD-COUNT                                  05630002
029464     WRITE TOTAL-NBR-MISC2-SGMTS-REC                              05640002
029465        FROM OUT-TOTAL-RECORD.                                    05650002
029466                                                                  05660002
029467******************************************************************05670000
029468* Z050 - INITIALIZE                                               05680000
029469******************************************************************05690000
029470 Z050-INITIALIZE.                                                 05700000
029471                                                                  05710000
029472     OPEN INPUT  CARD-MASTER-IN-FILE.                             05720000
029473     OPEN OUTPUT CARD-MASTER-OUT-FILE                             05730000
029474                 TOTAL-NBR-BASE-SGMTS-FILE                        05740002
029475                 TOTAL-NBR-HIST-SGMTS-FILE                        05750002
029476                 TOTAL-NBR-MONETARY-SGMTS-FILE                    05760002
029477                 TOTAL-NBR-CUST-SGMTS-FILE                        05770002
029478                 TOTAL-NBR-BHVSCR-SGMTS-FILE                      05780002
029479                 TOTAL-NBR-DELSEGS-SGMTS-FILE                     05790002
029480                 TOTAL-NBR-DELITEMS-SGMTS-FILE                    05800002
029481                 TOTAL-NBR-SLSSYD-SGMTS-FILE                      05810002
029482                 TOTAL-NBR-HRSKACS-SGMTS-FILE                     05820002
029483                 TOTAL-NBR-MISC1-SGMTS-FILE                       05830002
029484                 TOTAL-NBR-MISC2-SGMTS-FILE.                      05840002
029485                                                                  05850000
029486******************************************************************05860000
029487* Z100 - PREFORMS TASK TERMINATION PROCESSING                     05870000
029488******************************************************************05880000
029489 Z100-END-PROC.                                                   05890000
029490     DISPLAY ' '.                                                 05900000
029491     DISPLAY '**********************'.                            05910000
029492     DISPLAY '   ARKUT082 CONTROLS  '.                            05920002
029493     DISPLAY '**********************'.                            05930000
029494     DISPLAY ' '.                                                 05940000
029495     DISPLAY 'RECORDS READ   : ' PV-READ-COUNT.                   05950000
029496     DISPLAY 'MSTR REC WRITES: ' PV-CRDMAST-COUNT.                05960002
029497     DISPLAY 'BASE REC WRITES: ' PV-BASE-COUNT.                   05970002
029498     DISPLAY 'HIST REC WRITES: ' PV-HIST-COUNT.                   05980002
029499     DISPLAY 'MONETARY REC WRITES: ' PV-MONETARY-COUNT.           05990002
029500     DISPLAY 'CUST REC WRITES: ' PV-CUST-COUNT.                   06000002
029501     DISPLAY 'BHVSCR REC WRITES: ' PV-BHVSCR-COUNT.               06010002
029502     DISPLAY 'DELSEGS REC WRITES: ' PV-DELSEGS-COUNT.             06020002
029503     DISPLAY 'DELITEMS REC WRITES: ' PV-DELITEMS-COUNT.           06030002
029504     DISPLAY 'SLSSYD REC WRITES: ' PV-SLSSYD-COUNT.               06040003
029505     DISPLAY 'HRSKACS REC WRITES: ' PV-HRSKACS-COUNT.             06050002
029506     DISPLAY 'MISC1 REC WRITES: ' PV-MISC1-COUNT.                 06060002
029507     DISPLAY 'MISC2 REC WRITES: ' PV-MISC2-COUNT.                 06070002
029508                                                                  06080034
029508     IF PV-READ-COUNT = 0                                         06090000
029509        DISPLAY ' '                                               06100000
029510        DISPLAY '*** NO CARD MASTER RECORDS TO REFORMAT ***'      06110000
029511     END-IF.                                                      06120000
029508                                                                  06130034
029508     IF PV-TRAILER-REC-CNT NOT EQUAL PV-CRDMAST-COUNT             06140038
029509        DISPLAY ' '                                               06150034
029510        DISPLAY '*** WARNING WARNING WARNING WARNING ***'         06160034
029510        DISPLAY '***************************************'         06170034
029510        DISPLAY '***** CARD MASTER TRAILER COUNT *******'         06180034
029510        DISPLAY '****** DOES NOT MATCH PROGRAM  ********'         06190034
029510        DISPLAY '*********  RECORD READ COUNT  *********'         06200034
029510        DISPLAY '**** WE MAY NOT HAVE RECEIVED *********'         06210036
029510        DISPLAY '******* ALL RECS FROM FDR !!! *********'         06220034
029510        DISPLAY '***************************************'         06230034
029509        DISPLAY ' '                                               06240035
029509        DISPLAY 'FD TRAILER COUNT = ' PV-TRAILER-REC-CNT          06250039
029509        DISPLAY ' ARKUT082  COUNT = ' PV-CRDMAST-COUNT            06260039
029509        DISPLAY ' '                                               06270039
029509        MOVE 0004 TO RETURN-CODE                                  06280039
029511     END-IF.                                                      06290034
029512                                                                  06300000
029513     CLOSE CARD-MASTER-IN-FILE                                    06310000
029514           CARD-MASTER-OUT-FILE                                   06320000
029515           TOTAL-NBR-BASE-SGMTS-FILE                              06330002
029516           TOTAL-NBR-HIST-SGMTS-FILE                              06340002
029517           TOTAL-NBR-MONETARY-SGMTS-FILE                          06350002
029518           TOTAL-NBR-CUST-SGMTS-FILE                              06360002
029519           TOTAL-NBR-BHVSCR-SGMTS-FILE                            06370002
029520           TOTAL-NBR-DELSEGS-SGMTS-FILE                           06380002
029521           TOTAL-NBR-DELITEMS-SGMTS-FILE                          06390002
029522           TOTAL-NBR-SLSSYD-SGMTS-FILE                            06400002
029523           TOTAL-NBR-HRSKACS-SGMTS-FILE                           06410002
029524           TOTAL-NBR-MISC1-SGMTS-FILE                             06420002
029525           TOTAL-NBR-MISC2-SGMTS-FILE.                            06430002
029526                                                                  06440002
029534******************************************************************06450000
