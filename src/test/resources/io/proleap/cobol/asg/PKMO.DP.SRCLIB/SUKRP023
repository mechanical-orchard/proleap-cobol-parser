000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.   SUKRP023.                                          00040000
000500 AUTHOR.       JOE LAROSA.                                        00050000
000600 INSTALLATION. KOHLS DEPARTMENT STORES.                           00060000
000700 DATE-WRITTEN  JULY, 2000.                                        00070000
000800 DATE-COMPILED.                                                   00080000
000900***************************************************************** 00090000
001000*  THIS PROGRAM WILL PRINT THE UCC-128 PO/LINE UNUSED LABEL     * 00100000
001100*  REPORT.  ASSOCIATED EXTRACT PROGRAM IS SUKUT037.             * 00110000
001200*---------------------------------------------------------------- 00120031
001201* 03/01 - DEANNA BRANTNER - ADDED PREPK-IND INORDER TO DIPLAY     00121031
001202*         PREPACK INFORMATION.                                    00121131
001203***************************************************************** 00122031
001201* 09/30/14 - CHERI PARMLEY - PO EXPANSION FROM 7 TO 8 DIGITS      00123036
001200*---------------------------------------------------------------- 00124036
001300 ENVIRONMENT DIVISION.                                            00130000
001400***************************************************************** 00140000
001500 CONFIGURATION SECTION.                                           00150000
001600                                                                  00160000
001700 SOURCE-COMPUTER.        IBM-3090.                                00170000
001800 OBJECT-COMPUTER.        IBM-3090.                                00180000
001900                                                                  00190000
002000 INPUT-OUTPUT SECTION.                                            00200000
002100 FILE-CONTROL.                                                    00210000
002200                                                                  00220000
002300     SELECT EXTRACT-FILE  ASSIGN TO INP01.                        00230000
002400                                                                  00240000
002500     SELECT REPORT-FILE   ASSIGN TO RPT01.                        00250000
002600                                                                  00260000
002700***************************************************************** 00270000
002800 DATA DIVISION.                                                   00280000
002900***************************************************************** 00290000
003000 FILE SECTION.                                                    00300000
003100                                                                  00310000
003200 FD  EXTRACT-FILE                                                 00320000
003300     LABEL RECORDS ARE STANDARD                                   00330000
003400     RECORDING MODE IS F                                          00340000
003500     BLOCK CONTAINS 0 RECORDS                                     00350000
003600     RECORD CONTAINS 200 CHARACTERS.                              00360000
003700 01  EXTRACT-RECORD                  PIC X(200).                  00370000
003800                                                                  00380000
003900 FD  REPORT-FILE                                                  00390000
004000     RECORDING MODE IS F                                          00400000
004100     BLOCK CONTAINS 0  RECORDS.                                   00410000
004200 01  REPORT-RECORD                   PIC X(132).                  00420000
004300                                                                  00430000
004400**************************************************************    00440000
004500 WORKING-STORAGE SECTION.                                         00450000
004600                                                                  00460000
004700 01  PROGRAM-SWITCHES.                                            00470000
004800     05  PS-END-OF-EXTRACT-SW        PIC X(01) VALUE 'N'.         00480004
004900         88  PS-END-OF-EXTRACT                 VALUE 'Y'.         00490004
005000     05  PS-STATUS-FOUND-SW          PIC X(01) VALUE 'N'.         00500004
005100         88  PS-STATUS-FOUND                   VALUE 'Y'.         00510004
005200         88  PS-STATUS-NOT-FOUND               VALUE 'N'.         00520004
005300     05  PS-DETAIL-REC-WRITTEN-SW    PIC X(01) VALUE 'N'.         00530004
005400         88  PS-DETAIL-REC-WRITTEN             VALUE 'Y'.         00540004
005500         88  PS-NO-DETAIL-REC-WRITTEN          VALUE 'N'.         00550004
005600     05  PS-EOF-UID-CURSOR-IND       PIC X(01) VALUE 'N'.         00560004
005700         88  PS-EOF-UID-CURSOR                 VALUE 'Y'.         00570004
005800         88  PS-NOT-EOF-UID-CURSOR             VALUE 'N'.         00580004
005900     05  PS-RECORD-TYPE-SW           PIC X(01) VALUE 'B'.         00590004
006000         88  PS-ERROR-RECORD                   VALUE 'A'.         00600004
006100         88  PS-DETAIL-RECORD                  VALUE 'B'.         00610004
006200     05  PS-PO-WRITTEN-SW            PIC X(01) VALUE 'N'.         00620008
006300         88  PS-PO-WRITTEN-NO                  VALUE 'N'.         00630008
006400         88  PS-PO-WRITTEN-YES                 VALUE 'Y'.         00640008
006500                                                                  00650004
006600 01  PC-CONSTANTS.                                                00660000
006700     05  PC-SUKRP023                 PIC X(08) VALUE 'SUKRP023'.  00670004
006800     05  PC-REPORT-NBR               PIC 9(01) VALUE 1.           00680004
006900     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +64 COMP-3.  00690002
007000     05  PC-NINE-9-9                 PIC S9(9) COMP               00700004
007100                                               VALUE +999999999.  00710004
007200     05  PC-00                       PIC X(02) VALUE '00'.        00720004
007300     05  PC-UG                       PIC X(02) VALUE 'UG'.        00730004
007400     05  PC-UN                       PIC X(02) VALUE 'UN'.        00740004
007500     05  PC-AR                       PIC X(02) VALUE 'AR'.        00750004
007600                                                                  00760004
007700 01  DK-DATABASE-KEYS.                                            00770005
007800     05  DK-PO                       PIC S9(9) VALUE +0 COMP.     00780005
007900     05  DK-RECEIVER                 PIC S9(9) VALUE +0 COMP.     00790005
008000     05  DK-PO-LINE                  PIC S9(9) VALUE +0 COMP.     00800005
008100                                                                  00810005
008200 01  DN-DB2-NULL-INDICATORS.                                      00820000
008300     05  DN-VEH-NBR                  PIC S9(4) COMP VALUE +0.     00830004
008400                                                                  00840004
008500 01  PV-MISC-FIELDS.                                              00850000
008600     05  PV-RECORD-COUNT             PIC 9(07) VALUE ZEROES.      00860008
008700     05  PV-LINE-COUNT               PIC S9(3) VALUE +0 COMP-3.   00870002
008800     05  PV-PAGE-COUNT               PIC S9(4) VALUE +0 COMP-3.   00880002
008900     05  PV-SAVE-PO                  PIC S9(9) VALUE +0 COMP.     00890003
009000     05  PV-SAVE-RECEIVER            PIC S9(9) VALUE +0 COMP.     00900003
009100     05  PV-SAVE-PO-LINE             PIC S9(9) VALUE +0 COMP.     00910003
009200     05  PV-PO-RECEIVER.                                          00920003
      *CLP 09/30/14                                                     00921035
009300         10  PV-PO                   PIC  9(8) VALUE ZEROES.      00930035
009400         10  FILLER                  PIC  X(1) VALUE '-'.         00940003
009500         10  PV-RECEIVER             PIC  9(3) VALUE ZEROES.      00950003
009600     05  PV-PO-LINE                  PIC  9(4) VALUE ZEROES.      00960003
009700     05  PV-ACCUM-N-LABELS           PIC S9(7) VALUE ZEROES.      00970003
009800     05  PV-ACCUM-Y-LABELS           PIC S9(7) VALUE ZEROES.      00980003
009900     05  PV-LBL-SML-N                PIC S9(7) VALUE ZEROES.      00990003
010000     05  PV-LBL-P2L-N                PIC S9(7) VALUE ZEROES.      01000003
010100     05  PV-LBL-CS-N                 PIC S9(7) VALUE ZEROES.      01010003
010200     05  PV-LBL-SML-Y                PIC S9(7) VALUE ZEROES.      01020003
010300     05  PV-LBL-P2L-Y                PIC S9(7) VALUE ZEROES.      01030003
010400     05  PV-LBL-CS-Y                 PIC S9(7) VALUE ZEROES.      01040003
010500     05  PV-DISPLAY-LABEL            PIC ZZZ9.                    01050003
010600     05  PV-DISPLAY-LABEL-TOT        PIC ZZZZ9.                   01060003
010700     05  PV-DISPLAY-RECORDS-IN       PIC ZZZ,ZZ9.                 01070008
010800                                                                  01080004
010900     05  PV-DB2-OPERATION-ATTEMPTED  PIC X(30) VALUE SPACE.       01090004
011000     05  PV-ABEND-PARAGRAPH          PIC X(30) VALUE SPACES.      01100004
011100     05  PV-ABEND-CODE               PIC S9(4) VALUE ZEROES       01110004
011200                                               COMP SYNC.         01120004
011300                                                                  01130004
011400     05  PV-DB2-COUNT                PIC S9(4) VALUE ZEROES       01140004
011500                                               COMP SYNC.         01150004
011600     05  PV-STATUS                   PIC X(02).                   01160004
011700     05  PV-TRIP-ID                  PIC 9(09).                   01170004
011800     05  PV-HOLD-UID                 PIC X(07) VALUE SPACES.      01180004
011900     05  PV-TODAYS-DATE.                                          01190000
012000         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        01200004
012100         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        01210004
012200         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        01220004
012300     05  PV-TODAYS-TIME.                                          01230000
012400         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        01240004
012500         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        01250004
012600         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        01260004
012700         10  FILLER                  PIC 9(02) VALUE ZERO.        01270004
012800     05  PV-DB2-DATE.                                             01280000
012900         10  PV-DB2-DATE-CC          PIC X(02) VALUE ZERO.        01290004
013000         10  PV-DB2-DATE-YY          PIC X(02) VALUE ZERO.        01300004
013100         10  FILLER                  PIC X(01) VALUE ZERO.        01310004
013200         10  PV-DB2-DATE-MM          PIC X(02) VALUE ZERO.        01320004
013300         10  FILLER                  PIC X(01) VALUE ZERO.        01330004
013400         10  PV-DB2-DATE-DD          PIC X(02) VALUE ZERO.        01340004
013500                                                                  01350000
013600     COPY DPWS024.                                                01360035
013700                                                                  01370000
013800******************************************************************01380000
013900* INPUT FILE COPYBOOK                                            *01390012
014000******************************************************************01400000
014100     COPY SURD010.                                                01410012
014200                                                                  01420012
014300******************************************************************01430012
014400* FORMAT OF THE CONTROL CARD INFORMATION PASSED INTO THE PROGRAM *01440012
014500******************************************************************01450012
014600 01  CC-CONTROL-CARD.                                             01460012
014700     05  CC-PRINTER-ID                PIC  X(08).                 01470012
014800     05  CC-PRTR-CNTL-IND             PIC  X(01).                 01480012
014900     05  CC-TRACK-NBR                 PIC  9(01).                 01490012
015000     05  FILLER                       PIC  X(01).                 01500012
015100     05  CC-CUT-REPORT                PIC  X(01).                 01510012
015200         88 CC-CUT-REPORT-AT-END                   VALUE 'C'.     01520012
015300     05  CC-REQUESTOR-ID              PIC  X(08).                 01530012
015400     05  CC-PRINT-SUKRP002-IND        PIC  X(01).                 01540012
015500         88 CC-PRINT-SUKRP002                      VALUE 'Y'.     01550012
015600     05  CC-PRINT-SUKRP003-IND        PIC  X(01).                 01560012
015700         88 CC-PRINT-SUKRP003                      VALUE 'Y'.     01570012
015800     05  CC-PRINT-SUKRP004-IND        PIC  X(01).                 01580012
015900         88 CC-PRINT-SUKRP004                      VALUE 'Y'.     01590012
016000     05  CC-PRINT-SUKRP005-IND        PIC  X(01).                 01600012
016100         88 CC-PRINT-SUKRP005                      VALUE 'Y'.     01610012
016200     05  CC-PRINT-SUKRP006-IND        PIC  X(01).                 01620012
016300         88 CC-PRINT-SUKRP006                      VALUE 'Y'.     01630012
016400     05  CC-PRINT-SUKRP007-IND        PIC  X(01).                 01640012
016500         88 CC-PRINT-SUKRP007                      VALUE 'Y'.     01650012
016600     05  CC-PRINT-SUKRP008-IND        PIC  X(01).                 01660012
016700         88 CC-PRINT-SUKRP008                      VALUE 'Y'.     01670012
016800     05  CC-PRINT-SUKRP023-IND        PIC  X(01).                 01680012
016900         88 CC-PRINT-SUKRP023                      VALUE 'Y'.     01690012
016901     05  FILLER                       PIC  X(01).                 01690124
016902     05  CC-PRINT-ALL-PO-IND          PIC  X(01).                 01690224
016903         88 CC-PRINT-ENTIRE-TRIP                   VALUE 'Y'.     01690324
016910         88 CC-PRINT-SELECTED-PO                   VALUE 'N'.     01691024
017000                                                                  01700012
017100******************************************************************01710000
017200*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01720000
017300******************************************************************01730000
017400     COPY DPWS132O.                                               01740013
017500                                                                  01750000
017600 01  HEADING-LINES.                                               01760000
017700     05  HEADING-LINE-1.                                          01770000
017801         10  FILLER                  PIC  X(05)    VALUE SPACES.  01780124
017802         10  FILLER                  PIC  X(40)    VALUE          01780225
017803             '****************************************'.          01780325
017810         10  FILLER                  PIC  X(02)    VALUE SPACES.  01781025
017900         10  FILLER                  PIC  X(38) VALUE             01790006
018000             ' UCC-128 PO/LINE UNUSED VIRTUAL LABELS'.            01800008
018100         10  FILLER                  PIC  X(47) VALUE SPACES.     01810006
018101*                                                                 01810124
018102     05  HEADING-LINE-1A.                                         01810224
018103         10  FILLER                  PIC  X(05)    VALUE SPACES.  01810324
018104         10  FILLER                  PIC  X(03)    VALUE '*  '.   01810424
018105         10  HL1A-CC-IND-DESC        PIC  X(36)    VALUE SPACES.  01810525
018106         10  FILLER                  PIC  X(01)    VALUE '*'.     01810624
018107         10  FILLER                  PIC  X(87)    VALUE SPACES.  01810725
018108*                                                                 01810824
018109     05  HEADING-LINE-1B.                                         01810924
018110         10  FILLER                  PIC  X(05)    VALUE SPACES.  01811024
018111         10  FILLER                  PIC  X(40)    VALUE          01811125
018112             '****************************************'.          01811225
018120         10  FILLER                  PIC  X(87)    VALUE SPACES.  01812025
018200*                                                                 01820024
018300     05  HEADING-LINE-2.                                          01830000
018400         10  FILLER                  PIC  X(03) VALUE SPACE.      01840000
018500         10  FILLER                  PIC  X(09) VALUE             01850000
018600                                                 'CARRIER: '.     01860000
018700         10  HL2-SCAC                PIC  X(04) VALUE SPACES.     01870000
018800         10  FILLER                  PIC  X(03) VALUE SPACE.      01880000
018900         10  FILLER                  PIC  X(09) VALUE             01890000
019000                                                 'TRAILER: '.     01900000
019100         10  HL2-TRAILER             PIC  X(10) VALUE SPACES.     01910000
019200         10  FILLER                  PIC  X(04) VALUE SPACE.      01920000
019300         10  FILLER                  PIC  X(09) VALUE             01930000
019400                                                 'TRIP ID: '.     01940000
019500         10  HL2-TRIP-ID             PIC  X(11) VALUE SPACES.     01950000
019600         10  FILLER                  PIC  X(14) VALUE SPACE.      01960000
019700         10  FILLER                  PIC  X(16) VALUE             01970000
019800                                          'TRAILER STATUS: '.     01980000
019900         10  HL2-TRAILER-STAT        PIC  X(02) VALUE SPACES.     01990000
020000         10  FILLER                  PIC  X(38) VALUE SPACES.     02000000
020100                                                                  02010000
020200     05  HEADING-LINE-3.                                          02020000
020300         10  FILLER                  PIC  X(03) VALUE SPACES.     02030000
020400         10  FILLER                  PIC  X(16) VALUE             02040000
020500                                          'ARRIVAL DATE:   '.     02050000
020600         10  HL3-ARRIVAL-DATE.                                    02060000
020700             15  HL3-ARRIVAL-DATE-MM                              02070000
020800                                     PIC  X(02) VALUE SPACES.     02080000
020900             15  FILLER              PIC  X(01) VALUE '/'.        02090000
021000             15  HL3-ARRIVAL-DATE-DD                              02100000
021100                                     PIC  X(02) VALUE SPACES.     02110000
021200             15  FILLER              PIC  X(01) VALUE '/'.        02120000
021300             15  HL3-ARRIVAL-DATE-CC                              02130000
021400                                     PIC  X(02) VALUE SPACES.     02140000
021500             15  HL3-ARRIVAL-DATE-YY                              02150000
021600                                     PIC  X(02) VALUE SPACES.     02160000
021700         10  FILLER                  PIC  X(11) VALUE SPACES.     02170000
021800         10  FILLER                  PIC  X(23) VALUE             02180000
021900                                   'BEGIN UNLOADING DATE:  '.     02190000
022000         10  HL3-BEG-UNLOAD-DATE.                                 02200000
022100             15  HL3-BEG-UNLOAD-DATE-MM                           02210000
022200                                     PIC  X(02) VALUE SPACES.     02220000
022300             15  FILLER              PIC  X(01) VALUE '/'.        02230000
022400             15  HL3-BEG-UNLOAD-DATE-DD                           02240000
022500                                     PIC  X(02) VALUE SPACES.     02250000
022600             15  FILLER              PIC  X(01) VALUE '/'.        02260000
022700             15  HL3-BEG-UNLOAD-DATE-CC                           02270000
022800                                     PIC  X(02) VALUE SPACES.     02280000
022900             15  HL3-BEG-UNLOAD-DATE-YY                           02290000
023000                                     PIC  X(02) VALUE SPACES.     02300000
023100         10  FILLER                  PIC  X(03) VALUE SPACES.     02310000
023200         10  FILLER                  PIC  X(15) VALUE             02320000
023300                                           'UNLOADED DATE: '.     02330000
023400         10  HL3-UNLOADED-DATE.                                   02340000
023500             15  HL3-UNLOADED-DATE-MM                             02350000
023600                                     PIC  X(02) VALUE SPACES.     02360000
023700             15  FILLER              PIC  X(01) VALUE '/'.        02370000
023800             15  HL3-UNLOADED-DATE-DD                             02380000
023900                                     PIC  X(02) VALUE SPACES.     02390000
024000             15  FILLER              PIC  X(01) VALUE '/'.        02400000
024100             15  HL3-UNLOADED-DATE-CC                             02410000
024200                                     PIC  X(02) VALUE SPACES.     02420000
024300             15  HL3-UNLOADED-DATE-YY                             02430000
024400                                     PIC  X(02) VALUE SPACES.     02440000
024500         10  FILLER                  PIC  X(31) VALUE SPACES.     02450000
024600                                                                  02460000
024700     05  HEADING-LINE-3B.                                         02470000
024800          10  FILLER                 PIC  X(03) VALUE SPACES.     02480000
024900          10  FILLER                 PIC  X(22) VALUE             02490000
025000                                    'RECEIVING ASSOCIATES: '.     02500000
025100          10  HL3B-USERID-TABLE.                                  02510000
025200              15 FILLER  OCCURS 12 TIMES                          02520000
025300                         INDEXED BY HL3B-UID-IDX.                 02530000
025400                 20 HL3B-USER-ID     PIC  X(07) VALUE SPACES.     02540000
025500                 20 HL3B-COMMA       PIC  X(01) VALUE SPACES.     02550000
025600                 20 FILLER           PIC  X(01) VALUE SPACES.     02560000
025700                                                                  02570001
025800     05  HEADING-LINE-4.                                          02580000
025900         10  FILLER                  PIC  X(45) VALUE SPACES.     02590000
026000         10  FILLER                  PIC  X(39) VALUE             02600000
026100             '* * * * * *  U N U S E D  * * * * * * *'.           02610000
026200         10  FILLER                  PIC  X(08) VALUE SPACES.     02620000
026300         10  FILLER                  PIC  X(39) VALUE             02630000
026400             '* * * * * * * *  U S E D  * * * * * * *'.           02640000
026500         10  FILLER                  PIC  X(01) VALUE SPACES.     02650000
026600                                                                  02660001
026700     05  HEADING-LINE-5.                                          02670000
026800         10  FILLER                  PIC  X(14) VALUE SPACES.     02680003
026900         10  FILLER                  PIC  X(05) VALUE SPACES.     02690003
027000         10  FILLER                  PIC  X(10) VALUE             02700003
027100                                               'EXCEPTION '.      02710003
027200         10  FILLER                  PIC  X(05) VALUE SPACES.     02720003
027300         10  FILLER                  PIC  X(04) VALUE 'LINE'.     02730000
027400         10  FILLER                  PIC  X(07) VALUE SPACES.     02740003
027500         10  FILLER                  PIC  X(39) VALUE             02750000
027600             'TOTAL NBR    SML     P2L      CNTRL STK'.           02760000
027700         10  FILLER                  PIC  X(08) VALUE SPACES.     02770007
027800         10  FILLER                  PIC  X(39) VALUE             02780003
027900             'TOTAL NBR    SML     P2L      CNTRL STK'.           02790000
028000                                                                  02800001
028100     05  HEADING-LINE-6.                                          02810000
028200         10  FILLER                  PIC  X(03) VALUE SPACES.     02820000
028300         10  FILLER                  PIC  X(11) VALUE             02830000
028400                                               'PO/RECEIVER'.     02840000
028500         10  FILLER                  PIC  X(05) VALUE SPACES.     02850003
028600         10  FILLER                  PIC  X(10) VALUE             02860003
028700                                               'TYPE      '.      02870003
028800         10  FILLER                  PIC  X(05) VALUE SPACES.     02880003
028900         10  FILLER                  PIC  X(04) VALUE 'NBR '.     02890000
029000         10  FILLER                  PIC  X(07) VALUE SPACES.     02900003
029100         10  FILLER                  PIC  X(39) VALUE             02910000
029200             'LABELS       LABELS  LABELS   LABELS   '.           02920000
029300         10  FILLER                  PIC  X(08) VALUE SPACES.     02930007
029400         10  FILLER                  PIC  X(39) VALUE             02940003
029500             'LABELS       LABELS  LABELS   LABELS   '.           02950000
029600                                                                  02960000
029700 01  DETAIL-LINES.                                                02970010
029800     05  DETAIL-LINE1.                                            02980010
029900         10  FILLER                  PIC  X(03) VALUE SPACES.     02990010
      *CLP 09/30/14                                                     02991035
030000         10  DL1-PO-RECEIVER         PIC  X(12) VALUE SPACES.     03000035
030100         10  FILLER                  PIC  X(04) VALUE SPACES.     03010035
030200         10  DL1-EXCEPTION-TYPE      PIC  X(11) VALUE SPACES.     03020010
030300         10  FILLER                  PIC  X(02) VALUE SPACES.     03030030
030400         10  DL1-PO-LINE             PIC  Z(04) VALUE SPACES.     03040029
030500         10  FILLER                  PIC  X(01) VALUE SPACES.     03050028
030501         10  DL1-PREPK-IND           PIC  X(05) VALUE SPACES.     03051028
030502         10  FILLER                  PIC  X(03) VALUE SPACES.     03052030
030600         10  DL1-TOTAL-N-LBLS        PIC  X(05) VALUE SPACES.     03060010
030700         10  FILLER                  PIC  X(08) VALUE SPACES.     03070010
030800         10  DL1-SML-N-LBLS          PIC  X(04) VALUE SPACES.     03080010
030900         10  FILLER                  PIC  X(04) VALUE SPACES.     03090010
031000         10  DL1-P2L-N-LBLS          PIC  X(04) VALUE SPACES.     03100010
031100         10  FILLER                  PIC  X(05) VALUE SPACES.     03110010
031200         10  DL1-CNTRL-STK-N-LBLS    PIC  X(04) VALUE SPACES.     03120010
031300         10  FILLER                  PIC  X(13) VALUE SPACES.     03130010
031400         10  DL1-TOTAL-Y-LBLS        PIC  X(05) VALUE SPACES.     03140010
031500         10  FILLER                  PIC  X(08) VALUE SPACES.     03150010
031600         10  DL1-SML-Y-LBLS          PIC  X(04) VALUE SPACES.     03160010
031700         10  FILLER                  PIC  X(04) VALUE SPACES.     03170010
031800         10  DL1-P2L-Y-LBLS          PIC  X(04) VALUE SPACES.     03180010
031900         10  FILLER                  PIC  X(05) VALUE SPACES.     03190010
032000         10  DL1-CNTRL-STK-Y-LBLS    PIC  X(04) VALUE SPACES.     03200010
032100         10  FILLER                  PIC  X(06) VALUE SPACES.     03210010
032200                                                                  03220010
032300 01  MISCELLANEOUS-LINES.                                         03230000
032400     05  BLANK-REPORT-LINE.                                       03240000
032500         10  FILLER                  PIC  X(132) VALUE SPACES.    03250000
032600                                                                  03260000
032601     05  EMPTY-FILE-LINE.                                         03260116
032602         10  FILLER                  PIC  X(46)    VALUE SPACES.  03260216
032603         10  FILLER                  PIC  X(41)    VALUE          03260316
032604             '**** NO PO/LINE UNUSED LABELS FOUND *****'.         03260416
032605         10  FILLER                  PIC  X(45)    VALUE SPACES.  03260516
032610*                                                                 03261016
032700     05  END-OF-REPORT-LINE.                                      03270000
032800         10  FILLER                  PIC  X(43) VALUE SPACES.     03280000
032900         10  FILLER                  PIC  X(45) VALUE             03290000
033000             '*******   E N D   O F   R E P O R T   *******'.     03300000
033100         10  FILLER                  PIC  X(44) VALUE SPACES.     03310000
033200                                                                  03320001
033300 01  EL1-ERROR-LINE-1F.                                           03330001
033400     05  FILLER                      PIC  X(02) VALUE SPACES.     03340010
033500     05  FILLER                      PIC  X(48) VALUE             03350010
033600         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      03360001
033700     05  FILLER                      PIC  X(49) VALUE             03370010
033800         'CREATING YOUR REPORTS.  YOUR REQUEST COULD NOT BE'.     03380001
033900     05  FILLER                      PIC  X(33) VALUE             03390010
034000         ' COMPLETED.                      '.                     03400001
034100                                                                  03410001
034200 01  EL1-ERROR-LINE-1P.                                           03420012
034300     05  FILLER                      PIC  X(02) VALUE SPACES.     03430012
034400     05  FILLER                      PIC  X(48) VALUE             03440012
034500         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      03450012
034600     05  FILLER                      PIC  X(49) VALUE             03460012
034700         'CREATING YOUR REPORTS.  THIS REPORT COULD NOT BE '.     03470012
034800     05  FILLER                      PIC  X(33) VALUE             03480012
034900         'COMPLETED.                       '.                     03490012
035000                                                                  03500012
035100 01  EL2-ERROR-LINE-2F.                                           03510010
035200     05  FILLER                      PIC  X(02) VALUE SPACES.     03520010
035300     05  FILLER                      PIC  X(36) VALUE             03530010
035400         'NONE OF YOUR REPORTS WERE CREATED.  '.                  03540010
035500     05  FILLER                      PIC  X(36) VALUE             03550010
035600         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  03560010
035700     05  FILLER                      PIC  X(58) VALUE SPACES.     03570010
035800                                                                  03580010
035900 01  EL2-ERROR-LINE-2P.                                           03590012
036000     05  FILLER                      PIC  X(02) VALUE SPACES.     03600012
036100     05  FILLER                      PIC  X(49) VALUE             03610012
036200         'PLEASE RE-SUBMIT A REQUEST TO CREATE THIS REPORT '.     03620012
036300     05  FILLER                      PIC  X(41) VALUE             03630012
036400         '(YOUR OTHER REPORTS SHOULD BE CHECKED TO '.             03640012
036500     05  FILLER                      PIC  X(40) VALUE             03650012
036600         'DETERMINE IF THEY NEED TO BE CREATED).  '.              03660012
036700                                                                  03670012
036800 01  EL3-ERROR-LINE-3.                                            03680010
036900     05  FILLER                      PIC  X(02) VALUE SPACES.     03690010
037000     05  FILLER                      PIC  X(50) VALUE             03700010
037100         'YOUR REQUEST WAS AS FOLLOWS:                      '.    03710010
037200     05  FILLER                      PIC  X(81) VALUE SPACES.     03720010
037300                                                                  03730010
037400 01  EL4-ERROR-LINE-4.                                            03740010
037500     05  FILLER                      PIC  X(07) VALUE SPACES.     03750010
037600     05  FILLER                      PIC  X(12) VALUE             03760010
037700         'REQUESTOR:  '.                                          03770010
037800     05  EL4-REQUESTOR-ID            PIC  X(08) VALUE SPACES.     03780010
037900     05  FILLER                      PIC  X(10) VALUE SPACES.     03790010
038000     05  FILLER                      PIC  X(22) VALUE             03800010
038100         'PRINTER DESTINATION:  '.                                03810010
038200     05  EL4-PRINTER-ID              PIC  X(08) VALUE SPACES.     03820010
038300     05  FILLER                      PIC  X(65) VALUE SPACES.     03830010
038400                                                                  03840010
038500                                                                  03850010
038600 01  EL5-ERROR-LINE-5.                                            03860010
038700     05  FILLER                      PIC  X(07) VALUE SPACES.     03870010
038800     05  FILLER                      PIC  X(20) VALUE             03880010
038900         'REQUESTED REPORTS:  '.                                  03890010
039000     05  FILLER                      PIC X(105) VALUE SPACES.     03900010
039100                                                                  03910010
039200 01  EL5-ERROR-LINE-5B.                                           03920010
039300     05  FILLER                      PIC  X(07) VALUE SPACES.     03930010
039400     05  FILLER                      PIC  X(04) VALUE SPACES.     03940010
039500     05  FILLER                      PIC  X(08) VALUE             03950010
039600         'STATS   '.                                              03960010
039700     05  FILLER                      PIC  X(18) VALUE             03970010
039800         'PO/STR UNT ADJ    '.                                    03980010
039900     05  FILLER                      PIC  X(17) VALUE             03990010
040000         'CRTNS NOT RCVD   '.                                     04000010
040100     05  FILLER                      PIC  X(14) VALUE             04010010
040200         'FREE ASTRAY   '.                                        04020010
040300     05  FILLER                      PIC  X(12) VALUE             04030010
040400         'MISDIRECT   '.                                          04040010
040500     05  FILLER                      PIC  X(17) VALUE             04050010
040600         'DUPLICATE SCAN   '.                                     04060010
040700     05  FILLER                      PIC  X(18) VALUE             04070010
040800         'SCAN NOT FOUND    '.                                    04080010
040900     05  FILLER                      PIC  X(17) VALUE             04090010
041000         'UNUSED LABELS    '.                                     04100010
041100                                                                  04110010
041200 01  EL6-ERROR-LINE-6B.                                           04120010
041300     05  FILLER                      PIC  X(13) VALUE SPACES.     04130010
041400     05  EL6-SUKRP002-IND            PIC  X(01) VALUE SPACES.     04140010
041500     05  FILLER                      PIC  X(12) VALUE SPACES.     04150010
041600     05  EL6-SUKRP007-IND            PIC  X(01) VALUE SPACES.     04160010
041700     05  FILLER                      PIC  X(16) VALUE SPACES.     04170010
041800     05  EL6-SUKRP003-IND            PIC  X(01) VALUE SPACES.     04180010
041900     05  FILLER                      PIC  X(15) VALUE SPACES.     04190010
042000     05  EL6-SUKRP005-IND            PIC  X(01) VALUE SPACES.     04200010
042100     05  FILLER                      PIC  X(12) VALUE SPACES.     04210010
042200     05  EL6-SUKRP004-IND            PIC  X(01) VALUE SPACES.     04220010
042300     05  FILLER                      PIC  X(13) VALUE SPACES.     04230010
042400     05  EL6-SUKRP006-IND            PIC  X(01) VALUE SPACES.     04240010
042500     05  FILLER                      PIC  X(16) VALUE SPACES.     04250010
042600     05  EL6-SUKRP008-IND            PIC  X(01) VALUE SPACES.     04260010
042700     05  FILLER                      PIC  X(17) VALUE SPACES.     04270010
042800     05  EL6-SUKRP023-IND            PIC  X(01) VALUE SPACES.     04280010
042900     05  FILLER                      PIC  X(10) VALUE SPACES.     04290010
043000                                                                  04300010
043100***************************************************************** 04310000
043200*  COPY BOOK FOR SHIPMENT TABLE                                   04320000
043300***************************************************************** 04330000
043400     EXEC SQL                                                     04340000
043500          INCLUDE TSHIPMT                                         04350000
043600     END-EXEC.                                                    04360000
043700                                                                  04370000
043800***************************************************************** 04380000
043900*  COPY BOOK FOR SHIPMENT PO TABLE                                04390000
044000***************************************************************** 04400000
044100     EXEC SQL                                                     04410000
044200          INCLUDE TSHPTPO                                         04420000
044300     END-EXEC.                                                    04430000
044400                                                                  04440000
044500***************************************************************** 04450000
044600*  COPY BOOK FOR SHIPMENT UNIT/UPC ASSOCIATION                    04460000
044700***************************************************************** 04470000
044800     EXEC SQL                                                     04480000
044900          INCLUDE TSHUUPC                                         04490000
045000     END-EXEC.                                                    04500000
045100                                                                  04510000
045200***************************************************************** 04520000
045300*  COPY BOOK FOR PACKSLIP TABLE                                   04530000
045400***************************************************************** 04540000
045500     EXEC SQL                                                     04550000
045600          INCLUDE TPKSLIP                                         04560000
045700     END-EXEC.                                                    04570000
045800                                                                  04580000
045900***************************************************************** 04590000
046000*  COPY BOOK FOR INBOUND EDI PACKSLIP/VENDOR SHIPMENT UNIT ASSOC T04600000
046100***************************************************************** 04610000
046200     EXEC SQL                                                     04620000
046300          INCLUDE TINPKSU                                         04630000
046400     END-EXEC.                                                    04640000
046500                                                                  04650000
046600***************************************************************** 04660000
046700*  COPY BOOK FOR SHIPMENT UNIT LOCATION                           04670000
046800***************************************************************** 04680000
046900     EXEC SQL                                                     04690000
047000          INCLUDE TSHUNLO                                         04700000
047100     END-EXEC.                                                    04710000
047200                                                                  04720000
047300***************************************************************** 04730000
047400*  COPY BOOK FOR THE VEHICLE TRIP TABLE                           04740000
047500***************************************************************** 04750000
047600     EXEC SQL                                                     04760000
047700          INCLUDE TVHTRIP                                         04770000
047800     END-EXEC.                                                    04780000
047900                                                                  04790000
048000***************************************************************** 04800000
048100*  COPY BOOK FOR TRIP STATUS TABLE                                04810000
048200***************************************************************** 04820000
048300     EXEC SQL                                                     04830000
048400          INCLUDE TTRIPST                                         04840000
048500     END-EXEC.                                                    04850000
048600                                                                  04860000
048700***************************************************************** 04870000
048800*  COPY BOOK FOR TRIP STATUS TYPE TABLE                           04880000
048900***************************************************************** 04890000
049000     EXEC SQL                                                     04900000
049100          INCLUDE TTRSTYP                                         04910000
049200     END-EXEC.                                                    04920000
049300                                                                  04930000
049400***************************************************************** 04940000
049500*  COPY BOOK FOR THE RECEIVER TABLE                               04950000
049600***************************************************************** 04960000
049700     EXEC SQL                                                     04970000
049800          INCLUDE TRECEIV                                         04980000
049900     END-EXEC.                                                    04990000
050000                                                                  05000000
050100***************************************************************** 05010000
050200*  DB2 COMMUNICATION AREA                                         05020000
050300***************************************************************** 05030000
050400     EXEC SQL                                                     05040000
050500         INCLUDE SQLCA                                            05050000
050600     END-EXEC.                                                    05060000
050700                                                                  05070000
050800***************************************************************** 05080000
050900*  TRAILER-CSR                                                    05090000
051000***************************************************************** 05100000
051100     EXEC SQL                                                     05110000
051200       DECLARE TRAILER-CSR CURSOR FOR                             05120000
051300         SELECT DISTINCT                                          05130000
051400                'B'                                               05140000
051500              , C.PO_NBR                                          05150000
051600              , C.REC_SEQ_NBR                                     05160000
051700              , 0                                                 05170000
051800          FROM  TVHTRIP A                                         05180000
051900              , TSHIPMT B                                         05190000
052000              , TSHPTPO C                                         05200000
052100              , TRECEIV D                                         05210000
052200          WHERE A.TRIP_ID           = :VHTRIP-TRIP-ID             05220000
052300            AND A.TRIP_ID           = B.TRIP_ID                   05230000
052400            AND C.SHIPT_ID          = B.SHIPT_ID                  05240000
052500            AND C.PO_NBR          = D.ORD_NBR                     05250000
052600            AND C.REC_SEQ_NBR     = D.REC_SEQ_NBR                 05260000
052700            AND D.VER_STATUS_CDE  = 'A'                           05270000
052800       UNION                                                      05280000
052900         SELECT DISTINCT                                          05290000
053000                'C'                                               05300000
053100              , B.PO_NBR                                          05310000
053200              , 0                                                 05320000
053300              , B.SEQ_NBR                                         05330000
053400          FROM  TSHUNLO A                                         05340000
053500              , TINPKSU B                                         05350000
053600          WHERE A.TRIP_ID           = :VHTRIP-TRIP-ID             05360000
053700            AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              05370000
053710            AND A.SCN_LOC_ID        = 'RECV'                      05371033
053720            AND A.ACTV_CDE          = 'A'                         05372034
053800            AND A.SHIPT_UNT_ID NOT IN                             05380000
053900             (SELECT E.SHIPT_UNT_ID                               05390000
054000              FROM  TVHTRIP A                                     05400000
054100                  , TSHIPMT B                                     05410000
054200                  , TSHPTPO C                                     05420000
054300                  , TPKSLIP D                                     05430000
054400                  , TINPKSU E                                     05440000
054500              WHERE A.TRIP_ID           = :VHTRIP-TRIP-ID         05450000
054600                AND A.TRIP_ID           = B.TRIP_ID               05460000
054700                AND B.SHIPT_ID          = C.SHIPT_ID              05470000
054800                AND C.PO_NBR            = D.PO_NBR                05480000
054900                AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR           05490000
055000                AND D.PO_NBR            = E.PO_NBR                05500000
055100                AND D.SEQ_NBR           = E.SEQ_NBR)              05510000
055200       UNION                                                      05520000
055300         SELECT DISTINCT                                          05530000
055400                'A'                                               05540000
055500              , B.TRN_NBR                                         05550000
055600              , 0                                                 05560000
055700              , 0                                                 05570000
055800          FROM  TSHUNLO A                                         05580000
055900              , TSHUUPC B                                         05590000
056000          WHERE A.TRIP_ID           = :VHTRIP-TRIP-ID             05600000
056100            AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              05610000
056110            AND A.SCN_LOC_ID        = 'RECV'                      05611033
056120            AND A.ACTV_CDE          = 'A'                         05612034
056200            AND NOT EXISTS                                        05620000
056300             (SELECT C.SHIPT_UNT_ID                               05630000
056400              FROM TINPKSU C                                      05640000
056500              WHERE A.SHIPT_UNT_ID  = C.SHIPT_UNT_ID)             05650000
056600       ORDER BY 2, 1                                              05660000
056700     END-EXEC.                                                    05670000
056800                                                                  05680000
056900***************************************************************** 05690000
057000*  ADDED UID_CURSOR 3/31/98  DENISE HAHN                          05700000
057100***************************************************************** 05710000
057200*  RECEIVING ASSOCIATE USERID CURSOR -- THIS CURSOR WILL RETRIEVE 05720000
057300*  THE USERIDS OF ALL THE ASSOCIATES THAT CHECKED-IN THIS TRAILER 05730000
057400***************************************************************** 05740000
057500     EXEC SQL                                                     05750000
057600         DECLARE UID_CURSOR CURSOR FOR                            05760000
057700            SELECT  DISTINCT A.CRE_USR_ID                         05770002
057800              FROM  TSHUNLO A                                     05780002
057900             WHERE  A.TRIP_ID = :SU010-MANIFEST-NBR               05790012
057910               AND  A.SCN_LOC_ID      = 'RECV'                    05791033
057920               AND  A.ACTV_CDE        = 'A'                       05792034
058000         ORDER BY 1                                               05800000
058100     END-EXEC.                                                    05810000
058200                                                                  05820000
058300/                                                                 05830001
058400 PROCEDURE DIVISION.                                              05840000
058500******************************************************************05850000
058600*  THIS PARAGRAPH DRIVES THE PROGRAM.                            *05860001
058700******************************************************************05870001
058800 0000-MAINLINE-PROCESSING.                                        05880001
058900                                                                  05890000
059000     DISPLAY '**** START OF SUKRP023 ****'.                       05900008
059100     DISPLAY ' '.                                                 05910008
059200                                                                  05920012
059300     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           05930012
059400     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   05940012
059500                                                                  05950012
059600     IF CC-PRINT-SUKRP023                                         05960012
059700         PERFORM 0100-INITIALIZATION                              05970012
059800         IF SU010-DETAIL-RECORD                                   05980016
059810             IF PS-END-OF-EXTRACT                                 05981016
059811                 WRITE REPORT-RECORD                              05981116
059812                   FROM EMPTY-FILE-LINE                           05981216
059813                   AFTER ADVANCING 4 LINES                        05981316
059814                 WRITE REPORT-RECORD                              05981416
059815                   FROM END-OF-REPORT-LINE                        05981516
059816                     AFTER ADVANCING 2 LINES                      05981616
059820             ELSE                                                 05982016
059900                 PERFORM 1000-PROCESS-EXTRACT-FILE                05990016
060000                 IF PS-ERROR-RECORD                               06000016
060100                     PERFORM 7000-WRITE-ERROR-REPORT              06010016
060200                 END-IF                                           06020016
060210             END-IF                                               06021016
060300         ELSE                                                     06030015
060400             IF CC-PRINT-SUKRP002                                 06040015
060500               OR CC-PRINT-SUKRP003                               06050015
060600               OR CC-PRINT-SUKRP004                               06060015
060700               OR CC-PRINT-SUKRP005                               06070015
060800               OR CC-PRINT-SUKRP006                               06080015
060900               OR CC-PRINT-SUKRP007                               06090015
061000               OR CC-PRINT-SUKRP008                               06100015
061100                 CONTINUE                                         06110015
061200             ELSE                                                 06120015
061300                 PERFORM 7000-WRITE-ERROR-REPORT                  06130015
061400         END-IF                                                   06140014
061600                                                                  06160012
061700         MOVE PV-RECORD-COUNT           TO PV-DISPLAY-RECORDS-IN  06170014
061800         DISPLAY '  INPUT RECORDS READ = ' PV-DISPLAY-RECORDS-IN  06180014
061900                                                                  06190014
062000         CLOSE EXTRACT-FILE                                       06200014
062100               REPORT-FILE                                        06210014
062200     END-IF.                                                      06220012
062300                                                                  06230012
062400     DISPLAY ' '.                                                 06240008
062500     DISPLAY '****  END OF SUKRP023  ****'.                       06250008
062600                                                                  06260012
062700     GOBACK.                                                      06270000
062800                                                                  06280001
062900******************************************************************06290000
063000**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               06300000
063100******************************************************************06310000
063200 0100-INITIALIZATION.                                             06320000
063300                                                                  06330000
063400     ACCEPT PV-TODAYS-DATE       FROM DATE.                       06340000
063500     ACCEPT PV-TODAYS-TIME       FROM TIME.                       06350000
063600                                                                  06360000
063700     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         06370000
063800     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             06380000
063900     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               06390000
064000     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              06400000
064100                                                                  06410000
064200     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              06420000
064300     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            06430000
064400     MOVE PC-SUKRP023            TO DP132O-PROGRAM-NAME.          06440000
064500                                                                  06450000
064501******************************************************************06450124
064502**  CHECK PO IND ON CONTROL CARD AND MOVE DESCRIPTION TO HEADER.  06450224
064503******************************************************************06450324
064504     IF CC-PRINT-ENTIRE-TRIP                                      06450424
064506        STRING 'ENTIRE TRIP-REQUESTED BY '                        06450627
064507               CC-REQUESTOR-ID  DELIMITED BY SIZE                 06450727
064508               INTO HL1A-CC-IND-DESC                              06450827
064509     ELSE                                                         06450924
064510        STRING 'SELECTED PO''S REQUESTED BY '                     06451026
064511               CC-REQUESTOR-ID  DELIMITED BY SIZE                 06451126
064512               INTO HL1A-CC-IND-DESC.                             06451226
064520                                                                  06452024
064600     OPEN INPUT  EXTRACT-FILE                                     06460000
064700          OUTPUT REPORT-FILE.                                     06470000
064800                                                                  06480000
064900     PERFORM 0200-READ-EXTRACT.                                   06490012
065000                                                                  06500012
065010     IF PS-END-OF-EXTRACT OR                                      06501021
065011        SU010-ERROR-RECORD                                        06501121
065020         CONTINUE                                                 06502021
065030     ELSE                                                         06503021
065100         MOVE SU010-MANIFEST-NBR     TO PV-TRIP-ID                06510014
065200                                        VHTRIP-TRIP-ID            06520014
065300                                        SHUNLO-TRIP-ID            06530014
065400                                        SHIPMT-TRIP-ID            06540014
065500                                                                  06550000
065600         SET PS-PO-WRITTEN-NO        TO TRUE                      06560014
065700         SET PS-DETAIL-RECORD        TO TRUE                      06570014
065800                                                                  06580014
065900         PERFORM 0300-SELECT-TRAILER                              06590014
066000                                                                  06600014
066100         MOVE VHTRIP-OWNER-SCAC-ID   TO HL2-SCAC                  06610014
066200         MOVE PV-TRIP-ID             TO HL2-TRIP-ID               06620014
066300         MOVE TRIPST-TRIP-STATUS-CDE TO HL2-TRAILER-STAT          06630014
066400                                                                  06640014
066500         IF DN-VEH-NBR = -1                                       06650014
066600             MOVE SPACES             TO HL2-TRAILER               06660014
066700         ELSE                                                     06670014
066800             MOVE VHTRIP-VEH-NBR     TO HL2-TRAILER               06680014
066900         END-IF                                                   06690014
067000                                                                  06700001
067100         MOVE SU010-PO-NUMBER        TO PV-SAVE-PO                06710014
067200         MOVE SU010-REC-SEQ-NBR      TO PV-SAVE-RECEIVER          06720014
067300         MOVE SU010-LINE-NBR         TO PV-SAVE-PO-LINE           06730014
067301         PERFORM 1100-SELECT-RECEIVING-UIDS                       06730116
067302         MOVE PC-AR TO PV-STATUS                                  06730216
067303         SET PS-STATUS-NOT-FOUND TO TRUE                          06730316
067304         PERFORM 1200-SELECT-STATUS                               06730416
067305         IF PS-STATUS-FOUND                                       06730516
067306             MOVE TRIPST-STATUS-DTE TO PV-DB2-DATE                06730616
067307             MOVE PV-DB2-DATE-CC TO HL3-ARRIVAL-DATE-CC           06730716
067308             MOVE PV-DB2-DATE-YY TO HL3-ARRIVAL-DATE-YY           06730816
067309             MOVE PV-DB2-DATE-MM TO HL3-ARRIVAL-DATE-MM           06730916
067310             MOVE PV-DB2-DATE-DD TO HL3-ARRIVAL-DATE-DD           06731016
067311         ELSE                                                     06731116
067312             MOVE PC-00          TO HL3-ARRIVAL-DATE-CC           06731216
067313             MOVE PC-00          TO HL3-ARRIVAL-DATE-YY           06731316
067314             MOVE PC-00          TO HL3-ARRIVAL-DATE-MM           06731416
067315             MOVE PC-00          TO HL3-ARRIVAL-DATE-DD           06731516
067316         END-IF                                                   06731616
067317                                                                  06731716
067318         MOVE PC-UG              TO PV-STATUS                     06731816
067319         SET PS-STATUS-NOT-FOUND TO TRUE                          06731916
067320         PERFORM 1200-SELECT-STATUS                               06732016
067321         IF PS-STATUS-FOUND                                       06732116
067322             MOVE TRIPST-STATUS-DTE TO PV-DB2-DATE                06732216
067323             MOVE PV-DB2-DATE-CC TO HL3-BEG-UNLOAD-DATE-CC        06732316
067324             MOVE PV-DB2-DATE-YY TO HL3-BEG-UNLOAD-DATE-YY        06732416
067325             MOVE PV-DB2-DATE-MM TO HL3-BEG-UNLOAD-DATE-MM        06732516
067326             MOVE PV-DB2-DATE-DD TO HL3-BEG-UNLOAD-DATE-DD        06732616
067327         ELSE                                                     06732716
067328             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-CC        06732816
067329             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-YY        06732916
067330             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-MM        06733016
067331             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-DD        06733116
067332         END-IF                                                   06733216
067333                                                                  06733316
067334         MOVE PC-UN              TO PV-STATUS                     06733416
067335         SET PS-STATUS-NOT-FOUND TO TRUE                          06733516
067336         PERFORM 1200-SELECT-STATUS                               06733616
067337         IF PS-STATUS-FOUND                                       06733716
067338             MOVE TRIPST-STATUS-DTE TO PV-DB2-DATE                06733816
067339             MOVE PV-DB2-DATE-CC TO HL3-UNLOADED-DATE-CC          06733916
067340             MOVE PV-DB2-DATE-YY TO HL3-UNLOADED-DATE-YY          06734016
067341             MOVE PV-DB2-DATE-MM TO HL3-UNLOADED-DATE-MM          06734116
067342             MOVE PV-DB2-DATE-DD TO HL3-UNLOADED-DATE-DD          06734216
067343         ELSE                                                     06734316
067344             MOVE PC-00          TO HL3-UNLOADED-DATE-CC          06734416
067345             MOVE PC-00          TO HL3-UNLOADED-DATE-YY          06734516
067346             MOVE PC-00          TO HL3-UNLOADED-DATE-MM          06734616
067347             MOVE PC-00          TO HL3-UNLOADED-DATE-DD          06734716
067348         END-IF                                                   06734816
067349         PERFORM 1300-PRINT-HEADINGS                              06734916
067350         PERFORM 0200-READ-EXTRACT                                06735017
067351         IF NOT PS-END-OF-EXTRACT                                 06735119
067352             MOVE SU010-PO-NUMBER       TO PV-SAVE-PO             06735219
067353             MOVE SU010-REC-SEQ-NBR     TO PV-SAVE-RECEIVER       06735319
067354             MOVE SU010-LINE-NBR        TO PV-SAVE-PO-LINE        06735420
067360         END-IF                                                   06736019
067370     END-IF.                                                      06737019
067400                                                                  06740003
067500******************************************************************06750001
067600 0200-READ-EXTRACT.                                               06760001
067700******************************************************************06770001
067800                                                                  06780001
067900     READ EXTRACT-FILE INTO SU010-EXTRACT-RECORD                  06790001
068000       AT END                                                     06800001
068100         SET PS-END-OF-EXTRACT TO TRUE                            06810001
068200                                                                  06820012
068300       NOT AT END                                                 06830008
068400         ADD 1                 TO PV-RECORD-COUNT.                06840008
068500                                                                  06850001
068600******************************************************************06860001
068700 0300-SELECT-TRAILER.                                             06870001
068800******************************************************************06880001
068900     MOVE '0300-SELECT-TRAILER ' TO PV-ABEND-PARAGRAPH.           06890001
069000                                                                  06900001
069100     EXEC SQL                                                     06910001
069200       SELECT A.OWNER_SCAC_ID                                     06920001
069300             ,A.VEH_NBR                                           06930001
069400             ,B.TRIP_STATUS_CDE                                   06940001
069500       INTO  :VHTRIP-OWNER-SCAC-ID                                06950001
069600            ,:VHTRIP-VEH-NBR :DN-VEH-NBR                          06960001
069700            ,:TRIPST-TRIP-STATUS-CDE                              06970001
069800       FROM   TVHTRIP A                                           06980001
069900             ,TTRIPST B                                           06990001
070000             ,TTRSTYP C                                           07000001
070100       WHERE  A.TRIP_ID          = :VHTRIP-TRIP-ID                07010001
070200         AND  B.TRIP_STATUS_CDE ^= 'DE'                           07020001
070300         AND  C.PRTY_CDE =                                        07030001
070400              (SELECT MAX(E.PRTY_CDE)                             07040001
070500                 FROM TTRIPST D                                   07050001
070600                     ,TTRSTYP E                                   07060001
070700                WHERE D.TRIP_ID         = A.TRIP_ID               07070001
070800                  AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)      07080001
070900         AND  A.TRIP_ID         = B.TRIP_ID                       07090001
071000         AND  B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE               07100001
071100     END-EXEC.                                                    07110001
071200                                                                  07120001
071300     EVALUATE TRUE                                                07130001
071400       WHEN SQLCODE = ZEROS                                       07140001
071500         CONTINUE                                                 07150001
071600       WHEN SQLCODE = +100                                        07160001
071700         MOVE SPACES TO VHTRIP-VEH-NBR                            07170001
071800                        VHTRIP-OWNER-SCAC-ID                      07180001
071900                        TRIPST-TRIP-STATUS-CDE                    07190001
072000       WHEN SQLCODE = -904                                        07200001
072100       WHEN SQLCODE = -911                                        07210001
072200       WHEN SQLCODE = -913                                        07220001
072300         SET PS-ERROR-RECORD TO TRUE                              07230001
072400         MOVE SPACES TO VHTRIP-VEH-NBR                            07240001
072500                        VHTRIP-OWNER-SCAC-ID                      07250001
072600                        TRIPST-TRIP-STATUS-CDE                    07260001
072700       WHEN OTHER                                                 07270001
072800         DISPLAY PV-ABEND-PARAGRAPH                               07280001
072900         PERFORM Z999-SQL-ERROR                                   07290001
073000     END-EVALUATE.                                                07300001
073100                                                                  07310001
073200******************************************************************07320000
073300**  PERFORMS THE PROCESSING FOR THE PROGRAM.                      07330000
073400******************************************************************07340002
073500 1000-PROCESS-EXTRACT-FILE.                                       07350001
073600                                                                  07360001
079900                                                                  07990000
080000*PRINT REPORT DETAIL LINES.                                       08000016
080300     PERFORM 2000-PROCESS-SU.                                     08030016
080500                                                                  08050001
080600*PRINT 'END-OF-REPORT' LINE.                                      08060002
080700     WRITE REPORT-RECORD                                          08070001
080800       FROM END-OF-REPORT-LINE                                    08080001
080900         AFTER ADVANCING 2 LINES.                                 08090001
081000                                                                  08100000
081100******************************************************************08110001
081200* OPEN A CURSOR TO SELECT ALL THE USERIDS OF ALL THE RECEIVING    08120001
081300* ASSOCIATES WHO CHECKED-IN THIS TRAILER.                         08130001
081400******************************************************************08140001
081500 1100-SELECT-RECEIVING-UIDS.                                      08150001
081600                                                                  08160001
081700     INITIALIZE HL3B-USERID-TABLE                                 08170001
081800                PV-HOLD-UID.                                      08180001
081900     SET HL3B-UID-IDX TO +1.                                      08190001
082000     SET HL3B-UID-IDX DOWN BY +1.                                 08200001
082100                                                                  08210001
082200     PERFORM 1110-OPEN-UID-CURSOR.                                08220001
082300     IF PS-DETAIL-RECORD                                          08230001
082400         PERFORM 1120-FETCH-UID-CURSOR                            08240001
082500     END-IF.                                                      08250001
082600                                                                  08260001
082700     PERFORM                                                      08270001
082800       UNTIL PS-EOF-UID-CURSOR OR PS-ERROR-RECORD                 08280001
082900                                                                  08290001
083000         IF SHUNLO-CRE-USR-ID = PV-HOLD-UID                       08300001
083100             CONTINUE                                             08310001
083200         ELSE                                                     08320001
083300             IF HL3B-UID-IDX > 0                                  08330001
083400                 MOVE ',' TO HL3B-COMMA (HL3B-UID-IDX)            08340001
083500             END-IF                                               08350001
083600                                                                  08360001
083700             SET HL3B-UID-IDX UP BY +1                            08370001
083800             MOVE SHUNLO-CRE-USR-ID TO                            08380001
083900                             HL3B-USER-ID (HL3B-UID-IDX)          08390001
084000             MOVE SHUNLO-CRE-USR-ID TO PV-HOLD-UID                08400001
084100         END-IF                                                   08410001
084200                                                                  08420001
084300         PERFORM 1120-FETCH-UID-CURSOR                            08430001
084400     END-PERFORM.                                                 08440001
084500                                                                  08450001
084600     IF PS-DETAIL-RECORD                                          08460001
084700         PERFORM 1130-CLOSE-UID-CURSOR                            08470001
084800     END-IF.                                                      08480001
084900                                                                  08490001
085000******************************************************************08500001
085100*  THIS PROCEDURE WILL OPEN THE UID CURSOR.                       08510001
085200******************************************************************08520001
085300 1110-OPEN-UID-CURSOR.                                            08530001
085400                                                                  08540001
085500     EXEC SQL                                                     08550001
085600          OPEN UID_CURSOR                                         08560001
085700     END-EXEC.                                                    08570001
085800                                                                  08580001
085900     EVALUATE TRUE                                                08590001
086000         WHEN SQLCODE = ZERO                                      08600001
086100              SET PS-NOT-EOF-UID-CURSOR                           08610001
086200                               TO  TRUE                           08620001
086300         WHEN SQLCODE = -904                                      08630001
086400         WHEN SQLCODE = -911                                      08640001
086500         WHEN SQLCODE = -913                                      08650001
086600              SET PS-ERROR-RECORD TO TRUE                         08660001
086700         WHEN SQLWARN0 NOT EQUAL SPACE                            08670001
086800         WHEN SQLCODE NOT EQUAL ZERO                              08680001
086900              MOVE '1110-OPEN-UID-CURSOR'                         08690001
087000                               TO  PV-ABEND-PARAGRAPH             08700001
087100              MOVE 'OPEN UID_CURSOR'                              08710001
087200                               TO  PV-DB2-OPERATION-ATTEMPTED     08720001
087300              DISPLAY '** PARAGRAPH ** '                          08730001
087400                                   PV-ABEND-PARAGRAPH             08740001
087500              DISPLAY '** OPERATION ** '                          08750001
087600                                   PV-DB2-OPERATION-ATTEMPTED     08760001
087700              PERFORM Z999-SQL-ERROR                              08770001
087800     END-EVALUATE.                                                08780001
087900                                                                  08790001
088000******************************************************************08800001
088100*  THIS PROCEDURE WILL FETCH THE UID-CURSOR.                      08810001
088200******************************************************************08820001
088300 1120-FETCH-UID-CURSOR.                                           08830001
088400                                                                  08840001
088500     EXEC SQL                                                     08850001
088600          FETCH UID_CURSOR                                        08860001
088700          INTO   :SHUNLO-CRE-USR-ID                               08870001
088800     END-EXEC.                                                    08880001
088900                                                                  08890001
089000     EVALUATE TRUE                                                08900001
089100         WHEN SQLCODE = ZERO                                      08910001
089200              CONTINUE                                            08920001
089300                                                                  08930001
089400         WHEN SQLCODE = +100                                      08940001
089500              SET PS-EOF-UID-CURSOR                               08950001
089600                               TO  TRUE                           08960001
089700         WHEN SQLCODE = -904                                      08970001
089800         WHEN SQLCODE = -911                                      08980001
089900         WHEN SQLCODE = -913                                      08990001
090000              SET PS-ERROR-RECORD TO TRUE                         09000001
090100         WHEN SQLWARN0 NOT EQUAL SPACE                            09010001
090200         WHEN SQLCODE NOT EQUAL ZERO                              09020001
090300              MOVE '1120-FETCH-UID-CURSOR'                        09030001
090400                               TO  PV-ABEND-PARAGRAPH             09040001
090500              MOVE 'FETCH UID_CURSOR'                             09050001
090600                               TO  PV-DB2-OPERATION-ATTEMPTED     09060001
090700              DISPLAY '** PARAGRAPH ** '                          09070001
090800                                   PV-ABEND-PARAGRAPH             09080001
090900              DISPLAY '** OPERATION ** '                          09090001
091000                                   PV-DB2-OPERATION-ATTEMPTED     09100001
091100              PERFORM Z999-SQL-ERROR                              09110001
091200     END-EVALUATE.                                                09120001
091300                                                                  09130001
091400******************************************************************09140001
091500*  THIS PROCEDURE WILL CLOSE THE UID_CURSOR.                      09150001
091600******************************************************************09160001
091700 1130-CLOSE-UID-CURSOR.                                           09170001
091800                                                                  09180001
091900     EXEC SQL                                                     09190001
092000         CLOSE UID_CURSOR                                         09200001
092100     END-EXEC.                                                    09210001
092200                                                                  09220001
092300     EVALUATE TRUE                                                09230001
092400         WHEN SQLCODE = -904                                      09240001
092500         WHEN SQLCODE = -911                                      09250001
092600         WHEN SQLCODE = -913                                      09260001
092700              SET PS-ERROR-RECORD TO TRUE                         09270001
092800         WHEN SQLWARN0 NOT EQUAL SPACE                            09280001
092900         WHEN SQLCODE NOT EQUAL ZERO                              09290001
093000              MOVE '1130-CLOSE-UID-CURSOR'                        09300001
093100                               TO  PV-ABEND-PARAGRAPH             09310001
093200              MOVE 'CLOSE UID_CURSOR'                             09320001
093300                               TO  PV-DB2-OPERATION-ATTEMPTED     09330001
093400              DISPLAY '** PARAGRAPH ** '                          09340001
093500                                   PV-ABEND-PARAGRAPH             09350001
093600              DISPLAY '** OPERATION ** '                          09360001
093700                                   PV-DB2-OPERATION-ATTEMPTED     09370001
093800              PERFORM Z999-SQL-ERROR                              09380001
093900     END-EVALUATE.                                                09390001
094000                                                                  09400001
094100******************************************************************09410001
094200 1200-SELECT-STATUS.                                              09420000
094300                                                                  09430001
094400     MOVE '1200-SELECT-STATUS  ' TO PV-ABEND-PARAGRAPH.           09440001
094500                                                                  09450001
094600     EXEC SQL                                                     09460000
094700       SELECT STATUS_DTE                                          09470000
094800       INTO  :TRIPST-STATUS-DTE                                   09480000
094900       FROM   TTRIPST                                             09490000
095000       WHERE  TRIP_ID            = :VHTRIP-TRIP-ID                09500000
095100         AND  TRIP_STATUS_CDE    = :PV-STATUS                     09510000
095200     END-EXEC.                                                    09520000
095300                                                                  09530000
095400     EVALUATE TRUE                                                09540000
095500       WHEN SQLCODE = ZEROS                                       09550000
095600         SET PS-STATUS-FOUND TO TRUE                              09560000
095700       WHEN SQLCODE = +100                                        09570000
095800         SET PS-STATUS-NOT-FOUND TO TRUE                          09580000
095900       WHEN SQLCODE = -904                                        09590000
096000       WHEN SQLCODE = -911                                        09600000
096100       WHEN SQLCODE = -913                                        09610000
096200         SET PS-ERROR-RECORD TO TRUE                              09620000
096300       WHEN OTHER                                                 09630000
096400         DISPLAY PV-ABEND-PARAGRAPH                               09640000
096500         PERFORM Z999-SQL-ERROR                                   09650000
096600     END-EVALUATE.                                                09660000
096700                                                                  09670000
096800******************************************************************09680003
096900*  PRINT REPORT HEADINGS.                                        *09690003
097000******************************************************************09700003
097100 1300-PRINT-HEADINGS.                                             09710003
097200                                                                  09720003
097300     ADD 1 TO PV-PAGE-COUNT.                                      09730003
097400     MOVE     PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                09740003
097500     WRITE REPORT-RECORD                                          09750003
097600       FROM DP132O-STANDRD-HEADER-132-COLS                        09760003
097700         AFTER ADVANCING PAGE.                                    09770003
097800                                                                  09780003
097900     WRITE REPORT-RECORD                                          09790003
098000       FROM HEADING-LINE-1                                        09800003
098100         AFTER ADVANCING 2 LINE.                                  09810003
098101*                                                                 09810124
098102     WRITE REPORT-RECORD                                          09810224
098103       FROM HEADING-LINE-1A                                       09810324
098104         AFTER ADVANCING 1 LINE.                                  09810424
098105*                                                                 09810524
098106     WRITE REPORT-RECORD                                          09810624
098107       FROM HEADING-LINE-1B                                       09810724
098110         AFTER ADVANCING 1 LINE.                                  09811024
098200                                                                  09820003
098300     WRITE REPORT-RECORD                                          09830003
098400       FROM HEADING-LINE-2                                        09840003
098500         AFTER ADVANCING 1 LINES.                                 09850024
098600                                                                  09860003
098700     WRITE REPORT-RECORD                                          09870003
098800       FROM HEADING-LINE-3                                        09880003
098900         AFTER ADVANCING 2 LINES.                                 09890003
099000                                                                  09900003
099100     WRITE REPORT-RECORD                                          09910003
099200       FROM HEADING-LINE-3B                                       09920003
099300         AFTER ADVANCING 2 LINES.                                 09930003
099400                                                                  09940003
099500     WRITE REPORT-RECORD                                          09950003
099600       FROM HEADING-LINE-4                                        09960003
099700         AFTER ADVANCING 3 LINES.                                 09970003
099800                                                                  09980003
099900     WRITE REPORT-RECORD                                          09990003
100000       FROM HEADING-LINE-5                                        10000003
100100         AFTER ADVANCING 2 LINE.                                  10010003
100200                                                                  10020003
100300     WRITE REPORT-RECORD                                          10030003
100400       FROM HEADING-LINE-6                                        10040003
100500         AFTER ADVANCING 1 LINE.                                  10050003
100600                                                                  10060003
100700     WRITE REPORT-RECORD                                          10070008
100800       FROM BLANK-REPORT-LINE                                     10080008
100900         AFTER ADVANCING 1 LINE.                                  10090008
101000                                                                  10100008
101100     MOVE +17 TO PV-LINE-COUNT.                                   10110008
101200                                                                  10120003
101300******************************************************************10130000
101400*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *10140000
101500*  UNUSED LABELS REPORT.                                         *10150001
101600******************************************************************10160000
101700 2000-PROCESS-SU.                                                 10170001
101800                                                                  10180001
101900     PERFORM 2100-PROCESS-EXTRACT                                 10190007
102000       UNTIL PS-END-OF-EXTRACT                                    10200001
102100          OR PS-ERROR-RECORD.                                     10210001
102200                                                                  10220001
102300*PRINT LAST RECORD.                                               10230003
102400     IF PS-END-OF-EXTRACT                                         10240003
102500         PERFORM 2145-GET-EXCEPTION-TYPE                          10250009
102600         IF PV-DB2-COUNT = ZEROES                                 10260009
102700             MOVE 'FREE ASTRAY' TO DL1-EXCEPTION-TYPE             10270009
102800         END-IF                                                   10280009
102900         IF PS-PO-WRITTEN-YES                                     10290008
103000             MOVE SPACES TO DL1-PO-RECEIVER                       10300008
103100                            DL1-EXCEPTION-TYPE                    10310008
103200         END-IF                                                   10320008
103300         PERFORM 2120-WRITE-DETAIL-LINE                           10330003
103400     END-IF.                                                      10340003
103500                                                                  10350003
103600******************************************************************10360009
103700 2100-PROCESS-EXTRACT.                                            10370003
103800                                                                  10380001
103900*CHECK FOR DETAIL LINE PRINT.                                     10390003
104000     IF SU010-PO-NUMBER     NOT = PV-SAVE-PO                      10400003
104100       OR SU010-REC-SEQ-NBR NOT = PV-SAVE-RECEIVER                10410003
104200         PERFORM 2145-GET-EXCEPTION-TYPE                          10420005
104300         IF PV-DB2-COUNT = ZEROES                                 10430009
104400             MOVE 'FREE ASTRAY' TO DL1-EXCEPTION-TYPE             10440009
104500         END-IF                                                   10450009
104600         IF PS-PO-WRITTEN-YES                                     10460008
104700             MOVE SPACES TO DL1-PO-RECEIVER                       10470008
104800                            DL1-EXCEPTION-TYPE                    10480008
104900         END-IF                                                   10490008
105000         PERFORM 2120-WRITE-DETAIL-LINE                           10500003
105100         PERFORM 2110-WRITE-BLANK-LINE                            10510003
105200         PERFORM 2130-INITIALIZE-DETAIL                           10520003
105300         PERFORM 2140-FILL-DETAIL-LINE                            10530003
105400         SET PS-PO-WRITTEN-NO TO TRUE                             10540008
105500     ELSE                                                         10550003
105600         IF SU010-LINE-NBR  NOT = PV-SAVE-PO-LINE                 10560003
105700             PERFORM 2145-GET-EXCEPTION-TYPE                      10570009
105800             IF PV-DB2-COUNT = ZEROES                             10580009
105900                 MOVE 'FREE ASTRAY' TO DL1-EXCEPTION-TYPE         10590009
106000             END-IF                                               10600009
106100             IF PS-PO-WRITTEN-YES                                 10610008
106200                 MOVE SPACES TO DL1-PO-RECEIVER                   10620008
106300                                DL1-EXCEPTION-TYPE                10630008
106400             END-IF                                               10640008
106500             PERFORM 2120-WRITE-DETAIL-LINE                       10650003
106600             PERFORM 2130-INITIALIZE-DETAIL                       10660003
106700             PERFORM 2140-FILL-DETAIL-LINE                        10670003
106800             SET PS-PO-WRITTEN-YES TO TRUE                        10680008
106900         ELSE                                                     10690003
107000             PERFORM 2140-FILL-DETAIL-LINE                        10700003
107100         END-IF                                                   10710003
107200     END-IF.                                                      10720003
107300                                                                  10730003
107400*READ NEXT INPUT RECORD.                                          10740007
107500     PERFORM 0200-READ-EXTRACT.                                   10750007
107600                                                                  10760007
107700******************************************************************10770003
107800*     PRINT BLANK LINE.                                          *10780003
107900******************************************************************10790003
108000 2110-WRITE-BLANK-LINE.                                           10800003
108100                                                                  10810003
108200*CHECK FOR OVERFLOW.                                              10820003
108300     ADD +1 TO PV-LINE-COUNT.                                     10830003
108400     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         10840003
108500         PERFORM 1300-PRINT-HEADINGS                              10850003
108600     END-IF.                                                      10860003
108700                                                                  10870003
108800*PRINT DETAIL LINE.                                               10880003
108900     WRITE REPORT-RECORD                                          10890003
109000       FROM BLANK-REPORT-LINE                                     10900003
109100         AFTER ADVANCING 1 LINES.                                 10910003
109200                                                                  10920003
109300******************************************************************10930003
109400*     PRINT DETAIL LINE                                          *10940003
109500******************************************************************10950008
109600 2120-WRITE-DETAIL-LINE.                                          10960003
109700                                                                  10970003
109800*CHECK FOR OVERFLOW.                                              10980003
109900     ADD +1 TO PV-LINE-COUNT.                                     10990003
110000     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         11000003
110100         PERFORM 1300-PRINT-HEADINGS                              11010003
110200     END-IF.                                                      11020003
110300                                                                  11030008
110400*MOVE LABEL BUCKETS TO DETAIL LINE.                               11040008
110500     MOVE PV-ACCUM-N-LABELS    TO PV-DISPLAY-LABEL-TOT            11050008
110600     MOVE PV-DISPLAY-LABEL-TOT TO DL1-TOTAL-N-LBLS                11060008
110700                                                                  11070008
110800     MOVE PV-LBL-SML-N         TO PV-DISPLAY-LABEL.               11080008
110900     MOVE PV-DISPLAY-LABEL     TO DL1-SML-N-LBLS.                 11090008
111000                                                                  11100008
111100     MOVE PV-LBL-P2L-N         TO PV-DISPLAY-LABEL.               11110008
111200     MOVE PV-DISPLAY-LABEL     TO DL1-P2L-N-LBLS.                 11120008
111300                                                                  11130003
111400     MOVE PV-LBL-CS-N          TO PV-DISPLAY-LABEL.               11140008
111500     MOVE PV-DISPLAY-LABEL     TO DL1-CNTRL-STK-N-LBLS.           11150008
111600                                                                  11160008
111700     MOVE PV-ACCUM-Y-LABELS    TO PV-DISPLAY-LABEL-TOT.           11170008
111800     MOVE PV-DISPLAY-LABEL-TOT TO DL1-TOTAL-Y-LBLS.               11180008
111900                                                                  11190008
112000     MOVE PV-LBL-SML-Y         TO PV-DISPLAY-LABEL.               11200008
112100     MOVE PV-DISPLAY-LABEL     TO DL1-SML-Y-LBLS.                 11210008
112200                                                                  11220008
112300     MOVE PV-LBL-P2L-Y         TO PV-DISPLAY-LABEL.               11230008
112400     MOVE PV-DISPLAY-LABEL     TO DL1-P2L-Y-LBLS.                 11240008
112500                                                                  11250008
112600     MOVE PV-LBL-CS-Y          TO PV-DISPLAY-LABEL.               11260008
112700     MOVE PV-DISPLAY-LABEL     TO DL1-CNTRL-STK-Y-LBLS.           11270008
112800                                                                  11280008
112900*PRINT DETAIL LINE.                                               11290003
113000     WRITE REPORT-RECORD                                          11300003
113100       FROM DETAIL-LINE1                                          11310003
113200         AFTER ADVANCING 1 LINES.                                 11320003
113300                                                                  11330003
113400******************************************************************11340003
113500*     INITIALIZE DETAIL.                                         *11350003
113600******************************************************************11360003
113700 2130-INITIALIZE-DETAIL.                                          11370003
113800                                                                  11380003
113900*INITIALIZE DETAIL PRINT LINE.                                    11390003
114000     INITIALIZE DETAIL-LINE1.                                     11400008
114100                                                                  11410003
114200*INITIALIZE LABEL BUCKETS.                                        11420003
114300     MOVE ZEROES TO PV-ACCUM-N-LABELS                             11430008
114400                    PV-ACCUM-Y-LABELS                             11440008
114500                    PV-LBL-SML-N                                  11450008
114600                    PV-LBL-P2L-N                                  11460008
114700                    PV-LBL-CS-N                                   11470008
114800                    PV-LBL-SML-Y                                  11480008
114900                    PV-LBL-P2L-Y                                  11490008
115000                    PV-LBL-CS-Y.                                  11500008
115100                                                                  11510003
115200******************************************************************11520003
115300*     FILL FIELDS ON DETAIL LINE.                                *11530003
115400******************************************************************11540005
115500 2140-FILL-DETAIL-LINE.                                           11550003
115600                                                                  11560003
115700*SAVE PO/RCVR FOR COMPARE.                                        11570003
115800         MOVE SU010-PO-NUMBER       TO PV-SAVE-PO                 11580005
115900                                       DK-PO.                     11590005
116000         MOVE SU010-REC-SEQ-NBR     TO PV-SAVE-RECEIVER           11600005
116100                                       DK-RECEIVER.               11610005
116200         MOVE SU010-LINE-NBR        TO PV-SAVE-PO-LINE            11620005
116300                                       DK-PO-LINE.                11630005
116400                                                                  11640003
116500*FILL PO/RECEIVER.                                                11650003
116600     MOVE SU010-PO-NUMBER           TO PV-PO.                     11660005
116700     MOVE SU010-REC-SEQ-NBR         TO PV-RECEIVER.               11670005
116800     MOVE PV-PO-RECEIVER            TO DL1-PO-RECEIVER.           11680005
116900                                                                  11690003
117000*INITIALIZE EXCEPTION TYPE.                                       11700005
117100     MOVE SPACES                    TO DL1-EXCEPTION-TYPE.        11710005
117200                                                                  11720005
117300*FILL PO LINE.                                                    11730005
117400     MOVE SU010-LINE-NBR            TO PV-PO-LINE.                11740005
117500     MOVE PV-PO-LINE                TO DL1-PO-LINE.               11750003
117600     IF SU010-PREPK-IND = 'P'                                     11750129
117700         MOVE 'PCKID'               TO DL1-PREPK-IND              11751029
117800     ELSE                                                         11752029
117900         MOVE SPACES                TO DL1-PREPK-IND              11753029
117901     END-IF.                                                      11754029
117902                                                                  11760003
117903*FILL NUMBER OF UNUSED SML LABELS.                                11770003
117904     IF SU010-LABEL-IND = 'N'                                     11780003
117905         IF SU010-CART-LBL-TYPE = 'S'                             11790003
118000             MOVE SU010-LABEL-TOTAL TO PV-LBL-SML-N               11800003
118100             ADD  SU010-LABEL-TOTAL TO PV-ACCUM-N-LABELS          11810003
118200         END-IF                                                   11820003
118300                                                                  11830003
118400*FILL NUMBER OF UNUSED P2L LABELS.                                11840003
118500         IF SU010-CART-LBL-TYPE = 'P'                             11850003
118600             MOVE SU010-LABEL-TOTAL TO PV-LBL-P2L-N               11860003
118700             ADD  SU010-LABEL-TOTAL TO PV-ACCUM-N-LABELS          11870003
118800         END-IF                                                   11880003
118900                                                                  11890003
119000*FILL NUMBER OF UNUSED CENTRAL STOCK LABELS.                      11900003
119100         IF SU010-CART-LBL-TYPE = 'C'                             11910003
119200             MOVE SU010-LABEL-TOTAL TO PV-LBL-CS-N                11920003
119300             ADD  SU010-LABEL-TOTAL TO PV-ACCUM-N-LABELS          11930003
119400         END-IF                                                   11940003
119500     END-IF.                                                      11950003
119600                                                                  11960003
119700*FILL NUMBER OF USED SML LABELS.                                  11970003
119800     IF SU010-LABEL-IND = 'Y'                                     11980003
119900         IF SU010-CART-LBL-TYPE = 'S'                             11990003
120000             MOVE SU010-LABEL-TOTAL TO PV-LBL-SML-Y               12000003
120100             ADD  SU010-LABEL-TOTAL TO PV-ACCUM-Y-LABELS          12010003
120200         END-IF                                                   12020003
120300                                                                  12030003
120400*FILL NUMBER OF USED P2L LABELS.                                  12040003
120500         IF SU010-CART-LBL-TYPE = 'P'                             12050003
120600             MOVE SU010-LABEL-TOTAL TO PV-LBL-P2L-Y               12060008
120700             ADD  SU010-LABEL-TOTAL TO PV-ACCUM-Y-LABELS          12070003
120800         END-IF                                                   12080003
120900                                                                  12090003
121000*FILL NUMBER OF USED CENTRAL STOCK LABELS.                        12100003
121100         IF SU010-CART-LBL-TYPE = 'C'                             12110003
121200             MOVE SU010-LABEL-TOTAL TO PV-LBL-CS-Y                12120003
121300             ADD  SU010-LABEL-TOTAL TO PV-ACCUM-Y-LABELS          12130003
121400         END-IF                                                   12140003
121500     END-IF.                                                      12150003
121600                                                                  12160003
121700******************************************************************12170005
121800*     FILL EXCEPTION TYPE                                        *12180005
121900******************************************************************12190009
122000 2145-GET-EXCEPTION-TYPE.                                         12200005
122100                                                                  12210005
122200     INITIALIZE PV-DB2-COUNT.                                     12220005
122300                                                                  12230005
122400     EXEC SQL                                                     12240005
122500       SELECT  COUNT(*)                                           12250005
122600         INTO  :PV-DB2-COUNT                                      12260005
122700         FROM  TVHTRIP A                                          12270005
122800            ,  TSHIPMT B                                          12280005
122900            ,  TSHPTPO C                                          12290005
123000        WHERE  A.TRIP_ID      = B.TRIP_ID                         12300005
123100          AND  B.SHIPT_ID     = C.SHIPT_ID                        12310005
123200          AND  C.PO_NBR       = :DK-PO                            12320006
123300          AND  C.REC_SEQ_NBR  = :DK-RECEIVER                      12330005
123400     END-EXEC.                                                    12340005
123500                                                                  12350005
123600     EVALUATE TRUE                                                12360005
123700       WHEN SQLCODE = ZEROS                                       12370005
123800*JPL       MOVE PV-DB2-COUNT TO PV-DISPLAY-LABEL                  12380009
123900***        DISPLAY 'PV-DB2-COUNT = ' PV-DISPLAY-LABEL             12390009
124000           CONTINUE                                               12400009
124100                                                                  12410005
124200       WHEN OTHER                                                 12420005
124300           DISPLAY 'ABEND IN 2145-GET-EXCEPTION-TYPE'             12430009
124400           MOVE '2145-GET-EXCEPTION-TYPE' TO PV-ABEND-PARAGRAPH   12440009
124500           DISPLAY PV-ABEND-PARAGRAPH                             12450006
124600           PERFORM Z999-SQL-ERROR                                 12460006
124700     END-EVALUATE.                                                12470005
124800                                                                  12480005
124900******************************************************************12490000
125000*  PRINT THE ERROR REPORT WHEN THE EXTRACT FILE HAS AN ERROR REC *12500000
125100******************************************************************12510000
125200 7000-WRITE-ERROR-REPORT.                                         12520001
125300                                                                  12530001
125400     ADD 1 TO PV-PAGE-COUNT.                                      12540003
125500     MOVE     PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                12550003
125600     WRITE REPORT-RECORD                                          12560003
125700       FROM DP132O-STANDRD-HEADER-132-COLS                        12570003
125800         AFTER ADVANCING PAGE.                                    12580003
125900                                                                  12590001
126000     WRITE REPORT-RECORD                                          12600001
126100       FROM HEADING-LINE-1                                        12610000
126200         AFTER ADVANCING 1 LINE.                                  12620000
126301*                                                                 12630124
126302     WRITE REPORT-RECORD                                          12630224
126303       FROM HEADING-LINE-1A                                       12630324
126304         AFTER ADVANCING 1 LINE.                                  12630424
126305*                                                                 12630524
126306     WRITE REPORT-RECORD                                          12630624
126307       FROM HEADING-LINE-1B                                       12630724
126308         AFTER ADVANCING 1 LINE.                                  12630824
126309                                                                  12630924
126310     MOVE SU010-MANIFEST-NBR     TO PV-TRIP-ID.                   12631023
126320     MOVE PV-TRIP-ID             TO HL2-TRIP-ID.                  12632022
126330*                                                                 12633024
126400     WRITE REPORT-RECORD                                          12640001
126500       FROM HEADING-LINE-2                                        12650000
126600         AFTER ADVANCING 4 LINES.                                 12660024
126700                                                                  12670001
126800     IF SU010-DETAIL-RECORD                                       12680012
126900         WRITE REPORT-RECORD                                      12690012
127000           FROM EL1-ERROR-LINE-1P                                 12700012
127100             AFTER ADVANCING 3 LINES                              12710012
127200         WRITE REPORT-RECORD                                      12720012
127300           FROM EL2-ERROR-LINE-2P                                 12730012
127400             AFTER ADVANCING 2 LINES                              12740012
127500     ELSE                                                         12750012
127600         WRITE REPORT-RECORD                                      12760012
127700           FROM EL1-ERROR-LINE-1F                                 12770012
127800             AFTER ADVANCING 3 LINES                              12780012
127900         WRITE REPORT-RECORD                                      12790012
128000           FROM EL2-ERROR-LINE-2F                                 12800012
128100             AFTER ADVANCING 2 LINES                              12810012
128200     END-IF.                                                      12820012
128300                                                                  12830000
128400     WRITE REPORT-RECORD                                          12840010
128500       FROM EL3-ERROR-LINE-3                                      12850010
128600         AFTER ADVANCING 2 LINES.                                 12860010
128700                                                                  12870012
128800     MOVE CC-REQUESTOR-ID TO EL4-REQUESTOR-ID                     12880012
128900     MOVE CC-PRINTER-ID   TO EL4-PRINTER-ID.                      12890012
129000     WRITE REPORT-RECORD                                          12900010
129100       FROM EL4-ERROR-LINE-4                                      12910010
129200         AFTER ADVANCING 3 LINES.                                 12920010
129300                                                                  12930010
129400     WRITE REPORT-RECORD                                          12940010
129500       FROM EL5-ERROR-LINE-5                                      12950010
129600         AFTER ADVANCING 2 LINES.                                 12960010
129700                                                                  12970010
129800     WRITE REPORT-RECORD                                          12980010
129900       FROM EL5-ERROR-LINE-5B                                     12990010
130000         AFTER ADVANCING 2 LINES.                                 13000010
130100                                                                  13010012
130200     MOVE CC-PRINT-SUKRP002-IND TO EL6-SUKRP002-IND.              13020012
130300     MOVE CC-PRINT-SUKRP003-IND TO EL6-SUKRP003-IND.              13030012
130400     MOVE CC-PRINT-SUKRP004-IND TO EL6-SUKRP004-IND.              13040012
130500     MOVE CC-PRINT-SUKRP005-IND TO EL6-SUKRP005-IND.              13050012
130600     MOVE CC-PRINT-SUKRP006-IND TO EL6-SUKRP006-IND.              13060012
130700     MOVE CC-PRINT-SUKRP007-IND TO EL6-SUKRP007-IND.              13070012
130800     MOVE CC-PRINT-SUKRP008-IND TO EL6-SUKRP008-IND.              13080012
130900     MOVE CC-PRINT-SUKRP023-IND TO EL6-SUKRP023-IND.              13090012
131000***  MOVE 'Y'                   TO EL6-SUKRP023-IND.              13100012
131100     WRITE REPORT-RECORD                                          13110010
131200       FROM EL6-ERROR-LINE-6B                                     13120010
131300         AFTER ADVANCING 1 LINE.                                  13130010
131400                                                                  13140010
131500     WRITE REPORT-RECORD                                          13150001
131600       FROM END-OF-REPORT-LINE                                    13160000
131700         AFTER ADVANCING 6 LINES.                                 13170000
131800                                                                  13180001
131900******************************************************************13190000
132000*     SQL WARNING OR ERROR PROCESSING                            *13200000
132100******************************************************************13210000
132200 Z999-SQL-ERROR.                                                  13220000
132300*---------------                                                  13230000
132400     DISPLAY '** ABEND **       ** = SQLERROR'.                   13240000
132500     DISPLAY '** PROGRAM        ** = SUKRP023'.                   13250006
132600     DISPLAY '** SQLCODE        ** = ' SQLCODE.                   13260006
132700     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD(3).                13270006
132800     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   13280000
132900     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  13290000
133000     EXEC SQL                                                     13300000
133100         COMMIT                                                   13310000
133200     END-EXEC.                                                    13320000
133300     MOVE +4013 TO PV-ABEND-CODE.                                 13330000
133400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         13340000
