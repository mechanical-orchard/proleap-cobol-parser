000100 TITLE 'STORE TRAILER STATUS LIST'.                               00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300 PROGRAM-ID.    SUKCS567.                                         00030000
000400 AUTHOR.        DENNIS STEFFEN.                                   00040000
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
000600 DATE-WRITTEN.  AUTUMN 2001.                                      00060000
000700 DATE-COMPILED.                                                   00070000
263968*---------------------------------------------------------------* 00071034
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00072034
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00073034
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00074034
001130*                                                                 00074135
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00074235
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00074335
263968*---------------------------------------------------------------* 00075034
000800 ENVIRONMENT DIVISION.                                            00080000
000900 DATA DIVISION.                                                   00090000
001000                                                                  00100000
001100 WORKING-STORAGE SECTION.                                         00110000
001200                                                                  00120000
001300 01  DK-DB2-KEYS.                                                 00130000
001400     05  DK-OTBND-TRIP-ID             PIC S9(9) COMP VALUE ZERO.  00140000
001500     05  DK-STATUS-CODE-1             PIC X(02) VALUE SPACE.      00150000
001600     05  DK-STATUS-CODE-2             PIC X(02) VALUE SPACE.      00160000
001700     05  DK-STATUS-CODE-3             PIC X(02) VALUE SPACE.      00170000
001800     05  DK-STATUS-CODE-4             PIC X(02) VALUE SPACE.      00180000
001900     05  DK-FROM-DATE                 PIC X(10) VALUE SPACE.      00190000
002000     05  DK-TO-DATE                   PIC X(10) VALUE SPACE.      00200000
002100     05  DK-TRLR-SRL-NBR              PIC S9(09) VALUE ZERO       00210000
002200                                                    COMP.         00220000
002300     05  DK-STR-NBR                   PIC S9(04) VALUE ZERO       00230000
002400                                                    COMP.         00240000
002500                                                                  00250000
002600 01  PC-PROGRAM-CONSTANTS.                                        00260000
002700     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00270000
002800                                                    'SU567A  '.   00280000
002900     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00290000
003000                                                    'SUKM567 '.   00300000
003100     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00310000
003200                                                    'SUKCS567'.   00320000
003300     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00330000
003400     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00340000
003500     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00350000
003600     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     00360000
003700                                                    COMP SYNC.    00370000
003800     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00380000
003900                                                    COMP SYNC.    00390000
004000     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00400000
004100                                                    +1000000      00410000
004200                                                    COMP-3.       00420000
004300     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00430000
004400                                                    COMP SYNC.    00440000
004500     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00450000
004600     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00460000
004700     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00470000
004800     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00480000
004900     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00490000
005000*                                                                 00500000
005100     05  PC-TSYMSG-NUMBERS.                                       00510000
005200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00520000
005300         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00530000
005400         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  00540000
005500         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00550000
005600         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00560000
005700         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00570000
005800         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00580000
005900         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00590000
006000         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00600000
006100         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00610000
006200         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00620000
006300         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00630000
006400         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00640000
006500         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00650000
006600         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  00660000
006700         10  PC-TSYMSG-02816            PIC  9(05)  VALUE 02816.  00670000
006800         10  PC-TSYMSG-03412            PIC  9(05)  VALUE 03412.  00680000
006810* JAK 08/2007 - ADD NEW MESSAGE 3590                              00681000
006820         10  PC-TSYMSG-03590            PIC  9(05)  VALUE 03590.  00682000
006900         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  00690000
007000*                                                                 00700000
007100 01  PS-PROGRAM-SWITCHES.                                         00710000
007200     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'N'.    00720000
007300         88  PS-NO-ERROR                            VALUE 'N'.    00730000
007400         88  PS-ERROR                               VALUE 'Y'.    00740000
007500     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    00750000
007600         88  PS-COMMAREA-VALID                      VALUE 'Y'.    00760000
007700         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    00770000
007800     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    00780000
007900         88  PS-DONE                                VALUE 'Y'.    00790000
008000         88  PS-NOT-DONE                            VALUE 'N'.    00800000
008100     05  PS-NEXT-SCREEN-SW            PIC  X    VALUE 'N'.        00810000
008200         88  PS-NO-NEXT-SCREEN                  VALUE 'N'.        00820000
008300         88  PS-NEXT-SCREEN                     VALUE 'Y'.        00830000
008400*                                                                 00840000
008500 01  PV-PROGRAM-VARIABLES.                                        00850000
008600     05  PV-TRLR-SRL-NBR                PIC S9(09) VALUE ZERO.    00860000
008700     05  PV-STR-NBR                     PIC S9(04) VALUE ZERO.    00870000
008800     05  PV-SUB                         PIC S9(04)  VALUE +0      00880000
008900                                                    COMP SYNC.    00890000
009000     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      00900000
009100                                                    COMP SYNC.    00910000
009200     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      00920000
009300                                                    COMP-3.       00930000
009400     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      00940000
009500                                                    COMP-3.       00950000
009600     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      00960000
009700                                                    COMP-3.       00970000
009800     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      00980000
009900                                                    COMP-3.       00990000
010000     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01000000
010100                                                    COMP-3.       01010000
010200     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01020000
010300                                                    COMP-3.       01030000
010400     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01040000
010500                                                    COMP-3.       01050000
010600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01060000
010700                                                    COMP SYNC.    01070000
010800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01080000
010900                                                    COMP SYNC.    01090000
011000     05  PV-ITEM                        PIC S9(04)  VALUE +0      01100000
011100                                                    COMP SYNC.    01110000
011200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01120000
011300                                                    COMP SYNC.    01130000
011400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01140000
011500                                                    COMP SYNC.    01150000
011600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01160000
011700                                                    COMP SYNC.    01170000
011800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01180000
011900                                                    COMP SYNC.    01190000
012000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01200000
012100                                                    COMP SYNC.    01210000
012200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01220000
012300                                                    COMP SYNC.    01230000
012400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01240000
012500                                                    COMP SYNC.    01250000
012600     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01260000
012700                                                    COMP SYNC.    01270000
012800     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01280000
012900                                                    COMP SYNC.    01290000
013000     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01300000
013100                                                    COMP SYNC.    01310000
013200     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01320000
013300                                                    COMP SYNC.    01330000
013400     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      01340000
013500                                                    COMP SYNC.    01350000
013600     05  PV-DB2-DATE.                                             01360000
013700         10  PV-DB2-MM                PIC XX VALUE ZERO.          01370000
013800         10  FILLER                   PIC X VALUE '/'.            01380000
013900         10  PV-DB2-DD                PIC XX VALUE ZERO.          01390000
014000         10  FILLER                   PIC X VALUE '/'.            01400000
014100         10  PV-DB2-YY                PIC XX VALUE ZERO.          01410000
014200     05  PV-USA-DATE                  PIC X(10) VALUE SPACES.     01420000
014300     05  PV-DB2-COUNT                 PIC S9(8) COMP VALUE ZERO.  01430000
014400     05  PV-TEXT-POINTER              PIC S9(3) COMP-3            01440000
014500                                          VALUE ZERO.             01450000
014510     05  PV-STATUS-DAYS               PIC S9(8) COMP VALUE ZERO.  01451008
014520     05  PV-DISP-VALUE                PIC ZZZZ       VALUE ZERO.  01452009
014530     05  PV-DISP-TRIP                 PIC 9(09)      VALUE ZERO.  01453017
014600                                                                  01460000
014700******************************************************************01470000
014800**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01480000
014900**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **01490000
015000**  APPLICATION-SPECIFIC COMMAREA.                              **01500000
015100******************************************************************01510000
015200 01  LQW-LIST-QUEUE-WORK-AREA.                                    01520000
015300     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01530000
015400     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           01540000
015500                                        INDEXED BY LQW-IDX.       01550000
015600         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       01560000
015700         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01570000
015800         10  LQW-SELECTED-SW          PIC  X(01).                 01580000
015900             88  LQW-SELECT                         VALUE 'S'.    01590000
016000             88  LQW-DESELECT                       VALUE ' '.    01600000
016100         10  LQW-ACTION               PIC  X(03).                 01610000
016200         10  LQW-TRAILER-STAT         PIC X(10).                  01620000
016300         10  LQW-STAT-DATE            PIC X(08).                  01630000
016400         10  LQW-SCAC                 PIC X(04).                  01640000
016500         10  LQW-TRAILER-ID           PIC X(12).                  01650000
016600         10  LQW-SERIAL               PIC 9(09).                  01660000
016700*        10  LQW-PCT-FULL             PIC 9(03).                  01670000
016800         10  LQW-JEWELRY              PIC X(01).                  01680000
016900         10  LQW-AD                   PIC X(01).                  01690000
017000         10  LQW-CART-QTY             PIC 9(06).                  01700000
017100         10  LQW-UNT-QTY              PIC 9(06).                  01710000
017200         10  LQW-OTBND-TRIP-ID        PIC S9(9) COMP.             01720000
017300         10  LQW-TRIP-STAT-CDE        PIC X(02).                  01730000
017400         10  LQW-TRIP-OCRNC-ID        PIC S9(9) COMP.             01740000
017500         10  LQW-CRE-TMST             PIC X(26).                  01750000
017520* DMH - 05/08/17 BEGIN                                            01752015
017530         10  LQW-STATUS-DAYS          PIC S9(09) COMP.            01753015
017540* DMH - 05/08/17 END                                              01754015
017600                                                                  01760000
017700/                                                                 01770000
017800*---------------------------------------------------------------* 01780000
017900*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 01790000
018000*---------------------------------------------------------------* 01800000
018100                                                                  01810000
018200     COPY SUWS013.                                                01820000
018201                                                                  01820122
018202* FOR F22 NAVIGATION TO ASSOCIATE LIST SCREEN                     01820222
018203*                                                                 01820322
018210     COPY SUWS010.                                                01821022
018300                                                                  01830000
018400/                                                                 01840000
018500*---------------------------------------------------------------* 01850000
018600*    MAP LAYOUT                                                 * 01860000
018700*---------------------------------------------------------------* 01870000
018800                                                                  01880000
018900     COPY SUKM567.                                                01890000
019000*                                                                 01900000
019100 01  MR-OCCURS-LAYOUT                   REDEFINES  SU567AO.       01910000
019200     05  FILLER                         PIC X(249).               01920006
019300     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          01930000
019400         10  MR-SELECTL                 PIC S9(04) COMP.          01940000
019500         10  MR-SELECTA                 PIC  X(01).               01950000
019600         10  MR-SELECTC                 PIC  X(01).               01960000
019700         10  MR-SELECTH                 PIC  X(01).               01970000
019800         10  MR-SELECTI                 PIC  X(01).               01980000
019900             88  MR-SELECT                  VALUE 'S'.            01990000
020000                                                                  02000000
020100         10  MR-ACTIONL                 PIC S9(04) COMP.          02010000
020200         10  MR-ACTIONA                 PIC  X(01).               02020000
020300         10  MR-ACTIONC                 PIC  X(01).               02030000
020400         10  MR-ACTIONH                 PIC  X(01).               02040000
020500         10  MR-ACTION                  PIC  X(03).               02050000
020600                                                                  02060000
020700         10  MR-TRAILER-STAT-L          PIC S9(04) COMP.          02070000
020800         10  MR-TRAILER-STAT-A          PIC  X(01).               02080000
020900         10  MR-TRAILER-STAT-C          PIC  X(01).               02090000
021000         10  MR-TRAILER-STAT-H          PIC  X(01).               02100000
021100         10  MR-TRAILER-STAT            PIC  X(10).               02110000
021200                                                                  02120000
021300         10  MR-STAT-DATE-L             PIC S9(04) COMP.          02130000
021400         10  MR-STAT-DATE-A             PIC  X(01).               02140000
021500         10  MR-STAT-DATE-C             PIC  X(01).               02150000
021600         10  MR-STAT-DATE-H             PIC  X(01).               02160000
021700         10  MR-STAT-DATE               PIC  X(08).               02170000
021800                                                                  02180000
021900         10  MR-SCAC-L                  PIC S9(04) COMP.          02190000
022000         10  MR-SCAC-A                  PIC  X(01).               02200000
022100         10  MR-SCAC-C                  PIC  X(01).               02210000
022200         10  MR-SCAC-H                  PIC  X(01).               02220000
022300         10  MR-SCAC                    PIC  X(04).               02230000
022400                                                                  02240000
022500         10  MR-TRAILER-ID-L            PIC S9(04) COMP.          02250000
022600         10  MR-TRAILER-ID-A            PIC  X(01).               02260000
022700         10  MR-TRAILER-ID-C            PIC  X(01).               02270000
022800         10  MR-TRAILER-ID-H            PIC  X(01).               02280000
022900         10  MR-TRAILER-ID              PIC  X(12).               02290000
023000                                                                  02300000
023100         10  MR-SERIAL-L                PIC S9(04) COMP.          02310000
023200         10  MR-SERIAL-A                PIC  X(01).               02320000
023300         10  MR-SERIAL-C                PIC  X(01).               02330000
023400         10  MR-SERIAL-H                PIC  X(01).               02340000
023500         10  MR-SERIAL                  PIC  9(09) BLANK ZERO.    02350000
023600                                                                  02360000
023700*        10  MR-PCT-FULL-L              PIC S9(04) COMP.          02370000
023800*        10  MR-PCT-FULL-A              PIC  X(01).               02380000
023900*        10  MR-PCT-FULL-C              PIC  X(01).               02390000
024000*        10  MR-PCT-FULL-H              PIC  X(01).               02400000
024100*        10  MR-PCT-FULL                PIC  ZZZ.                 02410000
024200                                                                  02420000
024300         10  MR-JEWELRY-L               PIC S9(04) COMP.          02430000
024400         10  MR-JEWELRY-A               PIC  X(01).               02440000
024500         10  MR-JEWELRY-C               PIC  X(01).               02450000
024600         10  MR-JEWELRY-H               PIC  X(01).               02460000
024700         10  MR-JEWELRY                 PIC  X(01).               02470000
024800                                                                  02480000
024900         10  MR-AD-L                    PIC S9(04) COMP.          02490000
025000         10  MR-AD-A                    PIC  X(01).               02500000
025100         10  MR-AD-C                    PIC  X(01).               02510000
025200         10  MR-AD-H                    PIC  X(01).               02520000
025300         10  MR-AD                      PIC  X(01).               02530000
025400                                                                  02540000
025500         10  MR-CARTONS-L               PIC S9(04) COMP.          02550000
025600         10  MR-CARTONS-A               PIC  X(01).               02560000
025700         10  MR-CARTONS-C               PIC  X(01).               02570000
025800         10  MR-CARTONS-H               PIC  X(01).               02580000
025900         10  MR-CARTONS                 PIC  ZZZZZ9 BLANK ZERO.   02590000
026000                                                                  02600000
026100         10  MR-UNITS-L                 PIC S9(04) COMP.          02610000
026200         10  MR-UNITS-A                 PIC  X(01).               02620000
026300         10  MR-UNITS-C                 PIC  X(01).               02630000
026400         10  MR-UNITS-H                 PIC  X(01).               02640000
026500         10  MR-UNITS                   PIC  ZZZZZZ.              02650000
026600/                                                                 02660000
026700*---------------------------------------------------------------* 02670000
026800*    ATTRIBUTE SETTINGS                                           02680000
026900*---------------------------------------------------------------* 02690000
027000                                                                  02700000
027100     COPY DPWS015.                                                02710000
027200                                                                  02720000
027300*---------------------------------------------------------------* 02730000
027400*    FUNCTION KEYS                                                02740000
027500*---------------------------------------------------------------* 02750000
027600                                                                  02760000
027700     COPY DPWS016.                                                02770000
027800                                                                  02780000
027900*---------------------------------------------------------------* 02790000
028000*    NUMERIC EDIT LAYOUT.                                       * 02800000
028100*---------------------------------------------------------------* 02810000
028200                                                                  02820000
028300     COPY DPWS010I.                                               02830000
028400/                                                                 02840000
028500*---------------------------------------------------------------* 02850000
028600*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 02860036
028700*---------------------------------------------------------------* 02870000
028800                                                                  02880000
028900     COPY DPWS030.                                                02890000
028900     COPY DPWS930.                                                02891036
029000/                                                                 02900000
029100*---------------------------------------------------------------* 02910000
029200*    STANDARD COMMAREA.                                         * 02920000
029300*---------------------------------------------------------------* 02930000
029400                                                                  02940000
029500     COPY DPWS020.                                                02950000
029600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02960000
029700                                                                  02970000
029800*---------------------------------------------------------------* 02980000
029900* INTER-APPLICATION COMMAREA.                                   * 02990000
030000*   DPWS054 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 03000000
030100*             SPEC SCREEN.                                      * 03010000
030200*   DPWS056 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 03020000
030300*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 03030000
030310*   SUWS009 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 03031022
030320*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 03032022
030400*---------------------------------------------------------------* 03040000
030500                                                                  03050000
030600         10  INTER-APPL-COMM-AREA       PIC X(200).               03060000
030700                                                                  03070000
030800*  INPUT FROM CRIT SPEC SCREEN, SUKCS566                          03080000
030900     COPY SUWS011.                                                03090000
031000                                                                  03100000
031100*  OUTPUT TO LIST SCREEN, SUKCS568                                03110000
031200     COPY SUWS012.                                                03120000
031201                                                                  03120122
031210* FOR F22 NAVIGATION TO ASSOCIATE LIST SCREEN                     03121022
031211     COPY SUWS009.                                                03121122
031220                                                                  03122022
031300*---------------------------------------------------------------* 03130000
031400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03140000
031500*---------------------------------------------------------------* 03150000
031600         10  ASC-SPECIFIC-COMMAREA.                               03160000
031700             15  ASC-LIST-KEYS.                                   03170000
031800                 20  ASC-KEY-MESSAGE-NUMBER          PIC S9(05)   03180000
031900                                                     COMP-3.      03190000
032000                 20  ASC-KEY-SYSTEM-ID               PIC  X(02).  03200000
032100                 20  ASC-KEY-MESSAGE-TEXT            PIC  X(30).  03210000
032200                 20  ASC-KEY-REVIEW-IND              PIC  X(01).  03220000
032300             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                03230000
032400                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  03240000
032500                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03250000
032600                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03260000
032700                                                                  03270000
032800                 20  ASC-ITEM-ARRAY.                              03280000
032900                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        03290000
033000                         30  ASC-LIST-ITEM-NUMBER                 03300000
033100                                                     PIC S9(09)   03310000
033200                                                     COMP-3.      03320000
033300                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  03330000
033400                             88  ASC-VALID-SELECT    VALUE ' '    03340000
033500                                                           'S'    03350000
033600                                                           'B'    03360000
033700                                                           'E'.   03370000
033800                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03380000
033900                             88  ASC-TEMP-SELECT     VALUE 'S'.   03390000
034000                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03400000
034100                             88  ASC-TEMP-END        VALUE 'E'.   03410000
034200                         30  ASC-SELECTED-SW         PIC  X(01).  03420000
034300                             88  ASC-NO-SELECT       VALUE ' '.   03430000
034400                             88  ASC-SELECT          VALUE 'S'.   03440000
034500                             88  ASC-BEGIN           VALUE 'B'.   03450000
034600                             88  ASC-END             VALUE 'E'.   03460000
034700                         30  ASC-ACTION              PIC  X(03).  03470000
034800                         30  ASC-TRAILER-STAT                     03480000
034900                                             PIC X(10).           03490000
035000                         30 ASC-STAT-DATE    PIC X(08).           03500000
035100                         30 ASC-SCAC         PIC X(04).           03510000
035200                         30 ASC-TRAILER-ID   PIC X(12).           03520000
035300                         30 ASC-SERIAL       PIC 9(09).           03530000
035400*                        30 ASC-PCT-FULL     PIC 9(03).           03540000
035500                         30 ASC-JEWELRY      PIC X(01).           03550000
035600                         30 ASC-AD           PIC X(01).           03560000
035700                         30 ASC-CART-QTY     PIC 9(06).           03570000
035800                         30 ASC-UNT-QTY      PIC 9(06).           03580000
035900                         30 ASC-OTBND-TRIP-ID PIC S9(9) COMP.     03590000
036000                         30 ASC-TRIP-STAT-CDE PIC X(02).          03600000
036100                         30 ASC-TRIP-OCRNC-ID PIC S9(9) COMP.     03610000
036200                         30 ASC-CRE-TMST     PIC X(26).           03620000
036210* DMH - 05/08/17 BEGIN                                            03621001
036220                         30 ASC-STATUS-DAYS  PIC S9(09) COMP.     03622001
036230* DMH - 05/08/17 END                                              03623001
036300                                                                  03630000
036400             15  ASC-BLK-SUB                         PIC S9(04)   03640000
036500                                                          COMP    03650000
036600                                                          SYNC.   03660000
036700             15  ASC-ITEM-SUB                        PIC S9(04)   03670000
036800                                                          COMP    03680000
036900                                                          SYNC.   03690000
037000             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   03700000
037100                                                          COMP-3. 03710000
037200             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   03720000
037300                                                          COMP-3. 03730000
037400             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   03740000
037500                                                          COMP-3. 03750000
037600             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   03760000
037700                                                          COMP-3. 03770000
037800             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   03780000
037900                                                          COMP-3. 03790000
038000             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   03800000
038100                                                          COMP    03810000
038200                                                          SYNC.   03820000
038300             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   03830000
038400                                                          COMP-3. 03840000
038500             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   03850000
038600                                                          COMP-3. 03860000
038700             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  03870000
038800                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   03880000
038900                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   03890000
039000             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  03900000
039100                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   03910000
039200                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   03920000
039300             15  ASC-LIST-QUEUE-NAME.                             03930000
039400                 20  ASC-LIST-TERM-ID                PIC  X(04).  03940000
039500                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   03950000
039600                                                          COMP-3. 03960000
039700                 20  ASC-LIST-SEQ                    PIC  9(01).  03970000
039800             15  ASC-SEL-QUEUE-NAME.                              03980000
039900                 20  ASC-SEL-TERM-ID                 PIC  X(04).  03990000
040000                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   04000000
040100                                                          COMP-3. 04010000
040200                 20  ASC-SEL-SEQ                     PIC  9(01).  04020000
040300                                                                  04030000
040310             15  ASC-SEL-QUEUE-NAME-2.                            04031026
040320                 20  ASC-SEL-TERM-ID-2               PIC  X(04).  04032026
040330                 20  ASC-SEL-TASK-NUMBER-2           PIC S9(05)   04033026
040340                                                          COMP-3. 04034026
040350                 20  ASC-SEL-SEQ-2                   PIC  9(01).  04035026
040360                                                                  04036026
040400             15  ASC-CURSOR-SW                       PIC  X(01).  04040000
040500                 88  ASC-TRAILER-CSR                 VALUE 'T'.   04050000
040600                 88  ASC-STR-CSR                     VALUE 'H'.   04060000
040700             15  ASC-START-ITEM-REQUEST.                          04070000
040800                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  04080000
040900             15  ASC-STATUS-TITLE     PIC X(20).                  04090000
041000             15  ASC-STATUS-CRIT-LIST PIC X(58).                  04100000
041100             15  ASC-CURR-OPER-UNT-ID PIC S9(04) COMP.            04110000
041200             15  ASC-STR-NAME         PIC X(25).                  04120000
041300             15  ASC-STR-NBR          PIC S9(04) COMP.            04130000
041400             15  ASC-STATUS-SELECTED.                             04140000
041500                 20  ASC-STATUS-CODE-1   PIC X(02).               04150000
041600                 20  ASC-STATUS-CODE-2   PIC X(02).               04160000
041700                 20  ASC-STATUS-CODE-3   PIC X(02).               04170000
041800                 20  ASC-STATUS-CODE-4   PIC X(02).               04180000
041900                 20  FILLER              PIC X(02).               04190000
042000             15  ASC-SCREEN-SEQUENCE     PIC X(01).               04200000
042010             15  ASC-FROM-DATE           PIC X(10).               04201000
042020             15  ASC-TO-DATE             PIC X(10).               04202000
042021* DMH - 05/08/17 BEGIN                                            04202101
042022             15  ASC-OPEN-STR-VALUE      PIC  S9(9) COMP.         04202201
042023             15  ASC-DC-SHIP-VALUE       PIC  S9(9) COMP.         04202301
042024             15  ASC-STR-OPEN-GRTR-X-DAYS-SW  PIC X(01).          04202413
042025                 88  ASC-STR-OPEN-GRTR-X-DAYS     VALUE 'Y'.      04202513
042026                 88  ASC-STR-OPEN-GRTR-X-DAYS-NO  VALUE 'N'.      04202613
042027             15  ASC-DC-SHIP-GRTR-X-DAYS-SW   PIC X(01).          04202713
042028                 88  ASC-DC-SHIP-GRTR-X-DAYS      VALUE 'Y'.      04202813
042029                 88  ASC-DC-SHIP-GRTR-X-DAYS-NO   VALUE 'N'.      04202913
042030* DMH - 05/08/17 END                                              04203001
042040*  THIS SWITCH IS SET ON BEFORE LEAVING FOR SUKCS567              04204027
042050             15  ASC-FUNC07-RETURN-FLAG       PIC  X(1).          04205027
042060                 88  ASC-FUNC07-RETURN-NO   VALUE 'N'.            04206027
042070                 88  ASC-FUNC07-RETURN-YES  VALUE 'Y'.            04207027
042100/                                                                 04210000
042200*---------------------------------------------------------------* 04220000
042300*    ABEND PROCESSING                                             04230000
042400*---------------------------------------------------------------* 04240000
042500                                                                  04250000
042600     COPY DPWS013.                                                04260000
042700                                                                  04270000
042800/                                                                 04280000
042900     EXEC SQL                                                     04290000
043000          INCLUDE TSUOBTR                                         04300000
043100     END-EXEC.                                                    04310000
043200     EXEC SQL                                                     04320000
043300          INCLUDE TSUOBTS                                         04330000
043400     END-EXEC.                                                    04340000
043500     EXEC SQL                                                     04350000
043600          INCLUDE TSUOBSC                                         04360000
043700     END-EXEC.                                                    04370000
043800     EXEC SQL                                                     04380000
043900          INCLUDE TCNTRID                                         04390000
044000     END-EXEC.                                                    04400000
044100     EXEC SQL                                                     04410000
044200          INCLUDE SUT00007                                        04420000
044300     END-EXEC.                                                    04430000
044400     EXEC SQL                                                     04440000
044500          INCLUDE SUT00011                                        04450000
044600     END-EXEC.                                                    04460000
044700     EXEC SQL                                                     04470000
044800          INCLUDE XLT00025                                        04480000
044900     END-EXEC.                                                    04490000
044910* JAK 08/2007 - ADD WST_INTGRTN_TYP, WST_ATTR_ELEM, WST_ATTR_DEFN 04491000
044911     EXEC SQL                                                     04491100
044920          INCLUDE WST00008                                        04492000
044930     END-EXEC.                                                    04493000
044940     EXEC SQL                                                     04494000
044950          INCLUDE WST00009                                        04495000
044960     END-EXEC.                                                    04496000
044970     EXEC SQL                                                     04497000
044980          INCLUDE WST00010                                        04498000
044990     END-EXEC.                                                    04499000
044991                                                                  04499101
044992* DMH - 05/08/17 BEGIN                                            04499201
044993     EXEC SQL                                                     04499301
044994          INCLUDE TKRPRPM                                         04499402
044995     END-EXEC.                                                    04499501
044996* DMH - 05/08/17 END                                              04499601
045000                                                                  04500001
045100     EXEC SQL                                                     04510000
045200         DECLARE TRLR-STATUS-CSR CURSOR FOR                       04520000
045300          SELECT                                                  04530000
045400                 OBTR.OTBND_TRIP_ID                               04540000
045500                ,OBTR.TRLR_SRL_NBR                                04550000
045600                ,OBTR.ORGN_OPER_UNT_ID                            04560000
045700                ,OBTR.DEST_OPER_UNT_ID                            04570000
045800                ,OBTR.TRIP_ACTV_CDE                               04580000
045900*               ,OBTS.CPCTY_PCT                                   04590000
046000                ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)             04600000
046100                ,OBTS.TRIP_STAT_CDE                               04610000
046200                ,OBSC.STAT_SHRT_DESC                              04620000
046300                ,OBSC.TRIP_STAT_DESC                              04630000
046400                ,TRID.SCAC_CDE                                    04640000
046500                ,TRID.TRLR_ID                                     04650000
046600            FROM  TSUOBTR OBTR                                    04660000
046700                , TSUOBTS OBTS                                    04670000
046800                , TSUOBSC OBSC                                    04680000
046900                , TCNTRID TRID                                    04690000
047000          WHERE  OBTR.OTBND_TRIP_ID      = OBTS.OTBND_TRIP_ID     04700000
047100            AND  OBTS.TRIP_STAT_CDE      = OBSC.TRIP_STAT_CDE     04710000
047200            AND OBTR.TRLR_SRL_NBR        = TRID.TRLR_SRL_NBR      04720000
047300                                                                  04730000
047400            AND  OBTR.DEST_OPER_UNT_ID   = :ASC-CURR-OPER-UNT-ID  04740000
047500            AND  OBTR.TRIP_ACTV_CDE      = 'A'                    04750000
047600            AND  OBTS.OTBND_STAT_TMST IN                          04760000
047700                    (SELECT  MAX(OBTS1.OTBND_STAT_TMST)           04770000
047800                               FROM  TSUOBTS OBTS1                04780000
047900              WHERE  OBTS1.OTBND_TRIP_ID = OBTS.OTBND_TRIP_ID)    04790000
048000            AND  OBTS.TRIP_STAT_CDE IN                            04800000
048100             (   :ASC-STATUS-CODE-1                               04810000
048200             ,   :ASC-STATUS-CODE-2                               04820000
048300             ,   :ASC-STATUS-CODE-3                               04830000
048400             ,   :ASC-STATUS-CODE-4                               04840000
048500             )                                                    04850000
048600            ORDER BY   OBTS.OTBND_STAT_TMST DESC                  04860000
048700     END-EXEC.                                                    04870000
048800                                                                  04880000
048900     EXEC SQL                                                     04890000
049000         DECLARE STR-UNLOAD-CSR CURSOR FOR                        04900000
049100          SELECT                                                  04910000
049200                 OBTR.OTBND_TRIP_ID                               04920000
049300                ,OBTR.TRLR_SRL_NBR                                04930000
049400                ,OBTR.ORGN_OPER_UNT_ID                            04940000
049500                ,OBTR.DEST_OPER_UNT_ID                            04950000
049600                ,OBTR.TRIP_ACTV_CDE                               04960000
049700*               ,OBTS.CPCTY_PCT                                   04970000
049800                ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)             04980000
049900                ,OBTS.TRIP_STAT_CDE                               04990000
050000                ,OBSC.STAT_SHRT_DESC                              05000000
050100                ,OBSC.TRIP_STAT_DESC                              05010000
050200                ,TRID.SCAC_CDE                                    05020000
050300                ,TRID.TRLR_ID                                     05030000
050400                                                                  05040000
050500            FROM  TSUOBTR OBTR                                    05050000
050600                , TSUOBTS OBTS                                    05060000
050700                , TSUOBSC OBSC                                    05070000
050800                , TCNTRID TRID                                    05080000
050900          WHERE                                                   05090000
051000                 OBTR.OTBND_TRIP_ID      = OBTS.OTBND_TRIP_ID     05100000
051100            AND OBTS.TRIP_STAT_CDE       = OBSC.TRIP_STAT_CDE     05110000
051200            AND OBTR.TRLR_SRL_NBR        = TRID.TRLR_SRL_NBR      05120000
051300                                                                  05130000
051400            AND  OBTR.DEST_OPER_UNT_ID   = :ASC-CURR-OPER-UNT-ID  05140000
051500            AND  OBTR.TRIP_ACTV_CDE      = 'A'                    05150000
051600                                                                  05160000
051700            AND  OBTS.OTBND_STAT_TMST IN                          05170000
051800                    (SELECT  MAX(OBTS1.OTBND_STAT_TMST)           05180000
051900                               FROM  TSUOBTS OBTS1                05190000
052000                      WHERE                                       05200000
052100                         OBTS1.OTBND_TRIP_ID = OBTS.OTBND_TRIP_ID)05210000
052200                                                                  05220000
052300            AND  OBTS.TRIP_STAT_CDE      = 'SU'                   05230000
052400            AND DATE(OBTS.OTBND_STAT_TMST) BETWEEN                05240000
052500                :DK-FROM-DATE AND :DK-TO-DATE                     05250000
052600                                                                  05260000
052700            ORDER BY                                              05270000
052800                OBTS.OTBND_STAT_TMST DESC                         05280000
052900     END-EXEC.                                                    05290000
053000/                                                                 05300000
053100*---------------------------------------------------------------* 05310000
053200*    DB2 AREA FOR COMMUNICATIONS                                * 05320000
053300*---------------------------------------------------------------* 05330000
053400     EXEC SQL                                                     05340000
053500          INCLUDE SQLCA                                           05350000
053600     END-EXEC.                                                    05360000
053700                                                                  05370000
053800/                                                                 05380000
053900 LINKAGE SECTION.                                                 05390000
054000                                                                  05400000
054100 01  DFHCOMMAREA.                                                 05410000
054200     05  FILLER                         OCCURS  1 TO 4072 TIMES   05420000
054300                                        DEPENDING ON EIBCALEN.    05430000
054400         10  FILLER                     PIC X.                    05440000
054500                                                                  05450000
054600 EJECT                                                            05460000
054700 PROCEDURE DIVISION.                                              05470000
054800******************************************************************05480000
054900**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **05490000
055000**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **05500000
055100**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **05510000
055200******************************************************************05520000
055300 0000-MAIN-MODULE.                                                05530000
055400     INITIALIZE DP030-CICS-API-FIELDS.                            05540000
055500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       05550000
055600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05560000
055700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05570000
055800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05580000
055900     MOVE LENGTH OF SU567AI        TO DP030-MAP-LENGTH (1).       05590000
056000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05600000
056100     PERFORM 0001-CALL-CICS-ARCH-API.                             05610000
056200*                                                                 05620000
056300     PERFORM 1000-CONTROL-PROCESSING                              05630000
056400*                                                                 05640000
056500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05650000
056600     PERFORM 0001-CALL-CICS-ARCH-API.                             05660000
056700                                                                  05670000
056800******************************************************************05680000
056900**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **05690000
057000**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **05700000
057100******************************************************************05710000
057200 0001-CALL-CICS-ARCH-API.                                         05720000
057300*    CALL 'DPKCS030' USING DFHEIBLK                               05730036
057300     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05731036
057400                           DFHCOMMAREA                            05740000
057500                           DP030-CICS-API-FIELDS                  05750000
057600                           DP020-STANDARD-COMMAREA                05760000
057700                           SU567AI.                               05770000
057800*                                                                 05780000
057900     IF  DP030-RC-CALL-SUCCESSFUL                                 05790000
058000         CONTINUE                                                 05800000
058100     ELSE                                                         05810000
058200         SET DP013-NO-ROLLBACK                                    05820000
058300             DP013-XCTL-DISPLAY-RESTART                           05830000
058400             DP013-CICS-ABEND      TO TRUE                        05840000
058500         MOVE '0001-CALL-CICS-ARCH-API'                           05850000
058600                                   TO DP013-PARAGRAPH             05860000
058700*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX05870036
058800*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      05880036
058700         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O05881036
058800-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05882036
058900         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05890000
059000         PERFORM DP013-0000-PROCESS-ABEND                         05900000
059100     END-IF.                                                      05910000
059200*----------------------------------------------------------------*05920000
059300* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *05930000
059400* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *05940000
059500*                                                                *05950000
059600* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *05960000
059700*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *05970000
059800*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *05980000
059900*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *05990000
060000*----------------------------------------------------------------*06000000
060100                                                                  06010000
060200 1000-CONTROL-PROCESSING.                                         06020000
060300                                                                  06030000
060400     EVALUATE TRUE                                                06040000
060500         WHEN DP020-NEXT-ACT-INITIAL                              06050000
060600             INITIALIZE ASC-SPECIFIC-COMMAREA                     06060000
060700             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            06070000
060800                                      ASC-SEL-TERM-ID             06080000
060810                                      ASC-SEL-TERM-ID-2           06081026
060900             MOVE DP020-SRC-TASK-NUMBER                           06090000
061000                                   TO ASC-LIST-TASK-NUMBER        06100000
061100                                      ASC-SEL-TASK-NUMBER         06110000
061110                                      ASC-SEL-TASK-NUMBER-2       06111026
061200             MOVE PC-LIST-QUEUE-SEQ                               06120000
061300                                   TO ASC-LIST-SEQ                06130000
061400             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 06140000
061410                                      ASC-SEL-SEQ-2               06141026
061500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 06150000
061600***-----$TEMPLATE NOTE$-------------------------------------------06160000
061700*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,06170000
061800*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  06180000
061900*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.06190000
062000***---------------------------------------------------------------06200000
062100             IF  PS-COMMAREA-NOT-VALID                            06210000
062200***              MOVE PC-TSYMSG-99901                             06220000
062300***                                TO DP020-MSG-NUMBER            06230000
062400***              SET DP020-MSG-FATAL                              06240000
062500***                                TO TRUE                        06250000
062600                 SET DP020-NEXT-ACT-APPL-ERROR                    06260000
062700                                   TO TRUE                        06270000
062800             ELSE                                                 06280000
062900                 PERFORM 4000-BUILD-INITIAL-PANEL                 06290000
063000             END-IF                                               06300000
063100                                                                  06310000
063200         WHEN DP020-NEXT-ACT-READ-MAP                             06320000
063300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        06330000
063400                                   TO PV-TOP-ITEM                 06340000
063500             PERFORM 2000-PROCESS-PANEL                           06350000
063600                                                                  06360000
063700         WHEN DP020-NEXT-ACT-RETURN                               06370000
063800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        06380000
063900                                   TO PV-TOP-ITEM                 06390000
064000             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    06400000
064010                                                                  06401027
064020             EVALUATE TRUE                                        06402027
064030             WHEN ASC-FUNC07-RETURN-YES                           06403027
064040                 PERFORM 6001-REFRESH-PANEL-FROM-TEMP             06404027
064050                 SET ASC-FUNC07-RETURN-NO TO TRUE                 06405027
064095             WHEN OTHER                                           06409527
064100                 PERFORM 6000-REFRESH-PANEL-FROM-TEMP             06410027
064110             END-EVALUATE                                         06411028
064120                                                                  06412027
064200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06420000
064300                                                                  06430000
064400                                                                  06440000
064500         WHEN OTHER                                               06450000
064600             SET DP013-LOGIC-ABEND TO TRUE                        06460000
064700             SET DP013-NO-ROLLBACK TO TRUE                        06470000
064800             MOVE '1000-CONTROL-PROCESSING'                       06480000
064900                                   TO DP013-PARAGRAPH             06490000
065000             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    06500000
065100                                   TO DP013-MESSAGE-TEXT(1)       06510000
065200             PERFORM DP013-0000-PROCESS-ABEND                     06520000
065300     END-EVALUATE.                                                06530000
065400                                                                  06540000
065500/                                                                 06550000
065600*----------------------------------------------------------------*06560000
065700* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *06570000
065800* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *06580000
065900*----------------------------------------------------------------*06590000
066000                                                                  06600000
066100 1100-PROCESS-INTER-APPL-COMM.                                    06610000
066200                                                                  06620000
066300     SET PS-COMMAREA-VALID         TO TRUE.                       06630000
066400     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     06640000
066500     MOVE SU011-CURR-OPER-UNT-ID   TO ASC-CURR-OPER-UNT-ID.       06650000
066600     MOVE SU011-STR-NBR            TO ASC-STR-NBR                 06660000
066700     MOVE SU011-STR-NAME           TO ASC-STR-NAME.               06670000
066800     MOVE SU011-STATUS-SELECTED    TO ASC-STATUS-SELECTED         06680000
066900     MOVE 1                        TO PV-TEXT-POINTER             06690000
066901                                                                  06690113
066910     MOVE SU011-STR-OPEN-X-DAYS-SW TO ASC-STR-OPEN-GRTR-X-DAYS-SW 06691013
066940     MOVE SU011-DC-SHIP-X-DAYS-SW  TO ASC-DC-SHIP-GRTR-X-DAYS-SW  06694013
066950                                                                  06695013
067000     EVALUATE TRUE                                                06700000
067100         WHEN SU011-STR-UNLD-SEL                                  06710000
067200             MOVE 'DATE RANGE SELECTED:'                          06720000
067300                                   TO ASC-STATUS-TITLE            06730000
067400             STRING  'FROM '                                      06740000
067500                 SU011-STR-UNLD-FROM-MM '-'                       06750000
067600                 SU011-STR-UNLD-FROM-DD '-'                       06760000
067700                 SU011-STR-UNLD-FROM-CCYY                         06770000
067800                 ' THRU '                                         06780000
067900                                                                  06790000
068000                 SU011-STR-UNLD-TO-MM '-'                         06800000
068100                 SU011-STR-UNLD-TO-DD '-'                         06810000
068200                 SU011-STR-UNLD-TO-CCYY                           06820000
068300             DELIMITED BY SIZE                                    06830000
068400                         INTO ASC-STATUS-CRIT-LIST                06840000
068500         WHEN OTHER                                               06850000
068600             MOVE 'STATUS SELECTED....:'                          06860000
068700                                   TO ASC-STATUS-TITLE            06870000
068800             IF SU011-DC-OPEN-SEL                                 06880000
068900                 STRING 'OPEN AT DC ' DELIMITED BY SIZE           06890000
069000                         INTO ASC-STATUS-CRIT-LIST                06900000
069100                         WITH POINTER PV-TEXT-POINTER             06910000
069200             END-IF                                               06920000
069300             IF SU011-DC-CLOSED-SEL                               06930000
069400                 STRING '| CLSD AT DC ' DELIMITED BY SIZE         06940000
069500                         INTO ASC-STATUS-CRIT-LIST                06950000
069600                         WITH POINTER PV-TEXT-POINTER             06960000
069700             END-IF                                               06970000
069800             IF SU011-DC-SHIPPED-SEL                              06980000
069900                 STRING '| SHPD FR DC ' DELIMITED BY SIZE         06990000
070000                         INTO ASC-STATUS-CRIT-LIST                07000000
070100                         WITH POINTER PV-TEXT-POINTER             07010000
070200             END-IF                                               07020000
070300             IF SU011-STR-OPEN-SEL                                07030000
070400                 STRING '| OPEN AT ST' DELIMITED BY SIZE          07040000
070500                         INTO ASC-STATUS-CRIT-LIST                07050000
070600                         WITH POINTER PV-TEXT-POINTER             07060000
070700             END-IF                                               07070000
070800             IF ASC-STATUS-CRIT-LIST (1:1) = '|'                  07080000
070900*            THIS REMOVES THE LEADING "|" FROM THE DISPLAY LINE   07090000
071000                 MOVE SPACE TO ASC-STATUS-CRIT-LIST (1:1)         07100000
071100             END-IF                                               07110000
071200     END-EVALUATE.                                                07120000
071201                                                                  07120111
071210* DMH - 5/8/17 BEGIN                                              07121011
071220     PERFORM 4050-GET-OPEN-STR-VALUE.                             07122011
071230     PERFORM 4060-GET-DC-SHIP-VALUE.                              07123011
071240* DMH - 5/8/17 END                                                07124011
071250                                                                  07125011
071300                                                                  07130000
071400/                                                                 07140000
071500*----------------------------------------------------------------*07150000
071600* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *07160000
071700* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *07170000
071800* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *07180000
071900* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *07190000
072000* FUNCTION KEYS CAN GET THIS FAR.                                *07200000
072100*----------------------------------------------------------------*07210000
072200                                                                  07220000
072300 2000-PROCESS-PANEL.                                              07230000
072400     SET PS-NEXT-SCREEN TO TRUE.                                  07240000
072500     EVALUATE TRUE                                                07250000
072600         WHEN DP020-SRC-AID = DP016-CLEAR                         07260000
072700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    07270000
072800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07280000
072900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07290000
073000                                                                  07300000
073100         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    07310000
073200             PERFORM 2050-DELETE-LIST-QUEUE                       07320000
073300             PERFORM 4000-BUILD-INITIAL-PANEL                     07330000
073400                                                                  07340000
073500         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    07350000
073600             PERFORM 2140-DESELECT-ALL-ITEMS                      07360000
073700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07370000
073800                                                                  07380000
073900         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  07390000
074000             PERFORM 2150-SELECT-ALL-ITEMS                        07400000
074100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07410000
074200                                                                  07420000
074300         WHEN OTHER                                               07430000
074400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 07440000
074500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07450000
074600             IF  PS-NO-ERROR                                      07460000
074700                 SET DP030-CONTINUE-GO                            07470000
074800                                 TO TRUE                          07480000
074900                 PERFORM 2100-CHECK-FUNCTION-KEY                  07490000
075000             ELSE                                                 07500000
075100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07510000
075200                 SET DP030-OVERRIDE-GO                            07520000
075300                                 TO TRUE                          07530000
075400             END-IF                                               07540000
075500     END-EVALUATE.                                                07550000
075600 EJECT                                                            07560000
075700*----------------------------------------------------------------*07570000
075800*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *07580000
075900*----------------------------------------------------------------*07590000
076000 2050-DELETE-LIST-QUEUE.                                          07600000
076100                                                                  07610000
076200     EXEC CICS                                                    07620000
076300         DELETEQ TS                                               07630000
076400             QUEUE (ASC-LIST-QUEUE-NAME)                          07640000
076500             RESP  (PV-CICS-RESP)                                 07650000
076600     END-EXEC.                                                    07660000
076700                                                                  07670000
076800     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       07680000
076900        (PV-CICS-RESP = DFHRESP(QIDERR))                          07690000
077000         CONTINUE                                                 07700000
077100     ELSE                                                         07710000
077200         SET DP013-CICS-ABEND      TO TRUE                        07720000
077300         SET DP013-NO-ROLLBACK     TO TRUE                        07730000
077400                                                                  07740000
077500         MOVE '2050-DELETE-LIST-QUEUE'                            07750000
077600                                   TO DP013-PARAGRAPH             07760000
077700         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    07770000
077800                                   TO DP013-MESSAGE-TEXT (1)      07780000
077900         PERFORM DP013-0000-PROCESS-ABEND                         07790000
078000     END-IF.                                                      07800000
078100                                                                  07810000
078200     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  07820000
078300/                                                                 07830000
078400*----------------------------------------------------------------*07840000
078500* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*07850000
078600* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *07860000
078700* CICS ARCHITECTURE API.                                         *07870000
078800*----------------------------------------------------------------*07880000
078900 2100-CHECK-FUNCTION-KEY.                                         07890000
079000     SET PS-NEXT-SCREEN TO TRUE.                                  07900000
079100     EVALUATE TRUE                                                07910000
082300                                                                  08230000
082400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08240000
082500             MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB              08250000
082600             COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +               08260000
082700                 ASC-ITEMS-DISPLAYED - 1                          08270000
082800             PERFORM 3100-SET-SUBSCRIPTS                          08280000
082900             PERFORM 3300A-EDIT-STATUS                            08290000
083000                 VARYING PV-SUB                                   08300000
083100                 FROM PV-SUB BY -1                                08310000
083200                 UNTIL PV-SUB < +1                                08320000
083300                                                                  08330000
083400             IF PS-ERROR                                          08340000
083500                 CONTINUE                                         08350000
083600             ELSE                                                 08360000
083700                 EVALUATE TRUE                                    08370000
083800                 WHEN ASC-NUMBER-OF-SELECTED-ITEMS = ZERO         08380000
083900                   SET DP030-OVERRIDE-GO                          08390000
084000                                     TO TRUE                      08400000
084100                   MOVE PC-TSYMSG-00057                           08410000
084200                                   TO DP020-MSG-NUMBER            08420000
084300                   SET DP020-MSG-WARNING                          08430000
084400                                   TO TRUE                        08440000
084500                   MOVE -1           TO MR-SELECTL(1)             08450000
084600                   SET DP030-SET-CURSOR-APPL-1                    08460000
084700                                   TO TRUE                        08470000
084800                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           08480000
084900                 WHEN ASC-NUMBER-OF-SELECTED-ITEMS > 1            08490000
085000                     SET DP030-OVERRIDE-GO                        08500000
085100                                       TO TRUE                    08510000
085200                     MOVE PC-TSYMSG-00047                         08520000
085300                                       TO DP020-MSG-NUMBER        08530000
085400                     SET DP020-MSG-WARNING                        08540000
085500                                       TO TRUE                    08550000
085600                     MOVE -1           TO MR-SELECTL(1)           08560000
085700                     SET DP030-SET-CURSOR-APPL-1                  08570000
085800                                       TO TRUE                    08580000
085900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08590000
086000                 WHEN OTHER                                       08600000
086100                     MOVE SU012-SCREEN-SEQUENCE TO                08610000
086200                                        ASC-SCREEN-SEQUENCE       08620000
086300                     INITIALIZE SU012-INTER-APPL-COMMAREA         08630000
086400                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            08640000
086500                                TO SU012-NUMBER-OF-SELECTED-ITEMS 08650000
086600                     MOVE ASC-STR-NBR  TO SU012-STR-NBR           08660000
086700                     MOVE ASC-STR-NAME TO SU012-STR-NAME          08670000
086800                     MOVE ASC-SCREEN-SEQUENCE                     08680000
086900                                          TO SU012-SCREEN-SEQUENCE08690000
087000                     IF SU012-CLASS-SEQ OR                        08700000
087100                        SU012-UNIT-SEQ OR                         08710000
087200                        SU012-GROUP-SEQ                           08720000
087300                         CONTINUE                                 08730000
087400                     ELSE                                         08740000
087500                         SET SU012-DEPT-SEQ  TO TRUE              08750000
087600                     END-IF                                       08760000
087700                     PERFORM 5000-PREPARE-SEL-QUEUE               08770000
087800                 END-EVALUATE                                     08780000
087900             END-IF                                               08790000
088000         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  08800000
088100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              08810000
088200         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              08820000
088300         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              08830000
088400         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              08840000
088500         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              08850000
088600             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              08860000
088700                 MOVE SU012-SCREEN-SEQUENCE TO                    08870000
088800                                    ASC-SCREEN-SEQUENCE           08880000
088900                 INITIALIZE SU012-INTER-APPL-COMMAREA             08890000
089000                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                08900000
089100                                TO SU012-NUMBER-OF-SELECTED-ITEMS 08910000
089200                 MOVE ASC-STR-NBR  TO SU012-STR-NBR               08920000
089300                 MOVE ASC-STR-NAME TO SU012-STR-NAME              08930000
089400                 MOVE ASC-SCREEN-SEQUENCE TO SU012-SCREEN-SEQUENCE08940000
089500                 IF SU012-CLASS-SEQ OR                            08950000
089600                    SU012-UNIT-SEQ OR                             08960000
089700                    SU012-GROUP-SEQ                               08970000
089800                     CONTINUE                                     08980000
089900                 ELSE                                             08990000
090000                     SET SU012-DEPT-SEQ  TO TRUE                  09000000
090100                 END-IF                                           09010000
090200                 PERFORM 5000-PREPARE-SEL-QUEUE                   09020000
090300             ELSE                                                 09030000
090400                 SET DP030-OVERRIDE-GO                            09040000
090500                                   TO TRUE                        09050000
090600                 MOVE PC-TSYMSG-00057                             09060000
090700                                   TO DP020-MSG-NUMBER            09070000
090800                 SET DP020-MSG-WARNING                            09080000
090900                                   TO TRUE                        09090000
091000                 MOVE -1           TO MR-SELECTL(1)               09100000
091100                 SET DP030-SET-CURSOR-APPL-1                      09110000
091200                                   TO TRUE                        09120000
091300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09130000
091400             END-IF                                               09140000
091500                                                                  09150000
091510* DMH 5/17/18                                                     09151020
091520* F22 - ASSOCIATE LIST                                            09152020
091530         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              09153020
091531         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              09153130
091532             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              09153229
091533                 SET  ASC-FUNC07-RETURN-YES  TO  TRUE             09153329
091534                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                09153429
091535                            TO SU009-NUMBER-OF-SELECTED-ITEMS     09153529
091536                               SU009-NUMBER-OF-TS-ITEMS           09153629
091538                 MOVE ASC-STR-NBR       TO SU009-OPER-UNT-ID      09153827
091539                 PERFORM 5010-PREPARE-SEL-QUEUE                   09153927
091548             ELSE                                                 09154820
091549                 SET DP030-OVERRIDE-GO                            09154920
091550                                   TO TRUE                        09155020
091551                 MOVE PC-TSYMSG-00057                             09155120
091552                                   TO DP020-MSG-NUMBER            09155220
091553                 SET DP020-MSG-WARNING                            09155320
091554                                   TO TRUE                        09155420
091555                 MOVE -1           TO MR-SELECTL(1)               09155520
091556                 SET DP030-SET-CURSOR-APPL-1                      09155620
091557                                   TO TRUE                        09155720
091558                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09155820
091559             END-IF                                               09155920
091560                                                                  09156020
091614                                                                  09161420
091620         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  09162000
091700             MOVE +1               TO PV-TOP-ITEM                 09170000
091800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09180000
091900                                                                  09190000
092000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   09200000
092100             PERFORM 2110-BROWSE-BACKWARD                         09210000
092200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09220000
092300                                                                  09230000
092400         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   09240000
092500             PERFORM 2120-BROWSE-FORWARD                          09250000
092600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09260000
092700                                                                  09270000
092800         WHEN DP020-SRC-AID = DP016-ENTER                         09280000
092900             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   09290000
093000             IF  PS-ERROR                                         09300000
093100                 CONTINUE                                         09310000
093200             ELSE                                                 09320000
093300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09330000
093400             END-IF                                               09340000
093500                                                                  09350000
093600         WHEN OTHER                                               09360000
093700             SET DP013-NO-ROLLBACK                                09370000
093800                 DP013-XCTL-DISPLAY-RESTART                       09380000
093900                 DP013-CICS-ABEND  TO TRUE                        09390000
094000             MOVE '2100-CHECK-FUNCTION-KEY'                       09400000
094100                                   TO DP013-PARAGRAPH             09410000
094200             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09420000
094300                                   TO DP013-MESSAGE-TEXT (1)      09430000
094400             PERFORM DP013-0000-PROCESS-ABEND                     09440000
094500     END-EVALUATE.                                                09450000
094600*                                                                 09460000
094700*----------------------------------------------------------------*09470000
094800*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *09480000
094900*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *09490000
095000*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *09500000
095100*    MESSAGE.                                                    *09510000
095200*----------------------------------------------------------------*09520000
095300                                                                  09530000
095400 2110-BROWSE-BACKWARD.                                            09540000
095500     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    09550000
095600         GIVING PV-TOP-ITEM.                                      09560000
095700*                                                                 09570000
095800     IF  ((PV-TOP-ITEM < +1)                                      09580000
095900       OR (PV-TOP-ITEM = +1))                                     09590000
096000         MOVE +1                   TO PV-TOP-ITEM                 09600000
096100*        -- TOP OF LIST --                                        09610000
096200         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            09620000
096300         SET DP020-MSG-INFORMATIONAL TO TRUE                      09630000
096400     END-IF.                                                      09640000
096500                                                                  09650000
096600 EJECT                                                            09660000
096700*----------------------------------------------------------------*09670000
096800*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *09680000
096900*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *09690000
097000*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *09700000
097100*----------------------------------------------------------------*09710000
097200                                                                  09720000
097300 2120-BROWSE-FORWARD.                                             09730000
097400                                                                  09740000
097500     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              09750000
097600         GIVING PV-TOP-ITEM.                                      09760000
097700     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   09770000
097800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            09780000
097900                                   TO PV-TOP-ITEM                 09790000
098000*        -- BOTTOM OF LIST --                                     09800000
098100         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            09810000
098200         SET DP020-MSG-INFORMATIONAL                              09820000
098300                                   TO TRUE                        09830000
098400     ELSE                                                         09840000
098500         COMPUTE PV-BOTTOM-ITEM =                                 09850000
098600             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 09860000
098700         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            09870000
098800*            -- BOTTOM OF LIST --                                 09880000
098900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            09890000
099000             SET DP020-MSG-INFORMATIONAL                          09900000
099100                                   TO TRUE                        09910000
099200         END-IF                                                   09920000
099300     END-IF.                                                      09930000
099400 EJECT                                                            09940000
099500*----------------------------------------------------------------*09950000
099600*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *09960000
099700*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *09970000
099800*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *09980000
099900*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *09990000
100000*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *10000000
100100*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *10010000
100200*----------------------------------------------------------------*10020000
100300                                                                  10030000
100400 2130-CHECK-FOR-JUMP-BROWSE.                                      10040000
100500     SET PS-NO-ERROR               TO TRUE.                       10050000
100600     IF (ASC-START-ITEM-REQUEST = SPACE)                          10060000
100700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            10070000
100800                                   TO PV-TOP-ITEM                 10080000
100900     ELSE                                                         10090000
101000         MOVE ASC-START-ITEM-REQUEST                              10100000
101100                                   TO DP010I-UNEDITED-FIELD       10110000
101200         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       10120000
101300         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     10130000
101400         SET DP010I-NEGATIVE-NOT-ALLOWED                          10140000
101500                                   TO TRUE                        10150000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10161034
263968              USING DP010I-NUMERIC-EDIT-AREA                      10162034
101700                                                                  10170000
101800         IF  NOT DP010I-ERROR-DETECTED                            10180000
101900             MOVE DP010I-NUMERIC-FIELD                            10190000
102000                                   TO  ASC-START-ITEM-REQUEST-N   10200000
102100             IF  ASC-START-ITEM-REQUEST-N > ZERO                  10210000
102200                 IF  ASC-START-ITEM-REQUEST-N >                   10220000
102300                                          ASC-NUMBER-OF-ITEMS-READ10230000
102400                     MOVE SPACE TO ASC-START-ITEM-REQUEST         10240000
102500                     COMPUTE PV-TOP-ITEM =                        10250000
102600                             ASC-NUMBER-OF-ITEMS-READ             10260000
102700                             - PC-ITEMS-PER-PANEL + 1             10270000
102800                     IF  PV-TOP-ITEM < +1                         10280000
102900                         MOVE +1   TO PV-TOP-ITEM                 10290000
103000                         MOVE PC-TSYMSG-00070                     10300000
103100                                   TO DP020-MSG-NUMBER            10310000
103200                         SET DP020-MSG-INFORMATIONAL              10320000
103300                                   TO TRUE                        10330000
103400                     END-IF                                       10340000
103500                 ELSE                                             10350000
103600                     MOVE ASC-START-ITEM-REQUEST-N                10360000
103700                                   TO PV-TOP-ITEM                 10370000
103800                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      10380000
103900                     COMPUTE PV-BOTTOM-ITEM =                     10390000
104000                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     10400000
104100                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ10410000
104200*                        -- BOTTOM OF LIST --                     10420000
104300                         MOVE PC-TSYMSG-00070                     10430000
104400                                   TO DP020-MSG-NUMBER            10440000
104500                         SET DP020-MSG-INFORMATIONAL              10450000
104600                                   TO TRUE                        10460000
104700                     END-IF                                       10470000
104800                 END-IF                                           10480000
104900             ELSE                                                 10490000
105000*                --- VALUE OUT OF RANGE ----                      10500000
105100                 MOVE PC-TSYMSG-00101                             10510000
105200                                   TO DP020-MSG-NUMBER            10520000
105300                 MOVE -1           TO ASTRTITL                    10530000
105400                 SET DP030-SET-CURSOR-APPL-1                      10540000
105500                                   TO TRUE                        10550000
105600                 MOVE DP015-REVERSE                               10560000
105700                                   TO ASTRTITH                    10570000
105800                 MOVE DP015-RED    TO ASTRTITC                    10580000
105900                 MOVE DP015-UNP-NUM-BRT-MDT                       10590000
106000                                   TO ASTRTITA                    10600000
106100                 SET DP020-MSG-FATAL                              10610000
106200                                   TO TRUE                        10620000
106300                 SET PS-ERROR      TO TRUE                        10630000
106400             END-IF                                               10640000
106500                                                                  10650000
106600         ELSE                                                     10660000
106700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            10670000
106800             MOVE -1               TO ASTRTITL                    10680000
106900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10690000
107000             MOVE DP015-REVERSE    TO ASTRTITH                    10700000
107100             MOVE DP015-RED        TO ASTRTITC                    10710000
107200             MOVE DP015-UNP-NUM-BRT-MDT                           10720000
107300                                   TO ASTRTITA                    10730000
107400             SET DP020-MSG-FATAL   TO TRUE                        10740000
107500             SET PS-ERROR          TO TRUE                        10750000
107600         END-IF                                                   10760000
107700     END-IF.                                                      10770000
107800 EJECT                                                            10780000
107900*----------------------------------------------------------------*10790000
108000*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *10800000
108100*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *10810000
108200*----------------------------------------------------------------*10820000
108300 2140-DESELECT-ALL-ITEMS.                                         10830000
108400     MOVE +1                       TO ASC-BLK-SUB.                10840000
108500                                                                  10850000
108600     PERFORM 2141-CLEAR-SELECTED-INDS                             10860000
108700         VARYING ASC-ITEM-SUB                                     10870000
108800         FROM 1 BY 1                                              10880000
108900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 10890000
109000                                                                  10900000
109100     ADD +1                        TO ASC-BLK-SUB.                10910000
109200                                                                  10920000
109300     PERFORM 2141-CLEAR-SELECTED-INDS                             10930000
109400         VARYING ASC-ITEM-SUB                                     10940000
109500         FROM 1 BY 1                                              10950000
109600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 10960000
109700                                                                  10970000
109800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               10980000
109900                                   TO PV-LIST-ITEM-NUMBER.        10990000
110000                                                                  11000000
110100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            11010000
110200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    11020000
110300                                                                  11030000
110400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     11040000
110500        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      11050000
110600         MOVE +1                   TO ASC-BLK-SUB                 11060000
110700                                                                  11070000
110800         PERFORM 5100-WRITE-TEMP-STORAGE                          11080000
110900                                                                  11090000
111000         MOVE +1                   TO PV-BLOCK-NUMBER             11100000
111100                                                                  11110000
111200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         11120000
111300             PV-FIRST-BLOCK-IN-ARRAY - 1                          11130000
111400                                                                  11140000
111500         PERFORM                                                  11150000
111600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       11160000
111700                                                                  11170000
111800             PERFORM 4410-READ-TEMP-STORAGE                       11180000
111900                                                                  11190000
112000             PERFORM 2141-CLEAR-SELECTED-INDS                     11200000
112100                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 11210000
112200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          11220000
112300                                                                  11230000
112400             PERFORM 5100-WRITE-TEMP-STORAGE                      11240000
112500                                                                  11250000
112600             ADD +1                TO PV-BLOCK-NUMBER             11260000
112700                                                                  11270000
112800         END-PERFORM                                              11280000
112900                                                                  11290000
113000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         11300000
113100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     11310000
113200                                                                  11320000
113300         PERFORM                                                  11330000
113400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       11340000
113500                   ASC-HIGHEST-BLOCK-WRITTEN                      11350000
113600                                                                  11360000
113700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          11370000
113800                                   TO PV-BLOCK-NUMBER             11380000
113900                                                                  11390000
114000             PERFORM 4410-READ-TEMP-STORAGE                       11400000
114100                                                                  11410000
114200             PERFORM 2141-CLEAR-SELECTED-INDS                     11420000
114300                 VARYING ASC-ITEM-SUB                             11430000
114400                 FROM 1 BY 1                                      11440000
114500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          11450000
114600                                                                  11460000
114700             PERFORM 5100-WRITE-TEMP-STORAGE                      11470000
114800                                                                  11480000
114900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      11490000
115000                                                                  11500000
115100         END-PERFORM                                              11510000
115200                                                                  11520000
115300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             11530000
115400                                   TO PV-BLOCK-NUMBER             11540000
115500                                                                  11550000
115600         PERFORM 4410-READ-TEMP-STORAGE                           11560000
115700     END-IF.                                                      11570000
115800                                                                  11580000
115900                                                                  11590000
116000     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 11600000
116100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.11610000
116200     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  11620000
116300                                                                  11630000
116400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        11640000
116500                                                                  11650000
116600 EJECT                                                            11660000
116700*----------------------------------------------------------------*11670000
116800*    MARK EACH ITEM AS BEING NOT SELECTED.                       *11680000
116900*----------------------------------------------------------------*11690000
117000                                                                  11700000
117100 2141-CLEAR-SELECTED-INDS.                                        11710000
117200                                                                  11720000
117300     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           11730000
117400             NOT EQUAL ZERO                                       11740000
117500         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          11750000
117600             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          11760000
117700                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    11770000
117800                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  11780000
117900                                   TO TRUE                        11790000
118000         END-IF                                                   11800000
118100     END-IF.                                                      11810000
118200                                                                  11820000
118300/                                                                 11830000
118400*----------------------------------------------------------------*11840000
118500*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *11850000
118600*  FOR ALL ITEMS.                                                *11860000
118700*----------------------------------------------------------------*11870000
118800                                                                  11880000
118900 2150-SELECT-ALL-ITEMS.                                           11890000
119000                                                                  11900000
119100     MOVE +1                       TO ASC-BLK-SUB.                11910000
119200                                                                  11920000
119300     PERFORM 2151-SET-SELECTED-INDS                               11930000
119400         VARYING ASC-ITEM-SUB                                     11940000
119500         FROM 1 BY 1                                              11950000
119600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11960000
119700                                                                  11970000
119800     ADD +1                        TO ASC-BLK-SUB.                11980000
119900                                                                  11990000
120000     PERFORM 2151-SET-SELECTED-INDS                               12000000
120100         VARYING ASC-ITEM-SUB                                     12010000
120200         FROM 1 BY 1                                              12020000
120300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12030000
120400                                                                  12040000
120500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               12050000
120600                                   TO PV-LIST-ITEM-NUMBER.        12060000
120700                                                                  12070000
120800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12080000
120900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12090000
121000                                                                  12100000
121100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12110000
121200        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    12120000
121300         MOVE +1                   TO ASC-BLK-SUB                 12130000
121400                                                                  12140000
121500         PERFORM 5100-WRITE-TEMP-STORAGE                          12150000
121600                                                                  12160000
121700         MOVE +1                   TO PV-BLOCK-NUMBER             12170000
121800                                                                  12180000
121900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12190000
122000             PV-FIRST-BLOCK-IN-ARRAY - 1                          12200000
122100                                                                  12210000
122200         PERFORM                                                  12220000
122300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       12230000
122400                                                                  12240000
122500             PERFORM 4410-READ-TEMP-STORAGE                       12250000
122600                                                                  12260000
122700             PERFORM 2151-SET-SELECTED-INDS                       12270000
122800                 VARYING ASC-ITEM-SUB                             12280000
122900                 FROM 1 BY 1                                      12290000
123000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12300000
123100                                                                  12310000
123200             PERFORM 5100-WRITE-TEMP-STORAGE                      12320000
123300                                                                  12330000
123400             ADD +1                TO PV-BLOCK-NUMBER             12340000
123500                                                                  12350000
123600         END-PERFORM                                              12360000
123700                                                                  12370000
123800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         12380000
123900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     12390000
124000                                                                  12400000
124100         PERFORM                                                  12410000
124200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       12420000
124300                   ASC-HIGHEST-BLOCK-WRITTEN                      12430000
124400                                                                  12440000
124500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          12450000
124600                                   TO PV-BLOCK-NUMBER             12460000
124700                                                                  12470000
124800             PERFORM 4410-READ-TEMP-STORAGE                       12480000
124900                                                                  12490000
125000             PERFORM 2151-SET-SELECTED-INDS                       12500000
125100                 VARYING ASC-ITEM-SUB                             12510000
125200                 FROM 1 BY 1                                      12520000
125300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12530000
125400                                                                  12540000
125500             PERFORM 5100-WRITE-TEMP-STORAGE                      12550000
125600                                                                  12560000
125700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      12570000
125800                                                                  12580000
125900         END-PERFORM                                              12590000
126000                                                                  12600000
126100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             12610000
126200                                   TO PV-BLOCK-NUMBER             12620000
126300                                                                  12630000
126400         PERFORM 4410-READ-TEMP-STORAGE                           12640000
126500     END-IF.                                                      12650000
126600                                                                  12660000
126700                                                                  12670000
126800     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             12680000
126900                       ASC-NUMBER-OF-SELECTED-ITEMS.              12690000
127000                                                                  12700000
127100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        12710000
127200                                                                  12720000
127300 EJECT                                                            12730000
127400*----------------------------------------------------------------*12740000
127500*    MARK EACH ITEM AS BEING SELECTED.                           *12750000
127600*----------------------------------------------------------------*12760000
127700                                                                  12770000
127800 2151-SET-SELECTED-INDS.                                          12780000
127900                                                                  12790000
128000     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           12800000
128100             NOT EQUAL ZERO                                       12810000
128200         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             12820000
128300             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             12830000
128400                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        12840000
128500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  12850000
128600                               TO  TRUE                           12860000
128700         END-IF                                                   12870000
128800     END-IF.                                                      12880000
128900******************************************************************12890000
129000** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **12900000
129100** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **12910000
129200******************************************************************12920000
129300 2200-MOVE-SCREEN-TO-COMMAREA.                                    12930000
129400                                                                  12940000
129500     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             12950000
129600     MOVE +1                       TO PV-SUB.                     12960000
129700*                                                                 12970000
129800     PERFORM 3100-SET-SUBSCRIPTS.                                 12980000
129900     IF  ASTRTITL > ZERO                                          12990000
130000         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          13000000
130100     ELSE                                                         13010000
130200         IF  ASTRTITF = DP015-ERASE-EOF                           13020000
130300             INITIALIZE ASC-START-ITEM-REQUEST                    13030000
130400         END-IF                                                   13040000
130500     END-IF.                                                      13050000
130600     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          13060000
130700         VARYING PV-SUB                                           13070000
130800         FROM 1 BY 1                                              13080000
130900         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      13090000
131000******************************************************************13100000
131100** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**13110000
131200******************************************************************13120000
131300 2210-MOVE-LINES-TO-COMMAREA.                                     13130000
131400     IF  MR-SELECTL (PV-SUB) > ZERO                               13140000
131500         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             13150000
131600         MOVE MR-SELECTI (PV-SUB)                                 13160000
131700                                   TO ASC-TEMP-SELECTED-SW        13170000
131800                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      13180000
131900     ELSE                                                         13190000
132000         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                13200000
132100                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     13210000
132200                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        13220000
132300                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      13230000
132400         END-IF                                                   13240000
132500     END-IF.                                                      13250000
132600     ADD +1                        TO ASC-ITEM-SUB.               13260000
132700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        13270000
132800         ADD +1                    TO ASC-BLK-SUB                 13280000
132900         MOVE +1                   TO ASC-ITEM-SUB                13290000
133000     END-IF.                                                      13300000
133100******************************************************************13310000
133200** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **13320000
133300** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **13330000
133400******************************************************************13340000
133500 3000-EDIT-DATA-IN-COMMAREA.                                      13350000
133600     SET PS-NO-ERROR               TO TRUE.                       13360000
133700     PERFORM 3200-RESET-ATTRIBUTES.                               13370000
133800     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     13380000
133900**                                                                13390000
134000* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              13400000
134100* EDITTING IS DONE FROM THE BOTTOM UP.                            13410000
134200**                                                                13420000
134300     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       13430000
134400         ASC-ITEMS-DISPLAYED - 1.                                 13440000
134500     PERFORM 3100-SET-SUBSCRIPTS.                                 13450000
134600     PERFORM 3300-EDIT-SELECTIONS                                 13460000
134700         VARYING PV-SUB                                           13470000
134800         FROM PV-SUB BY -1                                        13480000
134900         UNTIL PV-SUB < +1                                        13490000
135000*                                                                 13500000
135100     IF  PS-NO-ERROR                                              13510000
135200         PERFORM 3400-CHECK-RANGE-SEQUENCE                        13520000
135300     END-IF.                                                      13530000
135400*                                                                 13540000
135500     IF  ((PS-NO-ERROR)                                           13550000
135600       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   13560000
135700       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    13570000
135800             PERFORM 3500-MARK-RANGE-AS-SELECTED                  13580000
135900     END-IF.                                                      13590000
136000 EJECT                                                            13600000
136100*----------------------------------------------------------------*13610000
136200*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *13620000
136300*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*13630000
136400*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *13640000
136500*                                                                *13650000
136600*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *13660000
136700*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *13670000
136800*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *13680000
136900*    US IN THE 2ND BLOCK OF THE ARRAY.                           *13690000
137000*----------------------------------------------------------------*13700000
137100                                                                  13710000
137200 3100-SET-SUBSCRIPTS.                                             13720000
137300                                                                  13730000
137400     COMPUTE ASC-ITEM-SUB =                                       13740000
137500         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        13750000
137600                                                                  13760000
137700     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         13770000
137800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            13780000
137900                                                                  13790000
138000         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               13800000
138100     ELSE                                                         13810000
138200         MOVE +1                     TO ASC-BLK-SUB               13820000
138300     END-IF.                                                      13830000
138400******************************************************************13840000
138500** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **13850000
138600******************************************************************13860000
138700                                                                  13870000
138800 3200-RESET-ATTRIBUTES.                                           13880000
138900     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   13890000
139000     MOVE DP015-GREEN              TO ASTRTITC.                   13900000
139100     MOVE DP015-UNDERLINE          TO ASTRTITH.                   13910000
139200*                                                                 13920000
139300     PERFORM                                                      13930000
139400         VARYING PV-SUB                                           13940000
139500         FROM 1 BY 1                                              13950000
139600         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        13960000
139700         MOVE DP015-UNP-ALP-NOR-OFF                               13970000
139800                                   TO MR-SELECTA (PV-SUB)         13980000
139900         MOVE DP015-ASK-NOR-OFF    TO                             13990000
140000                                      MR-TRAILER-STAT-A (PV-SUB)  14000000
140100                                      MR-STAT-DATE-A (PV-SUB)     14010000
140200                                      MR-SCAC-A (PV-SUB)          14020000
140300                                      MR-TRAILER-ID-A (PV-SUB)    14030000
140400                                      MR-SERIAL-A (PV-SUB)        14040000
140500                                      MR-JEWELRY-A (PV-SUB)       14050000
140600                                      MR-AD-A (PV-SUB)            14060000
140700                                      MR-CARTONS-A (PV-SUB)       14070000
140800                                      MR-UNITS-A (PV-SUB)         14080000
140900*                                     MR-PCT-FULL-A (PV-SUB)      14090000
141000         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         14100000
141001* DMH                                                             14100112
141010         MOVE DP015-BLUE           TO MR-TRAILER-STAT-C (PV-SUB)  14101012
141020                                      MR-STAT-DATE-C    (PV-SUB)  14102012
141030* DMH                                                             14103012
141100         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         14110000
141200     END-PERFORM.                                                 14120000
141300******************************************************************14130000
141400** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **14140000
141500** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **14150000
141600** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **14160000
141700** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **14170000
141800******************************************************************14180000
141900 3300-EDIT-SELECTIONS.                                            14190000
142000     EVALUATE TRUE                                                14200000
142100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     14210000
142200             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         14220000
142300                 CONTINUE                                         14230000
142400         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         14240000
142500             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        14250000
142600                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   14260000
142700                 MOVE ASC-TEMP-SELECTED-SW                        14270000
142800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14280000
142900                                TO ASC-SELECTED-SW                14290000
143000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14300000
143100             END-IF                                               14310000
143200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     14320000
143300                 = SPACE                                          14330000
143400             EVALUATE TRUE                                        14340000
143500                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       14350000
143600                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS14360000
143700                     MOVE SPACE TO ASC-SELECTED-SW                14370000
143800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14380000
143900                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        14390000
144000                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    14400000
144100                     MOVE SPACE TO ASC-SELECTED-SW                14410000
144200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14420000
144300                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          14430000
144400                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      14440000
144500                     MOVE SPACE TO ASC-SELECTED-SW                14450000
144600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14460000
144700             END-EVALUATE                                         14470000
144800         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           14480000
144900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14490000
145000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14500000
145100             END-IF                                               14510000
145200             PERFORM 3310-EDIT-RANGE                              14520000
145300         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             14530000
145400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14540000
145500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14550000
145600             END-IF                                               14560000
145700             PERFORM 3310-EDIT-RANGE                              14570000
145800         WHEN OTHER                                               14580000
145900             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           14590000
146000             SET DP020-MSG-FATAL    TO TRUE                       14600000
146100             MOVE -1                TO MR-SELECTL (PV-SUB)        14610000
146200             SET DP030-SET-CURSOR-APPL-1                          14620000
146300                                    TO TRUE                       14630000
146400             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        14640000
146500             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        14650000
146600             SET PS-ERROR TO TRUE                                 14660000
146700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14670000
146800                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     14680000
146900                 MOVE SPACE         TO ASC-SELECTED-SW            14690000
147000                                        (ASC-BLK-SUB ASC-ITEM-SUB)14700000
147100             END-IF                                               14710000
147200     END-EVALUATE.                                                14720000
147300                                                                  14730000
147400     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 14740000
147500     SUBTRACT +1 FROM ASC-ITEM-SUB.                               14750000
147600     IF  ASC-ITEM-SUB < 1                                         14760000
147700         SUBTRACT +1 FROM ASC-BLK-SUB                             14770000
147800         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                14780000
147900     END-IF.                                                      14790000
148000                                                                  14800000
148100 3300A-EDIT-STATUS.                                               14810000
148200     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     14820000
148300         IF ASC-TRIP-STAT-CDE(ASC-BLK-SUB ASC-ITEM-SUB) =         14830000
148400                                                   'DS' OR 'SO'   14840000
148500             PERFORM 3300C-CHECK-4-INVENTORY                      14850000
148600             IF PS-ERROR                                          14860000
148700                 SET DP020-MSG-FATAL                              14870000
148800                     DP030-SET-CURSOR-APPL-1                      14880000
148900                     DP030-OVERRIDE-GO      TO TRUE               14890000
149000                 MOVE PC-TSYMSG-03412       TO DP020-MSG-NUMBER   14900000
149100                 MOVE -1                TO MR-SELECTL (PV-SUB)    14910000
149200                 MOVE DP015-RED         TO MR-SELECTC (PV-SUB)    14920000
149300                 MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)    14930000
149400                 IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        14940000
149500                     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS 14950000
149600                     MOVE SPACE         TO ASC-SELECTED-SW        14960000
149700                                        (ASC-BLK-SUB ASC-ITEM-SUB)14970000
149800                 END-IF                                           14980000
149900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14990000
150000             ELSE                                                 15000000
150100                 PERFORM 3300B-SELECT-TSUOBTR                     15010000
150200                 IF SUOBTR-OTBND-TRIP-ID =                        15020000
150300                      ASC-OTBND-TRIP-ID (ASC-BLK-SUB ASC-ITEM-SUB)15030000
150400                   AND                                            15040000
150500                      SUOBTS-TRIP-STAT-CDE =                      15050000
150600                      ASC-TRIP-STAT-CDE (ASC-BLK-SUB ASC-ITEM-SUB)15060000
150700* JAK 08/2007 - ADD ADDL CHECK                                    15070000
150701******                   CONTINUE                                 15070100
150710                         PERFORM 3300D-CHECK-NO-OTBND-UPD         15071000
150800                         IF PS-ERROR                              15080000
150802                            SET DP020-MSG-FATAL                   15080200
150803                                DP030-SET-CURSOR-APPL-1           15080300
150804                                DP030-OVERRIDE-GO      TO TRUE    15080400
150805                            MOVE PC-TSYMSG-03590                  15080500
150806                                              TO DP020-MSG-NUMBER 15080600
150807                            MOVE -1         TO MR-SELECTL (PV-SUB)15080700
150808                            MOVE DP015-RED                        15080800
150809                                            TO MR-SELECTC (PV-SUB)15080900
150810                            MOVE DP015-REVERSE                    15081000
150811                                            TO MR-SELECTH (PV-SUB)15081100
150812                            IF  ASC-SELECT                        15081200
150813                                    (ASC-BLK-SUB ASC-ITEM-SUB)    15081300
150814                               SUBTRACT 1 FROM                    15081400
150815                                      ASC-NUMBER-OF-SELECTED-ITEMS15081500
150816                               MOVE SPACE  TO ASC-SELECTED-SW     15081600
150817                                        (ASC-BLK-SUB ASC-ITEM-SUB)15081700
150818                            END-IF                                15081800
150819                            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN  15081900
150821                         ELSE                                     15082100
150822                             CONTINUE                             15082200
150830                         END-IF                                   15083000
150850                 ELSE                                             15085000
150900                     SET PS-ERROR                                 15090000
151000                         DP020-MSG-FATAL                          15100000
151100                         DP030-SET-CURSOR-APPL-1                  15110000
151200                         DP030-OVERRIDE-GO      TO TRUE           15120000
151300                     MOVE PC-TSYMSG-02816     TO DP020-MSG-NUMBER 15130000
151400                     MOVE -1                TO MR-SELECTL (PV-SUB)15140000
151500                     MOVE DP015-RED         TO MR-SELECTC (PV-SUB)15150000
151600                     MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)15160000
151700                     IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    15170000
151800                      SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS15180000
151900                      MOVE SPACE  TO ASC-SELECTED-SW              15190000
152000                                        (ASC-BLK-SUB ASC-ITEM-SUB)15200000
152100                     END-IF                                       15210000
152200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         15220000
152300                 END-IF                                           15230000
152400             END-IF                                               15240000
152500         ELSE                                                     15250000
152600             SET PS-ERROR                                         15260000
152700                 DP020-MSG-FATAL                                  15270000
152800                 DP030-SET-CURSOR-APPL-1                          15280000
152900                 DP030-OVERRIDE-GO      TO TRUE                   15290000
153000             MOVE PC-TSYMSG-02816         TO DP020-MSG-NUMBER     15300000
153100             MOVE -1                TO MR-SELECTL (PV-SUB)        15310000
153200             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        15320000
153300             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        15330000
153400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            15340000
153500                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     15350000
153600                 MOVE SPACE         TO ASC-SELECTED-SW            15360000
153700                                        (ASC-BLK-SUB ASC-ITEM-SUB)15370000
153800             END-IF                                               15380000
153900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15390000
154000         END-IF                                                   15400000
154100     END-IF.                                                      15410000
154200                                                                  15420000
154300     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 15430000
154400     SUBTRACT +1 FROM ASC-ITEM-SUB.                               15440000
154500     IF  ASC-ITEM-SUB < 1                                         15450000
154600         SUBTRACT +1 FROM ASC-BLK-SUB                             15460000
154700         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                15470000
154800     END-IF.                                                      15480000
154900                                                                  15490000
155000 3300B-SELECT-TSUOBTR.                                            15500000
155100     MOVE ASC-SERIAL(ASC-BLK-SUB ASC-ITEM-SUB) TO DK-TRLR-SRL-NBR.15510000
155200     EXEC SQL                                                     15520000
155300         SELECT  A.OTBND_TRIP_ID                                  15530000
155400              ,  B.TRIP_STAT_CDE                                  15540000
155500         INTO    :SUOBTR-OTBND-TRIP-ID                            15550000
155600              ,  :SUOBTS-TRIP-STAT-CDE                            15560000
155700           FROM  TSUOBTR A                                        15570000
155800              ,  TSUOBTS B                                        15580000
155900          WHERE  A.TRLR_SRL_NBR     = :DK-TRLR-SRL-NBR            15590000
156000            AND  A.TRIP_ACTV_CDE    = 'A'                         15600000
156100            AND  A.OTBND_TRIP_ID    = B.OTBND_TRIP_ID             15610000
156200            AND  B.OTBND_STAT_TMST  =                             15620000
156300             (SELECT  MAX(D.OTBND_STAT_TMST)                      15630000
156400                   FROM  TSUOBTR C                                15640000
156500                      ,  TSUOBTS D                                15650000
156600              WHERE  C.TRLR_SRL_NBR     = :DK-TRLR-SRL-NBR        15660000
156700                AND  C.TRIP_ACTV_CDE    = 'A'                     15670000
156800                AND  C.OTBND_TRIP_ID    = D.OTBND_TRIP_ID)        15680000
156900     END-EXEC.                                                    15690000
157000                                                                  15700000
157100     EVALUATE TRUE                                                15710000
157200         WHEN SQLCODE = ZERO                                      15720000
157300              CONTINUE                                            15730000
157400         WHEN SQLCODE = -904                                      15740000
157500         WHEN SQLCODE = -911                                      15750000
157600         WHEN SQLCODE = -913                                      15760000
157700             PERFORM 9900-SOFT-ABORT                              15770000
157800         WHEN SQLWARN0 NOT = SPACE                                15780000
157900         WHEN SQLCODE NOT = ZERO                                  15790000
158000              MOVE '3300B-SELECT-TSUOBTR'                         15800000
158100                               TO DP013-PARAGRAPH                 15810000
158200              MOVE 'SELECT '                                      15820000
158300                               TO DP013-MESSAGE-TEXT (1)          15830000
158400              MOVE DK-TRLR-SRL-NBR                                15840000
158500                               TO PV-TRLR-SRL-NBR                 15850000
158600              MOVE PV-TRLR-SRL-NBR                                15860000
158700                               TO DP013-MESSAGE-TEXT (2)          15870000
158800              MOVE SQLCA       TO DP013-SQLCA                     15880000
158900              SET DP013-DB2-ABEND                                 15890000
159000                               TO TRUE                            15900000
159100              PERFORM DP013-0000-PROCESS-ABEND                    15910000
159200     END-EVALUATE.                                                15920000
159300                                                                  15930000
159400****************************************************************  15940000
159500* IF A STORE IS PERFORMING AN INVENTORY TODAY, DO NOT ALLOW THEM  15950000
159600* TO UPDATE THE STATUS OF A TRAILER.                              15960000
159700****************************************************************  15970000
159800 3300C-CHECK-4-INVENTORY.                                         15980000
159900     MOVE ASC-STR-NBR  TO DK-STR-NBR.                             15990000
160000     EXEC SQL                                                     16000000
160100         SELECT  PLND_INV_DTE                                     16010000
160200         INTO    :XLT00025-PLND-INV-DTE                           16020000
160300           FROM  XLT_MDSE_INV_PARM                                16030000
160400          WHERE  LOC_NBR          =  :DK-STR-NBR                  16040000
160500            AND  SCN_INV_IND      = 'Y'                           16050000
160600            AND  SCHD_PHY_CNT_CDE = 'PI'                          16060000
160700            AND  PLND_INV_DTE     = CURRENT DATE                  16070000
160710            AND  ACTV_IND         = 'Y'                           16071000
160720            AND  LOC_INV_STAT_CDE = 'IN'                          16072000
160800     END-EXEC.                                                    16080000
160900                                                                  16090000
161000     EVALUATE TRUE                                                16100000
161100         WHEN SQLCODE = ZERO                                      16110000
161200              SET PS-ERROR  TO TRUE                               16120000
161300         WHEN SQLCODE = +100                                      16130000
161400              CONTINUE                                            16140000
161500         WHEN SQLCODE = -904                                      16150000
161600         WHEN SQLCODE = -911                                      16160000
161700         WHEN SQLCODE = -913                                      16170000
161800             PERFORM 9900-SOFT-ABORT                              16180000
161900         WHEN SQLWARN0 NOT = SPACE                                16190000
162000         WHEN SQLCODE NOT = ZERO                                  16200000
162100              MOVE '3300C-CHECK-4-INVENTORY'                      16210000
162200                               TO DP013-PARAGRAPH                 16220000
162300              MOVE 'SELECT '   TO DP013-MESSAGE-TEXT (1)          16230000
162400              MOVE DK-STR-NBR  TO PV-STR-NBR                      16240000
162500              MOVE PV-STR-NBR  TO DP013-MESSAGE-TEXT (2)          16250000
162600              MOVE SQLCA       TO DP013-SQLCA                     16260000
162700              SET DP013-DB2-ABEND  TO TRUE                        16270000
162800              PERFORM DP013-0000-PROCESS-ABEND                    16280000
162900     END-EVALUATE.                                                16290000
163000                                                                  16300000
163010* JAK 08/2007 - ADD PARAGRAPH 3300D                               16301000
163011****************************************************************  16301100
163020* IF A STORE IS SET UP FOR NO OUTBOUND UPDATE, DO NOT ALLOW THEM  16302000
163030* TO UPDATE THE STATUS OF A TRAILER.                              16303000
163040****************************************************************  16304000
163050 3300D-CHECK-NO-OTBND-UPD.                                        16305000
163060     MOVE ASC-STR-NBR  TO DK-STR-NBR.                             16306000
163070     EXEC SQL                                                     16307000
163080         SELECT  C.ATTR_ELEM_NBR                                  16308000
163090         INTO    :WST00010-ATTR-ELEM-NBR                          16309000
163091           FROM  WST_INTGRTN_TYP   A                              16309100
163092              ,  WST_ATTR_DEFN     B                              16309200
163093              ,  WST_ATTR_ELEM     C                              16309300
163094              ,  WST_ATTR_ELEM     D                              16309400
163095          WHERE  C.ATTR_ELEM_NBR      =  :DK-STR-NBR              16309500
163096            AND  A.INTGRTN_TYP_CDE    = 'NOOTBNDUPD'              16309600
163097            AND  A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE          16309700
163098            AND  B.ATTR_DEFN_SEQ_NBR  = 1                         16309800
163099            AND  B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE          16309900
163100            AND  C.ATTR_DEFN_SEQ_NBR  = 1                         16310000
163101            AND  B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE          16310100
163102            AND  D.ATTR_DEFN_SEQ_NBR  = 2                         16310200
163103            AND  C.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE          16310300
163104            AND  C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR        16310400
163105            AND  D.ATTR_ELEM_TMST    <= CURRENT TIMESTAMP         16310500
163106     END-EXEC.                                                    16310600
163107                                                                  16310700
163108     EVALUATE TRUE                                                16310800
163109         WHEN SQLCODE = ZERO                                      16310900
163110              SET PS-ERROR  TO TRUE                               16311000
163111         WHEN SQLCODE = +100                                      16311100
163112              CONTINUE                                            16311200
163113         WHEN SQLCODE = -904                                      16311300
163114         WHEN SQLCODE = -911                                      16311400
163115         WHEN SQLCODE = -913                                      16311500
163116             PERFORM 9900-SOFT-ABORT                              16311600
163117         WHEN SQLWARN0 NOT = SPACE                                16311700
163118         WHEN SQLCODE NOT = ZERO                                  16311800
163119              MOVE '3300D-CHECK-NO-OTBND-UPD'                     16311900
163120                               TO DP013-PARAGRAPH                 16312000
163121              MOVE 'SELECT '   TO DP013-MESSAGE-TEXT (1)          16312100
163122              MOVE DK-STR-NBR  TO PV-STR-NBR                      16312200
163123              MOVE PV-STR-NBR  TO DP013-MESSAGE-TEXT (2)          16312300
163124              MOVE SQLCA       TO DP013-SQLCA                     16312400
163125              SET DP013-DB2-ABEND  TO TRUE                        16312500
163126              PERFORM DP013-0000-PROCESS-ABEND                    16312600
163127     END-EVALUATE.                                                16312700
163128                                                                  16312800
163130******************************************************************16313000
163200** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **16320000
163300** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **16330000
163400** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**16340000
163500** THE ENDING.                                                  **16350000
163600******************************************************************16360000
163700 3310-EDIT-RANGE.                                                 16370000
163800     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                16380000
163900         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   16390000
164000             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)16400000
164100                                   TO ASC-SELECTED-SW             16410000
164200                                        (ASC-BLK-SUB ASC-ITEM-SUB)16420000
164300             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 16430000
164400         ELSE                                                     16440000
164500             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     16450000
164600                 CONTINUE                                         16460000
164700             ELSE                                                 16470000
164800*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        16480000
164900                 MOVE PC-TSYMSG-00054                             16490000
165000                                   TO DP020-MSG-NUMBER            16500000
165100                 SET DP020-MSG-FATAL                              16510000
165200                                   TO TRUE                        16520000
165300                 MOVE -1           TO MR-SELECTL (PV-SUB)         16530000
165400                 SET DP030-SET-CURSOR-APPL-1                      16540000
165500                                   TO TRUE                        16550000
165600                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         16560000
165700                 MOVE DP015-UNDERLINE                             16570000
165800                                   TO MR-SELECTH (PV-SUB)         16580000
165900                 SET PS-ERROR      TO TRUE                        16590000
166000             END-IF                                               16600000
166100         END-IF                                                   16610000
166200     ELSE                                                         16620000
166300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     16630000
166400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 16640000
166500                                   TO ASC-SELECTED-SW             16650000
166600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   16660000
166700             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   16670000
166800         ELSE                                                     16680000
166900             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       16690000
167000                 CONTINUE                                         16700000
167100             ELSE                                                 16710000
167200*                -- ONLY ONE END-OF-RANGE ALLOWED --              16720000
167300                 MOVE PC-TSYMSG-00055                             16730000
167400                                   TO DP020-MSG-NUMBER            16740000
167500                 SET DP020-MSG-FATAL                              16750000
167600                                   TO TRUE                        16760000
167700                 MOVE -1           TO MR-SELECTL (PV-SUB)         16770000
167800                 SET DP030-SET-CURSOR-APPL-1                      16780000
167900                                   TO TRUE                        16790000
168000                 SET PS-ERROR      TO TRUE                        16800000
168100             END-IF                                               16810000
168200         END-IF                                                   16820000
168300     END-IF.                                                      16830000
168400*                                                                 16840000
168500******************************************************************16850000
168600** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **16860000
168700** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **16870000
168800******************************************************************16880000
168900 3400-CHECK-RANGE-SEQUENCE.                                       16890000
169000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       16900000
169100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      16910000
169200       AND  ASC-START-OF-SELECTED-RANGE >                         16920000
169300                                         ASC-END-OF-SELECTED-RANGE16930000
169400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                16940000
169500         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 16950000
169600         SET DP020-MSG-FATAL TO TRUE                              16960000
169700         SET PS-ERROR TO TRUE                                     16970000
169800         PERFORM 3410-POSITION-AT-ERROR                           16980000
169900     END-IF.                                                      16990000
170000******************************************************************17000000
170100** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **17010000
170200** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **17020000
170300** SHOULD BE POSITIONED ON A RANGE ERROR.                       **17030000
170400******************************************************************17040000
170500 3410-POSITION-AT-ERROR.                                          17050000
170600     SET DP030-SET-CURSOR-APPL-1                                  17060000
170700                                   TO TRUE.                       17070000
170800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 17080000
170900                    - PV-TOP-ITEM + 1.                            17090000
171000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      17100000
171100         CONTINUE                                                 17110000
171200     ELSE                                                         17120000
171300         MOVE -1                   TO MR-SELECTL (PV-SUB)         17130000
171400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         17140000
171500         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         17150000
171600     END-IF.                                                      17160000
171700*                                                                 17170000
171800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   17180000
171900                    - PV-TOP-ITEM + 1.                            17190000
172000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      17200000
172100         CONTINUE                                                 17210000
172200     ELSE                                                         17220000
172300         MOVE -1                   TO MR-SELECTL (PV-SUB)         17230000
172400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         17240000
172500         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         17250000
172600     END-IF.                                                      17260000
172700 EJECT                                                            17270000
172800*----------------------------------------------------------------*17280000
172900*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *17290000
173000*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *17300000
173100*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *17310000
173200*----------------------------------------------------------------*17320000
173300                                                                  17330000
173400 3500-MARK-RANGE-AS-SELECTED.                                     17340000
173500     MOVE +1                       TO  ASC-BLK-SUB.               17350000
173600     PERFORM 3510-MARK-SELECTED-INDS                              17360000
173700         VARYING ASC-ITEM-SUB                                     17370000
173800         FROM 1 BY 1                                              17380000
173900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17390000
174000                                                                  17400000
174100     ADD +1                        TO ASC-BLK-SUB.                17410000
174200     PERFORM 3510-MARK-SELECTED-INDS                              17420000
174300         VARYING ASC-ITEM-SUB                                     17430000
174400         FROM 1 BY 1                                              17440000
174500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17450000
174600                                                                  17460000
174700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17470000
174800                                   TO  PV-LIST-ITEM-NUMBER.       17480000
174900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17490000
175000         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         17500000
175100               PC-ITEMS-PER-PANEL).                               17510000
175200                                                                  17520000
175300     MOVE ASC-START-OF-SELECTED-RANGE                             17530000
175400                                   TO PV-START-OF-SELECTED-RANGE. 17540000
175500     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            17550000
175600         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  17560000
175700               PC-ITEMS-PER-PANEL).                               17570000
175800                                                                  17580000
175900     MOVE ASC-END-OF-SELECTED-RANGE                               17590000
176000                                   TO  PV-END-OF-SELECTED-RANGE.  17600000
176100     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             17610000
176200         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    17620000
176300               PC-ITEMS-PER-PANEL).                               17630000
176400     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             17640000
176500         PV-FIRST-BLOCK-IN-ARRAY + 1.                             17650000
176600                                                                  17660000
176700     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    17670000
176800        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        17680000
176900         MOVE +1                   TO ASC-BLK-SUB                 17690000
177000         PERFORM 5100-WRITE-TEMP-STORAGE                          17700000
177100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17710000
177200             PV-FIRST-BLOCK-IN-ARRAY - 1                          17720000
177300                                                                  17730000
177400         PERFORM                                                  17740000
177500             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      17750000
177600                   PV-PREV-BLOCK-IN-ARRAY                         17760000
177700             MOVE PV-FIRST-BLOCK-IN-RANGE                         17770000
177800                                   TO PV-BLOCK-NUMBER             17780000
177900             PERFORM 4410-READ-TEMP-STORAGE                       17790000
178000             PERFORM 3510-MARK-SELECTED-INDS                      17800000
178100                 VARYING ASC-ITEM-SUB                             17810000
178200                 FROM 1 BY 1                                      17820000
178300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17830000
178400             PERFORM 5100-WRITE-TEMP-STORAGE                      17840000
178500             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     17850000
178600         END-PERFORM                                              17860000
178700                                                                  17870000
178800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17880000
178900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17890000
179000         PERFORM                                                  17900000
179100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17910000
179200                   PV-LAST-BLOCK-IN-RANGE                         17920000
179300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17930000
179400                                   TO PV-BLOCK-NUMBER             17940000
179500             PERFORM 4410-READ-TEMP-STORAGE                       17950000
179600             PERFORM 3510-MARK-SELECTED-INDS                      17960000
179700                 VARYING ASC-ITEM-SUB                             17970000
179800                 FROM 1 BY 1                                      17980000
179900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17990000
180000             PERFORM 5100-WRITE-TEMP-STORAGE                      18000000
180100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18010000
180200         END-PERFORM                                              18020000
180300                                                                  18030000
180400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18040000
180500                                   TO PV-BLOCK-NUMBER             18050000
180600         PERFORM 4410-READ-TEMP-STORAGE                           18060000
180700     END-IF.                                                      18070000
180800                                                                  18080000
180900     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 18090000
181000                                      ASC-END-OF-SELECTED-RANGE.  18100000
181100                                                                  18110000
181200/                                                                 18120000
181300*----------------------------------------------------------------*18130000
181400* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *18140000
181500*----------------------------------------------------------------*18150000
181600                                                                  18160000
181700 3510-MARK-SELECTED-INDS.                                         18170000
181800                                                                  18180000
181900     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         18190000
182000                                ASC-ITEM-SUB) >                   18200000
182100         ASC-START-OF-SELECTED-RANGE)                             18210000
182200     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         18220000
182300                                ASC-ITEM-SUB) =                   18230000
182400         ASC-START-OF-SELECTED-RANGE)                             18240000
182500                                                                  18250000
182600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     18260000
182700                                    ASC-ITEM-SUB) <               18270000
182800             ASC-END-OF-SELECTED-RANGE)                           18280000
182900         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     18290000
183000                                    ASC-ITEM-SUB) =               18300000
183100             ASC-END-OF-SELECTED-RANGE)                           18310000
183200                                                                  18320000
183300             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18330000
183400                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   18340000
183500                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   18350000
183600                               TO TRUE                            18360000
183700                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              18370000
183800                               TO TRUE                            18380000
183900                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    18390000
184000             END-IF                                               18400000
184100         END-IF                                                   18410000
184200     END-IF.                                                      18420000
184300                                                                  18430000
184400 EJECT                                                            18440000
184500*----------------------------------------------------------------*18450000
184600*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *18460000
184700*    INITIALIZE ALL COUNTERS AND FLAGS.                          *18470000
184800*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *18480000
184900*    DISPLAY THE PANEL TO USER.                                  *18490000
185000*----------------------------------------------------------------*18500000
185100                                                                  18510000
185200 4000-BUILD-INITIAL-PANEL.                                        18520000
185300                                                                  18530000
185400     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            18540000
185500                                 ASC-BLOCK-ENTRIES (2).           18550000
185600     MOVE +1                 TO ASC-BLK-SUB.                      18560000
185700     SET ASC-ITEMS-LEFT-ON-DB                                     18570000
185800                             TO TRUE.                             18580000
185900                                                                  18590000
186000     MOVE +0                 TO ASC-ITEM-SUB                      18600000
186100                                ASC-NUMBER-OF-ITEMS-READ          18610000
186200                                ASC-NUMBER-OF-SELECTED-ITEMS      18620000
186300                                ASC-HIGHEST-BLOCK-WRITTEN         18630000
186400                                ASC-START-OF-SELECTED-RANGE       18640000
186500                                ASC-END-OF-SELECTED-RANGE         18650000
186600                                ASC-ITEM-AT-TOP-OF-PANEL.         18660000
186700*    MOVE SU011-CURR-OPER-UNT-ID      TO ASC-CURR-OPER-UNT-ID     18670000
186800                                                                  18680000
186900     MOVE ASC-CURR-OPER-UNT-ID        TO ASTOREO.                 18690000
187000     MOVE ASC-STR-NAME                TO ASTNMEO.                 18700000
187100     MOVE ASC-STATUS-TITLE            TO ASTTYPO.                 18710000
187200     MOVE ASC-STATUS-CRIT-LIST        TO ATITLEO.                 18720000
187201                                                                  18720113
187202* DMH - 05/08/17 - BEGIN                                          18720213
187206     IF  ASC-DC-SHIP-GRTR-X-DAYS                                  18720614
187207         MOVE ASC-DC-SHIP-VALUE  TO PV-DISP-VALUE                 18720713
187210         STRING 'DC SHIPPED > '                                   18721013
187220                 PV-DISP-VALUE                                    18722013
187230                ' DAYS'             DELIMITED BY SIZE             18723013
187240                               INTO ADCSHMO                       18724013
187250         MOVE DP015-RED          TO ADCSHMC                       18725013
187251     END-IF.                                                      18725113
187252                                                                  18725213
187253     IF  ASC-STR-OPEN-GRTR-X-DAYS                                 18725313
187254         MOVE ASC-OPEN-STR-VALUE TO PV-DISP-VALUE                 18725413
187255         STRING 'STORE OPEN > '                                   18725513
187256                 PV-DISP-VALUE                                    18725613
187257                ' DAYS'             DELIMITED BY SIZE             18725713
187258                               INTO AOPSTMO                       18725813
187259         MOVE DP015-RED          TO AOPSTMC                       18725913
187260     END-IF.                                                      18726013
187262* DMH - 05/08/17 - END                                            18726213
187270                                                                  18727013
187300     PERFORM 4100-PREPARE-CURSOR                                  18730000
187400                                                                  18740000
187500     PERFORM 4010-OPEN-CURSOR.                                    18750000
187600                                                                  18760000
187700     PERFORM 4300-READ-ITEMS-FROM-DB.                             18770000
187800                                                                  18780000
187900     PERFORM 4020-CLOSE-CURSOR.                                   18790000
188000                                                                  18800000
188100*    SHOW AN EMPTY SCREEN IF CURSOR IS EMPTY                      18810000
188200*    PLACE THE CURSOR ON THE COMMAND LINE                         18820000
188300     MOVE +1                   TO  PV-TOP-ITEM.                   18830000
188400     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          18840000
188500         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    18850000
188600         SET DP020-MSG-FATAL   TO  TRUE                           18860000
188700         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               18870000
188800     ELSE                                                         18880000
188900         MOVE -1               TO MR-SELECTL (1)                  18890000
189000         SET DP030-SET-CURSOR-APPL-1                              18900000
189100                               TO TRUE                            18910000
189200         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     18920000
189300     END-IF.                                                      18930000
189400 EJECT                                                            18940000
189500                                                                  18950000
189600 4010-OPEN-CURSOR.                                                18960000
189700                                                                  18970000
189800     EVALUATE TRUE                                                18980000
189900         WHEN ASC-TRAILER-CSR                                     18990000
190000             MOVE 'CURSOR:  TRAILER CSR'                          19000000
190100                                   TO DP013-MESSAGE-TEXT (2)      19010000
190200             EXEC SQL                                             19020000
190300                 OPEN TRLR-STATUS-CSR                             19030000
190400             END-EXEC                                             19040000
190500                                                                  19050000
190600         WHEN ASC-STR-CSR                                         19060000
190700             MOVE 'CURSOR:  STORE CSR'                            19070000
190800                                   TO DP013-MESSAGE-TEXT (2)      19080000
190900             EXEC SQL                                             19090000
191000                 OPEN STR-UNLOAD-CSR                              19100000
191100             END-EXEC                                             19110000
191200                                                                  19120000
191300     END-EVALUATE                                                 19130000
191400                                                                  19140000
191500     EVALUATE TRUE                                                19150000
191600         WHEN SQLCODE = ZERO                                      19160000
191700             CONTINUE                                             19170000
191800         WHEN SQLCODE = -904                                      19180000
191900         WHEN SQLCODE = -911                                      19190000
192000         WHEN SQLCODE = -913                                      19200000
192100             PERFORM 9900-SOFT-ABORT                              19210000
192200         WHEN SQLWARN0 NOT = SPACES                               19220000
192300         WHEN SQLCODE < ZERO                                      19230000
192400         WHEN SQLCODE > ZERO                                      19240000
192500             MOVE '4010-OPEN-CURSOR'                              19250000
192600                                   TO DP013-PARAGRAPH             19260000
192700             MOVE 'OPEN TRAILER STATUS CURSOR - '                 19270000
192800                                   TO DP013-MESSAGE-TEXT (1)      19280000
192900             MOVE SQLCA        TO DP013-SQLCA                     19290000
193000             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        19300000
193100             MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)        19310000
193200             MOVE 'TSUOBSC '   TO DP013-DB2-TABLE-NAME (3)        19320000
193300             MOVE 'TCNTRID '   TO DP013-DB2-TABLE-NAME (4)        19330000
193400             SET DP013-DB2-ABEND                                  19340000
193500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               19350000
193600             PERFORM DP013-0000-PROCESS-ABEND                     19360000
193700     END-EVALUATE.                                                19370000
193800/                                                                 19380000
193900 4020-CLOSE-CURSOR.                                               19390000
194000     EVALUATE TRUE                                                19400000
194100         WHEN ASC-TRAILER-CSR                                     19410000
194200             EXEC SQL                                             19420000
194300                 CLOSE TRLR-STATUS-CSR                            19430000
194400             END-EXEC                                             19440000
194500         WHEN ASC-STR-CSR                                         19450000
194600             EXEC SQL                                             19460000
194700                 CLOSE STR-UNLOAD-CSR                             19470000
194800             END-EXEC                                             19480000
194900     END-EVALUATE.                                                19490000
195000*                                                                 19500000
195100     EVALUATE TRUE                                                19510000
195200         WHEN SQLCODE = ZERO                                      19520000
195300             CONTINUE                                             19530000
195400         WHEN SQLCODE = -904                                      19540000
195500         WHEN SQLCODE = -911                                      19550000
195600         WHEN SQLCODE = -913                                      19560000
195700             PERFORM 9900-SOFT-ABORT                              19570000
195800         WHEN SQLWARN0 NOT = SPACES                               19580000
195900         WHEN SQLCODE < ZERO                                      19590000
196000         WHEN SQLCODE > ZERO                                      19600000
196100             MOVE '4020-CLOSE-CURSOR'                             19610000
196200                               TO DP013-PARAGRAPH                 19620000
196300             MOVE 'CLOSE CURSOR '                                 19630000
196400                               TO DP013-MESSAGE-TEXT (1)          19640000
196500             MOVE SQLCA        TO DP013-SQLCA                     19650000
196600             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        19660000
196700             SET DP013-DB2-ABEND                                  19670000
196800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               19680000
196900             PERFORM DP013-0000-PROCESS-ABEND                     19690000
197000     END-EVALUATE.                                                19700000
197100                                                                  19710000
197200                                                                  19720001
197201*----------------------------------------------------------------*19720101
197202* GET THE NUMBER OF DAYS TO HIGHLIGHT FOR OPEN AT STORE          *19720201
197203* DMH 5/8/17                                                     *19720301
197204*----------------------------------------------------------------*19720401
197210 4050-GET-OPEN-STR-VALUE.                                         19721001
197211                                                                  19721101
197212     MOVE ZEROES  TO  ASC-OPEN-STR-VALUE.                         19721201
197216                                                                  19721601
197217     EXEC SQL                                                     19721701
197218           SELECT  FUNC_QTY                                       19721801
197223             INTO :ASC-OPEN-STR-VALUE                             19722301
197224             FROM  TKRPRPM                                        19722403
197228            WHERE LOC_ID            = 90                          19722801
197229              AND INTFC_SYS_CDE     = 'KHL'                       19722901
197230              AND SYS_PRC_FUNC_CDE  = 'TROPST'                    19723001
197231              AND FUNC_PRC_STAT_CDE = 'AC'                        19723104
197232              AND FUNC_BEG_TMST    <= CURRENT TIMESTAMP           19723201
197233              AND FUNC_END_TMST    >= CURRENT TIMESTAMP           19723301
197234             WITH UR                                              19723401
197237     END-EXEC.                                                    19723701
197238                                                                  19723801
197239     EVALUATE TRUE                                                19723901
197240         WHEN SQLCODE = ZERO                                      19724001
197241         WHEN SQLCODE = +100                                      19724101
197242              CONTINUE                                            19724201
197243         WHEN SQLCODE = -904                                      19724301
197244         WHEN SQLCODE = -911                                      19724401
197245         WHEN SQLCODE = -913                                      19724501
197246             PERFORM 9900-SOFT-ABORT                              19724601
197247         WHEN SQLWARN0 NOT = SPACE                                19724701
197248         WHEN SQLCODE NOT = ZERO                                  19724801
197249              MOVE '4050-GET-OPEN-STR-VALUE'                      19724901
197250                               TO DP013-PARAGRAPH                 19725001
197251              MOVE 'SELECT '                                      19725101
197252                               TO DP013-MESSAGE-TEXT (1)          19725201
197253              MOVE SQLCA       TO DP013-SQLCA                     19725301
197254              SET DP013-DB2-ABEND                                 19725401
197255                               TO TRUE                            19725501
197256              PERFORM DP013-0000-PROCESS-ABEND                    19725601
197257     END-EVALUATE.                                                19725701
197258                                                                  19725801
197259                                                                  19725901
197260*----------------------------------------------------------------*19726001
197261* GET THE NUMBER OF DAYS TO HIGHLIGHT FOR DC SHIPPED             *19726101
197262* DMH 5/8/17                                                     *19726201
197263*----------------------------------------------------------------*19726301
197264 4060-GET-DC-SHIP-VALUE.                                          19726401
197265                                                                  19726501
197266     MOVE ZEROES  TO  ASC-DC-SHIP-VALUE.                          19726601
197267                                                                  19726701
197268     EXEC SQL                                                     19726801
197269           SELECT  FUNC_QTY                                       19726901
197270             INTO :ASC-DC-SHIP-VALUE                              19727001
197271             FROM  TKRPRPM                                        19727103
197272            WHERE LOC_ID            = 90                          19727201
197273              AND INTFC_SYS_CDE     = 'KHL'                       19727301
197274              AND SYS_PRC_FUNC_CDE  = 'TRDCSH'                    19727401
197275              AND FUNC_PRC_STAT_CDE = 'AC'                        19727504
197276              AND FUNC_BEG_TMST    <= CURRENT TIMESTAMP           19727601
197277              AND FUNC_END_TMST    >= CURRENT TIMESTAMP           19727701
197278             WITH UR                                              19727801
197279     END-EXEC.                                                    19727901
197280                                                                  19728001
197281     EVALUATE TRUE                                                19728101
197282         WHEN SQLCODE = ZERO                                      19728201
197283         WHEN SQLCODE = +100                                      19728301
197284              CONTINUE                                            19728401
197285         WHEN SQLCODE = -904                                      19728501
197286         WHEN SQLCODE = -911                                      19728601
197287         WHEN SQLCODE = -913                                      19728701
197288             PERFORM 9900-SOFT-ABORT                              19728801
197289         WHEN SQLWARN0 NOT = SPACE                                19728901
197290         WHEN SQLCODE NOT = ZERO                                  19729001
197291              MOVE '4060-GET-DC-SHIP-VALUE'                       19729101
197292                               TO DP013-PARAGRAPH                 19729201
197293              MOVE 'SELECT '                                      19729301
197294                               TO DP013-MESSAGE-TEXT (1)          19729401
197295              MOVE SQLCA       TO DP013-SQLCA                     19729501
197296              SET DP013-DB2-ABEND                                 19729601
197297                               TO TRUE                            19729701
197298              PERFORM DP013-0000-PROCESS-ABEND                    19729801
197299     END-EVALUATE.                                                19729901
197300                                                                  19730001
197301                                                                  19730101
197302                                                                  19730201
197303                                                                  19730301
197310*----------------------------------------------------------------*19731000
197400*    SET UP THE HOST VARIABLES.                                  *19740000
197500*----------------------------------------------------------------*19750000
197600                                                                  19760000
197700 4100-PREPARE-CURSOR.                                             19770000
197800                                                                  19780000
197900     EVALUATE TRUE                                                19790000
198000         WHEN SU011-DC-OPEN-SEL                                   19800000
198100         WHEN SU011-DC-CLOSED-SEL                                 19810000
198200         WHEN SU011-DC-SHIPPED-SEL                                19820000
198300         WHEN SU011-STR-OPEN-SEL                                  19830000
198400             SET ASC-TRAILER-CSR      TO TRUE                     19840000
198500         WHEN SU011-STR-UNLD-SEL                                  19850000
198600             SET ASC-STR-CSR          TO TRUE                     19860000
198700     END-EVALUATE                                                 19870000
198800                                                                  19880000
198900     EVALUATE TRUE                                                19890000
199000     WHEN ASC-TRAILER-CSR                                         19900000
199100         IF SU011-DC-OPEN-SEL                                     19910000
199200             MOVE 'DO'                TO DK-STATUS-CODE-1         19920000
199300                                         DK-STATUS-CODE-2         19930000
199400                                         DK-STATUS-CODE-3         19940000
199500                                         DK-STATUS-CODE-4         19950000
199600                                         ASC-STATUS-CODE-1        19960000
199700                                         ASC-STATUS-CODE-2        19970000
199800                                         ASC-STATUS-CODE-3        19980000
199900                                         ASC-STATUS-CODE-4        19990000
200000         END-IF                                                   20000000
200100         IF SU011-DC-CLOSED-SEL                                   20010000
200200             MOVE 'DC'                TO DK-STATUS-CODE-2         20020000
200300                                         DK-STATUS-CODE-3         20030000
200400                                         ASC-STATUS-CODE-2        20040000
200500                                         ASC-STATUS-CODE-3        20050000
200600         END-IF                                                   20060000
200700                                                                  20070000
200800         IF SU011-DC-SHIPPED-SEL                                  20080000
200900             MOVE 'DS'                TO DK-STATUS-CODE-3         20090000
201000                                         DK-STATUS-CODE-4         20100000
201100                                         ASC-STATUS-CODE-3        20110000
201200                                         ASC-STATUS-CODE-4        20120000
201300         END-IF                                                   20130000
201400         IF SU011-STR-OPEN-SEL                                    20140000
201500             MOVE 'SO'                TO DK-STATUS-CODE-4         20150000
201600                                         ASC-STATUS-CODE-4        20160000
201700         END-IF                                                   20170000
201800     WHEN ASC-STR-CSR                                             20180000
201810       IF SU011-STR-UNLD-FROM-DATE  = ZEROS                       20181000
201820          MOVE ASC-FROM-DATE      TO DK-FROM-DATE                 20182000
201821          MOVE ASC-TO-DATE        TO DK-TO-DATE                   20182100
201830       ELSE                                                       20183000
201900          STRING                                                  20190000
202000                 SU011-STR-UNLD-FROM-CCYY '-'                     20200000
202100                 SU011-STR-UNLD-FROM-MM   '-'                     20210000
202200                 SU011-STR-UNLD-FROM-DD                           20220000
202300             DELIMITED BY SIZE INTO DK-FROM-DATE                  20230000
202400          STRING                                                  20240000
202500                 SU011-STR-UNLD-TO-CCYY    '-'                    20250000
202600                 SU011-STR-UNLD-TO-MM      '-'                    20260000
202700                 SU011-STR-UNLD-TO-DD                             20270000
202800             DELIMITED BY SIZE INTO DK-TO-DATE                    20280000
202801                                                                  20280100
202802                 MOVE DK-FROM-DATE  TO ASC-FROM-DATE              20280200
202803                 MOVE DK-TO-DATE    TO ASC-TO-DATE                20280300
202810       END-IF                                                     20281000
202900     END-EVALUATE.                                                20290000
203000/                                                                 20300000
203100*----------------------------------------------------------------*20310000
203200*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *20320000
203300*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *20330000
203400*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *20340000
203500*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *20350000
203600*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *20360000
203700*                                                                *20370000
203800*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *20380000
203900*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *20390000
204000*    UPON INITIALIZATION.                                        *20400000
204100*----------------------------------------------------------------*20410000
204200                                                                  20420000
204300 4300-READ-ITEMS-FROM-DB.                                         20430000
204400                                                                  20440000
204500     PERFORM                                                      20450000
204600         VARYING PV-READ-COUNT                                    20460000
204700         FROM 1 BY 1                                              20470000
204800         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    20480000
204900            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         20490000
205000                                                                  20500000
205100         PERFORM 4310-FETCH                                       20510000
205200                                                                  20520000
205300         IF  ASC-ITEMS-LEFT-ON-DB                                 20530000
205400             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                20540000
205500                 ADD +1            TO ASC-ITEM-SUB                20550000
205600             ELSE                                                 20560000
205700                 ADD +1            TO ASC-BLK-SUB                 20570000
205800                 MOVE +1           TO ASC-ITEM-SUB                20580000
205900                                                                  20590000
206000                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         20600000
206100                     MOVE +1       TO ASC-BLK-SUB                 20610000
206200                     SET ASC-BLOCK-MODIFIED (1)                   20620000
206300                                   TO TRUE                        20630000
206400                     PERFORM 5100-WRITE-TEMP-STORAGE              20640000
206500                     MOVE ASC-BLOCK-ENTRIES                       20650000
206600                               (PC-MAX-BLOCKS-IN-ARRAY)           20660000
206700                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 20670000
206800                     ADD +1        TO ASC-BLK-SUB                 20680000
206900                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   20690000
207000                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      20700000
207100                                   TO TRUE                        20710000
207200                 END-IF                                           20720000
207300             END-IF                                               20730000
207400             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    20740000
207500             PERFORM 4300A-MOVE-TO-COMMAREA                       20750000
207600         END-IF                                                   20760000
207700     END-PERFORM.                                                 20770000
207800                                                                  20780000
207900     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          20790000
208000         MOVE +1               TO ASC-BLK-SUB                     20800000
208100         PERFORM 5100-WRITE-TEMP-STORAGE                          20810000
208200         ADD +1                TO ASC-BLK-SUB                     20820000
208300         PERFORM 5100-WRITE-TEMP-STORAGE                          20830000
208400                                                                  20840000
208500         MOVE 1                TO ASC-BLK-SUB                     20850000
208600                                  PV-BLOCK-NUMBER                 20860000
208700         PERFORM 4410-READ-TEMP-STORAGE                           20870000
208800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             20880000
208900             MOVE 2            TO ASC-BLK-SUB                     20890000
209000                                  PV-BLOCK-NUMBER                 20900000
209100             PERFORM 4410-READ-TEMP-STORAGE                       20910000
209200         END-IF                                                   20920000
209300     END-IF.                                                      20930000
209400/                                                                 20940000
209500 4300A-MOVE-TO-COMMAREA.                                          20950000
209600                                                                  20960000
209700     MOVE ASC-NUMBER-OF-ITEMS-READ    TO ASC-LIST-ITEM-NUMBER     20970000
209800                                        (ASC-BLK-SUB ASC-ITEM-SUB)20980000
209900                                                                  20990000
210000     MOVE SUOBTR-OTBND-TRIP-ID        TO ASC-OTBND-TRIP-ID        21000000
210100                                        (ASC-BLK-SUB ASC-ITEM-SUB)21010000
210200     MOVE SUOBTR-TRLR-SRL-NBR         TO ASC-SERIAL               21020000
210300                                        (ASC-BLK-SUB ASC-ITEM-SUB)21030000
210400                                                                  21040000
210500*    MOVE SUOBTS-CPCTY-PCT            TO ASC-PCT-FULL             21050000
210600*                                      (ASC-BLK-SUB ASC-ITEM-SUB) 21060000
210700                                                                  21070000
210800     MOVE PV-USA-DATE (1:6)           TO PV-DB2-DATE              21080000
210900     MOVE PV-USA-DATE (9:2)           TO PV-DB2-YY                21090000
211000     MOVE PV-DB2-DATE                 TO ASC-STAT-DATE            21100000
211100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21110000
211200                                                                  21120000
211300     MOVE SUOBSC-STAT-SHRT-DESC       TO ASC-TRAILER-STAT         21130000
211400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21140000
211500                                                                  21150000
211600     MOVE CNTRID-SCAC-CDE             TO ASC-SCAC                 21160000
211700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21170000
211800                                                                  21180000
211900     MOVE CNTRID-TRLR-ID              TO ASC-TRAILER-ID           21190000
212000                                       (ASC-BLK-SUB ASC-ITEM-SUB).21200000
212100                                                                  21210000
212200     PERFORM 4300B-CTN-UNIT-COUNTS.                               21220000
212300     MOVE SUT00007-CART-QTY           TO ASC-CART-QTY             21230000
212400                                       (ASC-BLK-SUB ASC-ITEM-SUB).21240000
212500     MOVE SUT00007-UNT-QTY            TO ASC-UNT-QTY              21250000
212600                                       (ASC-BLK-SUB ASC-ITEM-SUB).21260000
212700     MOVE SUT00007-TRIP-OCRNC-ID      TO ASC-TRIP-OCRNC-ID        21270000
212800                                       (ASC-BLK-SUB ASC-ITEM-SUB).21280000
212900     MOVE SUT00007-CRE-TMST           TO ASC-CRE-TMST             21290000
213000                                       (ASC-BLK-SUB ASC-ITEM-SUB).21300000
213100     PERFORM 4300C-AD-DATES.                                      21310000
213200     IF PV-DB2-COUNT > ZERO                                       21320000
213300         MOVE 'Y'                     TO ASC-AD                   21330000
213400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21340000
213500     ELSE                                                         21350000
213600         MOVE SPACE                   TO ASC-AD                   21360000
213700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21370000
213800     END-IF.                                                      21380000
213900     MOVE SUOBTS-TRIP-STAT-CDE        TO ASC-TRIP-STAT-CDE        21390000
214000                                       (ASC-BLK-SUB ASC-ITEM-SUB).21400000
214010* DMH -  5/8/17 - BEGIN                                           21401007
214011     IF  SUOBTS-TRIP-STAT-CDE  = 'DS'                             21401107
214012         PERFORM 4300D-CALC-DS-DAYS                               21401207
214013         MOVE  PV-STATUS-DAYS         TO  ASC-STATUS-DAYS         21401307
214014                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21401407
214015     END-IF.                                                      21401509
214016                                                                  21401607
214017     IF  SUOBTS-TRIP-STAT-CDE  = 'SO'                             21401707
214018         PERFORM 4300E-CALC-SO-DAYS                               21401807
214019         MOVE  PV-STATUS-DAYS         TO  ASC-STATUS-DAYS         21401907
214020                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21402007
214021     END-IF.                                                      21402109
214030* DMH -  5/8/17 - END                                             21403007
214100                                                                  21410000
214200                                                                  21420000
214300 4300B-CTN-UNIT-COUNTS.                                           21430000
214400                                                                  21440000
214500     MOVE ASC-OTBND-TRIP-ID (ASC-BLK-SUB ASC-ITEM-SUB)            21450000
214600                                      TO DK-OTBND-TRIP-ID         21460000
214700                                                                  21470000
214800     INITIALIZE  SUT00007-TRIP-OCRNC-ID                           21480000
214900                 SUT00007-CART-QTY                                21490000
215000                 SUT00007-UNT-QTY                                 21500000
215100                 SUT00007-CRE-TMST.                               21510000
215200                                                                  21520000
215300     EXEC SQL                                                     21530000
215400         SELECT                                                   21540000
215500           A.TRIP_OCRNC_ID                                        21550000
215600        ,  A.CART_QTY                                             21560000
215700        ,  A.UNT_QTY                                              21570000
215800        ,  A.CRE_TMST                                             21580000
215900         INTO                                                     21590000
216000             :SUT00007-TRIP-OCRNC-ID                              21600000
216100        ,    :SUT00007-CART-QTY                                   21610000
216200        ,    :SUT00007-UNT-QTY                                    21620000
216300        ,    :SUT00007-CRE-TMST                                   21630000
216400         FROM                                                     21640000
216500           SUT_TRIP_SUM A                                         21650000
216600         WHERE                                                    21660000
216700           A.OTBND_TRIP_ID = :DK-OTBND-TRIP-ID                    21670000
216800         AND                                                      21680000
216900           A.CRE_TMST IN                                          21690000
217000            (SELECT MAX(B.CRE_TMST)                               21700000
217100             FROM SUT_TRIP_SUM B                                  21710000
217200           WHERE B.OTBND_TRIP_ID = A.OTBND_TRIP_ID)               21720000
217300     END-EXEC.                                                    21730000
217400                                                                  21740000
217500     EVALUATE TRUE                                                21750000
217600         WHEN SQLCODE = ZERO                                      21760000
217700         WHEN SQLCODE = +100                                      21770000
217800              CONTINUE                                            21780000
217900         WHEN SQLCODE = -904                                      21790000
218000         WHEN SQLCODE = -911                                      21800000
218100         WHEN SQLCODE = -913                                      21810000
218200             PERFORM 9900-SOFT-ABORT                              21820000
218300         WHEN SQLWARN0 NOT = SPACE                                21830000
218400         WHEN SQLCODE NOT = ZERO                                  21840000
218500              MOVE '4300B-CTN-UNIT-COUNTS'                        21850000
218600                               TO DP013-PARAGRAPH                 21860000
218700              MOVE 'SELECT '                                      21870000
218800                               TO DP013-MESSAGE-TEXT (1)          21880000
218900              MOVE SQLCA       TO DP013-SQLCA                     21890000
219000              SET DP013-DB2-ABEND                                 21900000
219100                               TO TRUE                            21910000
219200              PERFORM DP013-0000-PROCESS-ABEND                    21920000
219300     END-EVALUATE.                                                21930000
219400                                                                  21940000
219500 4300C-AD-DATES.                                                  21950000
219600                                                                  21960000
219700                                                                  21970000
219800     EXEC SQL                                                     21980000
219900         SELECT COUNT (*)                                         21990000
220000         INTO                                                     22000000
220100           :PV-DB2-COUNT                                          22010000
220200         FROM                                                     22020000
220300           SUT_MAJ_CL_AD_DTE A                                    22030000
220400         WHERE                                                    22040000
220500           A.TRIP_OCRNC_ID       = :SUT00007-TRIP-OCRNC-ID        22050000
220600         AND                                                      22060000
220700           (DATE(A.AD_EVNT_DTE) >= (CURRENT DATE - 5 DAYS))       22070000
220800           AND                                                    22080000
220900           (DATE(A.AD_EVNT_DTE) <= (CURRENT DATE + 5 DAYS))       22090000
221000     END-EXEC.                                                    22100000
221100                                                                  22110000
221200     EVALUATE TRUE                                                22120000
221300         WHEN SQLCODE = ZERO                                      22130000
221400         WHEN SQLCODE = +100                                      22140000
221500              CONTINUE                                            22150000
221600         WHEN SQLCODE = -904                                      22160000
221700         WHEN SQLCODE = -911                                      22170000
221800         WHEN SQLCODE = -913                                      22180000
221900             PERFORM 9900-SOFT-ABORT                              22190000
222000         WHEN SQLWARN0 NOT = SPACE                                22200000
222100         WHEN SQLCODE NOT = ZERO                                  22210000
222200              MOVE '4300C-AD-DATES'                               22220000
222300                               TO DP013-PARAGRAPH                 22230000
222400              MOVE 'SELECT '                                      22240000
222500                               TO DP013-MESSAGE-TEXT (1)          22250000
222600              MOVE SQLCA       TO DP013-SQLCA                     22260000
222700              SET DP013-DB2-ABEND                                 22270000
222800                               TO TRUE                            22280000
222900              PERFORM DP013-0000-PROCESS-ABEND                    22290000
223000     END-EVALUATE.                                                22300000
223001                                                                  22300107
223002                                                                  22300207
223003*----------------------------------------------------------------*22300307
223004* CALCULATE THE NUMBER IF DAYS THIS TRIP HAS BEEN IN DS STATUS   *22300407
223005* DMH 5/8/17                                                     *22300507
223006*----------------------------------------------------------------*22300607
223010 4300D-CALC-DS-DAYS.                                              22301007
223011                                                                  22301107
223012     MOVE ZEROES  TO   PV-STATUS-DAYS.                            22301207
223013                                                                  22301307
223022     EXEC SQL                                                     22302207
223023         SELECT DAYS(CURRENT TIMESTAMP) -                         22302307
223024                DAYS(E.OTBND_STAT_TMST)                           22302407
223025           INTO :PV-STATUS-DAYS                                   22302507
223026           FROM TSUOBTR D                                         22302607
223027              , TSUOBTS E                                         22302707
223028         WHERE  D.OTBND_TRIP_ID          = :DK-OTBND-TRIP-ID      22302808
223029           AND  D.OTBND_TRIP_ID          = E.OTBND_TRIP_ID        22302907
223030           AND  E.TRIP_STAT_CDE          = 'DS'                   22303007
223040           AND  E.OTBND_STAT_TMST IN                              22304019
223041                (SELECT MAX(EE.OTBND_STAT_TMST)                   22304119
223042                   FROM TSUOBTS EE                                22304219
223043                  WHERE EE.OTBND_TRIP_ID  =  E.OTBND_TRIP_ID      22304319
223044                    AND EE.TRIP_STAT_CDE  = 'DS')                 22304419
223045     END-EXEC.                                                    22304507
223046                                                                  22304607
223047     EVALUATE TRUE                                                22304707
223048         WHEN SQLCODE = ZERO                                      22304807
223049         WHEN SQLCODE = +100                                      22304907
223050              CONTINUE                                            22305007
223051         WHEN SQLCODE = -904                                      22305107
223052         WHEN SQLCODE = -911                                      22305207
223053         WHEN SQLCODE = -913                                      22305307
223054             PERFORM 9900-SOFT-ABORT                              22305407
223055         WHEN SQLWARN0 NOT = SPACE                                22305507
223056         WHEN SQLCODE NOT = ZERO                                  22305607
223057             MOVE DK-OTBND-TRIP-ID    TO  PV-DISP-TRIP            22305717
223058              MOVE '4300D-CALC-DS-DAYS'                           22305807
223059                               TO DP013-PARAGRAPH                 22305907
223060              MOVE 'SELECT DAYS TRIP IN DS STATUS'                22306018
223061                               TO DP013-MESSAGE-TEXT (1)          22306107
223062              MOVE SPACES TO DP013-MESSAGE-TEXT (2)               22306218
223063              STRING 'TRIP:'                                      22306317
223064                     PV-DISP-TRIP DELIMITED BY SIZE               22306417
223065                             INTO DP013-MESSAGE-TEXT (2)          22306517
223066              MOVE SQLCA       TO DP013-SQLCA                     22306617
223067              SET DP013-DB2-ABEND                                 22306717
223068                               TO TRUE                            22306817
223069              PERFORM DP013-0000-PROCESS-ABEND                    22306917
223070     END-EVALUATE.                                                22307017
223071                                                                  22307117
223072                                                                  22307217
223073*----------------------------------------------------------------*22307317
223074* CALCULATE THE NUMBER IF DAYS THIS TRIP HAS BEEN IN SO STATUS   *22307418
223075* DMH 5/8/17                                                     *22307517
223076*----------------------------------------------------------------*22307617
223077 4300E-CALC-SO-DAYS.                                              22307717
223078                                                                  22307817
223079     MOVE ZEROES  TO   PV-STATUS-DAYS.                            22307917
223080                                                                  22308017
223081     EXEC SQL                                                     22308117
223082         SELECT DAYS(CURRENT TIMESTAMP) -                         22308217
223083                DAYS(E.OTBND_STAT_TMST)                           22308317
223084           INTO :PV-STATUS-DAYS                                   22308417
223085           FROM TSUOBTR D                                         22308517
223086              , TSUOBTS E                                         22308617
223087         WHERE  D.OTBND_TRIP_ID          = :DK-OTBND-TRIP-ID      22308717
223088           AND  D.OTBND_TRIP_ID          = E.OTBND_TRIP_ID        22308817
223089           AND  E.TRIP_STAT_CDE          = 'SO'                   22308917
223090     END-EXEC.                                                    22309017
223091                                                                  22309117
223092     EVALUATE TRUE                                                22309217
223093         WHEN SQLCODE = ZERO                                      22309317
223094         WHEN SQLCODE = +100                                      22309417
223095              CONTINUE                                            22309517
223096         WHEN SQLCODE = -904                                      22309617
223097         WHEN SQLCODE = -911                                      22309717
223098         WHEN SQLCODE = -913                                      22309817
223099             PERFORM 9900-SOFT-ABORT                              22309917
223100         WHEN SQLWARN0 NOT = SPACE                                22310017
223101         WHEN SQLCODE NOT = ZERO                                  22310117
223102             MOVE DK-OTBND-TRIP-ID    TO  PV-DISP-TRIP            22310217
223103              MOVE '4300E-CALC-SO-DAYS'                           22310317
223104                               TO DP013-PARAGRAPH                 22310417
223105              MOVE 'SELECT DAYS TRIP IN SO STATUS'                22310518
223106                               TO DP013-MESSAGE-TEXT (1)          22310617
223107              MOVE SPACES TO DP013-MESSAGE-TEXT (2)               22310718
223108              STRING 'TRIP:'                                      22310817
223109                     PV-DISP-TRIP DELIMITED BY SIZE               22310917
223110                             INTO DP013-MESSAGE-TEXT (2)          22311017
223111              MOVE SQLCA       TO DP013-SQLCA                     22311117
223112              SET DP013-DB2-ABEND                                 22311217
223113                               TO TRUE                            22311317
223114              PERFORM DP013-0000-PROCESS-ABEND                    22311417
223115     END-EVALUATE.                                                22311517
223116                                                                  22311617
223117                                                                  22311717
223120*----------------------------------------------------------------*22312000
223200*    FETCH THE MESSAGE CURSOR.                                   *22320000
223300*----------------------------------------------------------------*22330000
223400                                                                  22340000
223500 4310-FETCH.                                                      22350000
223600                                                                  22360000
223700     EVALUATE TRUE                                                22370000
223800         WHEN ASC-TRAILER-CSR                                     22380000
223900              EXEC SQL                                            22390000
224000              FETCH TRLR-STATUS-CSR                               22400000
224100              INTO                                                22410000
224200                   :SUOBTR-OTBND-TRIP-ID                          22420000
224300                ,  :SUOBTR-TRLR-SRL-NBR                           22430000
224400                ,  :SUOBTR-ORGN-OPER-UNT-ID                       22440000
224500                ,  :SUOBTR-DEST-OPER-UNT-ID                       22450000
224600                ,  :SUOBTR-TRIP-ACTV-CDE                          22460000
224700*               ,  :SUOBTS-CPCTY-PCT                              22470000
224800                ,  :PV-USA-DATE                                   22480000
224900                ,  :SUOBTS-TRIP-STAT-CDE                          22490000
225000                ,  :SUOBSC-STAT-SHRT-DESC                         22500000
225100                ,  :SUOBSC-TRIP-STAT-DESC                         22510000
225200                ,  :CNTRID-SCAC-CDE                               22520000
225300                ,  :CNTRID-TRLR-ID                                22530000
225400              END-EXEC                                            22540000
225500         WHEN ASC-STR-CSR                                         22550000
225600              EXEC SQL                                            22560000
225700              FETCH STR-UNLOAD-CSR                                22570000
225800              INTO                                                22580000
225900                   :SUOBTR-OTBND-TRIP-ID                          22590000
226000                ,  :SUOBTR-TRLR-SRL-NBR                           22600000
226100                ,  :SUOBTR-ORGN-OPER-UNT-ID                       22610000
226200                ,  :SUOBTR-DEST-OPER-UNT-ID                       22620000
226300                ,  :SUOBTR-TRIP-ACTV-CDE                          22630000
226400*               ,  :SUOBTS-CPCTY-PCT                              22640000
226500                ,  :PV-USA-DATE                                   22650000
226600                ,  :SUOBTS-TRIP-STAT-CDE                          22660000
226700                ,  :SUOBSC-STAT-SHRT-DESC                         22670000
226800                ,  :SUOBSC-TRIP-STAT-DESC                         22680000
226900                ,  :CNTRID-SCAC-CDE                               22690000
227000                ,  :CNTRID-TRLR-ID                                22700000
227100              END-EXEC                                            22710000
227200                                                                  22720000
227300     END-EVALUATE.                                                22730000
227400                                                                  22740000
227500     EVALUATE TRUE                                                22750000
227600         WHEN SQLCODE = ZERO                                      22760000
227700         WHEN SQLCODE = +100                                      22770000
227800              CONTINUE                                            22780000
227900         WHEN SQLCODE = -904                                      22790000
228000         WHEN SQLCODE = -911                                      22800000
228100         WHEN SQLCODE = -913                                      22810000
228200             PERFORM 9900-SOFT-ABORT                              22820000
228300         WHEN SQLWARN0 NOT = SPACE                                22830000
228400         WHEN SQLCODE NOT = ZERO                                  22840000
228500              MOVE '4310-FETCH-CURSOR'                            22850000
228600                               TO DP013-PARAGRAPH                 22860000
228700              MOVE 'FETCH MESSAGE CURSOR'                         22870000
228800                               TO DP013-MESSAGE-TEXT (1)          22880000
228900              MOVE SQLCA       TO DP013-SQLCA                     22890000
229000              SET DP013-DB2-ABEND                                 22900000
229100                               TO TRUE                            22910000
229200              PERFORM DP013-0000-PROCESS-ABEND                    22920000
229300     END-EVALUATE.                                                22930000
229400                                                                  22940000
229500     IF  SQLCODE EQUAL +100                                       22950000
229600         SET ASC-NO-ITEMS-LEFT-ON-DB                              22960000
229700                                   TO TRUE                        22970000
229800     END-IF.                                                      22980000
229900                                                                  22990000
230000 EJECT                                                            23000000
230100*----------------------------------------------------------------*23010000
230200* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *23020000
230300*----------------------------------------------------------------*23030000
230400                                                                  23040000
230500 4400-MOVE-COMMAREA-TO-SCREEN.                                    23050000
230600     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             23060000
230700         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          23070000
230800         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          23080000
230900             MOVE +1    TO ASC-BLK-SUB                            23090000
231000             PERFORM 5100-WRITE-TEMP-STORAGE                      23100000
231100             ADD +1     TO ASC-BLK-SUB                            23110000
231200             PERFORM 5100-WRITE-TEMP-STORAGE                      23120000
231300             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             23130000
231400                 GIVING PV-BLOCK-NUMBER                           23140000
231500                 REMAINDER PV-REMAINDER                           23150000
231600             IF  PV-REMAINDER > ZERO                              23160000
231700                 ADD +1 TO PV-BLOCK-NUMBER                        23170000
231800             END-IF                                               23180000
231900             MOVE +1    TO ASC-BLK-SUB                            23190000
232000             PERFORM 4410-READ-TEMP-STORAGE                       23200000
232100             ADD +1     TO ASC-BLK-SUB                            23210000
232200                           PV-BLOCK-NUMBER                        23220000
232300             PERFORM 4410-READ-TEMP-STORAGE                       23230000
232400     END-IF.                                                      23240000
232500     MOVE +1            TO ASC-BLK-SUB.                           23250000
232600     COMPUTE ASC-ITEM-SUB =                                       23260000
232700         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              23270000
232800         + PC-ITEMS-PER-PANEL).                                   23280000
232900*                                                                 23290000
233000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        23300000
233100         ADD +1         TO ASC-BLK-SUB                            23310000
233200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            23320000
233300     END-IF.                                                      23330000
233400*                                                                 23340000
233500     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           23350000
233600         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                23360000
233700     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        23370000
233800     PERFORM 4420-FORMAT-LIST-LINES                               23380000
233900         VARYING PV-SUB                                           23390000
234000         FROM PC-ITEMS-PER-PANEL BY -1                            23400000
234100         UNTIL PV-SUB < +1.                                       23410000
234200*                                                                 23420000
234300     COMPUTE ASC-ITEMS-DISPLAYED =                                23430000
234400         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          23440000
234500     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    23450000
234600                                      ASTRTITO.                   23460000
234700     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    23470000
234800     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    23480000
234900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            23490000
235000                                   TO ASELITO.                    23500000
235100*                                                                 23510000
235200     IF  DP020-MSG-NUMBER-X = SPACE                               23520000
235300         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  23530000
235400*            --- MORE ITEMS TO DISPLAY ----                       23540000
235500             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            23550000
235600             SET DP020-MSG-INFORMATIONAL TO TRUE                  23560000
235700         END-IF                                                   23570000
235800     END-IF.                                                      23580000
235900     MOVE ASC-CURR-OPER-UNT-ID        TO ASTOREO.                 23590000
236000     MOVE ASC-STR-NAME                TO ASTNMEO.                 23600000
236100     MOVE ASC-STATUS-TITLE            TO ASTTYPO.                 23610000
236200     MOVE ASC-STATUS-CRIT-LIST        TO ATITLEO.                 23620000
236300*----------------------------------------------------------------*23630000
236400*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *23640000
236500*----------------------------------------------------------------*23650000
236600                                                                  23660000
236700 4410-READ-TEMP-STORAGE.                                          23670000
236800                                                                  23680000
236900     EXEC CICS                                                    23690000
237000         READQ TS                                                 23700000
237100             QUEUE (ASC-LIST-QUEUE-NAME)                          23710000
237200             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               23720000
237300             ITEM  (PV-BLOCK-NUMBER)                              23730000
237400             RESP  (PV-CICS-RESP)                                 23740000
237500     END-EXEC.                                                    23750000
237600                                                                  23760000
237700     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       23770000
237800       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     23780000
237900         CONTINUE                                                 23790000
238000     ELSE                                                         23800000
238100         SET DP013-CICS-ABEND     TO TRUE                         23810000
238200         SET DP013-NO-ROLLBACK    TO TRUE                         23820000
238300         MOVE '4410-READ-TEMP-STORAGE'                            23830000
238400                                  TO DP013-PARAGRAPH              23840000
238500         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      23850000
238600                                  TO DP013-MESSAGE-TEXT(1)        23860000
238700         PERFORM DP013-0000-PROCESS-ABEND                         23870000
238800     END-IF.                                                      23880000
238900                                                                  23890000
239000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             23900000
239100*                                                                 23910000
239200     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         23920000
239300         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               23930000
239400     END-IF.                                                      23940000
239500 EJECT                                                            23950000
239600*----------------------------------------------------------------*23960000
239700*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *23970000
239800*----------------------------------------------------------------*23980000
239900                                                                  23990000
240000 4420-FORMAT-LIST-LINES.                                          24000000
240100     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      24010000
240200         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                24020000
240300         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           24030000
240400                                    MR-TRAILER-STAT-A (PV-SUB)    24040000
240500                                    MR-STAT-DATE-A (PV-SUB)       24050000
240600                                    MR-SCAC-A (PV-SUB)            24060000
240700                                    MR-TRAILER-ID-A (PV-SUB)      24070000
240800                                    MR-SERIAL-A (PV-SUB)          24080000
240900                                    MR-JEWELRY-A (PV-SUB)         24090000
241000                                    MR-AD-A (PV-SUB)              24100000
241100                                    MR-CARTONS-A (PV-SUB)         24110000
241200                                    MR-UNITS-A (PV-SUB)           24120000
241300*                                   MR-PCT-FULL-A (PV-SUB)        24130000
241400                                                                  24140000
241500         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           24150000
241501                                                                  24150107
241510         MOVE DP015-BLUE         TO MR-TRAILER-STAT-C (PV-SUB)    24151007
241520                                    MR-STAT-DATE-C    (PV-SUB)    24152007
241600                                                                  24160000
241700         MOVE SPACE              TO MR-SELECTI (PV-SUB)           24170000
241800                                    MR-ACTION (PV-SUB)            24180000
241900     ELSE                                                         24190000
242000         PERFORM 4420A-FILL-SCREEN                                24200000
242100*                                                                 24210000
242200         IF  DP030-SET-CURSOR-TRAILER                             24220000
242300             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)24230000
242400                 > SPACE)                                         24240000
242500               OR (PV-SUB = 1))                                   24250000
242600                SET DP030-SET-CURSOR-APPL-1 TO TRUE               24260000
242700                MOVE -1          TO MR-SELECTL (PV-SUB)           24270000
242800             END-IF                                               24280000
242900         END-IF                                                   24290000
243000*                                                                 24300000
243100         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           24310000
243200             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           24320000
243300                                 TO MR-ACTION (PV-SUB)            24330000
243400         END-IF                                                   24340000
243500     END-IF.                                                      24350000
243600     SUBTRACT +1 FROM ASC-ITEM-SUB                                24360000
243700     IF  ASC-ITEM-SUB < + 1                                       24370000
243800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  24380000
243900         MOVE +1                 TO ASC-BLK-SUB                   24390000
244000     END-IF.                                                      24400000
244100                                                                  24410000
244200 4420A-FILL-SCREEN.                                               24420000
244300     IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)          24430000
244400                                                   > SPACE        24440000
244500         MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     24450000
244600                                 TO MR-SELECTI (PV-SUB)           24460000
244700     ELSE                                                         24470000
244800         MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)          24480000
244900                                 TO MR-SELECTI (PV-SUB)           24490000
245000     END-IF                                                       24500000
245100                                                                  24510000
245200     MOVE ASC-SERIAL(ASC-BLK-SUB ASC-ITEM-SUB)                    24520000
245300                                      TO MR-SERIAL(PV-SUB)        24530000
245400                                                                  24540000
245500*    MOVE ASC-PCT-FULL(ASC-BLK-SUB ASC-ITEM-SUB)                  24550000
245600*                                     TO MR-PCT-FULL(PV-SUB)      24560000
245700                                                                  24570000
245800     MOVE ASC-STAT-DATE(ASC-BLK-SUB ASC-ITEM-SUB)                 24580000
245900                                      TO MR-STAT-DATE(PV-SUB)     24590000
246000                                                                  24600000
246100     MOVE ASC-TRAILER-STAT(ASC-BLK-SUB ASC-ITEM-SUB)              24610000
246200                                      TO MR-TRAILER-STAT(PV-SUB)  24620000
246300                                                                  24630000
246400     MOVE ASC-SCAC(ASC-BLK-SUB ASC-ITEM-SUB)                      24640000
246500                                      TO MR-SCAC(PV-SUB)          24650000
246600                                                                  24660000
246700     MOVE ASC-TRAILER-ID(ASC-BLK-SUB ASC-ITEM-SUB)                24670000
246800                                      TO MR-TRAILER-ID(PV-SUB).   24680000
246900     MOVE ASC-CART-QTY(ASC-BLK-SUB ASC-ITEM-SUB)                  24690000
247000                                      TO MR-CARTONS(PV-SUB).      24700000
247100     MOVE ASC-UNT-QTY(ASC-BLK-SUB ASC-ITEM-SUB)                   24710000
247200                                      TO MR-UNITS(PV-SUB).        24720000
247300     MOVE ASC-AD(ASC-BLK-SUB ASC-ITEM-SUB)                        24730000
247400                                      TO MR-AD(PV-SUB).           24740000
247500                                                                  24750000
247600     MOVE ASC-JEWELRY(ASC-BLK-SUB ASC-ITEM-SUB)                   24760000
247700                                      TO MR-JEWELRY (PV-SUB).     24770000
247710                                                                  24771007
247720* DMH - 5/8/17 - BEGIN                                            24772007
247721     IF  ASC-TRIP-STAT-CDE (ASC-BLK-SUB ASC-ITEM-SUB) = 'DS' AND  24772107
247723         ASC-STATUS-DAYS (ASC-BLK-SUB ASC-ITEM-SUB)  >            24772316
247724         ASC-DC-SHIP-VALUE                                        24772407
247725         MOVE DP015-RED          TO MR-TRAILER-STAT-C (PV-SUB)    24772507
247726                                    MR-STAT-DATE-C    (PV-SUB)    24772607
247727         MOVE ASC-DC-SHIP-VALUE  TO PV-DISP-VALUE                 24772707
247728         STRING 'DC SHIPPED > '                                   24772807
247729                 PV-DISP-VALUE                                    24772907
247730                ' DAYS'             DELIMITED BY SIZE             24773007
247731                               INTO ADCSHMO                       24773107
247732         MOVE DP015-RED          TO ADCSHMC                       24773207
247733     END-IF.                                                      24773310
247734                                                                  24773407
247735     IF  ASC-TRIP-STAT-CDE (ASC-BLK-SUB ASC-ITEM-SUB) = 'SO' AND  24773507
247736         ASC-STATUS-DAYS (ASC-BLK-SUB ASC-ITEM-SUB)  >            24773616
247737         ASC-OPEN-STR-VALUE                                       24773709
247738         MOVE DP015-RED          TO MR-TRAILER-STAT-C (PV-SUB)    24773807
247739                                    MR-STAT-DATE-C    (PV-SUB)    24773907
247740         MOVE ASC-OPEN-STR-VALUE TO PV-DISP-VALUE                 24774013
247741         STRING 'STORE OPEN > '                                   24774107
247742                 PV-DISP-VALUE                                    24774207
247743                ' DAYS'             DELIMITED BY SIZE             24774307
247744                               INTO AOPSTMO                       24774407
247745         MOVE DP015-RED          TO AOPSTMC                       24774507
247746     END-IF.                                                      24774610
247747* DMH - 5/8/17 - BEGIN                                            24774707
247748                                                                  24774807
247750                                                                  24775007
247800                                                                  24780000
247900                                                                  24790000
248000******************************************************************24800000
248100** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **24810000
248200** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **24820000
248300** ISSUE A WARNING.                                             **24830000
248400******************************************************************24840000
248500 4430-CHECK-FOR-BEGIN-AND-END.                                    24850000
248600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       24860000
248700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     24870000
248800*            -- NO END-OF-RANGE SPECFIED ---                      24880000
248900             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            24890000
249000             SET DP020-MSG-WARNING TO TRUE                        24900000
249100             PERFORM 4431-POSITION-AT-WARNING                     24910000
249200         END-IF                                                   24920000
249300     ELSE                                                         24930000
249400         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     24940000
249500*            -- NO BEGINNING-OF-RANGE SPECFIED ---                24950000
249600             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            24960000
249700             SET DP020-MSG-WARNING TO TRUE                        24970000
249800             PERFORM 4431-POSITION-AT-WARNING                     24980000
249900         END-IF                                                   24990000
250000     END-IF.                                                      25000000
250100******************************************************************25010000
250200** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **25020000
250300** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **25030000
250400** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **25040000
250500** POSITION THE CURSOR THERE.                                   **25050000
250600******************************************************************25060000
250700 4431-POSITION-AT-WARNING.                                        25070000
250800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 25080000
250900                    - PV-TOP-ITEM + 1.                            25090000
251000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25100000
251100         CONTINUE                                                 25110000
251200     ELSE                                                         25120000
251300         SET DP030-SET-CURSOR-APPL-1                              25130000
251400                                   TO TRUE                        25140000
251500         MOVE -1                   TO MR-SELECTL (PV-SUB)         25150000
251600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25160000
251700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         25170000
251800     END-IF.                                                      25180000
251900*                                                                 25190000
252000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   25200000
252100                    - PV-TOP-ITEM + 1.                            25210000
252200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25220000
252300         CONTINUE                                                 25230000
252400     ELSE                                                         25240000
252500         SET DP030-SET-CURSOR-APPL-1                              25250000
252600                                   TO TRUE                        25260000
252700         MOVE -1                   TO MR-SELECTL (PV-SUB)         25270000
252800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25280000
252900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         25290000
253000     END-IF.                                                      25300000
253100 EJECT                                                            25310000
253200*----------------------------------------------------------------*25320000
253300* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *25330000
253400* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *25340000
253500* FOR THE SELECTED ITEMS QUEUE.                                  *25350000
253600*                                                                *25360000
253700* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *25370000
253800* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *25380000
253900* THE ARRAY IS FULL.                                             *25390000
254000*----------------------------------------------------------------*25400000
254100                                                                  25410000
254200 5000-PREPARE-SEL-QUEUE.                                          25420000
254300                                                                  25430000
254400     MOVE +1                   TO  ASC-BLK-SUB.                   25440000
254500     PERFORM 5100-WRITE-TEMP-STORAGE.                             25450000
254600     ADD +1                    TO  ASC-BLK-SUB.                   25460000
254700     PERFORM 5100-WRITE-TEMP-STORAGE.                             25470000
254800                                                                  25480000
254900     MOVE ASC-SEL-QUEUE-NAME-2 TO  ASC-SEL-QUEUE-NAME.            25490026
254910     MOVE ASC-SEL-QUEUE-NAME   TO  SU012-SEL-QUEUE-NAME.          25491026
255000     PERFORM 6010-DELETE-SEL-QUEUE.                               25500000
255100                                                                  25510000
255200     SET ASC-UPDATE-TSQ        TO  TRUE.                          25520000
255300                                                                  25530000
255400     SET SU013-IDX             TO  1.                             25540000
255500     MOVE ZERO                 TO SU012-NUMBER-OF-TS-ITEMS.       25550000
255600     INITIALIZE SU013-SELECTED-ITEM-ARRAY.                        25560000
255700                                                                  25570000
255800     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           25580000
255900             VARYING PV-ITEM                                      25590000
256000             FROM 1 BY 1                                          25600000
256100             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     25610000
256200                                                                  25620000
256300     IF  SU013-IDX > 1                                            25630000
256400         PERFORM 5205-WRITE-SEL-QUEUE                             25640000
256500         ADD +1                TO SU012-NUMBER-OF-TS-ITEMS        25650000
256600     END-IF.                                                      25660000
256601                                                                  25660120
256602*----------------------------------------------------------------*25660220
256603* PREPARE SELECTION QUEUE TO NAVIGATE TO ASSOCIATE LIST SCREEN   *25660320
256604* DMH 5/17/18                                                    *25660420
256605*----------------------------------------------------------------*25660520
256610 5010-PREPARE-SEL-QUEUE.                                          25661020
256620                                                                  25662020
256630     MOVE +1                   TO  ASC-BLK-SUB.                   25663020
256640     PERFORM 5100-WRITE-TEMP-STORAGE.                             25664020
256650     ADD +1                    TO  ASC-BLK-SUB.                   25665020
256660     PERFORM 5100-WRITE-TEMP-STORAGE.                             25666020
256670                                                                  25667020
256680     MOVE ASC-SEL-QUEUE-NAME   TO  SU009-SEL-QUEUE-NAME.          25668020
256690     PERFORM 6010-DELETE-SEL-QUEUE.                               25669020
256691                                                                  25669120
256692     SET ASC-UPDATE-TSQ        TO  TRUE.                          25669220
256693                                                                  25669320
256694     SET SU013-IDX             TO  1.                             25669420
256695     MOVE ZERO                 TO SU009-NUMBER-OF-TS-ITEMS.       25669520
256696     INITIALIZE SU010-SELECTED-ITEM-ARRAY.                        25669620
256697                                                                  25669720
256698     PERFORM 5210-FILL-SEL-QUEUE-RECORD                           25669820
256699             VARYING PV-ITEM                                      25669920
256700             FROM 1 BY 1                                          25670020
256701             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     25670120
256702                                                                  25670220
256703     IF  SU010-IDX > 1                                            25670320
256704         PERFORM 5215-WRITE-SEL-QUEUE                             25670421
256705         ADD +1                TO SU009-NUMBER-OF-TS-ITEMS        25670520
256706     END-IF.                                                      25670620
256707                                                                  25670720
256708                                                                  25670820
256710                                                                  25671020
256800*----------------------------------------------------------------*25680000
256900*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *25690000
257000*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *25700000
257100*----------------------------------------------------------------*25710000
257200                                                                  25720000
257300 5100-WRITE-TEMP-STORAGE.                                         25730000
257400     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     25740000
257500                                   TO PV-LIST-ITEM-NUMBER.        25750000
257600     COMPUTE PV-BLOCK-NUMBER =                                    25760000
257700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    25770000
257800                                                                  25780000
257900     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             25790000
258000     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             25800000
258100         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      25810000
258200             PERFORM 5105-REWRITE-ASC-LISTQ                       25820000
258300         END-IF                                                   25830000
258400     ELSE                                                         25840000
258500         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       25850000
258600         ASC-HIGHEST-BLOCK-WRITTEN + 1                            25860000
258700         PERFORM 5110-WRITE-ASC-LISTQ                             25870000
258800         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   25880000
258900     END-IF.                                                      25890000
259000                                                                  25900000
259100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             25910000
259200******************************************************************25920000
259300** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **25930000
259400** SPECIFIC COMMAREA.                                           **25940000
259500******************************************************************25950000
259600 5105-REWRITE-ASC-LISTQ.                                          25960000
259700     EXEC CICS                                                    25970000
259800         WRITEQ TS                                                25980000
259900             QUEUE (ASC-LIST-QUEUE-NAME)                          25990000
260000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26000000
260100             ITEM  (PV-BLOCK-NUMBER)                              26010000
260200             REWRITE                                              26020000
260300             RESP  (PV-CICS-RESP)                                 26030000
260400     END-EXEC.                                                    26040000
260500                                                                  26050000
260600     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           26060000
260700         CONTINUE                                                 26070000
260800     ELSE                                                         26080000
260900         SET DP013-CICS-ABEND            TO TRUE                  26090000
261000         SET DP013-NO-ROLLBACK           TO TRUE                  26100000
261100         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       26110000
261200         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     26120000
261300                                         TO DP013-MESSAGE-TEXT(1) 26130000
261400         PERFORM DP013-0000-PROCESS-ABEND                         26140000
261500     END-IF.                                                      26150000
261600                                                                  26160000
261700******************************************************************26170000
261800** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **26180000
261900** SPECIFIC COMMAREA.                                           **26190000
262000******************************************************************26200000
262100 5110-WRITE-ASC-LISTQ.                                            26210000
262200     EXEC CICS                                                    26220000
262300         WRITEQ TS                                                26230000
262400             QUEUE (ASC-LIST-QUEUE-NAME)                          26240000
262500             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26250000
262600             ITEM  (PV-BLOCK-NUMBER)                              26260000
262700             RESP  (PV-CICS-RESP)                                 26270000
262800     END-EXEC.                                                    26280000
262900     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      26290000
263000         SET DP013-CICS-ABEND      TO TRUE                        26300000
263100         SET DP013-NO-ROLLBACK     TO TRUE                        26310000
263200         MOVE '5110-WRITE-ASC-LISTQ'                              26320000
263300                                   TO DP013-PARAGRAPH             26330000
263400         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           26340000
263500                                   TO DP013-MESSAGE-TEXT(1)       26350000
263600         PERFORM DP013-0000-PROCESS-ABEND                         26360000
263700     END-IF.                                                      26370000
263800 EJECT                                                            26380000
263810                                                                  26381021
263900*----------------------------------------------------------------*26390000
264000* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *26400000
264100* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *26410000
264200*----------------------------------------------------------------*26420000
264300                                                                  26430000
264400 5200-FILL-SEL-QUEUE-RECORD.                                      26440000
264500                                                                  26450021
264600     PERFORM 6112-READ-LIST-QUEUE.                                26460021
264700                                                                  26470021
264800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       26480021
264900         PERFORM                                                  26490021
265000         VARYING LQW-IDX                                          26500021
265100         FROM 1 BY 1                                              26510021
265200         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            26520021
265300           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          26530021
265400                                                                  26540021
265500             IF  LQW-SELECT (LQW-IDX)                             26550021
265600                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              26560021
265700                                   TO SU013-ITEM (SU013-IDX)      26570021
265800                 MOVE SPACE        TO SU013-ACTION-SW (SU013-IDX) 26580021
265900*    LOAD SELECTIONS TO SEL-QUEUE                                 26590021
266000                 MOVE LQW-TRAILER-STAT (LQW-IDX)                  26600021
266100                                      TO SU013-TRIP-STAT-DESC     26610021
266200                                         (SU013-IDX)              26620021
266300                 MOVE LQW-OTBND-TRIP-ID (LQW-IDX) TO              26630021
266400                                            DK-OTBND-TRIP-ID      26640021
266500                 PERFORM 7010-GET-LONG-DESC                       26650021
266600                 MOVE SUOBSC-TRIP-STAT-DESC                       26660021
266700                                      TO SU013-TRIP-STAT-DESC-LONG26670021
266800                                         (SU013-IDX)              26680021
266900                 MOVE LQW-STAT-DATE (LQW-IDX)                     26690021
267000                                      TO SU013-STAT-DATE          26700021
267100                                         (SU013-IDX)              26710021
267200                 MOVE LQW-SCAC (LQW-IDX)                          26720021
267300                                      TO SU013-SCAC (SU013-IDX)   26730021
267400                 MOVE LQW-TRAILER-ID(LQW-IDX)                     26740021
267500                                      TO SU013-TRLR-ID(SU013-IDX) 26750021
267600                 MOVE LQW-SERIAL(LQW-IDX)                         26760021
267700                                      TO SU013-TRLR-SRL-NBR       26770021
267800                                         (SU013-IDX)              26780021
267900*                MOVE LQW-PCT-FULL(LQW-IDX)                       26790021
268000*                                     TO SU013-CAPCTY-PCT         26800021
268100*                                        (SU013-IDX)              26810021
268200                 MOVE LQW-JEWELRY(LQW-IDX)                        26820021
268300                                      TO SU013-JWLRY-IND          26830021
268400                                         (SU013-IDX)              26840021
268500                 MOVE LQW-AD(LQW-IDX)                             26850021
268600                                      TO SU013-AD-MDSE-IND        26860021
268700                                         (SU013-IDX)              26870021
268800                 MOVE LQW-CART-QTY(LQW-IDX)                       26880021
268900                                      TO SU013-CARTON-CNT         26890021
269000                                         (SU013-IDX)              26900021
269100                 MOVE LQW-UNT-QTY(LQW-IDX)                        26910021
269200                                      TO SU013-UNIT-COUNT         26920021
269300                                         (SU013-IDX)              26930021
269400                 MOVE LQW-OTBND-TRIP-ID(LQW-IDX)                  26940021
269500                                      TO SU013-TRIP-ID            26950021
269600                                         (SU013-IDX)              26960021
269700                 MOVE LQW-TRIP-STAT-CDE(LQW-IDX)                  26970021
269800                                      TO SU013-TRIP-STAT-CDE      26980021
269900                                         (SU013-IDX)              26990021
270000                 MOVE LQW-TRIP-OCRNC-ID(LQW-IDX)                  27000021
270100                                      TO SU013-TRIP-OCRNC-ID      27010021
270200                                         (SU013-IDX)              27020021
270300                 MOVE LQW-CRE-TMST(LQW-IDX)                       27030021
270400                                      TO SU013-SUMMARY-TMST       27040021
270500                                         (SU013-IDX)              27050021
270600                                                                  27060021
270700                 SET SU013-IDX UP BY 1                            27070021
270800                 IF  SU013-IDX > SU013-MAX-ITEMS                  27080021
270900                     PERFORM 5205-WRITE-SEL-QUEUE                 27090021
271000                     ADD +1        TO SU012-NUMBER-OF-TS-ITEMS    27100021
271100                     INITIALIZE SU013-SELECTED-ITEM-ARRAY         27110021
271200                     SET SU013-IDX TO  1                          27120021
271300                 END-IF                                           27130021
271400             END-IF                                               27140021
271500         END-PERFORM                                              27150021
271600     END-IF.                                                      27160021
271610                                                                  27161021
271700                                                                  27170000
271800*----------------------------------------------------------------*27180000
271900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *27190000
272000*----------------------------------------------------------------*27200000
272100                                                                  27210000
272200 5205-WRITE-SEL-QUEUE.                                            27220000
272300                                                                  27230000
272400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27240000
272500                                   TO SU013-SELECTED-ITEMS.       27250000
272600                                                                  27260000
272700     EXEC CICS                                                    27270000
272800          WRITEQ TS                                               27280000
272900              QUEUE (ASC-SEL-QUEUE-NAME)                          27290000
273000              FROM  (SU013-SELECT-RECORD)                         27300000
273100              ITEM  (PV-SEL-QUEUE-ITEM)                           27310000
273200              RESP  (PV-CICS-RESP)                                27320000
273300     END-EXEC.                                                    27330000
273400                                                                  27340000
273500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27350000
273600         CONTINUE                                                 27360000
273700     ELSE                                                         27370000
273800         SET DP013-CICS-ABEND      TO TRUE                        27380000
273900         SET DP013-NO-ROLLBACK     TO TRUE                        27390000
274000         MOVE '5205-WRITE-SEL-QUEUE'                              27400000
274100                                   TO DP013-PARAGRAPH             27410000
274200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          27420000
274300                                   TO DP013-MESSAGE-TEXT(1)       27430000
274400         PERFORM DP013-0000-PROCESS-ABEND                         27440000
274500     END-IF.                                                      27450000
274501                                                                  27450121
274502                                                                  27450221
274503*----------------------------------------------------------------*27450321
274504*    BUILD THE SELECTED ITEMS TEMP STORAGE QUEUE.                *27450421
274505*TO NAVIGATE TO ASSOCIATE LIST SCREEN                            *27450521
274506*DMH 5/17/18                                                     *27450621
274507*----------- ----------------------------------------------------*27450721
274508 5210-FILL-SEL-QUEUE-RECORD.                                      27450821
274509                                                                  27450921
274510     PERFORM 6112-READ-LIST-QUEUE.                                27451021
274511                                                                  27451121
274512     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       27451221
274513         PERFORM                                                  27451321
274514         VARYING LQW-IDX                                          27451421
274515         FROM 1 BY 1                                              27451521
274516         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            27451621
274517           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          27451721
274518                                                                  27451821
274536             IF  LQW-SELECT (LQW-IDX)                             27453621
274537                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              27453721
274538                                   TO SU010-ITEM (SU010-IDX)      27453821
274539                 MOVE SPACE        TO SU010-ACTION-SW (SU010-IDX) 27453921
274540                                                                  27454021
274541                 MOVE LQW-SCAC (LQW-IDX)                          27454121
274542                                        TO SU010-SCAC (SU010-IDX) 27454221
274543                 MOVE LQW-TRAILER-ID (LQW-IDX)                    27454323
274544                                     TO SU010-TRLR-ID (SU010-IDX) 27454421
274545                 MOVE LQW-SERIAL       (LQW-IDX)                  27454523
274546                                TO SU010-TRLR-SRL-NBR (SU010-IDX) 27454621
274547                 MOVE LQW-OTBND-TRIP-ID (LQW-IDX)                 27454724
274548                                     TO SU010-TRIP-ID (SU010-IDX) 27454821
274549                 MOVE LQW-TRIP-STAT-CDE (LQW-IDX)                 27454923
274550                                 TO SU010-TRIP-STATUS (SU010-IDX) 27455021
274551                 MOVE LQW-STAT-DATE (LQW-IDX)                     27455121
274552                                   TO SU010-STAT-DATE (SU010-IDX) 27455221
274554                 MOVE SPACES     TO SU010-DESCRIPTION (SU010-IDX) 27455423
274556                 MOVE ASC-STR-NBR   TO SU010-DEST-NBR (SU010-IDX) 27455623
274563                 MOVE LQW-OTBND-TRIP-ID (LQW-IDX)                 27456324
274564                                         TO SU009-TRIP-ID         27456421
274569                 MOVE LQW-STAT-DATE (LQW-IDX)                     27456921
274570                                         TO SU009-STATUS-DATE     27457032
274578                                                                  27457821
274579                 SET SU010-IDX UP BY 1                            27457921
274580                 IF  SU010-IDX > SU010-MAX-ITEMS                  27458021
274581                     PERFORM 5215-WRITE-SEL-QUEUE                 27458121
274582                     ADD +1        TO SU009-NUMBER-OF-TS-ITEMS    27458221
274583                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         27458321
274584                     SET SU010-IDX TO  1                          27458421
274585                 END-IF                                           27458521
274586             END-IF                                               27458621
274587         END-PERFORM                                              27458721
274588     END-IF.                                                      27458821
274589                                                                  27458921
274590*----------------------------------------------------------------*27459020
274591*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *27459120
274592*TO NAVIGATE TO ASSOCIATE LIST SCREEN                            *27459220
274593*DMH 5/17/18                                                     *27459320
274594*----------- ----------------------------------------------------*27459420
274595                                                                  27459520
274596 5215-WRITE-SEL-QUEUE.                                            27459620
274597                                                                  27459720
274598     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27459820
274599                                   TO SU010-SELECTED-ITEMS.       27459920
274600                                                                  27460020
274601     EXEC CICS                                                    27460120
274602          WRITEQ TS                                               27460220
274603              QUEUE (ASC-SEL-QUEUE-NAME)                          27460320
274604              FROM  (SU010-SELECT-RECORD)                         27460420
274605              ITEM  (PV-SEL-QUEUE-ITEM)                           27460520
274606              RESP  (PV-CICS-RESP)                                27460620
274607     END-EXEC.                                                    27460720
274608                                                                  27460820
274609     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27460920
274610         CONTINUE                                                 27461020
274611     ELSE                                                         27461120
274612         SET DP013-CICS-ABEND      TO TRUE                        27461220
274613         SET DP013-NO-ROLLBACK     TO TRUE                        27461320
274614         MOVE '5215-WRITE-SEL-QUEUE'                              27461420
274615                                   TO DP013-PARAGRAPH             27461520
274616         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          27461620
274617                                   TO DP013-MESSAGE-TEXT(1)       27461720
274618         PERFORM DP013-0000-PROCESS-ABEND                         27461820
274619     END-IF.                                                      27461920
274620 EJECT                                                            27462000
274700******************************************************************27470000
274800** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **27480000
274900** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **27490000
275000** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **27500000
275100** THE USER.                                                    **27510000
275200******************************************************************27520000
275300 6000-REFRESH-PANEL-FROM-TEMP.                                    27530000
275400     IF  ASC-UPDATE-TSQ                                           27540000
275500         SET ASC-NO-TSQ-UPDATE TO TRUE                            27550000
275600         MOVE ZERO                 TO PV-SAVE-ITEM                27560000
275700                                      PV-SEL-QUEUE-ITEM           27570000
275800         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        27580000
275900                                   TO PV-HOLD-SELECTED-ITEMS      27590000
276000         MOVE +1                   TO PV-ITEMS-PROCESSED          27600000
276100         PERFORM 6100-UPDATE-TSQ                                  27610000
276200             UNTIL PV-ITEMS-PROCESSED >                           27620000
276300                                     PV-HOLD-SELECTED-ITEMS       27630000
276400         PERFORM 6010-DELETE-SEL-QUEUE                            27640000
276500         INITIALIZE ASC-BLOCK-ENTRIES (1)                         27650000
276600                    ASC-BLOCK-ENTRIES (2)                         27660000
276700     END-IF.                                                      27670000
276800                                                                  27680000
276810******************************************************************27681027
276820** WHEN RETURNING FROM THE ASSOCIATE LIST SCREEN                **27682027
276850** DMH 5/17/18                                                  **27685027
276860******************************************************************27686027
276870 6001-REFRESH-PANEL-FROM-TEMP.                                    27687027
276880     IF  ASC-UPDATE-TSQ                                           27688027
276890         SET ASC-NO-TSQ-UPDATE TO TRUE                            27689027
276891         MOVE ZERO                 TO PV-SAVE-ITEM                27689127
276892                                      PV-SEL-QUEUE-ITEM           27689227
276893         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        27689327
276894                                   TO PV-HOLD-SELECTED-ITEMS      27689427
276895         MOVE +1                   TO PV-ITEMS-PROCESSED          27689527
276896         PERFORM 6101-UPDATE-TSQ                                  27689627
276897             UNTIL PV-ITEMS-PROCESSED >                           27689727
276898                                     PV-HOLD-SELECTED-ITEMS       27689827
276899         PERFORM 6010-DELETE-SEL-QUEUE                            27689927
276900         INITIALIZE ASC-BLOCK-ENTRIES (1)                         27690027
276901                    ASC-BLOCK-ENTRIES (2)                         27690127
276902     END-IF.                                                      27690227
276903                                                                  27690327
276910*----------------------------------------------------------------*27691000
277000*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *27700000
277100*----------------------------------------------------------------*27710000
277200 6010-DELETE-SEL-QUEUE.                                           27720000
277300                                                                  27730000
277400     EXEC CICS                                                    27740000
277500         DELETEQ TS                                               27750000
277600             QUEUE (ASC-SEL-QUEUE-NAME)                           27760000
277700             RESP  (PV-CICS-RESP)                                 27770000
277800     END-EXEC.                                                    27780000
277900*                                                                 27790000
278000     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      27800000
278100        (PV-CICS-RESP = DFHRESP(QIDERR)))                         27810000
278200         CONTINUE                                                 27820000
278300     ELSE                                                         27830000
278400         SET DP013-CICS-ABEND TO TRUE                             27840000
278500         SET DP013-NO-ROLLBACK TO TRUE                            27850000
278600         MOVE '6010-DELETE-SEL-QUEUE'                             27860000
278700                        TO DP013-PARAGRAPH                        27870000
278800         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         27880000
278900                        TO DP013-MESSAGE-TEXT (1)                 27890000
279000         PERFORM DP013-0000-PROCESS-ABEND                         27900000
279100     END-IF.                                                      27910000
279200                                                                  27920000
279300*----------------------------------------------------------------*27930000
279400*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *27940000
279500*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *27950000
279600*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *27960000
279700*    THE TEMP QUEUE.                                             *27970000
279800*----------------------------------------------------------------*27980000
279900                                                                  27990000
280000 6100-UPDATE-TSQ.                                                 28000000
280100                                                                  28010000
280200     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             28020000
280300     PERFORM 6105-READ-SEL-QUEUE.                                 28030000
280400     PERFORM                                                      28040000
280500         VARYING SU013-IDX                                        28050000
280600         FROM 1 BY 1                                              28060000
280700         UNTIL ((PV-ITEMS-PROCESSED >                             28070000
280800                              PV-HOLD-SELECTED-ITEMS)             28080000
280900         OR (SU013-IDX GREATER THAN SU013-MAX-ITEMS))             28090000
281000         IF  SU013-ACTION-SW (SU013-IDX) > SPACE                  28100000
281100             PERFORM 6110-PROCESS-ITEMS                           28110000
281200         END-IF                                                   28120000
281300         ADD +1                TO PV-ITEMS-PROCESSED              28130000
281400     END-PERFORM.                                                 28140000
281500     PERFORM 6111-WRITE-LIST-QUEUE.                               28150000
281501                                                                  28150127
281510*----------------------------------------------------------------*28151027
281520*                                                                *28152027
281560*----------------------------------------------------------------*28156027
281570                                                                  28157027
281580 6101-UPDATE-TSQ.                                                 28158027
281590                                                                  28159027
281591     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             28159127
281592     PERFORM 6106-READ-SEL-QUEUE.                                 28159227
281593     PERFORM                                                      28159327
281594         VARYING SU013-IDX                                        28159427
281595         FROM 1 BY 1                                              28159527
281596         UNTIL ((PV-ITEMS-PROCESSED >                             28159627
281597                              PV-HOLD-SELECTED-ITEMS)             28159727
281598         OR (SU010-IDX GREATER THAN SU010-MAX-ITEMS))             28159827
281599         IF  SU010-ACTION-SW (SU013-IDX) > SPACE                  28159927
281600             PERFORM 6113-PROCESS-ITEMS                           28160027
281601         END-IF                                                   28160127
281602         ADD +1                TO PV-ITEMS-PROCESSED              28160227
281603     END-PERFORM.                                                 28160327
281604     PERFORM 6114-WRITE-LIST-QUEUE.                               28160427
281605                                                                  28160527
281610*----------------------------------------------------------------*28161000
281700*    READ THE LIST QUEUE RECORD.                                 *28170000
281800*----------------------------------------------------------------*28180000
281900                                                                  28190000
282000 6105-READ-SEL-QUEUE.                                             28200000
282100                                                                  28210000
282200     EXEC CICS                                                    28220000
282300          READQ TS                                                28230000
282400              QUEUE (ASC-SEL-QUEUE-NAME)                          28240000
282500              INTO  (SU013-SELECT-RECORD)                         28250000
282600              ITEM  (PV-SEL-QUEUE-ITEM)                           28260000
282700              RESP  (PV-CICS-RESP)                                28270000
282800     END-EXEC.                                                    28280000
282900*                                                                 28290000
283000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28300000
283100         CONTINUE                                                 28310000
283200     ELSE                                                         28320000
283300         SET DP013-CICS-ABEND      TO  TRUE                       28330000
283400         SET DP013-NO-ROLLBACK     TO  TRUE                       28340000
283500         MOVE '6105-READ-SEL-QUEUE'                               28350000
283600                                   TO  DP013-PARAGRAPH            28360000
283700         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           28370000
283800                                   TO  DP013-MESSAGE-TEXT(1)      28380000
283900         PERFORM DP013-0000-PROCESS-ABEND                         28390000
284000     END-IF.                                                      28400000
284100                                                                  28410027
284110*----------------------------------------------------------------*28411027
284120*                                                                *28412027
284130*----------------------------------------------------------------*28413027
284140                                                                  28414027
284150 6106-READ-SEL-QUEUE.                                             28415027
284160                                                                  28416027
284170     EXEC CICS                                                    28417027
284180          READQ TS                                                28418027
284190              QUEUE (ASC-SEL-QUEUE-NAME)                          28419027
284191              INTO  (SU010-SELECT-RECORD)                         28419127
284192              ITEM  (PV-SEL-QUEUE-ITEM)                           28419227
284193              RESP  (PV-CICS-RESP)                                28419327
284194     END-EXEC.                                                    28419427
284195*                                                                 28419527
284196     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28419627
284197         CONTINUE                                                 28419727
284198     ELSE                                                         28419827
284199         SET DP013-CICS-ABEND      TO  TRUE                       28419927
284200         SET DP013-NO-ROLLBACK     TO  TRUE                       28420027
284201         MOVE '6106-READ-SEL-QUEUE'                               28420127
284202                                   TO  DP013-PARAGRAPH            28420227
284203         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           28420327
284204                                   TO  DP013-MESSAGE-TEXT(1)      28420427
284205         PERFORM DP013-0000-PROCESS-ABEND                         28420527
284206     END-IF.                                                      28420627
284207/                                                                 28420727
284210*----------------------------------------------------------------*28421000
284300*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*28430000
284400*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*28440000
284500*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *28450000
284600*----------------------------------------------------------------*28460000
284700                                                                  28470000
284800 6110-PROCESS-ITEMS.                                              28480000
284900                                                                  28490000
285000     COMPUTE PV-ITEM = 1 + ((SU013-ITEM (SU013-IDX) - 1)          28500000
285100                     / PC-ITEMS-PER-PANEL).                       28510000
285200                                                                  28520000
285300     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           28530000
285400         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          28540000
285500             PERFORM 6111-WRITE-LIST-QUEUE                        28550000
285600         END-IF                                                   28560000
285700         MOVE PV-ITEM          TO PV-SAVE-ITEM                    28570000
285800                                                                  28580000
285900         PERFORM 6112-READ-LIST-QUEUE                             28590000
286000         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               28600000
286100             CONTINUE                                             28610000
286200         END-IF                                                   28620000
286300     END-IF.                                                      28630000
286400                                                                  28640000
286500     COMPUTE PV-SUB = (SU013-ITEM (SU013-IDX)                     28650000
286600                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              28660000
286700     SET LQW-DESELECT (PV-SUB) TO    TRUE                         28670000
286800     MOVE LQW-SELECTED-SW (PV-SUB)                                28680000
286900                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  28690000
287000     EVALUATE TRUE                                                28700000
287100         WHEN SU013-INQ (SU013-IDX)                               28710000
287200              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             28720000
287300                                                                  28730000
287400         WHEN SU013-UPD (SU013-IDX)                               28740000
287500              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             28750000
287600              MOVE LQW-OTBND-TRIP-ID (PV-SUB)                     28760000
287700                               TO DK-OTBND-TRIP-ID                28770000
287800              PERFORM 7000-GET-TRAILER-STATUS                     28780000
287900              MOVE SUOBSC-STAT-SHRT-DESC                          28790000
288000                               TO LQW-TRAILER-STAT (PV-SUB)       28800000
288100              MOVE PV-USA-DATE (1:6) TO PV-DB2-DATE               28810000
288200              MOVE PV-USA-DATE (9:2) TO PV-DB2-YY                 28820000
288300              MOVE PV-DB2-DATE       TO LQW-STAT-DATE (PV-SUB)    28830000
288400                                                                  28840000
288500         WHEN SU013-DEL (SU013-IDX)                               28850000
288600              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             28860000
288700                                                                  28870000
288800         WHEN SU013-ERR (SU013-IDX)                               28880000
288900              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             28890000
289000     END-EVALUATE.                                                28900000
289100                                                                  28910000
289200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                28920000
289300                                                                  28930000
289400*----------------------------------------------------------------*28940000
289500*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *28950000
289600*----------------------------------------------------------------*28960000
289700                                                                  28970000
289800 6111-WRITE-LIST-QUEUE.                                           28980000
289900                                                                  28990000
290000     EXEC CICS                                                    29000000
290100         WRITEQ TS                                                29010000
290200             QUEUE (ASC-LIST-QUEUE-NAME)                          29020000
290300             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     29030000
290400             ITEM  (PV-SAVE-ITEM)                                 29040000
290500             REWRITE                                              29050000
290600             RESP  (PV-CICS-RESP)                                 29060000
290700     END-EXEC.                                                    29070000
290800*                                                                 29080000
290900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29090000
291000         CONTINUE                                                 29100000
291100     ELSE                                                         29110000
291200         SET DP013-CICS-ABEND  TO  TRUE                           29120000
291300         SET DP013-NO-ROLLBACK TO  TRUE                           29130000
291400         MOVE '6111-WRITE-LIST-QUEUE'                             29140000
291500                               TO  DP013-PARAGRAPH                29150000
291600         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  29160000
291700                               TO  DP013-MESSAGE-TEXT(1)          29170000
291800         PERFORM DP013-0000-PROCESS-ABEND                         29180000
291900     END-IF.                                                      29190000
292000                                                                  29200000
292100 EJECT                                                            29210000
292200*----------------------------------------------------------------*29220000
292300*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*29230000
292400*----------------------------------------------------------------*29240000
292500                                                                  29250000
292600 6112-READ-LIST-QUEUE.                                            29260000
292700                                                                  29270000
292800     EXEC CICS                                                    29280000
292900         READQ TS                                                 29290000
293000             QUEUE (ASC-LIST-QUEUE-NAME)                          29300000
293100             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     29310000
293200             ITEM  (PV-ITEM)                                      29320000
293300             RESP  (PV-CICS-RESP)                                 29330000
293400     END-EXEC.                                                    29340000
293500*                                                                 29350000
293600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29360000
293700         CONTINUE                                                 29370000
293800     ELSE                                                         29380000
293900         SET DP013-CICS-ABEND        TO TRUE                      29390000
294000         SET DP013-NO-ROLLBACK       TO TRUE                      29400000
294100         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           29410000
294200         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    29420000
294300                                     TO DP013-MESSAGE-TEXT(1)     29430000
294400         PERFORM DP013-0000-PROCESS-ABEND                         29440000
294500     END-IF.                                                      29450000
294600                                                                  29460000
294610*----------------------------------------------------------------*29461027
294620*                                                                *29462027
294650*----------------------------------------------------------------*29465027
294660                                                                  29466027
294670 6113-PROCESS-ITEMS.                                              29467027
294680                                                                  29468027
294690     COMPUTE PV-ITEM = 1 + ((SU010-ITEM (SU010-IDX) - 1)          29469027
294691                     / PC-ITEMS-PER-PANEL).                       29469127
294692                                                                  29469227
294693     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           29469327
294694         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          29469427
294695             PERFORM 6114-WRITE-LIST-QUEUE                        29469527
294696         END-IF                                                   29469627
294697         MOVE PV-ITEM          TO PV-SAVE-ITEM                    29469727
294698                                                                  29469827
294699         PERFORM 6115-READ-LIST-QUEUE                             29469927
294700         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               29470027
294701             CONTINUE                                             29470127
294702         END-IF                                                   29470227
294703     END-IF.                                                      29470327
294704                                                                  29470427
294705     COMPUTE PV-SUB = (SU010-ITEM (SU010-IDX)                     29470527
294706                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              29470627
294707     SET LQW-DESELECT (PV-SUB) TO    TRUE                         29470727
294708     MOVE LQW-SELECTED-SW (PV-SUB)                                29470827
294709                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  29470927
294710     EVALUATE TRUE                                                29471027
294711         WHEN SU010-INQ (SU010-IDX)                               29471127
294712              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             29471227
294713                                                                  29471327
294714         WHEN SU013-UPD (SU010-IDX)                               29471427
294715              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             29471527
294716              MOVE LQW-OTBND-TRIP-ID (PV-SUB)                     29471627
294717                               TO DK-OTBND-TRIP-ID                29471727
294718              PERFORM 7000-GET-TRAILER-STATUS                     29471827
294719              MOVE SUOBSC-STAT-SHRT-DESC                          29471927
294720                               TO LQW-TRAILER-STAT (PV-SUB)       29472027
294721              MOVE PV-USA-DATE (1:6) TO PV-DB2-DATE               29472127
294722              MOVE PV-USA-DATE (9:2) TO PV-DB2-YY                 29472227
294723              MOVE PV-DB2-DATE       TO LQW-STAT-DATE (PV-SUB)    29472327
294724                                                                  29472427
294725         WHEN SU013-DEL (SU010-IDX)                               29472527
294726              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             29472627
294727                                                                  29472727
294728         WHEN SU013-ERR (SU010-IDX)                               29472827
294729              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             29472927
294730     END-EVALUATE.                                                29473027
294731                                                                  29473127
294732     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                29473227
294733                                                                  29473327
294734*----------------------------------------------------------------*29473427
294735*                                                                *29473527
294736*----------------------------------------------------------------*29473627
294737                                                                  29473727
294738 6114-WRITE-LIST-QUEUE.                                           29473827
294739                                                                  29473927
294740     EXEC CICS                                                    29474027
294741         WRITEQ TS                                                29474127
294742             QUEUE (ASC-LIST-QUEUE-NAME)                          29474227
294743             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     29474327
294744             ITEM  (PV-SAVE-ITEM)                                 29474427
294745             REWRITE                                              29474527
294746             RESP  (PV-CICS-RESP)                                 29474627
294747     END-EXEC.                                                    29474727
294748*                                                                 29474827
294749     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29474927
294750         CONTINUE                                                 29475027
294751     ELSE                                                         29475127
294752         SET DP013-CICS-ABEND  TO  TRUE                           29475227
294753         SET DP013-NO-ROLLBACK TO  TRUE                           29475327
294754         MOVE '6114-WRITE-LIST-QUEUE'                             29475427
294755                               TO  DP013-PARAGRAPH                29475527
294756         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  29475627
294757                               TO  DP013-MESSAGE-TEXT(1)          29475727
294758         PERFORM DP013-0000-PROCESS-ABEND                         29475827
294759     END-IF.                                                      29475927
294760                                                                  29476027
294761 EJECT                                                            29476127
294762*----------------------------------------------------------------*29476227
294763*                                                                *29476327
294764*----------------------------------------------------------------*29476427
294765                                                                  29476527
294766 6115-READ-LIST-QUEUE.                                            29476627
294767                                                                  29476727
294768     EXEC CICS                                                    29476827
294769         READQ TS                                                 29476927
294770             QUEUE (ASC-LIST-QUEUE-NAME)                          29477027
294771             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     29477127
294772             ITEM  (PV-ITEM)                                      29477227
294773             RESP  (PV-CICS-RESP)                                 29477327
294774     END-EXEC.                                                    29477427
294775*                                                                 29477527
294776     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29477627
294777         CONTINUE                                                 29477727
294778     ELSE                                                         29477827
294779         SET DP013-CICS-ABEND        TO TRUE                      29477927
294780         SET DP013-NO-ROLLBACK       TO TRUE                      29478027
294781         MOVE '6115-READ-LIST-QUEUE' TO DP013-PARAGRAPH           29478127
294782         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    29478227
294783                                     TO DP013-MESSAGE-TEXT(1)     29478327
294784         PERFORM DP013-0000-PROCESS-ABEND                         29478427
294785     END-IF.                                                      29478527
294786                                                                  29478627
294790 7000-GET-TRAILER-STATUS.                                         29479000
294800                                                                  29480000
294900     EXEC SQL                                                     29490000
295000                                                                  29500000
295100          SELECT                                                  29510000
295200                 OBSC.STAT_SHRT_DESC                              29520000
295300               , OBSC.TRIP_STAT_DESC                              29530000
295400               , CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)             29540000
295500            INTO                                                  29550000
295600                 :SUOBSC-STAT-SHRT-DESC                           29560000
295700              ,  :SUOBSC-TRIP-STAT-DESC                           29570000
295800              ,  :PV-USA-DATE                                     29580000
295900            FROM                                                  29590000
296000                  TSUOBTS OBTS                                    29600000
296100                , TSUOBSC OBSC                                    29610000
296200          WHERE                                                   29620000
296300                 OBTS.TRIP_STAT_CDE      = OBSC.TRIP_STAT_CDE     29630000
296400                                                                  29640000
296500            AND  OBTS.OTBND_TRIP_ID      = :DK-OTBND-TRIP-ID      29650000
296600            AND  OBTS.OTBND_STAT_TMST IN                          29660000
296700                    (SELECT  MAX(OBTS1.OTBND_STAT_TMST)           29670000
296800                               FROM  TSUOBTS OBTS1                29680000
296900              WHERE  OBTS1.OTBND_TRIP_ID = OBTS.OTBND_TRIP_ID)    29690000
297000                                                                  29700000
297100     END-EXEC.                                                    29710000
297200                                                                  29720000
297300     EVALUATE TRUE                                                29730000
297400         WHEN SQLCODE = ZERO                                      29740000
297500         WHEN SQLCODE = +100                                      29750000
297600             CONTINUE                                             29760000
297700         WHEN SQLCODE = -904                                      29770000
297800         WHEN SQLCODE = -911                                      29780000
297900         WHEN SQLCODE = -913                                      29790000
298000             PERFORM 9900-SOFT-ABORT                              29800000
298100         WHEN SQLWARN0 NOT = SPACES                               29810000
298200         WHEN SQLCODE < ZERO                                      29820000
298300         WHEN SQLCODE > ZERO                                      29830000
298400             MOVE '7000-GET-TRAILER-STATUS'                       29840000
298500                                   TO DP013-PARAGRAPH             29850000
298600             MOVE 'SELECT TRAILER STATUS'                         29860000
298700                                   TO DP013-MESSAGE-TEXT (1)      29870000
298800             MOVE SQLCA        TO DP013-SQLCA                     29880000
298900             MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (1)        29890000
299000             MOVE 'TSUOBSC '   TO DP013-DB2-TABLE-NAME (2)        29900000
299100             SET DP013-DB2-ABEND                                  29910000
299200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29920000
299300             PERFORM DP013-0000-PROCESS-ABEND                     29930000
299400     END-EVALUATE.                                                29940000
299500/                                                                 29950000
299600 7010-GET-LONG-DESC.                                              29960000
299700                                                                  29970000
299800     EXEC SQL                                                     29980000
299900                                                                  29990000
300000          SELECT                                                  30000000
300100                 OBSC.TRIP_STAT_DESC                              30010000
300200            INTO                                                  30020000
300300                 :SUOBSC-TRIP-STAT-DESC                           30030000
300400            FROM                                                  30040000
300500                  TSUOBTS OBTS                                    30050000
300600                , TSUOBSC OBSC                                    30060000
300700          WHERE                                                   30070000
300800                 OBTS.TRIP_STAT_CDE      = OBSC.TRIP_STAT_CDE     30080000
300900                                                                  30090000
301000            AND  OBTS.OTBND_TRIP_ID      = :DK-OTBND-TRIP-ID      30100000
301100            AND  OBTS.OTBND_STAT_TMST IN                          30110000
301200                    (SELECT  MAX(OBTS1.OTBND_STAT_TMST)           30120000
301300                               FROM  TSUOBTS OBTS1                30130000
301400              WHERE  OBTS1.OTBND_TRIP_ID = OBTS.OTBND_TRIP_ID)    30140000
301500                                                                  30150000
301600     END-EXEC.                                                    30160000
301700                                                                  30170000
301800     EVALUATE TRUE                                                30180000
301900         WHEN SQLCODE = ZERO                                      30190000
302000         WHEN SQLCODE = +100                                      30200000
302100             CONTINUE                                             30210000
302200         WHEN SQLCODE = -904                                      30220000
302300         WHEN SQLCODE = -911                                      30230000
302400         WHEN SQLCODE = -913                                      30240000
302500             PERFORM 9900-SOFT-ABORT                              30250000
302600         WHEN SQLWARN0 NOT = SPACES                               30260000
302700         WHEN SQLCODE < ZERO                                      30270000
302800         WHEN SQLCODE > ZERO                                      30280000
302900             MOVE '7010-GET-LONG-DESC'                            30290000
303000                                   TO DP013-PARAGRAPH             30300000
303100             MOVE 'SELECT TRIP DESC'                              30310000
303200                                   TO DP013-MESSAGE-TEXT (1)      30320000
303300             MOVE SQLCA        TO DP013-SQLCA                     30330000
303400             MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (1)        30340000
303500             MOVE 'TSUOBSC '   TO DP013-DB2-TABLE-NAME (2)        30350000
303600             SET DP013-DB2-ABEND                                  30360000
303700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30370000
303800             PERFORM DP013-0000-PROCESS-ABEND                     30380000
303900     END-EVALUATE.                                                30390000
304000/                                                                 30400000
304100 9900-SOFT-ABORT.                                                 30410000
304200     SET PS-ERROR         TO TRUE.                                30420000
304300     SET DP020-MSG-FATAL  TO TRUE.                                30430000
304400     MOVE 'THROUGH SOFT-ABORT PARA'                               30440000
304500                            TO DP013-MESSAGE-TEXT (1)             30450000
304600     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    30460000
304700     IF PS-NO-NEXT-SCREEN                                         30470000
304800         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    30480000
304900     END-IF.                                                      30490000
305000                                                                  30500000
305100     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          30510000
305200     PERFORM 0001-CALL-CICS-ARCH-API.                             30520000
305300                                                                  30530000
305400 EJECT                                                            30540000
305500*----------------------------------------------------------------*30550000
305600*    ABEND PROCESSOR MODULE                                      *30560000
305700*----------------------------------------------------------------*30570000
305800                                                                  30580000
305900     COPY DPPD013.                                                30590000
