000100******************************************************************00010026
000200 IDENTIFICATION DIVISION.                                         00020026
000300******************************************************************00030026
000400                                                                  00040026
000500 PROGRAM-ID.             ARKUT030.                                00050026
000600 AUTHOR.                 TAMARA KOLTUN.                           00060026
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070026
000800 DATE-WRITTEN            6-22-95.                                 00080026
000900 DATE-COMPILED.                                                   00090026
001000                                                                  00100026
001100******************************************************************00110026
001200*CHANGES:  08/08/96  DOREEN BONESS                                00120026
001300*          CHANGED GIFT-CERTIFICATE-PAYMNT FROM '0004195'         00130026
001400*          TO '0004196'.                                          00140026
001500*                                                                 00150026
001600*-----------------------------------------------------------------00160026
001700*CHANGES:  01/23/97  JEFF BOLWERK  PITS#:60554                    00170026
001800*        CHANGED GIFT-CERTIFICATE-PAYMNT FROM A CONSTANT          00180026
001900*        TO A VARIABLE.  THE YEAR FOR THE GIFT CERTIFICATE        00190026
002000*        ACCOUNT WILL BE TAKEN FROM THE FISCAL DATE SO THE        00200026
002100*        GL ACCOUNTS WILL BE UPDATED CORRECTLY (GIFT CERTIFICATES 00210026
002200*        ARE SOLD WITHIN A FISCAL CALENDAR YEAR).                 00220026
002300*                                                                 00230026
002400*-----------------------------------------------------------------00240026
002500*CHANGES:  08/07/97  CHRISTINE MALONE  PITS#:103544               00250026
002600*        CHANGED PROGRAM SO STORE NUMBER THAT IS WRITTEN TO OUTPUT00260026
002700*        FILE IS THE STORE NUMBER THAT IS ENTERED BY THE USER IN  00270026
002800*        THE CREDIT DEPARTMENT.  IT WILL NO LONGER DEFAULT TO 880.00280026
002900*        HOWEVER, 'GIFT CERTIFICATE PAYMENT' AND 'EMPLOYEE SALE   00290026
003000*        RETURN DISCOUNT' WILL REMAIN STORE 900.  IF STORE NUMBER 00300026
003100*        IS ZEROS, BLANK, OR NON-NUMERIC, STORE # WILL BE 880.    00310026
003200*                                                                 00320026
003300*-----------------------------------------------------------------00330026
003400*CHANGES:  08/27/97  CHRISTINE MALONE  PITS#:103544               00340026
003500*        ACCOUNT 1205 WILL ALWAYS DEFAULT TO STORE # 880.         00350026
003600*                                                                 00360026
003610*-----------------------------------------------------------------00361030
003620*CHANGES:  02/23/04  BRIAN HASSLINGER  WR#:23834                  00362037
003630*        CHANGED ALL DATA VALRIABLES THAT HOLD STORE NUMBERS TO   00363030
003640*        PIC 9(4) TO ACCOMODATE STORE NUMBERS GREATER THAN 999.   00364036
003700******************************************************************00370026
003800                                                                  00380026
003900******************************************************************00390026
004000 ENVIRONMENT DIVISION.                                            00400026
004100******************************************************************00410026
004200                                                                  00420026
004300 CONFIGURATION SECTION.                                           00430026
004400                                                                  00440026
004500 SOURCE-COMPUTER.        IBM-3090.                                00450026
004600 OBJECT-COMPUTER.        IBM-3090.                                00460026
004700                                                                  00470026
004800 INPUT-OUTPUT SECTION.                                            00480026
004900                                                                  00490026
005000 FILE-CONTROL.                                                    00500026
005100                                                                  00510026
005200      SELECT SELECT-GL-UPDATE-FILE    ASSIGN TO INP01.            00520026
005300      SELECT GL-INTERFACE-FILE      ASSIGN TO OUT01.              00530026
005400                                                                  00540026
005500******************************************************************00550026
005600 DATA DIVISION.                                                   00560026
005700******************************************************************00570026
005800                                                                  00580026
005900 FILE SECTION.                                                    00590026
006000 FD  SELECT-GL-UPDATE-FILE                                        00600026
006100     LABEL RECORDS ARE STANDARD                                   00610026
006200     BLOCK CONTAINS 0 RECORDS                                     00620026
006400     RECORD CONTAINS 184 CHARACTERS                               00640039
006500     DATA RECORD IS SELECT-GL-UPDATE-RECORD.                      00650026
006600                                                                  00660026
006700 01  SELECT-GL-UPDATE-RECORD         PIC X(184).                  00670039
006800                                                                  00680026
006900                                                                  00690026
007000 FD  GL-INTERFACE-FILE                                            00700026
007100     LABEL RECORDS ARE STANDARD                                   00710026
007200     BLOCK CONTAINS 0 RECORDS                                     00720026
007400     RECORD CONTAINS 81 CHARACTERS                                00740035
007500     DATA RECORD IS GL-INTERFACE-RECORD.                          00750026
007600                                                                  00760026
007700 01  GL-INTERFACE-RECORD             PIC X(81).                   00770035
007800                                                                  00780026
007900*------------------------------------------------------*          00790026
008000 WORKING-STORAGE SECTION.                                         00800026
008100*------------------------------------------------------*          00810026
008200 01  ABEND-CODE                  PIC S9(04)         VALUE ZEROS   00820026
008300                                 COMP SYNC.                       00830026
008400                                                                  00840026
008500 01 PC-PROGRAM-CONSTANTS.                                         00850026
008600    05 PC-PROGRAM-NAME               PIC X(08) VALUE 'ARKUT030'.  00860026
008700    05 PC-COMPANY                    PIC X(04) VALUE '0039'.      00870026
008800    05 PC-880                        PIC X(04) VALUE '0880'.      00880034
008900    05 PC-900                        PIC X(04) VALUE '0900'.      00890034
009000                                                                  00900026
009100 01 PV-PROGRAM-VARIABLES.                                         00910026
009200    05 PV-ABEND-CODE                 PIC 9(04)   VALUE ZEROS.     00920026
009300    05 PV-ABEND-PARA-NAME            PIC X(30)   VALUE SPACE.     00930026
009400    05 PV-PARAGRAPH-NAME             PIC X(30)   VALUE SPACE.     00940026
009500    05 PV-GL-ACCT-NBR                PIC X(07)   VALUE SPACE.     00950026
009600    05 PV-GL-ACCT-NBR-REFORMAT.                                   00960026
009700       10 FILLER                     PIC X(03)   VALUE SPACE.     00970026
009800       10 PV-ACCOUNT-7               PIC X(07)   VALUE SPACE.     00980026
009900        88 EMPL-SALE-RTN-DISCOUNT                VALUE '0051106'. 00990026
010000**      88 BAD-CHECK-DEBIT-ADJ                   VALUE '0053805'. 01000026
010100        88 BAD-MEDIA-WRITEOFF                    VALUE '0053802'. 01010026
010200        88 WRITEOFF-DISPUTED-AMT                 VALUE '0052442'. 01020026
010300        88 ACCOUNTS-RECEIVABLE-TRADE             VALUE '0010202'. 01030026
010400        88 GIFT-CERT-PAYMENT-2000                VALUE '0020553'. 01040026
010500        88 GIFT-CERT-PAYMENT-1999                VALUE '0020542'. 01050026
010600        88 GIFT-CARD-PAYMENT                     VALUE '0020550'. 01060026
010700        88 KOHLS-CARES-FOR-KIDS                  VALUE '0020547'. 01070026
010800**  05  PV-GIFT-CERTIFICATE-PAYMNT.                               01080026
010900**      10  PV-GC-ACCT-PREFIX        PIC X(05)   VALUE '00041'.   01090026
011000**      10  PV-GC-ACCT-YEAR          PIC X(02)   VALUE SPACES.    01100026
011400    05  PV-AR-TRADE-DESCRIPTION      PIC X(32)   VALUE            01140026
011500        'ACCOUNTS RECEIVABLE TRADE      '.                        01150026
011600                                                                  01160026
011700 01 PS-PROGRAM-SWITCHES.                                          01170026
011800    05 PS-END-OF-FILE-IND            PIC  X(01)    VALUE ' '.     01180026
011900       88 PS-EOF                                   VALUE 'E'.     01190026
012000    05 PS-ERROR-FOUND-IND            PIC  X(01)    VALUE ' '.     01200026
012100       88 PS-ERROR-FOUND                           VALUE 'F'.     01210026
012200       88 PS-ERROR-NOT-FOUND                       VALUE 'N'.     01220026
012300                                                                  01230026
012310*-----------------------------------------------------------      01231033
012320* OUTPUT FILE LAYOUT                                              01232033
012330*-----------------------------------------------------------      01233033
012400     COPY ARRD022.                                                01240026
012500                                                                  01250026
012510*-----------------------------------------------------------      01251033
012520* INPUT FILE LAYOUT                                               01252033
012530*-----------------------------------------------------------      01253033
012600     COPY ARWS030.                                                01260026
012700                                                                  01270026
012800*----------------------------------------------------------*      01280026
012900***  CALENDAR ROUTINE.                                            01290026
013000*----------------------------------------------------------*      01300026
013100     COPY DPWS500.                                                01310026
013200                                                                  01320026
013300********************************************************          01330026
013400 PROCEDURE DIVISION.                                              01340026
013500********************************************************          01350026
013600 0000-MAIN-LINE.                                                  01360026
013700         PERFORM 1000-INITIALIZATION   THRU 1000-EXIT.            01370026
013800         PERFORM 2000-PROCESS-INPUT    THRU 2000-EXIT             01380026
013900                              UNTIL PS-EOF.                       01390026
014000         PERFORM 3000-FINISH           THRU 3000-EXIT.            01400026
014100 0000-EXIT.   STOP RUN.                                           01410026
014200                                                                  01420026
014300 1000-INITIALIZATION.                                             01430026
014400       OPEN INPUT  SELECT-GL-UPDATE-FILE                          01440026
014500            OUTPUT GL-INTERFACE-FILE.                             01450026
014600                                                                  01460026
014700       READ SELECT-GL-UPDATE-FILE INTO                            01470026
014800                            AR030-SELECT-GL-UPDATE-RECORD         01480026
014900          AT END                                                  01490026
015000            SET PS-EOF    TO TRUE                                 01500026
015100            DISPLAY '***********************************'         01510026
015200            DISPLAY 'FROM ARKUT030: INPUT FILE IS EMPTY.'         01520026
015300            DISPLAY '***********************************'         01530026
015400       END-READ.                                                  01540026
015500                                                                  01550026
015600       INITIALIZE DPG51 DPG52                                     01560026
015700                  DPG53 DPG54                                     01570026
015800                  DPG55 DPG56.                                    01580026
015900                                                                  01590026
016000       ACCEPT DPG51-SYSTEM-DATE  FROM  DATE.                      01600026
016100       SET  DPG51-FISCAL-454-CALENDAR  TO  TRUE.                  01610026
016200       MOVE DPG51-SYSTEM-DATE-YR  TO  DPG52-GREG-DATE-YR.         01620026
016300       MOVE DPG51-SYSTEM-DATE-MO  TO  DPG52-GREG-DATE-MO.         01630026
016400       MOVE DPG51-SYSTEM-DATE-DY  TO  DPG52-GREG-DATE-DY.         01640026
016500       SET  DPG52-LK-DTE-GREG     TO  TRUE.                       01650026
016600                                                                  01660026
016700       CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53  01670026
016800                                               DPG54 DPG55 DPG56. 01680026
016900       IF ((DPG54-SEVERE-ERROR)                                   01690026
017000               OR (DPG54-WARNING-ERROR))                          01700026
017100           DISPLAY '** ABEND **'                                  01710026
017200           DISPLAY PC-PROGRAM-NAME                                01720026
017300           ' - CALENDAR ROUTINE '                                 01730026
017400                       'ERROR ON CURRENT DATE LOOKUP'             01740026
017500           DISPLAY PC-PROGRAM-NAME                                01750026
017600           ' - CALENDAR ROUTINE '                                 01760026
017700                       'ERROR INDICATOR = '  DPG54-ERROR-IND      01770026
017800           DISPLAY PC-PROGRAM-NAME                                01780026
017900           ' - CALENDAR ROUTINE '                                 01790026
018000                       'ERROR MESSAGE = '  DPG54-ERROR-MESSAGE    01800026
018100           MOVE +4019  TO  ABEND-CODE                             01810026
018200           CALL 'ILBOABN0' USING ABEND-CODE                       01820026
018300       END-IF.                                                    01830026
018400                                                                  01840026
018500****** MOVE DPG56-FISCAL-YEAR-NBR  TO  PV-GC-ACCT-YEAR.           01850026
018600                                                                  01860026
018700 1000-EXIT.  EXIT.                                                01870026
018800                                                                  01880026
018900                                                                  01890026
019000 2000-PROCESS-INPUT.                                              01900026
019100      INITIALIZE AR022-GL-INTERFACE.                              01910026
019200      IF AR030-GL-SEQUENCE-NBR = 000000  OR                       01920026
019300         AR030-GL-SEQUENCE-NBR = 999999                           01930026
019400           PERFORM 2500-READ-INPUT-FILE   THRU 2500-EXIT          01940026
019500           GO TO 2000-EXIT                                        01950026
019600      END-IF.                                                     01960026
019700      MOVE PC-COMPANY                TO AR022-COMPANY.            01970026
019800      SET  AR022-SOURCE-KOHLS-CREDIT TO TRUE.                     01980026
019900      MOVE AR030-TR-ACCOUNT          TO PV-GL-ACCT-NBR            01990026
020000                                        PV-GL-ACCT-NBR-REFORMAT.  02000026
020100      MOVE PV-ACCOUNT-7              TO AR022-ACCOUNT.            02010026
020200                                                                  02020026
020300      IF EMPL-SALE-RTN-DISCOUNT OR                                02030026
020400         GIFT-CERT-PAYMENT-2000 OR                                02040026
020500         GIFT-CERT-PAYMENT-1999 OR                                02050026
020600         GIFT-CARD-PAYMENT OR                                     02060026
020700         KOHLS-CARES-FOR-KIDS                                     02070026
020800         MOVE PC-900                 TO AR022-STORE               02080026
020900      ELSE                                                        02090026
021000**       IF BAD-MEDIA-WRITEOFF OR WRITEOFF-DISPUTED-AMT           02100026
021100**          MOVE AR030-TR-DEPARTMENT    TO AR022-STORE            02110028
021300**       ELSE                                                     02130026
021400**           MOVE PC-880             TO AR022-STORE               02140026
021500         IF (AR030-TR-DEPARTMENT = ZEROES)  OR                    02150026
021600            (AR030-TR-DEPARTMENT = SPACES)  OR                    02160026
021700            (AR030-TR-DEPARTMENT NOT NUMERIC) OR                  02170026
021800            (ACCOUNTS-RECEIVABLE-TRADE)                           02180026
021900            MOVE PC-880                 TO AR022-STORE            02190026
022000         ELSE                                                     02200026
022100             MOVE AR030-TR-DEPARTMENT   TO AR022-STORE            02210028
022300         END-IF                                                   02230026
022400      END-IF.                                                     02240026
022500                                                                  02250026
022600      MOVE AR030-GL-TR-AMT           TO AR022-AMOUNT.             02260026
022700      IF AR030-GL-TR-AMT IS POSITIVE                              02270026
022800         SET AR022-DEBIT  TO TRUE                                 02280026
022900      ELSE                                                        02290026
023000         SET AR022-CREDIT TO TRUE                                 02300026
023100      END-IF.                                                     02310026
023200      MOVE AR030-GL-TR-APPLY-DATE    TO AR022-POSTING-DATE.       02320026
023300                                                                  02330026
023400      IF ACCOUNTS-RECEIVABLE-TRADE                                02340026
023500         MOVE PV-AR-TRADE-DESCRIPTION   TO AR022-DESCRIPTION      02350026
023600      ELSE                                                        02360026
023700         MOVE AR030-GL-TR-DESCRIPTION   TO AR022-DESCRIPTION      02370026
023800      END-IF.                                                     02380026
023900                                                                  02390026
024000      WRITE GL-INTERFACE-RECORD FROM AR022-GL-INTERFACE.          02400026
024100                                                                  02410026
024200      PERFORM 2500-READ-INPUT-FILE   THRU 2500-EXIT.              02420026
024300 2000-EXIT.  EXIT.                                                02430026
024400                                                                  02440026
024500 2500-READ-INPUT-FILE.                                            02450026
024600       INITIALIZE AR030-SELECT-GL-UPDATE-RECORD.                  02460026
024700       READ SELECT-GL-UPDATE-FILE INTO                            02470026
024800                            AR030-SELECT-GL-UPDATE-RECORD         02480026
024900         AT END                                                   02490026
025000            SET PS-EOF    TO TRUE                                 02500026
025100       END-READ.                                                  02510026
025200 2500-EXIT.  EXIT.                                                02520026
025300                                                                  02530026
025400 3000-FINISH.                                                     02540026
025500       CLOSE SELECT-GL-UPDATE-FILE                                02550026
025600             GL-INTERFACE-FILE.                                   02560026
025700 3000-EXIT.  EXIT.                                                02570026
025800                                                                  02580026
