000100*************************                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*************************                                         00030001
000400 PROGRAM-ID.      SNKUP007.                                       00040001
000500 AUTHOR.          PAT LEE.                                        00050001
000600 DATE-WRITTEN.    05/28/91.                                       00060001
000700******************************************************************00070001
000800*  CREATES A FILE OF ADVANCE SHIP NOTICE NUMBERS THAT HAVE A SHIP*00080001
000900*  DATE WHICH IS GREATER THAN 21 DAYS PAST THE CURRENT DATE. THE *00090001
001000*  FILE WILL BE USED AS INPUT TO DELETE PROGRAMS.                *00100001
001100*                                                                *00110001
001200*  CHANGED 05/06/93 BY N. PALATNIK                               *00120001
001300*                                      CHANGED CODE TO CREATE A  *00130001
001400*  FILE OF ASN'S  THAT HAVE A CANCEL DATE WHICH IS GREATER THAN  *00140001
001500*  45 DAYS PAST THE CURRENT DATE. ADDED IMS CODE TO GET THE      *00150001
001600*  CANCEL OR EXTENDED CANCEL DATE FROM PO IMS DATABASE.          *00160001
001700******************************************************************00170001
001800* CHANGED 11/07/14 BY PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)       * 00180001
001900*              CHANGES THRU OUT THE PROGRAM TO INCREASE SIZE OF * 00190001
002000*              PO# FROM 7 DIGITS TO 8 DIGITS.                   * 00200001
002100*              CHANGE TAGGED WITH *PS 11/07/2014                * 00210001
002200*                                                               * 00220001
002210* CHANGED 11/04/2021    BY JIM HUNTER      WR: CHG0263627         00221001
002220* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00222001
002230* MAKING THE CALL DYNAMIC VS STATIC.                              00223001
002240***************************************************************** 00224001
002250 ENVIRONMENT DIVISION.                                            00225001
002260 CONFIGURATION SECTION.                                           00226001
002270 SOURCE-COMPUTER. IBM-3090.                                       00227001
002280 OBJECT-COMPUTER. IBM-3090.                                       00228001
002290                                                                  00229001
002300 INPUT-OUTPUT SECTION.                                            00230001
002400 FILE-CONTROL.                                                    00240001
002500                                                                  00250001
002600     SELECT ASNHDR-DELETE-FILE                                    00260001
002700            ASSIGN TO OUT01.                                      00270001
002800                                                                  00280001
002900/                                                                 00290001
003000***************                                                   00300001
003100 DATA DIVISION.                                                   00310001
003200***************                                                   00320001
003300 FILE SECTION.                                                    00330001
003400                                                                  00340001
003500 FD  ASNHDR-DELETE-FILE                                           00350001
003600     RECORDING MODE IS F                                          00360001
003700     LABEL RECORDS ARE STANDARD                                   00370001
003800     RECORD CONTAINS 5 CHARACTERS                                 00380001
003900     BLOCK CONTAINS 0 RECORDS.                                    00390001
004000                                                                  00400001
004100 01  ASNHDR-DELETE-RECORD        PIC X(5).                        00410001
004200                                                                  00420001
004300/                                                                 00430001
004400 WORKING-STORAGE SECTION.                                         00440001
004500/                                                                 00450001
004600****************************************************************  00460001
004700 01  FILLER                           PIC X(08) VALUE 'BEGIN WS'. 00470001
004800****************************************************************  00480001
004900/                                                                 00490001
005000 01  CD-CPU-DATE.                                                 00500001
005100     05  CD-CPU-DATE-YY               PIC 9(02)      VALUE ZEROS. 00510001
005200     05  CD-CPU-DATE-MM               PIC 9(02)      VALUE ZEROS. 00520001
005300     05  CD-CPU-DATE-DD               PIC 9(02)      VALUE ZEROS. 00530001
005400                                                                  00540001
005500 01  PC-PROGRAM-CONTROLS.                                         00550001
005600     05  PC-Y                         PIC  X(01)     VALUE 'Y'.   00560001
005700     05  PC-POS-1                     PIC S9(04)     VALUE +1     00570001
005800                                                     COMP-3.      00580001
005900     05  PC-7                         PIC S9(01)     VALUE +7.    00590001
006000*PS 11/07/2014 CHANGE STARTS                                      00600001
006100     05  PC-8                         PIC S9(01)     VALUE +8.    00610001
006200*PS 11/07/2014 CHANGE ENDS                                        00620001
006300     05  PC-POS-19                    PIC S9(04)     VALUE +19    00630001
006400                                                     COMP-3.      00640001
006500     05  PC-POS-20                    PIC S9(04)     VALUE +20    00650001
006600                                                     COMP-3.      00660001
006700     05  PC-POS-90                    PIC S9(04)     VALUE +90    00670001
006800                                                     COMP-3.      00680001
006900     05  PC-NEG-45                    PIC S9(04)     VALUE -45    00690001
007000                                                     COMP-3.      00700001
007100     05  PC-NEG-60                    PIC S9(04)     VALUE -60    00710001
007200                                                     COMP-3.      00720001
007300     05  PC-SUCCESSFUL                PIC S9(04)     VALUE +0     00730001
007400                                                     COMP SYNC.   00740001
007500     05  PC-ROW-NOT-FOUND             PIC S9(04)     VALUE +100   00750001
007600                                                     COMP SYNC.   00760001
007700     05  PC-DUPLICATE                 PIC S9(04)     VALUE -811   00770001
007800                                                     COMP SYNC.   00780001
007900     05  PC-INITIAL-DTE               PIC X(10)                   00790001
008000                                             VALUE '0001-01-01'.  00800001
008100     05  PC-A                        PIC  X(01)    VALUE 'A'.     00810001
008200**   05  PC-DPKUT105                 PIC X(10)     VALUE          00820001
008300**                                                 'DPKUT105  '.  00830001
008400     05  PC-DPKUT500                 PIC X(10)     VALUE          00840001
008500                                                   'DPKUT500  '.  00850001
008600/                                                                 00860001
008700 01  PROGRAM-SWITCHES.                                            00870001
008800     05  PS-END-OF-ASNORD-INFO-SW    PIC  X(01)    VALUE 'N'.     00880001
008900         88  PS-END-OF-ASNORD-INFO                 VALUE 'Y'.     00890001
009000     05  PS-END-OF-ASNHDR-INFO-SW    PIC  X(01)    VALUE 'N'.     00900001
009100         88  PS-END-OF-ASNHDR-INFO                 VALUE 'Y'.     00910001
009200         88  PS-NOT-END-OF-ASNHDR-INFO             VALUE 'N'.     00920001
009300     05  PS-END-OF-OLD-ASN-INFO-SW   PIC  X(01)    VALUE 'N'.     00930001
009400         88  PS-END-OF-OLD-ASN-INFO                VALUE 'Y'.     00940001
009500/                                                                 00950001
009600 01  PW-PROGRAM-WORKAREA.                                         00960001
009700     05  PW-CAN-DTE-CCYYMMDD.                                     00970001
009800         10  PW-CAN-DTE-CC            PIC  9(02)     VALUE ZEROS. 00980001
009900         10  PW-CAN-DTE-YY            PIC  9(02)     VALUE ZEROS. 00990001
010000         10  FILLER                   PIC  X(01)     VALUE '-'.   01000001
010100         10  PW-CAN-DTE-MM            PIC  9(02)     VALUE ZEROS. 01010001
010200         10  FILLER                   PIC  X(01)     VALUE '-'.   01020001
010300         10  PW-CAN-DTE-DD            PIC  9(02)     VALUE ZEROS. 01030001
010400     05  PW-CAN-DTE-REDF REDEFINES                                01040001
010500         PW-CAN-DTE-CCYYMMDD      PIC  X(10).                     01050001
010600     05  PW-CURRENT-DTE-CCYYMMDD.                                 01060001
010700         10  PW-CURRENT-DTE-CC        PIC  9(02)     VALUE ZEROS. 01070001
010800         10  PW-CURRENT-DTE-YY        PIC  9(02)     VALUE ZEROS. 01080001
010900         10  FILLER                   PIC  X(01)     VALUE '-'.   01090001
011000         10  PW-CURRENT-DTE-MM        PIC  9(02)     VALUE ZEROS. 01100001
011100         10  FILLER                   PIC  X(01)     VALUE '-'.   01110001
011200         10  PW-CURRENT-DTE-DD        PIC  9(02)     VALUE ZEROS. 01120001
011300     05  PW-CURRENT-DTE-REDF REDEFINES                            01130001
011400         PW-CURRENT-DTE-CCYYMMDD      PIC  X(10).                 01140001
011500     05  PW-CURRENT-PARA              PIC  X(35)     VALUE SPACES.01150001
011600     05  PW-ASNHDR-WRITTEN            PIC S9(09)     VALUE +0     01160001
011700                                                     COMP-3.      01170001
011710     05  PW-ASNHDR-MATCHED            PIC S9(09)     VALUE +0     01171026
011720                                                     COMP-3.      01172025
011730     05  PW-ASNHDR-UNMTCHD            PIC S9(09)     VALUE +0     01173026
011740                                                     COMP-3.      01174025
011741     05  PW-ASNHDR-UNMTCHD-WRTN       PIC S9(09)     VALUE +0     01174135
011742                                                     COMP-3.      01174235
011750     05  PW-ASNHDR-PO-FOUND           PIC S9(09)     VALUE +0     01175026
011760                                                     COMP-3.      01176025
011770     05  PW-MATCH-DATE-ELIGIBLE       PIC S9(09)     VALUE +0     01177027
011780                                                     COMP-3.      01178027
011800     05  PW-OPERCO-NBR                PIC  X(03)     VALUE SPACES.01180001
011900     05  PW-EDI-VEND-ID               PIC  X(17)     VALUE SPACES.01190001
012000     05  PW-ASNHDR-NBR                PIC  X(30)     VALUE SPACES.01200001
012100     05  PW-ASNHDR-ID                 PIC S9(09)     COMP         01210001
012200                                                     VALUE ZERO.  01220001
012300     05  PV-ASNHDR-ID                 PIC S9(09) COMP             01230001
012400                                                     VALUE ZERO.  01240001
012500     05  PV-CURR-PO-NBR               PIC  X(22)     VALUE SPACES.01250001
012600     05  PV-CURR-OPERCO-NBR           PIC  X(02)     VALUE '03'.  01260001
012700     05  PW-SHIP-DTE                  PIC  X(10)     VALUE SPACES.01270001
012800                                                                  01280001
012900     05  PV-MATCHED-DAYS              PIC  S9(10) COMP-3.         01290001
013000     05  PV-UNMATCHED-DAYS            PIC  S9(10) COMP-3.         01300001
013100     05  PV-ASN-HDR-TMST-DAYS         PIC  S9(10) COMP-3.         01310001
013200                                                                  01320001
013300     05  PV-DAYS-DISPLAY              PIC  9(04).                 01330001
013301     05  PV-ASN-MESSAGE-DISPLAY       PIC X(100).                 01330120
013310                                                                  01331001
013320     05  PV-MATCHED-DATE              PIC  X(10)     VALUE SPACES.01332001
013330     05  PV-UNMATCHED-DATE            PIC  X(10)     VALUE SPACES.01333001
013331     05  PV-ASN-HDR-TO-DATE           PIC  X(10)     VALUE SPACES.01333107
013332     05  PV-ASN-HDR-CRE-TMST.                                     01333207
013333         10   PV-TO-YYMMDD  PIC X(10)  VALUE ZEROES.              01333307
013338         10   FILLER        PIC X(16)  VALUE '-23.59.59.999999'.  01333807
013339                                                                  01333901
013340     05  PV-MMDDYY.                                               01334001
013341         10  PV-MM                   PIC  9(02)    VALUE ZERO.    01334101
013342         10  PV-DD                   PIC  9(02)    VALUE ZERO.    01334201
013343         10  PV-YY                   PIC  9(02)    VALUE ZERO.    01334301
013344     05  PV-CANCEL-DATE.                                          01334401
013345         10  PV-CD-YY                PIC  9(02)    VALUE ZERO.    01334501
013346         10  PV-CD-MM                PIC  9(02)    VALUE ZERO.    01334601
013347         10  PV-CD-DD                PIC  9(02)    VALUE ZERO.    01334701
013350*PS 11/07/2014 CHANGE STARTS                                      01335001
013360     05  PV-UNPK-PONUMB              PIC  9(08)    VALUE ZEROS.   01336001
013370*PS 11/07/2014 CHANGE ENDS                                        01337001
013380     05  PV-INTEGER-PO-NBR           PIC S9(09)    COMP           01338001
013390                                                   VALUE ZEROES.  01339001
013400     05  PV-DATE1-CCYYMMDD.                                       01340001
013500         10  PV-DATE1-CC             PIC  9(02)    VALUE ZEROES.  01350001
013600         10  PV-DATE1-YY             PIC  9(02)    VALUE ZEROES.  01360001
013700         10  PV-DATE1-MM             PIC  9(02)    VALUE ZEROES.  01370001
013800         10  PV-DATE1-DD             PIC  9(02)    VALUE ZEROES.  01380001
013900     05  PV-DTE-MINUS45-CCYYMMDD.                                 01390001
014000         10  PV-DTE-MINUS45-CC      PIC  9(02)    VALUE ZEROES.   01400001
014100         10  PV-DTE-MINUS45-YY      PIC  9(02)    VALUE ZEROES.   01410001
014200         10  FILLER                 PIC  X(01)    VALUE '-'.      01420001
014300         10  PV-DTE-MINUS45-MM      PIC  9(02)    VALUE ZEROES.   01430001
014400         10  FILLER                 PIC  X(01)    VALUE '-'.      01440001
014500         10  PV-DTE-MINUS45-DD      PIC  9(02)    VALUE ZEROES.   01450001
014600     05  PV-DTE-MINUS45-REDF REDEFINES                            01460001
014700         PV-DTE-MINUS45-CCYYMMDD      PIC  X(10).                 01470001
014800                                                                  01480001
014900     05  PV-DTE-MINUS60-CCYYMMDD.                                 01490001
015000         10  PV-DTE-MINUS60-CC      PIC  9(02)    VALUE ZEROES.   01500001
015100         10  PV-DTE-MINUS60-YY      PIC  9(02)    VALUE ZEROES.   01510001
015200         10  FILLER                 PIC  X(01)    VALUE '-'.      01520001
015300         10  PV-DTE-MINUS60-MM      PIC  9(02)    VALUE ZEROES.   01530001
015400         10  FILLER                 PIC  X(01)    VALUE '-'.      01540001
015500         10  PV-DTE-MINUS60-DD      PIC  9(02)    VALUE ZEROES.   01550001
015600     05  PV-DTE-MINUS60-REDF REDEFINES                            01560001
015700         PV-DTE-MINUS60-CCYYMMDD    PIC  X(10).                   01570001
015800                                                                  01580001
015900     05  PS-NO-PO-IND               PIC  X(01)    VALUE 'N'.      01590001
016000         88  PS-NO-PO-FOUND                        VALUE 'N'.     01600001
016100         88  PS-PO-FOUND                           VALUE 'Y'.     01610001
016200     05  DISPLAY-ASNHDR-ID           PIC  9(15)    VALUE ZEROES.  01620001
016201     05  DISPLAY-PO-NBR              PIC  9(08)    VALUE ZEROES.  01620120
016210     05  DISPLAY-ASNHDR-NBR          PIC  9(30)    VALUE ZEROES.  01621020
016300/                                                                 01630001
016400 01  ABEND-CODE                       PIC S9(04)     VALUE +0     01640001
016500                                                     COMP SYNC.   01650001
016600     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 01660001
016700     88  ABEND-4002-READ-ERROR                       VALUE +4002. 01670001
016800     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 01680001
016900     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 01690001
017000     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 01700001
017100     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 01710001
017200     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 01720001
017300     88  ABEND-4008-DATS-ERROR                       VALUE +4008. 01730001
017400     88  ABEND-4009-KEY-DATS-ERROR                   VALUE +4009. 01740001
017500     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 01750001
017600/                                                                 01760001
017700*                                                                 01770001
017800*    NUMERIC EDIT LAYOUT                                          01780001
017900***  COPY DPWS105.                                                01790001
018000                                                                  01800001
018100     COPY DPWS500.                                                01810001
018200                                                                  01820001
018300     COPY DPWS010I.                                               01830001
018400 EJECT                                                            01840001
018500     COPY MAWS900.                                                01850001
018600/                                                                 01860001
018700*  ASNHDR DELETE RECORD LAYOUT                                    01870001
018800*                                                                 01880001
018900     COPY SNRD002O.                                               01890001
019000/                                                                 01900001
019100*  VE ADVANCE SHIP NOTICE TABLE LAYOUT                            01910001
019200*                                                                 01920001
019300     EXEC SQL                                                     01930001
019400         INCLUDE TASNHDR                                          01940001
019500     END-EXEC.                                                    01950001
019600/                                                                 01960001
019700* DB2 ADVANCE SHIP NOTICE ORDER TABLE LAYOUT                      01970001
019800*                                                                 01980001
019900     EXEC SQL                                                     01990001
020000         INCLUDE TASNORD                                          02000001
020100     END-EXEC.                                                    02010001
020200/                                                                 02020001
020300* DB2 PO  TABLE LAYOUT                                            02030001
020400*                                                                 02040001
020500     EXEC SQL                                                     02050001
020600         INCLUDE TPURCHS                                          02060001
020700     END-EXEC.                                                    02070001
020800/                                                                 02080001
020900* DB2 PO  PLANNED SHIPMENT TABLE                                  02090001
021000*                                                                 02100001
021100     EXEC SQL                                                     02110001
021200         INCLUDE TPLNSHP                                          02120001
021300     END-EXEC.                                                    02130001
021400/                                                                 02140001
021500******************************************************************02150001
021600*  DB2 TABLE DECLARATION - WMS INTEGRATION TYPE                   02160001
021700*      (WST_INTGRTN_TYP)                                          02170001
021800******************************************************************02180001
021900     EXEC SQL                                                     02190001
022000          INCLUDE WST00008                                        02200001
022100     END-EXEC.                                                    02210001
022200                                                                  02220001
022300******************************************************************02230001
022400*  DB2 TABLE DECLARATION - WMS ATTRIBUTE DEFINITION               02240001
022500*      (WST_ATTR_DEFN)                                            02250001
022600******************************************************************02260001
022700     EXEC SQL                                                     02270001
022710          INCLUDE WST00009                                        02271001
022720     END-EXEC.                                                    02272001
022730                                                                  02273001
022740******************************************************************02274001
022750*  DB2 TABLE DECLARATION - WMS ATTRIBUTE ELEMENT                  02275001
022760*      (WST_ATTR_ELEM)                                            02276001
022770******************************************************************02277001
022780     EXEC SQL                                                     02278001
022790          INCLUDE WST00010                                        02279001
022800     END-EXEC.                                                    02280001
022801                                                                  02280101
022802* DB2 COMMUNICATION AREA.                                         02280201
022803*                                                                 02280301
022804     EXEC SQL                                                     02280401
022805         INCLUDE SQLCA                                            02280501
022806     END-EXEC.                                                    02280601
022807/                                                                 02280701
022808* DB2 COMMUNICATION AREA 2                                        02280801
022809*                                                                 02280901
022810     COPY SQLCA2.                                                 02281001
022820/                                                                 02282001
022830     EXEC SQL                                                     02283001
022840      DECLARE ASNORD_CURSOR CURSOR FOR                            02284001
022850       SELECT DISTINCT                                            02285001
022860              B.ASNHDR_ID                                         02286001
022870            , B.PO_NBR                                            02287001
022880            , A.ASNHDR_NBR                                        02288021
022890         FROM TASNHDR A                                           02289001
022900             ,TASNORD B                                           02290001
023000        WHERE A.ASNHDR_ID = B.ASNHDR_ID                           02300001
023100          AND B.MTCH_PO_CDE = 'Y'                                 02310001
023110          AND A.ASNHDR_TMST < :ASNHDR-ASNHDR-TMST                 02311019
023200        ORDER BY B.ASNHDR_ID                                      02320001
023210      WITH UR                                                     02321015
023300     END-EXEC.                                                    02330001
023400/                                                                 02340001
023500     EXEC SQL                                                     02350001
023600      DECLARE OLD_ASN_CURSOR CURSOR FOR                           02360001
023700       SELECT DISTINCT A.ASNHDR_ID                                02370001
023710             , B.PO_NBR                                           02371023
023720             , A.ASNHDR_NBR                                       02372023
023800         FROM TASNHDR A                                           02380001
023900             ,TASNORD B                                           02390001
024000        WHERE A.ASNHDR_ID = B.ASNHDR_ID                           02400001
024100          AND B.MTCH_PO_CDE = 'U'                                 02410001
024200          AND A.CRE_DTE < :PV-UNMATCHED-DATE                      02420001
024300     END-EXEC.                                                    02430001
024400/                                                                 02440001
024500****************************************************************  02450001
024600 PROCEDURE DIVISION.                                              02460001
024700****************************************************************  02470001
024800                                                                  02480001
024900***************************************************************** 02490001
025000*     MAINLINE                                                  * 02500001
025100*                                                               * 02510001
025200*   - MAINLINE PROCESSING                                       * 02520001
025300***************************************************************** 02530001
025400 0000-MAINLINE.                                                   02540001
025500     MOVE '0000-MAINLINE                  '                       02550001
025600                                 TO PW-CURRENT-PARA.              02560001
025700*    DISPLAY PW-CURRENT-PARA.                                     02570001
025800                                                                  02580001
025900     INITIALIZE PV-DATE1-CCYYMMDD.                                02590001
026000                                                                  02600001
026100******************************************************************02610001
026200                                                                  02620001
026300     INITIALIZE SN002O-ASN-DELETE-RECORD.                         02630001
026400                                                                  02640001
026500     OPEN OUTPUT ASNHDR-DELETE-FILE.                              02650001
026600                                                                  02660001
026700     PERFORM S010-SELECT-PROCESSING-DATES.                        02670001
026800     PERFORM S025-OPEN-ASNORD-CURSOR.                             02680001
026900     PERFORM S050-FETCH-ASNORD-PO.                                02690001
027000                                                                  02700001
027100     PERFORM                                                      02710001
027101       UNTIL PS-END-OF-ASNORD-INFO                                02710112
027102                                                                  02710217
027110       PERFORM Z025-GET-PO-INFO                                   02711012
027500       PERFORM E100-PROCESS-HEADER-INFO                           02750015
027600                                                                  02760015
028100       PERFORM S050-FETCH-ASNORD-PO                               02810015
028200                                                                  02820001
028300     END-PERFORM.                                                 02830001
028400                                                                  02840001
028500     PERFORM S325-CLOSE-ASNORD-CURSOR.                            02850001
028600                                                                  02860001
028700* RETRIEVE OLD UNMATCHED ASNS FOR DELETION                        02870001
028800     DISPLAY '** NOW PROCESSING OLD UNMATCHED ASNS **'.           02880001
028900     PERFORM S400-OPEN-OLD-ASN-CURSOR.                            02890001
029000                                                                  02900001
029100     PERFORM S425-FETCH-OLD-ASN                                   02910001
029200       UNTIL PS-END-OF-OLD-ASN-INFO.                              02920001
029300                                                                  02930001
029400     PERFORM S450-CLOSE-OLD-ASN-CURSOR.                           02940001
029500*                                                                 02950001
029600     DISPLAY '*******************************************'.       02960001
029700     DISPLAY 'ASNHDR MATCH FETCHED...: '  PW-ASNHDR-MATCHED.      02970026
029730     DISPLAY 'PURCHASE ORDER CA OR CM: '  PW-ASNHDR-PO-FOUND.     02973026
029732     DISPLAY 'ASNHDR MATCH WRITTEN...: '  PW-MATCH-DATE-ELIGIBLE. 02973235
029733     DISPLAY 'ASNHDR UNMTCHD FETCHED.: '  PW-ASNHDR-UNMTCHD.      02973333
029734     DISPLAY 'ASNHDR UNMTCHD WRITTEN.: '  PW-ASNHDR-UNMTCHD-WRTN. 02973435
029740     DISPLAY 'ASNHDR RECORDS WRITTEN.: '  PW-ASNHDR-WRITTEN.      02974026
029800     DISPLAY '*******************************************'.       02980001
029900                                                                  02990001
030000     CLOSE ASNHDR-DELETE-FILE.                                    03000001
030100                                                                  03010001
030200     GOBACK.                                                      03020001
030300/                                                                 03030001
030400******************************************************************03040001
030500*                                                                *03050001
030600*                                                                *03060001
030700******************************************************************03070001
030800 E100-PROCESS-HEADER-INFO.                                        03080001
030900*                                                                 03090001
031000     MOVE 'E100-PROCESS-HEADER-INFO '                             03100001
031100                                 TO PW-CURRENT-PARA.              03110001
031200*    DISPLAY PW-CURRENT-PARA.                                     03120001
031300                                                                  03130001
031400     IF SQLCODE = ZERO                                            03140001
031500         SET PS-PO-FOUND         TO TRUE                          03150001
031600         IF  PV-MATCHED-DATE  > PW-CAN-DTE-REDF                   03160001
031700             PERFORM Z200-WRITE-ASNHDR-INFO                       03170001
031701             ADD +1 TO PW-MATCH-DATE-ELIGIBLE                     03170133
031800         END-IF                                                   03180001
031900     END-IF.                                                      03190001
032000                                                                  03200001
032100/                                                                 03210001
032200 S010-SELECT-PROCESSING-DATES.                                    03220001
032300     MOVE 'S010-SELECT-PROCESSING-DATES'                          03230001
032400                                 TO PW-CURRENT-PARA.              03240001
032500                                                                  03250001
032600     EXEC SQL                                                     03260001
032700        SELECT  INT(C.ATTR_ELEM_NBR)                              03270001
032800             ,  INT(D.ATTR_ELEM_NBR)                              03280001
032900             ,  INT(E.ATTR_ELEM_NBR)                              03290001
033000             ,  CURRENT DATE - C.ATTR_ELEM_NBR DAYS               03300007
033100             ,  CURRENT DATE - D.ATTR_ELEM_NBR DAYS               03310007
033200             ,  CURRENT DATE - E.ATTR_ELEM_NBR DAYS               03320007
033300          INTO  :PV-MATCHED-DAYS                                  03330001
033400              , :PV-UNMATCHED-DAYS                                03340001
033500              , :PV-ASN-HDR-TMST-DAYS                             03350001
033600              , :PV-MATCHED-DATE                                  03360001
033700              , :PV-UNMATCHED-DATE                                03370001
033800              , :PV-ASN-HDR-TO-DATE                               03380007
033900          FROM                                                    03390001
034000                WST_INTGRTN_TYP  A                                03400001
034100             ,  WST_ATTR_DEFN    B                                03410001
034200             ,  WST_ATTR_ELEM    C                                03420001
034300             ,  WST_ATTR_ELEM    D                                03430001
034400             ,  WST_ATTR_ELEM    E                                03440001
034500        WHERE                                                     03450001
034600              A.INTGRTN_TYP_CDE   = 'ASNPRGDAYS'                  03460001
034700          AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE             03470001
034800          AND B.ATTR_DEFN_SEQ_NBR = 1                             03480001
034900          AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE             03490001
035000          AND C.ATTR_DEFN_SEQ_NBR = 1                             03500001
035100          AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE             03510001
035200          AND D.ATTR_DEFN_SEQ_NBR = 2                             03520001
035300          AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE             03530001
035400          AND E.ATTR_DEFN_SEQ_NBR = 3                             03540001
035500     END-EXEC.                                                    03550001
035600                                                                  03560001
035700     EVALUATE TRUE                                                03570001
035800       WHEN SQLCODE = PC-SUCCESSFUL                               03580001
035900         MOVE     PV-MATCHED-DAYS  TO PV-DAYS-DISPLAY             03590001
036000         DISPLAY 'PV-MATCHED-DAYS: ' PV-DAYS-DISPLAY              03600001
036100         DISPLAY 'PV-MATCHED-DATE: ' PV-MATCHED-DATE              03610001
036200         DISPLAY ' '                                              03620009
036300         MOVE    PV-UNMATCHED-DAYS TO PV-DAYS-DISPLAY             03630001
036400         DISPLAY 'PV-UNMATCHED-DAYS: ' PV-DAYS-DISPLAY            03640001
036500         DISPLAY 'PV-UNMATCHED-DATE: ' PV-UNMATCHED-DATE          03650001
036510         DISPLAY ' '                                              03651009
036600                                                                  03660001
036700         MOVE    PV-ASN-HDR-TMST-DAYS TO PV-DAYS-DISPLAY          03670001
036800         DISPLAY 'PV-ASN-HDR-TMST-DAYS: ' PV-DAYS-DISPLAY         03680010
036910         MOVE     PV-ASN-HDR-TO-DATE TO PV-TO-YYMMDD              03691007
036921         MOVE  PV-ASN-HDR-CRE-TMST TO ASNHDR-ASNHDR-TMST          03692116
036922         DISPLAY 'ASNHDR-ASNHDR-TMST..: ' ASNHDR-ASNHDR-TMST      03692216
036930         DISPLAY ' '                                              03693009
037500       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    03750001
037600             DISPLAY '******************************************' 03760001
037700             DISPLAY  PW-CURRENT-PARA                             03770001
037800             DISPLAY 'WARNING ISSUED ON SELECT WST_ATTR_ELEM    ' 03780001
037900             DISPLAY '******************************************' 03790001
038000             PERFORM Z800-SQL-WARNING                             03800001
038100                                                                  03810001
038200       WHEN  SQLCODE < ZERO                                       03820001
038300             DISPLAY '******************************************' 03830001
038400             DISPLAY  PW-CURRENT-PARA                             03840001
038500             DISPLAY 'ERROR ISSUED ON SELECT OF WST_ATTR_ELEM   ' 03850001
038600             DISPLAY '******************************************' 03860001
038700             PERFORM Z900-SQL-ERROR                               03870001
038800                                                                  03880001
038900     END-EVALUATE.                                                03890001
039000*                                                                 03900001
039100******************************************************************03910001
039200*     OPEN THE ASNORD CURSOR                                     *03920001
039300*                                                                *03930001
039400******************************************************************03940001
039500 S025-OPEN-ASNORD-CURSOR.                                         03950001
039600*                                                                 03960001
039700     MOVE 'S025-OPEN-ASNORD-CURSOR'                               03970001
039800                                 TO PW-CURRENT-PARA.              03980001
039900*    DISPLAY PW-CURRENT-PARA.                                     03990001
040000                                                                  04000001
040100     EXEC SQL                                                     04010001
040200         OPEN ASNORD_CURSOR                                       04020001
040300     END-EXEC.                                                    04030001
040400*                                                                 04040001
040500     EVALUATE TRUE                                                04050001
040600       WHEN SQLCODE = PC-SUCCESSFUL                               04060001
040700         CONTINUE                                                 04070001
040800                                                                  04080001
040900       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    04090001
041000             DISPLAY '******************************************' 04100001
041100             DISPLAY  PW-CURRENT-PARA                             04110001
041200             DISPLAY 'WARNING ISSUED ON OPEN OF ASNORD CURSOR   ' 04120001
041300             DISPLAY '******************************************' 04130001
041400             PERFORM Z800-SQL-WARNING                             04140001
041500                                                                  04150001
041600       WHEN  SQLCODE < ZERO                                       04160001
041700             DISPLAY '******************************************' 04170001
041800             DISPLAY  PW-CURRENT-PARA                             04180001
041900             DISPLAY 'ERROR ISSUED ON OPEN OF ASNORD CURSOR     ' 04190001
042000             DISPLAY '******************************************' 04200001
042100             PERFORM Z900-SQL-ERROR                               04210001
042200                                                                  04220001
042300     END-EVALUATE.                                                04230001
042400*                                                                 04240001
042500/                                                                 04250001
042600******************************************************************04260001
042700*  FETCHES THE ASN ORDER INFORMATION.                            *04270001
042800******************************************************************04280001
042900 S050-FETCH-ASNORD-PO.                                            04290001
043000*                                                                 04300001
043100     MOVE 'S200-FETCH-ASNHDR-PO  '                                04310001
043200                                 TO PW-CURRENT-PARA.              04320001
043300*    DISPLAY PW-CURRENT-PARA.                                     04330001
043400                                                                  04340001
043500     EXEC SQL                                                     04350001
043600         FETCH ASNORD_CURSOR                                      04360001
043700           INTO :PW-ASNHDR-ID                                     04370001
043800              , :PV-CURR-PO-NBR                                   04380001
043900              , :ASNHDR-ASNHDR-NBR                                04390020
044000     END-EXEC.                                                    04400001
044100*                                                                 04410001
044200     EVALUATE TRUE                                                04420001
044300                                                                  04430001
044400       WHEN SQLCODE = PC-SUCCESSFUL                               04440001
044500          ADD +1 TO PW-ASNHDR-MATCHED                             04450026
044600                                                                  04460001
044700       WHEN SQLCODE = PC-ROW-NOT-FOUND                            04470001
044800         SET PS-END-OF-ASNORD-INFO TO TRUE                        04480001
044900                                                                  04490001
045000       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    04500001
045100             DISPLAY '******************************************' 04510001
045200             DISPLAY  PW-CURRENT-PARA                             04520001
045300             DISPLAY 'WARNING ISSUED ON FETCH OF ASNORD CURSOR  ' 04530001
045400             DISPLAY '******************************************' 04540001
045500             PERFORM Z800-SQL-WARNING                             04550001
045600                                                                  04560001
045700       WHEN  SQLCODE < ZERO                                       04570001
045800             DISPLAY '******************************************' 04580001
045900             DISPLAY  PW-CURRENT-PARA                             04590001
046000             DISPLAY 'ERROR ISSUED ON FETCH OF ASNORD CURSOR    ' 04600001
046100             DISPLAY '******************************************' 04610001
046200             PERFORM Z900-SQL-ERROR                               04620001
046300                                                                  04630001
046400     END-EVALUATE.                                                04640001
046500/                                                                 04650001
046600******************************************************************04660001
046700*     CLOSES THE ASNORD CURSOR                                   *04670001
046800*                                                                *04680001
046900******************************************************************04690001
047000 S325-CLOSE-ASNORD-CURSOR.                                        04700001
047100*                                                                 04710001
047200     MOVE 'S325-CLOSE-ASNORD-CURSOR'                              04720001
047300                                 TO PW-CURRENT-PARA.              04730001
047400*    DISPLAY PW-CURRENT-PARA.                                     04740001
047500                                                                  04750001
047600     EXEC SQL                                                     04760001
047700         CLOSE ASNORD_CURSOR                                      04770001
047800     END-EXEC.                                                    04780001
047900*                                                                 04790001
048000     EVALUATE TRUE                                                04800001
048100                                                                  04810001
048200       WHEN SQLCODE = PC-SUCCESSFUL                               04820001
048300         CONTINUE                                                 04830001
048400                                                                  04840001
048500       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    04850001
048600             DISPLAY '******************************************' 04860001
048700             DISPLAY  PW-CURRENT-PARA                             04870001
048800             DISPLAY 'WARNING ISSUED ON CLOSE OF ASNORD CURSOR  ' 04880001
048900             DISPLAY '******************************************' 04890001
049000             PERFORM Z800-SQL-WARNING                             04900001
049100                                                                  04910001
049200       WHEN  SQLCODE < ZERO                                       04920001
049300             DISPLAY '******************************************' 04930001
049400             DISPLAY  PW-CURRENT-PARA                             04940001
049500             DISPLAY 'ERROR ISSUED ON CLOSE OF ASNORD CURSOR    ' 04950001
049600             DISPLAY '******************************************' 04960001
049700             PERFORM Z900-SQL-ERROR                               04970001
049800                                                                  04980001
049900     END-EVALUATE.                                                04990001
050000*                                                                 05000001
050100******************************************************************05010001
050200*     OPEN THE OLD ASN CURSOR                                    *05020001
050300*                                                                *05030001
050400******************************************************************05040001
050500 S400-OPEN-OLD-ASN-CURSOR.                                        05050001
050600*                                                                 05060001
050700     MOVE 'S400-OPEN-OLD-ASN-CURSOR'                              05070001
050800                                 TO PW-CURRENT-PARA.              05080001
050900     EXEC SQL                                                     05090001
051000         OPEN OLD_ASN_CURSOR                                      05100001
051100     END-EXEC.                                                    05110001
051200*                                                                 05120001
051300     EVALUATE TRUE                                                05130001
051400       WHEN SQLCODE = PC-SUCCESSFUL                               05140001
051500         CONTINUE                                                 05150001
051600                                                                  05160001
051700       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    05170001
051800             DISPLAY '******************************************' 05180001
051900             DISPLAY  PW-CURRENT-PARA                             05190001
052000             DISPLAY 'WARNING ISSUED ON OPEN OF OLD ASN CURSOR  ' 05200001
052100             DISPLAY '******************************************' 05210001
052200             PERFORM Z800-SQL-WARNING                             05220001
052300                                                                  05230001
052400       WHEN  SQLCODE < ZERO                                       05240001
052500             DISPLAY '******************************************' 05250001
052600             DISPLAY  PW-CURRENT-PARA                             05260001
052700             DISPLAY 'ERROR ISSUED ON OPEN OF OLD ASN CURSOR    ' 05270001
052800             DISPLAY '******************************************' 05280001
052900             PERFORM Z900-SQL-ERROR                               05290001
053000                                                                  05300001
053100     END-EVALUATE.                                                05310001
053200*                                                                 05320001
053300******************************************************************05330001
053400*  FETCHES THE OLD ASN ID'S.                                     *05340001
053500******************************************************************05350001
053600 S425-FETCH-OLD-ASN.                                              05360001
053700*                                                                 05370001
053800     MOVE 'S425-FETCH-OLD-ASN' TO PW-CURRENT-PARA.                05380001
053900                                                                  05390001
054000     EXEC SQL                                                     05400001
054100         FETCH OLD_ASN_CURSOR                                     05410001
054200           INTO :PW-ASNHDR-ID                                     05420001
054210              , :PV-CURR-PO-NBR                                   05421023
054220              , :ASNHDR-ASNHDR-NBR                                05422023
054300     END-EXEC.                                                    05430001
054400*                                                                 05440001
054500     EVALUATE TRUE                                                05450001
054600                                                                  05460001
054700       WHEN SQLCODE = PC-SUCCESSFUL                               05470001
054701         ADD +1  TO PW-ASNHDR-UNMTCHD                             05470126
054710         MOVE PV-CURR-PO-NBR(1:8) TO PV-INTEGER-PO-NBR            05471024
054800         PERFORM Z200-WRITE-ASNHDR-INFO                           05480001
054810         ADD +1  TO PW-ASNHDR-UNMTCHD-WRTN                        05481035
054900                                                                  05490001
055000       WHEN SQLCODE = PC-ROW-NOT-FOUND                            05500001
055100         SET PS-END-OF-OLD-ASN-INFO TO TRUE                       05510001
055200                                                                  05520001
055300       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    05530001
055400             DISPLAY '******************************************' 05540001
055500             DISPLAY  PW-CURRENT-PARA                             05550001
055600             DISPLAY 'WARNING ISSUED ON FETCH OF OLD ASN CURSOR ' 05560001
055700             DISPLAY '******************************************' 05570001
055800             PERFORM Z800-SQL-WARNING                             05580001
055900                                                                  05590001
056000       WHEN  SQLCODE < ZERO                                       05600001
056100             DISPLAY '******************************************' 05610001
056200             DISPLAY  PW-CURRENT-PARA                             05620001
056300             DISPLAY 'ERROR ISSUED ON FETCH OF OLD ASN CURSOR   ' 05630001
056400             DISPLAY '******************************************' 05640001
056500             PERFORM Z900-SQL-ERROR                               05650001
056600                                                                  05660001
056700     END-EVALUATE.                                                05670001
056800/                                                                 05680001
056900******************************************************************05690001
057000*     CLOSES THE OLD ASN CURSOR                                  *05700001
057100*                                                                *05710001
057200******************************************************************05720001
057300 S450-CLOSE-OLD-ASN-CURSOR.                                       05730001
057400*                                                                 05740001
057500     MOVE 'S450-CLOSE-OLD-ASN-CURSOR'                             05750001
057600                                 TO PW-CURRENT-PARA.              05760001
057700     EXEC SQL                                                     05770001
057800         CLOSE OLD_ASN_CURSOR                                     05780001
057900     END-EXEC.                                                    05790001
058000*                                                                 05800001
058100     EVALUATE TRUE                                                05810001
058200                                                                  05820001
058300       WHEN SQLCODE = PC-SUCCESSFUL                               05830001
058400         CONTINUE                                                 05840001
058500                                                                  05850001
058600       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    05860001
058700             DISPLAY '******************************************' 05870001
058800             DISPLAY  PW-CURRENT-PARA                             05880001
058900             DISPLAY 'WARNING ISSUED ON CLOSE OF OLD ASN CURSOR ' 05890001
059000             DISPLAY '******************************************' 05900001
059100             PERFORM Z800-SQL-WARNING                             05910001
059200                                                                  05920001
059300       WHEN  SQLCODE < ZERO                                       05930001
059400             DISPLAY '******************************************' 05940001
059500             DISPLAY  PW-CURRENT-PARA                             05950001
059600             DISPLAY 'ERROR ISSUED ON CLOSE OF OLD ASN CURSOR   ' 05960001
059700             DISPLAY '******************************************' 05970001
059800             PERFORM Z900-SQL-ERROR                               05980001
059900                                                                  05990001
060000     END-EVALUATE.                                                06000001
060100/                                                                 06010001
060200***************************************************************** 06020001
060300*     GET THE CANCEL DATE                                       * 06030001
060400*                                                               * 06040001
060500***************************************************************** 06050001
060600 Z025-GET-PO-INFO.                                                06060001
060700     MOVE 'Z025-GET-PO-INFO                   '                   06070001
060800                                 TO PW-CURRENT-PARA.              06080001
060900*    DISPLAY PW-CURRENT-PARA.                                     06090001
061000*PS 11/07/2014 CHANGE STARTS                                      06100001
061100     MOVE PV-CURR-PO-NBR (1:8)   TO DP010I-UNEDITED-FIELD.        06110001
061200     MOVE PC-8                   TO DP010I-MAXIMUM-DIGITS.        06120001
061300*PS 11/07/2014 CHANGE ENDS                                        06130001
061400     MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS.      06140001
061500     SET DP010I-NEGATIVE-NOT-ALLOWED                              06150001
061600                                 TO TRUE.                         06160001
061700                                                                  06170001
061800     CALL DP010I-NUMERIC-EDIT-ROUTINE                             06180001
061900          USING DP010I-NUMERIC-EDIT-AREA.                         06190001
062000                                                                  06200001
062100     IF DP010I-ERROR-DETECTED                                     06210001
062200         DISPLAY 'ERROR IN CONVERTING PO NUMBER TO NUMERIC: '     06220001
062300                  DP010I-UNEDITED-FIELD                           06230001
062400     END-IF.                                                      06240001
062500                                                                  06250001
062600     MOVE DP010I-NUMERIC-FIELD   TO PV-UNPK-PONUMB.               06260001
062700     MOVE PV-UNPK-PONUMB         TO PV-INTEGER-PO-NBR.            06270001
062800                                                                  06280001
062900     EXEC SQL                                                     06290001
063000        SELECT B.CAN_IFNOT_SHIP_DTE                               06300001
063100              ,B.EXT_CAN_DTE                                      06310001
063200           INTO :PLNSHP-CAN-IFNOT-SHIP-DTE                        06320001
063300               ,:PLNSHP-EXT-CAN-DTE                               06330001
063400           FROM TPURCHS A,                                        06340001
063500                TPLNSHP B                                         06350001
063600           WHERE A.PO_NBR = :PV-INTEGER-PO-NBR                    06360001
063700            AND  A.VER_STATUS_CDE = 'A'                           06370001
063800            AND  B.VER_STATUS_CDE = 'A'                           06380001
063900            AND  A.STATUS_CDE     IN ('CA','CM')                  06390001
064000            AND  B.PO_NBR = A.PO_NBR                              06400001
064100     END-EXEC.                                                    06410001
064200*                                                                 06420001
064700     EVALUATE TRUE                                                06470001
064800                                                                  06480001
064900       WHEN SQLCODE = PC-SUCCESSFUL                               06490001
065000       WHEN SQLCODE = PC-ROW-NOT-FOUND                            06500001
065100         SET PS-NO-PO-FOUND      TO TRUE                          06510001
065200                                                                  06520001
065300                                                                  06530001
065400       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    06540001
065500             DISPLAY '******************************************' 06550001
065600             DISPLAY  PW-CURRENT-PARA                             06560001
065700             DISPLAY 'WARNING ISSUED ON SELECT CANCEL DATE      ' 06570001
065800             DISPLAY 'FROM TPLNSHP , TPURCHS                    ' 06580001
065900             DISPLAY 'PO-NBR = ' PV-INTEGER-PO-NBR                06590001
066000             DISPLAY '******************************************' 06600001
066100             PERFORM Z800-SQL-WARNING                             06610001
066200                                                                  06620001
066300       WHEN  SQLCODE < ZERO                                       06630001
066400             DISPLAY '******************************************' 06640001
066500             DISPLAY  PW-CURRENT-PARA                             06650001
066600             DISPLAY 'ERROR ISSUED ON SELECT CANCEL DATE        ' 06660001
066700             DISPLAY 'FROM TPLNSHP , TPURCHS                    ' 06670001
066800             DISPLAY 'PO-NBR = ' PV-INTEGER-PO-NBR                06680001
066900             DISPLAY '******************************************' 06690001
067000             PERFORM Z900-SQL-ERROR                               06700001
067100                                                                  06710001
067200     END-EVALUATE.                                                06720001
067300/                                                                 06730001
067400                                                                  06740001
067500     IF SQLCODE = ZERO                                            06750001
067600         SET PS-PO-FOUND         TO TRUE                          06760001
067700                                                                  06770001
067800         IF PLNSHP-EXT-CAN-DTE = PC-INITIAL-DTE                   06780001
067900                                                                  06790001
068000            MOVE PLNSHP-CAN-IFNOT-SHIP-DTE  TO                    06800001
068100                              PW-CAN-DTE-CCYYMMDD                 06810001
068200                                                                  06820001
068300         ELSE                                                     06830001
068400                                                                  06840001
068500            MOVE PLNSHP-EXT-CAN-DTE  TO  PW-CAN-DTE-CCYYMMDD      06850001
068600                                                                  06860001
068700         END-IF                                                   06870001
068701         ADD +1     TO PW-ASNHDR-PO-FOUND                         06870130
068910     END-IF.                                                      06891029
069000                                                                  06900001
069100 EJECT                                                            06910001
069200                                                                  06920001
069300/                                                                 06930001
069400***************************************************************** 06940001
069500*     WRITE ASN HEADER INFORMATION.                             * 06950001
069600*                                                               * 06960001
069700***************************************************************** 06970001
069800 Z200-WRITE-ASNHDR-INFO.                                          06980001
069900                                                                  06990001
070000     MOVE 'Z200-WRITE-ASNHDR-INFO            '                    07000001
070100                                 TO PW-CURRENT-PARA.              07010001
070200*    DISPLAY PW-CURRENT-PARA.                                     07020001
070300                                                                  07030001
070400*    MOVE PW-OPERCO-NBR          TO SN002O-OPERCO-NBR.            07040001
070500*    MOVE PW-EDI-VEND-ID         TO SN002O-EDI-VEND-ID.           07050001
070600     MOVE PW-ASNHDR-ID           TO SN002O-ASNHDR-ID.             07060001
070700     MOVE PW-ASNHDR-ID           TO DISPLAY-ASNHDR-ID.            07070001
070710     MOVE PV-INTEGER-PO-NBR      TO DISPLAY-PO-NBR.               07071020
070720     MOVE ASNHDR-ASNHDR-NBR      TO DISPLAY-ASNHDR-NBR.           07072020
070800      STRING 'ASNHDR-ID = '  DISPLAY-ASNHDR-ID  DELIMITED BY SIZE 07080022
070820             ' PO NUMBER = ' DISPLAY-PO-NBR     DELIMITED BY SIZE 07082022
070840             ' ASNHDR-NBR = ' DISPLAY-ASNHDR-NBR DELIMITED BY SIZE07084020
070860                                  INTO PV-ASN-MESSAGE-DISPLAY     07086020
070900        DISPLAY PV-ASN-MESSAGE-DISPLAY                            07090020
071000     WRITE ASNHDR-DELETE-RECORD                                   07100001
071100         FROM SN002O-ASN-DELETE-RECORD.                           07110001
071200                                                                  07120001
071300     ADD PC-POS-1                TO PW-ASNHDR-WRITTEN.            07130001
071400/                                                                 07140001
071500 Z800-SQL-WARNING.                                                07150001
071600******************************************************************07160001
071700*  THIS MODULE PERFORMS THE SQL WARNING.                         *07170001
071800******************************************************************07180001
071900      MOVE SQLCODE               TO SQLCODE2.                     07190001
072000      MOVE SQLERRD(3)            TO SQLERRD3.                     07200001
072100      DISPLAY '** ABEND **       ** = SQLWARNING'.                07210001
072200      DISPLAY '** PROGRAM        ** = SNKUP007'.                  07220001
072300      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 07230001
072400      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 07240001
072500      DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                 07250001
072600      DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                 07260001
072700      DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                 07270001
072800      DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                 07280001
072900      DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                 07290001
073000      DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                 07300001
073100      DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                 07310001
073200      DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                 07320001
073300                                                                  07330001
073400      EXEC SQL                                                    07340001
073500          ROLLBACK                                                07350001
073600      END-EXEC.                                                   07360001
073700                                                                  07370001
073800      SET ABEND-4013-DB2-ERROR   TO TRUE                          07380001
073900      CALL 'ILBOABN0' USING ABEND-CODE.                           07390001
074000/                                                                 07400001
074100 Z900-SQL-ERROR.                                                  07410001
074200******************************************************************07420001
074300* THIS MODULE PERFORMS THE SQL ERROR.                            *07430001
074400******************************************************************07440001
074500      MOVE SQLCODE               TO SQLCODE2.                     07450001
074600      MOVE SQLERRD(3)            TO SQLERRD3.                     07460001
074700      DISPLAY '** ABEND **       ** = SQLERROR'.                  07470001
074800      DISPLAY '** PROGRAM        ** = SNKUP007'.                  07480001
074900      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 07490001
075000      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 07500001
075100      DISPLAY '** SQLERRM        ** = ' SQLERRM.                  07510001
075200      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                 07520001
075300                                                                  07530001
075400      EXEC SQL                                                    07540001
075500          ROLLBACK                                                07550001
075600      END-EXEC.                                                   07560001
075700                                                                  07570001
075800      SET ABEND-4013-DB2-ERROR   TO TRUE                          07580001
075900      CALL 'ILBOABN0' USING ABEND-CODE.                           07590001
076000*                                                                 07600001
