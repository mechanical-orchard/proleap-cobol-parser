       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.    XSKUP027.                                         00020000
       AUTHOR.        KOHLS DEPARTMENT STORES.                          00030000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
       DATE-WRITTEN.  10/04/2002.                                       00050000
       DATE-COMPILED.                                                   00060000
      ******************************************************************00070000
      **       MERCHANDISE HIERARCHY MESSAGE FOR TABLE XST_BUS_GP       00080000
      ******************************************************************00090000
      **THIS IS A CALLED MODULE FOR BUS GROUP MERCH HIER TABLES. THIS   00100000
      **     PROGRAM WILL PERFORM UPDATES/INSERTS/DELETES FOR THE       00110000
      **     TABLE.  IT DOES THE FOLLOWING WITH THESE RETURN CODES:     00120000
      **     0000 - END PROGRAM                                         00130000
      **    -0530 - END PROGRAM                                         00140000
      **    -0803 - COMPARE TIMESTAMPS AND UPDATE IF MESSAGE IS NEWER   00150000
      **    -0911 - RETRY INSERT UP TO 5 TIMES AND THEN END PROGRAM     00160000
      ******************************************************************00170000
      **10/04/2002 CHANGED BY: BEN BENTLEY         PROGRAM WRITE        00180000
010103**01/01/2003 CHANGED BY: JULIE SMITH TIMESTAMP ADDITION           00190006
022207**02/22/2007 CHANGED BY: RICH KELLEN ADD INSERT OF XST_BUS_GP_ATTR00200010
022207**                       TABLE ON INSERT OF XST_BUS_GP TABLE      00210010
121609**12/16/2009 CHANGED BY: JIM ARENDT PASS RETURN CODE OF 4051 IF A 00220044
121609**                       BUSINESS GROUP ADD OR DELETE.            00230017
      ******************************************************************00240000
       ENVIRONMENT DIVISION.                                            00250000
       CONFIGURATION SECTION.                                           00260000
       SOURCE-COMPUTER.  IBM-3090.                                      00270000
       OBJECT-COMPUTER.  IBM-3090.                                      00280000
       DATA DIVISION.                                                   00290000
                                                                        00300000
       WORKING-STORAGE SECTION.                                         00310000
      ******************************************************************00320000
      **PROGRAM SWITCHES                                                00330000
      ******************************************************************00340000
       01  PS-PROGRAM-SWITCHES.                                         00350000
           05  PS-PROCESS-CONTINUE-SW      PIC X(01)  VALUE 'Y'.        00360000
               88  PS-PROCESS-CONTINUE                VALUE 'Y'.        00370000
               88  PS-PROCESS-COMPLETE                VALUE 'N'.        00380000
121609     05  PS-BUS-GRP-CHANGE-SW        PIC X(01)  VALUE 'N'.        00390017
121609         88  PS-BUS-GRP-CHANGE-Y                VALUE 'Y'.        00400017
121609         88  PS-BUS-GRP-CHANGE-E                VALUE 'E'.        00410039
121609         88  PS-BUS-GRP-CHANGE-N                VALUE 'N'.        00420017
      ******************************************************************00430000
      **PROGRAM COUNTERS                                                00440000
      ******************************************************************00450000
       01  PC-PROGRAM-COUNTERS.                                         00460000
           05  PC-RETRY-COUNTER            PIC 9(01)  VALUE ZEROS.      00470000
           05  PC-RETRY-COUNTER-2          PIC 9(01)  VALUE ZEROS.      00480000
           05  PC-RETRY-MAX                PIC 9(01)  VALUE 5.          00490000
      ******************************************************************00500000
      **PROGRAM VARIABLES                                               00510000
      ******************************************************************00520000
       01  PV-PROGRAM-VARIABLES.                                        00530000
           05  PV-PARAGRAPH-NAME               PIC X(20)  VALUE SPACES. 00540000
           05  PV-MISC-BUS-GP-NBR              PIC S9(3)V COMP-3.       00550010
           05  PV-MISC-BUS-GP-CTG-NM           PIC X(15).               00560010
           05  PV-MISC-DISP-PRTY-NBR           PIC S9(4) COMP.          00570010
           05  PV-TIME-EVALUATE-INSERT.                                 00580000
               10  PV-TIME-HOUR-IN             PIC  9(02) VALUE ZEROS.  00590000
               10  PV-TIME-MINUTE-IN           PIC  9(02) VALUE ZEROS.  00600000
               10  PV-TIME-SECOND-IN           PIC  9(02) VALUE ZEROS.  00610000
               10  PV-TIME-MICROSEC-IN         PIC  9(06) VALUE ZEROS.  00620000
           05  PV-TIME-EVALUATE-UPDATE.                                 00630000
               10  PV-TIME-HOUR-UP             PIC  9(02) VALUE ZEROS.  00640000
               10  PV-TIME-MINUTE-UP           PIC  9(02) VALUE ZEROS.  00650000
               10  PV-TIME-SECOND-UP           PIC  9(02) VALUE ZEROS.  00660000
               10  PV-TIME-MICROSEC-UP         PIC  9(06) VALUE ZEROS.  00670000
121609     05  PV-SQLCODE                      PIC  Z(08)9-.            00680029
121609     05  PV-ACTION                       PIC  X(07) VALUE SPACES. 00690043
                                                                        00700023
      ******************************************************************00710000
      **TIMESTAMP VARIABLES                                             00720000
      ******************************************************************00730000
       01  SD-TIMESTAMP.                                                00740008
           05  SD-CURR-DTE                     PIC  X(10).              00750000
           05  FILLER                          PIC  X(01) VALUE '-'.    00760008
           05  SD-HOUR                         PIC  9(02).              00770008
           05  FILLER                          PIC  X(01) VALUE '.'.    00780008
           05  SD-MINUTE                       PIC  9(02).              00790008
           05  FILLER                          PIC  X(01) VALUE '.'.    00800008
           05  SD-SECOND                       PIC  9(02).              00810008
           05  FILLER                          PIC  X(01) VALUE '.'.    00820008
           05  SD-MICROSEC                     PIC  9(06).              00830008
      ******************************************************************00840000
      **COPYBOOKS                                                       00850000
      ******************************************************************00860000
      ***DB2 MESSAGE AREA                                               00870000
           COPY SQLCA2.                                                 00880010
      ***MESSAGE COPYBOOK                                               00890000
           COPY HMRD001.                                                00900010
      ***DATE ROUTINE COPYBOOK                                          00910000
           COPY DPWS500.                                                00920010
      ******************************************************************00930000
      **TABLE INCLUSIONS                                                00940000
      ******************************************************************00950000
      ***DB2 COMMUNICATIONS AREA                                        00960000
           EXEC SQL                                                     00970000
                INCLUDE SQLCA                                           00980000
           END-EXEC.                                                    00990000
      ***XST_BUS_GP TABLE                                               01000000
           EXEC SQL                                                     01010000
                INCLUDE XST00016                                        01020000
           END-EXEC.                                                    01030000
                                                                        01040000
      ***XST_BUS_GP_ATTR TABLE                                          01050010
           EXEC SQL                                                     01060010
                INCLUDE XST00106                                        01070010
           END-EXEC.                                                    01080010
                                                                        01090010
       LINKAGE SECTION.                                                 01100000
      ******************************************************************01110000
      **LINKAGE VARIABLES                                               01120000
      ******************************************************************01130000
       01  LV-HMRD001-RECORD               PIC X(500).                  01140000
       01  LV-RETURN-CODE                  PIC S9(04).                  01150000
010103 01  LV-CURRENT-TIMESTAMP            PIC X(26).                   01160006
                                                                        01170000
       PROCEDURE DIVISION USING LV-HMRD001-RECORD,                      01180000
                                LV-RETURN-CODE,                         01190006
010103                          LV-CURRENT-TIMESTAMP.                   01200006
                                                                        01210022
      ******************************************************************01220000
       0000-MAINLINE.                                                   01230000
                                                                        01240000
            PERFORM 1000-INITIALIZATION.                                01250000
            PERFORM 2000-PROCESS-MESSAGE                                01260000
                    UNTIL PS-PROCESS-COMPLETE.                          01270000
            PERFORM 9999-WRAPUP.                                        01280000
                                                                        01290000
       EJECT.                                                           01300001
      ***************************************************************** 01310000
      **INITIALIZATION AREA - ALL MOVES TO UPDATE/INSERT                01320000
      ***************************************************************** 01330000
       1000-INITIALIZATION.                                             01340000
                                                                        01350000
           MOVE '1000-INITIALIZATION'      TO PV-PARAGRAPH-NAME.        01360000
                                                                        01370000
           SET PS-PROCESS-CONTINUE         TO TRUE.                     01380000
121609     SET PS-BUS-GRP-CHANGE-N         TO TRUE.                     01390037
           INITIALIZE PC-RETRY-COUNTER                                  01400000
                      SD-TIMESTAMP.                                     01410000
                                                                        01420000
           MOVE LV-HMRD001-RECORD          TO HMRD001-RECORD.           01430000
           MOVE HM001-BUS-GRP-BUS-GP-NBR   TO XST00016-BUS-GP-NBR.      01440000
           MOVE HM001-BUS-GRP-BUS-AREA-ID  TO XST00016-BUS-AREA-ID.     01450000
           MOVE HM001-BUS-GRP-BUS-GP-DESC  TO XST00016-BUS-GP-DESC.     01460000
                                                                        01470000
010103     MOVE HM001-CRE-TMST            TO SD-CURR-DTE.               01480008
010103     MOVE SD-TIMESTAMP              TO XST00016-SOR-LAST-MSG-TMST.01490009
010103     INITIALIZE SD-TIMESTAMP.                                     01500006
                                                                        01510006
       EJECT.                                                           01520001
      ***************************************************************** 01530000
      **MAIN PROGRAM LOGIC - READS ACTION TYPE ON HMRD001 RECORD        01540000
      ***************************************************************** 01550000
       2000-PROCESS-MESSAGE.                                            01560000
                                                                        01570000
           MOVE '2000-PROCESS-MESSAGE' TO PV-PARAGRAPH-NAME.            01580000
                                                                        01590000
           EVALUATE TRUE                                                01600000
              WHEN HM001-ACTN-TYP-INSERT                                01610000
121609             MOVE ' INSERT'       TO PV-ACTION                    01620043
                   PERFORM 2100-INSERT-DATA                             01630000
              WHEN HM001-ACTN-TYP-UPDATE                                01640001
121609             MOVE ' UPDATE'       TO PV-ACTION                    01650043
                   PERFORM 2200-UPDATE-DATA                             01660001
              WHEN HM001-ACTN-TYP-DELETE                                01670000
121609             MOVE ' DELETE'       TO PV-ACTION                    01680043
                   PERFORM 2300-DELETE-DATA                             01690032
           END-EVALUATE.                                                01700000
                                                                        01710000
       EJECT.                                                           01720000
      ***************************************************************** 01730000
      **INSERT ACTION TYPE                                              01740000
      ***************************************************************** 01750000
       2100-INSERT-DATA.                                                01760000
                                                                        01770000
           MOVE '2000-PROCESS-MESSAGE' TO PV-PARAGRAPH-NAME.            01780000
                                                                        01790000
           EXEC SQL                                                     01800000
                INSERT INTO XST_BUS_GP (BUS_GP_NBR                      01810000
                                      , BUS_GP_DESC                     01820000
                                      , BUS_AREA_ID                     01830006
010103                                , SOR_LAST_MSG_TMST)              01840009
                VALUES (:XST00016-BUS-GP-NBR                            01850000
                      , :XST00016-BUS-GP-DESC                           01860000
                      , :XST00016-BUS-AREA-ID                           01870006
010103                , :XST00016-SOR-LAST-MSG-TMST)                    01880009
           END-EXEC.                                                    01890000
                                                                        01900000
           EVALUATE TRUE                                                01910000
      ***SUCCESSFUL PROCESSING                                          01920006
              WHEN SQLCODE = ZEROS                                      01930000
      *            SET PS-PROCESS-COMPLETE   TO TRUE                    01940010
121609             SET PS-BUS-GRP-CHANGE-Y   TO TRUE                    01950017
022207             PERFORM 2150-ADD-XST-BUS-GP-ATTR                     01960010
      ***REFERENTIAL INTEGRITY                                          01970006
              WHEN SQLCODE = -530                                       01980000
              WHEN SQLCODE = -532                                       01990006
121609             SET PS-BUS-GRP-CHANGE-E   TO TRUE                    02000039
                   SET PS-PROCESS-COMPLETE   TO TRUE                    02010000
      ***ROW ALREADY EXISTS                                             02020006
              WHEN SQLCODE = -803                                       02030001
121609             MOVE 'INS/UPD'              TO PV-ACTION             02040043
                   PERFORM 2200-UPDATE-DATA                             02050001
      ***ROW/TABLE LOCK                                                 02060006
              WHEN SQLCODE = -913                                       02070000
              WHEN SQLCODE = -911                                       02080000
                   IF  PC-RETRY-COUNTER >= PC-RETRY-MAX                 02090000
121609                 SET PS-BUS-GRP-CHANGE-E TO TRUE                  02100039
                       SET PS-PROCESS-COMPLETE TO TRUE                  02110000
                   ELSE                                                 02120000
                       ADD +1                  TO PC-RETRY-COUNTER      02130000
                   END-IF                                               02140000
              WHEN OTHER                                                02150000
121609             SET PS-BUS-GRP-CHANGE-E     TO TRUE                  02160039
                   SET PS-PROCESS-COMPLETE     TO TRUE                  02170000
           END-EVALUATE.                                                02180000
                                                                        02190000
       EJECT.                                                           02200001
022207***************************************************************** 02210010
022207**ADD NEW XST-BUS-GP-ATTR ROW AND ADJUST THE DISP_PRTY_NBR OF THE 02220010
022207**    MISC (BUS_GP_NBR=99) ROW TO BE 1 HIGHER THAN THE HIGHEST    02230010
022207**    NON MISC ROW.                                               02240010
022207***************************************************************** 02250010
022207 2150-ADD-XST-BUS-GP-ATTR.                                        02260010
022207                                                                  02270022
022207     PERFORM 2160-SELECT-MISC-ROW.                                02280010
022207                                                                  02290010
022207***************************************************************** 02300010
022207**SELECT MISC XST_BUS_GP_ATTR ROW                                 02310011
022207***************************************************************** 02320010
022207 2160-SELECT-MISC-ROW.                                            02330010
022207                                                                  02340022
022207     EXEC SQL                                                     02350022
022207          SELECT BUS_GP_NBR                                       02360010
022207                ,BUS_GP_CTG_NM                                    02370010
022207                ,DISP_PRTY_NBR                                    02380010
022207          INTO  :XST00106-BUS-GP-NBR                              02390010
022207               ,:XST00106-BUS-GP-CTG-NM                           02400010
022207               ,:XST00106-DISP-PRTY-NBR                           02410010
022207          FROM  XST_BUS_GP_ATTR                                   02420010
022207          WHERE BUS_GP_NBR    = 99                                02430013
022207     END-EXEC.                                                    02440010
022207                                                                  02450010
022207     EVALUATE TRUE                                                02460010
022207        WHEN SQLCODE = ZEROS                                      02470010
022207         MOVE XST00106-BUS-GP-NBR    TO PV-MISC-BUS-GP-NBR        02480011
022207         MOVE XST00106-BUS-GP-CTG-NM TO PV-MISC-BUS-GP-CTG-NM     02490011
022207         MOVE XST00106-DISP-PRTY-NBR TO PV-MISC-DISP-PRTY-NBR     02500011
022207         MOVE XST00016-BUS-GP-NBR    TO XST00106-BUS-GP-NBR       02510011
022207         MOVE XST00016-BUS-GP-DESC   TO XST00106-BUS-GP-CTG-NM    02520011
022207* THE DISP_PRTY_NBR OF THE NEW ROW IS THE SAME AS THE MISC ROW    02530011
022207         PERFORM 2170-INS-XST-BUS-GP-ATTR                         02540011
022207        WHEN OTHER                                                02550010
121609         SET PS-BUS-GRP-CHANGE-E     TO TRUE                      02560039
022207         SET PS-PROCESS-COMPLETE     TO TRUE                      02570011
121609         MOVE SQLCODE                TO PV-SQLCODE                02580022
022207         DISPLAY 'XSKUP027-BAD SELECT OF MISC ROW ' PV-SQLCODE    02590022
022207     END-EVALUATE.                                                02600010
022207                                                                  02610010
022207 EJECT.                                                           02620010
022207***************************************************************** 02630010
022207**INSERT XST-BUS-GP-ATTR ROW                                      02640010
022207***************************************************************** 02650010
022207 2170-INS-XST-BUS-GP-ATTR.                                        02660010
022207                                                                  02670035
022207     MOVE '2170-INS-XST-BUS-GP-ATTR' TO PV-PARAGRAPH-NAME.        02680010
022207                                                                  02690010
022207     EXEC SQL                                                     02700010
022207          INSERT INTO XST_BUS_GP_ATTR (BUS_GP_NBR                 02710010
022207                                      ,BUS_GP_CTG_NM              02720010
022207                                      ,DISP_PRTY_NBR)             02730010
022207          VALUES (:XST00106-BUS-GP-NBR                            02740010
022207                , :XST00106-BUS-GP-CTG-NM                         02750010
022207                , :XST00106-DISP-PRTY-NBR)                        02760010
022207     END-EXEC.                                                    02770010
022207                                                                  02780010
022207     EVALUATE TRUE                                                02790010
022207***SUCCESSFUL PROCESSING                                          02800010
022207        WHEN SQLCODE = ZEROS                                      02810010
022207         MOVE PV-MISC-BUS-GP-NBR     TO XST00106-BUS-GP-NBR       02820010
022207         MOVE PV-MISC-BUS-GP-CTG-NM  TO XST00106-BUS-GP-CTG-NM    02830010
022207         DISPLAY 'XSKUP027-XST_BUS_GP_ATTR ROW ADDED- '           02840016
                       XST00106-BUS-GP-NBR                              02850016
022207* THE MISC ROW IS ADJUSTED TO BE 1 HIGHER THAN THE ROW THAT       02860016
022207* WAS JUST INSERTED TO INSURE THE MISC ROW HAS THE HIGHEST        02870016
022207* DISP_PRTY_NBR.                                                  02880016
022207         COMPUTE XST00106-DISP-PRTY-NBR =                         02890016
022207          XST00106-DISP-PRTY-NBR + 1                              02900016
022207         PERFORM 2180-UPD-XST-BUS-GP-ATTR                         02910016
022207        WHEN OTHER                                                02920010
121609         SET PS-BUS-GRP-CHANGE-E     TO TRUE                      02930039
022207         SET PS-PROCESS-COMPLETE     TO TRUE                      02940010
121609         MOVE SQLCODE                TO PV-SQLCODE                02950022
022207         DISPLAY 'XSKUP027-BAD INSERT OF XST-BUS-GP-ATTR ROW '    02960012
022207            PV-SQLCODE ' - ' XST00106-BUS-GP-NBR                  02970022
022207     END-EVALUATE.                                                02980010
022207                                                                  02990010
022207 EJECT.                                                           03000010
022207***************************************************************** 03010010
022207**UPDATE XST-BUS-GP-ATTR MISC (BUS_GP_NBR=99) ROW                 03020010
022207***************************************************************** 03030010
022207 2180-UPD-XST-BUS-GP-ATTR.                                        03040010
022207                                                                  03050022
022207     MOVE '2180-UPD-XST-BUS-GP-ATTR' TO PV-PARAGRAPH-NAME.        03060010
022207     EXEC SQL                                                     03070010
022207     UPDATE XST_BUS_GP_ATTR                                       03080010
022207           SET DISP_PRTY_NBR  = :XST00106-DISP-PRTY-NBR           03090010
022207           WHERE BUS_GP_NBR =   99                                03100010
022207     END-EXEC.                                                    03110010
022207                                                                  03120010
022207     EVALUATE TRUE                                                03130010
022207***SUCCESSFUL PROCESSING                                          03140010
022207        WHEN SQLCODE = ZEROS                                      03150010
022207         SET PS-PROCESS-COMPLETE     TO TRUE                      03160011
022207        WHEN OTHER                                                03170010
121609         SET PS-BUS-GRP-CHANGE-E     TO TRUE                      03180039
022207         SET PS-PROCESS-COMPLETE     TO TRUE                      03190011
121609         MOVE SQLCODE                TO PV-SQLCODE                03200022
022207         DISPLAY 'XSKUP027-BAD UPDATE OF MISC ROW ' PV-SQLCODE    03210022
022207     END-EVALUATE.                                                03220010
022207                                                                  03230022
022207 EJECT.                                                           03240010
      ******************************************************************03250014
      **UPDATE ACTION TYPE                                              03260014
      ******************************************************************03270014
       2200-UPDATE-DATA.                                                03280003
                                                                        03290003
           MOVE '2200-UPDATE-DATA' TO PV-PARAGRAPH-NAME                 03300003
                                                                        03310003
           EXEC SQL                                                     03320003
              UPDATE XST_BUS_GP                                         03330003
                   SET BUS_GP_DESC = :XST00016-BUS-GP-DESC              03340003
                     , BUS_AREA_ID = :XST00016-BUS-AREA-ID              03350003
010103               , SOR_LAST_MSG_TMST = :XST00016-SOR-LAST-MSG-TMST  03360009
                  WHERE BUS_GP_NBR = :XST00016-BUS-GP-NBR               03370003
           END-EXEC.                                                    03380003
                                                                        03390003
           EVALUATE TRUE                                                03400003
      ***SUCCESSFUL PROCESSING                                          03410006
              WHEN SQLCODE = ZEROS                                      03420003
121609             SET PS-BUS-GRP-CHANGE-Y     TO TRUE                  03430041
                   SET PS-PROCESS-COMPLETE     TO TRUE                  03440003
      ***ROW/TABLE LOCK                                                 03450006
              WHEN SQLCODE = -911                                       03460003
              WHEN SQLCODE = -913                                       03470005
                   IF  PC-RETRY-COUNTER-2 >= PC-RETRY-MAX               03480003
121609                 SET PS-BUS-GRP-CHANGE-E TO TRUE                  03490041
                       SET PS-PROCESS-COMPLETE TO TRUE                  03500003
                   ELSE                                                 03510003
                       ADD +1                  TO PC-RETRY-COUNTER-2    03520003
                   END-IF                                               03530003
              WHEN OTHER                                                03540003
121609             SET PS-BUS-GRP-CHANGE-E     TO TRUE                  03550041
                   SET PS-PROCESS-COMPLETE     TO TRUE                  03560003
           END-EVALUATE.                                                03570003
                                                                        03580003
       EJECT.                                                           03590003
      ******************************************************************03600032
      **DELETE TYPE ACTION                                              03610032
      ******************************************************************03620032
       2300-DELETE-DATA.                                                03630032
                                                                        03640032
           MOVE '2300-DELETE-DATA' TO PV-PARAGRAPH-NAME                 03650032
                                                                        03660032
           EXEC SQL                                                     03670032
                DELETE FROM XST_BUS_GP                                  03680032
                WHERE BUS_GP_NBR  = :XST00016-BUS-GP-NBR                03690032
           END-EXEC.                                                    03700032
                                                                        03710032
           EVALUATE TRUE                                                03720032
      ***SUCCESSFUL PROCESSING                                          03730032
              WHEN SQLCODE = ZEROS                                      03740032
                   SET PS-PROCESS-COMPLETE     TO TRUE                  03750032
121609             SET PS-BUS-GRP-CHANGE-Y     TO TRUE                  03760032
      ***ROW DOES NOT EXIST                                             03770032
              WHEN SQLCODE = +100                                       03780032
121609             SET PS-BUS-GRP-CHANGE-E     TO TRUE                  03790039
                   SET PS-PROCESS-COMPLETE     TO TRUE                  03800032
      ***ROW/TABLE LOCK                                                 03810032
              WHEN SQLCODE = -911                                       03820032
              WHEN SQLCODE = -913                                       03830032
                   IF  PC-RETRY-COUNTER-2 >= PC-RETRY-MAX               03840032
121609                 SET PS-BUS-GRP-CHANGE-E TO TRUE                  03850039
                       SET PS-PROCESS-COMPLETE TO TRUE                  03860032
                   ELSE                                                 03870032
                       ADD +1                  TO PC-RETRY-COUNTER-2    03880032
                   END-IF                                               03890032
              WHEN OTHER                                                03900032
121609             SET PS-BUS-GRP-CHANGE-E     TO TRUE                  03910039
                   SET PS-PROCESS-COMPLETE     TO TRUE                  03920032
           END-EVALUATE.                                                03930032
                                                                        03940032
       EJECT.                                                           03950032
      ******************************************************************03960000
      **PASS SQLCODE TO CALLING AND EXIT PROGRAM                        03970000
      ******************************************************************03980000
       9999-WRAPUP.                                                     03990000
                                                                        04000000
           MOVE '9999-WRAPUP' TO PV-PARAGRAPH-NAME                      04010000
                                                                        04020000
121609     MOVE ZEROES        TO LV-RETURN-CODE.                        04030036
121609     EVALUATE  PS-BUS-GRP-CHANGE-SW                               04040039
121609        WHEN 'Y'                                                  04050039
121609          MOVE SQLCODE    TO PV-SQLCODE                           04060039
121609          DISPLAY 'XSKUP027 - ' PV-ACTION                         04070040
121609                        ' BUSINESS GROUP NBR: '                   04080040
                                XST00016-BUS-GP-NBR                     04090039
                              ' WITH RETURN-CODE ' PV-SQLCODE           04100039
121609          MOVE 4051       TO LV-RETURN-CODE                       04110039
121609        WHEN 'E'                                                  04120039
121609          MOVE SQLCODE    TO PV-SQLCODE                           04130039
121609          DISPLAY 'XSKUP027 - ' PV-ACTION                         04140040
121609                        ' BUSINESS GROUP NBR: '                   04150040
                                XST00016-BUS-GP-NBR                     04160039
                              ' WITH RETURN-CODE ' PV-SQLCODE           04170039
121609          MOVE SQLCODE    TO LV-RETURN-CODE                       04180039
121609        WHEN OTHER                                                04190039
121609          MOVE SQLCODE    TO LV-RETURN-CODE                       04200039
121609     END-EVALUATE.                                                04210039
121609**   MOVE SQLCODE       TO LV-RETURN-CODE.                        04220018
                                                                        04230030
           EXIT PROGRAM.                                                04240000
                                                                        04250030
       EJECT.                                                           04260001
