000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    VLKCS509.                                         00040000
000500 AUTHOR.        MARY SARDINA.                                     00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  08-10-96.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900*----------------------------------------------------------------*00090000
001000*    V509 - UPDATE TICKET PLACEMENT CODES AND DESCRIPTIONS.      *00100000
001100*                                                                *00110000
001200*    THIS PROGRAM ALLOWS THE USER TO UPDATE THE PLACEMENT        *00120000
001300*    CODES AND DESCRIPTIONS.                                            00
001600*----------------------------------------------------------------*00160000
CICS  * CHANGED 11/11/2022    BY JIM HUNTER      WR: CHG0278236                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *****************************************************************         
001900                                                                  00190000
002000 ENVIRONMENT DIVISION.                                            00200000
002100                                                                  00210000
002300                                                                  00230000
002400 DATA DIVISION.                                                   00240000
002500                                                                  00250000
002600                                                                  00260000
002700 WORKING-STORAGE SECTION.                                         00270000
002800                                                                  00280000
002900 01  DK-DB2-KEYS.                                                 00290000
003000     05  DK-OPERATING-COMPANY           PIC  X(02)  VALUE SPACE.  00300000
003100     05  DK-TKT-PLCMNT-CDE              PIC  X(04)  VALUE SPACE.  00310000
003110     05  DK-TKT-PLCMNT-DESC             PIC  X(50)  VALUE SPACE.  00310000
003200     05  DK-MESSAGE-NUMBER              PIC S9(05)  COMP-3        00320000
003300                                                    VALUE ZERO.   00330000
003400*                                                                 00340000
003500 01  PC-PROGRAM-CONSTANTS.                                        00350000
003600     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'VLKCS509'.  00360000
003700     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'VL509A  '.  00370000
003800     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'VLKM509 '.  00380000
003900     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           00390000
004000                                              COMP.               00400000
004100     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00410000
004200                                              COMP.               00420000
004300     05  PC-MAX-MSG-VAR           PIC S9(04)  VALUE  +1           00430000
004400                                              COMP.               00440000
004410     05  PC-UPD-VSAM              PIC  X(01)  VALUE 'Y'.          00441000
004500     05  PC-INTER-APPL-CODES.                                     00442000
004510         10  PC-INTER-APPL-LIST   PIC  X(01)  VALUE '4'.          00445000
004600         10  PC-INTER-APPL-CRIT-SPEC                              00443000
004700                                    PIC  X(01)  VALUE '1'.              00
004800         10  PC-INTER-APPL-LIST-ADD PIC  X(01)  VALUE '1'.              00
004840         10  PC-INTER-APPL-LIST-UPD PIC  X(01)  VALUE '2'.              00
004850         10  PC-INTER-APPL-LIST-DEL PIC  X(01)  VALUE '3'.              00
004900     05  PC-MSG-VAR-SYMBOLIC      PIC  X(04)  VALUE '&VAR'.       00446000
005000                                                                  00447000
005100     05  PC-TSYMSG-NUMBERS.                                       00448000
005200         10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       00449000
005201         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00449000
005210         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       00449000
005300         10  PC-TSYMSG-00057      PIC  9(05)  VALUE  00057.       00450000
005310         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00450000
005400         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00460000
005500         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00470000
005600         10  PC-TSYMSG-00095      PIC  9(05)  VALUE  00095.       00480000
005610         10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       00480000
005611         10  PC-TSYMSG-00116      PIC  9(05)  VALUE  00116.       00480000
005620         10  PC-TSYMSG-00117      PIC  9(05)  VALUE  00117.       00480000
005700         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       00490000
005800         10  PC-TSYMSG-00302      PIC  9(05)  VALUE  00302.       00500000
005900         10  PC-TSYMSG-00388      PIC  9(05)  VALUE  00388.       00510000
005910         10  PC-TSYMSG-00551      PIC  9(05)  VALUE  00551.       00510000
005920         10  PC-TSYMSG-00729      PIC  9(05)  VALUE  00729.       00510000
005930         10  PC-TSYMSG-01344      PIC  9(05)  VALUE  01344.       00510000
005940         10  PC-TSYMSG-01345      PIC  9(05)  VALUE  01345.       00510000
006000         10  PC-TSYMSG-99901      PIC  9(05)  VALUE  99901.       00520000
006100*                                                                 00530000
006200 01  PS-PROGRAM-SWITCHES.                                         00540000
006300     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00550000
006400         88  PS-ERROR                         VALUE  'Y'.         00560000
006500         88  PS-NO-ERROR                      VALUE  'N'.         00570000
006600*                                                                 00580000
006601     05  PS-COMMAREA-SW               PIC X(01)  VALUE 'N'.               
006602         88  PS-COMMAREA-VALID                   VALUE 'Y'.               
006610         88  PS-COMMAREA-NOT-VALID               VALUE 'N'.               
006620     05  PS-UPDATES-SW                PIC X(01)  VALUE 'N'.               
006630         88  PS-UPDATES-DONE                     VALUE 'Y'.               
006640         88  PS-NO-UPDATES-DONE                  VALUE 'N'.               
006641     05  PS-CODE-SW                   PIC X(01)  VALUE 'N'.               
006642         88  PS-CODE-FOUND                       VALUE 'Y'.               
006643         88  PS-NO-CODE-FOUND                    VALUE 'N'.               
006644     05  PS-DESC-EXISTS-SW            PIC X(01)  VALUE 'N'.               
006645         88  PS-DESC-FOUND                       VALUE 'Y'.               
006646         88  PS-DESC-NOT-FOUND                   VALUE 'N'.               
006650         88  PS-MULTI-DESC-FOUND                 VALUE 'M'.               
006651     05  PS-NEXT-SCREEN-SW             PIC X(1)  VALUE 'N'.               
006652         88  PS-NO-NEXT-SCREEN                   VALUE 'N'.               
006660         88  PS-NEXT-SCREEN                      VALUE 'Y'.               
006700 01  PV-PROGRAM-VARIABLES.                                        00590000
006800     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            00600000
006900                                              COMP SYNC.          00610000
007000     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            00620000
007100                                              COMP SYNC.          00630000
007200     05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0            00640000
007300                                              COMP SYNC.          00650000
007400                                                                  00660000
007500     EJECT                                                        00670000
007600**--------------------------------------------------------------**00680000
007700** THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING        **00690000
007800** SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.         **00700000
007900**--------------------------------------------------------------**00710000
008000     COPY VLWS006.                                                      00
008100 EJECT                                                            00730000
008200                                                                  00740000
008300*----------------------------------------------------------------*00750000
008400*    MAP LAYOUT                                                  *00760000
008500*----------------------------------------------------------------*00770000
008600                                                                  00780000
008700     COPY VLKM509.                                                00790000
008800                                                                  00800000
008900 EJECT                                                            00810000
009000*----------------------------------------------------------------*00820000
009100*    ATTRIBUTE SETTINGS COPYBOOK.                                *00830000
009200*----------------------------------------------------------------*00840000
009300                                                                  00850000
009400     COPY DPWS015.                                                00860000
009500                                                                  00870000
009600*----------------------------------------------------------------*00880000
009700*    FUNCTION KEYS COPYBOOK                                      *00890000
009800*----------------------------------------------------------------*00900000
009900                                                                  00910000
010000     COPY DPWS016.                                                00920000
010100                                                                  00930000
010200 EJECT                                                            00940000
010300**--------------------------------------------------------------**00950000
010400** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **00960000
010500** SUB-ROUTINE (DPKUT100).                                      **00970000
010600**--------------------------------------------------------------**00980000
010700     COPY DPWS010I.                                               00990000
010800 EJECT                                                            01000000
010900**--------------------------------------------------------------**01010000
011000** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS ARCHITECTURE*01020000
011100** APPLICATION PROGRAMMING INTERFACE MODULE.                    **01030000
011200**--------------------------------------------------------------**01040000
011300     COPY DPWS030.                                                01050000
CICS       COPY DPWS930.                                                01050000
011400 EJECT                                                            01060000
011500**--------------------------------------------------------------**01070000
011600*    STANDARD COMMAREA.                                           01080000
011700**--------------------------------------------------------------**01090000
011800                                                                  01100000
011900     COPY DPWS020.                                                01110000
012000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01120000
012100                                                                  01130000
012200***************************************************************** 01140000
012300*    INTER-APPLICATION COMMAREA.                                  01150000
012400***************************************************************** 01160000
012500                                                                  01170000
012600         10  INTER-APPL-COMM-AREA PIC X(200).                     01180000
012700     COPY VLWS005.                                                01190000
012900***************************************************************** 01210000
013000*    SPECIFIC COMMMAREA FOR VLKCS509.                             01220000
013100***************************************************************** 01230000
013200         10  ASC-SPECIFIC-COMMAREA.                               01240000
013300             15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            01250000
013400             15  ASC-TKT-PLCMNT-CDE        PIC  X(04).            01260000
013600             15  ASC-TKT-PLCMNT-DESC       PIC  X(50).            01280000
013800             15  ASC-USE-SELECTION-QUEUE-IND                      01300000
013900                                           PIC  X(01).            01310000
014000                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 01320000
014010                 88  ASC-SELECTION-QUEUE               VALUE 'N'.       00
014100             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            01330000
014200             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    01340000
014300             15  ASC-NUMBER-OF-SELECTED-ITEMS                     01350000
014400                                           PIC S9(09)  COMP-3.    01360000
014500             15  ASC-SEL-SUB               PIC S9(04)  COMP.      01370000
014600             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      01380000
014601             15  ASC-TKT-PLCMNT-CDE-OLD    PIC  X(04).            01260000
014602             15  ASC-TKT-PLCMNT-DESC-OLD   PIC  X(50).            01280000
014603             15  ASC-ACTION-SW              PIC X(03).                    
014604                 88  ASC-ADD-PENDING        VALUE 'ADD'.                  
014605                 88  ASC-DELETE-PENDING     VALUE 'DEL'.                  
014606                 88  ASC-UPDATE-PENDING     VALUE 'UPD'.                  
014607                 88  ASC-COPY-PENDING       VALUE 'COP'.                  
014608             15  ASC-ADD-COMPLETE-SW       PIC  X(01).                  VN
014609                88  ASC-ADD-COMPLETE                  VALUE 'Y'.        VN
014620                88  ASC-RECORD-NOT-ADDED              VALUE 'N'.        VN
014621             15  ASC-DELETE-SUCCESSFUL-SW   PIC X(01).                    
014630                 88  ASC-DELETE-SUCCESSFUL  VALUE 'Y'.                    
014631             15  ASC-ADD-SUCCESSFUL-SW      PIC X(01).                    
014632                 88  ASC-ADD-NOT-SUCCESSFUL VALUE ' '.                    
014640                 88  ASC-ADD-SUCCESSFUL     VALUE 'Y'.                    
014800     EJECT                                                        01400000
014900*----------------------------------------------------------------*01410000
015000*    ABEND PROCESSING COPYBOOK.                                  *01420000
015100*----------------------------------------------------------------*01430000
015200                                                                  01440000
015300     COPY DPWS013.                                                01450000
015400                                                                  01460000
015500 EJECT                                                            01470000
015600                                                                  01480000
015700*    DB2 AREA FOR THE (PRETICKET PLACEMENT DESCRIPTION TABLE)           00
015800                                                                  01500000
015900     EXEC SQL                                                     01510000
016000          INCLUDE TPLDESC                                         01520000
016100     END-EXEC.                                                    01530000
016800                                                                  01600000
016900*    DB2 AREA FOR COMMUNICATIONS                                  01610000
017000                                                                  01620000
017100     EXEC SQL                                                     01630000
017200          INCLUDE SQLCA                                           01640000
017300     END-EXEC.                                                    01650000
017400                                                                  01660000
017500 EJECT                                                            01670000
017600 LINKAGE SECTION.                                                 01680000
017700                                                                  01690000
017800 01  DFHCOMMAREA.                                                 01700000
017900     05  FILLER                         OCCURS  1 TO 4072 TIMES   01710000
018000                                        DEPENDING ON EIBCALEN.    01720000
018100         10  FILLER                     PIC X.                    01730000
018200                                                                  01740000
018300                                                                  01750000
018400 PROCEDURE DIVISION.                                              01760000
018500***************************************************************** 01770000
018600** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 01780000
018700** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 01790000
018800** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 01800000
018900**                                                             ** 01810000
019000** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 01820000
019100** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 01830000
019200***************************************************************** 01840000
019300 0000-MAIN-MODULE.                                                01850000
019400     INITIALIZE DP030-CICS-API-FIELDS.                            01860000
019500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       01870000
019600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          01880000
019700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         01890000
019800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       01900000
019900     MOVE LENGTH OF VL509AI        TO DP030-MAP-LENGTH (1).       01910000
020000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     01920000
020100     PERFORM 0001-CALL-CICS-ARCH-API.                             01930000
020200*                                                                 01940000
020300     PERFORM 1000-CONTROL-PROCESSING                              01950000
020400*                                                                 01960000
020500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     01970000
020600     PERFORM 0001-CALL-CICS-ARCH-API.                             01980000
020700                                                                  01990000
020800 0001-CALL-CICS-ARCH-API.                                         02000000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                              
021000                                    DFHCOMMAREA                           
021100                                    DP030-CICS-API-FIELDS                 
021200                                    DP020-STANDARD-COMMAREA               
021300                                    VL509AI.                              
021400*                                                                 02060000
021500     IF  DP030-RC-CALL-SUCCESSFUL                                 02070000
021600         CONTINUE                                                 02080000
021700     ELSE                                                         02090000
021800         SET DP013-NO-ROLLBACK                                    02100000
021900             DP013-XCTL-DISPLAY-RESTART                           02110000
022000             DP013-CICS-ABEND      TO TRUE                        02120000
022100         MOVE 'BEFORE 0000-MAIN-MODULE'                           02130000
022200                                   TO DP013-PARAGRAPH             02140000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O        
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)              
022500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      02170000
022600         PERFORM DP013-0000-PROCESS-ABEND                         02180000
022700     END-IF.                                                      02190000
022800 EJECT                                                            02200000
022900*----------------------------------------------------------------*02210000
023000*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02220000
023100*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02230000
023200*----------------------------------------------------------------*02240000
023300                                                                  02250000
023400 1000-CONTROL-PROCESSING.                                         02260000
023500                                                                  02270000
023600     EVALUATE TRUE                                                02280000
023700         WHEN DP020-NEXT-ACT-INITIAL                              02290000
023710         INITIALIZE ASC-SPECIFIC-COMMAREA                               00
023730         MOVE DP020-INT-APPL-FORMAT-IND                                 00
023740                                   TO ASC-INT-APPL-FORMAT-IND           00
023800         PERFORM 1100-PROCESS-INTER-APPL-COMM                           00
023900         IF  PS-COMMAREA-NOT-VALID                                      00
024000                  CONTINUE                                        02320000
024100         END-IF                                                         00
024110         IF ASC-ADD-PENDING                                               
024200             PERFORM 4050-BUILD-INITIAL-ADD-PANEL                       00
024210         ELSE                                                             
024220             PERFORM 4000-BUILD-INITIAL-PANEL                           00
024230         END-IF                                                           
024240         IF PS-NO-ERROR                                                   
024250             PERFORM 3200-RESET-ATTRIBUTES                                
024260             PERFORM 3500-SAVE-SCREEN-FIELDS                              
024270         END-IF                                                           
025000                                                                  02420000
025100         WHEN DP020-NEXT-ACT-READ-MAP                             02430000
025200             PERFORM 2000-PROCESS-PANEL                           02440000
025300                                                                  02450000
025400         WHEN DP020-NEXT-ACT-RETURN                               02460000
025410             PERFORM 3200-RESET-ATTRIBUTES                                
025500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02470000
025600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02480000
025700                                                                  02490000
025800         WHEN OTHER                                               02500000
025900             SET DP013-LOGIC-ABEND TO TRUE                        02510000
026000             SET DP013-NO-ROLLBACK TO TRUE                        02520000
026100             MOVE '1000-CONTROL-PROCESSING'                       02530000
026200                                   TO DP013-PARAGRAPH             02540000
026300             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02550000
026400                                   TO DP013-MESSAGE-TEXT(1)       02560000
026500             MOVE DP020-NEXT-APPL-ACTIVITY                        02570000
026600                                   TO DP013-MESSAGE-TEXT(2)       02580000
026700             PERFORM DP013-0000-PROCESS-ABEND                     02590000
026800     END-EVALUATE.                                                02600000
026900******************************************************************02610000
027000** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **02620000
027100** INTER-APPLICATION FORMAT CODE.                               **02630000
027200******************************************************************02640000
027300 1100-PROCESS-INTER-APPL-COMM.                                    02650000
027310     SET PS-COMMAREA-VALID      TO TRUE                                   
027400     INITIALIZE ASC-SPECIFIC-COMMAREA                                     
027700     EVALUATE DP020-INT-APPL-FORMAT-IND                           02690000
027800         WHEN PC-INTER-APPL-CRIT-SPEC                             02700000
027900             IF  VL005-TKT-PLCMNT-CDE > SPACES                    02710000
028000                 MOVE VL005-TKT-PLCMNT-CDE                        02720000
028100                                   TO ASC-TKT-PLCMNT-CDE          02730000
028200             ELSE                                                 02740000
028210                 MOVE SPACE        TO ASC-TKT-PLCMNT-CDE                  
028300* *              MOVE PC-TSYMSG-00148                             02750000
028400* *                                TO DP020-MSG-NUMBER            02760000
028500* *              SET DP020-MSG-FATAL                              02770000
028600* *                  DP020-NEXT-ACT-APPL-ERROR                    02780000
028700* *                                TO TRUE                        02790000
028800             END-IF                                               02800000
028900                                                                  02810000
029000         WHEN PC-INTER-APPL-LIST-ADD                                    00
029001             SET ASC-ADD-PENDING TO TRUE                                  
029003             SET DP030-SET-CURSOR-APPL-1                                  
029004                 ASC-USE-SELECTION-QUEUE                                  
029005                 ASC-ADD-PENDING   TO TRUE                                
029006             MOVE VL005-NUMBER-OF-SELECTED-ITEMS                          
029007                                   TO ASC-NUMBER-OF-SELECTED-ITEMS        
029008             MOVE VL005-NUMBER-OF-TS-ITEMS                                
029009                                   TO ASC-NUMBER-OF-TS-ITEMS              
029010             MOVE VL005-SEL-QUEUE-NAME                                    
029011                                   TO ASC-SEL-QUEUE-NAME                  
029012             IF VL005-NUMBER-OF-SELECTED-ITEMS = ZERO                     
029019                  MOVE SPACES TO   ASC-TKT-PLCMNT-CDE                     
029020                  MOVE SPACES TO   ASC-TKT-PLCMNT-DESC                    
029024             ELSE                                                         
029025                 PERFORM 1120-PREPARE-LIST-ENTRY                          
029026             END-IF                                                       
029042                                                                        00
029043         WHEN PC-INTER-APPL-LIST-UPD                                    00
029044         WHEN PC-INTER-APPL-LIST-DEL                                    00
029045             IF VL005-NUMBER-OF-SELECTED-ITEMS = ZERO                     
029046                 SET DP020-NEXT-ACT-APPL-ERROR                            
029047                     DP030-OVERRIDE-GO                                    
029048                     DP020-MSG-WARNING                                    
029049                     PS-ERROR                                             
029050                     PS-COMMAREA-NOT-VALID                                
029051                                   TO TRUE                                
029052                 MOVE PC-TSYMSG-00057                                     
029053                                   TO DP020-MSG-NUMBER                    
029054             ELSE                                                         
029055                 SET ASC-USE-SELECTION-QUEUE                              
029056                     DP030-SET-CURSOR-APPL-1                              
029057                                   TO TRUE                                
029058                 MOVE VL005-NUMBER-OF-SELECTED-ITEMS                      
029059                                   TO ASC-NUMBER-OF-SELECTED-ITEMS        
029060                 MOVE VL005-NUMBER-OF-TS-ITEMS                            
029061                                   TO ASC-NUMBER-OF-TS-ITEMS              
029062                 MOVE VL005-SEL-QUEUE-NAME                                
029063                                   TO ASC-SEL-QUEUE-NAME                  
029064                 PERFORM 1120-PREPARE-LIST-ENTRY                          
029065                 IF  PS-NO-ERROR                                          
029066                     IF DP020-INT-APPL-FORMAT-IND =                       
029067                        PC-INTER-APPL-LIST-UPD                            
029068                         SET ASC-UPDATE-PENDING                           
029069                                       TO TRUE                            
029070                     ELSE                                                 
029071                         MOVE PC-TSYMSG-00004                             
029072                                       TO DP020-MSG-NUMBER                
029073                         SET ASC-DELETE-PENDING                           
029074                         DP020-MSG-INFORMATIONAL                          
029075                                       TO TRUE                            
029076                     END-IF                                               
029080                 END-IF                                                   
029090             END-IF                                                       
029900                                                                  02910000
030000         WHEN OTHER                                               02920000
030400             MOVE PC-TSYMSG-00148                                         
030500                               TO DP020-MSG-NUMBER                        
030600             SET DP020-MSG-FATAL                                          
030700                 DP020-NEXT-ACT-APPL-ERROR                                
030800                               TO TRUE                                    
031000     END-EVALUATE.                                                03020000
031100******************************************************************03030000
031200** EDIT THE KEY ENTERED BY THE USER INTO THE KEY FIELD OF THE   **03040000
031300** COMMAND LINE.  A VALID MESSAGE NUMBER IS THE ONLY KEY        **03050000
031400** ACCEPTED.                                                    **03060000
031500******************************************************************03070000
031600 1110-EDIT-NAV-KEY.                                               03080000
031700     IF  ASC-TKT-PLCMNT-CDE  > SPACE                                    00
031800         CONTINUE                                                       00
032000     ELSE                                                               00
032600         SET PS-ERROR                                                   00
032700         DP020-MSG-FATAL   TO TRUE                                      00
032800*     -- INVALID DATA IN KEY FIELD ---                                  00
032900         MOVE PC-TSYMSG-00302  TO DP020-MSG-NUMBER                      00
033000         SET DP020-NEXT-ACT-APPL-ERROR                                  00
033100                                 TO TRUE                                00
033600     END-IF.                                                      03280000
033700*----------------------------------------------------------------*03290000
033800* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *03300000
033900* STORAGE QUEUE PASSED FROM THE LIST.                            *03310000
034000*----------------------------------------------------------------*03320000
034100 1120-PREPARE-LIST-ENTRY.                                         03330000
034200     MOVE VL006-MAX-ITEMS          TO ASC-SEL-SUB.                03340000
034300     MOVE ZERO                     TO ASC-SEL-ITEM.               03350000
034400     PERFORM 2110-GET-NEXT-MESSAGE.                               03360000
034401 1140-CHECK-DUPL-TPLDESC.                                                 
034402                                                                          
034403                                                                          
034404         EXEC SQL                                                         
034405            SELECT  TKT_PLCMNT_CDE                                        
034406                   ,TKT_PLCMNT_DESC                                       
034407                   ,CRER_ID                                               
034428              INTO :PLDESC-TKT-PLCMNT-CDE                                 
034429                  ,:PLDESC-TKT-PLCMNT-DESC                                
034430                  ,:PLDESC-CRER-ID                                        
034453              FROM  TPLDESC                                               
034454             WHERE TKT_PLCMNT_CDE      = :DK-TKT-PLCMNT-CDE               
034472         END-EXEC                                                         
034473                                                                          
034474         EVALUATE TRUE                                                    
034475             WHEN SQLCODE = +0                                            
034476                 SET PS-DESC-FOUND                                        
034477                                   TO TRUE                                
034478                                                                          
034479             WHEN SQLCODE = +100                                          
034480                 SET PS-DESC-NOT-FOUND                                    
034481                                   TO TRUE                                
034482                                                                          
034483             WHEN SQLCODE = -811                                          
034484                 SET PS-MULTI-DESC-FOUND                                  
034485                                   TO TRUE                                
034486                                                                          
034487             WHEN SQLCODE = -904                                          
034488             WHEN SQLCODE = -911                                          
034489             WHEN SQLCODE = -913                                          
034490                 PERFORM 9900-SOFT-ABORT                                  
034491                                                                          
034492             WHEN SQLWARN0 NOT = SPACES                                   
034493             WHEN SQLCODE < +0                                            
034494             WHEN SQLCODE > +0                                            
034495                 MOVE '1140-CHECK-DUPL-PLDESC'                            
034496                                   TO DP013-PARAGRAPH                     
034497                 MOVE 'CHECK IF DUPLICATE DESCRIPTION'                    
034498                                   TO DP013-MESSAGE-TEXT (1)              
034499                 MOVE SQLCA        TO DP013-SQLCA                         
034500                 MOVE 'TPLDESC'    TO DP013-DB2-TABLE-NAME (1)            
034501                 SET DP013-DB2-ABEND                                      
034502                                   TO TRUE                                
034503                 SET DP013-XCTL-DISPLAY-RESTART                           
034504                                   TO TRUE                                
034505                 PERFORM DP013-0000-PROCESS-ABEND                         
034506         END-EVALUATE.                                                    
034507                                                                          
034510*----------------------------------------------------------------*03370000
034600* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *03380000
034700* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *03390000
034800* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *03400000
034900* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *03410000
035000* FUNCTION KEYS CAN GET THIS FAR.                                *03420000
035100*----------------------------------------------------------------*03430000
035200                                                                  03440000
035300 2000-PROCESS-PANEL.                                              03450000
035400                                                                  03460000
035500     EVALUATE TRUE                                                03470000
035600                                                                  03480000
035700         WHEN DP020-SRC-AID = DP016-CLEAR                         03490000
035800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03500000
035900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03510000
035910                                                                  03480000
036000                                                                  03520000
036100         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03530000
036101             IF  ASC-DELETE-SUCCESSFUL                                    
036102                 MOVE PC-TSYMSG-00116                                     
036103                                   TO DP020-MSG-NUMBER                    
036104                 SET DP030-DONT-ERASE                                     
036105                     DP030-SEND-DATAONLY(PC-APPL-MAP)                     
036106                     DP020-MSG-FATAL                                      
036107                                   TO TRUE                                
036108             ELSE                                                         
036109*                INITIALIZE ASC-TKT-PLCMNT-CDE                            
036110*                           ASC-TKT-PLCMNT-DESC                           
036111                 SET DP030-SET-CURSOR-APPL-1                              
036112                                   TO TRUE                                
036113                 MOVE -1           TO ACODEL                              
036114                 MOVE ASC-TKT-PLCMNT-CDE-OLD                              
036115                                   TO DK-TKT-PLCMNT-CDE                   
036126                 IF ASC-ADD-PENDING                                       
036127*                 AND ASC-RECORD-NOT-ADDED)                             VN
036128*                AND ASC-ADD-NOT-SUCCESSFUL)                              
036129*                    MOVE ASC-TKT-PLCMNT-CDE                              
036130*                                  TO ASC-REC-SEQ-NBR                     
036139                     PERFORM 4050-BUILD-INITIAL-ADD-PANEL                 
036140                 ELSE                                                     
036143                     MOVE ASC-TKT-PLCMNT-CDE-OLD                          
036144                                   TO DK-TKT-PLCMNT-CDE                   
036145                     PERFORM 1140-CHECK-DUPL-TPLDESC                      
036146                     PERFORM 4000-BUILD-INITIAL-PANEL                     
036147                 END-IF                                                   
036148                 PERFORM 3200-RESET-ATTRIBUTES                            
036149                 PERFORM 3500-SAVE-SCREEN-FIELDS                          
036150             END-IF                                                       
036700                                                                  03590000
036800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             03600000
036900             IF  ASC-USE-SELECTION-QUEUE                          03610000
037000                 PERFORM 2110-GET-NEXT-MESSAGE                    03620000
037100                 PERFORM 4000-BUILD-INITIAL-PANEL                 03630000
037200                 PERFORM 3200-RESET-ATTRIBUTES                    03640000
037300             ELSE                                                 03650000
037400*                --- BOTTOM OF LIST ---                           03660000
037500                 MOVE PC-TSYMSG-00070                             03670000
037600                                   TO DP020-MSG-NUMBER            03680000
037700                 SET DP020-MSG-INFORMATIONAL                      03690000
037800                                   TO TRUE                        03700000
037900             END-IF                                               03710000
038000                                                                  03720000
038100         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             03730000
038200             IF  ASC-USE-SELECTION-QUEUE                          03740000
038300                 PERFORM 2120-GET-PREV-CODE                             00
038400                 PERFORM 4000-BUILD-INITIAL-PANEL                 03760000
038500                 PERFORM 3200-RESET-ATTRIBUTES                    03770000
038600             ELSE                                                 03780000
038700*                --- TOP OF LIST ---                              03790000
038800                 MOVE PC-TSYMSG-00069                             03800000
038900                                   TO DP020-MSG-NUMBER            03810000
039000                 SET DP020-MSG-INFORMATIONAL                      03820000
039100                                   TO TRUE                        03830000
039200             END-IF                                               03840000
039201         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                            
039202             IF  ASC-DELETE-SUCCESSFUL                                    
039203                 MOVE PC-TSYMSG-00116                                     
039204                                   TO DP020-MSG-NUMBER                    
039205                 SET DP020-MSG-FATAL                                      
039206                     PS-ERROR      TO TRUE                                
039207                 PERFORM 3200-RESET-ATTRIBUTES                            
039208             ELSE                                                         
039209                 SET DP030-CONTINUE-GO                                    
039210                                   TO TRUE                                
039212                 PERFORM 7000-DELETE-PLCMNT-ITEMS                         
039213             END-IF                                                       
039220                                                                          
039300                                                                  03850000
039400         WHEN OTHER                                               03860000
039500             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03870000
039600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03880000
039700             IF  PS-NO-ERROR                                      03890000
039800                 SET DP030-CONTINUE-GO                            03900000
039900                                   TO TRUE                        03910000
040000                 PERFORM 2100-CHECK-FUNCTION-KEY                  03920000
040100             ELSE                                                 03930000
040200                 SET DP030-OVERRIDE-GO                            03940000
040300                                   TO TRUE                        03950000
040400             END-IF                                               03960000
040500     END-EVALUATE.                                                03970000
040600*----------------------------------------------------------------*03980000
040700* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *03990000
040800* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *04000000
040900* FROM THE CICS ARCHITECTURE API.                                *04010000
041000*----------------------------------------------------------------*04020000
041100                                                                  04030000
041200 2100-CHECK-FUNCTION-KEY.                                         04040000
041300     EVALUATE TRUE                                                04050000
041301         WHEN ASC-ADD-COMPLETE                                    VNKCS007
041303             PERFORM 1100-PROCESS-INTER-APPL-COMM                 VNKCS000
041304             IF  PS-ERROR                                         VNKCS007
041305                 CONTINUE                                         VNKCS007
041306             ELSE                                                 VNKCS007
041307                 PERFORM 4000-BUILD-INITIAL-PANEL                 VNKCS007
041310             END-IF                                               VNKCS007
041320                                                                          
041400         WHEN DP020-SRC-AID = DP016-ENTER                         04060000
041500             CONTINUE                                             04070000
041600                                                                  04080000
041700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              04090000
041800             SET DP030-CONTINUE-GO TO TRUE                        04100000
041810             SET VL005-ADD TO TRUE                                        
041900             PERFORM 5125-ADD-PLCMNT-ITEMS                              00
042000*            ---     ADD SUCCESSFUL ---                           04120000
042001             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 VNKCS007
042002             IF PS-DESC-FOUND                                             
042003                 MOVE PC-TSYMSG-01344                                   KC
042005                                    TO DP020-MSG-NUMBER                   
042006                 SET DP020-MSG-INFORMATIONAL                              
042007                                       TO TRUE                        VNKC
042008                 SET ASC-ADD-PENDING  TO TRUE                             
042009                 SET DP030-ERASE-UNPROT TO TRUE                           
042015             ELSE                                                         
042016                 MOVE PC-TSYMSG-00034  TO DP020-MSG-NUMBER            VNKC
042017                 SET DP020-MSG-INFORMATIONAL                              
042018                                       TO TRUE                        VNKC
042019                 SET ASC-ADD-COMPLETE TO TRUE                             
042020                 SET DP030-ERASE-UNPROT TO TRUE                           
042021             END-IF                                                       
042022*            IF PS-ERROR                                                  
042023*                SET DP020-MSG-FATAL                                    00
042030*                                  TO TRUE                              00
042100*                MOVE PC-TSYMSG-00117  TO DP020-MSG-NUMBER              00
042101*            ELSE                                                         
042110*                MOVE PC-TSYMSG-00034  TO DP020-MSG-NUMBER              00
042200*                SET DP020-MSG-INFORMATIONAL                            00
042300*                                  TO TRUE                              00
042301*            END-IF                                                       
042310                                                                  04080000
042320         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              04090000
042330             SET DP030-CONTINUE-GO TO TRUE                        04100000
042340             PERFORM 5000-UPDATE-PLCMNT-CDE                             00
042350*            --- UPDATES SUCCESSFUL ---                           04120000
042351             IF PS-NO-CODE-FOUND                                          
042352                 MOVE PC-TSYMSG-01345                                   00
042355                                    TO DP020-MSG-NUMBER                   
042358                 SET PS-ERROR                                             
042359                     DP020-MSG-FATAL                                      
042360                                    TO TRUE                               
042361             ELSE                                                         
042362                 MOVE PC-TSYMSG-00059  TO DP020-MSG-NUMBER            0413
042370                 SET DP020-MSG-INFORMATIONAL                          0414
042380                                       TO TRUE                        0415
042400             END-IF                                               04160000
042410                                                                  04160000
042500         WHEN OTHER                                               04170000
042600             SET DP013-NO-ROLLBACK                                04180000
042700                 DP013-XCTL-DISPLAY-RESTART                       04190000
042800                 DP013-CICS-ABEND  TO TRUE                        04200000
042900             MOVE '2000-PROCESS-PANEL'                            04210000
043000                                   TO DP013-PARAGRAPH             04220000
043100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      04230000
043200                                   TO DP013-MESSAGE-TEXT (1)      04240000
043300             PERFORM DP013-0000-PROCESS-ABEND                     04250000
043400     END-EVALUATE.                                                04260000
043500                                                                  04270000
043600 2110-GET-NEXT-MESSAGE.                                           04280000
043700     ADD +1                        TO ASC-SEL-SUB.                04290000
043800     IF  ASC-SEL-SUB > VL006-MAX-ITEMS                            04300000
043900         ADD +1                    TO ASC-SEL-ITEM                04310000
044000         MOVE +1                   TO ASC-SEL-SUB                 04320000
044100     END-IF.                                                      04330000
044200     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                04340000
044300         PERFORM 9100-READ-SEL-QUEUE                              04350000
044400         IF  VL006-ITEM (ASC-SEL-SUB) > ZERO                      04360000
044500             MOVE VL006-TKT-PLCMNT-CDE (ASC-SEL-SUB)              04370000
044600                                   TO ASC-TKT-PLCMNT-CDE                00
044700             SET VL006-INQ (ASC-SEL-SUB)                          04390000
044800                                   TO TRUE                        04400000
044900             PERFORM 9200-REWRITE-LIST-QUEUE                      04410000
045000         ELSE                                                     04420000
045100             SUBTRACT +1 FROM ASC-SEL-SUB                         04430000
045200*            --- BOTTOM OF LIST ---                               04440000
045300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            04450000
045400             SET DP020-MSG-INFORMATIONAL                          04460000
045500                                   TO TRUE                        04470000
045600         END-IF                                                   04480000
045700     ELSE                                                         04490000
045800         SUBTRACT +1 FROM ASC-SEL-ITEM                            04500000
045900         MOVE VL006-MAX-ITEMS      TO ASC-SEL-SUB                 04510000
046000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            04520000
046100         SET DP020-MSG-INFORMATIONAL                              04530000
046200                                   TO TRUE                        04540000
046300     END-IF.                                                      04550000
046400******************************************************************04560000
046500** GET THE MESSAGE NUMBER (KEY) OF THE PREVIOUS SELECTED        **04570000
046600** OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **04580000
046700******************************************************************04590000
046800 2120-GET-PREV-CODE.                                                    00
046900     SUBTRACT +1 FROM ASC-SEL-SUB.                                04610000
047000     IF  ASC-SEL-SUB < +1                                         04620000
047100         SUBTRACT +1 FROM ASC-SEL-ITEM                            04630000
047200         MOVE VL006-MAX-ITEMS      TO ASC-SEL-SUB                 04640000
047300     END-IF.                                                      04650000
047400*                                                                 04660000
047500     IF  ASC-SEL-ITEM > ZERO                                      04670000
047600         PERFORM 9100-READ-SEL-QUEUE                              04680000
047700         MOVE VL006-TKT-PLCMNT-CDE (ASC-SEL-SUB)                        00
047800                                   TO ASC-TKT-PLCMNT-CDE                00
047900     ELSE                                                         04710000
048000         MOVE +1                   TO ASC-SEL-ITEM                04720000
048100                                      ASC-SEL-SUB                 04730000
048200*        --- TOP OF LIST ---                                      04740000
048300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            04750000
048400         SET DP020-MSG-INFORMATIONAL                              04760000
048500                                   TO TRUE                        04770000
048600     END-IF.                                                      04780000
048700 EJECT                                                            04790000
048800*----------------------------------------------------------------*04800000
048900* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *04810000
049000* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *04820000
049100* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *04830000
049200*----------------------------------------------------------------*04840000
049300                                                                  04850000
049400 2200-MOVE-SCREEN-TO-COMMAREA.                                    04860000
049500     IF  ACODEI > SPACE                                                 00
049600         MOVE ACODEI               TO ASC-TKT-PLCMNT-CDE                00
049700     ELSE                                                         04890000
049800         IF  ACODEF = DP015-ERASE-EOF                                   00
049900             MOVE SPACE            TO ASC-TKT-PLCMNT-DESC               00
050000         END-IF                                                   04920000
050100     END-IF.                                                      04930000
050200                                                                  04940000
050300     IF  ADESCI > SPACE                                                 00
050400         MOVE ADESCI               TO ASC-TKT-PLCMNT-DESC               00
050500     ELSE                                                         04970000
050600         IF  ADESCF = DP015-ERASE-EOF                                   00
050700             MOVE SPACE            TO ASC-TKT-PLCMNT-DESC               00
050800         END-IF                                                   05000000
050900     END-IF.                                                      05010000
051000 EJECT                                                            05020000
051100*----------------------------------------------------------------*05030000
051200* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *05040000
051300* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *05050000
051400* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *05060000
051500*----------------------------------------------------------------*05070000
051600                                                                  05080000
051700 3000-EDIT-DATA-IN-COMMAREA.                                      05090000
051800     PERFORM 3200-RESET-ATTRIBUTES.                               05100000
056300         MOVE ASC-TKT-PLCMNT-CDE   TO DK-TKT-PLCMNT-CDE                 00
056400         PERFORM 3310-SELECT-TPLDESC                              05560000
057900*                                                                 05710000
058000     IF  PS-NO-ERROR                                              05720000
058100         MOVE -1                   TO ACODEL                            00
058200         SET DP030-SET-CURSOR-APPL-1                              05740000
058300                                   TO TRUE                        05750000
058400     END-IF.                                                      05760000
058500*                                                                 05770000
058600*----------------------------------------------------------------*05780000
058700* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *05790000
058800* MAP.                                                           *05800000
058900*----------------------------------------------------------------*05810000
059000 3200-RESET-ATTRIBUTES.                                           05820000
059100     MOVE DP015-UNP-ALP-NOR-OFF    TO ACODEA                            00
059200                                      ADESCA.                           00
059300     MOVE DP015-GREEN              TO ACODEC                            00
059400                                      ADESCC.                           00
059500     MOVE DP015-UNDERLINE          TO ACODEH                            00
059600                                      ADESCH.                           00
059700*                                                                 05890000
059800*                                                                 05900000
059900 3310-SELECT-TPLDESC.                                             05910000
060000     PERFORM                                                      05920000
060100         WITH TEST AFTER                                          05930000
060200         VARYING PV-RETRY-COUNTER                                 05940000
060300         FROM 1 BY 1                                              05950000
060400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               05960000
060500                   OR (SQLCODE = ZERO)                            05970000
060600                   OR (SQLCODE = +100))                           05980000
060700*                                                                 05990000
060800         EXEC SQL                                                 06000000
060900             SELECT                                               06010000
061000                 TKT_PLCMNT_CDE                                   06020000
061100             INTO                                                 06030000
061200                 :PLDESC-TKT-PLCMNT-CDE                                 00
061300             FROM TPLDESC                                         06050000
061400             WHERE                                                06060000
061500                 TKT_PLCMNT_CDE = :DK-TKT-PLCMNT-CDE                    00
061700         END-EXEC                                                 06090000
061800                                                                  06100000
061900         EVALUATE TRUE                                            06110000
062000             WHEN SQLCODE = ZERO                                  06120000
062100             WHEN SQLCODE = +100                                  06130000
062200             WHEN SQLCODE = -904                                  06140000
062300             WHEN SQLCODE = -913                                  06150000
062400                 CONTINUE                                         06160000
062500             WHEN SQLWARN0 NOT = SPACES                           06170000
062600             WHEN SQLCODE < ZERO                                  06180000
062700             WHEN SQLCODE > ZERO                                  06190000
062800                 MOVE '3310-SELECT-TPLDESC'                       06200000
062900                                   TO DP013-PARAGRAPH             06210000
063000                 MOVE 'SELECT APPLICATION SYSTEM ID FOR SYS ID:'  06220000
063100                                   TO DP013-MESSAGE-TEXT (1)      06230000
063200                 MOVE DK-TKT-PLCMNT-CDE                           06240000
063300                                   TO DP013-MESSAGE-TEXT (2)      06250000
063400                 MOVE SQLCA        TO DP013-SQLCA                 06260000
063500                 MOVE 'TPLDESC'    TO DP013-DB2-TABLE-NAME (1)    06270000
063600                 SET DP013-DB2-ABEND                              06280000
063700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           06290000
063800                 PERFORM DP013-0000-PROCESS-ABEND                 06300000
063900         END-EVALUATE                                             06310000
064000     END-PERFORM.                                                 06320000
064100*                                                                 06330000
064200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        06340000
064300         MOVE '3310-SELECT-TPLDESC'                               06350000
064400                                   TO DP013-PARAGRAPH             06360000
064500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     06370000
064600                                   TO DP013-MESSAGE-TEXT (1)      06380000
064700         MOVE 'APLICATION SYS ID FOR SYS ID: '                    06390000
064800                                   TO DP013-MESSAGE-TEXT (2)      06400000
064900         MOVE DK-TKT-PLCMNT-CDE    TO DP013-MESSAGE-TEXT (3)      06410000
065000         MOVE SQLCA                TO DP013-SQLCA                 06420000
065100         MOVE 'TPLDESC'            TO DP013-DB2-TABLE-NAME (1)    06430000
065200         SET DP013-DB2-ABEND                                      06440000
065300             DP013-XCTL-DISPLAY-RESTART                           06450000
065400                                   TO TRUE                        06460000
065500         PERFORM DP013-0000-PROCESS-ABEND                         06470000
065600     END-IF.                                                      06480000
065700 EJECT                                                            06490000
065800*----------------------------------------------------------------*06500000
065900*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *06510000
066000*    ENTRY.                                                      *06520000
066100*----------------------------------------------------------------*06530000
066200                                                                  06540000
066201 3500-SAVE-SCREEN-FIELDS.                                                 
066202                                                                          
066203     MOVE ASC-TKT-PLCMNT-CDE       TO ASC-TKT-PLCMNT-CDE-OLD.             
066204     MOVE ASC-TKT-PLCMNT-DESC      TO ASC-TKT-PLCMNT-DESC-OLD.            
066220                                                                          
066300 4000-BUILD-INITIAL-PANEL.                                        06550000
066400     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        06560000
066500     MOVE -1                       TO ACODEL.                           00
066600         MOVE ASC-TKT-PLCMNT-CDE       TO DK-TKT-PLCMNT-CDE             00
066700         PERFORM 4100-GET-PLCMNT-DESC,                                  00
066900             MOVE PLDESC-TKT-PLCMNT-CDE                                   
066901                 TO ASC-TKT-PLCMNT-CDE.                                   
066910             MOVE PLDESC-TKT-PLCMNT-DESC                                  
066920                 TO ASC-TKT-PLCMNT-DESC.                                  
067000*            IF  SQLCODE = ZERO                                         00
067100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                    
067110                 MOVE ZERO TO SQLCODE.                                    
067200*            END-IF.                                                    00
067300                                                                  06650000
067303*----------------------------------------------------------------*06500000
067304*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *06510000
067305*    ENTRY.                                                      *06520000
067306*----------------------------------------------------------------*06530000
067307                                                                  06540000
067308 4050-BUILD-INITIAL-ADD-PANEL.                                    06550000
067309     SET ASC-RECORD-NOT-ADDED TO TRUE.                                    
067310     MOVE SPACES TO   ASC-TKT-PLCMNT-CDE                                  
067311     MOVE SPACES TO   ASC-TKT-PLCMNT-DESC                                 
067312     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                                
067320                                                                  06650000
067400*----------------------------------------------------------------*06660000
067500* SELECT A ROW FROM THE DB2 SYSTEM MESSAGE TABLE.                *06670000
067600*----------------------------------------------------------------*06680000
067700 4100-GET-PLCMNT-DESC.                                            06690000
067800     PERFORM                                                      06700000
067900         WITH TEST AFTER                                          06710000
068000         VARYING PV-RETRY-COUNTER                                 06720000
068100         FROM 1 BY 1                                              06730000
068200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               06740000
068300                   OR (SQLCODE = ZERO)                            06750000
068400                   OR (SQLCODE = +100))                           06760000
068500*                                                                 06770000
068600         EXEC SQL                                                 06780000
068700             SELECT TKT_PLCMNT_CDE,                               06790000
068800                    TKT_PLCMNT_DESC                                     00
069000             INTO   :PLDESC-TKT-PLCMNT-CDE,                             00
069010                    :PLDESC-TKT-PLCMNT-DESC                             00
069300             FROM   TPLDESC                                       06850000
069400             WHERE  TKT_PLCMNT_CDE = :DK-TKT-PLCMNT-CDE                 00
069500         END-EXEC                                                 06870000
069600                                                                  06880000
069700         EVALUATE TRUE                                            06890000
069800             WHEN SQLCODE = ZERO                                  06900000
069900             WHEN SQLCODE = +100                                  06910000
070000             WHEN SQLCODE = -904                                  06920000
070100             WHEN SQLCODE = -913                                  06930000
070200                 CONTINUE                                         06940000
070300             WHEN SQLWARN0 NOT = SPACES                           06950000
070400             WHEN SQLCODE < ZERO                                  06960000
070500             WHEN SQLCODE > ZERO                                  06970000
070600                 MOVE '4100-GET-PLCMNT-DESC'                      06980000
070700                                   TO DP013-PARAGRAPH             06990000
070800                 MOVE 'SELECT MESSAGE NUMBER'                     07000000
070900                                   TO DP013-MESSAGE-TEXT (1)      07010000
071000                 MOVE SQLCA        TO DP013-SQLCA                 07020000
071100                 MOVE 'TSYMSG '    TO DP013-DB2-TABLE-NAME (1)    07030000
071200                 SET DP013-DB2-ABEND                              07040000
071300                     DP013-XCTL-DISPLAY-RESTART                   07050000
071400                                   TO TRUE                        07060000
071500                 PERFORM DP013-0000-PROCESS-ABEND                 07070000
071600         END-EVALUATE                                             07080000
071700     END-PERFORM.                                                 07090000
071800*                                                                 07100000
071900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        07110000
072000         MOVE '4100-GET-MESSAGE'                                  07120000
072100                                   TO DP013-PARAGRAPH             07130000
072200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     07140000
072300                                   TO DP013-MESSAGE-TEXT (1)      07150000
072400         MOVE 'SHORT MESSAGE'      TO DP013-MESSAGE-TEXT (2)      07160000
072500         MOVE SQLCA                TO DP013-SQLCA                 07170000
072600         MOVE 'TSYMSG '            TO DP013-DB2-TABLE-NAME (1)    07180000
072700         SET DP013-DB2-ABEND                                      07190000
072800             DP013-XCTL-DISPLAY-RESTART                           07200000
072900                                   TO TRUE                        07210000
073000         PERFORM DP013-0000-PROCESS-ABEND                         07220000
073100     END-IF.                                                      07230000
073200*----------------------------------------------------------------*07240000
073300*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *07250000
073400*----------------------------------------------------------------*07260000
073500                                                                  07270000
073600 4400-MOVE-COMMAREA-TO-SCREEN.                                    07280000
073700     MOVE ASC-TKT-PLCMNT-CDE       TO ACODEO.                           00
073710     MOVE ASC-TKT-PLCMNT-DESC      TO ADESCO.                           00
073720                                                                  07270000
073730 4401-MOVE-COMMAREA-TO-SCREEN.                                    07280000
073740     MOVE SPACES                   TO ACODEO.                           00
073750     MOVE SPACES                   TO ADESCO.                           00
074000                                                                  07320000
074100 EJECT                                                            07330000
074200*----------------------------------------------------------------*07340000
074300* APPLY THE CHANGES TO THE MESSAGE TO THE DB2 TABLE.             *07350000
074400*----------------------------------------------------------------*07360000
074500 5000-UPDATE-PLCMNT-CDE.                                                00
074510     SET PS-NEXT-SCREEN TO TRUE.                                          
074600     MOVE ASC-TKT-PLCMNT-CDE       TO DK-TKT-PLCMNT-CDE.          07380000
074610     MOVE ASC-TKT-PLCMNT-DESC      TO DK-TKT-PLCMNT-DESC.         07380000
074900     PERFORM 5100-UPDATE-PLCMNT-DESC.                             07420000
075000     IF  ASC-USE-SELECTION-QUEUE                                  07430000
075100         PERFORM 5200-UPDATE-SELECTION-QUEUE                      07440000
075200     END-IF.                                                      07450000
075300******************************************************************07460000
075400** UPDATE THE ROW ON THE DB2 TABLE.                             **07470000
075500******************************************************************07480000
075600 5100-UPDATE-PLCMNT-DESC.                                         07490000
075700     PERFORM                                                      07500000
075800         WITH TEST AFTER                                          07510000
075900         VARYING PV-RETRY-COUNTER                                 07520000
076000         FROM 1 BY 1                                              07530000
076100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               07540000
076200                   OR (SQLCODE = ZERO)                                  00
076210                   OR (SQLCODE = +100))                           07550000
076300         EXEC SQL                                                 07560000
076400             UPDATE TPLDESC                                       07570000
076500                 SET TKT_PLCMNT_CDE  = :DK-TKT-PLCMNT-CDE,              00
076510                     TKT_PLCMNT_DESC = :DK-TKT-PLCMNT-DESC              00
076700             WHERE TKT_PLCMNT_CDE = :DK-TKT-PLCMNT-CDE                  00
076800         END-EXEC                                                 07620000
076900                                                                  07630000
077000         EVALUATE TRUE                                            07640000
077100             WHEN SQLCODE = ZERO                                  07650000
077101                   SET VL005-UPD TO TRUE                                  
077102                   SET PS-CODE-FOUND TO TRUE                              
077110                   MOVE SPACES TO VL005-TKT-PLCMNT-CDE                  00
077200             WHEN SQLCODE = -904                                  07660000
077210             WHEN SQLCODE = +100                                  07660000
077220                 SET PS-NO-CODE-FOUND TO TRUE                             
077240                 SET ASC-SELECTION-QUEUE TO TRUE                        00
077300             WHEN SQLCODE = -913                                  07670000
077400                 CONTINUE                                         07680000
077500             WHEN SQLWARN0 NOT = SPACES                           07690000
077600             WHEN SQLCODE < ZERO                                  07700000
077700             WHEN SQLCODE > ZERO                                  07710000
077800                 MOVE '5100-UPDATE-PLCMNT-DESC'                   07720000
077900                                   TO DP013-PARAGRAPH             07730000
078000                 MOVE 'UPDATE A ROW ON THE PRETICKET DESC TABLE'  07740000
078100                                   TO DP013-MESSAGE-TEXT(1)       07750000
078200                 MOVE SQLCA        TO DP013-SQLCA                 07760000
078300                 MOVE 'TPLDESC'    TO DP013-DB2-TABLE-NAME (1)    07770000
078400                 SET DP013-DB2-ABEND                              07780000
078500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           07790000
078600                 PERFORM DP013-0000-PROCESS-ABEND                 07800000
078700         END-EVALUATE                                             07810000
078800     END-PERFORM.                                                 07820000
078900*                                                                 07830000
079000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        07840000
079100         MOVE '5100-UPDATE-MESSAGE'                               07850000
079200                                   TO DP013-PARAGRAPH             07860000
079300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE A SYS07870000
079400-             'TEM MESSAGE'        TO DP013-MESSAGE-TEXT (1)      07880000
079500         MOVE SQLCA                TO DP013-SQLCA                 07890000
079600         MOVE 'TSYMSG '            TO DP013-DB2-TABLE-NAME (1)    07900000
079700         SET DP013-DB2-ABEND                                      07910000
079800             DP013-XCTL-DISPLAY-RESTART                           07920000
079900                                   TO TRUE                        07930000
080000         PERFORM DP013-0000-PROCESS-ABEND                         07940000
080100     END-IF.                                                      07950000
080110 EJECT                                                            07330000
080120*----------------------------------------------------------------*07340000
080130* APPLY THE CHANGES TO THE MESSAGE TO THE DB2 TABLE.             *07350000
080140*----------------------------------------------------------------*07360000
080150 5125-ADD-PLCMNT-ITEMS.                                                 00
080160     MOVE ASC-TKT-PLCMNT-CDE       TO PLDESC-TKT-PLCMNT-CDE.            00
080170     MOVE ASC-TKT-PLCMNT-DESC      TO PLDESC-TKT-PLCMNT-DESC.           00
080171     MOVE DP020-USERID             TO PLDESC-CRER-ID.                   00
080180     PERFORM 5175-INSERT-PLCMNT-ITEMS.                                  00
080190     IF  ASC-USE-SELECTION-QUEUE                                  07430000
080191         PERFORM 5200-UPDATE-SELECTION-QUEUE                      07440000
080192     END-IF.                                                      07450000
080193******************************************************************07460000
080194** UPDATE THE ROW ON THE DB2 TABLE.                             **07470000
080195******************************************************************07480000
080196 5175-INSERT-PLCMNT-ITEMS.                                              00
080197     PERFORM                                                      07500000
080198         WITH TEST AFTER                                          07510000
080199         VARYING PV-RETRY-COUNTER                                 07520000
080200         FROM 1 BY 1                                              07530000
080201         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               07540000
080202                   OR (SQLCODE = ZERO)                                  00
080203                   OR (SQLCODE = -803))                           07550000
080204         EXEC SQL                                                 07560000
080205             INSERT INTO TPLDESC                                        00
080206                (TKT_PLCMNT_CDE,                                        00
080207                 TKT_PLCMNT_DESC,                                       00
080208                 CRER_ID)                                               00
080209            VALUES (:PLDESC-TKT-PLCMNT-CDE,                             00
080210                    :PLDESC-TKT-PLCMNT-DESC,                            00
080211                    :PLDESC-CRER-ID)                                    00
080212         END-EXEC                                                 07620000
080213                                                                  07630000
080214         EVALUATE TRUE                                            07640000
080215             WHEN SQLCODE = ZERO                                  07650000
080216                  SET PS-DESC-NOT-FOUND TO TRUE                           
080217                   SET VL005-ADD TO TRUE                                  
080218                   MOVE PLDESC-TKT-PLCMNT-CDE                           00
080219                               TO VL005-TKT-PLCMNT-CDE                  00
080220             WHEN SQLCODE = -904                                  07660000
080221             WHEN SQLCODE = -913                                  07670000
080222                 CONTINUE                                         07680000
080223             WHEN SQLCODE = -803                                  07670000
080224                 SET PS-ERROR TO TRUE                             07680000
080225                 SET PS-DESC-FOUND TO TRUE                                
080226                 MOVE SPACES                                            00
080227                               TO VL005-TKT-PLCMNT-CDE                  00
080228             WHEN SQLWARN0 NOT = SPACES                           07690000
080229             WHEN SQLCODE < ZERO                                  07700000
080230             WHEN SQLCODE > ZERO                                  07710000
080231                 MOVE '5175-INSERT-PLCMNT-ITEMS'                  07720000
080232                                   TO DP013-PARAGRAPH             07730000
080233                 MOVE 'INSERT A ROW ON THE PRETICKET DESC TABLE'  07740000
080234                                   TO DP013-MESSAGE-TEXT(1)       07750000
080235                 MOVE SQLCA        TO DP013-SQLCA                 07760000
080236                 MOVE 'TPLDESC'    TO DP013-DB2-TABLE-NAME (1)    07770000
080237                 SET DP013-DB2-ABEND                              07780000
080238                     DP013-XCTL-DISPLAY-RESTART TO TRUE           07790000
080239                 PERFORM DP013-0000-PROCESS-ABEND                 07800000
080240         END-EVALUATE                                             07810000
080241     END-PERFORM.                                                 07820000
080242*                                                                 07830000
080243     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        07840000
080244         MOVE '5100-UPDATE-MESSAGE'                               07850000
080245                                   TO DP013-PARAGRAPH             07860000
080246         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE A SYS07870000
080247-             'TEM MESSAGE'        TO DP013-MESSAGE-TEXT (1)      07880000
080248         MOVE SQLCA                TO DP013-SQLCA                 07890000
080249         MOVE 'TSYMSG '            TO DP013-DB2-TABLE-NAME (1)    07900000
080250         SET DP013-DB2-ABEND                                      07910000
080251             DP013-XCTL-DISPLAY-RESTART                           07920000
080252                                   TO TRUE                        07930000
080253         PERFORM DP013-0000-PROCESS-ABEND                         07940000
080254     END-IF.                                                      07950000
080260 EJECT                                                            07960000
080300*----------------------------------------------------------------*07970000
080400* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *07980000
080500* OBJECT WAS UDPATED.                                            *07990000
080600*----------------------------------------------------------------*08000000
080700 5200-UPDATE-SELECTION-QUEUE.                                     08010000
080800     PERFORM 9100-READ-SEL-QUEUE.                                 08020000
080900     SET VL006-UPD (ASC-SEL-SUB) TO TRUE.                         08030000
081000     PERFORM 9200-REWRITE-LIST-QUEUE.                             08040000
081001/                                                                         
081002*----------------------------------------------------------------*        
081003*    PERFORM DELETE TICKET PLACEMENT ITEMS.                      *        
081004*----------------------------------------------------------------*        
081005 7000-DELETE-PLCMNT-ITEMS.                                                
081006                                                                          
081007     SET PS-NEXT-SCREEN TO TRUE.                                          
081008     MOVE ASC-TKT-PLCMNT-CDE       TO DK-TKT-PLCMNT-CDE.                  
081009                                                                          
081010     PERFORM 7010-DELETE-TPLDESC.                                         
081011                                                                          
081017                                                                          
081018     MOVE PC-TSYMSG-00115          TO DP020-MSG-NUMBER.                   
081019     SET DP020-MSG-INFORMATIONAL                                          
081020         ASC-DELETE-SUCCESSFUL     TO TRUE.                               
081021                                                                          
081022     IF  ASC-USE-SELECTION-QUEUE                                          
081023         PERFORM 5200-UPDATE-SELECTION-QUEUE                              
081024     END-IF.                                                              
081025                                                                          
081026*----------------------------------------------------------------*        
081027*    PERFORM DELETE TICKET PLACEMENT ITEMS.                      *        
081028*----------------------------------------------------------------*        
081029 7010-DELETE-TPLDESC.                                                     
081030         EXEC SQL                                                 07560000
081031             DELETE                                                     00
081032                FROM TPLDESC                                            00
081033                 WHERE TKT_PLCMNT_CDE = :DK-TKT-PLCMNT-CDE              00
081039         END-EXEC                                                 07620000
081040                                                                  07630000
081041         EVALUATE TRUE                                            07640000
081042             WHEN SQLCODE = ZERO                                  07650000
081043             WHEN SQLCODE = +100                                  07650000
081044                 SET VL005-DEL TO TRUE                                    
081045                 MOVE SPACES TO VL005-TKT-PLCMNT-CDE                      
081046             WHEN SQLCODE = -904                                  07660000
081047             WHEN SQLCODE = -911                                  07660000
081048             WHEN SQLCODE = -913                                  07670000
081049                 SET PS-UPDATES-DONE TO TRUE                      07680000
081050                 PERFORM 9900-SOFT-ABORT                                  
081052             WHEN SQLWARN0 NOT = SPACES                           07690000
081053             WHEN SQLCODE < ZERO                                  07700000
081054             WHEN SQLCODE > ZERO                                  07710000
081055                 MOVE '7010-DELETE-PLCMNT-ITEMS'                  07720000
081056                                   TO DP013-PARAGRAPH             07730000
081057                 MOVE 'DELETE A ROW FROM PRETICKET DESC TABLE'          00
081058                                   TO DP013-MESSAGE-TEXT(1)       07750000
081059                 MOVE SQLCA        TO DP013-SQLCA                 07760000
081060                 MOVE 'TPLDESC'    TO DP013-DB2-TABLE-NAME (1)    07770000
081061                 SET DP013-DB2-ABEND                              07780000
081062                     DP013-XCTL-DISPLAY-RESTART TO TRUE           07790000
081063                 PERFORM DP013-0000-PROCESS-ABEND                 07800000
081064         END-EVALUATE.                                            07810000
081070/                                                                         
081100 EJECT                                                            08050000
081200*----------------------------------------------------------------*08060000
081300* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *08070000
081400*----------------------------------------------------------------*08080000
081500                                                                  08090000
081600 9100-READ-SEL-QUEUE.                                             08100000
081700     EXEC CICS                                                    08110000
081800         READQ TS                                                 08120000
081900             QUEUE (ASC-SEL-QUEUE-NAME)                           08130000
082000             INTO  (VL006-LINE-SEL-REC)                                 00
082100             ITEM  (ASC-SEL-ITEM)                                 08150000
082200             RESP  (PV-CICS-RESPONSE)                             08160000
082300     END-EXEC.                                                    08170000
082400                                                                  08180000
082500     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   08190000
082600         CONTINUE                                                 08200000
082700     ELSE                                                         08210000
082800         SET DP013-LOGIC-ABEND                                    08220000
082900             DP013-NO-ROLLBACK     TO TRUE                        08230000
083000         MOVE '9100-READ-SEL-QUEUE'                               08240000
083100                                   TO DP013-PARAGRAPH             08250000
083200         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   08260000
083300                                   TO DP013-MESSAGE-TEXT (1)      08270000
083400         PERFORM DP013-0000-PROCESS-ABEND                         08280000
083500     END-IF.                                                      08290000
083600*----------------------------------------------------------------*08300000
083700* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *08310000
083800*----------------------------------------------------------------*08320000
083900 9200-REWRITE-LIST-QUEUE.                                         08330000
084000     EXEC CICS                                                    08340000
084100          WRITEQ TS                                               08350000
084200              QUEUE  (ASC-SEL-QUEUE-NAME)                         08360000
084300              FROM   (VL006-LINE-SEL-REC)                               00
084400              ITEM   (ASC-SEL-ITEM)                               08380000
084500              RESP   (PV-CICS-RESPONSE)                           08390000
084600              REWRITE                                             08400000
084700     END-EXEC.                                                    08410000
084800                                                                  08420000
084900     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               08430000
085000         SET DP013-CICS-ABEND                                     08440000
085100             DP013-NO-ROLLBACK     TO TRUE                        08450000
085200         MOVE '9200-REWRITE-LIST-QUEUE'                           08460000
085300                                   TO DP013-PARAGRAPH             08470000
085400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   08480000
085500                                   TO DP013-MESSAGE-TEXT (1)      08490000
085600         PERFORM DP013-0000-PROCESS-ABEND                         08500000
085700     END-IF.                                                      08510000
085800                                                                  08520000
085900 EJECT                                                            08530000
085901*----------------------------------------------------------------*        
085902*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *        
085903*    AND THE ERROR SWITCHES.                                     *        
085904*----------------------------------------------------------------*        
085905 9900-SOFT-ABORT.                                                         
085906     SET PS-ERROR         TO TRUE.                                        
085907     SET DP020-MSG-FATAL  TO TRUE.                                        
085908     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                            
085909     IF PS-NO-NEXT-SCREEN                                                 
085910        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                             
085911     END-IF.                                                              
085912     IF PS-UPDATES-DONE AND SQLCODE = -913                                
085913        PERFORM 9901-BACKUP                                               
085914     END-IF.                                                              
085915     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).                  
085916     PERFORM 0001-CALL-CICS-ARCH-API.                                     
085917                                                                          
085918 9901-BACKUP.                                                             
085919     EXEC CICS SYNCPOINT                                                  
085920          ROLLBACK                                                        
085930     END-EXEC.                                                            
086000*----------------------------------------------------------------*08540000
086100*    ABEND PROCESSOR MODULE                                      *08550000
086200*----------------------------------------------------------------*08560000
086300                                                                  08570000
086400     COPY DPPD013.                                                08580000
