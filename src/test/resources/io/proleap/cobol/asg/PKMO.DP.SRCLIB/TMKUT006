000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             TMKUT006.                                00050000
000600 AUTHOR.                 RON KRIER.                               00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            9-19-96.                                 00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*----------------------------------------------------------------*00110000
001200* THIS PROGRAM WILL TAKE IN AN EXTRACT FILE WHICH WILL CONTAIN   *00120000
001300* ALL OF THE ASSIGNED TROUBLE WITHIN A CERTAIN TIME FRAME AND    *00130000
001400* READ A TABLE TO DETERMINE WHAT TROUBLE CODES NEED TO BE        *00140000
001500* EXTRACTED FROM THE FILE AND PASSED ONTO THE REPORTING PROGRAM. *00150000
001600*----------------------------------------------------------------*00160000
001700                                                                  00170000
001800******************************************************************00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000******************************************************************00200000
002100                                                                  00210000
002200 CONFIGURATION SECTION.                                           00220000
002300                                                                  00230000
002400 SOURCE-COMPUTER.        IBM-3090.                                00240000
002500 OBJECT-COMPUTER.        IBM-3090.                                00250000
002600                                                                  00260000
002700 INPUT-OUTPUT SECTION.                                            00270000
002800                                                                  00280000
002900 FILE-CONTROL.                                                    00290000
003000                                                                  00300000
003100      SELECT EXTRACT-TRBL-FILE-IN       ASSIGN TO INP01.          00310000
003200                                                                  00320000
003300      SELECT EXTRACT-TRBL-FILE-OUT      ASSIGN TO OUT01.          00330000
003400                                                                  00340000
003500******************************************************************00350000
003600 DATA DIVISION.                                                   00360000
003700******************************************************************00370000
003800                                                                  00380000
003900 FILE SECTION.                                                    00390000
004000 FD  EXTRACT-TRBL-FILE-IN                                         00400000
004100     LABEL RECORDS ARE STANDARD                                   00410000
004200     BLOCK CONTAINS 0 RECORDS                                     00420000
004300     RECORDING MODE IS F                                          00430000
004400     RECORD CONTAINS 400 CHARACTERS                               00440002
004500     DATA RECORD IS TE-TRBL-EXTRACT-RCD-IN.                       00450000
004600                                                                  00460000
004700 01  TE-TRBL-EXTRACT-RCD-IN          PIC X(400).                  00470001
004800                                                                  00480000
004900                                                                  00490000
005000 FD  EXTRACT-TRBL-FILE-OUT                                        00500000
005100     LABEL RECORDS ARE STANDARD                                   00510000
005200     BLOCK CONTAINS 0 RECORDS                                     00520000
005300     RECORDING MODE IS F                                          00530000
005400     RECORD CONTAINS 400 CHARACTERS                               00540002
005500     DATA RECORD IS TE-TRBL-EXTRACT-RCD-OUT.                      00550000
005600                                                                  00560000
005700 01  TE-TRBL-EXTRACT-RCD-OUT         PIC X(400).                  00570001
005800*------------------------------------------------------*          00580000
005900 WORKING-STORAGE SECTION.                                         00590000
006000*------------------------------------------------------*          00600000
006100 01 PA-PROGRAM-ACCUMULATORS.                                      00610000
006200    05 PA-RESOLVE-HOURS              PIC S9(10) VALUE 0 COMP-3.   00620000
006300    05 PA-RESOLVE-MINUTES            PIC S9(10) VALUE 0 COMP-3.   00630000
006301    05 PA-NBR-OF-RESOLVED-TRBLS      PIC S9(10) VALUE 0 COMP-3.   00630199
006302 01 PC-PROGRAM-CONSTANTS.                                         00630200
006303    05 PC-PROGRAM-NAME               PIC X(08) VALUE 'TMKUT006'.  00630300
006304    05 PC-DEFAULT-CC-DATE            PIC X(10) VALUE '1999-99-99'.00630400
006400    05 PC-DATE-MODULE                PIC X(08) VALUE 'DPKUT500'.  00640000
006500    05 PC-NOT-FOUND                  PIC X(15) VALUE              00650099
006501       '** NOT FOUND **'.                                         00650199
006502    05 PC-99999                      PIC S9(5) VALUE +99999.      00650206
006600    05 PC-A                          PIC X(01) VALUE 'A'.         00660003
006601    05 PC-AA                         PIC X(02) VALUE 'AA'.        00660199
006602    05 PC-AF                         PIC X(02) VALUE 'AF'.        00660203
006603    05 PC-AG                         PIC X(02) VALUE 'AG'.        00660303
006604    05 PC-AI                         PIC X(02) VALUE 'AI'.        00660403
006605    05 PC-AK                         PIC X(02) VALUE 'AK'.        00660503
006606    05 PC-AM                         PIC X(02) VALUE 'AM'.        00660603
006607    05 PC-BB                         PIC X(02) VALUE 'BB'.        00660703
006608    05 PC-DC                         PIC X(02) VALUE 'DC'.        00660803
006609    05 PC-DD                         PIC X(02) VALUE 'DD'.        00660903
006610    05 PC-GMA                        PIC X(03) VALUE 'GMA'.       00661003
006611    05 PC-GMM                        PIC X(03) VALUE 'GMM'.       00661103
006612    05 PC-HH                         PIC X(02) VALUE 'HH'.        00661203
006613    05 PC-LL                         PIC X(02) VALUE 'LL'.        00661303
006614    05 PC-PP                         PIC X(02) VALUE 'PP'.        00661403
006700    05 PC-B                          PIC X(01) VALUE 'B'.         00670003
006800    05 PC-N                          PIC X(01) VALUE 'N'.         00680099
006900    05 PC-00                         PIC X(02) VALUE '00'.        00690099
007000    05 PC-03                         PIC X(02) VALUE '03'.        00700099
007100    05 PC-269                        PIC 9(03) VALUE 269.         00710099
007200    05 PC-271                        PIC 9(03) VALUE 271.         00720099
007300    05 PC-501                        PIC 9(03) VALUE 501.         00730099
007400    05 PC-502                        PIC 9(03) VALUE 502.         00740099
007500    05 PC-508                        PIC 9(03) VALUE 508.         00750099
007600    05 PC-509                        PIC 9(03) VALUE 509.         00760099
007700    05 PC-510                        PIC 9(03) VALUE 510.         00770099
007800    05 PC-512                        PIC 9(03) VALUE 512.         00780099
007900    05 PC-520                        PIC 9(03) VALUE 520.         00790099
008000    05 PC-521                        PIC 9(03) VALUE 521.         00800099
008100    05 PC-530                        PIC 9(03) VALUE 530.         00810099
008200    05 PC-570                        PIC 9(03) VALUE 570.         00820099
008300    05 PC-571                        PIC 9(03) VALUE 571.         00830099
008400    05 PC-579                        PIC 9(03) VALUE 579.         00840099
008500    05 PC-580                        PIC 9(03) VALUE 580.         00850099
008600    05 PC-582                        PIC 9(03) VALUE 582.         00860099
008700    05 PC-583                        PIC 9(03) VALUE 583.         00870099
008800    05 PC-591                        PIC 9(03) VALUE 591.         00880099
008801    05 PC-592                        PIC 9(03) VALUE 592.         00880199
008802    05 PC-RESOLVED                   PIC X(01) VALUE 'R'.         00880203
008803    05 PC-SPACE                      PIC X(01) VALUE ' '.         00880303
008804    05 PC-APPROVED                   PIC X(01) VALUE 'A'.         00880400
008805                                                                  00880599
008806                                                                  00880699
008807     05  PV-REASON-CODE              PIC S9(4)     VALUE 0 COMP.  00880799
008808         88  PC-SHORT-REASON         VALUES  510, 512, 450, 451,  00880899
008809                                             452, 453, 454, 455,  00880999
008810                                             456, 457, 458.       00881099
008820                                                                  00882099
008830         88  PC-PACK-SHORT-REASON    VALUES  570, 571,            00883099
008840                                             459, 460,            00884099
008850                                             461, 462, 463, 464,  00885099
008860                                             465, 466, 467.       00886099
008870                                                                  00887099
008880         88  PC-OVER-REASON          VALUES  520, 521,            00888099
008890                                             610, 611, 612, 613,  00889099
008900                                             614, 615, 616, 617,  00890099
009000                                             618, 619,            00900099
009100                                             620, 621, 622, 623,  00910099
009200                                             624, 625, 626, 627,  00920099
009300                                             628, 629,            00930099
009400                                             630, 631, 632, 633,  00940099
009500                                             634, 635, 636, 637,  00950099
009600                                             638, 639,            00960099
009700                                             640, 641, 642, 643,  00970099
009800                                             644, 645, 646, 647,  00980099
009900                                             648, 649.            00990099
010000                                                                  01000099
010100         88  PC-PACK-OVER-REASON     VALUES  579, 580,            01010099
010200                                             650, 651, 652, 653,  01020099
010300                                             654, 655, 656, 657,  01030099
010400                                             658, 659,            01040099
010500                                             660, 661, 662, 663,  01050099
010600                                             664, 665, 666, 667,  01060099
010700                                             668, 669,            01070099
010800                                             670, 671, 672, 673,  01080099
010900                                             674, 675, 676, 677,  01090099
011000                                             678, 679,            01100099
011100                                             680, 681, 682, 683,  01110099
011200                                             684, 685, 686, 687,  01120099
011300                                             688, 689.            01130099
011400                                                                  01140099
011401                                                                  01140199
011402    05 PC-HOURS-PER-DAY              PIC 9(02) VALUE 24.          01140200
011403    05 PC-MINUTES-PER-HOUR           PIC 9(02) VALUE 60.          01140300
011404                                                                  01140400
011405 01  WS-REASON-TOTAL-RECORD.                                      01140506
011406     05  RTR-RECORD-TYPE             PIC X(2)  VALUE 'CM'.        01140606
011407     05  RTR-SORT-FIELD.                                          01140706
011408         10  RTR-SF-RSN-NOTIF-CDE    PIC X(1).                    01140806
011409         10  RTR-SF-RSN-QTY          PIC 9(5).                    01140906
011410         10  RTR-SF-TRBL-RSN-CDE     PIC 9(8).                    01141006
011420         10  FILLER                  PIC X(11).                   01142006
011430     05  RTR-REPORT-DIVISION         PIC X(2)      VALUE 'PP'.    01143099
011440     05  RTR-REPORT-NOTIF-CDE        PIC X(1).                    01144099
011450     05  RTR-REPORT-OPER-UNT-ID      PIC S9(4)     COMP.          01145099
011460     05  RTR-REPORT-GMM-NBR          PIC X(2)      VALUE SPACES.  01146099
011461     05  FILLER                      PIC X(05)     VALUE SPACES.  01146199
011462     05  RTR-TRBL-RSN-CDE            PIC S9(4)     COMP.          01146206
011463     05  RTR-TRBL-RSN-CDE-DESC       PIC X(20).                   01146306
011464     05  RTR-TRBL-RSN-TOT-QTY        PIC S9(7)     COMP-3.        01146406
011465     05  RTR-AVG-RESOLVE-TIME.                                    01146506
011466         10  RTR-AVG-RESOLVE-HRS     PIC S9(5)     COMP-3.        01146606
011467         10  RTR-AVG-RESOLVE-MINS    PIC S9(3)     COMP-3.        01146706
011468     05  FILLER                      PIC X(330)    VALUE SPACES.  01146806
011469                                                                  01146900
011470 01  WS-ASSIGN-TOTAL-RECORD.                                      01147099
011471     05  ATR-RECORD-TYPE             PIC X(2)      VALUE 'AM'.    01147199
011472     05  ATR-SORT-FIELD              PIC X(25)     VALUE SPACES.  01147206
011473     05  ATR-REPORT-DIVISION         PIC X(2)      VALUE 'AA'.    01147399
011474     05  ATR-REPORT-NOTIF-CDE        PIC X(1).                    01147499
011475     05  ATR-REPORT-OPER-UNT-ID      PIC S9(4)     COMP.          01147599
011476     05  ATR-REPORT-GMM-NBR          PIC X(2)      VALUE SPACES.  01147699
011477     05  FILLER                      PIC X(05)     VALUE SPACES.  01147799
011478     05  ATR-TOT-QTY                 PIC S9(7)     COMP-3.        01147806
011479     05  FILLER                      PIC X(357)    VALUE SPACES.  01147906
011480                                                                  01148000
011490 01  WS-DC-ASSIGN-TOTAL-RECORD.                                   01149099
011500     05  DCATR-RECORD-TYPE           PIC X(2)      VALUE 'AN'.    01150099
011600     05  DCATR-SORT-FIELD.                                        01160099
011700         10  DCATR-DC-NBR            PIC 9(04)     VALUE ZEROS.   01170099
011800         10  FILLER                  PIC X(21)     VALUE SPACES.  01180099
011900     05  DCATR-REPORT-DIVISION       PIC X(2)      VALUE 'HH'.    01190099
012000     05  DCATR-REPORT-NOTIF-CDE      PIC X(1).                    01200099
012100     05  DCATR-REPORT-OPER-UNT-ID    PIC S9(4)     COMP.          01210099
012200     05  DCATR-REPORT-GMM-NBR        PIC X(2)      VALUE SPACES.  01220099
012201     05  FILLER                      PIC X(05)     VALUE SPACES.  01220199
012202     05  DCATR-TOT-QTY               PIC S9(7)     COMP-3.        01220206
012203     05  FILLER                      PIC X(357)    VALUE SPACES.  01220306
012204                                                                  01220406
012205 01  WS-GMM-ASSIGN-TOTAL-RECORD.                                  01220599
012206     05  GMMATR-RECORD-TYPE          PIC X(2)      VALUE 'AO'.    01220699
012207     05  GMMATR-SORT-FIELD.                                       01220799
012208         10  GMMATR-GMM-NBR          PIC X(02)     VALUE SPACES.  01220899
012209         10  FILLER                  PIC X(23)     VALUE SPACES.  01220999
012210     05  GMMATR-REPORT-DIVISION      PIC X(2)      VALUE 'BB'.    01221099
012220     05  GMMATR-REPORT-NOTIF-CDE     PIC X(1).                    01222099
012230     05  GMMATR-REPORT-OPER-UNT-ID   PIC S9(4)     COMP.          01223099
012240     05  GMMATR-REPORT-GMM-NBR       PIC X(2)      VALUE SPACES.  01224099
012241     05  FILLER                      PIC X(05)     VALUE SPACES.  01224199
012242     05  GMMATR-TOT-QTY              PIC S9(7)     COMP-3.        01224206
012243     05  GMMATR-GMM-NAME             PIC X(30)     VALUE SPACES.  01224399
012244     05  FILLER                      PIC X(327)    VALUE SPACES.  01224406
012245                                                                  01224506
012246 01 PS-PROGRAM-SWITCHES.                                          01224600
012247    05 PS-END-OF-FILE-SW             PIC X(01)     VALUE SPACE.   01224700
012248       88 PS-EOF                                   VALUE 'Y'.     01224800
012249       88 PS-NOT-EOF                               VALUE 'N'.     01224900
012250    05 PS-END-OF-CURSOR-SW           PIC X(01)     VALUE SPACE.   01225000
012251       88 PS-EOC                                   VALUE 'Y'.     01225100
012252       88 PS-NOT-EOC                               VALUE 'N'.     01225200
012253    05 WS-TBL-LOAD-SW                PIC X(01)     VALUE SPACE.   01225301
012254       88 WS-TBL-LOAD-COMPLETE                     VALUE 'Y'.     01225401
012255       88 WS-TBL-LOAD-INCOMPLETE                   VALUE 'N'.     01225501
012256    05 WS-CURSOR-READ-SW             PIC X(01)     VALUE SPACE.   01225601
012257       88 WS-CURSOR-READ-OK                        VALUE 'Y'.     01225701
012258    05 WS-FIRST-TIME-SW              PIC X(01)     VALUE 'Y'.     01225802
012259       88 WS-FIRST-TIME-PROCESS                    VALUE 'Y'.     01225902
012260       88 WS-NOT-FIRST-TIME-PROCESS                VALUE 'N'.     01226002
012261    05 WS-FIRST-OCCUR-SW             PIC X(01)     VALUE SPACE.   01226102
012262       88  WS-FIRST-OCCUR-FOUND                    VALUE 'Y'.     01226202
012263       88  WS-FIRST-OCCUR-NOT-FOUND                VALUE 'N'.     01226302
012264    05 WS-SEARCH-SW                  PIC X(01)     VALUE SPACE.   01226403
012265       88  WS-SEARCH-COMPLETE                      VALUE 'Y'.     01226503
012266       88  WS-SEARCH-INCOMPLETE                    VALUE 'N'.     01226603
012267    05 WS-DC-SEARCH-SW               PIC X(01)     VALUE SPACE.   01226703
012268       88  WS-DC-SEARCH-COMPLETE                   VALUE 'Y'.     01226803
012269       88  WS-DC-SEARCH-INCOMPLETE                 VALUE 'N'.     01226903
012270    05 WS-GMM-SEARCH-SW              PIC X(01)     VALUE SPACE.   01227003
012271       88  WS-GMM-SEARCH-COMPLETE                  VALUE 'Y'.     01227103
012272       88  WS-GMM-SEARCH-INCOMPLETE                VALUE 'N'.     01227203
012273    05 WS-DATE-VALID-SW              PIC X(01)     VALUE SPACE.   01227306
012274       88  WS-DATE-VALID                           VALUE 'Y'.     01227406
012275       88  WS-DATE-INVALID                         VALUE 'N'.     01227506
012276    05 WS-TRBL-RSN-CDE-SW            PIC X(01)     VALUE SPACE.   01227606
012277       88  WS-TRBL-RSN-CDE-VALID                   VALUE 'Y'.     01227706
012278       88  WS-TRBL-RSN-CDE-INVALID                 VALUE 'N'.     01227806
012279    05 WS-INCLUDE-TOTAL-SW           PIC X(01)     VALUE SPACE.   01227906
012280       88  WS-INCLUDE-IN-TOTAL                     VALUE 'Y'.     01228006
012281       88  WS-OMIT-IN-TOTAL                        VALUE 'N'.     01228106
012282    05 WS-PROCESS-RECORD-SW          PIC X(01)     VALUE SPACE.   01228206
012283       88  WS-PROCESS-RECORD                       VALUE 'Y'.     01228306
012284       88  WS-OMIT-RECORD                          VALUE 'N'.     01228406
012285                                                                  01228500
012286 01 WS-HOLD-ACCUMULATORS.                                         01228606
012287    05  WS-ASSIGNED-TOT-BUY-DIV      PIC S9(7)     COMP-3         01228706
012288                                                   VALUE ZEROS.   01228806
012289    05  WS-TROUBLE-TOT-BUY-DIV       PIC S9(7)     COMP-3         01228906
012290                                                   VALUE ZEROS.   01229006
012291    05  WS-NOTIFY-TOT-BUY-DIV        PIC S9(7)     COMP-3         01229106
012292                                                   VALUE ZEROS.   01229206
012293    05  WS-ASSIGNED-TOT-MDSE-DIV     PIC S9(7)     COMP-3         01229306
012294                                                   VALUE ZEROS.   01229406
012295    05  WS-TROUBLE-TOT-MDSE-DIV      PIC S9(7)     COMP-3         01229506
012296                                                   VALUE ZEROS.   01229606
012297    05  WS-NOTIFY-TOT-MDSE-DIV       PIC S9(7)     COMP-3         01229706
012298                                                   VALUE ZEROS.   01229806
012299    05  WS-ASSIGNED-TOT-DC-DIV       PIC S9(7)     COMP-3         01229906
012300                                                   VALUE ZEROS.   01230006
012301    05  WS-TROUBLE-TOT-DC-DIV        PIC S9(7)     COMP-3         01230106
012302                                                   VALUE ZEROS.   01230206
012303    05  WS-NOTIFY-TOT-DC-DIV         PIC S9(7)     COMP-3         01230306
012304                                                   VALUE ZEROS.   01230406
012305    05  WS-ASSIGNED-TOT-VEND-DIV     PIC S9(7)     COMP-3         01230506
012306                                                   VALUE ZEROS.   01230606
012307    05  WS-TROUBLE-TOT-VEND-DIV      PIC S9(7)     COMP-3         01230706
012308                                                   VALUE ZEROS.   01230806
012309    05  WS-NOTIFY-TOT-VEND-DIV       PIC S9(7)     COMP-3         01230906
012310                                                   VALUE ZEROS.   01231006
012311    05  WS-ASSIGNED-TOTAL            PIC S9(7)     COMP-3         01231106
012312                                                   VALUE ZEROS.   01231206
012313    05  WS-ASSIGNED-TRBL-TOTAL       PIC S9(7)     COMP-3         01231306
012314                                                   VALUE ZEROS.   01231406
012315    05  WS-ASSIGNED-NOTIFY-TOTAL     PIC S9(7)     COMP-3         01231506
012316                                                   VALUE ZEROS.   01231606
012317    05  WS-TRBL-RSN-CDE-TOTAL        PIC S9(5)     COMP-3         01231706
012318                                                   VALUE ZEROS.   01231806
012319    05  WS-RCD-READ-COUNT            PIC S9(7)     COMP-3         01231906
012320                                                   VALUE ZEROS.   01232006
012321    05  WS-RCD-BYPASS-COUNT          PIC S9(7)     COMP-3         01232106
012322                                                   VALUE ZEROS.   01232206
012323    05  WS-RCD-PROCESS-COUNT         PIC S9(7)     COMP-3         01232306
012324                                                   VALUE ZEROS.   01232406
012325    05  WS-RCD-DTL-WRITE-COUNT       PIC S9(7)     COMP-3         01232506
012326                                                   VALUE ZEROS.   01232606
012327    05  WS-RCD-RSNTOT-WRITE-COUNT    PIC S9(7)     COMP-3         01232706
012328                                                   VALUE ZEROS.   01232806
012329                                                                  01232906
012330 01 WS-HOLD-FIELDS.                                               01233006
012331    05  WS-HOLD-TRBL-RSN-CDE         PIC S9(04)    COMP           01233106
012332                                                   VALUE ZEROS.   01233206
012333    05  WS-HOLD-TRBL-RSN-DESC        PIC X(20)     VALUE SPACES.  01233306
012334    05  WS-HOLD-TRBL-RSN-NOTIF-CDE   PIC X(01)     VALUE SPACES.  01233406
012335    05  WS-HOLD-REPORT-DIVISION      PIC X(02)     VALUE SPACES.  01233599
012336    05  WS-HOLD-REPORT-OPER-UNT-ID   PIC S9(4)     COMP           01233699
012337                                                   VALUE ZEROS.   01233702
012338    05  WS-HOLD-REPORT-GMM-NBR       PIC X(02)     VALUE SPACES.  01233899
012339                                                                  01233999
012340    05  WS-HOLD-CRSR-DC-NBR.                                      01234099
012350        10  WS-HOLD-CRSR-DC-NBR-NUM  PIC 9(04)     VALUE ZEROS.   01235099
012360    05  WS-HOLD-CRSR-GMM-NBR         PIC X(02)     VALUE SPACES.  01236099
012370    05  WS-HOLD-CRSR-FIR-NAME        PIC X(12)     VALUE SPACES.  01237099
012371    05  WS-HOLD-CRSR-LAST-NAME       PIC X(18)     VALUE SPACES.  01237199
012372                                                                  01237206
012373 01 PV-PROGRAM-VARIABLES.                                         01237306
012374    05  PV-ABEND-CODE                PIC  9(04)    VALUE ZEROS.   01237400
012375    05  PV-JOIN-PGM-SEQ-NBR          PIC S9(04)    COMP           01237502
012376                                                   VALUE ZEROS.   01237602
012377    05  PV-PREV-TRBL-RSN-CDE         PIC S9(04)    COMP           01237702
012378                                                   VALUE ZEROS.   01237802
012379    05  PV-PREV-OPER-UNT-ID          PIC S9(04)    COMP           01237902
012380                                                   VALUE ZEROS.   01238002
012381    05  PV-PREV-STORE-NBR            PIC S9(04)    COMP           01238102
012382                                                   VALUE ZEROS.   01238202
012383    05  PV-SAVE-STR-TYP-CDE          PIC X(02).                   01238399
012384    05  PV-CURR-KEY.                                              01238400
012385        10  PV-CURR-PO-NBR           PIC S9(09)    COMP           01238500
012386                                                   VALUE ZEROS.   01238600
012387        10  PV-CURR-REC-SEQ-NBR      PIC S9(09)    COMP           01238700
012388                                                   VALUE ZEROS.   01238800
012389                                                                  01238900
012390    05  PV-PREV-KEY.                                              01239000
012391        10  PV-PREV-PO-NBR           PIC S9(09)    COMP           01239100
012392                                                   VALUE ZEROS.   01239200
012393        10  PV-PREV-REC-SEQ-NBR      PIC S9(09)    COMP           01239300
012394                                                   VALUE ZEROS.   01239400
012395                                                                  01239500
012396    05  PV-RESOLVED-HOURS            PIC S9(07)    COMP-3         01239600
012400                                                   VALUE ZEROS.   01240000
012500    05  PV-RESOLVED-MINUTES          PIC S9(07)    COMP-3         01250000
012600                                                   VALUE ZEROS.   01260000
012700    05  PV-RESOLVED-TRBL-QTY         PIC S9(05)    COMP-3         01270000
012800                                                   VALUE ZEROS.   01280000
012900    05  PV-CALC-TEMP-QTY             PIC S9(05)    COMP-3         01290006
013000                                                   VALUE ZEROS.   01300006
013100                                                                  01310004
013200    05  PV-BUYING-SORT-FIELD.                                     01320003
013300        10  FILLER                   PIC  X(02)    VALUE '01'.    01330003
013400        10  PV-BSF-GMM-NBR           PIC  X(02)    VALUE SPACES.  01340003
013500        10  PV-BSF-DMM-NBR           PIC  X(02)    VALUE SPACES.  01350003
013600        10  PV-BSF-BYR-NBR           PIC  X(03)    VALUE SPACES.  01360003
013700        10  PV-BSF-DPT-NBR           PIC  X(03)    VALUE SPACES.  01370003
013800        10  FILLER                   PIC  X(13)    VALUE SPACES.  01380003
013900                                                                  01390003
014000    05  PV-ANALYST-SORT-FIELD.                                    01400003
014100        10  FILLER                   PIC  X(02)    VALUE '02'.    01410003
014200        10  PV-ASF-ANALYST-MGR-NBR   PIC  9(07)    VALUE ZEROS.   01420003
014300        10  PV-ASF-ANALYST-NBR       PIC  9(07)    VALUE ZEROS.   01430003
014400        10  PV-ASF-DPT-NBR           PIC  X(03)    VALUE SPACES.  01440003
014500        10  FILLER                   PIC  X(06)    VALUE SPACES.  01450003
014600                                                                  01460003
014700    05  PV-DC-SORT-FIELD.                                         01470003
014800        10  FILLER                   PIC  X(02)    VALUE '03'.    01480003
014900        10  PV-DSF-DC-NBR            PIC  9(04)    VALUE ZEROS.   01490003
015000        10  PV-DSF-PROCESS-AREA      PIC  X(06)    VALUE SPACES.  01500003
015100        10  FILLER                   PIC  X(13)    VALUE SPACES.  01510003
015200                                                                  01520003
015300    05  PV-VENDOR-SORT-FIELD.                                     01530003
015400        10  FILLER                   PIC  X(02)    VALUE '04'.    01540003
015410        10  FILLER                   PIC  9(05)    VALUE ZEROS.   01541099
015500        10  PV-VSF-VND-NBR           PIC  9(09)    VALUE ZEROS.   01550003
015600        10  PV-VSF-DPT-NBR           PIC  X(03)    VALUE SPACES.  01560003
015700        10  FILLER                   PIC  X(06)    VALUE SPACES.  01570003
015800                                                                  01580003
015900    05 PV-SYSTEM-DATE.                                            01590000
016000       10 PV-SYSTEM-YY               PIC  9(02)    VALUE 0.       01600000
016100       10 PV-SYSTEM-MM               PIC  9(02)    VALUE 0.       01610000
016200       10 PV-SYSTEM-DD               PIC  9(02)    VALUE 0.       01620000
016300    05 PV-PARA-NAME                  PIC  X(30)    VALUE SPACE.   01630000
016400                                                                  01640004
016500    05 PV-PREV-NOTIF-DATE.                                        01650004
016600       10 PV-PREV-NOTIF-YYYY.                                     01660004
016700          15 PV-PREV-NOTIF-CC        PIC  9(02)    VALUE 0.       01670004
016800          15 PV-PREV-NOTIF-YY        PIC  9(02)    VALUE 0.       01680004
016900       10 PV-PREV-NOTIF-MM           PIC  9(02)    VALUE 0.       01690004
017000       10 PV-PREV-NOTIF-DD           PIC  9(02)    VALUE 0.       01700004
017100                                                                  01710004
017200    05 PV-BEG-DATE.                                               01720004
017300       10 PV-BEG-YYYY.                                            01730004
017400          15 PV-BEG-CC               PIC  9(02)    VALUE 0.       01740004
017500          15 PV-BEG-YY               PIC  9(02)    VALUE 0.       01750004
017600       10 PV-BEG-MM                  PIC  9(02)    VALUE 0.       01760004
017700       10 PV-BEG-DD                  PIC  9(02)    VALUE 0.       01770004
017800    05 PV-END-DATE.                                               01780000
017900       10 PV-END-YYYY.                                            01790000
018000          15 PV-END-CC               PIC  9(02)    VALUE 0.       01800000
018100          15 PV-END-YY               PIC  9(02)    VALUE 0.       01810000
018200       10 PV-END-MM                  PIC  9(02)    VALUE 0.       01820000
018300       10 PV-END-DD                  PIC  9(02)    VALUE 0.       01830000
018400    05 PV-DATE-AREA.                                              01840000
018500       10 PV-DATE-AREA-MM            PIC  9(02)    VALUE 0.       01850000
018600       10 PV-DATE-AREA-DD            PIC  9(02)    VALUE 0.       01860000
018700       10 PV-DATE-AREA-YY            PIC  9(02)    VALUE 0.       01870000
018800    05 PV-REFORMAT-TMST.                                          01880000
018900       10 PV-RF-YYYY                 PIC 9(04)     VALUE 0.       01890000
019000       10 FILLER                     PIC X(01)     VALUE SPACE.   01900000
019100       10 PV-RF-MM                   PIC 9(02)     VALUE 0.       01910000
019200       10 FILLER                     PIC X(01)     VALUE SPACE.   01920000
019300       10 PV-RF-DD                   PIC 9(02)     VALUE 0.       01930000
019400       10 FILLER                     PIC X(01)     VALUE SPACE.   01940000
019500       10 PV-RF-HH                   PIC 9(02)     VALUE 0.       01950000
019600       10 FILLER                     PIC X(01)     VALUE SPACE.   01960000
019700       10 PV-RF-MIN                  PIC 9(02)     VALUE 0.       01970000
019800       10 FILLER                     PIC X(01)     VALUE SPACE.   01980000
019900       10 PV-RF-SS                   PIC 9(02)     VALUE 0.       01990000
020000       10 FILLER                     PIC X(01)     VALUE SPACE.   02000000
020100       10 PV-RF-MSS                  PIC 9(06)     VALUE 0.       02010000
020200    05 PV-REFORMATED-TMST.                                        02020000
020300       10 PV-RFMTED-YYYY             PIC 9(04)     VALUE 0.       02030000
020400       10 PV-RFMTED-MM               PIC 9(02)     VALUE 0.       02040000
020500       10 PV-RFMTED-DD               PIC 9(02)     VALUE 0.       02050000
020600       10 PV-RFMTED-HH               PIC 9(02)     VALUE 0.       02060000
020700       10 PV-RFMTED-MIN              PIC 9(02)     VALUE 0.       02070000
020800       10 PV-RFMTED-SS               PIC 9(02)     VALUE 0.       02080000
020900    05 PV-START-EXTRACT              PIC X(10)     VALUE SPACE.   02090000
021000    05 PV-END-EXTRACT.                                            02100000
021100       10 PV-CCYY                    PIC 9(04)     VALUE 0.       02110000
021200       10 FILLER                     PIC X(01)     VALUE '-'.     02120000
021300       10 PV-MM                      PIC 9(02)     VALUE 0.       02130000
021400       10 FILLER                     PIC X(01)     VALUE '-'.     02140000
021500       10 PV-DD                      PIC 9(02)     VALUE 0.       02150000
021510    05 PV-DISPLAY-RSN-CDE            PIC 9(9)      VALUE ZEROS.   02151099
021600    05 PV-ABEND-PARA-NAME            PIC X(30)     VALUE SPACE.   02160000
021700    05 PV-DB2-OPERATION-MSG-1        PIC X(40)     VALUE SPACE.   02170000
021800    05 PV-DB2-TABLE-NAME             PIC X(12)     VALUE SPACE.   02180000
021900    05 PV-SQLCODE                    PIC Z(8)9-.                  02190000
022000    05 PV-SEARCH-STORE-NUM           PIC 9(04).                   02200099
022001    05 PV-SEARCH-STORE-X             PIC X(04).                   02200199
022002    05 PV-PARAGRAPH-NAME             PIC X(30)     VALUE SPACE.   02200200
022003    05 PV-FIRST-NAME.                                             02200399
022004       10 PV-FIRST-NAME-BYTE  OCCURS 12 TIMES INDEXED BY INX1     02200499
022005                                     PIC X(01).                   02200599
022006    05 PV-LAST-NAME.                                              02200699
022007       10 PV-LAST-NAME-BYTE   OCCURS 18 TIMES INDEXED BY INX2     02200799
022008                                     PIC X(01).                   02200899
022009    05 PV-NAME.                                                   02200999
022010       10 PV-NAME-BYTE        OCCURS 30 TIMES INDEXED BY INX3     02201099
022020                                     PIC X(01).                   02202099
022100    05  PV-AVG-TOT-HOURS             PIC 9(10) VALUE ZEROS.       02210000
022101    05  PV-AVG-TOT-MINUTES           PIC 9(10) VALUE ZEROS.       02210199
022102    05  PV-AVG-MINUTES               PIC 9(10) VALUE ZEROS.       02210200
022103                                                                  02210300
022104                                                                  02210400
022200 01  WS-TABLE-AREA.                                               02220000
022300     05  WS-RSN-CDE-TABLE            OCCURS 600 TIMES             02230002
022400                                     INDEXED BY RSN-CDE-IDX       02240002
022500                                                RSN-CDE-START-IDX.02250002
022600         10  WS-RSN-CDE              PIC S9(04)    COMP.          02260000
022700         10  WS-RPT-AREA-CDE         PIC X(01).                   02270000
022800         10  WS-INCL-TOT-CDE         PIC X(01).                   02280000
022900                                                                  02290000
023000     05  WS-RSN-CDE-TBL-ENTRY        PIC 9(3)      VALUE ZEROS.   02300000
023001     05  WS-RSN-CDE-TBL-COUNT        PIC 9(3)      VALUE ZEROS.   02300199
023002                                                                  02300200
023003                                                                  02300300
023004***CHG0147850 START                                               02300402
023005***CHG0161065 START                                               02300599
023006     05  WS-DC-TABLE                 OCCURS 500 TIMES             02300699
023007***CHG0161065 END                                                 02300799
023008***CHG0147850 END                                                 02300899
023009                                     INDEXED BY DCT-IDX           02300999
023010                                                DCT-PROCESS-IDX   02301099
023011                                                DCT-MAX-IDX.      02301199
023012         10  WS-DCT-OPER-UNIT-ID     PIC S9(04)    COMP.          02301299
023013         10  WS-DCT-DC-DESC          PIC S9(07)    COMP-3.        02301399
023014         10  WS-DCT-TROUBLE-TOTAL    PIC S9(07)    COMP-3.        02301499
023015         10  WS-DCT-NOTIFY-TOTAL     PIC S9(07)    COMP-3.        02301599
023016         10  WS-DCT-ALL-TRBL-TOTAL   PIC S9(07)    COMP-3.        02301699
023017                                                                  02301799
023100                                                                  02310000
023101                                                                  02310199
023102     05  WS-GMM-TABLE                OCCURS 50 TIMES              02310202
023103                                     INDEXED BY GMMT-IDX          02310302
023104                                                GMMT-PROCESS-IDX  02310499
023105                                                GMMT-MAX-IDX.     02310599
023106         10  WS-GMMT-GMM-NBR         PIC X(02).                   02310699
023107         10  WS-GMMT-GMM-NAME        PIC X(30).                   02310799
023108         10  WS-GMMT-RC-TROUBLE-TOTAL PIC S9(07)   COMP-3.        02310800
023109         10  WS-GMMT-TROUBLE-TOTAL   PIC S9(07)    COMP-3.        02310900
023110         10  WS-GMMT-NOTIFY-TOTAL    PIC S9(07)    COMP-3.        02311000
023111         10  WS-GMMT-ALL-TRBL-TOTAL  PIC S9(07)    COMP-3.        02311100
023112                                                                  02311200
023113                                                                  02311300
023114     05  WS-STORE-TABLE.                                          02311499
023115       07  FILLER                    OCCURS 400 TIMES             02311502
023116                                     INDEXED BY STR-IDX           02311699
023117                                                STR-PROCESS-IDX.  02311702
023118         10  WS-ST-STR-NBR           PIC X(04).                   02311899
023119         10  WS-ST-TYP-CDE           PIC X(02).                   02311999
023120     05  WS-ST-TABLE-MAX             PIC S9(4)     COMP           02312099
023121                                                   VALUE +400.    02312199
023122*                                                                 02312200
023200 01  CC-CONTROL-CARD-PARAMETERS.                                  02320000
023300     05  CC-PGM-ID                   PIC X(08)     VALUE SPACES.  02330000
023400     05  CC-PGM-SEQ-NBR              PIC 9(03)     VALUE ZEROS.   02340000
023500     05  CC-RSN-CDE-TOTAL            PIC X(01)     VALUE SPACE.   02350000
023600         88  CC-TOTAL-BY-RSN-CDE                   VALUE 'Y'.     02360000
023700         88  CC-NO-TOTAL-BY-RSN-CDE                VALUE 'N'.     02370000
023800     05  CC-TROUBLE-ASSIGN-TOTAL     PIC X(01)     VALUE SPACE.   02380000
023900         88  CC-TOTAL-FOR-TRBL-ASSIGN              VALUE 'Y'.     02390000
023910         88  CC-TOTAL-FOR-TRBL-NOTIFY              VALUE 'B'.     02391099
024000         88  CC-NO-TOTAL-FOR-TRBL-ASSIGN           VALUE 'N'.     02400000
024001     05  CC-TROUBLE-ASSIGN-DIV-TOT   PIC X(01)     VALUE SPACE.   02400199
024002         88  CC-TOTAL-TRBL-ASSIGN-DIV              VALUE 'Y'.     02400200
024003         88  CC-TOTAL-FOR-TRBL-NOTIFY-DIV          VALUE 'B'.     02400399
024004         88  CC-NO-TOTAL-TRBL-ASSIGN-DIV           VALUE 'N'.     02400400
024005     05  CC-PROCESS-INCLUDE-CDE      PIC X(01)     VALUE SPACE.   02400500
024006         88  CC-INCLUDE-ASSIGN-ONLY                VALUE 'A'.     02400600
024007         88  CC-INCLUDE-RESOLVE-ONLY               VALUE 'R'.     02400700
024008         88  CC-INCLUDE-ASSIGN-RESOLVE             VALUE 'B'.     02400800
024009     05  CC-DC-PROCESS-CDE           PIC X(01)     VALUE SPACE.   02400900
024010         88  CC-NO-PROCESS-BY-DC                   VALUE 'N'.     02401000
024011         88  CC-PROCESS-BY-DC                      VALUE 'Y'.     02401100
024012     05  CC-GMM-PROCESS-CDE          PIC X(01)     VALUE SPACE.   02401200
024013         88  CC-NO-PROCESS-BY-GMM                  VALUE 'N'.     02401300
024014         88  CC-PROCESS-BY-GMM                     VALUE 'Y'.     02401400
024015     05  CC-WRITE-DETAIL-CDE         PIC X(01)     VALUE SPACE.   02401500
024016         88  CC-NO-WRITE-DETAIL                    VALUE 'N'.     02401600
024017         88  CC-WRITE-DETAIL                       VALUE SPACE.   02401700
024100     05 FILLER                      PIC X(63)      VALUE SPACE.   02410000
024200                                                                  02420000
024300*** FILE LAYOUT AREA ****                                         02430000
024400     COPY TMRD001.                                                02440000
024500                                                                  02450000
024600*** DB2 MESSAGE AREAS ****                                        02460000
024700     COPY DPWS004.                                                02470000
024800                                                                  02480000
024900     EXEC SQL                                                     02490000
025000          INCLUDE SQLCA                                           02500000
025100     END-EXEC.                                                    02510000
025200                                                                  02520000
025300     EXEC SQL                                                     02530000
025400          INCLUDE TTRBRCN                                         02540000
025500     END-EXEC.                                                    02550000
025501* XLT_LOC                                                         02550199
025502     EXEC SQL                                                     02550200
025503          INCLUDE XLT00010                                        02550300
025504     END-EXEC.                                                    02550400
025505                                                                  02550500
025506* XLT_DC_LOC_ASGMT                                                02550600
025507     EXEC SQL                                                     02550700
025508          INCLUDE XLT00014                                        02550800
025509     END-EXEC.                                                    02550900
025510                                                                  02551000
025511     EXEC SQL                                                     02551100
025512          INCLUDE TMDSEAR                                         02551200
025513     END-EXEC.                                                    02551300
025600                                                                  02560000
025601     EXEC SQL                                                     02560199
025602          INCLUDE TRSPBAR                                         02560200
025603     END-EXEC.                                                    02560300
025604                                                                  02560400
025605     EXEC SQL                                                     02560599
025800          DECLARE TTRBRCN-READ-CRS CURSOR FOR                     02580000
025900             SELECT TRBL_RSN_CDE,                                 02590000
026000                    RPT_AREA_CDE,                                 02600000
026100                    INCL_TOT_IND                                  02610000
026200             FROM   TTRBRCN                                       02620000
026300             WHERE  RPT_PGM_NM = :CC-PGM-ID                       02630099
026400               AND  RPT_PGM_RN_NBR = :PV-JOIN-PGM-SEQ-NBR         02640099
026500             ORDER BY TRBL_RSN_CDE                                02650000
026501     END-EXEC.                                                    02650199
026502                                                                  02650200
026503     EXEC SQL                                                     02650399
026504          DECLARE GMM-READ-CRS CURSOR FOR                         02650400
026505             SELECT B.WORKER_FIR_NAME                             02650599
026506                  , B.WORKER_LAST_NAME                            02650699
026507                  , A.GMA_NBR                                     02650799
026508               FROM TMDSEAR A                                     02650899
026509                   ,TRSPBAR B                                     02650999
026510              WHERE A.OPERCO_NBR       = :PC-03                   02651099
026520                AND A.MDSELV_CDE       = :PC-GMA                  02652099
026530                AND A.STRT_DTE        <= CURRENT DATE             02653099
026540                AND A.END_DTE         >= CURRENT DATE             02654099
026550                AND A.MDSEAR_DKEY      = B.MDSEAR_DKEY            02655099
026560                AND B.WORKER_STRT_DTE <= CURRENT DATE             02656099
026570                AND B.WORKER_END_DTE  >= CURRENT DATE             02657099
026580                AND B.RSPLVL_CDE       = :PC-GMM                  02658099
026590                AND B.WORKER_FIR_NAME  = :PC-SPACE                02659099
026591             ORDER BY A.GMA_NBR                                   02659199
026592     END-EXEC.                                                    02659200
026593                                                                  02659399
026594     EXEC SQL                                                     02659499
026595          DECLARE DC-READ-CRS CURSOR FOR                          02659599
026596             SELECT A.LOC_NBR                                     02659699
026597               FROM XLT_LOC A                                     02659799
026598                  , XLT_DC_LOC_ASGMT B                            02659899
026599              WHERE A.LOC_TYP_CDE = 'DC'                          02659999
026600                AND A.LOC_NBR     = B.LOC_NBR                     02660099
026700                AND A.OPN_DTE     <= CURRENT DATE                 02670099
026800                AND A.CLO_DTE     >= CURRENT DATE                 02680099
026900                AND B.EFF_BEG_DTE <= CURRENT DATE                 02690099
026901             ORDER BY A.LOC_NBR                                   02690199
026902     END-EXEC.                                                    02690200
026903 EJECT                                                            02690300
026904 PROCEDURE DIVISION.                                              02690400
026905                                                                  02690599
027000 0000-MAINLINE-PROCESSING.                                        02700000
027100                                                                  02710000
027200     PERFORM 1000-INITIALIZATION.                                 02720000
027300                                                                  02730000
027400     PERFORM 2000-MAIN-LOOP                                       02740000
027500         UNTIL PS-EOF.                                            02750000
027600                                                                  02760000
027700     PERFORM 9000-END-OF-PROGRAM.                                 02770000
027800                                                                  02780000
027900     STOP RUN.                                                    02790000
028200 EJECT                                                            02820000
028300 1000-INITIALIZATION.                                             02830000
028400                                                                  02840000
028500     ACCEPT CC-CONTROL-CARD-PARAMETERS FROM SYSIN.                02850000
028600                                                                  02860000
028700     OPEN INPUT  EXTRACT-TRBL-FILE-IN.                            02870000
028800     OPEN OUTPUT EXTRACT-TRBL-FILE-OUT.                           02880000
028900                                                                  02890000
029000     PERFORM 7000-READ-INPUT-FILE.                                02900000
029100                                                                  02910000
029200     IF  PS-EOF                                                   02920000
029300         NEXT SENTENCE                                            02930000
029400     ELSE                                                         02940000
029500         MOVE TM001-BEGIN-YYYY TO                                 02950004
029600              PV-BEG-YYYY                                         02960004
029700         MOVE TM001-BEGIN-MM TO                                   02970004
029800              PV-BEG-MM                                           02980004
029900         MOVE TM001-BEGIN-DD TO                                   02990004
030000              PV-BEG-DD                                           03000004
030100         MOVE TM001-END-YYYY TO                                   03010004
030200              PV-END-YYYY                                         03020004
030300         MOVE TM001-END-MM TO                                     03030004
030400              PV-END-MM                                           03040004
030500         MOVE TM001-END-DD TO                                     03050004
030600              PV-END-DD                                           03060004
030700         MOVE PC-00 TO                                            03070099
030701              TM001-REPORT-GMM-NBR                                03070199
030702         PERFORM 8000-WRITE-OUTPUT-FILE                           03070200
030800         PERFORM 7000-READ-INPUT-FILE                             03080000
030900     END-IF.                                                      03090000
031000                                                                  03100000
031100     IF  PS-EOF                                                   03110000
031200         NEXT SENTENCE                                            03120000
031300     ELSE                                                         03130000
031400         MOVE CC-PGM-SEQ-NBR TO                                   03140099
031401              PV-JOIN-PGM-SEQ-NBR                                 03140199
031402         PERFORM 1500-OPEN-TTRBRCN-CRS                            03140200
031500         PERFORM 1100-INIT-RSN-CDE-TABLE                          03150000
031600             VARYING RSN-CDE-IDX FROM 1 BY 1                      03160000
031700                 UNTIL RSN-CDE-IDX GREATER THAN 600               03170002
031800         SET RSN-CDE-IDX TO 1                                     03180001
031900         MOVE ZEROS TO WS-RSN-CDE-TBL-ENTRY                       03190002
032000         PERFORM 1200-LOAD-RSN-CDE-TABLE                          03200000
032100             UNTIL WS-TBL-LOAD-COMPLETE                           03210000
032200         PERFORM 1700-CLOSE-TTRBRCN-CRS                           03220000
032300         MOVE ZEROS TO WS-RSN-CDE-TBL-COUNT                       03230099
032301         PERFORM 1210-LIST-RSN-CDE-TABLE                          03230199
032302             VARYING RSN-CDE-IDX FROM 1 BY 1                      03230200
032303                 UNTIL RSN-CDE-IDX GREATER THAN                   03230302
032304                       WS-RSN-CDE-TBL-ENTRY                       03230499
032305     END-IF.                                                      03230500
032400                                                                  03240003
032500     SET RSN-CDE-START-IDX TO 1.                                  03250003
032600                                                                  03260099
032700     PERFORM 1300-INIT-DC-TABLE                                   03270099
032800         VARYING DCT-IDX FROM 1 BY 1                              03280099
032900***CHG0147850 START                                               03290099
032910***CHG0161065 START                                               03291099
033000             UNTIL DCT-IDX GREATER THAN 500.                      03300099
033100***CHG0161065 END                                                 03310099
033110***CHG0147850 END                                                 03311099
033200                                                                  03320099
033300     IF  CC-PROCESS-BY-DC                                         03330099
033400         PERFORM 1310-LOAD-DC-TABLE                               03340099
033500*        PERFORM 1360-LIST-DC-TABLE                               03350099
033600*            VARYING DCT-IDX FROM 1 BY 1                          03360099
033700*                UNTIL DCT-IDX GREATER THAN                       03370099
033800*                      DCT-MAX-IDX                                03380099
033900     END-IF.                                                      03390099
034000                                                                  03400099
034100     PERFORM 1400-INIT-GMM-TABLE                                  03410099
034200         VARYING GMMT-IDX FROM 1 BY 1                             03420099
034300             UNTIL GMMT-IDX GREATER THAN 50.                      03430099
034400                                                                  03440099
034500     IF  CC-PROCESS-BY-GMM                                        03450099
034600         PERFORM 1410-LOAD-GMM-TABLE                              03460099
034700*        PERFORM 1460-LIST-GMM-TABLE                              03470099
034800*            VARYING GMMT-IDX FROM 1 BY 1                         03480099
034900*                UNTIL GMMT-IDX GREATER THAN                      03490099
035000*                      GMMT-MAX-IDX                               03500099
035100     END-IF.                                                      03510099
035200                                                                  03520099
035201     MOVE SPACES TO WS-STORE-TABLE.                               03520199
035202*    SET STR-PROCESS-IDX TO +1.                                   03520202
035203                                                                  03520300
035204                                                                  03520400
035205 1100-INIT-RSN-CDE-TABLE.                                         03520500
035206                                                                  03520600
035207     MOVE ZEROS  TO  WS-RSN-CDE (RSN-CDE-IDX).                    03520700
035208                                                                  03520800
035209     MOVE SPACES TO  WS-RPT-AREA-CDE (RSN-CDE-IDX)                03520900
035210                     WS-INCL-TOT-CDE (RSN-CDE-IDX).               03521000
035211                                                                  03521100
035212 1200-LOAD-RSN-CDE-TABLE.                                         03521200
035213                                                                  03521300
035214     PERFORM 1600-FETCH-TTRBRCN-CRS.                              03521400
035215                                                                  03521501
035216     IF  PS-EOC                                                   03521601
035217         SET WS-TBL-LOAD-COMPLETE TO TRUE                         03521701
035218     ELSE                                                         03521801
035219         IF  WS-CURSOR-READ-OK                                    03521901
035220             IF  WS-RSN-CDE-TBL-ENTRY = 600                       03522002
035221                 DISPLAY '***********************************'    03522101
035222                 DISPLAY 'TABLE OVERFLOW ON   '                   03522201
035223                 DISPLAY 'REASON CODE TABLE - OVER 600 OCCURS'    03522302
035224                 DISPLAY 'RUN ABORTED'                            03522401
035225                 DISPLAY '***********************************'    03522501
035226                 MOVE 4001  TO PV-ABEND-CODE                      03522601
035227                 PERFORM 9999-ABORT                               03522701
035228             ELSE                                                 03522801
035229                 MOVE TRBRCN-TRBL-RSN-CDE TO                      03522901
035300                      WS-RSN-CDE (RSN-CDE-IDX)                    03530001
035400                 MOVE TRBRCN-RPT-AREA-CDE TO                      03540001
035500                      WS-RPT-AREA-CDE (RSN-CDE-IDX)               03550001
035600                 MOVE TRBRCN-INCL-TOT-IND TO                      03560001
035700                      WS-INCL-TOT-CDE (RSN-CDE-IDX)               03570001
035800                 ADD 1 TO WS-RSN-CDE-TBL-ENTRY                    03580001
035900                 SET RSN-CDE-IDX UP BY 1                          03590001
036000         ELSE                                                     03600001
036100             SET WS-TBL-LOAD-COMPLETE TO TRUE.                    03610001
036500                                                                  03650001
036600 1210-LIST-RSN-CDE-TABLE.                                         03660099
036700                                                                  03670099
036800     MOVE WS-RSN-CDE (RSN-CDE-IDX) TO                             03680099
036900          PV-DISPLAY-RSN-CDE.                                     03690099
037000                                                                  03700099
037100     ADD 1 TO WS-RSN-CDE-TBL-COUNT                                03710099
037200                                                                  03720099
037300     DISPLAY '** OCCURRENCE '                                     03730099
037400             WS-RSN-CDE-TBL-COUNT                                 03740099
037500             ' CONTAINS RSN CODE '                                03750099
037600             PV-DISPLAY-RSN-CDE                                   03760099
037700             ' WITH REPORT AREA CODE OF '                         03770099
037800             WS-RPT-AREA-CDE (RSN-CDE-IDX)                        03780099
037900             ' AND INCLUDE TOTAL CODE OF '                        03790099
038000             WS-INCL-TOT-CDE (RSN-CDE-IDX).                       03800099
038100                                                                  03810099
038200                                                                  03820099
038201 1300-INIT-DC-TABLE.                                              03820199
038202                                                                  03820200
038203     MOVE ZEROS  TO WS-DCT-OPER-UNIT-ID (DCT-IDX)                 03820399
038204                    WS-DCT-TROUBLE-TOTAL (DCT-IDX)                03820499
038205                    WS-DCT-NOTIFY-TOTAL (DCT-IDX)                 03820599
038206                    WS-DCT-ALL-TRBL-TOTAL (DCT-IDX).              03820699
038207                                                                  03820799
038208                                                                  03820899
038209 1310-LOAD-DC-TABLE.                                              03820999
038210                                                                  03821099
038220     SET PS-NOT-EOC TO TRUE.                                      03822099
038230     SET WS-TBL-LOAD-INCOMPLETE TO TRUE.                          03823099
038240     PERFORM 1320-OPEN-DC-READ-CRS.                               03824099
038250     SET DCT-IDX TO 1.                                            03825099
038260     SET DCT-MAX-IDX TO 1.                                        03826099
038270     PERFORM 1330-LOAD-DC-TABLE                                   03827099
038280         UNTIL WS-TBL-LOAD-COMPLETE.                              03828099
038290     PERFORM 1350-CLOSE-DC-READ-CRS.                              03829099
038300                                                                  03830099
038400                                                                  03840099
038401 1320-OPEN-DC-READ-CRS.                                           03840199
038402                                                                  03840200
038403        EXEC SQL                                                  03840300
038404             OPEN DC-READ-CRS                                     03840499
038405        END-EXEC.                                                 03840500
038406                                                                  03840600
038407        EVALUATE TRUE                                             03840700
038408           WHEN SQLCODE = ZERO                                    03840800
038409                CONTINUE                                          03840900
038410           WHEN OTHER                                             03841000
038411                MOVE '1320-OPEN-DC-READ-CRS'  TO                  03841100
038412                     PV-ABEND-PARA-NAME                           03841200
038413                MOVE 'OPEN CURSOR'       TO PV-DB2-OPERATION-MSG-103841300
038414                MOVE 'XLT_LOC'           TO PV-DB2-TABLE-NAME     03841400
038415                PERFORM 9998-SQL-ABEND   THRU 9998-EXIT           03841500
038416        END-EVALUATE.                                             03841600
038417                                                                  03841700
038418                                                                  03841899
038419 1330-LOAD-DC-TABLE.                                              03841999
038420                                                                  03842000
038421     PERFORM 1340-FETCH-DC-READ-CRS.                              03842100
038422                                                                  03842201
038423     IF  PS-EOC                                                   03842301
038424         SET WS-TBL-LOAD-COMPLETE TO TRUE                         03842401
038425     ELSE                                                         03842501
038426         IF  WS-CURSOR-READ-OK                                    03842601
038427***CHG0147850 START                                               03842799
038428***CHG0161065 START                                               03842899
038429             IF  DCT-IDX > 500                                    03842999
038430***CHG0161065 END                                                 03843099
038431***CHG0147850 END                                                 03843199
038432                 DISPLAY '***********************************'    03843299
038433                 DISPLAY 'TABLE OVERFLOW ON   '                   03843399
038434***CHG0147850 START                                               03843499
038435***CHG0161065 START                                               03843599
038436                 DISPLAY 'DC TABLE - OVER 500 OCCURENCES     '    03843699
038437***CHG0161065 END                                                 03843799
038438***CHG0147850 END                                                 03843899
038439                 DISPLAY 'RUN ABORTED'                            03843999
038440                 DISPLAY '***********************************'    03844099
038441                 MOVE 4001  TO PV-ABEND-CODE                      03844199
038442                 PERFORM 9999-ABORT                               03844299
038443             ELSE                                                 03844399
038444                 MOVE XLT00010-LOC-NBR TO                         03844499
038445                      WS-DCT-OPER-UNIT-ID (DCT-IDX)               03844599
038446                 SET DCT-IDX UP BY 1                              03844699
038447                 SET DCT-MAX-IDX UP BY 1                          03844799
038448         ELSE                                                     03844899
038449             SET WS-TBL-LOAD-COMPLETE TO TRUE.                    03844999
038450                                                                  03845099
038451                                                                  03845199
038452 1340-FETCH-DC-READ-CRS.                                          03845299
038460                                                                  03846099
038500        EXEC SQL                                                  03850001
038600          FETCH DC-READ-CRS                                       03860099
038700           INTO  :XLT00010-LOC-NBR                                03870099
039000        END-EXEC.                                                 03900001
039100                                                                  03910001
039200       EVALUATE TRUE                                              03920001
039300            WHEN SQLCODE = ZERO                                   03930001
039400                SET WS-CURSOR-READ-OK TO TRUE                     03940001
039500            WHEN SQLCODE = +100                                   03950001
039600                SET PS-EOC              TO TRUE                   03960001
039700            WHEN OTHER                                            03970001
039800                MOVE '1340-FETCH-DC-CRS' TO                       03980001
039900                     PV-ABEND-PARA-NAME                           03990001
040000                MOVE 'FETCH DC-READ-CRS' TO PV-DB2-OPERATION-MSG-104000001
040200                MOVE 'XLT-LOC'           TO PV-DB2-TABLE-NAME     04020001
040300                PERFORM 9998-SQL-ABEND   THRU 9998-EXIT           04030001
040400        END-EVALUATE.                                             04040001
040500                                                                  04050099
040600                                                                  04060099
040601 1350-CLOSE-DC-READ-CRS.                                          04060199
040602                                                                  04060201
040800        EXEC SQL                                                  04080000
040900            CLOSE DC-READ-CRS                                     04090000
041000        END-EXEC.                                                 04100000
041100                                                                  04110000
041200        EVALUATE TRUE                                             04120000
041300           WHEN SQLCODE = ZERO                                    04130000
041400                CONTINUE                                          04140000
041500           WHEN OTHER                                             04150000
041600                MOVE '1350-CLOSE-DC-READ-CRS' TO                  04160000
041700                     PV-ABEND-PARA-NAME                           04170000
041800                MOVE 'CLOSE CURSOR'      TO PV-DB2-OPERATION-MSG-104180000
041900                MOVE 'XLT_LOC'           TO PV-DB2-TABLE-NAME     04190000
042000                PERFORM 9998-SQL-ABEND   THRU 9998-EXIT           04200000
042100        END-EVALUATE.                                             04210000
042200                                                                  04220099
042300                                                                  04230099
042400*1360-LIST-DC-TABLE.                                              04240099
042500*                                                                 04250099
042600*    MOVE WS-DCT-OPER-UNIT-ID (DCT-IDX) TO                        04260099
042700*         PV-DISPLAY-RSN-CDE.                                     04270099
042800*                                                                 04280099
042900*    DISPLAY '** OCCURRENCE '                                     04290099
043000*            ' CONTAINS DC NUMBER '                               04300099
043100*            PV-DISPLAY-RSN-CDE.                                  04310099
043200                                                                  04320099
043300                                                                  04330099
043301 1400-INIT-GMM-TABLE.                                             04330199
043302                                                                  04330200
043303     MOVE SPACES TO WS-GMMT-GMM-NBR (GMMT-IDX)                    04330399
043304                    WS-GMMT-GMM-NAME (GMMT-IDX).                  04330499
043305     MOVE ZEROS  TO WS-GMMT-RC-TROUBLE-TOTAL (GMMT-IDX)           04330599
043306                    WS-GMMT-TROUBLE-TOTAL (GMMT-IDX)              04330699
043307                    WS-GMMT-NOTIFY-TOTAL (GMMT-IDX)               04330799
043308                    WS-GMMT-ALL-TRBL-TOTAL (GMMT-IDX).            04330899
043309                                                                  04330999
043310                                                                  04331099
043320 1410-LOAD-GMM-TABLE.                                             04332099
043330                                                                  04333099
043340     MOVE PC-00 TO WS-GMMT-GMM-NBR (1).                           04334099
043350     MOVE PC-NOT-FOUND TO WS-GMMT-GMM-NAME (1).                   04335099
043360                                                                  04336099
043370     SET PS-NOT-EOC TO TRUE.                                      04337099
043380     SET WS-TBL-LOAD-INCOMPLETE TO TRUE.                          04338099
043390     PERFORM 1420-OPEN-GMM-READ-CRS.                              04339099
043400     SET GMMT-IDX TO 2.                                           04340099
043500     SET GMMT-MAX-IDX TO 2.                                       04350099
043600     PERFORM 1430-LOAD-GMM-TABLE                                  04360099
043700         UNTIL WS-TBL-LOAD-COMPLETE.                              04370099
043800     PERFORM 1450-CLOSE-GMM-READ-CRS.                             04380099
043900                                                                  04390099
044000                                                                  04400099
044001 1420-OPEN-GMM-READ-CRS.                                          04400199
044002                                                                  04400200
044003        EXEC SQL                                                  04400300
044004             OPEN GMM-READ-CRS                                    04400499
044005        END-EXEC.                                                 04400500
044006                                                                  04400600
044007        EVALUATE TRUE                                             04400700
044008           WHEN SQLCODE = ZERO                                    04400800
044009                CONTINUE                                          04400900
044010           WHEN OTHER                                             04401000
044011                MOVE '1420-OPEN-GMM-READ-CRS' TO                  04401100
044012                     PV-ABEND-PARA-NAME                           04401200
044013                MOVE 'OPEN CURSOR'       TO PV-DB2-OPERATION-MSG-104401300
044014                MOVE 'TMDSEAR'           TO PV-DB2-TABLE-NAME     04401400
044015                PERFORM 9998-SQL-ABEND   THRU 9998-EXIT           04401500
044016        END-EVALUATE.                                             04401600
044017                                                                  04401700
044018                                                                  04401899
044019 1430-LOAD-GMM-TABLE.                                             04401999
044020                                                                  04402000
044021     PERFORM 1440-FETCH-GMM-READ-CRS.                             04402100
044022                                                                  04402201
044023     IF  PS-EOC                                                   04402301
044024         SET WS-TBL-LOAD-COMPLETE TO TRUE                         04402401
044025     ELSE                                                         04402501
044026         IF  WS-CURSOR-READ-OK                                    04402601
044027             IF  GMMT-IDX > 50                                    04402799
044028                 DISPLAY '***********************************'    04402801
044029                 DISPLAY 'TABLE OVERFLOW ON   '                   04402901
044030                 DISPLAY 'GMM TABLE - OVER 50 OCCURRENCES    '    04403099
044031                 DISPLAY 'RUN ABORTED'                            04403101
044032                 DISPLAY '***********************************'    04403201
044033                 MOVE 4001  TO PV-ABEND-CODE                      04403301
044034                 PERFORM 9999-ABORT                               04403401
044035             ELSE                                                 04403501
044036                 MOVE MDSEAR-GMA-NBR TO                           04403699
044037                      WS-GMMT-GMM-NBR (GMMT-IDX)                  04403799
044038                 PERFORM 1470-STRING-GMM-NAME                     04403899
044039                 MOVE PV-NAME TO                                  04403999
044040                      WS-GMMT-GMM-NAME (GMMT-IDX)                 04404099
044050                 SET GMMT-IDX UP BY 1                             04405001
044051                 SET GMMT-MAX-IDX UP BY 1                         04405199
044052         ELSE                                                     04405201
044053             SET WS-TBL-LOAD-COMPLETE TO TRUE.                    04405301
044054                                                                  04405499
044055                                                                  04405599
044056 1440-FETCH-GMM-READ-CRS.                                         04405699
044057                                                                  04405799
044058        EXEC SQL                                                  04405801
044059          FETCH GMM-READ-CRS                                      04405999
044060           INTO  :RSPBAR-WORKER-FIR-NAME,                         04406099
044070                 :RSPBAR-WORKER-LAST-NAME,                        04407099
044071                 :MDSEAR-GMA-NBR                                  04407199
044072        END-EXEC.                                                 04407201
044073                                                                  04407301
044074       EVALUATE TRUE                                              04407401
044075            WHEN SQLCODE = ZERO                                   04407501
044076                SET WS-CURSOR-READ-OK TO TRUE                     04407601
044077            WHEN SQLCODE = +100                                   04407701
044078                SET PS-EOC              TO TRUE                   04407801
044079            WHEN OTHER                                            04407901
044080                MOVE '1440-FETCH-GMM-CRS' TO                      04408001
044090                     PV-ABEND-PARA-NAME                           04409001
044100                MOVE 'FETCH GMM-READ-CRS' TO                      04410099
044101                     PV-DB2-OPERATION-MSG-1                       04410199
044102                MOVE 'TMDSEAR'           TO PV-DB2-TABLE-NAME     04410201
044103                PERFORM 9998-SQL-ABEND   THRU 9998-EXIT           04410301
044104        END-EVALUATE.                                             04410401
044105                                                                  04410599
044106                                                                  04410699
044107 1450-CLOSE-GMM-READ-CRS.                                         04410799
044108                                                                  04410801
044109        EXEC SQL                                                  04410900
044110            CLOSE GMM-READ-CRS                                    04411000
044111        END-EXEC.                                                 04411100
044112                                                                  04411200
044113        EVALUATE TRUE                                             04411300
044114           WHEN SQLCODE = ZERO                                    04411400
044115                CONTINUE                                          04411500
044116           WHEN OTHER                                             04411600
044117                MOVE '1450-CLOSE-GMM-READ-CRS' TO                 04411700
044118                     PV-ABEND-PARA-NAME                           04411800
044119                MOVE 'CLOSE CURSOR'      TO PV-DB2-OPERATION-MSG-104411900
044120                MOVE 'TMDSEAR'           TO PV-DB2-TABLE-NAME     04412000
044121                PERFORM 9998-SQL-ABEND   THRU 9998-EXIT           04412100
044122        END-EVALUATE.                                             04412200
044123                                                                  04412399
044124                                                                  04412499
044125*1460-LIST-GMM-TABLE.                                             04412599
044126*                                                                 04412699
044127*    DISPLAY '** OCCURRENCE CONTAINS GMM NUMBER '                 04412799
044128*            WS-GMMT-GMM-NBR (GMMT-IDX)                           04412899
044129*            ' WITH NAME OF '                                     04412999
044130*            WS-GMMT-GMM-NAME (GMMT-IDX).                         04413099
044140                                                                  04414099
044141                                                                  04414199
044142 1470-STRING-GMM-NAME.                                            04414200
044143                                                                  04414399
044144     MOVE RSPBAR-WORKER-FIR-NAME  TO PV-FIRST-NAME.               04414499
044145     MOVE RSPBAR-WORKER-LAST-NAME TO PV-LAST-NAME.                04414599
044146                                                                  04414699
044147     INITIALIZE PV-NAME.                                          04414799
044148     SET INX3 TO 1.                                               04414899
044149                                                                  04414999
044150     PERFORM VARYING INX1 FROM 1 BY 1                             04415099
044160                 UNTIL INX1 > 12                                  04416099
044170           IF  PV-FIRST-NAME-BYTE (INX1) = SPACE                  04417099
044180               SET INX3 UP BY 1                                   04418099
044190               SET INX1   TO 12                                   04419099
044200           ELSE                                                   04420099
044300               MOVE PV-FIRST-NAME-BYTE (INX1)  TO                 04430099
044400                    PV-NAME-BYTE (INX3)                           04440099
044500               SET INX3 UP BY 1                                   04450099
044600           END-IF                                                 04460099
044700     END-PERFORM.                                                 04470099
044800                                                                  04480099
044900     PERFORM VARYING INX2 FROM 1 BY 1                             04490099
045000                 UNTIL INX2 > 18                                  04500099
045100           IF  PV-LAST-NAME-BYTE (INX2) = SPACE                   04510099
045200               SET INX2   TO 18                                   04520099
045300           ELSE                                                   04530099
045400               MOVE PV-LAST-NAME-BYTE (INX2)  TO                  04540099
045500                    PV-NAME-BYTE (INX3)                           04550099
045600               SET INX3 UP BY 1                                   04560099
045700           END-IF                                                 04570099
045800     END-PERFORM.                                                 04580099
045900                                                                  04590099
045901                                                                  04590199
045902 1500-OPEN-TTRBRCN-CRS.                                           04590200
045903                                                                  04590300
045904        EXEC SQL                                                  04590400
045905             OPEN TTRBRCN-READ-CRS                                04590500
045906        END-EXEC.                                                 04590600
045907                                                                  04590700
045908        EVALUATE TRUE                                             04590800
045909           WHEN SQLCODE = ZERO                                    04590900
045910                CONTINUE                                          04591000
045911           WHEN OTHER                                             04591100
045912                MOVE '1500-OPEN-TTRBRCN-CRS'  TO                  04591200
045913                     PV-ABEND-PARA-NAME                           04591300
045914                MOVE 'OPEN CURSOR'       TO PV-DB2-OPERATION-MSG-104591400
045915                MOVE 'TTRBRCN'           TO PV-DB2-TABLE-NAME     04591500
045916                PERFORM 9998-SQL-ABEND   THRU 9998-EXIT           04591600
045917        END-EVALUATE.                                             04591700
045918                                                                  04591800
045919 1600-FETCH-TTRBRCN-CRS.                                          04591901
045920                                                                  04592001
045921        EXEC SQL                                                  04592101
045922          FETCH TTRBRCN-READ-CRS                                  04592201
045923           INTO  :TRBRCN-TRBL-RSN-CDE                             04592301
045924                ,:TRBRCN-RPT-AREA-CDE                             04592401
045925                ,:TRBRCN-INCL-TOT-IND                             04592501
045926        END-EXEC.                                                 04592601
045927                                                                  04592701
045928       EVALUATE TRUE                                              04592801
045929            WHEN SQLCODE = ZERO                                   04592901
045930                SET WS-CURSOR-READ-OK TO TRUE                     04593001
045931            WHEN SQLCODE = +100                                   04593101
045932                SET PS-EOC              TO TRUE                   04593201
045933            WHEN OTHER                                            04593301
045934                MOVE '1600-FETCH-TTRBRCN-CRS' TO                  04593401
045935                     PV-ABEND-PARA-NAME                           04593501
045936                MOVE 'FETCH TTRBRCN-READ-CRS'                     04593601
045937                                         TO PV-DB2-OPERATION-MSG-104593701
045938                MOVE 'TTRBNTF'           TO PV-DB2-TABLE-NAME     04593801
045939                PERFORM 9998-SQL-ABEND   THRU 9998-EXIT           04593901
045940        END-EVALUATE.                                             04594001
045941                                                                  04594101
045942                                                                  04594201
045943 1700-CLOSE-TTRBRCN-CRS.                                          04594300
045944                                                                  04594401
045945        EXEC SQL                                                  04594500
045946            CLOSE TTRBRCN-READ-CRS                                04594600
045947        END-EXEC.                                                 04594700
045948                                                                  04594800
045949        EVALUATE TRUE                                             04594900
045950           WHEN SQLCODE = ZERO                                    04595000
045951                CONTINUE                                          04595100
045952           WHEN OTHER                                             04595200
045953                MOVE '1700-CLOSE-TTRBRCN-CRS' TO                  04595300
045954                     PV-ABEND-PARA-NAME                           04595400
045955                MOVE 'CLOSE CURSOR'      TO PV-DB2-OPERATION-MSG-104595500
045956                MOVE 'TTRBRCN'           TO PV-DB2-TABLE-NAME     04595600
045957                PERFORM 9998-SQL-ABEND   THRU 9998-EXIT           04595700
045958        END-EVALUATE.                                             04595800
045959 EJECT                                                            04595900
045960 2000-MAIN-LOOP.                                                  04596000
045970                                                                  04597002
045980     IF  CC-INCLUDE-ASSIGN-RESOLVE                                04598099
045990         SET WS-PROCESS-RECORD TO TRUE                            04599099
046000     ELSE                                                         04600099
046100         SET WS-OMIT-RECORD TO TRUE                               04610099
046200         PERFORM 2100-CHECK-FOR-PROCESS                           04620099
046300     END-IF.                                                      04630099
046400                                                                  04640099
046500     IF  WS-PROCESS-RECORD                                        04650099
046600         IF  TM001-TRBL-RSN-CDE =                                 04660099
046700             PV-PREV-TRBL-RSN-CDE                                 04670099
046800             IF  WS-TRBL-RSN-CDE-VALID                            04680099
046900                 SET RSN-CDE-IDX TO RSN-CDE-START-IDX             04690099
047000                 IF  CC-PROCESS-BY-DC                             04700099
047100                     PERFORM 2050-CHECK-FOR-DC-CHANGE             04710099
047200                 ELSE                                             04720099
047300                     CONTINUE                                     04730099
047400                 END-IF                                           04740099
047500                 SET WS-SEARCH-INCOMPLETE TO TRUE                 04750099
047600                 PERFORM 2400-SEARCH-TABLE                        04760099
047700                     UNTIL WS-SEARCH-COMPLETE                     04770099
047800                 PERFORM 2020-ACCUM-COUNTS                        04780099
047900             ELSE                                                 04790099
048000                 ADD +1 TO WS-RCD-BYPASS-COUNT                    04800099
048100         ELSE                                                     04810099
048200             PERFORM 2300-NEW-RSN-CODE                            04820099
048300             MOVE TM001-TRBL-RSN-CDE TO                           04830099
048400                  PV-PREV-TRBL-RSN-CDE                            04840099
048500             MOVE TM001-PO-NBR TO                                 04850099
048600                  PV-PREV-PO-NBR                                  04860099
048700             MOVE TM001-REC-SEQ-NBR TO                            04870099
048800                  PV-PREV-REC-SEQ-NBR                             04880099
048900             MOVE TM001-NOTIF-DATE TO                             04890099
049000                  PV-PREV-NOTIF-DATE                              04900099
049100             IF  WS-TRBL-RSN-CDE-VALID                            04910099
049200                 MOVE TM001-TRBL-RSN-CDE TO                       04920099
049300                      WS-HOLD-TRBL-RSN-CDE                        04930099
049400                 MOVE TM001-TRBL-RSN-CDE-DESC TO                  04940099
049500                      WS-HOLD-TRBL-RSN-DESC                       04950099
049600                 MOVE TM001-TRBL-RSN-NOTIF-CDE TO                 04960099
049700                      WS-HOLD-TRBL-RSN-NOTIF-CDE                  04970099
049800                 SET WS-DATE-INVALID TO TRUE                      04980099
049900                 PERFORM 2010-CHECK-NOTIF-DATE                    04990099
050000                 IF  WS-DATE-VALID                                05000099
050100                     ADD +1 TO WS-TRBL-RSN-CDE-TOTAL              05010099
050200                     PERFORM 2060-CHECK-GMM-TABLE                 05020099
050300                     IF  WS-INCLUDE-IN-TOTAL                      05030099
050400                         PERFORM 2040-ACCUM-FINAL-TOTALS          05040099
050500                         PERFORM 2030-ACCUM-DIV-TOTALS            05050099
050600                     ELSE                                         05060099
050700                         NEXT SENTENCE                            05070099
050800                 ELSE                                             05080099
050900                     NEXT SENTENCE                                05090099
051000             ELSE                                                 05100099
051100                 NEXT SENTENCE                                    05110099
051200     ELSE                                                         05120099
051201         NEXT SENTENCE.                                           05120199
051202                                                                  05120202
051203     IF  WS-OMIT-RECORD                                           05120399
051204         NEXT SENTENCE                                            05120499
051205     ELSE                                                         05120599
051206         SET WS-NOT-FIRST-TIME-PROCESS TO TRUE.                   05120699
051207                                                                  05120702
051208     PERFORM 7000-READ-INPUT-FILE.                                05120802
051209                                                                  05120900
051210 2010-CHECK-NOTIF-DATE.                                           05121004
051211                                                                  05121104
051212     IF  TM001-NOTIF-DATE >= PV-BEG-DATE                          05121204
051213     AND TM001-NOTIF-DATE <= PV-END-DATE                          05121304
051214         SET WS-DATE-VALID TO TRUE                                05121404
051215     ELSE                                                         05121504
051216         NEXT SENTENCE.                                           05121604
051217                                                                  05121704
051218                                                                  05121804
051219 2020-ACCUM-COUNTS.                                               05121904
051220                                                                  05122004
051221     MOVE TM001-PO-NBR TO                                         05122104
051222          PV-CURR-PO-NBR.                                         05122204
051223     MOVE TM001-REC-SEQ-NBR TO                                    05122304
051224          PV-CURR-REC-SEQ-NBR.                                    05122404
051225     IF  PV-CURR-KEY = PV-PREV-KEY                                05122504
051226         IF  TM001-NOTIF-DATE = PV-PREV-NOTIF-DATE                05122604
051227             NEXT SENTENCE                                        05122799
051228         ELSE                                                     05122804
051229             MOVE TM001-NOTIF-DATE TO                             05122999
051230                  PV-PREV-NOTIF-DATE                              05123099
051231             SET WS-DATE-INVALID TO TRUE                          05123104
051232             PERFORM 2010-CHECK-NOTIF-DATE                        05123204
051233             IF  WS-DATE-VALID                                    05123304
051234                 ADD +1 TO WS-TRBL-RSN-CDE-TOTAL                  05123406
051235                 PERFORM 2060-CHECK-GMM-TABLE                     05123599
051236                 IF  WS-INCLUDE-IN-TOTAL                          05123605
051237                     PERFORM 2040-ACCUM-FINAL-TOTALS              05123799
051238                     PERFORM 2030-ACCUM-DIV-TOTALS                05123899
051239                 ELSE                                             05123905
051240                     NEXT SENTENCE                                05124005
051241             ELSE                                                 05124104
051242                 NEXT SENTENCE                                    05124204
051243     ELSE                                                         05124304
051244         MOVE PV-CURR-KEY TO                                      05124405
051245              PV-PREV-KEY                                         05124505
051246         MOVE TM001-NOTIF-DATE TO                                 05124605
051247              PV-PREV-NOTIF-DATE                                  05124705
051248         SET WS-DATE-INVALID TO TRUE                              05124805
051249         PERFORM 2010-CHECK-NOTIF-DATE                            05124905
051250             IF  WS-DATE-VALID                                    05125005
051260                 ADD +1 TO WS-TRBL-RSN-CDE-TOTAL                  05126006
051261                 PERFORM 2060-CHECK-GMM-TABLE                     05126199
051262                 IF  WS-INCLUDE-IN-TOTAL                          05126205
051263                     PERFORM 2040-ACCUM-FINAL-TOTALS              05126399
051264                     PERFORM 2030-ACCUM-DIV-TOTALS                05126499
051265                 ELSE                                             05126505
051266                     NEXT SENTENCE                                05126605
051267             ELSE                                                 05126705
051268                 NEXT SENTENCE.                                   05126805
051269                                                                  05126904
051270                                                                  05127004
051271 2030-ACCUM-DIV-TOTALS.                                           05127199
051272                                                                  05127204
051273*    IF  TM001-RPT-AREA-BUYING OR                                 05127399
051274     IF  TM001-RPT-AREA-ANALYST                                   05127499
051275         ADD +1 TO WS-ASSIGNED-TOT-MDSE-DIV                       05127599
051276         IF  TM001-TRBL-RSN-NOTIF                                 05127699
051277             ADD +1 TO WS-NOTIFY-TOT-MDSE-DIV                     05127799
051278         ELSE                                                     05127899
051279             IF  TM001-TRBL-RSN-TROUBLE                           05127999
051280                 ADD +1 TO WS-TROUBLE-TOT-MDSE-DIV                05128099
051290             ELSE                                                 05129099
051300                 NEXT SENTENCE                                    05130099
051400     ELSE                                                         05140099
051500         IF  TM001-RPT-AREA-DC                                    05150099
051600             IF  CC-PROCESS-BY-DC                                 05160099
051700                 PERFORM 2500-ACCUM-BY-DC                         05170099
051800             END-IF                                               05180099
051900             ADD +1 TO WS-ASSIGNED-TOT-DC-DIV                     05190099
052000             IF  TM001-TRBL-RSN-NOTIF                             05200099
052100                 ADD +1 TO WS-NOTIFY-TOT-DC-DIV                   05210099
052200             ELSE                                                 05220099
052300                 IF  TM001-TRBL-RSN-TROUBLE                       05230099
052400                     ADD +1 TO WS-TROUBLE-TOT-DC-DIV              05240099
052500                 ELSE                                             05250099
052600                     NEXT SENTENCE                                05260099
052700         ELSE                                                     05270099
052800             ADD +1 TO WS-ASSIGNED-TOT-VEND-DIV                   05280099
052900             IF  TM001-TRBL-RSN-NOTIF                             05290099
053000                 ADD +1 TO WS-NOTIFY-TOT-VEND-DIV                 05300099
053100             ELSE                                                 05310099
053200                 IF  TM001-TRBL-RSN-TROUBLE                       05320099
053300                     ADD +1 TO WS-TROUBLE-TOT-VEND-DIV            05330099
053400                 ELSE                                             05340099
053500                     NEXT SENTENCE                                05350099
053600         END-IF                                                   05360099
053700     END-IF.                                                      05370099
053800                                                                  05380099
053900                                                                  05390099
054000 2040-ACCUM-FINAL-TOTALS.                                         05400099
054100                                                                  05410099
054200     ADD +1 TO WS-ASSIGNED-TOTAL.                                 05420099
054300                                                                  05430099
054400     IF  TM001-TRBL-RSN-NOTIF                                     05440099
054500         ADD +1 TO WS-ASSIGNED-NOTIFY-TOTAL                       05450099
054600     ELSE                                                         05460099
054700         IF  TM001-TRBL-RSN-TROUBLE                               05470099
054800             ADD +1 TO WS-ASSIGNED-TRBL-TOTAL                     05480099
054900         ELSE                                                     05490099
055000             NEXT SENTENCE.                                       05500099
055100                                                                  05510099
055200                                                                  05520099
055300 2050-CHECK-FOR-DC-CHANGE.                                        05530099
055400                                                                  05540099
055500     IF  WS-HOLD-REPORT-DIVISION = PC-HH                          05550099
055600         IF  TM001-OPER-UNT-ID = PV-PREV-OPER-UNT-ID              05560099
055700             NEXT SENTENCE                                        05570099
055800         ELSE                                                     05580099
055900             PERFORM 2310-WRITE-RSN-TOTAL-RECORD                  05590099
056000     ELSE                                                         05600099
056100         NEXT SENTENCE.                                           05610099
056200                                                                  05620099
056300                                                                  05630099
056400 2060-CHECK-GMM-TABLE.                                            05640099
056500                                                                  05650099
056600     IF  WS-HOLD-REPORT-DIVISION = PC-BB                          05660099
056700         IF  CC-PROCESS-BY-GMM                                    05670099
056800             SET WS-GMM-SEARCH-INCOMPLETE TO TRUE                 05680099
056900             PERFORM 2070-SEARCH-GMM-TABLE                        05690099
057000                 VARYING GMMT-IDX FROM 1 BY 1                     05700099
057100                 UNTIL   GMMT-IDX > 50                            05710099
057200                 OR      WS-GMM-SEARCH-COMPLETE                   05720099
057300             PERFORM 2080-CHECK-SEARCH-RESULT                     05730099
057400         END-IF                                                   05740099
057500     END-IF.                                                      05750099
057600                                                                  05760099
057700 2070-SEARCH-GMM-TABLE.                                           05770099
057800                                                                  05780099
057900     IF  TM001-GMM-NBR = WS-GMMT-GMM-NBR (GMMT-IDX)               05790099
058000         SET GMMT-PROCESS-IDX TO GMMT-IDX                         05800099
058100         SET WS-GMM-SEARCH-COMPLETE TO TRUE                       05810099
058200     ELSE                                                         05820099
058300         NEXT SENTENCE.                                           05830099
058400                                                                  05840099
058500                                                                  05850099
058600 2080-CHECK-SEARCH-RESULT.                                        05860099
058700                                                                  05870099
058800     IF  WS-GMM-SEARCH-COMPLETE                                   05880099
058900         ADD +1 TO                                                05890099
059000         WS-GMMT-ALL-TRBL-TOTAL (GMMT-PROCESS-IDX)                05900099
059100         ADD +1 TO                                                05910099
059200         WS-GMMT-RC-TROUBLE-TOTAL (GMMT-PROCESS-IDX)              05920099
059300         IF  TM001-TRBL-RSN-NOTIF                                 05930099
059400             ADD +1 TO                                            05940099
059500             WS-GMMT-NOTIFY-TOTAL (GMMT-PROCESS-IDX)              05950099
059600         ELSE                                                     05960099
059700             IF  TM001-TRBL-RSN-TROUBLE                           05970099
059800                 ADD +1 TO                                        05980099
059900                 WS-GMMT-TROUBLE-TOTAL (GMMT-PROCESS-IDX)         05990099
060000             ELSE                                                 06000099
060100                 NEXT SENTENCE                                    06010099
060200     ELSE                                                         06020099
060300         IF  GMMT-MAX-IDX = 50                                    06030099
060400             DISPLAY '***********************************'        06040099
060500             DISPLAY 'TABLE OVERFLOW ON   '                       06050099
060600             DISPLAY 'GMM TABLE - OVER 50 OCCURS         '        06060099
060700             DISPLAY 'RUN ABORTED'                                06070099
060800             DISPLAY '***********************************'        06080099
060900             MOVE 4001  TO PV-ABEND-CODE                          06090099
061000             PERFORM 9999-ABORT                                   06100099
061100         ELSE                                                     06110099
061200             SET GMMT-PROCESS-IDX TO GMMT-MAX-IDX                 06120099
061300             MOVE TM001-GMM-NBR TO                                06130099
061400                  WS-GMMT-GMM-NBR (GMMT-PROCESS-IDX)              06140099
061500             MOVE TM001-GMM-NAME TO                               06150099
061600                  WS-GMMT-GMM-NAME (GMMT-PROCESS-IDX)             06160099
061700             ADD +1 TO WS-GMMT-ALL-TRBL-TOTAL (GMMT-PROCESS-IDX)  06170099
061800             ADD +1 TO WS-GMMT-RC-TROUBLE-TOTAL (GMMT-PROCESS-IDX)06180099
061900             IF  TM001-TRBL-RSN-NOTIF                             06190099
062000                 ADD +1 TO WS-GMMT-NOTIFY-TOTAL (GMMT-PROCESS-IDX)06200099
062100             ELSE                                                 06210099
062200                 IF  TM001-TRBL-RSN-TROUBLE                       06220099
062300                     ADD +1 TO                                    06230099
062400                         WS-GMMT-TROUBLE-TOTAL (GMMT-PROCESS-IDX) 06240099
062500                 ELSE                                             06250099
062600                     NEXT SENTENCE                                06260099
062700                 END-IF                                           06270099
062800             END-IF                                               06280099
062900             SET GMMT-MAX-IDX UP BY 1.                            06290099
063000                                                                  06300099
063100                                                                  06310099
063200 2100-CHECK-FOR-PROCESS.                                          06320099
063300                                                                  06330099
063400     IF  CC-INCLUDE-ASSIGN-ONLY                                   06340099
063500         IF  TM001-NOTIF-DATE >= PV-BEG-DATE                      06350099
063600         AND TM001-NOTIF-DATE <= PV-END-DATE                      06360099
063700             SET WS-PROCESS-RECORD TO TRUE                        06370099
063800         ELSE                                                     06380099
063900             ADD +1 TO WS-RCD-BYPASS-COUNT                        06390099
064000     ELSE                                                         06400099
064100         IF  TM001-RESOLVED-DATE >= PV-BEG-DATE                   06410099
064200         AND TM001-RESOLVED-DATE <= PV-END-DATE                   06420099
064300             SET WS-PROCESS-RECORD TO TRUE                        06430099
064400         ELSE                                                     06440099
064500             ADD +1 TO WS-RCD-BYPASS-COUNT.                       06450099
064600                                                                  06460099
064601                                                                  06460199
064602 2300-NEW-RSN-CODE.                                               06460203
064603                                                                  06460303
064604     IF  WS-FIRST-TIME-PROCESS                                    06460403
064605         NEXT SENTENCE                                            06460503
064606     ELSE                                                         06460603
064607         IF  WS-TRBL-RSN-CDE-VALID                                06460704
064608             IF  WS-HOLD-REPORT-DIVISION = PC-BB                  06460899
064609                 IF  CC-PROCESS-BY-GMM                            06460999
064610                     PERFORM 2320-WRITE-RSN-FROM-TABLE            06461099
064620                         VARYING GMMT-IDX FROM 1 BY 1             06462099
064630                         UNTIL   GMMT-IDX > 50                    06463099
064640                 ELSE                                             06464099
064650                     PERFORM 2310-WRITE-RSN-TOTAL-RECORD          06465099
064660                 END-IF                                           06466099
064670             ELSE                                                 06467099
064680                 PERFORM 2310-WRITE-RSN-TOTAL-RECORD              06468099
064681             END-IF                                               06468199
064682         ELSE                                                     06468204
064683             NEXT SENTENCE                                        06468304
064684         END-IF                                                   06468404
064685     END-IF.                                                      06468504
064686                                                                  06468603
064687     SET RSN-CDE-IDX TO RSN-CDE-START-IDX.                        06468703
064688     SET WS-FIRST-OCCUR-NOT-FOUND TO TRUE.                        06468803
064689     SET WS-SEARCH-INCOMPLETE TO TRUE.                            06468903
064690     SET WS-OMIT-IN-TOTAL TO TRUE.                                06469004
064691     SET WS-TRBL-RSN-CDE-INVALID TO TRUE.                         06469104
064692                                                                  06469203
064693     PERFORM 2400-SEARCH-TABLE                                    06469399
064694         UNTIL WS-SEARCH-COMPLETE.                                06469499
064695                                                                  06469503
064696 2310-WRITE-RSN-TOTAL-RECORD.                                     06469605
064697                                                                  06469799
064698     IF  CC-TOTAL-BY-RSN-CDE                                      06469806
064699         MOVE WS-HOLD-TRBL-RSN-CDE TO                             06469906
064700              RTR-SF-TRBL-RSN-CDE                                 06470006
064701              RTR-TRBL-RSN-CDE                                    06470106
064702         MOVE WS-HOLD-TRBL-RSN-DESC TO                            06470206
064703              RTR-TRBL-RSN-CDE-DESC                               06470306
064704         MOVE WS-HOLD-TRBL-RSN-NOTIF-CDE TO                       06470406
064705              RTR-SF-RSN-NOTIF-CDE                                06470506
064706         IF  WS-HOLD-TRBL-RSN-NOTIF-CDE = PC-N                    06470699
064707             MOVE PC-B TO RTR-REPORT-NOTIF-CDE                    06470799
064708         ELSE                                                     06470899
064709             MOVE PC-A TO RTR-REPORT-NOTIF-CDE                    06470999
064710         END-IF                                                   06471099
064711         MOVE WS-TRBL-RSN-CDE-TOTAL TO                            06471106
064712              RTR-TRBL-RSN-TOT-QTY                                06471206
064713         SUBTRACT WS-TRBL-RSN-CDE-TOTAL FROM                      06471306
064714                  PC-99999 GIVING                                 06471406
064715                  PV-CALC-TEMP-QTY                                06471506
064716         MOVE PV-CALC-TEMP-QTY TO                                 06471606
064717              RTR-SF-RSN-QTY                                      06471706
064718         IF  CC-NO-TOTAL-TRBL-ASSIGN-DIV                          06471899
064719             MOVE PC-PP TO RTR-REPORT-DIVISION                    06471999
064720             MOVE ZEROS TO RTR-REPORT-OPER-UNT-ID                 06472099
064730             MOVE PC-00 TO RTR-REPORT-GMM-NBR                     06473099
064740         ELSE                                                     06474099
064750             MOVE WS-HOLD-REPORT-DIVISION TO                      06475099
064760                  RTR-REPORT-DIVISION                             06476099
064770             IF  WS-HOLD-REPORT-DIVISION = PC-HH                  06477099
064780                 MOVE WS-HOLD-REPORT-OPER-UNT-ID TO               06478099
064790                      RTR-REPORT-OPER-UNT-ID                      06479099
064800                 MOVE PC-00 TO RTR-REPORT-GMM-NBR                 06480099
064900             ELSE                                                 06490099
065000                 IF  WS-HOLD-REPORT-DIVISION = PC-BB              06500099
065100                     MOVE ZEROS TO RTR-REPORT-OPER-UNT-ID         06510099
065200                     MOVE WS-HOLD-REPORT-GMM-NBR TO               06520099
065300                          RTR-REPORT-GMM-NBR                      06530099
065400                 ELSE                                             06540099
065500                     MOVE PC-00 TO RTR-REPORT-GMM-NBR             06550099
065600                     MOVE ZEROS TO RTR-REPORT-OPER-UNT-ID         06560099
065700                 END-IF                                           06570099
065800             END-IF                                               06580099
065900         END-IF                                                   06590099
065901         PERFORM 5000-CALC-AVG-RESOLVE-TIME                       06590199
065902         WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                       06590206
065903               WS-REASON-TOTAL-RECORD                             06590306
065904         ADD +1 TO WS-RCD-RSNTOT-WRITE-COUNT                      06590406
065905     ELSE                                                         06590506
065906         NEXT SENTENCE                                            06590606
065907     END-IF.                                                      06590799
065908                                                                  06590806
065909     MOVE ZEROS TO WS-TRBL-RSN-CDE-TOTAL.                         06590906
065910                                                                  06591006
065920     IF  PS-EOF                                                   06592099
065930         NEXT SENTENCE                                            06593099
065940     ELSE                                                         06594099
065950         MOVE TM001-OPER-UNT-ID TO                                06595099
065951              PV-PREV-OPER-UNT-ID.                                06595199
065952                                                                  06595205
065953                                                                  06595305
065954 2320-WRITE-RSN-FROM-TABLE.                                       06595499
065955                                                                  06595505
065956     IF  CC-TOTAL-BY-RSN-CDE                                      06595606
065957         IF  WS-GMMT-RC-TROUBLE-TOTAL (GMMT-IDX) > ZERO           06595799
065958             MOVE WS-HOLD-TRBL-RSN-CDE TO                         06595899
065959                  RTR-SF-TRBL-RSN-CDE                             06595999
065960                  RTR-TRBL-RSN-CDE                                06596099
065970             MOVE WS-HOLD-TRBL-RSN-DESC TO                        06597099
065980                  RTR-TRBL-RSN-CDE-DESC                           06598099
065990             MOVE WS-HOLD-TRBL-RSN-NOTIF-CDE TO                   06599099
066000                  RTR-SF-RSN-NOTIF-CDE                            06600099
066100             IF  WS-HOLD-TRBL-RSN-NOTIF-CDE = PC-N                06610099
066200                 MOVE PC-B TO RTR-REPORT-NOTIF-CDE                06620099
066300             ELSE                                                 06630099
066400                 MOVE PC-A TO RTR-REPORT-NOTIF-CDE                06640099
066500             END-IF                                               06650099
066600             MOVE WS-GMMT-RC-TROUBLE-TOTAL (GMMT-IDX) TO          06660099
066700                  RTR-TRBL-RSN-TOT-QTY                            06670099
066800             SUBTRACT WS-GMMT-RC-TROUBLE-TOTAL (GMMT-IDX) FROM    06680099
066900                      PC-99999 GIVING                             06690099
067000                      PV-CALC-TEMP-QTY                            06700099
067100             MOVE PV-CALC-TEMP-QTY TO                             06710099
067200                  RTR-SF-RSN-QTY                                  06720099
067300             MOVE ZERO TO WS-GMMT-RC-TROUBLE-TOTAL (GMMT-IDX)     06730099
067400             IF  CC-NO-TOTAL-TRBL-ASSIGN-DIV                      06740099
067500                 MOVE PC-PP TO RTR-REPORT-DIVISION                06750099
067600                 MOVE ZEROS TO RTR-REPORT-OPER-UNT-ID             06760099
067700                 MOVE PC-00 TO RTR-REPORT-GMM-NBR                 06770099
067800             ELSE                                                 06780099
067900                 MOVE WS-HOLD-REPORT-DIVISION TO                  06790099
068000                      RTR-REPORT-DIVISION                         06800099
068100                 MOVE ZEROS TO RTR-REPORT-OPER-UNT-ID             06810099
068200                 MOVE WS-GMMT-GMM-NBR (GMMT-IDX) TO               06820099
068300                      RTR-REPORT-GMM-NBR                          06830099
068400             END-IF                                               06840099
068500             PERFORM 5000-CALC-AVG-RESOLVE-TIME                   06850099
068600             WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                   06860099
068700                   WS-REASON-TOTAL-RECORD                         06870099
068800             ADD +1 TO WS-RCD-RSNTOT-WRITE-COUNT                  06880099
068900         ELSE                                                     06890099
069000             NEXT SENTENCE                                        06900099
069100         END-IF                                                   06910099
069200     ELSE                                                         06920099
069300         NEXT SENTENCE                                            06930099
069301     END-IF.                                                      06930199
069302                                                                  06930206
069303     MOVE ZEROS TO WS-TRBL-RSN-CDE-TOTAL.                         06930306
069304                                                                  06930405
069305                                                                  06930505
069306 2400-SEARCH-TABLE.                                               06930603
069307                                                                  06930703
069308     IF  RSN-CDE-IDX > WS-RSN-CDE-TBL-ENTRY                       06930803
069309         SET WS-SEARCH-COMPLETE TO TRUE                           06930903
069310     ELSE                                                         06931003
069311         IF  WS-RSN-CDE (RSN-CDE-IDX) = TM001-TRBL-RSN-CDE        06931103
069312             SET WS-TRBL-RSN-CDE-VALID TO TRUE                    06931204
069313             PERFORM 2410-FORMAT-AND-WRITE                        06931303
069314             IF  WS-FIRST-OCCUR-FOUND                             06931403
069315                 SET RSN-CDE-IDX UP BY 1                          06931599
069316             ELSE                                                 06931603
069317                 SET WS-FIRST-OCCUR-FOUND TO TRUE                 06931703
069318                 SET RSN-CDE-START-IDX TO RSN-CDE-IDX             06931803
069319                 SET RSN-CDE-IDX UP BY 1                          06931999
069320             END-IF                                               06932003
069321         ELSE                                                     06932103
069322             IF  WS-RSN-CDE(RSN-CDE-IDX) > TM001-TRBL-RSN-CDE     06932203
069323                 SET WS-SEARCH-COMPLETE TO TRUE                   06932303
069324             ELSE                                                 06932403
069325                 SET RSN-CDE-IDX UP BY 1                          06932503
069326             END-IF                                               06932603
069327     END-IF.                                                      06932703
069328                                                                  06932803
069329                                                                  06932903
069330 2410-FORMAT-AND-WRITE.                                           06933003
069331                                                                  06933103
069332     MOVE WS-RPT-AREA-CDE (RSN-CDE-IDX) TO                        06933203
069333          TM001-REPORT-AREA.                                      06933303
069334     MOVE TM001-OPER-UNT-ID TO                                    06933499
069335          WS-HOLD-REPORT-OPER-UNT-ID.                             06933599
069336     MOVE TM001-GMM-NBR TO                                        06933699
069337          WS-HOLD-REPORT-GMM-NBR.                                 06933799
069338                                                                  06933899
069339     IF  TM001-RPT-AREA-ANALYST                                   06933999
069340         SET TM001-RPT-DIV-MERCHANDISE TO TRUE                    06934099
069350         MOVE TM001-REPORT-DIVISION TO                            06935099
069360              WS-HOLD-REPORT-DIVISION                             06936099
069370     ELSE                                                         06937099
069380         IF  TM001-RPT-AREA-BUYING                                06938099
069390             SET TM001-RPT-DIV-BUYING TO TRUE                     06939099
069400             MOVE TM001-REPORT-DIVISION TO                        06940099
069500                  WS-HOLD-REPORT-DIVISION                         06950099
069600         ELSE                                                     06960099
069700             IF  TM001-RPT-AREA-VENDOR                            06970099
069800                 SET TM001-RPT-DIV-VENDOR TO TRUE                 06980099
069900                 MOVE TM001-REPORT-DIVISION TO                    06990099
070000                      WS-HOLD-REPORT-DIVISION                     07000099
070100             ELSE                                                 07010099
070200                 IF  TM001-RPT-AREA-DC                            07020099
070300                     SET TM001-RPT-DIV-LOGISTICS TO TRUE          07030099
070400                     MOVE TM001-REPORT-DIVISION TO                07040099
070500                          WS-HOLD-REPORT-DIVISION                 07050099
070600                 ELSE                                             07060099
070700                     MOVE SPACES TO TM001-REPORT-DIVISION         07070099
070800                                    WS-HOLD-REPORT-DIVISION.      07080099
070900                                                                  07090099
071000     MOVE SPACES TO TM001-REPORT-VENDOR-GROUP-IND.                07100099
071100                                                                  07110099
071200     IF  TM001-RPT-AREA-VENDOR                                    07120099
071300       MOVE TM001-TRBL-RSN-CDE TO PV-REASON-CODE                  07130099
071400                                                                  07140099
071500       IF  TM001-TRBL-RSN-CDE EQUAL PC-501                        07150099
071600       OR  TM001-TRBL-RSN-CDE EQUAL PC-502                        07160099
071700**         EARLY                                                  07170099
071800           SET TM001-RPT-GROUP-A TO TRUE                          07180099
071900       ELSE                                                       07190099
072000         IF  TM001-TRBL-RSN-CDE EQUAL PC-508                      07200099
072100         OR  TM001-TRBL-RSN-CDE EQUAL PC-509                      07210099
072200**           LATE                                                 07220099
072300             SET TM001-RPT-GROUP-B TO TRUE                        07230099
072400         ELSE                                                     07240099
072500           IF  PC-SHORT-REASON                                    07250099
072600               SET TM001-RPT-GROUP-C TO TRUE                      07260099
072700           ELSE                                                   07270099
072800             IF  PC-OVER-REASON                                   07280099
072900                 SET TM001-RPT-GROUP-D TO TRUE                    07290099
073000             ELSE                                                 07300099
073100               IF  TM001-TRBL-RSN-CDE EQUAL PC-530                07310099
073200**                 STYLE                                          07320099
073300                   SET TM001-RPT-GROUP-E TO TRUE                  07330099
073400               ELSE                                               07340099
073500                 IF PC-PACK-SHORT-REASON                          07350099
073600**                  PACK SHORT                                    07360099
073700                    SET TM001-RPT-GROUP-F TO TRUE                 07370099
073800                 ELSE                                             07380099
073900                   IF PC-PACK-OVER-REASON                         07390099
074000**                    PACK OVER                                   07400099
074100                      SET TM001-RPT-GROUP-G TO TRUE               07410099
074200                   ELSE                                           07420099
074300                     IF TM001-TRBL-RSN-CDE EQUAL PC-269           07430099
074400                     OR TM001-TRBL-RSN-CDE EQUAL PC-271           07440099
074500                        SET TM001-RPT-GROUP-H TO TRUE             07450099
074600                     ELSE                                         07460099
074700                       IF TM001-TRBL-RSN-CDE EQUAL PC-582         07470099
074800                       OR TM001-TRBL-RSN-CDE EQUAL PC-583         07480099
074900**                        PACK LINE SHORT                         07490099
075000                          SET TM001-RPT-GROUP-I TO TRUE           07500099
075100                       ELSE                                       07510099
075200                         IF TM001-TRBL-RSN-CDE EQUAL PC-591       07520099
075300                         OR TM001-TRBL-RSN-CDE EQUAL PC-592       07530099
075400**                          PACK LINE OVER                        07540099
075500                            SET TM001-RPT-GROUP-J TO TRUE         07550099
075600                         ELSE                                     07560099
075700                           NEXT SENTENCE                          07570099
075800     ELSE                                                         07580099
075900         NEXT SENTENCE.                                           07590099
075901                                                                  07590199
075902     MOVE WS-INCL-TOT-CDE (RSN-CDE-IDX) TO                        07590203
075903          TM001-INCL-TOT-CDE.                                     07590303
075904                                                                  07590404
075905     IF  TM001-INCL-IN-TOT                                        07590504
075906         SET WS-INCLUDE-IN-TOTAL TO TRUE                          07590604
075907     ELSE                                                         07590704
075908         NEXT SENTENCE.                                           07590804
075909                                                                  07590903
075910     IF  TM001-RESOLVED-IND = PC-RESOLVED                         07591003
075911     OR  TM001-RESOLVED-IND = PC-APPROVED                         07591103
075912         MOVE PC-B TO TM001-REPORT-RESOLVE-IND                    07591203
075913     ELSE                                                         07591303
075914         MOVE PC-A TO TM001-REPORT-RESOLVE-IND                    07591403
075915     END-IF.                                                      07591503
075916                                                                  07591603
075917     IF  TM001-RPT-AREA-DC                                        07591799
075918         MOVE TM001-OPER-UNT-ID TO                                07591899
075919              TM001-REPORT-OPER-UNT-ID                            07591999
075920     ELSE                                                         07592099
075921         MOVE ZEROS TO TM001-REPORT-OPER-UNT-ID.                  07592199
075922                                                                  07592203
075923     IF  TM001-TRBL-RSN-NOTIF                                     07592399
075924         MOVE PC-B TO TM001-REPORT-NOTIF-CDE                      07592499
075925     ELSE                                                         07592599
075926         MOVE PC-A TO TM001-REPORT-NOTIF-CDE                      07592699
075927     END-IF.                                                      07592703
075928                                                                  07592803
075929     IF  TM001-RPT-AREA-BUYING                                    07592903
075930         MOVE TM001-GMM-NBR TO                                    07593003
075940              PV-BSF-GMM-NBR                                      07594003
075941              TM001-REPORT-GMM-NBR                                07594199
075942         MOVE TM001-DMM-NBR TO                                    07594203
075943              PV-BSF-DMM-NBR                                      07594303
075944         MOVE TM001-BYR-NBR TO                                    07594403
075945              PV-BSF-BYR-NBR                                      07594503
075946         MOVE TM001-DEPT-NBR TO                                   07594603
075947              PV-BSF-DPT-NBR                                      07594703
075948         MOVE PV-BUYING-SORT-FIELD TO                             07594803
075949              TM001-SORT-FIELD                                    07594903
075950     ELSE                                                         07595003
075960         IF  TM001-RPT-AREA-ANALYST                               07596003
075970             MOVE PC-00 TO                                        07597099
075971                  TM001-REPORT-GMM-NBR                            07597199
075972             MOVE TM001-ANALYST-MGR-NBR TO                        07597203
075973                  PV-ASF-ANALYST-MGR-NBR                          07597303
075974             MOVE TM001-ANALYST-NBR TO                            07597403
075975                  PV-ASF-ANALYST-NBR                              07597503
075976             MOVE TM001-DEPT-NBR TO                               07597603
075977                  PV-BSF-DPT-NBR                                  07597703
075978             MOVE PV-ANALYST-SORT-FIELD TO                        07597803
075979                  TM001-SORT-FIELD                                07597903
075980         ELSE                                                     07598003
075990             IF  TM001-RPT-AREA-DC                                07599003
076000                 MOVE PC-00 TO                                    07600099
076001                      TM001-REPORT-GMM-NBR                        07600199
076002                 MOVE TM001-OPER-UNT-ID TO                        07600203
076003                      PV-DSF-DC-NBR                               07600303
076004                 MOVE TM001-FCLTY-AREA-ID TO                      07600499
076005                      PV-DSF-PROCESS-AREA                         07600599
076006                 MOVE PV-DC-SORT-FIELD TO                         07600603
076007                      TM001-SORT-FIELD                            07600703
076008             ELSE                                                 07600803
076009                 IF  TM001-RPT-AREA-VENDOR                        07600903
076010                     MOVE PC-00 TO                                07601099
076011                          TM001-REPORT-GMM-NBR                    07601199
076012                     MOVE TM001-ENT-ID TO                         07601203
076013                          PV-VSF-VND-NBR                          07601303
076014                     MOVE TM001-DEPT-NBR TO                       07601403
076015                          PV-VSF-DPT-NBR                          07601503
076016                     MOVE PV-VENDOR-SORT-FIELD TO                 07601603
076017                          TM001-SORT-FIELD                        07601703
076018                 ELSE                                             07601803
076019                     MOVE SPACES TO                               07601903
076020                          TM001-SORT-FIELD                        07602003
076021                     MOVE '99' TO                                 07602103
076022                          TM001-SORT-FIELD                        07602203
076023                 END-IF                                           07602303
076024             END-IF                                               07602403
076025         END-IF                                                   07602503
076026     END-IF.                                                      07602603
076027                                                                  07602799
076028     IF TM001-OPER-UNT-ID  = PV-PREV-STORE-NBR                    07602899
076029         CONTINUE                                                 07602999
076030     ELSE                                                         07603099
076040         PERFORM 2420-SEARCH-STORE-TABLE                          07604099
076050         MOVE TM001-OPER-UNT-ID       TO PV-PREV-STORE-NBR        07605099
076060     END-IF.                                                      07606099
076061     MOVE PV-SAVE-STR-TYP-CDE        TO TM001-STR-TYP-CDE         07606199
076062                                                                  07606203
076063     IF TM001-RECORD-TYPE-DETAIL AND                              07606303
076064         TM001-TRBL-RSN-TROUBLE AND                               07606403
076065         (TM001-RESOLVED-IND = PC-RESOLVED OR PC-APPROVED) AND    07606503
076066         TM001-TRBL-RSN-CDE = PV-PREV-TRBL-RSN-CDE                07606699
076067         ADD +1 TO PA-NBR-OF-RESOLVED-TRBLS                       07606703
076068         ADD TM001-RESOLVED-HOURS TO PA-RESOLVE-HOURS             07606803
076069         ADD TM001-RESOLVED-MINUTES TO PA-RESOLVE-MINUTES         07606903
076070     END-IF.                                                      07607003
076071                                                                  07607103
076072     PERFORM 8000-WRITE-OUTPUT-FILE.                              07607203
076073                                                                  07607303
076074***************************************************************** 07607499
076075* GET THE TYPE CODE FOR THE STORE WHICH IS ASSOCIATED TO THE    * 07607599
076076* CURRENT TROUBLE REASON CODE                                   * 07607699
076077***************************************************************** 07607799
076078 2420-SEARCH-STORE-TABLE.                                         07607899
076079                                                                  07607999
076080     SET STR-IDX TO +1.                                           07608099
076090     MOVE TM001-OPER-UNT-ID         TO PV-SEARCH-STORE-NUM.       07609099
076100     MOVE PV-SEARCH-STORE-NUM       TO PV-SEARCH-STORE-X.         07610099
076200                                                                  07620099
076300     PERFORM UNTIL WS-ST-STR-NBR (STR-IDX) = PV-SEARCH-STORE-X    07630099
076400                OR STR-IDX > STR-PROCESS-IDX                      07640099
076500         SET STR-IDX UP BY +1                                     07650099
076600     END-PERFORM.                                                 07660099
076700                                                                  07670099
076800     IF WS-ST-STR-NBR (STR-IDX) = PV-SEARCH-STORE-X               07680099
076900         MOVE WS-ST-TYP-CDE (STR-IDX) TO PV-SAVE-STR-TYP-CDE      07690099
077000     ELSE                                                         07700099
077100         PERFORM 2430-SELECT-STORE-TYPE-CODE                      07710099
077200         SET STR-PROCESS-IDX UP BY +1                             07720099
077300         IF STR-PROCESS-IDX > WS-ST-TABLE-MAX                     07730099
077400             DISPLAY '***********************************'        07740099
077500             DISPLAY '* TABLE OVERFLOW ON STORE TABLE   *'        07750099
077600             DISPLAY '* OVER 400 OCCURRANCES            *'        07760099
077700             DISPLAY '* RUN ABORTED                     *'        07770099
077800             DISPLAY '***********************************'        07780099
077900             MOVE 4001  TO PV-ABEND-CODE                          07790099
078000             PERFORM 9999-ABORT                                   07800099
078100         ELSE                                                     07810099
078200                                                                  07820099
078300             MOVE PV-SEARCH-STORE-X                               07830099
078400                        TO WS-ST-STR-NBR (STR-PROCESS-IDX)        07840099
078500             MOVE XLT00010-LOC-TYP-CDE                            07850099
078600                        TO WS-ST-TYP-CDE (STR-PROCESS-IDX)        07860099
078700                           PV-SAVE-STR-TYP-CDE                    07870099
078800             DISPLAY 'ADDING STORE # ' PV-SEARCH-STORE-X          07880099
078900             DISPLAY '     TYPE CODE ' XLT00010-LOC-TYP-CDE       07890099
079000         END-IF                                                   07900099
079100     END-IF.                                                      07910099
079200                                                                  07920099
079300***************************************************************** 07930099
079400* SELECT THE TYPE CODE FROM THE XLT-LOC TABLE                   * 07940099
079500***************************************************************** 07950099
079501 2430-SELECT-STORE-TYPE-CODE.                                     07950199
079502                                                                  07950203
079503     EXEC SQL                                                     07950399
079504         SELECT LOC_TYP_CDE                                       07950499
079505           INTO :XLT00010-LOC-TYP-CDE                             07950599
079506           FROM XLT_LOC                                           07950699
079507         WHERE LOC_NBR     = :TM001-OPER-UNT-ID                   07950799
079508     END-EXEC.                                                    07950899
079509                                                                  07950900
079510     EVALUATE TRUE                                                07951000
079511        WHEN SQLCODE = ZERO                                       07951100
079512             CONTINUE                                             07951200
079513        WHEN OTHER                                                07951300
079514             MOVE '2430-SELECT-STORE-TYPE-CODE' TO                07951400
079515                  PV-ABEND-PARA-NAME                              07951500
079516             MOVE 'SELECT'            TO PV-DB2-OPERATION-MSG-1   07951600
079517             MOVE 'XLT_LOC'           TO PV-DB2-TABLE-NAME        07951700
079518             PERFORM 9998-SQL-ABEND   THRU 9998-EXIT              07951800
079519     END-EVALUATE.                                                07951900
079520 EJECT                                                            07952000
079530 2500-ACCUM-BY-DC.                                                07953099
079540                                                                  07954099
079550     SET WS-DC-SEARCH-INCOMPLETE TO TRUE.                         07955099
079560                                                                  07956099
079570     PERFORM 2510-SEARCH-DC-TABLE                                 07957099
079580         VARYING DCT-IDX FROM 1 BY 1                              07958099
079590***CHG0147850 START                                               07959099
079591***CHG0161065 START                                               07959199
079600         UNTIL DCT-IDX > 500                                      07960099
079700***CHG0161065 END                                                 07970099
079710***CHG0147850 END                                                 07971099
079800            OR WS-DC-SEARCH-COMPLETE.                             07980099
079900                                                                  07990099
080000     IF  WS-DC-SEARCH-COMPLETE                                    08000099
080100         ADD +1 TO WS-DCT-ALL-TRBL-TOTAL (DCT-PROCESS-IDX)        08010099
080200         IF  TM001-TRBL-RSN-NOTIF                                 08020099
080300             ADD +1 TO WS-DCT-NOTIFY-TOTAL (DCT-PROCESS-IDX)      08030099
080400         ELSE                                                     08040099
080500             IF  TM001-TRBL-RSN-TROUBLE                           08050099
080600                 ADD +1 TO WS-DCT-TROUBLE-TOTAL (DCT-PROCESS-IDX) 08060099
080700             ELSE                                                 08070099
080800                 NEXT SENTENCE                                    08080099
080900     ELSE                                                         08090099
081000***CHG0147850 START                                               08100099
081010***CHG0161065 START                                               08101099
081100         IF  DCT-MAX-IDX = 500                                    08110099
081200***CHG0161065 END                                                 08120099
081210***CHG0147850 END                                                 08121099
081300             DISPLAY '***********************************'        08130099
081400             DISPLAY 'TABLE OVERFLOW ON   '                       08140099
081500***CHG0147850 START                                               08150099
081510***CHG0161065 START                                               08151099
081600             DISPLAY 'DC TABLE - OVER 500 OCCURS         '        08160099
081700***CHG0161065 END                                                 08170099
081710***CHG0147850 END                                                 08171099
081800             DISPLAY 'RUN ABORTED'                                08180099
081900             DISPLAY '***********************************'        08190099
082000             MOVE 4001  TO PV-ABEND-CODE                          08200099
082100             PERFORM 9999-ABORT                                   08210099
082200         ELSE                                                     08220099
082300             SET DCT-PROCESS-IDX TO DCT-MAX-IDX                   08230099
082400             MOVE TM001-OPER-UNT-ID TO                            08240099
082500                  WS-DCT-OPER-UNIT-ID (DCT-PROCESS-IDX)           08250099
082600             ADD +1 TO WS-DCT-ALL-TRBL-TOTAL (DCT-PROCESS-IDX)    08260099
082700             IF  TM001-TRBL-RSN-NOTIF                             08270099
082800                 ADD +1 TO WS-DCT-NOTIFY-TOTAL (DCT-PROCESS-IDX)  08280099
082900             ELSE                                                 08290099
083000                 IF  TM001-TRBL-RSN-TROUBLE                       08300099
083100                     ADD +1 TO                                    08310099
083200                         WS-DCT-TROUBLE-TOTAL (DCT-PROCESS-IDX)   08320099
083300                 ELSE                                             08330099
083400                     NEXT SENTENCE                                08340099
083500                 END-IF                                           08350099
083600             END-IF                                               08360099
083700             SET DCT-MAX-IDX UP BY 1.                             08370099
083800                                                                  08380099
083900                                                                  08390099
084000 2510-SEARCH-DC-TABLE.                                            08400099
084100                                                                  08410099
084200     IF  TM001-OPER-UNT-ID = WS-DCT-OPER-UNIT-ID (DCT-IDX)        08420099
084300         SET DCT-PROCESS-IDX TO DCT-IDX                           08430099
084400         SET WS-DC-SEARCH-COMPLETE TO TRUE                        08440099
084500     ELSE                                                         08450099
084600         NEXT SENTENCE.                                           08460099
084700                                                                  08470099
084701                                                                  08470199
084702 EJECT                                                            08470200
084703                                                                  08470399
084704 5000-CALC-AVG-RESOLVE-TIME.                                      08470499
084705                                                                  08470500
084706     INITIALIZE RTR-AVG-RESOLVE-HRS                               08470600
084707                RTR-AVG-RESOLVE-MINS.                             08470700
084708     IF PA-RESOLVE-HOURS = ZERO AND                               08470800
084709        PA-RESOLVE-MINUTES = ZEROS AND                            08470900
084710        PA-NBR-OF-RESOLVED-TRBLS = ZERO                           08471000
084711         MOVE ZERO TO PV-AVG-TOT-HOURS                            08471100
084712         MOVE ZERO TO PV-AVG-TOT-MINUTES                          08471200
084713     ELSE                                                         08471300
084714         MULTIPLY 60 BY PA-RESOLVE-HOURS                          08471400
084715         ADD PA-RESOLVE-HOURS TO PA-RESOLVE-MINUTES               08471500
084716         DIVIDE PA-RESOLVE-MINUTES BY PA-NBR-OF-RESOLVED-TRBLS    08471600
084717               GIVING PV-AVG-MINUTES ROUNDED                      08471700
084718               ON SIZE ERROR                                      08471800
084719                    MOVE  ZERO TO PV-AVG-MINUTES                  08471900
084720         END-DIVIDE                                               08472000
084721                                                                  08472100
084722         DIVIDE PV-AVG-MINUTES BY 60                              08472200
084723             GIVING PV-AVG-TOT-HOURS                              08472300
084724             REMAINDER PV-AVG-TOT-MINUTES                         08472400
084725             ON SIZE ERROR                                        08472500
084726             MOVE ZERO TO PV-AVG-TOT-HOURS                        08472600
084727                          PV-AVG-TOT-MINUTES                      08472700
084728         END-DIVIDE                                               08472800
084729     END-IF.                                                      08472900
084730                                                                  08473000
084731     MOVE PV-AVG-TOT-HOURS TO RTR-AVG-RESOLVE-HRS.                08473100
084732     MOVE PV-AVG-TOT-MINUTES TO RTR-AVG-RESOLVE-MINS.             08473200
084733                                                                  08473300
084734     INITIALIZE PA-RESOLVE-HOURS                                  08473400
084735                PA-RESOLVE-MINUTES                                08473500
084736                PA-NBR-OF-RESOLVED-TRBLS                          08473600
084737                PV-AVG-MINUTES                                    08473700
084738                PV-AVG-TOT-HOURS                                  08473800
084739                PV-AVG-TOT-MINUTES.                               08473900
084740                                                                  08474000
084750                                                                  08475000
084760 6000-WRITE-TOTAL-RECORD.                                         08476099
084770                                                                  08477099
084780     IF  CC-TOTAL-FOR-TRBL-ASSIGN                                 08478099
084790         MOVE WS-ASSIGNED-TOTAL TO                                08479099
084800              ATR-TOT-QTY                                         08480099
084900         MOVE PC-AM TO                                            08490099
085000              ATR-RECORD-TYPE                                     08500099
085100         MOVE PC-AA TO                                            08510099
085200              ATR-REPORT-DIVISION                                 08520099
085300         MOVE PC-A TO ATR-REPORT-NOTIF-CDE                        08530099
085400         MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID                     08540099
085401         MOVE PC-00 TO ATR-REPORT-GMM-NBR                         08540199
085402         WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                       08540206
085403               WS-ASSIGN-TOTAL-RECORD                             08540399
085404     ELSE                                                         08540499
085405         IF  CC-TOTAL-FOR-TRBL-NOTIFY                             08540599
085406             MOVE WS-ASSIGNED-TRBL-TOTAL TO                       08540699
085407                  ATR-TOT-QTY                                     08540799
085408             MOVE PC-AM TO                                        08540899
085409                  ATR-RECORD-TYPE                                 08540999
085410             MOVE PC-AA TO                                        08541099
085420                  ATR-REPORT-DIVISION                             08542099
085430             MOVE PC-A TO ATR-REPORT-NOTIF-CDE                    08543099
085440             MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID                 08544099
085450             MOVE PC-00 TO ATR-REPORT-GMM-NBR                     08545099
085460             WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                   08546099
085470                   WS-ASSIGN-TOTAL-RECORD                         08547099
085480             MOVE WS-ASSIGNED-NOTIFY-TOTAL TO                     08548099
085490                  ATR-TOT-QTY                                     08549099
085500             MOVE PC-AM TO                                        08550099
085600                  ATR-RECORD-TYPE                                 08560099
085700             MOVE PC-AA TO                                        08570099
085800                  ATR-REPORT-DIVISION                             08580099
085900             MOVE PC-B TO ATR-REPORT-NOTIF-CDE                    08590099
086000             MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID                 08600099
086100             MOVE PC-00 TO ATR-REPORT-GMM-NBR                     08610099
086200             WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                   08620099
086300                   WS-ASSIGN-TOTAL-RECORD                         08630099
086400         END-IF                                                   08640099
086500     END-IF.                                                      08650099
086600                                                                  08660099
086700     IF  CC-TOTAL-TRBL-ASSIGN-DIV                                 08670099
086800         MOVE WS-ASSIGNED-TOT-MDSE-DIV TO                         08680099
086900              ATR-TOT-QTY                                         08690099
087000         MOVE PC-AG TO                                            08700099
087100              ATR-RECORD-TYPE                                     08710099
087200         MOVE PC-DD TO                                            08720099
087300              ATR-REPORT-DIVISION                                 08730099
087400         MOVE PC-A TO ATR-REPORT-NOTIF-CDE                        08740099
087500         MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID                     08750099
087600         MOVE PC-00 TO ATR-REPORT-GMM-NBR                         08760099
087700         WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                       08770099
087800               WS-ASSIGN-TOTAL-RECORD                             08780099
087900         IF  CC-PROCESS-BY-GMM                                    08790099
088000             PERFORM 6110-CREATE-BY-GMM                           08800099
088100         ELSE                                                     08810099
088200             MOVE WS-ASSIGNED-TOT-BUY-DIV TO                      08820099
088300                  ATR-TOT-QTY                                     08830099
088400             MOVE PC-AF TO                                        08840099
088500                  ATR-RECORD-TYPE                                 08850099
088600             MOVE PC-BB TO                                        08860099
088700                  ATR-REPORT-DIVISION                             08870099
088800             MOVE PC-A TO ATR-REPORT-NOTIF-CDE                    08880099
088900             MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID                 08890099
089000             MOVE PC-00 TO ATR-REPORT-GMM-NBR                     08900099
089100             WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                   08910099
089200                   WS-ASSIGN-TOTAL-RECORD                         08920099
089300         END-IF                                                   08930099
089400         IF  CC-PROCESS-BY-DC                                     08940099
089500             PERFORM 6010-CREATE-BY-DC                            08950099
089600         ELSE                                                     08960099
089700             MOVE WS-ASSIGNED-TOT-DC-DIV TO                       08970099
089800                  ATR-TOT-QTY                                     08980099
089900             MOVE PC-AI TO                                        08990099
090000                  ATR-RECORD-TYPE                                 09000099
090100             MOVE PC-HH TO                                        09010099
090200                  ATR-REPORT-DIVISION                             09020099
090300             MOVE PC-A TO ATR-REPORT-NOTIF-CDE                    09030099
090400             MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID                 09040099
090500             MOVE PC-00 TO ATR-REPORT-GMM-NBR                     09050099
090600             WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                   09060099
090700                   WS-ASSIGN-TOTAL-RECORD                         09070099
090800         END-IF                                                   09080099
090900         MOVE WS-ASSIGNED-TOT-VEND-DIV TO                         09090099
091000              ATR-TOT-QTY                                         09100099
091100         MOVE PC-AK TO                                            09110099
091200              ATR-RECORD-TYPE                                     09120099
091300         MOVE PC-LL TO                                            09130099
091400              ATR-REPORT-DIVISION                                 09140099
091500         MOVE PC-A TO ATR-REPORT-NOTIF-CDE                        09150099
091600         MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID                     09160099
091700         MOVE PC-00 TO ATR-REPORT-GMM-NBR                         09170099
091800         WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                       09180099
091900               WS-ASSIGN-TOTAL-RECORD                             09190099
092000     ELSE                                                         09200099
092100         IF  CC-TOTAL-FOR-TRBL-NOTIFY-DIV                         09210099
092200             MOVE WS-TROUBLE-TOT-MDSE-DIV TO                      09220099
092300                  ATR-TOT-QTY                                     09230099
092400             MOVE PC-AG TO                                        09240099
092500                  ATR-RECORD-TYPE                                 09250099
092600             MOVE PC-DD TO                                        09260099
092700                  ATR-REPORT-DIVISION                             09270099
092800             MOVE PC-A TO ATR-REPORT-NOTIF-CDE                    09280099
092900             MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID                 09290099
093000             MOVE PC-00 TO ATR-REPORT-GMM-NBR                     09300099
093100             WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                   09310099
093200                   WS-ASSIGN-TOTAL-RECORD                         09320099
093300             MOVE WS-NOTIFY-TOT-MDSE-DIV TO                       09330099
093400                  ATR-TOT-QTY                                     09340099
093500             MOVE PC-AG TO                                        09350099
093600                  ATR-RECORD-TYPE                                 09360099
093700             MOVE PC-DD TO                                        09370099
093800                  ATR-REPORT-DIVISION                             09380099
093900             MOVE PC-B TO ATR-REPORT-NOTIF-CDE                    09390099
094000             MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID                 09400099
094100             MOVE PC-00 TO ATR-REPORT-GMM-NBR                     09410099
094200             WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                   09420099
094300                   WS-ASSIGN-TOTAL-RECORD                         09430099
094400             IF  CC-PROCESS-BY-GMM                                09440099
094500                 PERFORM 6110-CREATE-BY-GMM                       09450099
094600             ELSE                                                 09460099
094700                 MOVE WS-TROUBLE-TOT-BUY-DIV TO                   09470099
094800                      ATR-TOT-QTY                                 09480099
094900                 MOVE PC-AF TO                                    09490099
095000                      ATR-RECORD-TYPE                             09500099
095100                 MOVE PC-BB TO                                    09510099
095200                      ATR-REPORT-DIVISION                         09520099
095300                 MOVE PC-A TO ATR-REPORT-NOTIF-CDE                09530099
095400                 MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID             09540099
095500                 MOVE PC-00 TO ATR-REPORT-GMM-NBR                 09550099
095600                 WRITE TE-TRBL-EXTRACT-RCD-OUT FROM               09560099
095700                       WS-ASSIGN-TOTAL-RECORD                     09570099
095800                 MOVE WS-NOTIFY-TOT-BUY-DIV TO                    09580099
095900                      ATR-TOT-QTY                                 09590099
096000                 MOVE PC-AF TO                                    09600099
096100                      ATR-RECORD-TYPE                             09610099
096200                 MOVE PC-BB TO                                    09620099
096300                      ATR-REPORT-DIVISION                         09630099
096400                 MOVE PC-A TO ATR-REPORT-NOTIF-CDE                09640099
096500                 MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID             09650099
096600                 MOVE PC-00 TO ATR-REPORT-GMM-NBR                 09660099
096700                 WRITE TE-TRBL-EXTRACT-RCD-OUT FROM               09670099
096800                       WS-ASSIGN-TOTAL-RECORD                     09680099
096900             END-IF                                               09690099
097000             IF  CC-PROCESS-BY-DC                                 09700099
097100                 PERFORM 6010-CREATE-BY-DC                        09710099
097200             ELSE                                                 09720099
097300                 MOVE WS-TROUBLE-TOT-DC-DIV TO                    09730099
097400                      ATR-TOT-QTY                                 09740099
097500                 MOVE PC-AI TO                                    09750099
097600                      ATR-RECORD-TYPE                             09760099
097700                 MOVE PC-HH TO                                    09770099
097800                      ATR-REPORT-DIVISION                         09780099
097900                 MOVE PC-A TO ATR-REPORT-NOTIF-CDE                09790099
098000                 MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID             09800099
098100                 MOVE PC-00 TO ATR-REPORT-GMM-NBR                 09810099
098200                 WRITE TE-TRBL-EXTRACT-RCD-OUT FROM               09820099
098300                       WS-ASSIGN-TOTAL-RECORD                     09830099
098400                 MOVE WS-NOTIFY-TOT-DC-DIV TO                     09840099
098500                      ATR-TOT-QTY                                 09850099
098600                 MOVE PC-AI TO                                    09860099
098700                      ATR-RECORD-TYPE                             09870099
098800                 MOVE PC-HH TO                                    09880099
098900                      ATR-REPORT-DIVISION                         09890099
099000                 MOVE PC-B TO ATR-REPORT-NOTIF-CDE                09900099
099100                 MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID             09910099
099200                 MOVE PC-00 TO ATR-REPORT-GMM-NBR                 09920099
099300                 WRITE TE-TRBL-EXTRACT-RCD-OUT FROM               09930099
099400                       WS-ASSIGN-TOTAL-RECORD                     09940099
099500             END-IF                                               09950099
099600             MOVE WS-TROUBLE-TOT-VEND-DIV TO                      09960099
099700                  ATR-TOT-QTY                                     09970099
099800             MOVE PC-AK TO                                        09980099
099900                  ATR-RECORD-TYPE                                 09990099
100000             MOVE PC-LL TO                                        10000099
100100                  ATR-REPORT-DIVISION                             10010099
100200             MOVE PC-A TO ATR-REPORT-NOTIF-CDE                    10020099
100300             MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID                 10030099
100400             MOVE PC-00 TO ATR-REPORT-GMM-NBR                     10040099
100500             WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                   10050099
100600                   WS-ASSIGN-TOTAL-RECORD                         10060099
100700             MOVE WS-NOTIFY-TOT-VEND-DIV TO                       10070099
100800                  ATR-TOT-QTY                                     10080099
100900             MOVE PC-AK TO                                        10090099
101000                  ATR-RECORD-TYPE                                 10100099
101100             MOVE PC-LL TO                                        10110099
101200                  ATR-REPORT-DIVISION                             10120099
101300             MOVE PC-B TO ATR-REPORT-NOTIF-CDE                    10130099
101400             MOVE ZEROS TO ATR-REPORT-OPER-UNT-ID                 10140099
101500             MOVE PC-00 TO ATR-REPORT-GMM-NBR                     10150099
101600             WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                   10160099
101700                   WS-ASSIGN-TOTAL-RECORD                         10170099
101800         END-IF                                                   10180099
101900     END-IF.                                                      10190099
102000                                                                  10200099
102100                                                                  10210099
102200 6010-CREATE-BY-DC.                                               10220099
102300                                                                  10230099
102400      PERFORM 6020-FORMAT-AND-WRITE                               10240099
102500          VARYING DCT-IDX FROM 1 BY 1                             10250099
102600          UNTIL   DCT-IDX > DCT-MAX-IDX.                          10260099
102700                                                                  10270099
102800                                                                  10280099
102900 6020-FORMAT-AND-WRITE.                                           10290099
103000                                                                  10300099
103100     IF  WS-DCT-OPER-UNIT-ID (DCT-IDX) = 0                        10310099
103200     AND WS-DCT-ALL-TRBL-TOTAL (DCT-IDX) = 0                      10320099
103300         NEXT SENTENCE                                            10330099
103400     ELSE                                                         10340099
103500         IF  CC-TOTAL-TRBL-ASSIGN-DIV                             10350099
103600             MOVE WS-DCT-OPER-UNIT-ID (DCT-IDX) TO                10360099
103700                  DCATR-DC-NBR                                    10370099
103800                  DCATR-REPORT-OPER-UNT-ID                        10380099
103900             MOVE WS-DCT-ALL-TRBL-TOTAL (DCT-IDX) TO              10390099
104000                  DCATR-TOT-QTY                                   10400099
104100             MOVE PC-A TO DCATR-REPORT-NOTIF-CDE                  10410099
104200             MOVE PC-00 TO DCATR-REPORT-GMM-NBR                   10420099
104300             WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                   10430099
104400                   WS-DC-ASSIGN-TOTAL-RECORD                      10440099
104500         ELSE                                                     10450099
104600             IF  CC-TOTAL-FOR-TRBL-NOTIFY-DIV                     10460099
104700                 MOVE WS-DCT-OPER-UNIT-ID (DCT-IDX) TO            10470099
104800                      DCATR-DC-NBR                                10480099
104900                      DCATR-REPORT-OPER-UNT-ID                    10490099
105000                 MOVE WS-DCT-TROUBLE-TOTAL (DCT-IDX) TO           10500099
105100                      DCATR-TOT-QTY                               10510099
105200                 MOVE PC-A TO DCATR-REPORT-NOTIF-CDE              10520099
105300                 MOVE PC-00 TO DCATR-REPORT-GMM-NBR               10530099
105400                 WRITE TE-TRBL-EXTRACT-RCD-OUT FROM               10540099
105500                       WS-DC-ASSIGN-TOTAL-RECORD                  10550099
105600                 MOVE WS-DCT-OPER-UNIT-ID (DCT-IDX) TO            10560099
105700                      DCATR-DC-NBR                                10570099
105800                      DCATR-REPORT-OPER-UNT-ID                    10580099
105900                 MOVE WS-DCT-NOTIFY-TOTAL (DCT-IDX) TO            10590099
106000                      DCATR-TOT-QTY                               10600099
106100                 MOVE PC-B TO DCATR-REPORT-NOTIF-CDE              10610099
106200                 MOVE PC-00 TO DCATR-REPORT-GMM-NBR               10620099
106300                 WRITE TE-TRBL-EXTRACT-RCD-OUT FROM               10630099
106400                       WS-DC-ASSIGN-TOTAL-RECORD                  10640099
106500             ELSE                                                 10650099
106600                 NEXT SENTENCE.                                   10660099
106700                                                                  10670099
106800                                                                  10680099
106900 6110-CREATE-BY-GMM.                                              10690099
107000                                                                  10700099
107100      PERFORM 6120-FORMAT-AND-WRITE                               10710099
107200          VARYING GMMT-IDX FROM 1 BY 1                            10720099
107300          UNTIL   GMMT-IDX > GMMT-MAX-IDX.                        10730099
107400                                                                  10740099
107500                                                                  10750099
107600 6120-FORMAT-AND-WRITE.                                           10760099
107700                                                                  10770099
107800     IF  WS-GMMT-GMM-NBR (GMMT-IDX) = SPACES                      10780099
107900*    OR  WS-GMMT-GMM-NBR (GMMT-IDX) = PC-00)                      10790099
108000     AND WS-GMMT-ALL-TRBL-TOTAL (GMMT-IDX) = 0                    10800099
108100         NEXT SENTENCE                                            10810099
108200     ELSE                                                         10820099
108300         IF  CC-TOTAL-TRBL-ASSIGN-DIV                             10830099
108400             MOVE WS-GMMT-GMM-NBR (GMMT-IDX) TO                   10840099
108500                  GMMATR-GMM-NBR                                  10850099
108600                  GMMATR-REPORT-GMM-NBR                           10860099
108700             MOVE WS-GMMT-GMM-NAME (GMMT-IDX) TO                  10870099
108800                  GMMATR-GMM-NAME                                 10880099
108900             MOVE ZEROS TO GMMATR-REPORT-OPER-UNT-ID              10890099
109000             MOVE WS-GMMT-ALL-TRBL-TOTAL (GMMT-IDX) TO            10900099
109100                  GMMATR-TOT-QTY                                  10910099
109200             MOVE PC-A TO GMMATR-REPORT-NOTIF-CDE                 10920099
109300             WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                   10930099
109400                   WS-GMM-ASSIGN-TOTAL-RECORD                     10940099
109500         ELSE                                                     10950099
109600             IF  CC-TOTAL-FOR-TRBL-NOTIFY-DIV                     10960099
109700                 MOVE WS-GMMT-GMM-NBR (GMMT-IDX) TO               10970099
109800                      GMMATR-GMM-NBR                              10980099
109900                      GMMATR-REPORT-GMM-NBR                       10990099
110000                 MOVE WS-GMMT-GMM-NAME (GMMT-IDX) TO              11000099
110100                      GMMATR-GMM-NAME                             11010099
110200                 MOVE ZEROS TO GMMATR-REPORT-OPER-UNT-ID          11020099
110300                 MOVE WS-GMMT-TROUBLE-TOTAL (GMMT-IDX) TO         11030099
110400                      GMMATR-TOT-QTY                              11040099
110500                 MOVE PC-A TO GMMATR-REPORT-NOTIF-CDE             11050099
110600                 WRITE TE-TRBL-EXTRACT-RCD-OUT FROM               11060099
110700                       WS-GMM-ASSIGN-TOTAL-RECORD                 11070099
110800                 MOVE WS-GMMT-GMM-NBR (GMMT-IDX) TO               11080099
110900                      GMMATR-GMM-NBR                              11090099
111000                      GMMATR-REPORT-GMM-NBR                       11100099
111100                 MOVE WS-GMMT-GMM-NAME (GMMT-IDX) TO              11110099
111200                      GMMATR-GMM-NAME                             11120099
111300                 MOVE ZEROS TO GMMATR-REPORT-OPER-UNT-ID          11130099
111400                 MOVE WS-GMMT-NOTIFY-TOTAL (GMMT-IDX) TO          11140099
111500                      GMMATR-TOT-QTY                              11150099
111600                 MOVE PC-B TO GMMATR-REPORT-NOTIF-CDE             11160099
111700                 WRITE TE-TRBL-EXTRACT-RCD-OUT FROM               11170099
111800                       WS-GMM-ASSIGN-TOTAL-RECORD                 11180099
111900             ELSE                                                 11190099
112000                 NEXT SENTENCE.                                   11200099
112001                                                                  11200199
112002 EJECT                                                            11200200
112003 7000-READ-INPUT-FILE.                                            11200300
112004                                                                  11200400
112005      READ EXTRACT-TRBL-FILE-IN INTO                              11200500
112006           TM001-TROUBLE-EXT-RECORD                               11200600
112007      AT END                                                      11200700
112008           SET PS-EOF TO TRUE                                     11200800
112009      END-READ.                                                   11200900
112010                                                                  11201000
112011      IF  PS-EOF                                                  11201100
112012          NEXT SENTENCE                                           11201200
112013      ELSE                                                        11201300
112014          ADD +1 TO WS-RCD-READ-COUNT                             11201400
112015      END-IF.                                                     11201500
112016                                                                  11201600
112017                                                                  11201700
112018 8000-WRITE-OUTPUT-FILE.                                          11201800
112019                                                                  11201900
112020     IF TM001-RECORD-TYPE-DETAIL AND                              11202000
112030        CC-NO-WRITE-DETAIL                                        11203000
112040         ADD +1 TO  WS-RCD-BYPASS-COUNT                           11204099
112041     ELSE                                                         11204199
112042         WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                       11204200
112043               TM001-TROUBLE-EXT-RECORD                           11204300
112044                                                                  11204406
112045         ADD +1 TO WS-RCD-DTL-WRITE-COUNT                         11204506
112046     END-IF.                                                      11204600
112047                                                                  11204700
112048 9000-END-OF-PROGRAM.                                             11204800
112049                                                                  11204900
112050     IF  WS-TRBL-RSN-CDE-VALID                                    11205099
112060         PERFORM 2310-WRITE-RSN-TOTAL-RECORD                      11206099
112070     ELSE                                                         11207099
112080         NEXT SENTENCE                                            11208099
112081     END-IF.                                                      11208199
112082                                                                  11208200
112083     PERFORM 6000-WRITE-TOTAL-RECORD.                             11208399
112084                                                                  11208400
112085     CLOSE EXTRACT-TRBL-FILE-IN                                   11208500
112086           EXTRACT-TRBL-FILE-OUT.                                 11208600
112087                                                                  11208799
112088     DISPLAY '** INPUT RECORDS READ =========== '                 11208899
112089             WS-RCD-READ-COUNT.                                   11208999
112090     DISPLAY '** INPUT RECORDS NOT WRITTEN ==== '                 11209099
112100             WS-RCD-BYPASS-COUNT.                                 11210099
112200     DISPLAY '** REASON TOTAL RECORDS WRITTEN = '                 11220099
112300             WS-RCD-RSNTOT-WRITE-COUNT.                           11230099
112400     DISPLAY '** INPUT RECORDS WRITTEN ======== '                 11240099
112500             WS-RCD-DTL-WRITE-COUNT.                              11250099
112600     DISPLAY ' '.                                                 11260099
112700     DISPLAY '** NUMBER OF RSN CODE TABLE ENTRIES = '             11270099
112800             WS-RSN-CDE-TBL-ENTRY.                                11280099
112900     DISPLAY ' '.                                                 11290099
113000     DISPLAY '** CONTROL CARD FOR THIS RUN IS = '                 11300099
113001             CC-CONTROL-CARD-PARAMETERS.                          11300199
113002 EJECT                                                            11300200
113003 9998-SQL-ABEND.                                                  11300300
113004     MOVE SQLCODE     TO PV-SQLCODE.                              11300400
113005     DISPLAY '** ABEND           ** = SQLABEND'.                  11300500
113006     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          11300600
113007     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARA-NAME        11300700
113008     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME.        11300800
113009     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MSG-1.   11300900
113010     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               11301000
113011     COPY DPPD004.                                                11301100
113012                                                                  11301200
113013     MOVE +4013                  TO PV-ABEND-CODE.                11301300
113014     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       11301400
113015 9998-EXIT.  EXIT.                                                11301500
113016                                                                  11301600
113017 9999-ABORT.                                                      11301700
113018                                                                  11301801
113019      DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE                    11301900
113020      CALL 'ILBOABN0'   USING PV-ABEND-CODE.                      11302000
113030                                                                  11303000
