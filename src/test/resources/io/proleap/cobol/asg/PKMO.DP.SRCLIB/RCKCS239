000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    RCKCS239.                                         00020000
000300 AUTHOR.        ANNE RECKNAGEL.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  03/30/94.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800*    TRANID      - E239                                         * 00080000
000900*    TYPE        - CICS ARCHITECTURE MAINTENANCE - DB2          * 00090000
001000*    DESCRIPTION - UPDATE A RECEIPT ITEM                        * 00100000
001100*    MAPSET      - RCKM239                                      * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM ALLOWS THE USER TO CHANGE INFORMATION ON THE  * 00130000
001400*    RECITM TABLE.  IT CAN BE ENTERED EITHER THROUGH THE WORK   * 00140000
001500*    ORDER SYSTEM OR THE TROUBLE SYSTEM.                        * 00150000
001510*---------------------------------------------------------------* 00151007
001520* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00152008
001530* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00153008
001540* MAKING THE CALL DYNAMIC VS STATIC.                              00154008
001550*---------------------------------------------------------------* 00155008
001600                                                                  00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800 DATA DIVISION.                                                   00180000
001900                                                                  00190000
002000 WORKING-STORAGE SECTION.                                         00200000
002100                                                                  00210000
002200 01  DK-DB2-KEYS.                                                 00220000
002300     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    00230000
002400     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    00240000
002500     05  DK-PO-LNE-NBR                PIC S9(9) COMP VALUE +0.    00250000
002600     05  DK-UNT-COST-AMT              PIC S9(4)V9(3) VALUE +0     00260000
002700                                                     COMP-3.      00270000
002800     05  DK-SEQ-NBR                   PIC S9(04) COMP-3.          00280000
002900     05  DK-TRIP-ID                   PIC S9(9) COMP VALUE +0.    00290000
003000     05  DK-OPER-UNT-ID               PIC S9(4) COMP VALUE +0.    00300000
003100                                                                  00310000
003200 01  PC-PROGRAM-CONSTANTS.                                        00320000
003300     05  PC-TRANS-ID                  PIC X(04)  VALUE 'E239'.    00330000
003400     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'RCKCS239'.00340000
003500     05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE 'RC239A  '.00350000
003600     05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE 'RCKM239 '.00360000
003700     05  PC-TROUBLE-RTN               PIC X(08)  VALUE 'TMKCS520'.00370000
003800     05  PC-TROUBLE-RTN-LENGTH        PIC S9(04) VALUE +600       00380000
003900                                                 COMP.            00390000
004000     05  PC-AUDIT-RTN                 PIC X(08) VALUE 'RCKCS290'. 00400000
004100     05  PC-APPL-MAP                  PIC S9(04) VALUE  +1        00410000
004200                                                 COMP.            00420000
004300     05  PC-WMS-CONTROL-MOD           PIC X(8)  VALUE  'WSKCS305'.00430000
004400*    05  PC-WMS-CONTROL-MOD-LENGTH    PIC S9(4) VALUE +125        00440000
004500*                                               COMP SYNC.        00450000
004600     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +3        00460000
004700                                                 COMP.            00470000
004800     05  PC-DEFAULT-TMST              PIC  X(26) VALUE            00480000
004900                             '9999-09-09-09.09.09.999999'.        00490000
005000     05  PC-1                         PIC S9(09) VALUE +1         00500000
005100                                                 COMP.            00510000
005200     05  PC-ACTIVE                    PIC X(01)  VALUE 'A'.       00520000
005300     05  PC-INACTIVE                  PIC X(01)  VALUE 'I'.       00530000
005400     05  PC-A                         PIC X(01)  VALUE 'A'.       00540000
005500     05  PC-F                         PIC X(01)  VALUE 'F'.       00550000
005600     05  PC-L                         PIC X(01)  VALUE 'L'.       00560000
005700     05  PC-R                         PIC X(01)  VALUE 'R'.       00570000
005800     05  PC-T                         PIC X(01)  VALUE 'T'.       00580000
005900     05  PC-U                         PIC X(01)  VALUE 'U'.       00590000
006000     05  PC-Y                         PIC X(01)  VALUE 'Y'.       00600000
006100     05  PC-AC                        PIC X(02)  VALUE 'AC'.      00610000
006200     05  PC-CM                        PIC X(02)  VALUE 'CM'.      00620000
006300     05  PC-DE                        PIC X(02)  VALUE 'DE'.      00630000
006400     05  PC-VE                        PIC X(02)  VALUE 'VE'.      00640000
006500     05  PC-IN                        PIC X(02)  VALUE 'IN'.      00650000
006600     05  PC-IP                        PIC X(02)  VALUE 'IP'.      00660000
006700     05  PC-01                        PIC X(02)  VALUE '01'.      00670000
006800     05  PC-DPKUT500                  PIC X(08)  VALUE 'DPKUT500'.00680000
006900     05  PC-INTER-APPL-CODES.                                     00690000
007000         10  PC-INTER-APPL-RCVG       PIC X(01)  VALUE '1'.       00700000
007100         10  PC-INTER-APPL-TRBL       PIC X(01)  VALUE '2'.       00710000
007200         10  PC-INTER-APPL-RCV-UPD    PIC X(01)  VALUE '3'.       00720000
007300         10  PC-INTER-APPL-RCV-DEL    PIC X(01)  VALUE '4'.       00730000
007400         10  PC-INTER-APPL-PREPK-RCVG PIC X(01)  VALUE '5'.       00740000
007500         10  PC-INTER-APPL-DELETE     PIC X(01)  VALUE 'D'.       00750000
007600     05  PC-DASH                      PIC X(01)  VALUE '-'.       00760000
007700     05  PC-X-000                     PIC 9(03)  VALUE 000.       00770000
007800     05  PC-X-999                     PIC 9(03)  VALUE 999.       00780000
007900     05  PC-999                       PIC 9(04)  VALUE 999.       00790000
008000     05  PC-1000                      PIC 9(04)  VALUE 1000.      00800000
008100     05  PC-8999                      PIC 9(04)  VALUE 8999.      00810000
008200     05  PC-9000                      PIC 9(04)  VALUE 9000.      00820000
008300     05  PC-MULTIPLE-MSG              PIC X(25)  VALUE            00830000
008400         'MULTIPLE TROUBLE EXISTS  '.                             00840000
008500                                                                  00850000
008600     05  PC-TSYMSG-NUMBERS.                                       00860000
008700         10  PC-TSYMSG-00005          PIC 9(05)  VALUE 00005.     00870000
008800*            INVALID VALUE                                        00880000
008900         10  PC-TSYMSG-00008          PIC 9(05)  VALUE 00008.     00890000
009000*            MUST BE NUMERIC                                      00900000
009100         10  PC-TSYMSG-00057          PIC 9(05)  VALUE 00057.     00910000
009200*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       00920000
009300         10  PC-TSYMSG-00059          PIC 9(05)  VALUE 00059.     00930000
009400*            UPDATE(S) SUCCESSFUL                                 00940000
009500         10  PC-TSYMSG-00069          PIC 9(05)  VALUE 00069.     00950000
009600*            TOP OF LIST                                          00960000
009700         10  PC-TSYMSG-00070          PIC 9(05)  VALUE 00070.     00970000
009800*            BOTTOM OF LIST                                       00980000
009900         10  PC-TSYMSG-00084          PIC 9(05)  VALUE 00084.     00990000
010000*            PURCHASE ORDER LINE DOES NOT EXIST                   01000000
010100         10  PC-TSYMSG-00115          PIC 9(05)  VALUE 00115.     01010000
010200*            DELETE SUCCESSFUL                                    01020000
010300         10  PC-TSYMSG-00116          PIC 9(05)  VALUE 00116.     01030000
010400*            CANNOT DELETE; DATA DOES NOT EXIST                   01040000
010500         10  PC-TSYMSG-00148          PIC 9(05)  VALUE 00148.     01050000
010600*            DATA DOES NOT EXIST                                  01060000
010700         10  PC-TSYMSG-00342          PIC 9(05)  VALUE 00342.     01070000
010800*            MUST BE NUMERIC AND > ZERO                           01080000
010900         10  PC-TSYMSG-00354          PIC 9(05)  VALUE 00354.     01090000
011000*            DELETE PENDING, PRESS F2 TO CONFIRM                  01100000
011100         10  PC-TSYMSG-00551          PIC 9(5)  VALUE 00551.      01110000
011200*            WAIT 15 SECONDS;RETRY FUNCTION AGAIN;IF UNSUCCESSFUL 01120000
011300*            CALL HELP DESK                                       01130000
011400         10  PC-TSYMSG-00808          PIC 9(05)  VALUE 00808.     01140000
011500*            PURCHASE ORDER LINE STATUS MUST BE ACTIVE OR APPROVED01150000
011600         10  PC-TSYMSG-00854          PIC 9(05)  VALUE 00854.     01160000
011700*            ITEM QTY CAN NOT BE ZERO                             01170000
011800         10  PC-TSYMSG-00889          PIC 9(05)  VALUE 00889.     01180000
011900*            STATUS MUST BE 'IP' OR 'CM' TO DELETE                01190000
012000         10  PC-TSYMSG-00890          PIC 9(05)  VALUE 00890.     01200000
012100*            PACK SLIPS EXIST; ONLY WORK ORDER INFO DELETED       01210000
012200         10  PC-TSYMSG-00891          PIC 9(05)  VALUE 00891.     01220000
012300*            PACK SLIPS EXIST; WORK ORDER DELETE; NO STR ALLOC    01230000
012400         10  PC-TSYMSG-00892          PIC 9(05)  VALUE 00892.     01240000
012500*            PACK SLIPS EXIST; WORK ORDER DELETE; STATUS UPDATED  01250000
012600         10  PC-TSYMSG-00928          PIC 9(05)  VALUE 00928.     01260000
012700*            REDISTRO PROCEDURE INVALID FOR A PACKED BY STORE RECE01270000
012800         10  PC-TSYMSG-00929          PIC 9(05)  VALUE 00929.     01280000
012900*            RECEIPT LINE HAS ALREADY BEEN VERIFIED               01290000
013000         10  PC-TSYMSG-00937          PIC 9(05)  VALUE 00937.     01300000
013100*            UNABLE TO REDISTRO DUE TO TROUBLE                    01310000
013200         10  PC-TSYMSG-00941          PIC 9(05)  VALUE 00941.     01320000
013300*            REDISTRO SUCCESSFUL BUT TROUBLE CREATED              01330000
013400         10  PC-TSYMSG-01256          PIC 9(05)  VALUE 01256.     01340000
013500* UPDATE NOT ALLOWED:ADJUSTMENTS HAVE BEEN MADE TO THE VERIFIED QU01350000
013600         10  PC-TSYMSG-01795          PIC 9(05)  VALUE 01795.     01360000
013700* CANNOT UPDATE DETAIL CHECK QTY - CASEPACK SPLIT PROCESS PERFORMD01370000
013800         10  PC-TSYMSG-01801          PIC 9(05)  VALUE 01801.     01380000
013900* CANNOT UPDATE INNER PACK QTY - CASEPACK SPLIT PROCESS PERFORMED 01390000
014000         10  PC-TSYMSG-02463          PIC 9(05)  VALUE 02463.     01400000
014100*            INVALID FUNCTION FOR PACKAGING CODE OF "M" OR "I"    01410000
014200         10  PC-TSYMSG-03355          PIC 9(05)  VALUE 03355.     01420000
014300* UNABLE TO UPDATE DETAIL CHECK QTY - 1 OR MORE CARTONS ARE ACTIVD01430000
014400         10  PC-TSYMSG-03537          PIC 9(5)  VALUE 03537.      01440000
014500*RECEIVING HAS BEGUN ON TRAILER - UNABLE IN INACTIVATE PACKSLIP   01450000
014600         10  PC-TSYMSG-03546          PIC 9(05)  VALUE 03546.     01460000
014700*RECEIVING HAS BEGUN ON TRAILER - CANNOT UPDATE DETAIL CHECK QTY  01470000
014800         10  PC-TSYMSG-03563          PIC 9(05)  VALUE 03563.     01480000
014900* ERROR IN WMS DOWNLOAD MODULE - CONTACT HELP DESK                01490000
015000         10  PC-TSYMSG-03138          PIC 9(05)  VALUE 03138.     01500000
015100* ERROR IN WMS DOWNLOAD MODULE - CONTACT HELP DESK                01510000
015200* JAK 05/2007 - ADD NEW MESSAGES FOR WMS                          01520008
015300         10  PC-TSYMSG-03568            PIC  9(05)  VALUE 03568.  01530001
015400*  REDISTRO SUCCESSFUL AND ASN WILL BE DOWNLOADED TO WMS          01540001
015500         10  PC-TSYMSG-03569            PIC  9(05)  VALUE 03569.  01550001
015600*  REDISTRO SUCCESSFUL, ASN WILL BE DWNLD TO WMS, BUT TROUBLE     01560001
015700         10  PC-TSYMSG-03578            PIC  9(05)  VALUE 03578.  01570001
015800*  DELETE SUCCESSFUL, AND WMOS UPDATE ACCORDINGLY                 01580001
015900* JAK 05/2007 - END                                               01590001
016000                                                                  01600000
016100                                                                  01610000
016200 01  PS-PROGRAM-SWITCHES.                                         01620000
016300     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       01630000
016400         88  PS-ERROR                            VALUE 'Y'.       01640000
016500         88  PS-NO-ERROR                         VALUE 'N'.       01650000
016600     05  PS-INACTIVATE-CARTONS-SW     PIC X(01)  VALUE 'N'.       01660000
016700         88  PS-INACTIVATE-CARTONS               VALUE 'Y'.       01670000
016800         88  PS-DONT-INACTIVATE-CARTONS          VALUE 'N'.       01680000
016900     05  PS-CHECKED-IN-FOUND-SW       PIC X(01)  VALUE 'N'.       01690000
017000         88  PS-CHECKED-IN-FOUND                 VALUE 'Y'.       01700000
017100         88  PS-NO-CHECKED-IN-FOUND              VALUE 'N'.       01710000
017200     05  PS-COMMAREA-SW               PIC X(01)  VALUE 'N'.       01720000
017300         88  PS-COMMAREA-VALID                   VALUE 'Y'.       01730000
017400         88  PS-COMMAREA-NOT-VALID               VALUE 'N'.       01740000
017500     05  PS-PKITEM-EXISTS-SW          PIC X(01)  VALUE 'N'.       01750000
017600         88  PS-PKITEM-FOUND                     VALUE 'Y'.       01760000
017700         88  PS-PKITEM-NOT-FOUND                 VALUE 'N'.       01770000
017800         88  PS-MULTI-PKITEM-FOUND               VALUE 'M'.       01780000
017900     05  PS-PURITM-EXISTS-SW          PIC X(01)  VALUE 'N'.       01790000
018000         88  PS-PURITM-FOUND                     VALUE 'Y'.       01800000
018100         88  PS-PURITM-NOT-FOUND                 VALUE 'N'.       01810000
018200     05  PS-UNPKSL-EXISTS-SW          PIC X(01)  VALUE 'N'.       01820000
018300         88  PS-UNPKSL-FOUND                     VALUE 'Y'.       01830000
018400         88  PS-UNPKSL-NOT-FOUND                 VALUE 'N'.       01840000
018500     05  PS-RECITM-EXISTS-SW          PIC X(01)  VALUE 'N'.       01850000
018600         88  PS-RECITM-FOUND                     VALUE 'Y'.       01860000
018700         88  PS-RECITM-NOT-FOUND                 VALUE 'N'.       01870000
018800     05  PS-RTV-QTY-ERROR-SW          PIC X(01)  VALUE 'N'.       01880000
018900         88  PS-RTV-QTY-ERROR                    VALUE 'Y'.       01890000
019000         88  PS-NO-RTV-QTY-ERROR                 VALUE 'N'.       01900000
019100     05  PS-DMG-ITM-QTY-ERROR-SW      PIC X(01)  VALUE 'N'.       01910000
019200         88  PS-DMG-ITM-QTY-ERROR                VALUE 'Y'.       01920000
019300         88  PS-NO-DMG-ITM-QTY-ERROR             VALUE 'N'.       01930000
019400     05  PS-LIST-SW                   PIC X(01)  VALUE 'N'.       01940000
019500         88  PS-LIST-END                         VALUE 'Y'.       01950000
019600         88  PS-NO-LIST-END                      VALUE 'N'.       01960000
019700     05  PS-REDISTRO-SW               PIC X(01)  VALUE 'N'.       01970000
019800         88  PS-REDISTRO-OK                      VALUE 'Y'.       01980000
019900         88  PS-REDISTRO-NOT-OK                  VALUE 'N'.       01990000
020000     05  PS-RECDIS-CSR-SW             PIC X(01)  VALUE 'N'.       02000000
020100         88  PS-RECDIS-CSR-CLOSED                VALUE 'N'.       02010000
020200         88  PS-RECDIS-CSR-OPEN                  VALUE 'Y'.       02020000
020300     05  PS-CARTON-CSR-SW             PIC X(01)  VALUE 'N'.       02030000
020400         88  PS-CARTON-CSR-CLOSED                VALUE 'N'.       02040000
020500         88  PS-CARTON-CSR-OPEN                  VALUE 'Y'.       02050000
020600     05  PS-RECDIS-EOF-SW             PIC X(01)  VALUE 'N'.       02060000
020700         88  PS-EOF-RECDIS                       VALUE 'Y'.       02070000
020800         88  PS-START-RECDIS                     VALUE 'N'.       02080000
020900     05  PS-CARTON-EOC-SW             PIC X(01)  VALUE 'N'.       02090000
021000         88  PS-EOC-CARTON                       VALUE 'Y'.       02100000
021100         88  PS-START-CARTON                     VALUE 'N'.       02110000
021200     05  PS-SEQ-EOC-SW                PIC X(01)  VALUE 'N'.       02120000
021300         88  PS-EOC-SEQ                          VALUE 'Y'.       02130000
021400         88  PS-START-SEQ                        VALUE 'N'.       02140000
021500     05  PS-NEXT-SCREEN-SW            PIC  X     VALUE 'N'.       02150000
021600         88  PS-NO-NEXT-SCREEN                   VALUE 'N'.       02160000
021700         88  PS-NEXT-SCREEN                      VALUE 'Y'.       02170000
021800     05  PS-ASNS-TO-WMS-SW            PIC X(01) VALUE 'N'.        02180000
021900         88  PS-ASNS-TO-WMS-YES                 VALUE 'Y'.        02190000
022000         88  PS-ASNS-TO-WMS-NO                  VALUE 'N'.        02200000
022100     05  PS-INACTIVATE-SW             PIC X(01) VALUE 'N'.        02210000
022200         88  PS-INACTIVATE-YES                  VALUE 'Y'.        02220000
022300         88  PS-INACTIVATE-NO                   VALUE 'N'.        02230000
022400     05  PS-VALID-TRIP-SW             PIC X(01) VALUE 'N'.        02240000
022500         88  PS-VALID-TRIP                      VALUE 'Y'.        02250000
022600         88  PS-VALID-TRIP-NO                   VALUE 'N'.        02260000
022700                                                                  02270000
022800 01  PV-PROGRAM-VARIABLES.                                        02280000
022900     05  PV-CICS-RESPONSE             PIC S9(04) VALUE +0         02290000
023000                                                 COMP SYNC.       02300000
023100     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         02310000
023200                                                 COMP-3.          02320000
023300     05  PV-CARTON-COUNT              PIC S9(09) VALUE +0         02330000
023400                                                 COMP-3.          02340000
023500     05  PV-LINE-NBR-IND              PIC S9(04) VALUE +0         02350000
023600                                                 COMP SYNC.       02360000
023700     05  PV-MAX-LINE-NBR              PIC S9(04) VALUE +0         02370000
023800                                                 COMP.            02380000
023900     05  PV-NEXT-LINE-NBR             PIC S9(04) VALUE +0         02390000
024000                                                 COMP.            02400000
024100     05  PV-NULL-IND                  PIC S9(04) VALUE +0         02410000
024200                                                 COMP.            02420000
024300     05  PV-HDR-REC-COUNT             PIC S9(04) VALUE +0         02430000
024400                                                 COMP.            02440000
024500     05  PV-ABSTIME                   PIC S9(15) COMP.            02450000
024600     05  PV-CURRENT-TIMESTAMP         PIC  X(26).                 02460000
024700     05  PV-CURRENT-TIME              PIC  9(06).                 02470000
024800     05  PV-CURRENT-DATE              PIC  9(06).                 02480000
024900     05  FILLER REDEFINES PV-CURRENT-DATE.                        02490000
025000         10  PV-CURRENT-DATE-YY       PIC  X(02).                 02500000
025100         10  PV-CURRENT-DATE-MM       PIC  X(02).                 02510000
025200         10  PV-CURRENT-DATE-DD       PIC  X(02).                 02520000
025300                                                                  02530000
025400     05  PV-CURRENT-DATE-ISO          PIC  X(10).                 02540000
025500     05  FILLER REDEFINES PV-CURRENT-DATE-ISO.                    02550000
025600         10  PV-CD-ISO-YEAR           PIC  9(04).                 02560000
025700         10  FILLER                   PIC  X(01).                 02570000
025800         10  PV-CD-ISO-MM             PIC  9(02).                 02580000
025900         10  FILLER                   PIC  X(01).                 02590000
026000         10  PV-CD-ISO-DD             PIC  9(02).                 02600000
026100                                                                  02610000
026200     05  PV-COMPARE-DATE1             PIC  X(04).                 02620000
026300     05  FILLER REDEFINES PV-COMPARE-DATE1.                       02630000
026400         10  PV-CD-YY-N               PIC  9(02).                 02640000
026500         10  PV-CD-MM-N               PIC  9(02).                 02650000
026600     05  PV-COMPARE-DATE2             PIC  X(04).                 02660000
026700     05  PV-DB2-RETURN-AREAS.                                     02670000
026800         10  PV-DB2-MONTH             PIC S9(09) VALUE +0 COMP.   02680000
026900         10  PV-DB2-DAY               PIC S9(09) VALUE +0 COMP.   02690000
027000         10  PV-DB2-YEAR              PIC S9(09) VALUE +0 COMP.   02700000
027100         10  PV-DB2-HOUR              PIC S9(09) VALUE +0 COMP.   02710000
027200         10  PV-DB2-MINUTE            PIC S9(09) VALUE +0 COMP.   02720000
027300                                                                  02730000
027400         10  PV-DB2-MONTH-TRSCP       PIC S9(09) VALUE +0 COMP.   02740000
027500         10  PV-DB2-DAY-TRSCP         PIC S9(09) VALUE +0 COMP.   02750000
027600         10  PV-DB2-YEAR-TRSCP        PIC S9(09) VALUE +0 COMP.   02760000
027700         10  PV-DB2-HOUR-TRSCP        PIC S9(09) VALUE +0 COMP.   02770000
027800         10  PV-DB2-MINUTE-TRSCP      PIC S9(09) VALUE +0 COMP.   02780000
027900                                                                  02790000
028000         10  PV-DB2-TMST.                                         02800000
028100             15  PV-DB2-DATE-AREA     PIC  X(10)   VALUE SPACES.  02810000
028200             15  FILLER               PIC  X(01)   VALUE SPACES.  02820000
028300             15  PV-DB2-TIME-AREA     PIC  X(15)   VALUE SPACES.  02830000
028400     05  PV-DISPLAY-DATE.                                         02840000
028500         10  PV-MONTH                 PIC  9(02)   VALUE ZEROES.  02850000
028600         10  FILLER                   PIC  X(01)   VALUE '-'.     02860000
028700         10  PV-DAY                   PIC  9(02)   VALUE ZEROES.  02870000
028800         10  FILLER                   PIC  X(01)   VALUE '-'.     02880000
028900         10  PV-YEAR                  PIC  9(04)   VALUE ZEROES.  02890000
029000     05  PV-DISPLAY-TIME.                                         02900000
029100         10  PV-HOUR                  PIC  9(02)   VALUE ZEROES.  02910000
029200         10  FILLER                   PIC  X(01)   VALUE ':'.     02920000
029300         10  PV-MINUTE                PIC  9(02)   VALUE ZEROES.  02930000
029400     05  PV-DISPLAY-PO                PIC  9(09).                 02940000
029500     05  PV-DISPLAY-RCVR              PIC  9(04).                 02950000
029600     05  PV-DISPLAY-LINE              PIC  9(04).                 02960002
029700     05  PV-DB2-DATE-HOST             PIC  X(10).                 02970000
029800     05  PV-DB2-DATE                  PIC  X(10).                 02980000
029900     05  FILLER  REDEFINES PV-DB2-DATE.                           02990000
030000         10  PV-DB2-DATE-CCYY.                                    03000000
030100             15  PV-DB2-DATE-CC       PIC  X(02).                 03010000
030200             15  PV-DB2-DATE-YY       PIC  X(02).                 03020000
030300         10  FILLER                   PIC  X(01).                 03030000
030400         10  PV-DB2-DATE-MM           PIC  X(02).                 03040000
030500         10  FILLER                   PIC  X(01).                 03050000
030600         10  PV-DB2-DATE-DD           PIC  X(02).                 03060000
030700     05  PV-DB2-TIME                  PIC  X(16).                 03070000
030800     05  FILLER  REDEFINES PV-DB2-TIME.                           03080000
030900         10  PV-DB2-TIME-HH           PIC  X(02).                 03090000
031000         10  FILLER                   PIC  X(01).                 03100000
031100         10  PV-DB2-TIME-MM           PIC  X(02).                 03110000
031200         10  FILLER                   PIC  X(01).                 03120000
031300         10  PV-DB2-TIME-SS           PIC  X(02).                 03130000
031400         10  FILLER                   PIC  X(01).                 03140000
031500         10  PV-DB2-TIME-HS           PIC  X(06).                 03150000
031600     05  PV-INTEGER                   PIC  9(6).                  03160000
031700     05  PV-REMAINDER                 PIC  9(3).                  03170000
031800     05  PV-STATUS                    PIC  X(02)   VALUE SPACES.  03180000
031900     05  PV-PKSL-STAT-CDE             PIC  X(02)   VALUE SPACES.  03190000
032000         88 PV-PKSL-STAT-CDE-BEING-WORKED          VALUES         03200000
032100            'IP', 'CM'.                                           03210000
032200     05  PV-VALIDATE-IND              PIC  X(01)   VALUE SPACES.  03220000
032300         88  PV-VALID-RTV-IND                      VALUES         03230000
032400                                                   'Y', 'N', ' '. 03240000
032500         88  PV-VALID-PRE-TKT-IND                  VALUES         03250000
032600                                                   'Y', 'N', ' '. 03260000
032700     05  PV-PURITM-STATUS-CDE         PIC  X(02)   VALUE SPACES.  03270000
032800         88  PV-PURITM-STATUS-CDE-VALID            VALUES         03280000
032900                                                   'AC', 'AP'.    03290000
033000                                                                  03300000
033100     05  PV-BASE-DISTRO-QTY           PIC S9(07)   VALUE +0.      03310000
033200     05  PV-DISTRO-QTY                PIC S9(07)   VALUE +0.      03320000
033300     05  PV-TROUBLE-COUNT             PIC 9(03)    VALUE ZEROS.   03330000
033400     05  PV-NOT-IN-TROUBLE-COUNT      PIC 9(03)    VALUE ZEROS.   03340000
033500     05  PV-PACK-BY-ST-IND            PIC X(01)    VALUE SPACE.   03350000
033600         88  PV-PACK-BY-ST-IND-YES                 VALUE 'Y'.     03360000
033700     05  PV-PO-NBR                    PIC S9(09)   COMP           03370000
033800                                                   VALUE ZERO.    03380000
033900     05  PV-REC-SEQ-NBR               PIC S9(09)   COMP           03390000
034000                                                   VALUE ZERO.    03400000
034100     05  PV-NIS-SKU-NBR               PIC 9(08).                  03410000
034200                                                                  03420000
034300     05  PV-PO-NBR-PIC9               PIC S9(11) VALUE +0.        03430000
034400     05  PV-REC-SEQ-NBR-PIC9          PIC S9(11) VALUE +0.        03440000
034500     05  PV-PO-LNE-NBR-PIC9           PIC S9(11) VALUE +0.        03450000
034600     05  PV-UNPACK-OPER-UNT-ID        PIC  9(04) VALUE ZERO.      03460000
034700* JAK 05/08/07 - ADD COMMAREA LENGTH FIELD                        03470000
034800     05  PV-COMMAREA-LENGTH             PIC S9(04)  VALUE +0      03480000
034900                                                    COMP SYNC.    03490000
035000                                                                  03500000
035100*----------------------------------------------------------------*03510000
035200*    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING       *03520000
035300*    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.        *03530000
035400*----------------------------------------------------------------*03540000
035500                                                                  03550000
035600     COPY PCWS016.                                                03560000
035700/                                                                 03570000
035800***************************************************************** 03580000
035900*   RCWS071 - COPYBOOK IS USED FOR THE MODULE TO TRACK DC ASSOC * 03590000
036000*             FUNCTIONS                                        .* 03600000
036100***************************************************************** 03610000
036200     COPY RCWS071.                                                03620000
036300                                                                  03630000
036400                                                                  03640000
036500***************************************************************** 03650000
036600* COPYBOOK FOR WMS VENDOR SHIPMENT CONTROL MODULE               * 03660000
036700***************************************************************** 03670000
036800     COPY WSWS001.                                                03680000
036900/                                                                 03690000
037000*----------------------------------------------------------------*03700000
037100*    COPYBOOK FOR THE FIELDS PASSED TO THE TROUBLE SUBROUTINE     03710000
037200*----------------------------------------------------------------*03720000
037300                                                                  03730000
037400     COPY TMWS500.                                                03740000
037500/                                                                 03750000
037600                                                                  03760000
037700*----------------------------------------------------------------*03770000
037800*    MAP LAYOUT                                                  *03780000
037900*----------------------------------------------------------------*03790000
038000                                                                  03800000
038100     COPY RCKM239.                                                03810000
038200                                                                  03820000
038300/                                                                 03830000
038400*----------------------------------------------------------------*03840000
038500*    ATTRIBUTE SETTINGS COPYBOOK.                                *03850000
038600*----------------------------------------------------------------*03860000
038700                                                                  03870000
038800     COPY DPWS015.                                                03880000
038900                                                                  03890000
039000/                                                                 03900000
039100*----------------------------------------------------------------*03910000
039200*    FUNCTION KEYS COPYBOOK                                      *03920000
039300*----------------------------------------------------------------*03930000
039400                                                                  03940000
039500     COPY DPWS016.                                                03950000
039600                                                                  03960000
039700/                                                                 03970000
039800*----------------------------------------------------------------*03980000
039900*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT   *03990000
040000*    SUB-ROUTINE (POKUT100).                                     *04000000
040100*----------------------------------------------------------------*04010000
040200     COPY DPWS010I.                                               04020000
040300                                                                  04030000
040400/                                                                 04040000
040500*----------------------------------------------------------------*04050000
040600*  WORK AREA PASSED IN CALL TO DPKUT500                          *04060000
040700*----------------------------------------------------------------*04070000
040800     COPY DPWS500.                                                04080000
040900                                                                  04090000
041000/                                                                 04100000
041100******************************************************************04110008
041200** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **04120008
041300** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **04130008
041400******************************************************************04140008
041500     COPY DPWS030.                                                04150000
041510     COPY DPWS930.                                                04151008
041600                                                                  04160000
041700/                                                                 04170000
041800*----------------------------------------------------------------*04180000
041900*    STANDARD COMMAREA.                                          *04190000
042000*----------------------------------------------------------------*04200000
042100                                                                  04210000
042200     COPY DPWS020.                                                04220000
042300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04230000
042400                                                                  04240000
042500*----------------------------------------------------------------*04250000
042600*    INTER-APPLICATION COMMAREA.                                 *04260000
042700*----------------------------------------------------------------*04270000
042800                                                                  04280000
042900         10  INTER-APPL-COMM-AREA PIC X(200).                     04290000
043000     COPY PCWS000.                                                04300000
043100*----------------------------------------------------------------*04310000
043200*    SPECIFIC COMMMAREA FOR RCKCS239.                            *04320000
043300*----------------------------------------------------------------*04330000
043400         10  ASC-SPECIFIC-COMMAREA.                               04340000
043500             15  ASC-USE-SELECTION-QUEUE-IND                      04350000
043600                                            PIC X(01).            04360000
043700                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        04370000
043800             15  ASC-SEL-QUEUE-NAME         PIC X(08).            04380000
043900             15  ASC-NUMBER-OF-TS-ITEMS     PIC S9(05) COMP-3.    04390000
044000             15  ASC-NUMBER-OF-SELECTED-ITEMS                     04400000
044100                                            PIC S9(09) COMP-3.    04410000
044200             15  ASC-SEL-SUB                PIC S9(04) COMP.      04420000
044300             15  ASC-SEL-ITEM               PIC S9(04) COMP.      04430000
044400             15  ASC-CURRENT-DATE           PIC X(10).            04440000
044500             15  ASC-ACTION-SW              PIC X(03).            04450000
044600                 88  ASC-UPDATE-PENDING     VALUE 'UPD'.          04460000
044700             15  ASC-KEY-FIELDS.                                  04470000
044800** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  04480005
044900                 20  ASC-KEY-PO-NBR         PIC 9(08).            04490005
045000                 20  ASC-KEY-PO-LNE-NBR     PIC S9(09) COMP.      04500000
045100                 20  ASC-KEY-REC-SEQ-NBR    PIC 9(04).            04510000
045200                 20  ASC-KEY-OPER-UNT-ID    PIC S9(4)  COMP.      04520000
045300                 20  ASC-KEY-FCLTY-ID       PIC S9(4)  COMP.      04530000
045400             15  ASC-SCREEN-FIELDS.                               04540000
045500                 20  ASC-OPER-UNT-ID        PIC S9(4)  COMP.      04550000
045600                 20  ASC-FCLTY-ID           PIC S9(4)  COMP.      04560000
045700                 20  ASC-FCLTY-DESC         PIC X(25).            04570000
045800                 20  ASC-RECEIVER.                                04580000
045900** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  04590005
046000                     25  ASC-PO-NBR         PIC 9(08).            04600005
046100                     25  ASC-REC-DASH       PIC X(01).            04610000
046200                     25  ASC-REC-SEQ-NBR    PIC 9(04).            04620000
046300                 20  ASC-CREATED-BY-UID     PIC X(08).            04630000
046400                 20  ASC-CREATED-BY-DTE     PIC X(10).            04640000
046500                 20  ASC-CREATED-BY-TME     PIC X(05).            04650000
046600                 20  ASC-PO-LNE-NBR.                              04660000
046700                     25  ASC-PO-LNE-NBR-N   PIC 9(04).            04670000
046800                 20  ASC-LAST-UPD-BY-UID    PIC X(08).            04680000
046900                 20  ASC-LAST-UPD-BY-DTE    PIC X(10).            04690000
047000                 20  ASC-LAST-UPD-BY-TME    PIC X(05).            04700000
047100                 20  ASC-STATUS-DESC        PIC X(10).            04710000
047200                 20  ASC-TROUBLE-DESC       PIC X(26).            04720000
047300                 20  ASC-INNR-PACK-QTY.                           04730000
047400                     25  ASC-INNR-PACK-QTY-N                      04740000
047500                                            PIC 9(03).            04750000
047600                 20  ASC-PKSL-ITM-QTY       PIC 9(07).            04760000
047700                 20  ASC-GP-RTL-AMT         PIC 9(05)V99.         04770000
047800                 20  ASC-CASE-PACK-QTY.                           04780000
047900                     25  ASC-CASE-PACK-QTY-N                      04790000
048000                                            PIC 9(03).            04800000
048100                 20  ASC-DTL-CK-ITM-QTY.                          04810000
048200                     25  ASC-DTL-CK-ITM-QTY-N                     04820000
048300                                            PIC 9(05).            04830000
048400                 20  ASC-ORIG-DTL-CK-ITM-QTY                      04840000
048500                                            PIC 9(05).            04850000
048600                 20  ASC-GP-QTY             PIC 9(03).            04860000
048700                 20  ASC-PRE-TKT-IND        PIC X(01).            04870000
048800                 20  ASC-DMG-ITM-QTY.                             04880000
048900                     25  ASC-DMG-ITM-QTY-N  PIC 9(04).            04890000
049000                 20  ASC-EXPTED-CART-CNT    PIC 9(04).            04900000
049100                 20  ASC-UNT-RTL-PR-AMT     PIC 9(05)V99.         04910000
049200                 20  ASC-ACTL-CART-CNT      PIC 9(04).            04920000
049300******    WR # 27201 - START                                      04930000
049400                 20  ASC-VRFD-LWST-RTL-AMT  PIC S9(7)V9(2) COMP-3.04940000
049500******    WR # 27201 - END                                        04950000
049600                 20  ASC-TKT-FMT-ID         PIC X(06).            04960000
049700                 20  ASC-RTV-IND            PIC X(01).            04970000
049800                 20  ASC-SKU.                                     04980000
049900                     25  ASC-DEPT-NBR       PIC X(03).            04990000
050000                     25  ASC-SKU-DASH-1     PIC X(01).            05000000
050100                     25  ASC-CLASS-NBR      PIC X(02).            05010000
050200                     25  ASC-SKU-DASH-2     PIC X(01).            05020000
050300                     25  ASC-SKU-SEQ-NBR    PIC X(08).            05030000
050400                 20  ASC-RTV-QTY.                                 05040000
050500                     25  ASC-RTV-QTY-N      PIC 9(05).            05050000
050600                 20  ASC-VEND-STYL-NAME     PIC X(20).            05060000
050700                 20  ASC-UNT-COST-AMT.                            05070000
050800                     25  ASC-UNT-COST-AMT-N PIC 9(05)V9(3).       05080000
050900                 20  ASC-COLOR-DESC         PIC X(25).            05090000
051000                 20  ASC-MTCH-TO-LINE.                            05100000
051100                     25  ASC-MTCH-TO-LINE-N PIC 9(04).            05110000
051200                 20  ASC-SIZE-DESC          PIC X(25).            05120000
051300             15  ASC-PURITM-VER-NBR         PIC S9(04) COMP.      05130000
051400             15  ASC-ITM-NBR                PIC S9(15) COMP-3.    05140000
051500             15  ASC-PURITM-PIC-ITM-IND     PIC X(01).            05150000
051600             15  ASC-ENT-ID                 PIC S9(09) COMP.      05160000
051700             15  ASC-NOT-FOUND-SW           PIC X(01).            05170000
051800                 88  ASC-FOUND                         VALUE 'F'. 05180000
051900                 88  ASC-NOT-FOUND                     VALUE 'N'. 05190000
052000             15  ASC-DELETE-ITEM-SW         PIC X(01).            05200000
052100                 88  ASC-DELETE-ITEM               VALUE 'D', '4'.05210000
052200             15  ASC-DELETED-SW             PIC X(01).            05220000
052300                 88  ASC-DELETED                       VALUE 'D'. 05230000
052400                 88  ASC-NOT-DELETED                   VALUE 'N'. 05240000
052500             15  ASC-CASEPACK-SW            PIC X(01).            05250000
052600                 88  ASC-CASEPACK-FOUND                VALUE 'Y'. 05260000
052700                 88  ASC-CASEPACK-NOT-FOUND            VALUE 'N'. 05270000
052800             15  ASC-RECITM-STATUS-CDE      PIC X(02).            05280000
052900                 88  ASC-RECITM-STATUS-CM-VE           VALUES     05290000
053000                     'CM', 'VE'.                                  05300000
053100             15 ASC-RECITM-RCPT-DISTR-UPD-CDE                     05310000
053200                                            PIC   X(1).           05320000
053300             15  ASC-ORIGINATION-IND        PIC X(01).            05330000
053400                 88  ASC-CAME-FROM-RCVG                VALUE '1'. 05340000
053500                 88  ASC-CAME-FROM-TRBL                VALUE '2'. 05350000
053600             15  ASC-PKGNG-CODE             PIC X(01).            05360000
053700                 88  ASC-PREPACK-RECEIVER              VALUES     05370000
053800                     'I', 'M'.                                    05380000
053900             15  ASC-TKT-DESC               PIC X(16).            05390000
054000             15  ASC-PREPK-ID               PIC  S9(4) COMP.      05400000
054100                                                                  05410000
054200*----------------------------------------------------------------*05420000
054300*    AUDIT FILE LAYOUT                                           *05430000
054400*----------------------------------------------------------------*05440000
054500     COPY RCWS031.                                                05450000
054600/                                                                 05460000
054700*----------------------------------------------------------------*05470000
054800*    ABEND PROCESSING COPYBOOK.                                  *05480000
054900*----------------------------------------------------------------*05490000
055000                                                                  05500000
055100     COPY DPWS013.                                                05510000
055200/                                                                 05520000
055300                                                                  05530000
055400*----------------------------------------------------------------*05540000
055500*    SYSTEM MESSAGE COPYBOOK                                     *05550000
055600*----------------------------------------------------------------*05560000
055700                                                                  05570000
055800     COPY DPRD507I.                                               05580000
055900/                                                                 05590000
056000                                                                  05600000
056100*----------------------------------------------------------------*05610000
056200*    COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE *          *05620000
056300*----------------------------------------------------------------*05630000
056400                                                                  05640000
056500     COPY XLWS001.                                                05650000
056600                                                                  05660000
056700*----------------------------------------------------------------*05670000
056800*    COPYBOOK FOR LOGISTICS DOMAIN LOCATION ACCESS MODULE        *05680000
056900*----------------------------------------------------------------*05690000
057000                                                                  05700000
057100     COPY XLWS071.                                                05710000
057200                                                                  05720000
057300*----------------------------------------------------------------*05730000
057400*    DB2 SQL COMMUNICATION AREA                                   05740000
057500*----------------------------------------------------------------*05750000
057600     EXEC SQL                                                     05760000
057700          INCLUDE SQLCA                                           05770000
057800     END-EXEC.                                                    05780000
057900                                                                  05790000
058000***************************************************************** 05800000
058100*    DB2 AREA FOR THE SHIPT UNIT TABLE                          * 05810000
058200***************************************************************** 05820000
058300     EXEC SQL                                                     05830000
058400          INCLUDE TSHPUNT                                         05840000
058500     END-EXEC.                                                    05850000
058600                                                                  05860000
058700***************************************************************** 05870000
058800*    DB2 AREA FOR THE CROSS REFERENCE TABLE                     * 05880000
058900***************************************************************** 05890000
059000     EXEC SQL                                                     05900000
059100          INCLUDE TSULBXF                                         05910000
059200     END-EXEC.                                                    05920000
059300                                                                  05930000
059400***************************************************************** 05940000
059500*    DB2 AREA FOR THE INPKSU TABLE                              * 05950000
059600***************************************************************** 05960000
059700     EXEC SQL                                                     05970000
059800          INCLUDE TINPKSU                                         05980000
059900     END-EXEC.                                                    05990000
060000                                                                  06000000
060100***************************************************************** 06010000
060200*    DB2 AREA FOR THE SHUUPC TABLE                              * 06020000
060300***************************************************************** 06030000
060400     EXEC SQL                                                     06040000
060500          INCLUDE TSHUUPC                                         06050000
060600     END-EXEC.                                                    06060000
060700                                                                  06070000
060800***************************************************************** 06080000
060900*    DB2 AREA FOR THE INPKSU TABLE                              * 06090000
061000***************************************************************** 06100000
061100     EXEC SQL                                                     06110000
061200          INCLUDE TSHUNLO                                         06120000
061300     END-EXEC.                                                    06130000
061400                                                                  06140000
061500/                                                                 06150000
061600*----------------------------------------------------------------*06160000
061700*    DB2 DCLGEN FOR THE PACK SLIP TABLE                           06170000
061800*----------------------------------------------------------------*06180000
061900     EXEC SQL                                                     06190000
062000          INCLUDE TPKSLIP                                         06200000
062100     END-EXEC.                                                    06210000
062200                                                                  06220000
062300/                                                                 06230000
062400*----------------------------------------------------------------*06240000
062500*    DB2 DCLGEN FOR THE PACK SLIP ITEM TABLE                      06250000
062600*----------------------------------------------------------------*06260000
062700     EXEC SQL                                                     06270000
062800          INCLUDE TPKITEM                                         06280000
062900     END-EXEC.                                                    06290000
063000                                                                  06300000
063100/                                                                 06310000
063200*----------------------------------------------------------------*06320000
063300*    DB2 DCLGEN FOR THE UNMATCHED PACK SLIP ITEM TABLE            06330000
063400*----------------------------------------------------------------*06340000
063500     EXEC SQL                                                     06350000
063600          INCLUDE TUNPKSL                                         06360000
063700     END-EXEC.                                                    06370000
063800                                                                  06380000
063900/                                                                 06390000
064000*----------------------------------------------------------------*06400000
064100*    DB2 DCLGEN FOR THE RECEIVER TABLE                            06410000
064200*----------------------------------------------------------------*06420000
064300     EXEC SQL                                                     06430000
064400          INCLUDE TRECEIV                                         06440000
064500     END-EXEC.                                                    06450000
064600                                                                  06460000
064700/                                                                 06470000
064800*----------------------------------------------------------------*06480000
064900*    DB2 DCLGEN FOR THE RECEIVER ITEM TABLE                       06490000
065000*----------------------------------------------------------------*06500000
065100     EXEC SQL                                                     06510000
065200          INCLUDE TRECITM                                         06520000
065300     END-EXEC.                                                    06530000
065400                                                                  06540000
065500/                                                                 06550000
065600*----------------------------------------------------------------*06560000
065700*    DB2 DCLGEN FOR THE DISTRIBUTION HEADER TABLE                 06570000
065800*----------------------------------------------------------------*06580000
065900     EXEC SQL                                                     06590000
066000          INCLUDE TDISTHD                                         06600000
066100     END-EXEC.                                                    06610000
066200                                                                  06620000
066300/                                                                 06630000
066400*----------------------------------------------------------------*06640000
066500*    DB2 DCLGEN FOR THE RECEIVER DISTRIBUTION TABLE               06650000
066600*----------------------------------------------------------------*06660000
066700     EXEC SQL                                                     06670000
066800          INCLUDE TRECDIS                                         06680000
066900     END-EXEC.                                                    06690000
067000                                                                  06700000
067100/                                                                 06710000
067200*----------------------------------------------------------------*06720000
067300*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          06730000
067400*----------------------------------------------------------------*06740000
067500     EXEC SQL                                                     06750000
067600          INCLUDE TPURCHS                                         06760000
067700     END-EXEC.                                                    06770000
067800                                                                  06780000
067900/                                                                 06790000
068000*----------------------------------------------------------------*06800000
068100*    DB2 DCLGEN FOR PURCHASE ORDER STATUS CODE TABLE              06810000
068200*----------------------------------------------------------------*06820000
068300     EXEC SQL                                                     06830000
068400          INCLUDE TSTATCD                                         06840000
068500     END-EXEC.                                                    06850000
068600                                                                  06860000
068700/                                                                 06870000
068800*----------------------------------------------------------------*06880000
068900*    DB2 DCLGEN FOR PURCHASE ORDER LINE ITEM TABLE                06890000
069000*----------------------------------------------------------------*06900000
069100     EXEC SQL                                                     06910000
069200          INCLUDE TPURITM                                         06920000
069300     END-EXEC.                                                    06930000
069400                                                                  06940000
069500*----------------------------------------------------------------*06950000
069600*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                06960000
069700*----------------------------------------------------------------*06970000
069800     EXEC SQL                                                     06980000
069900          INCLUDE TTRBNTF                                         06990000
070000     END-EXEC.                                                    07000000
070100                                                                  07010000
070200*----------------------------------------------------------------*07020000
070300*    DB2 DCLGEN FOR THE TROUBLE REASON CODE TABLE                 07030000
070400*----------------------------------------------------------------*07040000
070500     EXEC SQL                                                     07050000
070600          INCLUDE TTRBRSN                                         07060000
070700     END-EXEC.                                                    07070000
070800                                                                  07080000
070900*----------------------------------------------------------------*07090000
071000*    DB2 DCLGEN FOR THE WORK ORDER TABLE                          07100000
071100*----------------------------------------------------------------*07110000
071200     EXEC SQL                                                     07120000
071300          INCLUDE TWRKORD                                         07130000
071400     END-EXEC.                                                    07140000
071500                                                                  07150000
071600*----------------------------------------------------------------*07160000
071700*    DB2 DCLGEN FOR THE WORK ORDER INSTRUCTION TABLE              07170000
071800*----------------------------------------------------------------*07180000
071900     EXEC SQL                                                     07190000
072000          INCLUDE TWKORIN                                         07200000
072100     END-EXEC.                                                    07210000
072200                                                                  07220000
072300*----------------------------------------------------------------*07230000
072400*    DB2 DCLGEN FOR THE SHIPMT TABLE                              07240000
072500*----------------------------------------------------------------*07250000
072600     EXEC SQL                                                     07260000
072700          INCLUDE TSHIPMT                                         07270000
072800     END-EXEC.                                                    07280000
072900                                                                  07290000
073000*----------------------------------------------------------------*07300000
073100*    DB2 DCLGEN FOR THE SHPTPO TABLE                              07310000
073200*----------------------------------------------------------------*07320000
073300     EXEC SQL                                                     07330000
073400          INCLUDE TSHPTPO                                         07340000
073500     END-EXEC.                                                    07350000
073600                                                                  07360000
074400*----------------------------------------------------------------*07440000
074500*    DB2 DCLGEN FOR THE ODD UNIT TABLE                            07450000
074600*----------------------------------------------------------------*07460000
074700     EXEC SQL                                                     07470000
074800          INCLUDE RCT00009                                        07480000
074900     END-EXEC.                                                    07490000
075000/                                                                 07500000
075100******    WR # 27201 - START                                      07510000
075200*----------------------------------------------------------------*07520000
075300*    DB2 DCLGEN FOR THE RCT_PRC_RCPT                              07530000
075400*----------------------------------------------------------------*07540000
075500     EXEC SQL                                                     07550000
075600          INCLUDE RCT00019                                        07560000
075700     END-EXEC.                                                    07570000
075800/                                                                 07580000
075900*----------------------------------------------------------------*07590000
076000*    DB2 DCLGEN FOR THE TKRPRPM                                   07600000
076100*----------------------------------------------------------------*07610000
076200     EXEC SQL                                                     07620000
076300          INCLUDE TKRPRPM                                         07630000
076400     END-EXEC.                                                    07640000
076500/                                                                 07650000
076600******    WR # 27201 - END                                        07660000
076700******************************************************************07670000
076800*    DB2 DCLGEN FOR THE TICKET FORMAT TABLE                       07680000
076900******************************************************************07690000
077000     EXEC SQL                                                     07700000
077100          INCLUDE TTKTFMT                                         07710000
077200     END-EXEC.                                                    07720000
077300/                                                                 07730000
077400******************************************************************07740000
077500*    DB2 DCLGEN FOR THE WST_SHPMT_XREF_HDR TABLE                  07750000
077600******************************************************************07760000
077700     EXEC SQL                                                     07770000
077800          INCLUDE WST00001                                        07780000
077900     END-EXEC.                                                    07790000
078000/                                                                 07800000
078100******************************************************************07810000
078200*    DB2 DCLGEN FOR THE WST_SHPMT_XREF_DTL TABLE                  07820000
078300******************************************************************07830000
078400     EXEC SQL                                                     07840000
078500          INCLUDE WST00002                                        07850000
078600     END-EXEC.                                                    07860000
078700/                                                                 07870000
078800******************************************************************07880000
078900     EXEC SQL                                                     07890000
079000     DECLARE RECDIS-CSR CURSOR FOR                                07900000
079100     SELECT                                                       07910000
079200         STR_NBR                                                  07920000
079300       , STR_FCLTY_ID                                             07930000
079400     FROM TRECDIS                                                 07940000
079500     WHERE                                                        07950000
079600         ORD_NBR                =  :DK-PO-NBR                     07960000
079700         AND ORD_LNE_NBR        =  :DK-PO-LNE-NBR                 07970000
079800         AND REC_SEQ_NBR        =  :DK-REC-SEQ-NBR                07980000
079900     ORDER BY 1, 2                                                07990000
080000     FOR FETCH ONLY                                               08000000
080100     END-EXEC.                                                    08010000
080200                                                                  08020000
080300     EXEC SQL                                                     08030000
080400         DECLARE CARTON-CSR CURSOR WITH HOLD FOR                  08040000
080500          SELECT A.SHIPT_UNT_ID                                   08050000
080600            FROM TSHPUNT A                                        08060000
080700             ,   TINPKSU B                                        08070000
080800            WHERE A.ACTV_IND      = 'A'                           08080000
080900              AND B.PO_NBR        = :PV-PO-NBR                    08090000
081000              AND B.SEQ_NBR       = :DK-SEQ-NBR                   08100000
081100              AND A.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                08110000
081200     END-EXEC.                                                    08120000
081300                                                                  08130000
081400     EXEC SQL                                                     08140000
081500         DECLARE SEQ-CSR CURSOR FOR                               08150000
081600         SELECT DISTINCT A.SEQ_NBR                                08160000
081700           FROM TPKSLIP A                                         08170000
081800             ,  TINPKSU B                                         08180000
081900             ,  TSHUUPC C                                         08190000
082000          WHERE A.PO_NBR          = :PV-PO-NBR                    08200000
082100            AND A.REC_SEQ_NBR     = :PV-REC-SEQ-NBR               08210000
082200            AND A.VER_STAT_CDE    = 'A'                           08220000
082300            AND A.PKSL_STAT_CDE   = 'AC'                          08230000
082400            AND A.PO_NBR          = B.PO_NBR                      08240000
082500            AND A.SEQ_NBR         = B.SEQ_NBR                     08250000
082600            AND B.SHIPT_UNT_ID    = C.SHIPT_UNT_ID                08260000
082700            AND A.PO_NBR          = C.TRN_NBR                     08270000
082800            AND C.TRN_LNE_NBR     = :DK-PO-LNE-NBR                08280000
082900     END-EXEC.                                                    08290000
083000/                                                                 08300000
083100 LINKAGE SECTION.                                                 08310000
083200                                                                  08320000
083300 01  DFHCOMMAREA.                                                 08330000
083400     05  FILLER                       OCCURS  1 TO 4072 TIMES     08340000
083500                                      DEPENDING ON EIBCALEN.      08350000
083600         10  FILLER                   PIC X.                      08360000
083700                                                                  08370000
083800/                                                                 08380000
083900 PROCEDURE DIVISION.                                              08390000
084000                                                                  08400000
084100*----------------------------------------------------------------*08410000
084200*    THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. *08420000
084300*    THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  *08430000
084400*    MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            *08440000
084500*                                                                *08450000
084600*    THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  *08460000
084700*    LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       *08470000
084800*----------------------------------------------------------------*08480000
084900 0000-MAIN-MODULE.                                                08490000
085000                                                                  08500000
085100     INITIALIZE DP030-CICS-API-FIELDS.                            08510000
085200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       08520000
085300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          08530000
085400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         08540000
085500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       08550000
085600     SET PS-ASNS-TO-WMS-NO         TO TRUE.                       08560001
085700     MOVE LENGTH OF RC239AI        TO DP030-MAP-LENGTH (1).       08570000
085800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     08580000
085900     PERFORM 0001-CALL-CICS-ARCH-API.                             08590000
086000                                                                  08600000
086100     PERFORM 1000-CONTROL-PROCESSING.                             08610000
086200                                                                  08620000
086300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     08630000
086400     PERFORM 0001-CALL-CICS-ARCH-API.                             08640000
086500                                                                  08650000
086600/                                                                 08660000
086700 0001-CALL-CICS-ARCH-API.                                         08670000
086800                                                                  08680000
086910     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08691008
087000                                    DFHCOMMAREA                   08700008
087100                                    DP030-CICS-API-FIELDS         08710008
087200                                    DP020-STANDARD-COMMAREA       08720008
087300                                    RC239AI.                      08730008
087400                                                                  08740000
087500     IF  DP030-RC-CALL-SUCCESSFUL                                 08750000
087600         CONTINUE                                                 08760000
087700     ELSE                                                         08770000
087800         SET DP013-NO-ROLLBACK                                    08780000
087900             DP013-XCTL-DISPLAY-RESTART                           08790000
088000             DP013-CICS-ABEND      TO TRUE                        08800000
088100         MOVE 'BEFORE 0000-MAIN-MODULE'                           08810000
088200                                   TO DP013-PARAGRAPH             08820000
088220         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O08822008
088230-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08823008
088500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      08850000
088600         PERFORM DP013-0000-PROCESS-ABEND                         08860000
088700     END-IF.                                                      08870000
088800                                                                  08880000
088900/                                                                 08890000
089000*----------------------------------------------------------------*08900000
089100*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *08910000
089200*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *08920000
089300*----------------------------------------------------------------*08930000
089400                                                                  08940000
089500 1000-CONTROL-PROCESSING.                                         08950000
089600                                                                  08960000
089700     EVALUATE TRUE                                                08970000
089800         WHEN DP020-NEXT-ACT-INITIAL                              08980000
089900              INITIALIZE ASC-SPECIFIC-COMMAREA                    08990000
090000              PERFORM 1100-PROCESS-INTER-APPL-COMM                09000000
090100              PERFORM 4000-BUILD-INITIAL-PANEL                    09010000
090200              PERFORM 3200-RESET-ATTRIBUTES                       09020000
090300                                                                  09030000
090400         WHEN DP020-NEXT-ACT-READ-MAP                             09040000
090500              PERFORM 2000-PROCESS-PANEL                          09050000
090600                                                                  09060000
090700         WHEN DP020-NEXT-ACT-RETURN                               09070000
090800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09080000
090900             PERFORM 2140-CHECK-PACKAGING-CODE                    09090000
091000             PERFORM 3200-RESET-ATTRIBUTES                        09100000
091100                                                                  09110000
091200         WHEN OTHER                                               09120000
091300              SET DP013-LOGIC-ABEND                               09130000
091400                  DP013-NO-ROLLBACK                               09140000
091500                                   TO TRUE                        09150000
091600              MOVE '1000-CONTROL-PROCESSING'                      09160000
091700                                   TO DP013-PARAGRAPH             09170000
091800              MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'  09180000
091900                                   TO DP013-MESSAGE-TEXT(1)       09190000
092000              MOVE DP020-NEXT-APPL-ACTIVITY                       09200000
092100                                   TO DP013-MESSAGE-TEXT(2)       09210000
092200              PERFORM DP013-0000-PROCESS-ABEND                    09220000
092300     END-EVALUATE.                                                09230000
092400                                                                  09240000
092500/                                                                 09250000
092600*----------------------------------------------------------------*09260000
092700*    SAVE THE KEYS PASSED IN THE INTER-APPL COMMAREA             *09270000
092800*----------------------------------------------------------------*09280000
092900 1100-PROCESS-INTER-APPL-COMM.                                    09290000
093000                                                                  09300000
093100     SET PS-COMMAREA-VALID         TO TRUE.                       09310000
093200                                                                  09320000
093300     IF PC000-NUMBER-OF-SELECTED-ITEMS = ZERO                     09330000
093400         MOVE PC-TSYMSG-00057      TO DP020-MSG-NUMBER            09340000
093500         SET DP020-MSG-FATAL       TO TRUE                        09350000
093600         SET DP020-NEXT-ACT-APPL-ERROR                            09360000
093700                                   TO TRUE                        09370000
093800         SET PS-ERROR              TO TRUE                        09380000
093900     ELSE                                                         09390000
094000         SET ASC-USE-SELECTION-QUEUE                              09400000
094100                                   TO TRUE                        09410000
094200         MOVE PC000-NUMBER-OF-SELECTED-ITEMS                      09420000
094300                                   TO ASC-NUMBER-OF-SELECTED-ITEMS09430000
094400         MOVE PC000-NUMBER-OF-TS-ITEMS                            09440000
094500                                   TO ASC-NUMBER-OF-TS-ITEMS      09450000
094600         MOVE PC000-SEL-QUEUE-NAME TO ASC-SEL-QUEUE-NAME          09460000
094700         PERFORM 1120-PREPARE-LIST-ENTRY                          09470000
094800         SET ASC-UPDATE-PENDING    TO TRUE                        09480000
094900     END-IF.                                                      09490000
095000                                                                  09500000
095100     MOVE DP020-INT-APPL-FORMAT-IND                               09510000
095200                                   TO  ASC-DELETE-ITEM-SW.        09520000
095300                                                                  09530000
095400     PERFORM 2140-CHECK-PACKAGING-CODE.                           09540000
095500                                                                  09550000
095600     EVALUATE DP020-INT-APPL-FORMAT-IND                           09560000
095700         WHEN PC-INTER-APPL-RCVG                                  09570000
095800         WHEN PC-INTER-APPL-PREPK-RCVG                            09580000
095900         WHEN PC-INTER-APPL-DELETE                                09590000
096000         WHEN PC-INTER-APPL-RCV-UPD                               09600000
096100         WHEN PC-INTER-APPL-RCV-DEL                               09610000
096200             SET ASC-CAME-FROM-RCVG                               09620000
096300                                   TO TRUE                        09630000
096400         WHEN PC-INTER-APPL-TRBL                                  09640000
096500             SET ASC-CAME-FROM-TRBL                               09650000
096600                                   TO TRUE                        09660000
096700     END-EVALUATE.                                                09670000
096800                                                                  09680000
096900/                                                                 09690000
097000*----------------------------------------------------------------*09700000
097100*    ENTRY IS FROM A LIST.  GET THE PO NUMBER FROM THE           *09710000
097200*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *09720000
097300*----------------------------------------------------------------*09730000
097400 1120-PREPARE-LIST-ENTRY.                                         09740000
097500                                                                  09750000
097600     MOVE PC016-MAX-ITEMS          TO ASC-SEL-SUB.                09760000
097700     MOVE ZERO                     TO ASC-SEL-ITEM.               09770000
097800                                                                  09780000
097900     PERFORM 2110-GET-NEXT-RECITM-SELECT.                         09790000
098000                                                                  09800000
098100/                                                                 09810000
098200*----------------------------------------------------------------*09820000
098300*    DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA*09830000
098400*    ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT*09840000
098500*    USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE    *09850000
098600*    REST OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO      *09860000
098700*    INVALID FUNCTION KEYS CAN GET THIS FAR.                     *09870000
098800*----------------------------------------------------------------*09880000
098900                                                                  09890000
099000 2000-PROCESS-PANEL.                                              09900000
099100                                                                  09910000
099200     EVALUATE TRUE                                                09920000
099300                                                                  09930000
099400         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  09940000
099500             MOVE ASC-KEY-PO-NBR   TO PC000-PO-NBR-N              09950000
099600             MOVE ASC-DEPT-NBR     TO PC000-DEPT-NBR              09960000
099700             MOVE ASC-ENT-ID       TO PC000-ENT-ID                09970000
099800             MOVE ASC-PO-LNE-NBR-N TO PC000-LINE-NBR-N            09980000
099900             MOVE ASC-SEL-QUEUE-NAME                              09990000
100000                                   TO PC000-SEL-QUEUE-NAME        10000000
100100             MOVE ASC-KEY-REC-SEQ-NBR                             10010000
100200                                   TO PC000-REC-SEQ-NBR-N         10020000
100300             MOVE ASC-KEY-OPER-UNT-ID                             10030000
100400                                   TO PC000-OPERATING-UNIT-ID     10040000
100500             MOVE ASC-KEY-FCLTY-ID TO PC000-FACILITY-ID           10050000
100600             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    10060000
100700                               TO PC000-NUMBER-OF-SELECTED-ITEMS  10070000
100800             MOVE ASC-NUMBER-OF-TS-ITEMS                          10080000
100900                                   TO PC000-NUMBER-OF-TS-ITEMS    10090000
101000                                                                  10100000
101100         WHEN DP020-SRC-AID = DP016-CLEAR                         10110000
101200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10120000
101300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10130000
101400                                                                  10140000
101500         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     10150000
101600             INITIALIZE ASC-SCREEN-FIELDS                         10160000
101700             MOVE ASC-KEY-PO-NBR   TO DK-PO-NBR                   10170000
101800                                      ASC-PO-NBR                  10180000
101900             MOVE ASC-KEY-PO-LNE-NBR                              10190000
102000                                   TO ASC-PO-LNE-NBR-N            10200000
102100                                      DK-PO-LNE-NBR               10210000
102200             MOVE ASC-KEY-REC-SEQ-NBR                             10220000
102300                                   TO ASC-REC-SEQ-NBR             10230000
102400                                      DK-REC-SEQ-NBR              10240000
102500                                                                  10250000
102600             MOVE ASC-KEY-OPER-UNT-ID                             10260000
102700                                   TO ASC-OPER-UNT-ID             10270000
102800                                                                  10280000
102900             MOVE ASC-KEY-FCLTY-ID TO ASC-FCLTY-ID                10290000
103000             PERFORM 4000-BUILD-INITIAL-PANEL                     10300000
103100             PERFORM 3200-RESET-ATTRIBUTES                        10310000
103200                                                                  10320000
103300         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             10330000
103400             IF  ASC-USE-SELECTION-QUEUE                          10340000
103500                 PERFORM 2110-GET-NEXT-RECITM-SELECT              10350000
103600                 IF PS-LIST-END                                   10360000
103700                     SET PS-NO-LIST-END                           10370000
103800                                   TO TRUE                        10380000
103900                 ELSE                                             10390000
104000                     MOVE ASC-KEY-PO-NBR                          10400000
104100                                   TO DK-PO-NBR                   10410000
104200                                      ASC-PO-NBR                  10420000
104300                     MOVE ASC-KEY-PO-LNE-NBR                      10430000
104400                                   TO ASC-PO-LNE-NBR-N            10440000
104500                                      DK-PO-LNE-NBR               10450000
104600                     MOVE ASC-KEY-REC-SEQ-NBR                     10460000
104700                                   TO ASC-REC-SEQ-NBR             10470000
104800                                      DK-REC-SEQ-NBR              10480000
104900                     MOVE ASC-KEY-OPER-UNT-ID                     10490000
105000                                   TO ASC-OPER-UNT-ID             10500000
105100                     MOVE ASC-KEY-FCLTY-ID                        10510000
105200                                   TO ASC-FCLTY-ID                10520000
105300                                                                  10530000
105400                     PERFORM 4000-BUILD-INITIAL-PANEL             10540000
105500                     PERFORM 3200-RESET-ATTRIBUTES                10550000
105600                 END-IF                                           10560000
105700             ELSE                                                 10570000
105800*                --- BOTTOM OF LIST ---                           10580000
105900                 MOVE PC-TSYMSG-00070                             10590000
106000                                   TO DP020-MSG-NUMBER            10600000
106100                 SET DP020-MSG-INFORMATIONAL                      10610000
106200                     PS-LIST-END   TO TRUE                        10620000
106300             END-IF                                               10630000
106400                                                                  10640000
106500         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             10650000
106600             IF  ASC-USE-SELECTION-QUEUE                          10660000
106700                 PERFORM 2120-GET-PREV-RECITM-SELECT              10670000
106800                 IF PS-LIST-END                                   10680000
106900                     SET PS-NO-LIST-END                           10690000
107000                                   TO TRUE                        10700000
107100                 ELSE                                             10710000
107200                     MOVE ASC-KEY-PO-NBR                          10720000
107300                                   TO DK-PO-NBR                   10730000
107400                                      ASC-PO-NBR                  10740000
107500                     MOVE ASC-KEY-PO-LNE-NBR                      10750000
107600                                   TO ASC-PO-LNE-NBR-N            10760000
107700                                      DK-PO-LNE-NBR               10770000
107800                     MOVE ASC-KEY-REC-SEQ-NBR                     10780000
107900                                   TO ASC-REC-SEQ-NBR             10790000
108000                                      DK-REC-SEQ-NBR              10800000
108100                     MOVE ASC-KEY-OPER-UNT-ID                     10810000
108200                                   TO ASC-OPER-UNT-ID             10820000
108300                     MOVE ASC-KEY-FCLTY-ID                        10830000
108400                                   TO ASC-FCLTY-ID                10840000
108500                                                                  10850000
108600                     PERFORM 4000-BUILD-INITIAL-PANEL             10860000
108700                     PERFORM 3200-RESET-ATTRIBUTES                10870000
108800                 END-IF                                           10880000
108900             ELSE                                                 10890000
109000*                --- TOP OF LIST ---                              10900000
109100                 MOVE PC-TSYMSG-00069                             10910000
109200                                   TO DP020-MSG-NUMBER            10920000
109300                 SET DP020-MSG-INFORMATIONAL                      10930000
109400                     PS-LIST-END   TO TRUE                        10940000
109500             END-IF                                               10950000
109600*                                                                 10960000
109700*    CONFIRM USED ONLY FOR DELETE FUNCTION.                       10970000
109800*                                                                 10980000
109900         WHEN DP020-FK-CONFIRM(DP020-SRC-AID)                     10990000
110000              IF  ASC-DELETED                                     11000000
110100                  MOVE PC-TSYMSG-00116                            11010000
110200                                   TO  DP020-MSG-NUMBER           11020000
110300                  SET DP020-MSG-FATAL                             11030000
110400                      PS-ERROR     TO  TRUE                       11040000
110500              ELSE                                                11050000
110600                  PERFORM 7000-DELETE-PROCESS                     11060000
110700              END-IF                                              11070000
110800                                                                  11080000
110900         WHEN OTHER                                               11090000
111000              IF  ASC-NOT-FOUND                                   11100000
111100                  MOVE PC-TSYMSG-00148                            11110000
111200                                   TO  DP020-MSG-NUMBER           11120000
111300                  SET DP020-MSG-FATAL                             11130000
111400                          PS-ERROR TO  TRUE                       11140000
111500              ELSE                                                11150000
111600                  PERFORM 2200-MOVE-SCREEN-TO-COMMAREA            11160000
111700                  PERFORM 3000-EDIT-DATA-IN-COMMAREA              11170000
111800                  IF  PS-NO-ERROR                                 11180000
111900                      SET DP030-CONTINUE-GO                       11190000
112000                                   TO TRUE                        11200000
112100                      PERFORM 2100-CHECK-FUNCTION-KEY             11210000
112200                  ELSE                                            11220000
112300                      SET DP030-OVERRIDE-GO                       11230000
112400                                   TO TRUE                        11240000
112500                  END-IF                                          11250000
112600              END-IF                                              11260000
112700     END-EVALUATE.                                                11270000
112800                                                                  11280000
112900/                                                                 11290000
113000*----------------------------------------------------------------*11300000
113100*    ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED    *11310000
113200*    FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED*11320000
113300*    FROM THE CICS ARCHITECTURE API.                             *11330000
113400*----------------------------------------------------------------*11340000
113500                                                                  11350000
113600 2100-CHECK-FUNCTION-KEY.                                         11360000
113700                                                                  11370000
113800     EVALUATE TRUE                                                11380000
113900         WHEN DP020-SRC-AID = DP016-ENTER                         11390000
114000             CONTINUE                                             11400000
114100                                                                  11410000
114200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              11420000
114300             IF ASC-RECITM-STATUS-CM-VE                           11430000
114400                 MOVE PC-TSYMSG-00929                             11440000
114500                                   TO DP020-MSG-NUMBER            11450000
114600                 SET DP020-MSG-FATAL                              11460000
114700                                   TO TRUE                        11470000
114800             ELSE                                                 11480000
114900                 PERFORM 2130-CHECK-PACK-BY-STORE                 11490000
115000                 IF  PV-PACK-BY-ST-IND-YES                        11500000
115100                     MOVE PC-TSYMSG-00928                         11510000
115200                                   TO DP020-MSG-NUMBER            11520000
115300                     SET DP020-MSG-FATAL                          11530000
115400                                   TO TRUE                        11540000
115500                 ELSE                                             11550000
115600                     SET DP030-CONTINUE-GO                        11560000
115700                                   TO TRUE                        11570000
115800                                                                  11580000
115900                     PERFORM 6000-PROCESS-REDISTRO                11590000
116000                 END-IF                                           11600000
116100             END-IF                                               11610000
116200                                                                  11620000
116300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              11630000
116400           IF ASC-PREPACK-RECEIVER                                11640000
116500                MOVE PC-TSYMSG-02463                              11650000
116600                                   TO DP020-MSG-NUMBER            11660000
116700                SET PS-ERROR                                      11670000
116800                    DP030-OVERRIDE-GO                             11680000
116900                    DP020-MSG-FATAL                               11690000
117000                                   TO TRUE                        11700000
117100           ELSE                                                   11710000
117200* JAK 04/08/07 - LOAD KEYS                                        11720000
117300              MOVE ASC-KEY-PO-NBR           TO DK-PO-NBR          11730000
117400              MOVE ASC-KEY-REC-SEQ-NBR      TO DK-REC-SEQ-NBR     11740000
117500              PERFORM 2400-WMS-PROCESS                            11750000
117600              PERFORM 2410-CHECK-IF-RCVG-BEGAN                    11760000
117700* TCR 05/09/07 - IF RCVG BEGAN, THEN NO UPDATE TO DETAIL CHECK QTY11770000
117800                IF PV-HDR-REC-COUNT > 0                           11780000
117900                   SET DP030-OVERRIDE-GO                          11790000
118000                       DP020-MSG-WARNING                          11800000
118100                              TO TRUE                             11810000
118200                    MOVE PC-TSYMSG-03563                          11820000
118300                                   TO DP020-MSG-NUMBER            11830000
118400                ELSE                                              11840000
118500* TCR 05/10/07IF PS-INACTIVATE-NO                                 11850000
118600* TCR 05/10/07     SET DP030-OVERRIDE-GO                          11860000
118700* TCR 05/10/07         DP020-MSG-WARNING                          11870000
118800* TCR 05/10/07                TO TRUE                             11880000
118900* TCR 05/10/07     MOVE PC-TSYMSG-03537                           11890000
119000* TCR 05/10/07                TO DP020-MSG-NUMBER                 11900000
119100* TCR 05/10/07ELSE                                                11910000
119200                MOVE ASC-SEL-QUEUE-NAME                           11920000
119300                                   TO PC000-SEL-QUEUE-NAME        11930000
119400                MOVE ASC-KEY-PO-NBR           TO DK-PO-NBR        11940000
119500                MOVE ASC-PO-LNE-NBR-N         TO DK-PO-LNE-NBR    11950000
119600                MOVE ASC-KEY-REC-SEQ-NBR      TO DK-REC-SEQ-NBR   11960000
119700                                                                  11970000
119800                PERFORM 8000-SELECT-RECITM                        11980000
119900                                                                  11990000
120000                PERFORM 2130-CHECK-PACK-BY-STORE                  12000000
120100                IF PV-PACK-BY-ST-IND-YES                          12010000
120200                    PERFORM 8100-ARE-CARTONS-CHECKED-IN           12020000
120300                END-IF                                            12030000
120400                IF ASC-DTL-CK-ITM-QTY-N NOT =                     12040000
120500                              RECITM-DTL-CK-ITM-QTY AND           12050000
120600                  (RECITM-RCPT-DISTR-UPD-CDE = PC-A OR            12060000
120700                   RECITM-RCPT-DISTR-UPD-CDE = PC-U)              12070000
120800                    MOVE RECITM-DTL-CK-ITM-QTY                    12080000
120900                                   TO ASC-DTL-CK-ITM-QTY-N        12090000
121000                                      ADCQTYO                     12100000
121100                    MOVE 'RETURN  ' TO PC000-SEL-QUEUE-NAME       12110000
121200                    MOVE PC-TSYMSG-01256                          12120000
121300                                   TO DP020-MSG-NUMBER            12130000
121400                    SET DP020-MSG-FATAL                           12140000
121500                                   TO TRUE                        12150000
121600                ELSE                                              12160000
121700                IF (ASC-INNR-PACK-QTY-N NOT =                     12170000
121800                              RECITM-INNR-PACK-QTY) AND           12180000
121900                   ASC-CASEPACK-FOUND                             12190000
122000                    MOVE 'RETURN  ' TO PC000-SEL-QUEUE-NAME       12200000
122100                    MOVE PC-TSYMSG-01801                          12210000
122200                                   TO DP020-MSG-NUMBER            12220000
122300                    SET DP020-MSG-FATAL                           12230000
122400                                   TO TRUE                        12240000
122500                ELSE                                              12250000
122600                IF (ASC-DTL-CK-ITM-QTY-N NOT =                    12260000
122700                              RECITM-DTL-CK-ITM-QTY) AND          12270000
122800                   ASC-CASEPACK-FOUND                             12280000
122900                    MOVE 'RETURN  ' TO PC000-SEL-QUEUE-NAME       12290000
123000                    MOVE PC-TSYMSG-01795                          12300000
123100                                   TO DP020-MSG-NUMBER            12310000
123200                    SET DP020-MSG-FATAL                           12320000
123300                                   TO TRUE                        12330000
123400                ELSE                                              12340000
123500                IF (ASC-DTL-CK-ITM-QTY-N NOT =                    12350000
123600                              RECITM-DTL-CK-ITM-QTY) AND          12360000
123700                    PV-PACK-BY-ST-IND-YES AND                     12370000
123800                    PS-CHECKED-IN-FOUND                           12380000
123900                    MOVE PC-TSYMSG-03355                          12390000
124000                                   TO DP020-MSG-NUMBER            12400000
124100                    SET DP020-MSG-FATAL                           12410000
124200                        DP030-OVERRIDE-GO                         12420000
124300                                   TO TRUE                        12430000
124400                ELSE                                              12440000
124500                IF ASC-RECITM-STATUS-CM-VE                        12450000
124600                    MOVE 'RETURN  ' TO PC000-SEL-QUEUE-NAME       12460004
124700                    MOVE PC-TSYMSG-00929                          12470000
124800                                   TO DP020-MSG-NUMBER            12480000
124900                    SET DP020-MSG-FATAL                           12490000
125000                                   TO TRUE                        12500000
125100                ELSE                                              12510000
125200                    SET DP030-CONTINUE-GO                         12520000
125300                                   TO TRUE                        12530000
125400                    MOVE ASC-SEL-QUEUE-NAME                       12540000
125500                                   TO PC000-SEL-QUEUE-NAME        12550000
125600                    IF (ASC-DTL-CK-ITM-QTY-N NOT =                12560000
125700                                  RECITM-DTL-CK-ITM-QTY) AND      12570000
125800                        PV-PACK-BY-ST-IND-YES                     12580000
125900                         SET PS-INACTIVATE-CARTONS TO TRUE        12590000
126000                    ELSE                                          12600000
126100                         SET PS-DONT-INACTIVATE-CARTONS TO TRUE   12610000
126200                    END-IF                                        12620000
126300                    PERFORM 5000-UPDATE-RECITM-SELECT             12630000
126400                    IF PS-ASNS-TO-WMS-YES                         12640000
126500                        SET WS001-PKSLIP-INACTIVE TO TRUE         12650000
126600                        PERFORM 2800-CALL-WMS-MODULE              12660000
126700                    END-IF                                        12670000
126800                    MOVE ASC-KEY-PO-NBR   TO PC000-PO-NBR-N       12680000
126900                    MOVE ASC-DEPT-NBR     TO PC000-DEPT-NBR       12690000
127000                    MOVE ASC-ENT-ID       TO PC000-ENT-ID         12700000
127100                    MOVE ASC-PO-LNE-NBR-N TO PC000-LINE-NBR-N     12710000
127200                    MOVE ASC-KEY-REC-SEQ-NBR                      12720000
127300                                   TO PC000-REC-SEQ-NBR-N         12730000
127400                    MOVE ASC-KEY-OPER-UNT-ID                      12740000
127500                                   TO PC000-OPERATING-UNIT-ID     12750000
127600                    MOVE ASC-KEY-FCLTY-ID TO PC000-FACILITY-ID    12760000
127700                    MOVE ASC-NUMBER-OF-SELECTED-ITEMS             12770000
127800                               TO PC000-NUMBER-OF-SELECTED-ITEMS  12780000
127900                    MOVE ASC-NUMBER-OF-TS-ITEMS                   12790000
128000                                   TO PC000-NUMBER-OF-TS-ITEMS    12800000
128100                END-IF                                            12810000
128200                END-IF                                            12820000
128300                END-IF                                            12830000
128400                END-IF                                            12840000
128500                END-IF                                            12850000
128600              END-IF                                              12860000
128700             END-IF                                               12870000
128800                                                                  12880000
128900         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              12890000
129000             IF ASC-PREPACK-RECEIVER                              12900000
129100                MOVE PC-TSYMSG-02463                              12910000
129200                                   TO DP020-MSG-NUMBER            12920000
129300                SET PS-ERROR                                      12930000
129400                    DP030-OVERRIDE-GO                             12940000
129500                    DP020-MSG-FATAL                               12950000
129600                                   TO TRUE                        12960000
129700             ELSE                                                 12970000
129800                MOVE ASC-KEY-PO-NBR   TO PC000-PO-NBR-N           12980000
129900                MOVE ASC-DEPT-NBR     TO PC000-DEPT-NBR           12990000
130000                MOVE ASC-ENT-ID       TO PC000-ENT-ID             13000000
130100                MOVE ASC-PO-LNE-NBR-N TO PC000-LINE-NBR-N         13010000
130200                MOVE ASC-SEL-QUEUE-NAME                           13020000
130300                                   TO PC000-SEL-QUEUE-NAME        13030000
130400                MOVE ASC-KEY-REC-SEQ-NBR                          13040000
130500                                   TO PC000-REC-SEQ-NBR-N         13050000
130600                MOVE ASC-KEY-OPER-UNT-ID                          13060000
130700                                   TO PC000-OPERATING-UNIT-ID     13070000
130800                MOVE ASC-KEY-FCLTY-ID TO PC000-FACILITY-ID        13080000
130900                MOVE ASC-NUMBER-OF-SELECTED-ITEMS                 13090000
131000                               TO PC000-NUMBER-OF-SELECTED-ITEMS  13100000
131100                MOVE ASC-NUMBER-OF-TS-ITEMS                       13110000
131200                                   TO PC000-NUMBER-OF-TS-ITEMS    13120000
131300             END-IF                                               13130000
131400                                                                  13140000
131500         WHEN OTHER                                               13150000
131600             SET DP013-NO-ROLLBACK                                13160000
131700                 DP013-XCTL-DISPLAY-RESTART                       13170000
131800                 DP013-CICS-ABEND  TO TRUE                        13180000
131900             MOVE '2100-CHECK-FUNCTION-KEY'                       13190000
132000                                   TO DP013-PARAGRAPH             13200000
132100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      13210000
132200                                   TO DP013-MESSAGE-TEXT (1)      13220000
132300             PERFORM DP013-0000-PROCESS-ABEND                     13230000
132400     END-EVALUATE.                                                13240000
132500                                                                  13250000
132600/                                                                 13260000
132700*----------------------------------------------------------------*13270000
132800*    GET THE RECITM (KEY) OF THE NEXT SELECTED OBJECT            *13280000
132900*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *13290000
133000*----------------------------------------------------------------*13300000
133100 2110-GET-NEXT-RECITM-SELECT.                                     13310000
133200                                                                  13320000
133300     ADD +1                        TO ASC-SEL-SUB.                13330000
133400     IF  ASC-SEL-SUB > PC016-MAX-ITEMS                            13340000
133500         ADD +1                    TO ASC-SEL-ITEM                13350000
133600         MOVE +1                   TO ASC-SEL-SUB                 13360000
133700     END-IF.                                                      13370000
133800                                                                  13380000
133900     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                13390000
134000         PERFORM 9100-READ-SEL-QUEUE                              13400000
134100         IF  PC016-ITEM (ASC-SEL-SUB) > ZERO                      13410000
134200             MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                  13420000
134300                                   TO ASC-PO-LNE-NBR-N            13430000
134400                                      ASC-KEY-PO-LNE-NBR          13440000
134500                                      DK-PO-LNE-NBR               13450000
134600                                                                  13460000
134700             MOVE PC016-PO-NBR-N (ASC-SEL-SUB)                    13470000
134800                                   TO DK-PO-NBR                   13480000
134900                                      ASC-KEY-PO-NBR              13490000
135000                                      ASC-PO-NBR                  13500000
135100                                                                  13510000
135200             MOVE PC016-REC-SEQ-NBR-N (ASC-SEL-SUB)               13520000
135300                                   TO ASC-KEY-REC-SEQ-NBR         13530000
135400                                      ASC-REC-SEQ-NBR             13540000
135500                                      DK-REC-SEQ-NBR              13550000
135600                                                                  13560000
135700             MOVE PC016-OPER-UNT-ID (ASC-SEL-SUB)                 13570000
135800                                   TO ASC-KEY-OPER-UNT-ID         13580000
135900                                      ASC-OPER-UNT-ID             13590000
136000                                                                  13600000
136100             MOVE PC016-FCLTY-ID (ASC-SEL-SUB)                    13610000
136200                                   TO ASC-KEY-FCLTY-ID            13620000
136300                                      ASC-FCLTY-ID                13630000
136400             SET PC016-INQ           (ASC-SEL-SUB)                13640000
136500                 ASC-NOT-DELETED   TO TRUE                        13650000
136600             PERFORM 9200-REWRITE-SEL-QUEUE                       13660000
136700         ELSE                                                     13670000
136800             SUBTRACT +1 FROM ASC-SEL-SUB                         13680000
136900*            --- BOTTOM OF LIST ---                               13690000
137000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            13700000
137100             SET DP020-MSG-INFORMATIONAL                          13710000
137200                 PS-LIST-END                                      13720000
137300                                   TO TRUE                        13730000
137400         END-IF                                                   13740000
137500     ELSE                                                         13750000
137600         SUBTRACT +1 FROM ASC-SEL-ITEM                            13760000
137700         MOVE PC016-MAX-ITEMS      TO ASC-SEL-SUB                 13770000
137800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            13780000
137900         SET DP020-MSG-INFORMATIONAL                              13790000
138000             PS-LIST-END           TO TRUE                        13800000
138100     END-IF.                                                      13810000
138200                                                                  13820000
138300/                                                                 13830000
138400*----------------------------------------------------------------*13840000
138500*    GET THE RECITM (KEY) OF THE PREVIOUS SELECTED               *13850000
138600*    OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.         *13860000
138700*----------------------------------------------------------------*13870000
138800 2120-GET-PREV-RECITM-SELECT.                                     13880000
138900                                                                  13890000
139000     SUBTRACT +1 FROM ASC-SEL-SUB.                                13900000
139100     IF  ASC-SEL-SUB < +1                                         13910000
139200         SUBTRACT +1 FROM ASC-SEL-ITEM                            13920000
139300         MOVE PC016-MAX-ITEMS      TO ASC-SEL-SUB                 13930000
139400     END-IF.                                                      13940000
139500                                                                  13950000
139600     IF  ASC-SEL-ITEM > ZERO                                      13960000
139700         PERFORM 9100-READ-SEL-QUEUE                              13970000
139800         INITIALIZE ASC-SCREEN-FIELDS                             13980000
139900         MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                      13990000
140000                                   TO ASC-PO-LNE-NBR-N            14000000
140100                                      ASC-KEY-PO-LNE-NBR          14010000
140200                                      DK-PO-LNE-NBR               14020000
140300                                                                  14030000
140400         MOVE PC016-PO-NBR-N (ASC-SEL-SUB)                        14040000
140500                                   TO DK-PO-NBR                   14050000
140600                                      ASC-KEY-PO-NBR              14060000
140700                                      ASC-PO-NBR                  14070000
140800                                                                  14080000
140900         MOVE PC016-REC-SEQ-NBR-N (ASC-SEL-SUB)                   14090000
141000                                   TO ASC-KEY-REC-SEQ-NBR         14100000
141100                                      ASC-REC-SEQ-NBR             14110000
141200                                      DK-REC-SEQ-NBR              14120000
141300                                                                  14130000
141400         MOVE PC016-OPER-UNT-ID (ASC-SEL-SUB)                     14140000
141500                                   TO ASC-KEY-OPER-UNT-ID         14150000
141600                                      ASC-OPER-UNT-ID             14160000
141700                                                                  14170000
141800         MOVE PC016-FCLTY-ID (ASC-SEL-SUB)                        14180000
141900                                   TO ASC-KEY-FCLTY-ID            14190000
142000                                      ASC-FCLTY-ID                14200000
142100     ELSE                                                         14210000
142200         MOVE +1                   TO ASC-SEL-ITEM                14220000
142300                                      ASC-SEL-SUB                 14230000
142400*        --- TOP OF LIST ---                                      14240000
142500         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            14250000
142600         SET DP020-MSG-INFORMATIONAL                              14260000
142700             PS-LIST-END           TO TRUE                        14270000
142800     END-IF.                                                      14280000
142900/                                                                 14290000
143000*----------------------------------------------------------------*14300000
143100*    GET THE CURRENT ROW FOR PROCESSING.                         *14310000
143200*----------------------------------------------------------------*14320000
143300                                                                  14330000
143400 2130-CHECK-PACK-BY-STORE.                                        14340000
143500     MOVE ASC-KEY-PO-NBR           TO PV-PO-NBR.                  14350000
143600     MOVE ASC-KEY-REC-SEQ-NBR      TO PV-REC-SEQ-NBR.             14360000
143700                                                                  14370000
143800     EXEC SQL                                                     14380000
143900          SELECT PACK_BY_ST_IND                                   14390000
144000            INTO :PV-PACK-BY-ST-IND                               14400000
144100            FROM TRECEIV                                          14410000
144200           WHERE ORD_NBR         =  :PV-PO-NBR                    14420000
144300             AND REC_SEQ_NBR     =  :PV-REC-SEQ-NBR               14430000
144400             AND OPER_UNT_ID     =  :ASC-KEY-OPER-UNT-ID          14440000
144500             AND FCLTY_ID        =  :ASC-KEY-FCLTY-ID             14450000
144600             AND VER_STATUS_CDE  =  :PC-A                         14460000
144700     END-EXEC.                                                    14470000
144800                                                                  14480000
144900     EVALUATE TRUE                                                14490000
145000         WHEN SQLCODE = ZERO                                      14500000
145100              CONTINUE                                            14510000
145200         WHEN SQLWARN0 NOT = SPACE                                14520000
145300         WHEN SQLCODE NOT = ZERO                                  14530000
145400              MOVE  PV-PO-NBR       TO  PV-DISPLAY-PO             14540001
145500              MOVE  PV-REC-SEQ-NBR  TO  PV-DISPLAY-RCVR           14550001
145600              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             14560001
145700              STRING  PV-DISPLAY-PO   '-'                         14570001
145800                      PV-DISPLAY-RCVR    DELIMITED BY SIZE        14580001
145900                          INTO DP013-MESSAGE-TEXT (2)             14590001
146000                                                                  14600001
146100              MOVE '2130-CHECK-PACK-BY-STORE'                     14610000
146200                               TO DP013-PARAGRAPH                 14620000
146300              MOVE 'SELECT TRECEIV'                               14630000
146400                               TO DP013-MESSAGE-TEXT (1)          14640000
146500              MOVE SQLCA       TO DP013-SQLCA                     14650000
146600              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        14660000
146700              SET DP013-DB2-ABEND                                 14670000
146800                               TO TRUE                            14680000
146900              PERFORM DP013-0000-PROCESS-ABEND                    14690000
147000     END-EVALUATE.                                                14700000
147100/                                                                 14710000
147200*----------------------------------------------------------------*14720000
147300*  CHECK PACKAGING CODE TO DETERMINE ACCESS                      *14730000
147400*----------------------------------------------------------------*14740000
147500 2140-CHECK-PACKAGING-CODE.                                       14750000
147600     MOVE ASC-KEY-PO-NBR           TO PV-PO-NBR.                  14760000
147700     MOVE ASC-KEY-REC-SEQ-NBR      TO PV-REC-SEQ-NBR.             14770000
147800                                                                  14780000
147900     EXEC SQL                                                     14790000
148000          SELECT PKGNG_CDE                                        14800000
148100            INTO :RECEIV-PKGNG-CDE                                14810000
148200            FROM TRECEIV                                          14820000
148300           WHERE ORD_NBR         =  :PV-PO-NBR                    14830000
148400             AND REC_SEQ_NBR     =  :PV-REC-SEQ-NBR               14840000
148500             AND OPER_UNT_ID     =  :ASC-KEY-OPER-UNT-ID          14850000
148600             AND FCLTY_ID        =  :ASC-KEY-FCLTY-ID             14860000
148700             AND VER_STATUS_CDE  =  :PC-A                         14870000
148800     END-EXEC.                                                    14880000
148900                                                                  14890000
149000     EVALUATE TRUE                                                14900000
149100         WHEN SQLCODE = ZERO                                      14910000
149200              MOVE RECEIV-PKGNG-CDE         TO ASC-PKGNG-CODE     14920000
149300         WHEN SQLWARN0 NOT = SPACE                                14930000
149400         WHEN SQLCODE NOT = ZERO                                  14940000
149500              MOVE  PV-PO-NBR       TO  PV-DISPLAY-PO             14950001
149600              MOVE  PV-REC-SEQ-NBR  TO  PV-DISPLAY-RCVR           14960001
149700              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             14970001
149800              STRING  PV-DISPLAY-PO   '-'                         14980001
149900                      PV-DISPLAY-RCVR    DELIMITED BY SIZE        14990001
150000                          INTO DP013-MESSAGE-TEXT (2)             15000001
150100                                                                  15010001
150200              MOVE '2140-CHECK-PACKAGING-CODE'                    15020000
150300                               TO DP013-PARAGRAPH                 15030000
150400              MOVE 'SELECT TRECEIV'                               15040000
150500                               TO DP013-MESSAGE-TEXT (1)          15050000
150600              MOVE SQLCA       TO DP013-SQLCA                     15060000
150700              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        15070000
150800              SET DP013-DB2-ABEND                                 15080000
150900                               TO TRUE                            15090000
151000              PERFORM DP013-0000-PROCESS-ABEND                    15100000
151100     END-EVALUATE.                                                15110000
151200*----------------------------------------------------------------*15120000
151300*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *15130000
151400*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *15140000
151500*----------------------------------------------------------------*15150000
151600 2200-MOVE-SCREEN-TO-COMMAREA.                                    15160000
151700                                                                  15170000
151800     IF AINNRL > ZERO                                             15180000
151900         MOVE AINNRI               TO ASC-INNR-PACK-QTY           15190000
152000     ELSE                                                         15200000
152100         IF AINNRF = DP015-ERASE-EOF                              15210000
152200             MOVE ZEROS            TO ASC-INNR-PACK-QTY-N         15220000
152300         END-IF                                                   15230000
152400     END-IF.                                                      15240000
152500                                                                  15250000
152600     IF ACASEL > ZERO                                             15260000
152700         MOVE ACASEI               TO ASC-CASE-PACK-QTY           15270000
152800     ELSE                                                         15280000
152900         IF ACASEF = DP015-ERASE-EOF                              15290000
153000             MOVE ZEROS            TO ASC-CASE-PACK-QTY-N         15300000
153100         END-IF                                                   15310000
153200     END-IF.                                                      15320000
153300                                                                  15330000
153400     IF ADCQTYL > ZERO                                            15340000
153500         IF ADCQTYI = SPACES                                      15350000
153600             MOVE ZEROS            TO ASC-DTL-CK-ITM-QTY-N        15360000
153700         ELSE                                                     15370000
153800             MOVE ADCQTYI          TO ASC-DTL-CK-ITM-QTY          15380000
153900         END-IF                                                   15390000
154000     ELSE                                                         15400000
154100         IF ADCQTYF = DP015-ERASE-EOF                             15410000
154200             MOVE ZEROS            TO ASC-DTL-CK-ITM-QTY-N        15420000
154300         END-IF                                                   15430000
154400     END-IF.                                                      15440000
154500                                                                  15450000
154600     IF APRETKTL > ZERO                                           15460000
154700         MOVE APRETKTI             TO ASC-PRE-TKT-IND             15470000
154800     ELSE                                                         15480000
154900         IF APRETKTF = DP015-ERASE-EOF                            15490000
155000             MOVE ZEROS            TO ASC-PRE-TKT-IND             15500000
155100         END-IF                                                   15510000
155200     END-IF.                                                      15520000
155300                                                                  15530000
155400     IF ADMGL > ZERO                                              15540000
155500         MOVE ADMGI                TO ASC-DMG-ITM-QTY             15550000
155600     ELSE                                                         15560000
155700         IF ADMGF = DP015-ERASE-EOF                               15570000
155800             MOVE ZEROS            TO ASC-DMG-ITM-QTY-N           15580000
155900         END-IF                                                   15590000
156000     END-IF.                                                      15600000
156100                                                                  15610000
156200     IF ARTVINDL > ZERO                                           15620000
156300         MOVE ARTVINDI             TO ASC-RTV-IND                 15630000
156400     ELSE                                                         15640000
156500         IF ARTVINDF = DP015-ERASE-EOF                            15650000
156600             MOVE SPACES           TO ASC-RTV-IND                 15660000
156700         END-IF                                                   15670000
156800     END-IF.                                                      15680000
156900                                                                  15690000
157000     IF ARTVQTYL > ZERO                                           15700000
157100         MOVE ARTVQTYI             TO ASC-RTV-QTY                 15710000
157200     ELSE                                                         15720000
157300         IF ARTVQTYF = DP015-ERASE-EOF                            15730000
157400             MOVE ZEROS            TO ASC-RTV-QTY-N               15740000
157500         END-IF                                                   15750000
157600     END-IF.                                                      15760000
157700                                                                  15770000
157800     IF ACOSTL > ZERO                                             15780000
157900         MOVE ACOSTI               TO ASC-UNT-COST-AMT            15790000
158000     ELSE                                                         15800000
158100         IF ACOSTF = DP015-ERASE-EOF                              15810000
158200             MOVE ZEROS            TO ASC-UNT-COST-AMT-N          15820000
158300         END-IF                                                   15830000
158400     END-IF.                                                      15840000
158500                                                                  15850000
158600     IF AMTCHL > ZERO                                             15860000
158700         MOVE AMTCHI               TO ASC-MTCH-TO-LINE            15870000
158800     ELSE                                                         15880000
158900         IF AMTCHF = DP015-ERASE-EOF                              15890000
159000             MOVE ZEROS            TO ASC-MTCH-TO-LINE-N          15900000
159100         END-IF                                                   15910000
159200     END-IF.                                                      15920000
159300*---------------------------------------------------------------- 15930000
159400 2400-WMS-PROCESS.                                                15940000
159500                                                                  15950000
159600     SET PS-ASNS-TO-WMS-NO TO TRUE.                               15960000
159700* JAK 06/2007 - ADD CALL TO 2460-                                 15970001
159800     PERFORM 2460-SELECT-TRECEIV.                                 15980000
159900     PERFORM 2450-CHECK-TKRPRPM.                                  15990001
160000     IF PS-ASNS-TO-WMS-YES                                        16000000
160100        PERFORM 2500-GET-SHIPMENT-INFO                            16010000
160200        PERFORM 2600-SELECT-WST-XREF                              16020000
160300     ELSE                                                         16030000
160400        SET PS-INACTIVATE-YES TO TRUE                             16040000
160500     END-IF.                                                      16050000
160600/                                                                 16060000
160700*---------------------------------------------------------------- 16070000
160800 2410-CHECK-IF-RCVG-BEGAN.                                        16080000
160900                                                                  16090000
161000     MOVE 0 TO PV-HDR-REC-COUNT.                                  16100000
161100                                                                  16110000
161200     EXEC SQL                                                     16120000
161300          SELECT   COUNT(*)                                       16130000
161400            INTO  :PV-HDR-REC-COUNT                               16140000
161500            FROM  WST_SHPMT_XREF_HDR  HDR                         16150000
161600                , WST_SHPMT_XREF_DTL  DTL                         16160000
161700            WHERE HDR.EXT_SHP_ID   = DTL.EXT_SHP_ID               16170000
161800              AND DTL.PO_NBR       = :DK-PO-NBR                   16180000
161900              AND DTL.RCVR_SEQ_NBR = :DK-REC-SEQ-NBR              16190000
162000              AND NOT RCPT_TMST    = :PC-DEFAULT-TMST             16200000
162100     END-EXEC.                                                    16210000
162200                                                                  16220000
162300     EVALUATE TRUE                                                16230000
162400         WHEN SQLCODE = ZERO                                      16240000
162500              CONTINUE                                            16250000
162600         WHEN SQLCODE = +100                                      16260000
162700              CONTINUE                                            16270000
162800         WHEN SQLWARN0 NOT = SPACES                               16280000
162900         WHEN SQLCODE < +0                                        16290000
163000         WHEN SQLCODE > +0                                        16300000
163100              MOVE  PV-PO-NBR       TO  PV-DISPLAY-PO             16310001
163200              MOVE  PV-REC-SEQ-NBR  TO  PV-DISPLAY-RCVR           16320001
163300              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             16330001
163400              STRING  PV-DISPLAY-PO   '-'                         16340001
163500                      PV-DISPLAY-RCVR    DELIMITED BY SIZE        16350001
163600                          INTO DP013-MESSAGE-TEXT (2)             16360001
163700                                                                  16370001
163800              MOVE '2410-CHECK-IF-RCVG-BEGAN'                     16380000
163900                                  TO DP013-PARAGRAPH              16390000
164000              MOVE 'UNSUCCESSFUL SELECT ON WST_SHPMT_XREF_HDR'    16400000
164100                                  TO DP013-MESSAGE-TEXT (1)       16410000
164200              MOVE SQLCA          TO DP013-SQLCA                  16420000
164300              MOVE 'WST_SHPMT_XREF_HDR'                           16430000
164400                                  TO DP013-DB2-TABLE-NAME (1)     16440000
164500              SET DP013-DB2-ABEND                                 16450000
164600                  DP013-XCTL-DISPLAY-RESTART                      16460000
164700                                  TO TRUE                         16470000
164800              PERFORM DP013-0000-PROCESS-ABEND                    16480000
164900     END-EVALUATE.                                                16490000
165000/                                                                 16500000
165100*----------------------------------------------------------------*16510000
165200*  CHECK PARM TABLE TO SEE IF DC IS TURNED ON TO DOWNLOAD ASN'S  *16520000
165300*   TO WMS.                                                      *16530000
165400*----------------------------------------------------------------*16540000
165500 2450-CHECK-TKRPRPM.                                              16550000
165600                                                                  16560000
165700     INITIALIZE DCLTKRPRPM.                                       16570000
165800* JAK 06/2007 -  USE CURRENT OPER UNIT ID FOR READ                16580001
165900     MOVE RECEIV-CURR-OPER-UNT-ID  TO KRPRPM-LOC-ID.              16590000
166000                                                                  16600000
166100     EXEC SQL                                                     16610000
166200          SELECT   FUNC_TXT                                       16620000
166300            INTO  :KRPRPM-FUNC-TXT                                16630000
166400            FROM                                                  16640000
166500                  TKRPRPM                                         16650000
166600            WHERE                                                 16660000
166700                  LOC_ID            = :KRPRPM-LOC-ID              16670000
166800              AND SYS_PRC_FUNC_CDE  = 'ASNDWN'                    16680000
166900              AND FUNC_PRC_STAT_CDE = 'AC'                        16690000
167000              AND INTFC_SYS_CDE     = 'KHL'                       16700000
167100              AND FUNC_TXT          = 'Y'                         16710000
167200              AND FUNC_BEG_TMST    < CURRENT TIMESTAMP            16720000
167300     END-EXEC.                                                    16730000
167400                                                                  16740000
167500     EVALUATE TRUE                                                16750000
167600         WHEN SQLCODE = ZERO                                      16760000
167700              SET PS-ASNS-TO-WMS-YES TO TRUE                      16770000
167800         WHEN SQLCODE = +100                                      16780000
167900              CONTINUE                                            16790000
168000         WHEN SQLWARN0 NOT = SPACES                               16800000
168100         WHEN SQLCODE < +0                                        16810000
168200         WHEN SQLCODE > +0                                        16820000
168300              MOVE '2450-CHECK-TKRPRPM'                           16830000
168400                                  TO DP013-PARAGRAPH              16840000
168500              MOVE 'UNSUCCESSFUL SELECT ON TKRPRPM'               16850000
168600                                  TO DP013-MESSAGE-TEXT (1)       16860000
168700              MOVE SQLCA          TO DP013-SQLCA                  16870000
168800              MOVE 'TKRPRPM'      TO DP013-DB2-TABLE-NAME (1)     16880000
168900              SET DP013-DB2-ABEND                                 16890000
169000                  DP013-XCTL-DISPLAY-RESTART                      16900000
169100                                  TO TRUE                         16910000
169200              PERFORM DP013-0000-PROCESS-ABEND                    16920000
169300     END-EVALUATE.                                                16930000
169400/                                                                 16940000
169500* JAK 06/2007 -  ADD PARAGRAPH TO GET CURRENT OPER UNIT ID.       16950000
169600****************************************************************  16960000
169700*  THIS PARAGRAPH GETS THE CURRENT OPER ID FOR THE PO/RCVR        16970000
169800****************************************************************  16980000
169900 2460-SELECT-TRECEIV.                                             16990000
170000                                                                  17000000
170100     MOVE ASC-KEY-PO-NBR       TO RECEIV-ORD-NBR.                 17010000
170200     MOVE ASC-KEY-REC-SEQ-NBR  TO RECEIV-REC-SEQ-NBR.             17020000
170300                                                                  17030000
170400     EXEC SQL                                                     17040000
170500          SELECT   CURR_OPER_UNT_ID                               17050000
170600            INTO  :RECEIV-CURR-OPER-UNT-ID                        17060000
170700            FROM                                                  17070000
170800                  TRECEIV                                         17080000
170900            WHERE                                                 17090000
171000                  ORD_NBR           = :RECEIV-ORD-NBR             17100000
171100              AND REC_SEQ_NBR       = :RECEIV-REC-SEQ-NBR         17110000
171200              AND VER_STATUS_CDE    = 'A'                         17120000
171300     END-EXEC.                                                    17130000
171400                                                                  17140000
171500     EVALUATE TRUE                                                17150000
171600         WHEN SQLCODE = ZERO                                      17160000
171700         WHEN SQLCODE = -811                                      17170000
171800              CONTINUE                                            17180000
171900         WHEN SQLCODE = +100                                      17190000
172000              MOVE ZERO           TO RECEIV-CURR-OPER-UNT-ID      17200000
172100         WHEN SQLWARN0 NOT = SPACES                               17210000
172200         WHEN SQLCODE  NOT = ZERO                                 17220000
172300              MOVE  RECEIV-ORD-NBR      TO  PV-DISPLAY-PO         17230001
172400              MOVE  RECEIV-REC-SEQ-NBR  TO  PV-DISPLAY-RCVR       17240001
172500              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             17250001
172600              STRING  PV-DISPLAY-PO   '-'                         17260001
172700                      PV-DISPLAY-RCVR    DELIMITED BY SIZE        17270001
172800                          INTO DP013-MESSAGE-TEXT (2)             17280001
172900                                                                  17290001
173000             MOVE '2460-SELECT-TRECEIV'                           17300000
173100                                  TO DP013-PARAGRAPH              17310000
173200             MOVE 'UNSUCCESSFUL SELECT ON TRECEIV'                17320000
173300                                  TO DP013-MESSAGE-TEXT (1)       17330000
173400             MOVE SQLCA           TO DP013-SQLCA                  17340000
173500             MOVE 'TRECEIV '      TO DP013-DB2-TABLE-NAME (1)     17350000
173600             SET DP013-DB2-ABEND                                  17360000
173700                 DP013-XCTL-DISPLAY-RESTART                       17370000
173800                                  TO TRUE                         17380000
173900             PERFORM DP013-0000-PROCESS-ABEND                     17390000
174000     END-EVALUATE.                                                17400000
174100* JAK 06/2007 -  END                                              17410000
174200                                                                  17420000
174300*----------------------------------------------------------------*17430000
174400*  OBTAIN TRIP ID THAT THE PO/REC IS ATTACHED TO                  17440000
174500*----------------------------------------------------------------*17450000
174600 2500-GET-SHIPMENT-INFO.                                          17460000
174700                                                                  17470000
174800         EXEC SQL                                                 17480000
174900            SELECT  B.SHIPT_ID                                    17490000
175000                   ,B.TRIP_ID                                     17500000
175100              INTO :SHIPMT-SHIPT-ID                               17510000
175200                  ,:SHIPMT-TRIP-ID                                17520000
175300              FROM  TSHPTPO A                                     17530000
175400                   ,TSHIPMT B                                     17540000
175500          WHERE A.PO_NBR      = :DK-PO-NBR                        17550000
175600            AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                   17560000
175700            AND A.PRIM_SHIPT_IND = 'Y'                            17570000
175800            AND A.SHIPT_ID = B.SHIPT_ID                           17580000
175900         END-EXEC                                                 17590000
176000                                                                  17600000
176100         EVALUATE TRUE                                            17610000
176200             WHEN SQLCODE = +0                                    17620000
176300                 MOVE SHIPMT-TRIP-ID  TO DK-TRIP-ID               17630000
176400             WHEN SQLCODE = +100                                  17640000
176500             WHEN SQLCODE = -811                                  17650000
176600             WHEN SQLCODE = -904                                  17660000
176700             WHEN SQLCODE = -913                                  17670000
176800                 CONTINUE                                         17680000
176900                                                                  17690000
177000             WHEN SQLWARN0 NOT = SPACE                            17700000
177100             WHEN SQLCODE < +0                                    17710000
177200             WHEN SQLCODE > +0                                    17720000
177300              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         17730001
177400              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       17740001
177500              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             17750001
177600              STRING  PV-DISPLAY-PO   '-'                         17760001
177700                      PV-DISPLAY-RCVR    DELIMITED BY SIZE        17770001
177800                          INTO DP013-MESSAGE-TEXT (2)             17780001
177900                                                                  17790001
178000                 MOVE '2500-GET-SHIPMENT-INFO'                    17800000
178100                                 TO DP013-PARAGRAPH               17810000
178200                 MOVE 'SELECT SHIPMENT TABLE'                     17820000
178300                                 TO DP013-MESSAGE-TEXT (1)        17830000
178400                 MOVE SQLCA      TO DP013-SQLCA                   17840000
178500                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)      17850000
178600                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (2)      17860000
178700                 SET DP013-DB2-ABEND                              17870000
178800                                 TO TRUE                          17880000
178900                 SET DP013-XCTL-DISPLAY-RESTART                   17890000
179000                                 TO TRUE                          17900000
179100                 PERFORM DP013-0000-PROCESS-ABEND                 17910000
179200         END-EVALUATE.                                            17920000
179300                                                                  17930000
179400*----------------------------------------------------------------*17940000
179500*  CHECK WST_SHPMT_XREF_HDR TABLE TO SEE IF RECEIVING HAS BEGUN   17950000
179600*  WHICH WILL STOP THE PACKSLIP FROM BEING INACTIVATED.           17960000
179700*----------------------------------------------------------------*17970000
179800 2600-SELECT-WST-XREF.                                            17980000
179900                                                                  17990000
180000         EXEC SQL                                                 18000000
180100            SELECT  A.RCPT_TMST                                   18010000
180200              INTO :WST00001-RCPT-TMST                            18020000
180300              FROM  WST_SHPMT_XREF_HDR A                          18030000
180400          WHERE A.INTR_TRIP_ID = :DK-TRIP-ID                      18040000
180500            AND A.SOR_CDE      = 'RC'                             18050000
180600            AND A.RCPT_TMST    < :PC-DEFAULT-TMST                 18060000
180700         END-EXEC                                                 18070000
180800                                                                  18080000
180900         EVALUATE TRUE                                            18090000
181000             WHEN SQLCODE = +0                                    18100000
181100             WHEN SQLCODE = -811                                  18110000
181200                 SET PS-INACTIVATE-NO  TO TRUE                    18120000
181300             WHEN SQLCODE = +100                                  18130000
181400                 SET PS-INACTIVATE-YES TO TRUE                    18140000
181500             WHEN SQLCODE = -904                                  18150000
181600             WHEN SQLCODE = -913                                  18160000
181700                 CONTINUE                                         18170000
181800             WHEN SQLWARN0 NOT = SPACE                            18180000
181900             WHEN SQLCODE < +0                                    18190000
182000             WHEN SQLCODE > +0                                    18200000
182100                 MOVE '2600-SELECT-WST-XREF '                     18210000
182200                                 TO DP013-PARAGRAPH               18220000
182300                 MOVE 'SELECT SHIPMENT TABLE'                     18230000
182400                                 TO DP013-MESSAGE-TEXT (1)        18240000
182500                 MOVE SQLCA      TO DP013-SQLCA                   18250000
182600                 MOVE 'WST_SHPMT_XREF' TO DP013-DB2-TABLE-NAME (1)18260000
182700                 SET DP013-DB2-ABEND                              18270000
182800                                 TO TRUE                          18280000
182900                 SET DP013-XCTL-DISPLAY-RESTART                   18290000
183000                                 TO TRUE                          18300000
183100                 PERFORM DP013-0000-PROCESS-ABEND                 18310000
183200         END-EVALUATE.                                            18320000
183300                                                                  18330000
183400*----------------------------------------------------------------*18340000
183500* CALL TO WMS VENDOR SHIPMENT CONTROL MODULE (WSKCS305) USING     18350000
183600*  COPYBOOK WSWS001.                                              18360000
183700*----------------------------------------------------------------*18370000
183800 2800-CALL-WMS-MODULE.                                            18380000
183900                                                                  18390000
184000     MOVE SHIPMT-TRIP-ID       TO WS001-TRIP-ID.                  18400000
184100     MOVE DK-OPER-UNT-ID       TO WS001-OPER-UNT-ID.              18410000
184200     MOVE DP020-USERID         TO WS001-USER-ID.                  18420000
184300     MOVE DP020-SRC-TASK-NUMBER TO WS001-SRC-TASK-NUMBER.         18430000
184400     MOVE ASC-KEY-PO-NBR       TO WS001-PO-NBR.                   18440000
184500     MOVE ASC-KEY-REC-SEQ-NBR  TO WS001-RCVR-NBR.                 18450000
184600     MOVE RECITM-PO-VER-NBR    TO WS001-PO-LNE-NBR.               18460000
184700     MOVE 'RC'                 TO WS001-SHIPMENT-SOURCE           18470000
184800     MOVE ZEROS                TO WS001-KOHLS-SHIPT-ID.           18480000
184900     MOVE ZEROS                TO WS001-PREPK-ID.                 18490000
185000     MOVE ZEROS                TO WS001-SKU-NBR.                  18500000
185100     MOVE ZEROS                TO WS001-DTL-ASN-LEVEL-IND.        18510000
185200     MOVE 'RCKCS239'           TO WS001-CALLING-PROGRAM-NAME.     18520000
185300                                                                  18530000
185400* JAK 05/08/07 - CHANGE CALL TO LINK                              18540000
185500*    CALL PC-WMS-CONTROL-MOD     USING  DFHEIBLK                  18550000
185600*                                       PC-WMS-CONTROL-MOD-LENGTH 18560000
185700*                                       WS001-FIELDS.             18570000
185800                                                                  18580000
185900     MOVE LENGTH OF WS001-FIELDS TO PV-COMMAREA-LENGTH.           18590000
186000     EXEC CICS                                                    18600000
186100         LINK PROGRAM  (PC-WMS-CONTROL-MOD)                       18610000
186200              COMMAREA (WS001-FIELDS)                             18620000
186300              LENGTH   (PV-COMMAREA-LENGTH)                       18630000
186400     END-EXEC.                                                    18640000
186500                                                                  18650000
186600     EVALUATE TRUE                                                18660000
186700         WHEN WS001-SUCCESSFUL                                    18670000
186800              CONTINUE                                            18680000
186900         WHEN WS001-DATABASE-BUSY OR                              18690000
187000              WS001-INVALID-SQL                                   18700000
187100                  MOVE PC-TSYMSG-03546  TO DP020-MSG-NUMBER       18710000
187200                  SET DP020-MSG-WARNING TO TRUE                   18720000
187300                  SET DP030-OVERRIDE-GO TO TRUE                   18730000
187400                  SET PS-ERROR          TO TRUE                   18740000
187500                                                                  18750000
187600         WHEN WS001-ERROR                                         18760000
187700                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       18770000
187800                  SET DP020-MSG-WARNING TO TRUE                   18780000
187900                  SET DP030-OVERRIDE-GO TO TRUE                   18790000
188000                  SET PS-ERROR          TO TRUE                   18800000
188100                                                                  18810000
188200         WHEN OTHER                                               18820000
188300                                                                  18830000
188400             MOVE '2300-CALL-WMS-MODULE' TO DP013-PARAGRAPH       18840000
188500             MOVE 'UNSUCCESSFUL CALL TO WMS  MOD'                 18850000
188600                                         TO DP013-MESSAGE-TEXT (1)18860000
188700             MOVE WS001-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)18870000
188800             SET DP013-DB2-ABEND                                  18880000
188900                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              18890000
189000             SET PS-ERROR                    TO TRUE              18900000
189100             PERFORM DP013-0000-PROCESS-ABEND                     18910000
189200                                                                  18920000
189300     END-EVALUATE.                                                18930000
189400/                                                                 18940000
189500*----------------------------------------------------------------*18950000
189600*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *18960000
189700*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *18970000
189800*----------------------------------------------------------------*18980000
189900 3000-EDIT-DATA-IN-COMMAREA.                                      18990000
190000                                                                  19000000
190100     SET PS-NO-ERROR               TO TRUE.                       19010000
190200                                                                  19020000
190300     PERFORM 3200-RESET-ATTRIBUTES.                               19030000
190400                                                                  19040000
190500     IF  ASC-MTCH-TO-LINE > SPACES                                19050000
190600         MOVE ASC-MTCH-TO-LINE     TO DP010I-UNEDITED-FIELD       19060000
190700         MOVE LENGTH OF ASC-MTCH-TO-LINE                          19070000
190800                                   TO DP010I-MAXIMUM-DIGITS       19080000
190900         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     19090000
191000         SET DP010I-NEGATIVE-NOT-ALLOWED                          19100000
191100                                   TO TRUE                        19110000
191210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19121007
191220              USING DP010I-NUMERIC-EDIT-AREA                      19122007
191300                                                                  19130000
191400         IF  DP010I-ERROR-DETECTED                                19140000
191500             SET PS-ERROR                                         19150000
191600                 DP020-MSG-FATAL   TO TRUE                        19160000
191700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            19170000
191800             MOVE DP015-UNP-NUM-BRT-OFF                           19180000
191900                                   TO AMTCHA                      19190000
192000             MOVE DP015-RED        TO AMTCHC                      19200000
192100             MOVE DP015-REVERSE    TO AMTCHH                      19210000
192200             MOVE -1               TO AMTCHL                      19220000
192300             SET DP030-SET-CURSOR-APPL-1                          19230000
192400                                   TO TRUE                        19240000
192500         ELSE                                                     19250000
192600             MOVE DP010I-NUMERIC-FIELD                            19260000
192700                                   TO ASC-MTCH-TO-LINE-N          19270000
192800             MOVE ASC-MTCH-TO-LINE TO AMTCHO                      19280000
192900             EVALUATE TRUE                                        19290000
193000                 WHEN ASC-MTCH-TO-LINE > PC-999                   19300000
193100                     SET DP020-MSG-FATAL                          19310000
193200                         PS-ERROR  TO TRUE                        19320000
193300                     MOVE PC-TSYMSG-00005                         19330000
193400                                   TO DP020-MSG-NUMBER            19340000
193500                     MOVE DP015-UNP-NUM-BRT-OFF                   19350000
193600                                   TO AMTCHA                      19360000
193700                     MOVE DP015-RED                               19370000
193800                                   TO AMTCHC                      19380000
193900                     MOVE DP015-REVERSE                           19390000
194000                                   TO AMTCHH                      19400000
194100                     MOVE -1       TO AMTCHL                      19410000
194200                     SET DP030-SET-CURSOR-APPL-1                  19420000
194300                                   TO TRUE                        19430000
194400                                                                  19440000
194500                 WHEN ASC-MTCH-TO-LINE = ZERO                     19450000
194600                     MOVE SPACES   TO ASC-MTCH-TO-LINE            19460000
194700                                      AMTCHO                      19470000
194800                 WHEN OTHER                                       19480000
194900                     MOVE ASC-MTCH-TO-LINE-N                      19490000
195000                                   TO DK-PO-LNE-NBR               19500000
195100                     PERFORM 9050-GET-PURITM                      19510000
195200                     IF PS-PURITM-FOUND                           19520000
195300                         IF PV-PURITM-STATUS-CDE-VALID            19530000
195400                             MOVE PURITM-VER-NBR                  19540000
195500                                   TO ASC-PURITM-VER-NBR          19550000
195600*  CALL THE DOMAIN MODULE TO GET 8 DIGIT SKU                      19560000
195700                             INITIALIZE XL001-ITEM-COMMAREA       19570000
195800                             PERFORM 4085-CALL-CICS-API-ARCH      19580000
195900                         ELSE                                     19590000
196000                             SET PS-ERROR                         19600000
196100                             DP020-MSG-FATAL                      19610000
196200                                   TO TRUE                        19620000
196300                             MOVE PC-TSYMSG-00808                 19630000
196400                                   TO DP020-MSG-NUMBER            19640000
196500                             MOVE DP015-UNP-NUM-BRT-OFF           19650000
196600                                   TO AMTCHA                      19660000
196700                             MOVE DP015-RED                       19670000
196800                                   TO AMTCHC                      19680000
196900                             MOVE DP015-REVERSE                   19690000
197000                                   TO AMTCHH                      19700000
197100                             MOVE -1                              19710000
197200                                   TO AMTCHL                      19720000
197300                             SET DP030-SET-CURSOR-APPL-1          19730000
197400                                   TO TRUE                        19740000
197500                         END-IF                                   19750000
197600                     ELSE                                         19760000
197700                         SET PS-ERROR                             19770000
197800                         DP020-MSG-FATAL                          19780000
197900                                   TO TRUE                        19790000
198000                         MOVE PC-TSYMSG-00084                     19800000
198100                                   TO DP020-MSG-NUMBER            19810000
198200                         MOVE DP015-UNP-NUM-BRT-OFF               19820000
198300                                   TO AMTCHA                      19830000
198400                         MOVE DP015-RED                           19840000
198500                                   TO AMTCHC                      19850000
198600                         MOVE DP015-REVERSE                       19860000
198700                                   TO AMTCHH                      19870000
198800                         MOVE -1   TO AMTCHL                      19880000
198900                         SET DP030-SET-CURSOR-APPL-1              19890000
199000                                   TO TRUE                        19900000
199100                     END-IF                                       19910000
199200             END-EVALUATE                                         19920000
199300         END-IF                                                   19930000
199400     END-IF.                                                      19940000
199500                                                                  19950000
199600     IF  ASC-UNT-COST-AMT > SPACES                                19960000
199700         MOVE ASC-UNT-COST-AMT     TO DP010I-UNEDITED-FIELD       19970000
199800         MOVE LENGTH OF ASC-UNT-COST-AMT                          19980000
199900                                   TO DP010I-MAXIMUM-DIGITS       19990000
200000         MOVE +3                   TO DP010I-MAXIMUM-DECIMALS     20000000
200100         SET DP010I-NEGATIVE-NOT-ALLOWED                          20010000
200200                                   TO TRUE                        20020000
200310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         20031007
200320              USING DP010I-NUMERIC-EDIT-AREA                      20032007
200400                                                                  20040000
200500         IF  DP010I-ERROR-DETECTED                                20050000
200600             SET DP020-MSG-FATAL                                  20060000
200700                 PS-ERROR          TO TRUE                        20070000
200800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            20080000
200900             MOVE DP015-UNP-NUM-BRT-OFF                           20090000
201000                                   TO ACOSTA                      20100000
201100             MOVE DP015-RED        TO ACOSTC                      20110000
201200             MOVE DP015-REVERSE    TO ACOSTH                      20120000
201300             MOVE -1               TO ACOSTL                      20130000
201400             SET DP030-SET-CURSOR-APPL-1                          20140000
201500                                   TO TRUE                        20150000
201600         ELSE                                                     20160000
201700             MOVE DP010I-NUMERIC-FIELD                            20170000
201800                                   TO ASC-UNT-COST-AMT-N          20180000
201900                                      DK-UNT-COST-AMT             20190000
202000             MOVE ASC-UNT-COST-AMT-N                              20200000
202100                                   TO ACOSTO                      20210000
202200             MOVE ACOSTO           TO ASC-UNT-COST-AMT            20220000
202300         END-IF                                                   20230000
202400     END-IF.                                                      20240000
202500                                                                  20250000
202600     IF  ASC-RTV-QTY > SPACES                                     20260000
202700         MOVE ASC-RTV-QTY          TO DP010I-UNEDITED-FIELD       20270000
202800         MOVE LENGTH OF ASC-RTV-QTY                               20280000
202900                                   TO DP010I-MAXIMUM-DIGITS       20290000
203000         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     20300000
203100         SET DP010I-NEGATIVE-NOT-ALLOWED                          20310000
203200                                   TO TRUE                        20320000
203310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         20331007
203320              USING DP010I-NUMERIC-EDIT-AREA                      20332007
203400                                                                  20340000
203500         IF  DP010I-ERROR-DETECTED                                20350000
203600             SET PS-ERROR                                         20360000
203700                 DP020-MSG-FATAL   TO TRUE                        20370000
203800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            20380000
203900             MOVE DP015-UNP-NUM-BRT-OFF                           20390000
204000                                   TO ARTVQTYA                    20400000
204100             MOVE DP015-RED        TO ARTVQTYC                    20410000
204200             MOVE DP015-REVERSE    TO ARTVQTYH                    20420000
204300             MOVE -1               TO ARTVQTYL                    20430000
204400             SET DP030-SET-CURSOR-APPL-1                          20440000
204500                                   TO TRUE                        20450000
204600         ELSE                                                     20460000
204700             MOVE DP010I-NUMERIC-FIELD                            20470000
204800                                   TO ASC-RTV-QTY-N               20480000
204900             MOVE ASC-RTV-QTY-N    TO ARTVQTYO                    20490000
205000         END-IF                                                   20500000
205100     END-IF.                                                      20510000
205200                                                                  20520000
205300     MOVE ASC-RTV-IND              TO PV-VALIDATE-IND.            20530000
205400     IF PV-VALID-RTV-IND                                          20540000
205500         CONTINUE                                                 20550000
205600     ELSE                                                         20560000
205700         SET PS-ERROR                                             20570000
205800             DP020-MSG-FATAL       TO TRUE                        20580000
205900         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            20590000
206000         MOVE DP015-UNP-ALP-BRT-OFF                               20600000
206100                                   TO ARTVINDA                    20610000
206200         MOVE DP015-RED            TO ARTVINDC                    20620000
206300         MOVE DP015-REVERSE        TO ARTVINDH                    20630000
206400         MOVE -1                   TO ARTVINDL                    20640000
206500         SET DP030-SET-CURSOR-APPL-1                              20650000
206600                                   TO TRUE                        20660000
206700     END-IF.                                                      20670000
206800                                                                  20680000
206900     IF  ASC-DMG-ITM-QTY > SPACES                                 20690000
207000         MOVE ASC-DMG-ITM-QTY      TO DP010I-UNEDITED-FIELD       20700000
207100         MOVE LENGTH OF ASC-DMG-ITM-QTY                           20710000
207200                                   TO DP010I-MAXIMUM-DIGITS       20720000
207300         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     20730000
207400         SET DP010I-NEGATIVE-NOT-ALLOWED                          20740000
207500                                   TO TRUE                        20750000
207610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         20761007
207620              USING DP010I-NUMERIC-EDIT-AREA                      20762007
207700                                                                  20770000
207800         IF  DP010I-ERROR-DETECTED                                20780000
207900             SET PS-ERROR                                         20790000
208000                 DP020-MSG-FATAL   TO TRUE                        20800000
208100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            20810000
208200             MOVE DP015-UNP-NUM-BRT-OFF                           20820000
208300                                   TO ADMGA                       20830000
208400             MOVE DP015-RED        TO ADMGC                       20840000
208500             MOVE DP015-REVERSE    TO ADMGH                       20850000
208600             MOVE -1               TO ADMGL                       20860000
208700             SET DP030-SET-CURSOR-APPL-1                          20870000
208800                                   TO TRUE                        20880000
208900         ELSE                                                     20890000
209000             MOVE DP010I-NUMERIC-FIELD                            20900000
209100                                   TO ASC-DMG-ITM-QTY-N           20910000
209200             MOVE ASC-DMG-ITM-QTY-N                               20920000
209300                                   TO ADMGO                       20930000
209400         END-IF                                                   20940000
209500     END-IF.                                                      20950000
209600                                                                  20960000
209700     MOVE ASC-PRE-TKT-IND          TO PV-VALIDATE-IND.            20970000
209800     IF PV-VALID-PRE-TKT-IND                                      20980000
209900         CONTINUE                                                 20990000
210000     ELSE                                                         21000000
210100         SET PS-ERROR                                             21010000
210200             DP020-MSG-FATAL       TO TRUE                        21020000
210300         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            21030000
210400         MOVE DP015-UNP-ALP-BRT-OFF                               21040000
210500                                   TO APRETKTA                    21050000
210600         MOVE DP015-RED            TO APRETKTC                    21060000
210700         MOVE DP015-REVERSE        TO APRETKTH                    21070000
210800         MOVE -1                   TO APRETKTL                    21080000
210900         SET DP030-SET-CURSOR-APPL-1                              21090000
211000                                   TO TRUE                        21100000
211100     END-IF.                                                      21110000
211200                                                                  21120000
211300     IF  ASC-DTL-CK-ITM-QTY > SPACES                              21130000
211400         MOVE ASC-DTL-CK-ITM-QTY   TO DP010I-UNEDITED-FIELD       21140000
211500         MOVE LENGTH OF ASC-DTL-CK-ITM-QTY                        21150000
211600                                   TO DP010I-MAXIMUM-DIGITS       21160000
211700         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     21170000
211800         SET DP010I-NEGATIVE-NOT-ALLOWED                          21180000
211900                                   TO TRUE                        21190000
212010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         21201007
212020              USING DP010I-NUMERIC-EDIT-AREA                      21202007
212100                                                                  21210000
212200         IF  DP010I-ERROR-DETECTED                                21220000
212300             SET PS-ERROR                                         21230000
212400                 DP020-MSG-FATAL   TO TRUE                        21240000
212500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            21250000
212600             MOVE DP015-UNP-NUM-BRT-OFF                           21260000
212700                                   TO ADCQTYA                     21270000
212800             MOVE DP015-RED        TO ADCQTYC                     21280000
212900             MOVE DP015-REVERSE    TO ADCQTYH                     21290000
213000             MOVE -1               TO ADCQTYL                     21300000
213100             SET DP030-SET-CURSOR-APPL-1                          21310000
213200                                   TO TRUE                        21320000
213300         ELSE                                                     21330000
213400             IF ASC-ORIG-DTL-CK-ITM-QTY > 0 AND                   21340000
213500                DP010I-NUMERIC-FIELD = 0                          21350000
213600                 SET PS-ERROR                                     21360000
213700                     DP020-MSG-FATAL   TO TRUE                    21370000
213800                 MOVE PC-TSYMSG-00854  TO DP020-MSG-NUMBER        21380000
213900                 MOVE DP015-UNP-NUM-BRT-OFF                       21390000
214000                                       TO ADCQTYA                 21400000
214100                 MOVE DP015-RED        TO ADCQTYC                 21410000
214200                 MOVE DP015-REVERSE    TO ADCQTYH                 21420000
214300                 MOVE -1               TO ADCQTYL                 21430000
214400                 SET DP030-SET-CURSOR-APPL-1                      21440000
214500                                       TO TRUE                    21450000
214600             ELSE                                                 21460000
214700                 MOVE DP010I-NUMERIC-FIELD                        21470000
214800                                   TO ASC-DTL-CK-ITM-QTY-N        21480000
214900                 MOVE ASC-DTL-CK-ITM-QTY-N                        21490000
215000                                   TO ADCQTYO                     21500000
215100             END-IF                                               21510000
215200         END-IF                                                   21520000
215300     END-IF.                                                      21530000
215400                                                                  21540000
215500     IF  ASC-CASE-PACK-QTY > SPACES                               21550000
215600         MOVE ASC-CASE-PACK-QTY    TO DP010I-UNEDITED-FIELD       21560000
215700         MOVE LENGTH OF ASC-CASE-PACK-QTY                         21570000
215800                                   TO DP010I-MAXIMUM-DIGITS       21580000
215900         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     21590000
216000         SET DP010I-NEGATIVE-NOT-ALLOWED                          21600000
216100                                   TO TRUE                        21610000
216210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         21621007
216220              USING DP010I-NUMERIC-EDIT-AREA                      21622007
216300                                                                  21630000
216400         IF  DP010I-ERROR-DETECTED                                21640000
216500             SET PS-ERROR                                         21650000
216600                 DP020-MSG-FATAL   TO TRUE                        21660000
216700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            21670000
216800             MOVE DP015-UNP-NUM-BRT-OFF                           21680000
216900                                   TO ACASEA                      21690000
217000             MOVE DP015-RED        TO ACASEC                      21700000
217100             MOVE DP015-REVERSE    TO ACASEH                      21710000
217200             MOVE -1               TO ACASEL                      21720000
217300             SET DP030-SET-CURSOR-APPL-1                          21730000
217400                                   TO TRUE                        21740000
217500         ELSE                                                     21750000
217600             MOVE DP010I-NUMERIC-FIELD                            21760000
217700                                   TO ASC-CASE-PACK-QTY-N         21770000
217800         END-IF                                                   21780000
217900     END-IF.                                                      21790000
218000                                                                  21800000
218100     IF  ASC-INNR-PACK-QTY > SPACES                               21810000
218200         MOVE ASC-INNR-PACK-QTY    TO DP010I-UNEDITED-FIELD       21820000
218300         MOVE LENGTH OF ASC-INNR-PACK-QTY                         21830000
218400                                   TO DP010I-MAXIMUM-DIGITS       21840000
218500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     21850000
218600         SET DP010I-NEGATIVE-NOT-ALLOWED                          21860000
218700                                   TO TRUE                        21870000
218810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         21881007
218820              USING DP010I-NUMERIC-EDIT-AREA                      21882007
218900                                                                  21890000
219000         IF  DP010I-ERROR-DETECTED                                21900000
219100             SET PS-ERROR                                         21910000
219200                 DP020-MSG-FATAL   TO TRUE                        21920000
219300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            21930000
219400             MOVE DP015-UNP-NUM-BRT-OFF                           21940000
219500                                   TO AINNRA                      21950000
219600             MOVE DP015-RED        TO AINNRC                      21960000
219700             MOVE DP015-REVERSE    TO AINNRH                      21970000
219800             MOVE -1               TO AINNRL                      21980000
219900             SET DP030-SET-CURSOR-APPL-1                          21990000
220000                                   TO TRUE                        22000000
220100         ELSE                                                     22010000
220200             MOVE DP010I-NUMERIC-FIELD                            22020000
220300                                   TO ASC-INNR-PACK-QTY-N         22030000
220400         END-IF                                                   22040000
220500     END-IF.                                                      22050000
220600                                                                  22060000
220700     IF  PS-NO-ERROR                                              22070000
220800*T       IF ASC-CAME-FROM-TRBL                                    22080000
220900             PERFORM 3010-SECONDARY-EDITS                         22090000
221000*T       END-IF                                                   22100000
221100     END-IF.                                                      22110000
221200                                                                  22120000
221300     IF  PS-NO-ERROR                                              22130000
221400         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     22140000
221500         IF ASC-CAME-FROM-RCVG                                    22150000
221600             MOVE -1               TO AINNRL                      22160000
221700         ELSE                                                     22170000
221800             MOVE -1               TO ARTVINDL                    22180000
221900         END-IF                                                   22190000
222000         SET DP030-SET-CURSOR-APPL-1                              22200000
222100                                   TO TRUE                        22210000
222200     END-IF.                                                      22220000
222300                                                                  22230000
222400/                                                                 22240000
222500*----------------------------------------------------------------*22250000
222600*  IF ALL BASIC EDITS ARE PASSED, EDIT FOR SPECIFIC COMBINATIONS *22260000
222700*----------------------------------------------------------------*22270000
222800 3010-SECONDARY-EDITS.                                            22280000
222900                                                                  22290000
223000*    IF ASC-RTV-IND = PC-Y                                        22300000
223100*        IF ASC-RTV-QTY NUMERIC AND ASC-RTV-QTY-N > 0             22310000
223200*            IF ASC-DTL-CK-ITM-QTY NUMERIC  AND                   22320000
223300*               ASC-DTL-CK-ITM-QTY-N > 0                          22330000
223400*                IF ASC-RTV-QTY-N > ASC-DTL-CK-ITM-QTY-N          22340000
223500*                    SET PS-RTV-QTY-ERROR                         22350000
223600*                                  TO TRUE                        22360000
223700*                    MOVE PC-TSYMSG-00005                         22370000
223800*                                  TO DP020-MSG-NUMBER            22380000
223900*                ELSE                                             22390000
224000*                    CONTINUE                                     22400000
224100*                END-IF                                           22410000
224200*            ELSE                                                 22420000
224300*                IF ASC-RTV-QTY-N > ASC-PKSL-ITM-QTY              22430000
224400*                    SET PS-RTV-QTY-ERROR                         22440000
224500*                                  TO TRUE                        22450000
224600*                    MOVE PC-TSYMSG-00005                         22460000
224700*                                  TO DP020-MSG-NUMBER            22470000
224800*                END-IF                                           22480000
224900*            END-IF                                               22490000
225000*        ELSE                                                     22500000
225100*            SET PS-RTV-QTY-ERROR  TO TRUE                        22510000
225200*            MOVE PC-TSYMSG-00342  TO DP020-MSG-NUMBER            22520000
225300*        END-IF                                                   22530000
225400*    ELSE                                                         22540000
225500*        IF ASC-RTV-QTY NUMERIC AND ASC-RTV-QTY-N > 0             22550000
225600*            SET PS-RTV-QTY-ERROR  TO TRUE                        22560000
225700*            MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            22570000
225800*        END-IF                                                   22580000
225900*    END-IF.                                                      22590000
226000*                                                                 22600000
226100*    IF ASC-RTV-IND = PC-Y                                        22610000
226200*        IF ASC-UNT-RTL-PR-AMT > .00                              22620000
226300*            CONTINUE                                             22630000
226400*        ELSE                                                     22640000
226500*            SET PS-RTV-QTY-ERROR  TO TRUE                        22650000
226600*            MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            22660000
226700*        END-IF                                                   22670000
226800*    END-IF.                                                      22680000
226900*                                                                 22690000
227000*    IF PS-RTV-QTY-ERROR                                          22700000
227100*        SET PS-ERROR                                             22710000
227200*            DP020-MSG-FATAL       TO TRUE                        22720000
227300*        MOVE DP015-UNP-NUM-BRT-OFF                               22730000
227400*                                  TO ARTVQTYA                    22740000
227500*        MOVE DP015-RED            TO ARTVQTYC                    22750000
227600*        MOVE DP015-REVERSE        TO ARTVQTYH                    22760000
227700*        MOVE -1                   TO ARTVQTYL                    22770000
227800*        SET DP030-SET-CURSOR-APPL-1                              22780000
227900*                                  TO TRUE                        22790000
228000*    END-IF.                                                      22800000
228100                                                                  22810000
228200     IF ASC-DMG-ITM-QTY NUMERIC AND ASC-DMG-ITM-QTY-N > 0         22820000
228300         IF ASC-DTL-CK-ITM-QTY NUMERIC AND                        22830000
228400            ASC-DTL-CK-ITM-QTY-N > 0                              22840000
228500             IF ASC-DMG-ITM-QTY-N > ASC-DTL-CK-ITM-QTY-N          22850000
228600                 SET PS-DMG-ITM-QTY-ERROR                         22860000
228700                                   TO TRUE                        22870000
228800                 MOVE PC-TSYMSG-00005                             22880000
228900                                   TO DP020-MSG-NUMBER            22890000
229000             ELSE                                                 22900000
229100                 CONTINUE                                         22910000
229200             END-IF                                               22920000
229300         ELSE                                                     22930000
229400             IF ASC-DMG-ITM-QTY-N > ASC-PKSL-ITM-QTY              22940000
229500                 SET PS-DMG-ITM-QTY-ERROR                         22950000
229600                                   TO TRUE                        22960000
229700                 MOVE PC-TSYMSG-00005                             22970000
229800                                   TO DP020-MSG-NUMBER            22980000
229900             END-IF                                               22990000
230000         END-IF                                                   23000000
230100     END-IF.                                                      23010000
230200                                                                  23020000
230300     IF PS-DMG-ITM-QTY-ERROR                                      23030000
230400         SET PS-ERROR                                             23040000
230500             DP020-MSG-FATAL       TO TRUE                        23050000
230600         MOVE DP015-UNP-NUM-BRT-OFF                               23060000
230700                                   TO ADMGA                       23070000
230800         MOVE DP015-RED            TO ADMGC                       23080000
230900         MOVE DP015-REVERSE        TO ADMGH                       23090000
231000         MOVE -1                   TO ADMGL                       23100000
231100         SET DP030-SET-CURSOR-APPL-1                              23110000
231200                                   TO TRUE                        23120000
231300     END-IF.                                                      23130000
231400                                                                  23140000
231500/                                                                 23150000
231600*----------------------------------------------------------------*23160000
231700*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *23170000
231800*----------------------------------------------------------------*23180000
231900                                                                  23190000
232000 3200-RESET-ATTRIBUTES.                                           23200000
232100                                                                  23210000
232200*T   WHEN THE TROUBLE SYSTEM IS WORKING, THIS ROUTINE WILL        23220000
232300*T   NEED TO BE CHANGED                                           23230000
232400                                                                  23240000
232500     EVALUATE TRUE                                                23250000
232600         WHEN ASC-RECITM-STATUS-CM-VE                             23260000
232700         WHEN ASC-PREPACK-RECEIVER                                23270000
232800         WHEN ASC-DELETE-ITEM                                     23280000
232900              MOVE DP015-PRO-NOR-OFF                              23290000
233000                                   TO ARTVINDA                    23300000
233100                                      ARTVQTYA                    23310000
233200                                      ACOSTA                      23320000
233300                                      AMTCHA                      23330000
233400                                      AINNRA                      23340000
233500                                      ACASEA                      23350000
233600                                      APRETKTA                    23360000
233700                                      ADCQTYA                     23370000
233800                                      ADMGA                       23380000
233900              MOVE DP015-BLUE      TO ARTVINDC                    23390000
234000                                      ARTVQTYC                    23400000
234100                                      ACOSTC                      23410000
234200                                      AMTCHC                      23420000
234300                                      AINNRC                      23430000
234400                                      ACASEC                      23440000
234500                                      APRETKTC                    23450000
234600                                      ADCQTYC                     23460000
234700                                      ADMGC                       23470000
234800              MOVE DP015-HL-OFF    TO ARTVINDH                    23480000
234900                                      ARTVQTYH                    23490000
235000                                      ACOSTH                      23500000
235100                                      AMTCHH                      23510000
235200                                      AINNRH                      23520000
235300                                      ACASEH                      23530000
235400                                      APRETKTH                    23540000
235500                                      ADCQTYH                     23550000
235600                                      ADMGH                       23560000
235700         WHEN OTHER                                               23570000
235800*T       WHEN ASC-CAME-FROM-RCVG                                  23580000
235900              MOVE DP015-UNP-ALP-NOR-OFF                          23590000
236000                                   TO APRETKTA                    23600000
236100              MOVE DP015-UNP-NUM-NOR-OFF                          23610000
236200                                   TO AINNRA                      23620000
236300                                      ACASEA                      23630000
236400                                      ADCQTYA                     23640000
236500                                      ADMGA                       23650000
236600              MOVE DP015-GREEN     TO APRETKTC                    23660000
236700                                      AINNRC                      23670000
236800                                      ACASEC                      23680000
236900                                      ADCQTYC                     23690000
237000                                      ADMGC                       23700000
237100              MOVE DP015-UNDERLINE TO APRETKTH                    23710000
237200                                      AINNRH                      23720000
237300                                      ACASEH                      23730000
237400                                      ADCQTYH                     23740000
237500                                      ADMGH                       23750000
237600*LS  PROTECT THE RTV QTY FIELD ALWAYS                             23760000
237700              MOVE DP015-PRO-NOR-OFF                              23770000
237800                                   TO ARTVQTYA                    23780000
237900              MOVE DP015-BLUE      TO ARTVQTYC                    23790000
238000              MOVE DP015-HL-OFF    TO ARTVQTYH                    23800000
238100*T            MOVE DP015-PRO-NOR-OFF                              23810000
238200*T                                 TO ARTVINDA                    23820000
238300*T                                    ARTVQTYA                    23830000
238400*T                                    ACOSTA                      23840000
238500*T                                    AMTCHA                      23850000
238600*T            MOVE DP015-BLUE      TO ARTVINDC                    23860000
238700*T                                    ARTVQTYC                    23870000
238800*T                                    ACOSTC                      23880000
238900*T                                    AMTCHC                      23890000
239000*T            MOVE DP015-HL-OFF    TO ARTVINDH                    23900000
239100*T                                    ARTVQTYH                    23910000
239200*T                                    ACOSTH                      23920000
239300*T                                    AMTCHH                      23930000
239400                                                                  23940000
239500*T       WHEN ASC-CAME-FROM-TRBL                                  23950000
239600              MOVE DP015-UNP-ALP-NOR-OFF                          23960000
239700                                   TO ARTVINDA                    23970000
239800              MOVE DP015-UNP-NUM-NOR-OFF                          23980000
239900*LS                                TO ARTVQTYA                    23990000
240000                                   TO ACOSTA                      24000000
240100                                      AMTCHA                      24010000
240200              MOVE DP015-GREEN     TO ARTVINDC                    24020000
240300*                                     ARTVQTYC                    24030000
240400                                      ACOSTC                      24040000
240500                                      AMTCHC                      24050000
240600              MOVE DP015-UNDERLINE TO ARTVINDH                    24060000
240700*                                     ARTVQTYH                    24070000
240800                                      ACOSTH                      24080000
240900                                      AMTCHH.                     24090000
241000*T            MOVE DP015-PRO-NOR-OFF                              24100000
241100*T                                 TO AINNRA                      24110000
241200*T                                    ACASEA                      24120000
241300*T                                    APRETKTA                    24130000
241400*T                                    ADCQTYA                     24140000
241500*T                                    ADMGA                       24150000
241600*T            MOVE DP015-BLUE      TO AINNRC                      24160000
241700*T                                    ACASEC                      24170000
241800*T                                    APRETKTC                    24180000
241900*T                                    ADCQTYC                     24190000
242000*T                                    ADMGC                       24200000
242100*T            MOVE DP015-HL-OFF    TO AINNRH                      24210000
242200*T                                    ACASEH                      24220000
242300*T                                    APRETKTH                    24230000
242400*T                                    ADCQTYH                     24240000
242500*T                                    ADMGH                       24250000
242600                                                                  24260000
242700*T   END-EVALUATE.                                                24270000
242800                                                                  24280000
242900     IF  DP020-NEXT-ACT-INITIAL                                   24290000
243000         SET DP030-SET-CURSOR-APPL-1                              24300000
243100                                   TO TRUE                        24310000
243200         IF ASC-CAME-FROM-TRBL                                    24320000
243300             MOVE -1               TO ARTVINDL                    24330000
243400         ELSE                                                     24340000
243500             MOVE -1               TO AINNRL                      24350000
243600         END-IF                                                   24360000
243700     END-IF.                                                      24370000
243800                                                                  24380000
243900     IF (ASC-RECITM-STATUS-CM-VE                                  24390000
244000     OR  ASC-DELETE-ITEM)                                         24400000
244100         SET DP030-SET-CURSOR-TRAILER                             24410000
244200                                   TO TRUE                        24420000
244300     END-IF.                                                      24430000
244400/                                                                 24440000
244500*----------------------------------------------------------------*24450000
244600*  THIS PARAGRAPH BUILDS THE INITIAL SCREEN                      *24460000
244700*----------------------------------------------------------------*24470000
244800                                                                  24480000
244900 4000-BUILD-INITIAL-PANEL.                                        24490000
245000                                                                  24500000
245100     PERFORM 8000-SELECT-RECITM.                                  24510000
245200                                                                  24520000
245300     PERFORM 4010-GET-FCLTY-DESC.                                 24530000
245400                                                                  24540000
245500     MOVE ASC-PO-LNE-NBR-N         TO DK-PO-LNE-NBR.              24550000
245600                                                                  24560000
245700     PERFORM 9050-GET-PURITM.                                     24570000
245800                                                                  24580000
245900     MOVE PURITM-GP-RTL-AMT        TO ASC-GP-RTL-AMT.             24590000
246000     MOVE PURITM-GP-QTY            TO ASC-GP-QTY.                 24600000
246100     MOVE PURITM-UNT-RTL-PR-AMT    TO ASC-UNT-RTL-PR-AMT.         24610000
246200******    WR # 27201 - START                                      24620000
246300     IF RECITM-STATUS-CDE = 'VE'                                  24630000
246400         PERFORM 9090-GET-POST-TMST                               24640000
246500         PERFORM 9095-GET-FUNC-BEG-TMST                           24650000
246600         IF RECEIV-ML-POST-TMST = PC-DEFAULT-TMST                 24660000
246700           OR RECEIV-FS-POST-TMST = PC-DEFAULT-TMST               24670000
246800           OR RECEIV-ML-POST-TMST < KRPRPM-FUNC-BEG-TMST          24680000
246900           OR RECEIV-FS-POST-TMST < KRPRPM-FUNC-BEG-TMST          24690000
247000             MOVE ZEROS                TO ASC-VRFD-LWST-RTL-AMT   24700000
247100         ELSE                                                     24710000
247200             PERFORM 9080-GET-VRFD-RTL                            24720000
247300         END-IF                                                   24730000
247400     ELSE                                                         24740000
247500         MOVE ZEROS                TO ASC-VRFD-LWST-RTL-AMT       24750000
247600     END-IF.                                                      24760000
247700******    WR # 27201 - END                                        24770000
247800                                                                  24780000
247900*?   ADDED.. UNTIL I'M TOLD HOW TO HANDLE                         24790000
248000     IF PS-RECITM-NOT-FOUND                                       24800000
248100         IF ASC-CAME-FROM-RCVG                                    24810000
248200             MOVE PC-TSYMSG-00148  TO DP020-MSG-NUMBER            24820000
248300             SET DP020-MSG-FATAL   TO TRUE                        24830000
248400*            SET DP020-NEXT-ACT-APPL-ERROR                        24840000
248500*                                  TO TRUE                        24850000
248600             SET PS-ERROR          TO TRUE                        24860000
248700         END-IF                                                   24870000
248800     END-IF.                                                      24880000
248900                                                                  24890000
249000     PERFORM 4020-GET-STATUS-DESC.                                24900000
249100                                                                  24910000
249200     MOVE RECITM-PREPK-ID    TO ASC-PREPK-ID.                     24920000
249300     IF PV-DB2-YEAR-TRSCP < 9999                                  24930000
249400         MOVE PV-DB2-MONTH-TRSCP   TO PV-MONTH                    24940000
249500         MOVE PV-DB2-DAY-TRSCP     TO PV-DAY                      24950000
249600         MOVE PV-DB2-YEAR-TRSCP    TO PV-YEAR                     24960000
249700         MOVE PV-DISPLAY-DATE      TO ASC-LAST-UPD-BY-DTE         24970000
249800         MOVE PV-DB2-HOUR-TRSCP    TO PV-HOUR                     24980000
249900         MOVE PV-DB2-MINUTE-TRSCP  TO PV-MINUTE                   24990000
250000         MOVE PV-DISPLAY-TIME      TO ASC-LAST-UPD-BY-TME         25000000
250100         MOVE RECITM-LAST-TRSCP-USR-ID                            25010000
250200                                   TO ASC-LAST-UPD-BY-UID         25020000
250300     ELSE                                                         25030000
250400         MOVE SPACES               TO ASC-LAST-UPD-BY-DTE         25040000
250500                                      ASC-LAST-UPD-BY-TME         25050000
250600                                      ASC-LAST-UPD-BY-UID         25060000
250700     END-IF                                                       25070000
250800                                                                  25080000
250900* CREATED BY DATE/TIME/USER                                       25090000
251000     MOVE PV-DB2-MONTH             TO PV-MONTH                    25100000
251100     MOVE PV-DB2-DAY               TO PV-DAY                      25110000
251200     MOVE PV-DB2-YEAR              TO PV-YEAR                     25120000
251300     MOVE PV-DISPLAY-DATE          TO ASC-CREATED-BY-DTE          25130000
251400     MOVE PV-DB2-HOUR              TO PV-HOUR                     25140000
251500     MOVE PV-DB2-MINUTE            TO PV-MINUTE                   25150000
251600     MOVE PV-DISPLAY-TIME          TO ASC-CREATED-BY-TME          25160000
251700     MOVE RECITM-CRE-UID           TO ASC-CREATED-BY-UID          25170000
251800                                                                  25180000
251900     MOVE RECITM-INNR-PACK-QTY     TO ASC-INNR-PACK-QTY-N.        25190000
252000     MOVE RECITM-CASE-PACK-QTY     TO ASC-CASE-PACK-QTY-N.        25200000
252100     MOVE RECITM-PRE-TKT-IND       TO ASC-PRE-TKT-IND.            25210000
252200     MOVE RECITM-PKSL-ITM-QTY      TO ASC-PKSL-ITM-QTY.           25220000
252300     MOVE RECITM-DTL-CK-ITM-QTY    TO ASC-DTL-CK-ITM-QTY-N        25230000
252400                                      ASC-ORIG-DTL-CK-ITM-QTY.    25240000
252500     MOVE RECITM-EXPTED-CART-CNT   TO ASC-EXPTED-CART-CNT.        25250000
252600     MOVE RECITM-ACTL-CART-CNT     TO ASC-ACTL-CART-CNT.          25260000
252700     MOVE RECITM-RTV-IND           TO ASC-RTV-IND.                25270000
252800     MOVE RECITM-RTV-QTY           TO ASC-RTV-QTY-N.              25280000
252900     MOVE RECITM-UNT-COST-AMT      TO ASC-UNT-COST-AMT-N.         25290000
253000     MOVE RECITM-DMG-ITM-QTY       TO ASC-DMG-ITM-QTY-N.          25300000
253100     MOVE ASC-UNT-COST-AMT-N       TO ACOSTO.                     25310000
253200     MOVE ACOSTO                   TO ASC-UNT-COST-AMT.           25320000
253300     MOVE RECITM-STATUS-CDE        TO ASC-RECITM-STATUS-CDE.      25330000
253400     MOVE RECITM-RCPT-DISTR-UPD-CDE                               25340000
253500                               TO ASC-RECITM-RCPT-DISTR-UPD-CDE.  25350000
253600                                                                  25360000
253700     MOVE RECITM-TKT-FMT-ID        TO ASC-TKT-FMT-ID              25370000
253800     PERFORM 4065-SELECT-TKT-FMT-ID.                              25380000
253900     PERFORM 4030-GET-TROUBLE-DESC.                               25390000
254000     PERFORM 4040-GET-TDISTHD.                                    25400000
254100                                                                  25410000
254200     IF ASC-PO-LNE-NBR > PC-8999                                  25420000
254300         PERFORM 4200-BUILD-UNPKSL-SCREEN                         25430000
254400     ELSE                                                         25440000
254500         INITIALIZE XL001-ITEM-COMMAREA                           25450000
254600         PERFORM 4085-CALL-CICS-API-ARCH                          25460000
254700         PERFORM 4100-BUILD-PKITEM-SCREEN                         25470000
254800     END-IF.                                                      25480000
254900                                                                  25490000
255000     IF (ASC-DELETE-ITEM                                          25500000
255100     AND NOT PS-ERROR)                                            25510000
255200         MOVE PC-TSYMSG-00354        TO DP020-MSG-NUMBER          25520000
255300         SET DP020-MSG-INFORMATIONAL TO TRUE                      25530000
255400     END-IF.                                                      25540000
255500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        25550000
255600                                                                  25560000
255700*----------------------------------------------------------------*25570000
255800*  SELECT THE FACILITY TABLE TO GET THE DESCRIPTION              *25580000
255900*----------------------------------------------------------------*25590000
256000                                                                  25600000
256100 4010-GET-FCLTY-DESC.                                             25610000
256200     INITIALIZE XL071-COMMAREA-REC.                               25620000
256300                                                                  25630000
256400     MOVE ASC-KEY-OPER-UNT-ID   TO PV-UNPACK-OPER-UNT-ID.         25640000
256500     MOVE PV-UNPACK-OPER-UNT-ID TO XL071-LOCATION-NUMBER.         25650000
256600                                                                  25660000
256700     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    25670000
256800                                      XL071-COMMAREA              25680000
256900                                      XL071-COMMAREA-REC.         25690000
257000                                                                  25700000
257100     EVALUATE TRUE                                                25710000
257200         WHEN XL071-NO-ERRORS                                     25720000
257300             MOVE XL071-LOC-NM TO ASC-FCLTY-DESC                  25730000
257400                                  AFDESCO                         25740000
257500         WHEN XL071-LOC-NOT-FOUND                                 25750000
257600             SET PS-ERROR                                         25760000
257700                 DP020-MSG-FATAL         TO TRUE                  25770000
257800             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      25780000
257900             MOVE DP015-UNP-NUM-BRT-OFF  TO AOPERA                25790000
258000             MOVE DP015-RED              TO AOPERC                25800000
258100             MOVE DP015-REVERSE          TO AOPERH                25810000
258200             MOVE -1                     TO AOPERL                25820000
258300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  25830000
258400         WHEN XL071-SQLCODE-N = -904                              25840000
258500         WHEN XL071-SQLCODE-N = -913                              25850000
258600             MOVE SPACES  TO ASC-FCLTY-DESC                       25860000
258700         WHEN XL071-BAD-DB2-RETURN                                25870000
258800         WHEN SQLCODE < +0                                        25880000
258900         WHEN SQLCODE > +0                                        25890000
259000             MOVE XL071-SQLCODE-N TO SQLCODE                      25900000
259100             MOVE '4010-GET-FCLTY-DESC' TO DP013-PARAGRAPH        25910000
259200             MOVE 'SELECT LOCATION-DESC' TO DP013-MESSAGE-TEXT (1)25920000
259300             STRING 'LOCATION:  '        DELIMITED BY SIZE        25930000
259400                   XL071-LOCATION-NUMBER DELIMITED BY SIZE        25940000
259500                                       INTO DP013-MESSAGE-TEXT (2)25950000
259600             MOVE XL071-SQLCA  TO DP013-SQLCA                     25960000
259700             MOVE 'XLT_LOC'    TO DP013-DB2-TABLE-NAME (1)        25970000
259800             SET DP013-DB2-ABEND                                  25980000
259900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               25990000
260000             PERFORM DP013-0000-PROCESS-ABEND                     26000000
260100     END-EVALUATE.                                                26010000
260200                                                                  26020000
260300     IF SQLCODE = +100                                            26030000
260400         SET PS-ERROR                                             26040000
260500             DP020-MSG-FATAL       TO TRUE                        26050000
260600         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            26060000
260700         MOVE DP015-UNP-ALP-BRT-OFF                               26070000
260800                                   TO AFCLTYA                     26080000
260900         MOVE DP015-RED            TO AFCLTYC                     26090000
261000         MOVE DP015-REVERSE        TO AFCLTYH                     26100000
261100         MOVE -1                   TO AFCLTYL                     26110000
261200         SET DP030-SET-CURSOR-APPL-1                              26120000
261300                                   TO TRUE                        26130000
261400     END-IF.                                                      26140000
261500                                                                  26150000
261600*----------------------------------------------------------------*26160000
261700*  SELECT THE STATUS CODE DESCRIPTION                            *26170000
261800*----------------------------------------------------------------*26180000
261900                                                                  26190000
262000 4020-GET-STATUS-DESC.                                            26200000
262100                                                                  26210000
262200     EXEC SQL                                                     26220000
262300        SELECT  STATUS_DESC                                       26230000
262400          INTO :STATCD-STATUS-DESC                                26240000
262500          FROM  TSTATCD                                           26250000
262600         WHERE  STATUS_CDE     = :RECITM-STATUS-CDE               26260000
262700           AND  STATUS_TYP_CDE = :PC-R                            26270000
262800     END-EXEC.                                                    26280000
262900                                                                  26290000
263000     EVALUATE TRUE                                                26300000
263100         WHEN SQLCODE = +0                                        26310000
263200             MOVE STATCD-STATUS-DESC                              26320000
263300                               TO ASC-STATUS-DESC                 26330000
263400                                                                  26340000
263500         WHEN SQLCODE = +100                                      26350000
263600             MOVE RECITM-STATUS-CDE                               26360000
263700                               TO ASC-STATUS-DESC                 26370000
263800                                                                  26380000
263900         WHEN SQLWARN0 NOT = SPACES                               26390000
264000         WHEN SQLCODE < +0                                        26400000
264100         WHEN SQLCODE > +0                                        26410000
264200             MOVE '4020-GET-STATUS-DESC'                          26420000
264300                               TO DP013-PARAGRAPH                 26430000
264400             MOVE 'SELECT STATUS DESC '                           26440000
264500                               TO DP013-MESSAGE-TEXT (1)          26450000
264600             MOVE SQLCA        TO DP013-SQLCA                     26460000
264700             MOVE 'TSTATCD'    TO DP013-DB2-TABLE-NAME (1)        26470000
264800             SET DP013-DB2-ABEND                                  26480000
264900                               TO TRUE                            26490000
265000             SET DP013-XCTL-DISPLAY-RESTART                       26500000
265100                               TO TRUE                            26510000
265200             PERFORM DP013-0000-PROCESS-ABEND                     26520000
265300     END-EVALUATE.                                                26530000
265400                                                                  26540000
265500*----------------------------------------------------------------*26550000
265600*  CHECK IF THE PURCHASE ORDER LINE IS IN TROUBLE                *26560000
265700*----------------------------------------------------------------*26570000
265800                                                                  26580000
265900 4030-GET-TROUBLE-DESC.                                           26590000
266000                                                                  26600000
266100                                                                  26610000
266200     EXEC SQL                                                     26620000
266300        SELECT  TRBL_LONG_DESC                                    26630000
266400          INTO :TRBRSN-TRBL-LONG-DESC                             26640000
266500          FROM  TTRBNTF A,                                        26650000
266600                TTRBRSN B                                         26660000
266700         WHERE  A.OPER_UNT_ID   = :ASC-KEY-OPER-UNT-ID            26670000
266800           AND  A.FCLTY_ID      = :ASC-KEY-FCLTY-ID               26680000
266900           AND  A.PO_NBR        = :DK-PO-NBR                      26690000
267000           AND  A.PO_LNE_NBR    = :ASC-KEY-PO-LNE-NBR             26700000
267100           AND  A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR                 26710000
267200           AND (A.RESOLVED_IND ^= :PC-A                           26720000
267300           AND  A.RESOLVED_IND ^= :PC-R)                          26730000
267400           AND  A.TRBL_RSN_CDE  = B.TRBL_RSN_CDE                  26740000
267500           AND  B.NOTIF_IND     = :PC-T                           26750000
267600     END-EXEC.                                                    26760000
267700                                                                  26770000
267800     EVALUATE TRUE                                                26780000
267900         WHEN SQLCODE = +0                                        26790000
268000             MOVE TRBRSN-TRBL-LONG-DESC                           26800000
268100                               TO ASC-TROUBLE-DESC                26810000
268200                                                                  26820000
268300         WHEN SQLCODE = +100                                      26830000
268400             MOVE SPACES       TO ASC-TROUBLE-DESC                26840000
268500                                                                  26850000
268600         WHEN SQLCODE = -811                                      26860000
268700             STRING TRBRSN-TRBL-LONG-DESC '*'                     26870000
268800                 DELIMITED BY SIZE                                26880000
268900                 INTO ASC-TROUBLE-DESC                            26890000
269000                                                                  26900000
269100         WHEN SQLWARN0 NOT = SPACES                               26910000
269200         WHEN SQLCODE < +0                                        26920000
269300         WHEN SQLCODE > +0                                        26930000
269400              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         26940001
269500              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       26950001
269600              MOVE  ASC-KEY-PO-LNE-NBR  TO  PV-DISPLAY-LINE       26960001
269700              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             26970001
269800              STRING  PV-DISPLAY-PO   '-'                         26980001
269900                      PV-DISPLAY-RCVR '-'                         26990001
270000                      PV-DISPLAY-LINE    DELIMITED BY SIZE        27000001
270100                          INTO DP013-MESSAGE-TEXT (2)             27010001
270200                                                                  27020001
270300             MOVE '4030-GET-TROUBLE-DESC'                         27030000
270400                               TO DP013-PARAGRAPH                 27040000
270500             MOVE 'SELECT TROUBLE LONG DESC '                     27050000
270600                               TO DP013-MESSAGE-TEXT (1)          27060000
270700             MOVE SQLCA        TO DP013-SQLCA                     27070000
270800             MOVE 'TTRBNTF'    TO DP013-DB2-TABLE-NAME (1)        27080000
270900             MOVE 'TTRBRSN'    TO DP013-DB2-TABLE-NAME (2)        27090000
271000             SET DP013-DB2-ABEND                                  27100000
271100                               TO TRUE                            27110000
271200             SET DP013-XCTL-DISPLAY-RESTART                       27120000
271300                               TO TRUE                            27130000
271400             PERFORM DP013-0000-PROCESS-ABEND                     27140000
271500     END-EVALUATE.                                                27150000
271600 4040-GET-TDISTHD.                                                27160000
271700                                                                  27170000
271800         EXEC SQL                                                 27180000
271900             SELECT TOT_CART_CNT                                  27190000
272000             INTO   :DISTHD-TOT-CART-CNT                          27200000
272100             FROM  TDISTHD                                        27210000
272200          WHERE ORD_NBR          =  :DK-PO-NBR                    27220000
272300          AND   ORD_LNE_NBR      =  :ASC-KEY-PO-LNE-NBR           27230000
272400          AND   RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR               27240000
272500          AND ((TOT_CART_CNT > 0)                                 27250000
272600           OR  (TOT_CART_CNT = 0 AND                              27260000
272700                NOT CRE_USR_ID = ' ' AND                          27270000
272800                NOT CRE_USR_ID = 'RCKUT129' AND                   27280000
272900                NOT SYS_CRE_CDE = ' '))                           27290000
273000         END-EXEC.                                                27300000
273100                                                                  27310000
273200     EVALUATE TRUE                                                27320000
273300           WHEN SQLCODE = +0                                      27330000
273400                SET ASC-CASEPACK-FOUND TO TRUE                    27340000
273500           WHEN SQLCODE = +100                                    27350000
273600                SET ASC-CASEPACK-NOT-FOUND TO TRUE                27360000
273700           WHEN SQLWARN0 NOT = SPACES                             27370000
273800           WHEN SQLCODE  NOT = ZERO                               27380000
273900              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         27390001
274000              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       27400001
274100              MOVE  ASC-KEY-PO-LNE-NBR  TO  PV-DISPLAY-LINE       27410001
274200              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             27420001
274300              STRING  PV-DISPLAY-PO   '-'                         27430001
274400                      PV-DISPLAY-RCVR '-'                         27440001
274500                      PV-DISPLAY-LINE    DELIMITED BY SIZE        27450001
274600                          INTO DP013-MESSAGE-TEXT (2)             27460001
274700                                                                  27470001
274800                MOVE '4040-GET-TDISTHD'                           27480000
274900                               TO DP013-PARAGRAPH                 27490000
275000                MOVE 'UNSUCCESSFUL SELECT OF TDISTHD'             27500000
275100                               TO DP013-MESSAGE-TEXT (1)          27510000
275200                MOVE 'SEARCHING FOR CASEPACK'                     27520000
275300                               TO DP013-MESSAGE-TEXT (2)          27530000
275400                MOVE SQLCA     TO DP013-SQLCA                     27540000
275500                MOVE 'TDISTHD' TO DP013-DB2-TABLE-NAME (1)        27550000
275600                SET DP013-DB2-ABEND                               27560000
275700                      DP013-XCTL-DISPLAY-RESTART                  27570000
275800                                 TO TRUE                          27580000
275900                  PERFORM DP013-0000-PROCESS-ABEND                27590000
276000         END-EVALUATE.                                            27600000
276100                                                                  27610000
276200 4065-SELECT-TKT-FMT-ID.                                          27620000
276300      EXEC SQL                                                    27630000
276400          SELECT DISTINCT TKT_FMT_DESC                            27640000
276500                INTO :TKTFMT-TKT-FMT-DESC                         27650000
276600              FROM TTKTFMT                                        27660000
276700           WHERE                                                  27670000
276800              TKT_FMT_ID = :ASC-TKT-FMT-ID                        27680000
276900     END-EXEC                                                     27690000
277000                                                                  27700000
277100     EVALUATE TRUE                                                27710000
277200           WHEN SQLCODE = +0                                      27720000
277300             MOVE TKTFMT-TKT-FMT-DESC TO ASC-TKT-DESC             27730000
277400           WHEN SQLCODE = +100                                    27740000
277500                  MOVE SPACES    TO ASC-TKT-DESC                  27750000
277600*            WHEN SQLCODE = -904                                  27760000
277700*            WHEN SQLCODE = -911                                  27770000
277800*            WHEN SQLCODE = -913                                  27780000
277900*                 PERFORM 9900-SOFT-ABORT                         27790000
278000             WHEN SQLWARN0 NOT = SPACES                           27800000
278100             WHEN SQLCODE  NOT = ZERO                             27810000
278200                  MOVE '4065-SELECT-TKT-FMT-ID'                   27820000
278300                                 TO DP013-PARAGRAPH               27830000
278400                  MOVE 'UNSUCCESSFUL SELECT OF TTKTFMG'           27840000
278500                                 TO DP013-MESSAGE-TEXT (1)        27850000
278600                  MOVE ASC-TKT-DESC                               27860000
278700                                 TO DP013-MESSAGE-TEXT (2)        27870000
278800                  MOVE SQLCA     TO DP013-SQLCA                   27880000
278900                  MOVE 'TTKTFMT' TO DP013-DB2-TABLE-NAME (1)      27890000
279000                  SET DP013-DB2-ABEND                             27900000
279100                      DP013-XCTL-DISPLAY-RESTART                  27910000
279200                                 TO TRUE                          27920000
279300                  PERFORM DP013-0000-PROCESS-ABEND                27930000
279400         END-EVALUATE.                                            27940000
279500                                                                  27950000
279600 4085-CALL-CICS-API-ARCH.                                         27960000
279700                                                                  27970000
279800     INITIALIZE PV-NIS-SKU-NBR                                    27980000
279900                                                                  27990000
280000     EVALUATE PURITM-SKU-SEQ-NBR                                  28000000
280100          WHEN PC-X-000                                           28010000
280200              MOVE ZEROES           TO PV-NIS-SKU-NBR             28020000
280300                                                                  28030000
280400          WHEN PC-X-999                                           28040000
280500              MOVE 99999999         TO PV-NIS-SKU-NBR             28050000
280600                                                                  28060000
280700          WHEN OTHER                                              28070000
280800              MOVE ASC-ITM-NBR      TO XL001-KEY-ITM-NBR          28080000
280900              SET  XL001-SELECT-SKU                               28090000
281000                   XL001-SELECT-VND-STYL                          28100000
281100                   XL001-BY-ITEM    TO TRUE                       28110000
281200                                                                  28120000
281300              CALL XL001-VSM-PGM USING DFHEIBLK                   28130000
281400                                       XL001-COMMAREA             28140000
281500                                       XL001-ITEM-COMMAREA        28150000
281600              PERFORM 4090-VERIFY-SQL-RETCODE                     28160000
281700     END-EVALUATE.                                                28170000
281800                                                                  28180000
281900 4090-VERIFY-SQL-RETCODE.                                         28190000
282000                                                                  28200000
282100     EVALUATE TRUE                                                28210000
282200        WHEN XL001-SUCCESSFUL                                     28220000
282300             MOVE XL001-SKU-NBR        TO PV-NIS-SKU-NBR          28230000
282400             MOVE XL001-SUB-CL-NBR-2CH TO ASC-CLASS-NBR           28240000
282500                                                                  28250000
282600        WHEN XL001-SKU-SQLCODE = +100                             28260000
282700             MOVE ZEROES TO PV-NIS-SKU-NBR                        28270000
282800                                                                  28280000
282900        WHEN XL001-SKU-SQLCODE = -904                             28290000
283000        WHEN XL001-SKU-SQLCODE = -911                             28300000
283100        WHEN XL001-SKU-SQLCODE = -913                             28310000
283200              PERFORM 9900-SOFT-ABORT                             28320000
283300                                                                  28330000
283400        WHEN XL001-INVALID-ACCESS                                 28340000
283500              MOVE '4085-CALL-CICS-API-ARCH'                      28350000
283600                               TO DP013-PARAGRAPH                 28360000
283700              MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'           28370000
283800                               TO DP013-MESSAGE-TEXT (1)          28380000
283900              MOVE SQLCA       TO DP013-SQLCA                     28390000
284000              MOVE 'XLKUT001'  TO DP013-DB2-TABLE-NAME (1)        28400000
284100              SET DP013-DB2-ABEND                                 28410000
284200                  DP013-XCTL-DISPLAY-RESTART                      28420000
284300                               TO TRUE                            28430000
284400              PERFORM DP013-0000-PROCESS-ABEND                    28440000
284500        WHEN OTHER                                                28450000
284600              MOVE '4085-CALL-CICS-API-ARCH'                      28460000
284700                               TO DP013-PARAGRAPH                 28470000
284800              MOVE 'UNSUCCESSFUL SELECT FROM XLKUT001'            28480000
284900                               TO DP013-MESSAGE-TEXT (1)          28490000
285000              MOVE SQLCA       TO DP013-SQLCA                     28500000
285100              MOVE 'XLKUT001'  TO DP013-DB2-TABLE-NAME (1)        28510000
285200              SET DP013-DB2-ABEND                                 28520000
285300                  DP013-XCTL-DISPLAY-RESTART                      28530000
285400                               TO TRUE                            28540000
285500              PERFORM DP013-0000-PROCESS-ABEND                    28550000
285600     END-EVALUATE.                                                28560000
285700                                                                  28570000
285800 4100-BUILD-PKITEM-SCREEN.                                        28580000
285900                                                                  28590000
286000     MOVE PURCHS-DEPT-NBR          TO ASC-DEPT-NBR.               28600000
286100     MOVE PURCHS-ENT-ID            TO ASC-ENT-ID.                 28610000
286200     MOVE XL001-SUB-CL-NBR-2CH     TO ASC-CLASS-NBR.              28620000
286300     MOVE PV-NIS-SKU-NBR           TO ASC-SKU-SEQ-NBR.            28630000
286400     MOVE PURITM-VEND-STYL-NAME    TO ASC-VEND-STYL-NAME.         28640000
286500     MOVE PURITM-COLOR-DESC        TO ASC-COLOR-DESC.             28650000
286600     MOVE PURITM-SIZE-DESC         TO ASC-SIZE-DESC.              28660000
286700                                                                  28670000
286800/                                                                 28680000
286900 4200-BUILD-UNPKSL-SCREEN.                                        28690000
287000                                                                  28700000
287100     MOVE RECITM-VEND-STYL-NAME    TO ASC-VEND-STYL-NAME.         28710000
287200     MOVE RECITM-COLOR-DESC        TO ASC-COLOR-DESC.             28720000
287300     MOVE RECITM-SIZE-DESC         TO ASC-SIZE-DESC.              28730000
287400                                                                  28740000
287500/                                                                 28750000
287600*----------------------------------------------------------------*28760000
287700*    RESTORE THE DATA ON THE SCREEN FROM THE COMMAREA.           *28770000
287800*----------------------------------------------------------------*28780000
287900 4400-MOVE-COMMAREA-TO-SCREEN.                                    28790000
288000                                                                  28800000
288100     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     28810000
288200     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    28820000
288300     MOVE ASC-FCLTY-DESC           TO AFDESCO.                    28830000
288400     MOVE PC-DASH                  TO ASC-REC-DASH.               28840000
288500     MOVE ASC-RECEIVER             TO ARCVRO.                     28850000
288600     MOVE ASC-CREATED-BY-UID       TO ACRTBYO.                    28860000
288700     MOVE ASC-CREATED-BY-DTE       TO ACRTDTEO.                   28870000
288800     MOVE ASC-CREATED-BY-TME       TO ACRTTMEO.                   28880000
288900     MOVE ASC-PO-LNE-NBR-N         TO ALINEO.                     28890000
289000     MOVE ASC-LAST-UPD-BY-UID      TO ALSTBYO.                    28900000
289100     MOVE ASC-LAST-UPD-BY-DTE      TO ALSTDTEO.                   28910000
289200     MOVE ASC-LAST-UPD-BY-TME      TO ALSTTMEO.                   28920000
289300     MOVE ASC-STATUS-DESC          TO ASTDESCO.                   28930000
289400     MOVE ASC-TROUBLE-DESC         TO ATRBLO.                     28940000
289500     MOVE ASC-INNR-PACK-QTY-N      TO AINNRO.                     28950000
289600     MOVE ASC-PKSL-ITM-QTY         TO APSQTYO.                    28960000
289700     MOVE ASC-GP-RTL-AMT           TO AGRPRTLO.                   28970000
289800     MOVE ASC-CASE-PACK-QTY-N      TO ACASEO.                     28980000
289900     MOVE ASC-DTL-CK-ITM-QTY-N     TO ADCQTYO.                    28990000
290000     MOVE ASC-GP-QTY               TO AGRPQTYO.                   29000000
290100     MOVE ASC-PRE-TKT-IND          TO APRETKTO.                   29010000
290200     MOVE ASC-EXPTED-CART-CNT      TO AEXPCTNO.                   29020000
290300     MOVE ASC-UNT-RTL-PR-AMT       TO ARTLO.                      29030000
290400     MOVE ASC-ACTL-CART-CNT        TO AACTCTNO.                   29040000
290500******    WR # 27201 - START                                      29050000
290600     MOVE ASC-VRFD-LWST-RTL-AMT    TO ALVRO.                      29060000
290700******    WR # 27201 - END                                        29070000
290800     MOVE ASC-TKT-DESC             TO ATKTO.                      29080000
290900     MOVE ASC-RTV-IND              TO ARTVINDO.                   29090000
291000*    MOVE PC-DASH                  TO ASC-SKU-DASH-1              29100000
291100*                                     ASC-SKU-DASH-2.             29110000
291200     MOVE ASC-SKU                  TO ASKUO.                      29120000
291300     MOVE ASC-RTV-QTY-N            TO ARTVQTYO.                   29130000
291400     MOVE ASC-VEND-STYL-NAME       TO ASTYLEO.                    29140000
291500     MOVE ASC-COLOR-DESC           TO ACOLORO.                    29150000
291600     MOVE ASC-DMG-ITM-QTY-N        TO ADMGO.                      29160000
291700                                                                  29170000
291800     IF  ASC-UNT-COST-AMT > SPACES                                29180000
291900         MOVE ASC-UNT-COST-AMT     TO DP010I-UNEDITED-FIELD       29190000
292000         MOVE LENGTH OF ASC-UNT-COST-AMT                          29200000
292100                                   TO DP010I-MAXIMUM-DIGITS       29210000
292200         MOVE +3                   TO DP010I-MAXIMUM-DECIMALS     29220000
292300         SET DP010I-NEGATIVE-NOT-ALLOWED                          29230000
292400                                   TO TRUE                        29240000
292510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         29251007
292520              USING DP010I-NUMERIC-EDIT-AREA                      29252007
292600                                                                  29260000
292700         IF  DP010I-ERROR-DETECTED                                29270000
292800             SET DP020-MSG-FATAL                                  29280000
292900                 PS-ERROR          TO TRUE                        29290000
293000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            29300000
293100             MOVE DP015-UNP-NUM-BRT-OFF                           29310000
293200                                   TO ACOSTA                      29320000
293300             MOVE DP015-RED        TO ACOSTC                      29330000
293400             MOVE DP015-REVERSE    TO ACOSTH                      29340000
293500             MOVE -1               TO ACOSTL                      29350000
293600             SET DP030-SET-CURSOR-APPL-1                          29360000
293700                                   TO TRUE                        29370000
293800         ELSE                                                     29380000
293900             MOVE DP010I-NUMERIC-FIELD                            29390000
294000                                   TO ASC-UNT-COST-AMT-N          29400000
294100                                      DK-UNT-COST-AMT             29410000
294200             MOVE ASC-UNT-COST-AMT-N                              29420000
294300                                   TO ACOSTO                      29430000
294400             MOVE ACOSTO           TO ASC-UNT-COST-AMT            29440000
294500         END-IF                                                   29450000
294600     END-IF.                                                      29460000
294700                                                                  29470000
294800     IF ASC-MTCH-TO-LINE = ZERO                                   29480000
294900         MOVE SPACES               TO AMTCHO                      29490000
295000     ELSE                                                         29500000
295100         MOVE ASC-MTCH-TO-LINE-N   TO AMTCHO                      29510000
295200     END-IF.                                                      29520000
295300                                                                  29530000
295400     MOVE ASC-SIZE-DESC            TO ASIZEO.                     29540000
295500                                                                  29550000
295600*----------------------------------------------------------------*29560000
295700*    PERFORM UPDATE PACK SLIP ITEM PROCESSING                    *29570000
295800*----------------------------------------------------------------*29580000
295900 5000-UPDATE-RECITM-SELECT.                                       29590000
296000                                                                  29600000
296100     IF ASC-PO-LNE-NBR-N > PC-8999                                29610000
296200         IF ASC-MTCH-TO-LINE < PC-9000                            29620000
296300             PERFORM 5100-CHG-UNMATCHED-TO-MATCHED                29630000
296400         END-IF                                                   29640000
296500     ELSE                                                         29650000
296600         PERFORM 5200-UPDATE-RECEIPT-ITEM                         29660000
296700     END-IF.                                                      29670000
296800                                                                  29680000
296900/                                                                 29690000
297000*----------------------------------------------------------------*29700000
297100*    CHANGE FROM AN UNMATCHED PO LINE TO A MATCHED               *29710000
297200*----------------------------------------------------------------*29720000
297300 5100-CHG-UNMATCHED-TO-MATCHED.                                   29730000
297400                                                                  29740000
297500     MOVE ASC-KEY-PO-LNE-NBR       TO DK-PO-LNE-NBR.              29750000
297600                                                                  29760000
297700     PERFORM 5110-SELECT-UNPKSL.                                  29770000
297800     PERFORM 5120-SET-UNPKSL-INACT.                               29780000
297900                                                                  29790000
298000     MOVE PC-INACTIVE              TO UNPKSL-VER-STAT-CDE.        29800000
298100                                                                  29810000
298200     PERFORM 5130-INSERT-UNPKSL.                                  29820000
298300                                                                  29830000
298400     INITIALIZE DCLTPKITEM.                                       29840000
298500     PERFORM 9060-SELECT-TPKITEM.                                 29850000
298600                                                                  29860000
298700     IF PS-PKITEM-FOUND                                           29870000
298800         PERFORM 9070-SET-PKITEM-INACT                            29880000
298900         COMPUTE PKITEM-PKSL-ITM-QTY =                            29890000
299000             PKITEM-PKSL-ITM-QTY + UNPKSL-PKSL-ITM-QTY            29900000
299100     ELSE                                                         29910000
299200         MOVE DK-PO-NBR            TO PKITEM-PO-NBR               29920000
299300         MOVE UNPKSL-SEQ-NBR       TO PKITEM-SEQ-NBR              29930000
299400         MOVE ASC-MTCH-TO-LINE     TO PKITEM-PKSL-LNE-NBR         29940000
299500         MOVE UNPKSL-PKSL-ITM-QTY  TO PKITEM-PKSL-ITM-QTY         29950000
299600         MOVE ASC-PURITM-VER-NBR   TO PKITEM-PURITM-VER-NBR       29960000
299700     END-IF.                                                      29970000
299800                                                                  29980000
299900     PERFORM 5140-INSERT-PKITEM.                                  29990000
300000                                                                  30000000
300100     MOVE ASC-MTCH-TO-LINE-N       TO DK-PO-LNE-NBR.              30010000
300200                                                                  30020000
300300     PERFORM 5200-UPDATE-RECEIPT-ITEM.                            30030000
300400                                                                  30040000
300500     IF  SQLCODE = +0                                             30050000
300600         MOVE PC-TSYMSG-00059      TO DP020-MSG-NUMBER            30060000
300700         SET DP020-MSG-INFORMATIONAL                              30070000
300800                                   TO TRUE                        30080000
300900         IF  ASC-USE-SELECTION-QUEUE                              30090000
301000             PERFORM 5300-UPDATE-SELECTION-QUEUE                  30100000
301100         END-IF                                                   30110000
301200     END-IF.                                                      30120000
301300                                                                  30130000
301400/                                                                 30140000
301500*---------------------------------------------------------------* 30150000
301600*    SELECT THE UNMATCHED PACK SLIP LINE ITEM                   * 30160000
301700*---------------------------------------------------------------* 30170000
301800 5110-SELECT-UNPKSL.                                              30180000
301900                                                                  30190000
302000     EXEC SQL                                                     30200000
302100         SELECT  PO_NBR,                                          30210000
302200                 SEQ_NBR,                                         30220000
302300                 PKSL_LNE_NBR,                                    30230000
302400                 PKSL_ITM_QTY,                                    30240000
302500                 UNT_COST_AMT,                                    30250000
302600                 COLOR_DESC,                                      30260000
302700                 SIZE_DESC,                                       30270000
302800                 VEND_STYL_NAME,                                  30280000
302900                 VEND_DESC                                        30290000
303000           INTO :UNPKSL-PO-NBR,                                   30300000
303100                :UNPKSL-SEQ-NBR,                                  30310000
303200                :UNPKSL-PKSL-LNE-NBR,                             30320000
303300                :UNPKSL-PKSL-ITM-QTY,                             30330000
303400                :UNPKSL-UNT-COST-AMT,                             30340000
303500                :UNPKSL-COLOR-DESC,                               30350000
303600                :UNPKSL-SIZE-DESC,                                30360000
303700                :UNPKSL-VEND-STYL-NAME,                           30370000
303800                :UNPKSL-VEND-DESC                                 30380000
303900           FROM  TUNPKSL                                          30390000
304000          WHERE  PO_NBR       = :DK-PO-NBR                        30400000
304100*??         AND  SEQ_NBR      = :ASC-KEY-SEQ-NBR                  30410000
304200            AND  PKSL_LNE_NBR = :DK-PO-LNE-NBR                    30420000
304300            AND  VER_STAT_CDE = :PC-ACTIVE                        30430000
304400     END-EXEC.                                                    30440000
304500                                                                  30450000
304600     EVALUATE TRUE                                                30460000
304700         WHEN SQLCODE = +0                                        30470000
304800              CONTINUE                                            30480000
304900                                                                  30490000
305000         WHEN SQLCODE = +100                                      30500000
305100              SET PS-UNPKSL-NOT-FOUND                             30510000
305200                               TO TRUE                            30520000
305300                                                                  30530000
305400         WHEN SQLWARN0 NOT = SPACE                                30540000
305500         WHEN SQLCODE < +0                                        30550000
305600         WHEN SQLCODE > +0                                        30560000
305700              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         30570001
305800              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       30580003
305900              MOVE  DK-PO-LNE-NBR       TO  PV-DISPLAY-LINE       30590001
306000              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             30600001
306100              STRING  PV-DISPLAY-PO   '-'                         30610001
306200                      PV-DISPLAY-RCVR '-'                         30620001
306300                      PV-DISPLAY-LINE    DELIMITED BY SIZE        30630001
306400                          INTO DP013-MESSAGE-TEXT (2)             30640001
306500                                                                  30650001
306600              MOVE '5110-SELECT-UNPKSL'                           30660000
306700                               TO DP013-PARAGRAPH                 30670000
306800              MOVE 'SELECT TUNPKSL'                               30680000
306900                               TO DP013-MESSAGE-TEXT (1)          30690000
307000              MOVE SQLCA       TO DP013-SQLCA                     30700000
307100              MOVE 'TUNPKSL'   TO DP013-DB2-TABLE-NAME (1)        30710000
307200              SET DP013-DB2-ABEND                                 30720000
307300                               TO TRUE                            30730000
307400              PERFORM DP013-0000-PROCESS-ABEND                    30740000
307500     END-EVALUATE.                                                30750000
307600                                                                  30760000
307700/                                                                 30770000
307800*----------------------------------------------------------------*30780000
307900*    SET THE CURRENT VERSION OF THE UNMATCHED PACK SLIP ITEM TO  *30790000
308000*    INACTIVE BEFORE THE INSERT OF THE NEW UNMATCHED PACK SLIP   *30800000
308100*    ITEM ROW IS DONE.                                           *30810000
308200*----------------------------------------------------------------*30820000
308300                                                                  30830000
308400 5120-SET-UNPKSL-INACT.                                           30840000
308500                                                                  30850000
308600     EXEC SQL                                                     30860000
308700          UPDATE TUNPKSL                                          30870000
308800             SET VER_STAT_CDE   = :PC-INACTIVE                    30880000
308900           WHERE PO_NBR         = :DK-PO-NBR                      30890000
309000             AND SEQ_NBR        = :UNPKSL-SEQ-NBR                 30900000
309100             AND PKSL_LNE_NBR   = :UNPKSL-PKSL-LNE-NBR            30910000
309200             AND VER_STAT_CDE   = :PC-ACTIVE                      30920000
309300     END-EXEC.                                                    30930000
309400                                                                  30940000
309500     EVALUATE TRUE                                                30950000
309600         WHEN SQLCODE = +0                                        30960000
309700              CONTINUE                                            30970000
309800                                                                  30980000
309900         WHEN SQLWARN0 NOT = SPACES                               30990000
310000         WHEN SQLCODE < +0                                        31000000
310100         WHEN SQLCODE > +0                                        31010000
310200              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         31020001
310300              MOVE  UNPKSL-SEQ-NBR      TO  PV-DISPLAY-RCVR       31030001
310400              MOVE  UNPKSL-PKSL-LNE-NBR TO  PV-DISPLAY-LINE       31040001
310500              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             31050001
310600              STRING  PV-DISPLAY-PO   '-'                         31060001
310700                      PV-DISPLAY-RCVR '-'                         31070001
310800                      PV-DISPLAY-LINE    DELIMITED BY SIZE        31080001
310900                          INTO DP013-MESSAGE-TEXT (2)             31090001
311000                                                                  31100001
311100              MOVE '5120-SET-UNPKSL-INACT'                        31110000
311200                               TO DP013-PARAGRAPH                 31120000
311300              MOVE 'UNSUCCESSFUL UPDATE FOR TUNPKSL'              31130000
311400                               TO DP013-MESSAGE-TEXT (1)          31140000
311500              MOVE SQLCA       TO DP013-SQLCA                     31150000
311600              MOVE 'TUNPKSL '  TO DP013-DB2-TABLE-NAME (1)        31160000
311700              SET DP013-DB2-ABEND                                 31170000
311800                  DP013-XCTL-DISPLAY-RESTART                      31180000
311900                               TO TRUE                            31190000
312000              PERFORM DP013-0000-PROCESS-ABEND                    31200000
312100     END-EVALUATE.                                                31210000
312200                                                                  31220000
312300/                                                                 31230000
312400*----------------------------------------------------------------*31240000
312500*    INSERT AN UNMATCHED PACK SLIP ITEM ROW                      *31250000
312600*----------------------------------------------------------------*31260000
312700                                                                  31270000
312800 5130-INSERT-UNPKSL.                                              31280000
312900                                                                  31290000
313000     EXEC SQL                                                     31300000
313100          INSERT INTO TUNPKSL                                     31310000
313200                 (PO_NBR,                                         31320000
313300                  SEQ_NBR,                                        31330000
313400                  PKSL_LNE_NBR,                                   31340000
313500                  CRE_TMST,                                       31350000
313600                  VER_STAT_CDE,                                   31360000
313700                  PKSL_ITM_QTY,                                   31370000
313800                  UNT_COST_AMT,                                   31380000
313900                  COLOR_DESC,                                     31390000
314000                  SIZE_DESC,                                      31400000
314100                  VEND_STYL_NAME,                                 31410000
314200                  VEND_DESC,                                      31420000
314300                  CRE_UID)                                        31430000
314400          VALUES (:UNPKSL-PO-NBR,                                 31440000
314500                  :UNPKSL-SEQ-NBR,                                31450000
314600                  :UNPKSL-PKSL-LNE-NBR,                           31460000
314700                   CURRENT TIMESTAMP,                             31470000
314800                  :UNPKSL-VER-STAT-CDE,                           31480000
314900                  :UNPKSL-PKSL-ITM-QTY,                           31490000
315000                  :UNPKSL-UNT-COST-AMT,                           31500000
315100                  :UNPKSL-COLOR-DESC,                             31510000
315200                  :UNPKSL-SIZE-DESC,                              31520000
315300                  :UNPKSL-VEND-STYL-NAME,                         31530000
315400                  :UNPKSL-VEND-DESC,                              31540000
315500                  :DP020-USERID)                                  31550000
315600     END-EXEC.                                                    31560000
315700                                                                  31570000
315800     EVALUATE TRUE                                                31580000
315900         WHEN SQLCODE = +0                                        31590000
316000              CONTINUE                                            31600000
316100                                                                  31610000
316200         WHEN SQLWARN0 NOT = SPACES                               31620000
316300         WHEN SQLCODE < +0                                        31630000
316400         WHEN SQLCODE > +0                                        31640000
316500              MOVE  UNPKSL-PO-NBR       TO  PV-DISPLAY-PO         31650001
316600              MOVE  UNPKSL-SEQ-NBR      TO  PV-DISPLAY-RCVR       31660001
316700              MOVE  UNPKSL-PKSL-LNE-NBR TO  PV-DISPLAY-LINE       31670001
316800              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             31680001
316900              STRING  PV-DISPLAY-PO   '-'                         31690001
317000                      PV-DISPLAY-RCVR '-'                         31700001
317100                      PV-DISPLAY-LINE    DELIMITED BY SIZE        31710001
317200                          INTO DP013-MESSAGE-TEXT (2)             31720001
317300                                                                  31730001
317400              MOVE '5130-INSERT-UNPKSL'                           31740000
317500                               TO DP013-PARAGRAPH                 31750000
317600              MOVE 'UNSUCCESSFUL INSERT FOR TUNPKSL'              31760000
317700                               TO DP013-MESSAGE-TEXT (1)          31770000
317800              MOVE SQLCA       TO DP013-SQLCA                     31780000
317900              MOVE 'TUNPKSL '  TO DP013-DB2-TABLE-NAME (1)        31790000
318000              SET DP013-DB2-ABEND                                 31800000
318100                  DP013-XCTL-DISPLAY-RESTART                      31810000
318200                               TO TRUE                            31820000
318300              PERFORM DP013-0000-PROCESS-ABEND                    31830000
318400     END-EVALUATE.                                                31840000
318500                                                                  31850000
318600/                                                                 31860000
318700*----------------------------------------------------------------*31870000
318800*    INSERT A PACK SLIP ITEM ROW                                 *31880000
318900*----------------------------------------------------------------*31890000
319000                                                                  31900000
319100 5140-INSERT-PKITEM.                                              31910000
319200                                                                  31920000
319300     EXEC SQL                                                     31930000
319400          INSERT INTO TPKITEM                                     31940000
319500                 (PO_NBR,                                         31950000
319600                  SEQ_NBR,                                        31960000
319700                  PKSL_LNE_NBR,                                   31970000
319800                  CRE_TMST,                                       31980000
319900                  VER_STAT_CDE,                                   31990000
320000                  PKSL_ITM_QTY,                                   32000000
320100                  CRE_UID,                                        32010000
320200                  PURITM_VER_NBR)                                 32020000
320300          VALUES (:PKITEM-PO-NBR,                                 32030000
320400                  :PKITEM-SEQ-NBR,                                32040000
320500                  :PKITEM-PKSL-LNE-NBR,                           32050000
320600                   CURRENT TIMESTAMP,                             32060000
320700                  :PC-ACTIVE,                                     32070000
320800                  :PKITEM-PKSL-ITM-QTY,                           32080000
320900                  :DP020-USERID,                                  32090000
321000                  :PKITEM-PURITM-VER-NBR)                         32100000
321100     END-EXEC.                                                    32110000
321200                                                                  32120000
321300     EVALUATE TRUE                                                32130000
321400         WHEN SQLCODE = +0                                        32140000
321500              CONTINUE                                            32150000
321600                                                                  32160000
321700         WHEN SQLWARN0 NOT = SPACES                               32170000
321800         WHEN SQLCODE < +0                                        32180000
321900         WHEN SQLCODE > +0                                        32190000
322000              MOVE  PKITEM-PO-NBR       TO  PV-DISPLAY-PO         32200001
322100              MOVE  PKITEM-SEQ-NBR      TO  PV-DISPLAY-RCVR       32210001
322200              MOVE  PKITEM-PKSL-LNE-NBR TO  PV-DISPLAY-LINE       32220001
322300              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             32230001
322400              STRING  PV-DISPLAY-PO   '-'                         32240001
322500                      PV-DISPLAY-RCVR '-'                         32250001
322600                      PV-DISPLAY-LINE    DELIMITED BY SIZE        32260001
322700                          INTO DP013-MESSAGE-TEXT (2)             32270001
322800                                                                  32280001
322900              MOVE '5140-INSERT-PKITEM'                           32290000
323000                               TO DP013-PARAGRAPH                 32300000
323100              MOVE 'UNSUCCESSFUL INSERT FOR TPKITEM'              32310000
323200                               TO DP013-MESSAGE-TEXT (1)          32320000
323300              MOVE SQLCA       TO DP013-SQLCA                     32330000
323400              MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)        32340000
323500              SET DP013-DB2-ABEND                                 32350000
323600                  DP013-XCTL-DISPLAY-RESTART                      32360000
323700                               TO TRUE                            32370000
323800              PERFORM DP013-0000-PROCESS-ABEND                    32380000
323900     END-EVALUATE.                                                32390000
324000/                                                                 32400000
324100*----------------------------------------------------------------*32410000
324200*    PERFORM UPDATE RECEIPT ITEM PROCESSING                      *32420000
324300*----------------------------------------------------------------*32430000
324400 5200-UPDATE-RECEIPT-ITEM.                                        32440000
324500                                                                  32450000
324600     IF (ASC-DTL-CK-ITM-QTY-N = 0) OR                             32460000
324700        ASC-DTL-CK-ITM-QTY-N =  RECITM-DTL-CK-ITM-QTY             32470000
324800         MOVE 'RETURN  ' TO PC000-SEL-QUEUE-NAME                  32480000
324900     END-IF.                                                      32490000
325000                                                                  32500000
325100     IF PS-RECITM-FOUND                                           32510000
325200         CONTINUE                                                 32520000
325300     ELSE                                                         32530000
325400         MOVE DK-PO-NBR            TO RECITM-ORD-NBR              32540000
325500         MOVE DK-PO-LNE-NBR        TO RECITM-ORD-LNE-NBR          32550000
325600         MOVE DK-REC-SEQ-NBR       TO RECITM-REC-SEQ-NBR          32560000
325700         MOVE ASC-KEY-OPER-UNT-ID  TO RECITM-OPER-UNT-ID          32570000
325800         MOVE ASC-KEY-FCLTY-ID     TO RECITM-FCLTY-ID             32580000
325900         MOVE ASC-PURITM-VER-NBR   TO RECITM-PO-VER-NBR           32590000
326000         MOVE ASC-ITM-NBR          TO RECITM-ITM-NBR              32600000
326100     END-IF.                                                      32610000
326200                                                                  32620000
326300     MOVE ASC-INNR-PACK-QTY-N      TO RECITM-INNR-PACK-QTY.       32630000
326400     MOVE ASC-CASE-PACK-QTY-N      TO RECITM-CASE-PACK-QTY.       32640000
326500     MOVE ASC-PRE-TKT-IND          TO RECITM-PRE-TKT-IND.         32650000
326600     MOVE ASC-DTL-CK-ITM-QTY-N     TO RECITM-DTL-CK-ITM-QTY.      32660000
326700     MOVE ASC-DMG-ITM-QTY-N        TO RECITM-DMG-ITM-QTY.         32670000
326800     MOVE ASC-RTV-IND              TO RECITM-RTV-IND.             32680000
326900     MOVE ASC-RTV-QTY-N            TO RECITM-RTV-QTY.             32690000
327000     MOVE DK-UNT-COST-AMT          TO RECITM-UNT-COST-AMT.        32700000
327100     MOVE ASC-PKSL-ITM-QTY  TO        RECITM-PKSL-ITM-QTY.        32710000
327200                                                                  32720000
327300     PERFORM 9010-UPDATE-RECITM.                                  32730000
327400                                                                  32740000
327500     IF  SQLCODE = +0                                             32750000
327600         MOVE PC-TSYMSG-00059      TO DP020-MSG-NUMBER            32760000
327700         SET DP020-MSG-INFORMATIONAL                              32770000
327800                                   TO TRUE                        32780000
327900         IF  ASC-USE-SELECTION-QUEUE                              32790000
328000             PERFORM 5300-UPDATE-SELECTION-QUEUE                  32800000
328100         END-IF                                                   32810000
328200     END-IF.                                                      32820000
328300     IF PS-INACTIVATE-CARTONS                                     32830000
328400         PERFORM 8300-INACTIVATE-CARTONS                          32840000
328500     END-IF.                                                      32850000
328600/                                                                 32860000
328700*----------------------------------------------------------------*32870000
328800* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *32880000
328900* OBJECT WAS UDPATED.                                            *32890000
329000*----------------------------------------------------------------*32900000
329100                                                                  32910000
329200 5300-UPDATE-SELECTION-QUEUE.                                     32920000
329300                                                                  32930000
329400     PERFORM 9100-READ-SEL-QUEUE.                                 32940000
329500                                                                  32950000
329600     SET PC016-UPD (ASC-SEL-SUB)   TO TRUE.                       32960000
329700                                                                  32970000
329800     PERFORM 9200-REWRITE-SEL-QUEUE.                              32980000
329900                                                                  32990000
330000/                                                                 33000000
330100*----------------------------------------------------------------*33010000
330200* DETERMINE WHAT QUANITITY NEEDS TO BE REDISTROED AND PASS IT    *33020000
330300* FOR PROCESSING THRU THE TROUBLE AND REDISTRO ROUTINES.         *33030000
330400*----------------------------------------------------------------*33040000
330500 6000-PROCESS-REDISTRO.                                           33050000
330600                                                                  33060000
330700     IF ASC-DTL-CK-ITM-QTY > ZEROS                                33070000
330800         MOVE ASC-DTL-CK-ITM-QTY-N TO PV-BASE-DISTRO-QTY          33080000
330900     ELSE                                                         33090000
331000         MOVE ASC-PKSL-ITM-QTY     TO PV-BASE-DISTRO-QTY          33100000
331100     END-IF.                                                      33110000
331200                                                                  33120000
331300     COMPUTE PV-DISTRO-QTY = PV-BASE-DISTRO-QTY -                 33130000
331400         (ASC-DMG-ITM-QTY-N + ASC-RTV-QTY-N).                     33140000
331500                                                                  33150000
331600     PERFORM 6100-CHECK-FOR-TROUBLE.                              33160000
331700                                                                  33170000
331800     IF PS-REDISTRO-OK                                            33180000
331900         IF TM500-IN-TROUBLE                                      33190000
332000* JAK 05/2007 ADD ERROR MSGS FOR WMS                              33200000
332100**           MOVE PC-TSYMSG-00941        TO DP020-MSG-NUMBER      33210000
332200**           SET DP020-MSG-INFORMATIONAL TO TRUE                  33220000
332300             IF TM500-ASN-SENT-TO-WMS-YES                         33230000
332400**               * REDISTRO SUCCESSFUL, ASN WILL BE               33240000
332500**               * DOWNLOADED TO WMS BUT TROUBLE CREATED          33250000
332600                 MOVE PC-TSYMSG-03569  TO DP020-MSG-NUMBER        33260000
332700                 SET DP020-MSG-INFORMATIONAL TO TRUE              33270000
332800             ELSE                                                 33280000
332900*                * REDISTRO SUCCESSFUL BUT TROUBLE CREATED        33290000
333000                 MOVE PC-TSYMSG-00941  TO DP020-MSG-NUMBER        33300000
333100                 SET DP020-MSG-INFORMATIONAL TO TRUE              33310000
333200             END-IF                                               33320000
333300         ELSE                                                     33330000
333400**           MOVE PC-TSYMSG-00059        TO DP020-MSG-NUMBER      33340000
333500**           SET DP020-MSG-INFORMATIONAL TO TRUE                  33350000
333600             IF TM500-ASN-SENT-TO-WMS-YES                         33360000
333700*                * REDISTRO SUCCESSFUL AND ASN WILL BE            33370000
333800*                * DOWNLOADED TO WMS                              33380000
333900                 MOVE PC-TSYMSG-03568  TO DP020-MSG-NUMBER        33390000
334000                 SET DP020-MSG-INFORMATIONAL TO TRUE              33400000
334100             ELSE                                                 33410000
334200*                * REDISTRO SUCCESSFUL                            33420000
334300                 MOVE PC-TSYMSG-00059  TO DP020-MSG-NUMBER        33430000
334400                 SET DP020-MSG-INFORMATIONAL TO TRUE              33440000
334500             END-IF                                               33450000
334600* JAK 05/2007 END                                                 33460000
334700         END-IF                                                   33470000
334800     ELSE                                                         33480000
334900         MOVE PC-TSYMSG-00937        TO DP020-MSG-NUMBER          33490000
335000         SET DP020-MSG-INFORMATIONAL TO TRUE                      33500000
335100     END-IF.                                                      33510000
335200                                                                  33520000
335300 6100-CHECK-FOR-TROUBLE.                                          33530000
335400                                                                  33540000
335500     INITIALIZE TM500-FIELDS.                                     33550000
335600                                                                  33560000
335700     SET  TM500-CREATE-AUTO        TO TRUE.                       33570000
335800     SET  TM500-LINE-LEVEL         TO TRUE.                       33580000
335900     SET  TM500-NO-DETAILS         TO TRUE.                       33590000
336000     SET  TM500-REDISTRO-YES       TO TRUE.                       33600000
336100     MOVE ASC-KEY-PO-NBR           TO TM500-PO-NBR.               33610000
336200     MOVE ASC-KEY-PO-LNE-NBR       TO TM500-PO-LNE-NBR.           33620000
336300     MOVE ASC-KEY-OPER-UNT-ID      TO TM500-OPER-UNT-ID.          33630000
336400     MOVE ASC-KEY-FCLTY-ID         TO TM500-FCLTY-ID.             33640000
336500     MOVE PV-DISTRO-QTY            TO TM500-UNITS-TO-ALLOC.       33650000
336600     MOVE ASC-PURITM-PIC-ITM-IND   TO TM500-AD-SW.                33660000
336700*  TM500-RTV-SW IS LOADED BY TMKCS505 ONLY                        33670000
336800*    MOVE ASC-RTV-IND              TO TM500-RTV-SW.               33680000
336900     MOVE PC-CURRENT-PROGRAM-NAME  TO TM500-NOTIF-UID.            33690000
337000     MOVE ASC-KEY-REC-SEQ-NBR      TO TM500-REC-SEQ-NBR           33700000
337100                                                                  33710000
337200     SET PS-REDISTRO-OK            TO TRUE                        33720000
337300     PERFORM 9100-LINK-TROUBLE.                                   33730000
337400                                                                  33740000
337500     EVALUATE TRUE                                                33750000
337600         WHEN TM500-CALL-SUCCESSFUL                               33760000
337700         WHEN TM500-DUPLICATE-TROUBLE                             33770000
337800         WHEN TM500-TTRBNTF-UPDATE-NOT-FND                        33780000
337900              IF TM500-IN-TROUBLE                                 33790000
338000                  ADD 1 TO PV-TROUBLE-COUNT                       33800000
338100              ELSE                                                33810000
338200                  ADD 1 TO PV-NOT-IN-TROUBLE-COUNT                33820000
338300              END-IF                                              33830000
338400                                                                  33840000
338500         WHEN TM500-DIDNT-ALLOC-DUE-TO-TRBL                       33850000
338600              SET PS-REDISTRO-NOT-OK TO TRUE                      33860000
338700                                                                  33870000
338800              IF TM500-IN-TROUBLE                                 33880000
338900                  ADD 1 TO PV-TROUBLE-COUNT                       33890000
339000              ELSE                                                33900000
339100                  ADD 1 TO PV-NOT-IN-TROUBLE-COUNT                33910000
339200              END-IF                                              33920000
339300                                                                  33930000
339400         WHEN OTHER                                               33940000
339500              MOVE '6100-CHECK-FOR-TROUBLE'                       33950000
339600                                    TO DP013-PARAGRAPH            33960000
339700              MOVE 'UNSUCCESSFUL CALL TO TROUBLE RTN'             33970000
339800                                    TO DP013-MESSAGE-TEXT (1)     33980000
339900              MOVE TM500-RETURN-MSG TO DP013-MESSAGE-TEXT (2)     33990000
340000              MOVE TM500-SQLCA      TO DP013-SQLCA                34000000
340100              SET DP013-DB2-ABEND                                 34010000
340200                  DP013-XCTL-DISPLAY-RESTART                      34020000
340300                                    TO TRUE                       34030000
340400              PERFORM DP013-0000-PROCESS-ABEND                    34040000
340500                                                                  34050000
340600     END-EVALUATE.                                                34060000
340700/                                                                 34070000
340800*----------------------------------------------------------------*34080000
340900*    START OF THE DELETE PROCESS.                                *34090000
341000*----------------------------------------------------------------*34100000
341100                                                                  34110000
341200 7000-DELETE-PROCESS.                                             34120000
341300                                                                  34130000
341400     MOVE ASC-KEY-PO-NBR           TO  DK-PO-NBR.                 34140000
341500     MOVE ASC-KEY-PO-LNE-NBR       TO  DK-PO-LNE-NBR.             34150000
341600     MOVE ASC-KEY-REC-SEQ-NBR      TO  DK-REC-SEQ-NBR.            34160000
341700                                                                  34170000
341800     PERFORM 8000-SELECT-RECITM.                                  34180000
341900     IF  SQLCODE EQUAL ZERO                                       34190000
342000         IF  RECITM-STATUS-CDE EQUAL PC-IP OR PC-CM               34200000
342100             PERFORM 7100-CONTINUE-DELETE                         34210000
342200             SET ASC-DELETED       TO  TRUE                       34220000
342300         ELSE                                                     34230000
342400             MOVE PC-TSYMSG-00889  TO  DP020-MSG-NUMBER           34240000
342500             SET PS-ERROR                                         34250000
342600                 DP020-MSG-FATAL   TO  TRUE                       34260000
342700         END-IF                                                   34270000
342800     ELSE                                                         34280000
342900         MOVE PC-TSYMSG-00148      TO  DP020-MSG-NUMBER           34290000
343000         SET DP020-MSG-FATAL       TO  TRUE                       34300000
343100             SET PS-ERROR          TO  TRUE                       34310000
343200     END-IF.                                                      34320000
343300/                                                                 34330000
343400*----------------------------------------------------------------*34340000
343500*    WE CAN ALWAYS DELETE THE WORK ORDER INFORMATION.  FIRST,    *34350000
343600*    DELETE THAT, THEN CHECK TO SEE IF WE CAN DELETE MORE.       *34360000
343700*----------------------------------------------------------------*34370000
343800                                                                  34380000
343900 7100-CONTINUE-DELETE.                                            34390000
344000                                                                  34400000
344100     PERFORM 7140-COUNT-PACK-SLIPS.                               34410000
344200     IF  PV-DB2-COUNT EQUAL ZERO                                  34420000
344300         PERFORM 7110-DELETE-TWRKORD                              34430000
344400         PERFORM 7120-DELETE-TWKORIN                              34440000
344500*        PERFORM 7130-DELETE-TWOSTAL                              34450006
344600                                                                  34460000
344700         PERFORM 7135-DELETE-TROUBLE                              34470000
344800         PERFORM 7200-FINISH-DELETE                               34480000
344900* JAK 06/2007 - ADD WMS SPECIFIC MESSAGE                          34490000
345000****     MOVE PC-TSYMSG-00115      TO  DP020-MSG-NUMBER           34500000
345100         IF PS-ASNS-TO-WMS-YES                                    34510000
345200             IF WS001-SUCCESSFUL                                  34520000
345300                 MOVE PC-TSYMSG-03578      TO  DP020-MSG-NUMBER   34530000
345400             ELSE                                                 34540000
345500                 MOVE PC-TSYMSG-03546      TO  DP020-MSG-NUMBER   34550000
345600             END-IF                                               34560000
345700         ELSE                                                     34570000
345800             MOVE PC-TSYMSG-00115      TO  DP020-MSG-NUMBER       34580000
345900         END-IF                                                   34590000
346000     ELSE                                                         34600000
346100         MOVE PC-TSYMSG-00890      TO  DP020-MSG-NUMBER           34610000
346200******** PERFORM 7315-CHECK-RECEIV-STATUS                         34620000
346300     END-IF.                                                      34630000
346400     SET DP020-MSG-INFORMATIONAL   TO  TRUE.                      34640000
346500                                                                  34650000
346600/                                                                 34660000
346700*----------------------------------------------------------------*34670000
346800*    "DELETE" THE CURRENT TWRKORD ROW - MAKE INACTIVE.           *34680000
346900*----------------------------------------------------------------*34690000
347000                                                                  34700000
347100 7110-DELETE-TWRKORD.                                             34710000
347200                                                                  34720000
347300     EXEC SQL                                                     34730000
347400          UPDATE                                                  34740000
347500                TWRKORD                                           34750000
347600          SET   VER_STATUS_CDE     =  :PC-INACTIVE                34760000
347700              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    34770000
347800*             , CRE_TMST           =   CURRENT TIMESTAMP          34780000
347900          WHERE                                                   34790000
348000                ORD_NBR            =  :DK-PO-NBR                  34800000
348100          AND   ORD_LNE_NBR        =  :DK-PO-LNE-NBR              34810000
348200          AND   RCVR_SEQ_NBR       =  :DK-REC-SEQ-NBR             34820000
348300          AND   OPER_UNT_ID        =  :ASC-KEY-OPER-UNT-ID        34830000
348400          AND   FCLTY_ID           =  :ASC-KEY-FCLTY-ID           34840000
348500          AND   VER_STATUS_CDE     =  :PC-A                       34850000
348600     END-EXEC.                                                    34860000
348700                                                                  34870000
348800     EVALUATE TRUE                                                34880000
348900         WHEN SQLCODE = ZERO                                      34890000
349000         WHEN SQLCODE = +100                                      34900000
349100              CONTINUE                                            34910000
349200         WHEN SQLWARN0 NOT = SPACE                                34920000
349300         WHEN SQLCODE NOT = ZERO                                  34930000
349400              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         34940001
349500              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       34950001
349600              MOVE  DK-PO-LNE-NBR       TO  PV-DISPLAY-LINE       34960001
349700              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             34970001
349800              STRING  PV-DISPLAY-PO   '-'                         34980001
349900                      PV-DISPLAY-RCVR '-'                         34990001
350000                      PV-DISPLAY-LINE    DELIMITED BY SIZE        35000001
350100                          INTO DP013-MESSAGE-TEXT (2)             35010001
350200                                                                  35020001
350300              MOVE '7110-DELETE-TWRKORD'                          35030000
350400                               TO DP013-PARAGRAPH                 35040000
350500              MOVE 'UPDATE TWRKORD STATUS CODE, UID; TO INACTIVE' 35050000
350600                               TO DP013-MESSAGE-TEXT (1)          35060000
350700              MOVE SQLCA       TO DP013-SQLCA                     35070000
350800              MOVE 'TWRKORD'   TO DP013-DB2-TABLE-NAME (1)        35080000
350900              SET DP013-DB2-ABEND                                 35090000
351000                               TO TRUE                            35100000
351100              PERFORM DP013-0000-PROCESS-ABEND                    35110000
351200     END-EVALUATE.                                                35120000
351300/                                                                 35130000
351400*----------------------------------------------------------------*35140000
351500*    "DELETE" THE CURRENT TWKORIN ROW - MAKE INACTIVE.           *35150000
351600*----------------------------------------------------------------*35160000
351700                                                                  35170000
351800 7120-DELETE-TWKORIN.                                             35180000
351900                                                                  35190000
352000     EXEC SQL                                                     35200000
352100          UPDATE                                                  35210000
352200                TWKORIN                                           35220000
352300          SET   VER_STATUS_CDE     =  :PC-INACTIVE                35230000
352400              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    35240000
352500*             , CRE_TMST           =   CURRENT TIMESTAMP          35250000
352600          WHERE                                                   35260000
352700                ORD_NBR            =  :DK-PO-NBR                  35270000
352800          AND   ORD_LNE_NBR        =  :DK-PO-LNE-NBR              35280000
352900          AND   RCVR_SEQ_NBR       =  :DK-REC-SEQ-NBR             35290000
353000          AND   OPER_UNT_ID        =  :ASC-KEY-OPER-UNT-ID        35300000
353100          AND   FCLTY_ID           =  :ASC-KEY-FCLTY-ID           35310000
353200          AND   VER_STATUS_CDE     =  :PC-A                       35320000
353300     END-EXEC.                                                    35330000
353400                                                                  35340000
353500     EVALUATE TRUE                                                35350000
353600         WHEN SQLCODE = ZERO                                      35360000
353700         WHEN SQLCODE = +100                                      35370000
353800              CONTINUE                                            35380000
353900         WHEN SQLWARN0 NOT = SPACE                                35390000
354000         WHEN SQLCODE NOT = ZERO                                  35400000
354100              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         35410001
354200              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       35420001
354300              MOVE  DK-PO-LNE-NBR       TO  PV-DISPLAY-LINE       35430001
354400              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             35440001
354500              STRING  PV-DISPLAY-PO   '-'                         35450001
354600                      PV-DISPLAY-RCVR '-'                         35460001
354700                      PV-DISPLAY-LINE    DELIMITED BY SIZE        35470001
354800                          INTO DP013-MESSAGE-TEXT (2)             35480001
354900                                                                  35490001
355000              MOVE '7120-DELETE-TWKORIN'                          35500000
355100                               TO DP013-PARAGRAPH                 35510000
355200              MOVE 'UPDATE TWKORIN STATUS CODE, UID; TO INACTIVE' 35520000
355300                               TO DP013-MESSAGE-TEXT (1)          35530000
355400              MOVE SQLCA       TO DP013-SQLCA                     35540000
355500              MOVE 'TWKORIN'   TO DP013-DB2-TABLE-NAME (1)        35550000
355600              SET DP013-DB2-ABEND                                 35560000
355700                               TO TRUE                            35570000
355800              PERFORM DP013-0000-PROCESS-ABEND                    35580000
355900     END-EVALUATE.                                                35590000
356000/                                                                 35600000
356100*----------------------------------------------------------------*35610000
356200*    "DELETE" THE CURRENT TWOSTAL ROW - MAKE INACTIVE.           *35620000
356300*----------------------------------------------------------------*35630000
356400*                                                                 35640006
356500*7130-DELETE-TWOSTAL.                                             35650006
356600*                                                                 35660006
356700*    EXEC SQL                                                     35670006
356800*         UPDATE                                                  35680006
356900*               TWOSTAL                                           35690006
357000*         SET   VER_STATUS_CDE     =  :PC-INACTIVE                35700006
357100*             , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    35710006
357200*             , CRE_TMST           =   CURRENT TIMESTAMP          35720000
357300*         WHERE                                                   35730006
357400*               ORD_NBR            =  :DK-PO-NBR                  35740006
357500*         AND   ORD_LNE_NBR        =  :DK-PO-LNE-NBR              35750006
357600*         AND   RCVR_SEQ_NBR       =  :DK-REC-SEQ-NBR             35760006
357700*         AND   OPER_UNT_ID        =  :ASC-KEY-OPER-UNT-ID        35770006
357800*         AND   FCLTY_ID           =  :ASC-KEY-FCLTY-ID           35780006
357900*         AND   VER_STATUS_CDE     =  :PC-A                       35790006
358000*    END-EXEC.                                                    35800006
358100*                                                                 35810006
358200*    EVALUATE TRUE                                                35820006
358300*        WHEN SQLCODE = ZERO                                      35830006
358400*        WHEN SQLCODE = +100                                      35840006
358500*             CONTINUE                                            35850006
358600*        WHEN SQLWARN0 NOT = SPACE                                35860006
358700*        WHEN SQLCODE NOT = ZERO                                  35870006
358800*             MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         35880006
358900*             MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       35890006
359000*             MOVE  DK-PO-LNE-NBR       TO  PV-DISPLAY-LINE       35900006
359100*             MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             35910006
359200*             STRING  PV-DISPLAY-PO   '-'                         35920006
359300*                     PV-DISPLAY-RCVR '-'                         35930006
359400*                     PV-DISPLAY-LINE    DELIMITED BY SIZE        35940006
359500*                         INTO DP013-MESSAGE-TEXT (2)             35950006
359600*                                                                 35960006
359700*             MOVE '7130-DELETE-TWOSTAL'                          35970006
359800*                              TO DP013-PARAGRAPH                 35980006
359900*             MOVE 'UPDATE TWOSTAL STATUS CODE, UID; TO INACTIVE' 35990006
360000*                              TO DP013-MESSAGE-TEXT (1)          36000006
360100*             MOVE SQLCA       TO DP013-SQLCA                     36010006
360200*             MOVE 'TWOSTAL'   TO DP013-DB2-TABLE-NAME (1)        36020006
360300*             SET DP013-DB2-ABEND                                 36030006
360400*                              TO TRUE                            36040006
360500*             PERFORM DP013-0000-PROCESS-ABEND                    36050006
360600*    END-EVALUATE.                                                36060006
360700*                                                                 36070006
360800*----------------------------------------------------------------*36080000
360900*    BY DELETING THE NOTIFICATION ROWS, R.I. WITH DELETE CASCADE *36090000
361000*    DELETES ALL TROUBLE DETAIL ROWS AS WELL.                    *36100000
361100*----------------------------------------------------------------*36110000
361200                                                                  36120000
361300 7135-DELETE-TROUBLE.                                             36130000
361400                                                                  36140000
361500     EXEC SQL                                                     36150000
361600          DELETE                                                  36160000
361700            FROM TTRBNTF                                          36170000
361800           WHERE PO_NBR       = :DK-PO-NBR                        36180000
361900             AND PO_LNE_NBR   = :DK-PO-LNE-NBR                    36190000
362000             AND REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   36200000
362100     END-EXEC.                                                    36210000
362200                                                                  36220000
362300     EVALUATE TRUE                                                36230000
362400         WHEN SQLCODE = +0                                        36240000
362500         WHEN SQLCODE = +100                                      36250000
362600              CONTINUE                                            36260000
362700                                                                  36270000
362800         WHEN SQLWARN0 NOT = SPACES                               36280000
362900         WHEN SQLCODE < +0                                        36290000
363000         WHEN SQLCODE > +0                                        36300000
363100              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         36310001
363200              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       36320001
363300              MOVE  DK-PO-LNE-NBR       TO  PV-DISPLAY-LINE       36330001
363400              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             36340001
363500              STRING  PV-DISPLAY-PO   '-'                         36350001
363600                      PV-DISPLAY-RCVR '-'                         36360001
363700                      PV-DISPLAY-LINE    DELIMITED BY SIZE        36370001
363800                          INTO DP013-MESSAGE-TEXT (2)             36380001
363900                                                                  36390001
364000              MOVE '7135-DELETE-TROUBLE'                          36400000
364100                               TO DP013-PARAGRAPH                 36410000
364200              MOVE 'UNSUCCESSFUL DELETE ON TTRBNTF'               36420000
364300                               TO DP013-MESSAGE-TEXT (1)          36430000
364400              MOVE SQLCA       TO DP013-SQLCA                     36440000
364500              MOVE 'TTRBNTF '  TO DP013-DB2-TABLE-NAME (1)        36450000
364600              SET DP013-DB2-ABEND                                 36460000
364700                  DP013-XCTL-DISPLAY-RESTART                      36470000
364800                               TO TRUE                            36480000
364900              PERFORM DP013-0000-PROCESS-ABEND                    36490000
365000     END-EVALUATE.                                                36500000
365100                                                                  36510000
365200/                                                                 36520000
365300*----------------------------------------------------------------*36530000
365400*    COUNT THE NUMBER OF PACK SLIP ROWS.                         *36540000
365500*----------------------------------------------------------------*36550000
365600                                                                  36560000
365700 7140-COUNT-PACK-SLIPS.                                           36570000
365800                                                                  36580000
365900     MOVE ZERO            TO  PV-DB2-COUNT.                       36590000
366000                                                                  36600000
366100     EXEC SQL                                                     36610000
366200          SELECT                                                  36620000
366300                COUNT(*)                                          36630000
366400          INTO                                                    36640000
366500                :PV-DB2-COUNT :PV-NULL-IND                        36650000
366600          FROM                                                    36660000
366700                TRECITM A                                         36670000
366800              , TPKSLIP B                                         36680000
366900              , TPKITEM C                                         36690000
367000          WHERE                                                   36700000
367100                A.ORD_NBR            =  :DK-PO-NBR                36710000
367200          AND   A.ORD_LNE_NBR        =  :DK-PO-LNE-NBR            36720000
367300          AND   A.REC_SEQ_NBR        =  :DK-REC-SEQ-NBR           36730000
367400          AND   A.VER_STATUS_CDE     =  :PC-A                     36740000
367500          AND   A.ORD_NBR            =  B.PO_NBR                  36750000
367600          AND   A.ORD_NBR            =  C.PO_NBR                  36760000
367700          AND   A.REC_SEQ_NBR        =  B.REC_SEQ_NBR             36770000
367800          AND   B.VER_STAT_CDE       =  :PC-A                     36780000
367900          AND   C.VER_STAT_CDE       =  :PC-A                     36790000
368000          AND   B.PKSL_STAT_CDE      =  :PC-AC                    36800000
368100          AND   B.SEQ_NBR            =  C.SEQ_NBR                 36810000
368200          AND   C.PKSL_LNE_NBR       =  :DK-PO-LNE-NBR            36820000
368300     END-EXEC.                                                    36830000
368400                                                                  36840000
368500     EVALUATE TRUE                                                36850000
368600         WHEN SQLCODE = ZERO                                      36860000
368700         WHEN SQLCODE = +100                                      36870000
368800              CONTINUE                                            36880000
368900         WHEN SQLWARN0 NOT = SPACE                                36890000
369000         WHEN SQLCODE NOT = ZERO                                  36900000
369100              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         36910001
369200              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       36920001
369300              MOVE  DK-PO-LNE-NBR       TO  PV-DISPLAY-LINE       36930001
369400              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             36940001
369500              STRING  PV-DISPLAY-PO   '-'                         36950001
369600                      PV-DISPLAY-RCVR '-'                         36960001
369700                      PV-DISPLAY-LINE    DELIMITED BY SIZE        36970001
369800                          INTO DP013-MESSAGE-TEXT (2)             36980001
369900                                                                  36990001
370000              MOVE '7140-COUNT-PACK-SLIPS'                        37000000
370100                               TO DP013-PARAGRAPH                 37010000
370200              MOVE 'COUNT NUMBER OF PACK SLIP ITEMS'              37020000
370300                               TO DP013-MESSAGE-TEXT (1)          37030000
370400              MOVE SQLCA       TO DP013-SQLCA                     37040000
370500              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        37050000
370600              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (2)        37060000
370700              MOVE 'TPKITEM'   TO DP013-DB2-TABLE-NAME (3)        37070000
370800              SET DP013-DB2-ABEND                                 37080000
370900                               TO TRUE                            37090000
371000              PERFORM DP013-0000-PROCESS-ABEND                    37100000
371100     END-EVALUATE.                                                37110000
371200/                                                                 37120000
371300*----------------------------------------------------------------*37130000
371400*    THERE ARE NO PACK SLIP ITEMS, FINISH THE DELETE PROCESS     *37140000
371500*----------------------------------------------------------------*37150000
371600                                                                  37160000
371700 7200-FINISH-DELETE.                                              37170000
371800                                                                  37180000
371900     MOVE 0 TO RECITM-PKSL-ITM-QTY.                               37190000
372000     PERFORM 7210-DELETE-TRECITM.                                 37200000
372100     PERFORM 9950-CALL-PO-RCVR-TRKING-MOD.                        37210000
372200     PERFORM 7220-DELETE-TRECDIS.                                 37220000
372300     PERFORM 7300-CHECK-FOR-ROLLUP.                               37230000
372400                                                                  37240000
372500 7210-DELETE-TRECITM.                                             37250000
372600                                                                  37260000
372700* BEFORE IMAGE                                                    37270000
372800     MOVE 'I'                      TO RC031-TABLE-TO-AUDIT.       37280000
372900     MOVE 'B'                      TO RC031-AUD-TYP-CDE.          37290000
373000     MOVE 'D'                      TO RC031-AUD-FUNC-CDE.         37300000
373100     MOVE RECITM-ORD-NBR           TO RC031-PO-NBR.               37310000
373200     MOVE RECITM-ORD-LNE-NBR       TO RC031-PO-LNE-NBR.           37320000
373300     MOVE RECITM-REC-SEQ-NBR       TO RC031-REC-SEQ-NBR.          37330000
373400     MOVE RECITM-OPER-UNT-ID       TO RC031-OPER-UNT-ID.          37340000
373500     MOVE RECITM-FCLTY-ID          TO RC031-FCLTY-ID.             37350000
373600     MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID.           37360000
373700                                                                  37370000
373800     PERFORM 9000-LINK-AUDIT.                                     37380000
373900                                                                  37390000
374000     EVALUATE TRUE                                                37400000
374100         WHEN RC031-CALL-SUCCESSFUL                               37410000
374200             CONTINUE                                             37420000
374300                                                                  37430000
374400         WHEN OTHER                                               37440000
374500              MOVE '7210-DELETE-TRECITM'                          37450000
374600                                   TO DP013-PARAGRAPH             37460000
374700              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               37470000
374800                                   TO DP013-MESSAGE-TEXT (1)      37480000
374900              MOVE RC031-RETURN-DESC                              37490000
375000                                   TO DP013-MESSAGE-TEXT (2)      37500000
375100              MOVE RC031-SQLCA     TO DP013-SQLCA                 37510000
375200              SET DP013-DB2-ABEND                                 37520000
375300                  DP013-XCTL-DISPLAY-RESTART                      37530000
375400                                   TO TRUE                        37540000
375500              PERFORM DP013-0000-PROCESS-ABEND                    37550000
375600     END-EVALUATE.                                                37560000
375700                                                                  37570000
375800*  AFTER IMAGE                                                    37580000
375900     MOVE 'I'                      TO RC031-TABLE-TO-AUDIT.       37590000
376000     MOVE 'A'                      TO RC031-AUD-TYP-CDE.          37600000
376100     MOVE 'D'                      TO RC031-AUD-FUNC-CDE.         37610000
376200     MOVE RECITM-ORD-NBR           TO RC031-PO-NBR.               37620000
376300     MOVE RECITM-ORD-LNE-NBR       TO RC031-PO-LNE-NBR.           37630000
376400     MOVE RECITM-REC-SEQ-NBR       TO RC031-REC-SEQ-NBR.          37640000
376500     MOVE RECITM-OPER-UNT-ID       TO RC031-OPER-UNT-ID.          37650000
376600     MOVE RECITM-FCLTY-ID          TO RC031-FCLTY-ID.             37660000
376700     MOVE 'DE'                     TO RC031-STATUS-CDE            37670000
376800     MOVE DP020-USERID             TO RC031-UPD-UID               37680000
376900     MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID            37690000
377000     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST              37700000
377100                                                                  37710000
377200     PERFORM 9000-LINK-AUDIT.                                     37720000
377300                                                                  37730000
377400     EVALUATE TRUE                                                37740000
377500         WHEN RC031-CALL-SUCCESSFUL                               37750000
377600             CONTINUE                                             37760000
377700         WHEN OTHER                                               37770000
377800              MOVE '7210-DELETE-TRECITM'                          37780000
377900                                   TO DP013-PARAGRAPH             37790000
378000              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               37800000
378100                                   TO DP013-MESSAGE-TEXT (1)      37810000
378200              MOVE RC031-RETURN-DESC                              37820000
378300                                   TO DP013-MESSAGE-TEXT (2)      37830000
378400              MOVE RC031-SQLCA     TO DP013-SQLCA                 37840000
378500              SET DP013-DB2-ABEND                                 37850000
378600                  DP013-XCTL-DISPLAY-RESTART                      37860000
378700                                   TO TRUE                        37870000
378800              PERFORM DP013-0000-PROCESS-ABEND                    37880000
378900     END-EVALUATE.                                                37890000
379000                                                                  37900000
379100* ACTUAL DELETION                                                 37910000
379200     EXEC SQL                                                     37920000
379300         DELETE                                                   37930000
379400         FROM                                                     37940000
379500             TRECITM                                              37950000
379600          WHERE                                                   37960000
379700                ORD_NBR            =  :DK-PO-NBR                  37970000
379800            AND ORD_LNE_NBR        =  :DK-PO-LNE-NBR              37980000
379900            AND REC_SEQ_NBR        =  :DK-REC-SEQ-NBR             37990000
380000     END-EXEC.                                                    38000000
380100                                                                  38010000
380200     EVALUATE TRUE                                                38020000
380300         WHEN SQLCODE = ZERO                                      38030000
380400         WHEN SQLCODE = +100                                      38040000
380500              CONTINUE                                            38050000
380600         WHEN SQLWARN0 NOT = SPACE                                38060000
380700         WHEN SQLCODE NOT = ZERO                                  38070000
380800              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         38080001
380900              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       38090001
381000              MOVE  DK-PO-LNE-NBR       TO  PV-DISPLAY-LINE       38100001
381100              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             38110001
381200              STRING  PV-DISPLAY-PO   '-'                         38120001
381300                      PV-DISPLAY-RCVR '-'                         38130001
381400                      PV-DISPLAY-LINE    DELIMITED BY SIZE        38140001
381500                          INTO DP013-MESSAGE-TEXT (2)             38150001
381600                                                                  38160001
381700              MOVE '7210-DELETE-TRECITM'                          38170000
381800                               TO DP013-PARAGRAPH                 38180000
381900              MOVE 'DELETE TRECITM'                               38190000
382000                               TO DP013-MESSAGE-TEXT (1)          38200000
382100              MOVE SQLCA       TO DP013-SQLCA                     38210000
382200              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        38220000
382300              SET DP013-DB2-ABEND                                 38230000
382400                               TO TRUE                            38240000
382500              PERFORM DP013-0000-PROCESS-ABEND                    38250000
382600     END-EVALUATE.                                                38260000
382700/                                                                 38270000
382800 7220-DELETE-TRECDIS.                                             38280000
382900                                                                  38290000
383000     PERFORM 7221-OPEN-RECDIS-CSR.                                38300000
383100     IF PS-RECDIS-CSR-OPEN                                        38310000
383200         PERFORM 7222-FETCH-RECDIS-CSR                            38320000
383300         PERFORM UNTIL PS-EOF-RECDIS OR PS-ERROR                  38330000
383400             PERFORM 7223-AUDIT-RECDIS                            38340000
383500             PERFORM 7224-DELETE-RECDIS                           38350000
383600             PERFORM 7240-DELETE-ODD-UNIT                         38360000
383700             PERFORM 7222-FETCH-RECDIS-CSR                        38370000
383800         END-PERFORM                                              38380000
383900         PERFORM 7225-CLOSE-RECDIS-CSR                            38390000
384000     END-IF.                                                      38400000
384100/                                                                 38410000
384200 7221-OPEN-RECDIS-CSR.                                            38420000
384300     EXEC SQL                                                     38430000
384400         OPEN RECDIS-CSR                                          38440000
384500     END-EXEC.                                                    38450000
384600                                                                  38460000
384700     EVALUATE TRUE                                                38470000
384800         WHEN SQLCODE = ZERO                                      38480000
384900             SET PS-RECDIS-CSR-OPEN TO TRUE                       38490000
385000         WHEN SQLWARN0 NOT = SPACE                                38500000
385100         WHEN SQLCODE NOT = ZERO                                  38510000
385200              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         38520001
385300              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       38530001
385400              MOVE  DK-PO-LNE-NBR       TO  PV-DISPLAY-LINE       38540001
385500              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             38550001
385600              STRING  PV-DISPLAY-PO   '-'                         38560001
385700                      PV-DISPLAY-RCVR '-'                         38570001
385800                      PV-DISPLAY-LINE    DELIMITED BY SIZE        38580001
385900                          INTO DP013-MESSAGE-TEXT (2)             38590001
386000                                                                  38600001
386100             SET PS-RECDIS-CSR-CLOSED TO TRUE                     38610000
386200              MOVE '7221-OPEN-RECDIS-CSR'                         38620000
386300                               TO DP013-PARAGRAPH                 38630000
386400              MOVE 'OPEN RECDIS CURSOR'                           38640000
386500                               TO DP013-MESSAGE-TEXT (1)          38650000
386600              MOVE SQLCA       TO DP013-SQLCA                     38660000
386700              MOVE 'TRECDIS'   TO DP013-DB2-TABLE-NAME (1)        38670000
386800              SET DP013-DB2-ABEND                                 38680000
386900                               TO TRUE                            38690000
387000              PERFORM DP013-0000-PROCESS-ABEND                    38700000
387100     END-EVALUATE.                                                38710000
387200                                                                  38720000
387300 7222-FETCH-RECDIS-CSR.                                           38730000
387400     EXEC SQL                                                     38740000
387500         FETCH RECDIS-CSR                                         38750000
387600         INTO                                                     38760000
387700         :RECDIS-STR-NBR                                          38770000
387800       , :RECDIS-STR-FCLTY-ID                                     38780000
387900     END-EXEC.                                                    38790000
388000                                                                  38800000
388100     EVALUATE TRUE                                                38810000
388200         WHEN SQLCODE = ZERO                                      38820000
388300              CONTINUE                                            38830000
388400         WHEN SQLCODE = +100                                      38840000
388500             SET PS-EOF-RECDIS TO TRUE                            38850000
388600         WHEN SQLWARN0 NOT = SPACE                                38860000
388700         WHEN SQLCODE NOT = ZERO                                  38870000
388800              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         38880001
388900              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       38890001
389000              MOVE  DK-PO-LNE-NBR       TO  PV-DISPLAY-LINE       38900001
389100              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             38910001
389200              STRING  PV-DISPLAY-PO   '-'                         38920001
389300                      PV-DISPLAY-RCVR '-'                         38930001
389400                      PV-DISPLAY-LINE    DELIMITED BY SIZE        38940001
389500                          INTO DP013-MESSAGE-TEXT (2)             38950001
389600                                                                  38960001
389700              MOVE '7222-FETCH-RECDIS-CSR'                        38970000
389800                               TO DP013-PARAGRAPH                 38980000
389900              MOVE 'FETCH RECDIS CURSOR'                          38990000
390000                               TO DP013-MESSAGE-TEXT (1)          39000000
390100              MOVE SQLCA       TO DP013-SQLCA                     39010000
390200              MOVE 'TRECDIS'   TO DP013-DB2-TABLE-NAME (1)        39020000
390300              SET DP013-DB2-ABEND                                 39030000
390400                               TO TRUE                            39040000
390500              PERFORM DP013-0000-PROCESS-ABEND                    39050000
390600     END-EVALUATE.                                                39060000
390700                                                                  39070000
390800 7223-AUDIT-RECDIS.                                               39080000
390900                                                                  39090000
391000* BEFORE IMAGE                                                    39100000
391100                                                                  39110000
391200     MOVE 'D'                      TO RC031-TABLE-TO-AUDIT.       39120000
391300     MOVE 'B'                      TO RC031-AUD-TYP-CDE.          39130000
391400     MOVE 'D'                      TO RC031-AUD-FUNC-CDE.         39140000
391500     MOVE DK-PO-NBR                TO RC031-PO-NBR.               39150000
391600     MOVE DK-PO-LNE-NBR            TO RC031-PO-LNE-NBR.           39160000
391700     MOVE DK-REC-SEQ-NBR           TO RC031-REC-SEQ-NBR.          39170000
391800     MOVE ASC-KEY-OPER-UNT-ID      TO RC031-OPER-UNT-ID.          39180000
391900     MOVE ASC-KEY-FCLTY-ID         TO RC031-FCLTY-ID.             39190000
392000     MOVE RECDIS-STR-NBR           TO RC031-STR-NBR.              39200000
392100     MOVE DP020-USERID             TO RC031-UPD-UID.              39210000
392200     MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID.           39220000
392300     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST.             39230000
392400                                                                  39240000
392500     PERFORM 9000-LINK-AUDIT.                                     39250000
392600                                                                  39260000
392700     EVALUATE TRUE                                                39270000
392800         WHEN RC031-CALL-SUCCESSFUL                               39280000
392900             CONTINUE                                             39290000
393000                                                                  39300000
393100         WHEN OTHER                                               39310000
393200              MOVE '7223-AUDIT-RECDIS'                            39320000
393300                                   TO DP013-PARAGRAPH             39330000
393400              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               39340000
393500                                   TO DP013-MESSAGE-TEXT (1)      39350000
393600              MOVE RC031-RETURN-DESC                              39360000
393700                                   TO DP013-MESSAGE-TEXT (2)      39370000
393800              MOVE RC031-SQLCA     TO DP013-SQLCA                 39380000
393900              SET DP013-DB2-ABEND                                 39390000
394000                  DP013-XCTL-DISPLAY-RESTART                      39400000
394100                                   TO TRUE                        39410000
394200              PERFORM DP013-0000-PROCESS-ABEND                    39420000
394300     END-EVALUATE.                                                39430000
394400                                                                  39440000
394500 7224-DELETE-RECDIS.                                              39450000
394600     EXEC SQL                                                     39460000
394700         DELETE                                                   39470000
394800     FROM TRECDIS                                                 39480000
394900     WHERE                                                        39490000
395000         ORD_NBR                =  :DK-PO-NBR                     39500000
395100         AND ORD_LNE_NBR        =  :DK-PO-LNE-NBR                 39510000
395200         AND REC_SEQ_NBR        =  :DK-REC-SEQ-NBR                39520000
395300         AND STR_NBR            =  :RECDIS-STR-NBR                39530000
395400         AND STR_FCLTY_ID       =  :RECDIS-STR-FCLTY-ID           39540000
395500     END-EXEC.                                                    39550000
395600                                                                  39560000
395700     EVALUATE TRUE                                                39570000
395800         WHEN SQLCODE = ZERO                                      39580000
395900         WHEN SQLCODE = +100                                      39590000
396000              CONTINUE                                            39600000
396100         WHEN SQLWARN0 NOT = SPACE                                39610000
396200         WHEN SQLCODE NOT = ZERO                                  39620000
396300              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         39630001
396400              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       39640001
396500              MOVE  DK-PO-LNE-NBR       TO  PV-DISPLAY-LINE       39650001
396600              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             39660001
396700              STRING  PV-DISPLAY-PO   '-'                         39670001
396800                      PV-DISPLAY-RCVR '-'                         39680001
396900                      PV-DISPLAY-LINE    DELIMITED BY SIZE        39690001
397000                          INTO DP013-MESSAGE-TEXT (2)             39700001
397100                                                                  39710001
397200              MOVE '7223-DELETE-RECDIS'                           39720000
397300                               TO DP013-PARAGRAPH                 39730000
397400              MOVE 'DELETE RECDIS ROW'                            39740000
397500                               TO DP013-MESSAGE-TEXT (1)          39750000
397600              MOVE SQLCA       TO DP013-SQLCA                     39760000
397700              MOVE 'TRECDIS'   TO DP013-DB2-TABLE-NAME (1)        39770000
397800              SET DP013-DB2-ABEND                                 39780000
397900                               TO TRUE                            39790000
398000              PERFORM DP013-0000-PROCESS-ABEND                    39800000
398100     END-EVALUATE.                                                39810000
398200                                                                  39820000
398300 7225-CLOSE-RECDIS-CSR.                                           39830000
398400     EXEC SQL                                                     39840000
398500         CLOSE RECDIS-CSR                                         39850000
398600     END-EXEC.                                                    39860000
398700                                                                  39870000
398800     EVALUATE TRUE                                                39880000
398900         WHEN SQLCODE = ZERO                                      39890000
399000         WHEN SQLCODE = +100                                      39900000
399100              CONTINUE                                            39910000
399200         WHEN SQLWARN0 NOT = SPACE                                39920000
399300         WHEN SQLCODE NOT = ZERO                                  39930000
399400              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         39940001
399500              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       39950001
399600              MOVE  DK-PO-LNE-NBR       TO  PV-DISPLAY-LINE       39960001
399700              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             39970001
399800              STRING  PV-DISPLAY-PO   '-'                         39980001
399900                      PV-DISPLAY-RCVR '-'                         39990001
400000                      PV-DISPLAY-LINE    DELIMITED BY SIZE        40000001
400100                          INTO DP013-MESSAGE-TEXT (2)             40010001
400200                                                                  40020001
400300              MOVE '7224-CLOSE-RECDIS-CSR'                        40030000
400400                               TO DP013-PARAGRAPH                 40040000
400500              MOVE 'CLOSE RECDIS CURSOR'                          40050000
400600                               TO DP013-MESSAGE-TEXT (1)          40060000
400700              MOVE SQLCA       TO DP013-SQLCA                     40070000
400800              MOVE 'TRECDIS'   TO DP013-DB2-TABLE-NAME (1)        40080000
400900              SET DP013-DB2-ABEND                                 40090000
401000                               TO TRUE                            40100000
401100              PERFORM DP013-0000-PROCESS-ABEND                    40110000
401200     END-EVALUATE.                                                40120000
401300                                                                  40130000
401400 7240-DELETE-ODD-UNIT.                                            40140000
401500                                                                  40150000
401600     EXEC SQL                                                     40160000
401700          DELETE                                                  40170000
401800            FROM RCT_VRFD_ODD_UNT                                 40180000
401900            WHERE PO_NBR         = :DK-PO-NBR                     40190000
402000              AND PO_LNE_NBR     = :DK-PO-LNE-NBR                 40200000
402100              AND RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                40210000
402200              AND STR_NBR        = :RECDIS-STR-NBR                40220000
402300     END-EXEC.                                                    40230000
402400                                                                  40240000
402500     EVALUATE TRUE                                                40250000
402600         WHEN SQLCODE = ZERO                                      40260000
402700         WHEN SQLCODE = +100                                      40270000
402800              CONTINUE                                            40280000
402900         WHEN SQLCODE = -904                                      40290000
403000         WHEN SQLCODE = -911                                      40300000
403100         WHEN SQLCODE = -913                                      40310000
403200              PERFORM 9900-SOFT-ABORT                             40320000
403300                                                                  40330000
403400         WHEN SQLWARN0 NOT = SPACES                               40340000
403500         WHEN SQLCODE  NOT = ZERO                                 40350000
403600              MOVE '7240-DELETE-ODD-UNIT'                         40360000
403700                             TO DP013-PARAGRAPH                   40370000
403800              MOVE 'UNSUCCESSFUL DELETE OF RCT_VRFD_ODD_UNT'      40380000
403900                             TO DP013-MESSAGE-TEXT (1)            40390000
404000              MOVE DK-PO-NBR      TO PV-PO-NBR-PIC9               40400000
404100              MOVE DK-REC-SEQ-NBR TO PV-REC-SEQ-NBR-PIC9          40410000
404200              MOVE DK-PO-LNE-NBR  TO PV-PO-LNE-NBR-PIC9           40420000
404300              STRING 'PO '                                        40430000
404400                     PV-PO-NBR-PIC9                               40440000
404500                     ' SEQ '                                      40450000
404600                     PV-REC-SEQ-NBR-PIC9                          40460000
404700                     ' LINE '                                     40470000
404800                     PV-PO-LNE-NBR-PIC9                           40480000
404900                     DELIMITED BY SIZE                            40490000
405000                     INTO DP013-MESSAGE-TEXT (2)                  40500000
405100              MOVE SQLCA     TO DP013-SQLCA                       40510000
405200              MOVE 'RCT00009' TO DP013-DB2-TABLE-NAME (1)         40520000
405300              SET DP013-DB2-ABEND                                 40530000
405400                  DP013-XCTL-DISPLAY-RESTART                      40540000
405500                             TO TRUE                              40550000
405600              PERFORM DP013-0000-PROCESS-ABEND                    40560000
405700     END-EVALUATE.                                                40570000
405800                                                                  40580000
405900/                                                                 40590000
406000 7300-CHECK-FOR-ROLLUP.                                           40600000
406100*----------------------------------------------------------------*40610000
406200*    SEE IF ALL RECITM ROWS ARE VE.  UPDATE TRECEIV              *40620000
406300*    IF SO.  DC-200: FIRST SEE IF ANY RECITMS EXIST.             *40630000
406400*----------------------------------------------------------------*40640000
406500                                                                  40650000
406600*DC-200 FROM HERE                                                 40660000
406700     PERFORM 7312-COUNT-ALL-RECITM.                               40670000
406800     IF  PV-DB2-COUNT EQUAL ZERO                                  40680000
406900         MOVE PC-IP       TO  PV-STATUS                           40690000
407000         PERFORM 7320-UPDATE-TRECEIV                              40700000
407100     ELSE                                                         40710000
407200         PERFORM 7301-REAL-ROLL-UP                                40720000
407300     END-IF.                                                      40730000
407400                                                                  40740000
407500 7301-REAL-ROLL-UP.                                               40750000
407600                                                                  40760000
407700     MOVE PC-VE           TO  PV-STATUS.                          40770000
407800     PERFORM 7310-COUNT-STATUS.                                   40780000
407900     IF  PV-DB2-COUNT EQUAL ZERO                                  40790000
408000         PERFORM 7320-UPDATE-TRECEIV                              40800000
408100     END-IF.                                                      40810000
408200                                                                  40820000
408300 7310-COUNT-STATUS.                                               40830000
408400*                                                                 40840000
408500*    WE TAKE ACTION IF COUNT IS EQUAL TO ZERO.  TO HANDLE THE     40850000
408600*    NULL INDICATOR WITHOUT AN IF TEST, WE SET THE COUNTER TO     40860000
408700*    THE VALUE OF ONE (NO ACTION TAKE IN ROUTINE THAT PERFORMS    40870000
408800*    THIS ONE).                                                   40880000
408900*                                                                 40890000
409000     MOVE 1               TO  PV-DB2-COUNT.                       40900000
409100                                                                  40910000
409200     EXEC SQL                                                     40920000
409300          SELECT                                                  40930000
409400                COUNT(*)                                          40940000
409500          INTO                                                    40950000
409600                :PV-DB2-COUNT :PV-NULL-IND                        40960000
409700          FROM                                                    40970000
409800                TRECITM                                           40980000
409900          WHERE                                                   40990000
410000                ORD_NBR            =  :DK-PO-NBR                  41000000
410100          AND   REC_SEQ_NBR        =  :DK-REC-SEQ-NBR             41010000
410200          AND   VER_STATUS_CDE     =  :PC-A                       41020000
410300          AND   STATUS_CDE        ^=  :PV-STATUS                  41030000
410400     END-EXEC.                                                    41040000
410500                                                                  41050000
410600     EVALUATE TRUE                                                41060000
410700         WHEN SQLCODE = ZERO                                      41070000
410800         WHEN SQLCODE = +100                                      41080000
410900              CONTINUE                                            41090000
411000         WHEN SQLWARN0 NOT = SPACE                                41100000
411100         WHEN SQLCODE NOT = ZERO                                  41110000
411200              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         41120001
411300              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       41130001
411400              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             41140001
411500              STRING  PV-DISPLAY-PO   '-'                         41150001
411600                      PV-DISPLAY-RCVR '-'                         41160001
411700                      PV-DISPLAY-LINE    DELIMITED BY SIZE        41170001
411800                          INTO DP013-MESSAGE-TEXT (2)             41180001
411900                                                                  41190001
412000              MOVE '7310-COUNT-STATUS'                            41200000
412100                               TO DP013-PARAGRAPH                 41210000
412200              MOVE 'COUNT NUMBER OF RECITMS'                      41220000
412300                               TO DP013-MESSAGE-TEXT (1)          41230000
412400              MOVE SQLCA       TO DP013-SQLCA                     41240000
412500              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        41250000
412600              SET DP013-DB2-ABEND                                 41260000
412700                               TO TRUE                            41270000
412800              PERFORM DP013-0000-PROCESS-ABEND                    41280000
412900     END-EVALUATE.                                                41290000
413000/                                                                 41300000
413100*DC-200 FROM HERE                                                 41310000
413200*----------------------------------------------------------------*41320000
413300*    HERE WE CHECK FOR THE EXISTANCE OF ANY ACTIVE TRECITM ROW.  *41330000
413400*    IF NONE ARE FOUND, THE TRECEIV ROW MUST BE SET TO A STATUS  *41340000
413500*    STATUS CODE OF 'IP'.                                        *41350000
413600*----------------------------------------------------------------*41360000
413700                                                                  41370000
413800 7312-COUNT-ALL-RECITM.                                           41380000
413900                                                                  41390000
414000     MOVE ZERO            TO  PV-DB2-COUNT.                       41400000
414100                                                                  41410000
414200     EXEC SQL                                                     41420000
414300          SELECT                                                  41430000
414400                COUNT(*)                                          41440000
414500          INTO                                                    41450000
414600                :PV-DB2-COUNT :PV-NULL-IND                        41460000
414700          FROM                                                    41470000
414800                TRECITM                                           41480000
414900          WHERE                                                   41490000
415000                ORD_NBR            =  :DK-PO-NBR                  41500000
415100          AND   REC_SEQ_NBR        =  :DK-REC-SEQ-NBR             41510000
415200          AND   VER_STATUS_CDE     =  :PC-A                       41520000
415300     END-EXEC.                                                    41530000
415400                                                                  41540000
415500     EVALUATE TRUE                                                41550000
415600         WHEN SQLCODE = ZERO                                      41560000
415700         WHEN SQLCODE = +100                                      41570000
415800              CONTINUE                                            41580000
415900         WHEN SQLWARN0 NOT = SPACE                                41590000
416000         WHEN SQLCODE NOT = ZERO                                  41600000
416100              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         41610001
416200              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       41620001
416300              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             41630001
416400              STRING  PV-DISPLAY-PO   '-'                         41640001
416500                      PV-DISPLAY-RCVR '-'                         41650001
416600                      PV-DISPLAY-LINE    DELIMITED BY SIZE        41660001
416700                          INTO DP013-MESSAGE-TEXT (2)             41670001
416800                                                                  41680001
416900              MOVE '7312-COUNT-ALL-RECITM'                        41690000
417000                               TO DP013-PARAGRAPH                 41700000
417100              MOVE 'COUNT TOTAL NUMBER OF ACTIVE RECITMS'         41710000
417200                               TO DP013-MESSAGE-TEXT (1)          41720000
417300              MOVE SQLCA       TO DP013-SQLCA                     41730000
417400              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        41740000
417500              SET DP013-DB2-ABEND                                 41750000
417600                               TO TRUE                            41760000
417700              PERFORM DP013-0000-PROCESS-ABEND                    41770000
417800     END-EVALUATE.                                                41780000
417900*DC-200 TO HERE                                                   41790000
418000/                                                                 41800000
418100*----------------------------------------------------------------*41810000
418200*    SINCE PACK SLIPS EXIST WE CAN'T UPDATE THE TRECITM ROWS.    *41820000
418300*    HOWEVER, WE CAN STILL CHECK TO SEE IF ALL RECITMS ARE       *41830000
418400*    EQUAL TO 'CM' OR 'VE'.  IF SO, AND THE RECEIVER IS SET TO   *41840000
418500*    'IP', SET THE RECEIVER TO 'CM'.                             *41850000
418600*----------------------------------------------------------------*41860000
418700                                                                  41870000
418800 7315-CHECK-RECEIV-STATUS.                                        41880000
418900                                                                  41890000
419000     PERFORM 7321-SELECT-TRECEIV.                                 41900000
419100     IF (SQLCODE EQUAL ZERO                                       41910000
419200     AND RECEIV-STATUS-CDE EQUAL PC-IP)                           41920000
419300                                                                  41930000
419400         IF  RECITM-STATUS-CDE EQUAL PC-IP                        41940000
419500             PERFORM 7319-COUNT-TRECDIS                           41950000
419600             IF  PV-DB2-COUNT GREATER THAN ZERO                   41960000
419700                 IF  SQLCODE EQUAL ZERO                           41970000
419800                     MOVE PC-CM    TO  RECITM-STATUS-CDE          41980000
419900                     PERFORM 9005-UPDATE-STATUS-CDE               41990000
420000                 END-IF                                           42000000
420100             ELSE                                                 42010000
420200                 MOVE PC-TSYMSG-00891                             42020000
420300                                   TO  DP020-MSG-NUMBER           42030000
420400             END-IF                                               42040000
420500         END-IF                                                   42050000
420600                                                                  42060000
420700         PERFORM 7318-COUNT-VE-CM                                 42070000
420800         IF  PV-DB2-COUNT EQUAL ZERO                              42080000
420900             PERFORM 7322-UPDATE-TRECEIV                          42090000
421000             MOVE PC-TSYMSG-00892                                 42100000
421100                               TO  DP020-MSG-NUMBER               42110000
421200         END-IF                                                   42120000
421300     END-IF.                                                      42130000
421400                                                                  42140000
421500/                                                                 42150000
421600 7318-COUNT-VE-CM.                                                42160000
421700*                                                                 42170000
421800*    WE TAKE ACTION IF COUNT IS EQUAL TO ZERO.  TO HANDLE THE     42180000
421900*    NULL INDICATOR WITHOUT AN IF TEST, WE SET THE COUNTER TO     42190000
422000*    THE VALUE OF ONE (NO ACTION TAKE IN ROUTINE THAT PERFORMS    42200000
422100*    THIS ONE).                                                   42210000
422200*                                                                 42220000
422300     MOVE 1               TO  PV-DB2-COUNT.                       42230000
422400                                                                  42240000
422500     EXEC SQL                                                     42250000
422600          SELECT                                                  42260000
422700                COUNT(*)                                          42270000
422800          INTO                                                    42280000
422900                :PV-DB2-COUNT :PV-NULL-IND                        42290000
423000          FROM                                                    42300000
423100                TRECITM                                           42310000
423200          WHERE                                                   42320000
423300                ORD_NBR            =  :DK-PO-NBR                  42330000
423400          AND   REC_SEQ_NBR        =  :DK-REC-SEQ-NBR             42340000
423500          AND   VER_STATUS_CDE     =  :PC-A                       42350000
423600          AND  (STATUS_CDE        ^=  :PC-CM                      42360000
423700          AND   STATUS_CDE        ^=  :PC-VE)                     42370000
423800     END-EXEC.                                                    42380000
423900                                                                  42390000
424000     EVALUATE TRUE                                                42400000
424100         WHEN SQLCODE = ZERO                                      42410000
424200         WHEN SQLCODE = +100                                      42420000
424300              CONTINUE                                            42430000
424400         WHEN SQLWARN0 NOT = SPACE                                42440000
424500         WHEN SQLCODE NOT = ZERO                                  42450000
424600              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         42460001
424700              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       42470001
424800              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             42480001
424900              STRING  PV-DISPLAY-PO   '-'                         42490001
425000                      PV-DISPLAY-RCVR '-'                         42500001
425100                      PV-DISPLAY-LINE    DELIMITED BY SIZE        42510001
425200                          INTO DP013-MESSAGE-TEXT (2)             42520001
425300                                                                  42530001
425400              MOVE '7318-COUNT-VE-CM'                             42540000
425500                               TO DP013-PARAGRAPH                 42550000
425600              MOVE 'COUNT NUMBER OF RECITMS'                      42560000
425700                               TO DP013-MESSAGE-TEXT (1)          42570000
425800              MOVE SQLCA       TO DP013-SQLCA                     42580000
425900              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        42590000
426000              SET DP013-DB2-ABEND                                 42600000
426100                               TO TRUE                            42610000
426200              PERFORM DP013-0000-PROCESS-ABEND                    42620000
426300     END-EVALUATE.                                                42630000
426400/                                                                 42640000
426500 7319-COUNT-TRECDIS.                                              42650000
426600                                                                  42660000
426700     MOVE ZERO            TO  PV-DB2-COUNT.                       42670000
426800                                                                  42680000
426900     EXEC SQL                                                     42690000
427000          SELECT                                                  42700000
427100                COUNT(*)                                          42710000
427200          INTO                                                    42720000
427300                :PV-DB2-COUNT :PV-NULL-IND                        42730000
427400          FROM                                                    42740000
427500                TRECDIS                                           42750000
427600          WHERE                                                   42760000
427700                ORD_NBR            =  :DK-PO-NBR                  42770000
427800          AND   ORD_LNE_NBR        =  :DK-PO-LNE-NBR              42780000
427900          AND   REC_SEQ_NBR        =  :DK-REC-SEQ-NBR             42790000
428100     END-EXEC.                                                    42810000
428200                                                                  42820000
428300     EVALUATE TRUE                                                42830000
428400         WHEN SQLCODE = ZERO                                      42840000
428500         WHEN SQLCODE = +100                                      42850000
428600              CONTINUE                                            42860000
428710         WHEN SQLWARN0 NOT = SPACE                                42871000
428800         WHEN SQLCODE NOT = ZERO                                  42880000
428900              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         42890001
429000              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       42900001
429100              MOVE  DK-PO-LNE-NBR       TO  PV-DISPLAY-LINE       42910001
429200              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             42920001
429300              STRING  PV-DISPLAY-PO   '-'                         42930001
429400                      PV-DISPLAY-RCVR '-'                         42940001
429500                      PV-DISPLAY-LINE    DELIMITED BY SIZE        42950001
429600                          INTO DP013-MESSAGE-TEXT (2)             42960001
429700                                                                  42970001
429800              MOVE '7319-COUNT-TRECDIS'                           42980000
429900                               TO DP013-PARAGRAPH                 42990000
430000              MOVE 'COUNT NUMBER OF RECDIS ROWS'                  43000000
430100                               TO DP013-MESSAGE-TEXT (1)          43010000
430200              MOVE SQLCA       TO DP013-SQLCA                     43020000
430300              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        43030000
430400              SET DP013-DB2-ABEND                                 43040000
430500                               TO TRUE                            43050000
430600              PERFORM DP013-0000-PROCESS-ABEND                    43060000
430700     END-EVALUATE.                                                43070000
430800/                                                                 43080000
430900*----------------------------------------------------------------*43090000
431000*    ONCE AGAIN, READ, UPDATE, INSERT.                           *43100000
431100*----------------------------------------------------------------*43110000
431200                                                                  43120000
431300 7320-UPDATE-TRECEIV.                                             43130000
431400                                                                  43140000
431500     PERFORM 7321-SELECT-TRECEIV.                                 43150000
431600                                                                  43160000
431700     IF  RECEIV-STATUS-CDE NOT EQUAL PV-STATUS                    43170000
431800         IF  SQLCODE EQUAL ZERO                                   43180000
431900             PERFORM 7322-UPDATE-TRECEIV                          43190000
432000         END-IF                                                   43200000
432100                                                                  43210000
432200     END-IF.                                                      43220000
432300/                                                                 43230000
432400*----------------------------------------------------------------*43240000
432500*    GET THE CURRENT ROW FOR PROCESSING.                         *43250000
432600*----------------------------------------------------------------*43260000
432700                                                                  43270000
432800 7321-SELECT-TRECEIV.                                             43280000
432900                                                                  43290000
433000     EXEC SQL                                                     43300000
433100          SELECT                                                  43310000
433200                ORD_NBR                                           43320000
433300              , REC_SEQ_NBR                                       43330000
433400              , CRE_TMST                                          43340000
433500              , CRE_UID                                           43350000
433600              , PO_VER_NBR                                        43360000
433700              , OPER_UNT_ID                                       43370000
433800              , FCLTY_ID                                          43380000
433900              , STATUS_CDE                                        43390000
434000              , SYST_CRE_CDE                                      43400000
434100              , REC_TYP_CDE                                       43410000
434200              , VER_STATUS_CDE                                    43420000
434300              , PACK_BY_ST_IND                                    43430000
434400              , REC_TMST                                          43440000
434500              , EXPTED_CART_CNT                                   43450000
434600              , ACTL_CART_CNT                                     43460000
434700              , EXPTED_ITM_QTY                                    43470000
434800              , ACTL_ITM_QTY                                      43480000
434900              , RCVR_NBR                                          43490000
435000              , ML_POST_TMST                                      43500000
435100              , FS_POST_TMST                                      43510000
435200              , PRE_TKT_IND                                       43520000
435300              , AD_INFO_DESC                                      43530000
435400              , IN_TRBL_TMST                                      43540000
435500              , IN_TRBL_MIN_CNT                                   43550000
435600              , IN_TRBL_HOUR_CNT                                  43560000
435700              , VERFYD_TMST                                       43570000
435800              , RCVG_CLERK_INIT_ID                                43580000
435900              , REFER_BACK_SEQ_NBR                                43590000
436000              , AP_PRC_CDE                                        43600000
436100              , AP_PRC_DTE                                        43610000
436200              , MIS_DIRECT_IND                                    43620000
436300              , IMPRT_IND                                         43630000
436400              , CRE_OPER_UNT_ID                                   43640000
436500              , CRE_FCLTY_ID                                      43650000
436600              , CURR_OPER_UNT_ID                                  43660000
436700              , CURR_FCLTY_ID                                     43670000
436800              , UPD_TMST                                          43680000
436900              , UPD_UID                                           43690000
437000              , UPD_PGM_ID                                        43700000
437100              , APRON_LOC_DESC                                    43710000
437200              , MKNG_APRN_PRT_TMST                                43720000
437300              , GOH_IND                                           43730000
437400              , PKGNG_CDE                                         43740000
437500          INTO                                                    43750000
437600               :RECEIV-ORD-NBR                                    43760000
437700              ,:RECEIV-REC-SEQ-NBR                                43770000
437800              ,:RECEIV-CRE-TMST                                   43780000
437900              ,:RECEIV-CRE-UID                                    43790000
438000              ,:RECEIV-PO-VER-NBR                                 43800000
438100              ,:RECEIV-OPER-UNT-ID                                43810000
438200              ,:RECEIV-FCLTY-ID                                   43820000
438300              ,:RECEIV-STATUS-CDE                                 43830000
438400              ,:RECEIV-SYST-CRE-CDE                               43840000
438500              ,:RECEIV-REC-TYP-CDE                                43850000
438600              ,:RECEIV-VER-STATUS-CDE                             43860000
438700              ,:RECEIV-PACK-BY-ST-IND                             43870000
438800              ,:RECEIV-REC-TMST                                   43880000
438900              ,:RECEIV-EXPTED-CART-CNT                            43890000
439000              ,:RECEIV-ACTL-CART-CNT                              43900000
439100              ,:RECEIV-EXPTED-ITM-QTY                             43910000
439200              ,:RECEIV-ACTL-ITM-QTY                               43920000
439300              ,:RECEIV-RCVR-NBR                                   43930000
439400              ,:RECEIV-ML-POST-TMST                               43940000
439500              ,:RECEIV-FS-POST-TMST                               43950000
439600              ,:RECEIV-PRE-TKT-IND                                43960000
439700              ,:RECEIV-AD-INFO-DESC                               43970000
439800              ,:RECEIV-IN-TRBL-TMST                               43980000
439900              ,:RECEIV-IN-TRBL-MIN-CNT                            43990000
440000              ,:RECEIV-IN-TRBL-HOUR-CNT                           44000000
440100              ,:RECEIV-VERFYD-TMST                                44010000
440200              ,:RECEIV-RCVG-CLERK-INIT-ID                         44020000
440300              ,:RECEIV-REFER-BACK-SEQ-NBR                         44030000
440400              ,:RECEIV-AP-PRC-CDE                                 44040000
440500              ,:RECEIV-AP-PRC-DTE                                 44050000
440600              ,:RECEIV-MIS-DIRECT-IND                             44060000
440700              ,:RECEIV-IMPRT-IND                                  44070000
440800              ,:RECEIV-CRE-OPER-UNT-ID                            44080000
440900              ,:RECEIV-CRE-FCLTY-ID                               44090000
441000              ,:RECEIV-CURR-OPER-UNT-ID                           44100000
441100              ,:RECEIV-CURR-FCLTY-ID                              44110000
441200              ,:RECEIV-UPD-TMST                                   44120000
441300              ,:RECEIV-UPD-UID                                    44130000
441400              ,:RECEIV-UPD-PGM-ID                                 44140000
441500              ,:RECEIV-APRON-LOC-DESC                             44150000
441600              ,:RECEIV-MKNG-APRN-PRT-TMST                         44160000
441700              ,:RECEIV-GOH-IND                                    44170000
441800              ,:RECEIV-PKGNG-CDE                                  44180000
441900          FROM                                                    44190000
442000                TRECEIV                                           44200000
442100          WHERE                                                   44210000
442200                ORD_NBR            =  :DK-PO-NBR                  44220000
442300          AND   REC_SEQ_NBR        =  :DK-REC-SEQ-NBR             44230000
442400          AND   VER_STATUS_CDE     =  :PC-A                       44240000
442500     END-EXEC.                                                    44250000
442600                                                                  44260000
442700     EVALUATE TRUE                                                44270000
442800         WHEN SQLCODE = ZERO                                      44280000
442900         WHEN SQLCODE = +100                                      44290000
443000              CONTINUE                                            44300000
443100         WHEN SQLWARN0 NOT = SPACE                                44310000
443200         WHEN SQLCODE NOT = ZERO                                  44320000
443300              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         44330001
443400              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       44340001
443500              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             44350001
443600              STRING  PV-DISPLAY-PO   '-'                         44360001
443700                      PV-DISPLAY-RCVR '-'                         44370001
443800                      PV-DISPLAY-LINE    DELIMITED BY SIZE        44380001
443900                          INTO DP013-MESSAGE-TEXT (2)             44390001
444000                                                                  44400001
444100              MOVE '7321-SELECT-TRECEIV'                          44410000
444200                               TO DP013-PARAGRAPH                 44420000
444300              MOVE 'SELECT TRECEIV'                               44430000
444400                               TO DP013-MESSAGE-TEXT (1)          44440000
444500              MOVE SQLCA       TO DP013-SQLCA                     44450000
444600              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        44460000
444700              SET DP013-DB2-ABEND                                 44470000
444800                               TO TRUE                            44480000
444900              PERFORM DP013-0000-PROCESS-ABEND                    44490000
445000     END-EVALUATE.                                                44500000
445100/                                                                 44510000
445200*----------------------------------------------------------------*44520000
445300*    CHANGE THE CURRENT ROW TO NOT ACTIVE.                       *44530000
445400*----------------------------------------------------------------*44540000
445500                                                                  44550000
445600 7322-UPDATE-TRECEIV.                                             44560000
445700     IF  PV-STATUS EQUAL PC-VE                                    44570000
445800         EXEC SQL                                                 44580000
445900              SET                                                 44590000
446000                 :RECEIV-VERFYD-TMST   =  CURRENT TIMESTAMP       44600000
446100         END-EXEC                                                 44610000
446200                                                                  44620000
446300         EVALUATE TRUE                                            44630000
446400             WHEN SQLCODE = ZERO                                  44640000
446500                  CONTINUE                                        44650000
446600             WHEN SQLWARN0 NOT = SPACE                            44660000
446700             WHEN SQLCODE NOT = ZERO                              44670000
446800                  MOVE '7323-INSERT-TRECEIV'                      44680000
446900                               TO DP013-PARAGRAPH                 44690000
447000                  MOVE 'SET CURRENT TIMESTAMP FOR VERIFIED STATUS'44700000
447100                               TO DP013-MESSAGE-TEXT (1)          44710000
447200                  MOVE SQLCA   TO DP013-SQLCA                     44720000
447300                  MOVE 'TRECEIV '                                 44730000
447400                               TO DP013-DB2-TABLE-NAME (1)        44740000
447500                  SET DP013-DB2-ABEND                             44750000
447600                               TO TRUE                            44760000
447700                  PERFORM DP013-0000-PROCESS-ABEND                44770000
447800         END-EVALUATE                                             44780000
447900     END-IF.                                                      44790000
448000                                                                  44800000
448100* BEFORE IMAGE                                                    44810000
448200     MOVE 'V'                      TO RC031-TABLE-TO-AUDIT.       44820000
448300     MOVE 'B'                      TO RC031-AUD-TYP-CDE.          44830000
448400     MOVE 'U'                      TO RC031-AUD-FUNC-CDE.         44840000
448500     MOVE DK-PO-NBR                TO RC031-PO-NBR.               44850000
448600     MOVE DK-REC-SEQ-NBR           TO RC031-REC-SEQ-NBR.          44860000
448700     MOVE ASC-KEY-OPER-UNT-ID      TO RC031-OPER-UNT-ID.          44870000
448800     MOVE ASC-KEY-FCLTY-ID         TO RC031-FCLTY-ID.             44880000
448900                                                                  44890000
449000     PERFORM 9000-LINK-AUDIT.                                     44900000
449100                                                                  44910000
449200     EVALUATE TRUE                                                44920000
449300         WHEN RC031-CALL-SUCCESSFUL                               44930000
449400             CONTINUE                                             44940000
449500                                                                  44950000
449600         WHEN OTHER                                               44960000
449700              MOVE '7323-INSERT-TRECEIV'                          44970000
449800                                   TO DP013-PARAGRAPH             44980000
449900              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               44990000
450000                                   TO DP013-MESSAGE-TEXT (1)      45000000
450100              MOVE RC031-RETURN-DESC                              45010000
450200                                   TO DP013-MESSAGE-TEXT (2)      45020000
450300              MOVE RC031-SQLCA     TO DP013-SQLCA                 45030000
450400              SET DP013-DB2-ABEND                                 45040000
450500                  DP013-XCTL-DISPLAY-RESTART                      45050000
450600                                   TO TRUE                        45060000
450700              PERFORM DP013-0000-PROCESS-ABEND                    45070000
450800     END-EVALUATE.                                                45080000
450900                                                                  45090000
451000     EXEC SQL                                                     45100000
451100          UPDATE                                                  45110000
451200                TRECEIV                                           45120000
451300          SET   STATUS_CDE         =  :PV-STATUS                  45130000
451400            ,   VERFYD_TMST        =  :RECEIV-VERFYD-TMST         45140000
451500          WHERE                                                   45150000
451600                ORD_NBR            =  :DK-PO-NBR                  45160000
451700          AND   REC_SEQ_NBR        =  :DK-REC-SEQ-NBR             45170000
451800          AND   VER_STATUS_CDE     =  :PC-A                       45180000
451900     END-EXEC.                                                    45190000
452000                                                                  45200000
452100     EVALUATE TRUE                                                45210000
452200         WHEN SQLCODE = ZERO                                      45220000
452300              CONTINUE                                            45230000
452400         WHEN SQLWARN0 NOT = SPACE                                45240000
452500         WHEN SQLCODE NOT = ZERO                                  45250000
452600              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         45260001
452700              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       45270001
452800              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             45280001
452900              STRING  PV-DISPLAY-PO   '-'                         45290001
453000                      PV-DISPLAY-RCVR '-'                         45300001
453100                      PV-DISPLAY-LINE    DELIMITED BY SIZE        45310001
453200                          INTO DP013-MESSAGE-TEXT (2)             45320001
453300                                                                  45330001
453400              MOVE '7322-UPDATE-TRECEIV'                          45340000
453500                               TO DP013-PARAGRAPH                 45350000
453600              MOVE 'UPDATE TRECEIV STATUS CODE'                   45360000
453700                               TO DP013-MESSAGE-TEXT (1)          45370000
453800              MOVE SQLCA       TO DP013-SQLCA                     45380000
453900              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        45390000
454000              SET DP013-DB2-ABEND                                 45400000
454100                               TO TRUE                            45410000
454200              PERFORM DP013-0000-PROCESS-ABEND                    45420000
454300     END-EVALUATE.                                                45430000
454400/                                                                 45440000
454500 8000-SELECT-RECITM.                                              45450000
454600                                                                  45460000
454700     EXEC SQL                                                     45470000
454800     SELECT                                                       45480000
454900           ORD_NBR                                                45490000
455000          ,ORD_LNE_NBR                                            45500000
455100          ,REC_SEQ_NBR                                            45510000
455200          ,OPER_UNT_ID                                            45520000
455300          ,FCLTY_ID                                               45530000
455400          ,CRE_TMST                                               45540000
455500          ,CRE_UID                                                45550000
455600          ,PO_VER_NBR                                             45560000
455700          ,ITM_NBR                                                45570000
455800          ,PRE_TKT_IND                                            45580000
455900          ,TKT_FMT_ID                                             45590000
456000          ,RTV_IND                                                45600000
456100          ,STATUS_CDE                                             45610000
456200          ,VER_STATUS_CDE                                         45620000
456300          ,PKSL_ITM_QTY                                           45630000
456400          ,DTL_CK_ITM_QTY                                         45640000
456500          ,INNR_PACK_QTY                                          45650000
456600          ,CASE_PACK_QTY                                          45660000
456700          ,RTV_QTY                                                45670000
456800          ,EXPTED_CART_CNT                                        45680000
456900          ,ACTL_CART_CNT                                          45690000
457000          ,MKING_APRON_TMST                                       45700000
457100          ,UNT_COST_AMT                                           45710000
457200          ,COLOR_DESC                                             45720000
457300          ,SIZE_DESC                                              45730000
457400          ,VEND_STYL_NAME                                         45740000
457500          ,VEND_DESC                                              45750000
457600          ,VERFYD_TMST                                            45760000
457700          ,PKSL_NBR                                               45770000
457800          ,REC_INV_LNE_NBR                                        45780000
457900          ,DMG_ITM_QTY                                            45790000
458000          ,UPD_TMST                                               45800000
458100          ,UPD_UID                                                45810000
458200          ,UPD_PGM_ID                                             45820000
458300          ,RCPT_DISTR_UPD_CDE                                     45830000
458400          ,VRFD_USR_ID                                            45840000
458500          ,LAST_TRSCP_TMST                                        45850000
458600          ,LAST_TRSCP_USR_ID                                      45860000
458700          ,PREPK_ID                                               45870000
458800          ,MONTH  (CRE_TMST)                                      45880000
458900          ,DAY    (CRE_TMST)                                      45890000
459000          ,YEAR   (CRE_TMST)                                      45900000
459100          ,HOUR   (CRE_TMST)                                      45910000
459200          ,MINUTE (CRE_TMST)                                      45920000
459300          ,MONTH  (LAST_TRSCP_TMST)                               45930000
459400          ,DAY    (LAST_TRSCP_TMST)                               45940000
459500          ,YEAR   (LAST_TRSCP_TMST)                               45950000
459600          ,HOUR   (LAST_TRSCP_TMST)                               45960000
459700          ,MINUTE (LAST_TRSCP_TMST)                               45970000
459800          ,CURRENT TIMESTAMP                                      45980000
459900     INTO                                                         45990000
460000           :RECITM-ORD-NBR                                        46000000
460100         , :RECITM-ORD-LNE-NBR                                    46010000
460200         , :RECITM-REC-SEQ-NBR                                    46020000
460300         , :RECITM-OPER-UNT-ID                                    46030000
460400         , :RECITM-FCLTY-ID                                       46040000
460500         , :RECITM-CRE-TMST                                       46050000
460600         , :RECITM-CRE-UID                                        46060000
460700         , :RECITM-PO-VER-NBR                                     46070000
460800         , :RECITM-ITM-NBR                                        46080000
460900         , :RECITM-PRE-TKT-IND                                    46090000
461000         , :RECITM-TKT-FMT-ID                                     46100000
461100         , :RECITM-RTV-IND                                        46110000
461200         , :RECITM-STATUS-CDE                                     46120000
461300         , :RECITM-VER-STATUS-CDE                                 46130000
461400         , :RECITM-PKSL-ITM-QTY                                   46140000
461500         , :RECITM-DTL-CK-ITM-QTY                                 46150000
461600         , :RECITM-INNR-PACK-QTY                                  46160000
461700         , :RECITM-CASE-PACK-QTY                                  46170000
461800         , :RECITM-RTV-QTY                                        46180000
461900         , :RECITM-EXPTED-CART-CNT                                46190000
462000         , :RECITM-ACTL-CART-CNT                                  46200000
462100         , :RECITM-MKING-APRON-TMST                               46210000
462200         , :RECITM-UNT-COST-AMT                                   46220000
462300         , :RECITM-COLOR-DESC                                     46230000
462400         , :RECITM-SIZE-DESC                                      46240000
462500         , :RECITM-VEND-STYL-NAME                                 46250000
462600         , :RECITM-VEND-DESC                                      46260000
462700         , :RECITM-VERFYD-TMST                                    46270000
462800         , :RECITM-PKSL-NBR                                       46280000
462900         , :RECITM-REC-INV-LNE-NBR                                46290000
463000         , :RECITM-DMG-ITM-QTY                                    46300000
463100         , :RECITM-UPD-TMST                                       46310000
463200         , :RECITM-UPD-UID                                        46320000
463300         , :RECITM-UPD-PGM-ID                                     46330000
463400         , :RECITM-RCPT-DISTR-UPD-CDE                             46340000
463500         , :RECITM-VRFD-USR-ID                                    46350000
463600         , :RECITM-LAST-TRSCP-TMST                                46360000
463700         , :RECITM-LAST-TRSCP-USR-ID                              46370000
463800         , :RECITM-PREPK-ID                                       46380000
463900         , :PV-DB2-MONTH                                          46390000
464000         , :PV-DB2-DAY                                            46400000
464100         , :PV-DB2-YEAR                                           46410000
464200         , :PV-DB2-HOUR                                           46420000
464300         , :PV-DB2-MINUTE                                         46430000
464400         , :PV-DB2-MONTH-TRSCP                                    46440000
464500         , :PV-DB2-DAY-TRSCP                                      46450000
464600         , :PV-DB2-YEAR-TRSCP                                     46460000
464700         , :PV-DB2-HOUR-TRSCP                                     46470000
464800         , :PV-DB2-MINUTE-TRSCP                                   46480000
464900         , :PV-CURRENT-TIMESTAMP                                  46490000
465000     FROM TRECITM                                                 46500000
465100          WHERE ORD_NBR        = :DK-PO-NBR                       46510000
465200            AND ORD_LNE_NBR    = :DK-PO-LNE-NBR                   46520000
465300            AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  46530000
465400            AND VER_STATUS_CDE = :PC-ACTIVE                       46540000
465500     END-EXEC.                                                    46550000
465600                                                                  46560000
465700     EVALUATE TRUE                                                46570000
465800         WHEN SQLCODE = ZERO                                      46580000
465900              SET PS-RECITM-FOUND                                 46590000
466000                  ASC-FOUND    TO TRUE                            46600000
466100         WHEN SQLCODE = +100                                      46610000
466200              SET PS-RECITM-NOT-FOUND                             46620000
466300                  ASC-NOT-FOUND                                   46630000
466400                               TO TRUE                            46640000
466500         WHEN SQLWARN0 NOT = SPACES                               46650000
466600         WHEN SQLCODE < +0                                        46660000
466700         WHEN SQLCODE > +0                                        46670000
466800              MOVE  DK-PO-NBR           TO  PV-DISPLAY-PO         46680001
466900              MOVE  DK-REC-SEQ-NBR      TO  PV-DISPLAY-RCVR       46690001
467000              MOVE  DK-PO-LNE-NBR       TO  PV-DISPLAY-LINE       46700001
467100              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             46710001
467200              STRING  PV-DISPLAY-PO   '-'                         46720001
467300                      PV-DISPLAY-RCVR '-'                         46730001
467400                      PV-DISPLAY-LINE    DELIMITED BY SIZE        46740001
467500                          INTO DP013-MESSAGE-TEXT (2)             46750001
467600                                                                  46760001
467700              MOVE '8000-SELECT-RECITM'                           46770000
467800                               TO DP013-PARAGRAPH                 46780000
467900              MOVE 'UNSUCCESSFUL SELECT OF RECEIPT ITEM'          46790000
468000                               TO DP013-MESSAGE-TEXT (1)          46800000
468100              MOVE SQLCA       TO DP013-SQLCA                     46810000
468200              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        46820000
468300              SET DP013-DB2-ABEND                                 46830000
468400                  DP013-XCTL-DISPLAY-RESTART                      46840000
468500                               TO TRUE                            46850000
468600              PERFORM DP013-0000-PROCESS-ABEND                    46860000
468700     END-EVALUATE.                                                46870000
468800/                                                                 46880000
468900 8100-ARE-CARTONS-CHECKED-IN.                                     46890000
469000     PERFORM 8110-OPEN-SEQ-CSR.                                   46900000
469100     PERFORM 8120-FETCH-SEQ-CSR.                                  46910000
469200     SET PS-NO-CHECKED-IN-FOUND TO TRUE.                          46920000
469300     PERFORM UNTIL PS-EOC-SEQ OR                                  46930000
469400                   PS-CHECKED-IN-FOUND                            46940000
469500         MOVE PKSLIP-SEQ-NBR TO DK-SEQ-NBR                        46950000
469600         PERFORM 8200-ACTIVE-CARTONS-CHECKED-IN                   46960000
469700         PERFORM 8120-FETCH-SEQ-CSR                               46970000
469800     END-PERFORM.                                                 46980000
469900     PERFORM 8140-CLOSE-SEQ-CSR.                                  46990000
470000                                                                  47000000
470100 8110-OPEN-SEQ-CSR.                                               47010000
470200     EXEC SQL                                                     47020000
470300         OPEN SEQ-CSR                                             47030000
470400     END-EXEC.                                                    47040000
470500                                                                  47050000
470600     EVALUATE TRUE                                                47060000
470700         WHEN SQLCODE = ZERO                                      47070000
470800             SET PS-START-SEQ       TO TRUE                       47080000
470900         WHEN SQLWARN0 NOT = SPACE                                47090000
471000         WHEN SQLCODE NOT = ZERO                                  47100000
471100              MOVE '8110-OPEN-SEQ-CSR'                            47110000
471200                               TO DP013-PARAGRAPH                 47120000
471300              MOVE 'OPEN SEQ CURSOR'                              47130000
471400                               TO DP013-MESSAGE-TEXT (1)          47140000
471500              MOVE SQLCA       TO DP013-SQLCA                     47150000
471600              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)        47160000
471700              SET DP013-DB2-ABEND                                 47170000
471800                               TO TRUE                            47180000
471900              PERFORM DP013-0000-PROCESS-ABEND                    47190000
472000     END-EVALUATE.                                                47200000
472100                                                                  47210000
472200 8120-FETCH-SEQ-CSR.                                              47220000
472300     EXEC SQL                                                     47230000
472400         FETCH SEQ-CSR                                            47240000
472500            INTO  :PKSLIP-SEQ-NBR                                 47250000
472600     END-EXEC.                                                    47260000
472700                                                                  47270000
472800     EVALUATE TRUE                                                47280000
472900         WHEN SQLCODE = ZERO                                      47290000
473000              CONTINUE                                            47300000
473100         WHEN SQLCODE = +100                                      47310000
473200             SET PS-EOC-SEQ TO TRUE                               47320000
473300         WHEN SQLWARN0 NOT = SPACE                                47330000
473400         WHEN SQLCODE NOT = ZERO                                  47340000
473500              MOVE '8120-FETCH-SEQ-CSR'                           47350000
473600                               TO DP013-PARAGRAPH                 47360000
473700              MOVE 'FETCH SEQ CURSOR'                             47370000
473800                               TO DP013-MESSAGE-TEXT (1)          47380000
473900              MOVE SQLCA       TO DP013-SQLCA                     47390000
474000              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)        47400000
474100              SET DP013-DB2-ABEND                                 47410000
474200                               TO TRUE                            47420000
474300              PERFORM DP013-0000-PROCESS-ABEND                    47430000
474400     END-EVALUATE.                                                47440000
474500                                                                  47450000
474600 8140-CLOSE-SEQ-CSR.                                              47460000
474700     EXEC SQL                                                     47470000
474800         CLOSE SEQ-CSR                                            47480000
474900     END-EXEC.                                                    47490000
475000                                                                  47500000
475100     EVALUATE TRUE                                                47510000
475200         WHEN SQLCODE = ZERO                                      47520000
475300         WHEN SQLCODE = +100                                      47530000
475400              CONTINUE                                            47540000
475500         WHEN SQLWARN0 NOT = SPACE                                47550000
475600         WHEN SQLCODE NOT = ZERO                                  47560000
475700              MOVE '8140-CLOSE-SEQ-CSR'                           47570000
475800                               TO DP013-PARAGRAPH                 47580000
475900              MOVE 'CLOSE SEQ CURSOR'                             47590000
476000                               TO DP013-MESSAGE-TEXT (1)          47600000
476100              MOVE SQLCA       TO DP013-SQLCA                     47610000
476200              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)        47620000
476300              SET DP013-DB2-ABEND                                 47630000
476400                               TO TRUE                            47640000
476500              PERFORM DP013-0000-PROCESS-ABEND                    47650000
476600     END-EVALUATE.                                                47660000
476700                                                                  47670000
476800******************************************************************47680000
476900* CHECK TSHUNLO FOR ACTIVE CARTONS CHECKED-IN                     47690000
477000******************************************************************47700000
477100 8200-ACTIVE-CARTONS-CHECKED-IN.                                  47710000
477200                                                                  47720000
477300     MOVE 0        TO PV-CARTON-COUNT.                            47730000
477400                                                                  47740000
477500     EXEC SQL                                                     47750000
477600          SELECT COUNT (*)                                        47760000
477700            INTO :PV-CARTON-COUNT                                 47770000
477800            FROM TINPKSU A                                        47780000
477900                ,TSHUNLO B                                        47790000
478000                ,TSULBXF C                                        47800000
478100            WHERE A.PO_NBR        = :PV-PO-NBR                    47810000
478200              AND A.SEQ_NBR       = :DK-SEQ-NBR                   47820000
478300              AND A.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                47830000
478400              AND A.SHIPT_UNT_ID  = C.SHIPT_UNT_ID                47840000
478500              AND B.ACTV_CDE      = 'A'                           47850000
478600              AND B.SCN_LOC_ID    = 'RECV'                        47860000
478700     END-EXEC                                                     47870000
478800                                                                  47880000
478900     EVALUATE TRUE                                                47890000
479000         WHEN SQLCODE = ZERO                                      47900000
479100              IF PV-CARTON-COUNT > 0                              47910000
479200                  SET PS-CHECKED-IN-FOUND TO TRUE                 47920000
479300              END-IF                                              47930000
479400         WHEN SQLCODE = +100                                      47940000
479500              CONTINUE                                            47950000
479600         WHEN SQLCODE = -904                                      47960000
479700         WHEN SQLCODE = -911                                      47970000
479800         WHEN SQLCODE = -913                                      47980000
479900              PERFORM 9900-SOFT-ABORT                             47990000
480000                                                                  48000000
480100         WHEN SQLWARN0 NOT = SPACES                               48010000
480200         WHEN SQLCODE  NOT = ZERO                                 48020000
480300              MOVE '8200-ACTIVE-CARTONS-CHECKED-IN'               48030000
480400                                 TO DP013-PARAGRAPH               48040000
480500              MOVE 'UNSUCCESSFUL CHECK ACTIVE CARTONS '           48050000
480600                                 TO DP013-MESSAGE-TEXT (1)        48060000
480700              MOVE ASC-KEY-PO-NBR                                 48070000
480800                                 TO PV-DISPLAY-PO                 48080000
480900              MOVE ASC-KEY-REC-SEQ-NBR                            48090000
481000                                 TO PV-DISPLAY-RCVR               48100000
481100              STRING ' RCKCS239 - PO: '                           48110000
481200                     PV-DISPLAY-PO                                48120000
481300                     ' RECVR: '                                   48130000
481400                     PV-DISPLAY-RCVR  DELIMITED BY SIZE           48140000
481500                               INTO DP013-MESSAGE-TEXT (2)        48150000
481600              MOVE SQLCA TO DP013-SQLCA                           48160000
481700              MOVE 'TINPSKU '    TO DP013-DB2-TABLE-NAME (1)      48170000
481800              MOVE 'TSHUNLO '    TO DP013-DB2-TABLE-NAME (2)      48180000
481900              SET DP013-DB2-ABEND                                 48190000
482000                  DP013-XCTL-DISPLAY-RESTART                      48200000
482100                                 TO TRUE                          48210000
482200                                                                  48220000
482300              PERFORM DP013-0000-PROCESS-ABEND                    48230000
482400     END-EVALUATE.                                                48240000
482500                                                                  48250000
482600 8300-INACTIVATE-CARTONS.                                         48260000
482700                                                                  48270000
482800     PERFORM 8110-OPEN-SEQ-CSR.                                   48280000
482900     PERFORM 8120-FETCH-SEQ-CSR.                                  48290000
483000     PERFORM UNTIL PS-EOC-SEQ                                     48300000
483100         MOVE PKSLIP-SEQ-NBR TO DK-SEQ-NBR                        48310000
483200         PERFORM 8350-PROCESS-CARTON-CSR                          48320000
483300         PERFORM 8120-FETCH-SEQ-CSR                               48330000
483400     END-PERFORM.                                                 48340000
483500     PERFORM 8140-CLOSE-SEQ-CSR.                                  48350000
483600                                                                  48360000
483700 8350-PROCESS-CARTON-CSR.                                         48370000
483800     PERFORM 8400-OPEN-CARTON-CSR.                                48380000
483900     PERFORM 8500-FETCH-CARTON-CSR UNTIL                          48390000
484000             PS-EOC-CARTON.                                       48400000
484100     PERFORM 8700-CLOSE-CARTON-CSR.                               48410000
484200                                                                  48420000
484300 8400-OPEN-CARTON-CSR.                                            48430000
484400     EXEC SQL                                                     48440000
484500         OPEN CARTON-CSR                                          48450000
484600     END-EXEC.                                                    48460000
484700                                                                  48470000
484800     EVALUATE TRUE                                                48480000
484900         WHEN SQLCODE = ZERO                                      48490000
485000             SET PS-START-CARTON    TO TRUE                       48500000
485100         WHEN SQLWARN0 NOT = SPACE                                48510000
485200         WHEN SQLCODE NOT = ZERO                                  48520000
485300              MOVE '8400-OPEN-CARTON-CSR'                         48530000
485400                               TO DP013-PARAGRAPH                 48540000
485500              MOVE 'OPEN CARTON CURSOR'                           48550000
485600                               TO DP013-MESSAGE-TEXT (1)          48560000
485700              MOVE SQLCA       TO DP013-SQLCA                     48570000
485800              MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (1)        48580000
485900              MOVE 'TSHPUNT'   TO DP013-DB2-TABLE-NAME (2)        48590000
486000              SET DP013-DB2-ABEND                                 48600000
486100                               TO TRUE                            48610000
486200              PERFORM DP013-0000-PROCESS-ABEND                    48620000
486300     END-EVALUATE.                                                48630000
486400                                                                  48640000
486500 8500-FETCH-CARTON-CSR.                                           48650000
486600     EXEC SQL                                                     48660000
486700         FETCH CARTON-CSR                                         48670000
486800            INTO :SHPUNT-SHIPT-UNT-ID                             48680000
486900     END-EXEC.                                                    48690000
487000                                                                  48700000
487100     EVALUATE TRUE                                                48710000
487200         WHEN SQLCODE = ZERO                                      48720000
487300              PERFORM 8600-UPDATE-SHPUNT                          48730000
487400         WHEN SQLCODE = +100                                      48740000
487500             SET PS-EOC-CARTON TO TRUE                            48750000
487600         WHEN SQLWARN0 NOT = SPACE                                48760000
487700         WHEN SQLCODE NOT = ZERO                                  48770000
487800              MOVE '8500-FETCH-CARTON-CSR'                        48780000
487900                               TO DP013-PARAGRAPH                 48790000
488000              MOVE 'FETCH CARTON CURSOR'                          48800000
488100                               TO DP013-MESSAGE-TEXT (1)          48810000
488200              MOVE SQLCA       TO DP013-SQLCA                     48820000
488300              MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (1)        48830000
488400              MOVE 'TSHPUNT'   TO DP013-DB2-TABLE-NAME (2)        48840000
488500              SET DP013-DB2-ABEND                                 48850000
488600                               TO TRUE                            48860000
488700              PERFORM DP013-0000-PROCESS-ABEND                    48870000
488800     END-EVALUATE.                                                48880000
488900                                                                  48890000
489000 8600-UPDATE-SHPUNT.                                              48900000
489100                                                                  48910000
489200     EXEC SQL                                                     48920000
489300          UPDATE TSHPUNT                                          48930000
489400             SET ACTV_IND           = 'I'                         48940000
489500           WHERE SHIPT_UNT_ID       = :SHPUNT-SHIPT-UNT-ID        48950000
489600     END-EXEC.                                                    48960000
489700                                                                  48970000
489800     EVALUATE TRUE                                                48980000
489900         WHEN SQLCODE = ZERO                                      48990000
490000              CONTINUE                                            49000000
490100         WHEN SQLWARN0 NOT = SPACE                                49010000
490200         WHEN SQLCODE NOT = ZERO                                  49020000
490300              MOVE '8600-UPDATE-SHPUNT'                           49030000
490400                               TO DP013-PARAGRAPH                 49040000
490500              MOVE 'UPDATE TSHPUNT'                               49050000
490600                               TO DP013-MESSAGE-TEXT (1)          49060000
490700              MOVE SQLCA       TO DP013-SQLCA                     49070000
490800              MOVE 'TSHPUNT'   TO DP013-DB2-TABLE-NAME (1)        49080000
490900              SET DP013-DB2-ABEND                                 49090000
491000                               TO TRUE                            49100000
491100              PERFORM DP013-0000-PROCESS-ABEND                    49110000
491200     END-EVALUATE.                                                49120000
491300                                                                  49130000
491400 8700-CLOSE-CARTON-CSR.                                           49140000
491500     EXEC SQL                                                     49150000
491600         CLOSE CARTON-CSR                                         49160000
491700     END-EXEC.                                                    49170000
491800                                                                  49180000
491900     EVALUATE TRUE                                                49190000
492000         WHEN SQLCODE = ZERO                                      49200000
492100         WHEN SQLCODE = +100                                      49210000
492200              CONTINUE                                            49220000
492300         WHEN SQLWARN0 NOT = SPACE                                49230000
492400         WHEN SQLCODE NOT = ZERO                                  49240000
492500              MOVE '8700-CLOSE-CARTON-CSR'                        49250000
492600                               TO DP013-PARAGRAPH                 49260000
492700              MOVE 'CLOSE CARTON CURSOR'                          49270000
492800                               TO DP013-MESSAGE-TEXT (1)          49280000
492900              MOVE SQLCA       TO DP013-SQLCA                     49290000
493000              MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (1)        49300000
493100              MOVE 'TSHPUNT'   TO DP013-DB2-TABLE-NAME (2)        49310000
493200              SET DP013-DB2-ABEND                                 49320000
493300                               TO TRUE                            49330000
493400              PERFORM DP013-0000-PROCESS-ABEND                    49340000
493500     END-EVALUATE.                                                49350000
493600                                                                  49360000
493700                                                                  49370000
493800/                                                                 49380000
493900 9000-LINK-AUDIT.                                                 49390000
494000     EXEC CICS                                                    49400000
494100         LINK PROGRAM  (PC-AUDIT-RTN)                             49410000
494200              COMMAREA (RC031-FIELDS)                             49420000
494300     END-EXEC.                                                    49430000
494400 9100-LINK-TROUBLE.                                               49440000
494500     EXEC CICS                                                    49450000
494600         LINK PROGRAM  (PC-TROUBLE-RTN)                           49460000
494700              COMMAREA (TM500-FIELDS)                             49470000
494800              LENGTH   (PC-TROUBLE-RTN-LENGTH)                    49480000
494900     END-EXEC.                                                    49490000
495000                                                                  49500000
495100/                                                                 49510000
495200 9005-UPDATE-STATUS-CDE.                                          49520000
495300                                                                  49530000
495400* BEFORE IMAGE                                                    49540000
495500     MOVE 'I'                      TO RC031-TABLE-TO-AUDIT.       49550000
495600     MOVE 'B'                      TO RC031-AUD-TYP-CDE.          49560000
495700     MOVE 'U'                      TO RC031-AUD-FUNC-CDE.         49570000
495800     MOVE RECITM-ORD-NBR           TO RC031-PO-NBR.               49580000
495900     MOVE RECITM-ORD-LNE-NBR       TO RC031-PO-LNE-NBR.           49590000
496000     MOVE RECITM-REC-SEQ-NBR       TO RC031-REC-SEQ-NBR.          49600000
496100     MOVE RECITM-OPER-UNT-ID       TO RC031-OPER-UNT-ID.          49610000
496200     MOVE RECITM-FCLTY-ID          TO RC031-FCLTY-ID.             49620000
496300     MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID.           49630000
496400                                                                  49640000
496500     PERFORM 9000-LINK-AUDIT.                                     49650000
496600                                                                  49660000
496700     EVALUATE TRUE                                                49670000
496800         WHEN RC031-CALL-SUCCESSFUL                               49680000
496900             CONTINUE                                             49690000
497000                                                                  49700000
497100         WHEN OTHER                                               49710000
497200              MOVE '9005-UPDATE-STATUS-CDE'                       49720000
497300                                   TO DP013-PARAGRAPH             49730000
497400              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               49740000
497500                                   TO DP013-MESSAGE-TEXT (1)      49750000
497600              MOVE RC031-RETURN-DESC                              49760000
497700                                   TO DP013-MESSAGE-TEXT (2)      49770000
497800              MOVE RC031-SQLCA     TO DP013-SQLCA                 49780000
497900              SET DP013-DB2-ABEND                                 49790000
498000                  DP013-XCTL-DISPLAY-RESTART                      49800000
498100                                   TO TRUE                        49810000
498200              PERFORM DP013-0000-PROCESS-ABEND                    49820000
498300     END-EVALUATE.                                                49830000
498400                                                                  49840000
498500     EXEC SQL                                                     49850000
498600          UPDATE TRECITM                                          49860000
498700             SET STATUS_CDE     = :RECITM-STATUS-CDE              49870000
498800           WHERE ORD_NBR        = :DK-PO-NBR                      49880000
498900             AND ORD_LNE_NBR    = :DK-PO-LNE-NBR                  49890000
499000             AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 49900000
499100             AND VER_STATUS_CDE = :PC-ACTIVE                      49910000
499200     END-EXEC.                                                    49920000
499300                                                                  49930000
499400     EVALUATE TRUE                                                49940000
499500         WHEN SQLCODE = +0                                        49950000
499600              CONTINUE                                            49960000
499700                                                                  49970000
499800         WHEN SQLWARN0 NOT = SPACES                               49980000
499900         WHEN SQLCODE < +0                                        49990000
500000         WHEN SQLCODE > +0                                        50000000
500100              MOVE '9005-UPDATE-STATUS-CDE'                       50010000
500200                               TO DP013-PARAGRAPH                 50020000
500300              MOVE 'UNSUCCESSFUL UPDATE FOR TRECITM'              50030000
500400                               TO DP013-MESSAGE-TEXT (1)          50040000
500500              MOVE SQLCA       TO DP013-SQLCA                     50050000
500600              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        50060000
500700              SET DP013-DB2-ABEND                                 50070000
500800                  DP013-XCTL-DISPLAY-RESTART                      50080000
500900                               TO TRUE                            50090000
501000              PERFORM DP013-0000-PROCESS-ABEND                    50100000
501100     END-EVALUATE.                                                50110000
501200/                                                                 50120000
501300*----------------------------------------------------------------*50130000
501400*    INSERT A RECEIPT ITEM ROW                                   *50140000
501500*----------------------------------------------------------------*50150000
501600                                                                  50160000
501700 9010-UPDATE-RECITM.                                              50170000
501800                                                                  50180000
501900* BEFORE IMAGE                                                    50190000
502000     MOVE 'I'                      TO RC031-TABLE-TO-AUDIT.       50200000
502100     MOVE 'B'                      TO RC031-AUD-TYP-CDE.          50210000
502200     MOVE 'U'                      TO RC031-AUD-FUNC-CDE.         50220000
502300     MOVE RECITM-ORD-NBR           TO RC031-PO-NBR.               50230000
502400     MOVE RECITM-ORD-LNE-NBR       TO RC031-PO-LNE-NBR.           50240000
502500     MOVE RECITM-REC-SEQ-NBR       TO RC031-REC-SEQ-NBR.          50250000
502600     MOVE RECITM-OPER-UNT-ID       TO RC031-OPER-UNT-ID.          50260000
502700     MOVE RECITM-FCLTY-ID          TO RC031-FCLTY-ID.             50270000
502800     MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID.           50280000
502900                                                                  50290000
503000     PERFORM 9000-LINK-AUDIT.                                     50300000
503100                                                                  50310000
503200     EVALUATE TRUE                                                50320000
503300         WHEN RC031-CALL-SUCCESSFUL                               50330000
503400             CONTINUE                                             50340000
503500                                                                  50350000
503600         WHEN OTHER                                               50360000
503700              MOVE '9010-UPDATE-TRECITM'                          50370000
503800                                   TO DP013-PARAGRAPH             50380000
503900              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               50390000
504000                                   TO DP013-MESSAGE-TEXT (1)      50400000
504100              MOVE RC031-RETURN-DESC                              50410000
504200                                   TO DP013-MESSAGE-TEXT (2)      50420000
504300              MOVE RC031-SQLCA     TO DP013-SQLCA                 50430000
504400              SET DP013-DB2-ABEND                                 50440000
504500                  DP013-XCTL-DISPLAY-RESTART                      50450000
504600                                   TO TRUE                        50460000
504700              PERFORM DP013-0000-PROCESS-ABEND                    50470000
504800     END-EVALUATE.                                                50480000
504900                                                                  50490000
505000     EXEC SQL                                                     50500000
505100         UPDATE TRECITM                                           50510000
505200         SET PO_VER_NBR            = :RECITM-PO-VER-NBR           50520000
505300           , ITM_NBR               = :RECITM-ITM-NBR              50530000
505400           , INNR_PACK_QTY         = :RECITM-INNR-PACK-QTY        50540000
505500           , CASE_PACK_QTY         = :RECITM-CASE-PACK-QTY        50550000
505600           , PRE_TKT_IND           = :RECITM-PRE-TKT-IND          50560000
505700           , DTL_CK_ITM_QTY        = :RECITM-DTL-CK-ITM-QTY       50570000
505800           , DMG_ITM_QTY           = :RECITM-DMG-ITM-QTY          50580000
505900           , RTV_IND               = :RECITM-RTV-IND              50590000
506000           , RTV_QTY               = :RECITM-RTV-QTY              50600000
506100           , UNT_COST_AMT          = :RECITM-UNT-COST-AMT         50610000
506200           , PKSL_ITM_QTY          = :RECITM-PKSL-ITM-QTY         50620000
506300          WHERE ORD_NBR            = :DK-PO-NBR                   50630000
506400            AND ORD_LNE_NBR        = :DK-PO-LNE-NBR               50640000
506500            AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR              50650000
506600            AND VER_STATUS_CDE     = :PC-ACTIVE                   50660000
506700     END-EXEC.                                                    50670000
506800                                                                  50680000
506900     EVALUATE TRUE                                                50690000
507000         WHEN SQLCODE = ZERO                                      50700000
507100              CONTINUE                                            50710000
507200                                                                  50720000
507300         WHEN SQLWARN0 NOT = SPACES                               50730000
507400         WHEN SQLCODE < +0                                        50740000
507500         WHEN SQLCODE > +0                                        50750000
507600              MOVE '9010-UPDATE-RECITM'                           50760000
507700                               TO DP013-PARAGRAPH                 50770000
507800              MOVE 'UNSUCCESSFUL INSERT FOR TRECITM'              50780000
507900                               TO DP013-MESSAGE-TEXT (1)          50790000
508000              MOVE SQLCA       TO DP013-SQLCA                     50800000
508100              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        50810000
508200              SET DP013-DB2-ABEND                                 50820000
508300                  DP013-XCTL-DISPLAY-RESTART                      50830000
508400                               TO TRUE                            50840000
508500              PERFORM DP013-0000-PROCESS-ABEND                    50850000
508600     END-EVALUATE.                                                50860000
508700                                                                  50870000
508800*----------------------------------------------------------------*50880000
508900*    RETRIEVE THE VERSION NUMBER, CLASS AND SEQUENCE NUMBER      *50890000
509000*    OF THE PURCHASE ORDER LINE                                  *50900000
509100*----------------------------------------------------------------*50910000
509200 9050-GET-PURITM.                                                 50920000
509300                                                                  50930000
509400     MOVE ASC-KEY-PO-NBR           TO DK-PO-NBR.                  50940000
509500                                                                  50950000
509600     EXEC SQL                                                     50960000
509700          SELECT DISTINCT                                         50970000
509800                 A.DEPT_NBR,                                      50980000
509900                 A.ENT_ID,                                        50990000
510000                 B.VER_NBR,                                       51000000
510100                 B.SKU_SEQ_NBR,                                   51010000
510200                 B.VEND_STYL_NAME,                                51020000
510300                 B.COLOR_DESC,                                    51030000
510400                 B.SIZE_DESC,                                     51040000
510500                 B.UNT_RTL_PR_AMT,                                51050000
510600                 B.STATUS_CDE,                                    51060000
510700                 B.ITM_NBR,                                       51070000
510800                 B.GP_RTL_AMT,                                    51080000
510900                 B.GP_QTY,                                        51090000
511000                 B.PIC_ITM_IND                                    51100000
511100            INTO :PURCHS-DEPT-NBR,                                51110000
511200                 :PURCHS-ENT-ID,                                  51120000
511300                 :PURITM-VER-NBR,                                 51130000
511400                 :PURITM-SKU-SEQ-NBR,                             51140000
511500                 :PURITM-VEND-STYL-NAME,                          51150000
511600                 :PURITM-COLOR-DESC,                              51160000
511700                 :PURITM-SIZE-DESC,                               51170000
511800                 :PURITM-UNT-RTL-PR-AMT,                          51180000
511900                 :PV-PURITM-STATUS-CDE,                           51190000
512000                 :ASC-ITM-NBR,                                    51200000
512100                 :PURITM-GP-RTL-AMT,                              51210000
512200                 :PURITM-GP-QTY,                                  51220000
512300                 :ASC-PURITM-PIC-ITM-IND                          51230000
512400            FROM TPURCHS A,                                       51240000
512500                 TPURITM B,                                       51250000
512600                 TRECITM C                                        51260000
512700           WHERE A.PO_NBR         = :DK-PO-NBR                    51270000
512800             AND A.PO_NBR         = B.PO_NBR                      51280000
512900             AND A.PO_NBR         = C.ORD_NBR                     51290000
513000             AND B.APP_PO_LNE_NBR = :DK-PO-LNE-NBR                51300000
513100             AND C.ORD_LNE_NBR    = :DK-PO-LNE-NBR                51310000
513200             AND C.VER_STATUS_CDE = :PC-ACTIVE                    51320000
513300             AND A.VER_STATUS_CDE = :PC-ACTIVE                    51330000
513400             AND C.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               51340000
513500             AND C.PO_VER_NBR     = B.VER_NBR                     51350000
513600     END-EXEC.                                                    51360000
513700                                                                  51370000
513800     EVALUATE TRUE                                                51380000
513900         WHEN SQLCODE = +0                                        51390000
514000              SET PS-PURITM-FOUND                                 51400000
514100                               TO TRUE                            51410000
514200                                                                  51420000
514300         WHEN SQLCODE = +100                                      51430000
514400              SET PS-PURITM-NOT-FOUND                             51440000
514500                               TO TRUE                            51450000
514600         WHEN SQLWARN0 NOT = SPACES                               51460000
514700         WHEN SQLCODE < +0                                        51470000
514800         WHEN SQLCODE > +0                                        51480000
514900              MOVE '9050-GET-PURITM'                              51490000
515000                               TO DP013-PARAGRAPH                 51500000
515100              MOVE 'UNSUCCESSFUL SELECT ON PO ITEM'               51510000
515200                               TO DP013-MESSAGE-TEXT (1)          51520000
515300              MOVE SQLCA       TO DP013-SQLCA                     51530000
515400              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        51540000
515500              SET DP013-DB2-ABEND                                 51550000
515600                  DP013-XCTL-DISPLAY-RESTART                      51560000
515700                               TO TRUE                            51570000
515800              PERFORM DP013-0000-PROCESS-ABEND                    51580000
515900     END-EVALUATE.                                                51590000
516000                                                                  51600000
516100/                                                                 51610000
516200*----------------------------------------------------------------*51620000
516300*    SELECT THE PACK SLIP ITEM.                                  *51630000
516400*----------------------------------------------------------------*51640000
516500 9060-SELECT-TPKITEM.                                             51650000
516600                                                                  51660000
516700     EXEC SQL                                                     51670000
516800          SELECT  PO_NBR,                                         51680000
516900                  SEQ_NBR,                                        51690000
517000                  PKSL_LNE_NBR,                                   51700000
517100                  CRE_TMST,                                       51710000
517200                  VER_STAT_CDE,                                   51720000
517300                  PKSL_ITM_QTY,                                   51730000
517400                  CRE_UID,                                        51740000
517500                  PURITM_VER_NBR                                  51750000
517600            INTO :PKITEM-PO-NBR,                                  51760000
517700                 :PKITEM-SEQ-NBR,                                 51770000
517800                 :PKITEM-PKSL-LNE-NBR,                            51780000
517900                 :PKITEM-CRE-TMST,                                51790000
518000                 :PKITEM-VER-STAT-CDE,                            51800000
518100                 :PKITEM-PKSL-ITM-QTY,                            51810000
518200                 :PKITEM-CRE-UID,                                 51820000
518300                 :PKITEM-PURITM-VER-NBR                           51830000
518400            FROM TPKITEM                                          51840000
518500           WHERE PO_NBR       = :DK-PO-NBR                        51850000
518600*????            AND SEQ_NBR      = :ASC-KEY-SEQ-NBR              51860000
518700             AND PKSL_LNE_NBR = :DK-PO-LNE-NBR                    51870000
518800             AND VER_STAT_CDE = :PC-ACTIVE                        51880000
518900     END-EXEC.                                                    51890000
519000                                                                  51900000
519100     EVALUATE TRUE                                                51910000
519200         WHEN SQLCODE = +0                                        51920000
519300              CONTINUE                                            51930000
519400                                                                  51940000
519500         WHEN SQLCODE = +100                                      51950000
519600              SET PS-PKITEM-NOT-FOUND                             51960000
519700                               TO TRUE                            51970000
519800                                                                  51980000
519900         WHEN SQLWARN0 NOT = SPACES                               51990000
520000         WHEN SQLCODE < +0                                        52000000
520100         WHEN SQLCODE > +0                                        52010000
520200              MOVE '9060-SELECT-PKITEM'                           52020000
520300                               TO DP013-PARAGRAPH                 52030000
520400              MOVE 'UNSUCCESSFUL SELECT PACK SLIP ITEM'           52040000
520500                               TO DP013-MESSAGE-TEXT (1)          52050000
520600              MOVE SQLCA       TO DP013-SQLCA                     52060000
520700              MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)        52070000
520800              SET DP013-DB2-ABEND                                 52080000
520900                  DP013-XCTL-DISPLAY-RESTART                      52090000
521000                               TO TRUE                            52100000
521100              PERFORM DP013-0000-PROCESS-ABEND                    52110000
521200     END-EVALUATE.                                                52120000
521300                                                                  52130000
521400/                                                                 52140000
521500*----------------------------------------------------------------*52150000
521600*    SET THE CURRENT VERSION OF THE MATCHED PACK SLIP ITEM TO    *52160000
521700*    INACTIVE BEFORE THE INSERT OF THE NEW MATCHED PACK SLIP     *52170000
521800*    ITEM ROW IS DONE.                                           *52180000
521900*----------------------------------------------------------------*52190000
522000                                                                  52200000
522100 9070-SET-PKITEM-INACT.                                           52210000
522200                                                                  52220000
522300                                                                  52230000
522400     EXEC SQL                                                     52240000
522500          UPDATE TPKITEM                                          52250000
522600             SET VER_STAT_CDE   = :PC-INACTIVE                    52260000
522700           WHERE PO_NBR         = :DK-PO-NBR                      52270000
522800             AND SEQ_NBR        = :PKITEM-SEQ-NBR                 52280000
522900             AND PKSL_LNE_NBR   = :PKITEM-PKSL-LNE-NBR            52290000
523000             AND VER_STAT_CDE   = :PC-ACTIVE                      52300000
523100     END-EXEC.                                                    52310000
523200                                                                  52320000
523300     EVALUATE TRUE                                                52330000
523400         WHEN SQLCODE = +0                                        52340000
523500              CONTINUE                                            52350000
523600                                                                  52360000
523700         WHEN SQLWARN0 NOT = SPACES                               52370000
523800         WHEN SQLCODE < +0                                        52380000
523900         WHEN SQLCODE > +0                                        52390000
524000              MOVE '9070-SET-PKITEM-INACT'                        52400000
524100                               TO DP013-PARAGRAPH                 52410000
524200              MOVE 'UNSUCCESSFUL UPDATE FOR TPKITEM'              52420000
524300                               TO DP013-MESSAGE-TEXT (1)          52430000
524400              MOVE SQLCA       TO DP013-SQLCA                     52440000
524500              MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)        52450000
524600              SET DP013-DB2-ABEND                                 52460000
524700                  DP013-XCTL-DISPLAY-RESTART                      52470000
524800                               TO TRUE                            52480000
524900              PERFORM DP013-0000-PROCESS-ABEND                    52490000
525000     END-EVALUATE.                                                52500000
525100/                                                                 52510000
525200******    WR # 27201 - START                                      52520000
525300*----------------------------------------------------------------*52530000
525400*   GET VERIFIED RETAIL FROM RCT_PRC_RCPT                        *52540000
525500*----------------------------------------------------------------*52550000
525600 9080-GET-VRFD-RTL.                                               52560000
525700                                                                  52570000
525800         INITIALIZE DCLRCT00019.                                  52580000
525900                                                                  52590000
526000         EXEC SQL                                                 52600000
526100              SELECT UNT_AMT                                      52610000
526200                    ,GP_AMT                                       52620000
526300                    ,GP_QTY                                       52630000
526400              INTO   :RCT00019-UNT-AMT                            52640000
526500                    ,:RCT00019-GP-AMT                             52650000
526600                    ,:RCT00019-GP-QTY                             52660000
526700              FROM  RCT_PRC_RCPT                                  52670000
526800              WHERE ORD_NBR          = :DK-PO-NBR                 52680000
526900                AND ORD_LNE_NBR      = :DK-PO-LNE-NBR             52690000
527000                AND REC_SEQ_NBR      = :DK-REC-SEQ-NBR            52700000
527100                AND OPER_UNT_ID      = :ASC-KEY-OPER-UNT-ID       52710000
527200                AND FCLTY_ID         = :ASC-KEY-FCLTY-ID          52720000
527300                AND PRC_RCPT_TYP_CDE = 'VE'                       52730000
527400                AND AMT_TYP_CDE      = 'R'                        52740000
527500         END-EXEC                                                 52750000
527600                                                                  52760000
527700     EVALUATE TRUE                                                52770000
527800         WHEN SQLCODE = ZERO                                      52780000
527900              MOVE RCT00019-GP-AMT      TO ASC-GP-RTL-AMT         52790000
528000              MOVE RCT00019-GP-QTY      TO ASC-GP-QTY             52800000
528100              MOVE RCT00019-UNT-AMT     TO ASC-UNT-RTL-PR-AMT     52810000
528200              MOVE RCT00019-UNT-AMT     TO ASC-VRFD-LWST-RTL-AMT  52820000
528300              IF RCT00019-GP-QTY > 1                              52830000
528400                  COMPUTE ASC-VRFD-LWST-RTL-AMT =                 52840000
528500                             RCT00019-GP-AMT / RCT00019-GP-QTY    52850000
528600              END-IF                                              52860000
528700         WHEN SQLCODE = +100                                      52870000
528800                  PERFORM 9085-GET-VRFD-RTL-TRECITM               52880000
528900         WHEN SQLWARN0 NOT = SPACES                               52890000
529000         WHEN SQLCODE < +0                                        52900000
529100         WHEN SQLCODE > +0                                        52910000
529200              MOVE '9080-GET-VRFD-RTL'                            52920000
529300                                  TO DP013-PARAGRAPH              52930000
529400              MOVE 'UNSUCCESSFUL SELECT ON RCT_PRC_RCPT'          52940000
529500                                  TO DP013-MESSAGE-TEXT (1)       52950000
529600              MOVE SQLCA          TO DP013-SQLCA                  52960000
529700              MOVE 'RCT_PRC_RCPT' TO DP013-DB2-TABLE-NAME (1)     52970000
529800              SET DP013-DB2-ABEND                                 52980000
529900                  DP013-XCTL-DISPLAY-RESTART                      52990000
530000                                  TO TRUE                         53000000
530100              PERFORM DP013-0000-PROCESS-ABEND                    53010000
530200     END-EVALUATE.                                                53020000
530300/                                                                 53030000
530400*----------------------------------------------------------------*53040000
530500*  GET VERIFIED RETAIL FROM TRECITM                              *53050000
530600*----------------------------------------------------------------*53060000
530700 9085-GET-VRFD-RTL-TRECITM.                                       53070000
530800                                                                  53080000
530900                                                                  53090000
531000         EXEC SQL                                                 53100000
531100              SELECT UNT_RTL_AMT                                  53110000
531200                    ,GP_RTL_AMT                                   53120000
531300                    ,GP_QTY                                       53130000
531400              INTO   :RECITM-UNT-RTL-AMT                          53140000
531500                    ,:RECITM-GP-RTL-AMT                           53150000
531600                    ,:RECITM-GP-QTY                               53160000
531700              FROM  TRECITM                                       53170000
531800              WHERE ORD_NBR        = :DK-PO-NBR                   53180000
531900                AND ORD_LNE_NBR    = :DK-PO-LNE-NBR               53190000
532000                AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR              53200000
532100                AND STATUS_CDE     = 'VE'                         53210000
532200                AND VER_STATUS_CDE = 'A'                          53220000
532300         END-EXEC                                                 53230000
532400                                                                  53240000
532500     EVALUATE TRUE                                                53250000
532600         WHEN SQLCODE = ZERO                                      53260000
532700              MOVE RECITM-GP-RTL-AMT    TO ASC-GP-RTL-AMT         53270000
532800              MOVE RECITM-GP-QTY        TO ASC-GP-QTY             53280000
532900              MOVE RECITM-UNT-RTL-AMT   TO ASC-UNT-RTL-PR-AMT     53290000
533000              MOVE RECITM-UNT-RTL-AMT   TO ASC-VRFD-LWST-RTL-AMT  53300000
533100              IF RECITM-GP-QTY > 1                                53310000
533200                  COMPUTE ASC-VRFD-LWST-RTL-AMT =                 53320000
533300                             RECITM-GP-RTL-AMT / RECITM-GP-QTY    53330000
533400              END-IF                                              53340000
533500         WHEN SQLCODE = +100                                      53350000
533600              MOVE ZEROS                TO ASC-GP-RTL-AMT         53360000
533700                                           ASC-GP-QTY             53370000
533800                                           ASC-UNT-RTL-PR-AMT     53380000
533900                                           ASC-VRFD-LWST-RTL-AMT  53390000
534000         WHEN SQLWARN0 NOT = SPACES                               53400000
534100         WHEN SQLCODE < +0                                        53410000
534200         WHEN SQLCODE > +0                                        53420000
534300              MOVE '9085-GET-VRFD-RTL-TRECITM'                    53430000
534400                                  TO DP013-PARAGRAPH              53440000
534500              MOVE 'UNSUCCESSFUL SELECT ON TRECITM'               53450000
534600                                  TO DP013-MESSAGE-TEXT (1)       53460000
534700              MOVE SQLCA          TO DP013-SQLCA                  53470000
534800              MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (1)     53480000
534900              SET DP013-DB2-ABEND                                 53490000
535000                  DP013-XCTL-DISPLAY-RESTART                      53500000
535100                                  TO TRUE                         53510000
535200              PERFORM DP013-0000-PROCESS-ABEND                    53520000
535300     END-EVALUATE.                                                53530000
535400/                                                                 53540000
535500*----------------------------------------------------------------*53550000
535600*    GET THE POST TMST FROM TRECEIV.                             *53560000
535700*----------------------------------------------------------------*53570000
535800 9090-GET-POST-TMST.                                              53580000
535900                                                                  53590000
536000     EXEC SQL                                                     53600000
536100          SELECT                                                  53610000
536200                ML_POST_TMST                                      53620000
536300              , FS_POST_TMST                                      53630000
536400          INTO                                                    53640000
536500               :RECEIV-ML-POST-TMST                               53650000
536600              ,:RECEIV-FS-POST-TMST                               53660000
536700          FROM                                                    53670000
536800                TRECEIV                                           53680000
536900          WHERE                                                   53690000
537000                ORD_NBR            =  :DK-PO-NBR                  53700000
537100          AND   REC_SEQ_NBR        =  :DK-REC-SEQ-NBR             53710000
537200          AND   VER_STATUS_CDE     =  :PC-A                       53720000
537300     END-EXEC.                                                    53730000
537400                                                                  53740000
537500     EVALUATE TRUE                                                53750000
537600         WHEN SQLCODE = ZERO                                      53760000
537700         WHEN SQLCODE = +100                                      53770000
537800              CONTINUE                                            53780000
537900         WHEN SQLWARN0 NOT = SPACE                                53790000
538000         WHEN SQLCODE NOT = ZERO                                  53800000
538100              MOVE '9090-GET-POST-TMST'                           53810000
538200                               TO DP013-PARAGRAPH                 53820000
538300              MOVE 'SELECT TRECEIV'                               53830000
538400                               TO DP013-MESSAGE-TEXT (1)          53840000
538500              MOVE SQLCA       TO DP013-SQLCA                     53850000
538600              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        53860000
538700              SET DP013-DB2-ABEND                                 53870000
538800                               TO TRUE                            53880000
538900              PERFORM DP013-0000-PROCESS-ABEND                    53890000
539000     END-EVALUATE.                                                53900000
539100/                                                                 53910000
539200*----------------------------------------------------------------*53920000
539300*  GET VERIFIED RETAIL FROM TRECITM                              *53930000
539400*----------------------------------------------------------------*53940000
539500 9095-GET-FUNC-BEG-TMST.                                          53950000
539600                                                                  53960000
539700         INITIALIZE DCLTKRPRPM.                                   53970000
539800                                                                  53980000
539900         EXEC SQL                                                 53990000
540000              SELECT FUNC_BEG_TMST                                54000000
540100              INTO   :KRPRPM-FUNC-BEG-TMST                        54010000
540200              FROM  TKRPRPM                                       54020000
540300                                                                  54030000
540400              WHERE LOC_ID            = 90                        54040000
540500                AND INTFC_SYS_CDE     = 'KHL'                     54050000
540600                AND SYS_PRC_FUNC_CDE  = 'VRTLDI'                  54060000
540700                AND FUNC_PRC_STAT_CDE = 'AC'                      54070000
540800         END-EXEC                                                 54080000
540900                                                                  54090000
541000     EVALUATE TRUE                                                54100000
541100         WHEN SQLCODE = ZERO                                      54110000
541200         WHEN SQLCODE = +100                                      54120000
541300              CONTINUE                                            54130000
541400         WHEN SQLWARN0 NOT = SPACES                               54140000
541500         WHEN SQLCODE < +0                                        54150000
541600         WHEN SQLCODE > +0                                        54160000
541700              MOVE '9095-GET-FUNC-BEG-TMST'                       54170000
541800                                  TO DP013-PARAGRAPH              54180000
541900              MOVE 'UNSUCCESSFUL SELECT ON TKRPRPM'               54190000
542000                                  TO DP013-MESSAGE-TEXT (1)       54200000
542100              MOVE SQLCA          TO DP013-SQLCA                  54210000
542200              MOVE 'TKRPRPM'      TO DP013-DB2-TABLE-NAME (1)     54220000
542300              SET DP013-DB2-ABEND                                 54230000
542400                  DP013-XCTL-DISPLAY-RESTART                      54240000
542500                                  TO TRUE                         54250000
542600              PERFORM DP013-0000-PROCESS-ABEND                    54260000
542700     END-EVALUATE.                                                54270000
542800/                                                                 54280000
542900******    WR # 27201 - END                                        54290000
543000*----------------------------------------------------------------*54300000
543100*    READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE     *54310000
543200*----------------------------------------------------------------*54320000
543300                                                                  54330000
543400 9100-READ-SEL-QUEUE.                                             54340000
543500                                                                  54350000
543600     EXEC CICS                                                    54360000
543700         READQ TS                                                 54370000
543800             QUEUE (ASC-SEL-QUEUE-NAME)                           54380000
543900             INTO  (PC016-TS-SEL-REC)                             54390000
544000             ITEM  (ASC-SEL-ITEM)                                 54400000
544100             RESP  (PV-CICS-RESPONSE)                             54410000
544200     END-EXEC.                                                    54420000
544300                                                                  54430000
544400     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       54440000
544500         CONTINUE                                                 54450000
544600     ELSE                                                         54460000
544700         SET DP013-LOGIC-ABEND                                    54470000
544800             DP013-NO-ROLLBACK     TO TRUE                        54480000
544900         MOVE '9100-READ-SEL-QUEUE'                               54490000
545000                                   TO DP013-PARAGRAPH             54500000
545100         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   54510000
545200                                   TO DP013-MESSAGE-TEXT (1)      54520000
545300         PERFORM DP013-0000-PROCESS-ABEND                         54530000
545400     END-IF.                                                      54540000
545500                                                                  54550000
545600/                                                                 54560000
545700*----------------------------------------------------------------*54570000
545800*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *54580000
545900*----------------------------------------------------------------*54590000
546000 9200-REWRITE-SEL-QUEUE.                                          54600000
546100                                                                  54610000
546200     EXEC CICS                                                    54620000
546300          WRITEQ TS                                               54630000
546400              QUEUE  (ASC-SEL-QUEUE-NAME)                         54640000
546500              FROM   (PC016-TS-SEL-REC)                           54650000
546600              ITEM   (ASC-SEL-ITEM)                               54660000
546700              RESP   (PV-CICS-RESPONSE)                           54670000
546800              REWRITE                                             54680000
546900     END-EXEC.                                                    54690000
547000                                                                  54700000
547100     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   54710000
547200         SET DP013-CICS-ABEND                                     54720000
547300             DP013-NO-ROLLBACK     TO TRUE                        54730000
547400         MOVE '9200-REWRITE-SEL-QUEUE'                            54740000
547500                                   TO DP013-PARAGRAPH             54750000
547600         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   54760000
547700                                   TO DP013-MESSAGE-TEXT (1)      54770000
547800         PERFORM DP013-0000-PROCESS-ABEND                         54780000
547900     END-IF.                                                      54790000
548000                                                                  54800000
548100/                                                                 54810000
548200***************************************************************   54820000
548300*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE     54830000
548400*    AND THE ERROR SWITCHES.                                      54840000
548500****************************************************************  54850000
548600 9900-SOFT-ABORT.                                                 54860000
548700       SET PS-ERROR         TO TRUE.                              54870000
548800       SET DP020-MSG-FATAL  TO TRUE.                              54880000
548900       MOVE 'THROUGH SOFT-ABORT PARA'                             54890000
549000                        TO DP013-MESSAGE-TEXT (1)                 54900000
549100       MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                  54910000
549200       IF PS-NO-NEXT-SCREEN                                       54920000
549300          SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                   54930000
549400       END-IF.                                                    54940000
549500       PERFORM 9901-BACKUP.                                       54950000
549600       MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).        54960000
549700       PERFORM 0001-CALL-CICS-ARCH-API.                           54970000
549800                                                                  54980000
549900 9901-BACKUP.                                                     54990000
550000      EXEC CICS SYNCPOINT                                         55000000
550100           ROLLBACK                                               55010000
550200      END-EXEC.                                                   55020000
550300                                                                  55030000
550400 9950-CALL-PO-RCVR-TRKING-MOD.                                    55040000
550500                                                                  55050000
550600     INITIALIZE RC071-FIELDS.                                     55060000
550700     MOVE '0A'                      TO RC071-DC-FUNCTION-CODE.    55070000
550800     MOVE DK-PO-NBR                 TO RC071-PO-NBR               55080000
550900     MOVE DK-REC-SEQ-NBR            TO RC071-PO-RCVR              55090000
551000     IF ASC-PKGNG-CODE = 'I' OR 'M'                               55100000
551100        MOVE ASC-PREPK-ID              TO RC071-PREPK-ID          55110000
551200        MOVE ZEROES                    TO RC071-PO-LINE           55120000
551300     ELSE                                                         55130000
551400        MOVE DK-PO-LNE-NBR             TO RC071-PO-LINE           55140000
551500        MOVE ZEROES                    TO RC071-PREPK-ID          55150000
551600     END-IF                                                       55160000
551700     MOVE ASC-KEY-OPER-UNT-ID       TO RC071-SIGNON-LOCATION      55170000
551800     MOVE DP020-USERID              TO RC071-USER-ID              55180000
551900     MOVE PC-CURRENT-PROGRAM-NAME   TO RC071-CALLING-PROGRAM      55190000
552000                                                                  55200000
552100     CALL RC071-PO-RCVR-TRACKING USING  DFHEIBLK                  55210000
552200                                        RC071-COMMAREA            55220000
552300                                        RC071-FIELDS.             55230000
552400                                                                  55240000
552500     IF RC071-SUCCESSFUL                                          55250000
552600         CONTINUE                                                 55260000
552700     ELSE                                                         55270000
552800         SET DP013-NO-ROLLBACK                                    55280000
552900             DP013-XCTL-DISPLAY-RESTART                           55290000
553000             DP013-CICS-ABEND      TO TRUE                        55300000
553100         MOVE '9950-CALL-PO-RCVR-TRKING-MOD'                      55310000
553200                                   TO DP013-PARAGRAPH             55320000
553300         MOVE DK-PO-NBR            TO PV-DISPLAY-PO               55330000
553400         MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR             55340000
553500         STRING                                                   55350000
553600               'CALL TO RCKUT137 NOT SUCCESSFUL '                 55360000
553700               'RETURN CODE = '                                   55370000
553800               RC071-SUCCESS-IND                                  55380000
553900                                DELIMITED BY SIZE                 55390000
554000                                 INTO DP013-MESSAGE-TEXT (1)      55400000
554100         STRING 'PO/RECEIVER = '                                  55410000
554200                 PV-DISPLAY-PO                                    55420000
554300                 ' '                                              55430000
554400                 PV-DISPLAY-RCVR                                  55440000
554500                                DELIMITED BY SIZE                 55450000
554600                                 INTO DP013-MESSAGE-TEXT (2)      55460000
554700         PERFORM DP013-0000-PROCESS-ABEND                         55470000
554800                                                                  55480000
554900      END-IF.                                                     55490000
555000                                                                  55500000
555100*----------------------------------------------------------------*55510000
555200*    ABEND PROCESSOR MODULE                                      *55520000
555300*----------------------------------------------------------------*55530000
555400                                                                  55540000
555500     COPY DPPD013.                                                55550000
