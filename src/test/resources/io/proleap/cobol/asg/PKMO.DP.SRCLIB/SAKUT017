000100*----------------------------------------------------------       00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*----------------------------------------------------------       00030000
000400 PROGRAM-ID.    SAKUT017.                                         00040001
000500 AUTHOR.        CHERI PARMLEY.                                    00050001
000600 DATE-WRITTEN.  FEBRUARY 2011.                                    00060001
000700                                                                  00070000
000800*----------------------------------------------------------       00080000
000900* THIS CREATES THE MISSED MARKUP/MARKDOWN FILE WHICH              00090001
001000* WILL BE USED FOR THE DATA WHAREHOUSE. NEW PROGRAM WAS           00100001
001000* NEEDED FOR THE SAME SORT/SUM COULD NOT BE USED AS INPUT         00101014
001000* ELSE NEEDED DETAIL MAY HAVE BEEN EXCLUDED.                      00102014
001300*----------------------------------------------------------       00110000
001400*----------------------------------------------------------       00120000
001410* HISTORY LOG:                                                    00130000
001420*                                                                 00140000
001430* DATE:   02/18/2011                                              00150001
001440* WR/IR#: WR#39586                                                00160001
001450* PROGRAMMER: CHERI PARMLEY                                       00170001
001460* DESCRIPTION: INITIAL VERSION                                    00180001
001400*----------------------------------------------------------       00181015
031511* DATE:   03/15/2011                                              00190015
031511* WR/IR#: WR#39586                                                00200015
031511* PROGRAMMER: CHERI PARMLEY                                       00210015
031511* DESCRIPTION: ADD 4 DIGIT YEAR TO THE MLRD044 FILE (AT END)      00211015
003194*----------------------------------------------------------       00220000
006101* CHANGED: 01/27/2012                                            *00221019
006102* BY:      ROB SWAGER                                            *00222019
006103* FOR:     WR24719                                               *00223023
006104* WHY:     EXPANDED SIZE OF PV-PC-DIFFER-AMT FIELD               *00224019
      *         RETAIL ITEMS PART OF KOHLS CASH PROJECT.               *00227019
006106******************************************************************00228019
003195 ENVIRONMENT DIVISION.                                            00230000
003196*----------------------------------------------------------       00240000
003197 CONFIGURATION SECTION.                                           00250000
003198 SOURCE-COMPUTER. IBM-3090.                                       00260000
003199 OBJECT-COMPUTER. IBM-3090.                                       00270000
003200                                                                  00280000
003300 INPUT-OUTPUT SECTION.                                            00290000
003400                                                                  00300000
003500 FILE-CONTROL.                                                    00310000
003600                                                                  00320000
003700     SELECT POS-SRTD-EVEN-EXCHG-FILE                              00330000
003800       FILE STATUS IS SC-SRTD-EVEN-EXCHG-FILE-STATUS              00340000
003900       ASSIGN TO INP01.                                           00350000
004000                                                                  00360000
004010     SELECT POS-DATE-FILE                                         00370000
004020       FILE STATUS IS SC-POS-DATE-FILE-STATUS                     00380000
004030       ASSIGN TO INP02.                                           00390000
004040                                                                  00400000
021811     SELECT MW-POS-WAREHOUSE-FILE                                 00486908
021811       FILE STATUS IS SC-MW-WAREHOUSE-FILE-STATUS                 00487008
021811       ASSIGN TO OUT01.                                           00488008
004930                                                                  00489000
005000*----------------------------------------------------------       00490000
005100 DATA DIVISION.                                                   00500000
005200*----------------------------------------------------------       00510000
005300 FILE SECTION.                                                    00520000
005400                                                                  00530000
005700 FD  POS-SRTD-EVEN-EXCHG-FILE                                     00540000
005800     RECORDING MODE IS F                                          00550000
005900     LABEL RECORDS ARE STANDARD                                   00560000
006000     BLOCK CONTAINS 0 RECORDS.                                    00570000
006010 01  POS-SRTD-EVEN-EXCHG-RECORD             PIC  X(115).          00580000
006800                                                                  00590000
006801 FD  POS-DATE-FILE                                                00600000
006802     RECORDING MODE IS F                                          00610000
006803     LABEL RECORDS ARE STANDARD                                   00620000
006804     RECORD CONTAINS 80 CHARACTERS                                00630000
006805     DATA RECORD IS POS-DATE-RECORD.                              00640000
006806 01  POS-DATE-RECORD                        PIC  X(080).          00650000
006807                                                                  00660000
021811 FD  MW-POS-WAREHOUSE-FILE                                        00694008
021811     RECORDING MODE IS F                                          00695008
021811     BLOCK CONTAINS 0 RECORDS                                     00696008
021811     LABEL RECORDS ARE STANDARD.                                  00697008
021811 01  MW-POS-WAREHOUSE-REC                   PIC  X(200).          00698008
021811                                                                  00699008
008307*----------------------------------------------------------       00700000
008400 WORKING-STORAGE SECTION.                                         00710000
008401*----------------------------------------------------------       00720000
008403 01  ABEND-CODE                             PIC S9(004)           00730000
008404                                             VALUE +0             00740000
008405                                             COMP.                00750000
008407                                                                  00760000
008408*---------------------------------------------                    00770000
008409* RECORD LAYOUT FOR INPUT DATE CARD                               00780000
008410* (POS DATE)                                                      00790000
008420*---------------------------------------------                    00800000
008430 01  CC-POS-DATE-CARD.                                            00810000
008440   05  CC-POS-DATE-CARD-DISPLAY.                                  00820000
008450     10  CC-CONTROL-NAME                    PIC  X(014)           00830000
008460                                             VALUE SPACES.        00840000
008470       88  CC-VALID-CONTROL-NAME                                  00841000
008480             VALUE 'P.O.S. DATE = '.                              00842000
008490     10  CC-POS-DATE-MMDDYY                 PIC  9(006)           00843000
008500                                             VALUE ZEROES.        00844000
008501     10  FILLER                                                   00845000
008502        REDEFINES CC-POS-DATE-MMDDYY.                             00846000
008503       15  CC-POS-DATE-MM                   PIC  9(002).          00847000
008504       15  CC-POS-DATE-DD                   PIC  9(002).          00848000
008505       15  CC-POS-DATE-YY                   PIC  9(002).          00849000
008506   05  FILLER                               PIC  X(060)           00850000
008507                                             VALUE SPACES.        00850100
008508                                                                  00850200
008510*---------------------------------------------                    00850300
008520* PC- PROGRAM CONSTANTS                                           00850400
008530*---------------------------------------------                    00850500
008531 01  PC-PROGRAM-CONSTANTS.                                        00850600
008532   05  PC-PROGRAM-NAME                      PIC  X(008)           00850700
008533        VALUE 'SAKUT017'.                                         00850801
008534   05  PC-DECIMAL-SHIFT-RIGHT               PIC S9(002)           00850900
008535                                             VALUE +10.           00851000
008538   05  PC-SKU-QUANTITY                      PIC  9(004)           00852000
008539                                             VALUE 1.             00853000
008542   05  PC-DOCUMENT-QUANTITY                 PIC  X(005)           00854000
008543                                             VALUE '00001'.       00854100
008546   05  PC-VENDOR-INHSE-NMBR                 PIC  X(003)           00854200
008547                                             VALUE SPACES.        00854300
008552                                                                  00854400
008563*---------------------------------------------                    00856200
008564* PV- PROGRAM WORKING VARIABLES                                   00856300
008565*---------------------------------------------                    00856400
008566 01  PV-PROGRAM-VARIABLES.                                        00856500
008567   05 PV-RFMT-STORE.                                              00856715
008568      10  FILLER                            PIC  X VALUE '0'.     00856815
008569      10  PV-RFMT-STORE-4                   PIC  X(4).            00856915
008570   05  PV-CC-FISCAL-ACCT-MONTH              PIC  9(002).          00857015
008571   05  PV-TRANSACTION-DATE-YMD              PIC S9(007)           00857115
008572                                             VALUE ZEROES.        00857215
008573   05  FILLER                                                     00857315
008574      REDEFINES PV-TRANSACTION-DATE-YMD.                          00857415
008575                                                                  00857515
008576     10  PV-TRANSACTION-DATE-YEAR           PIC  9(002).          00857615
008577     10  PV-TRANSACTION-DATE-MONTH          PIC  9(002).          00857715
008578     10  PV-TRANSACTION-DATE-DAY            PIC  9(002).          00857815
008579     10  FILLER                             PIC  9(001).          00857915
008580   05  FILLER                                                     00858015
008581      REDEFINES PV-TRANSACTION-DATE-YMD.                          00858115
008582     10  FILLER                             PIC  9(004).          00858215
008583     10  PV-TRANSACTION-DATE-DAY-X          PIC  X(002).          00858315
008584     10  FILLER                             PIC  9(001).          00858415
008585   05  FILLER                                                     00858515
008586      REDEFINES PV-TRANSACTION-DATE-YMD.                          00858615
008587     10  FILLER                             PIC  9(002).          00858715
008588     10  PV-TRANSACTION-DATE-MONTH-DAY      PIC  X(004).          00858815
008589     10  FILLER                             PIC  9(001).          00858915
008590   05  PV-KOHLS-ACCT-MONTH                  PIC S9(003)           00859015
008591                                             VALUE ZEROES.        00859115
008592   05  FILLER                                                     00859215
008593      REDEFINES PV-KOHLS-ACCT-MONTH.                              00859315
008594     10  PV-KOHLS-ACCT-MONTH-X              PIC  X(002).          00859415
008595     10  FILLER                             PIC  9(001).          00859515
008596   05  PV-RETAIL                            PIC S9(005)V99        00859615
008597                                             VALUE ZEROES.        00859715
008602   05  PV-7-DIGIT-DOCUMENT-NMBR.                                  00859815
008603     10  PV-CATEGORY-IND                    PIC  X(002)           00859915
008604                                             VALUE '00'.          00860015
008605     10  PV-DOCUMENT-NMBR.                                        00860115
008606       15  PV-DEPT-NMBR                     PIC  X(003)           00860215
008607                                             VALUE '000'.         00860315
008608       15  PV-DATE-DAY                      PIC  X(002)           00860415
008609                                             VALUE '00'.          00860515
008610   05  PV-EXT-MISSED-RETURN-MD-AMT          PIC S9(007)V99        00860615
008611                                             VALUE ZEROES         00860715
008612                                             COMP-3.              00860815
008613   05  PV-EXT-MISSED-RETURN-MDC-AMT         PIC S9(007)V99        00860915
008614                                             VALUE ZEROES         00861015
008615                                             COMP-3.              00861115
008616   05  PV-EXT-MISSED-SALE-MU-AMT            PIC S9(007)V99        00861215
008617                                             VALUE ZEROES         00861315
008618                                             COMP-3.              00861415
008619   05  PV-EXT-MISSED-SALE-MD-AMT            PIC S9(007)V99        00861515
008620                                             VALUE ZEROES         00861615
008630                                             COMP-3.              00861715
008619   05  PV-PC-DIFFER-AMT                     PIC S9(005)V99        00861819
008620                                             VALUE ZEROES         00861915
008630                                             COMP-3.              00862015
008666                                                                  00865000
008667   05  PV-SALES-OR-RETURNS-LAYOUT.                                00866000
008668     10  PV-POS-DATE-YMD                    PIC S9(007)           00866100
008669                                             COMP-3.              00866200
008670     10  PV-ACCT-MONTH                      PIC  9(002).          00866300
008671     10  PV-STORE-NUMBER                    PIC  X(004).          00866400
008672     10  PV-TERMINAL-NUMBER                 PIC  9(004).          00866500
008673     10  PV-TRANSACTION-NUMBER              PIC  9(004).          00866600
008680     10  PV-ITEM-SEQUENCE                   PIC S9(005)           00866700
008690                                             COMP-3.              00866800
008700     10  PV-SKU                             PIC  X(008).          00866900
008742     10  PV-STATUS-CODE                     PIC S9(003)           00867000
008743                                             COMP-3.              00868000
008746     10  PV-UNIT-CUST-CHARGED-AMT           PIC S9(005)V99        00871000
008747                                             COMP-3.              00872000
008748     10  PV-UNIT-NET-AMT-CHARGED            PIC S9(005)V99        00873000
008749                                             COMP-3.              00874000
008750     10  PV-UNIT-RETAIL-AMT                 PIC S9(005)V99        00875000
008751                                              COMP-3.             00875100
008766     10  PV-SKU-DTA-ATTRIB.                                       00876600
008767         15  PV-DEPT-CLASS             PIC  X(05).                00876700
008768         15  PV-DEPT-CLASS-NUM        REDEFINES                   00876800
008769             PV-DEPT-CLASS.                                       00876900
008770             20  PV-DEPT-NBR           PIC  9(03).                00877000
008771             20  PV-CLASS-NBR          PIC  9(02).                00877100
008772         15  PV-MAJ-CLASS              PIC  X(04).                00877200
008773     10  FILLER                        PIC  X(01) VALUE SPACES.   00877300
008774                                                                  00877400
008775*---------------------------------------------                    00877500
008776* SC- FILE STATUSES                                               00877600
008777*---------------------------------------------                    00877700
008778 01  SC-FILE-STATUS-CODES.                                        00877800
008779   05  SC-SRTD-EVEN-EXCHG-FILE-STATUS       PIC  X(002)           00877900
008780                                             VALUE SPACES.        00878000
008781     88  SC-SRTD-EVEN-EXCHG-FILE-OK          VALUE '00'.          00878100
008782     88  SC-SRTD-EVEN-EXCHG-FILE-EOF         VALUE '10'.          00878200
008783   05  SC-POS-DATE-FILE-STATUS              PIC  X(002)           00878300
008784                                             VALUE SPACES.        00878400
008785     88  SC-POS-DATE-STATUS-OK               VALUE '00'.          00878500
008813   05  SC-MW-WAREHOUSE-FILE-STATUS          PIC  X(002)           00881600
008814                                             VALUE SPACES.        00881700
008815     88  SC-MW-WAREHOUSE-FILE-OK             VALUE '00'.          00881800
008816                                                                  00881900
008817*---------------------------------------------                    00882600
008818* MERCHANDISE LEDGER MARKDOWN/MARKON RECORD                       00882700
008819* LAYOUT (ADDED FIELDS)                                           00882800
008820*---------------------------------------------                    00882900
008830     COPY MLRD044.                                                00883000
008900                                                                  00884000
009000*---------------------------------------------                    00885000
009100* WORKING STORAGE FOR DPKUT500 INTERFACE                          00886000
009200*---------------------------------------------                    00887000
009300     COPY DPWS500.                                                00888000
009400                                                                  00889000
009500*---------------------------------------------                    00890000
009600* EVEN EXCHANGE EXTRACTION RECORD LAYOUT                          00900000
009700*---------------------------------------------                    00910000
009800     COPY SAWS039.                                                00920000
009900                                                                  00930000
042900*----------------------------------------------------------       00940000
043000 PROCEDURE DIVISION.                                              00950000
043100*----------------------------------------------------------       00960000
043200 0000-MAINLINE.                                                   00970000
043300                                                                  00980000
043301     PERFORM 1000-INITIALIZE.                                     00990000
043302                                                                  01000000
043303     PERFORM 2000-CREATE-MKUP-MKDWN-RECS                          01010000
043304       UNTIL SC-SRTD-EVEN-EXCHG-FILE-EOF.                         01020000
043305                                                                  01030000
043306     PERFORM 9999-CLOSE-FILES.                                    01040000
043307                                                                  01050000
044100     GOBACK.                                                      01060000
044200                                                                  01070000
044300*0000-EXIT.                                                       01080000
044400 EJECT                                                            01090000
044401                                                                  01100000
044402*----------------------------------------------------------       01110000
044403* 1000-INITIALIZE.                                                01120000
044406*----------------------------------------------------------       01130000
044407 1000-INITIALIZE.                                                 01140000
044408                                                                  01150000
044430     OPEN INPUT  POS-SRTD-EVEN-EXCHG-FILE                         01160000
044431                 POS-DATE-FILE                                    01170000
021811          OUTPUT MW-POS-WAREHOUSE-FILE.                           01280008
044479                                                                  01290000
044480     IF NOT SC-SRTD-EVEN-EXCHG-FILE-OK                            01300005
044481       DISPLAY ' '                                                01310005
044482       DISPLAY '** ABEND     **'                                  01320005
044483       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              01330005
044484       DISPLAY '** PARAGRAPH **'                                  01340005
044485        '= 1000-INITIALIZE'                                       01350005
044486       DISPLAY '** SORTED EVEN EXCHANGE OPEN ERROR'               01360005
044487       DISPLAY '** FILE STATUS IS = '                             01370005
044488        SC-SRTD-EVEN-EXCHG-FILE-STATUS                            01380005
044489       MOVE +4005 TO ABEND-CODE                                   01390005
044490       CALL 'ILBOABN0' USING ABEND-CODE                           01400005
044491     END-IF.                                                      01410005
                                                                        01420005
021811     IF NOT SC-MW-WAREHOUSE-FILE-OK                               02640008
021811       DISPLAY ' '                                                02650008
021811       DISPLAY '** ABEND     **'                                  02660008
021811       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              02670008
021811       DISPLAY '** PARAGRAPH **'                                  02680008
021811        '= 1000-INITIALIZE'                                       02690008
021811       DISPLAY '** MW WAREHOUSE FILE OPEN ERROR'                  02700008
021811       DISPLAY '** FILE STATUS IS = '                             02710008
021811        SC-MW-WAREHOUSE-FILE-STATUS                               02720008
021811       MOVE +4005 TO ABEND-CODE                                   02730008
021811       CALL 'ILBOABN0' USING ABEND-CODE                           02740008
021811     END-IF.                                                      02750008
044614                                                                  02760000
044615     PERFORM 1100-RET-CURR-FISCAL-MONTH.                          02770000
044616                                                                  02780000
044617     PERFORM 8010-READ-EVEN-EX-FILE.                              02790000
044618                                                                  02800000
044619     INITIALIZE ML044-PRICE-CHANGE-RECORD.                        02810001
044620                                                                  02820000
044621*1000-EXIT.                                                       02830000
044622 EJECT                                                            02840000
044623                                                                  02850000
044624*----------------------------------------------------------       02860000
044625* 1100-RET-CURR-FISCAL-MONTH.                                     02870000
044626*----------------------------------------------------------       02880000
044627 1100-RET-CURR-FISCAL-MONTH.                                      02890000
044628                                                                  02900000
044629     READ POS-DATE-FILE                                           02910000
044630       INTO CC-POS-DATE-CARD                                      02920000
044631         AT END                                                   02930000
044632           DISPLAY ' '                                            02940000
044633           DISPLAY '** ABEND     **'                              02950000
044634           DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME          02960000
044635           DISPLAY '** PARAGRAPH **'                              02970000
044636            '= 1100-RET-CURR-FISCAL-MONTH'                        02980000
044638           DISPLAY '** CONTROL CARD DATE RECORD IS MISSING'       02990000
044639           MOVE +4003 TO ABEND-CODE                               03000000
044640           CALL 'ILBOABN0' USING ABEND-CODE                       03010000
044641     END-READ.                                                    03020000
044642                                                                  03030000
044644     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         03040000
044645                                                                  03050000
044646     SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03060000
044647     SET DPG52-LK-DTE-GREG         TO TRUE.                       03070000
044648                                                                  03080000
044649     MOVE CC-POS-DATE-MMDDYY TO DPG52-LK-DATE-INPUT.              03090000
044650                                                                  03100000
044651     CALL DP500-KOHLS-CALENDAR-ROUTINE                            03110000
044652       USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.                 03120000
044653                                                                  03130000
044654     EVALUATE TRUE                                                03140000
044655       WHEN DPG54-NO-ERROR                                        03150000
044656         CONTINUE                                                 03160000
044657       WHEN OTHER                                                 03170000
044658         DISPLAY ' '                                              03180000
044659         DISPLAY '** ABEND     **'                                03190000
044660         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            03200000
044661         DISPLAY '** PARAGRAPH **'                                03210000
044662          '= 1100-RET-CURR-FISCAL-MONTH'                          03220000
044664         DISPLAY '** ERROR MESSAGE = ' DPG54-ERROR-MESSAGE        03230000
044665         MOVE +4019 TO ABEND-CODE                                 03240000
044666         CALL 'ILBOABN0' USING ABEND-CODE                         03250000
044667     END-EVALUATE.                                                03260000
044668                                                                  03270000
044669     MOVE DPG56-FISCAL-PERIOD-NBR TO PV-CC-FISCAL-ACCT-MONTH.     03280000
044671                                                                  03290000
044672*1100-EXIT.                                                       03300000
044673 EJECT                                                            03310000
044674                                                                  03320000
044675*----------------------------------------------------------       03330000
044676* 2000-CREATE-MKUP-MKDWN-RECS.                                    03340000
044677*----------------------------------------------------------       03350000
044678 2000-CREATE-MKUP-MKDWN-RECS.                                     03360000
044679                                                                  03370000
044680     PERFORM 3010-PROC-GENERAL-TRANS-DATA.                        03380000
044681                                                                  03390000
044682     IF SA039-RI-SKU = ZEROES                                     03400000
044683       PERFORM 3030-PROC-SALE-TRANS-DATA                          03410000
044684     ELSE                                                         03420000
044685       IF SA039-RI-UNIT-CUST-CHARGED-AMT =                        03430000
044686         SA039-RI-UNIT-OWNED-RETAIL-AMT                           03440000
044687           PERFORM 3030-PROC-SALE-TRANS-DATA                      03450000
044688       ELSE                                                       03460000
044689           PERFORM 3020-RETURN-ITEM-TRANS-DATA                    03470000
044690           PERFORM 3030-PROC-SALE-TRANS-DATA                      03480000
044691       END-IF                                                     03490000
044692     END-IF.                                                      03500000
044693                                                                  03510000
044694     PERFORM 8010-READ-EVEN-EX-FILE.                              03520000
044695                                                                  03530000
044696*2000-EXIT.                                                       03540000
044697 EJECT                                                            03550000
044698                                                                  03560000
044699*----------------------------------------------------------       03570000
044700* 3010-PROC-GENERAL-TRANS-DATA.                                   03580000
044701*----------------------------------------------------------       03590000
044702 3010-PROC-GENERAL-TRANS-DATA.                                    03600000
044703                                                                  03610000
044704     COMPUTE PV-TRANSACTION-DATE-YMD =                            03620000
044705               SA039-POS-DATE-YMD * PC-DECIMAL-SHIFT-RIGHT.       03630000
044706                                                                  03640000
044707     COMPUTE PV-KOHLS-ACCT-MONTH =                                03650000
044708               SA039-KOHLS-ACCT-MONTH * PC-DECIMAL-SHIFT-RIGHT.   03660000
044709                                                                  03670000
044710*3010-EXIT.                                                       03680000
044711 EJECT                                                            03690000
044712                                                                  03700000
044713*----------------------------------------------------------       03710000
044714* 3020-RETURN-ITEM-TRANS-DATA.                                    03720000
044715*----------------------------------------------------------       03730000
044716 3020-RETURN-ITEM-TRANS-DATA.                                     03740000
044717                                                                  03750000
044718     MOVE ZEROES TO PV-EXT-MISSED-SALE-MU-AMT                     03760000
044719                    PV-EXT-MISSED-SALE-MD-AMT.                    03770000
044720                                                                  03780000
044721     COMPUTE PV-EXT-MISSED-RETURN-MDC-AMT =                       03790000
044722               ((SA039-RI-UNIT-CUST-CHARGED-AMT -                 03800000
044723                  SA039-RI-UNIT-OWNED-RETAIL-AMT) *               03810000
044724                    SA039-RI-UNIT-QTY).                           03820000
044725                                                                  03830000
044726     IF PV-EXT-MISSED-RETURN-MDC-AMT >= ZERO                      03840000
044727       MOVE ZEROES TO PV-EXT-MISSED-RETURN-MD-AMT                 03850000
044728     ELSE                                                         03860000
044729       COMPUTE PV-EXT-MISSED-RETURN-MD-AMT =                      03870000
044730                 PV-EXT-MISSED-RETURN-MDC-AMT * -1                03880000
044731       MOVE ZEROES TO PV-EXT-MISSED-RETURN-MDC-AMT                03890000
044732     END-IF.                                                      03900000
044733                                                                  03910000
044734     SET ML044-BN-OWN-ADJ-CRCT          TO TRUE.                  03920001
044735     SET ML044-RC-MISCELLANEOUS         TO TRUE.                  03930001
044736     MOVE PV-TRANSACTION-DATE-MONTH-DAY TO ML044-PC-DTE.          03940001
031511     MOVE SA039-PC-DTE-YEAR             TO ML044-PC-DTE-YEAR.     03941018
044737     MOVE PV-KOHLS-ACCT-MONTH-X         TO ML044-PC-KOHLS-MM.     03950001
044738     MOVE SA039-RI-SKU                  TO ML044-PC-SKU.          03960001
044739     MOVE SA039-RI-DEPT-CLASS           TO ML044-PC-DEPT-CLASS.   03970001
044740     MOVE SA039-RI-MAJ-CLASS            TO ML044-PC-MAJ-CLASS.    03980001
044741     MOVE SA039-TERMINAL-NUMBER         TO ML044-RGST-ID.         03990001
044742     MOVE SA039-TRANSACTION-NUMBER      TO ML044-TRN-NBR.         04000001
044743     MOVE SA039-ITEM-SEQUENCE           TO ML044-LNE-ITM-SEQ-NBR. 04010001
044744     MOVE PC-SKU-QUANTITY               TO ML044-PC-QTY.          04020001
044745                                                                  04030000
044746     COMPUTE ML044-PC-DIFFER-AMT =                                04040001
044747               ((SA039-RI-UNIT-CUST-CHARGED-AMT -                 04050000
044748                  SA039-RI-UNIT-OWNED-RETAIL-AMT) *               04060000
044749                    SA039-RI-UNIT-QTY * (-1)).                    04070000
044750                                                                  04080000
044751     SET ML044-REGISTER-MKDN-MKON   TO TRUE.                      04090001
044752     MOVE PC-DOCUMENT-QUANTITY      TO ML044-PC-TOT-DOC-QTY.      04100001
044753     MOVE SA039-STORE-NUMBER        TO PV-RFMT-STORE-4.           04110000
044754     MOVE PV-RFMT-STORE             TO ML044-PC-STORE-NBR.        04120001
044755     MOVE PC-VENDOR-INHSE-NMBR      TO ML044-PC-VENDOR-INHSE-NMBR.04130001
044756     MOVE SA039-RI-DEPT-NBR         TO PV-DEPT-NMBR.              04140000
044757     MOVE PV-TRANSACTION-DATE-DAY-X TO PV-DATE-DAY.               04150000
044758     MOVE PV-7-DIGIT-DOCUMENT-NMBR                                04160000
044759       TO ML044-PC-DOC-7-NBR.                                     04170001
044760     MOVE PV-DOCUMENT-NMBR TO ML044-PC-DOC-5-NBR.                 04180001
044761                                                                  04190000
044762     IF PV-EXT-MISSED-RETURN-MD-AMT = ZEROES                      04200000
044763       SET ML044-MKDOWN                 TO TRUE                   04210001
044764       SET ML044-MARKDOWN-CANCEL TO TRUE                          04220001
044765       MOVE ZEROES    TO PV-RETAIL                                04230000
044766       MOVE PV-RETAIL TO ML044-PC-OLD-PR-AMT                      04240001
044767                                                                  04250000
             MOVE ML044-PC-DIFFER-AMT TO PV-PC-DIFFER-AMT               04251012
                                                                        04252010
044768       COMPUTE PV-RETAIL =                                        04260000
044769                 (PV-PC-DIFFER-AMT    *                           04271010
044770                    (-1))                                         04280000
044771       MOVE PV-RETAIL TO ML044-PC-NEW-PR-AMT                      04290001
044773*+*                                                               04310005
044775       MOVE SA039-RI-UNIT-QTY TO ML044-PC-QTY                     04330001
044776       PERFORM 8030-WRITE-WAREHOUSE-REC                           04340013
044777                                                                  04350000
044780     ELSE                                                         04380000
044781       SET ML044-MKDOWN TO TRUE                                   04390001
044782       SET ML044-MARKDOWN           TO TRUE                       04400001
044783                                                                  04410000
044784       COMPUTE PV-RETAIL =                                        04420000
044785                 (SA039-RI-UNIT-CUST-CHARGED-AMT *                04430000
044786                    SA039-RI-UNIT-QTY *                           04440000
044787                    (-1))                                         04450000
044788       MOVE PV-RETAIL TO ML044-PC-OLD-PR-AMT                      04460001
044789                                                                  04470000
044790       COMPUTE PV-RETAIL =                                        04471000
044791                 (SA039-RI-UNIT-OWNED-RETAIL-AMT *                04472000
044792                    SA039-RI-UNIT-QTY *                           04473000
044793                    (-1))                                         04474000
044794       MOVE PV-RETAIL TO ML044-PC-NEW-PR-AMT                      04475001
044773*+*                                                               04476105
044798       MOVE SA039-RI-UNIT-QTY TO ML044-PC-QTY                     04479001
044799       PERFORM 8030-WRITE-WAREHOUSE-REC                           04480013
044800                                                                  04480100
044803     END-IF.                                                      04480400
044804                                                                  04480500
044807*3020-EXIT.                                                       04480800
044808 EJECT                                                            04480900
044809                                                                  04481000
044810*----------------------------------------------------------       04481100
044811* 3030-PROC-SALE-TRANS-DATA.                                      04481200
044812*----------------------------------------------------------       04481300
044813 3030-PROC-SALE-TRANS-DATA.                                       04481400
044814                                                                  04481500
044815     IF (SA039-SI-SKU NOT = ZEROES)                               04481600
044816      AND (SA039-SI-UNIT-CUST-CHARGED-AMT NOT =                   04481700
044817            SA039-SI-UNIT-OWNED-RETAIL-AMT)                       04481800
044818                                                                  04481900
044819       MOVE ZEROES TO PV-EXT-MISSED-RETURN-MD-AMT                 04482000
044820                      PV-EXT-MISSED-RETURN-MDC-AMT                04482100
044821                                                                  04482200
044822       COMPUTE PV-EXT-MISSED-SALE-MU-AMT =                        04482300
044823                 ((SA039-SI-UNIT-CUST-CHARGED-AMT -               04482400
044824                     SA039-SI-UNIT-OWNED-RETAIL-AMT) *            04482500
044825                        SA039-SI-UNIT-QTY)                        04482600
044826                                                                  04482700
044827       IF PV-EXT-MISSED-SALE-MU-AMT >= ZEROES                     04482800
044828         MOVE ZEROES TO PV-EXT-MISSED-SALE-MD-AMT                 04482900
044829       ELSE                                                       04483000
044830         COMPUTE PV-EXT-MISSED-SALE-MD-AMT =                      04483100
044831           PV-EXT-MISSED-SALE-MU-AMT * -1                         04483200
044832         MOVE ZEROES TO PV-EXT-MISSED-SALE-MU-AMT                 04483300
044833       END-IF                                                     04483400
044834                                                                  04483500
044835       MOVE ZEROES TO PV-EXT-MISSED-RETURN-MDC-AMT                04483600
044836                      PV-EXT-MISSED-RETURN-MD-AMT                 04483700
044837                                                                  04483800
044838       SET ML044-RC-MISCELLANEOUS         TO TRUE                 04483901
044839       SET ML044-BN-OWN-ADJ-CRCT          TO TRUE                 04484001
044840       MOVE PV-TRANSACTION-DATE-MONTH-DAY TO ML044-PC-DTE         04484101
031511       MOVE SA039-PC-DTE-YEAR             TO ML044-PC-DTE-YEAR    04484218
044841       MOVE PV-KOHLS-ACCT-MONTH-X         TO ML044-PC-KOHLS-MM    04484401
044842       MOVE SA039-SI-SKU                  TO ML044-PC-SKU         04484501
044843       MOVE SA039-SI-DEPT-CLASS           TO ML044-PC-DEPT-CLASS  04484601
044844       MOVE SA039-SI-MAJ-CLASS            TO ML044-PC-MAJ-CLASS   04484701
044845       MOVE SA039-TERMINAL-NUMBER         TO ML044-RGST-ID        04484801
044846       MOVE SA039-TRANSACTION-NUMBER      TO ML044-TRN-NBR        04484901
044847       MOVE SA039-ITEM-SEQUENCE          TO ML044-LNE-ITM-SEQ-NBR 04485001
044848       MOVE PC-SKU-QUANTITY               TO ML044-PC-QTY         04485101
044849                                                                  04485200
044850       COMPUTE ML044-PC-DIFFER-AMT =                              04485301
044851                 ((SA039-SI-UNIT-CUST-CHARGED-AMT -               04485400
044852                     SA039-SI-UNIT-OWNED-RETAIL-AMT) *            04485500
044853                        SA039-SI-UNIT-QTY * (-1))                 04485600
044854                                                                  04485700
044855       MOVE PC-DOCUMENT-QUANTITY      TO ML044-PC-TOT-DOC-QTY     04485801
044856       MOVE SA039-STORE-NUMBER        TO PV-RFMT-STORE-4          04485900
044857       MOVE PV-RFMT-STORE             TO ML044-PC-STORE-NBR       04486001
044858       SET ML044-REGISTER-MKDN-MKON   TO TRUE                     04486101
044859       MOVE PC-VENDOR-INHSE-NMBR      TO                          04486200
044860                                     ML044-PC-VENDOR-INHSE-NMBR   04486301
044861       MOVE SA039-SI-DEPT-NBR         TO PV-DEPT-NMBR             04486400
044862       MOVE PV-TRANSACTION-DATE-DAY-X TO PV-DATE-DAY              04486500
044863       MOVE PV-7-DIGIT-DOCUMENT-NMBR                              04486600
044864         TO ML044-PC-DOC-7-NBR                                    04486701
044865       MOVE PV-DOCUMENT-NMBR TO ML044-PC-DOC-5-NBR                04486801
044866                                                                  04486900
044867       IF PV-EXT-MISSED-SALE-MU-AMT = ZEROES                      04487000
044868         SET ML044-MKDOWN TO TRUE                                 04487101
044869         SET ML044-MARKDOWN           TO TRUE                     04487201
044870                                                                  04487300
044871         COMPUTE PV-RETAIL =                                      04487400
044872                   (SA039-SI-UNIT-OWNED-RETAIL-AMT *              04487500
044873                      SA039-SI-UNIT-QTY)                          04487600
044874         MOVE PV-RETAIL TO ML044-PC-OLD-PR-AMT                    04487701
044875                                                                  04487800
044876         COMPUTE PV-RETAIL =                                      04487900
044877                   (SA039-SI-UNIT-CUST-CHARGED-AMT *              04488000
044878                      SA039-SI-UNIT-QTY)                          04488100
044879         MOVE PV-RETAIL TO ML044-PC-NEW-PR-AMT                    04488201
044773*+*                                                               04488305
044883         MOVE SA039-SI-UNIT-QTY TO ML044-PC-QTY                   04488501
044884         PERFORM 8030-WRITE-WAREHOUSE-REC                         04488613
044885                                                                  04488700
044888       ELSE                                                       04489000
044889         SET ML044-MKUP TO TRUE                                   04489101
044890         SET ML044-MARKUP           TO TRUE                       04489201
044891                                                                  04489300
044892         COMPUTE PV-RETAIL =                                      04489400
044893                   (SA039-SI-UNIT-OWNED-RETAIL-AMT *              04489500
044894                      SA039-SI-UNIT-QTY *                         04489600
044895                      (-1))                                       04489700
044896         MOVE PV-RETAIL TO ML044-PC-OLD-PR-AMT                    04489801
044897                                                                  04489900
044898         COMPUTE PV-RETAIL =                                      04490000
044899                   (SA039-SI-UNIT-CUST-CHARGED-AMT *              04490100
044900                      SA039-SI-UNIT-QTY *                         04490200
044901                      (-1))                                       04490300
044902         MOVE PV-RETAIL TO ML044-PC-NEW-PR-AMT                    04490401
044773*+*                                                               04490605
044906         MOVE SA039-SI-UNIT-QTY TO ML044-PC-QTY                   04490901
044907         PERFORM 8030-WRITE-WAREHOUSE-REC                         04491013
044908                                                                  04491100
044934       END-IF                                                     04493000
044935                                                                  04493100
044937     END-IF.                                                      04493300
044938                                                                  04493400
044939*3030-EXIT.                                                       04493500
044940 EJECT                                                            04493600
044941                                                                  04493700
045102*----------------------------------------------------------       04509500
045103* 8010-READ-EVEN-EX-FILE.                                         04509600
045104*----------------------------------------------------------       04509700
045105 8010-READ-EVEN-EX-FILE.                                          04509800
045106                                                                  04509900
045107     READ POS-SRTD-EVEN-EXCHG-FILE                                04510000
045108       INTO SA039-EVEN-EXCHNG-EXTR-RECORD.                        04510100
045109                                                                  04510200
045110     IF NOT SC-SRTD-EVEN-EXCHG-FILE-OK                            04510300
045111      AND NOT SC-SRTD-EVEN-EXCHG-FILE-EOF                         04510400
045112       DISPLAY ' '                                                04510500
045113       DISPLAY '** ABEND     **'                                  04510600
045114       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              04510700
045115       DISPLAY '** PARAGRAPH **'                                  04510800
045116        '= 8010-READ-EVEN-EX-FILE'                                04510900
045117       DISPLAY '** SORTED EVEN EXCHANGE OPEN ERROR'               04511000
045118       DISPLAY '** FILE STATUS IS = '                             04511100
045119        SC-SRTD-EVEN-EXCHG-FILE-STATUS                            04511200
045120       MOVE +4002 TO ABEND-CODE                                   04511300
045121       CALL 'ILBOABN0' USING ABEND-CODE                           04511400
045122     END-IF.                                                      04511500
045123                                                                  04511600
045124*8010-EXIT.                                                       04511700
045125 EJECT                                                            04511800
045126                                                                  04511900
045175*----------------------------------------------------------       04516800
045176* 8030-WRITE-WAREHOUSE-REC.                                       04516913
045177*----------------------------------------------------------       04517100
045178 8030-WRITE-WAREHOUSE-REC.                                        04517213
045179                                                                  04517300
045180     IF PV-KOHLS-ACCT-MONTH-X <= PV-CC-FISCAL-ACCT-MONTH          04517413
            MOVE SA039-STRT-TM             TO ML044-STRT-TM             04519303
            MOVE SA039-SLS-CORR-SEQ-NBR    TO ML044-SLS-CORR-SEQ-NBR    04519403
            MOVE ZERO                      TO ML044-LID-SEQ-NBR         04519503
021811       MOVE ML044-PRICE-CHANGE-RECORD                             04520108
021811         TO MW-POS-WAREHOUSE-REC                                  04520208
021811                                                                  04520308
021811       WRITE MW-POS-WAREHOUSE-REC                                 04520408
021811                                                                  04520508
021811       IF NOT SC-MW-WAREHOUSE-FILE-OK                             04520608
021811         DISPLAY ' '                                              04520708
021811         DISPLAY '** ABEND     **'                                04520808
021811         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            04520908
021811         DISPLAY '** PARAGRAPH **'                                04521008
021811          '= 8030-WRITE-WAREHOUSE-REC'                            04521113
021811         DISPLAY '** INVALID WRITE ON MW POS WAREHOUSE FILE'      04521208
021811         DISPLAY '** FILE STATUS IS = '                           04521408
021811          SC-MW-WAREHOUSE-FILE-STATUS                             04521508
021811         MOVE +4001 TO ABEND-CODE                                 04521608
021811         CALL 'ILBOABN0' USING ABEND-CODE                         04521708
021811       END-IF                                                     04522008
045198     END-IF.                                                      04522100
045199                                                                  04522200
045220 8030-EXIT.                                                       04526814
045221 EJECT                                                            04526900
045270                                                                  04531800
045356*----------------------------------------------------------       04550300
045357* 9999-CLOSE-FILES.                                               04550400
045358*----------------------------------------------------------       04550500
045359 9999-CLOSE-FILES.                                                04550600
045360                                                                  04550700
045361     CLOSE POS-SRTD-EVEN-EXCHG-FILE                               04550800
045362           POS-DATE-FILE                                          04550900
021811           MW-POS-WAREHOUSE-FILE.                                 04552008
045400                                                                  04552100
045700*9999-EXIT.                                                       04552200
045800 EJECT                                                            04553000
