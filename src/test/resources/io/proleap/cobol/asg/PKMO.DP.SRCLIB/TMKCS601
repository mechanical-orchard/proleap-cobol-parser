000100*-----------------------*                                         00010009
000200 IDENTIFICATION DIVISION.                                         00020009
000300*-----------------------*                                         00030009
000400 PROGRAM-ID.    TMKCS601.                                         00040009
000500 AUTHOR.        MARGARET MORRISON.                                00050009
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060009
000700 DATE-WRITTEN.  06/99.                                            00070010
000800 DATE-COMPILED.                                                   00080009
000900                                                                  00090009
001000*---------------------------------------------------------------* 00100009
001100*    Y601 - IMPORT NOTIFICATION/TROUBLE LIST PROGRAM            * 00110010
001200*                                                               * 00120009
001300*    THIS PROGRAM WILL PRODUCE A LIST OF NOTIFICATION AND       * 00130009
001400*    TROUBLE RECORDS FOR AN FOB, POE, OTB, DEPARTMENT, PO,      * 00140011
001410*    BUYER, OR OPERATING UNIT.  THE LIST CAN BE DISPLAYED       * 00141011
001420*    EITHER BY PO NUMBER OR BY OLDEST TO NEWEST TROUBLE.        * 00142011
001500*                                                               * 00150009
001600*    THE APPROPRIATE PROGRAM IS INVOKED WHEN THE OPERATOR       * 00160009
001700*    ENTERS  ONE OR MORE ITEMS AND PRESSES A FUNCTION KEY.      * 00170009
001800*                                                               * 00180009
001900*    THE DP030-OVERRIDE-APPL-ERROR SWITCH IS SET TO TRUE WHEN   * 00190009
002000*    ENTERING THE PROGRAM IN ORDER TO GIVE CONTROL BACK TO THE  * 00200009
002100*    LIST WHEN A NEXT-ACT-APPL-ERROR IS SENT BACK FROM THE      * 00210009
002200*    UPDATE.  THE DP030-RC-APPL-ERROR IS CHECKED TO DETERMINE   * 00220009
002300*    IF A NEXT-ACT-APPL-ERROR IS BEING RETURNED TO THE LIST.    * 00230009
002400*                                                               * 00240009
002500*---------------------------------------------------------------* 00250009
001300* CHANGE HISTORY:                                               *         
001300*    CHANGES                                                    *         
001300*     MADE BY: VENKATSUBBU (COGNIZANT)                          *         
001300*     DATE:    10/10/2014                                       *         
001300*                                                               *         
001300*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO# *         
001300*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *TV 10/10/2014    *         
001100*---------------------------------------------------------------*         
263627* CHANGED 11/04/2021    BY JIM HUNTER      WR: CHG0263627                 
263627* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
263627* MAKING THE CALL DYNAMIC VS STATIC.                                      
263627*---------------------------------------------------------------*         
CICS  * CHANGED 11/09/2022    BY JIM HUNTER      WR: CHG0278008                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *-----------------------------------------------------------------        
002600 EJECT                                                            00260009
002700 ENVIRONMENT DIVISION.                                            00270009
002800                                                                  00280009
002900 DATA DIVISION.                                                   00290009
003000                                                                  00300009
003100 WORKING-STORAGE SECTION.                                         00310009
003200                                                                  00320009
003300*----------------------------------------------------------------*00330009
003400*    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING       *00340009
003500*    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.        *00350009
003600*----------------------------------------------------------------*00360009
003700                                                                  00370009
003800     COPY RCWS013.                                                00380009
003900/                                                                 00390009
004000     COPY PCWS016.                                                00400009
004100/                                                                 00410009
004200     COPY DSWS002.                                                00420009
004300                                                                  00430009
004400 01  DK-DB2-KEYS.                                                 00440009
004500     05  DK-OPER-UNT-ID                 PIC S9(04)  COMP.         00450009
004800     05  DK-DEPT-NBR                    PIC  X(03).               00480009
005000     05  DK-BUYER-NBR                   PIC  X(03).               00500009
005100     05  DK-BUYER-NBR-N                 REDEFINES                 00510009
005200         DK-BUYER-NBR                   PIC  9(03).               00520009
005210     05  DK-FOB-CDE                     PIC  X(04).               00521018
005220     05  DK-POE-CDE                     PIC  X(03).               00522018
005230     05  DK-OTB-PER-NBR.                                          00523018
005240         10  DK-OTB-PER-NBR-CC          PIC  X(02).               00523018
005250         10  DK-OTB-PER-NBR-YY          PIC  X(02).               00523018
005260         10  DK-OTB-PER-NBR-MM          PIC  X(02).               00523018
005270     05  DK-OTB-PER-NBR-ALL             PIC  X(06).               00523018
005300     05  DK-PO-NBR                      PIC S9(09)  COMP.         00530009
005600     05  DK-REC-SEQ-NBR                 PIC S9(09)  COMP.         00560009
005700     05  DK-REC-SEQ-NBR-LOW             PIC S9(09)  COMP.         00570009
005800     05  DK-REC-SEQ-NBR-HIGH            PIC S9(09)  COMP.         00580009
005900     05  DK-RESP-AREA-1                 PIC  X(01).               00590009
006000     05  DK-RESP-AREA-2                 PIC  X(01).               00600009
006100     05  DK-RESP-AREA-3                 PIC  X(01).               00610009
006200     05  DK-TRBL-RSN-LOW                PIC S9(04)  COMP.         00620009
006300     05  DK-TRBL-RSN-HIGH               PIC S9(04)  COMP.         00630009
006400     05  DK-NOTIF-STAT-1                PIC  X(01).               00640009
006500     05  DK-NOTIF-STAT-2                PIC  X(01).               00650009
006600     05  DK-NOTIF-STAT-3                PIC  X(01).               00660009
006700     05  DK-NOTIF-STAT-4                PIC  X(01).               00670009
006800     05  DK-LOW-REC-TMST                PIC  X(26)  VALUE SPACES. 00680009
006900     05  DK-HIGH-REC-TMST               PIC  X(26)  VALUE SPACES. 00690009
007000     05  DK-VENDOR-NAME                 PIC  X(30).               00700009
007100     05  DK-ENT-ID                      PIC S9(09)  COMP.         00710009
007200                                                                  00720009
007300 01  PC-PROGRAM-CONSTANTS.                                        00730009
007400     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00740009
007500                                                    'TM601A  '.   00750009
007600     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00760009
007700                                                    'TMKM601 '.   00770009
007800     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00780009
007900                                                    'TMKCS601'.   00790009
008000     05  PC-TMKCS520                    PIC  X(08)  VALUE         00800009
008100                                                    'TMKCS520'.   00810009
008110     05  PC-TMKUP625                    PIC  X(08)  VALUE         00800009
008120                                                    'TMKUP625'.   00810009
008200     05  PC-DPKUT100                    PIC  X(08)  VALUE         00820009
008300                                                    'DPKUT100'.   00830009
008400     05  PC-CORPORATE-OFFICE            PIC S9(04)  VALUE +0090.  00840009
008500     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00850009
008600     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00860009
008700     05  PC-ENTERED-USING-IND           PIC  X(01).               00870009
008800         88  PC-CRIT-SPEC-FORMAT              VALUE '1'.          00880009
008900         88  PC-ENTERED-USING-PO-PO011        VALUE '2'.          00890009
009000         88  PC-ENTERED-USING-PO-PO017        VALUE '3'.          00900009
009100         88  PC-ENTERED-USING-PO-PO013        VALUE '4'.          00910009
009700     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +13     00970009
009800                                                    COMP SYNC.    00980009
009900     05  PC-ITEMS-PER-PANEL-COMP3       PIC S9(09)  VALUE +13     00990009
010000                                                    COMP-3.       01000009
010100     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      01010009
010200                                                    COMP SYNC.    01020009
010300     05  PC-MAX-TABLE-ENTRIES           PIC S9(04)  VALUE +20     01030009
010400                                                    COMP SYNC.    01040009
010500     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         01050009
010600                                                    +1000000      01060009
010700                                                    COMP-3.       01070009
010800     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      01080009
010900                                                    COMP SYNC.    01090009
011000     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       01100009
011100                                                    COMP-3.       01110009
011200     05  PC-NINE                        PIC  X(01)  VALUE '9'.    01120009
011300     05  PC-000000000                   PIC S9(09)  VALUE         01130009
011400                                                    +000000000    01140009
011500                                                    COMP.         01150009
011600     05  PC-999999999                   PIC S9(09)  VALUE         01160009
011700                                                    +999999999    01170009
011800                                                    COMP.         01180009
011900     05  PC-NOT-FOUND                   PIC  X(15)  VALUE         01190009
012000            '** NOT FOUND **'.                                    01200009
012100     05  PC-MULTI-BUYERS                PIC  X(15)  VALUE         01210009
012200            'MULTIPLE BUYERS'.                                    01220009
012300     05  PC-MULTI-ANALYSTS              PIC  X(17)  VALUE         01230009
012400            'MULTIPLE ANALYSTS'.                                  01240009
012500     05  PC-ALL                         PIC  X(03)  VALUE 'ALL'.  01250009
012600     05  PC-ACTIVE-STATUS               PIC  X(01)  VALUE 'A'.    01260009
012700     05  PC-NEW-TROUBLE                 PIC  X(01)  VALUE 'N'.    01270009
012800     05  PC-IN-PROCESS-TROUBLE          PIC  X(01)  VALUE 'I'.    01280009
012900     05  PC-RESOLVED-TROUBLE            PIC  X(01)  VALUE 'R'.    01290009
013000     05  PC-ACKNOWLEDGED-TROUBLE        PIC  X(01)  VALUE 'A'.    01300009
013100     05  PC-BUY-ANALYST-DC-SW           PIC  X(01)  VALUE 'A'.    01310009
013200     05  PC-BUYER                       PIC  X(01)  VALUE 'B'.    01320009
013300     05  PC-ANALYST                     PIC  X(01)  VALUE 'A'.    01330009
013400     05  PC-BUYER-ANALYST-DC            PIC  X(01)  VALUE 'D'.    01340009
013500     05  PC-SLASH                       PIC  X(01)  VALUE '/'.    01350009
013600     05  PC-SPACE                       PIC  X(01)  VALUE ' '.    01360009
013700     05  PC-TYPE-CODE-LONG-NAME         PIC  X(02)  VALUE '01'.   01370009
013800     05  PC-TYPE-CODE-SHORT-NAME        PIC  X(02)  VALUE '04'.   01380009
013900     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  01390009
014000     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  01400009
014100     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  01410009
014200     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  01420009
014300     05  PC-Y                           PIC  X(01)  VALUE 'Y'.    01430009
014310     05  PC-T                           PIC  X(01)  VALUE 'T'.    01431025
014320     05  PC-NA                          PIC  X(05)  VALUE                 
014330                                                      '  N/A'.            
014400     05  PC-DUMMY-DB2-DATE-LOW          PIC  X(26)  VALUE         01440009
014500         '0001-01-01-00.00.00.000000'.                            01450009
014600     05  PC-DUMMY-DB2-DATE-HIGH         PIC  X(26)  VALUE         01460009
014700         '9999-09-09-09.09.09.999999'.                            01470009
014800     05  PC-DUMMY-DB2-DATE              PIC  X(26)  VALUE         01480009
014900         '9999-09-09-09.09.09.999999'.                            01490009
015000     05  PC-DUMMY-DATE                  PIC  X(10)  VALUE         01500009
015100                                        '9999-09-09'.             01510009
015200     05  PC-DC-CHECKED-MSG              PIC  X(10)  VALUE         01520009
015300         'DC CHECKED'.                                            01530009
015400                                                                  01540009
015500     05  PC-TSYMSG-NUMBERS.                                       01550009
015600         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01560009
015700         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01570009
015800         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  01580009
015900*        ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNCTION     01590009
016000         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01600009
016100         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01610009
016200         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01620009
016300         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01630009
016400         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01640009
016500         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01650009
016600         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01660009
016700         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  01670009
016800         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01680009
016900         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01690009
017000         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01700009
017100         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01710009
017200                                                                  01720009
017300         10  PC-TSYMSG-00938            PIC  9(05)  VALUE 00938.  01730009
017400*        TROUBLE/NOTIF HAS ALREADY BEEN RESOLVED                  01740009
017500                                                                  01750009
017600         10  PC-TSYMSG-00986            PIC  9(05)  VALUE 00986.  01760009
017700*        NOTIF/TROUBLE LIST-BY-LINE SCREEN MUST BE USED           01770009
017800                                                                  01780009
017900         10  PC-TSYMSG-00994            PIC  9(05)  VALUE 00994.  01790009
018000*        TABLE LIMITS EXCEEDED, RESULTS COULD BE INACCURATE,      01800009
018100*        CONTACT HELP DESK                                        01810009
018200                                                                  01820009
018300         10  PC-TSYMSG-01025            PIC  9(05)  VALUE 01025.  01830009
018400*        TROUBLE RESOLUTION NOT REQUIRED                          01840009
018500                                                                  01850009
018600         10  PC-TSYMSG-01029            PIC  9(05)  VALUE 01029.  01860009
018700*        DEPARTMENT, BUYER, OR PO NBR REQUIRED FOR LIST           01870009
018800                                                                  01880009
018900         10  PC-TSYMSG-01030            PIC  9(05)  VALUE 01030.  01890009
019000*        INVALID TROUBLE SELECTION REASON ENTERED                 01900009
019100                                                                  01910009
019200         10  PC-TSYMSG-01031            PIC  9(05)  VALUE 01031.  01920009
019300*        TROUBLE MUST BE RESOLVED MANUALLY                        01930009
019400                                                                  01940009
019500         10  PC-TSYMSG-01032            PIC  9(05)  VALUE 01032.  01950009
019600*        RECORD IS ALREADY IN PROCESS                             01960009
019700                                                                  01970009
019800         10  PC-TSYMSG-01033            PIC  9(05)  VALUE 01033.  01980009
019900*        RECORD IS RESOLVED - IN-PROCESS REQUEST INVALID          01990009
020000                                                                  02000009
020100         10  PC-TSYMSG-01034            PIC  9(05)  VALUE 01034.  02010009
020200*        SOME UNRESOLVED TROUBLE STILL EXISTS                     02020009
020300                                                                  02030009
020400         10  PC-TSYMSG-01036            PIC  9(05)  VALUE 01036.  02040009
020500*        NOTIFICATION/TROUBLE IS ACKNOWLEDGED - CAN NOT RESOLVE   02050009
020600                                                                  02060009
020700         10  PC-TSYMSG-01037            PIC  9(05)  VALUE 01037.  02070009
020800*        RECORD IS NOT RESOLVED - CANNOT ACKNOWLEDGE              02080009
020900                                                                  02090009
021000         10  PC-TSYMSG-01038            PIC  9(05)  VALUE 01038.  02100009
021100*        NOTIFICATION/TROUBLE NOT FOUND                           02110009
021200                                                                  02120009
021300         10  PC-TSYMSG-01089            PIC  9(05)  VALUE 01089.  02130009
021400*        NOTIFICATION/TROUBLE NOT AVAILABLE                       02140009
021401                                                                  02140109
021410         10  PC-TSYMSG-01839            PIC  9(05)  VALUE 01839.  02141009
021420*        NOTIFICATION/TROUBLE IS ACKNOWLEDGED - CAN NOT           02142009
021421*        ACKNOWLEDGE                                              02142109
021500*                                                                 02150009
021600 01  PS-PROGRAM-SWITCHES.                                         02160009
021700     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    02170009
021800         88  PS-LIST-END                            VALUE 'Y'.    02180009
021900         88  PS-NO-LIST-END                         VALUE 'N'.    02190009
022000     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    02200009
022100         88  PS-NO-ERROR                            VALUE 'Y'.    02210009
022200         88  PS-ERROR                               VALUE 'N'.    02220009
022300     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02230009
022400         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02240009
022500         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02250009
022600     05  PS-PO-NBR-ENTERED-SW           PIC  X(01)  VALUE 'N'.    02260009
022700         88  PS-PO-NBR-ENTERED                      VALUE 'Y'.    02270009
022800         88  PS-PO-NBR-NOT-ENTERED                  VALUE 'N'.    02280009
022900     05  PS-TRBL-RSN-LOADED-SW          PIC  X(01)  VALUE 'N'.    02290009
023000         88  PS-TRBL-RSN-LOADED                     VALUE 'Y'.    02300009
023100         88  PS-TRBL-RSN-NOT-LOADED                 VALUE 'N'.    02310009
023200     05  PS-DISPLAY-LINE-SW             PIC  X(01)  VALUE 'Y'.    02320009
023300         88  PS-DISPLAY-TROUBLE-LINE                VALUE 'Y'.    02330009
023400         88  PS-DO-NOT-DISPLAY-TROUBLE-LINE         VALUE 'N'.    02340009
023500     05  PS-RESOLVE-REQUEST-SW          PIC  X(01)  VALUE 'N'.    02350009
023600         88  PS-RESOLVE-REQUEST                     VALUE 'Y'.    02360009
023700         88  PS-NOT-A-RESOLVE-REQUEST               VALUE 'N'.    02370009
023800     05  PS-DC-CHEK-REQUEST-SW          PIC  X(01)  VALUE 'N'.    02380009
023900         88  PS-DC-CHEK-REQUEST                     VALUE 'Y'.    02390009
024000     05  PS-FIRST-TIME-SW               PIC  X(01)  VALUE 'Y'.    02400009
024100         88  PS-FIRST-TIME                          VALUE 'Y'.    02410009
024200         88  PS-NOT-FIRST-TIME                      VALUE 'N'.    02420009
024300     05  PS-ITEMS-LEFT-SW               PIC  X(01)  VALUE 'Y'.    02430009
024400         88  PS-TRBL-NOTIF-ITEMS-LEFT               VALUE 'Y'.    02440009
024500         88  PS-NO-TRBL-NOTIF-ITEMS-LEFT            VALUE 'N'.    02450009
024600     05  PS-TRBL-DTL-EXISTS-SW          PIC  X(01)  VALUE 'N'.    02460009
024700         88  PS-TRBL-DTL-EXISTS                     VALUE 'Y'.    02470009
024800         88  PS-NO-TRBL-DTL-EXISTS                  VALUE 'N'.    02480009
024900     05  PS-USE-CSR-SW                  PIC  X(02)  VALUE ' '.    02490009
025000**** LIST SEQ. BY PURCHASE ORDER NUMBER                           02500013
025100         88  PS-USE-OPER-UNT-PO-CSR            VALUE 'OP'.        02510013
025200         88  PS-USE-DEPT-PO-CSR                VALUE 'DP'.        02520013
025300         88  PS-USE-BYR-PO-CSR                 VALUE 'BP'.        02530013
025400         88  PS-USE-PO-PO-CSR                  VALUE 'PP'.        02540019
025410         88  PS-USE-FOB-PO-CSR                 VALUE 'FP'.        02541013
025420         88  PS-USE-POE-PO-CSR                 VALUE 'EP'.        02542013
025430         88  PS-USE-OTB-PO-CSR                 VALUE 'TP'.        02543013
025440         88  PS-USE-ALL-TRBL-PO-CSR            VALUE 'AP'.        02544022
025500**** LIST SEQ. BY OLDEST TO NEWEST TROUBLE                        02550009
025600         88  PS-USE-OPER-UNT-TRB-CSR           VALUE 'OT'.        02560009
025700         88  PS-USE-DEPT-TRB-CSR               VALUE 'DT'.        02570009
025800         88  PS-USE-BYR-TRB-CSR                VALUE 'BT'.        02580009
025900         88  PS-USE-PO-TRB-CSR                 VALUE 'PT'.        02590015
025910         88  PS-USE-FOB-TRB-CSR                VALUE 'FT'.        02591019
025920         88  PS-USE-POE-TRB-CSR                VALUE 'ET'.        02592019
025930         88  PS-USE-OTB-TRB-CSR                VALUE 'TT'.        02593022
025940         88  PS-USE-ALL-TRBL-TRB-CSR           VALUE 'AT'.        02594022
026000*                                                                 02600009
026100 01  PV-PROGRAM-VARIABLES.                                        02610009
026200     05  PV-SUB                         PIC S9(04)  VALUE +0      02620009
026300                                                    COMP SYNC.    02630009
026400     05  PV-SUB-COMP3                   PIC S9(09)  VALUE +0      02640009
026500                                                    COMP-3.       02650009
026600     05  PV-ASC-ITEM-SUB-COMP3          PIC S9(09)  VALUE +0      02660009
026700                                                    COMP-3.       02670009
026800     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02680009
026900                                                    COMP SYNC.    02690009
027000     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02700009
027100                                                    COMP-3.       02710009
027200     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02720009
027300                                                    COMP-3.       02730009
027400     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02740009
027500                                                    COMP-3.       02750009
027600     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02760009
027700                                                    COMP-3.       02770009
027800     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02780009
027900                                                    COMP-3.       02790009
028000     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02800009
028100                                                    COMP-3.       02810009
028200     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02820009
028300                                                    COMP SYNC.    02830009
028400     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02840009
028500                                                    COMP SYNC.    02850009
028600     05  PV-COMMAREA-LENGTH             PIC S9(04)  VALUE +0      02860009
028700                                                    COMP SYNC.    02870009
028800     05  PV-ITEM                        PIC S9(04)  VALUE +0      02880009
028900                                                    COMP SYNC.    02890009
029000     05  PV-ITEM-COMP3                  PIC S9(09)  VALUE +0      02900009
029100                                                    COMP-3.       02910009
029200     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02920009
029300                                                    COMP SYNC.    02930009
029400     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02940009
029500                                                    COMP SYNC.    02950009
029600     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02960009
029700                                                    COMP SYNC.    02970009
029800     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02980009
029900                                                    COMP SYNC.    02990009
030000     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03000009
030100                                                    COMP SYNC.    03010009
030200     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03020009
030300                                                    COMP SYNC.    03030009
030400     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03040009
030500                                                    COMP SYNC.    03050009
030600     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03060009
030700                                                    COMP SYNC.    03070009
030800     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03080009
030900                                                    COMP SYNC.    03090009
031000     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03100009
031100                                                    COMP SYNC.    03110009
031200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      03120009
031300                                                    COMP SYNC.    03130009
031400     05  PV-TRBL-RSN-SUB                PIC S9(04)  VALUE +0      03140009
031500                                                    COMP SYNC.    03150009
031600     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03160009
031700                                                    COMP SYNC.    03170009
031800     05  PV-PREV-REC-SEQ-NBR            PIC S9(09)  VALUE +0      03180009
031900                                                    COMP SYNC.    03190009
032000     05  PV-UNRESOLVED-TROUBLE-COUNT    PIC S9(09)  VALUE +0      03200009
032100                                                    COMP-3.       03210009
032130     05  PV-NOT-RESOLVED-CNT            PIC S9(09)  VALUE +0      03211009
032140                                                    COMP-3.       03212009
032141     05  PV-TTRBDTL-CNT                 PIC S9(09)  VALUE +0      03211009
032142                                                    COMP-3.       03212009
032200     05  PV-PREV-PO-NBR                 PIC S9(09)  VALUE +0      03220009
032300                                                    COMP SYNC.    03230009
032400     05  PV-PREV-DEPT-NBR               PIC  X(03)  VALUE SPACES. 03240009
032500     05  PV-TRBL-REASON-LOW             PIC  X(03)  VALUE SPACES. 03250009
032600     05  PV-TRBL-REASON-HIGH            PIC  X(03)  VALUE SPACES. 03260009
032700     05  PV-PO-NBR                      PIC  9(08)  VALUE ZEROS.  03270009
032800     05  PV-MAX-RESP-DATE               PIC  X(26)  VALUE SPACES. 03280009
032800*TV 10/10/2014 CHANGE STARTS                                      03280009
032900     05  PV-ERROR-PO-NBR                PIC  9(08)  VALUE ZEROS.  03290009
032800*TV 10/10/2014 CHANGE ENDS                                        03280009
033000     05  PV-ERROR-REC-SEQ-NBR           PIC  9(04)  VALUE ZEROS.  03300009
033100     05  PV-ERROR-PO-LNE-NBR            PIC  9(04)  VALUE ZEROS.  03310009
033200     05  PV-ERROR-NOTIF-NBR             PIC  9(09)  VALUE ZEROS.  03320009
033300     05  PV-ERROR-TRBL-RSN-CDE          PIC  9(04)  VALUE ZEROS.  03330009
033400     05  PV-TIMESTAMP                   PIC  X(26)  VALUE SPACES. 03340009
033500     05  PV-TIMESTAMP-R                 REDEFINES                 03350009
033600         PV-TIMESTAMP.                                            03360009
033700         10  PV-TIMESTAMP-YEAR          PIC  9(04).               03370009
033800         10  FILLER                     PIC  X(01).               03380009
033900         10  PV-TIMESTAMP-MONTH         PIC  9(02).               03390009
034000         10  FILLER                     PIC  X(01).               03400009
034100         10  PV-TIMESTAMP-DAY           PIC  9(02).               03410009
034200         10  FILLER                     PIC  X(01).               03420009
034300         10  PV-TIMESTAMP-HOUR          PIC  9(02).               03430009
034400         10  FILLER                     PIC  X(01).               03440009
034500         10  PV-TIMESTAMP-MINUTE        PIC  9(02).               03450009
034600         10  FILLER                     PIC  X(01).               03460009
034700         10  PV-TIMESTAMP-SECONDS       PIC  9(02).               03470009
034800         10  FILLER                     PIC  X(01).               03480009
034900         10  PV-TIMESTAMP-MILLISECONDS  PIC  9(06).               03490009
035000     05  PV-FIRST-NAME.                                           03500009
035100         10 PV-FIRST-NAME-BYTE OCCURS 12 TIMES INDEXED BY INX1    03510009
035200                                        PIC X(01).                03520009
035300     05  PV-LAST-NAME.                                            03530009
035400         10 PV-LAST-NAME-BYTE  OCCURS 18 TIMES INDEXED BY INX2    03540009
035500                                        PIC X(01).                03550009
035600     05  PV-NAME.                                                 03560009
035700         10 PV-NAME-BYTE       OCCURS 30 TIMES INDEXED BY INX3    03570009
035800                                        PIC X(01).                03580009
035900*                                                                 03590009
036000 01  TR-TROUBLE-REASON-TABLE.                                     03600009
036100     05  TR-TROUBLE-REASON-ENTRY        OCCURS 20 TIMES           03610009
036200                                        INDEXED BY TR-TRBL-IDX.   03620009
036300         10  TR-TROUBLE-REASON          PIC  X(04)  VALUE SPACES. 03630009
036400         10  TR-TROUBLE-REASON-N        REDEFINES                 03640009
036500             TR-TROUBLE-REASON          PIC  9(04).               03650009
036600*                                                                 03660009
036700******************************************************************03670009
036800**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03680009
036900**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03690009
037000**  APPLICATION-SPECIFIC COMMAREA.                              **03700009
037100******************************************************************03710009
037200 01  LQW-LIST-QUEUE-WORK-AREA.                                    03720009
037300     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03730009
037400     05  LQW-ITEM-ENTRIES               OCCURS 13 TIMES           03740009
037500                                        INDEXED BY LQW-IDX.       03750009
037600         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03760009
037700         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03770009
037800         10  LQW-SELECTED-SW            PIC  X(01).               03780009
037900             88  LQW-SELECT                         VALUE 'S'.    03790009
038000             88  LQW-DESELECT                       VALUE ' '.    03800009
038100         10  LQW-ACTION                 PIC  X(03).               03810009
038200             88  LQW-ERROR                          VALUE 'ERR'.  03820009
038300             88  LQW-INQUIRE                        VALUE 'INQ'.  03830009
038400             88  LQW-UPDATE                         VALUE 'UPD'.  03840009
038500         10  LQW-NOTIF-NBR              PIC S9(09)  COMP.         03850009
038600         10  LQW-OPER-UNT-ID            PIC S9(04)  COMP.         03860009
038700         10  LQW-FCLTY-ID               PIC S9(04)  COMP.         03870009
038800         10  LQW-DEPT                   PIC  9(03).               03880009
038800*TV 10/10/2014 CHANGE STARTS                                      03880009
038900         10  LQW-PO-NBR                 PIC  9(08).               03890009
038800*TV 10/10/2014 CHANGE ENDS                                        03880009
039000         10  LQW-RCVR-SEQ-NBR-N         PIC  9(04).               03900016
039010         10  LQW-RCVR-SEQ-NBR REDEFINES                           03901025
039020             LQW-RCVR-SEQ-NBR-N         PIC  X(04).               03902025
039100         10  LQW-PO-LNE-NBR             PIC  9(04).               03910009
039200         10  LQW-ENT-ID                 PIC S9(09)  COMP.         03920009
039300         10  LQW-VENDOR-SHORT-NME       PIC  X(10).               03930009
039400         10  LQW-FOB-POE-CDE            PIC  X(04).               03940009
039500         10  LQW-TROUBLE-REASON-CDE     PIC S9(04)  COMP.         03950009
039600         10  LQW-TROUBLE-REASON-DESC    PIC  X(10).               03960009
039700         10  LQW-TROUBLE-RESP-RES-IND   PIC  X(01).               03970009
039800             88  LQW-RESOLVE-NOT-REQUIRED           VALUE ' '.    03980009
039900             88  LQW-RESOLVE-TRBL-AUTO              VALUE 'A'.    03990009
040000             88  LQW-RESOLVE-TRBL-MANUAL            VALUE 'M'.    04000009
040100             88  LQW-RESOLVE-TRBL-BOTH-AUTO-MAN     VALUE 'B'.    04010009
040200         10  LQW-TROUBLE-REASON-LVL     PIC  X(01).               04020009
040300             88  LQW-TROUBLE-PO-LEVEL               VALUE 'P'.    04030009
040400             88  LQW-TROUBLE-LINE-LEVEL             VALUE ' '     04040009
040500                                                          'L'     04050009
040600                                                          'S'     04060009
040700                                                          'X'.    04070009
040800         10  LQW-ARRIVAL-DATE-TIME      PIC  X(08).               04080009
040900         10  LQW-NOTIFICATION-DATE-TIME PIC  X(08).               04090009
041000         10  LQW-RESPONSE-DATE-TIME     PIC  X(08).               04100009
041100         10  LQW-TRBL-DTL-EXISTS-SW     PIC  X(01).               04110009
041200         10  LQW-TRBL-RESOLVED-SW       PIC  X(01).               04120009
041300             88  LQW-TRBL-RESOLVED                  VALUE 'Y'.    04130009
041310         10  LQW-TRBL-ACK-SW            PIC  X(01).               04131009
041320             88  LQW-TRBL-ACK                       VALUE 'Y'.    04132009
041330             88  LQW-TRBL-NOT-ACK                   VALUE 'N'.    04133009
041400                                                                  04140009
041500                                                                  04150009
041600*---------------------------------------------------------------* 04160009
041700*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 04170009
041800*---------------------------------------------------------------* 04180009
041900                                                                  04190009
042000     COPY TMWS002.                                                04200009
042100                                                                  04210009
042200*---------------------------------------------------------------* 04220009
042300*  RECORD LAYOUT FOR THE PO INQUIRY AND UPDATE SELECTION TEMP   * 04230009
042400*  STORAGE QUEUE                                                * 04240009
042500*---------------------------------------------------------------* 04250009
042600                                                                  04260009
042700     COPY POWS012.                                                04270009
042800                                                                  04280009
042900*---------------------------------------------------------------* 04290009
043000*    MAP LAYOUT                                                 * 04300009
043100*---------------------------------------------------------------* 04310009
043200                                                                  04320009
043300     COPY TMKM601.                                                04330009
043400*                                                                 04340009
043500 01  MR-OCCURS-LAYOUT                   REDEFINES  TM601AO.       04350009
043800     05  FILLER                         PIC X(42).                04360035
045600     05  MR-SCROLL-AREA                 OCCURS 13 TIMES.          04560009
045700         10  MR-SELECTL                 PIC S9(04) COMP.          04570009
045800         10  MR-SELECTA                 PIC  X(01).               04580009
045900         10  MR-SELECTC                 PIC  X(01).               04590009
046000         10  MR-SELECTH                 PIC  X(01).               04600009
046100         10  MR-SELECTI                 PIC  X(01).               04610009
046200                                                                  04620009
046300         10  MR-ACTIONL                 PIC S9(04) COMP.          04630009
046400         10  MR-ACTIONA                 PIC  X(01).               04640009
046500         10  MR-ACTIONC                 PIC  X(01).               04650009
046600         10  MR-ACTIONH                 PIC  X(01).               04660009
046700         10  MR-ACTION                  PIC  X(03).               04670009
046800                                                                  04680009
046900         10  MR-DEPTL                   PIC S9(04) COMP.          04690009
047000         10  MR-DEPTA                   PIC  X(01).               04700009
047100         10  MR-DEPTC                   PIC  X(01).               04710009
047200         10  MR-DEPTH                   PIC  X(01).               04720009
047300         10  MR-DEPT.                                             04730009
047400             15  MR-DEPT-N              PIC  9(03).               04740009
047500                                                                  04750009
047600         10  MR-PO-NBRL                 PIC S9(04) COMP.          04760009
047700         10  MR-PO-NBRA                 PIC  X(01).               04770009
047800         10  MR-PO-NBRC                 PIC  X(01).               04780009
047900         10  MR-PO-NBRH                 PIC  X(01).               04790009
048000         10  MR-PO-NBR.                                           04800009
048000*TV 10/10/2014 CHANGE STARTS                                      04800009
048100             15  MR-PO-NBR-N            PIC  Z(08).               04810009
048000*TV 10/10/2014 CHANGE ENDS                                        04800009
048200                                                                  04820009
048300         10  MR-RCVR-SEQ-NBRL           PIC S9(04) COMP.          04830009
048400         10  MR-RCVR-SEQ-NBRA           PIC  X(01).               04840009
048500         10  MR-RCVR-SEQ-NBRC           PIC  X(01).               04850009
048600         10  MR-RCVR-SEQ-NBRH           PIC  X(01).               04860009
048700         10  MR-RCVR-SEQ-NBR.                                     04870009
048800             15  MR-RCVR-SEQ-NBR-N      PIC  9(04).               04880009
048900                                                                  04890009
049000         10  MR-VENDOR-NMEL             PIC S9(04) COMP.          04900009
049100         10  MR-VENDOR-NMEA             PIC  X(01).               04910009
049200         10  MR-VENDOR-NMEC             PIC  X(01).               04920009
049300         10  MR-VENDOR-NMEH             PIC  X(01).               04930009
049400         10  MR-VENDOR-NME              PIC  X(10).               04940009
049500                                                                  04950009
049600         10  MR-FOB-POE-CDEL            PIC S9(04) COMP.          04960009
049700         10  MR-FOB-POE-CDEA            PIC  X(01).               04970009
049800         10  MR-FOB-POE-CDEC            PIC  X(01).               04980009
049900         10  MR-FOB-POE-CDEH            PIC  X(01).               04990009
050000         10  MR-FOB-POE-CDE             PIC  X(04).               05000009
050100                                                                  05010009
050200         10  MR-TROUBLE-REASONL         PIC S9(04) COMP.          05020009
050300         10  MR-TROUBLE-REASONA         PIC  X(01).               05030009
050400         10  MR-TROUBLE-REASONC         PIC  X(01).               05040009
050500         10  MR-TROUBLE-REASONH         PIC  X(01).               05050009
050600         10  MR-TROUBLE-REASON          PIC  X(10).               05060009
050700                                                                  05070009
050800         10  MR-ARRIVAL-DATE-TIMEL      PIC S9(04) COMP.          05080009
050900         10  MR-ARRIVAL-DATE-TIMEA      PIC  X(01).               05090009
051000         10  MR-ARRIVAL-DATE-TIMEC      PIC  X(01).               05100009
051100         10  MR-ARRIVAL-DATE-TIMEH      PIC  X(01).               05110009
051200         10  MR-ARRIVAL-DATE-TIME       PIC  X(08).               05120009
051300                                                                  05130009
051400         10  MR-NOTIFICATION-DATE-TIMEL PIC S9(04) COMP.          05140009
051500         10  MR-NOTIFICATION-DATE-TIMEA PIC  X(01).               05150009
051600         10  MR-NOTIFICATION-DATE-TIMEC PIC  X(01).               05160009
051700         10  MR-NOTIFICATION-DATE-TIMEH PIC  X(01).               05170009
051800         10  MR-NOTIFICATION-DATE-TIME  PIC  X(08).               05180009
051900                                                                  05190009
052000         10  MR-RESPONSE-DATE-TIMEL     PIC S9(04) COMP.          05200009
052100         10  MR-RESPONSE-DATE-TIMEA     PIC  X(01).               05210009
052200         10  MR-RESPONSE-DATE-TIMEC     PIC  X(01).               05220009
052300         10  MR-RESPONSE-DATE-TIMEH     PIC  X(01).               05230009
052400         10  MR-RESPONSE-DATE-TIME      PIC  X(08).               05240009
052500                                                                  05250009
052600     EJECT                                                        05260009
052700*---------------------------------------------------------------* 05270009
052800*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05280009
052900*---------------------------------------------------------------* 05290009
053000                                                                  05300009
053100     COPY DPWS015.                                                05310009
053200                                                                  05320009
053300*---------------------------------------------------------------* 05330009
053400*    FUNCTION KEYS COPYBOOK.                                    * 05340009
053500*---------------------------------------------------------------* 05350009
053600                                                                  05360009
053700     COPY DPWS016.                                                05370009
053800                                                                  05380009
053900*---------------------------------------------------------------* 05390009
054000*    NUMERIC EDIT LAYOUT.                                       * 05400009
054100*---------------------------------------------------------------* 05410009
054200                                                                  05420009
054300     COPY DPWS010I.                                               05430009
054400 EJECT                                                            05440009
054500*---------------------------------------------------------------* 05450009
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 05460009
054700*---------------------------------------------------------------* 05470009
054800                                                                  05480009
054900     COPY DPWS030.                                                05490009
CICS       COPY DPWS930.                                                05490009
055000 EJECT                                                            05500009
055100*---------------------------------------------------------------* 05510009
055200*    PARAMETERS FOR CALLING THE TROUBLE CENTRAL PROCESSING      * 05520009
055300*    MODULE (TMKCS520).                                         * 05530009
055400*---------------------------------------------------------------* 05540009
055500                                                                  05550009
055600     COPY TMWS500.                                                05560009
055700 EJECT                                                            05570009
055800*---------------------------------------------------------------* 05580009
055900*    STANDARD COMMAREA.                                         * 05590009
056000*---------------------------------------------------------------* 05600009
056100                                                                  05610009
056200     COPY DPWS020.                                                05620009
056300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05630009
056400                                                                  05640009
056500*---------------------------------------------------------------* 05650009
056600* INTER-APPLICATION COMMAREA.                                   * 05660009
056700*   TMWS006 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 05670009
056800*             SPEC SCREEN FOR IMPORT EXCEPTIONS                 * 05680009
056900*---------------------------------------------------------------* 05690009
057000                                                                  05700009
057100         10  INTER-APPL-COMM-AREA       PIC X(200).               05710009
057200     COPY TMWS006.                                                05720009
057300     COPY POWS011.                                                05730009
057400     COPY POWS017.                                                05740009
057500     COPY POWS013.                                                05750009
057600     COPY TRWS105.                                                05750009
058100                                                                  05810009
058200*---------------------------------------------------------------* 05820009
058300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05830009
058400*---------------------------------------------------------------* 05840009
058500         10  ASC-SPECIFIC-COMMAREA.                               05850009
058600             15  ASC-LOCAL-GO-DESTINATION            PIC X(01).   05860009
058700                 88  ASC-STAYING-WITHIN-TROUBLE      VALUE ' '.   05870009
058800                 88  ASC-GOING-TO-PO                 VALUE '1'.   05880009
058900                 88  ASC-RETURNING-FROM-PO           VALUE '1'.   05890009
059100             15  ASC-KEY-FIELDS.                                  05910009
059200                 20  ASC-KEY-OPER-UNT-ID             PIC 9(04).   05920009
059300                 20  ASC-KEY-FCLTY-ID                PIC 9(04).   05930009
059400                 20  ASC-KEY-PO-NBR                  PIC 9(08).   05940009
059500                 20  ASC-KEY-DEPT                    PIC X(03).   05950009
059600                 20  ASC-KEY-BUYER                   PIC 9(02).   05960009
059700                 20  ASC-KEY-DMM                     PIC 9(02).   05970009
059710                 20  ASC-KEY-FOB-CDE                 PIC X(04).   05971015
059720                 20  ASC-KEY-POE-CDE                 PIC X(03).   05972015
059730                 20  ASC-KEY-OTB                     PIC X(04).   05973015
059740                 20  ASC-KEY-ALL-TRBL                PIC X(04).           
059800                 20  ASC-LIST-SEQ-SW                 PIC X(01).   05980009
059900                     88  ASC-LS-PO                   VALUE 'P'.   05990029
060000                     88  ASC-LS-OLDEST-TRBL          VALUE 'O'.   06000009
060100                 20  ASC-RESPONSIBILITY-AREA-SW      PIC X(01).   06010009
060200                     88  ASC-RA-BUY-ANALYST-SW       VALUE 'Y'.   06020009
060300                     88  ASC-RA-BUY-ANALYST-DC-SW    VALUE 'A'.   06030009
060400                     88  ASC-RA-DC-SW                VALUE 'D'.   06040009
060500                 20  ASC-RESPONSIBILITY-AREA.                     06050009
060600                     25  ASC-RA-BUYER               PIC X(01).    06060009
060700                     25  ASC-RA-ANALYST             PIC X(01).    06070009
060800                     25  ASC-RA-BUYER-ANALYST       PIC X(01).    06080009
060900                     25  ASC-RA-DC                  PIC X(01).    06090009
061000                 20  ASC-KEY-ENT-ID                  PIC 9(09).   06100009
061100                 20  ASC-TRBL-REASON-LOW             PIC 9(03).   06110009
061200                 20  ASC-TRBL-REASON-HIGH            PIC 9(03).   06120009
061300                 20  ASC-NOTIF-STAT                  PIC X(01).   06130009
061400                     88  ASC-ALL-NOTIF-STATS         VALUE ' '.   06140009
061500                     88  ASC-RESOLVD-STAT-ONLY       VALUE 'R'.   06150009
061600                     88  ASC-UNRSLVD-STAT-ONLY       VALUE 'U'.   06160009
061700                 20  ASC-RCVR-STATUS-SW              PIC X(01).   06170009
061800                     88  ASC-RCVR-STAT-ARR-ENR       VALUE 'B'.   06180009
061900                     88  ASC-RCVR-STAT-ARRIVED       VALUE 'A'.   06190009
062000                     88  ASC-RCVR-STAT-ENROUTE       VALUE 'E'.   06200009
062100             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06210009
062200                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06220009
062300                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06230009
062400                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06240009
062500                 20  ASC-ITEM-ARRAY.                              06250009
062600                     25  ASC-ITEM-ENTRIES OCCURS 13 TIMES.        06260009
062700                         30  ASC-LIST-ITEM-NUMBER                 06270009
062800                                                     PIC S9(09)   06280009
062900                                                     COMP-3.      06290009
063000                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06300009
063100                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06310009
063200                             88  ASC-TEMP-SELECT     VALUE 'S'.   06320009
063300                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06330009
063400                             88  ASC-TEMP-END        VALUE 'E'.   06340009
063500                         30  ASC-SELECTED-SW         PIC  X(01).  06350009
063600                             88  ASC-NO-SELECT       VALUE ' '.   06360009
063700                             88  ASC-SELECT          VALUE 'S'.   06370009
063800                             88  ASC-BEGIN           VALUE 'B'.   06380009
063900                             88  ASC-END             VALUE 'E'.   06390009
064000                         30  ASC-ACTION              PIC  X(03).  06400009
064100                         30  ASC-NOTIF-NBR           PIC S9(09)   06410009
064200                                                          COMP.   06420009
064300                         30  ASC-OPER-UNT-ID         PIC S9(04)   06430009
064400                                                          COMP.   06440009
064500                         30  ASC-FCLTY-ID            PIC S9(04)   06450009
064600                                                          COMP.   06460009
064700                         30  ASC-DEPT-NBR            PIC  9(03).  06470009
064700*TV 10/10/2014 CHANGE STARTS                                      06470009
064800                         30  ASC-PO-NBR-N            PIC  9(08).  06480009
064700*TV 10/10/2014 CHANGE ENDS                                        06470009
064900                         30  ASC-RCVR-SEQ-NBR-N      PIC  9(04).  06490009
065000                         30  ASC-PO-LNE-NBR-N        PIC  9(04).  06500009
065100                         30  ASC-ENT-ID              PIC S9(09)   06510009
065200                                                          COMP.   06520009
065300                         30  ASC-VENDOR-SHORT-NME    PIC  X(10).  06530009
065400                         30  ASC-FOB-POE-CDE         PIC  X(04).  06540009
065500                         30  ASC-TROUBLE-REASON-CDE  PIC S9(04)   06550009
065600                                                          COMP.   06560009
065700                         30  ASC-TROUBLE-REASON-DESC PIC  X(10).  06570009
065800                         30  ASC-TROUBLE-RESP-RES-IND             06580009
065900                                                     PIC  X(01).  06590009
066000                         30  ASC-TROUBLE-REASON-LVL  PIC  X(01).  06600009
066100                         30  ASC-ARRIVAL-DATE-TIME   PIC  X(08).  06610009
066200                         30  ASC-NOTIFICATION-DATE-TIME           06620009
066300                                                     PIC  X(08).  06630009
066400                         30  ASC-RESPONSE-DATE-TIME  PIC  X(08).  06640009
066500                         30  ASC-TRBL-DTL-EXISTS-SW  PIC  X(01).  06650009
066600                             88  ASC-TRBL-DTL-EXISTS VALUE 'Y'.   06660009
066700                             88  ASC-NO-TRBL-DTL-EXISTS           06670009
066800                                                     VALUE 'N'.   06680009
066900                         30  ASC-TRBL-RESOLVED-SW    PIC  X(01).  06690009
067000                             88  ASC-TRBL-RESOLVED   VALUE 'Y'.   06700009
067100                             88  ASC-TRBL-NOT-RESOLVED            06710009
067200                                                     VALUE 'N'.   06720009
067210                         30  ASC-TRBL-ACK-SW         PIC  X(01).  06721009
067220                             88  ASC-TRBL-ACK        VALUE 'Y'.   06722009
067230                             88  ASC-TRBL-NOT-ACK    VALUE 'N'.   06723009
067300             15  ASC-BLK-SUB                         PIC S9(04)   06730009
067400                                                          COMP    06740009
067500                                                          SYNC.   06750009
067600             15  ASC-SEL-SUB                         PIC S9(04)   06760009
067700                                                         COMP.    06770009
067800             15  ASC-SEL-ITEM                        PIC S9(04)   06780009
067900                                                         COMP.    06790009
068000             15  ASC-ITEM-SUB                        PIC S9(04)   06800009
068100                                                          COMP    06810009
068200                                                          SYNC.   06820009
068300             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   06830009
068400                                                          COMP-3. 06840009
068500             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   06850009
068600                                                          COMP-3. 06860009
068700             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   06870009
068800                                                          COMP-3. 06880009
068900             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   06890009
069000                                                          COMP-3. 06900009
069100             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   06910009
069200                                                          COMP-3. 06920009
069300             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   06930009
069400                                                          COMP-3. 06940009
069500             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   06950009
069600                                                          COMP    06960009
069700                                                          SYNC.   06970009
069800             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   06980009
069900                                                          COMP-3. 06990009
070000             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   07000009
070100                                                          COMP-3. 07010009
070200             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  07020009
070300                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   07030009
070400                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   07040009
070500             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  07050009
070600                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   07060009
070700                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   07070009
070800             15  ASC-LIST-QUEUE-NAME.                             07080009
070900                 20  ASC-LIST-TERM-ID                PIC  X(04).  07090009
071000                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   07100009
071100                                                          COMP-3. 07110009
071200                 20  ASC-LIST-SEQ                    PIC  9(01).  07120009
071300             15  ASC-SEL-QUEUE-OUT.                               07130009
071400                 20  ASC-SEL-TERM-ID                 PIC  X(04).  07140009
071500                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   07150009
071600                                                          COMP-3. 07160009
071700                 20  ASC-SEL-SEQ                     PIC  9(01).  07170009
071800             15  ASC-SEL-QUEUE-IN                    PIC  X(08).  07180009
071900             15  ASC-START-ITEM-REQUEST.                          07190009
072000                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  07200009
072100             15  ASC-KEY-REC-SEQ-NBR           PIC S9(09) COMP.   07210009
072200             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(01).   07220009
072300                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   07230009
073100                                                                  07310009
073200*---------------------------------------------------------------* 07320009
073300*    ABEND PROCESSING COPYBOOK.                                 * 07330009
073400*---------------------------------------------------------------* 07340009
073500                                                                  07350009
073600     COPY DPWS013.                                                07360009
073700                                                                  07370009
073800*---------------------------------------------------------------* 07380009
073900*    DB2 AREA FOR TTRBNTF - TROUBLE NOTIFICATION                * 07390009
074000*---------------------------------------------------------------* 07400009
074100     EXEC SQL                                                     07410009
074200          INCLUDE TTRBNTF                                         07420009
074300     END-EXEC.                                                    07430009
074310*---------------------------------------------------------------* 07380009
074320*    DB2 AREA FOR TTRBDTL - TROUBLE NOTIFICATION DETAIL         * 07390009
074330*---------------------------------------------------------------* 07400009
074340     EXEC SQL                                                     07410009
074350          INCLUDE TTRBDTL                                         07420009
074360     END-EXEC.                                                    07430009
074400*---------------------------------------------------------------* 07440009
074500*    DB2 AREA FOR TTRBRSN - TROUBLE REASON                      * 07450009
074600*---------------------------------------------------------------* 07460009
074700     EXEC SQL                                                     07470009
074800          INCLUDE TTRBRSN                                         07480009
074900     END-EXEC.                                                    07490009
075600*---------------------------------------------------------------* 07560009
075700*    DB2 AREA FOR TENTNME - ENTITY NAME                         * 07570009
075800*---------------------------------------------------------------* 07580009
075900     EXEC SQL                                                     07590009
076000          INCLUDE TENTNME                                         07600009
076100     END-EXEC.                                                    07610009
076200*---------------------------------------------------------------* 07620009
076300*    DB2 AREA FOR TPURCHS - PURCHASE ORDER HEADER TABLE         * 07630009
076400*---------------------------------------------------------------* 07640009
076500     EXEC SQL                                                     07650009
076600          INCLUDE TPURCHS                                         07660009
076700     END-EXEC.                                                    07670009
077400*---------------------------------------------------------------* 07740009
077500*    DB2 AREA FOR TMDSEAR - MERCHANDISE AREA TABLE              * 07750009
077600*---------------------------------------------------------------* 07760009
077700     EXEC SQL                                                     07770009
077800          INCLUDE TMDSEAR                                         07780009
077900     END-EXEC.                                                    07790009
078600*---------------------------------------------------------------* 07860009
078700*    DB2 AREA FOR TSHPTPO - SHIPPED PO TABLE                    * 07870009
078800*---------------------------------------------------------------* 07880009
078900     EXEC SQL                                                     07890009
079000          INCLUDE TSHPTPO                                         07900009
079100     END-EXEC.                                                    07910009
079200*---------------------------------------------------------------* 07920009
079300*    DB2 AREA FOR TSHIPMT - SHIPMENT TABLE                      * 07930009
079400*---------------------------------------------------------------* 07940009
079500     EXEC SQL                                                     07950009
079600          INCLUDE TSHIPMT                                         07960009
079700     END-EXEC.                                                    07970009
079710*---------------------------------------------------------------* 07971024
079720*    DB2 AREA FOR TPLNSHP - PLANNED SHIPMENT TABLE              * 07972024
079730*---------------------------------------------------------------* 07973024
079740     EXEC SQL                                                     07974024
079750          INCLUDE TPLNSHP                                         07975024
079760     END-EXEC.                                                    07976024
079770*---------------------------------------------------------------* 07971024
079780*    DB2 AREA FOR TEXTENT - EXTERNAL ENTITY TABLE               * 07972024
079790*---------------------------------------------------------------* 07973024
079791     EXEC SQL                                                     07974024
079792          INCLUDE TEXTENT                                         07975024
079793     END-EXEC.                                                    07976024
079800*---------------------------------------------------------------* 07980009
079900*    DB2 AREA FOR COMMUNICATIONS                                * 07990009
080000*---------------------------------------------------------------* 08000009
080100     EXEC SQL                                                     08010009
080200          INCLUDE SQLCA                                           08020009
080300     END-EXEC.                                                    08030009
080400                                                                  08040009
086410*---------------------------------------------------------------* 08641013
086420*    DEPARTMENT CURSOR FOR A SPECIFIED DEPARTMENT               * 08642013
086430*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 08643013
086440*    THE CURSOR.                                                * 08644013
086450*    THE RESULTS OF THIS CURSOR WILL BE IN PO NUMBER ORDER.     * 08645013
086460*---------------------------------------------------------------* 08646013
086470                                                                  08647013
086480      EXEC SQL                                                    08648033
086490           DECLARE DEPT_BY_PO CURSOR                              08649033
086491           FOR SELECT                                             08649133
086494                 A.NOTIF_NBR                                      08649433
086495               , A.OPER_UNT_ID                                    08649533
086496               , A.FCLTY_ID                                       08649633
086497               , A.DEPT_NBR                                       08649733
086498               , A.ENT_ID                                         08649833
086499               , A.PO_NBR                                         08649933
086500               , A.PO_LNE_NBR                                     08650033
086501               , A.REC_SEQ_NBR                                    08650133
086502               , A.TRBL_RSN_CDE                                   08650233
086503               , A.NOTIF_TMST                                     08650333
086504               , A.RESOLVED_IND                                   08650433
086505               , A.RESOLVED_TMST                                  08650533
086506               , A.ACKNOWLG_TMST                                  08650633
086507               , A.LAST_DTL_CRE_TMST                                      
086508               , A.INITR_ENT_ID                                   08650933
086509               , A.FOB_CDE                                                
086510               , A.POE_CDE                                                
086511               , B.TRBL_SHT_DESC                                  08650733
086512               , B.RESP_RES_IND                                   08650833
086513               , B.TRBL_LVL_IND                                   08650933
086514           FROM                                                   08651233
086515                 TTRBNTF A                                        08651333
086516               , TTRBRSN B                                        08651433
086517          WHERE                                                   08651533
086518                 A.RESOLVED_IND      IN (:DK-NOTIF-STAT-1         08651833
086519                                       , :DK-NOTIF-STAT-2         08651933
086520                                       , :DK-NOTIF-STAT-3         08652033
086521                                       , :DK-NOTIF-STAT-4)        08652133
086522             AND A.TRBL_RSN_CDE  BETWEEN :DK-TRBL-RSN-LOW         08652233
086523                                     AND :DK-TRBL-RSN-HIGH        08652333
086524             AND B.RSLV_RSPNT_CDE    IN (:DK-RESP-AREA-1          08652433
086525                                       , :DK-RESP-AREA-2          08652533
086526                                       , :DK-RESP-AREA-3)         08652633
086527             AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE          08652733
086528             AND A.DEPT_NBR            = :DK-DEPT-NBR             08652833
086531          ORDER BY                                                08653033
086532                A.PO_NBR                                          08653133
086533              , A.NOTIF_TMST                                      08653234
086535      END-EXEC.                                                   08653533
086536                                                                  08653613
086597*---------------------------------------------------------------* 08659713
086598*    BUYER CURSOR FOR A SPECIFIED BUYER                         * 08659813
086599*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 08659913
086600*    THE CURSOR.                                                * 08660013
086601*    THE RESULTS OF THIS CURSOR WILL BE IN PO NUMBER ORDER.     * 08660113
086602*---------------------------------------------------------------* 08660213
086603                                                                  08660313
086604      EXEC SQL                                                    08660413
086605           DECLARE BUYER_BY_PO CURSOR                             08660521
086606           FOR SELECT                                             08660613
086609                 A.NOTIF_NBR                                      08649433
086610               , A.OPER_UNT_ID                                    08649533
086611               , A.FCLTY_ID                                       08649633
086612               , A.DEPT_NBR                                       08649733
086613               , A.ENT_ID                                         08649833
086614               , A.PO_NBR                                         08649933
086615               , A.PO_LNE_NBR                                     08650033
086616               , A.REC_SEQ_NBR                                    08650133
086617               , A.TRBL_RSN_CDE                                   08650233
086618               , A.NOTIF_TMST                                     08650333
086619               , A.RESOLVED_IND                                   08650433
086620               , A.RESOLVED_TMST                                  08650533
086621               , A.ACKNOWLG_TMST                                  08650633
086622               , A.LAST_DTL_CRE_TMST                                      
086623               , A.INITR_ENT_ID                                   08650933
086624               , A.FOB_CDE                                                
086625               , A.POE_CDE                                                
086626               , B.TRBL_SHT_DESC                                  08650733
086627               , B.RESP_RES_IND                                   08650833
086628               , B.TRBL_LVL_IND                                   08650933
086629           FROM                                                   08660913
086630                 TTRBNTF A                                        08661013
086631               , TTRBRSN B                                        08661213
086632               , TMDSEAR C                                        08661113
086633          WHERE                                                   08661318
086800                 A.RESOLVED_IND      IN (:DK-NOTIF-STAT-1         08680018
086900                                       , :DK-NOTIF-STAT-2         08690018
087000                                       , :DK-NOTIF-STAT-3         08700013
087100                                       , :DK-NOTIF-STAT-4)        08710018
087200             AND A.TRBL_RSN_CDE  BETWEEN :DK-TRBL-RSN-LOW         08720013
087300                                     AND :DK-TRBL-RSN-HIGH        08730013
087400             AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE          08740013
087500             AND A.DEPT_NBR            =  C.DEPT_NBR              08750013
087600             AND C.BYR_NBR             = :DK-BUYER-NBR            08760013
087700             AND C.STRT_DTE           <=  CURRENT DATE            08770013
087800             AND C.END_DTE            >=  CURRENT DATE            08780013
087900             AND B.RSLV_RSPNT_CDE    IN (:DK-RESP-AREA-1          08790013
088000                                       , :DK-RESP-AREA-2          08800013
088100                                       , :DK-RESP-AREA-3)         08810013
088110          ORDER BY                                                08653033
088120                A.PO_NBR                                          08653133
088130              , A.NOTIF_TMST                                      08653234
088600      END-EXEC.                                                   08860013
088700                                                                  08870013
099500*---------------------------------------------------------------* 09950009
099600*    PO CURSOR FOR A SPECIFIED PURCHASE ORDER.                  * 09960013
099700*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 09970009
099800*    THE CURSOR.                                                * 09980009
099900*    THE RESULTS OF THIS CURSOR WILL BE IN PO NUMBER ORDER.     * 09990013
100000*---------------------------------------------------------------* 10000009
100100                                                                  10010009
100110      EXEC SQL                                                    10011013
100120           DECLARE PO_BY_PO CURSOR                                10012021
100130           FOR SELECT                                             10013013
100151                 A.NOTIF_NBR                                      08649433
100152               , A.OPER_UNT_ID                                    08649533
100153               , A.FCLTY_ID                                       08649633
100154               , A.DEPT_NBR                                       08649733
100155               , A.ENT_ID                                         08649833
100156               , A.PO_NBR                                         08649933
100157               , A.PO_LNE_NBR                                     08650033
100158               , A.REC_SEQ_NBR                                    08650133
100159               , A.TRBL_RSN_CDE                                   08650233
100160               , A.NOTIF_TMST                                     08650333
100161               , A.RESOLVED_IND                                   08650433
100162               , A.RESOLVED_TMST                                  08650533
100163               , A.ACKNOWLG_TMST                                  08650633
100164               , A.LAST_DTL_CRE_TMST                                      
100165               , A.INITR_ENT_ID                                   08650933
100166               , A.FOB_CDE                                                
100167               , A.POE_CDE                                                
100168               , B.TRBL_SHT_DESC                                  08650733
100169               , B.RESP_RES_IND                                   08650833
100170               , B.TRBL_LVL_IND                                   08650933
100171           FROM                                                   10016013
100172                 TTRBNTF A                                        10017013
100180               , TTRBRSN B                                        10018013
100190          WHERE                                                   10019013
100191                 A.PO_NBR              = :DK-PO-NBR               10019113
100192             AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE          10019213
100193             AND A.RESOLVED_IND      IN (:DK-NOTIF-STAT-1         10019313
100194                                       , :DK-NOTIF-STAT-2         10019413
100195                                       , :DK-NOTIF-STAT-3         10019513
100196                                       , :DK-NOTIF-STAT-4)        10019613
100197             AND B.RSLV_RSPNT_CDE    IN (:DK-RESP-AREA-1          10019713
100198                                       , :DK-RESP-AREA-2          10019813
100199                                       , :DK-RESP-AREA-3)         10019913
100200          ORDER BY                                                08653033
100201                A.PO_NBR                                          08653133
100202              , A.NOTIF_TMST                                      08653234
100207      END-EXEC.                                                   10020413
100208                                                                  10020513
100211*---------------------------------------------------------------* 10021113
100212*    FOB CURSOR FOR A SPECIFIED FOB CODE.                       * 10021214
100213*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 10021313
100214*    THE CURSOR.                                                * 10021413
100215*    THE RESULTS OF THIS CURSOR WILL BE IN PO NUMBER ORDER.     * 10021513
100216*---------------------------------------------------------------* 10021613
100217                                                                  10021713
100220       EXEC SQL                                                   10022013
100230           DECLARE FOB_BY_PO CURSOR                               10023021
100240           FOR SELECT                                             10024013
100261                 A.NOTIF_NBR                                      08649433
100262               , A.OPER_UNT_ID                                    08649533
100263               , A.FCLTY_ID                                       08649633
100264               , A.DEPT_NBR                                       08649733
100265               , A.ENT_ID                                         08649833
100266               , A.PO_NBR                                         08649933
100267               , A.PO_LNE_NBR                                     08650033
100268               , A.REC_SEQ_NBR                                    08650133
100269               , A.TRBL_RSN_CDE                                   08650233
100270               , A.NOTIF_TMST                                     08650333
100271               , A.RESOLVED_IND                                   08650433
100272               , A.RESOLVED_TMST                                  08650533
100273               , A.ACKNOWLG_TMST                                  08650633
100274               , A.LAST_DTL_CRE_TMST                                      
100275               , A.INITR_ENT_ID                                   08650933
100276               , A.FOB_CDE                                                
100277               , A.POE_CDE                                                
100278               , B.TRBL_SHT_DESC                                  08650733
100279               , B.RESP_RES_IND                                   08650833
100280               , B.TRBL_LVL_IND                                   08650933
100281           FROM                                                   10027013
100282                 TTRBNTF A                                        10028013
100290               , TTRBRSN B                                        10029013
100300               , TPLNSHP C                                        10030013
100400          WHERE                                                   10040013
100700                 A.PO_NBR         =      C.PO_NBR                 10070013
100800             AND C.VER_STATUS_CDE =      'A'                      10080013
100900             AND C.FOB_CDE        =      :DK-FOB-CDE              10090013
101000             AND A.RESOLVED_IND      IN (:DK-NOTIF-STAT-1         10100013
101100                                       , :DK-NOTIF-STAT-2         10110013
101200                                       , :DK-NOTIF-STAT-3         10120013
101300                                       , :DK-NOTIF-STAT-4)        10130013
101400             AND A.TRBL_RSN_CDE  BETWEEN :DK-TRBL-RSN-LOW         10140013
101500                                     AND :DK-TRBL-RSN-HIGH        10150013
101600             AND B.RSLV_RSPNT_CDE    IN (:DK-RESP-AREA-1          10160013
101700                                       , :DK-RESP-AREA-2          10170013
101800                                       , :DK-RESP-AREA-3)         10180013
101900             AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE          10190013
102110          ORDER BY                                                08653033
102120                A.PO_NBR                                          08653133
102130              , A.NOTIF_TMST                                      08653234
102600       END-EXEC.                                                  10260013
102700                                                                  10270013
103210*---------------------------------------------------------------* 10321013
103220*    POE CURSOR FOR A SPECIFIED POE CODE.                       * 10322014
103230*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 10323013
103240*    THE CURSOR.                                                * 10324013
103250*    THE RESULTS OF THIS CURSOR WILL BE IN PO NUMBER ORDER.     * 10325013
103260*---------------------------------------------------------------* 10326013
103270                                                                  10327013
103300       EXEC SQL                                                   10330013
103400           DECLARE POE_BY_PO CURSOR                               10340021
103500           FOR SELECT                                             10350013
103710                 A.NOTIF_NBR                                      08649433
103720               , A.OPER_UNT_ID                                    08649533
103730               , A.FCLTY_ID                                       08649633
103740               , A.DEPT_NBR                                       08649733
103750               , A.ENT_ID                                         08649833
103760               , A.PO_NBR                                         08649933
103770               , A.PO_LNE_NBR                                     08650033
103780               , A.REC_SEQ_NBR                                    08650133
103790               , A.TRBL_RSN_CDE                                   08650233
103791               , A.NOTIF_TMST                                     08650333
103792               , A.RESOLVED_IND                                   08650433
103793               , A.RESOLVED_TMST                                  08650533
103794               , A.ACKNOWLG_TMST                                  08650633
103795               , A.LAST_DTL_CRE_TMST                                      
103796               , A.INITR_ENT_ID                                   08650933
103797               , A.FOB_CDE                                                
103798               , A.POE_CDE                                                
103799               , B.TRBL_SHT_DESC                                  08650733
103800               , B.RESP_RES_IND                                   08650833
103801               , B.TRBL_LVL_IND                                   08650933
103810           FROM                                                   10380013
103900                 TTRBNTF A                                        10390013
104000               , TTRBRSN B                                        10400013
104100               , TPLNSHP C                                        10410013
104200          WHERE                                                   10420013
104500                 A.PO_NBR         =      C.PO_NBR                 10450013
104600             AND C.VER_STATUS_CDE =      'A'                      10460013
104700             AND C.POE_CDE        =      :DK-POE-CDE              10470013
104800             AND A.RESOLVED_IND      IN (:DK-NOTIF-STAT-1         10480013
104900                                       , :DK-NOTIF-STAT-2         10490013
105000                                       , :DK-NOTIF-STAT-3         10500013
105100                                       , :DK-NOTIF-STAT-4)        10510013
105200             AND A.TRBL_RSN_CDE  BETWEEN :DK-TRBL-RSN-LOW         10520013
105300                                     AND :DK-TRBL-RSN-HIGH        10530013
105310             AND B.RSLV_RSPNT_CDE    IN (:DK-RESP-AREA-1          10531013
105320                                       , :DK-RESP-AREA-2          10532013
105330                                       , :DK-RESP-AREA-3)         10533013
105340             AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE          10534013
105361          ORDER BY                                                08653033
105362                A.PO_NBR                                          08653133
105363              , A.NOTIF_TMST                                      08653234
105392       END-EXEC.                                                  10539213
105393                                                                  10539313
105399*---------------------------------------------------------------* 10539913
105400*    OTB CURSOR FOR A SPECIFIED OTB.                            * 10540014
105401*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 10540113
105402*    THE CURSOR.                                                * 10540213
105403*    THE RESULTS OF THIS CURSOR WILL BE IN PO NUMBER ORDER.     * 10540313
105404*---------------------------------------------------------------* 10540413
105405                                                                  10540513
105406       EXEC SQL                                                   10540613
105407           DECLARE OTB_BY_PO CURSOR                               10540721
105408           FOR SELECT                                             10540813
105411                 A.NOTIF_NBR                                      08649433
105412               , A.OPER_UNT_ID                                    08649533
105413               , A.FCLTY_ID                                       08649633
105414               , A.DEPT_NBR                                       08649733
105415               , A.ENT_ID                                         08649833
105416               , A.PO_NBR                                         08649933
105417               , A.PO_LNE_NBR                                     08650033
105418               , A.REC_SEQ_NBR                                    08650133
105419               , A.TRBL_RSN_CDE                                   08650233
105420               , A.NOTIF_TMST                                     08650333
105421               , A.RESOLVED_IND                                   08650433
105422               , A.RESOLVED_TMST                                  08650533
105423               , A.ACKNOWLG_TMST                                  08650633
105424               , A.LAST_DTL_CRE_TMST                                      
105425               , A.INITR_ENT_ID                                   08650933
105426               , A.FOB_CDE                                                
105427               , A.POE_CDE                                                
105428               , B.TRBL_SHT_DESC                                  08650733
105429               , B.RESP_RES_IND                                   08650833
105430               , B.TRBL_LVL_IND                                   08650933
105431           FROM                                                   10541113
105432                 TTRBNTF A                                        10541213
105433               , TTRBRSN B                                        10541313
105434               , TPURCHS C                                        10541413
105435          WHERE                                                   10541513
105436                 A.PO_NBR         =      C.PO_NBR                 10541813
105437             AND C.VER_STATUS_CDE =      'A'                      10541913
105438             AND C.OTB_PER_NBR    =      :DK-OTB-PER-NBR-ALL      10542013
105439             AND A.RESOLVED_IND      IN (:DK-NOTIF-STAT-1         10542113
105440                                       , :DK-NOTIF-STAT-2         10542213
105441                                       , :DK-NOTIF-STAT-3         10542313
105442                                       , :DK-NOTIF-STAT-4)        10542413
105443             AND A.TRBL_RSN_CDE  BETWEEN :DK-TRBL-RSN-LOW         10542513
105444                                     AND :DK-TRBL-RSN-HIGH        10542613
105445             AND B.RSLV_RSPNT_CDE    IN (:DK-RESP-AREA-1          10542713
105446                                       , :DK-RESP-AREA-2          10542813
105447                                       , :DK-RESP-AREA-3)         10542913
105448             AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE          10543013
105451          ORDER BY                                                08653033
105452                A.PO_NBR                                          08653133
105453              , A.NOTIF_TMST                                      08653234
105456      END-EXEC.                                                   10543713
105457                                                                  10544014
105458*---------------------------------------------------------------* 10545022
105460*    CURSOR TO SELECT ALL TROUBLE.                              * 10546022
105470*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 10547022
105480*    THE CURSOR.                                                * 10548022
105490*    THE RESULTS OF THIS CURSOR WILL BE IN PO NUMBER ORDER.     * 10549022
105491*---------------------------------------------------------------* 10549122
105492                                                                  10549222
105493       EXEC SQL                                                   10549322
105494           DECLARE ALL_BY_PO CURSOR                               10549422
105495           FOR SELECT                                             10549522
105498                 A.NOTIF_NBR                                      08649433
105499               , A.OPER_UNT_ID                                    08649533
105500               , A.FCLTY_ID                                       08649633
105501               , A.DEPT_NBR                                       08649733
105502               , A.ENT_ID                                         08649833
105503               , A.PO_NBR                                         08649933
105504               , A.PO_LNE_NBR                                     08650033
105505               , A.REC_SEQ_NBR                                    08650133
105506               , A.TRBL_RSN_CDE                                   08650233
105507               , A.NOTIF_TMST                                     08650333
105508               , A.RESOLVED_IND                                   08650433
105509               , A.RESOLVED_TMST                                  08650533
105510               , A.ACKNOWLG_TMST                                  08650633
105511               , A.LAST_DTL_CRE_TMST                                      
105512               , A.INITR_ENT_ID                                   08650933
105513               , A.FOB_CDE                                                
105514               , A.POE_CDE                                                
105515               , B.TRBL_SHT_DESC                                  08650733
105516               , B.RESP_RES_IND                                   08650833
105517               , B.TRBL_LVL_IND                                   08650933
105518           FROM                                                   10549822
105519                 TTRBNTF A                                        10549922
105520               , TTRBRSN B                                        10550022
105521          WHERE                                                   10550222
105524                 A.RESOLVED_IND      IN (:DK-NOTIF-STAT-1         10550822
105525                                       , :DK-NOTIF-STAT-2         10550922
105526                                       , :DK-NOTIF-STAT-3         10551022
105527                                       , :DK-NOTIF-STAT-4)        10551122
105528             AND A.TRBL_RSN_CDE  BETWEEN :DK-TRBL-RSN-LOW         10551222
105529                                     AND :DK-TRBL-RSN-HIGH        10551322
105530             AND B.RSLV_RSPNT_CDE    IN (:DK-RESP-AREA-1          10551422
105531                                       , :DK-RESP-AREA-2          10551522
105532                                       , :DK-RESP-AREA-3)         10551622
105533             AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE          10551722
105535          ORDER BY                                                08653033
105536                A.PO_NBR                                          08653133
105537              , A.NOTIF_TMST                                      08653234
105541       END-EXEC.                                                  10552422
105542                                                                  10552522
111500*---------------------------------------------------------------* 11150009
111600*    DEPARTMENT CURSOR FOR A SPECIFIED DEPARTMENT               * 11160009
111700*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 11170009
111800*    THE CURSOR.                                                * 11180009
111900*    THE RESULTS OF THIS CURSOR WILL BE IN OLDEST TO NEWEST TRBL* 11190009
112000*---------------------------------------------------------------* 11200009
112100                                                                  11210009
112200     EXEC SQL                                                     11220009
112300          DECLARE DEPT_BY_TRBL CURSOR                             11230021
112400          FOR SELECT                                              11240009
112500                    A.NOTIF_NBR                                   11250009
112600                  , A.OPER_UNT_ID                                 11260009
112700                  , A.FCLTY_ID                                    11270009
112800                  , A.DEPT_NBR                                    11280009
112900                  , A.ENT_ID                                      11290009
113000                  , A.PO_NBR                                      11300009
113100                  , A.PO_LNE_NBR                                  11310009
113200                  , A.REC_SEQ_NBR                                 11320009
113300                  , A.TRBL_RSN_CDE                                11330009
113400                  , A.NOTIF_TMST                                  11340009
113500                  , A.RESOLVED_IND                                11350009
113600                  , A.RESOLVED_TMST                               11360009
113610                  , A.ACKNOWLG_TMST                               11361009
113611                  , A.LAST_DTL_CRE_TMST                                   
113620                  , A.INITR_ENT_ID                                        
113630                  , A.FOB_CDE                                             
113640                  , A.POE_CDE                                             
113700                  , B.TRBL_SHT_DESC                               11370009
113800                  , B.RESP_RES_IND                                11380009
113900                  , B.TRBL_LVL_IND                                11390009
114200          FROM                                                    11420009
114300                TTRBNTF A                                         11430009
114400              , TTRBRSN B                                         11440009
114500          WHERE                                                   08651533
114530                 A.RESOLVED_IND      IN (:DK-NOTIF-STAT-1         08651833
114540                                       , :DK-NOTIF-STAT-2         08651933
114550                                       , :DK-NOTIF-STAT-3         08652033
114560                                       , :DK-NOTIF-STAT-4)        08652133
114570             AND A.TRBL_RSN_CDE  BETWEEN :DK-TRBL-RSN-LOW         08652233
114580                                     AND :DK-TRBL-RSN-HIGH        08652333
114590             AND B.RSLV_RSPNT_CDE    IN (:DK-RESP-AREA-1          08652433
114591                                       , :DK-RESP-AREA-2          08652533
114592                                       , :DK-RESP-AREA-3)         08652633
114593             AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE          08652733
114594             AND A.DEPT_NBR            = :DK-DEPT-NBR             08652833
117000       ORDER BY A.NOTIF_TMST                                      11700009
117200              , A.PO_NBR                                          11720009
117400              , A.TRBL_RSN_CDE                                    11740009
117500     END-EXEC.                                                    11750009
117600                                                                  11760009
117700*---------------------------------------------------------------* 11770009
117800*    BUYER CURSOR FOR A SPECIFIED BUYER                         * 11780009
117900*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 11790009
118000*    THE CURSOR.                                                * 11800009
118100*    THE RESULTS OF THIS CURSOR WILL BE IN OLDEST TO NEWEST TRBL* 11810009
118200*---------------------------------------------------------------* 11820009
118300                                                                  11830009
118400     EXEC SQL                                                     11840009
118500          DECLARE BUYER_BY_TRBL CURSOR                            11850021
118600          FOR SELECT                                              11860009
118700                    A.NOTIF_NBR                                   11870009
118800                  , A.OPER_UNT_ID                                 11880009
118900                  , A.FCLTY_ID                                    11890009
119000                  , A.DEPT_NBR                                    11900009
119100                  , A.ENT_ID                                      11910009
119200                  , A.PO_NBR                                      11920009
119300                  , A.PO_LNE_NBR                                  11930009
119400                  , A.REC_SEQ_NBR                                 11940009
119500                  , A.TRBL_RSN_CDE                                11950009
119600                  , A.NOTIF_TMST                                  11960009
119700                  , A.RESOLVED_IND                                11970009
119800                  , A.RESOLVED_TMST                               11980009
119810                  , A.ACKNOWLG_TMST                               11981009
119811                  , A.LAST_DTL_CRE_TMST                                   
119820                  , A.INITR_ENT_ID                                        
119830                  , A.FOB_CDE                                             
119840                  , A.POE_CDE                                             
119900                  , B.TRBL_SHT_DESC                               11990009
120000                  , B.RESP_RES_IND                                12000009
120100                  , B.TRBL_LVL_IND                                12010009
120400          FROM                                                    12040009
120500                TTRBNTF A                                         12050009
120510              , TTRBRSN B                                         12070009
120600              , TMDSEAR C                                         12060009
120800          WHERE                                                   08661318
120830                 A.RESOLVED_IND      IN (:DK-NOTIF-STAT-1         08680018
120840                                       , :DK-NOTIF-STAT-2         08690018
120850                                       , :DK-NOTIF-STAT-3         08700013
120860                                       , :DK-NOTIF-STAT-4)        08710018
120870             AND A.TRBL_RSN_CDE  BETWEEN :DK-TRBL-RSN-LOW         08720013
120880                                     AND :DK-TRBL-RSN-HIGH        08730013
120890             AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE          08740013
120891             AND A.DEPT_NBR            =  C.DEPT_NBR              08750013
120892             AND C.BYR_NBR             = :DK-BUYER-NBR            08760013
120893             AND C.STRT_DTE           <=  CURRENT DATE            08770013
120894             AND C.END_DTE            >=  CURRENT DATE            08780013
120895             AND B.RSLV_RSPNT_CDE    IN (:DK-RESP-AREA-1          08790013
120896                                       , :DK-RESP-AREA-2          08800013
120897                                       , :DK-RESP-AREA-3)         08810013
123600       ORDER BY A.NOTIF_TMST                                      11700009
123700              , A.PO_NBR                                          11720009
123710              , A.TRBL_RSN_CDE                                    11740009
124300     END-EXEC.                                                    12430009
124400                                                                  12440009
124500*---------------------------------------------------------------* 12450009
124600*    PO CURSOR FOR A SPECIFIED PURCHASE ORDER.                  * 12460014
124700*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 12470009
124800*    THE CURSOR.                                                * 12480009
124900*    THE RESULTS OF THIS CURSOR WILL BE IN OLDEST TO NEWEST TRBL* 12490009
125000*---------------------------------------------------------------* 12500009
125100                                                                  12510009
125200     EXEC SQL                                                     12520009
125300          DECLARE PO_BY_TRBL CURSOR                               12530021
125400          FOR SELECT                                              12540009
125500                    A.NOTIF_NBR                                   12550009
125600                  , A.OPER_UNT_ID                                 12560009
125700                  , A.FCLTY_ID                                    12570009
125800                  , A.DEPT_NBR                                    12580009
125900                  , A.ENT_ID                                      12590009
126000                  , A.PO_NBR                                      12600009
126100                  , A.PO_LNE_NBR                                  12610009
126200                  , A.REC_SEQ_NBR                                 12620009
126300                  , A.TRBL_RSN_CDE                                12630009
126400                  , A.NOTIF_TMST                                  12640009
126500                  , A.RESOLVED_IND                                12650009
126600                  , A.RESOLVED_TMST                               12660009
126610                  , A.ACKNOWLG_TMST                               12661009
126611                  , A.LAST_DTL_CRE_TMST                                   
126620                  , A.INITR_ENT_ID                                        
126630                  , A.FOB_CDE                                             
126640                  , A.POE_CDE                                             
126700                  , B.TRBL_SHT_DESC                               12670009
126800                  , B.RESP_RES_IND                                12680009
126900                  , B.TRBL_LVL_IND                                12690009
127200          FROM                                                    12720009
127300                TTRBNTF A                                         12730009
127400              , TTRBRSN B                                         12740009
127500          WHERE                                                   10019013
127510                 A.PO_NBR              = :DK-PO-NBR               10019113
127520             AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE          10019213
127530             AND A.RESOLVED_IND      IN (:DK-NOTIF-STAT-1         10019313
127540                                       , :DK-NOTIF-STAT-2         10019413
127550                                       , :DK-NOTIF-STAT-3         10019513
127560                                       , :DK-NOTIF-STAT-4)        10019613
127570             AND B.RSLV_RSPNT_CDE    IN (:DK-RESP-AREA-1          10019713
127580                                       , :DK-RESP-AREA-2          10019813
127590                                       , :DK-RESP-AREA-3)         10019913
129610       ORDER BY A.NOTIF_TMST                                      11700009
129620              , A.PO_NBR                                          11720009
129630              , A.TRBL_RSN_CDE                                    11740009
130200     END-EXEC.                                                    13020009
130300                                                                  13030009
130310*---------------------------------------------------------------* 10021113
130320*    FOB CURSOR FOR A SPECIFIED FOB CODE.                       * 10021214
130330*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 10021313
130340*    THE CURSOR.                                                * 10021413
130341*    THE RESULTS OF THIS CURSOR WILL BE IN OLDEST TO NEWEST TRBL* 12490009
130360*---------------------------------------------------------------* 10021613
130370                                                                  10021713
130380       EXEC SQL                                                   10022013
130390           DECLARE FOB_BY_TRBL CURSOR                             10023021
130391           FOR SELECT                                             10024013
130392                 A.NOTIF_NBR                                      08649433
130393               , A.OPER_UNT_ID                                    08649533
130394               , A.FCLTY_ID                                       08649633
130395               , A.DEPT_NBR                                       08649733
130396               , A.ENT_ID                                         08649833
130397               , A.PO_NBR                                         08649933
130398               , A.PO_LNE_NBR                                     08650033
130399               , A.REC_SEQ_NBR                                    08650133
130400               , A.TRBL_RSN_CDE                                   08650233
130401               , A.NOTIF_TMST                                     08650333
130402               , A.RESOLVED_IND                                   08650433
130403               , A.RESOLVED_TMST                                  08650533
130404               , A.ACKNOWLG_TMST                                  08650633
130405               , A.LAST_DTL_CRE_TMST                                      
130406               , A.INITR_ENT_ID                                           
130407               , A.FOB_CDE                                                
130408               , A.POE_CDE                                                
130409               , B.TRBL_SHT_DESC                                  08650733
130410               , B.RESP_RES_IND                                   08650833
130411               , B.TRBL_LVL_IND                                   08650933
130412           FROM                                                   10027013
130413                 TTRBNTF A                                        10028013
130414               , TTRBRSN B                                        10029013
130415               , TPLNSHP C                                        10030013
130416          WHERE                                                   10040013
130417                 A.PO_NBR         =      C.PO_NBR                 10070013
130418             AND C.VER_STATUS_CDE =      'A'                      10080013
130419             AND C.FOB_CDE        =      :DK-FOB-CDE              10090013
130420             AND A.RESOLVED_IND      IN (:DK-NOTIF-STAT-1         10100013
130421                                       , :DK-NOTIF-STAT-2         10110013
130422                                       , :DK-NOTIF-STAT-3         10120013
130423                                       , :DK-NOTIF-STAT-4)        10130013
130424             AND A.TRBL_RSN_CDE  BETWEEN :DK-TRBL-RSN-LOW         10140013
130425                                     AND :DK-TRBL-RSN-HIGH        10150013
130426             AND B.RSLV_RSPNT_CDE    IN (:DK-RESP-AREA-1          10160013
130427                                       , :DK-RESP-AREA-2          10170013
130428                                       , :DK-RESP-AREA-3)         10180013
130429             AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE          10190013
130448       ORDER BY A.NOTIF_TMST                                      11700009
130449              , A.PO_NBR                                          11720009
130450              , A.TRBL_RSN_CDE                                    11740009
130451       END-EXEC.                                                  10260013
130452                                                                  10270013
130453*---------------------------------------------------------------* 10321013
130454*    POE CURSOR FOR A SPECIFIED POE CODE.                       * 10322014
130455*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 10323013
130456*    THE CURSOR.                                                * 10324013
130457*    THE RESULTS OF THIS CURSOR WILL BE IN OLDEST TO NEWEST TRBL* 12490009
130458*---------------------------------------------------------------* 10326013
130459                                                                  10327013
130460       EXEC SQL                                                   10330013
130461           DECLARE POE_BY_TRBL CURSOR                             10340021
130462           FOR SELECT                                             10350013
130463                 A.NOTIF_NBR                                      08649433
130464               , A.OPER_UNT_ID                                    08649533
130465               , A.FCLTY_ID                                       08649633
130466               , A.DEPT_NBR                                       08649733
130467               , A.ENT_ID                                         08649833
130468               , A.PO_NBR                                         08649933
130469               , A.PO_LNE_NBR                                     08650033
130470               , A.REC_SEQ_NBR                                    08650133
130471               , A.TRBL_RSN_CDE                                   08650233
130472               , A.NOTIF_TMST                                     08650333
130473               , A.RESOLVED_IND                                   08650433
130474               , A.RESOLVED_TMST                                  08650533
130475               , A.ACKNOWLG_TMST                                  08650633
130476               , A.LAST_DTL_CRE_TMST                                      
130477               , A.INITR_ENT_ID                                           
130478               , A.FOB_CDE                                                
130479               , A.POE_CDE                                                
130480               , B.TRBL_SHT_DESC                                  08650733
130481               , B.RESP_RES_IND                                   08650833
130482               , B.TRBL_LVL_IND                                   08650933
130483           FROM                                                   10380013
130484                 TTRBNTF A                                        10390013
130485               , TTRBRSN B                                        10400013
130486               , TPLNSHP C                                        10410013
130487          WHERE                                                   10420013
130488                 A.PO_NBR         =      C.PO_NBR                 10450013
130489             AND C.VER_STATUS_CDE =      'A'                      10460013
130490             AND C.POE_CDE        =      :DK-POE-CDE              10470013
130491             AND A.RESOLVED_IND      IN (:DK-NOTIF-STAT-1         10480013
130492                                       , :DK-NOTIF-STAT-2         10490013
130493                                       , :DK-NOTIF-STAT-3         10500013
130494                                       , :DK-NOTIF-STAT-4)        10510013
130495             AND A.TRBL_RSN_CDE  BETWEEN :DK-TRBL-RSN-LOW         10520013
130496                                     AND :DK-TRBL-RSN-HIGH        10530013
130497             AND B.RSLV_RSPNT_CDE    IN (:DK-RESP-AREA-1          10531013
130498                                       , :DK-RESP-AREA-2          10532013
130499                                       , :DK-RESP-AREA-3)         10533013
130500             AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE          10534013
130519       ORDER BY A.NOTIF_TMST                                      11700009
130520              , A.PO_NBR                                          11720009
130521              , A.TRBL_RSN_CDE                                    11740009
130522       END-EXEC.                                                  10539213
130523                                                                  10539313
130524*---------------------------------------------------------------* 10539913
130525*    OTB CURSOR FOR A SPECIFIED OTB.                            * 10540014
130526*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 10540113
130527*    THE CURSOR.                                                * 10540213
130528*    THE RESULTS OF THIS CURSOR WILL BE IN OLDEST TO NEWEST TRBL* 12490009
130529*---------------------------------------------------------------* 10540413
130530                                                                  10540513
130531       EXEC SQL                                                   10540613
130532           DECLARE OTB_BY_TRBL CURSOR                             10540721
130533           FOR SELECT                                             10540813
130534                 A.NOTIF_NBR                                      08649433
130535               , A.OPER_UNT_ID                                    08649533
130536               , A.FCLTY_ID                                       08649633
130537               , A.DEPT_NBR                                       08649733
130538               , A.ENT_ID                                         08649833
130539               , A.PO_NBR                                         08649933
130540               , A.PO_LNE_NBR                                     08650033
130541               , A.REC_SEQ_NBR                                    08650133
130542               , A.TRBL_RSN_CDE                                   08650233
130543               , A.NOTIF_TMST                                     08650333
130544               , A.RESOLVED_IND                                   08650433
130545               , A.RESOLVED_TMST                                  08650533
130546               , A.ACKNOWLG_TMST                                  08650633
130547               , A.LAST_DTL_CRE_TMST                                      
130548               , A.INITR_ENT_ID                                           
130549               , A.FOB_CDE                                                
130550               , A.POE_CDE                                                
130551               , B.TRBL_SHT_DESC                                  08650733
130552               , B.RESP_RES_IND                                   08650833
130553               , B.TRBL_LVL_IND                                   08650933
130554           FROM                                                   10541113
130555                 TTRBNTF A                                        10541213
130556               , TTRBRSN B                                        10541313
130557               , TPURCHS C                                        10541413
130558          WHERE                                                   10541513
130559                 A.PO_NBR         =      C.PO_NBR                 10541813
130560             AND C.VER_STATUS_CDE =      'A'                      10541913
130561             AND C.OTB_PER_NBR    =      :DK-OTB-PER-NBR-ALL      10542013
130562             AND A.RESOLVED_IND      IN (:DK-NOTIF-STAT-1         10542113
130563                                       , :DK-NOTIF-STAT-2         10542213
130564                                       , :DK-NOTIF-STAT-3         10542313
130565                                       , :DK-NOTIF-STAT-4)        10542413
130566             AND A.TRBL_RSN_CDE  BETWEEN :DK-TRBL-RSN-LOW         10542513
130567                                     AND :DK-TRBL-RSN-HIGH        10542613
130568             AND B.RSLV_RSPNT_CDE    IN (:DK-RESP-AREA-1          10542713
130569                                       , :DK-RESP-AREA-2          10542813
130570                                       , :DK-RESP-AREA-3)         10542913
130571             AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE          10543013
130590       ORDER BY A.NOTIF_TMST                                      11700009
130591              , A.PO_NBR                                          11720009
130592              , A.TRBL_RSN_CDE                                    11740009
130593      END-EXEC.                                                   10543713
130594                                                                  10544014
130595*---------------------------------------------------------------* 13040022
130596*    CURSOR TO SELECT ALL TROUBLE.                              * 13050022
130600*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 13060022
130700*    THE CURSOR.                                                * 13070022
130710*    THE RESULTS OF THIS CURSOR WILL BE IN OLDEST TO NEWEST TRBL* 13071022
130720*---------------------------------------------------------------* 13072022
130730                                                                  13073022
130731     EXEC SQL                                                     13073122
130732          DECLARE ALL_BY_TRBL CURSOR                              13073222
130733          FOR SELECT                                              13073322
130734                    A.NOTIF_NBR                                   13073422
130735                  , A.OPER_UNT_ID                                 13073522
130736                  , A.FCLTY_ID                                    13073622
130737                  , A.DEPT_NBR                                    13073722
130738                  , A.ENT_ID                                      13073822
130739                  , A.PO_NBR                                      13073922
130740                  , A.PO_LNE_NBR                                  13074022
130741                  , A.REC_SEQ_NBR                                 13074122
130742                  , A.TRBL_RSN_CDE                                13074222
130743                  , A.NOTIF_TMST                                  13074322
130744                  , A.RESOLVED_IND                                13074422
130745                  , A.RESOLVED_TMST                               13074522
130746                  , A.ACKNOWLG_TMST                               13074622
130747                  , A.LAST_DTL_CRE_TMST                                   
130748                  , A.INITR_ENT_ID                                        
130749                  , A.FOB_CDE                                             
130750                  , A.POE_CDE                                             
130751                  , B.TRBL_SHT_DESC                               13074722
130752                  , B.RESP_RES_IND                                13074822
130753                  , B.TRBL_LVL_IND                                13074922
130754          FROM                                                    13075222
130755                TTRBNTF A                                         13075322
130756              , TTRBRSN B                                         13075422
130757          WHERE                                                   10550222
130758                 A.RESOLVED_IND      IN (:DK-NOTIF-STAT-1         10550822
130759                                       , :DK-NOTIF-STAT-2         10550922
130760                                       , :DK-NOTIF-STAT-3         10551022
130761                                       , :DK-NOTIF-STAT-4)        10551122
130762             AND A.TRBL_RSN_CDE  BETWEEN :DK-TRBL-RSN-LOW         10551222
130763                                     AND :DK-TRBL-RSN-HIGH        10551322
130764             AND B.RSLV_RSPNT_CDE    IN (:DK-RESP-AREA-1          10551422
130765                                       , :DK-RESP-AREA-2          10551522
130766                                       , :DK-RESP-AREA-3)         10551622
130767             AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE          10551722
130784       ORDER BY A.NOTIF_TMST                                      11700009
130785              , A.PO_NBR                                          11720009
130786              , A.TRBL_RSN_CDE                                    11740009
130787     END-EXEC.                                                    13078222
130788                                                                  13078322
132600                                                                  13260009
133001                                                                  13300109
133010 LINKAGE SECTION.                                                 13301009
133100                                                                  13310003
133200 01  DFHCOMMAREA.                                                 13320003
133300     05  FILLER                         OCCURS  1 TO 4072 TIMES   13330003
133400                                        DEPENDING ON EIBCALEN.    13340003
133500         10  FILLER                     PIC X.                    13350003
133600                                                                  13360003
133700                                                                  13370003
133800 PROCEDURE DIVISION.                                              13380003
133900******************************************************************13390003
134000**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **13400003
134100**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **13410003
134200**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **13420003
134300******************************************************************13430003
134400 0000-MAIN-MODULE.                                                13440003
134500     INITIALIZE DP030-CICS-API-FIELDS.                            13450003
134600     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       13460003
134700     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          13470003
134800     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         13480003
134900     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       13490003
135000     MOVE LENGTH OF TM601AI        TO DP030-MAP-LENGTH (1).       13500009
135100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     13510003
135200     SET DP030-OVERRIDE-APPL-ERROR TO TRUE.                       13520003
135300*                                                                 13530003
135400     PERFORM 0001-CALL-CICS-ARCH-API.                             13540003
135500     PERFORM 1000-CONTROL-PROCESSING                              13550003
135600*                                                                 13560003
135700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     13570003
135800     PERFORM 0001-CALL-CICS-ARCH-API.                             13580003
135900                                                                  13590003
136000******************************************************************13600003
136100**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **13610003
136200**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **13620003
136300******************************************************************13630003
136400 0001-CALL-CICS-ARCH-API.                                         13640003
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                              
136600                                    DFHCOMMAREA                           
136700                                    DP030-CICS-API-FIELDS                 
136800                                    DP020-STANDARD-COMMAREA               
136900                                    TM601AI.                              
137000*                                                                 13700003
137100     IF DP030-RC-CALL-SUCCESSFUL OR DP030-RC-APPL-ERROR           13710003
137200         CONTINUE                                                 13720003
137300     ELSE                                                         13730003
137400         SET DP013-NO-ROLLBACK                                    13740003
137500             DP013-XCTL-DISPLAY-RESTART                           13750003
137600             DP013-CICS-ABEND      TO TRUE                        13760003
137700         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        13770003
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O        
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)              
138000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      13800003
138100         PERFORM DP013-0000-PROCESS-ABEND                         13810003
138200     END-IF.                                                      13820003
138300                                                                  13830003
138400*----------------------------------------------------------------*13840003
138500* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *13850003
138600* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *13860003
138700*                                                                *13870003
138800* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *13880003
138900*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *13890003
139000*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *13900003
139100*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *13910003
139200*----------------------------------------------------------------*13920003
139300 1000-CONTROL-PROCESSING.                                         13930003
139400     EVALUATE TRUE                                                13940003
139500         WHEN DP030-RC-APPL-ERROR                                 13950003
139600             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         13960003
139700             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                13970003
139800             IF ASC-RETURNING-FROM-PO                             13980003
139900                 PERFORM 2140-DESELECT-ALL-ITEMS                  13990003
140000             ELSE                                                 14000003
140100                 PERFORM 6000-REFRESH-PANEL-FROM-TEMP             14010003
140200             END-IF                                               14020003
140300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14030003
140400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14040003
140500                                                                  14050003
140600         WHEN DP020-NEXT-ACT-INITIAL                              14060003
140700             INITIALIZE ASC-SPECIFIC-COMMAREA                     14070003
140800             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            14080003
140900                                      ASC-SEL-TERM-ID             14090003
141000             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   14100003
141100                                           ASC-SEL-TASK-NUMBER    14110003
141200             MOVE PC-LIST-QUEUE-SEQ TO ASC-LIST-SEQ               14120003
141300             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 14130003
141400             PERFORM 1100-PROCESS-INTER-APPL-COMM                 14140003
141500                                                                  14150003
141600             IF  PS-COMMAREA-NOT-VALID                            14160003
141700                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            14170003
141800             ELSE                                                 14180003
141900                 PERFORM 4000-BUILD-INITIAL-PANEL                 14190003
142000             END-IF                                               14200003
142100                                                                  14210003
142200         WHEN DP020-NEXT-ACT-READ-MAP                             14220003
142300             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         14230003
142400             PERFORM 2000-PROCESS-PANEL                           14240003
142500                                                                  14250003
142600         WHEN DP020-NEXT-ACT-RETURN                               14260003
142700             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         14270003
142800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    14280003
142900             IF ASC-RETURNING-FROM-PO                             14290003
143000                 PERFORM 2140-DESELECT-ALL-ITEMS                  14300003
143100             ELSE                                                 14310003
143200                 PERFORM 6000-REFRESH-PANEL-FROM-TEMP             14320003
143300             END-IF                                               14330003
143400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14340003
143500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14350003
143600                                                                  14360003
143700         WHEN OTHER                                               14370003
143800             SET DP013-LOGIC-ABEND TO TRUE                        14380003
143900             SET DP013-NO-ROLLBACK TO TRUE                        14390003
144000             MOVE '1000-CONTROL-PROCESSING'                       14400003
144100                                   TO DP013-PARAGRAPH             14410003
144200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    14420003
144300                                   TO DP013-MESSAGE-TEXT(1)       14430003
144400             PERFORM DP013-0000-PROCESS-ABEND                     14440003
144500     END-EVALUATE.                                                14450003
144600                                                                  14460003
144700*----------------------------------------------------------------*14470003
144800* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *14480003
144900* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *14490003
145000*----------------------------------------------------------------*14500003
145100 1100-PROCESS-INTER-APPL-COMM.                                    14510003
145200     SET PS-COMMAREA-VALID         TO TRUE.                       14520003
145300     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     14530003
145400                                                                  14540003
145500     MOVE DP020-INT-APPL-FORMAT-IND TO PC-ENTERED-USING-IND.      14550003
145600     EVALUATE TRUE                                                14560003
145700**** COMING FROM THE CRIT SPEC SCREEN  *************************  14570003
145800         WHEN PC-CRIT-SPEC-FORMAT                                 14580003
145900             IF  TM006-TRBL-REASON > SPACES                       14590014
146000                 IF  TM006-TRBL-REASON = PC-ALL                   14600014
146100                     MOVE +700        TO ASC-TRBL-REASON-LOW      14610014
146200                     MOVE +759        TO ASC-TRBL-REASON-HIGH     14620014
146300                 ELSE                                             14630009
146400                     MOVE TM006-TRBL-REASON                       14640014
146500                                  TO PV-TRBL-REASON-LOW           14650009
146600                                     PV-TRBL-REASON-HIGH          14660009
146700                     INSPECT PV-TRBL-REASON-LOW                   14670009
146800                         REPLACING ALL '*' BY ZEROS               14680009
146900                     INSPECT PV-TRBL-REASON-HIGH                  14690009
147000                         REPLACING ALL '*' BY PC-NINE             14700009
147100                     IF (PV-TRBL-REASON-LOW NUMERIC)  AND         14710009
147200                        (PV-TRBL-REASON-HIGH NUMERIC)             14720009
147300                         MOVE PV-TRBL-REASON-LOW                  14730009
147400                                  TO ASC-TRBL-REASON-LOW          14740009
147500                         MOVE PV-TRBL-REASON-HIGH                 14750009
147600                                  TO ASC-TRBL-REASON-HIGH         14760009
147700                     ELSE                                         14770009
147800                         MOVE PC-TSYMSG-01030                     14780009
147900                                  TO DP020-MSG-NUMBER             14790009
148000                         SET PS-ERROR                             14800009
148100                             PS-COMMAREA-NOT-VALID                14810009
148200                             DP020-MSG-FATAL TO TRUE              14820009
148300                     END-IF                                       14830009
148400                 END-IF                                           14840009
148500             ELSE                                                 14850009
148600                 MOVE ZEROS       TO ASC-TRBL-REASON-LOW          14860009
148700                                     ASC-TRBL-REASON-HIGH         14870009
148800             END-IF                                               14880009
148900                                                                  14890009
149000             IF  PS-NO-ERROR                                      14900006
149100                 MOVE TM006-OPER-UNT-ID TO ASC-KEY-OPER-UNT-ID    14910014
149200                 MOVE TM006-FCLTY-ID    TO ASC-KEY-FCLTY-ID       14920014
149300                 MOVE TM006-DEPT           TO ASC-KEY-DEPT        14930014
149400                 MOVE TM006-BUYER          TO ASC-KEY-BUYER       14940014
149500                 MOVE TM006-PO-NBR-N       TO ASC-KEY-PO-NBR      14950014
149600                 MOVE TM006-FOB-CDE        TO ASC-KEY-FOB-CDE     14960015
149610                 MOVE TM006-POE-CDE        TO ASC-KEY-POE-CDE     14961015
149620                 MOVE TM006-OTB            TO ASC-KEY-OTB         14962015
149700                 MOVE TM006-LIST-SEQ-SW    TO ASC-LIST-SEQ-SW     14970014
149800                 MOVE TM006-ALL-TRBL       TO ASC-KEY-ALL-TRBL            
150000                 MOVE TM006-BUYER          TO ASC-RA-BUYER        15000015
150300                 MOVE TM006-NOTIF-STATUS   TO ASC-NOTIF-STAT      15030014
150400                 MOVE TM006-RESPONSIBILITY-AREA-SW                15040028
150410                                    TO ASC-RESPONSIBILITY-AREA-SW 15041028
150500             END-IF                                               15050003
152000         WHEN PC-ENTERED-USING-PO-PO013                           15200003
152100**** USED WHEN GOING TO PO INQUIRY ************************       15210003
152200************* SCREEN FROM THIS LIST SCREEN  ***************       15220003
152300             MOVE PO013-PO-NBR      TO ASC-KEY-PO-NBR             15230009
152400         WHEN PC-ENTERED-USING-PO-PO017                           15240003
152500**** USED WHEN COMING FROM THE PO INQUIRY  SCREEN  ********       15250003
152600             MOVE PO017-PO-NBR      TO ASC-KEY-PO-NBR             15260009
152700             MOVE PO017-DEPT-NBR    TO ASC-KEY-DEPT               15270009
152800             MOVE +1                TO ASC-KEY-FCLTY-ID           15280009
152900             MOVE PC-BUY-ANALYST-DC-SW                            15290003
153000                                    TO ASC-RESPONSIBILITY-AREA-SW 15300003
153100             MOVE PC-BUYER          TO ASC-RA-BUYER               15310003
153200             MOVE PC-ANALYST        TO ASC-RA-ANALYST             15320003
153300             MOVE PC-BUYER-ANALYST-DC TO ASC-RA-DC                15330009
153400             SET ASC-ALL-NOTIF-STATS                              15340003
153500                 ASC-RCVR-STAT-ARR-ENR                            15350009
153600                 ASC-LS-PO          TO TRUE                       15360029
153700             MOVE +999              TO ASC-TRBL-REASON-HIGH       15370009
153800             MOVE +0000             TO ASC-KEY-OPER-UNT-ID        15380009
165600     END-EVALUATE.                                                16560003
165700                                                                  16570003
168800*----------------------------------------------------------------*16880003
168900* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *16890003
169000* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *16900003
169100* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *16910003
169200* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *16920003
169300* FUNCTION KEYS CAN GET THIS FAR.                                *16930003
169400*----------------------------------------------------------------*16940003
169500 2000-PROCESS-PANEL.                                              16950003
169600     EVALUATE TRUE                                                16960003
169700         WHEN DP020-SRC-AID = DP016-CLEAR                         16970003
169800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    16980003
169900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   16990003
170000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17000003
170100                                                                  17010003
170200         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    17020003
170300             PERFORM 2050-DELETE-LIST-QUEUE                       17030003
170400             PERFORM 4000-BUILD-INITIAL-PANEL                     17040003
170500                                                                  17050003
170600         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             17060009
170700             IF ASC-USE-SELECTION-QUEUE                           17070009
170800                 INITIALIZE ASC-KEY-FIELDS                        17080009
171700                 IF PS-LIST-END                                   17170009
171800                    SET PS-NO-LIST-END TO TRUE                    17180009
171900                 ELSE                                             17190009
172000                     PERFORM 2050-DELETE-LIST-QUEUE               17200009
172100                     PERFORM 3200-RESET-ATTRIBUTES                17210009
172200                     PERFORM 4000-BUILD-INITIAL-PANEL             17220009
172300                 END-IF                                           17230009
172400              ELSE                                                17240009
172500*                --- BOTTOM OF LIST ---                           17250009
172600                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         17260009
172700                 SET DP020-MSG-INFORMATIONAL TO TRUE              17270009
172800              END-IF                                              17280009
172900                                                                  17290009
173000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             17300009
173100             IF ASC-USE-SELECTION-QUEUE                           17310009
173200                 INITIALIZE ASC-KEY-FIELDS                        17320009
174100                 IF PS-LIST-END                                   17410009
174200                    SET PS-NO-LIST-END TO TRUE                    17420009
174300                 ELSE                                             17430009
174400                     PERFORM 2050-DELETE-LIST-QUEUE               17440009
174500                     PERFORM 3200-RESET-ATTRIBUTES                17450009
174600                     PERFORM 4000-BUILD-INITIAL-PANEL             17460009
174700                 END-IF                                           17470009
174800             ELSE                                                 17480009
174900*                --- TOP OF LIST ---                              17490009
175000                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         17500009
175100                 SET DP020-MSG-INFORMATIONAL TO TRUE              17510009
175200              END-IF                                              17520009
175300                                                                  17530009
175400         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    17540003
175500             PERFORM 2140-DESELECT-ALL-ITEMS                      17550003
175600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17560003
175700                                                                  17570003
175800         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  17580003
175900             PERFORM 2150-SELECT-ALL-ITEMS                        17590003
176000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17600003
176100                                                                  17610003
176200         WHEN OTHER                                               17620003
176300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 17630003
176400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   17640003
176500             IF  PS-NO-ERROR                                      17650003
176600                 SET DP030-CONTINUE-GO TO TRUE                    17660003
176700                 PERFORM 2100-CHECK-FUNCTION-KEY                  17670003
176800             ELSE                                                 17680003
176900                 SET DP030-OVERRIDE-GO TO TRUE                    17690003
177000             END-IF                                               17700003
177100     END-EVALUATE.                                                17710003
177200                                                                  17720003
177300*----------------------------------------------------------------*17730003
177400*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *17740003
177500*----------------------------------------------------------------*17750003
177600 2050-DELETE-LIST-QUEUE.                                          17760003
177700     EXEC CICS                                                    17770003
177800         DELETEQ TS                                               17780003
177900             QUEUE (ASC-LIST-QUEUE-NAME)                          17790003
178000             RESP  (PV-CICS-RESP)                                 17800003
178100     END-EXEC.                                                    17810003
178200                                                                  17820003
178300     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       17830003
178400        (PV-CICS-RESP = DFHRESP(QIDERR))                          17840003
178500         CONTINUE                                                 17850003
178600     ELSE                                                         17860003
178700         SET DP013-CICS-ABEND      TO TRUE                        17870003
178800         SET DP013-NO-ROLLBACK     TO TRUE                        17880003
178900         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         17890003
179000         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    17900003
179100                                   TO DP013-MESSAGE-TEXT (1)      17910003
179200         PERFORM DP013-0000-PROCESS-ABEND                         17920003
179300     END-IF.                                                      17930003
179400     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  17940003
179500                                                                  17950003
179600*----------------------------------------------------------------*17960003
179700* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*17970003
179800* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *17980003
179900* CICS ARCHITECTURE API.                                         *17990003
180000*----------------------------------------------------------------*18000003
180100 2100-CHECK-FUNCTION-KEY.                                         18010003
180200     EVALUATE TRUE                                                18020003
184600         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               18460012
184700*             ---     PO INQUIRY  KEY ---                         18470006
185000             IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO               18500006
185100                 INITIALIZE PO013-INTER-APPL-COMMAREA             18510006
185200                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                18520006
185300                         TO PO013-NUMBER-OF-SELECTED-ITEMS        18530006
185400                 PERFORM 5025-PREPARE-SEL-QUEUE-FOR-PO            18540006
185500                 IF PS-ERROR                                      18550006
185600                     MOVE ASC-ITEM-AT-TOP-OF-PANEL                18560006
185700                         TO PV-TOP-ITEM                           18570006
185800                     MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL        18580006
185900                     MOVE +1 TO ASC-BLK-SUB                       18590006
186000                     PERFORM 4410-READ-TEMP-STORAGE               18600006
186100                     ADD +1 TO  ASC-BLK-SUB                       18610006
186200                                PV-BLOCK-NUMBER                   18620006
186300                     PERFORM 4410-READ-TEMP-STORAGE               18630006
186400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         18640006
186500                     SET DP030-OVERRIDE-GO                        18650006
186600                         DP020-MSG-WARNING TO TRUE                18660006
186700                 END-IF                                           18670006
186800             ELSE                                                 18680006
186900                 SET DP030-OVERRIDE-GO TO TRUE                    18690006
187000                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        18700009
187100                 SET DP020-MSG-WARNING TO TRUE                    18710006
187200             END-IF                                               18720006
191800         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               19180012
191900*             --- RESPOND/RESOLVE FUNCTION KEY ---                19190006
192200         WHEN DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)               19220012
192300*             --- DETAILS FUNCTION KEY ---                        19230003
192310         WHEN DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)               19220012
192320*             --- TR IMPORTS PO TRACKING SUMMARY ---              19230003
192400             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              19240003
192500                 INITIALIZE TM006-INTER-APPL-COMMAREA             19250014
192600                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                19260003
192700                         TO TM006-NUMBER-OF-SELECTED-ITEMS        19270014
192800                 PERFORM 5000-PREPARE-SEL-QUEUE                   19280003
192900             ELSE                                                 19290003
193000                 SET DP030-OVERRIDE-GO TO TRUE                    19300003
193100                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        19310009
193200                 SET DP020-MSG-WARNING TO TRUE                    19320003
193300             END-IF                                               19330003
193400         WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               19340012
193500*             --- RESOLVE FUCTION KEY ---                         19350003
193600             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              19360003
193700                 INITIALIZE TM500-FIELDS                          19370003
193800                 SET TM500-RESOLVE-AUTO                           19380003
193900                     TM500-NO-DETAILS                             19390003
194000                     PS-RESOLVE-REQUEST TO TRUE                   19400003
194100                 MOVE PC-CURRENT-PROGRAM-NAME TO TM500-NOTIF-UID  19410003
194200                 MOVE DP020-USERID TO TM500-RESOLVED-UID          19420003
194300                 PERFORM 5050-PREPARE-TO-PROCESS-TRBL             19430003
194400                 IF  NOT PS-ERROR                                 19440003
194500                     IF  TM500-DUPLICATE-TROUBLE                  19450003
194600                         CONTINUE                                 19460003
194700                     ELSE                                         19470003
194800                         MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER 19480003
194900                     END-IF                                       19490003
195000                     SET DP020-MSG-INFORMATIONAL   TO TRUE        19500009
195100                     MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM 19510003
195200                     MOVE ZERO     TO  ASC-ITEM-AT-TOP-OF-PANEL   19520003
195300                                                                  19530003
195400                     DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL     19540003
195500                         GIVING PV-BLOCK-NUMBER                   19550003
195600                         REMAINDER PV-REMAINDER                   19560003
195700                     IF  PV-REMAINDER > ZERO                      19570003
195800                         ADD +1 TO PV-BLOCK-NUMBER                19580003
195900                     END-IF                                       19590003
196000                                                                  19600003
196100                     MOVE +1    TO ASC-BLK-SUB                    19610003
196200                     PERFORM 4410-READ-TEMP-STORAGE               19620003
196300                     ADD +1     TO ASC-BLK-SUB                    19630003
196400                                   PV-BLOCK-NUMBER                19640003
196500                     PERFORM 4410-READ-TEMP-STORAGE               19650003
196600                 ELSE                                             19660003
196700                     MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM 19670003
196800                     MOVE ZERO     TO  ASC-ITEM-AT-TOP-OF-PANEL   19680003
196900                     MOVE +1       TO  ASC-BLK-SUB                19690003
197000                     PERFORM 4410-READ-TEMP-STORAGE               19700003
197100                     ADD +1        TO  ASC-BLK-SUB                19710003
197200                                       PV-BLOCK-NUMBER            19720003
197300                     PERFORM 4410-READ-TEMP-STORAGE               19730003
197400                 END-IF                                           19740003
197500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             19750003
197600             ELSE                                                 19760003
197700                 SET DP030-OVERRIDE-GO TO TRUE                    19770003
197800                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        19780009
197900                 SET DP020-MSG-WARNING TO TRUE                    19790003
198000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             19800003
198100             END-IF                                               19810003
200700         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  20070003
200800             MOVE +1       TO PV-TOP-ITEM                         20080009
200900             PERFORM 3200-RESET-ATTRIBUTES                        20090003
201000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 20100003
201100         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   20110003
201200             PERFORM 2110-BROWSE-BACKWARD                         20120003
201300             PERFORM 3200-RESET-ATTRIBUTES                        20130003
201400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 20140003
201500         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   20150003
201600             PERFORM 2120-BROWSE-FORWARD                          20160003
201700             PERFORM 3200-RESET-ATTRIBUTES                        20170003
201800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 20180003
201900         WHEN DP020-SRC-AID = DP016-ENTER                         20190003
202000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   20200003
202100             IF PS-ERROR                                          20210009
202200                 CONTINUE                                         20220003
202300             ELSE                                                 20230003
202400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             20240003
202500             END-IF                                               20250003
202600         WHEN OTHER                                               20260003
202700             SET DP013-NO-ROLLBACK                                20270003
202800                 DP013-XCTL-DISPLAY-RESTART                       20280003
202900                 DP013-CICS-ABEND  TO TRUE                        20290003
203000             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    20300003
203100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      20310003
203200                                   TO DP013-MESSAGE-TEXT (1)      20320003
203300             PERFORM DP013-0000-PROCESS-ABEND                     20330003
203400     END-EVALUATE.                                                20340003
203500                                                                  20350009
239700*----------------------------------------------------------------*23970003
239800*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *23980003
239900*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *23990003
240000*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *24000003
240100*    MESSAGE.                                                    *24010003
240200*----------------------------------------------------------------*24020003
240300 2110-BROWSE-BACKWARD.                                            24030003
240400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    24040003
240500         GIVING PV-TOP-ITEM.                                      24050003
240600                                                                  24060003
240700     IF  ((PV-TOP-ITEM < +1)                                      24070003
240800       OR (PV-TOP-ITEM = +1))                                     24080003
240900         MOVE +1                   TO PV-TOP-ITEM                 24090003
241000*        -- TOP OF LIST --                                        24100003
241100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            24110003
241200         SET DP020-MSG-INFORMATIONAL TO TRUE                      24120003
241300     END-IF.                                                      24130003
241400                                                                  24140003
241500*----------------------------------------------------------------*24150003
241600*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *24160003
241700*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *24170003
241800*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *24180003
241900*----------------------------------------------------------------*24190003
242000 2120-BROWSE-FORWARD.                                             24200003
242100     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              24210003
242200         GIVING PV-TOP-ITEM.                                      24220003
242300     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   24230003
242400         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             24240003
242500*        -- BOTTOM OF LIST --                                     24250003
242600         MOVE PC-TSYMSG-00070        TO DP020-MSG-NUMBER          24260009
242700         SET DP020-MSG-INFORMATIONAL TO TRUE                      24270003
242800     ELSE                                                         24280003
242900         COMPUTE PV-BOTTOM-ITEM =                                 24290003
243000             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 24300003
243100         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            24310003
243200*            -- BOTTOM OF LIST --                                 24320003
243300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            24330003
243400             SET DP020-MSG-INFORMATIONAL TO TRUE                  24340003
243500         END-IF                                                   24350003
243600     END-IF.                                                      24360003
243700                                                                  24370003
243800*----------------------------------------------------------------*24380003
243900*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *24390003
244000*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *24400003
244100*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *24410003
244200*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *24420003
244300*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *24430003
244400*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *24440003
244500*----------------------------------------------------------------*24450003
244600 2130-CHECK-FOR-JUMP-BROWSE.                                      24460003
244700     SET PS-NO-ERROR               TO TRUE.                       24470003
244800     IF (ASC-START-ITEM-REQUEST = SPACE)                          24480003
244900         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             24490003
245000     ELSE                                                         24500003
245100         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     24510003
245200         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       24520003
245300         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     24530003
245400         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  24540003
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263627              USING DP010I-NUMERIC-EDIT-AREA                              
245600                                                                  24560003
245700         IF  NOT DP010I-ERROR-DETECTED                            24570003
245800             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N24580003
245900             IF  ASC-START-ITEM-REQUEST-N > ZERO                  24590003
246000                 IF  ASC-START-ITEM-REQUEST-N >                   24600003
246100                                          ASC-NUMBER-OF-ITEMS-READ24610003
246200                     MOVE SPACE TO ASC-START-ITEM-REQUEST         24620003
246300                     COMPUTE PV-TOP-ITEM =                        24630003
246400                             ASC-NUMBER-OF-ITEMS-READ             24640003
246500                             - PC-ITEMS-PER-PANEL + 1             24650003
246600                     IF  PV-TOP-ITEM < +1                         24660003
246700                         MOVE +1   TO PV-TOP-ITEM                 24670003
246800                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 24680003
246900                         SET DP020-MSG-INFORMATIONAL TO TRUE      24690003
247000                     END-IF                                       24700003
247100                 ELSE                                             24710003
247200                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 24720003
247300                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      24730003
247400                     COMPUTE PV-BOTTOM-ITEM =                     24740003
247500                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     24750003
247600                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ24760003
247700*                        -- BOTTOM OF LIST --                     24770003
247800                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 24780003
247900                         SET DP020-MSG-INFORMATIONAL TO TRUE      24790003
248000                     END-IF                                       24800003
248100                 END-IF                                           24810003
248200             ELSE                                                 24820003
248300*                --- VALUE OUT OF RANGE ----                      24830003
248400                 MOVE PC-TSYMSG-00101 TO DP020-MSG-NUMBER         24840003
248500                 MOVE -1           TO ASTRTITL                    24850003
248600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              24860003
248700                 MOVE DP015-REVERSE TO ASTRTITH                   24870003
248800                 MOVE DP015-RED    TO ASTRTITC                    24880003
248900                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           24890003
249000                 SET DP020-MSG-FATAL TO TRUE                      24900003
249100                 SET PS-ERROR      TO TRUE                        24910003
249200             END-IF                                               24920003
249300         ELSE                                                     24930003
249400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            24940003
249500             MOVE -1               TO ASTRTITL                    24950003
249600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  24960003
249700             MOVE DP015-REVERSE    TO ASTRTITH                    24970003
249800             MOVE DP015-RED        TO ASTRTITC                    24980003
249900             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               24990003
250000             SET DP020-MSG-FATAL   TO TRUE                        25000003
250100             SET PS-ERROR          TO TRUE                        25010003
250200         END-IF                                                   25020003
250300     END-IF.                                                      25030003
250400                                                                  25040003
250500*----------------------------------------------------------------*25050003
250600*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *25060003
250700*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *25070003
250800*----------------------------------------------------------------*25080003
250900 2140-DESELECT-ALL-ITEMS.                                         25090003
251000     MOVE +1                       TO ASC-BLK-SUB.                25100003
251100                                                                  25110003
251200     PERFORM 2141-CLEAR-SELECTED-INDS                             25120003
251300         VARYING ASC-ITEM-SUB                                     25130003
251400         FROM 1 BY 1                                              25140003
251500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 25150003
251600                                                                  25160003
251700     ADD +1                        TO ASC-BLK-SUB.                25170003
251800                                                                  25180003
251900     PERFORM 2141-CLEAR-SELECTED-INDS                             25190003
252000         VARYING ASC-ITEM-SUB                                     25200003
252100         FROM 1 BY 1                                              25210003
252200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 25220003
252300                                                                  25230003
252400     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER.       25240003
252500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            25250003
252600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    25260003
252700                                                                  25270003
252800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     25280003
252900        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      25290003
253000         MOVE +1                   TO ASC-BLK-SUB                 25300003
253100         PERFORM 5100-WRITE-TEMP-STORAGE                          25310003
253200         MOVE +1                   TO PV-BLOCK-NUMBER             25320003
253300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         25330003
253400             PV-FIRST-BLOCK-IN-ARRAY - 1                          25340003
253500         PERFORM                                                  25350003
253600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       25360003
253700                                                                  25370003
253800             PERFORM 4410-READ-TEMP-STORAGE                       25380003
253900             PERFORM 2141-CLEAR-SELECTED-INDS                     25390003
254000                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 25400003
254100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          25410003
254200             PERFORM 5100-WRITE-TEMP-STORAGE                      25420003
254300             ADD +1                TO PV-BLOCK-NUMBER             25430003
254400         END-PERFORM                                              25440003
254500                                                                  25450003
254600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         25460003
254700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     25470003
254800                                                                  25480003
254900         PERFORM                                                  25490003
255000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       25500003
255100                   ASC-HIGHEST-BLOCK-WRITTEN                      25510003
255200             MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER       25520003
255300             PERFORM 4410-READ-TEMP-STORAGE                       25530003
255400             PERFORM 2141-CLEAR-SELECTED-INDS                     25540003
255500                 VARYING ASC-ITEM-SUB                             25550003
255600                 FROM 1 BY 1                                      25560003
255700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          25570003
255800             PERFORM 5100-WRITE-TEMP-STORAGE                      25580003
255900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      25590003
256000         END-PERFORM                                              25600003
256100                                                                  25610003
256200         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          25620003
256300         PERFORM 4410-READ-TEMP-STORAGE                           25630003
256400     END-IF.                                                      25640003
256500                                                                  25650003
256600     MOVE +0           TO ASC-NUMBER-OF-SELECTED-ITEMS.           25660003
256700     MOVE +0           TO ASC-START-OF-SELECTED-RANGE.            25670003
256800     MOVE +0           TO ASC-END-OF-SELECTED-RANGE.              25680003
256900                                                                  25690003
257000*----------------------------------------------------------------*25700003
257100*    MARK EACH ITEM AS BEING NOT SELECTED.                       *25710003
257200*----------------------------------------------------------------*25720003
257300 2141-CLEAR-SELECTED-INDS.                                        25730003
257400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           25740003
257500             NOT EQUAL ZERO                                       25750003
257600         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          25760003
257700             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          25770003
257800                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    25780003
257900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          25790003
258000         END-IF                                                   25800003
258100     END-IF.                                                      25810003
258200                                                                  25820003
258300*----------------------------------------------------------------*25830003
258400*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *25840003
258500*  FOR ALL ITEMS.                                                *25850003
258600*----------------------------------------------------------------*25860003
258700 2150-SELECT-ALL-ITEMS.                                           25870003
258800     MOVE +1                       TO ASC-BLK-SUB.                25880003
258900                                                                  25890003
259000     PERFORM 2151-SET-SELECTED-INDS                               25900003
259100         VARYING ASC-ITEM-SUB                                     25910003
259200         FROM 1 BY 1                                              25920003
259300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 25930003
259400                                                                  25940003
259500     ADD +1                        TO ASC-BLK-SUB.                25950003
259600                                                                  25960003
259700     PERFORM 2151-SET-SELECTED-INDS                               25970003
259800         VARYING ASC-ITEM-SUB                                     25980003
259900         FROM 1 BY 1                                              25990003
260000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 26000003
260100                                                                  26010003
260200     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER.       26020003
260300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            26030003
260400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    26040003
260500                                                                  26050003
260600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     26060003
260700        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    26070003
260800         MOVE +1                   TO ASC-BLK-SUB                 26080003
260900         PERFORM 5100-WRITE-TEMP-STORAGE                          26090003
261000         MOVE +1                   TO PV-BLOCK-NUMBER             26100003
261100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         26110003
261200             PV-FIRST-BLOCK-IN-ARRAY - 1                          26120003
261300                                                                  26130003
261400         PERFORM                                                  26140003
261500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       26150003
261600             PERFORM 4410-READ-TEMP-STORAGE                       26160003
261700             PERFORM 2151-SET-SELECTED-INDS                       26170003
261800                 VARYING ASC-ITEM-SUB                             26180003
261900                 FROM 1 BY 1                                      26190003
262000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          26200003
262100             PERFORM 5100-WRITE-TEMP-STORAGE                      26210003
262200             ADD +1                TO PV-BLOCK-NUMBER             26220003
262300         END-PERFORM                                              26230003
262400                                                                  26240003
262500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         26250003
262600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     26260003
262700                                                                  26270003
262800         PERFORM                                                  26280003
262900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       26290003
263000                   ASC-HIGHEST-BLOCK-WRITTEN                      26300003
263100             MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER       26310003
263200             PERFORM 4410-READ-TEMP-STORAGE                       26320003
263300             PERFORM 2151-SET-SELECTED-INDS                       26330003
263400                 VARYING ASC-ITEM-SUB                             26340003
263500                 FROM 1 BY 1                                      26350003
263600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          26360003
263700             PERFORM 5100-WRITE-TEMP-STORAGE                      26370003
263800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      26380003
263900         END-PERFORM                                              26390003
264000                                                                  26400003
264100         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          26410003
264200         PERFORM 4410-READ-TEMP-STORAGE                           26420003
264300     END-IF.                                                      26430003
264400                                                                  26440003
264500     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             26450003
264600                       ASC-NUMBER-OF-SELECTED-ITEMS.              26460003
264700                                                                  26470003
264800*----------------------------------------------------------------*26480003
264900*    MARK EACH ITEM AS BEING SELECTED.                           *26490003
265000*----------------------------------------------------------------*26500003
265100 2151-SET-SELECTED-INDS.                                          26510003
265200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           26520003
265300             NOT EQUAL ZERO                                       26530003
265400         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             26540003
265500             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             26550003
265600                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        26560003
265700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          26570003
265800         END-IF                                                   26580003
265900     END-IF.                                                      26590003
266000                                                                  26600003
266100                                                                  26610003
266200******************************************************************26620003
266300** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **26630003
266400** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **26640003
266500******************************************************************26650003
266600 2200-MOVE-SCREEN-TO-COMMAREA.                                    26660003
266700     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             26670003
266800     MOVE +1                       TO PV-SUB.                     26680003
266900                                                                  26690003
267000     PERFORM 3100-SET-SUBSCRIPTS.                                 26700003
267100     IF  ASTRTITL > ZERO                                          26710003
267200         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          26720003
267300     ELSE                                                         26730003
267400         IF  ASTRTITF = DP015-ERASE-EOF                           26740003
267500             INITIALIZE ASC-START-ITEM-REQUEST                    26750003
267600         END-IF                                                   26760003
267700     END-IF.                                                      26770003
267800     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          26780003
267900         VARYING PV-SUB                                           26790003
268000         FROM 1 BY 1                                              26800003
268100         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      26810003
268200                                                                  26820003
268300******************************************************************26830003
268400** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**26840003
268500******************************************************************26850003
268600 2210-MOVE-LINES-TO-COMMAREA.                                     26860003
268700     IF  MR-SELECTL (PV-SUB) > ZERO                               26870003
268800         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             26880003
268900         MOVE MR-SELECTI (PV-SUB) TO ASC-TEMP-SELECTED-SW         26890003
269000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      26900003
269100     ELSE                                                         26910003
269200         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                26920003
269300             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         26930009
269400             MOVE SPACE        TO ASC-TEMP-SELECTED-SW            26940009
269500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      26950003
269600         END-IF                                                   26960003
269700     END-IF.                                                      26970003
269800     ADD +1                    TO ASC-ITEM-SUB.                   26980009
269900     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        26990003
270000         ADD +1                TO ASC-BLK-SUB                     27000009
270100         MOVE +1               TO ASC-ITEM-SUB                    27010009
270200     END-IF.                                                      27020003
270300                                                                  27030003
270400                                                                  27040003
270500******************************************************************27050003
270600** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **27060003
270700** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **27070003
270800******************************************************************27080003
270900 3000-EDIT-DATA-IN-COMMAREA.                                      27090003
271000     SET PS-NO-ERROR               TO TRUE.                       27100003
271100     PERFORM 3200-RESET-ATTRIBUTES.                               27110003
271200     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     27120003
271300**                                                                27130003
271400* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              27140003
271500* EDITTING IS DONE FROM THE BOTTOM UP.                            27150003
271600**                                                                27160003
271700     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       27170003
271800         ASC-ITEMS-DISPLAYED - 1.                                 27180003
271900     PERFORM 3100-SET-SUBSCRIPTS.                                 27190003
272000     PERFORM 3300-EDIT-SELECTIONS                                 27200003
272100         VARYING PV-SUB                                           27210003
272200         FROM PV-SUB BY -1                                        27220003
272300         UNTIL PV-SUB < +1                                        27230003
272400                                                                  27240003
272500     IF  PS-NO-ERROR                                              27250003
272600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        27260003
272700     END-IF.                                                      27270003
272800                                                                  27280003
272900     IF  ((PS-NO-ERROR)                                           27290003
273000       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   27300003
273100       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    27310003
273200             PERFORM 3500-MARK-RANGE-AS-SELECTED                  27320003
273300     END-IF.                                                      27330003
273400                                                                  27340003
273500*----------------------------------------------------------------*27350003
273600*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *27360003
273700*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*27370003
273800*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *27380003
273900*                                                                *27390003
274000*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *27400003
274100*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *27410003
274200*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *27420003
274300*    US IN THE 2ND BLOCK OF THE ARRAY.                           *27430003
274400*----------------------------------------------------------------*27440003
274500 3100-SET-SUBSCRIPTS.                                             27450003
274600     COMPUTE PV-ASC-ITEM-SUB-COMP3 =                              27460003
274700         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        27470003
274800     MOVE PV-ASC-ITEM-SUB-COMP3 TO ASC-ITEM-SUB                   27480003
274900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         27490003
275000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            27500003
275100         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               27510003
275200     ELSE                                                         27520003
275300         MOVE +1                     TO ASC-BLK-SUB               27530003
275400     END-IF.                                                      27540003
275500                                                                  27550003
275600******************************************************************27560003
275700** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **27570003
275800******************************************************************27580003
275900 3200-RESET-ATTRIBUTES.                                           27590003
276000     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   27600003
276100     MOVE DP015-GREEN              TO ASTRTITC.                   27610003
276200     MOVE DP015-UNDERLINE          TO ASTRTITH.                   27620003
276300                                                                  27630003
276400     PERFORM                                                      27640003
276500         VARYING PV-SUB                                           27650003
276600          FROM 1 BY 1                                             27660003
276700         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        27670003
276800         MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA (PV-SUB)        27680003
276900         MOVE DP015-GREEN           TO MR-SELECTC (PV-SUB)        27690003
277000         MOVE DP015-UNDERLINE       TO MR-SELECTH (PV-SUB)        27700003
277100     END-PERFORM.                                                 27710003
277200                                                                  27720003
277300                                                                  27730003
277400******************************************************************27740003
277500** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **27750003
277600** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **27760003
277700** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **27770003
277800** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **27780003
277900******************************************************************27790003
278000 3300-EDIT-SELECTIONS.                                            27800003
278100     EVALUATE TRUE                                                27810003
278200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     27820003
278300             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         27830003
278400                 CONTINUE                                         27840003
278500         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         27850003
278600             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        27860003
278700                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   27870003
278800                 MOVE ASC-TEMP-SELECTED-SW                        27880003
278900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27890003
279000                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  27900003
279100             END-IF                                               27910003
279200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     27920003
279300                 = SPACE                                          27930003
279400             EVALUATE TRUE                                        27940003
279500                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       27950003
279600                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS27960003
279700                     MOVE SPACE TO ASC-SELECTED-SW                27970003
279800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27980003
279900                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        27990003
280000                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    28000003
280100                     MOVE SPACE TO ASC-SELECTED-SW                28010003
280200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28020003
280300                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          28030003
280400                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      28040003
280500                     MOVE SPACE TO ASC-SELECTED-SW                28050003
280600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28060003
280700             END-EVALUATE                                         28070003
280800         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           28080003
280900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            28090003
281000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    28100003
281100             END-IF                                               28110003
281200             PERFORM 3310-EDIT-RANGE                              28120003
281300         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             28130003
281400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            28140003
281500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    28150003
281600             END-IF                                               28160003
281700             PERFORM 3310-EDIT-RANGE                              28170003
281800         WHEN OTHER                                               28180003
281900             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           28190003
282000             SET DP020-MSG-FATAL    TO TRUE                       28200003
282100             MOVE -1                TO MR-SELECTL (PV-SUB)        28210003
282200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  28220003
282300             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        28230003
282400             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        28240003
282500             SET PS-ERROR TO TRUE                                 28250003
282600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            28260003
282700                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     28270003
282800                 MOVE SPACE         TO ASC-SELECTED-SW            28280003
282900                                        (ASC-BLK-SUB ASC-ITEM-SUB)28290003
283000             END-IF                                               28300003
283100     END-EVALUATE.                                                28310003
283200                                                                  28320003
283300     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 28330003
283400     SUBTRACT +1 FROM ASC-ITEM-SUB.                               28340003
283500     IF  ASC-BLK-SUB = 2                                          28350009
283510        IF ASC-ITEM-SUB < 1                                       28351009
283600            SUBTRACT +1 FROM ASC-BLK-SUB                          28360009
283700            MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB             28370009
283710         END-IF                                                   28371009
283800     END-IF.                                                      28380003
283900                                                                  28390003
284000******************************************************************28400003
284100** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **28410003
284200** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **28420003
284300** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**28430003
284400** THE ENDING.                                                  **28440003
284500******************************************************************28450003
284600 3310-EDIT-RANGE.                                                 28460003
284700     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                28470003
284800         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   28480003
284900             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)28490003
285000                                   TO ASC-SELECTED-SW             28500003
285100                                        (ASC-BLK-SUB ASC-ITEM-SUB)28510003
285200             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 28520003
285300         ELSE                                                     28530003
285400             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     28540003
285500                 CONTINUE                                         28550003
285600             ELSE                                                 28560003
285700*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        28570003
285800                 MOVE PC-TSYMSG-00054 TO DP020-MSG-NUMBER         28580003
285900                 SET DP020-MSG-FATAL TO TRUE                      28590003
286000                 MOVE -1           TO MR-SELECTL (PV-SUB)         28600003
286100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              28610003
286200                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         28620003
286300                 MOVE DP015-UNDERLINE TO MR-SELECTH (PV-SUB)      28630003
286400                 SET PS-ERROR      TO TRUE                        28640003
286500             END-IF                                               28650003
286600         END-IF                                                   28660003
286700     ELSE                                                         28670003
286800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     28680003
286900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 28690003
287000                  TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)   28700003
287100             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   28710003
287200         ELSE                                                     28720003
287300             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       28730003
287400                 CONTINUE                                         28740003
287500             ELSE                                                 28750003
287600*                -- ONLY ONE END-OF-RANGE ALLOWED --              28760003
287700                 MOVE PC-TSYMSG-00055 TO DP020-MSG-NUMBER         28770003
287800                 SET DP020-MSG-FATAL TO TRUE                      28780003
287900                 MOVE -1           TO MR-SELECTL (PV-SUB)         28790003
288000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              28800003
288100                 SET PS-ERROR      TO TRUE                        28810003
288200             END-IF                                               28820003
288300         END-IF                                                   28830003
288400     END-IF.                                                      28840003
288500                                                                  28850003
288600******************************************************************28860003
288700** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **28870003
288800** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **28880003
288900******************************************************************28890003
289000 3400-CHECK-RANGE-SEQUENCE.                                       28900003
289100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       28910003
289200       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      28920003
289300       AND  ASC-START-OF-SELECTED-RANGE >                         28930003
289400                                    ASC-END-OF-SELECTED-RANGE     28940009
289500*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                28950003
289600         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 28960003
289700         SET DP020-MSG-FATAL TO TRUE                              28970003
289800         SET PS-ERROR TO TRUE                                     28980003
289900         PERFORM 3410-POSITION-AT-ERROR                           28990003
290000     END-IF.                                                      29000003
290100                                                                  29010003
290200******************************************************************29020003
290300** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **29030003
290400** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **29040003
290500** SHOULD BE POSITIONED ON A RANGE ERROR.                       **29050003
290600******************************************************************29060003
290700 3410-POSITION-AT-ERROR.                                          29070003
290800     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         29080003
290900     COMPUTE PV-SUB-COMP3 = ASC-START-OF-SELECTED-RANGE           29090003
291000                    - PV-TOP-ITEM + 1.                            29100003
291100     MOVE PV-SUB-COMP3 TO PV-SUB.                                 29110003
291200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      29120003
291300         CONTINUE                                                 29130003
291400     ELSE                                                         29140003
291500         MOVE -1                   TO MR-SELECTL (PV-SUB)         29150003
291600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         29160003
291700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         29170003
291800     END-IF.                                                      29180003
291900                                                                  29190003
292000     COMPUTE PV-SUB-COMP3 = ASC-END-OF-SELECTED-RANGE             29200003
292100                    - PV-TOP-ITEM + 1.                            29210003
292200     MOVE PV-SUB-COMP3 TO PV-SUB.                                 29220003
292300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      29230003
292400         CONTINUE                                                 29240003
292500     ELSE                                                         29250003
292600         MOVE -1                   TO MR-SELECTL (PV-SUB)         29260003
292700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         29270003
292800         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         29280003
292900     END-IF.                                                      29290003
293000                                                                  29300003
293100*----------------------------------------------------------------*29310003
293200*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *29320003
293300*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *29330003
293400*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *29340003
293500*----------------------------------------------------------------*29350003
293600 3500-MARK-RANGE-AS-SELECTED.                                     29360003
293700     MOVE +1                       TO  ASC-BLK-SUB.               29370003
293800     PERFORM 3510-MARK-SELECTED-INDS                              29380003
293900         VARYING ASC-ITEM-SUB                                     29390003
294000         FROM 1 BY 1                                              29400003
294100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 29410003
294200                                                                  29420003
294300     ADD +1                        TO ASC-BLK-SUB.                29430003
294400     PERFORM 3510-MARK-SELECTED-INDS                              29440003
294500         VARYING ASC-ITEM-SUB                                     29450003
294600         FROM 1 BY 1                                              29460003
294700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 29470003
294800                                                                  29480003
294900     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER.       29490003
295000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            29500003
295100         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         29510003
295200               PC-ITEMS-PER-PANEL).                               29520003
295300                                                                  29530003
295400     MOVE ASC-START-OF-SELECTED-RANGE                             29540003
295500                                   TO PV-START-OF-SELECTED-RANGE. 29550003
295600     COMPUTE PV-FIRST-BLOCK-IN-RANGE = 1 +                        29560003
295700          ((PV-START-OF-SELECTED-RANGE - 1) / PC-ITEMS-PER-PANEL).29570003
295800                                                                  29580003
295900     MOVE ASC-END-OF-SELECTED-RANGE TO  PV-END-OF-SELECTED-RANGE. 29590003
296000     COMPUTE PV-LAST-BLOCK-IN-RANGE = 1 +                         29600003
296100         ((PV-END-OF-SELECTED-RANGE - 1) / PC-ITEMS-PER-PANEL).   29610003
296200     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             29620003
296300         PV-FIRST-BLOCK-IN-ARRAY + 1.                             29630003
296400                                                                  29640003
296500     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    29650003
296600        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        29660003
296700         MOVE +1                   TO ASC-BLK-SUB                 29670003
296800         PERFORM 5100-WRITE-TEMP-STORAGE                          29680003
296900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         29690003
297000             PV-FIRST-BLOCK-IN-ARRAY - 1                          29700003
297100                                                                  29710003
297200         PERFORM                                                  29720003
297300             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      29730003
297400                   PV-PREV-BLOCK-IN-ARRAY                         29740003
297500             MOVE PV-FIRST-BLOCK-IN-RANGE TO PV-BLOCK-NUMBER      29750003
297600             PERFORM 4410-READ-TEMP-STORAGE                       29760003
297700             PERFORM 3510-MARK-SELECTED-INDS                      29770003
297800                 VARYING ASC-ITEM-SUB                             29780003
297900                 FROM 1 BY 1                                      29790003
298000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          29800003
298100             PERFORM 5100-WRITE-TEMP-STORAGE                      29810003
298200             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     29820003
298300         END-PERFORM                                              29830003
298400                                                                  29840003
298500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         29850003
298600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     29860003
298700         PERFORM                                                  29870003
298800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       29880003
298900                   PV-LAST-BLOCK-IN-RANGE                         29890003
299000             MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER       29900003
299100             PERFORM 4410-READ-TEMP-STORAGE                       29910003
299200             PERFORM 3510-MARK-SELECTED-INDS                      29920003
299300                 VARYING ASC-ITEM-SUB                             29930003
299400                 FROM 1 BY 1                                      29940003
299500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          29950003
299600             PERFORM 5100-WRITE-TEMP-STORAGE                      29960003
299700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      29970003
299800         END-PERFORM                                              29980003
299900                                                                  29990003
300000         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          30000003
300100         PERFORM 4410-READ-TEMP-STORAGE                           30010003
300200     END-IF.                                                      30020003
300300                                                                  30030003
300400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 30040003
300500                                      ASC-END-OF-SELECTED-RANGE.  30050003
300600                                                                  30060003
300700*----------------------------------------------------------------*30070003
300800* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *30080003
300900*----------------------------------------------------------------*30090003
301000 3510-MARK-SELECTED-INDS.                                         30100003
301100     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         30110003
301200         ASC-START-OF-SELECTED-RANGE)                             30120003
301300     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         30130003
301400         ASC-START-OF-SELECTED-RANGE)                             30140003
301500                                                                  30150003
301600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     30160003
301700             ASC-END-OF-SELECTED-RANGE)                           30170003
301800         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     30180003
301900             ASC-END-OF-SELECTED-RANGE)                           30190003
302000                                                                  30200003
302100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          30210003
302200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   30220003
302300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   30230003
302400                     ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE      30240003
302500                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    30250003
302600             END-IF                                               30260003
302700         END-IF                                                   30270003
302800     END-IF.                                                      30280003
302900                                                                  30290003
303000*----------------------------------------------------------------*30300003
303100*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *30310003
303200*    INITIALIZE ALL COUNTERS AND FLAGS.                          *30320003
303300*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *30330003
303400*    DISPLAY THE PANEL TO USER.                                  *30340003
303500*----------------------------------------------------------------*30350003
303600 4000-BUILD-INITIAL-PANEL.                                        30360003
303700     INITIALIZE                 ASC-BLOCK-ENTRIES (1)             30370003
303800                                ASC-BLOCK-ENTRIES (2).            30380003
303900     MOVE +1                 TO ASC-BLK-SUB.                      30390003
304000     SET ASC-ITEMS-LEFT-ON-DB TO TRUE.                            30400003
304100                                                                  30410003
304200     MOVE +0                 TO ASC-ITEM-SUB                      30420003
304300                                ASC-NUMBER-OF-ITEMS-READ          30430003
304400                                ASC-NUMBER-OF-SELECTED-ITEMS      30440003
304500                                ASC-HIGHEST-BLOCK-WRITTEN         30450003
304600                                ASC-START-OF-SELECTED-RANGE       30460003
304700                                ASC-END-OF-SELECTED-RANGE         30470003
304800                                ASC-ITEM-AT-TOP-OF-PANEL.         30480003
304900     PERFORM 4100-PREPARE-CURSOR.                                 30490003
305000                                                                  30500003
305100**** BASED ON THE SELECTED LIST SEQUENCE OPEN APPROPRIATE CSR     30510009
305200**** EITHER PURCHASE ORDER SEQ. OR OLDEST TO NEWEST TRBL SEQ.     30520009
305300     EVALUATE TRUE                                                30530003
305400**** LIST SEQUENCE BY PURCHASE ORDER                              30540029
306000         WHEN PS-USE-DEPT-PO-CSR                                  30600013
306100             PERFORM 4010-OPEN-DEPT-PO-CSR                        30610013
306200             IF SQLCODE           = -913                          30620009
306300                 PERFORM 9910-SQL-913-RETURN                      30630009
306400             END-IF                                               30640009
306500         WHEN PS-USE-BYR-PO-CSR                                   30650013
306600             PERFORM 4015-OPEN-BYR-PO-CSR                         30660013
306700             IF SQLCODE           = -913                          30670009
306800                 PERFORM 9910-SQL-913-RETURN                      30680009
306900             END-IF                                               30690009
307000         WHEN PS-USE-PO-PO-CSR                                    30700019
307100             PERFORM 4025-OPEN-PO-BY-PO-CSR                       30710018
307200             IF SQLCODE           = -913                          30720003
307300                 PERFORM 9900-SQL-913-RETURN                      30730003
307400             END-IF                                               30740003
307410         WHEN PS-USE-FOB-PO-CSR                                   30741013
307420             PERFORM 4026-OPEN-FOB-PO-CSR                         30742013
307430             IF SQLCODE           = -913                          30743013
307440                 PERFORM 9910-SQL-913-RETURN                      30744013
307450             END-IF                                               30745013
307460         WHEN PS-USE-POE-PO-CSR                                   30746013
307470             PERFORM 4027-OPEN-POE-PO-CSR                         30747013
307480             IF SQLCODE           = -913                          30748013
307490                 PERFORM 9910-SQL-913-RETURN                      30749013
307491             END-IF                                               30749113
307492         WHEN PS-USE-OTB-PO-CSR                                   30749213
307493             PERFORM 4028-OPEN-OTB-PO-CSR                         30749313
307494             IF SQLCODE           = -913                          30749413
307495                 PERFORM 9910-SQL-913-RETURN                      30749513
307496             END-IF                                               30749613
307497         WHEN PS-USE-ALL-TRBL-PO-CSR                              30749722
307498             PERFORM 4029-OPEN-ALL-PO-CSR                         30749822
307499             IF SQLCODE           = -913                          30749922
307500                 PERFORM 9910-SQL-913-RETURN                      30750022
307501             END-IF                                               30750122
307510**** LIST SEQUENCE BY OLDEST TO NEWEST TROUBLE                    30751009
308100         WHEN PS-USE-DEPT-TRB-CSR                                 30810009
308200             PERFORM 4035-OPEN-DEPT-TRB-CSR                       30820009
308300             IF SQLCODE           = -913                          30830009
308400                 PERFORM 9910-SQL-913-RETURN                      30840009
308500             END-IF                                               30850009
308600         WHEN PS-USE-BYR-TRB-CSR                                  30860009
308700             PERFORM 4040-OPEN-BYR-TRB-CSR                        30870009
308800             IF SQLCODE           = -913                          30880009
308900                 PERFORM 9910-SQL-913-RETURN                      30890009
309000             END-IF                                               30900009
309100         WHEN PS-USE-PO-TRB-CSR                                   30910019
309200             PERFORM 4045-OPEN-PO-BY-TRB-CSR                      30920022
309300             IF SQLCODE           = -913                          30930009
309400                 PERFORM 9900-SQL-913-RETURN                      30940009
309500             END-IF                                               30950009
309501         WHEN PS-USE-FOB-TRB-CSR                                  30810009
309502             PERFORM 4046-OPEN-FOB-TRB-CSR                        30820009
309503             IF SQLCODE           = -913                          30830009
309504                 PERFORM 9910-SQL-913-RETURN                      30840009
309505             END-IF                                               30850009
309506         WHEN PS-USE-POE-TRB-CSR                                  30810009
309507             PERFORM 4047-OPEN-POE-TRB-CSR                        30820009
309508             IF SQLCODE           = -913                          30830009
309509                 PERFORM 9910-SQL-913-RETURN                      30840009
309510             END-IF                                               30850009
309511         WHEN PS-USE-OTB-TRB-CSR                                  30810009
309512             PERFORM 4048-OPEN-OTB-TRB-CSR                        30820009
309513             IF SQLCODE           = -913                          30830009
309514                 PERFORM 9910-SQL-913-RETURN                      30840009
309515             END-IF                                               30850009
309516         WHEN PS-USE-ALL-TRBL-TRB-CSR                             30951022
309520             PERFORM 4049-OPEN-ALL-BY-TRB-CSR                     30952022
309530             IF SQLCODE           = -913                          30953022
309540                 PERFORM 9900-SQL-913-RETURN                      30954022
309550             END-IF                                               30955022
309600     END-EVALUATE.                                                30960009
309700                                                                  30970003
309800     PERFORM 4300-READ-TROUBLE-NOTIF-FOR-PO.                      30980009
309900                                                                  30990003
310000**** BASED ON THE SELECTED LIST SEQUENCE CLOSE APPROPRIATE CSR    31000009
310100     EVALUATE TRUE                                                31010009
310200**** LIST SEQUENCE BY PURCHASE ORDER                              31020029
310800         WHEN PS-USE-DEPT-PO-CSR                                  31080013
310900             PERFORM 4055-CLOSE-DEPT-PO-CSR                       31090013
311000             IF SQLCODE           = -913                          31100009
311100                 PERFORM 9910-SQL-913-RETURN                      31110009
311200             END-IF                                               31120009
311300         WHEN PS-USE-BYR-PO-CSR                                   31130013
311400             PERFORM 4060-CLOSE-BYR-PO-CSR                        31140013
311500             IF SQLCODE           = -913                          31150009
311600                 PERFORM 9910-SQL-913-RETURN                      31160009
311700             END-IF                                               31170009
311800         WHEN PS-USE-PO-PO-CSR                                    31180019
311900             PERFORM 4070-CLOSE-PO-BY-PO-CSR                      31190018
312000             IF SQLCODE           = -913                          31200009
312100                 PERFORM 9900-SQL-913-RETURN                      31210009
312200             END-IF                                               31220009
312210         WHEN PS-USE-FOB-PO-CSR                                   31221013
312220             PERFORM 4071-CLOSE-FOB-PO-CSR                        31222013
312230             IF SQLCODE           = -913                          31223013
312240                 PERFORM 9910-SQL-913-RETURN                      31224013
312250             END-IF                                               31225013
312260         WHEN PS-USE-POE-PO-CSR                                   31226013
312270             PERFORM 4072-CLOSE-POE-PO-CSR                        31227013
312280             IF SQLCODE           = -913                          31228013
312290                 PERFORM 9910-SQL-913-RETURN                      31229013
312291             END-IF                                               31229113
312292         WHEN PS-USE-OTB-PO-CSR                                   31229213
312293             PERFORM 4073-CLOSE-OTB-PO-CSR                        31229313
312294             IF SQLCODE           = -913                          31229413
312295                 PERFORM 9910-SQL-913-RETURN                      31229513
312296             END-IF                                               31229613
312297         WHEN PS-USE-ALL-TRBL-PO-CSR                              31229213
312298             PERFORM 4074-CLOSE-ALL-TRBL-PO-CSR                   31229313
312299             IF SQLCODE           = -913                          31229413
312300                 PERFORM 9910-SQL-913-RETURN                      31229513
312301             END-IF                                               31229613
312310**** LIST SEQUENCE BY OLDEST TO NEWEST TROUBLE                    31230009
312900         WHEN PS-USE-DEPT-TRB-CSR                                 31290009
313000             PERFORM 4080-CLOSE-DEPT-TRB-CSR                      31300009
313100             IF SQLCODE           = -913                          31310009
313200                 PERFORM 9910-SQL-913-RETURN                      31320009
313300             END-IF                                               31330009
313400         WHEN PS-USE-BYR-TRB-CSR                                  31340009
313500             PERFORM 4085-CLOSE-BYR-TRB-CSR                       31350009
313600             IF SQLCODE           = -913                          31360009
313700                 PERFORM 9910-SQL-913-RETURN                      31370009
313800             END-IF                                               31380009
313900         WHEN PS-USE-PO-TRB-CSR                                   31390019
314000             PERFORM 4095-CLOSE-PO-BY-TRB-CSR                     31400018
314100             IF SQLCODE           = -913                          31410009
314200                 PERFORM 9900-SQL-913-RETURN                      31420009
314300             END-IF                                               31430009
314310         WHEN PS-USE-FOB-TRB-CSR                                  31390019
314320             PERFORM 4096-CLOSE-FOB-TRB-CSR                       31400018
314330             IF SQLCODE           = -913                          31410009
314340                 PERFORM 9900-SQL-913-RETURN                      31420009
314350             END-IF                                               31430009
314360         WHEN PS-USE-POE-TRB-CSR                                  31390019
314370             PERFORM 4097-CLOSE-POE-TRB-CSR                       31400018
314380             IF SQLCODE           = -913                          31410009
314390                 PERFORM 9900-SQL-913-RETURN                      31420009
314391             END-IF                                               31430009
314392         WHEN PS-USE-OTB-TRB-CSR                                  31390019
314393             PERFORM 4098-CLOSE-OTB-TRB-CSR                       31400018
314394             IF SQLCODE           = -913                          31410009
314395                 PERFORM 9900-SQL-913-RETURN                      31420009
314396             END-IF                                               31430009
314397         WHEN PS-USE-ALL-TRBL-TRB-CSR                             31390019
314398             PERFORM 4099-CLOSE-ALL-TRB-CSR                       31400018
314399             IF SQLCODE           = -913                          31410009
314400                 PERFORM 9900-SQL-913-RETURN                      31420009
314401             END-IF                                               31430009
314410     END-EVALUATE.                                                31440009
314500                                                                  31450003
314600     MOVE +1                   TO  PV-TOP-ITEM.                   31460003
314700     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          31470003
314800         SET DP020-NEXT-ACT-APPL-ERROR                            31480003
314900             DP020-MSG-FATAL   TO  TRUE                           31490003
315000         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               31500003
315100     ELSE                                                         31510003
315200         IF  PS-ERROR                                             31520003
315300             NEXT SENTENCE                                        31530003
315400         ELSE                                                     31540003
315500             MOVE -1           TO MR-SELECTL (1)                  31550003
315600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  31560003
315700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 31570003
315800         END-IF                                                   31580003
315900     END-IF.                                                      31590003
316000                                                                  31600003
321600*----------------------------------------------------------------*32160009
321700* OPEN DEPARTMENT BY PO CURSOR.                                  *32170013
321800*----------------------------------------------------------------*32180009
321900 4010-OPEN-DEPT-PO-CSR.                                           32190013
322000     PERFORM                                                      32200009
322100         WITH TEST AFTER                                          32210009
322200         VARYING PV-RETRY-COUNTER                                 32220009
322300         FROM 1 BY 1                                              32230009
322400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32240009
322500                   OR (SQLCODE = ZERO))                           32250009
322600         EXEC SQL                                                 32260009
322700              OPEN DEPT_BY_PO                                     32270022
322800         END-EXEC                                                 32280009
322900                                                                  32290009
323000         EVALUATE TRUE                                            32300009
323100             WHEN SQLCODE = ZERO                                  32310009
323200             WHEN SQLCODE = -904                                  32320009
323300             WHEN SQLCODE = -913                                  32330009
323400                 CONTINUE                                         32340009
323500             WHEN SQLWARN0 NOT = SPACES                           32350009
323600             WHEN SQLCODE < ZERO                                  32360009
323700             WHEN SQLCODE > ZERO                                  32370009
323800                 MOVE '4010-OPEN-DEPT-PO-CSR'                     32380013
323900                                   TO DP013-PARAGRAPH             32390009
324000                 MOVE 'OPEN DEPARTMENT PO CURSOR       '          32400029
324100                                   TO DP013-MESSAGE-TEXT (1)      32410009
324200                 MOVE SQLCA    TO DP013-SQLCA                     32420009
324300                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      32430009
324400                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      32440009
324600                 SET DP013-DB2-ABEND                              32460009
324700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           32470009
324800                 PERFORM DP013-0000-PROCESS-ABEND                 32480009
324900         END-EVALUATE                                             32490009
325000     END-PERFORM.                                                 32500009
325100                                                                  32510009
325200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32520009
325300         IF SQLCODE = -913                                        32530009
325400             PERFORM 9910-SQL-913-RETURN                          32540009
325500         ELSE                                                     32550009
325600             MOVE '4010-OPEN-DEPT-PO-CSR'                         32560013
325700                                   TO DP013-PARAGRAPH             32570009
325800             MOVE                                                 32580009
325900                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 32590009
326000                                   TO DP013-MESSAGE-TEXT (1)      32600009
326100             MOVE SQLCA            TO DP013-SQLCA                 32610009
326200             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    32620009
326300             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    32630009
326500             SET DP013-DB2-ABEND                                  32650009
326600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               32660009
326700             PERFORM DP013-0000-PROCESS-ABEND                     32670009
326800         END-IF                                                   32680009
326900     END-IF.                                                      32690009
327000                                                                  32700009
327100*----------------------------------------------------------------*32710003
327200* OPEN BUYER BY PO CURSOR                                        *32720013
327300*----------------------------------------------------------------*32730003
327400 4015-OPEN-BYR-PO-CSR.                                            32740027
327500     PERFORM                                                      32750003
327600         WITH TEST AFTER                                          32760003
327700         VARYING PV-RETRY-COUNTER                                 32770003
327800         FROM 1 BY 1                                              32780003
327900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32790003
328000                   OR (SQLCODE = ZERO))                           32800003
328100                                                                  32810003
328200         EXEC SQL                                                 32820003
328300              OPEN BUYER_BY_PO                                    32830022
328400         END-EXEC                                                 32840003
328500                                                                  32850003
328600         EVALUATE TRUE                                            32860003
328700             WHEN SQLCODE = ZERO                                  32870003
328800             WHEN SQLCODE = -904                                  32880003
328900             WHEN SQLCODE = -913                                  32890003
329000                 CONTINUE                                         32900003
329100             WHEN SQLWARN0 NOT = SPACES                           32910003
329200             WHEN SQLCODE < ZERO                                  32920003
329300             WHEN SQLCODE > ZERO                                  32930003
329400                 MOVE '4015-OPEN-BYR-PO-CSR       '               32940013
329500                                   TO DP013-PARAGRAPH             32950003
329600                 MOVE 'OPEN TROUBLE BUYER PO CURSOR'              32960029
329700                                   TO DP013-MESSAGE-TEXT (1)      32970003
329800                 MOVE SQLCA    TO DP013-SQLCA                     32980003
329900                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      32990003
330000                 MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (2)      33000003
330100                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (3)      33010003
330300                 SET DP013-DB2-ABEND                              33030003
330400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           33040003
330500                 PERFORM DP013-0000-PROCESS-ABEND                 33050003
330600         END-EVALUATE                                             33060003
330700     END-PERFORM.                                                 33070003
330800                                                                  33080003
330900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33090003
331000         IF SQLCODE = -913                                        33100003
331100             PERFORM 9910-SQL-913-RETURN                          33110003
331200         ELSE                                                     33120003
331300             MOVE '4015-OPEN-BYR-PO-CSR       '                   33130013
331400                                            TO DP013-PARAGRAPH    33140003
331500             MOVE                                                 33150003
331600                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 33160003
331700                                   TO DP013-MESSAGE-TEXT (1)      33170003
331800             MOVE SQLCA            TO DP013-SQLCA                 33180003
331900             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    33190003
332000             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    33200003
332100             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    33210003
332300             SET DP013-DB2-ABEND                                  33230003
332400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33240003
332500             PERFORM DP013-0000-PROCESS-ABEND                     33250003
332600         END-IF                                                   33260003
332700     END-IF.                                                      33270003
332800                                                                  33280003
332900*----------------------------------------------------------------*33290003
333000* OPEN THE PO BY PO CURSOR                                       *33300013
333100*----------------------------------------------------------------*33310003
333200 4025-OPEN-PO-BY-PO-CSR.                                          33320018
333300     PERFORM                                                      33330003
333400         WITH TEST AFTER                                          33340003
333500         VARYING PV-RETRY-COUNTER                                 33350003
333600         FROM 1 BY 1                                              33360003
333700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33370003
333800                   OR (SQLCODE = ZERO))                           33380003
333900                                                                  33390003
334000         EXEC SQL                                                 33400003
334100              OPEN PO_BY_PO                                       33410022
334200         END-EXEC                                                 33420003
334300                                                                  33430003
334400         EVALUATE TRUE                                            33440003
334500             WHEN SQLCODE = ZERO                                  33450003
334600             WHEN SQLCODE = -904                                  33460003
334700             WHEN SQLCODE = -913                                  33470003
334800                 CONTINUE                                         33480003
334900             WHEN SQLWARN0 NOT = SPACES                           33490003
335000             WHEN SQLCODE < ZERO                                  33500003
335100             WHEN SQLCODE > ZERO                                  33510003
335200                 MOVE '4025-OPEN-PO-BY-PO-CSR'                    33520018
335300                                   TO DP013-PARAGRAPH             33530003
335400                 MOVE 'OPEN TROUBLE PO PO CURSORURSOR  '          33540029
335500                                   TO DP013-MESSAGE-TEXT (1)      33550003
335600                 MOVE SQLCA    TO DP013-SQLCA                     33560003
335700                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      33570003
335800                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      33580003
336000                 SET DP013-DB2-ABEND                              33600003
336100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           33610003
336200                 PERFORM DP013-0000-PROCESS-ABEND                 33620003
336300         END-EVALUATE                                             33630003
336400     END-PERFORM.                                                 33640003
336500                                                                  33650003
336600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33660003
336700         IF SQLCODE = -913                                        33670003
336800             PERFORM 9910-SQL-913-RETURN                          33680003
336900         ELSE                                                     33690003
337000             MOVE '4025-OPEN-PO-BY-PO-CSR'    TO DP013-PARAGRAPH  33700018
337100             MOVE                                                 33710003
337200                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 33720003
337300                                    TO DP013-MESSAGE-TEXT (1)     33730003
337400             MOVE SQLCA             TO DP013-SQLCA                33740003
337500             MOVE 'TTRBNTF '        TO DP013-DB2-TABLE-NAME (1)   33750003
337600             MOVE 'TTRBRSN '        TO DP013-DB2-TABLE-NAME (2)   33760003
337800             SET DP013-DB2-ABEND                                  33780003
337900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33790003
338000             PERFORM DP013-0000-PROCESS-ABEND                     33800003
338100         END-IF                                                   33810003
338200     END-IF.                                                      33820003
338300                                                                  33830003
338310*----------------------------------------------------------------*33831013
338320* OPEN FOB BY PO CURSOR.                                         *33832013
338330*----------------------------------------------------------------*33833013
338340 4026-OPEN-FOB-PO-CSR.                                            33834013
338350     PERFORM                                                      33835013
338360         WITH TEST AFTER                                          33836013
338370         VARYING PV-RETRY-COUNTER                                 33837013
338380         FROM 1 BY 1                                              33838013
338390         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33839013
338391                   OR (SQLCODE = ZERO))                           33839113
338392         EXEC SQL                                                 33839213
338393              OPEN FOB_BY_PO                                      33839322
338394         END-EXEC                                                 33839413
338395                                                                  33839513
338396         EVALUATE TRUE                                            33839613
338397             WHEN SQLCODE = ZERO                                  33839713
338398             WHEN SQLCODE = -904                                  33839813
338399             WHEN SQLCODE = -913                                  33839913
338400                 CONTINUE                                         33840013
338401             WHEN SQLWARN0 NOT = SPACES                           33840113
338402             WHEN SQLCODE < ZERO                                  33840213
338403             WHEN SQLCODE > ZERO                                  33840313
338404                 MOVE '4026-OPEN-FOB-PO-CSR'                      33840413
338405                                   TO DP013-PARAGRAPH             33840513
338406                 MOVE 'OPEN FOB PO CURSOR              '          33840613
338407                                   TO DP013-MESSAGE-TEXT (1)      33840713
338408                 MOVE SQLCA    TO DP013-SQLCA                     33840813
338409                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      33840913
338410                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      33841013
338412                 SET DP013-DB2-ABEND                              33841213
338413                     DP013-XCTL-DISPLAY-RESTART TO TRUE           33841313
338414                 PERFORM DP013-0000-PROCESS-ABEND                 33841413
338415         END-EVALUATE                                             33841513
338416     END-PERFORM.                                                 33841613
338417                                                                  33841713
338418     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33841813
338419         IF SQLCODE = -913                                        33841913
338420             PERFORM 9910-SQL-913-RETURN                          33842013
338421         ELSE                                                     33842113
338422             MOVE '4026-OPEN-FOB-PO-CSR'                          33842213
338423                                   TO DP013-PARAGRAPH             33842313
338424             MOVE                                                 33842413
338425                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 33842513
338426                                   TO DP013-MESSAGE-TEXT (1)      33842613
338427             MOVE SQLCA            TO DP013-SQLCA                 33842713
338428             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    33842813
338429             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    33842913
338431             SET DP013-DB2-ABEND                                  33843113
338432                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33843213
338433             PERFORM DP013-0000-PROCESS-ABEND                     33843313
338434         END-IF                                                   33843413
338435     END-IF.                                                      33843513
338436                                                                  33843613
338437*----------------------------------------------------------------*33843713
338438* OPEN POE BY PO CURSOR.                                         *33843813
338439*----------------------------------------------------------------*33843913
338440 4027-OPEN-POE-PO-CSR.                                            33844013
338441     PERFORM                                                      33844113
338442         WITH TEST AFTER                                          33844213
338443         VARYING PV-RETRY-COUNTER                                 33844313
338444         FROM 1 BY 1                                              33844413
338445         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33844513
338446                   OR (SQLCODE = ZERO))                           33844613
338447         EXEC SQL                                                 33844713
338448              OPEN POE_BY_PO                                      33844822
338449         END-EXEC                                                 33844913
338450                                                                  33845013
338451         EVALUATE TRUE                                            33845113
338452             WHEN SQLCODE = ZERO                                  33845213
338453             WHEN SQLCODE = -904                                  33845313
338454             WHEN SQLCODE = -913                                  33845413
338455                 CONTINUE                                         33845513
338456             WHEN SQLWARN0 NOT = SPACES                           33845613
338457             WHEN SQLCODE < ZERO                                  33845713
338458             WHEN SQLCODE > ZERO                                  33845813
338459                 MOVE '4027-OPEN-POE-PO-CSR'                      33845913
338460                                   TO DP013-PARAGRAPH             33846013
338461                 MOVE 'OPEN POE PO CURSOR              '          33846113
338462                                   TO DP013-MESSAGE-TEXT (1)      33846213
338463                 MOVE SQLCA    TO DP013-SQLCA                     33846313
338464                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      33846413
338465                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      33846513
338467                 SET DP013-DB2-ABEND                              33846713
338468                     DP013-XCTL-DISPLAY-RESTART TO TRUE           33846813
338469                 PERFORM DP013-0000-PROCESS-ABEND                 33846913
338470         END-EVALUATE                                             33847013
338471     END-PERFORM.                                                 33847113
338472                                                                  33847213
338473     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33847313
338474         IF SQLCODE = -913                                        33847413
338475             PERFORM 9910-SQL-913-RETURN                          33847513
338476         ELSE                                                     33847613
338477             MOVE '4027-OPEN-POE-PO-CSR'                          33847713
338478                                   TO DP013-PARAGRAPH             33847813
338479             MOVE                                                 33847913
338480                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 33848013
338481                                   TO DP013-MESSAGE-TEXT (1)      33848113
338482             MOVE SQLCA            TO DP013-SQLCA                 33848213
338483             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    33848313
338484             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    33848413
338486             SET DP013-DB2-ABEND                                  33848613
338487                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33848713
338488             PERFORM DP013-0000-PROCESS-ABEND                     33848813
338489         END-IF                                                   33848913
338490     END-IF.                                                      33849013
338491                                                                  33849113
338492*----------------------------------------------------------------*33849213
338493* OPEN OTB BY PO CURSOR.                                         *33849313
338494*----------------------------------------------------------------*33849413
338495 4028-OPEN-OTB-PO-CSR.                                            33849513
338496     PERFORM                                                      33849613
338497         WITH TEST AFTER                                          33849713
338498         VARYING PV-RETRY-COUNTER                                 33849813
338499         FROM 1 BY 1                                              33849913
338500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33850013
338501                   OR (SQLCODE = ZERO))                           33850113
338502         EXEC SQL                                                 33850213
338503              OPEN OTB_BY_PO                                      33850322
338504         END-EXEC                                                 33850413
338505                                                                  33850513
338506         EVALUATE TRUE                                            33850613
338507             WHEN SQLCODE = ZERO                                  33850713
338508             WHEN SQLCODE = -904                                  33850813
338509             WHEN SQLCODE = -913                                  33850913
338510                 CONTINUE                                         33851013
338511             WHEN SQLWARN0 NOT = SPACES                           33851113
338512             WHEN SQLCODE < ZERO                                  33851213
338513             WHEN SQLCODE > ZERO                                  33851313
338514                 MOVE '4028-OPEN-OTB-PO-CSR'                      33851413
338515                                   TO DP013-PARAGRAPH             33851513
338516                 MOVE 'OPEN OTB PO CURSOR              '          33851613
338517                                   TO DP013-MESSAGE-TEXT (1)      33851713
338518                 MOVE SQLCA    TO DP013-SQLCA                     33851813
338519                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      33851913
338520                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      33852013
338522                 SET DP013-DB2-ABEND                              33852213
338523                     DP013-XCTL-DISPLAY-RESTART TO TRUE           33852313
338524                 PERFORM DP013-0000-PROCESS-ABEND                 33852413
338525         END-EVALUATE                                             33852513
338526     END-PERFORM.                                                 33852613
338527                                                                  33852713
338528     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33852813
338529         IF SQLCODE = -913                                        33852913
338530             PERFORM 9910-SQL-913-RETURN                          33853013
338531         ELSE                                                     33853113
338532             MOVE '4028-OPEN-OTB-PO-CSR'                          33853213
338533                                   TO DP013-PARAGRAPH             33853313
338534             MOVE                                                 33853413
338535                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 33853513
338536                                   TO DP013-MESSAGE-TEXT (1)      33853613
338537             MOVE SQLCA            TO DP013-SQLCA                 33853713
338538             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    33853813
338539             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    33853913
338541             SET DP013-DB2-ABEND                                  33854113
338542                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33854213
338543             PERFORM DP013-0000-PROCESS-ABEND                     33854313
338544         END-IF                                                   33854413
338545     END-IF.                                                      33854513
338546                                                                  33854613
338547*----------------------------------------------------------------*33854727
338548* OPEN ALL TROUBLE BY PO CURSOR                                  *33854827
338549*----------------------------------------------------------------*33854927
338550 4029-OPEN-ALL-PO-CSR.                                            33855027
338551     PERFORM                                                      33855127
338552         WITH TEST AFTER                                          33855227
338553         VARYING PV-RETRY-COUNTER                                 33855327
338554         FROM 1 BY 1                                              33855427
338555         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33855527
338556                   OR (SQLCODE = ZERO))                           33855627
338557         EXEC SQL                                                 33855727
338558              OPEN ALL_BY_PO                                      33855827
338559         END-EXEC                                                 33855927
338560                                                                  33856027
338561         EVALUATE TRUE                                            33856127
338562             WHEN SQLCODE = ZERO                                  33856227
338563             WHEN SQLCODE = -904                                  33856327
338564             WHEN SQLCODE = -913                                  33856427
338565                 CONTINUE                                         33856527
338566             WHEN SQLWARN0 NOT = SPACES                           33856627
338567             WHEN SQLCODE < ZERO                                  33856727
338568             WHEN SQLCODE > ZERO                                  33856827
338569                 MOVE '4029-OPEN-ALL-PO-CSR'                      33856927
338570                                   TO DP013-PARAGRAPH             33857027
338571                 MOVE 'OPEN ALL TROUBLE PO CURSOR      '          33857127
338572                                   TO DP013-MESSAGE-TEXT (1)      33857227
338573                 MOVE SQLCA    TO DP013-SQLCA                     33857327
338574                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      33857427
338575                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      33857527
338577                 SET DP013-DB2-ABEND                              33857727
338578                     DP013-XCTL-DISPLAY-RESTART TO TRUE           33857827
338579                 PERFORM DP013-0000-PROCESS-ABEND                 33857927
338580         END-EVALUATE                                             33858027
338581     END-PERFORM.                                                 33858127
338582                                                                  33858227
338583     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33858327
338584         IF SQLCODE = -913                                        33858427
338585             PERFORM 9910-SQL-913-RETURN                          33858527
338586         ELSE                                                     33858627
338587             MOVE '4029-OPEN-ALL-PO-CSR'                          33858727
338588                                   TO DP013-PARAGRAPH             33858827
338589             MOVE                                                 33858927
338590                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 33859027
338591                                   TO DP013-MESSAGE-TEXT (1)      33859127
338592             MOVE SQLCA            TO DP013-SQLCA                 33859227
338593             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    33859327
338594             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    33859427
338596             SET DP013-DB2-ABEND                                  33859627
338597                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33859727
338598             PERFORM DP013-0000-PROCESS-ABEND                     33859827
338599         END-IF                                                   33859927
338600     END-IF.                                                      33860027
338601                                                                  33860127
343900*----------------------------------------------------------------*34390009
344000* OPEN DEPARTMENT BY OLDEST TO NEWEST TROUBLE  CURSOR            *34400009
344100*----------------------------------------------------------------*34410009
344200 4035-OPEN-DEPT-TRB-CSR.                                          34420009
344300     PERFORM                                                      34430009
344400         WITH TEST AFTER                                          34440009
344500         VARYING PV-RETRY-COUNTER                                 34450009
344600         FROM 1 BY 1                                              34460009
344700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34470009
344800                   OR (SQLCODE = ZERO))                           34480009
344900         EXEC SQL                                                 34490009
345000              OPEN DEPT_BY_TRBL                                   34500022
345100         END-EXEC                                                 34510009
345200                                                                  34520009
345300         EVALUATE TRUE                                            34530009
345400             WHEN SQLCODE = ZERO                                  34540009
345500             WHEN SQLCODE = -904                                  34550009
345600             WHEN SQLCODE = -913                                  34560009
345700                 CONTINUE                                         34570009
345800             WHEN SQLWARN0 NOT = SPACES                           34580009
345900             WHEN SQLCODE < ZERO                                  34590009
346000             WHEN SQLCODE > ZERO                                  34600009
346100                 MOVE '4035-OPEN-DEPT-TRB-CSR'                    34610009
346200                                   TO DP013-PARAGRAPH             34620009
346300                 MOVE 'OPEN TROUBLE DEPARTMENT CURSOR  '          34630015
346400                                   TO DP013-MESSAGE-TEXT (1)      34640009
346500                 MOVE SQLCA    TO DP013-SQLCA                     34650009
346600                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      34660009
346700                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      34670009
346900                 SET DP013-DB2-ABEND                              34690009
347000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           34700009
347100                 PERFORM DP013-0000-PROCESS-ABEND                 34710009
347200         END-EVALUATE                                             34720009
347300     END-PERFORM.                                                 34730009
347400                                                                  34740009
347500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        34750009
347600         IF SQLCODE = -913                                        34760009
347700             PERFORM 9910-SQL-913-RETURN                          34770009
347800         ELSE                                                     34780009
347900             MOVE '4035-OPEN-DEPT-TRB-CSR'                        34790023
348000                                   TO DP013-PARAGRAPH             34800009
348100             MOVE                                                 34810009
348200                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 34820009
348300                                   TO DP013-MESSAGE-TEXT (1)      34830009
348400             MOVE SQLCA            TO DP013-SQLCA                 34840009
348500             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    34850009
348600             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    34860009
348800             SET DP013-DB2-ABEND                                  34880009
348900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               34890009
349000             PERFORM DP013-0000-PROCESS-ABEND                     34900009
349100         END-IF                                                   34910009
349200     END-IF.                                                      34920009
349300                                                                  34930009
349400*----------------------------------------------------------------*34940009
349500* OPEN BUYER BY OLDEST TO NEWEST TROUBLE  CURSOR                 *34950009
349600*----------------------------------------------------------------*34960009
349700 4040-OPEN-BYR-TRB-CSR.                                           34970009
349800     PERFORM                                                      34980009
349900         WITH TEST AFTER                                          34990009
350000         VARYING PV-RETRY-COUNTER                                 35000009
350100         FROM 1 BY 1                                              35010009
350200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35020009
350300                   OR (SQLCODE = ZERO))                           35030009
350400                                                                  35040009
350500         EXEC SQL                                                 35050009
350600              OPEN BUYER_BY_TRBL                                  35060022
350700         END-EXEC                                                 35070009
350800                                                                  35080009
350900         EVALUATE TRUE                                            35090009
351000             WHEN SQLCODE = ZERO                                  35100009
351100             WHEN SQLCODE = -904                                  35110009
351200             WHEN SQLCODE = -913                                  35120009
351300                 CONTINUE                                         35130009
351400             WHEN SQLWARN0 NOT = SPACES                           35140009
351500             WHEN SQLCODE < ZERO                                  35150009
351600             WHEN SQLCODE > ZERO                                  35160009
351700                 MOVE '4040-OPEN-BYR-TRB-CSR      '               35170025
351800                                   TO DP013-PARAGRAPH             35180009
351900                 MOVE 'OPEN TROUBLE BUYER BY TRBL CURSOR'         35190009
352000                                   TO DP013-MESSAGE-TEXT (1)      35200009
352100                 MOVE SQLCA    TO DP013-SQLCA                     35210009
352200                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      35220009
352300                 MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (2)      35230009
352400                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (3)      35240009
352600                 SET DP013-DB2-ABEND                              35260009
352700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35270009
352800                 PERFORM DP013-0000-PROCESS-ABEND                 35280009
352900         END-EVALUATE                                             35290009
353000     END-PERFORM.                                                 35300009
353100                                                                  35310009
353200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35320009
353300         IF SQLCODE = -913                                        35330009
353400             PERFORM 9910-SQL-913-RETURN                          35340009
353500         ELSE                                                     35350009
353600             MOVE '4040-OPEN-BYR-TRB-CSR      '                   35360009
353700                                            TO DP013-PARAGRAPH    35370009
353800             MOVE                                                 35380009
353900                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 35390009
354000                                   TO DP013-MESSAGE-TEXT (1)      35400009
354100             MOVE SQLCA            TO DP013-SQLCA                 35410009
354200             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    35420009
354300             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    35430009
354400             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    35440009
354600             SET DP013-DB2-ABEND                                  35460009
354700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               35470009
354800             PERFORM DP013-0000-PROCESS-ABEND                     35480009
354900         END-IF                                                   35490009
355000     END-IF.                                                      35500009
355100                                                                  35510009
355200*----------------------------------------------------------------*35520009
355300* OPEN THE PO BY OLDEST TO NEWEST TROUBLE CURSOR                 *35530018
355400*----------------------------------------------------------------*35540009
355500 4045-OPEN-PO-BY-TRB-CSR.                                         35550022
355600     PERFORM                                                      35560009
355700         WITH TEST AFTER                                          35570009
355800         VARYING PV-RETRY-COUNTER                                 35580009
355900         FROM 1 BY 1                                              35590009
356000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35600009
356100                   OR (SQLCODE = ZERO))                           35610009
356200                                                                  35620009
356300         EXEC SQL                                                 35630009
356400              OPEN PO_BY_TRBL                                     35640022
356500         END-EXEC                                                 35650009
356600                                                                  35660009
356700         EVALUATE TRUE                                            35670009
356800             WHEN SQLCODE = ZERO                                  35680009
356900             WHEN SQLCODE = -904                                  35690009
357000             WHEN SQLCODE = -913                                  35700009
357100                 CONTINUE                                         35710009
357200             WHEN SQLWARN0 NOT = SPACES                           35720009
357300             WHEN SQLCODE < ZERO                                  35730009
357400             WHEN SQLCODE > ZERO                                  35740009
357500                 MOVE '4045-OPEN-PO-BY-TRB-CSR'                   35750022
357600                                   TO DP013-PARAGRAPH             35760009
357700                 MOVE 'OPEN TROUBLE PO BY TRBL CURSOR  '          35770009
357800                                   TO DP013-MESSAGE-TEXT (1)      35780009
357900                 MOVE SQLCA    TO DP013-SQLCA                     35790009
358000                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      35800009
358100                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      35810009
358300                 SET DP013-DB2-ABEND                              35830009
358400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35840009
358500                 PERFORM DP013-0000-PROCESS-ABEND                 35850009
358600         END-EVALUATE                                             35860009
358700     END-PERFORM.                                                 35870009
358800                                                                  35880009
358900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35890009
359000         IF SQLCODE = -913                                        35900009
359100             PERFORM 9910-SQL-913-RETURN                          35910009
359200         ELSE                                                     35920009
359300             MOVE '4045-OPEN-PO-BY-TRB-CSR'   TO DP013-PARAGRAPH  35930022
359400             MOVE                                                 35940009
359500                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 35950009
359600                                    TO DP013-MESSAGE-TEXT (1)     35960009
359700             MOVE SQLCA             TO DP013-SQLCA                35970009
359800             MOVE 'TTRBNTF '        TO DP013-DB2-TABLE-NAME (1)   35980009
359900             MOVE 'TTRBRSN '        TO DP013-DB2-TABLE-NAME (2)   35990009
360100             SET DP013-DB2-ABEND                                  36010009
360200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36020009
360300             PERFORM DP013-0000-PROCESS-ABEND                     36030009
360400         END-IF                                                   36040009
360500     END-IF.                                                      36050009
360600                                                                  36060009
360601*----------------------------------------------------------------*35520009
360602* OPEN THE FOB BY OLDEST TO NEWEST TROUBLE CURSOR                *35530018
360603*----------------------------------------------------------------*35540009
360604 4046-OPEN-FOB-TRB-CSR.                                           35550022
360605     PERFORM                                                      35560009
360606         WITH TEST AFTER                                          35570009
360607         VARYING PV-RETRY-COUNTER                                 35580009
360608         FROM 1 BY 1                                              35590009
360609         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35600009
360610                   OR (SQLCODE = ZERO))                           35610009
360611                                                                  35620009
360612         EXEC SQL                                                 35630009
360613              OPEN FOB_BY_TRBL                                    35640022
360614         END-EXEC                                                 35650009
360615                                                                  35660009
360616         EVALUATE TRUE                                            35670009
360617             WHEN SQLCODE = ZERO                                  35680009
360618             WHEN SQLCODE = -904                                  35690009
360619             WHEN SQLCODE = -913                                  35700009
360620                 CONTINUE                                         35710009
360621             WHEN SQLWARN0 NOT = SPACES                           35720009
360622             WHEN SQLCODE < ZERO                                  35730009
360623             WHEN SQLCODE > ZERO                                  35740009
360624                 MOVE '4046-OPEN-FOB-TRB-CSR'                     35750022
360625                                   TO DP013-PARAGRAPH             35760009
360626                 MOVE 'OPEN TROUBLE FOB BY TRBL CURSOR '          35770009
360627                                   TO DP013-MESSAGE-TEXT (1)      35780009
360628                 MOVE SQLCA    TO DP013-SQLCA                     35790009
360629                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      35800009
360630                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      35810009
360632                 SET DP013-DB2-ABEND                              35830009
360633                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35840009
360634                 PERFORM DP013-0000-PROCESS-ABEND                 35850009
360635         END-EVALUATE                                             35860009
360636     END-PERFORM.                                                 35870009
360637                                                                  35880009
360638     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35890009
360639         IF SQLCODE = -913                                        35900009
360640             PERFORM 9910-SQL-913-RETURN                          35910009
360641         ELSE                                                     35920009
360642             MOVE '4046-OPEN-FOB-TRB-CSR'     TO DP013-PARAGRAPH  35930022
360643             MOVE                                                 35940009
360644                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 35950009
360645                                    TO DP013-MESSAGE-TEXT (1)     35960009
360646             MOVE SQLCA             TO DP013-SQLCA                35970009
360647             MOVE 'TTRBNTF '        TO DP013-DB2-TABLE-NAME (1)   35980009
360648             MOVE 'TTRBRSN '        TO DP013-DB2-TABLE-NAME (2)   35990009
360650             SET DP013-DB2-ABEND                                  36010009
360651                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36020009
360652             PERFORM DP013-0000-PROCESS-ABEND                     36030009
360653         END-IF                                                   36040009
360654     END-IF.                                                      36050009
360655                                                                  36060009
360656*----------------------------------------------------------------*35520009
360657* OPEN THE POE BY OLDEST TO NEWEST TROUBLE CURSOR                *35530018
360658*----------------------------------------------------------------*35540009
360659 4047-OPEN-POE-TRB-CSR.                                           35550022
360660     PERFORM                                                      35560009
360661         WITH TEST AFTER                                          35570009
360662         VARYING PV-RETRY-COUNTER                                 35580009
360663         FROM 1 BY 1                                              35590009
360664         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35600009
360665                   OR (SQLCODE = ZERO))                           35610009
360666                                                                  35620009
360667         EXEC SQL                                                 35630009
360668              OPEN POE_BY_TRBL                                    35640022
360669         END-EXEC                                                 35650009
360670                                                                  35660009
360671         EVALUATE TRUE                                            35670009
360672             WHEN SQLCODE = ZERO                                  35680009
360673             WHEN SQLCODE = -904                                  35690009
360674             WHEN SQLCODE = -913                                  35700009
360675                 CONTINUE                                         35710009
360676             WHEN SQLWARN0 NOT = SPACES                           35720009
360677             WHEN SQLCODE < ZERO                                  35730009
360678             WHEN SQLCODE > ZERO                                  35740009
360679                 MOVE '4047-OPEN-POE-TRB-CSR'                     35750022
360680                                   TO DP013-PARAGRAPH             35760009
360681                 MOVE 'OPEN TROUBLE POE BY TRBL CURSOR '          35770009
360682                                   TO DP013-MESSAGE-TEXT (1)      35780009
360683                 MOVE SQLCA    TO DP013-SQLCA                     35790009
360684                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      35800009
360685                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      35810009
360686                 SET DP013-DB2-ABEND                              35830009
360687                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35840009
360688                 PERFORM DP013-0000-PROCESS-ABEND                 35850009
360689         END-EVALUATE                                             35860009
360690     END-PERFORM.                                                 35870009
360691                                                                  35880009
360692     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35890009
360693         IF SQLCODE = -913                                        35900009
360694             PERFORM 9910-SQL-913-RETURN                          35910009
360695         ELSE                                                     35920009
360696             MOVE '4047-OPEN-POE-TRB-CSR'     TO DP013-PARAGRAPH  35930022
360697             MOVE                                                 35940009
360698                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 35950009
360699                                    TO DP013-MESSAGE-TEXT (1)     35960009
360700             MOVE SQLCA             TO DP013-SQLCA                35970009
360701             MOVE 'TTRBNTF '        TO DP013-DB2-TABLE-NAME (1)   35980009
360702             MOVE 'TTRBRSN '        TO DP013-DB2-TABLE-NAME (2)   35990009
360703             SET DP013-DB2-ABEND                                  36010009
360704                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36020009
360705             PERFORM DP013-0000-PROCESS-ABEND                     36030009
360706         END-IF                                                   36040009
360707     END-IF.                                                      36050009
360708                                                                  36060009
360709*----------------------------------------------------------------*35520009
360710* OPEN THE OTB BY OLDEST TO NEWEST TROUBLE CURSOR                *35530018
360711*----------------------------------------------------------------*35540009
360712 4048-OPEN-OTB-TRB-CSR.                                           35550022
360713     PERFORM                                                      35560009
360714         WITH TEST AFTER                                          35570009
360715         VARYING PV-RETRY-COUNTER                                 35580009
360716         FROM 1 BY 1                                              35590009
360717         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35600009
360718                   OR (SQLCODE = ZERO))                           35610009
360719                                                                  35620009
360720         EXEC SQL                                                 35630009
360721              OPEN OTB_BY_TRBL                                    35640022
360722         END-EXEC                                                 35650009
360723                                                                  35660009
360724         EVALUATE TRUE                                            35670009
360725             WHEN SQLCODE = ZERO                                  35680009
360726             WHEN SQLCODE = -904                                  35690009
360727             WHEN SQLCODE = -913                                  35700009
360728                 CONTINUE                                         35710009
360729             WHEN SQLWARN0 NOT = SPACES                           35720009
360730             WHEN SQLCODE < ZERO                                  35730009
360731             WHEN SQLCODE > ZERO                                  35740009
360732                 MOVE '4048-OPEN-OTB-TRB-CSR'                     35750022
360733                                   TO DP013-PARAGRAPH             35760009
360734                 MOVE 'OPEN TROUBLE OTB BY TRBL CURSOR '          35770009
360735                                   TO DP013-MESSAGE-TEXT (1)      35780009
360736                 MOVE SQLCA    TO DP013-SQLCA                     35790009
360737                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      35800009
360738                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      35810009
360739                 SET DP013-DB2-ABEND                              35830009
360740                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35840009
360741                 PERFORM DP013-0000-PROCESS-ABEND                 35850009
360742         END-EVALUATE                                             35860009
360743     END-PERFORM.                                                 35870009
360744                                                                  35880009
360745     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35890009
360746         IF SQLCODE = -913                                        35900009
360747             PERFORM 9910-SQL-913-RETURN                          35910009
360748         ELSE                                                     35920009
360749             MOVE '4048-OPEN-OTB-TRB-CSR'     TO DP013-PARAGRAPH  35930022
360750             MOVE                                                 35940009
360751                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 35950009
360752                                    TO DP013-MESSAGE-TEXT (1)     35960009
360753             MOVE SQLCA             TO DP013-SQLCA                35970009
360754             MOVE 'TTRBNTF '        TO DP013-DB2-TABLE-NAME (1)   35980009
360755             MOVE 'TTRBRSN '        TO DP013-DB2-TABLE-NAME (2)   35990009
360756             SET DP013-DB2-ABEND                                  36010009
360757                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36020009
360758             PERFORM DP013-0000-PROCESS-ABEND                     36030009
360759         END-IF                                                   36040009
360760     END-IF.                                                      36050009
360761                                                                  36060009
360762*----------------------------------------------------------------*36061022
360763* OPEN ALL TROUBLE FROM OLDEST TO NEWEST TROUBLE CURSOR          *36062022
360764*----------------------------------------------------------------*36063022
360765 4049-OPEN-ALL-BY-TRB-CSR.                                        36064022
360766     PERFORM                                                      36065022
360767         WITH TEST AFTER                                          36066022
360768         VARYING PV-RETRY-COUNTER                                 36067022
360769         FROM 1 BY 1                                              36068022
360770         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36069022
360771                   OR (SQLCODE = ZERO))                           36069122
360772                                                                  36069222
360773         EXEC SQL                                                 36069322
360774              OPEN ALL_BY_TRBL                                    36069422
360775         END-EXEC                                                 36069522
360776                                                                  36069622
360777         EVALUATE TRUE                                            36069722
360778             WHEN SQLCODE = ZERO                                  36069822
360779             WHEN SQLCODE = -904                                  36069922
360780             WHEN SQLCODE = -913                                  36070022
360781                 CONTINUE                                         36070122
360782             WHEN SQLWARN0 NOT = SPACES                           36070222
360783             WHEN SQLCODE < ZERO                                  36070322
360784             WHEN SQLCODE > ZERO                                  36070422
360785                 MOVE '4049-OPEN-ALL-BY-TRB-CSR'                  36070522
360786                                   TO DP013-PARAGRAPH             36070622
360787                 MOVE 'OPEN ALL TROUBLE BY TRBL CURSOR '          36070722
360788                                   TO DP013-MESSAGE-TEXT (1)      36070822
360789                 MOVE SQLCA    TO DP013-SQLCA                     36070922
360790                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      36071022
360791                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      36071122
360793                 SET DP013-DB2-ABEND                              36071322
360794                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36071422
360795                 PERFORM DP013-0000-PROCESS-ABEND                 36071522
360796         END-EVALUATE                                             36071622
360797     END-PERFORM.                                                 36071722
360798                                                                  36071822
360799     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36071922
360800         IF SQLCODE = -913                                        36072022
360801             PERFORM 9910-SQL-913-RETURN                          36072122
360802         ELSE                                                     36072222
360803             MOVE '4049-OPEN-ALL-BY-TRB-CSR'   TO DP013-PARAGRAPH 36072322
360804             MOVE                                                 36072422
360805                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 36072522
360806                                    TO DP013-MESSAGE-TEXT (1)     36072622
360807             MOVE SQLCA             TO DP013-SQLCA                36072722
360808             MOVE 'TTRBNTF '        TO DP013-DB2-TABLE-NAME (1)   36072822
360809             MOVE 'TTRBRSN '        TO DP013-DB2-TABLE-NAME (2)   36072922
360811             SET DP013-DB2-ABEND                                  36073122
360812                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36073222
360813             PERFORM DP013-0000-PROCESS-ABEND                     36073322
360814         END-IF                                                   36073422
360820     END-IF.                                                      36073522
360900                                                                  36073622
363400*----------------------------------------------------------------*36340009
363500* CLOSE THE DEPARTMENT BY PO CURSOR                              *36350013
363600*----------------------------------------------------------------*36360009
363700 4055-CLOSE-DEPT-PO-CSR.                                          36370013
363800     EXEC SQL                                                     36380009
363900         CLOSE DEPT_BY_PO                                         36390023
364000     END-EXEC                                                     36400009
364100                                                                  36410009
364200     EVALUATE TRUE                                                36420009
364300         WHEN SQLCODE = ZERO                                      36430009
364400             CONTINUE                                             36440009
364500         WHEN SQLWARN0 NOT = SPACES                               36450009
364600         WHEN SQLCODE < ZERO                                      36460009
364700         WHEN SQLCODE > ZERO                                      36470009
364800             MOVE '4055-CLOSE-DEPT-PO-CSR'  TO DP013-PARAGRAPH    36480013
364900             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      36490009
365000                               TO DP013-MESSAGE-TEXT (1)          36500009
365100             MOVE SQLCA        TO DP013-SQLCA                     36510009
365200             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          36520009
365300             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          36530009
365500             SET DP013-DB2-ABEND                                  36550009
365600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36560009
365700             PERFORM DP013-0000-PROCESS-ABEND                     36570009
365800     END-EVALUATE.                                                36580009
365900                                                                  36590009
366000                                                                  36600009
366100*----------------------------------------------------------------*36610003
366200* CLOSE THE BUYER BY PO CURSOR                                   *36620013
366300*----------------------------------------------------------------*36630003
366400 4060-CLOSE-BYR-PO-CSR.                                           36640013
366500     EXEC SQL                                                     36650003
366600         CLOSE BUYER_BY_PO                                        36660023
366700     END-EXEC                                                     36670003
366800                                                                  36680003
366900     EVALUATE TRUE                                                36690003
367000         WHEN SQLCODE = ZERO                                      36700003
367100             CONTINUE                                             36710003
367200         WHEN SQLWARN0 NOT = SPACES                               36720003
367300         WHEN SQLCODE < ZERO                                      36730003
367400         WHEN SQLCODE > ZERO                                      36740003
367500             MOVE '4060-CLOSE-BYR-PO-CSR'  TO DP013-PARAGRAPH     36750013
367600             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      36760003
367700                               TO DP013-MESSAGE-TEXT (1)          36770003
367800             MOVE SQLCA        TO DP013-SQLCA                     36780003
367900             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          36790003
368000             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    36800003
368100             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    36810003
368300             SET DP013-DB2-ABEND                                  36830003
368400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36840003
368500             PERFORM DP013-0000-PROCESS-ABEND                     36850003
368600     END-EVALUATE.                                                36860003
368700                                                                  36870003
368800*----------------------------------------------------------------*36880009
368900* CLOSE THE PO BY PO CURSOR                                      *36890013
369000*----------------------------------------------------------------*36900009
369100 4070-CLOSE-PO-BY-PO-CSR.                                         36910018
369200     EXEC SQL                                                     36920003
369300         CLOSE PO_BY_PO                                           36930023
369400     END-EXEC                                                     36940003
369500                                                                  36950003
369600     EVALUATE TRUE                                                36960003
369700         WHEN SQLCODE = ZERO                                      36970003
369800             CONTINUE                                             36980003
369900         WHEN SQLWARN0 NOT = SPACES                               36990003
370000         WHEN SQLCODE < ZERO                                      37000003
370100         WHEN SQLCODE > ZERO                                      37010003
370200             MOVE '4070-CLOSE-PO-BY-PO-CSR'    TO DP013-PARAGRAPH 37020018
370300             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      37030003
370400                               TO DP013-MESSAGE-TEXT (1)          37040003
370500             MOVE SQLCA        TO DP013-SQLCA                     37050003
370600             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          37060003
370700             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          37070003
370900             SET DP013-DB2-ABEND                                  37090003
371000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37100003
371100             PERFORM DP013-0000-PROCESS-ABEND                     37110003
371200     END-EVALUATE.                                                37120003
371300                                                                  37130003
371310*----------------------------------------------------------------*37131013
371320* CLOSE THE FOB BY PO CURSOR                                     *37132013
371330*----------------------------------------------------------------*37133013
371340 4071-CLOSE-FOB-PO-CSR.                                           37134013
371350     EXEC SQL                                                     37135013
371360         CLOSE FOB_BY_PO                                          37136023
371370     END-EXEC                                                     37137013
371380                                                                  37138013
371390     EVALUATE TRUE                                                37139013
371391         WHEN SQLCODE = ZERO                                      37139113
371392             CONTINUE                                             37139213
371393         WHEN SQLWARN0 NOT = SPACES                               37139313
371394         WHEN SQLCODE < ZERO                                      37139413
371395         WHEN SQLCODE > ZERO                                      37139513
371396             MOVE '4071-CLOSE-FOB-PO-CSR'   TO DP013-PARAGRAPH    37139613
371397             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      37139713
371398                               TO DP013-MESSAGE-TEXT (1)          37139813
371399             MOVE SQLCA        TO DP013-SQLCA                     37139913
371400             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          37140013
371401             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          37140113
371403             SET DP013-DB2-ABEND                                  37140313
371404                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37140413
371405             PERFORM DP013-0000-PROCESS-ABEND                     37140513
371406     END-EVALUATE.                                                37140613
371407                                                                  37140713
371409*----------------------------------------------------------------*37140913
371410* CLOSE THE POE BY PO CURSOR                                     *37141013
371411*----------------------------------------------------------------*37141113
371412 4072-CLOSE-POE-PO-CSR.                                           37141213
371413     EXEC SQL                                                     37141313
371414         CLOSE POE_BY_PO                                          37141423
371415     END-EXEC                                                     37141513
371416                                                                  37141613
371417     EVALUATE TRUE                                                37141713
371418         WHEN SQLCODE = ZERO                                      37141813
371419             CONTINUE                                             37141913
371420         WHEN SQLWARN0 NOT = SPACES                               37142013
371421         WHEN SQLCODE < ZERO                                      37142113
371422         WHEN SQLCODE > ZERO                                      37142213
371423             MOVE '4072-CLOSE-POE-PO-CSR'   TO DP013-PARAGRAPH    37142313
371424             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      37142413
371425                               TO DP013-MESSAGE-TEXT (1)          37142513
371426             MOVE SQLCA        TO DP013-SQLCA                     37142613
371427             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          37142713
371428             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          37142813
371430             SET DP013-DB2-ABEND                                  37143013
371431                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37143113
371432             PERFORM DP013-0000-PROCESS-ABEND                     37143213
371433     END-EVALUATE.                                                37143313
371435                                                                  37143513
371436*----------------------------------------------------------------*37143613
371437* CLOSE THE OTB BY PO CURSOR                                     *37143713
371438*----------------------------------------------------------------*37143813
371439 4073-CLOSE-OTB-PO-CSR.                                           37143913
371440     EXEC SQL                                                     37144013
371441         CLOSE OTB_BY_PO                                          37144123
371442     END-EXEC                                                     37144213
371443                                                                  37144313
371444     EVALUATE TRUE                                                37144413
371445         WHEN SQLCODE = ZERO                                      37144513
371446             CONTINUE                                             37144613
371447         WHEN SQLWARN0 NOT = SPACES                               37144713
371448         WHEN SQLCODE < ZERO                                      37144813
371449         WHEN SQLCODE > ZERO                                      37144913
371450             MOVE '4073-CLOSE-OTB-PO-CSR'   TO DP013-PARAGRAPH    37145013
371451             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      37145113
371452                               TO DP013-MESSAGE-TEXT (1)          37145213
371453             MOVE SQLCA        TO DP013-SQLCA                     37145313
371454             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          37145413
371455             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          37145513
371457             SET DP013-DB2-ABEND                                  37145713
371458                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37145813
371459             PERFORM DP013-0000-PROCESS-ABEND                     37145913
371460     END-EVALUATE.                                                37146013
371461                                                                  37146113
371462*----------------------------------------------------------------*37143613
371463* CLOSE THE ALL TROUBLE BY PO CURSOR.                            *37143713
371464*----------------------------------------------------------------*37143813
371465 4074-CLOSE-ALL-TRBL-PO-CSR.                                      37143913
371466     EXEC SQL                                                     37144013
371467         CLOSE ALL_BY_PO                                          37144123
371468     END-EXEC                                                     37144213
371469                                                                  37144313
371470     EVALUATE TRUE                                                37144413
371471         WHEN SQLCODE = ZERO                                      37144513
371472             CONTINUE                                             37144613
371473         WHEN SQLWARN0 NOT = SPACES                               37144713
371474         WHEN SQLCODE < ZERO                                      37144813
371475         WHEN SQLCODE > ZERO                                      37144913
371476             MOVE '4074-CLOSE-ALL-TRBL-PO-CSR' TO DP013-PARAGRAPH 37145013
371477             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      37145113
371478                               TO DP013-MESSAGE-TEXT (1)          37145213
371479             MOVE SQLCA        TO DP013-SQLCA                     37145313
371480             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          37145413
371481             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          37145513
371483             SET DP013-DB2-ABEND                                  37145713
371484                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37145813
371485             PERFORM DP013-0000-PROCESS-ABEND                     37145913
371486     END-EVALUATE.                                                37146013
371487                                                                  37146113
374000*----------------------------------------------------------------*37400009
374100* CLOSE THE DEPARTMENT BY OLDEST TO NEWEST TROUBLE               *37410009
374200*----------------------------------------------------------------*37420009
374300 4080-CLOSE-DEPT-TRB-CSR.                                         37430009
374400     EXEC SQL                                                     37440009
374500         CLOSE DEPT_BY_TRBL                                       37450022
374600     END-EXEC                                                     37460009
374700                                                                  37470009
374800     EVALUATE TRUE                                                37480009
374900         WHEN SQLCODE = ZERO                                      37490009
375000             CONTINUE                                             37500009
375100         WHEN SQLWARN0 NOT = SPACES                               37510009
375200         WHEN SQLCODE < ZERO                                      37520009
375300         WHEN SQLCODE > ZERO                                      37530009
375400             MOVE '4080-CLOSE-DEPT-TRB-CSR'                       37540009
375500                               TO DP013-PARAGRAPH                 37550009
375600             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      37560009
375700                               TO DP013-MESSAGE-TEXT (1)          37570009
375800             MOVE SQLCA        TO DP013-SQLCA                     37580009
375900             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          37590009
376000             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          37600009
376200             SET DP013-DB2-ABEND                                  37620009
376300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37630009
376400             PERFORM DP013-0000-PROCESS-ABEND                     37640009
376500     END-EVALUATE.                                                37650009
376600                                                                  37660009
376700                                                                  37670009
376800*----------------------------------------------------------------*37680009
376900* CLOSE THE BUYER  BY OLDEST TO NEWEST TROUBLE                   *37690009
377000*----------------------------------------------------------------*37700009
377100 4085-CLOSE-BYR-TRB-CSR.                                          37710009
377200     EXEC SQL                                                     37720009
377300         CLOSE BUYER_BY_TRBL                                      37730022
377400     END-EXEC                                                     37740009
377500                                                                  37750009
377600     EVALUATE TRUE                                                37760009
377700         WHEN SQLCODE = ZERO                                      37770009
377800             CONTINUE                                             37780009
377900         WHEN SQLWARN0 NOT = SPACES                               37790009
378000         WHEN SQLCODE < ZERO                                      37800009
378100         WHEN SQLCODE > ZERO                                      37810009
378200             MOVE '4085-CLOSE-BYR-TRB-CSR' TO DP013-PARAGRAPH     37820009
378300             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      37830009
378400                               TO DP013-MESSAGE-TEXT (1)          37840009
378500             MOVE SQLCA        TO DP013-SQLCA                     37850009
378600             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          37860009
378700             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    37870009
378800             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    37880009
379000             SET DP013-DB2-ABEND                                  37900009
379100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37910009
379200             PERFORM DP013-0000-PROCESS-ABEND                     37920009
379300     END-EVALUATE.                                                37930009
379400                                                                  37940009
379500*----------------------------------------------------------------*37950009
379600* CLOSE THE PO BY OLDEST TO NEWEST TROUBLE CURSOR                *37960018
379700*----------------------------------------------------------------*37970009
379800 4095-CLOSE-PO-BY-TRB-CSR.                                        37980018
379900     EXEC SQL                                                     37990009
380000         CLOSE PO_BY_TRBL                                         38000022
380100     END-EXEC                                                     38010009
380200                                                                  38020009
380300     EVALUATE TRUE                                                38030009
380400         WHEN SQLCODE = ZERO                                      38040009
380500             CONTINUE                                             38050009
380600         WHEN SQLWARN0 NOT = SPACES                               38060009
380700         WHEN SQLCODE < ZERO                                      38070009
380800         WHEN SQLCODE > ZERO                                      38080009
380900             MOVE '4095-CLOSE-PO-BY-TRB-CSR'   TO DP013-PARAGRAPH 38090018
381000             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      38100009
381100                               TO DP013-MESSAGE-TEXT (1)          38110009
381200             MOVE SQLCA        TO DP013-SQLCA                     38120009
381300             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          38130009
381400             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          38140009
381600             SET DP013-DB2-ABEND                                  38160009
381700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38170009
381800             PERFORM DP013-0000-PROCESS-ABEND                     38180009
381900     END-EVALUATE.                                                38190009
382000                                                                  38200009
382010*----------------------------------------------------------------*37950009
382020* CLOSE THE FOB BY OLDEST TO NEWEST TROUBLE CURSOR               *37960018
382030*----------------------------------------------------------------*37970009
382040 4096-CLOSE-FOB-TRB-CSR.                                          37980018
382050     EXEC SQL                                                     37990009
382060         CLOSE FOB_BY_TRBL                                        38000022
382070     END-EXEC                                                     38010009
382080                                                                  38020009
382090     EVALUATE TRUE                                                38030009
382091         WHEN SQLCODE = ZERO                                      38040009
382092             CONTINUE                                             38050009
382093         WHEN SQLWARN0 NOT = SPACES                               38060009
382094         WHEN SQLCODE < ZERO                                      38070009
382095         WHEN SQLCODE > ZERO                                      38080009
382096             MOVE '4096-CLOSE-FOB-TRB-CSR'     TO DP013-PARAGRAPH 38090018
382097             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      38100009
382098                               TO DP013-MESSAGE-TEXT (1)          38110009
382099             MOVE SQLCA        TO DP013-SQLCA                     38120009
382100             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          38130009
382101             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          38140009
382103             SET DP013-DB2-ABEND                                  38160009
382104                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38170009
382105             PERFORM DP013-0000-PROCESS-ABEND                     38180009
382106     END-EVALUATE.                                                38190009
382107                                                                  38200009
382108*----------------------------------------------------------------*37950009
382109* CLOSE THE POE BY OLDEST TO NEWEST TROUBLE CURSOR               *37960018
382110*----------------------------------------------------------------*37970009
382111 4097-CLOSE-POE-TRB-CSR.                                          37980018
382112     EXEC SQL                                                     37990009
382113         CLOSE POE_BY_TRBL                                        38000022
382114     END-EXEC                                                     38010009
382115                                                                  38020009
382116     EVALUATE TRUE                                                38030009
382117         WHEN SQLCODE = ZERO                                      38040009
382118             CONTINUE                                             38050009
382119         WHEN SQLWARN0 NOT = SPACES                               38060009
382120         WHEN SQLCODE < ZERO                                      38070009
382121         WHEN SQLCODE > ZERO                                      38080009
382122             MOVE '4097-CLOSE-POE-TRB-CSR'     TO DP013-PARAGRAPH 38090018
382123             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      38100009
382124                               TO DP013-MESSAGE-TEXT (1)          38110009
382125             MOVE SQLCA        TO DP013-SQLCA                     38120009
382126             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          38130009
382127             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          38140009
382128             SET DP013-DB2-ABEND                                  38160009
382129                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38170009
382130             PERFORM DP013-0000-PROCESS-ABEND                     38180009
382131     END-EVALUATE.                                                38190009
382132                                                                  38200009
382133*----------------------------------------------------------------*37950009
382134* CLOSE THE OTB BY OLDEST TO NEWEST TROUBLE CURSOR               *37960018
382135*----------------------------------------------------------------*37970009
382136 4098-CLOSE-OTB-TRB-CSR.                                          37980018
382137     EXEC SQL                                                     37990009
382138         CLOSE OTB_BY_TRBL                                        38000022
382139     END-EXEC                                                     38010009
382140                                                                  38020009
382141     EVALUATE TRUE                                                38030009
382142         WHEN SQLCODE = ZERO                                      38040009
382143             CONTINUE                                             38050009
382144         WHEN SQLWARN0 NOT = SPACES                               38060009
382145         WHEN SQLCODE < ZERO                                      38070009
382146         WHEN SQLCODE > ZERO                                      38080009
382147             MOVE '4098-CLOSE-OTB-TRB-CSR'     TO DP013-PARAGRAPH 38090018
382148             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      38100009
382149                               TO DP013-MESSAGE-TEXT (1)          38110009
382150             MOVE SQLCA        TO DP013-SQLCA                     38120009
382151             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          38130009
382152             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          38140009
382153             SET DP013-DB2-ABEND                                  38160009
382154                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38170009
382155             PERFORM DP013-0000-PROCESS-ABEND                     38180009
382156     END-EVALUATE.                                                38190009
382157                                                                  38200009
382158*----------------------------------------------------------------*37950009
382159* CLOSE THE ALL TROUBLE BY OLDEST TO NEWEST TROUBLE CURSOR       *37960018
382160*----------------------------------------------------------------*37970009
382161 4099-CLOSE-ALL-TRB-CSR.                                          37980018
382162     EXEC SQL                                                     37990009
382163         CLOSE ALL_BY_TRBL                                        38000022
382164     END-EXEC                                                     38010009
382165                                                                  38020009
382166     EVALUATE TRUE                                                38030009
382167         WHEN SQLCODE = ZERO                                      38040009
382168             CONTINUE                                             38050009
382169         WHEN SQLWARN0 NOT = SPACES                               38060009
382170         WHEN SQLCODE < ZERO                                      38070009
382171         WHEN SQLCODE > ZERO                                      38080009
382172             MOVE '4099-CLOSE-ALL-TRB-CSR'     TO DP013-PARAGRAPH 38090018
382173             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      38100009
382174                               TO DP013-MESSAGE-TEXT (1)          38110009
382175             MOVE SQLCA        TO DP013-SQLCA                     38120009
382176             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          38130009
382177             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          38140009
382178             SET DP013-DB2-ABEND                                  38160009
382179                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38170009
382180             PERFORM DP013-0000-PROCESS-ABEND                     38180009
382181     END-EVALUATE.                                                38190009
382182                                                                  38200009
382190*----------------------------------------------------------------*38210009
382200*    SET UP THE HOST VARIABLES.                                  *38220003
382300*----------------------------------------------------------------*38230003
382400 4100-PREPARE-CURSOR.                                             38240003
382500     MOVE +0000             TO DK-OPER-UNT-ID.                    38250009
383000     INITIALIZE                DK-PO-NBR.                         38300003
383300     MOVE +700              TO DK-TRBL-RSN-LOW.                   38330009
383400     MOVE +759              TO DK-TRBL-RSN-HIGH.                  38340009
383500     MOVE SPACES            TO DK-NOTIF-STAT-1                    38350003
383600                               DK-NOTIF-STAT-2                    38360003
383700                               DK-NOTIF-STAT-3                    38370003
383800                               DK-NOTIF-STAT-4                    38380003
383900                               DK-RESP-AREA-1                     38390003
384000                               DK-RESP-AREA-2                     38400003
384100                               DK-RESP-AREA-3.                    38410003
384200     MOVE PC-DUMMY-DB2-DATE-LOW  TO DK-LOW-REC-TMST.              38420009
384300     MOVE PC-DUMMY-DB2-DATE-HIGH TO DK-HIGH-REC-TMST.             38430009
384400                                                                  38440003
384500     IF ASC-KEY-OPER-UNT-ID > SPACE                               38450009
384600            AND NOT = 0                                           38460009
384700         MOVE ASC-KEY-OPER-UNT-ID TO DK-OPER-UNT-ID               38470009
385500     END-IF.                                                      38550008
385600                                                                  38560008
385700     IF (ASC-KEY-DEPT > SPACES)                                   38570008
385710         MOVE ASC-KEY-DEPT  TO DK-DEPT-NBR                                
386000         IF ASC-LS-PO                                             38600029
386100             SET PS-USE-DEPT-PO-CSR     TO TRUE                   38610013
386200         ELSE                                                     38620009
386300             SET PS-USE-DEPT-TRB-CSR    TO TRUE                   38630009
386400         END-IF                                                   38640009
386500     END-IF.                                                      38650009
386600                                                                  38660009
386700     IF (ASC-KEY-BUYER > ZEROS)                                   38670009
386800         MOVE ASC-KEY-BUYER     TO DK-BUYER-NBR-N                 38680009
386900         IF ASC-LS-PO                                             38690029
387000             SET PS-USE-BYR-PO-CSR  TO TRUE                       38700013
387100         ELSE                                                     38710009
387200             SET PS-USE-BYR-TRB-CSR TO TRUE                       38720009
387300         END-IF                                                   38730009
387400     END-IF.                                                      38740009
387500                                                                  38750009
387600     IF  ASC-KEY-PO-NBR > ZERO                                    38760009
387700         MOVE ASC-KEY-PO-NBR TO DK-PO-NBR                         38770009
388000         IF ASC-LS-PO                                             38800029
388100             SET PS-USE-PO-PO-CSR  TO TRUE                        38810019
388200         ELSE                                                     38820009
388300             SET PS-USE-PO-TRB-CSR TO TRUE                        38830019
388400         END-IF                                                   38840009
388500     END-IF.                                                      38850009
388600                                                                  38860009
388601     IF  ASC-KEY-FOB-CDE > SPACES                                 38760009
388602         MOVE ASC-KEY-FOB-CDE TO DK-FOB-CDE                       38770009
388605         IF ASC-LS-PO                                             38800029
388606             SET PS-USE-FOB-PO-CSR  TO TRUE                       38810019
388607         ELSE                                                     38820009
388608             SET PS-USE-FOB-TRB-CSR TO TRUE                       38830019
388609         END-IF                                                   38840009
388610     END-IF.                                                      38850009
388611                                                                  38860009
388612     IF  ASC-KEY-POE-CDE > SPACES                                 38760009
388613         MOVE ASC-KEY-POE-CDE TO DK-POE-CDE                       38770009
388614         IF ASC-LS-PO                                             38800029
388615             SET PS-USE-POE-PO-CSR  TO TRUE                       38810019
388616         ELSE                                                     38820009
388617             SET PS-USE-POE-TRB-CSR TO TRUE                       38830019
388618         END-IF                                                   38840009
388619     END-IF.                                                      38850009
388620                                                                  38860009
388621     IF  ASC-KEY-OTB > SPACES                                     38760009
388622         MOVE ASC-KEY-OTB (1:2) TO DK-OTB-PER-NBR-MM              38770009
388623         MOVE ASC-KEY-OTB (3:2) TO DK-OTB-PER-NBR-YY              38770009
388624         IF ASC-KEY-OTB (3:2) < 80                                        
388625             MOVE 20 TO DK-OTB-PER-NBR-CC                                 
388626         ELSE                                                             
388627             MOVE 19 TO DK-OTB-PER-NBR-CC                                 
388628         END-IF                                                           
388629         MOVE DK-OTB-PER-NBR TO DK-OTB-PER-NBR-ALL                        
388630         IF ASC-LS-PO                                             38800029
388631             SET PS-USE-OTB-PO-CSR  TO TRUE                       38810019
388632         ELSE                                                     38820009
388633             SET PS-USE-OTB-TRB-CSR TO TRUE                       38830019
388634         END-IF                                                   38840009
388635     END-IF.                                                      38850009
388636                                                                  38860009
388637     IF ASC-KEY-ALL-TRBL > SPACES                                 38570008
388640         IF ASC-LS-PO                                             38600029
388650             SET PS-USE-ALL-TRBL-PO-CSR  TO TRUE                  38610013
388660         ELSE                                                     38620009
388670             SET PS-USE-ALL-TRBL-TRB-CSR TO TRUE                  38630009
388680         END-IF                                                   38640009
388690     END-IF.                                                      38650009
388691                                                                  38660009
388700*    EVALUATE TRUE                                                38870032
388800*        WHEN ASC-RA-BUY-ANALYST-SW                               38880032
388900*            MOVE ASC-RA-BUYER   TO DK-RESP-AREA-1                38890032
389000*            MOVE ASC-RA-ANALYST TO DK-RESP-AREA-2                38900032
389100*        WHEN ASC-RA-BUY-ANALYST-DC-SW                            38910032
389200*            MOVE ASC-RA-BUYER   TO DK-RESP-AREA-1                38920032
389300*            MOVE ASC-RA-ANALYST TO DK-RESP-AREA-2                38930032
389400*            MOVE ASC-RA-DC      TO DK-RESP-AREA-3                38940032
389500*        WHEN ASC-RA-DC-SW                                        38950032
389600*            MOVE ASC-RA-DC      TO DK-RESP-AREA-1                38960032
389700*    END-EVALUATE.                                                38970032
389800                                                                  38980003
389810     MOVE PC-T                   TO DK-RESP-AREA-1.               38981032
389820                                                                  38982032
389900     EVALUATE TRUE                                                38990008
390000         WHEN ASC-ALL-NOTIF-STATS                                 39000008
390100             MOVE PC-NEW-TROUBLE TO DK-NOTIF-STAT-1               39010008
390200             MOVE PC-IN-PROCESS-TROUBLE TO DK-NOTIF-STAT-2        39020008
390300             MOVE PC-RESOLVED-TROUBLE TO DK-NOTIF-STAT-3          39030008
390400             MOVE PC-ACKNOWLEDGED-TROUBLE TO DK-NOTIF-STAT-4      39040008
390500         WHEN ASC-RESOLVD-STAT-ONLY                               39050008
390600             MOVE PC-RESOLVED-TROUBLE TO DK-NOTIF-STAT-1          39060009
390700         WHEN  ASC-UNRSLVD-STAT-ONLY                              39070008
390800             MOVE PC-NEW-TROUBLE TO DK-NOTIF-STAT-1               39080008
390900             MOVE PC-IN-PROCESS-TROUBLE TO DK-NOTIF-STAT-2        39090008
391000     END-EVALUATE.                                                39100009
391100                                                                  39110003
391200     IF  ASC-KEY-REC-SEQ-NBR >  ZEROS                             39120003
391300         MOVE ASC-KEY-REC-SEQ-NBR TO DK-REC-SEQ-NBR               39130003
391400                                     DK-REC-SEQ-NBR-LOW           39140003
391500                                     DK-REC-SEQ-NBR-HIGH          39150003
391600     ELSE                                                         39160003
391700         MOVE PC-000000000        TO DK-REC-SEQ-NBR               39170003
391800                                     DK-REC-SEQ-NBR-LOW           39180003
391900         MOVE PC-999999999        TO DK-REC-SEQ-NBR-HIGH          39190003
392000     END-IF.                                                      39200003
392100                                                                  39210003
392200     IF  ASC-TRBL-REASON-LOW > ZERO                               39220009
392300         MOVE ASC-TRBL-REASON-LOW TO DK-TRBL-RSN-LOW              39230009
392400     END-IF.                                                      39240009
392500     IF  ASC-TRBL-REASON-HIGH > ZERO                              39250009
392600         MOVE ASC-TRBL-REASON-HIGH  TO DK-TRBL-RSN-HIGH           39260009
392700     END-IF.                                                      39270009
392800                                                                  39280009
392900     EVALUATE TRUE                                                39290009
393000         WHEN ASC-RCVR-STAT-ARR-ENR                               39300009
393100             MOVE PC-DUMMY-DB2-DATE-LOW  TO DK-LOW-REC-TMST       39310009
393200             MOVE PC-DUMMY-DB2-DATE-HIGH TO DK-HIGH-REC-TMST      39320009
393300         WHEN ASC-RCVR-STAT-ARRIVED                               39330009
393400             MOVE PC-DUMMY-DB2-DATE-LOW  TO DK-LOW-REC-TMST       39340009
393500             EXEC SQL                                             39350009
393600                 SET :DK-HIGH-REC-TMST = CURRENT TIMESTAMP        39360009
393700             END-EXEC                                             39370009
393800         WHEN ASC-RCVR-STAT-ENROUTE                               39380009
393900             MOVE PC-DUMMY-DB2-DATE-HIGH TO DK-LOW-REC-TMST       39390009
394000                                            DK-HIGH-REC-TMST      39400009
394100     END-EVALUATE.                                                39410009
394200                                                                  39420009
394300*----------------------------------------------------------------*39430009
394400*    READ THE NOTIFICATION RECORDS FOR A SPECIFIC PO AND MOVE    *39440003
394500*    THEM INTO THE BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS    *39450003
394600*    BECOME FULL, WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE,  *39460003
394700*    MOVE THE 2ND BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND       *39470003
394800*    INITIALIZE THE 2ND BLOCK MAKING IT AVAILABLE TO BE USED.    *39480003
394900*                                                                *39490003
395000*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *39500003
395100*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *39510003
395200*    UPON INITIALIZATION.                                        *39520003
395300*----------------------------------------------------------------*39530003
395400 4300-READ-TROUBLE-NOTIF-FOR-PO.                                  39540003
395500     PERFORM                                                      39550003
395600         VARYING PV-READ-COUNT                                    39560003
395700         FROM 1 BY 1                                              39570003
395800         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    39580003
395900            OR (PS-NO-TRBL-NOTIF-ITEMS-LEFT)                      39590003
396000            OR (PS-ERROR))                                        39600003
396100                                                                  39610003
396200         PERFORM 4310-FETCH-TROUBLE-NOTIF-ITEM                    39620003
396300                                                                  39630009
398500         MOVE TRBNTF-PO-NBR      TO PV-PREV-PO-NBR                       9
398600         MOVE TRBNTF-REC-SEQ-NBR TO PV-PREV-REC-SEQ-NBR                  9
398700         INITIALIZE PV-TRBL-RSN-SUB                                      9
398800                    TR-TROUBLE-REASON-TABLE                              9
399000                                                                         3
399100         SET TR-TRBL-IDX TO +1                                           3
399200         SEARCH TR-TROUBLE-REASON-ENTRY                                  3
399300           VARYING TR-TRBL-IDX                                           3
399400             AT END                                                      3
399500                 SET PS-DISPLAY-TROUBLE-LINE TO TRUE                     3
399600             WHEN TR-TROUBLE-REASON-N (TR-TRBL-IDX) =                    3
399700                                              TRBNTF-TRBL-RSN-CDE        3
399800                 SET PS-DO-NOT-DISPLAY-TROUBLE-LINE TO TRUE              3
399900         END-SEARCH                                                      3
400000                                                                         3
400100         IF  PS-DISPLAY-TROUBLE-LINE                                     3
400200             SET PS-TRBL-RSN-NOT-LOADED   TO TRUE                        3
400300             PERFORM VARYING TR-TRBL-IDX                                 3
400400               FROM 1 BY 1                                               3
400500                 UNTIL (TR-TRBL-IDX > PC-MAX-TABLE-ENTRIES) OR    40050003
400600                       (PS-TRBL-RSN-LOADED)                       40060003
400700                 IF  TR-TROUBLE-REASON (TR-TRBL-IDX) = SPACES     40070003
400800                     MOVE TRBNTF-TRBL-RSN-CDE                     40080003
400900                                    TO TR-TROUBLE-REASON-N        40090009
401000                                                   (TR-TRBL-IDX)  40100009
401100                     SET PS-TRBL-RSN-LOADED TO TRUE               40110003
401200                 END-IF                                           40120003
401300             END-PERFORM                                          40130003
401400         END-IF                                                   40140003
401500                                                                  40150003
401600         IF  TR-TRBL-IDX > PC-MAX-TABLE-ENTRIES                   40160003
401700             MOVE PC-TSYMSG-00994  TO DP020-MSG-NUMBER            40170009
401800             SET PS-DO-NOT-DISPLAY-TROUBLE-LINE                   40180003
401900                 DP020-NEXT-ACT-APPL-ERROR                        40190003
402000                 DP020-MSG-FATAL                                  40200003
402100                 PS-ERROR          TO  TRUE                       40210009
402200         END-IF                                                   40220003
402300                                                                  40230003
402400         IF (PS-TRBL-NOTIF-ITEMS-LEFT) AND                        40240003
402500            (PS-DISPLAY-TROUBLE-LINE)                             40250003
402600             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                40260003
402700                 ADD +1            TO ASC-ITEM-SUB                40270009
402800             ELSE                                                 40280003
402900                 ADD +1            TO ASC-BLK-SUB                 40290003
403000                 MOVE +1           TO ASC-ITEM-SUB                40300003
403100                                                                  40310003
403200                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         40320003
403300                     MOVE +1       TO ASC-BLK-SUB                 40330003
403400                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           40340003
403500                     PERFORM 5100-WRITE-TEMP-STORAGE              40350003
403600                     MOVE ASC-BLOCK-ENTRIES                       40360003
403700                               (PC-MAX-BLOCKS-IN-ARRAY)           40370003
403800                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 40380003
403900                     ADD +1        TO ASC-BLK-SUB                 40390003
404000                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   40400003
404100                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      40410003
404200                                   TO TRUE                        40420003
404300                 END-IF                                           40430003
404400             END-IF                                               40440003
404500             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    40450003
404600             MOVE ASC-NUMBER-OF-ITEMS-READ                        40460003
404700                                   TO ASC-LIST-ITEM-NUMBER        40470003
404800                                        (ASC-BLK-SUB ASC-ITEM-SUB)40480003
404900             MOVE TRBNTF-NOTIF-NBR TO ASC-NOTIF-NBR               40490003
405000                                        (ASC-BLK-SUB ASC-ITEM-SUB)40500003
405100             MOVE TRBNTF-OPER-UNT-ID TO ASC-OPER-UNT-ID           40510003
405200                                        (ASC-BLK-SUB ASC-ITEM-SUB)40520003
405300             MOVE TRBNTF-FCLTY-ID  TO ASC-FCLTY-ID                40530003
405400                                        (ASC-BLK-SUB ASC-ITEM-SUB)40540003
405500             MOVE TRBNTF-DEPT-NBR  TO ASC-DEPT-NBR                40550003
405600                                        (ASC-BLK-SUB ASC-ITEM-SUB)40560003
405700             MOVE TRBNTF-PO-NBR    TO ASC-PO-NBR-N                40570003
405800                                        (ASC-BLK-SUB ASC-ITEM-SUB)40580003
405900             MOVE TRBNTF-REC-SEQ-NBR TO ASC-RCVR-SEQ-NBR-N        40590003
406000                                        (ASC-BLK-SUB ASC-ITEM-SUB)40600003
406100             MOVE TRBNTF-PO-LNE-NBR TO ASC-PO-LNE-NBR-N           40610003
406200                                        (ASC-BLK-SUB ASC-ITEM-SUB)40620003
406300                                                                  40630003
406400             PERFORM 4320-FETCH-VENDOR-SHORT-NAME                 40640003
406500             MOVE ENTNME-ENT-NAME-DESC TO ASC-VENDOR-SHORT-NME    40650003
406600                                        (ASC-BLK-SUB ASC-ITEM-SUB)40660003
406700             MOVE TRBNTF-ENT-ID    TO ASC-ENT-ID                  40670003
406800                                        (ASC-BLK-SUB ASC-ITEM-SUB)40680003
406910*MAM         PERFORM 4330-FETCH-SCAC-CDE                          40691025
406920*MAM                                                              40692009
407110*MAM         MOVE EXTENT-SCAC-CDE      TO ASC-SCAC-CDE            40700003
407120*MAM                                    (ASC-BLK-SUB ASC-ITEM-SUB)40710003
407130                                                                          
407140             PERFORM 4330-FOB-POE-CDE                                     
407150                                                                          
407200             MOVE TRBNTF-TRBL-RSN-CDE  TO ASC-TROUBLE-REASON-CDE  40720009
407300                                        (ASC-BLK-SUB ASC-ITEM-SUB)40730003
407400             MOVE TRBRSN-TRBL-SHT-DESC TO ASC-TROUBLE-REASON-DESC 40740003
407500                                        (ASC-BLK-SUB ASC-ITEM-SUB)40750003
407600             MOVE TRBRSN-RESP-RES-IND TO ASC-TROUBLE-RESP-RES-IND 40760003
407700                                        (ASC-BLK-SUB ASC-ITEM-SUB)40770003
407800             MOVE TRBRSN-TRBL-LVL-IND TO ASC-TROUBLE-REASON-LVL   40780003
407900                                        (ASC-BLK-SUB ASC-ITEM-SUB)40790003
407910             MOVE PC-NA               TO ASC-ARRIVAL-DATE-TIME            
407920                                        (ASC-BLK-SUB ASC-ITEM-SUB)        
409300             MOVE TRBNTF-NOTIF-TMST TO PV-TIMESTAMP               40930003
409400             STRING PV-TIMESTAMP-MONTH  DELIMITED BY SIZE         40940003
409500                    PC-SLASH            DELIMITED BY SIZE         40950003
409600                    PV-TIMESTAMP-DAY    DELIMITED BY SIZE         40960003
409700                    PC-SPACE            DELIMITED BY SIZE         40970003
409800                    PV-TIMESTAMP-HOUR   DELIMITED BY SIZE         40980003
409900                                 INTO ASC-NOTIFICATION-DATE-TIME  40990003
410000                                        (ASC-BLK-SUB ASC-ITEM-SUB)41000003
410010                                                                          
410100             PERFORM 4350-FETCH-TROUBLE-DETAIL                    41010003
410200             IF  PS-TRBL-DTL-EXISTS                               41020003
410300                 SET ASC-TRBL-DTL-EXISTS                          41030003
410400                        (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE        41040003
410500             ELSE                                                 41050003
410600                 SET ASC-NO-TRBL-DTL-EXISTS                       41060003
410700                        (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE        41070003
410800             END-IF                                               41080003
410900             IF  TRBNTF-RESOLVED-IND = PC-NEW-TROUBLE OR          41090003
411000                                       PC-IN-PROCESS-TROUBLE      41100003
411100                 SET ASC-TRBL-NOT-RESOLVED                        41110003
411200                        (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE        41120003
411300             ELSE                                                 41130003
411400                 INITIALIZE PV-UNRESOLVED-TROUBLE-COUNT           41140003
411500                 PERFORM 4370-COUNT-UNRESOLVED-TROUBLE            41150003
411600                 IF  PV-UNRESOLVED-TROUBLE-COUNT = 0              41160003
411700                     SET ASC-TRBL-RESOLVED                        41170003
411800                        (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE        41180003
411900                 ELSE                                             41190003
412000                     SET ASC-TRBL-NOT-RESOLVED                    41200003
412100                        (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE        41210003
412291                 END-IF                                           41229109
412300             END-IF                                               41230003
412400                                                                          
412601             IF ASC-TRBL-RESOLVED (ASC-BLK-SUB ASC-ITEM-SUB)              
412651               IF ASC-TRBL-DTL-EXISTS (ASC-BLK-SUB ASC-ITEM-SUB)          
412652                   IF TRBNTF-RESOLVED-TMST > PV-MAX-RESP-DATE             
412653                       MOVE TRBNTF-RESOLVED-TMST TO PV-TIMESTAMP          
412655                   ELSE                                                   
412656                       MOVE PV-MAX-RESP-DATE     TO PV-TIMESTAMP          
412657                   END-IF                                                 
412658               ELSE                                                       
412659                   MOVE TRBNTF-RESOLVED-TMST TO PV-TIMESTAMP              
412660               END-IF                                                     
412661             END-IF                                                       
412662             IF ASC-TRBL-NOT-RESOLVED (ASC-BLK-SUB ASC-ITEM-SUB)          
412663               IF ASC-TRBL-DTL-EXISTS (ASC-BLK-SUB ASC-ITEM-SUB)          
412664                   MOVE PV-MAX-RESP-DATE     TO PV-TIMESTAMP              
412666               ELSE                                                       
412667                   MOVE SPACES               TO PV-TIMESTAMP              
412668               END-IF                                                     
412672             END-IF                                                       
412673             IF PV-TIMESTAMP > SPACES                                     
412674                 STRING PV-TIMESTAMP-MONTH  DELIMITED BY SIZE             
412675                        PC-SLASH            DELIMITED BY SIZE             
412676                        PV-TIMESTAMP-DAY    DELIMITED BY SIZE             
412677                        PC-SPACE            DELIMITED BY SIZE             
412678                        PV-TIMESTAMP-HOUR   DELIMITED BY SIZE             
412679                                     INTO ASC-RESPONSE-DATE-TIME          
412680                                       (ASC-BLK-SUB ASC-ITEM-SUB)         
412681             ELSE                                                         
412682                 MOVE SPACES TO ASC-RESPONSE-DATE-TIME                    
412683                                       (ASC-BLK-SUB ASC-ITEM-SUB)         
412690             END-IF                                                       
413600         END-IF                                                   41360003
413700     END-PERFORM.                                                 41370003
413800                                                                  41380003
413900*----------------------------------------------------------------*41390003
414000*    FETCH ALL OF THE NOTIFICATION RECORDS FOR A SPECIFIC PO.    *41400003
414100*----------------------------------------------------------------*41410003
414200 4310-FETCH-TROUBLE-NOTIF-ITEM.                                   41420003
414210                                                                          
414300     EVALUATE TRUE                                                41430009
416400       WHEN PS-USE-DEPT-PO-CSR                                    41640013
416500         EXEC SQL                                                         
416600              FETCH DEPT_BY_PO                                            
416700              INTO  :TRBNTF-NOTIF-NBR                                     
416800                  , :TRBNTF-OPER-UNT-ID                                   
416810                  , :TRBNTF-FCLTY-ID                                      
416820                  , :TRBNTF-DEPT-NBR                                      
416830                  , :TRBNTF-ENT-ID                                41683031
416840                  , :TRBNTF-PO-NBR                                41684031
416850                  , :TRBNTF-PO-LNE-NBR                            41685031
416860                  , :TRBNTF-REC-SEQ-NBR                           41686031
416870                  , :TRBNTF-TRBL-RSN-CDE                          41687031
416880                  , :TRBNTF-NOTIF-TMST                            41688031
416890                  , :TRBNTF-RESOLVED-IND                          41689031
416891                  , :TRBNTF-RESOLVED-TMST                         41689131
416892                  , :TRBNTF-ACKNOWLG-TMST                         41689231
416893                  , :TRBNTF-LAST-DTL-CRE-TMST                             
416895                  , :TRBNTF-INITR-ENT-ID                                  
416896                  , :TRBNTF-FOB-CDE                                       
416897                  , :TRBNTF-POE-CDE                                       
416898                  , :TRBRSN-TRBL-SHT-DESC                         41689331
416899                  , :TRBRSN-RESP-RES-IND                          41689431
416900                  , :TRBRSN-TRBL-LVL-IND                          41689531
418300         END-EXEC                                                 41830003
418310                                                                          
418400       WHEN PS-USE-BYR-PO-CSR                                     41840013
418500         EXEC SQL                                                 41850009
418600              FETCH BUYER_BY_PO                                   41860020
418700              INTO  :TRBNTF-NOTIF-NBR                                     
418800                  , :TRBNTF-OPER-UNT-ID                           41880009
418900                  , :TRBNTF-FCLTY-ID                              41890009
419000                  , :TRBNTF-DEPT-NBR                              41900009
419100                  , :TRBNTF-ENT-ID                                41910009
419200                  , :TRBNTF-PO-NBR                                41920009
419300                  , :TRBNTF-PO-LNE-NBR                            41930009
419400                  , :TRBNTF-REC-SEQ-NBR                           41940009
419500                  , :TRBNTF-TRBL-RSN-CDE                          41950009
419600                  , :TRBNTF-NOTIF-TMST                            41960009
419700                  , :TRBNTF-RESOLVED-IND                          41970009
419800                  , :TRBNTF-RESOLVED-TMST                         41980009
419810                  , :TRBNTF-ACKNOWLG-TMST                         41981009
419811                  , :TRBNTF-LAST-DTL-CRE-TMST                             
419820                  , :TRBNTF-INITR-ENT-ID                                  
419830                  , :TRBNTF-FOB-CDE                                       
419840                  , :TRBNTF-POE-CDE                                       
419900                  , :TRBRSN-TRBL-SHT-DESC                         41990009
420000                  , :TRBRSN-RESP-RES-IND                          42000009
420100                  , :TRBRSN-TRBL-LVL-IND                          42010009
420300         END-EXEC                                                 42030009
420310                                                                          
420400       WHEN PS-USE-PO-PO-CSR                                      42040019
420500         EXEC SQL                                                 42050009
420600              FETCH PO_BY_PO                                      42060020
420700              INTO  :TRBNTF-NOTIF-NBR                                     
420800                  , :TRBNTF-OPER-UNT-ID                           42080009
420900                  , :TRBNTF-FCLTY-ID                              42090009
421000                  , :TRBNTF-DEPT-NBR                              42100009
421100                  , :TRBNTF-ENT-ID                                42110009
421200                  , :TRBNTF-PO-NBR                                42120009
421300                  , :TRBNTF-PO-LNE-NBR                            42130009
421400                  , :TRBNTF-REC-SEQ-NBR                           42140009
421500                  , :TRBNTF-TRBL-RSN-CDE                          42150009
421600                  , :TRBNTF-NOTIF-TMST                            42160009
421700                  , :TRBNTF-RESOLVED-IND                          42170009
421800                  , :TRBNTF-RESOLVED-TMST                         42180009
421810                  , :TRBNTF-ACKNOWLG-TMST                         42181009
421811                  , :TRBNTF-LAST-DTL-CRE-TMST                             
421820                  , :TRBNTF-INITR-ENT-ID                                  
421830                  , :TRBNTF-FOB-CDE                                       
421840                  , :TRBNTF-POE-CDE                                       
421900                  , :TRBRSN-TRBL-SHT-DESC                         42190009
422000                  , :TRBRSN-RESP-RES-IND                          42200009
422100                  , :TRBRSN-TRBL-LVL-IND                          42210009
422300         END-EXEC                                                 42230009
422301                                                                          
422310       WHEN PS-USE-FOB-PO-CSR                                     42231013
422320         EXEC SQL                                                 42232013
422330              FETCH FOB_BY_PO                                     42233020
422340              INTO  :TRBNTF-NOTIF-NBR                                     
422350                  , :TRBNTF-OPER-UNT-ID                           42235013
422360                  , :TRBNTF-FCLTY-ID                              42236013
422370                  , :TRBNTF-DEPT-NBR                              42237013
422380                  , :TRBNTF-ENT-ID                                42238013
422390                  , :TRBNTF-PO-NBR                                42239013
422391                  , :TRBNTF-PO-LNE-NBR                            42239113
422392                  , :TRBNTF-REC-SEQ-NBR                           42239213
422393                  , :TRBNTF-TRBL-RSN-CDE                          42239313
422394                  , :TRBNTF-NOTIF-TMST                            42239413
422395                  , :TRBNTF-RESOLVED-IND                          42239513
422396                  , :TRBNTF-RESOLVED-TMST                         42239613
422397                  , :TRBNTF-ACKNOWLG-TMST                         42239713
422398                  , :TRBNTF-LAST-DTL-CRE-TMST                             
422399                  , :TRBNTF-INITR-ENT-ID                                  
422400                  , :TRBNTF-FOB-CDE                                       
422401                  , :TRBNTF-POE-CDE                                       
422402                  , :TRBRSN-TRBL-SHT-DESC                         42239813
422403                  , :TRBRSN-RESP-RES-IND                          42239913
422404                  , :TRBRSN-TRBL-LVL-IND                          42240013
422405         END-EXEC                                                 42240213
422406                                                                          
422407       WHEN PS-USE-POE-PO-CSR                                     42240313
422408         EXEC SQL                                                 42240413
422409              FETCH POE_BY_PO                                     42240520
422410              INTO  :TRBNTF-NOTIF-NBR                                     
422411                  , :TRBNTF-OPER-UNT-ID                           42240713
422412                  , :TRBNTF-FCLTY-ID                              42240813
422413                  , :TRBNTF-DEPT-NBR                              42240913
422414                  , :TRBNTF-ENT-ID                                42241013
422415                  , :TRBNTF-PO-NBR                                42241113
422416                  , :TRBNTF-PO-LNE-NBR                            42241213
422417                  , :TRBNTF-REC-SEQ-NBR                           42241313
422418                  , :TRBNTF-TRBL-RSN-CDE                          42241413
422419                  , :TRBNTF-NOTIF-TMST                            42241513
422420                  , :TRBNTF-RESOLVED-IND                          42241613
422421                  , :TRBNTF-RESOLVED-TMST                         42241713
422422                  , :TRBNTF-ACKNOWLG-TMST                         42241813
422423                  , :TRBNTF-LAST-DTL-CRE-TMST                             
422424                  , :TRBNTF-INITR-ENT-ID                                  
422425                  , :TRBNTF-FOB-CDE                                       
422426                  , :TRBNTF-POE-CDE                                       
422427                  , :TRBRSN-TRBL-SHT-DESC                         42241913
422428                  , :TRBRSN-RESP-RES-IND                          42242013
422429                  , :TRBRSN-TRBL-LVL-IND                          42242113
422430         END-EXEC                                                 42242313
422431                                                                          
422432       WHEN PS-USE-OTB-PO-CSR                                     42242413
422433         EXEC SQL                                                 42242513
422434              FETCH OTB_BY_PO                                     42242620
422435              INTO  :TRBNTF-NOTIF-NBR                                     
422436                  , :TRBNTF-OPER-UNT-ID                           42242813
422437                  , :TRBNTF-FCLTY-ID                              42242913
422438                  , :TRBNTF-DEPT-NBR                              42243013
422439                  , :TRBNTF-ENT-ID                                42243113
422440                  , :TRBNTF-PO-NBR                                42243213
422441                  , :TRBNTF-PO-LNE-NBR                            42243313
422442                  , :TRBNTF-REC-SEQ-NBR                           42243413
422443                  , :TRBNTF-TRBL-RSN-CDE                          42243513
422444                  , :TRBNTF-NOTIF-TMST                            42243613
422445                  , :TRBNTF-RESOLVED-IND                          42243713
422446                  , :TRBNTF-RESOLVED-TMST                         42243813
422447                  , :TRBNTF-ACKNOWLG-TMST                         42243913
422448                  , :TRBNTF-LAST-DTL-CRE-TMST                             
422449                  , :TRBNTF-INITR-ENT-ID                                  
422450                  , :TRBNTF-FOB-CDE                                       
422451                  , :TRBNTF-POE-CDE                                       
422452                  , :TRBRSN-TRBL-SHT-DESC                         42244013
422453                  , :TRBRSN-RESP-RES-IND                          42244113
422454                  , :TRBRSN-TRBL-LVL-IND                          42244213
422455         END-EXEC                                                 42244413
422456                                                                          
422457       WHEN PS-USE-ALL-TRBL-PO-CSR                                41640013
422458         EXEC SQL                                                         
422459              FETCH ALL_BY_PO                                             
422460              INTO  :TRBNTF-NOTIF-NBR                                     
422461                  , :TRBNTF-OPER-UNT-ID                                   
422462                  , :TRBNTF-FCLTY-ID                                      
422463                  , :TRBNTF-DEPT-NBR                                      
422464                  , :TRBNTF-ENT-ID                                41683031
422465                  , :TRBNTF-PO-NBR                                41684031
422466                  , :TRBNTF-PO-LNE-NBR                            41685031
422467                  , :TRBNTF-REC-SEQ-NBR                           41686031
422468                  , :TRBNTF-TRBL-RSN-CDE                          41687031
422469                  , :TRBNTF-NOTIF-TMST                            41688031
422470                  , :TRBNTF-RESOLVED-IND                          41689031
422471                  , :TRBNTF-RESOLVED-TMST                         41689131
422472                  , :TRBNTF-ACKNOWLG-TMST                         41689231
422473                  , :TRBNTF-LAST-DTL-CRE-TMST                             
422474                  , :TRBNTF-INITR-ENT-ID                                  
422475                  , :TRBNTF-FOB-CDE                                       
422476                  , :TRBNTF-POE-CDE                                       
422477                  , :TRBRSN-TRBL-SHT-DESC                         41689331
422478                  , :TRBRSN-RESP-RES-IND                          41689431
422479                  , :TRBRSN-TRBL-LVL-IND                          41689531
422480         END-EXEC                                                 41830003
422481                                                                          
422490****  FETCH BY OLDEST TO NEWEST  TROUBLE SEQUENCE                 42245009
424500       WHEN PS-USE-DEPT-TRB-CSR                                   42450009
424600         EXEC SQL                                                 42460009
424700              FETCH DEPT_BY_TRBL                                  42470020
424800              INTO  :TRBNTF-NOTIF-NBR                                     
424900                  , :TRBNTF-OPER-UNT-ID                           42490009
425000                  , :TRBNTF-FCLTY-ID                              42500009
425100                  , :TRBNTF-DEPT-NBR                              42510009
425200                  , :TRBNTF-ENT-ID                                42520009
425300                  , :TRBNTF-PO-NBR                                42530009
425400                  , :TRBNTF-PO-LNE-NBR                            42540009
425500                  , :TRBNTF-REC-SEQ-NBR                           42550009
425600                  , :TRBNTF-TRBL-RSN-CDE                          42560009
425700                  , :TRBNTF-NOTIF-TMST                            42570009
425800                  , :TRBNTF-RESOLVED-IND                          42580009
425900                  , :TRBNTF-RESOLVED-TMST                         42590009
425910                  , :TRBNTF-ACKNOWLG-TMST                         42591009
425911                  , :TRBNTF-LAST-DTL-CRE-TMST                             
425920                  , :TRBNTF-INITR-ENT-ID                                  
425930                  , :TRBNTF-FOB-CDE                                       
425940                  , :TRBNTF-POE-CDE                                       
426000                  , :TRBRSN-TRBL-SHT-DESC                         42600009
426100                  , :TRBRSN-RESP-RES-IND                          42610009
426200                  , :TRBRSN-TRBL-LVL-IND                          42620009
426400         END-EXEC                                                 42640009
426410                                                                          
426500       WHEN PS-USE-BYR-TRB-CSR                                    42650009
426600         EXEC SQL                                                 42660009
426700              FETCH BUYER_BY_TRBL                                 42670020
426800              INTO  :TRBNTF-NOTIF-NBR                                     
426900                  , :TRBNTF-OPER-UNT-ID                           42690009
427000                  , :TRBNTF-FCLTY-ID                              42700009
427100                  , :TRBNTF-DEPT-NBR                              42710009
427200                  , :TRBNTF-ENT-ID                                42720009
427300                  , :TRBNTF-PO-NBR                                42730009
427400                  , :TRBNTF-PO-LNE-NBR                            42740009
427500                  , :TRBNTF-REC-SEQ-NBR                           42750009
427600                  , :TRBNTF-TRBL-RSN-CDE                          42760009
427700                  , :TRBNTF-NOTIF-TMST                            42770009
427800                  , :TRBNTF-RESOLVED-IND                          42780009
427900                  , :TRBNTF-RESOLVED-TMST                         42790009
427910                  , :TRBNTF-ACKNOWLG-TMST                         42791009
427911                  , :TRBNTF-LAST-DTL-CRE-TMST                             
427920                  , :TRBNTF-INITR-ENT-ID                                  
427930                  , :TRBNTF-FOB-CDE                                       
427940                  , :TRBNTF-POE-CDE                                       
428000                  , :TRBRSN-TRBL-SHT-DESC                         42800009
428100                  , :TRBRSN-RESP-RES-IND                          42810009
428200                  , :TRBRSN-TRBL-LVL-IND                          42820009
428400         END-EXEC                                                 42840009
428410                                                                          
428500       WHEN PS-USE-PO-TRB-CSR                                     42850014
428600         EXEC SQL                                                 42860009
428700              FETCH PO_BY_TRBL                                    42870020
428800              INTO  :TRBNTF-NOTIF-NBR                                     
428900                  , :TRBNTF-OPER-UNT-ID                           42890009
429000                  , :TRBNTF-FCLTY-ID                              42900009
429100                  , :TRBNTF-DEPT-NBR                              42910009
429200                  , :TRBNTF-ENT-ID                                42920009
429300                  , :TRBNTF-PO-NBR                                42930009
429400                  , :TRBNTF-PO-LNE-NBR                            42940009
429500                  , :TRBNTF-REC-SEQ-NBR                           42950009
429600                  , :TRBNTF-TRBL-RSN-CDE                          42960009
429700                  , :TRBNTF-NOTIF-TMST                            42970009
429800                  , :TRBNTF-RESOLVED-IND                          42980009
429900                  , :TRBNTF-RESOLVED-TMST                         42990009
429910                  , :TRBNTF-ACKNOWLG-TMST                         42991009
429911                  , :TRBNTF-LAST-DTL-CRE-TMST                             
429920                  , :TRBNTF-INITR-ENT-ID                                  
429930                  , :TRBNTF-FOB-CDE                                       
429940                  , :TRBNTF-POE-CDE                                       
430000                  , :TRBRSN-TRBL-SHT-DESC                         43000009
430100                  , :TRBRSN-RESP-RES-IND                          43010009
430200                  , :TRBRSN-TRBL-LVL-IND                          43020009
430400         END-EXEC                                                 43040009
430401                                                                          
430410       WHEN PS-USE-FOB-TRB-CSR                                    43041024
430420         EXEC SQL                                                 43042024
430430              FETCH FOB_BY_TRBL                                   43043024
430440              INTO :TRBNTF-NOTIF-NBR                              43044024
430450                  , :TRBNTF-OPER-UNT-ID                           43045024
430460                  , :TRBNTF-FCLTY-ID                              43046024
430470                  , :TRBNTF-DEPT-NBR                              43047024
430480                  , :TRBNTF-ENT-ID                                43048024
430490                  , :TRBNTF-PO-NBR                                43049024
430491                  , :TRBNTF-PO-LNE-NBR                            43049124
430492                  , :TRBNTF-REC-SEQ-NBR                           43049224
430493                  , :TRBNTF-TRBL-RSN-CDE                          43049324
430494                  , :TRBNTF-NOTIF-TMST                            43049424
430495                  , :TRBNTF-RESOLVED-IND                          43049524
430496                  , :TRBNTF-RESOLVED-TMST                         43049624
430497                  , :TRBNTF-ACKNOWLG-TMST                         43049724
430498                  , :TRBNTF-LAST-DTL-CRE-TMST                             
430499                  , :TRBNTF-INITR-ENT-ID                                  
430500                  , :TRBNTF-FOB-CDE                                       
430501                  , :TRBNTF-POE-CDE                                       
430502                  , :TRBRSN-TRBL-SHT-DESC                         43049824
430503                  , :TRBRSN-RESP-RES-IND                          43049924
430504                  , :TRBRSN-TRBL-LVL-IND                          43050024
430505         END-EXEC                                                 43050224
430506                                                                          
430507       WHEN PS-USE-POE-TRB-CSR                                    43050324
430508         EXEC SQL                                                 43050424
430509              FETCH POE_BY_TRBL                                   43050524
430510              INTO :TRBNTF-NOTIF-NBR                              43050624
430511                  , :TRBNTF-OPER-UNT-ID                           43050724
430512                  , :TRBNTF-FCLTY-ID                              43050824
430513                  , :TRBNTF-DEPT-NBR                              43050924
430514                  , :TRBNTF-ENT-ID                                43051024
430515                  , :TRBNTF-PO-NBR                                43051124
430516                  , :TRBNTF-PO-LNE-NBR                            43051224
430517                  , :TRBNTF-REC-SEQ-NBR                           43051324
430518                  , :TRBNTF-TRBL-RSN-CDE                          43051424
430519                  , :TRBNTF-NOTIF-TMST                            43051524
430520                  , :TRBNTF-RESOLVED-IND                          43051624
430521                  , :TRBNTF-RESOLVED-TMST                         43051724
430522                  , :TRBNTF-ACKNOWLG-TMST                         43051824
430523                  , :TRBNTF-LAST-DTL-CRE-TMST                             
430524                  , :TRBNTF-INITR-ENT-ID                                  
430525                  , :TRBNTF-FOB-CDE                                       
430526                  , :TRBNTF-POE-CDE                                       
430527                  , :TRBRSN-TRBL-SHT-DESC                         43051924
430528                  , :TRBRSN-RESP-RES-IND                          43052024
430529                  , :TRBRSN-TRBL-LVL-IND                          43052124
430530         END-EXEC                                                 43052324
430531                                                                          
430532       WHEN PS-USE-OTB-TRB-CSR                                    43052424
430533         EXEC SQL                                                 43052524
430534              FETCH OTB_BY_TRBL                                   43052624
430535              INTO :TRBNTF-NOTIF-NBR                              43052724
430536                  , :TRBNTF-OPER-UNT-ID                           43052824
430537                  , :TRBNTF-FCLTY-ID                              43052924
430538                  , :TRBNTF-DEPT-NBR                              43053024
430539                  , :TRBNTF-ENT-ID                                43053124
430540                  , :TRBNTF-PO-NBR                                43053224
430541                  , :TRBNTF-PO-LNE-NBR                            43053324
430542                  , :TRBNTF-REC-SEQ-NBR                           43053424
430543                  , :TRBNTF-TRBL-RSN-CDE                          43053524
430544                  , :TRBNTF-NOTIF-TMST                            43053624
430545                  , :TRBNTF-RESOLVED-IND                          43053724
430546                  , :TRBNTF-RESOLVED-TMST                         43053824
430547                  , :TRBNTF-ACKNOWLG-TMST                         43053924
430548                  , :TRBNTF-LAST-DTL-CRE-TMST                             
430549                  , :TRBNTF-INITR-ENT-ID                                  
430550                  , :TRBNTF-FOB-CDE                                       
430551                  , :TRBNTF-POE-CDE                                       
430552                  , :TRBRSN-TRBL-SHT-DESC                         43054024
430553                  , :TRBRSN-RESP-RES-IND                          43054124
430554                  , :TRBRSN-TRBL-LVL-IND                          43054224
430555         END-EXEC                                                 43054424
430556                                                                          
430557       WHEN PS-USE-ALL-TRBL-TRB-CSR                               43052424
430558         EXEC SQL                                                 43052524
430559              FETCH ALL_BY_TRBL                                   43052624
430560              INTO :TRBNTF-NOTIF-NBR                              43052724
430561                  , :TRBNTF-OPER-UNT-ID                           43052824
430562                  , :TRBNTF-FCLTY-ID                              43052924
430563                  , :TRBNTF-DEPT-NBR                              43053024
430564                  , :TRBNTF-ENT-ID                                43053124
430565                  , :TRBNTF-PO-NBR                                43053224
430566                  , :TRBNTF-PO-LNE-NBR                            43053324
430567                  , :TRBNTF-REC-SEQ-NBR                           43053424
430568                  , :TRBNTF-TRBL-RSN-CDE                          43053524
430569                  , :TRBNTF-NOTIF-TMST                            43053624
430570                  , :TRBNTF-RESOLVED-IND                          43053724
430571                  , :TRBNTF-RESOLVED-TMST                         43053824
430572                  , :TRBNTF-ACKNOWLG-TMST                         43053924
430573                  , :TRBNTF-LAST-DTL-CRE-TMST                             
430574                  , :TRBNTF-INITR-ENT-ID                                  
430575                  , :TRBNTF-FOB-CDE                                       
430576                  , :TRBNTF-POE-CDE                                       
430577                  , :TRBRSN-TRBL-SHT-DESC                         43054024
430578                  , :TRBRSN-RESP-RES-IND                          43054124
430579                  , :TRBRSN-TRBL-LVL-IND                          43054224
430580         END-EXEC                                                 43054424
430590     END-EVALUATE.                                                43055024
430600                                                                  43060003
430700     EVALUATE TRUE                                                43070003
430800         WHEN SQLCODE = ZERO                                      43080003
430900              CONTINUE                                            43090003
431000         WHEN SQLCODE = +100                                      43100003
431100              SET PS-NO-TRBL-NOTIF-ITEMS-LEFT TO TRUE             43110003
431200         WHEN SQLWARN0 NOT = SPACE                                43120003
431300         WHEN SQLCODE NOT = ZERO                                  43130003
431400              MOVE '4310-FETCH-TROUBLE-NOTIF-ITEM'                43140003
431500                               TO DP013-PARAGRAPH                 43150003
431600              MOVE 'FETCH TROUBLE NOTIFICATION CURSOR'            43160003
431700                               TO DP013-MESSAGE-TEXT (1)          43170003
431800              MOVE SQLCA       TO DP013-SQLCA                     43180003
431900              MOVE 'TTRBNTF '  TO DP013-DB2-TABLE-NAME (1)        43190003
432000              MOVE 'TTRBRSN '  TO DP013-DB2-TABLE-NAME (2)        43200003
432200              SET DP013-DB2-ABEND TO TRUE                         43220003
432300              PERFORM DP013-0000-PROCESS-ABEND                    43230003
432400     END-EVALUATE.                                                43240003
432500                                                                  43250003
432600*----------------------------------------------------------------*43260003
432700*    RETRIEVE VENDOR SHORT NAME FROM THE ENTITY NAME TABLE FOR   *43270003
432800*    THIS NOTIFICATION RECORD.                                   *43280003
432900*----------------------------------------------------------------*43290003
433000 4320-FETCH-VENDOR-SHORT-NAME.                                    43300003
433100     PERFORM                                                      43310003
433200         WITH TEST AFTER                                          43320003
433300         VARYING PV-RETRY-COUNTER                                 43330003
433400         FROM 1 BY 1                                              43340003
433500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43350003
433600                   OR (SQLCODE = ZERO OR +100))                   43360003
433700                                                                  43370003
433800         EXEC SQL                                                 43380003
433900              SELECT ENT_NAME_DESC                                43390003
434000                INTO :ENTNME-ENT-NAME-DESC                        43400003
434100                FROM TENTNME                                      43410003
434200               WHERE ENT_ID  = :TRBNTF-ENT-ID                     43420003
434300                 AND TYPE_CDE = :PC-TYPE-CODE-SHORT-NAME          43430003
434400         END-EXEC                                                 43440003
434500                                                                  43450003
434600         EVALUATE TRUE                                            43460003
434700             WHEN SQLCODE = ZERO                                  43470003
434800             WHEN SQLCODE = -904                                  43480003
434900             WHEN SQLCODE = -913                                  43490003
435000                  CONTINUE                                        43500003
435100             WHEN SQLCODE = +100                                  43510003
435200                  MOVE SPACES    TO ENTNME-ENT-NAME-DESC          43520003
435300             WHEN SQLWARN0 NOT = SPACE                            43530003
435400             WHEN SQLCODE NOT = ZERO                              43540003
435500                  MOVE '4320-FETCH-VENDOR-SHORT-NAME'             43550003
435600                                   TO DP013-PARAGRAPH             43560003
435700                  MOVE 'FETCH VENDOR SHORT NAME INFORMATION'      43570003
435800                                   TO DP013-MESSAGE-TEXT (1)      43580003
435900                  MOVE TRBNTF-PO-NBR                              43590003
436000                                   TO PV-ERROR-PO-NBR             43600003
436100                  MOVE TRBNTF-REC-SEQ-NBR                         43610003
436200                                   TO PV-ERROR-REC-SEQ-NBR        43620003
436300                MOVE TRBNTF-PO-LNE-NBR                            43630003
436400                                 TO PV-ERROR-PO-LNE-NBR           43640003
436500                MOVE TRBNTF-NOTIF-NBR                             43650003
436600                                 TO PV-ERROR-NOTIF-NBR            43660003
436700                STRING ' RCVR: '              DELIMITED BY SIZE   43670003
436800                     PV-ERROR-PO-NBR          DELIMITED BY SIZE   43680003
436900                     '-'                      DELIMITED BY SIZE   43690003
437000                     PV-ERROR-REC-SEQ-NBR     DELIMITED BY SIZE   43700003
437100                     ' PO LINE NBR: '         DELIMITED BY SIZE   43710003
437200                     PV-ERROR-PO-LNE-NBR      DELIMITED BY SIZE   43720003
437300                     ' NOTIFICATION NBR: '    DELIMITED BY SIZE   43730003
437400                     PV-ERROR-NOTIF-NBR       DELIMITED BY SIZE   43740003
437500                             INTO DP013-MESSAGE-TEXT (2)          43750003
437600              MOVE SQLCA       TO DP013-SQLCA                     43760003
437700              MOVE 'TENTNME '  TO DP013-DB2-TABLE-NAME (1)        43770003
437800              SET DP013-DB2-ABEND TO TRUE                         43780003
437900              PERFORM DP013-0000-PROCESS-ABEND                    43790003
438000         END-EVALUATE                                             43800003
438100     END-PERFORM.                                                 43810003
438200                                                                  43820003
438300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        43830003
438400         MOVE '4320-FETCH-VENDOR-SHORT-NAME'                      43840003
438500                                   TO DP013-PARAGRAPH             43850003
438600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     43860003
438700                                   TO DP013-MESSAGE-TEXT (1)      43870003
438800         MOVE SQLCA                TO DP013-SQLCA                 43880003
438900         MOVE 'TENTNME '           TO DP013-DB2-TABLE-NAME (1)    43890003
439000         SET DP013-DB2-ABEND                                      43900003
439100             DP013-XCTL-DISPLAY-RESTART TO TRUE                   43910003
439200         PERFORM DP013-0000-PROCESS-ABEND                         43920003
439300     END-IF.                                                      43930003
439400                                                                  43940003
446010*----------------------------------------------------------------*43950003
446020*    RETRIEVE THE SCAC CODE                                      *43960003
446030*----------------------------------------------------------------*43970003
446040*4330-FETCH-SCAC-CDE.                                             43980003
446050*MAM INITIALIZE DCLTEXTENT.                                       43990003
446060*MAM                                                              44000003
446070*    PERFORM                                                      44010003
446080*        WITH TEST AFTER                                          44020003
446090*        VARYING PV-RETRY-COUNTER                                 44030003
446091*        FROM 1 BY 1                                              44040003
446092*        UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44050003
446093*                  OR (SQLCODE = ZERO OR +100))                   44060003
446094*                                                                 44070003
446095*        EXEC SQL                                                 44080003
446096*             SELECT SCAC_CDE                                     44090003
446097*               INTO :EXTENT-SCAC-CDE                             44100003
446098*               FROM TEXTENT                                      44110003
446099*              WHERE ENT_ID   =  :TRBNTF-INITR-ENT-ID             44120003
446101*        END-EXEC                                                 44140003
446102*                                                                 44150003
446103*        EVALUATE TRUE                                            44160003
446104*            WHEN SQLCODE = ZERO                                  44170003
446105*            WHEN SQLCODE = -904                                  44180003
446106*            WHEN SQLCODE = -913                                  44190003
446107*                 CONTINUE                                        44200003
446108*            WHEN SQLCODE = +100                                  44210003
446109*                 MOVE SPACES  TO EXTENT-SCAC-CDE                 44220003
446110*            WHEN SQLWARN0 NOT = SPACE                            44230003
446111*            WHEN SQLCODE NOT = ZERO                              44240003
446112*                 MOVE '4330-FETCH-SCAC-CDE'                      44250003
446113*                                  TO DP013-PARAGRAPH             44260003
446114*                 MOVE 'FETCH SCAC CODE'                          44270003
446115*                                  TO DP013-MESSAGE-TEXT (1)      44280003
446116*                 MOVE TRBNTF-PO-NBR TO PV-ERROR-PO-NBR           44290009
446117*                 MOVE TRBNTF-REC-SEQ-NBR TO PV-ERROR-REC-SEQ-NBR 44300009
446118*                 MOVE TRBNTF-PO-LNE-NBR TO PV-ERROR-PO-LNE-NBR   44310009
446119*                 MOVE TRBNTF-NOTIF-NBR TO PV-ERROR-NOTIF-NBR     44320009
446120*             STRING ' RCVR: '                DELIMITED BY SIZE   44330003
446121*                    PV-ERROR-PO-NBR          DELIMITED BY SIZE   44340003
446122*                    '-'                      DELIMITED BY SIZE   44350003
446123*                    PV-ERROR-REC-SEQ-NBR     DELIMITED BY SIZE   44360003
446124*                    ' PO LINE NBR: '         DELIMITED BY SIZE   44370003
446125*                    PV-ERROR-PO-LNE-NBR      DELIMITED BY SIZE   44380003
446126*                    ' NOTIFICATION NBR: '    DELIMITED BY SIZE   44390003
446127*                    PV-ERROR-NOTIF-NBR       DELIMITED BY SIZE   44400003
446128*                            INTO DP013-MESSAGE-TEXT (2)          44410003
446129*                 MOVE SQLCA   TO DP013-SQLCA                     44420003
446130*                 MOVE 'TEXTENT ' TO DP013-DB2-TABLE-NAME (1)     44430003
446131*                 SET DP013-DB2-ABEND TO TRUE                     44440003
446132*                 PERFORM DP013-0000-PROCESS-ABEND                44450003
446133*        END-EVALUATE                                             44460003
446134*    END-PERFORM.                                                 44470003
446135*                                                                 44480003
446136*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        44490003
446137*        MOVE '4330-FETCH-SCAC-CDE'                               44500003
446138*                                  TO DP013-PARAGRAPH             44510003
446139*        MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     44520003
446140*                                  TO DP013-MESSAGE-TEXT (1)      44530003
446141*        MOVE SQLCA                TO DP013-SQLCA                 44540003
446142*        MOVE 'TEXTENT '           TO DP013-DB2-TABLE-NAME (1)    44550003
446143*        SET DP013-DB2-ABEND                                      44560003
446144*            DP013-XCTL-DISPLAY-RESTART TO TRUE                   44570003
446145*        PERFORM DP013-0000-PROCESS-ABEND                         44580003
446146*    END-IF.                                                      44590003
446147                                                                  44600003
446148*----------------------------------------------------------------*43950003
446149*    FOB AND POE CODES                                           *43960003
446150*----------------------------------------------------------------*43970003
446151 4330-FOB-POE-CDE.                                                43980003
446153                                                                  44000003
446154     IF TRBNTF-POE-CDE > SPACES                                           
446155         MOVE TRBNTF-POE-CDE TO ASC-FOB-POE-CDE                           
446156                               (ASC-BLK-SUB ASC-ITEM-SUB)                 
446157     ELSE                                                                 
446158        IF TRBNTF-FOB-CDE > SPACES                                        
446159            MOVE TRBNTF-FOB-CDE TO ASC-FOB-POE-CDE                        
446160                                  (ASC-BLK-SUB ASC-ITEM-SUB)              
446161        ELSE                                                              
446162            MOVE SPACES TO ASC-FOB-POE-CDE                                
446163                          (ASC-BLK-SUB ASC-ITEM-SUB)                      
446164        END-IF                                                            
446165     END-IF.                                                              
446166                                                                          
446213*----------------------------------------------------------------*44610003
446220*    RETRIEVE THE TROUBLE DETAIL ROW FOR A SPECIFIC TROUBLE      *44620003
446300*    NOTIFICATION RECORD, LOOKING FOR THE ROW WITH THE MOST      *44630003
446400*    CURRENT TIMESTAMP.                                          *44640003
446500*----------------------------------------------------------------*44650003
446600 4350-FETCH-TROUBLE-DETAIL.                                       44660003
446700     INITIALIZE PV-MAX-RESP-DATE.                                 44670003
446800     PERFORM 4360-FETCH-MAX-DATE-TRBL-NOTIF                       44680003
446900                                                                  44690003
447000     IF  PV-MAX-RESP-DATE > SPACES                                44700003
447100         MOVE PV-MAX-RESP-DATE       TO PV-TIMESTAMP              44710003
447200         SET PS-TRBL-DTL-EXISTS      TO TRUE                      44720003
447300     ELSE                                                         44730003
447400         MOVE PC-DUMMY-DB2-DATE      TO PV-TIMESTAMP              44740003
447500         SET PS-NO-TRBL-DTL-EXISTS   TO TRUE                      44750003
447600     END-IF.                                                      44760003
447700                                                                  44770003
447800*----------------------------------------------------------------*44780003
447900*  RETRIEVE THE DATE OF THE MOST CURRENT TROUBLE DETAIL RECORD   *44790003
448000*----------------------------------------------------------------*44800003
448100 4360-FETCH-MAX-DATE-TRBL-NOTIF.                                  44810003
448200     PERFORM                                                      44820003
448300         WITH TEST AFTER                                          44830003
448400         VARYING PV-RETRY-COUNTER                                 44840003
448500         FROM 1 BY 1                                              44850003
448600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44860003
448700                   OR (SQLCODE = ZERO OR +100 OR -305))           44870003
448800                                                                  44880003
448900         EXEC SQL                                                 44890003
449000              SELECT MAX(LAST_DTL_CRE_TMST)                       44900003
449100                INTO :PV-MAX-RESP-DATE                            44910003
449200                FROM TTRBNTF                                      44920003
449300               WHERE OPER_UNT_ID = :TRBNTF-OPER-UNT-ID            44930003
449400                 AND FCLTY_ID  = :TRBNTF-FCLTY-ID                 44940003
449500                 AND PO_NBR    = :TRBNTF-PO-NBR                   44950003
449600                 AND REC_SEQ_NBR = :TRBNTF-REC-SEQ-NBR            44960003
449700                 AND TRBL_RSN_CDE = :TRBNTF-TRBL-RSN-CDE          44970003
449800                 AND LAST_DTL_CRE_TMST                            44980003
449900                          NOT IN ('9999-09-09-09.09.09.999999'    44990003
450000                                , '0001-01-01-00.00.00.000000')   45000003
450100         END-EXEC                                                 45010003
450200                                                                  45020003
450300         EVALUATE TRUE                                            45030003
450400             WHEN SQLCODE = ZERO                                  45040003
450500             WHEN SQLCODE = +100                                  45050003
450600             WHEN SQLCODE = -305                                  45060003
450700             WHEN SQLCODE = -904                                  45070003
450800             WHEN SQLCODE = -913                                  45080003
450900                  CONTINUE                                        45090003
451000             WHEN SQLWARN0 NOT = SPACE                            45100003
451100             WHEN SQLCODE NOT = ZERO                              45110003
451200                  MOVE '4360-FETCH-MAX-DATE-TRBL-NOTIF'           45120003
451300                                   TO DP013-PARAGRAPH             45130003
451400                  MOVE 'FETCH MOST CURRENT TROUBLE DETAIL DATE'   45140003
451500                                   TO DP013-MESSAGE-TEXT (1)      45150003
451600                  MOVE TRBNTF-PO-NBR TO PV-ERROR-PO-NBR           45160003
451700                  MOVE TRBNTF-REC-SEQ-NBR TO PV-ERROR-REC-SEQ-NBR 45170003
451800                  MOVE TRBNTF-PO-LNE-NBR TO PV-ERROR-PO-LNE-NBR   45180003
451900                  MOVE TRBNTF-NOTIF-NBR TO PV-ERROR-NOTIF-NBR     45190003
452000                  STRING ' RCVR: '            DELIMITED BY SIZE   45200003
452100                     PV-ERROR-PO-NBR          DELIMITED BY SIZE   45210003
452200                     '-'                      DELIMITED BY SIZE   45220003
452300                     PV-ERROR-REC-SEQ-NBR     DELIMITED BY SIZE   45230003
452400                     ' PO LINE NBR: '         DELIMITED BY SIZE   45240003
452500                     PV-ERROR-PO-LNE-NBR      DELIMITED BY SIZE   45250003
452600                     ' NOTIFICATION NBR: '    DELIMITED BY SIZE   45260003
452700                     PV-ERROR-NOTIF-NBR       DELIMITED BY SIZE   45270003
452800                                 INTO DP013-MESSAGE-TEXT (2)      45280003
452900                  MOVE SQLCA       TO DP013-SQLCA                 45290003
453000                  MOVE 'TTRBNTF '  TO DP013-DB2-TABLE-NAME (1)    45300003
453100                  SET DP013-DB2-ABEND TO TRUE                     45310003
453200                  PERFORM DP013-0000-PROCESS-ABEND                45320003
453300         END-EVALUATE                                             45330003
453400     END-PERFORM.                                                 45340003
453500                                                                  45350003
453600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        45360003
453700         IF SQLCODE = -913                                        45370003
453800             PERFORM 9910-SQL-913-RETURN                          45380003
453900         ELSE                                                     45390003
454000             MOVE '4360-FETCH-MAX-DATE-TRBL-NOTIF'                45400003
454100                                     TO DP013-PARAGRAPH           45410003
454200             MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT' 45420003
454300                                     TO DP013-MESSAGE-TEXT (1)    45430003
454400             MOVE SQLCA              TO DP013-SQLCA               45440003
454500             MOVE 'TTRBNTF '         TO DP013-DB2-TABLE-NAME (1)  45450003
454600             SET DP013-DB2-ABEND                                  45460003
454700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               45470003
454800             PERFORM DP013-0000-PROCESS-ABEND                     45480003
454900         END-IF                                                   45490003
455000     END-IF.                                                      45500003
455100                                                                  45510003
455110*----------------------------------------------------------------*44780003
455120*  COUNT TTRBDTL                                                 *44790003
455130*----------------------------------------------------------------*44800003
455140 4365-COUNT-TRBDTL.                                               44810003
455141     PERFORM                                                      45570003
455142         WITH TEST AFTER                                          45580003
455143         VARYING PV-RETRY-COUNTER                                 45590003
455144         FROM 1 BY 1                                              45600003
455145         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45610003
455146                   OR (SQLCODE = ZERO OR +100 OR -305))           44870003
455148                                                                  45630003
455149         EXEC SQL                                                 45640003
455150              SELECT COUNT(*)                                     45650003
455151                INTO :PV-TTRBDTL-CNT                              45660003
455152                FROM TTRBDTL                                      45670003
455153               WHERE NOTIF_NBR   = :TRBNTF-NOTIF-NBR              45680003
455154                 AND CRE_TMST    = :TRBNTF-LAST-DTL-CRE-TMST      45690003
455155                 AND CRE_UID    ^= :PC-TMKUP625                           
455159         END-EXEC                                                 45740003
455160                                                                  45750003
455161         EVALUATE TRUE                                            45760003
455162             WHEN SQLCODE = ZERO                                  45770003
455163             WHEN SQLCODE = +100                                  45780003
455164             WHEN SQLCODE = -305                                  45780003
455165             WHEN SQLCODE = -904                                  45790003
455166             WHEN SQLCODE = -913                                  45800003
455167                  CONTINUE                                        45810003
455168             WHEN SQLWARN0 NOT = SPACE                            45820003
455169             WHEN SQLCODE NOT = ZERO                              45830003
455170                  MOVE '4365-COUNT-TRBDTL'                        45840003
455171                                   TO DP013-PARAGRAPH             45850003
455172                  MOVE 'COUNTING TROUBLE DETAIL FOR:'             45860003
455173                                   TO DP013-MESSAGE-TEXT (1)      45870003
455174                  MOVE TRBNTF-PO-NBR TO  PV-ERROR-PO-NBR          45880003
455175                  MOVE TRBNTF-TRBL-RSN-CDE                        45900003
455176                                   TO PV-ERROR-TRBL-RSN-CDE       45910003
455177                  STRING '   PO: '            DELIMITED BY SIZE   45920003
455178                     PV-ERROR-PO-NBR          DELIMITED BY SIZE   45930003
455181                     ' TROUBLE REASON: '      DELIMITED BY SIZE   45960003
455182                     PV-ERROR-TRBL-RSN-CDE    DELIMITED BY SIZE   45970003
455183                             INTO DP013-MESSAGE-TEXT (2)          45980003
455184                  MOVE SQLCA   TO DP013-SQLCA                     45990003
455185                  MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)     46000003
455186                  SET DP013-DB2-ABEND TO TRUE                     46010003
455187                  PERFORM DP013-0000-PROCESS-ABEND                46020003
455188         END-EVALUATE                                             46030003
455189     END-PERFORM.                                                 46040003
455190                                                                  46050003
455191     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        46060003
455192         IF SQLCODE = -913                                        46070003
455193             PERFORM 9910-SQL-913-RETURN                          46080003
455194         ELSE                                                     46090003
455195             MOVE '4650-COUNT-TRBDTL' TO DP013-PARAGRAPH          46100003
455197             MOVE                                                 46120003
455198                 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'  46130003
455199                                     TO DP013-MESSAGE-TEXT (1)    46140003
455200             MOVE SQLCA              TO DP013-SQLCA               46150003
455201             MOVE 'TTRBNTF '         TO DP013-DB2-TABLE-NAME (1)  46160003
455202             SET DP013-DB2-ABEND                                  46170003
455203                 DP013-XCTL-DISPLAY-RESTART TO TRUE               46180003
455204             PERFORM DP013-0000-PROCESS-ABEND                     46190003
455205         END-IF                                                   46200003
455206     END-IF.                                                      46210003
455276                                                                  45510003
455280*----------------------------------------------------------------*45520003
455300*    COUNT THE NUMBER OF UNRESOLVED TROUBLE NOTIFICATION RECORDS *45530003
455400*    FOR A SPECIFIC PO, RCVR SEQ, AND TROUBLE REASON.            *45540003
455500*----------------------------------------------------------------*45550003
455600 4370-COUNT-UNRESOLVED-TROUBLE.                                   45560003
455700     PERFORM                                                      45570003
455800         WITH TEST AFTER                                          45580003
455900         VARYING PV-RETRY-COUNTER                                 45590003
456000         FROM 1 BY 1                                              45600003
456100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45610003
456200                   OR (SQLCODE = ZERO OR +100))                   45620003
456300                                                                  45630003
456400         EXEC SQL                                                 45640003
456500              SELECT COUNT(*)                                     45650003
456600                INTO :PV-UNRESOLVED-TROUBLE-COUNT                 45660003
456700                FROM TTRBNTF                                      45670003
456800               WHERE OPER_UNT_ID = :TRBNTF-OPER-UNT-ID            45680003
456900                 AND FCLTY_ID    = :TRBNTF-FCLTY-ID               45690003
457000                 AND PO_NBR      = :TRBNTF-PO-NBR                 45700003
457100                 AND REC_SEQ_NBR = :TRBNTF-REC-SEQ-NBR            45710003
457200                 AND TRBL_RSN_CDE = :TRBNTF-TRBL-RSN-CDE          45720003
457300                 AND RESOLVED_TMST = :PC-DUMMY-DB2-DATE           45730003
457400         END-EXEC                                                 45740003
457500                                                                  45750003
457600         EVALUATE TRUE                                            45760003
457700             WHEN SQLCODE = ZERO                                  45770003
457800             WHEN SQLCODE = +100                                  45780003
457900             WHEN SQLCODE = -904                                  45790003
458000             WHEN SQLCODE = -913                                  45800003
458100                  CONTINUE                                        45810003
458200             WHEN SQLWARN0 NOT = SPACE                            45820003
458300             WHEN SQLCODE NOT = ZERO                              45830003
458400                  MOVE '4370-COUNT-UNRESOLVED-TROUBLE'            45840003
458500                                   TO DP013-PARAGRAPH             45850003
458600                  MOVE 'COUNTING UNRESOLVED TROUBLE FOR:'         45860003
458700                                   TO DP013-MESSAGE-TEXT (1)      45870003
458800                  MOVE TRBNTF-PO-NBR TO  PV-ERROR-PO-NBR          45880003
458900                  MOVE TRBNTF-REC-SEQ-NBR TO PV-ERROR-REC-SEQ-NBR 45890003
459000                  MOVE TRBNTF-TRBL-RSN-CDE                        45900003
459100                                   TO PV-ERROR-TRBL-RSN-CDE       45910003
459200                  STRING ' RCVR: '            DELIMITED BY SIZE   45920003
459300                     PV-ERROR-PO-NBR          DELIMITED BY SIZE   45930003
459400                     '-'                      DELIMITED BY SIZE   45940003
459500                     PV-ERROR-REC-SEQ-NBR     DELIMITED BY SIZE   45950003
459600                     ' TROUBLE REASON: '      DELIMITED BY SIZE   45960003
459700                     PV-ERROR-TRBL-RSN-CDE    DELIMITED BY SIZE   45970003
459800                             INTO DP013-MESSAGE-TEXT (2)          45980003
459900                  MOVE SQLCA   TO DP013-SQLCA                     45990003
460000                  MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)     46000003
460100                  SET DP013-DB2-ABEND TO TRUE                     46010003
460200                  PERFORM DP013-0000-PROCESS-ABEND                46020003
460300         END-EVALUATE                                             46030003
460400     END-PERFORM.                                                 46040003
460500                                                                  46050003
460600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        46060003
460700         IF SQLCODE = -913                                        46070003
460800             PERFORM 9910-SQL-913-RETURN                          46080003
460900         ELSE                                                     46090003
461000             MOVE '4370-COUNT-UNRESOLVED-TROUBLE'                 46100003
461100                                     TO DP013-PARAGRAPH           46110003
461200             MOVE                                                 46120003
461300                 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'  46130003
461400                                     TO DP013-MESSAGE-TEXT (1)    46140003
461500             MOVE SQLCA              TO DP013-SQLCA               46150003
461600             MOVE 'TTRBNTF '         TO DP013-DB2-TABLE-NAME (1)  46160003
461700             SET DP013-DB2-ABEND                                  46170003
461800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               46180003
461900             PERFORM DP013-0000-PROCESS-ABEND                     46190003
462000         END-IF                                                   46200003
462100     END-IF.                                                      46210003
462200                                                                  46220003
462421*----------------------------------------------------------------*46236009
462430* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *46240003
462500*----------------------------------------------------------------*46250003
462600 4400-MOVE-COMMAREA-TO-SCREEN.                                    46260003
462700     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             46270003
462800         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          46280003
462900         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          46290003
463000             MOVE +1    TO ASC-BLK-SUB                            46300003
463100             PERFORM 5100-WRITE-TEMP-STORAGE                      46310003
463200             ADD +1     TO ASC-BLK-SUB                            46320003
463300             PERFORM 5100-WRITE-TEMP-STORAGE                      46330003
463400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             46340003
463500                 GIVING PV-BLOCK-NUMBER                           46350003
463600                 REMAINDER PV-REMAINDER                           46360003
463700             IF  PV-REMAINDER > ZERO                              46370003
463800                 ADD +1 TO PV-BLOCK-NUMBER                        46380003
463900             END-IF                                               46390003
464000             MOVE +1    TO ASC-BLK-SUB                            46400003
464100             PERFORM 4410-READ-TEMP-STORAGE                       46410003
464200             ADD +1     TO ASC-BLK-SUB                            46420003
464300                           PV-BLOCK-NUMBER                        46430003
464400             PERFORM 4410-READ-TEMP-STORAGE                       46440003
464500     END-IF.                                                      46450003
464600     MOVE +1            TO ASC-BLK-SUB.                           46460003
464700     COMPUTE PV-ASC-ITEM-SUB-COMP3 =                              46470003
464800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              46480003
464900         + PC-ITEMS-PER-PANEL-COMP3).                             46490003
465000     MOVE  PV-ASC-ITEM-SUB-COMP3 TO ASC-ITEM-SUB.                 46500003
465100     MOVE  PC-ITEMS-PER-PANEL-COMP3 TO PC-ITEMS-PER-PANEL.        46510003
465200                                                                  46520003
465300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        46530003
465400         ADD +1         TO ASC-BLK-SUB                            46540003
465500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            46550003
465600     END-IF.                                                      46560003
465700                                                                  46570003
465800     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           46580003
465900         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                46590003
466000     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        46600003
466100     PERFORM 4420-FORMAT-LIST-LINES                               46610003
466200         VARYING PV-SUB                                           46620003
466300         FROM PC-ITEMS-PER-PANEL BY -1                            46630003
466400         UNTIL PV-SUB < +1.                                       46640003
466500                                                                  46650003
466600     COMPUTE ASC-ITEMS-DISPLAYED =                                46660003
466700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          46670003
466800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    46680003
466900                                      ASTRTITO.                   46690003
467000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    46700003
467100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    46710003
467200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO ASELITO.                46720003
467300                                                                  46730003
469100     IF  DP020-MSG-NUMBER-X = SPACE                               46910003
469200         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  46920003
469300*            --- MORE ITEMS TO DISPLAY ----                       46930003
469400             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            46940003
469500             SET DP020-MSG-INFORMATIONAL TO TRUE                  46950003
469600         END-IF                                                   46960003
469700     END-IF.                                                      46970003
469800                                                                  46980003
469900*----------------------------------------------------------------*46990003
470000*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *47000003
470100*----------------------------------------------------------------*47010003
470200 4410-READ-TEMP-STORAGE.                                          47020003
470300     EXEC CICS                                                    47030003
470400         READQ TS                                                 47040003
470500             QUEUE (ASC-LIST-QUEUE-NAME)                          47050003
470600             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               47060003
470700             ITEM  (PV-BLOCK-NUMBER)                              47070003
470800             RESP  (PV-CICS-RESP)                                 47080003
470900     END-EXEC.                                                    47090003
471000                                                                  47100003
471100     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       47110003
471200       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     47120003
471300         CONTINUE                                                 47130003
471400     ELSE                                                         47140003
471500         SET DP013-CICS-ABEND     TO TRUE                         47150003
471600         SET DP013-NO-ROLLBACK    TO TRUE                         47160003
471700         MOVE '4410-READ-TEMP-STORAGE' TO DP013-PARAGRAPH         47170003
471800         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      47180003
471900                                  TO DP013-MESSAGE-TEXT(1)        47190003
472000         PERFORM DP013-0000-PROCESS-ABEND                         47200003
472100     END-IF.                                                      47210003
472200                                                                  47220003
472300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             47230003
472400                                                                  47240003
472500     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         47250003
472600         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               47260003
472700     END-IF.                                                      47270003
472800                                                                  47280003
472900                                                                  47290003
473000*----------------------------------------------------------------*47300003
473100*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *47310003
473200*----------------------------------------------------------------*47320003
473300 4420-FORMAT-LIST-LINES.                                          47330003
473400     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      47340003
473500         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                47350003
473600         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           47360003
473700         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           47370003
473800         MOVE SPACE              TO MR-SELECTI (PV-SUB)           47380003
473900                                    MR-ACTION (PV-SUB)            47390003
474000                                    MR-DEPT (PV-SUB)              47400003
474100                                    MR-PO-NBR (PV-SUB)            47410003
474200                                    MR-RCVR-SEQ-NBR (PV-SUB)      47420003
474300                                    MR-VENDOR-NME (PV-SUB)        47430003
474400                                    MR-FOB-POE-CDE (PV-SUB)       47440003
474500                                    MR-TROUBLE-REASON (PV-SUB)    47450003
474600                                    MR-ARRIVAL-DATE-TIME (PV-SUB) 47460003
474700                                    MR-NOTIFICATION-DATE-TIME     47470003
474800                                                          (PV-SUB)47480003
474900                                    MR-RESPONSE-DATE-TIME (PV-SUB)47490003
475000     ELSE                                                         47500003
475100         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      47510003
475200                                                   > SPACE        47520003
475300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 47530003
475400                                 TO MR-SELECTI (PV-SUB)           47540003
475500         ELSE                                                     47550003
475600             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      47560003
475700                                 TO MR-SELECTI (PV-SUB)           47570003
475800         END-IF                                                   47580003
475900                                                                  47590003
476000         IF  DP030-SET-CURSOR-TRAILER                             47600003
476100             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)47610003
476200                 > SPACE)                                         47620003
476300               OR (PV-SUB = 1))                                   47630003
476400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               47640003
476500                MOVE -1          TO MR-SELECTL (PV-SUB)           47650003
476600             END-IF                                               47660003
476700         END-IF                                                   47670003
476800                                                                  47680003
476900         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           47690003
477000             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           47700003
477100                                 TO MR-ACTION (PV-SUB)            47710003
477200             MOVE ASC-DEPT-NBR (ASC-BLK-SUB ASC-ITEM-SUB)         47720003
477300                                 TO MR-DEPT-N (PV-SUB)            47730003
477400             MOVE ASC-PO-NBR-N (ASC-BLK-SUB ASC-ITEM-SUB)         47740003
477500                                 TO MR-PO-NBR-N (PV-SUB)          47750003
477600             MOVE ASC-RCVR-SEQ-NBR-N (ASC-BLK-SUB ASC-ITEM-SUB)   47760003
477700                                 TO MR-RCVR-SEQ-NBR-N (PV-SUB)    47770003
477800             MOVE ASC-VENDOR-SHORT-NME (ASC-BLK-SUB ASC-ITEM-SUB) 47780003
477900                                 TO MR-VENDOR-NME (PV-SUB)        47790003
478010             MOVE ASC-FOB-POE-CDE (ASC-BLK-SUB ASC-ITEM-SUB)      47800003
478100                                 TO MR-FOB-POE-CDE (PV-SUB)       47810003
478200             MOVE ASC-TROUBLE-REASON-DESC                         47820003
478300                                        (ASC-BLK-SUB ASC-ITEM-SUB)47830003
478400                                 TO MR-TROUBLE-REASON (PV-SUB)    47840003
478500                                                                  47850003
478600             IF  ASC-TRBL-DTL-EXISTS (ASC-BLK-SUB ASC-ITEM-SUB)   47860003
478700                 MOVE DP015-YELLOW TO MR-TROUBLE-REASONC (PV-SUB) 47870003
478800             ELSE                                                 47880003
478900                 MOVE DP015-BLUE TO MR-TROUBLE-REASONC (PV-SUB)   47890003
479000             END-IF                                               47900003
479100                                                                  47910003
479200             MOVE ASC-ARRIVAL-DATE-TIME (ASC-BLK-SUB ASC-ITEM-SUB)47920003
479300                                 TO MR-ARRIVAL-DATE-TIME (PV-SUB) 47930003
479400             MOVE ASC-NOTIFICATION-DATE-TIME                      47940003
479500                                        (ASC-BLK-SUB ASC-ITEM-SUB)47950003
479600                            TO MR-NOTIFICATION-DATE-TIME (PV-SUB) 47960003
479700             MOVE ASC-RESPONSE-DATE-TIME                          47970003
479800                                        (ASC-BLK-SUB ASC-ITEM-SUB)47980003
479900                                 TO MR-RESPONSE-DATE-TIME (PV-SUB)47990003
480000                                                                  48000003
480100             IF  ASC-TRBL-RESOLVED (ASC-BLK-SUB ASC-ITEM-SUB)     48010003
480200                 MOVE DP015-YELLOW                                48020009
480300                           TO MR-RESPONSE-DATE-TIMEC(PV-SUB)      48030009
480310*                IF ASC-ALL-NOTIF-STATS AND                       48031009
480320*                    ASC-TRBL-RESOLVED (ASC-BLK-SUB ASC-ITEM-SUB) 48032009
480330*                    MOVE DP015-YELLOW                            48033009
480340*                          TO MR-DEPTC (PV-SUB)                   48034009
480350*                             MR-PO-NBRC (PV-SUB)                 48035009
480360*                             MR-RCVR-SEQ-NBRC (PV-SUB)           48036009
480370*                             MR-VENDOR-NMEC (PV-SUB)             48037009
480380*                             MR-SCAC-CDE (PV-SUB)                48038009
480390*                             MR-TROUBLE-REASONC (PV-SUB)         48039009
480391*                             MR-ARRIVAL-DATE-TIMEC (PV-SUB)      48039109
480392*                             MR-NOTIFICATION-DATE-TIMEC (PV-SUB) 48039209
480393*                             MR-RESPONSE-DATE-TIMEC (PV-SUB)     48039309
480405*                END-IF                                           48040509
480410             ELSE                                                 48041003
480500                 MOVE DP015-BLUE TO MR-RESPONSE-DATE-TIMEC(PV-SUB)48050003
480600             END-IF                                               48060003
480770         END-IF                                                   48077009
480800     END-IF.                                                      48080003
480900     SUBTRACT +1 FROM ASC-ITEM-SUB                                48090003
481000     IF  ASC-ITEM-SUB < + 1                                       48100003
481100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  48110003
481200         MOVE +1                 TO ASC-BLK-SUB                   48120003
481300     END-IF.                                                      48130003
481400                                                                  48140003
481500******************************************************************48150003
481600** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **48160003
481700** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **48170003
481800** ISSUE A WARNING.                                             **48180003
481900******************************************************************48190003
482000 4430-CHECK-FOR-BEGIN-AND-END.                                    48200003
482100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       48210003
482200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     48220003
482300*            -- NO END-OF-RANGE SPECFIED ---                      48230003
482400             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            48240003
482500             SET DP020-MSG-WARNING TO TRUE                        48250003
482600             PERFORM 4431-POSITION-AT-WARNING                     48260003
482700         END-IF                                                   48270003
482800     ELSE                                                         48280003
482900         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     48290003
483000*            -- NO BEGINNING-OF-RANGE SPECFIED ---                48300003
483100             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            48310003
483200             SET DP020-MSG-WARNING TO TRUE                        48320003
483300             PERFORM 4431-POSITION-AT-WARNING                     48330003
483400         END-IF                                                   48340003
483500     END-IF.                                                      48350003
483600                                                                  48360003
483700******************************************************************48370003
483800** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **48380003
483900** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **48390003
484000** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **48400003
484100** POSITION THE CURSOR THERE.                                   **48410003
484200******************************************************************48420003
484300 4431-POSITION-AT-WARNING.                                        48430003
484400     COMPUTE PV-SUB-COMP3 = ASC-START-OF-SELECTED-RANGE           48440003
484500                    - PV-TOP-ITEM + 1.                            48450003
484600     MOVE PV-SUB-COMP3 TO PV-SUB.                                 48460003
484700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      48470003
484800         CONTINUE                                                 48480003
484900     ELSE                                                         48490003
485000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      48500003
485100         MOVE -1                   TO MR-SELECTL (PV-SUB)         48510003
485200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         48520003
485300         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         48530003
485400     END-IF.                                                      48540003
485500                                                                  48550003
485600     COMPUTE PV-SUB-COMP3 = ASC-END-OF-SELECTED-RANGE             48560003
485700                    - PV-TOP-ITEM + 1.                            48570003
485800     MOVE PV-SUB-COMP3 TO PV-SUB.                                 48580003
485900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      48590003
486000         CONTINUE                                                 48600003
486100     ELSE                                                         48610003
486200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      48620003
486300         MOVE -1                   TO MR-SELECTL (PV-SUB)         48630003
486400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         48640003
486500         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         48650003
486600     END-IF.                                                      48660003
486700                                                                  48670003
486800*----------------------------------------------------------------*48680003
486900* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *48690003
487000* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *48700003
487100* FOR THE SELECTED ITEMS QUEUE.                                  *48710003
487200*                                                                *48720003
487300* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *48730003
487400* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *48740003
487500* THE ARRAY IS FULL.                                             *48750003
487600*----------------------------------------------------------------*48760003
487700 5000-PREPARE-SEL-QUEUE.                                          48770003
487800     MOVE +1                   TO  ASC-BLK-SUB.                   48780003
487900     PERFORM 5100-WRITE-TEMP-STORAGE.                             48790003
488000     ADD +1                    TO  ASC-BLK-SUB.                   48800003
488100     PERFORM 5100-WRITE-TEMP-STORAGE.                             48810003
488200                                                                  48820003
488300     MOVE ASC-SEL-QUEUE-OUT    TO  TM006-SEL-QUEUE-NAME.          48830014
488400     PERFORM 6010-DELETE-SEL-QUEUE.                               48840003
488500                                                                  48850003
488600     SET ASC-UPDATE-TSQ        TO  TRUE.                          48860003
488700                                                                  48870003
488800     SET TM002-IDX             TO  1.                             48880003
488900     MOVE ZERO                 TO TM006-NUMBER-OF-TS-ITEMS.       48890014
489000     INITIALIZE TM002-SELECTED-ITEM-ARRAY.                        48900003
489100                                                                  48910003
489200     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           48920003
489300             VARYING PV-ITEM                                      48930003
489400             FROM 1 BY 1                                          48940003
489500             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     48950003
489600                                                                  48960003
489700     IF  TM002-IDX > 1                                            48970003
489800         PERFORM 5205-WRITE-SEL-QUEUE                             48980003
489900         ADD +1                TO TM006-NUMBER-OF-TS-ITEMS        48990014
490000     END-IF.                                                      49000003
490100                                                                  49010003
494000*----------------------------------------------------------------*49400009
494100* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *49410009
494200* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *49420009
494300* FOR THE SELECTED ITEMS QUEUE.                                  *49430009
494400*                                                                *49440009
494500* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *49450009
494600* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *49460009
494700* THE ARRAY IS FULL.                                             *49470009
494800*----------------------------------------------------------------*49480009
494900 5025-PREPARE-SEL-QUEUE-FOR-PO.                                   49490009
495000     MOVE +1                   TO  ASC-BLK-SUB.                   49500009
495100     PERFORM 5100-WRITE-TEMP-STORAGE.                             49510009
495200     ADD +1                    TO  ASC-BLK-SUB.                   49520009
495300     PERFORM 5100-WRITE-TEMP-STORAGE.                             49530009
495400                                                                  49540009
495500     MOVE ASC-SEL-QUEUE-OUT    TO  PO013-SEL-QUEUE-NAME.          49550009
495600     PERFORM 6010-DELETE-SEL-QUEUE.                               49560009
495700                                                                  49570009
495800     SET ASC-UPDATE-TSQ        TO  TRUE.                          49580009
495900                                                                  49590009
496000     SET PO012-IDX             TO  1.                             49600009
496100     MOVE ZERO                 TO PO013-NUMBER-OF-TS-ITEMS.       49610009
496200     INITIALIZE PO012-SELECTED-ITEM-ARRAY.                        49620009
496300                                                                  49630009
496400     PERFORM 5250-FILL-SEL-QUEUE-REC-FOR-PO                       49640009
496500             VARYING PV-ITEM                                      49650009
496600             FROM 1 BY 1                                          49660009
496700             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     49670009
496800                                                                  49680009
496900     IF  PO012-IDX > 1 AND PS-NO-ERROR                            49690009
497000         PERFORM 5265-WRITE-PO-SEL-QUEUE                          49700009
497100         ADD +1                TO PO013-NUMBER-OF-TS-ITEMS        49710009
497200     END-IF.                                                      49720009
497300                                                                  49730003
497420*----------------------------------------------------------------*49740003
497500* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE TO BE PROCESSED  *49750003
497600* BY THE TROUBLE CENTRAL PROCESSING ROUTINE (TMKCS520).  MOVE    *49760003
497700* ALL SELECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE     *49770003
497800* LAYOUT FOR THE SELECTED ITEMS QUEUE.                           *49780003
497900*----------------------------------------------------------------*49790003
498000 5050-PREPARE-TO-PROCESS-TRBL.                                    49800003
498100     MOVE +1                   TO  ASC-BLK-SUB.                   49810003
498200     PERFORM 5100-WRITE-TEMP-STORAGE.                             49820003
498300     ADD +1                    TO  ASC-BLK-SUB.                   49830003
498400     PERFORM 5100-WRITE-TEMP-STORAGE.                             49840003
498500     PERFORM 5300-PROCESS-TROUBLE-UPDATE                          49850003
498600             VARYING PV-ITEM                                      49860003
498700             FROM 1 BY 1                                          49870003
498800             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN      49880003
498900             OR PS-ERROR.                                         49890003
499000                                                                  49900003
499100*----------------------------------------------------------------*49910003
499200*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *49920003
499300*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *49930003
499400*----------------------------------------------------------------*49940003
499500 5100-WRITE-TEMP-STORAGE.                                         49950003
499600     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     49960003
499700                                   TO PV-LIST-ITEM-NUMBER.        49970003
499800     COMPUTE PV-BLOCK-NUMBER =                                    49980003
499900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    49990003
500000                                                                  50000003
500100     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             50010003
500200     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             50020003
500300         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      50030003
500400             PERFORM 5105-REWRITE-ASC-LISTQ                       50040003
500500         END-IF                                                   50050003
500600     ELSE                                                         50060003
500700         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       50070003
500800         ASC-HIGHEST-BLOCK-WRITTEN + 1                            50080003
500900         PERFORM 5110-WRITE-ASC-LISTQ                             50090003
501000         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   50100003
501100     END-IF.                                                      50110003
501200                                                                  50120003
501300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             50130003
501400                                                                  50140003
501500******************************************************************50150003
501600** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **50160003
501700** SPECIFIC COMMAREA.                                           **50170003
501800******************************************************************50180003
501900 5105-REWRITE-ASC-LISTQ.                                          50190003
502000     EXEC CICS                                                    50200003
502100         WRITEQ TS                                                50210003
502200             QUEUE (ASC-LIST-QUEUE-NAME)                          50220003
502300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               50230003
502400             ITEM  (PV-BLOCK-NUMBER)                              50240003
502500             REWRITE                                              50250003
502600             RESP  (PV-CICS-RESP)                                 50260003
502700     END-EXEC.                                                    50270003
502800                                                                  50280003
502900     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           50290003
503000         CONTINUE                                                 50300003
503100     ELSE                                                         50310003
503200         SET DP013-CICS-ABEND            TO TRUE                  50320003
503300         SET DP013-NO-ROLLBACK           TO TRUE                  50330003
503400         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       50340003
503500         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     50350003
503600                                         TO DP013-MESSAGE-TEXT(1) 50360003
503700         PERFORM DP013-0000-PROCESS-ABEND                         50370003
503800     END-IF.                                                      50380003
503900                                                                  50390003
504000******************************************************************50400003
504100** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **50410003
504200** SPECIFIC COMMAREA.                                           **50420003
504300******************************************************************50430003
504400 5110-WRITE-ASC-LISTQ.                                            50440003
504500     EXEC CICS                                                    50450003
504600         WRITEQ TS                                                50460003
504700             QUEUE (ASC-LIST-QUEUE-NAME)                          50470003
504800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               50480003
504900             ITEM  (PV-BLOCK-NUMBER)                              50490003
505000             RESP  (PV-CICS-RESP)                                 50500003
505100     END-EXEC.                                                    50510003
505200     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      50520003
505300         SET DP013-CICS-ABEND      TO TRUE                        50530003
505400         SET DP013-NO-ROLLBACK     TO TRUE                        50540003
505500         MOVE '5110-WRITE-ASC-LISTQ' TO DP013-PARAGRAPH           50550009
505600         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           50560003
505700                                   TO DP013-MESSAGE-TEXT(1)       50570003
505800         PERFORM DP013-0000-PROCESS-ABEND                         50580003
505900     END-IF.                                                      50590003
506000                                                                  50600003
506100*----------------------------------------------------------------*50610003
506200* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *50620003
506300* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *50630003
506400*----------------------------------------------------------------*50640003
506500 5200-FILL-SEL-QUEUE-RECORD.                                      50650003
506600     PERFORM 6112-READ-LIST-QUEUE.                                50660003
506700     SET ASC-STAYING-WITHIN-TROUBLE TO TRUE                       50670003
506800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       50680003
506900         PERFORM                                                  50690003
507000         VARYING LQW-IDX                                          50700003
507100         FROM 1 BY 1                                              50710003
507200         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            50720003
507300           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          50730003
507400                                                                  50740003
507500             IF  LQW-SELECT (LQW-IDX)                             50750003
507600                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              50760003
507700                                 TO TM002-ITEM (TM002-IDX)        50770003
507800                 MOVE LQW-NOTIF-NBR (LQW-IDX)                     50780003
507900                                 TO TM002-NOTIF-NBR (TM002-IDX)   50790003
508000                 MOVE LQW-OPER-UNT-ID (LQW-IDX)                   50800003
508100                                 TO TM002-OPER-UNT-ID (TM002-IDX) 50810003
508200                 MOVE LQW-FCLTY-ID (LQW-IDX)                      50820003
508300                                 TO TM002-FCLTY-ID (TM002-IDX)    50830003
508400                 MOVE LQW-PO-NBR (LQW-IDX)                        50840003
508500                                 TO TM002-PO-NBR (TM002-IDX)      50850003
508600                 MOVE LQW-RCVR-SEQ-NBR (LQW-IDX)                  50860003
508700                                 TO TM002-RCVR-SEQ (TM002-IDX)    50870003
508800                 MOVE LQW-PO-LNE-NBR (LQW-IDX)                    50880003
508900                                 TO TM002-PO-LNE-NBR (TM002-IDX)  50890003
509000                 MOVE LQW-TROUBLE-REASON-CDE (LQW-IDX)            50900003
509100                                 TO TM002-TRBL-RSN-CDE (TM002-IDX)50910003
509200                 MOVE LQW-TROUBLE-REASON-LVL (LQW-IDX)            50920003
509300                                 TO TM002-TRBL-LVL-IND (TM002-IDX)50930003
509400                 MOVE SPACE        TO  TM002-ACTION-SW (TM002-IDX)50940003
509500                 SET TM002-IDX UP BY 1                            50950003
509600                 IF  TM002-IDX > TM002-MAX-ITEMS                  50960003
509700                     PERFORM 5205-WRITE-SEL-QUEUE                 50970003
509800                     ADD +1        TO TM006-NUMBER-OF-TS-ITEMS    50980014
509900                     INITIALIZE TM002-SELECTED-ITEM-ARRAY         50990003
510000                     SET TM002-IDX TO  1                          51000003
510100                 END-IF                                           51010003
510200             END-IF                                               51020003
510300         END-PERFORM                                              51030003
510400     END-IF.                                                      51040003
510500                                                                  51050003
510600*----------------------------------------------------------------*51060003
510700*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *51070003
510800*----------------------------------------------------------------*51080003
510900 5205-WRITE-SEL-QUEUE.                                            51090003
511000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO TM002-SELECTED-ITEMS.   51100003
511100                                                                  51110003
511200     EXEC CICS                                                    51120003
511300          WRITEQ TS                                               51130003
511400              QUEUE (ASC-SEL-QUEUE-OUT)                           51140003
511500              FROM  (TM002-MESSAGE-SEL-REC)                       51150003
511600              ITEM  (ASC-SEL-ITEM)                                51160003
511700              RESP  (PV-CICS-RESP)                                51170003
511800     END-EXEC.                                                    51180003
511900                                                                  51190003
512000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          51200003
512100         CONTINUE                                                 51210003
512200     ELSE                                                         51220003
512300         SET DP013-CICS-ABEND                                     51230009
512400             DP013-NO-ROLLBACK     TO TRUE                        51240009
512500         MOVE '5205-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           51250003
512600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          51260003
512700                                   TO DP013-MESSAGE-TEXT(1)       51270003
512800         PERFORM DP013-0000-PROCESS-ABEND                         51280003
512900     END-IF.                                                      51290003
513000                                                                  51300003
520400*----------------------------------------------------------------*52040009
520500* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *52050009
520600* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *52060009
520700*----------------------------------------------------------------*52070009
520800 5250-FILL-SEL-QUEUE-REC-FOR-PO.                                  52080009
520900     PERFORM 6112-READ-LIST-QUEUE.                                52090009
521000                                                                  52100009
521100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       52110009
521200         PERFORM                                                  52120009
521300         VARYING LQW-IDX                                          52130009
521400         FROM 1 BY 1                                              52140009
521500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            52150009
521600           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          52160009
521700           OR  PS-ERROR                                           52170009
521800             IF  PS-FIRST-TIME                                    52180009
521900                 SET PS-NOT-FIRST-TIME TO TRUE                    52190009
522000                 MOVE LQW-PO-NBR (LQW-IDX) TO PV-PREV-PO-NBR      52200009
522100                 MOVE LQW-DEPT   (LQW-IDX) TO PV-PREV-DEPT-NBR    52210009
522200             END-IF                                               52220009
522300                                                                  52230009
522400             IF  LQW-SELECT (LQW-IDX)                             52240009
522500                 SET ASC-GOING-TO-PO   TO TRUE                    52250009
522600                 PERFORM 5255-FETCH-TPURCHS-INFO                  52260009
522700                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              52270009
522800                                   TO  PO012-ITEM(PO012-IDX)      52280009
522900                 MOVE PURCHS-DEPT-NBR                             52290009
523000                                   TO  PO013-DEPT-NBR             52300009
523100                 MOVE PURCHS-STATUS-CDE                           52310009
523200                                   TO  PO012-STATUS (PO012-IDX)   52320009
523300                 MOVE PURCHS-PO-TYP-CDE                           52330009
523400                                   TO  PO012-PO-TYPE (PO012-IDX)  52340009
523500                 PERFORM 5260-FETCH-VENDOR-LONG-NAME              52350009
523600                 IF  SQLCODE = +100                               52360009
523700                     MOVE SPACES TO PO012-VENDOR-NAME (PO012-IDX) 52370009
523800                 ELSE                                             52380009
523900                     MOVE ENTNME-ENT-NAME-DESC                    52390009
524000                                   TO  PO012-VENDOR-NAME          52400009
524100                                                    (PO012-IDX)   52410009
524200                 END-IF                                           52420009
524300                 MOVE LQW-ENT-ID (LQW-IDX) TO PO013-ENT-ID        52430009
524400                 MOVE LQW-PO-NBR (LQW-IDX)                        52440009
524500                                   TO  PO012-PO-NBR (PO012-IDX)   52450009
524600                                       PO013-PO-NBR               52460009
524700                 MOVE LQW-PO-LNE-NBR (LQW-IDX)                    52470009
524800                               TO  PO012-PO-LNE-NBR (PO012-IDX)   52480009
524900                 MOVE SPACE        TO  PO012-ACTION-SW (PO012-IDX)52490009
525000                 SET PO012-IDX UP BY 1                            52500009
525100                 IF  PO012-IDX > PO012-MAX-ITEMS                  52510009
525200                     PERFORM 5265-WRITE-PO-SEL-QUEUE              52520009
525300                     ADD +1        TO PO013-NUMBER-OF-TS-ITEMS    52530009
525400                     INITIALIZE PO012-SELECTED-ITEM-ARRAY         52540009
525500                     SET PO012-IDX TO  1                          52550009
525600                 END-IF                                           52560009
525700             END-IF                                               52570009
525800         END-PERFORM                                              52580009
525900     END-IF.                                                      52590009
526000                                                                  52600009
526100*----------------------------------------------------------------*52610003
526200*    RETRIEVE THE PURCHASE ORDER HEADER INFORMATION FOR THE      *52620003
526300*    PO ASSOCIATED WITH THE TROUBLE NOTIFICATION RECORD.         *52630003
526400*----------------------------------------------------------------*52640003
526500 5255-FETCH-TPURCHS-INFO.                                         52650003
526600     MOVE LQW-PO-NBR (LQW-IDX)  TO TRBNTF-PO-NBR.                 52660003
526700                                                                  52670003
526800     PERFORM                                                      52680003
526900         WITH TEST AFTER                                          52690003
527000         VARYING PV-RETRY-COUNTER                                 52700003
527100         FROM 1 BY 1                                              52710003
527200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               52720003
527300                   OR (SQLCODE = ZERO OR +100))                   52730003
527400                                                                  52740003
527500         EXEC SQL                                                 52750003
527600              SELECT PO_TYP_CDE                                   52760003
527700                     ,DIR_STR_IND                                 52770003
527800                     ,STATUS_CDE                                  52780003
527900                     ,DEPT_NBR                                    52790003
528000                INTO :PURCHS-PO-TYP-CDE                           52800003
528100                     ,:PURCHS-DIR-STR-IND                         52810003
528200                     ,:PURCHS-STATUS-CDE                          52820003
528300                     ,:PURCHS-DEPT-NBR                            52830003
528400                FROM TPURCHS                                      52840003
528500               WHERE PO_NBR       = :TRBNTF-PO-NBR                52850003
528600                 AND VER_STATUS_CDE = :PC-ACTIVE-STATUS           52860003
528700         END-EXEC                                                 52870003
528800                                                                  52880003
528900         EVALUATE TRUE                                            52890003
529000             WHEN SQLCODE = ZERO                                  52900003
529100             WHEN SQLCODE = -904                                  52910003
529200             WHEN SQLCODE = -913                                  52920003
529300                  CONTINUE                                        52930003
529400             WHEN SQLCODE = +100                                  52940003
529500                  MOVE SPACES  TO PURCHS-PO-TYP-CDE               52950003
529600                                  PURCHS-DIR-STR-IND              52960009
529700                                  PURCHS-STATUS-CDE               52970009
529800                                  PURCHS-DEPT-NBR                 52980009
529900             WHEN SQLWARN0 NOT = SPACE                            52990003
530000             WHEN SQLCODE NOT = ZERO                              53000003
530100                  MOVE '5255-FETCH-TPURCHS-INFO'                  53010003
530200                                   TO DP013-PARAGRAPH             53020003
530300                  MOVE 'FETCH PURCHASE ORDER INFORMATION'         53030003
530400                                   TO DP013-MESSAGE-TEXT (1)      53040003
530500                  MOVE 'FOR THE FOLLOWING PO:           '         53050003
530600                                   TO DP013-MESSAGE-TEXT (2)      53060003
530700                  MOVE TRBNTF-PO-NBR TO DP013-MESSAGE-TEXT (3)    53070003
530800                  MOVE SQLCA   TO DP013-SQLCA                     53080003
530900                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)     53090003
531000                  SET DP013-DB2-ABEND TO TRUE                     53100003
531100                  PERFORM DP013-0000-PROCESS-ABEND                53110003
531200         END-EVALUATE                                             53120003
531300     END-PERFORM.                                                 53130003
531400                                                                  53140003
531500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        53150003
531600         MOVE '5255-FETCH-TPURCHS-INFO' TO DP013-PARAGRAPH        53160003
531700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     53170003
531800                                   TO DP013-MESSAGE-TEXT (1)      53180003
531900         MOVE SQLCA                TO DP013-SQLCA                 53190003
532000         MOVE 'TPURCHS '           TO DP013-DB2-TABLE-NAME (1)    53200003
532100         SET DP013-DB2-ABEND                                      53210003
532200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   53220003
532300         PERFORM DP013-0000-PROCESS-ABEND                         53230003
532400     END-IF.                                                      53240003
532500                                                                  53250003
532600*----------------------------------------------------------------*53260003
532700*    RETRIEVE THE FULL VENDOR NAME THAT IS ASSOCIATED WITH THE   *53270003
532800*    TROUBLE NOTIFICATION RECORD.  THIS INFORMATION WILL BE USED *53280003
532900*    WHEN PERFORMING EITHER A PO INQUIRY LOOKUP OR PO UPDATE FOR *53290003
533000*    THIS SPECIFIC TROUBLE NOTIFICATION RECORD.                  *53300003
533100*----------------------------------------------------------------*53310003
533200 5260-FETCH-VENDOR-LONG-NAME.                                     53320003
533300     MOVE LQW-ENT-ID(LQW-IDX)   TO DK-ENT-ID                      53330003
533400                                                                  53340003
533500     PERFORM                                                      53350003
533600         WITH TEST AFTER                                          53360003
533700         VARYING PV-RETRY-COUNTER                                 53370003
533800         FROM 1 BY 1                                              53380003
533900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               53390003
534000                   OR (SQLCODE = ZERO OR +100))                   53400003
534100                                                                  53410009
534200         EXEC SQL                                                 53420003
534300              SELECT ENT_NAME_DESC                                53430003
534400                INTO :ENTNME-ENT-NAME-DESC                        53440003
534500                FROM TENTNME                                      53450003
534600               WHERE ENT_ID       = :DK-ENT-ID                    53460003
534700                 AND TYPE_CDE     = :PC-TYPE-CODE-LONG-NAME       53470003
534800         END-EXEC                                                 53480003
534900                                                                  53490003
535000         EVALUATE TRUE                                            53500003
535100             WHEN SQLCODE = ZERO                                  53510003
535200             WHEN SQLCODE = +100                                  53520003
535300             WHEN SQLCODE = -904                                  53530003
535400             WHEN SQLCODE = -913                                  53540003
535500                  CONTINUE                                        53550003
535600             WHEN SQLWARN0 NOT = SPACE                            53560003
535700             WHEN SQLCODE NOT = ZERO                              53570003
535800                  MOVE '5260-FETCH-VENDOR-LONG-NAME'              53580003
535900                                   TO DP013-PARAGRAPH             53590003
536000                  MOVE 'FETCH VENDOR LONG NAME          '         53600003
536100                                   TO DP013-MESSAGE-TEXT (1)      53610003
536200                  MOVE 'FOR THE FOLLOWING PO:           '         53620003
536300                                   TO DP013-MESSAGE-TEXT (2)      53630003
536400                  MOVE TRBNTF-PO-NBR TO DP013-MESSAGE-TEXT (3)    53640009
536500                  MOVE SQLCA      TO DP013-SQLCA                  53650009
536600                  MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (1)     53660003
536700                  SET DP013-DB2-ABEND TO TRUE                     53670003
536800                  PERFORM DP013-0000-PROCESS-ABEND                53680003
536900         END-EVALUATE                                             53690003
537000     END-PERFORM.                                                 53700003
537100                                                                  53710003
537200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        53720003
537300         MOVE '5260-FETCH-VENDOR-LONG-NAME' TO DP013-PARAGRAPH    53730003
537400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     53740003
537500                                   TO DP013-MESSAGE-TEXT (1)      53750003
537600         MOVE SQLCA                TO DP013-SQLCA                 53760003
537700         MOVE 'TENTNME '           TO DP013-DB2-TABLE-NAME (1)    53770003
537800         SET DP013-DB2-ABEND                                      53780003
537900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   53790003
538000         PERFORM DP013-0000-PROCESS-ABEND                         53800003
538100     END-IF.                                                      53810003
538200                                                                  53820003
538300*----------------------------------------------------------------*53830003
538400*    WRITE THE SELECTED PO ITEMS TEMP STORAGE QUEUE.             *53840003
538500*----------------------------------------------------------------*53850003
538600 5265-WRITE-PO-SEL-QUEUE.                                         53860003
538700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO PO012-SELECTED-ITEMS.   53870003
538800                                                                  53880003
538900     EXEC CICS                                                    53890003
539000          WRITEQ TS                                               53900003
539100              QUEUE (ASC-SEL-QUEUE-OUT)                           53910003
539200              FROM  (PO012-PO-SELECT-RECORD)                      53920003
539300              ITEM  (ASC-SEL-ITEM)                                53930003
539400              RESP  (PV-CICS-RESP)                                53940003
539500     END-EXEC.                                                    53950003
539600                                                                  53960003
539700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          53970003
539800         CONTINUE                                                 53980003
539900     ELSE                                                         53990003
540000         SET DP013-CICS-ABEND                                     54000009
540100             DP013-NO-ROLLBACK     TO TRUE                        54010009
540200         MOVE '5265-WRITE-SEL-QUEUE'  TO DP013-PARAGRAPH          54020003
540300         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          54030003
540400                                   TO DP013-MESSAGE-TEXT(1)       54040003
540500         PERFORM DP013-0000-PROCESS-ABEND                         54050003
540600     END-IF.                                                      54060003
540700                                                                  54070003
540800*----------------------------------------------------------------*54080003
540900*    CALL THE TROUBLE CENTRAL PROCESSING ROUTINE (TMKCS520) TO   *54090003
541000*    PERFORM EITHER A RESPOND, RESOLVE, OR ACKNOWLEDGE FOR THE   *54100003
541100*    SELECTED NOTIFICATION RECORDS.  THIS PARAGRAPH IS PERFORMED *54110003
541200*    UNTIL ALL NOTIFICATION RECORDS ARE PROCESSED OR AN ERROR    *54120003
541300*    IS ENCOUNTERED.                                             *54130003
541400*----------------------------------------------------------------*54140003
541500 5300-PROCESS-TROUBLE-UPDATE.                                     54150003
541600     PERFORM 6112-READ-LIST-QUEUE.                                54160003
541700                                                                  54170003
541800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       54180003
541900         PERFORM                                                  54190003
542000         VARYING LQW-IDX                                          54200003
542100         FROM 1 BY 1                                              54210003
542200         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            54220003
542300           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          54230003
542400           OR  PS-ERROR                                           54240003
542500             IF  LQW-SELECT (LQW-IDX)                             54250003
542600                 MOVE LQW-NOTIF-NBR (LQW-IDX)                     54260009
542700                                TO  TM500-NOTIF-NBR               54270009
542710                 MOVE LQW-OPER-UNT-ID (LQW-IDX)                   54271009
542720                                TO  TM500-OPER-UNT-ID             54272009
542800                 MOVE LQW-FCLTY-ID (LQW-IDX) TO TM500-FCLTY-ID    54280003
542900                 MOVE LQW-PO-NBR (LQW-IDX) TO TM500-PO-NBR        54290003
543000                                              DK-PO-NBR           54300003
543100                 MOVE LQW-RCVR-SEQ-NBR (LQW-IDX)                  54310003
543200                                TO  TM500-REC-SEQ-NBR             54320003
543300                                    DK-REC-SEQ-NBR                54330003
543400                 MOVE LQW-TROUBLE-REASON-CDE (LQW-IDX)            54340003
543500                                TO  TM500-TRBL-RSN-CDE            54350003
543600                 MOVE LQW-TROUBLE-REASON-LVL (LQW-IDX)            54360003
543700                                TO  TM500-LEVEL-IND               54370003
543800                 MOVE PC-DUMMY-DATE TO TM500-VEND-SHIP-DTE        54380003
543900                                                                  54390003
544000                 IF  TM500-REC-SEQ-NBR = 0                        54400003
544100                     CONTINUE                                     54410003
544200                 ELSE                                             54420003
544300                     PERFORM 5350-FETCH-VEND-SHIP-DTE             54430003
544400                     MOVE SHIPMT-VEND-SHIP-DTE                    54440003
544500                                TO  TM500-VEND-SHIP-DTE           54450003
544600                 END-IF                                           54460003
544700                                                                  54470003
544800                 IF  PS-RESOLVE-REQUEST                           54480003
544900                     PERFORM 5301-RESOLVE-SETUP-EDITS             54490003
545000                 ELSE                                             54500003
545100                     IF  TM500-PO-LEVEL                           54510003
545200                         CONTINUE                                 54520003
545300                     ELSE                                         54530003
545400                         SET TM500-LINE-LEVEL TO TRUE             54540003
545500                     END-IF                                       54550003
545600                 END-IF                                           54560003
545700                                                                  54570003
545800                 IF  PS-NO-ERROR                                  54580003
545900                     PERFORM 5400-PROCESS-TRBL-REQUEST            54590003
546000                 END-IF                                           54600003
546100                                                                  54610003
546200                 IF  PS-NO-ERROR                                  54620003
546300                     IF  TM500-DUPLICATE-TROUBLE                  54630003
546400                         SET LQW-DESELECT (LQW-IDX)               54640003
546500                             LQW-INQUIRE  (LQW-IDX) TO TRUE       54650003
546600                         MOVE PC-TSYMSG-01034 TO DP020-MSG-NUMBER 54660003
546700                         MOVE SPACE                               54670003
546800                                TO  LQW-TEMP-SELECTED-SW (LQW-IDX)54680003
546900                         SUBTRACT 1                               54690003
547000                                FROM ASC-NUMBER-OF-SELECTED-ITEMS 54700003
547100                     ELSE                                         54710003
547200                         SET LQW-DESELECT (LQW-IDX)               54720003
547300                             LQW-UPDATE   (LQW-IDX) TO TRUE       54730003
547400                         MOVE SPACE                               54740003
547500                                TO  LQW-TEMP-SELECTED-SW (LQW-IDX)54750003
547600                         SUBTRACT 1                               54760003
547700                                FROM ASC-NUMBER-OF-SELECTED-ITEMS 54770003
547800                     END-IF                                       54780003
547900                 ELSE                                             54790003
548000                     SET LQW-ERROR (LQW-IDX) TO TRUE              54800003
548100                     EXEC CICS                                    54810003
548200                         SYNCPOINT ROLLBACK                       54820003
548300                     END-EXEC                                     54830003
548400                 END-IF                                           54840003
548500             END-IF                                               54850003
548600         END-PERFORM                                              54860003
548700     END-IF.                                                      54870003
548800                                                                  54880003
548900     MOVE PV-ITEM                TO  PV-SAVE-ITEM.                54890003
549000     PERFORM 6111-WRITE-LIST-QUEUE.                               54900003
549100                                                                  54910003
549200 5301-RESOLVE-SETUP-EDITS.                                        54920003
549300     IF (LQW-TRBL-RESOLVED (LQW-IDX))                             54930003
549400         OR  (PS-DC-CHEK-REQUEST AND LQW-TRBL-RESOLVED (LQW-IDX)) 54940009
549500         MOVE PC-TSYMSG-00938   TO DP020-MSG-NUMBER               54950003
549600         SET PS-ERROR           TO  TRUE                          54960003
549700     END-IF                                                       54970003
549800                                                                  54980003
549900     IF PS-NO-ERROR                                               54990003
550000     EVALUATE TRUE                                                55000003
550100         WHEN (LQW-RESOLVE-TRBL-AUTO (LQW-IDX)) OR                55010003
550200              (LQW-RESOLVE-TRBL-BOTH-AUTO-MAN (LQW-IDX))          55020003
550300              CONTINUE                                            55030003
550400         WHEN LQW-RESOLVE-TRBL-MANUAL (LQW-IDX)                   55040003
550500             MOVE PC-TSYMSG-01031 TO DP020-MSG-NUMBER             55050003
550600             SET PS-ERROR         TO  TRUE                        55060009
550700         WHEN OTHER                                               55070003
550800             MOVE PC-TSYMSG-01025 TO DP020-MSG-NUMBER             55080003
550900             SET PS-ERROR         TO  TRUE                        55090009
551000     END-EVALUATE                                                 55100003
551100     END-IF.                                                      55110003
551200                                                                  55120003
551300     IF PS-NO-ERROR                                               55130003
551400     IF  TM500-PO-LEVEL OR TM500-LINE-LEVEL                       55140003
551500         CONTINUE                                                 55150003
551600     ELSE                                                         55160003
551700         MOVE PC-TSYMSG-00986 TO DP020-MSG-NUMBER                 55170003
551800         SET PS-ERROR       TO  TRUE                              55180003
551900     END-IF.                                                      55190003
552000                                                                  55200003
552100*----------------------------------------------------------------*55210003
552200*    RETRIEVE THE VENDOR SHIP DATE ASSOCIATED WITH THE TROUBLE   *55220003
552300*    NOTIFICATION RECORD.                                        *55230003
552400*----------------------------------------------------------------*55240003
552500 5350-FETCH-VEND-SHIP-DTE.                                        55250003
552600     INITIALIZE DCLTSHIPMT.                                       55260003
552700                                                                  55270003
552800     PERFORM                                                      55280003
552900         WITH TEST AFTER                                          55290003
553000         VARYING PV-RETRY-COUNTER                                 55300003
553100         FROM 1 BY 1                                              55310003
553200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               55320003
553300                   OR (SQLCODE = ZERO OR +100))                   55330003
553400                                                                  55340003
553500         EXEC SQL                                                 55350003
553600              SELECT VEND_SHIP_DTE                                55360003
553700                INTO :SHIPMT-VEND-SHIP-DTE                        55370003
553800                FROM TSHPTPO A                                    55380003
553900                    , TSHIPMT B                                   55390003
554000               WHERE A.PO_NBR         = :DK-PO-NBR                55400003
554100                 AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR           55410003
554200                 AND A.SHIPT_ID       = B.SHIPT_ID                55420003
554300                 AND A.PRIM_SHIPT_IND = :PC-Y                     55430003
554400         END-EXEC                                                 55440003
554500                                                                  55450009
554600         EVALUATE TRUE                                            55460003
554700             WHEN SQLCODE = ZERO                                  55470003
554800             WHEN SQLCODE = -904                                  55480003
554900             WHEN SQLCODE = -913                                  55490003
555000                  CONTINUE                                        55500003
555100             WHEN SQLCODE = +100                                  55510003
555200                  MOVE PC-DUMMY-DATE TO SHIPMT-VEND-SHIP-DTE      55520003
555300             WHEN SQLWARN0 NOT = SPACE                            55530003
555400             WHEN SQLCODE NOT = ZERO                              55540003
555500                  MOVE '5350-FETCH-VEND-SHIP-DTE'                 55550003
555600                                   TO DP013-PARAGRAPH             55560003
555700                  MOVE 'FETCH VENDOR SHIP DATE'                   55570003
555800                                   TO DP013-MESSAGE-TEXT (1)      55580003
555900                  MOVE 'FOR THE FOLLOWING PO:  '                  55590018
556000                                   TO DP013-MESSAGE-TEXT (2)      55600003
556100                  MOVE DK-PO-NBR   TO DP013-MESSAGE-TEXT (3)      55610026
556700                  MOVE SQLCA   TO DP013-SQLCA                     55670003
556800                  MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (1)     55680009
556900                  MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (2)     55690003
557000                  SET DP013-DB2-ABEND TO TRUE                     55700003
557100                  PERFORM DP013-0000-PROCESS-ABEND                55710003
557200         END-EVALUATE                                             55720003
557300     END-PERFORM.                                                 55730003
557400                                                                  55740003
557500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        55750003
557600         MOVE '5350-FETCH-VEND-SHIP-DTE' TO DP013-PARAGRAPH       55760003
557700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     55770003
557800                                   TO DP013-MESSAGE-TEXT (1)      55780003
557900         MOVE SQLCA                TO DP013-SQLCA                 55790003
558000              MOVE 'TSHPTPO '  TO DP013-DB2-TABLE-NAME (1)        55800003
558100              MOVE 'TSHIPMT '  TO DP013-DB2-TABLE-NAME (2)        55810003
558200         SET DP013-DB2-ABEND                                      55820003
558300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   55830003
558400         PERFORM DP013-0000-PROCESS-ABEND                         55840003
558500     END-IF.                                                      55850003
558600                                                                  55860003
558700******************************************************************55870003
558800** CALL THE TROUBLE ROUTINE TO PROCESS THE TROUBLE NOTIFICATION **55880003
558900** RECORD.                                                      **55890003
559000******************************************************************55900003
559100 5400-PROCESS-TRBL-REQUEST.                                       55910003
559200     MOVE LENGTH OF TM500-FIELDS      TO PV-COMMAREA-LENGTH       55920003
559300     SET TM500-FROM-LIST-SCREEN       TO TRUE.                    55930003
559400                                                                  55940003
559500     EXEC CICS                                                    55950003
559600          LINK PROGRAM  (PC-TMKCS520)                             55960003
559700               COMMAREA (TM500-FIELDS)                            55970003
559800               LENGTH   (PV-COMMAREA-LENGTH)                      55980003
559900               RESP     (PV-CICS-RESP)                            55990003
560000     END-EXEC.                                                    56000003
560100                                                                  56010003
560200     EVALUATE TRUE                                                56020003
560300         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     56030003
560400              CONTINUE                                            56040003
560500         WHEN OTHER                                               56050003
560600              MOVE '5400-PROCESS-TRBL-REQUEST' TO DP013-PARAGRAPH 56060003
560700                                                                  56070003
560800              MOVE 'CANNOT LINK TO TMKCS520'                      56080003
560900                                         TO DP013-MESSAGE-TEXT (1)56090003
561000              SET DP013-CICS-ABEND       TO TRUE                  56100003
561100              SET DP013-NO-ROLLBACK      TO TRUE                  56110003
561200              SET PS-ERROR               TO TRUE                  56120003
561300              PERFORM DP013-0000-PROCESS-ABEND                    56130003
561400     END-EVALUATE.                                                56140003
561500                                                                  56150003
561600     EVALUATE TRUE                                                56160003
561700         WHEN TM500-CALL-SUCCESSFUL                               56170003
561800         WHEN TM500-DUPLICATE-TROUBLE                             56180003
561900         WHEN TM500-TTRBNTF-UPDATE-NOT-FND                        56190003
562000         WHEN TM500-TPURCHS-SELECT-NOT-FND                        56200003
562100         WHEN TM500-DIDNT-ALLOC-DUE-TO-TRBL                       56210003
562200              CONTINUE                                            56220003
562300         WHEN TM500-RECORD-IN-PROCESS                             56230003
562400              MOVE PC-TSYMSG-01032 TO DP020-MSG-NUMBER            56240003
562500              SET PS-ERROR      TO  TRUE                          56250003
562600         WHEN TM500-RECORD-RESOLVED                               56260003
562700              MOVE PC-TSYMSG-01033 TO DP020-MSG-NUMBER            56270003
562800              SET PS-ERROR      TO  TRUE                          56280003
562900         WHEN TM500-RECORD-ACKNOWLEDGED                           56290003
563000************* MOVE PC-TSYMSG-01036 TO DP020-MSG-NUMBER            56300009
563010              MOVE PC-TSYMSG-01839 TO DP020-MSG-NUMBER            56301009
563100              SET PS-ERROR      TO  TRUE                          56310003
563200         WHEN TM500-RECORD-NOT-RESOLVED                           56320003
563300              MOVE PC-TSYMSG-01037 TO DP020-MSG-NUMBER            56330003
563400              SET PS-ERROR      TO  TRUE                          56340003
563500         WHEN TM500-IN-PROC-UPDATE-NOT-FND                        56350003
563600              MOVE PC-TSYMSG-00938 TO DP020-MSG-NUMBER            56360003
563700              SET PS-ERROR      TO  TRUE                          56370003
563800         WHEN TM500-RESPOND-UPDATE-NOT-FND                        56380003
563900              MOVE PC-TSYMSG-01038 TO DP020-MSG-NUMBER            56390003
564000              SET PS-ERROR      TO  TRUE                          56400003
564100         WHEN TM500-ACKNWLG-UPDATE-NOT-FND                        56410003
564200              MOVE PC-TSYMSG-01038 TO DP020-MSG-NUMBER            56420003
564300              SET PS-ERROR      TO  TRUE                          56430003
564400         WHEN OTHER                                               56440003
564500              STRING 'NNNNN-E-'             DELIMITED BY SIZE     56450003
564600                     TM500-RETURN-MSG       DELIMITED BY SIZE     56460003
564700                     '-'                    DELIMITED BY SIZE     56470003
564800                     TM500-RETURN-CODE      DELIMITED BY SIZE     56480003
564900                     ' SQLCODE='            DELIMITED BY SIZE     56490003
565000                     TM500-SQLCODE          DELIMITED BY SIZE     56500003
565100                              INTO  DP020-MSG-MESSAGE             56510003
565200              SET PS-ERROR      TO  TRUE                          56520003
565300     END-EVALUATE.                                                56530003
565400                                                                  56540003
565500******************************************************************56550003
565600** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **56560003
565700** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **56570003
565800** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **56580003
565900** THE USER.                                                    **56590003
566000******************************************************************56600003
566100 6000-REFRESH-PANEL-FROM-TEMP.                                    56610003
566200     IF  ASC-UPDATE-TSQ                                           56620003
566300         SET ASC-NO-TSQ-UPDATE TO TRUE                            56630003
566400         MOVE ZERO                 TO PV-SAVE-ITEM                56640003
566500                                      ASC-SEL-ITEM                56650003
566600         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        56660003
566700                                   TO PV-HOLD-SELECTED-ITEMS      56670003
566800         MOVE +1                   TO PV-ITEMS-PROCESSED          56680003
567300         PERFORM 6100-UPDATE-TSQ                                  56730025
567400             UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS    56740025
567600         PERFORM 6010-DELETE-SEL-QUEUE                            56760003
567700         INITIALIZE ASC-BLOCK-ENTRIES (1)                         56770003
567800                    ASC-BLOCK-ENTRIES (2)                         56780003
567900                                                                  56790003
568000         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 56800003
568100                GIVING PV-BLOCK-NUMBER                            56810003
568200                REMAINDER PV-REMAINDER                            56820003
568300                                                                  56830003
568400         IF  PV-REMAINDER > ZERO                                  56840003
568500             ADD +1                TO PV-BLOCK-NUMBER             56850003
568600         END-IF                                                   56860003
568700                                                                  56870003
568800         MOVE +1                   TO ASC-BLK-SUB                 56880003
568900         PERFORM 4410-READ-TEMP-STORAGE                           56890003
569000         ADD +1                    TO ASC-BLK-SUB                 56900003
569100                                      PV-BLOCK-NUMBER             56910003
569200         PERFORM 4410-READ-TEMP-STORAGE                           56920003
569300     END-IF.                                                      56930003
569400                                                                  56940003
569500*----------------------------------------------------------------*56950003
569600*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *56960003
569700*----------------------------------------------------------------*56970003
569800 6010-DELETE-SEL-QUEUE.                                           56980003
569900     EXEC CICS                                                    56990003
570000         DELETEQ TS                                               57000003
570100             QUEUE (ASC-SEL-QUEUE-OUT)                            57010003
570200             RESP  (PV-CICS-RESP)                                 57020003
570300     END-EXEC.                                                    57030003
570400                                                                  57040003
570500     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      57050003
570600        (PV-CICS-RESP = DFHRESP(QIDERR)))                         57060003
570700         CONTINUE                                                 57070003
570800     ELSE                                                         57080003
570900         SET DP013-CICS-ABEND TO TRUE                             57090003
571000         SET DP013-NO-ROLLBACK TO TRUE                            57100003
571100         MOVE '6010-DELETE-SEL-QUEUE' TO DP013-PARAGRAPH          57110003
571200         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         57120003
571300                        TO DP013-MESSAGE-TEXT (1)                 57130003
571400         PERFORM DP013-0000-PROCESS-ABEND                         57140003
571500     END-IF.                                                      57150003
571600                                                                  57160003
571700*----------------------------------------------------------------*57170003
571800*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *57180003
571900*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *57190003
572000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *57200003
572100*    THE TEMP QUEUE.                                             *57210003
572200*----------------------------------------------------------------*57220003
572300 6100-UPDATE-TSQ.                                                 57230003
572400     ADD 1                     TO  ASC-SEL-ITEM.                  57240003
572500     PERFORM 6105-READ-SEL-QUEUE.                                 57250003
572600     PERFORM                                                      57260003
572700         VARYING TM002-IDX                                        57270003
572800         FROM 1 BY 1                                              57280003
572900         UNTIL ((PV-ITEMS-PROCESSED >                             57290003
573000                              PV-HOLD-SELECTED-ITEMS)             57300003
573100         OR (TM002-IDX GREATER THAN TM002-MAX-ITEMS))             57310003
573200         IF  TM002-ACTION-SW (TM002-IDX) > SPACE                  57320003
573300             PERFORM 6110-PROCESS-ITEMS                           57330003
573400         END-IF                                                   57340003
573500         ADD +1                TO PV-ITEMS-PROCESSED              57350003
573600     END-PERFORM.                                                 57360003
573700     PERFORM 6111-WRITE-LIST-QUEUE.                               57370003
573800                                                                  57380003
573900*----------------------------------------------------------------*57390009
574000*    6100-UPDATE-TSQ-R USED BY RCVRMNT FUNCTION                  *57400009
574100*                                                                *57410009
574200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *57420009
574300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *57430009
574400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *57440009
574500*    THE TEMP QUEUE.                                             *57450009
574600*----------------------------------------------------------------*57460009
574700 6100-UPDATE-TSQ-R.                                               57470009
574800     ADD 1                    TO PV-SEL-QUEUE-ITEM.               57480009
574900     PERFORM 6105-READ-SEL-QUEUE-R.                               57490009
575000                                                                  57500009
575100     PERFORM                                                      57510009
575200         VARYING RC013-IDX                                        57520009
575300         FROM 1 BY 1                                              57530009
575400         UNTIL ((PV-ITEMS-PROCESSED >                             57540009
575500                              PV-HOLD-SELECTED-ITEMS)             57550009
575600         OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))             57560009
575700         IF  RC013-ACTION-SW (RC013-IDX) > SPACE                  57570009
575800             PERFORM 6110-PROCESS-ITEMS-R                         57580009
575900         END-IF                                                   57590009
576000         ADD +1               TO PV-ITEMS-PROCESSED               57600009
576100     END-PERFORM.                                                 57610009
576200                                                                  57620009
576300     PERFORM 6111-WRITE-LIST-QUEUE.                               57630009
576400                                                                  57640009
576500*----------------------------------------------------------------*57650003
576600*    READ THE LIST QUEUE RECORD.                                 *57660003
576700*----------------------------------------------------------------*57670003
576800 6105-READ-SEL-QUEUE.                                             57680003
576900     EXEC CICS                                                    57690003
577000          READQ TS                                                57700003
577100              QUEUE (ASC-SEL-QUEUE-OUT)                           57710003
577200              INTO  (TM002-MESSAGE-SEL-REC)                       57720003
577300              ITEM  (ASC-SEL-ITEM)                                57730003
577400              RESP  (PV-CICS-RESP)                                57740003
577500     END-EXEC.                                                    57750003
577600                                                                  57760003
577700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          57770003
577800         CONTINUE                                                 57780003
577900     ELSE                                                         57790003
578000         SET DP013-CICS-ABEND      TO  TRUE                       57800003
578100         SET DP013-NO-ROLLBACK     TO  TRUE                       57810003
578200         MOVE '6105-READ-SEL-QUEUE' TO DP013-PARAGRAPH            57820003
578300         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           57830003
578400                                   TO  DP013-MESSAGE-TEXT(1)      57840003
578500         PERFORM DP013-0000-PROCESS-ABEND                         57850003
578600     END-IF.                                                      57860003
578700                                                                  57870003
578800*----------------------------------------------------------------*57880009
578900*    6105-READ-SEL-QUEUE-R USED BY RCVRMNT FUNCTION              *57890009
579000*    READ THE LIST QUEUE RECORD.                                 *57900009
579100*----------------------------------------------------------------*57910009
579200 6105-READ-SEL-QUEUE-R.                                           57920009
579300     EXEC CICS                                                    57930009
579400          READQ TS                                                57940009
579500              QUEUE (ASC-SEL-QUEUE-OUT)                           57950009
579600              INTO  (RC013-DC-SELECT-RECORD)                      57960009
579700              ITEM  (PV-SEL-QUEUE-ITEM)                           57970009
579800              RESP  (PV-CICS-RESP)                                57980009
579900     END-EXEC.                                                    57990009
580000                                                                  58000009
580100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          58010009
580200         CONTINUE                                                 58020009
580300     ELSE                                                         58030009
580400         SET DP013-CICS-ABEND      TO TRUE                        58040009
580500         SET DP013-NO-ROLLBACK     TO TRUE                        58050009
580600         MOVE '6105-READ-SEL-QUEUE-R'                             58060009
580700                                   TO DP013-PARAGRAPH             58070009
580800         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           58080009
580900                                   TO DP013-MESSAGE-TEXT(1)       58090009
581000         PERFORM DP013-0000-PROCESS-ABEND                         58100009
581100     END-IF.                                                      58110009
581200                                                                  58120009
581300*----------------------------------------------------------------*58130003
581400*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*58140003
581500*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*58150003
581600*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *58160003
581700*----------------------------------------------------------------*58170003
581800 6110-PROCESS-ITEMS.                                              58180003
581900     COMPUTE PV-ITEM-COMP3 = 1 + ((TM002-ITEM (TM002-IDX) - 1)    58190003
582000                     / PC-ITEMS-PER-PANEL-COMP3).                 58200003
582100     MOVE PV-ITEM-COMP3 TO PV-ITEM.                               58210003
582200                                                                  58220003
582300     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           58230003
582400         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          58240003
582500             PERFORM 6111-WRITE-LIST-QUEUE                        58250003
582600         END-IF                                                   58260003
582700         MOVE PV-ITEM          TO PV-SAVE-ITEM                    58270003
582800                                                                  58280003
582900         PERFORM 6112-READ-LIST-QUEUE                             58290003
583000         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               58300003
583100             CONTINUE                                             58310003
583200         END-IF                                                   58320003
583300     END-IF.                                                      58330003
583400                                                                  58340003
583500     COMPUTE PV-SUB-COMP3 = (TM002-ITEM (TM002-IDX)               58350003
583600                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              58360003
583700     MOVE PV-SUB-COMP3 TO PV-SUB.                                 58370003
583800     SET LQW-DESELECT (PV-SUB) TO    TRUE                         58380003
583900     MOVE LQW-SELECTED-SW (PV-SUB)                                58390003
584000                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  58400003
584100     EVALUATE TRUE                                                58410003
584200         WHEN TM002-INQ (TM002-IDX)                               58420003
584300              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             58430003
584400         WHEN TM002-UPD (TM002-IDX)                               58440003
584500              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             58450003
584600         WHEN TM002-DEL (TM002-IDX)                               58460003
584700              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             58470003
584800         WHEN TM002-ERR (TM002-IDX)                               58480003
584900              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             58490003
585000     END-EVALUATE.                                                58500003
585100                                                                  58510003
585200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                58520003
585300                                                                  58530003
585400*----------------------------------------------------------------*58540009
585500*    6110-PROCESS-ITEMS-R USED BY RCVRMNT FUNCTION               *58550009
585600*                                                                *58560009
585700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*58570009
585800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*58580009
585900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *58590009
586000*----------------------------------------------------------------*58600009
586100 6110-PROCESS-ITEMS-R.                                            58610009
586200     COMPUTE PV-ITEM-COMP3 = 1 + ((RC013-ITEM (RC013-IDX) - 1)    58620009
586300                     / PC-ITEMS-PER-PANEL).                       58630009
586400     MOVE PV-ITEM-COMP3 TO PV-ITEM.                               58640009
586500                                                                  58650009
586600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           58660009
586700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          58670009
586800             PERFORM 6111-WRITE-LIST-QUEUE                        58680009
586900         END-IF                                                   58690009
587000         MOVE PV-ITEM              TO PV-SAVE-ITEM                58700009
587100                                                                  58710009
587200         PERFORM 6112-READ-LIST-QUEUE                             58720009
587300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               58730009
587400             CONTINUE                                             58740009
587500         END-IF                                                   58750009
587600     END-IF.                                                      58760009
587700                                                                  58770009
587800     COMPUTE PV-SUB-COMP3 = (RC013-ITEM (RC013-IDX)               58780009
587900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              58790009
588000     MOVE PV-SUB-COMP3 TO PV-SUB.                                 58800009
588100                                                                  58810009
588200     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       58820009
588300     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        58830009
588400                                     (PV-SUB).                    58840009
588500     EVALUATE TRUE                                                58850009
588600         WHEN RC013-INQ (RC013-IDX)                               58860009
588700              MOVE PC-INQ          TO LQW-ACTION (PV-SUB)         58870009
588800                                                                  58880009
588900         WHEN RC013-UPD (RC013-IDX)                               58890009
589000              MOVE PC-UPD          TO LQW-ACTION (PV-SUB)         58900009
589100                                                                  58910009
589200         WHEN RC013-DEL (RC013-IDX)                               58920009
589300              MOVE PC-DEL          TO LQW-ACTION (PV-SUB)         58930009
589400                                                                  58940009
589500         WHEN RC013-ERR (RC013-IDX)                               58950009
589600              MOVE PC-ERR          TO LQW-ACTION (PV-SUB)         58960009
589700     END-EVALUATE.                                                58970009
589800                                                                  58980009
589900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                58990009
590000                                                                  59000003
590100*----------------------------------------------------------------*59010003
590200*    WRITE THE TS QUEUE RECORD JUST UPDATED                      *59020009
590300*----------------------------------------------------------------*59030003
590400 6111-WRITE-LIST-QUEUE.                                           59040003
590500     EXEC CICS                                                    59050003
590600         WRITEQ TS                                                59060003
590700             QUEUE (ASC-LIST-QUEUE-NAME)                          59070003
590800             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     59080003
590900             ITEM  (PV-SAVE-ITEM)                                 59090003
591000             REWRITE                                              59100003
591100             RESP  (PV-CICS-RESP)                                 59110003
591200     END-EXEC.                                                    59120003
591300                                                                  59130003
591400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          59140003
591500         CONTINUE                                                 59150003
591600     ELSE                                                         59160003
591700         SET DP013-CICS-ABEND  TO  TRUE                           59170003
591800         SET DP013-NO-ROLLBACK TO  TRUE                           59180003
591900         MOVE '6111-WRITE-LIST-QUEUE' TO DP013-PARAGRAPH          59190009
592000         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  59200003
592100                               TO  DP013-MESSAGE-TEXT(1)          59210003
592200         PERFORM DP013-0000-PROCESS-ABEND                         59220003
592300     END-IF.                                                      59230003
592400                                                                  59240003
592500*----------------------------------------------------------------*59250003
592600*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*59260003
592700*----------------------------------------------------------------*59270003
592800 6112-READ-LIST-QUEUE.                                            59280003
592900     EXEC CICS                                                    59290003
593000         READQ TS                                                 59300003
593100             QUEUE (ASC-LIST-QUEUE-NAME)                          59310003
593200             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     59320003
593300             ITEM  (PV-ITEM)                                      59330003
593400             RESP  (PV-CICS-RESP)                                 59340003
593500     END-EXEC.                                                    59350003
593600                                                                  59360003
593700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          59370003
593800         CONTINUE                                                 59380003
593900     ELSE                                                         59390003
594000         SET DP013-CICS-ABEND        TO TRUE                      59400003
594100         SET DP013-NO-ROLLBACK       TO TRUE                      59410003
594200         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           59420003
594300         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    59430003
594400                                     TO DP013-MESSAGE-TEXT(1)     59440003
594500         PERFORM DP013-0000-PROCESS-ABEND                         59450003
594600     END-IF.                                                      59460003
594700                                                                  59470003
614800*----------------------------------------------------------------*61480009
614900*    READ THE ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE      *61490009
615000*----------------------------------------------------------------*61500003
615100 9100-READ-SEL-QUEUE.                                             61510003
615200     EXEC CICS                                                    61520003
615300         READQ TS                                                 61530003
615400             QUEUE (ASC-SEL-QUEUE-IN)                             61540003
615500             INTO  (RC013-DC-SELECT-RECORD)                       61550003
615600             ITEM  (ASC-SEL-ITEM)                                 61560003
615700             RESP  (PV-CICS-RESP)                                 61570003
615800     END-EXEC.                                                    61580003
615900                                                                  61590003
616000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       61600003
616100         CONTINUE                                                 61610003
616200     ELSE                                                         61620003
616300         SET DP013-LOGIC-ABEND                                    61630003
616400             DP013-NO-ROLLBACK      TO TRUE                       61640009
616500         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            61650003
616600         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   61660003
616700                                    TO DP013-MESSAGE-TEXT (1)     61670009
616800         PERFORM DP013-0000-PROCESS-ABEND                         61680003
616900     END-IF.                                                      61690003
617000                                                                  61700003
617100*----------------------------------------------------------------*61710003
617200*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *61720003
617300*----------------------------------------------------------------*61730003
617400 9200-REWRITE-SEL-QUEUE.                                          61740003
617500     EXEC CICS                                                    61750003
617600          WRITEQ TS                                               61760003
617700              QUEUE  (ASC-SEL-QUEUE-IN)                           61770003
617800              FROM   (RC013-DC-SELECT-RECORD)                     61780003
617900              ITEM  (ASC-SEL-ITEM)                                61790003
618000              RESP   (PV-CICS-RESP)                               61800003
618100              REWRITE                                             61810003
618200     END-EXEC.                                                    61820003
618300                                                                  61830003
618400     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   61840003
618500         SET DP013-CICS-ABEND                                     61850003
618600             DP013-NO-ROLLBACK     TO TRUE                        61860003
618700         MOVE '9200-REWRITE-SEL-QUEUE' TO DP013-PARAGRAPH         61870003
618800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   61880003
618900                                   TO DP013-MESSAGE-TEXT (1)      61890003
619000         PERFORM DP013-0000-PROCESS-ABEND                         61900003
619100     END-IF.                                                      61910003
619200                                                                  61920009
619300 9300-READ-SEL-QUEUE.                                             61930009
619400     EXEC CICS                                                    61940009
619500         READQ TS                                                 61950009
619600             QUEUE (ASC-SEL-QUEUE-IN)                             61960009
619700             INTO  (PC016-TS-SEL-REC)                             61970009
619800             ITEM  (ASC-SEL-ITEM)                                 61980009
619900             RESP  (PV-CICS-RESP)                                 61990009
620000     END-EXEC.                                                    62000009
620100                                                                  62010009
620200     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       62020009
620300         CONTINUE                                                 62030009
620400     ELSE                                                         62040009
620500         SET DP013-LOGIC-ABEND                                    62050009
620600             DP013-NO-ROLLBACK     TO TRUE                        62060009
620700         MOVE '9300-READ-SEL-QUEUE' TO DP013-PARAGRAPH            62070009
620800         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   62080009
620900                                   TO DP013-MESSAGE-TEXT (1)      62090009
621000         PERFORM DP013-0000-PROCESS-ABEND                         62100009
621100     END-IF.                                                      62110009
621200                                                                  62120009
621300*----------------------------------------------------------------*62130009
621400*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *62140009
621500*----------------------------------------------------------------*62150009
621600 9400-REWRITE-SEL-QUEUE.                                          62160009
621700     EXEC CICS                                                    62170009
621800          WRITEQ TS                                               62180009
621900              QUEUE  (ASC-SEL-QUEUE-IN)                           62190009
622000              FROM   (PC016-TS-SEL-REC)                           62200009
622100              ITEM  (ASC-SEL-ITEM)                                62210009
622200              RESP   (PV-CICS-RESP)                               62220009
622300              REWRITE                                             62230009
622400     END-EXEC.                                                    62240009
622500                                                                  62250009
622600     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   62260009
622700         SET DP013-CICS-ABEND                                     62270009
622800             DP013-NO-ROLLBACK     TO TRUE                        62280009
622900         MOVE '9400-REWRITE-SEL-QUEUE' TO DP013-PARAGRAPH         62290009
623000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   62300009
623100                                   TO DP013-MESSAGE-TEXT (1)      62310009
623200         PERFORM DP013-0000-PROCESS-ABEND                         62320009
623300     END-IF.                                                      62330009
623400                                                                  62340009
623500 9500-READ-SEL-QUEUE.                                             62350009
623600     EXEC CICS                                                    62360009
623700         READQ TS                                                 62370009
623800             QUEUE (ASC-SEL-QUEUE-IN)                             62380009
623900             INTO  (DS002-PRINT-SELECT-RECORD)                    62390009
624000             ITEM  (ASC-SEL-ITEM)                                 62400009
624100             RESP  (PV-CICS-RESP)                                 62410009
624200     END-EXEC.                                                    62420009
624300                                                                  62430009
624400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       62440009
624500         CONTINUE                                                 62450009
624600     ELSE                                                         62460009
624700         SET DP013-LOGIC-ABEND                                    62470009
624800             DP013-NO-ROLLBACK     TO TRUE                        62480009
624900         MOVE '9500-READ-SEL-QUEUE' TO DP013-PARAGRAPH            62490009
625000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   62500009
625100                                   TO DP013-MESSAGE-TEXT (1)      62510009
625200         PERFORM DP013-0000-PROCESS-ABEND                         62520009
625300     END-IF.                                                      62530009
625400                                                                  62540009
625500*----------------------------------------------------------------*62550009
625600*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *62560009
625700*----------------------------------------------------------------*62570009
625800 9600-REWRITE-SEL-QUEUE.                                          62580009
625900     EXEC CICS                                                    62590009
626000          WRITEQ TS                                               62600009
626100              QUEUE  (ASC-SEL-QUEUE-IN)                           62610009
626200              FROM   (DS002-PRINT-SELECT-RECORD)                  62620009
626300              ITEM  (ASC-SEL-ITEM)                                62630009
626400              RESP   (PV-CICS-RESP)                               62640009
626500              REWRITE                                             62650009
626600     END-EXEC.                                                    62660009
626700                                                                  62670009
626800     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   62680009
626900         SET DP013-CICS-ABEND                                     62690009
627000             DP013-NO-ROLLBACK     TO TRUE                        62700009
627100         MOVE '9600-REWRITE-SEL-QUEUE' TO DP013-PARAGRAPH         62710009
627200         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   62720009
627300                                   TO DP013-MESSAGE-TEXT (1)      62730009
627400         PERFORM DP013-0000-PROCESS-ABEND                         62740009
627500     END-IF.                                                      62750009
627600                                                                  62760003
627700*----------------------------------------------------------------*62770003
627800*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *62780003
627900*----------------------------------------------------------------*62790003
628000 9900-SQL-913-RETURN.                                             62800003
628100     PERFORM 9100-READ-SEL-QUEUE.                                 62810003
628200     MOVE SPACE TO RC013-ACTION-SW (ASC-SEL-ITEM)                 62820003
628300     PERFORM 9200-REWRITE-SEL-QUEUE.                              62830003
628400     SET DP020-NEXT-ACT-APPL-ERROR TO TRUE.                       62840003
628500     SET DP020-MSG-FATAL           TO  TRUE.                      62850003
628600     MOVE PC-TSYMSG-01089          TO  DP020-MSG-NUMBER.          62860003
628700     MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1).         62870003
628800     PERFORM 0001-CALL-CICS-ARCH-API.                             62880003
628900                                                                  62890003
629000 9910-SQL-913-RETURN.                                             62900003
629100     SET DP020-NEXT-ACT-APPL-ERROR TO TRUE.                       62910003
629200     SET DP020-MSG-FATAL           TO  TRUE.                      62920003
629300     MOVE PC-TSYMSG-01089          TO  DP020-MSG-NUMBER.          62930003
629400     MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1).         62940003
629500     PERFORM 0001-CALL-CICS-ARCH-API.                             62950003
629600                                                                  62960003
629700*----------------------------------------------------------------*62970003
629800*    ABEND PROCESSOR MODULE                                      *62980003
629900*----------------------------------------------------------------*62990003
630000     COPY DPPD013.                                                63000003
