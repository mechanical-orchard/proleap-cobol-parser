000400******************************************************************00040003
000500 IDENTIFICATION DIVISION.                                         00050003
000600******************************************************************00060003
000700 PROGRAM-ID.    PCKUT123.                                         00070003
000800 AUTHOR.        DENISE HAHN.                                      00080003
000900 DATE-WRITTEN.  FEBRUARY 2024.                                    00090003
001000******************************************************************00100003
001100* THIS PROGRAM WILL BE USED TO DETERMINE:                         00110003
001200*    -  DETERMINE PROCESS AREA                                    00120003
001300*    -  DETERMINE THE BUSINESS DATE AND SHIFT BASED ON THE        00130003
001400*       TRANSACTION TIMESTAMP AND DC NUMBER                       00140003
001500*    -  DETERMINE WHAT HAS BEEN PREVIOUSLY POSTED TO THE UNITS    00150003
001600*       WORKED DATABASES FOR CONFIRMATION, UPLOADED P2L           00160003
001700*       TRANSACTIONS AND/OR VERIFICATION                          00170003
001710*                                                                 00171015
001720*  INPUT FILE IS IN OPER-PO-RCVR-LINE-STORE ORDER                 00172015
001800******************************************************************00180003
001900 ENVIRONMENT DIVISION.                                            00190003
002000 INPUT-OUTPUT SECTION.                                            00200003
002100                                                                  00210003
002200 FILE-CONTROL.                                                    00220003
002300     SELECT PICKMADE-EXTRACT-IN      ASSIGN TO INP01.             00230009
002400                                                                  00240003
002500     SELECT PICKMADE-EXTRACT-OUT     ASSIGN TO OUT01.             00250009
002600                                                                  00260003
002700 DATA DIVISION.                                                   00270003
002800 FILE SECTION.                                                    00280003
002900                                                                  00290003
003000 FD  PICKMADE-EXTRACT-IN                                          00300009
003100     RECORDING MODE IS F                                          00310003
003200     LABEL RECORDS ARE STANDARD                                   00320003
003300     BLOCK CONTAINS 0 RECORDS.                                    00330003
003400                                                                  00340003
003500 01  PICKMADE-RECORD-IN               PIC X(300).                 00350009
003600                                                                  00360003
003700 FD  PICKMADE-EXTRACT-OUT                                         00370009
003800     RECORDING MODE IS F                                          00380003
003900     LABEL RECORDS ARE STANDARD                                   00390003
004000     BLOCK CONTAINS 0 RECORDS.                                    00400003
004100                                                                  00410003
004200 01  PICKMADE-RECORD-OUT              PIC X(300).                 00420009
004300                                                                  00430003
004400                                                                  00440003
004500*----------------------------------------------------------------*00450003
004600 WORKING-STORAGE SECTION.                                         00460003
004700                                                                  00470011
004800 01  DK-DB2-KEYS.                                                 00480003
004900     05  DK-OPER-UNT-ID              PIC S9(04)  COMP.            00490015
004901     05  DK-PO-NBR                   PIC S9(09)  COMP.            00490115
004902     05  DK-PO-LINE-NBR              PIC S9(09)  COMP.            00490215
004903     05  DK-RCVR-SEQ-NBR             PIC S9(09)  COMP.            00490315
004910     05  DK-BUS-DTE                  PIC  X(10).                  00491015
005000                                                                  00500003
005800*----------------------------------------------------------------*00580003
005900* INPUT/OUTPUT RECORD LAYOUT                                      00590003
006000*----------------------------------------------------------------*00600003
006100     COPY PCRD086.                                                00610003
006500                                                                  00650011
006510                                                                  00651011
006600*----------------------------------------------------------------*00660003
006700*  PROGRAM CONSTANTS                                             *00670003
006800*----------------------------------------------------------------*00680003
006900 01  PC-PROGRAM-CONSTANTS.                                        00690009
006910     05  PC-END-TM                PIC  X(08) VALUE '24.00.00'.    00691009
006920     05  PC-BEG-TM                PIC  X(08) VALUE '00.00.00'.    00692009
006930                                                                  00693009
009900*----------------------------------------------------------------*00990003
010000*  PROGRAM SWITCHES                                              *01000003
010100*----------------------------------------------------------------*01010003
010200 01  PS-PROGRAM-SWITCHES.                                         01020003
010300     05  PS-END-OF-FILE-SW               PIC  X(01)  VALUE 'N'.   01030003
010400         88  PS-EOF                                  VALUE 'Y'.   01040003
010500         88  PS-EOF-NO                               VALUE 'N'.   01050003
010510     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   01051005
010520         88  PS-ERROR                                VALUE 'Y'.   01052005
010530         88  PS-ERROR-NO                             VALUE 'N'.   01053005
010540     05  PS-POST-UNITS-WORKED-SW         PIC  X(01)  VALUE ' '.   01054005
010550         88  PS-POST-UNITS-WORKED-YES                VALUE 'Y'.   01055005
010560         88  PS-POST-UNITS-WORKED-NO                 VALUE 'N'.   01056005
010570     05  PS-DONE-CHECKING-SW             PIC  X(01)  VALUE ' '.   01057009
010580         88  PS-DONE-CHECKING                        VALUE 'Y'.   01058009
010590         88  PS-DONE-CHECKING-NO                     VALUE 'N'.   01059009
010700                                                                  01070003
010800                                                                  01080011
018300*----------------------------------------------------------------*01830003
018400*  PROGRAM VARIABLES                                             *01840003
018500*----------------------------------------------------------------*01850003
018600 01  PV-PROGRAM-VARIABLES.                                        01860003
018700                                                                  01870003
018800     05  PV-DISP-OPER                 PIC 9(04)  VALUE ZEROS.     01880003
018900     05  PV-DISP-PO                   PIC 9(08)  VALUE ZEROS.     01890003
019000     05  PV-DISP-RCVR                 PIC 9(04)  VALUE ZEROS.     01900003
019100     05  PV-DISP-LINE                 PIC 9(04)  VALUE ZEROS.     01910003
019200     05  PV-DISP-PREPK                PIC 9(04)  VALUE ZEROS.     01920003
019300     05  PV-DISP-SHIFT                PIC 9999-  VALUE ZEROS.     01930003
019301     05  PV-DISP-STORE                PIC 9(04)  VALUE ZEROS.     01930123
019302     05  PV-DISP-QTY                  PIC Z(4)9- VALUE ZEROS.     01930223
019310     05  PV-EVENT-INPUT-COUNT         PIC 9(09)  VALUE ZEROS.     01931008
019320     05  PV-EVENT-BYPASS-COUNT        PIC 9(09)  VALUE ZEROS.     01932008
019330     05  PV-EVENT-OUTPUT-COUNT        PIC 9(09)  VALUE ZEROS.     01933008
019331     05  PV-PICK-BEFORE-VE-CNT        PIC 9(09)  VALUE ZEROS.     01933124
019340     05  PV-DISP-COUNT                PIC ZZZ,ZZZ,ZZ9.            01934010
019350     05  PV-SQLCODE                   PIC -999.                   01935010
019360     05  PV-UWBYPS-FUNC-TXT           PIC X(25).                  01936017
019400                                                                  01940003
019500     05  PV-CURRENT-TMST                 PIC  X(26)  VALUE SPACES.01950003
019600     05  PV-CURRENT-TMST-R REDEFINES PV-CURRENT-TMST.             01960003
019700         10  PV-CURR-CC                  PIC  9(02).              01970003
019800         10  PV-CURR-YY                  PIC  9(02).              01980003
019900         10  FILLER                      PIC  X(01).              01990003
020000         10  PV-CURR-MM                  PIC  9(02).              02000003
020100         10  FILLER                      PIC  X(01).              02010003
020200         10  PV-CURR-DD                  PIC  9(02).              02020003
020300         10  FILLER                      PIC  X(01).              02030003
020400         10  PV-CURR-HH                  PIC  9(02).              02040003
020500         10  FILLER                      PIC  X(01).              02050003
020600         10  PV-CURR-MN                  PIC  9(02).              02060003
020700         10  FILLER                      PIC  X(01).              02070003
020800         10  PV-CURR-SS                  PIC  9(02).              02080003
020900         10  FILLER                      PIC  X(07).              02090003
021000     05  PV-BUSINESS-DATE                PIC  X(26)  VALUE SPACES.02100012
021100     05  PV-BUSINESS-DATE-R REDEFINES PV-BUSINESS-DATE.           02110012
021200         10  PV-BUSN-CC                  PIC  9(02).              02120003
021300         10  PV-BUSN-YY                  PIC  9(02).              02130003
021400         10  FILLER                      PIC  X(01).              02140003
021500         10  PV-BUSN-MM                  PIC  9(02).              02150003
021600         10  FILLER                      PIC  X(01).              02160003
021700         10  PV-BUSN-DD                  PIC  9(02).              02170003
021800         10  FILLER                      PIC  X(01).              02180003
021900         10  PV-BUSN-HH                  PIC  9(02).              02190003
022000         10  FILLER                      PIC  X(01).              02200003
022100         10  PV-BUSN-MN                  PIC  9(02).              02210003
022200         10  FILLER                      PIC  X(01).              02220003
022300         10  PV-BUSN-SS                  PIC  9(02).              02230003
022400         10  FILLER                      PIC  X(07).              02240003
022500     05  PV-BUSINESS-DATE-PREV           PIC  X(26)  VALUE SPACES.02250012
022600     05  PV-BUSINESS-DATE-R-PREV REDEFINES PV-BUSINESS-DATE-PREV. 02260012
022700         10  PV-BUSN-CC-PREV             PIC  9(02).              02270003
022800         10  PV-BUSN-YY-PREV             PIC  9(02).              02280003
022900         10  FILLER                      PIC  X(01).              02290003
023000         10  PV-BUSN-MM-PREV             PIC  9(02).              02300003
023100         10  FILLER                      PIC  X(01).              02310003
023200         10  PV-BUSN-DD-PREV             PIC  9(02).              02320003
023300         10  FILLER                      PIC  X(01).              02330003
023400         10  PV-BUSN-HH-PREV             PIC  9(02).              02340003
023500         10  FILLER                      PIC  X(01).              02350003
023600         10  PV-BUSN-MN-PREV             PIC  9(02).              02360003
023700         10  FILLER                      PIC  X(01).              02370003
023800         10  PV-BUSN-SS-PREV             PIC  9(02).              02380003
023900         10  FILLER                      PIC  X(07).              02390003
024000*    05  PV-WRKD-TMST                    PIC  X(26)  VALUE SPACES.02400003
024100     05  PV-SHIFT-TIME                   PIC  X(08)  VALUE SPACES.02410003
024200     05  PV-SHIFT-TIME-R REDEFINES PV-SHIFT-TIME.                 02420003
024300         10  PV-SHFT-HH                  PIC  9(02).              02430003
024400         10  PV-PERIOD-1                 PIC  X(01).              02440003
024500         10  PV-SHFT-MN                  PIC  9(02).              02450003
024600         10  PV-PERIOD-2                 PIC  X(01).              02460003
024700         10  PV-SHFT-SS                  PIC  9(02).              02470003
024800     05  PV-KEY-DATE                     PIC  X(10) VALUE SPACES. 02480003
024900     05  PV-KEY-DATE-R REDEFINES PV-KEY-DATE.                     02490003
025000         10  PV-KEY-CC                   PIC  9(02).              02500003
025100         10  PV-KEY-YY                   PIC  9(02).              02510003
025200         10  PV-KEY-DASH-1               PIC  X(01).              02520003
025300         10  PV-KEY-MM                   PIC  9(02).              02530003
025400         10  PV-KEY-DASH-2               PIC  X(01).              02540003
025500         10  PV-KEY-DD                   PIC  9(02).              02550003
025600                                                                  02560003
025610 01  PV-ABEND-CODE                    PIC S9(04)   VALUE ZERO.    02561011
025700                                                                  02570003
032200 01  PV-ABEND-FIELDS.                                             03220003
032300     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'PCKUT121'.03230003
032400     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    03240003
032500     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    03250003
032600     05  PV-ABEND-STRUCTURE-1         PIC X(15)  VALUE SPACES.    03260003
032700     05  PV-ABEND-STRUCTURE-2         PIC X(15)  VALUE SPACES.    03270003
032800     05  PV-ABEND-STRUCTURE-3         PIC X(15)  VALUE SPACES.    03280003
032900     05  PV-ABEND-STATUS              PIC XX     VALUE SPACES.    03290003
033000     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    03300003
033100     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    03310003
033200     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    03320003
033300     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.    03330003
033400                                                                  03340003
033500                                                                  03350003
033600*---------------------------------------------------------------* 03360003
033700*    PARM TABLE                                                   03370003
033800*---------------------------------------------------------------* 03380003
033900     EXEC SQL                                                     03390003
034000         INCLUDE TKRPRPM                                          03400003
034100     END-EXEC.                                                    03410003
034200                                                                  03420003
034300*---------------------------------------------------------------* 03430003
034400*  DB2 AREA FOR THE PCT SHIFT TABLE (PCT_SHFT)                    03440003
034500*---------------------------------------------------------------* 03450003
034600     EXEC SQL                                                     03460003
034700         INCLUDE PCT00004                                         03470003
034800     END-EXEC.                                                    03480003
034900                                                                  03490003
035000*---------------------------------------------------------------* 03500003
035100*    DB2 DCLGEN FOR DATE ATTRIBUTE TABLE                        * 03510003
035200*---------------------------------------------------------------* 03520003
035300     EXEC SQL                                                     03530003
035400          INCLUDE TDTATTR                                         03540003
035500     END-EXEC.                                                    03550003
035600                                                                  03560003
035700*---------------------------------------------------------------* 03570003
035800*    DB2 AREA FOR THE PURCHASE ITEM TABLE                       * 03580003
035900*---------------------------------------------------------------* 03590003
036000     EXEC SQL                                                     03600006
036100          INCLUDE TPURITM                                         03610006
036200     END-EXEC.                                                    03620006
036210                                                                  03621006
036300*---------------------------------------------------------------* 03630003
036400*    DB2 AREA FOR THE RECEIVER TABLE                            * 03640003
036500*---------------------------------------------------------------* 03650003
036600     EXEC SQL                                                     03660006
036700          INCLUDE TRECEIV                                         03670006
036800     END-EXEC.                                                    03680006
036810                                                                  03681006
036820*---------------------------------------------------------------* 03682006
036830*    DB2 AREA FOR RECEIVER ITEM TABLE                           * 03683006
036840*---------------------------------------------------------------* 03684006
036850     EXEC SQL                                                     03685006
036860          INCLUDE TRECITM                                         03686006
036870     END-EXEC.                                                    03687006
036880                                                                  03688006
037600*-----------------------------------------------------------------03760010
037700*  USED FOR DB2 ERROR MESSAGE BUILDING                            03770010
037800*-----------------------------------------------------------------03780010
037900     COPY DPWS004.                                                03790010
038000                                                                  03800010
040100*----------------------------------------------------------------*04010003
040200*  COMMUNICATIONS AREA FOR DB2                                   *04020003
040300*----------------------------------------------------------------*04030003
040400     EXEC SQL                                                     04040003
040500         INCLUDE SQLCA                                            04050003
040600     END-EXEC.                                                    04060003
040700                                                                  04070003
043900*----------------------------------------------------------------*04390003
044000 PROCEDURE DIVISION.                                              04400003
044100*----------------------------------------------------------------*04410003
044200                                                                  04420003
044300     DISPLAY '************************'.                          04430003
044400     DISPLAY '******* PCKUT123 *******'.                          04440003
044500     DISPLAY '************************'.                          04450003
044600                                                                  04460003
044610     SET  PS-ERROR-NO                                             04461009
044611          PS-DONE-CHECKING-NO                                     04461109
044612          PS-POST-UNITS-WORKED-NO TO TRUE.                        04461209
044620                                                                  04462005
044700     PERFORM 1000-INIT.                                           04470003
044800                                                                  04480003
044801     PERFORM 5050-TKRPRPM-RCVR-TYPES.                             04480117
044810                                                                  04481017
044900     PERFORM 2000-PROCESS                                         04490003
045000       UNTIL PS-EOF                                               04500005
045010          OR PS-ERROR.                                            04501005
045100                                                                  04510003
045200     PERFORM 9000-TERMINATE.                                      04520003
045300                                                                  04530003
045400     GOBACK.                                                      04540003
045500                                                                  04550003
045600*-----------------------------------------------------------------04560003
045700*                                                                 04570003
045800*-----------------------------------------------------------------04580003
045900 1000-INIT.                                                       04590003
046000                                                                  04600003
046100     OPEN INPUT  PICKMADE-EXTRACT-IN.                             04610009
046200     OPEN OUTPUT PICKMADE-EXTRACT-OUT.                            04620009
046300                                                                  04630003
046400     PERFORM 7000-READ-INPUT.                                     04640003
046500                                                                  04650003
046600                                                                  04660003
046700*-----------------------------------------------------------------04670003
046800*                                                                 04680003
046900*-----------------------------------------------------------------04690003
047000 2000-PROCESS.                                                    04700003
047100                                                                  04710003
047110     SET  PS-DONE-CHECKING-NO                                     04711009
047111          PS-POST-UNITS-WORKED-NO TO TRUE.                        04711109
047120                                                                  04712009
047200     MOVE PC086-OPER-UNT-ID       TO PV-DISP-OPER.                04720003
047300     MOVE PC086-ORD-NBR           TO PV-DISP-PO.                  04730003
047400     MOVE PC086-RCVR-SEQ-NBR      TO PV-DISP-RCVR.                04740003
047500     MOVE PC086-ORD-LNE-NBR       TO PV-DISP-LINE.                04750003
047510     MOVE PC086-STORE-NBR         TO PV-DISP-STORE.               04751021
047520     MOVE PC086-PICKED-QTY        TO PV-DISP-QTY.                 04752023
047600                                                                  04760003
047700*    DISPLAY 'RCVR:  '                                            04770021
047800*           PV-DISP-OPER '-'                                      04780021
047900*           PV-DISP-PO   '-'                                      04790021
048000*           PV-DISP-RCVR '-'                                      04800021
048100*           PV-DISP-LINE.                                         04810021
048200                                                                  04820003
048300     PERFORM 2100-DETRMN-BUS-DAY-SHIFT.                           04830003
048400                                                                  04840003
048401     IF  PS-ERROR-NO                                              04840105
048402         PERFORM 2110-CHECK-RCVR-TYPE                             04840205
048403     END-IF,                                                      04840305
048404                                                                  04840405
048405     IF  PS-ERROR-NO  AND                                         04840505
048406         PS-POST-UNITS-WORKED-YES                                 04840605
048407         PERFORM 5060-SELECT-RETAIL-PRICE                         04840727
048417         IF  RECITM-VERFYD-TMST                                   04841726
048418                 <  '9999-09-09-09.09.09.999999' AND              04841826
048419             PC086-BUS-EVENT-TMST < RECITM-VERFYD-TMST            04841926
048420             SET PS-POST-UNITS-WORKED-NO  TO TRUE                 04842026
048421             ADD 1  TO PV-PICK-BEFORE-VE-CNT                      04842126
048423*            DISPLAY ' PICKED BEFORE VE: '                        04842330
048424*                      PV-DISP-OPER '-'                           04842430
048425*                      PV-DISP-PO   '-'                           04842530
048426*                      PV-DISP-RCVR '-'                           04842630
048427*                      PV-DISP-LINE '-'                           04842730
048428*                      PV-DISP-STORE '  '                         04842830
048429*                      PV-DISP-QTY   '  '                         04842930
048430*                      PC086-BUS-EVENT-TMST                       04843030
048431*                    ' VE TMST: 'RECITM-VERFYD-TMST               04843130
048440        END-IF                                                    04844020
048500     END-IF.                                                      04850005
048600                                                                  04860003
048910     IF  PS-ERROR-NO  AND                                         04891005
048920         PS-POST-UNITS-WORKED-YES                                 04892005
049000         PERFORM 8000-WRITE-EXTRACT-REC                           04900005
049010     END-IF.                                                      04901005
049100                                                                  04910003
049200     PERFORM 7000-READ-INPUT.                                     04920003
049300                                                                  04930003
049400                                                                  04940003
049410*-----------------------------------------------------------------04941005
049420*                                                                 04942005
049430*-----------------------------------------------------------------04943005
049500 2100-DETRMN-BUS-DAY-SHIFT.                                       04950003
049600                                                                  04960003
049700     MOVE PC086-OPER-UNT-ID       TO DK-OPER-UNT-ID.              04970003
049800                                                                  04980003
049900     PERFORM 5000-GET-TKRPRPM-TIMEZN.                             04990017
050000                                                                  05000003
050100     SET PS-ERROR-NO  TO  TRUE.                                   05010005
050200     PERFORM 5010-GET-SHIFT.                                      05020006
050300                                                                  05030003
050400     IF  PS-ERROR-NO                                              05040005
050500         CONTINUE                                                 05050003
050600     ELSE                                                         05060003
050700         MOVE PV-KEY-DATE         TO DK-BUS-DTE                   05070003
050800                                     PC086-BUS-DTE                05080008
050900         PERFORM 5030-SELECT-FISCAL-INFO                          05090006
051000         MOVE DTATTR-FSCL-YR-NBR         TO PC086-FSCL-YR-NBR     05100003
051100         MOVE DTATTR-FSCL-MN-NBR         TO PC086-FSCL-MN-NBR     05110003
051200         MOVE DTATTR-FSCL-WK-NBR         TO PC086-FSCL-WK-NBR     05120003
051300         MOVE DTATTR-WK-IN-MN-NBR        TO PC086-WK-IN-MN-NBR    05130003
051400         MOVE DTATTR-DAY-OF-WK-NBR       TO PC086-DAY-OF-WK-NBR   05140003
051500         MOVE DTATTR-LY-THIS-DAY-KY-DTE                           05150003
051600                                      TO PC086-LY-THIS-DAY-KY-DTE 05160003
051700         MOVE DTATTR-FSCL-MN-BEG-DTE     TO PC086-FSCL-MN-BEG-DTE 05170003
051800         MOVE DTATTR-FSCL-MN-END-DTE     TO PC086-FSCL-MN-END-DTE 05180003
051900         MOVE DTATTR-FSCL-WK-BEG-DTE     TO PC086-FSCL-WK-BEG-DTE 05190003
052000         MOVE DTATTR-FSCL-WK-END-DTE     TO PC086-FSCL-WK-END-DTE 05200003
052100     END-IF.                                                      05210003
052200                                                                  05220003
052201                                                                  05220105
052202*-----------------------------------------------------------------05220205
052203*                                                                 05220305
052204*-----------------------------------------------------------------05220405
052205 2110-CHECK-RCVR-TYPE.                                            05220505
052206                                                                  05220605
052210     MOVE PC086-ORD-NBR          TO DK-PO-NBR                     05221005
052220     MOVE PC086-RCVR-SEQ-NBR     TO DK-RCVR-SEQ-NBR               05222005
052230     MOVE PC086-ORD-LNE-NBR      TO DK-PO-LINE-NBR                05223005
052240     PERFORM 5040-SELECT-TRECEIV                                  05224006
052241                                                                  05224117
052242     IF  RECEIV-REC-TYP-CDE = PV-UWBYPS-FUNC-TXT (1:2)            05224217
052243                           OR PV-UWBYPS-FUNC-TXT (4:2)            05224317
052244                           OR PV-UWBYPS-FUNC-TXT (7:2)            05224417
052245                           OR PV-UWBYPS-FUNC-TXT (10:2)           05224517
052246                           OR PV-UWBYPS-FUNC-TXT (13:2)           05224617
052247                           OR PV-UWBYPS-FUNC-TXT (16:2)           05224717
052248                           OR PV-UWBYPS-FUNC-TXT (19:2)           05224817
052249                           OR PV-UWBYPS-FUNC-TXT (22:2)           05224917
052250         SET PS-POST-UNITS-WORKED-NO  TO TRUE                     05225017
052251         ADD 1  TO  PV-EVENT-BYPASS-COUNT                         05225131
052252*        DISPLAY ' RCVR BYPASSED FOR REC-TYP: '                   05225230
052253*                  PV-DISP-OPER '-'                               05225330
052254*                  PV-DISP-PO   '-'                               05225430
052255*                  PV-DISP-RCVR '-'                               05225530
052256*                  PV-DISP-LINE ' '                               05225630
052257*                '  REC-TYP-CDE:' RECEIV-REC-TYP-CDE              05225730
052258     ELSE                                                         05225817
052259         SET PS-POST-UNITS-WORKED-YES TO TRUE                     05225917
052260     END-IF.                                                      05226017
052270                                                                  05227017
052300                                                                  05230006
232948*----------------------------------------------------------------*23294805
232949*    RETRIEVE THE TIMEZN FROM TKRPRPM TABLE DETERMINE THE NUMBER  23294905
232950*    OF HOURS TO ADD OR SUBTRACT FROM THE CURRENT TIME INORDER    23295005
232951*    TO BE IN THE CORRECT TIMEZONE.                               23295105
232952*                                                                 23295218
232954*----------------------------------------------------------------*23295418
232955 5000-GET-TKRPRPM-TIMEZN.                                         23295518
232956                                                                  23295618
232957     EXEC SQL                                                     23295718
232959         SELECT (TIMESTAMP(:PC086-BUS-EVENT-TMST)                 23295919
232960                     + FUNC_QTY HOURS)                            23296018
232961               ,(TIMESTAMP(:PC086-BUS-EVENT-TMST)                 23296119
232962                     + FUNC_QTY HOURS)                            23296218
232963                 + 1 DAY                                          23296318
232964               ,(TIMESTAMP(:PC086-BUS-EVENT-TMST)                 23296419
232965                     + FUNC_QTY HOURS)                            23296518
232966                 - 1 DAY                                          23296618
232967           INTO   :PV-CURRENT-TMST                                23296718
232968                 ,:PV-BUSINESS-DATE                               23296818
232969                 ,:PV-BUSINESS-DATE-PREV                          23296918
232970           FROM   TKRPRPM                                         23297018
232971          WHERE LOC_ID           = :DK-OPER-UNT-ID                23297118
232972            AND INTFC_SYS_CDE    = 'KHL'                          23297218
232973            AND SYS_PRC_FUNC_CDE = 'TIMEZN'                       23297318
232974            AND FUNC_PRC_STAT_CDE = 'AC'                          23297418
232975           WITH UR                                                23297518
232976     END-EXEC.                                                    23297618
232977                                                                  23297718
232978     EVALUATE TRUE                                                23297818
232979         WHEN SQLCODE = +0                                        23297918
232980              MOVE PV-CURR-HH  TO PV-SHFT-HH                      23298018
232981              MOVE PV-CURR-MN  TO PV-SHFT-MN                      23298118
232982              MOVE PV-CURR-SS  TO PV-SHFT-SS                      23298218
232983              MOVE '.'         TO PV-PERIOD-1                     23298318
232984                                  PV-PERIOD-2                     23298418
232985                                                                  23298518
232986         WHEN SQLWARN0 NOT = SPACE                                23298618
232987         WHEN SQLCODE  NOT = ZERO                                 23298718
232988             MOVE '5000-GET-TKRPRPM-TIMEZN'                       23298818
232989                                       TO PV-ABEND-PARAGRAPH      23298918
232990             MOVE 'SELECT TIMEZONE'    TO PV-ABEND-OPERATION      23299018
232991             MOVE 'TKRPRPM'            TO PV-ABEND-STRUCTURE-1    23299118
232992             PERFORM 9900-DB2-ABEND                               23299218
232993     END-EVALUATE.                                                23299318
232994                                                                  23299418
232995                                                                  23299518
232996*----------------------------------------------------------------*23299618
232997*    LOOK AT SHIFT TABLE TO SEE IF DATE NEEDS TO BE INCREMENTED.  23299718
232998*----------------------------------------------------------------*23299818
232999 5010-GET-SHIFT.                                                  23299918
233000                                                                  23300018
233001     EXEC SQL                                                     23300118
233002         SELECT SHFT_NBR, SHFT_BEG_TM, SHFT_END_TM                23300218
233003           INTO :PCT00004-SHFT-NBR                                23300318
233004              , :PCT00004-SHFT-BEG-TM                             23300418
233005              , :PCT00004-SHFT-END-TM                             23300518
233006           FROM   PCT_SHFT                                        23300618
233007          WHERE OPER_UNT_ID      = :DK-OPER-UNT-ID                23300718
233008            AND ((SHFT_BEG_TM   <= :PV-SHIFT-TIME                 23300818
233009            AND   SHFT_END_TM   >= :PV-SHIFT-TIME)                23300918
233010             OR  (SHFT_END_TM   >= :PV-SHIFT-TIME                 23301018
233011            AND   SHFT_BEG_TM   > SHFT_END_TM)                    23301118
233012             OR  (SHFT_BEG_TM   <= :PV-SHIFT-TIME                 23301218
233013            AND   SHFT_BEG_TM   > SHFT_END_TM))                   23301318
233014           WITH UR                                                23301418
233015     END-EXEC.                                                    23301518
233016                                                                  23301618
233017     EVALUATE TRUE                                                23301718
233018         WHEN SQLCODE = +0                                        23301818
233019             MOVE PCT00004-SHFT-NBR     TO PC086-SHFT-NBR         23301918
233020             MOVE '-'                   TO PV-KEY-DASH-1          23302018
233021                                           PV-KEY-DASH-2          23302118
233022                                           PC086-BUS-DASH-1       23302218
233023                                           PC086-BUS-DASH-2       23302318
233024                                                                  23302418
233025             IF  PCT00004-SHFT-BEG-TM  >  PCT00004-SHFT-END-TM    23302518
233026                 IF  PCT00004-SHFT-NBR  =  2                      23302618
233027                     PERFORM 5020-CHECK-OVERLAPPING-SHIFTS        23302718
233028                 END-IF                                           23302818
233029                 IF  PS-DONE-CHECKING                             23302918
233030                     CONTINUE                                     23303018
233031                 ELSE                                             23303118
233032                     IF  PV-SHIFT-TIME >= PCT00004-SHFT-BEG-TM AND23303218
233033                         PV-SHIFT-TIME <  PC-END-TM               23303318
233034                         MOVE PV-BUSN-CC  TO PC086-BUS-DTE-CC     23303418
233035                                            PV-KEY-CC             23303518
233036                         MOVE PV-BUSN-YY  TO PC086-BUS-DTE-YY     23303618
233037                                            PV-KEY-YY             23303718
233038                         MOVE PV-BUSN-MM  TO PC086-BUS-DTE-MM     23303818
233039                                            PV-KEY-MM             23303918
233040                         MOVE PV-BUSN-DD  TO PC086-BUS-DTE-DD     23304018
233041                                            PV-KEY-DD             23304118
233042                     ELSE                                         23304218
233043                         MOVE PV-CURR-CC  TO PC086-BUS-DTE-CC     23304318
233044                                             PV-KEY-CC            23304418
233045                         MOVE PV-CURR-YY  TO PC086-BUS-DTE-YY     23304518
233046                                             PV-KEY-YY            23304618
233047                         MOVE PV-CURR-MM  TO PC086-BUS-DTE-MM     23304718
233048                                             PV-KEY-MM            23304818
233049                         MOVE PV-CURR-DD  TO PC086-BUS-DTE-DD     23304918
233050                                             PV-KEY-DD            23305018
233051                     END-IF                                       23305118
233052                 END-IF                                           23305218
233053             ELSE                                                 23305318
233054                 MOVE PV-CURR-CC        TO PC086-BUS-DTE-CC       23305418
233055                                           PV-KEY-CC              23305518
233056                 MOVE PV-CURR-YY        TO PC086-BUS-DTE-YY       23305618
233057                                           PV-KEY-YY              23305718
233058                 MOVE PV-CURR-MM        TO PC086-BUS-DTE-MM       23305818
233059                                           PV-KEY-MM              23305918
233060                 MOVE PV-CURR-DD        TO PC086-BUS-DTE-DD       23306018
233061                                           PV-KEY-DD              23306118
233062             END-IF                                               23306218
233063                                                                  23306318
233064         WHEN SQLCODE = +100                                      23306418
233065             SET PS-ERROR               TO TRUE                   23306518
233066                                                                  23306618
233067         WHEN OTHER                                               23306718
233068             MOVE DK-OPER-UNT-ID TO  PV-DISP-OPER                 23306818
233069             MOVE PC086-ORD-NBR      TO PV-DISP-PO                23306918
233070             MOVE PC086-RCVR-SEQ-NBR TO PV-DISP-RCVR              23307018
233071             MOVE PC086-ORD-LNE-NBR  TO PV-DISP-LINE              23307118
233072             SET PS-ERROR               TO TRUE                   23307218
233073             DISPLAY ' RCVR: '                                    23307318
233074                     PV-DISP-OPER '-'                             23307418
233075                     PV-DISP-PO   '-'                             23307518
233076                     PV-DISP-RCVR '-'                             23307618
233077                     PV-DISP-LINE ' '                             23307718
233078                     '  TIME:'    PV-SHIFT-TIME                   23307818
233079             MOVE '5010-GET-SHIFT  '                              23307918
233080                                       TO PV-ABEND-PARAGRAPH      23308018
233081             MOVE 'GETTING SHIFT INFO' TO PV-ABEND-OPERATION      23308118
233082             MOVE 'PCT_SHFT'           TO PV-ABEND-STRUCTURE-1    23308218
233083             PERFORM 9900-DB2-ABEND                               23308318
233084     END-EVALUATE.                                                23308418
233085                                                                  23308518
233086                                                                  23308618
233087*----------------------------------------------------------------*23308718
233088*                                                                 23308818
233089*----------------------------------------------------------------*23308918
233090 5020-CHECK-OVERLAPPING-SHIFTS.                                   23309018
233091     IF  (PCT00004-SHFT-BEG-TM  < PC-END-TM AND                   23309118
233092          PCT00004-SHFT-END-TM  > PC-BEG-TM )                     23309218
233093            IF PV-SHIFT-TIME > PCT00004-SHFT-BEG-TM AND           23309318
233094               PV-SHIFT-TIME < PC-END-TM                          23309418
233095                  MOVE PV-CURR-CC        TO PC086-BUS-DTE-CC      23309518
233096                                            PV-KEY-CC             23309618
233097                  MOVE PV-CURR-YY        TO PC086-BUS-DTE-YY      23309718
233098                                            PV-KEY-YY             23309818
233099                  MOVE PV-CURR-MM        TO PC086-BUS-DTE-MM      23309918
233100                                            PV-KEY-MM             23310018
233101                  MOVE PV-CURR-DD        TO PC086-BUS-DTE-DD      23310118
233102                                            PV-KEY-DD             23310218
233103                 SET PS-DONE-CHECKING    TO TRUE                  23310318
233104            ELSE                                                  23310418
233105                 MOVE PV-BUSN-CC-PREV    TO PC086-BUS-DTE-CC      23310518
233106                                            PV-KEY-CC             23310618
233107                 MOVE PV-BUSN-YY-PREV    TO PC086-BUS-DTE-YY      23310718
233108                                            PV-KEY-YY             23310818
233109                 MOVE PV-BUSN-MM-PREV    TO PC086-BUS-DTE-MM      23310918
233110                                            PV-KEY-MM             23311018
233111                 MOVE PV-BUSN-DD-PREV    TO PC086-BUS-DTE-DD      23311118
233112                                            PV-KEY-DD             23311218
233113                 SET PS-DONE-CHECKING    TO TRUE                  23311318
233114            END-IF                                                23311418
233115     END-IF.                                                      23311518
233116                                                                  23311618
233117                                                                  23311718
233118*----------------------------------------------------------------*23311818
233119*                                                                 23311918
233120*----------------------------------------------------------------*23312018
233121 5030-SELECT-FISCAL-INFO.                                         23312118
233122     EXEC SQL                                                     23312218
233123         SELECT  FSCL_YR_NBR                                      23312318
233124              ,  FSCL_MN_NBR                                      23312418
233125              ,  FSCL_WK_NBR                                      23312518
233126              ,  WK_IN_MN_NBR                                     23312618
233127              ,  DAY_OF_WK_NBR                                    23312718
233128              ,  LY_THIS_DAY_KY_DTE                               23312818
233129              ,  FSCL_MN_BEG_DTE                                  23312918
233130              ,  FSCL_MN_END_DTE                                  23313018
233131              ,  FSCL_WK_BEG_DTE                                  23313118
233132              ,  FSCL_WK_END_DTE                                  23313218
233133           INTO :DTATTR-FSCL-YR-NBR                               23313318
233134              , :DTATTR-FSCL-MN-NBR                               23313418
233135              , :DTATTR-FSCL-WK-NBR                               23313518
233136              , :DTATTR-WK-IN-MN-NBR                              23313618
233137              , :DTATTR-DAY-OF-WK-NBR                             23313718
233138              , :DTATTR-LY-THIS-DAY-KY-DTE                        23313818
233139              , :DTATTR-FSCL-MN-BEG-DTE                           23313918
233140              , :DTATTR-FSCL-MN-END-DTE                           23314018
233141              , :DTATTR-FSCL-WK-BEG-DTE                           23314118
233142              , :DTATTR-FSCL-WK-END-DTE                           23314218
233143           FROM TDTATTR                                           23314318
233144          WHERE KY_DTE = :DK-BUS-DTE                              23314418
233145           WITH UR                                                23314518
233146     END-EXEC.                                                    23314618
233147                                                                  23314718
233148     EVALUATE TRUE                                                23314818
233149         WHEN SQLCODE = 0                                         23314918
233150              CONTINUE                                            23315018
233151         WHEN SQLWARN NOT = SPACE                                 23315118
233152         WHEN SQLCODE NOT = ZERO                                  23315218
233153             MOVE DK-OPER-UNT-ID TO  PV-DISP-OPER                 23315318
233154             MOVE PC086-ORD-NBR      TO PV-DISP-PO                23315418
233155             MOVE PC086-RCVR-SEQ-NBR TO PV-DISP-RCVR              23315518
233156             MOVE PC086-ORD-LNE-NBR  TO PV-DISP-LINE              23315618
233157             SET PS-ERROR               TO TRUE                   23315718
233158             DISPLAY ' RCVR: '                                    23315818
233159                     PV-DISP-OPER '-'                             23315918
233160                     PV-DISP-PO   '-'                             23316018
233161                     PV-DISP-RCVR '-'                             23316118
233162                     PV-DISP-LINE ' '                             23316218
233163                     '  DATE:'    DK-BUS-DTE                      23316318
233164             MOVE '5030-SELECT-FISCAL-INFO'                       23316418
233165                                       TO PV-ABEND-PARAGRAPH      23316518
233166             MOVE 'SELECT FISCAL INFORMATION'                     23316618
233167                                       TO PV-ABEND-OPERATION      23316718
233168             MOVE 'TDTATTR'            TO PV-ABEND-STRUCTURE-1    23316818
233169             PERFORM 9900-DB2-ABEND                               23316918
233170     END-EVALUATE.                                                23317018
233171                                                                  23317118
233172                                                                  23317218
233173*-----------------------------------------------------------------23317318
233174* GET RECEIVER TYPE                                               23317418
233175*-----------------------------------------------------------------23317518
233176 5040-SELECT-TRECEIV.                                             23317618
233177                                                                  23317718
233178     EXEC SQL                                                     23317818
233179          SELECT REC_TYP_CDE                                      23317918
233180            INTO :RECEIV-REC-TYP-CDE                              23318018
233181            FROM TRECEIV                                          23318118
233182           WHERE ORD_NBR             = :DK-PO-NBR                 23318218
233183             AND REC_SEQ_NBR         = :DK-RCVR-SEQ-NBR           23318318
233184            WITH UR                                               23318418
233185     END-EXEC.                                                    23318518
233186                                                                  23318618
233187     EVALUATE TRUE                                                23318718
233188         WHEN SQLCODE = ZERO                                      23318818
233189             CONTINUE                                             23318918
233190         WHEN SQLCODE = +100                                      23319018
233191         WHEN SQLCODE = -305                                      23319118
233192             MOVE SPACES TO RECEIV-REC-TYP-CDE                    23319218
233193                                                                  23319318
233194         WHEN SQLWARN0 NOT = SPACES                               23319418
233195         WHEN SQLCODE NOT EQUAL ZERO                              23319518
233196             MOVE DK-OPER-UNT-ID TO  PV-DISP-OPER                 23319618
233197             MOVE PC086-ORD-NBR      TO PV-DISP-PO                23319718
233198             MOVE PC086-RCVR-SEQ-NBR TO PV-DISP-RCVR              23319818
233199             MOVE PC086-ORD-LNE-NBR  TO PV-DISP-LINE              23319918
233200             SET PS-ERROR TO TRUE                                 23320018
233201             DISPLAY ' RCVR: '                                    23320118
233202                     PV-DISP-OPER '-'                             23320218
233203                     PV-DISP-PO   '-'                             23320318
233204                     PV-DISP-RCVR '-'                             23320418
233205                     PV-DISP-LINE ' '                             23320518
233206                     '  TIME:'    PV-SHIFT-TIME                   23320618
233207             MOVE '5040-SELECT-TRECEIV'                           23320718
233208                                       TO PV-ABEND-PARAGRAPH      23320818
233209             MOVE 'RECEIVER TYPE     ' TO PV-ABEND-OPERATION      23320918
233210             MOVE 'TRECEIV '           TO PV-ABEND-STRUCTURE-1    23321018
233211             PERFORM 9900-DB2-ABEND                               23321118
233212     END-EVALUATE.                                                23321218
233213                                                                  23321318
233214                                                                  23321418
233215*----------------------------------------------------------------*23321518
233216*    CHECK THE PARM VALUE TO FIND WHICH RECEIVER TYPES WILL       23321618
233217*    BYPASS POSTING UNITS WORKED                                  23321718
233218*----------------------------------------------------------------*23321818
233219 5050-TKRPRPM-RCVR-TYPES.                                         23321918
233220                                                                  23322018
233221     SET  PS-POST-UNITS-WORKED-NO   TO  TRUE.                     23322118
233222                                                                  23322218
233223     EXEC SQL                                                     23322318
233224          SELECT  FUNC_TXT                                        23322418
233225            INTO :PV-UWBYPS-FUNC-TXT                              23322518
233226            FROM  TKRPRPM                                         23322618
233227           WHERE  SYS_PRC_FUNC_CDE  = 'UWBYPS'                    23322718
233228             AND  LOC_ID            =  090                        23322818
233229             AND  INTFC_SYS_CDE     = 'KHL'                       23322918
233230             AND  FUNC_PRC_STAT_CDE = 'AC'                        23323018
233231            WITH UR                                               23323118
233232     END-EXEC.                                                    23323218
233233                                                                  23323318
233234     EVALUATE TRUE                                                23323418
233235         WHEN SQLCODE = +0                                        23323518
233236              DISPLAY ' PARM: UWBYPS  '                           23323618
233237                       PV-UWBYPS-FUNC-TXT                         23323718
233255         WHEN SQLCODE = +100                                      23325505
233256                  SET PS-POST-UNITS-WORKED-YES TO TRUE            23325605
233257         WHEN SQLWARN NOT = SPACE                                 23325705
233258         WHEN SQLCODE NOT = ZERO                                  23325805
233259             MOVE DK-OPER-UNT-ID TO  PV-DISP-OPER                 23325905
233260             MOVE PC086-ORD-NBR      TO PV-DISP-PO                23326005
233261             MOVE PC086-RCVR-SEQ-NBR TO PV-DISP-RCVR              23326105
233262             MOVE PC086-ORD-LNE-NBR  TO PV-DISP-LINE              23326205
233263             SET PS-ERROR               TO TRUE                   23326305
233264             DISPLAY ' RCVR: '                                    23326405
233265                     PV-DISP-OPER '-'                             23326505
233266                     PV-DISP-PO   '-'                             23326605
233267                     PV-DISP-RCVR '-'                             23326705
233268                     PV-DISP-LINE ' '                             23326805
233269                     '  DATE:'    DK-BUS-DTE                      23326905
233270             MOVE '5050-TKRPRPM-RCVR-TYPES'                       23327005
233271                                       TO PV-ABEND-PARAGRAPH      23327105
233272             MOVE 'PARM:  UWBYPS            '                     23327205
233273                                       TO PV-ABEND-OPERATION      23327305
233274             MOVE 'TKRPRPM'            TO PV-ABEND-STRUCTURE-1    23327405
233275             PERFORM 9900-DB2-ABEND                               23327505
233276     END-EVALUATE.                                                23327605
233277                                                                  23327705
233278                                                                  23327805
233279 5060-SELECT-RETAIL-PRICE.                                        23327906
233280                                                                  23328006
233281     EXEC SQL                                                     23328106
233282          SELECT  B.UNT_RTL_PR_AMT                                23328220
233283               ,  A.VERFYD_TMST                                   23328320
233284            INTO :PURITM-UNT-RTL-PR-AMT                           23328420
233285               , :RECITM-VERFYD-TMST                              23328522
233286            FROM  TRECITM A                                       23328620
233287               ,  TPURITM B                                       23328720
233288           WHERE  A.ORD_NBR           = :DK-PO-NBR                23328820
233289             AND  A.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR          23328920
233290             AND  A.ORD_LNE_NBR       = :DK-PO-LINE-NBR           23329020
233291             AND  A.ORD_NBR           = B.PO_NBR                  23329120
233292             AND  A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR          23329220
233293             AND  A.PO_VER_NBR        = B.VER_NBR                 23329320
233294            WITH UR                                               23329420
233295     END-EXEC.                                                    23329520
233296                                                                  23329620
233297     EVALUATE TRUE                                                23329720
233298         WHEN SQLCODE = ZERO                                      23329820
233299             MOVE PURITM-UNT-RTL-PR-AMT   TO PC086-UNT-RETAIL-PRC 23329920
233300             MULTIPLY PURITM-UNT-RTL-PR-AMT                       23330020
233301                   BY PC086-PICKED-QTY                            23330120
233302               GIVING PC086-EXTD-RTL-AMT                          23330220
233303         WHEN SQLWARN NOT = SPACE                                 23330320
233304         WHEN SQLCODE NOT = ZERO                                  23330420
233305             MOVE DK-OPER-UNT-ID TO  PV-DISP-OPER                 23330520
233306             MOVE PC086-ORD-NBR      TO PV-DISP-PO                23330620
233307             MOVE PC086-RCVR-SEQ-NBR TO PV-DISP-RCVR              23330720
233308             MOVE PC086-ORD-LNE-NBR  TO PV-DISP-LINE              23330820
233309             SET PS-ERROR               TO TRUE                   23330920
233310             DISPLAY ' RCVR: '                                    23331020
233311                     PV-DISP-OPER '-'                             23331120
233312                     PV-DISP-PO   '-'                             23331220
233313                     PV-DISP-RCVR '-'                             23331320
233314                     PV-DISP-LINE ' '                             23331420
233315                     '  DATE:'    DK-BUS-DTE                      23331520
233316             MOVE '5060-SELECT-RETAIL-PRICE'                      23331620
233317                                       TO PV-ABEND-PARAGRAPH      23331720
233318             MOVE 'GET UNIT RETAIL          '                     23331820
233319                                       TO PV-ABEND-OPERATION      23331920
233320             MOVE 'TRECITM'            TO PV-ABEND-STRUCTURE-1    23332020
233321             MOVE 'TPURITM'            TO PV-ABEND-STRUCTURE-2    23332120
233322             PERFORM 9900-DB2-ABEND                               23332220
233330     END-EVALUATE.                                                23333006
233341                                                                  23334106
233342                                                                  23334206
233343*-----------------------------------------------------------------23334306
233344*                                                                 23334406
233345*-----------------------------------------------------------------23334506
233346 7000-READ-INPUT.                                                 23334606
233347                                                                  23334706
233348     READ PICKMADE-EXTRACT-IN INTO                                23334809
233349           PC086-EXPORT-RECORD-LAYOUT                             23334906
233350           AT END                                                 23335006
233351              SET  PS-EOF  TO TRUE                                23335106
233352           NOT AT END                                             23335206
233353              ADD 1 TO PV-EVENT-INPUT-COUNT.                      23335308
233354                                                                  23335406
233355                                                                  23335506
233356*-----------------------------------------------------------------23335606
233357*                                                                 23335706
233358*-----------------------------------------------------------------23335806
233359 8000-WRITE-EXTRACT-REC.                                          23335906
233360                                                                  23336003
233400     ADD 1 TO PV-EVENT-OUTPUT-COUNT                               23340008
233500     WRITE PICKMADE-RECORD-OUT  FROM                              23350009
233600           PC086-EXPORT-RECORD-LAYOUT.                            23360003
233700                                                                  23370003
233701                                                                  23370108
233702*-----------------------------------------------------------------23370208
233703*                                                                 23370308
233704*-----------------------------------------------------------------23370408
233710 9000-TERMINATE.                                                  23371008
233720                                                                  23372008
233750     CLOSE PICKMADE-EXTRACT-IN.                                   23375009
233751     CLOSE PICKMADE-EXTRACT-OUT.                                  23375109
237501                                                                  23750108
237502     IF  PV-EVENT-OUTPUT-COUNT = 0                                23750210
237503         MOVE 1 TO RETURN-CODE                                    23750308
237504     END-IF.                                                      23750408
237505                                                                  23750508
237506     DISPLAY SPACES                                               23750608
237507                                                                  23750708
237508     MOVE PV-EVENT-INPUT-COUNT         TO PV-DISP-COUNT.          23750810
237509     DISPLAY 'TOTAL BUS EVENTS FETCHED       = ' PV-DISP-COUNT.   23750910
237510                                                                  23751008
237511     MOVE PV-EVENT-BYPASS-COUNT        TO PV-DISP-COUNT.          23751110
237512     DISPLAY 'TOTAL AP/CR RECORDS BYPASSED   = ' PV-DISP-COUNT.   23751231
237513                                                                  23751308
237514     MOVE PV-PICK-BEFORE-VE-CNT        TO PV-DISP-COUNT.          23751425
237515     DISPLAY 'TOTAL BYPASS PICKED BEFORE VE  = ' PV-DISP-COUNT.   23751520
237516                                                                  23751620
237517     MOVE PV-EVENT-OUTPUT-COUNT        TO PV-DISP-COUNT.          23751710
237518     DISPLAY 'TOTAL EXTRACT RECORDS WRITTEN  = ' PV-DISP-COUNT.   23751810
237519                                                                  23751908
237520     DISPLAY SPACES                                               23752008
237521     DISPLAY '************************'.                          23752108
237522                                                                  23752208
237523                                                                  23752308
237524*-----------------------------------------------------------------23752408
237530*                                                                 23753008
237600*-----------------------------------------------------------------23760008
255800 9900-DB2-ABEND.                                                  25580003
255900                                                                  25590003
256000     MOVE SQLCODE TO PV-SQLCODE.                                  25600003
256100     DISPLAY '*** DB2 ERROR '.                                    25610003
256200     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       25620003
256300     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 25630003
256400     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               25640003
256500     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               25650003
256600     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       25660003
256700     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       25670003
256800     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-3.       25680003
256900     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             25690003
257000                                                                  25700003
257100                                                                  25710003
257200     COPY DPPD004.                                                25720003
257300                                                                  25730003
257400     MOVE +4013                  TO PV-ABEND-CODE.                25740003
257500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         25750003
257600                                                                  25760003
