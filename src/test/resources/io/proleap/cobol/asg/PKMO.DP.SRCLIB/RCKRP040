000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    RCKRP040.                                         00020000
000300 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00030000
000400 DATE-WRITTEN.  MAY 2005.                                         00040000
000500 DATE-COMPILED.                                                   00050000
000600                                                                  00060000
000700******************************************************************00070000
000800*PURPOSE:                                                         00080000
000900* THIS REPORT LISTS DATA ON VERIFIED, OR POST VERIFIED ADJUSTED   00090000
001000* RECEIVERS BASED ON SELECT RECEIVER TYPES.  THE DETAIL IS BY     00100000
001100* PO/RECEIVER/LINE DOWN TO THE STORE LEVEL.                       00110000
001200******************************************************************00120000
001300                                                                  00130000
001400 ENVIRONMENT DIVISION.                                            00140000
001500 CONFIGURATION SECTION.                                           00150000
001600 SOURCE-COMPUTER.        IBM-3090.                                00160000
001700 OBJECT-COMPUTER.        IBM-3090.                                00170000
001800 INPUT-OUTPUT SECTION.                                            00180000
001900 FILE-CONTROL.                                                    00190000
002000                                                                  00200000
002100     SELECT STORE-EXTRACT-FILE                                    00210000
002200         ASSIGN TO INP01.                                         00220000
002300                                                                  00230000
002400     SELECT VERIFIED-RECEIPTS-RPT                                 00240000
002500         ASSIGN TO RPT01.                                         00250000
002600                                                                  00260000
002700 DATA DIVISION.                                                   00270000
002800 FILE SECTION.                                                    00280000
002900                                                                  00290000
003000 FD  STORE-EXTRACT-FILE                                           00300000
003100     RECORDING MODE IS F                                          00310000
003200     LABEL RECORDS ARE STANDARD                                   00320000
003300     BLOCK CONTAINS 0 RECORDS                                     00330000
003400     RECORD CONTAINS 300 CHARACTERS                               00340000
003500     DATA RECORD IS STORE-EXTRACT-RECORD.                         00350000
003600                                                                  00360000
003700 01  STORE-EXTRACT-RECORD        PIC X(300).                      00370000
003800                                                                  00380000
003900 FD  VERIFIED-RECEIPTS-RPT                                        00390000
004000     RECORDING MODE IS F                                          00400000
004100     LABEL RECORDS ARE STANDARD                                   00410000
004200     BLOCK CONTAINS 0 RECORDS                                     00420000
004300     RECORD CONTAINS 132 CHARACTERS                               00430000
004400     DATA RECORD IS VERIFIED-RECEIPTS-LINE.                       00440000
004500                                                                  00450000
004600 01  VERIFIED-RECEIPTS-LINE      PIC X(132).                      00460000
004700                                                                  00470000
004800/*****************************************************************00480000
004900 WORKING-STORAGE SECTION.                                         00490000
005000******************************************************************00500000
005100                                                                  00510000
005200 01  ABEND-CODE             PIC S9(4) COMP SYNC VALUE ZERO.       00520000
005300                                                                  00530000
005400 01  PS-PROGRAM-SWITCHES.                                         00540000
005500     05  PS-END-OF-EXTRACT-FILE-IND PIC X(01) VALUE 'N'.          00550000
005600         88  PS-NOT-END-OF-EXTRACT-FILE       VALUE 'N'.          00560000
005700         88  PS-END-OF-EXTRACT-FILE           VALUE 'Y'.          00570000
005800     05  PS-LAST-PAGE-OF-RPT-IND  PIC X(1)    VALUE 'N'.          00580000
005900         88  PS-NOT-LAST-PAGE                 VALUE 'N'.          00590000
006000         88  PS-LAST-PAGE                     VALUE 'Y'.          00600000
006100     05  PS-FIRST-LINE-ON-RPT-IND  PIC X(1)   VALUE 'N'.          00610000
006200         88  PS-NOT-FIRST-LINE                VALUE 'N'.          00620000
006300         88  PS-FIRST-LINE                    VALUE 'Y'.          00630000
006400     05  PS-PRINT-SW              PIC X(1)    VALUE 'D'.          00640000
006500         88  PS-PRINT-DETAIL                  VALUE 'D'.          00650000
006600         88  PS-PRINT-TOTAL                   VALUE 'T'.          00660000
006700                                                                  00670000
006800 01  PC-PROGRAM-CONSTANTS.                                        00680000
006900     05  PC-MAX-RETRIES          PIC S9(04) VALUE  +3             00690000
007000                                 COMP SYNC.                       00700000
007100     05  PC-PAGE-SIZE            PIC S9(4)    VALUE +60           00710000
007200                                 COMP SYNC.                       00720000
007300     05  PC-DEFAULT-DTE          PIC X(10)    VALUE '9999-09-09'. 00730000
007400                                                                  00740000
007500 01  PV-PROGRAM-VARIABLES.                                        00750000
007600     05  PV-NULL-IND             PIC S9(04)  VALUE ZEROS          00760000
007700                                 COMP SYNC.                       00770000
007800     05  PV-RETRY-COUNTER        PIC S9(04) VALUE +0              00780000
007900                                 COMP SYNC.                       00790000
008000     05  PV-LINE-COUNT           PIC S9(4)    VALUE +53           00800000
008100                                 COMP SYNC.                       00810000
008200     05  PV-NBR-OF-LINES         PIC S9(3)    VALUE ZERO          00820000
008300                                 COMP-3.                          00830000
008400     05  PV-PAGE-COUNT           PIC S9(5)    VALUE ZERO          00840000
008500                                 COMP-3.                          00850000
008600     05  PV-SKU-NBR              PIC  9(08).                      00860000
008700     05  PV-VE-UNITS             PIC S9(07)                       00870000
008800                                 COMP-3.                          00880000
008900     05  PV-UNIT-COST            PIC S9(05)V99                    00890000
009000                                 COMP-3.                          00900000
009100     05  PV-EXTENDED-COST        PIC S9(09)V99                    00910000
009200                                 COMP-3.                          00920000
009300     05  PV-EXTENDED-RETAIL      PIC S9(09)V99                    00930000
009400                                 COMP-3.                          00940000
009500     05  PV-TOT-VE-UNITS-SKU     PIC S9(07)   VALUE ZERO          00950000
009600                                 COMP-3.                          00960000
009700     05  PV-TOT-VE-UNITS-PO-RCVR PIC S9(07)   VALUE ZERO          00970000
009800                                 COMP-3.                          00980000
009900     05  PV-TOT-VE-UNITS-DEPT    PIC S9(07)   VALUE ZERO          00990000
010000                                 COMP-3.                          01000000
010100     05  PV-TOT-VE-UNITS-FINAL   PIC S9(07)   VALUE ZERO          01010000
010200                                 COMP-3.                          01020000
010300     05  PV-TOT-EXT-COST-SKU     PIC S9(11)V99                    01030000
010400                                              VALUE ZERO          01040000
010500                                 COMP-3.                          01050000
010600     05  PV-TOT-EXT-COST-PO-RCVR PIC S9(11)V99                    01060000
010700                                              VALUE ZERO          01070000
010800                                 COMP-3.                          01080000
010900     05  PV-TOT-EXT-COST-DEPT    PIC S9(11)V99                    01090000
011000                                              VALUE ZERO          01100000
011100                                 COMP-3.                          01110000
011200     05  PV-TOT-EXT-COST-FINAL   PIC S9(11)V99                    01120000
011300                                              VALUE ZERO          01130000
011400                                 COMP-3.                          01140000
011500     05  PV-TOT-EXT-RETAIL-SKU   PIC S9(11)V99                    01150000
011600                                              VALUE ZERO          01160000
011700                                 COMP-3.                          01170000
011800     05  PV-TOT-EXT-RETAIL-PO-RCVR                                01180000
011900                                 PIC S9(11)V99                    01190000
012000                                              VALUE ZERO          01200000
012100                                 COMP-3.                          01210000
012200     05  PV-TOT-EXT-RETAIL-DEPT  PIC S9(11)V99                    01220000
012300                                              VALUE ZERO          01230000
012400                                 COMP-3.                          01240000
012500     05  PV-TOT-EXT-RETAIL-FINAL PIC S9(11)V99                    01250000
012600                                              VALUE ZERO          01260000
012700                                 COMP-3.                          01270000
012800     05  PV-RPT-LINE-SEQ         PIC 9(5)     VALUE ZERO          01280000
012900                                 COMP-3.                          01290000
013000                                                                  01300000
013100     05  PV-HOLD-LINE-NBR        PIC 9(04).                       01310000
013200     05  PV-HOLD-REC-SEQ-NBR     PIC 9(09).                       01320000
013300     05  PV-HOLD-PO-NBR          PIC 9(08).                       01330000
013400     05  PV-HOLD-DEPT-NBR        PIC 9(04).                       01340000
013500                                                                  01350000
013600     05  PV-PARAGRAPH-NAME       PIC X(30)    VALUE SPACES.       01360000
013700     05  PV-DB2-OPERATION-ATTEMPTED                               01370000
013800                                 PIC X(30)    VALUE SPACES.       01380000
013900     05  PV-DATA                 PIC 9(09).                       01390000
014000     05  PV-DATE-WITH-DASHES.                                     01400000
014100         10  PV-YYYY-WITH-DASHES PIC X(4).                        01410000
014200         10  FILLER              PIC X(1).                        01420000
014300         10  PV-MM-WITH-DASHES   PIC X(2).                        01430000
014400         10  FILLER              PIC X(1).                        01440000
014500         10  PV-DD-WITH-DASHES   PIC X(2).                        01450000
014600                                                                  01460000
014700 01  CD-RECEIVER-TYPE-DATA.                                       01470000
014800     05  FILLER                  PIC X(11).                       01480000
014900     05  CD-RECEIVER-TYPE-DESC   PIC X(35).                       01490000
015000                                                                  01500000
015100 01  CD-CURRENT-DATE.                                             01510000
015200     05  CD-CURRENT-YEAR         PIC 9(2)     VALUE ZERO.         01520000
015300     05  CD-CURRENT-MONTH        PIC 9(2)     VALUE ZERO.         01530000
015400     05  CD-CURRENT-DAY          PIC 9(2)     VALUE ZERO.         01540000
015500                                                                  01550000
015600 01  CD-CCYYMMDD-HOLD.                                            01560000
015700     05  CD-CCYYMMDD-HOLD-CC     PIC 9(2)     VALUE ZERO.         01570000
015800     05  CD-CCYYMMDD-HOLD-YY     PIC 9(2)     VALUE ZERO.         01580000
015900     05  CD-CCYYMMDD-HOLD-MM     PIC 9(2)     VALUE ZERO.         01590000
016000     05  CD-CCYYMMDD-HOLD-DD     PIC 9(2)     VALUE ZERO.         01600000
016100                                                                  01610000
016200 01  CT-CURRENT-TIME.                                             01620000
016300     05  CT-CURRENT-HOUR         PIC 9(2)     VALUE ZERO.         01630000
016400     05  CT-CURRENT-MINUTE       PIC 9(2)     VALUE ZERO.         01640000
016500     05  FILLER                  PIC 9(4)     VALUE ZERO.         01650000
016600                                                                  01660000
016700 01  HEADING-LINE-1.                                              01670000
016800     05  FILLER                  PIC X(31)    VALUE SPACES.       01680000
016900     05  FILLER                  PIC X(37)    VALUE               01690000
017000         'DETAIL LISTING OF UNITS VERIFIED FOR '.                 01700000
017100     05  HL1-RECEIVER-TYPE-DESC  PIC X(35).                       01710000
017200     05  FILLER                  PIC X(30)    VALUE SPACES.       01720000
017300                                                                  01730000
017400 01  HEADING-LINE-2.                                              01740000
017500     05  FILLER                  PIC X(52)    VALUE SPACES.       01750000
017600     05  FILLER                  PIC X(19)    VALUE               01760000
017700         'PROCESSING DATE OF '.                                   01770000
017800     05  HL2-PROCESS-MM          PIC X(02).                       01780000
017900     05  FILLER                  PIC X(01)    VALUE               01790000
018000         '/'.                                                     01800000
018100     05  HL2-PROCESS-DD          PIC X(02).                       01810000
018200     05  FILLER                  PIC X(01)    VALUE               01820000
018300         '/'.                                                     01830000
018400     05  HL2-PROCESS-YYYY        PIC X(04).                       01840000
018500     05  FILLER                  PIC X(51)    VALUE SPACES.       01850000
018600                                                                  01860000
018700 01  HEADING-LINE-3.                                              01870000
018800     05  FILLER                  PIC X(01)    VALUE SPACES.       01880000
018900     05  FILLER                  PIC X(23)    VALUE               01890000
019000         'DEPARTMENT NUMBER:     '.                               01900000
019100     05  HL3-DEPT-NBR            PIC ZZZ9.                        01910000
019200     05  FILLER                  PIC X(03)    VALUE               01920000
019300         ' - '.                                                   01930000
019400     05  HL3-DEPT-NAME           PIC X(20)    VALUE SPACES.       01940000
019500     05  FILLER                  PIC X(81)    VALUE SPACES.       01950000
019600                                                                  01960000
019700 01  HEADING-LINE-4.                                              01970000
019800     05  FILLER                  PIC X(01)    VALUE SPACES.       01980000
019900     05  FILLER                  PIC X(14)    VALUE               01990000
020000         'PO/RECEIVER:  '.                                        02000000
020100     05  HL4-PO-NBR              PIC ZZZZZZZZ9.                   02010000
020200     05  FILLER                  PIC X(01)    VALUE               02020000
020300         '-'.                                                     02030000
020400     05  HL4-REC-SEQ-NBR         PIC 9(04).                       02040000
020500     05  FILLER                  PIC X(10)    VALUE               02050000
020600         ' (BY DC:  '.                                            02060000
020700     05  HL4-CURR-OPER-UNIT-ID   PIC ZZZ9.                        02070000
020800     05  FILLER                  PIC X(22)    VALUE               02080000
020900         ')     VERIFIED DATE:  '.                                02090000
021000     05  HL4-VE-MM               PIC X(02).                       02100000
021100     05  FILLER                  PIC X(01)    VALUE               02110000
021200         '/'.                                                     02120000
021300     05  HL4-VE-DD               PIC X(02).                       02130000
021400     05  FILLER                  PIC X(03)    VALUE               02140000
021500         '/20'.                                                   02150000
021600     05  HL4-VE-YY               PIC X(02).                       02160000
021700     05  FILLER                  PIC X(08)    VALUE               02170000
021800         '  (BY:  '.                                              02180000
021900     05  HL4-VRFD-USR-ID         PIC X(08).                       02190000
022000     05  FILLER                  PIC X(29)    VALUE               02200000
022100         ')     CANCEL NOT SHIP DATE:  '.                         02210000
022200     05  HL4-CANCEL-MM           PIC X(02).                       02220000
022300     05  FILLER                  PIC X(01)    VALUE               02230000
022400         '/'.                                                     02240000
022500     05  HL4-CANCEL-DD           PIC X(02).                       02250000
022600     05  FILLER                  PIC X(01)    VALUE               02260000
022700         '/'.                                                     02270000
022800     05  HL4-CANCEL-YYYY         PIC X(04).                       02280000
022900     05  FILLER                  PIC X(02)    VALUE SPACES.       02290000
023000                                                                  02300000
023100                                                                  02310000
023200 01  HEADING-LINE-5.                                              02320000
023300     05  FILLER                  PIC X(01)    VALUE SPACES.       02330000
023400     05  FILLER                  PIC X(14)    VALUE               02340000
023500         'VENDOR NAME:  '.                                        02350000
023600     05  HL5-VENDOR-NAME         PIC X(25).                       02360000
023700     05  FILLER                  PIC X(25)    VALUE               02370000
023800         '          PACKAGE TYPE:  '.                             02380000
023900     05  HL5-PKGNG-CDE           PIC X(01).                       02390000
024000     05  FILLER                  PIC X(02)    VALUE               02400000
024100         ' ('.                                                    02410000
024200     05  HL5-PKGNG-CDE-DESC      PIC X(18).                       02420000
024300     05  FILLER                  PIC X(34)    VALUE               02430000
024400         ')                   VERIFY TYPE:  '.                    02440000
024500     05  HL5-VE-TYPE             PIC X(10).                       02450000
024600     05  FILLER                  PIC X(02)    VALUE SPACES.       02460000
024700                                                                  02470000
024800 01  HEADING-LINE-6.                                              02480000
024900     05  FILLER                  PIC X(01)    VALUE SPACES.       02490000
025000     05  FILLER                  PIC X(04)    VALUE               02500000
025100         'LINE'.                                                  02510000
025200     05  FILLER                  PIC X(24)    VALUE SPACES.       02520000
025300     05  FILLER                  PIC X(31)    VALUE               02530000
025400         'MAJOR/SUB  STORE   ACTUAL      '.                       02540000
025500     05  FILLER                  PIC X(30)    VALUE               02550000
025600         ' NEXT     VERIFIED    UNIT    '.                        02560000
025700     05  FILLER                  PIC X(42)    VALUE               02570000
025800         'LOWEST        EXTENDED         EXTENDED'.               02580000
025900                                                                  02590000
026000 01  HEADING-LINE-7.                                              02600000
026100     05  FILLER                  PIC X(01)    VALUE SPACES.       02610000
026200     05  FILLER                  PIC X(28)    VALUE               02620000
026300         ' NBR  SKU NBR   SKU STATUS  '.                          02630000
026400     05  FILLER                  PIC X(30)    VALUE               02640000
026500         '  CLASS     NBR   INV DATE    '.                        02650000
026600     05  FILLER                  PIC X(31)    VALUE               02660000
026700         'INV DATE    UNITS      COST    '.                       02670000
026800     05  FILLER                  PIC X(41)    VALUE               02680000
026900         'RETAIL          COST            RETAIL '.               02690000
027000                                                                  02700000
027100 01  DETAIL-LINE.                                                 02710000
027200     05  FILLER                  PIC X(01)    VALUE SPACES.       02720000
027300     05  DL-LINE-NBR             PIC Z999.                        02730000
027400     05  DL-LINE-NBR-X REDEFINES DL-LINE-NBR                      02740000
027500                                 PIC X(04).                       02750000
027600     05  FILLER                  PIC X(02)    VALUE SPACES.       02760000
027700     05  DL-SKU-NBR              PIC X(08).                       02770000
027800     05  FILLER                  PIC X(02)    VALUE SPACES.       02780000
027900     05  DL-SKU-STAT-DESC        PIC X(10).                       02790000
028000     05  FILLER                  PIC X(02)    VALUE SPACES.       02800000
028100     05  DL-MAJ-CLASS-NBR        PIC 9(04).                       02810000
028200     05  DL-MAJ-CLASS-NBR-X REDEFINES DL-MAJ-CLASS-NBR            02820000
028300                                 PIC X(04).                       02830000
028400     05  DL-SLASH                PIC X(01).                       02840000
028500     05  DL-SUB-CLASS-NBR        PIC 9(04).                       02850000
028600     05  DL-SUB-CLASS-NBR-X REDEFINES DL-SUB-CLASS-NBR            02860000
028700                                 PIC X(04).                       02870000
028800     05  FILLER                  PIC X(02)    VALUE SPACES.       02880000
028900     05  DL-STORE-NBR            PIC ZZZ9.                        02890000
029000     05  FILLER                  PIC X(02)    VALUE SPACES.       02900000
029100     05  DL-FLUSH-MM             PIC X(02).                       02910000
029200     05  FILLER                  PIC X(01)    VALUE               02920000
029300         '/'.                                                     02930000
029400     05  DL-FLUSH-DD             PIC X(02).                       02940000
029500     05  FILLER                  PIC X(01)    VALUE               02950000
029600         '/'.                                                     02960000
029700     05  DL-FLUSH-YYYY           PIC X(04).                       02970000
029800     05  FILLER                  PIC X(02)    VALUE SPACES.       02980000
029900     05  DL-NEXT-MM              PIC X(02).                       02990000
030000     05  FILLER                  PIC X(01)    VALUE               03000000
030100         '/'.                                                     03010000
030200     05  DL-NEXT-DD              PIC X(02).                       03020000
030300     05  FILLER                  PIC X(01)    VALUE               03030000
030400         '/'.                                                     03040000
030500     05  DL-NEXT-YYYY            PIC X(04).                       03050000
030600     05  FILLER                  PIC X(02)    VALUE SPACES.       03060000
030700     05  DL-VE-UNITS             PIC ZZZ,ZZ9-.                    03070000
030800     05  FILLER                  PIC X(02)    VALUE SPACES.       03080000
030900     05  DL-UNIT-COST            PIC Z,ZZ9.99.                    03090000
031000     05  FILLER                  PIC X(01)    VALUE SPACES.       03100000
031100     05  DL-LOWEST-RETAIL        PIC ZZ,ZZ9.99.                   03110000
031200     05  FILLER                  PIC X(02)    VALUE SPACES.       03120000
031300     05  DL-EXTENDED-COST        PIC ZZZ,ZZZ,ZZ9.99-.             03130000
031400     05  FILLER                  PIC X(02)    VALUE SPACES.       03140000
031500     05  DL-EXTENDED-RETAIL      PIC ZZZ,ZZZ,ZZ9.99-.             03150000
031600                                                                  03160000
031700 01  TOTAL-LINE.                                                  03170000
031800     05  FILLER                  PIC X(38)    VALUE SPACES.       03180000
031900     05  TL-TOTAL-TYPE-DESC      PIC X(20).                       03190000
032000     05  FILLER                  PIC X(10)    VALUE SPACES.       03200000
032100     05  TL-VE-UNITS             PIC Z,ZZZ,ZZ9.                   03210000
032200     05  FILLER                  PIC X(21)    VALUE SPACES.       03220000
032300     05  TL-EXTENDED-COST        PIC Z,ZZZ,ZZZ,ZZ9.99-.           03230000
032400     05  TL-EXTENDED-RETAIL      PIC Z,ZZZ,ZZZ,ZZZ.99-            03240000
032500                                              VALUE ZEROES.       03250000
032600                                                                  03260000
032700 01  END-OF-REPORT-LINE.                                          03270000
032800     05  FILLER                  PIC X(56)    VALUE SPACES.       03280000
032900     05  FILLER                  PIC X(20)    VALUE               03290000
033000         ' ** END OF REPORT **'.                                  03300000
033100     05  FILLER                  PIC X(56)    VALUE SPACES.       03310000
033200                                                                  03320000
033300 01  EMPTY-INPUT-LINE.                                            03330000
033400     05  FILLER                  PIC X(27)    VALUE SPACES.       03340000
033500     05  FILLER                  PIC X(14)    VALUE               03350000
033600         'THERE WERE NO '.                                        03360000
033700     05  EI-RECEIVER-TYPE-DESC   PIC X(35).                       03370000
033800     05  FILLER                  PIC X(27)    VALUE               03380000
033900         'TO REPORT ON FOR THIS RUN. '.                           03390000
034000     05  FILLER                  PIC X(29)    VALUE SPACES.       03400000
034100                                                                  03410000
034200/*****************************************************************03420000
034300*  FILE LAYOUT FOR STORE EXTRACT DATA                             03430000
034400******************************************************************03440000
034500     COPY STOREEXT.                                               03450000
034600                                                                  03460000
034700******************************************************************03470000
034800** COPYBOOK USED FOR CALLED MODULE XLKUT004                       03480000
034900******************************************************************03490000
035000     COPY XLWS004.                                                03500000
035100                                                                  03510000
035200/*****************************************************************03520000
035300*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT                 03530000
035400******************************************************************03540000
035500     COPY DPWS132O.                                               03550000
035600                                                                  03560000
035700/*****************************************************************03570000
035800*  DB2 ERROR MESSAGES FORMAT AREA.                                03580000
035900******************************************************************03590000
036000     COPY DPWS004.                                                03600000
036100                                                                  03610000
036200******************************************************************03620000
036300*  USED FOR DB2 ERRORS                                            03630000
036400******************************************************************03640000
036500     EXEC SQL                                                     03650000
036600         INCLUDE SQLCA                                            03660000
036700     END-EXEC.                                                    03670000
036800                                                                  03680000
036900******************************************************************03690000
037000*  LAYOUT USED FOR COMPANY CONTROL TABLE                          03700000
037100******************************************************************03710000
037200     EXEC SQL                                                     03720000
037300         INCLUDE TCOCNTL                                          03730000
037400     END-EXEC.                                                    03740000
037500                                                                  03750000
037600******************************************************************03760000
037700*  LAYOUT USED FOR XLT_SKU                                        03770000
037800******************************************************************03780000
037900     EXEC SQL                                                     03790000
038000         INCLUDE XLT00003                                         03800000
038100     END-EXEC.                                                    03810000
038200                                                                  03820000
038300******************************************************************03830000
038400*  LAYOUT USED FOR XLT_VND_STYL                                   03840000
038500******************************************************************03850000
038600     EXEC SQL                                                     03860000
038700         INCLUDE XLT00004                                         03870000
038800     END-EXEC.                                                    03880000
038900                                                                  03890000
039000******************************************************************03900000
039100*  LAYOUT FOR THE INVENTORY PARAMETER TABLE                       03910000
039200*  XLT_MDSE_INV_PARM                                              03920000
039300******************************************************************03930000
039400     EXEC SQL                                                     03940000
039500          INCLUDE XLT00025                                        03950000
039600     END-EXEC.                                                    03960000
039700                                                                  03970000
039800******************************************************************03980000
039900* DB2 - RECEIVING                                                 03990000
040000******************************************************************04000000
040100     EXEC SQL                                                     04010000
040200         INCLUDE TRECEIV                                          04020000
040300     END-EXEC.                                                    04030000
040400                                                                  04040000
040500***************************************************************** 04050000
040600*    DB2 AREA FOR THE PLANNED SHIPMENTS TABLE              4     *04060000
040700***************************************************************** 04070000
040800     EXEC SQL                                                     04080000
040900          INCLUDE TPLNSHP                                         04090000
041000     END-EXEC.                                                    04100000
041100/*****************************************************************04110000
041200******************************************************************04120000
041300 PROCEDURE DIVISION.                                              04130000
041400******************************************************************04140000
041500                                                                  04150000
041600 0000-MAINLINE.                                                   04160000
041700                                                                  04170000
041800     PERFORM 1000-INITIALIZE.                                     04180000
041900                                                                  04190000
042000     IF PS-NOT-END-OF-EXTRACT-FILE                                04200000
042100         PERFORM 2000-PROCESS-EXTRACT                             04210000
042200            UNTIL PS-END-OF-EXTRACT-FILE                          04220000
042300         SET PS-PRINT-TOTAL TO TRUE                               04230000
042400         ADD +5             TO PV-LINE-COUNT                      04240000
042500         MOVE '        SKU TOTAL:  '                              04250000
042600                            TO TL-TOTAL-TYPE-DESC                 04260000
042700         MOVE PV-TOT-VE-UNITS-SKU                                 04270000
042800                            TO TL-VE-UNITS                        04280000
042900         MOVE PV-TOT-EXT-COST-SKU                                 04290000
043000                            TO TL-EXTENDED-COST                   04300000
043100         MOVE PV-TOT-EXT-RETAIL-SKU                               04310000
043200                            TO TL-EXTENDED-RETAIL                 04320000
043300         PERFORM 7000-PRINT-REPORT                                04330000
043400         MOVE +2            TO PV-NBR-OF-LINES                    04340000
043500         MOVE 'PO/RECEIVER TOTAL:  '                              04350000
043600                            TO TL-TOTAL-TYPE-DESC                 04360000
043700         MOVE PV-TOT-VE-UNITS-PO-RCVR                             04370000
043800                            TO TL-VE-UNITS                        04380000
043900         MOVE PV-TOT-EXT-COST-PO-RCVR                             04390000
044000                            TO TL-EXTENDED-COST                   04400000
044100         MOVE PV-TOT-EXT-RETAIL-PO-RCVR                           04410000
044200                            TO TL-EXTENDED-RETAIL                 04420000
044300         MOVE +2            TO PV-NBR-OF-LINES                    04430000
044400         PERFORM 7000-PRINT-REPORT                                04440000
044500         MOVE ' DEPARTMENT TOTAL:  '                              04450000
044600                            TO TL-TOTAL-TYPE-DESC                 04460000
044700         MOVE PV-TOT-VE-UNITS-DEPT                                04470000
044800                            TO TL-VE-UNITS                        04480000
044900         MOVE PV-TOT-EXT-COST-DEPT                                04490000
045000                            TO TL-EXTENDED-COST                   04500000
045100         MOVE PV-TOT-EXT-RETAIL-DEPT                              04510000
045200                            TO TL-EXTENDED-RETAIL                 04520000
045300         MOVE +2            TO PV-NBR-OF-LINES                    04530000
045400         PERFORM 7000-PRINT-REPORT                                04540000
045500         MOVE '      FINAL TOTAL:  '                              04550000
045600                            TO TL-TOTAL-TYPE-DESC                 04560000
045700         MOVE PV-TOT-VE-UNITS-FINAL                               04570000
045800                            TO TL-VE-UNITS                        04580000
045900         MOVE PV-TOT-EXT-COST-FINAL                               04590000
046000                            TO TL-EXTENDED-COST                   04600000
046100         MOVE PV-TOT-EXT-RETAIL-FINAL                             04610000
046200                            TO TL-EXTENDED-RETAIL                 04620000
046300         MOVE +2            TO PV-NBR-OF-LINES                    04630000
046400         PERFORM 7000-PRINT-REPORT                                04640000
046500         PERFORM 9000-EOJ-ROUTINE                                 04650000
046600     END-IF.                                                      04660000
046700                                                                  04670000
046800     STOP RUN.                                                    04680000
046900                                                                  04690000
047000/*****************************************************************04700000
047100* 1000-INTIALIZATION ROUTINE.                                     04710000
047200*  OPEN FILES, FILL STANDARD REPORT HEADER FIELDS,                04720000
047300*  READ THE FIRST IN STORE EXTRACT RECORD.                        04730000
047400******************************************************************04740000
047500 1000-INITIALIZE.                                                 04750000
047600                                                                  04760000
047700     OPEN INPUT  STORE-EXTRACT-FILE                               04770000
047800          OUTPUT VERIFIED-RECEIPTS-RPT.                           04780000
047900                                                                  04790000
048000     ACCEPT CD-RECEIVER-TYPE-DATA                                 04800000
048100                              FROM SYSIN.                         04810000
048200     MOVE CD-RECEIVER-TYPE-DESC                                   04820000
048300                              TO HL1-RECEIVER-TYPE-DESC           04830000
048400                                 EI-RECEIVER-TYPE-DESC            04840000
048500                                                                  04850000
048600     ACCEPT CD-CURRENT-DATE   FROM DATE.                          04860000
048700     MOVE CD-CURRENT-YEAR     TO DP132O-RUN-YEAR.                 04870000
048800     MOVE CD-CURRENT-MONTH    TO DP132O-RUN-MONTH.                04880000
048900     MOVE CD-CURRENT-DAY      TO DP132O-RUN-DAY.                  04890000
049000                                                                  04900000
049100     ACCEPT CT-CURRENT-TIME   FROM TIME.                          04910000
049200     MOVE CT-CURRENT-HOUR     TO DP132O-RUN-HOUR.                 04920000
049300     MOVE CT-CURRENT-MINUTE   TO DP132O-RUN-MINUTE.               04930000
049400                                                                  04940000
049500     MOVE 'RCKRP040'          TO DP132O-PROGRAM-NAME.             04950000
049600     MOVE 1                   TO DP132O-REPORT-NUMBER.            04960000
049700     MOVE PC-PAGE-SIZE        TO PV-LINE-COUNT.                   04970000
049800     MOVE ZEROS               TO PV-PAGE-COUNT.                   04980000
049900                                                                  04990000
050000     PERFORM 6000-PROCESS-TCOCNTL.                                05000000
050100                                                                  05010000
050200     SET PS-NOT-END-OF-EXTRACT-FILE TO TRUE.                      05020000
050300     PERFORM 7100-READ-EXTRACT-FILE                               05030000
050400                                                                  05040000
050500     IF PS-END-OF-EXTRACT-FILE                                    05050000
050600         MOVE ZERO          TO HL3-DEPT-NBR                       05060000
050700         ADD 1 TO PV-PAGE-COUNT                                   05070000
050800         MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER                 05080000
050900         WRITE VERIFIED-RECEIPTS-LINE                             05090000
051000             FROM DP132O-STANDRD-HEADER-132-COLS                  05100000
051100             AFTER ADVANCING PAGE                                 05110000
051200         WRITE VERIFIED-RECEIPTS-LINE                             05120000
051300             FROM HEADING-LINE-1                                  05130000
051400             AFTER ADVANCING 2 LINES                              05140000
051500         WRITE VERIFIED-RECEIPTS-LINE                             05150000
051600             FROM HEADING-LINE-2                                  05160000
051700             AFTER ADVANCING 1 LINES                              05170000
051800         WRITE VERIFIED-RECEIPTS-LINE                             05180000
051900             FROM HEADING-LINE-3                                  05190000
052000             AFTER ADVANCING 2 LINES                              05200000
052100         WRITE VERIFIED-RECEIPTS-LINE                             05210000
052200             FROM EMPTY-INPUT-LINE                                05220000
052300             AFTER ADVANCING 1 LINES                              05230000
052400     ELSE                                                         05240000
052500         MOVE SE-POLINENO    TO PV-HOLD-LINE-NBR                  05250000
052600         MOVE SE-REC-SEQ-NBR TO PV-HOLD-REC-SEQ-NBR               05260000
052700         MOVE SE-PO          TO PV-HOLD-PO-NBR                    05270000
052800         MOVE ZERO           TO PV-HOLD-DEPT-NBR                  05280000
052900     END-IF.                                                      05290000
053000                                                                  05300000
053100     SET PS-FIRST-LINE       TO TRUE.                             05310000
053200*    PERFORM 8000-PRINT-HEADERS THRU                              05320000
053300*    SET PS-NOT-FIRST-LINE TO TRUE.                               05330000
053400                                                                  05340000
053500 2000-PROCESS-EXTRACT.                                            05350000
053600     IF SE-DEPT NOT = PV-HOLD-DEPT-NBR                            05360000
053700         PERFORM 2100-DEPT-BREAK                                  05370000
053800         PERFORM 2010-LOAD-BEGINNING-DL-LINE                      05380000
053900         MOVE SE-POLINENO    TO PV-HOLD-LINE-NBR                  05390000
054000         MOVE SE-REC-SEQ-NBR TO PV-HOLD-REC-SEQ-NBR               05400000
054100         MOVE SE-PO          TO PV-HOLD-PO-NBR                    05410000
054200         MOVE SE-DEPT        TO PV-HOLD-DEPT-NBR                  05420000
054300     END-IF.                                                      05430000
054400                                                                  05440000
054500     IF SE-PO             = PV-HOLD-PO-NBR                        05450000
054600       AND SE-REC-SEQ-NBR = PV-HOLD-REC-SEQ-NBR                   05460000
054700         CONTINUE                                                 05470000
054800     ELSE                                                         05480000
054900         PERFORM 2200-PO-RCVR-BREAK                               05490000
055000         PERFORM 2010-LOAD-BEGINNING-DL-LINE                      05500000
055100         MOVE SE-POLINENO    TO PV-HOLD-LINE-NBR                  05510000
055200         MOVE SE-REC-SEQ-NBR TO PV-HOLD-REC-SEQ-NBR               05520000
055300         MOVE SE-PO          TO PV-HOLD-PO-NBR                    05530000
055400     END-IF                                                       05540000
055500     IF SE-POLINENO NOT = PV-HOLD-LINE-NBR                        05550000
055600         SET PS-PRINT-TOTAL TO TRUE                               05560000
055700         MOVE '        SKU TOTAL:  '                              05570000
055800                            TO TL-TOTAL-TYPE-DESC                 05580000
055900         MOVE PV-TOT-VE-UNITS-SKU                                 05590000
056000                            TO TL-VE-UNITS                        05600000
056100         MOVE PV-TOT-EXT-COST-SKU                                 05610000
056200                            TO TL-EXTENDED-COST                   05620000
056300         MOVE PV-TOT-EXT-RETAIL-SKU                               05630000
056400                            TO TL-EXTENDED-RETAIL                 05640000
056500         ADD +1             TO PV-LINE-COUNT                      05650000
056600         PERFORM 7000-PRINT-REPORT                                05660000
056700         MOVE ZERO TO PV-TOT-VE-UNITS-SKU                         05670000
056800                      PV-TOT-EXT-COST-SKU                         05680000
056900                      PV-TOT-EXT-RETAIL-SKU                       05690000
057000         PERFORM 2010-LOAD-BEGINNING-DL-LINE                      05700000
057100         MOVE SE-POLINENO   TO PV-HOLD-LINE-NBR                   05710000
057200         MOVE +2            TO PV-NBR-OF-LINES                    05720000
057300     END-IF                                                       05730000
057400                                                                  05740000
057500     IF PS-FIRST-LINE                                             05750000
057600         PERFORM 2010-LOAD-BEGINNING-DL-LINE                      05760000
057700         SET PS-NOT-FIRST-LINE                                    05770000
057800                            TO TRUE                               05780000
057900     END-IF                                                       05790000
058000                                                                  05800000
058100     MOVE SE-LOC-NBR        TO DL-STORE-NBR                       05810000
058200     PERFORM 6500-INV-DATE                                        05820000
058300     MOVE SE-RETAIL-UNITS-MARK                                    05830000
058400                            TO DL-VE-UNITS                        05840000
058500                               PV-VE-UNITS                        05850000
058600     MOVE SE-LOWEST-RETAIL  TO DL-LOWEST-RETAIL                   05860000
058700     IF SE-RETAIL-UNITS-MARK NOT = ZERO                           05870000
058800         DIVIDE SE-COST-EXTENSION BY SE-RETAIL-UNITS-MARK         05880000
058900             GIVING PV-UNIT-COST                                  05890000
059000     ELSE                                                         05900000
059100         MOVE ZERO          TO PV-UNIT-COST                       05910000
059200     END-IF                                                       05920000
059300     MOVE PV-UNIT-COST      TO DL-UNIT-COST                       05930000
059400     MOVE SE-COST-EXTENSION TO DL-EXTENDED-COST                   05940000
059500     MOVE SE-RETAIL-EXTENSION                                     05950000
059600                            TO DL-EXTENDED-RETAIL                 05960000
059700     SET PS-PRINT-DETAIL    TO TRUE                               05970000
059800     ADD PV-NBR-OF-LINES    TO PV-LINE-COUNT                      05980000
059900     PERFORM 7000-PRINT-REPORT                                    05990000
060000                                                                  06000000
060100     MOVE SPACES            TO DL-LINE-NBR-X                      06010000
060200                               DL-SKU-NBR                         06020000
060300                               DL-SKU-STAT-DESC                   06030000
060400                               DL-MAJ-CLASS-NBR-X                 06040000
060500                               DL-SUB-CLASS-NBR-X                 06050000
060600                               DL-SLASH.                          06060000
060700                                                                  06070000
060800     ADD PV-VE-UNITS        TO PV-TOT-VE-UNITS-SKU                06080000
060900                               PV-TOT-VE-UNITS-PO-RCVR            06090000
061000                               PV-TOT-VE-UNITS-DEPT               06100000
061100                               PV-TOT-VE-UNITS-FINAL              06110000
061200     ADD SE-COST-EXTENSION  TO PV-TOT-EXT-COST-SKU                06120000
061300                               PV-TOT-EXT-COST-PO-RCVR            06130000
061400                               PV-TOT-EXT-COST-DEPT               06140000
061500                               PV-TOT-EXT-COST-FINAL              06150000
061600     ADD SE-RETAIL-EXTENSION                                      06160000
061700                            TO PV-TOT-EXT-RETAIL-SKU              06170000
061800                               PV-TOT-EXT-RETAIL-PO-RCVR          06180000
061900                               PV-TOT-EXT-RETAIL-DEPT             06190000
062000                               PV-TOT-EXT-RETAIL-FINAL            06200000
062100                                                                  06210000
062200     PERFORM 7100-READ-EXTRACT-FILE.                              06220000
062300                                                                  06230000
062400 2010-LOAD-BEGINNING-DL-LINE.                                     06240000
062500     MOVE SE-POLINENO       TO DL-LINE-NBR                        06250000
062600     MOVE SE-SKU-NBR        TO DL-SKU-NBR                         06260000
062700                               PV-SKU-NBR                         06270000
062800     MOVE '/'               TO DL-SLASH                           06280000
062900     PERFORM 6400-GET-XL-DOMAIN-DATA.                             06290000
063000                                                                  06300000
063100 2100-DEPT-BREAK.                                                 06310000
063200     IF PS-FIRST-LINE                                             06320000
063300         MOVE SE-PO            TO HL4-PO-NBR                      06330000
063400         PERFORM 6100-CALL-XLKUT004                               06340000
063500         PERFORM 4000-LOAD-PO-RCVR-LINES                          06350000
063600         PERFORM 8000-PRINT-HEADERS                               06360000
063700     ELSE                                                         06370000
063800         SET PS-PRINT-TOTAL    TO TRUE                            06380000
063900         ADD +5                TO PV-LINE-COUNT                   06390000
064000         MOVE '        SKU TOTAL:  '                              06400000
064100                               TO TL-TOTAL-TYPE-DESC              06410000
064200         MOVE PV-TOT-VE-UNITS-SKU                                 06420000
064300                               TO TL-VE-UNITS                     06430000
064400         MOVE PV-TOT-EXT-COST-SKU                                 06440000
064500                               TO TL-EXTENDED-COST                06450000
064600         MOVE PV-TOT-EXT-RETAIL-SKU                               06460000
064700                               TO TL-EXTENDED-RETAIL              06470000
064800         PERFORM 7000-PRINT-REPORT                                06480000
064900         MOVE +2               TO PV-NBR-OF-LINES                 06490000
065000         MOVE 'PO/RECEIVER TOTAL:  '                              06500000
065100                               TO TL-TOTAL-TYPE-DESC              06510000
065200         MOVE PV-TOT-VE-UNITS-PO-RCVR                             06520000
065300                               TO TL-VE-UNITS                     06530000
065400         MOVE PV-TOT-EXT-COST-PO-RCVR                             06540000
065500                               TO TL-EXTENDED-COST                06550000
065600         MOVE PV-TOT-EXT-RETAIL-PO-RCVR                           06560000
065700                               TO TL-EXTENDED-RETAIL              06570000
065800         MOVE +2               TO PV-NBR-OF-LINES                 06580000
065900         PERFORM 7000-PRINT-REPORT                                06590000
066000         MOVE ' DEPARTMENT TOTAL:  '                              06600000
066100                               TO TL-TOTAL-TYPE-DESC              06610000
066200         MOVE PV-TOT-VE-UNITS-DEPT                                06620000
066300                               TO TL-VE-UNITS                     06630000
066400         MOVE PV-TOT-EXT-COST-DEPT                                06640000
066500                               TO TL-EXTENDED-COST                06650000
066600         MOVE PV-TOT-EXT-RETAIL-DEPT                              06660000
066700                               TO TL-EXTENDED-RETAIL              06670000
066800         MOVE +2               TO PV-NBR-OF-LINES                 06680000
066900         PERFORM 7000-PRINT-REPORT                                06690000
067000         MOVE ZERO TO PV-TOT-VE-UNITS-SKU                         06700000
067100                      PV-TOT-VE-UNITS-PO-RCVR                     06710000
067200                      PV-TOT-VE-UNITS-DEPT                        06720000
067300                      PV-TOT-EXT-COST-SKU                         06730000
067400                      PV-TOT-EXT-COST-PO-RCVR                     06740000
067500                      PV-TOT-EXT-COST-DEPT                        06750000
067600                      PV-TOT-EXT-RETAIL-SKU                       06760000
067700                      PV-TOT-EXT-RETAIL-PO-RCVR                   06770000
067800                      PV-TOT-EXT-RETAIL-DEPT                      06780000
067900         MOVE SE-PO            TO HL4-PO-NBR                      06790000
068000         PERFORM 6100-CALL-XLKUT004                               06800000
068100         PERFORM 4000-LOAD-PO-RCVR-LINES                          06810000
068200         PERFORM 8000-PRINT-HEADERS                               06820000
068300     END-IF.                                                      06830000
068400                                                                  06840000
068500 2200-PO-RCVR-BREAK.                                              06850000
068600     SET PS-PRINT-TOTAL        TO TRUE                            06860000
068700     ADD +3                    TO PV-LINE-COUNT                   06870000
068800     MOVE '        SKU TOTAL:  '                                  06880000
068900                               TO TL-TOTAL-TYPE-DESC              06890000
069000     MOVE PV-TOT-VE-UNITS-SKU  TO TL-VE-UNITS                     06900000
069100     MOVE PV-TOT-EXT-COST-SKU  TO TL-EXTENDED-COST                06910000
069200     MOVE PV-TOT-EXT-RETAIL-SKU                                   06920000
069300                               TO TL-EXTENDED-RETAIL              06930000
069400     PERFORM 7000-PRINT-REPORT                                    06940000
069500     MOVE +2                   TO PV-NBR-OF-LINES                 06950000
069600     MOVE 'PO/RECEIVER TOTAL:  '                                  06960000
069700                               TO TL-TOTAL-TYPE-DESC              06970000
069800     MOVE PV-TOT-VE-UNITS-PO-RCVR                                 06980000
069900                               TO TL-VE-UNITS                     06990000
070000     MOVE PV-TOT-EXT-COST-PO-RCVR                                 07000000
070100                               TO TL-EXTENDED-COST                07010000
070200     MOVE PV-TOT-EXT-RETAIL-PO-RCVR                               07020000
070300                               TO TL-EXTENDED-RETAIL              07030000
070400     PERFORM 7000-PRINT-REPORT                                    07040000
070500     MOVE ZERO TO PV-TOT-VE-UNITS-SKU                             07050000
070600                  PV-TOT-VE-UNITS-PO-RCVR                         07060000
070700                  PV-TOT-EXT-COST-SKU                             07070000
070800                  PV-TOT-EXT-COST-PO-RCVR                         07080000
070900                  PV-TOT-EXT-RETAIL-SKU                           07090000
071000                  PV-TOT-EXT-RETAIL-PO-RCVR                       07100000
071100     PERFORM 4000-LOAD-PO-RCVR-LINES                              07110000
071200     ADD +4                    TO PV-LINE-COUNT                   07120000
071300     IF PV-LINE-COUNT > PC-PAGE-SIZE                              07130000
071400         PERFORM 8000-PRINT-HEADERS                               07140000
071500     ELSE                                                         07150000
071600         WRITE VERIFIED-RECEIPTS-LINE                             07160000
071700             FROM HEADING-LINE-4                                  07170000
071800             AFTER ADVANCING 2 LINES                              07180000
071900         WRITE VERIFIED-RECEIPTS-LINE                             07190000
072000             FROM HEADING-LINE-5                                  07200000
072100             AFTER ADVANCING 1 LINES                              07210000
072200         INITIALIZE VERIFIED-RECEIPTS-LINE                        07220000
072300         WRITE VERIFIED-RECEIPTS-LINE                             07230000
072400             AFTER ADVANCING 1 LINE                               07240000
072500     END-IF.                                                      07250000
072600                                                                  07260000
072700 4000-LOAD-PO-RCVR-LINES.                                         07270000
072800     PERFORM 6200-SELECT-TRECEIV                                  07280000
072900     PERFORM 6300-GET-CANCEL-DATE                                 07290000
073000     IF SE-REC-SRC-CDE = 'A'                                      07300000
073100         MOVE 'POST ADJ'   TO HL5-VE-TYPE                         07310000
073200     ELSE                                                         07320000
073300         MOVE 'RECEIPT'    TO HL5-VE-TYPE                         07330000
073400     END-IF.                                                      07340000
073500     MOVE SE-DEPT          TO HL3-DEPT-NBR                        07350000
073600     MOVE SE-PO            TO HL4-PO-NBR                          07360000
073700     MOVE SE-REC-SEQ-NBR   TO HL4-REC-SEQ-NBR                     07370000
073800     MOVE SE-CURR-OPER-UNT-ID                                     07380000
073900                           TO HL4-CURR-OPER-UNIT-ID               07390000
074000     MOVE SE-DV-MM         TO HL4-VE-MM                           07400000
074100     MOVE SE-DV-DD         TO HL4-VE-DD                           07410000
074200     MOVE SE-DV-YY         TO HL4-VE-YY                           07420000
074300     MOVE SE-VENDOR-NAME-INHOUSE                                  07430000
074400                           TO HL5-VENDOR-NAME.                    07440000
074500                                                                  07450000
074600 6000-PROCESS-TCOCNTL.                                            07460000
074700                                                                  07470000
074800     EXEC SQL                                                     07480000
074900         SELECT BTCH_PRC_DTE                                      07490000
075000           INTO :COCNTL-BTCH-PRC-DTE                              07500000
075100           FROM TCOCNTL                                           07510000
075200          WHERE OPER_UNT_ID = 90                                  07520000
075210           WITH UR                                                07521001
075300     END-EXEC.                                                    07530000
075400                                                                  07540000
075500     EVALUATE SQLCODE                                             07550000
075600         WHEN +0                                                  07560000
075700             MOVE COCNTL-BTCH-PRC-DTE                             07570000
075800                 TO PV-DATE-WITH-DASHES                           07580000
075900             MOVE PV-MM-WITH-DASHES                               07590000
076000                 TO HL2-PROCESS-MM                                07600000
076100             MOVE PV-DD-WITH-DASHES                               07610000
076200                 TO HL2-PROCESS-DD                                07620000
076300             MOVE PV-YYYY-WITH-DASHES                             07630000
076400                 TO HL2-PROCESS-YYYY                              07640000
076500         WHEN OTHER                                               07650000
076600             MOVE '6000-PROCESS-TCOCNTL'                          07660000
076700                 TO PV-PARAGRAPH-NAME                             07670000
076800             MOVE 'SELECT TCOCNTL'                                07680000
076900                 TO PV-DB2-OPERATION-ATTEMPTED                    07690000
077000             PERFORM 9999-SQL-ABEND                               07700000
077100     END-EVALUATE.                                                07710000
077200                                                                  07720000
077300 6100-CALL-XLKUT004.                                              07730000
077400     INITIALIZE XL004-COMMAREA                                    07740000
077500     MOVE SE-DEPT                  TO XL004-DEPT-NBR              07750000
077600     CALL XL004-PGM     USING XL004-DEPT-COMMAREA                 07760000
077700     EVALUATE TRUE                                                07770000
077800         WHEN XL004-SUCCESSFUL                                    07780000
077900             MOVE XL004-DEPT-NM    TO HL3-DEPT-NAME               07790000
078000         WHEN XL004-NOT-FOUND                                     07800000
078100              MOVE 'NOT FOUND'     TO HL3-DEPT-NAME               07810000
078200         WHEN OTHER                                               07820000
078300              STRING 'SQL ERROR '  DELIMITED BY SIZE              07830000
078400                     XL004-SQLCODE DELIMITED BY SIZE              07840000
078500                INTO HL3-DEPT-NAME                                07850000
078600     END-EVALUATE.                                                07860000
078700                                                                  07870000
078800 6200-SELECT-TRECEIV.                                             07880000
078900     MOVE SE-PO          TO RECEIV-ORD-NBR                        07890000
079000     MOVE SE-REC-SEQ-NBR TO RECEIV-REC-SEQ-NBR                    07900000
079100     PERFORM                                                      07910000
079200         WITH TEST AFTER                                          07920000
079300         VARYING PV-RETRY-COUNTER                                 07930000
079400         FROM 1 BY 1                                              07940000
079500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               07950000
079600            OR (SQLCODE = +0)                                     07960000
079700            OR (SQLCODE = +100))                                  07970000
079800                                                                  07980000
079900         EXEC SQL                                                 07990000
080000            SELECT VRFD_USR_ID                                    08000000
080100                  ,PKGNG_CDE                                      08010000
080200              INTO :RECEIV-VRFD-USR-ID                            08020000
080300                  ,:RECEIV-PKGNG-CDE                              08030000
080400              FROM  TRECEIV                                       08040000
080500             WHERE ORD_NBR     = :RECEIV-ORD-NBR                  08050000
080600               AND REC_SEQ_NBR = :RECEIV-REC-SEQ-NBR              08060000
080610              WITH UR                                             08061001
080700         END-EXEC                                                 08070000
080800                                                                  08080000
080900         EVALUATE TRUE                                            08090000
081000             WHEN SQLCODE = +0                                    08100000
081100                 MOVE RECEIV-VRFD-USR-ID                          08110000
081200                                   TO HL4-VRFD-USR-ID             08120000
081300                 MOVE RECEIV-PKGNG-CDE                            08130000
081400                                   TO HL5-PKGNG-CDE               08140000
081500                 EVALUATE HL5-PKGNG-CDE                           08150000
081600                     WHEN 'I'                                     08160000
081700                         MOVE 'INNER PREPACK'                     08170000
081800                                   TO HL5-PKGNG-CDE-DESC          08180000
081900                     WHEN 'M'                                     08190000
082000                         MOVE 'MULTI SKU PREPACK'                 08200000
082100                                   TO HL5-PKGNG-CDE-DESC          08210000
082200                     WHEN 'S'                                     08220000
082300                         MOVE 'SINGLE SKU PREPACK'                08230000
082400                                   TO HL5-PKGNG-CDE-DESC          08240000
082500                     WHEN 'C'                                     08250000
082600                         MOVE 'CASE PACK'                         08260000
082700                                   TO HL5-PKGNG-CDE-DESC          08270000
082800                     WHEN 'B'                                     08280000
082900                         MOVE 'BULK'                              08290000
083000                                   TO HL5-PKGNG-CDE-DESC          08300000
083100                     WHEN ' '                                     08310000
083200                         MOVE 'PACK BY STORE'                     08320000
083300                                   TO HL5-PKGNG-CDE-DESC          08330000
083400                 END-EVALUATE                                     08340000
083500             WHEN SQLCODE = +100                                  08350000
083600                 MOVE 'NOT FOUND'  TO HL4-VRFD-USR-ID             08360000
083700                                      HL5-PKGNG-CDE-DESC          08370000
083800                 MOVE SPACES       TO HL5-PKGNG-CDE               08380000
083900             WHEN SQLCODE = -904                                  08390000
084000             WHEN SQLCODE = -913                                  08400000
084100                 CONTINUE                                         08410000
084200                                                                  08420000
084300             WHEN SQLWARN0 NOT = SPACE                            08430000
084400             WHEN SQLCODE < +0                                    08440000
084500             WHEN SQLCODE > +0                                    08450000
084600             MOVE '6200'           TO PV-PARAGRAPH-NAME           08460000
084700             MOVE 'SELECT TRECEIV' TO PV-DB2-OPERATION-ATTEMPTED  08470000
084800             PERFORM 9999-SQL-ABEND                               08480000
084900         END-EVALUATE                                             08490000
085000     END-PERFORM.                                                 08500000
085100                                                                  08510000
085200 6300-GET-CANCEL-DATE.                                            08520000
085300     MOVE SE-PO TO PLNSHP-PO-NBR                                  08530000
085400     PERFORM                                                      08540000
085500         WITH TEST AFTER                                          08550000
085600         VARYING PV-RETRY-COUNTER                                 08560000
085700         FROM 1 BY 1                                              08570000
085800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               08580000
085900            OR (SQLCODE = +0)                                     08590000
086000            OR (SQLCODE = +100))                                  08600000
086100                                                                  08610000
086200         EXEC SQL                                                 08620000
086300            SELECT CAN_IFNOT_SHIP_DTE                             08630000
086400              INTO :PLNSHP-CAN-IFNOT-SHIP-DTE                     08640000
086500              FROM  TPLNSHP                                       08650000
086600             WHERE PO_NBR         = :PLNSHP-PO-NBR                08660000
086700               AND VER_STATUS_CDE = 'A'                           08670000
086710              WITH UR                                             08671001
086800         END-EXEC                                                 08680000
086900                                                                  08690000
087000         EVALUATE TRUE                                            08700000
087100             WHEN SQLCODE = +0                                    08710000
087200             MOVE PLNSHP-CAN-IFNOT-SHIP-DTE                       08720000
087300                                   TO PV-DATE-WITH-DASHES         08730000
087400             MOVE PV-MM-WITH-DASHES                               08740000
087500                                   TO HL4-CANCEL-MM               08750000
087600             MOVE PV-DD-WITH-DASHES                               08760000
087700                                   TO HL4-CANCEL-DD               08770000
087800             MOVE PV-YYYY-WITH-DASHES                             08780000
087900                                   TO HL4-CANCEL-YYYY             08790000
088000             WHEN SQLCODE = +100                                  08800000
088100                 MOVE SPACES       TO HL4-CANCEL-MM               08810000
088200                                      HL4-CANCEL-DD               08820000
088300                                      HL4-CANCEL-YYYY             08830000
088400             WHEN SQLCODE = -904                                  08840000
088500             WHEN SQLCODE = -913                                  08850000
088600                 CONTINUE                                         08860000
088700                                                                  08870000
088800             WHEN SQLWARN0 NOT = SPACE                            08880000
088900             WHEN SQLCODE < +0                                    08890000
089000             WHEN SQLCODE > +0                                    08900000
089100             MOVE '6300'           TO PV-PARAGRAPH-NAME           08910000
089200             MOVE 'SELECT TPLNSHP' TO PV-DB2-OPERATION-ATTEMPTED  08920000
089300             PERFORM 9999-SQL-ABEND                               08930000
089400         END-EVALUATE                                             08940000
089500     END-PERFORM.                                                 08950000
089600                                                                  08960000
089700 6400-GET-XL-DOMAIN-DATA.                                         08970000
089800     MOVE PV-SKU-NBR TO XLT00003-SKU-NBR                          08980000
089900     PERFORM                                                      08990000
090000         WITH TEST AFTER                                          09000000
090100         VARYING PV-RETRY-COUNTER                                 09010000
090200         FROM 1 BY 1                                              09020000
090300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09030000
090400            OR (SQLCODE = +0)                                     09040000
090500            OR (SQLCODE = +100))                                  09050000
090600                                                                  09060000
090700         EXEC SQL                                                 09070000
090800            SELECT SKU_STAT_DESC                                  09080000
090900                  ,MAJ_CL_NBR                                     09090000
091000                  ,SUB_CL_NBR                                     09100000
091100              INTO :XLT00003-SKU-STAT-DESC                        09110000
091200                  ,:XLT00004-MAJ-CL-NBR                           09120000
091300                  ,:XLT00004-SUB-CL-NBR                           09130000
091400              FROM XLT_SKU A,                                     09140000
091500                   XLT_VND_STYL B                                 09150000
091600             WHERE SKU_NBR   = :XLT00003-SKU-NBR                  09160000
091700               AND A.STYL_ID = B.STYL_ID                          09170000
091710              WITH UR                                             09171001
091800         END-EXEC                                                 09180000
091900                                                                  09190000
092000         EVALUATE TRUE                                            09200000
092100             WHEN SQLCODE = +0                                    09210000
092200             MOVE XLT00003-SKU-STAT-DESC                          09220000
092300                                   TO DL-SKU-STAT-DESC            09230000
092400             MOVE XLT00004-MAJ-CL-NBR                             09240000
092500                                   TO DL-MAJ-CLASS-NBR            09250000
092600             MOVE XLT00004-SUB-CL-NBR                             09260000
092700                                   TO DL-SUB-CLASS-NBR            09270000
092800             WHEN SQLCODE = +100                                  09280000
092900                 MOVE SPACES       TO DL-SKU-STAT-DESC            09290000
093000                                      XLT00003-SKU-STAT-DESC      09300000
093100                 MOVE ZERO         TO DL-MAJ-CLASS-NBR            09310000
093200                                      DL-SUB-CLASS-NBR            09320000
093300                                      XLT00004-MAJ-CL-NBR         09330000
093400                                      XLT00004-SUB-CL-NBR         09340000
093500             WHEN SQLCODE = -904                                  09350000
093600             WHEN SQLCODE = -913                                  09360000
093700                 CONTINUE                                         09370000
093800                                                                  09380000
093900             WHEN SQLWARN0 NOT = SPACE                            09390000
094000             WHEN SQLCODE < +0                                    09400000
094100             WHEN SQLCODE > +0                                    09410000
094200             MOVE '6400'           TO PV-PARAGRAPH-NAME           09420000
094300             MOVE 'SELECT XLT_SKU, XLT_VND_STYL'                  09430000
094400                                   TO PV-DB2-OPERATION-ATTEMPTED  09440000
094500             PERFORM 9999-SQL-ABEND                               09450000
094600         END-EVALUATE                                             09460000
094700     END-PERFORM.                                                 09470000
094800                                                                  09480000
094900 6500-INV-DATE.                                                   09490000
095000     PERFORM                                                      09500000
095100         WITH TEST AFTER                                          09510000
095200         VARYING PV-RETRY-COUNTER                                 09520000
095300         FROM 1 BY 1                                              09530000
095400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09540000
095500            OR (SQLCODE = +0)                                     09550000
095600            OR (SQLCODE = +100))                                  09560000
095700                                                                  09570000
095800         EXEC SQL                                                 09580000
095900            SELECT MAX(INV_DTE)                                   09590000
096000              INTO :XLT00025-INV-DTE :PV-NULL-IND                 09600000
096100              FROM XLT_MDSE_INV_PARM                              09610000
096200             WHERE LOC_NBR   = :SE-LOC-NBR                        09620000
096300               AND INV_DTE    < '9999-09-09'                      09630000
096400               AND DC_CTOFF_DTE     < :COCNTL-BTCH-PRC-DTE        09640000
096500               AND LOC_INV_STAT_CDE = 'IN'                        09650000
096600               AND SCHD_PHY_CNT_CDE IN ( 'PI' , 'NS' )            09660000
096610              WITH UR                                             09661001
096700         END-EXEC                                                 09670000
096800                                                                  09680000
096900         EVALUATE TRUE                                            09690000
097000             WHEN SQLCODE = +0                                    09700000
097100                 IF PV-NULL-IND = -1                              09710000
097200                     DISPLAY 'NULL-IND = -1'                      09720000
097300                 ' LOC_NBR = '  SE-LOC-NBR                        09730000
097400                 ' DC_CTOFF_DTE = ' COCNTL-BTCH-PRC-DTE           09740000
097500                     MOVE '09'     TO DL-FLUSH-MM                 09750000
097600                                      DL-FLUSH-DD                 09760000
097700                     MOVE '9999'   TO DL-FLUSH-YYYY               09770000
097800                 ELSE                                             09780000
097900                     MOVE XLT00025-INV-DTE                        09790000
098000                                   TO PV-DATE-WITH-DASHES         09800000
098100                     MOVE PV-MM-WITH-DASHES                       09810000
098200                                   TO DL-FLUSH-MM                 09820000
098300                     MOVE PV-DD-WITH-DASHES                       09830000
098400                                   TO DL-FLUSH-DD                 09840000
098500                     MOVE PV-YYYY-WITH-DASHES                     09850000
098600                                   TO DL-FLUSH-YYYY               09860000
098700                 END-IF                                           09870000
098800             WHEN SQLCODE = -904                                  09880000
098900             WHEN SQLCODE = -913                                  09890000
099000                 CONTINUE                                         09900000
099100                                                                  09910000
099200             WHEN SQLWARN0 NOT = SPACE                            09920000
099300             WHEN SQLCODE < +0                                    09930000
099400             WHEN SQLCODE > +0                                    09940000
099500             MOVE SE-LOC-NBR       TO PV-DATA                     09950000
099600             DISPLAY '** DATA      ** = ' PV-DATA                 09960000
099700             MOVE '6500'           TO PV-PARAGRAPH-NAME           09970000
099800             MOVE 'SELECT XLT_MDSE_INV_PARM'                      09980000
099900                                   TO PV-DB2-OPERATION-ATTEMPTED  09990000
100000             PERFORM 9999-SQL-ABEND                               10000000
100100         END-EVALUATE                                             10010000
100200         PERFORM 6510-NEXT-INV-DATE                               10020000
100300     END-PERFORM.                                                 10030000
100400                                                                  10040000
100500 6510-NEXT-INV-DATE.                                              10050000
100600*                                                                 10060000
100700     INITIALIZE XLT00025-PLND-INV-DTE.                            10070000
100800     EXEC SQL                                                     10080000
100900          SELECT MIN(PLND_INV_DTE)                                10090000
101000            INTO :XLT00025-PLND-INV-DTE :PV-NULL-IND              10100000
101100            FROM XLT_MDSE_INV_PARM                                10110000
101200           WHERE LOC_NBR          =  :SE-LOC-NBR                  10120000
101300             AND INV_DTE          =  '9999-09-09'                 10130000
101400             AND DC_CTOFF_DTE     >= :COCNTL-BTCH-PRC-DTE         10140000
101500             AND LOC_INV_STAT_CDE =  'IN'                         10150000
101600             AND SCHD_PHY_CNT_CDE IN ( 'PI' , 'NS' )              10160000
101610            WITH UR                                               10161001
101700     END-EXEC.                                                    10170000
101800*                                                                 10180000
101900     EVALUATE TRUE                                                10190000
102000         WHEN SQLCODE                = +0                         10200000
102100              IF PV-NULL-IND         = -1                         10210000
102200                 DISPLAY 'NULL-IND   = -1'                        10220000
102300                 ' LOC_NBR = '  SE-LOC-NBR                        10230000
102400                 ' DC_CTOFF_DTE = ' COCNTL-BTCH-PRC-DTE           10240000
102500                 MOVE '09'           TO DL-NEXT-MM                10250000
102600                                        DL-NEXT-DD                10260000
102700                 MOVE '9999'         TO DL-NEXT-YYYY              10270000
102800              ELSE                                                10280000
102900                     MOVE XLT00025-PLND-INV-DTE                   10290000
103000                                   TO PV-DATE-WITH-DASHES         10300000
103100                     MOVE PV-MM-WITH-DASHES                       10310000
103200                                   TO DL-NEXT-MM                  10320000
103300                     MOVE PV-DD-WITH-DASHES                       10330000
103400                                   TO DL-NEXT-DD                  10340000
103500                     MOVE PV-YYYY-WITH-DASHES                     10350000
103600                                   TO DL-NEXT-YYYY                10360000
103700              END-IF                                              10370000
103800         WHEN SQLCODE = -904                                      10380000
103900         WHEN SQLCODE = -913                                      10390000
104000              CONTINUE                                            10400000
104100                                                                  10410000
104200         WHEN SQLWARN0 NOT = SPACE                                10420000
104300         WHEN SQLCODE < +0                                        10430000
104400         WHEN SQLCODE > +0                                        10440000
104500         MOVE SE-LOC-NBR       TO PV-DATA                         10450000
104600             DISPLAY '** DATA      ** = ' PV-DATA                 10460000
104700             MOVE '6510'           TO PV-PARAGRAPH-NAME           10470000
104800             MOVE 'SELECT XLT_MDSE_INV_PARM'                      10480000
104900                                   TO PV-DB2-OPERATION-ATTEMPTED  10490000
105000             PERFORM 9999-SQL-ABEND                               10500000
105100     END-EVALUATE.                                                10510000
105200*                                                                 10520000
105300 7000-PRINT-REPORT.                                               10530000
105400     IF PV-LINE-COUNT > PC-PAGE-SIZE                              10540000
105500         PERFORM 8000-PRINT-HEADERS                               10550000
105600         MOVE SE-POLINENO   TO DL-LINE-NBR                        10560000
105700         MOVE SE-SKU-NBR    TO DL-SKU-NBR                         10570000
105800         MOVE '/'           TO DL-SLASH                           10580000
105900         MOVE XLT00003-SKU-STAT-DESC                              10590000
106000                            TO DL-SKU-STAT-DESC                   10600000
106100         MOVE XLT00004-MAJ-CL-NBR                                 10610000
106200                            TO DL-MAJ-CLASS-NBR                   10620000
106300         MOVE XLT00004-SUB-CL-NBR                                 10630000
106400                            TO DL-SUB-CLASS-NBR                   10640000
106500     END-IF                                                       10650000
106600     EVALUATE TRUE                                                10660000
106700         WHEN PS-PRINT-DETAIL                                     10670000
106800             WRITE VERIFIED-RECEIPTS-LINE                         10680000
106900              FROM DETAIL-LINE                                    10690000
107000             AFTER PV-NBR-OF-LINES                                10700000
107100         WHEN PS-PRINT-TOTAL                                      10710000
107200             WRITE VERIFIED-RECEIPTS-LINE                         10720000
107300              FROM TOTAL-LINE                                     10730000
107400             AFTER PV-NBR-OF-LINES                                10740000
107500     END-EVALUATE.                                                10750000
107600     MOVE +1 TO PV-NBR-OF-LINES.                                  10760000
107700                                                                  10770000
107800/*****************************************************************10780000
107900* 7100-READ-EXTRACT-FILE.                                         10790000
108000******************************************************************10800000
108100 7100-READ-EXTRACT-FILE.                                          10810000
108200     READ STORE-EXTRACT-FILE                                      10820000
108300         INTO STORE-EXTRACT-LINE                                  10830000
108400         AT END                                                   10840000
108500             SET PS-END-OF-EXTRACT-FILE TO TRUE                   10850000
108600     END-READ.                                                    10860000
108700                                                                  10870000
108800                                                                  10880000
108900/*****************************************************************10890000
109000* 8000-PRINT-HEADERS.                                             10900000
109100*  PRINT TITLE LINES ON THE REPORT AT EACH PAGE BREAK.  UPDATE    10910000
109200*  THE PAGE NUMBER.                                               10920000
109300******************************************************************10930000
109400 8000-PRINT-HEADERS.                                              10940000
109500                                                                  10950000
109600     ADD 1 TO PV-PAGE-COUNT.                                      10960000
109700     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    10970000
109800                                                                  10980000
109900     WRITE VERIFIED-RECEIPTS-LINE                                 10990000
110000         FROM DP132O-STANDRD-HEADER-132-COLS                      11000000
110100         AFTER ADVANCING PAGE.                                    11010000
110200                                                                  11020000
110300     WRITE VERIFIED-RECEIPTS-LINE                                 11030000
110400         FROM HEADING-LINE-1                                      11040000
110500         AFTER ADVANCING 2 LINES.                                 11050000
110600                                                                  11060000
110700     WRITE VERIFIED-RECEIPTS-LINE                                 11070000
110800         FROM HEADING-LINE-2                                      11080000
110900         AFTER ADVANCING 1 LINES.                                 11090000
111000                                                                  11100000
111100     WRITE VERIFIED-RECEIPTS-LINE                                 11110000
111200         FROM HEADING-LINE-3                                      11120000
111300         AFTER ADVANCING 2 LINES.                                 11130000
111400                                                                  11140000
111500     WRITE VERIFIED-RECEIPTS-LINE                                 11150000
111600         FROM HEADING-LINE-4                                      11160000
111700         AFTER ADVANCING 2 LINES.                                 11170000
111800                                                                  11180000
111900     WRITE VERIFIED-RECEIPTS-LINE                                 11190000
112000         FROM HEADING-LINE-5                                      11200000
112100         AFTER ADVANCING 1 LINES.                                 11210000
112200                                                                  11220000
112300     WRITE VERIFIED-RECEIPTS-LINE                                 11230000
112400         FROM HEADING-LINE-6                                      11240000
112500         AFTER ADVANCING 2 LINES.                                 11250000
112600                                                                  11260000
112700     WRITE VERIFIED-RECEIPTS-LINE                                 11270000
112800         FROM HEADING-LINE-7                                      11280000
112900         AFTER ADVANCING 1 LINES.                                 11290000
113000                                                                  11300000
113100*    INITIALIZE VERIFIED-RECEIPTS-LINE.                           11310000
113200                                                                  11320000
113300*    WRITE VERIFIED-RECEIPTS-LINE                                 11330000
113400*        AFTER ADVANCING 1 LINE.                                  11340000
113500                                                                  11350000
113600     MOVE +2  TO PV-NBR-OF-LINES                                  11360000
113700     MOVE 13 TO PV-LINE-COUNT.                                    11370000
113800                                                                  11380000
113900/*****************************************************************11390000
114000* 9000-EOJ-ROUTINE.                                               11400000
114100******************************************************************11410000
114200 9000-EOJ-ROUTINE.                                                11420000
114300     WRITE VERIFIED-RECEIPTS-LINE                                 11430000
114400         FROM END-OF-REPORT-LINE                                  11440000
114500         AFTER ADVANCING 1 LINES.                                 11450000
114600     CLOSE STORE-EXTRACT-FILE                                     11460000
114700           VERIFIED-RECEIPTS-RPT.                                 11470000
114800                                                                  11480000
114900******************************************************************11490000
115000* 9999-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      11500000
115100* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 11510000
115200******************************************************************11520000
115300 9999-SQL-ABEND.                                                  11530000
115400                                                                  11540000
115500     DISPLAY '** ABEND     **'.                                   11550000
115600     DISPLAY '** PROGRAM   ** = RCKRP040'.                        11560000
115700     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              11570000
115800     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     11580000
115900                                                                  11590000
116000     COPY DPPD004.                                                11600000
116100                                                                  11610000
116200     MOVE +4013 TO ABEND-CODE.                                    11620000
116300     CALL 'ILBOABN0' USING ABEND-CODE.                            11630000
116400                                                                  11640000
