000100 IDENTIFICATION DIVISION.                                         00010011
000200 PROGRAM-ID.      XLKUP042.                                       00020019
000300 AUTHOR.          KOHLS DEPARTMENT STORES.                        00030011
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040011
000500 DATE-WRITTEN.    08/26/2004.                                     00050019
000600 DATE-COMPILED.                                                   00060011
000700******************************************************************00070011
000800**XL DOMAIN TABLE UPDATE - UPDATE FOR TABLE XLT_MDSE_INV_PARM     00080019
000900******************************************************************00090011
001000**THIS PROGRAM USES THE RMS FILE EXTRACT TO UPDATE THE XL DOMAIN  00100019
001100**TABLE.                                                          00110011
001200******************************************************************00120011
001300*DATE:08/26/2004   MADE BY:VISWA KARUTURI INITIAL PROGRAM WRITE   00130019
001400******************************************************************00140011
001500 ENVIRONMENT DIVISION.                                            00150011
001600 CONFIGURATION SECTION.                                           00160011
001700 SOURCE-COMPUTER.        IBM-3090.                                00170011
001800 OBJECT-COMPUTER.        IBM-3090.                                00180011
001900 INPUT-OUTPUT SECTION.                                            00190011
002000 FILE-CONTROL.                                                    00200011
002100                                                                  00210011
002200     SELECT INPUT-FILE                                            00220011
002300            ASSIGN TO INP01.                                      00230011
002400                                                                  00240011
002500 DATA DIVISION.                                                   00250011
002600 FILE SECTION.                                                    00260011
002700                                                                  00270011
002800 FD  INPUT-FILE                                                   00280011
002900     RECORDING MODE F                                             00290011
003000     BLOCK CONTAINS 0 RECORDS                                     00300011
003100     LABEL RECORDS ARE OMITTED                                    00310011
003200     DATA RECORD IS INPUT-RECORD.                                 00320011
003300 01  INPUT-RECORD                    PIC X(330).                  00330029
003400                                                                  00340011
003500 WORKING-STORAGE SECTION.                                         00350011
003600******************************************************************00360011
003700**SWITCHES                                                        00370011
003800******************************************************************00380011
003900 01  PS-PROGRAM-SWITCHES.                                         00390011
004000     05  PS-END-OF-INPUT-FILE-SW         PIC X(01)   VALUE 'N'.   00400011
004100         88  PS-END-OF-INPUT-FILE                    VALUE 'Y'.   00410011
004200         88  PS-NOT-END-OF-INPUT-FILE                VALUE 'N'.   00420011
004300     05  PS-LOC-UPD-NF-SW                PIC X(01)   VALUE 'N'.   00430024
004400         88  PS-INV-UPD-NF-YES                       VALUE 'Y'.   00440024
004500         88  PS-INV-UPD-NF-NO                        VALUE 'N'.   00450024
004600     05  PS-INV-DEL-SW                   PIC X(01)   VALUE 'N'.   00460024
004700         88  PS-INV-DEL-YES                          VALUE 'Y'.   00470024
004800         88  PS-INV-DEL-NO                           VALUE 'N'.   00480024
004900******************************************************************00490011
005000**TIMESTAMP VARIABLES                                             00500011
005100******************************************************************00510011
005200 01  SD-TIMESTAMP                        PIC  X(26)  VALUE SPACES.00520011
005300 01  FILLER REDEFINES SD-TIMESTAMP.                               00530011
005400     05  SD-CURR-DTE                     PIC  X(10).              00540011
005500     05  FILLER                          PIC  X(01).              00550011
005600     05  SD-HOUR                         PIC  X(02).              00560011
005700     05  FILLER                          PIC  X(01).              00570011
005800     05  SD-MINUTE                       PIC  X(02).              00580011
005900     05  FILLER                          PIC  X(01).              00590011
006000     05  SD-SECOND                       PIC  X(02).              00600011
006100     05  FILLER                          PIC  X(01).              00610011
006200     05  SD-MICROSEC                     PIC  X(06).              00620011
006300******************************************************************00630011
006400**PROGRAM CONSTANTS                                               00640011
006500******************************************************************00650011
006600 01  PC-PROGRAM-CONSTANTS.                                        00660011
006700     05  PC-CURRENT-PROGRAM-NAME         PIC X(08)                00670011
006800                                         VALUE 'XLKUP042'.        00680019
006900     05  PC-TABLE-NAME                   PIC X(18)                00690025
007000                                        VALUE 'XLT_MDSE_INV_PARM'.00700019
007100******************************************************************00710011
007200**PROGRAM COUNTERS                                                00720011
007300******************************************************************00730011
007400 01  PC-PROGRAM-COUNTER.                                          00740011
007500     05  PC-INPUT-RECORDS-READ           PIC 9(09) VALUE ZEROS.   00750011
007600     05  PC-RECORDS-INSERTED             PIC 9(09) VALUE ZEROS.   00760011
007700     05  PC-RECORDS-UPDATED              PIC 9(09) VALUE ZEROS.   00770011
007800     05  PC-RECORDS-DELETED              PIC 9(09) VALUE ZEROS.   00780011
007900     05  PC-DEL-RECS-COUNT               PIC 9(09) VALUE ZEROS.   00790024
008000     05  PC-COMMIT-COUNTER               PIC 9(09) VALUE ZEROS.   00800011
008100     05  PC-UPD-NF-RECORDS               PIC 9(09) VALUE ZEROS.   00810013
008200     05  PC-DEL-NF-RECORDS               PIC 9(09) VALUE ZEROS.   00820013
008300     05  PC-DUP-RECORDS                  PIC 9(09) VALUE ZEROS.   00830013
008400     05  PC-532-RECORDS                  PIC 9(09) VALUE ZEROS.   00840013
008500******************************************************************00850011
008600**COPYBOOKS                                                       00860011
008700******************************************************************00870011
008800***INPUT FILE LAYOUT - XL UPDATE FILE FORMAT                      00880022
008900     COPY XLRD053.                                                00890019
009000***VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004        00900011
009100     COPY DPWS004.                                                00910011
009200***DB2 ABEND COPYBOOK                                             00920011
009300     COPY DPWS900.                                                00930011
009400***DB2 MESSAGE AREA                                               00940011
009500     COPY SQLCA2.                                                 00950011
009600***KOHLS CALENDAR ROUTINE                                         00960011
009700     COPY DPWS500.                                                00970011
009800******************************************************************00980011
009900**TABLE INCLUSIONS                                                00990011
010000******************************************************************01000011
010100***DB2 COMMUNICATIONS AREA                                        01010011
010200     EXEC SQL                                                     01020011
010300          INCLUDE SQLCA                                           01030011
010400     END-EXEC.                                                    01040011
010500***TABLE XLT_MDSE_INV_PARM                                        01050019
010600     EXEC SQL                                                     01060011
010700          INCLUDE XLT00025                                        01070038
010800     END-EXEC.                                                    01080011
010900******************************************************************01090011
011000**ERROR HANDLING                                                  01100011
011100******************************************************************01110011
011200 01  PV-MISC-ABEND-FIELDS.                                        01120011
011300     05  PV-PARAGRAPH-NAME               PIC X(30) VALUE SPACE.   01130011
011400     05  PV-OPERATION-MSG-1              PIC X(40) VALUE SPACE.   01140011
011500     05  PV-OPERATION-MSG-2              PIC X(40) VALUE SPACE.   01150011
011600     05  PV-DB2-OPERATION                PIC X(30) VALUE SPACE.   01160011
011700 01  ABEND-CODE                          PIC S9(4) VALUE ZEROS    01170011
011800                                                   COMP SYNC.     01180011
011900     88  ABEND-4001-WRITE-ERROR            VALUE +4001.           01190011
012000     88  ABEND-4002-READ-ERROR             VALUE +4002.           01200011
012100     88  ABEND-4003-CTRL-CARD-ERROR        VALUE +4003.           01210011
012200     88  ABEND-4004-TABLE-ERROR            VALUE +4004.           01220011
012300     88  ABEND-4005-OPEN-ERROR             VALUE +4005.           01230011
012400     88  ABEND-4006-CLOSE-ERROR            VALUE +4006.           01240011
012500     88  ABEND-4007-SEQUENCE-ERROR         VALUE +4007.           01250011
012600     88  ABEND-4008-DATA-ERROR             VALUE +4008.           01260011
012700     88  ABEND-4009-KEY-DATA-ERROR         VALUE +4009.           01270011
012800     88  ABEND-4013-DB2-ERROR              VALUE +4013.           01280011
012900     88  ABEND-4019-CAL-SUB-ERROR          VALUE +4019.           01290011
013000     88  ABEND-4444-FORCED-ABEND           VALUE +4444.           01300011
013100                                                                  01310011
013200 PROCEDURE DIVISION.                                              01320011
013300***************************************************************** 01330011
013400                                                                  01340011
013500     PERFORM 1000-INITIALIZATION.                                 01350011
013600     PERFORM 2000-PROCESS-RECORDS                                 01360011
013700             UNTIL PS-END-OF-INPUT-FILE.                          01370011
013800     PERFORM 9999-WRAPUP.                                         01380011
013900     GOBACK.                                                      01390011
014000                                                                  01400011
014100 EJECT.                                                           01410011
014200******************************************************************01420011
014300**INITIALIZATION AREA                                             01430011
014400******************************************************************01440011
014500 1000-INITIALIZATION.                                             01450011
014600                                                                  01460011
014700     MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME.             01470011
014800                                                                  01480011
014900     OPEN INPUT INPUT-FILE.                                       01490011
015000                                                                  01500011
015100     PERFORM 1100-SELECT-DB2-TIME.                                01510011
015200                                                                  01520011
015300     PERFORM 9999-READ-INPUT-FILE.                                01530011
015400                                                                  01540011
015500 EJECT.                                                           01550011
015600******************************************************************01560011
015700**RETRIEVE TIME FROM DB2                                          01570011
015800******************************************************************01580011
015900 1100-SELECT-DB2-TIME.                                            01590011
016000                                                                  01600011
016100     MOVE '1100-SELECT-DB2-TIME' TO PV-PARAGRAPH-NAME.            01610011
016200                                                                  01620011
016300     EXEC SQL                                                     01630011
016400          SELECT CURRENT TIMESTAMP                                01640011
016500          INTO  :SD-TIMESTAMP                                     01650011
016600          FROM   SYSIBM.SYSDUMMY1                                 01660011
016700     END-EXEC.                                                    01670011
016800                                                                  01680011
016900     IF  SQLCODE NOT EQUAL ZERO                                   01690011
017000         PERFORM 9999-ABEND-ROUTINE                               01700011
017100     END-IF.                                                      01710011
017200                                                                  01720011
017300 EJECT.                                                           01730011
017400******************************************************************01740011
017500**PROCESSES INPUT FILE                                            01750011
017600******************************************************************01760011
017700 2000-PROCESS-RECORDS.                                            01770011
017800                                                                  01780011
017900     MOVE '2000-PROCESS-RECORDS' TO PV-PARAGRAPH-NAME.            01790011
018000                                                                  01800022
018100     PERFORM 2500-MOVE-DATA.                                      01810022
018200                                                                  01820011
018300     EVALUATE TRUE                                                01830011
018400        WHEN XL053-INSERT                                         01840022
018500             PERFORM 2100-INSERT-ROW                              01850011
018600        WHEN XL053-MODIFY                                         01860022
018700             PERFORM 2200-UPDATE-ROW                              01870011
018800        WHEN XL053-DELETE                                         01880022
018900*            SET PS-INV-DEL-YES  TO TRUE                          01890026
019000*            ADD +1 TO PC-DEL-RECS-COUNT                          01900026
019100             PERFORM 2300-DELETE-ROW                              01910026
019200        WHEN OTHER                                                01920011
019300             PERFORM 9999-DISPLAY-STATISTICS                      01930011
019400             PERFORM 9999-ABEND-ROUTINE                           01940011
019500     END-EVALUATE.                                                01950011
019600                                                                  01960011
019700     IF  PC-COMMIT-COUNTER >= 5000                                01970011
019800         PERFORM 9999-COMMIT-DATA                                 01980011
019900         INITIALIZE PC-COMMIT-COUNTER                             01990011
020000     END-IF.                                                      02000011
020100                                                                  02010011
020200     PERFORM 9999-READ-INPUT-FILE.                                02020011
020300                                                                  02030011
020400 EJECT.                                                           02040011
020500***************************************************************** 02050011
020600**INSERT ROW INTO TABLE XLT_MDSE_INV_PARM                         02060019
020700***************************************************************** 02070011
020800 2100-INSERT-ROW.                                                 02080011
020900                                                                  02090011
021000     MOVE '2100-INSERT-ROW' TO PV-PARAGRAPH-NAME.                 02100011
021100                                                                  02110011
021200     EXEC SQL                                                     02120011
021300       INSERT INTO XLT_MDSE_INV_PARM (INV_ID                      02130038
021310                                     ,LOC_NBR                     02140027
021400                                     ,INV_DTE                     02150019
021500                                     ,PLND_INV_DTE                02160019
021600                                     ,SCN_INV_IND                 02170019
021700                                     ,UNIT_BK_DTE                 02180019
021800                                     ,FIN_BK_DTE                  02190019
021900                                     ,PLND_UNIT_BK_DTE            02200019
022000                                     ,PLND_FIN_BK_DTE             02210019
022100                                     ,INV_RCVD_DTE                02220019
022200                                     ,STKRM_DAY_QTY               02230019
022300                                     ,CORR_DAY_QTY                02240019
022400                                     ,SOR_LAST_UPD_TMST           02250019
022500                                     ,SOR_UPD_BY_USR_ID           02260019
022600                                     ,LDGR_CTOFF_TMST             02270019
022700                                     ,DC_CTOFF_DTE                02280019
022800                                     ,PHY_CNT_TMST                02290019
022900                                     ,SLS_ADJ_CPLD_IND            02300019
023000                                     ,SCHD_PHY_CNT_CDE            02310019
023100                                     ,XFER_INV_CTOFF_DTE          02320019
023200                                     ,SHEET_INV_CPLD_IND          02330019
023300                                     ,UNT_BKG_STAT_CDE            02340019
023400                                     ,FIL_TOT_BAL_CDE             02350019
023500                                     ,STKRM_WDRWL_IND             02360019
023600                                     ,MFSTNG_IND                  02370019
023700                                     ,INV_SRVC_CDE                02380019
023800                                     ,SHEET_INV_REQR_IND          02390019
023900                                     ,TMST_EDT_STAT_CDE           02400027
023910                                     ,INV_NM                      02410037
023920                                     ,ACTV_IND                    02420037
023930                                     ,OPN_FSCL_MN_NBR             02430037
023940                                     ,OPN_FSCL_MN_DTE             02440037
023950                                     ,ITM_CTOFF_IND               02450037
023960                                     ,SHTG_ACTL_INV_DTE           02460037
023970                                     ,JOB_NM                      02470037
023980                                     ,INV_CLO_DTE                 02480037
023990                                     ,FINCL_INV_STAT_CDE          02490037
023991                                     ,LOC_INV_STAT_CDE            02500037
023992                                     ,LOC_DEL_RSN_TXT             02510037
023993                                     ,LOC_DEL_DTE)                02520037
024000                             VALUES (:XLT00025-INV-ID             02530027
024010                                    ,:XLT00025-LOC-NBR            02540027
024100                                    ,:XLT00025-INV-DTE            02550019
024200                                    ,:XLT00025-PLND-INV-DTE       02560019
024300                                    ,:XLT00025-SCN-INV-IND        02570019
024400                                    ,:XLT00025-UNIT-BK-DTE        02580019
024500                                    ,:XLT00025-FIN-BK-DTE         02590019
024600                                    ,:XLT00025-PLND-UNIT-BK-DTE   02600019
024700                                    ,:XLT00025-PLND-FIN-BK-DTE    02610019
024800                                    ,:XLT00025-INV-RCVD-DTE       02620019
024900                                    ,:XLT00025-STKRM-DAY-QTY      02630019
025000                                    ,:XLT00025-CORR-DAY-QTY       02640019
025100                                    ,:XLT00025-SOR-LAST-UPD-TMST  02650019
025200                                    ,:XLT00025-SOR-UPD-BY-USR-ID  02660019
025300                                    ,:XLT00025-LDGR-CTOFF-TMST    02670019
025400                                    ,:XLT00025-DC-CTOFF-DTE       02680019
025500                                    ,:XLT00025-PHY-CNT-TMST       02690019
025600                                    ,:XLT00025-SLS-ADJ-CPLD-IND   02700019
025700                                    ,:XLT00025-SCHD-PHY-CNT-CDE   02710019
025800                                    ,:XLT00025-XFER-INV-CTOFF-DTE 02720019
025900                                    ,:XLT00025-SHEET-INV-CPLD-IND 02730019
026000                                    ,:XLT00025-UNT-BKG-STAT-CDE   02740019
026100                                    ,:XLT00025-FIL-TOT-BAL-CDE    02750019
026200                                    ,:XLT00025-STKRM-WDRWL-IND    02760019
026300                                    ,:XLT00025-MFSTNG-IND         02770019
026400                                    ,:XLT00025-INV-SRVC-CDE       02780019
026500                                    ,:XLT00025-SHEET-INV-REQR-IND 02790019
026600                                    ,:XLT00025-TMST-EDT-STAT-CDE  02800027
026610                                    ,:XLT00025-INV-NM             02810037
026620                                    ,:XLT00025-ACTV-IND           02820037
026630                                    ,:XLT00025-OPN-FSCL-MN-NBR    02830037
026640                                    ,:XLT00025-OPN-FSCL-MN-DTE    02840037
026650                                    ,:XLT00025-ITM-CTOFF-IND      02850037
026660                                    ,:XLT00025-SHTG-ACTL-INV-DTE  02860037
026670                                    ,:XLT00025-JOB-NM             02870037
026680                                    ,:XLT00025-INV-CLO-DTE        02880037
026690                                    ,:XLT00025-FINCL-INV-STAT-CDE 02890037
026691                                    ,:XLT00025-LOC-INV-STAT-CDE   02900037
026692                                    ,:XLT00025-LOC-DEL-RSN-TXT    02910037
026693                                    ,:XLT00025-LOC-DEL-DTE)       02920037
026700     END-EXEC.                                                    02930011
026800                                                                  02940011
026900     EVALUATE TRUE                                                02950011
027000        WHEN SQLCODE = ZERO                                       02960011
027100             ADD +1                       TO PC-RECORDS-INSERTED  02970011
027200             ADD +1                       TO PC-COMMIT-COUNTER    02980011
027300        WHEN SQLCODE = -803                                       02990013
027400             ADD +1                       TO PC-DUP-RECORDS       03000013
027500        WHEN OTHER                                                03010011
027600             DISPLAY 'TRYING TO INSERT XLT_MDSE_INV_PARM '        03020019
027700             DISPLAY 'INV ID  ' XLT00025-INV-ID                   03030027
027710             DISPLAY 'LOC NBR ' XLT00025-LOC-NBR                  03040027
027800             DISPLAY 'INV DTE ' XLT00025-INV-DTE                  03050019
027810             DISPLAY 'PLND-INV-DT ' XLT00025-PLND-INV-DTE         03060039
027820             DISPLAY 'SCN-INV-IND ' XLT00025-SCN-INV-IND          03070039
027830             DISPLAY 'UNIT-BK-DTE ' XLT00025-UNIT-BK-DTE          03080039
027840             DISPLAY 'FIN-BK-DTE  ' XLT00025-FIN-BK-DTE           03090039
027850             DISPLAY 'PLND-UNIT-B ' XLT00025-PLND-UNIT-BK-DTE     03100039
027860             DISPLAY 'PLND-FIN-BK ' XLT00025-PLND-FIN-BK-DTE      03110039
027870             DISPLAY 'INV-RCVD-DT ' XLT00025-INV-RCVD-DTE         03120039
027880             DISPLAY 'STKRM-DAY-Q ' XLT00025-STKRM-DAY-QTY        03130039
027890             DISPLAY 'CORR-DAY-QT ' XLT00025-CORR-DAY-QTY         03140039
027891             DISPLAY 'SOR-LAST-UP ' XLT00025-SOR-LAST-UPD-TMST    03150039
027892             DISPLAY 'SOR-UPD-BY- ' XLT00025-SOR-UPD-BY-USR-ID    03160039
027893             DISPLAY 'LDGR-CTOFF- ' XLT00025-LDGR-CTOFF-TMST      03170039
027894             DISPLAY 'DC-CTOFF-DT ' XLT00025-DC-CTOFF-DTE         03180039
027895             DISPLAY 'PHY-CNT-TMS ' XLT00025-PHY-CNT-TMST         03190039
027896             DISPLAY 'SLS-ADJ-CPL ' XLT00025-SLS-ADJ-CPLD-IND     03200039
027897             DISPLAY 'SCHD-PHY-CN ' XLT00025-SCHD-PHY-CNT-CDE     03210039
027898             DISPLAY 'XFER-INV-CT ' XLT00025-XFER-INV-CTOFF-DTE   03220039
027899             DISPLAY 'SHEET-INV-C ' XLT00025-SHEET-INV-CPLD-IND   03230039
027900             DISPLAY 'UNT-BKG-STA ' XLT00025-UNT-BKG-STAT-CDE     03240039
027901             DISPLAY 'FIL-TOT-BAL ' XLT00025-FIL-TOT-BAL-CDE      03250039
027902             DISPLAY 'STKRM-WDRWL ' XLT00025-STKRM-WDRWL-IND      03260039
027903             DISPLAY 'MFSTNG-IND  ' XLT00025-MFSTNG-IND           03270039
027904             DISPLAY 'INV-SRVC-CD ' XLT00025-INV-SRVC-CDE         03280039
027905             DISPLAY 'SHEET-INV-R ' XLT00025-SHEET-INV-REQR-IND   03290039
027906             DISPLAY 'TMST-EDT-ST ' XLT00025-TMST-EDT-STAT-CDE    03300039
027907             DISPLAY 'INV-NM      ' XLT00025-INV-NM               03310039
027908             DISPLAY 'ACTV-IND    ' XLT00025-ACTV-IND             03320039
027909             DISPLAY 'OPN-FSCL-MN ' XLT00025-OPN-FSCL-MN-NBR      03330039
027910             DISPLAY 'OPN-FSCL-MN ' XLT00025-OPN-FSCL-MN-DTE      03340039
027911             DISPLAY 'ITM-CTOFF-I ' XLT00025-ITM-CTOFF-IND        03350039
027912             DISPLAY 'SHTG-ACTL-I ' XLT00025-SHTG-ACTL-INV-DTE    03360039
027913             DISPLAY 'JOB-NM      ' XLT00025-JOB-NM               03370039
027914             DISPLAY 'INV-CLO-DTE ' XLT00025-INV-CLO-DTE          03380039
027915             DISPLAY 'FINCL-INV-S ' XLT00025-FINCL-INV-STAT-CDE   03390039
027916             DISPLAY 'LOC-INV-STA ' XLT00025-LOC-INV-STAT-CDE     03400039
027917             DISPLAY 'LOC-DEL-RSN ' XLT00025-LOC-DEL-RSN-TXT      03410039
027919             DISPLAY 'LOC-DEL-DTE ' XLT00025-LOC-DEL-DTE          03420039
027930             PERFORM 9999-DISPLAY-STATISTICS                      03430039
028000             PERFORM 9999-ABEND-ROUTINE                           03440011
028100     END-EVALUATE.                                                03450011
028200                                                                  03460011
028300 EJECT.                                                           03470011
028400***************************************************************** 03480011
028500**UPDATE ROW INTO TABLE XLT_MDSE_INV_PARM                         03490019
028600***************************************************************** 03500011
028700 2200-UPDATE-ROW.                                                 03510011
028800                                                                  03520011
028900     MOVE '2200-UPDATE-ROW' TO PV-PARAGRAPH-NAME.                 03530011
029000                                                                  03540011
029100     EXEC SQL                                                     03550011
029200          UPDATE XLT_MDSE_INV_PARM                                03560038
029300          SET PLND_INV_DTE       = :XLT00025-PLND-INV-DTE         03570019
029400             ,INV_DTE            = :XLT00025-INV-DTE              03580041
029400             ,SCN_INV_IND        = :XLT00025-SCN-INV-IND          03590041
029500             ,UNIT_BK_DTE        = :XLT00025-UNIT-BK-DTE          03600019
029600             ,FIN_BK_DTE         = :XLT00025-FIN-BK-DTE           03610019
029700             ,PLND_UNIT_BK_DTE   = :XLT00025-PLND-UNIT-BK-DTE     03620019
029800             ,PLND_FIN_BK_DTE    = :XLT00025-PLND-FIN-BK-DTE      03630019
029900             ,INV_RCVD_DTE       = :XLT00025-INV-RCVD-DTE         03640019
030000             ,STKRM_DAY_QTY      = :XLT00025-STKRM-DAY-QTY        03650019
030100             ,CORR_DAY_QTY       = :XLT00025-CORR-DAY-QTY         03660019
030200             ,SOR_LAST_UPD_TMST  = :XLT00025-SOR-LAST-UPD-TMST    03670019
030300             ,SOR_UPD_BY_USR_ID  = :XLT00025-SOR-UPD-BY-USR-ID    03680019
030400             ,LDGR_CTOFF_TMST    = :XLT00025-LDGR-CTOFF-TMST      03690019
030500             ,DC_CTOFF_DTE       = :XLT00025-DC-CTOFF-DTE         03700019
030600             ,PHY_CNT_TMST       = :XLT00025-PHY-CNT-TMST         03710019
030700             ,SLS_ADJ_CPLD_IND   = :XLT00025-SLS-ADJ-CPLD-IND     03720019
030800             ,SCHD_PHY_CNT_CDE   = :XLT00025-SCHD-PHY-CNT-CDE     03730019
030900             ,XFER_INV_CTOFF_DTE = :XLT00025-XFER-INV-CTOFF-DTE   03740019
031000             ,SHEET_INV_CPLD_IND = :XLT00025-SHEET-INV-CPLD-IND   03750019
031100             ,UNT_BKG_STAT_CDE   = :XLT00025-UNT-BKG-STAT-CDE     03760019
031200             ,FIL_TOT_BAL_CDE    = :XLT00025-FIL-TOT-BAL-CDE      03770019
031300             ,STKRM_WDRWL_IND    = :XLT00025-STKRM-WDRWL-IND      03780019
031400             ,MFSTNG_IND         = :XLT00025-MFSTNG-IND           03790019
031500             ,INV_SRVC_CDE       = :XLT00025-INV-SRVC-CDE         03800019
031600             ,SHEET_INV_REQR_IND = :XLT00025-SHEET-INV-REQR-IND   03810019
031700             ,TMST_EDT_STAT_CDE  = :XLT00025-TMST-EDT-STAT-CDE    03820019
031710             ,INV_NM             = :XLT00025-INV-NM               03830027
031720             ,ACTV_IND           = :XLT00025-ACTV-IND             03840027
031730             ,OPN_FSCL_MN_NBR    = :XLT00025-OPN-FSCL-MN-NBR      03850027
031740             ,OPN_FSCL_MN_DTE    = :XLT00025-OPN-FSCL-MN-DTE      03860027
031750             ,ITM_CTOFF_IND      = :XLT00025-ITM-CTOFF-IND        03870027
031760             ,SHTG_ACTL_INV_DTE  = :XLT00025-SHTG-ACTL-INV-DTE    03880027
031770             ,JOB_NM             = :XLT00025-JOB-NM               03890027
031780             ,INV_CLO_DTE        = :XLT00025-INV-CLO-DTE          03900027
031790             ,FINCL_INV_STAT_CDE = :XLT00025-FINCL-INV-STAT-CDE   03910027
031791             ,LOC_INV_STAT_CDE   = :XLT00025-LOC-INV-STAT-CDE     03920027
031792             ,LOC_DEL_RSN_TXT    = :XLT00025-LOC-DEL-RSN-TXT      03930027
031793             ,LOC_DEL_DTE        = :XLT00025-LOC-DEL-DTE          03940027
031800          WHERE  INV_ID  = :XLT00025-INV-ID                       03950027
031810            AND  LOC_NBR = :XLT00025-LOC-NBR                      03960027
032000     END-EXEC.                                                    03970011
032100                                                                  03980011
032200     EVALUATE TRUE                                                03990011
032300        WHEN SQLCODE = ZERO                                       04000011
032400             ADD +1                       TO PC-RECORDS-UPDATED   04010011
032500             ADD +1                       TO PC-COMMIT-COUNTER    04020011
032600        WHEN SQLCODE = +100                                       04030035
032700             SET PS-INV-UPD-NF-YES        TO TRUE                 04040024
032800             ADD +1                       TO PC-UPD-NF-RECORDS    04050013
032900             DISPLAY 'UPDATE OF XLT_MDSE_INV_PARM NOT FOUND '     04060024
033000             DISPLAY 'INV ID  ' XLT00025-INV-ID                   04070027
033010             DISPLAY 'LOC NBR ' XLT00025-LOC-NBR                  04080027
033100             DISPLAY 'INV DTE ' XLT00025-INV-DTE                  04090024
033200        WHEN SQLCODE = -803                                       04100013
033300             ADD +1                       TO PC-DUP-RECORDS       04110013
033400        WHEN OTHER                                                04120011
033500             DISPLAY 'TRYING TO UPDATE XLT_MDSE_INV_PARM '        04130019
033600             DISPLAY 'INV ID  ' XLT00025-INV-ID                   04140027
033610             DISPLAY 'LOC NBR ' XLT00025-LOC-NBR                  04150027
033700             DISPLAY 'INV DTE ' XLT00025-INV-DTE                  04160020
033800             PERFORM 9999-DISPLAY-STATISTICS                      04170011
033900             PERFORM 9999-ABEND-ROUTINE                           04180011
034000     END-EVALUATE.                                                04190011
034100                                                                  04200011
034200 EJECT.                                                           04210011
034300***************************************************************** 04220011
034400**DELETE ROW INTO TABLE XLT_MDSE_INV_PARM                         04230019
034500***************************************************************** 04240011
034600 2300-DELETE-ROW.                                                 04250011
034700                                                                  04260011
034800     MOVE '2300-DELETE-ROW' TO PV-PARAGRAPH-NAME.                 04270011
034900                                                                  04280011
035000     EXEC SQL                                                     04290011
035100          DELETE FROM XLT_MDSE_INV_PARM                           04300038
035200          WHERE  INV_ID  = :XLT00025-INV-ID                       04310027
035210            AND  LOC_NBR = :XLT00025-LOC-NBR                      04320027
035300            AND  INV_DTE = :XLT00025-INV-DTE                      04330020
035400     END-EXEC.                                                    04340011
035500                                                                  04350011
035600     EVALUATE TRUE                                                04360011
035700        WHEN SQLCODE = ZERO                                       04370011
035800             ADD +1                       TO PC-RECORDS-DELETED   04380011
035900             ADD +1                       TO PC-COMMIT-COUNTER    04390011
036000        WHEN SQLCODE = +100                                       04400013
036100             ADD +1                       TO PC-DEL-NF-RECORDS    04410013
036200        WHEN SQLCODE = -532                                       04420013
036300             ADD +1                       TO PC-532-RECORDS       04430013
036400        WHEN OTHER                                                04440011
036500             DISPLAY 'TRYING TO DELETE XLT_MDSE_INV_PARM '        04450019
036600             DISPLAY 'INV ID  ' XLT00025-INV-ID                   04460027
036610             DISPLAY 'LOC NBR ' XLT00025-LOC-NBR                  04470027
036700             DISPLAY 'INV DTE ' XLT00025-INV-DTE                  04480020
036800             PERFORM 9999-DISPLAY-STATISTICS                      04490011
036900             PERFORM 9999-ABEND-ROUTINE                           04500011
037000     END-EVALUATE.                                                04510011
037100                                                                  04520011
037200 EJECT.                                                           04530011
037300******************************************************************04540021
037400**PROCESSES INPUT FILE                                            04550021
037500******************************************************************04560021
037600 2500-MOVE-DATA.                                                  04570021
037700                                                                  04580021
037710     MOVE XL053-INV-ID             TO XLT00025-INV-ID.            04590027
037800     MOVE XL053-LOC-NBR            TO XLT00025-LOC-NBR.           04600021
037900     MOVE XL053-INV-DTE            TO XLT00025-INV-DTE.           04610021
038000     MOVE XL053-PLND-INV-DTE       TO XLT00025-PLND-INV-DTE.      04620021
038100     MOVE XL053-SCN-INV-IND        TO XLT00025-SCN-INV-IND.       04630021
038200     MOVE XL053-UNIT-BK-DTE        TO XLT00025-UNIT-BK-DTE.       04640021
038300     MOVE XL053-FIN-BK-DTE         TO XLT00025-FIN-BK-DTE.        04650021
038400     MOVE XL053-PLND-UNIT-BK-DTE   TO XLT00025-PLND-UNIT-BK-DTE.  04660021
038500     MOVE XL053-PLND-FIN-BK-DTE    TO XLT00025-PLND-FIN-BK-DTE.   04670021
038600     MOVE XL053-INV-RCVD-DTE       TO XLT00025-INV-RCVD-DTE.      04680021
038700     MOVE XL053-STKRM-DAY-QTY      TO XLT00025-STKRM-DAY-QTY.     04690021
038800     MOVE XL053-CORR-DAY-QTY       TO XLT00025-CORR-DAY-QTY.      04700021
038900     MOVE XL053-SOR-LAST-UPD-TMST  TO XLT00025-SOR-LAST-UPD-TMST. 04710025
039000     MOVE XL053-SOR-UPD-BY-USR-ID  TO XLT00025-SOR-UPD-BY-USR-ID. 04720025
039100     MOVE XL053-LDGR-CTOFF-TMST    TO XLT00025-LDGR-CTOFF-TMST.   04730021
039200     MOVE XL053-DC-CTOFF-DTE       TO XLT00025-DC-CTOFF-DTE.      04740021
039300     MOVE XL053-PHY-CNT-TMST       TO XLT00025-PHY-CNT-TMST.      04750021
039400     MOVE XL053-SLS-ADJ-CPLD-IND   TO XLT00025-SLS-ADJ-CPLD-IND.  04760021
039500     MOVE XL053-SCHD-PHY-CNT-CDE   TO XLT00025-SCHD-PHY-CNT-CDE . 04770021
039600     MOVE XL053-XFER-INV-CTOFF-DTE TO XLT00025-XFER-INV-CTOFF-DTE.04780021
039700     MOVE XL053-SHEET-INV-CPLD-IND TO XLT00025-SHEET-INV-CPLD-IND.04790021
039800     MOVE XL053-UNT-BKG-STAT-CDE   TO XLT00025-UNT-BKG-STAT-CDE.  04800021
039900     MOVE XL053-FIL-TOT-BAL-CDE    TO XLT00025-FIL-TOT-BAL-CDE.   04810021
040000     MOVE XL053-STKRM-WDRWL-IND    TO XLT00025-STKRM-WDRWL-IND.   04820021
040100     MOVE XL053-MFSTNG-IND         TO XLT00025-MFSTNG-IND.        04830021
040200     MOVE XL053-INV-SRVC-CDE       TO XLT00025-INV-SRVC-CDE.      04840021
040300     MOVE XL053-SHEET-INV-REQR-IND TO XLT00025-SHEET-INV-REQR-IND.04850025
040400     MOVE XL053-TMST-EDT-STAT-CDE  TO XLT00025-TMST-EDT-STAT-CDE. 04860021
040410     MOVE XL053-INV-NM             TO XLT00025-INV-NM.            04870028
040420     MOVE XL053-ACTV-IND           TO XLT00025-ACTV-IND.          04880028
040430     MOVE XL053-OPN-FSCL-MN-NBR    TO XLT00025-OPN-FSCL-MN-NBR.   04890028
040440     MOVE XL053-OPN-FSCL-MN-DTE    TO XLT00025-OPN-FSCL-MN-DTE.   04900028
040450     MOVE XL053-ITM-CTOFF-IND      TO XLT00025-ITM-CTOFF-IND.     04910028
040460     MOVE XL053-SHTG-ACTL-INV-DTE  TO XLT00025-SHTG-ACTL-INV-DTE. 04920028
040470     MOVE XL053-JOB-NM             TO XLT00025-JOB-NM.            04930028
040480     MOVE XL053-INV-CLO-DTE        TO XLT00025-INV-CLO-DTE.       04940028
040490     MOVE XL053-FINCL-INV-STAT-CDE TO XLT00025-FINCL-INV-STAT-CDE.04950028
040491     MOVE XL053-LOC-INV-STAT-CDE   TO XLT00025-LOC-INV-STAT-CDE.  04960028
040492     MOVE XL053-LOC-DEL-RSN-TXT    TO XLT00025-LOC-DEL-RSN-TXT.   04970028
040493     MOVE XL053-LOC-DEL-DTE        TO XLT00025-LOC-DEL-DTE.       04980028
040500                                                                  04990021
040600 EJECT.                                                           05000021
040700***************************************************************** 05010011
040800**READ INPUT FILE                                                 05020011
040900***************************************************************** 05030011
041000 9999-READ-INPUT-FILE.                                            05040011
041100                                                                  05050011
041200     READ INPUT-FILE INTO XL053-INVPAR-TRANS-REC                  05060020
041300          AT END SET PS-END-OF-INPUT-FILE TO TRUE                 05070011
041400     END-READ.                                                    05080011
041500                                                                  05090011
041600     IF  PS-NOT-END-OF-INPUT-FILE                                 05100011
041700         ADD +1 TO PC-INPUT-RECORDS-READ                          05110011
041800     END-IF.                                                      05120011
041900                                                                  05130011
042000 EJECT.                                                           05140011
042100****************************************************************  05150011
042200*END OF PROGRAM ROUTINE                                           05160011
042300****************************************************************  05170011
042400 9999-WRAPUP.                                                     05180011
042500                                                                  05190011
042600     PERFORM 9999-COMMIT-DATA.                                    05200011
042700                                                                  05210011
042800*    IF PS-INV-DEL-YES                                            05220026
042900*        MOVE 4092        TO RETURN-CODE                          05230026
043000*    END-IF.                                                      05240026
043100                                                                  05250024
043200     IF PS-INV-UPD-NF-YES                                         05260024
043300         MOVE 4093        TO RETURN-CODE                          05270024
043400     END-IF.                                                      05280024
043500                                                                  05290024
043600     CLOSE INPUT-FILE.                                            05300011
043700                                                                  05310011
043800     PERFORM 9999-DISPLAY-STATISTICS.                             05320011
043900                                                                  05330011
044000 EJECT.                                                           05340011
044100****************************************************************  05350011
044200*COMMIT DATA TO DATABASE                                          05360011
044300****************************************************************  05370011
044400 9999-COMMIT-DATA.                                                05380011
044500                                                                  05390011
044600     MOVE '9999-COMMIT-DATA' TO PV-PARAGRAPH-NAME.                05400011
044700                                                                  05410011
044800     EXEC SQL                                                     05420011
044900          COMMIT                                                  05430011
045000     END-EXEC.                                                    05440011
045100                                                                  05450011
045200     EVALUATE TRUE                                                05460011
045300        WHEN SQLCODE = ZERO                                       05470011
045400             CONTINUE                                             05480011
045500        WHEN OTHER                                                05490011
045600             PERFORM 9999-DISPLAY-STATISTICS                      05500011
045700             PERFORM 9999-ABEND-ROUTINE                           05510011
045800     END-EVALUATE.                                                05520011
045900                                                                  05530011
046000 EJECT.                                                           05540011
046100****************************************************************  05550011
046200*DISPLAY PROGRAM STATISTICS                                       05560011
046300****************************************************************  05570011
046400 9999-DISPLAY-STATISTICS.                                         05580011
046500                                                                  05590011
046600     DISPLAY '*************************************************'. 05600011
046700     DISPLAY '* PROGRAM...............: ' PC-CURRENT-PROGRAM-NAME.05610011
046800     DISPLAY '* TABLE.................: ' PC-TABLE-NAME.          05620017
046900     DISPLAY '* TIMESTAMP.............: ' SD-TIMESTAMP.           05630011
047000     DISPLAY '*************************************************'. 05640011
047100     DISPLAY '* DATE/TIMESTAMP........: ' SD-TIMESTAMP.           05650011
047200     DISPLAY '* TOTAL RECORDS READ....: ' PC-INPUT-RECORDS-READ.  05660011
047300     DISPLAY '* TOTAL RECORDS INSERTED: ' PC-RECORDS-INSERTED.    05670011
047400     DISPLAY '* TOTAL RECORDS UPDATED.: ' PC-RECORDS-UPDATED.     05680011
047500     DISPLAY '* TOTAL RECORDS DELETED.: ' PC-RECORDS-DELETED.     05690026
047600*    DISPLAY '* TOTAL DELETE REC FOUND: ' PC-DEL-RECS-COUNT.      05700026
047700     DISPLAY '* DUPLICATE REC IGNORED.: ' PC-DUP-RECORDS.         05710013
047800     DISPLAY '* REC NOT FOUND FOR DEL.: ' PC-DEL-NF-RECORDS.      05720013
047900     DISPLAY '* REC NOT FOUND FOR UPD.: ' PC-UPD-NF-RECORDS.      05730013
048000     DISPLAY '* REC DELETE RESTRICTED.: ' PC-532-RECORDS.         05740026
048100     DISPLAY '*************************************************'. 05750011
048200                                                                  05760011
048300 EJECT.                                                           05770011
048400******************************************************************05780011
048500**SQL ABEND ROUTINE                                               05790011
048600******************************************************************05800011
048700 9999-ABEND-ROUTINE.                                              05810011
048800                                                                  05820011
048900     DISPLAY '** ABEND     **'.                                   05830011
049000     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        05840011
049100     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              05850011
049200     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               05860011
049300******************************************************************05870011
049400* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     05880011
049500* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      05890011
049600******************************************************************05900011
049700     COPY DPPD004.                                                05910011
049800     SET ABEND-4013-DB2-ERROR TO TRUE.                            05920011
049900     CALL 'ILBOABN0' USING ABEND-CODE.                            05930011
050000                                                                  05940011
050100 EJECT                                                            05950011
