      *-----------------------*                                         00010082
       IDENTIFICATION DIVISION.                                         00020082
      *-----------------------*                                         00030082
       PROGRAM-ID.    TFKCS440.                                         00040082
       AUTHOR.        JACK KRAMER.                                      00050082
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060082
       DATE-WRITTEN.  SEPTEMBER 1996.                                   00070082
       DATE-COMPILED.                                                   00080082
      *----------------------------------------------------------------*00090082
      *    P440 - CREATE TRANSFER WORKSHEET SETUP.                     *00100082
      *                                                                *00110082
      *    THIS PROGRAM ALLOWS THE USER TO ENTER A TRANSFER TYPE AND A *00120082
      *    CONTAINER TYPE FOR THE CREATION OF A TRANSFER WORKSHEET.    *00130082
      *----------------------------------------------------------------*00140082
      *-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=*00150082
      * CONTAINS LOGIC TO OVERRIDE MENOMENEE FALLS AND FINDLAY DC'S TO *00160082
      * RTV'S. (085 BECOMES 801 AND 810 BECOMES 811'.                  *00170082
      *-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=*00180082
      ******************************************************************00181082
      * 6/02/2003 - RAY GRAF                                            00182082
      *  PROCESS NONINTELLIGENT SKU.                                    00183082
      ******************************************************************00184082
080204* 8/02/2004 - RAY GRAF                                            00185086
080204* CHANGES TO TINVPAR TO ACCESS LOC_NBR                            00186086
080204* USE DP020-LOCATION-NBR INSTEAD OF DP020-LOCATION                00186188
      ******************************************************************00187083
100404*10/04/2004 - RAY GRAF                                            00188089
100404*  EXPAND STORE NUMBER. MAKE DOMAIN COMPLIANT.                    00189089
      ******************************************************************00189189
051705*  DATE 05/17/05 RAY GRAF                                         00189292
051705*  REMOVE PHYSICAL INVENTORY LOGIC                                00189392
060110******************************************************************00189499
060110*  DATE 06/01/10 JACKIE HELING                                    00189599
060110*  BLOCK CERTAIN LOCATIONS FROM SENDING/RECEIVING TRANSFERS.      00189699
060110******************************************************************00189799
033111* WR39649 -  DAVID WELLER - 03/31/2011                            00189899
033111*            MLOF - DO NOT EXCLUDE LOCATIONS 807, 808 AND 809     00189999
033111***************************************************************** 00190099
CICS  * CHANGED 11/17/2022    BY JIM HUNTER      WR: CHG0278345         00190199
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00190299
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00190399
CICS  *-----------------------------------------------------------------00190499
                                                                        00191099
       ENVIRONMENT DIVISION.                                            00200082
                                                                        00210082
       DATA DIVISION.                                                   00220082
                                                                        00230082
       WORKING-STORAGE SECTION.                                         00240082
      *                                                                 00250082
       01  DK-DB2-KEYS.                                                 00420082
           05  DK-STORE-NBR                   PIC S9(4)   VALUE ZERO    00460086
                                                          COMP.         00470082
           05  DK-STORE-NBR-9                 PIC S9(04)  VALUE ZERO    00480086
                                                          COMP.         00481086
      *                                                                 00510082
       01  PC-PROGRAM-CONSTANTS.                                        00520082
           05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'TF440A  '. 00530082
           05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'TFKM440 '. 00540082
           05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'TFKCS440'. 00550082
           05  PC-MAX-TYPES              PIC S9(03)  VALUE  +10 COMP-3. 00560082
           05  PC-OFFSITE-STORAGE        PIC  X(02)  VALUE  '07'.       00570082
           05  PC-STOCK-BAL-CORP-1CHAR   PIC  X(01)  VALUE  '3'.        00580082
           05  PC-STOCK-BAL-STORE-1CHAR  PIC  X(01)  VALUE  '4'.        00590082
           05  PC-STOCK-BAL-STORE        PIC  X(02)  VALUE  '04'.       00600082
           05  PC-STOCK-BALANCE-MSG      PIC  X(13)  VALUE              00610082
                                         'STOCK BALANCE'.               00620082
           05  PC-CUST-NON-HANDCARRY-MSG PIC  X(22)  VALUE              00630082
                                         'CUSTOMER NON-HANDCARRY'.      00640082
           05  PC-NON-RETAIL             PIC  X(02)  VALUE  '06'.       00650082
           05  PC-HAND-CARRY             PIC  X(01)  VALUE  '5'.        00660082
           05  PC-CUSTOMER               PIC  X(01)  VALUE  '5'.        00670082
           05  PC-NONRETAIL              PIC  X(01)  VALUE  '6'.        00680082
           05  PC-YES                    PIC  X(01)  VALUE  'Y'.        00690082
           05  PC-DEPT-STORE             PIC  X(02)  VALUE  'DS'.       00700082
           05  PC-RTV-TYPE               PIC  X(02)  VALUE  'RV'.       00710082
           05  PC-CORPORATE              PIC  X(02)  VALUE  'HQ'.       00720082
060110     05  PC-CNTRL-STK              PIC  X(02)  VALUE  'CS'.       00730099
           05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00960082
                                                          COMP-3.       00970082
051705*    05 PC-MAX-DATE               PIC X(10) VALUE '9999-09-09'.   00980092
051705*    05 PC-MIN-DATE               PIC X(10) VALUE '0001-01-01'.   00981092
100404*    05  PC-RTV-MEN-FLS            PIC  X(03)  VALUE '801'.       00990089
100404     05  PC-RTV-MEN-FLS            PIC  9(04)  VALUE  801.        00991091
           05  PC-DC-MEN-FLS             PIC  9(05)  VALUE  085.        01000089
100404*    05  PC-RTV-FINDLAY            PIC  X(03)  VALUE '811'.       01010089
100404     05  PC-RTV-FINDLAY            PIC  9(04)  VALUE  811.        01011091
           05  PC-DC-FINDLAY             PIC  9(05)  VALUE  810.        01020087
           05  PC-TSYMSG-NUMBERS.                                       01030082
               10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      01040082
               10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      01050082
               10  PC-TSYMSG-00095       PIC  9(05)  VALUE  00095.      01060082
               10  PC-TSYMSG-00224       PIC  9(05)  VALUE  00224.      01070082
               10  PC-TSYMSG-01412       PIC  9(05)  VALUE  01412.      01080082
               10  PC-TSYMSG-01482       PIC  9(05)  VALUE  01482.      01090082
               10  PC-TSYMSG-01539       PIC  9(05)  VALUE  01539.      01100082
               10  PC-TSYMSG-01555       PIC  9(05)  VALUE  01555.      01110082
               10  PC-TSYMSG-01675       PIC  9(05)  VALUE  01675.      01120082
               10  PC-TSYMSG-02002       PIC  9(05)  VALUE  02002.      01130082
               10  PC-TSYMSG-99907       PIC  9(05)  VALUE  99907.      01140082
               10  PC-TSYMSG-02023       PIC  9(05)  VALUE  02023.      01141082
      *                                                                 01150082
       01  PS-PROGRAM-SWITCHES.                                         01160082
           05  PS-ITEMS-LEFT-ON-DB-SW    PIC  X      VALUE  'Y'.        01170082
               88  PS-ITEMS-LEFT-ON-DB               VALUE  'Y'.        01180082
               88  PS-NO-ITEMS-LEFT-ON-DB            VALUE  'N'.        01190082
           05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        01200082
               88  PS-ERROR                          VALUE  'Y'.        01210082
               88  PS-NO-ERROR                       VALUE  'N'.        01220082
           05  PS-TYPE-FOUND-SW          PIC  X(01)  VALUE  'N'.        01260082
               88  PS-TYPE-FOUND                     VALUE  'Y'.        01270082
               88  PS-TYPE-NOT-FOUND                 VALUE  'N'.        01270182
           05  PS-STORE-FOUND-SW              PIC  X(01)  VALUE 'Y'.    01270282
               88  PS-STORE-FOUND                         VALUE 'Y'.    01270382
               88  PS-STORE-NOT-FOUND                     VALUE 'N'.    01270482
      *                                                                 01270899
       01  PV-PROGRAM-VARIABLES.                                        01270999
           05  PV-RETRY-COUNT                 PIC S9(04)  VALUE +0      01361482
                                                          COMP SYNC.    01361582
           05  PV-NULL-IND                    PIC S9(04)  VALUE +0      01361682
                                                          COMP SYNC.    01361782
           05  PV-READ-COUNT           PIC S9(04)   VALUE +0  COMP.     01361882
051705*    05  PV-CURRENT-DATE                 PIC X(10)   VALUE SPACE. 01361992
051705*    05  PV-XFER-INV-CTOFF-DTE           PIC X(10)   VALUE SPACE. 01362092
051705*    05  PV-FR-STR-INV-DTE               PIC X(10)   VALUE SPACE. 01363092
051705*    05  PV-COUNT-BEG-DTE                PIC X(10)   VALUE SPACE. 01364092
051705*    05  PV-COUNT-END-DTE                PIC X(10)   VALUE SPACE. 01366092
051705*    05  PV-PHY-INV-PERD-IND             PIC X(01)   VALUE SPACE. 01368092
                                                                        01369082
       01  PM-PROGRAM-MESSAGES.                                         01370082
           05  PM-ABEND-INFO-A.                                         01380082
               10  FILLER                PIC X(15)   VALUE              01390082
                                         'DP020-SRC-AID: '.             01400082
               10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      01410082
               10  FILLER                PIC X(19)   VALUE              01420082
                                         '. DP020-FK-ACTION: '.         01430082
               10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      01440082
               10  FILLER                PIC X(22)   VALUE              01450082
                                         '. DP020-FK-DISPN-IND: '.      01460082
               10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      01470082
               10  FILLER                PIC X(01)   VALUE '.'.         01480082
               10  FILLER                PIC X(19)   VALUE SPACE.       01490082
                                                                        01500082
060110*----------------------------------------------------------------*01501199
060110*  LIST OF LOCATION EXCLUSIONS                                    01502099
060110*----------------------------------------------------------------*01502199
060110     COPY TFWS010.                                                01504099
                                                                        01510082
      *----------------------------------------------------------------*01520082
      *    MAP LAYOUT                                                  *01530082
      *----------------------------------------------------------------*01540082
                                                                        01550082
           COPY TFKM440.                                                01560082
           EJECT                                                        01560182
      ******************************************************************01560282
      *  ** NOTE **                                                    *01560382
      *      THE FOLLOWING IS A REDEFINITION OF THE TFKM440 MAP DSECT. *01560482
      *  ANY CHANGES TO THE MAP/DSECT MUST ALSO BE REFLECTED IN THIS   *01560582
      *  REDEFINITION.                                                 *01560682
      ******************************************************************01560782
      *                                                                 01560882
       01  MR-MAP-REDEFINITION                REDEFINES  TF440AO.       01560982
           05  FILLER                         PIC  X(12).               01561082
      *                                                                 01562082
           05 MR-MAP.                                                   01563082
      *                                                                 01960082
               10  MR-FR-STORE-NBR-L          PIC S9(04)  COMP.         01970082
               10  MR-FR-STORE-NBR-A          PIC  X(01).               01980082
               10  MR-FR-STORE-NBR-C          PIC  X(01).               01990082
               10  MR-FR-STORE-NBR-H          PIC  X(01).               02000082
               10  MR-FR-STORE-NBR.                                     02010082
100404*            15  MR-FR-STORE-NBR-N      PIC  9(03).               02020089
100404             15  MR-FR-STORE-NBR-N      PIC  9(04).               02021091
      *                                                                 02030082
               10  MR-FR-STORE-NAM-L          PIC S9(04)  COMP.         02040082
               10  MR-FR-STORE-NAM-A          PIC  X(01).               02050082
               10  MR-FR-STORE-NAM-C          PIC  X(01).               02060082
               10  MR-FR-STORE-NAM-H          PIC  X(01).               02070082
               10  MR-FR-STORE-NAM            PIC  X(10).               02080082
      *                                                                 02090082
               10 MR-SCROLL-AREA              OCCURS 10 TIMES.          02090182
      *                                                                 02090282
                   15 MR-XFER-TYPEL           PIC S9(04) COMP.          02090382
                   15 MR-XFER-TYPEA           PIC  X(01).               02090482
                   15 MR-XFER-TYPEC           PIC  X(01).               02090582
                   15 MR-XFER-TYPEH           PIC  X(01).               02090682
                   15 MR-XFER-TYPE            PIC  X(30).               02090782
      *                                                                 02090882
                   15 MR-CONT-TYPEL           PIC S9(04) COMP.          02090982
                   15 MR-CONT-TYPEA           PIC  X(01).               02091082
                   15 MR-CONT-TYPEC           PIC  X(01).               02092082
                   15 MR-CONT-TYPEH           PIC  X(01).               02093082
                   15 MR-CONT-TYPE            PIC  X(20).               02094082
      *                                                                 02094182
           05  MR-SEL-XFER-TYPEL              PIC S9(04) COMP.          02094282
           05  MR-SEL-XFER-TYPEF              PIC  X(01).               02094382
           05  MR-SEL-XFER-TYPEA REDEFINES MR-SEL-XFER-TYPEF            02094482
                                              PIC  X(01).               02094582
           05  MR-SEL-XFER-TYPEC              PIC  X(01).               02094682
           05  MR-SEL-XFER-TYPEH              PIC  X(01).               02094782
           05  MR-SEL-XFER-TYPE               PIC  X(01).               02094882
      *                                                                 02094982
           05  MR-SEL-CONT-TYPEL              PIC S9(04) COMP.          02095082
           05  MR-SEL-CONT-TYPEF              PIC  X(01).               02095182
           05  MR-SEL-CONT-TYPEA REDEFINES MR-SEL-CONT-TYPEF            02095282
                                              PIC  X(01).               02095382
           05  MR-SEL-CONT-TYPEC              PIC  X(01).               02095482
           05  MR-SEL-CONT-TYPEH              PIC  X(01).               02095582
           05  MR-SEL-CONT-TYPE               PIC  X(01).               02095682
      *                                                                 02095782
      *----------------------------------------------------------------*02095882
      *    ATTRIBUTE SETTINGS COPYBOOK.                                *02095982
      *----------------------------------------------------------------*02096082
                                                                        02097082
           COPY DPWS015.                                                02098082
                                                                        02099082
      *----------------------------------------------------------------*02100082
      *    FUNCTION KEYS COPYBOOK                                      *02110082
      *----------------------------------------------------------------*02120082
                                                                        02130082
           COPY DPWS016.                                                02140082
       EJECT                                                            02150082
      ******************************************************************02160082
      ** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **02170082
      ** SUB-ROUTINE (DPKUT100).                                      **02180082
      ******************************************************************02190082
           COPY DPWS010I.                                               02200082
       EJECT                                                            02210082
      ******************************************************************02220082
      ** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **02230082
      ** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **02240082
      ******************************************************************02250082
           COPY DPWS030.                                                02260082
CICS       COPY DPWS930.                                                02261099
       EJECT                                                            02270082
      ***************************************************************** 02280082
      *    STANDARD COMMAREA.                                           02290082
      ***************************************************************** 02300082
                                                                        02310082
           COPY DPWS020.                                                02320082
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02330082
                                                                        02340082
      ***************************************************************** 02350082
      *    INTER-APPLICATION COMMAREA.                                  02360082
      ***************************************************************** 02370082
                                                                        02380082
               10  INTER-APPL-COMM-AREA PIC X(200).                     02390082
           COPY TFWS001.                                                02400082
      ***************************************************************** 02410082
      *    SPECIFIC COMMMAREA FOR DPKCS035.                             02420082
      ***************************************************************** 02430082
               10  ASC-SPECIFIC-COMMAREA.                               02440082
                   15  ASC-XFER-TYPE-TBL.                               02450082
                       20  ASC-XFER-TYPE-FIELD OCCURS 10 TIMES          02460082
                                  INDEXED BY XFER-TYPE-INDX.            02470082
                           25  ASC-XFER-TYPE-CDE   PIC X.               02480082
                           25  ASC-XFER-TYPE-DASH  PIC X.               02490082
                           25  ASC-XFER-TYPE-DESC  PIC X(28).           02500082
                   15  ASC-CONT-TYPE-TBL.                               02510082
                       20  ASC-CONT-TYPE-FIELD OCCURS 10 TIMES          02520082
                                  INDEXED BY CONT-TYPE-INDX.            02530082
                           25  ASC-CONT-TYPE-CDE   PIC X.               02540082
                           25  ASC-CONT-TYPE-DASH  PIC X.               02550082
                           25  ASC-CONT-TYPE-DESC  PIC X(18).           02560082
                   15  ASC-TYPE-TBL-SUB            PIC  9(02).          02570082
                   15  ASC-XFER-TYPE               PIC  X(01).          02580082
                   15  ASC-CONTAINER-TYPE          PIC  X(01).          02590082
                   15  ASC-FR-STR-NBR-X.                                02600082
100404*                20  ASC-FR-STR-NBR          PIC  9(03).          02610089
100404                 20  ASC-FR-STR-NBR          PIC  9(04).          02611091
                   15  ASC-FR-STR-NAM              PIC  X(10).          02620082
                   15  ASC-TYPE-CODE               PIC  X(02).          02630082
                   15  ASC-FR-STR-OVRRID-IND       PIC  X(01).          02640082
                       88  ASC-FR-STR-OVERRIDE      VALUE 'Y'.          02650082
                       88  ASC-NO-FR-STR-OVERRIDE   VALUE 'N'.          02660082
                   15  ASC-WARNING-SW            PIC  X(01).            02661082
                       88  ASC-WARNING               VALUE  'Y'.        02662082
                       88  ASC-NO-WARNING            VALUE  'N'.        02663082
                   15  ASC-OVERRIDE-SW           PIC  X(01).            02664082
                       88  ASC-OVERRIDE              VALUE  'Y'.        02665082
                       88  ASC-NO-OVERRIDE           VALUE  'N'.        02666082
           EJECT                                                        02670082
      *----------------------------------------------------------------*02680082
      *    ABEND PROCESSING COPYBOOK.                                  *02690082
      *----------------------------------------------------------------*02700082
                                                                        02710082
           COPY DPWS013.                                                02720082
                                                                        02730082
      *---------------------------------------------------------------* 04150082
100404*    DB2 AREA FOR XST_LOC TABLE                                 * 04160089
      *---------------------------------------------------------------* 04170082
           EXEC SQL                                                     04180082
100404          INCLUDE XST00001                                        04190089
           END-EXEC.                                                    04200082
      *---------------------------------------------------------------* 04200182
      *    DB2 AREA FOR TRANSFER TYPE TABLE                           * 04200282
      *---------------------------------------------------------------* 04200382
           EXEC SQL                                                     04200482
                INCLUDE TTFTYCD                                         04200582
           END-EXEC.                                                    04200682
      *---------------------------------------------------------------* 04200782
      *    DB2 AREA FOR TRANSFER CONTAINER TYPE TABLE                 * 04200882
      *---------------------------------------------------------------* 04200982
           EXEC SQL                                                     04201082
                INCLUDE TTFSHCT                                         04201182
           END-EXEC.                                                    04201282
051705*---------------------------------------------------------------* 04201392
051705*    DB2 AREA FOR INVENTORY PARAMETERS TABLE                    * 04201492
051705*---------------------------------------------------------------* 04201592
051705*    EXEC SQL                                                     04201692
051705*         INCLUDE TINVPAR                                         04201792
051705*    END-EXEC.                                                    04201892
051705*---------------------------------------------------------------* 04201992
051705*    DB2 AREA FOR TRANSFER CONTROL TABLE                        * 04202092
051705*---------------------------------------------------------------* 04203092
051705*    EXEC SQL                                                     04204092
051705*         INCLUDE TTFCNTL                                         04205092
051705*    END-EXEC.                                                    04206092
      *---------------------------------------------------------------* 04629082
      *    DB2 AREA FOR COMMUNICATIONS                                * 04630082
      *---------------------------------------------------------------* 04640082
           EXEC SQL                                                     04650082
                INCLUDE SQLCA                                           04660082
           END-EXEC.                                                    04670082
      *---------------------------------------------------------------* 04910082
      *    CURSOR TO OBTAIN THE TRANSFER TYPE CODES AND DESCRIPTIONS  * 04920082
      *---------------------------------------------------------------* 04930082
           EXEC SQL                                                     04950082
                DECLARE XFER-TYPE-CSR CURSOR                            04960082
                FOR                                                     04970082
                  SELECT                                                04971082
                      XFER_TYP_CDE                                      04980082
                     ,TYP_1ST_LNE_DESC                                  04981082
                     ,TYP_2ND_LNE_DESC                                  04990082
                  FROM                                                  05000082
                      TTFTYCD                                           05010082
                  ORDER BY XFER_TYP_CDE                                 05120082
100404            WITH UR                                               05130089
           END-EXEC.                                                    05140082
      *---------------------------------------------------------------* 05140182
      *  CURSOR TO OBTAIN THE CONTAINER TYPE CODES AND DESCRIPTIONS   * 05140282
      *---------------------------------------------------------------* 05140382
           EXEC SQL                                                     05140482
                DECLARE CONT-TYPE-CSR CURSOR                            05140582
                FOR                                                     05140682
                  SELECT                                                05140782
                      CONTNR_TYP_CDE                                    05140882
                     ,CONTNR_TYP_DESC                                   05140982
                  FROM                                                  05141082
                      TTFSHCT                                           05141182
                  ORDER BY CONTNR_TYP_CDE                               05141282
100404            WITH UR                                               05141389
           END-EXEC.                                                    05141482
       EJECT                                                            05141582
       LINKAGE SECTION.                                                 05141682
                                                                        05141782
       01  DFHCOMMAREA.                                                 05141882
           05  FILLER                         OCCURS  1 TO 4072 TIMES   05141982
                                              DEPENDING ON EIBCALEN.    05142082
               10  FILLER                     PIC X.                    05142182
                                                                        05143082
       PROCEDURE DIVISION.                                              05144082
      ***************************************************************** 05145082
      ** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 05146082
      ** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 05147082
      ** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 05148082
      **                                                             ** 05149082
      ** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 05150082
      ** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 05160082
      ***************************************************************** 05170082
       0000-MAIN-MODULE.                                                05180082
           INITIALIZE DP030-CICS-API-FIELDS.                            05190082
           MOVE +1                       TO DP030-NUMBER-OF-MAPS.       05200082
           MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05210082
           MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05220082
           SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05230082
           MOVE LENGTH OF TF440AI        TO DP030-MAP-LENGTH (1).       05240082
           MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05250082
           PERFORM 0001-CALL-CICS-ARCH-API.                             05260082
      *                                                                 05270082
           PERFORM 1000-CONTROL-PROCESSING                              05280082
      *                                                                 05290082
           MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05300082
           PERFORM 0001-CALL-CICS-ARCH-API.                             05310082
                                                                        05320082
       0001-CALL-CICS-ARCH-API.                                         05330082
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05340099
                                          DFHCOMMAREA                   05350099
                                          DP030-CICS-API-FIELDS         05360099
                                          DP020-STANDARD-COMMAREA       05370099
                                          TF440AI.                      05380099
      *                                                                 05390082
           IF  DP030-RC-CALL-SUCCESSFUL                                 05400082
               CONTINUE                                                 05410082
           ELSE                                                         05420082
               SET DP013-NO-ROLLBACK                                    05430082
                   DP013-XCTL-DISPLAY-RESTART                           05440082
                   DP013-CICS-ABEND      TO TRUE                        05450082
               MOVE 'BEFORE 0000-MAIN-MODULE'                           05460082
                                         TO DP013-PARAGRAPH             05470082
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05471099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05472099
               MOVE DP030-RETURN-CODE                                   05500082
                                         TO DP013-MESSAGE-TEXT (3)      05510082
               PERFORM DP013-0000-PROCESS-ABEND                         05520082
           END-IF.                                                      05530082
       EJECT                                                            05540082
      *----------------------------------------------------------------*05550082
      *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *05560082
      *    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *05570082
      *----------------------------------------------------------------*05580082
                                                                        05590082
       1000-CONTROL-PROCESSING.                                         05600082
                                                                        05610082
           EVALUATE TRUE                                                05620082
               WHEN DP020-NEXT-ACT-INITIAL                              05630082
                   INITIALIZE ASC-SPECIFIC-COMMAREA                     05640082
080204             IF DP020-LOCATION-NBR = PC-DC-MEN-FLS                05660087
100404                 MOVE PC-RTV-MEN-FLS         TO ASC-FR-STR-NBR    05670090
                   ELSE                                                 05680082
080204                 IF DP020-LOCATION-NBR = PC-DC-FINDLAY            05690087
100404                     MOVE PC-RTV-FINDLAY     TO ASC-FR-STR-NBR    05700090
                       ELSE                                             05710082
080204                     MOVE DP020-LOCATION-NBR TO ASC-FR-STR-NBR    05720087
                      END-IF                                            05730082
                   END-IF                                               05740082
                   PERFORM 4000-BUILD-INITIAL-PANEL                     05750082
                                                                        05760082
               WHEN DP020-NEXT-ACT-READ-MAP                             05770082
                   PERFORM 2000-FKEY-PROCESSING                         05780082
                                                                        05790082
               WHEN DP020-NEXT-ACT-RETURN                               05800082
                   SET ASC-NO-OVERRIDE TO TRUE                          05801082
                   IF TF001-FR-STR-OVERRIDE                             05810082
                       MOVE TF001-XFER-FROM-STR TO ASC-FR-STR-NBR       05820082
                       SET ASC-FR-STR-OVERRIDE  TO TRUE                 05830082
                       INITIALIZE ASC-XFER-TYPE-TBL                     05840082
                                  ASC-CONT-TYPE-TBL                     05850082
                       PERFORM 4000-BUILD-INITIAL-PANEL                 05860082
                   END-IF                                               05870082
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05880082
                                                                        05890082
               WHEN OTHER                                               05900082
                   SET DP013-LOGIC-ABEND                                05910082
                       DP013-NO-ROLLBACK TO TRUE                        05920082
                   MOVE '1000-CONTROL-PROCESSING'                       05930082
                                         TO  DP013-PARAGRAPH            05940082
                   MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   05950082
                                         TO  DP013-MESSAGE-TEXT(1)      05960082
                   MOVE DP020-NEXT-APPL-ACTIVITY                        05970082
                                         TO DP013-MESSAGE-TEXT(2)       05980082
                   PERFORM DP013-0000-PROCESS-ABEND                     05990082
           END-EVALUATE.                                                06000082
                                                                        06010082
      *----------------------------------------------------------------*06020082
      * FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*06030082
      * SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*06040082
      * EDITS.                                                         *06050082
      *----------------------------------------------------------------*06060082
                                                                        06070082
       2000-FKEY-PROCESSING.                                            06080082
                                                                        06090082
           EVALUATE TRUE                                                06100082
                                                                        06110082
               WHEN DP020-SRC-AID = DP016-CLEAR                         06120082
                   SET ASC-NO-OVERRIDE TO TRUE                          06121082
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06130082
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06140082
                                                                        06150082
               WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06160082
                   SET ASC-NO-OVERRIDE TO TRUE                          06161082
                   INITIALIZE ASC-SPECIFIC-COMMAREA                     06170082
080204             IF DP020-LOCATION-NBR = PC-DC-MEN-FLS                06180088
100404                 MOVE PC-RTV-MEN-FLS         TO ASC-FR-STR-NBR    06190090
                   ELSE                                                 06200082
080204                 IF DP020-LOCATION-NBR = PC-DC-FINDLAY            06210088
100404                     MOVE PC-RTV-FINDLAY     TO ASC-FR-STR-NBR    06220090
                       ELSE                                             06230082
080204                     MOVE DP020-LOCATION-NBR TO ASC-FR-STR-NBR    06240088
                      END-IF                                            06250082
                   END-IF                                               06260082
                   PERFORM 4000-BUILD-INITIAL-PANEL                     06270082
                                                                        06280082
               WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              06290082
      * ------- FROM STR -----------------------------------------------06300082
                   SET ASC-NO-OVERRIDE TO TRUE                          06301082
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06310082
                   SET DP030-CONTINUE-GO TO TRUE                        06320082
                   PERFORM 2110-PREPARE-INTER-APPL-COMM                 06330082
                                                                        06340082
               WHEN OTHER                                               06350082
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06360082
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06370082
                   IF  PS-NO-ERROR                                      06380082
                       SET DP030-CONTINUE-GO TO TRUE                    06390082
                       PERFORM 2100-CHECK-FUNCTION-KEY                  06400082
                   ELSE                                                 06410082
                       SET DP030-OVERRIDE-GO TO TRUE                    06420082
                   END-IF                                               06430082
           END-EVALUATE.                                                06440082
      ******************************************************************06450082
      ** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **06460082
      ** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **06470082
      ** FROM THE CICS ARCHITECTURE API.                              **06480082
      ******************************************************************06490082
       2100-CHECK-FUNCTION-KEY.                                         06500082
           EVALUATE TRUE                                                06510082
               WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              06520082
      * ------- CREATE -------------------------------------------------06530082
                   IF ASC-WARNING                                       06531082
                       IF ASC-OVERRIDE                                  06532082
                           PERFORM 2110-PREPARE-INTER-APPL-COMM         06540082
                       ELSE                                             06541082
      *        -- COUNTS ARE SCHEDULED          --                      06541282
                           MOVE PC-TSYMSG-02023 TO DP020-MSG-NUMBER     06541382
                           MOVE 'F13'           TO DP020-MSG-TEXT       06541482
                           MOVE -1              TO MR-SEL-XFER-TYPEL    06541582
                           SET DP030-OVERRIDE-GO                        06541782
                               ASC-OVERRIDE                             06541882
                               DP030-SET-CURSOR-APPL-1                  06541982
                               DP020-MSG-WARNING    TO TRUE             06542082
                       END-IF                                           06542182
                   ELSE                                                 06542282
                       PERFORM 2110-PREPARE-INTER-APPL-COMM             06542382
                   END-IF                                               06543082
                                                                        06550082
               WHEN DP020-SRC-AID = DP016-ENTER                         06560082
                   SET ASC-NO-OVERRIDE TO TRUE                          06561082
                                                                        06580082
               WHEN OTHER                                               06590082
                   SET DP013-NO-ROLLBACK                                06600082
                       DP013-XCTL-DISPLAY-RESTART                       06610082
                       DP013-CICS-ABEND  TO TRUE                        06620082
                   MOVE '2100-CHECK-FUNCTION-KEY'                       06630082
                                         TO DP013-PARAGRAPH             06640082
                   MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06650082
                                         TO DP013-MESSAGE-TEXT (1)      06660082
                   MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 06670082
                                         TO DP013-MESSAGE-TEXT (2)      06680082
                   MOVE DP020-SRC-AID    TO PM-A-SRC-AID                06690082
                   MOVE DP020-FK-ACTION (DP020-SRC-AID)                 06700082
                                         TO PM-A-FK-ACTION              06710082
                   MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              06720082
                                         TO PM-A-FK-DISPN               06730082
                   MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      06740082
                   MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        06750082
                                         TO DP013-MESSAGE-TEXT (4)      06760082
                   PERFORM DP013-0000-PROCESS-ABEND                     06770082
           END-EVALUATE.                                                06780082
      ******************************************************************06790082
      ** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **06800082
      ** INTER-APPLICATION COMMAREA.                                  **06810082
      ******************************************************************06820082
       2110-PREPARE-INTER-APPL-COMM.                                    06830082
           INITIALIZE TF001-INTER-APPL-COMMAREA.                        06840082
           MOVE ZERO                    TO TF001-XFER-TYPE(1:1).        06850082
           MOVE ASC-XFER-TYPE           TO TF001-XFER-TYPE(2:1).        06860082
           MOVE ZERO                    TO TF001-CONTNR-TYPE(1:1).      06870082
           MOVE ASC-CONTAINER-TYPE      TO TF001-CONTNR-TYPE(2:1).      06880082
           MOVE ASC-FR-STR-NBR          TO TF001-XFER-FROM-STR.         06890082
           MOVE ASC-FR-STR-OVRRID-IND   TO TF001-FR-STR-OVRRID-IND.     06900082
       EJECT                                                            06910082
      *----------------------------------------------------------------*06920082
      * MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*06930082
      * THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *06940082
      * APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *06950082
      *----------------------------------------------------------------*06960082
                                                                        06970082
       2200-MOVE-SCREEN-TO-COMMAREA.                                    06980082
           IF  MR-SEL-XFER-TYPEL > 0                                    06990082
               MOVE MR-SEL-XFER-TYPE     TO ASC-XFER-TYPE               07000082
           ELSE                                                         07010082
               IF  MR-SEL-XFER-TYPEF = DP015-ERASE-EOF                  07020082
                   MOVE SPACE            TO ASC-XFER-TYPE               07030082
               END-IF                                                   07040082
           END-IF.                                                      07050082
                                                                        07060082
           IF  MR-SEL-CONT-TYPEL > 0                                    07070082
               MOVE MR-SEL-CONT-TYPE     TO ASC-CONTAINER-TYPE          07080082
           ELSE                                                         07090082
               IF  MR-SEL-CONT-TYPEF = DP015-ERASE-EOF                  07100082
                   MOVE SPACE            TO ASC-CONTAINER-TYPE          07110082
               END-IF                                                   07120082
           END-IF.                                                      07130082
                                                                        07140082
      *----------------------------------------------------------------*07150082
      * ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *07160082
      * CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *07170082
      * A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*07180082
      * IN THE DESTINATION PROGRAM, NOT HERE.                          *07190082
      *----------------------------------------------------------------*07200082
                                                                        07210082
       3000-EDIT-DATA-IN-COMMAREA.                                      07220082
           SET PS-NO-ERROR                                              07230082
               ASC-NO-WARNING            TO TRUE.                       07240082
           PERFORM 3200-RESET-ATTRIBUTES.                               07250082
           IF ASC-TYPE-CODE NOT = PC-DEPT-STORE     AND                 07260097
              ASC-TYPE-CODE NOT = PC-RTV-TYPE       AND                 07270082
060110        ASC-TYPE-CODE NOT = PC-CORPORATE      AND                 07290099
060110        ASC-TYPE-CODE NOT = PC-CNTRL-STK                          07300099
               SET DP020-MSG-FATAL   TO TRUE                            23080082
      *  -- NOT ALLOWED TO COMPLETE A TRANSFER IN THIS LOCATION         23090082
               IF PS-NO-ERROR                                           23100082
                   MOVE PC-TSYMSG-01539 TO DP020-MSG-NUMBER             23110082
                   MOVE -1           TO MR-SEL-XFER-TYPEL               23120082
                   SET DP030-SET-CURSOR-APPL-1                          23170082
                                     TO TRUE                            23180082
                   SET PS-ERROR      TO TRUE                            23190082
               END-IF                                                   23200082
           END-IF.                                                      23210082
060110     MOVE ASC-FR-STR-NBR TO PV-LOC-EXCLUSION.                     23210199
060110     IF PV-EXCLUDE                                                23210699
060110         SET DP020-MSG-FATAL   TO TRUE                            23210799
060110*  -- NOT ALLOWED TO COMPLETE A TRANSFER IN THIS LOCATION         23210899
060110         IF PS-NO-ERROR                                           23210999
060110             MOVE PC-TSYMSG-01539 TO DP020-MSG-NUMBER             23211099
060110             MOVE -1           TO MR-SEL-XFER-TYPEL               23211199
060110             SET DP030-SET-CURSOR-APPL-1                          23211299
060110                               TO TRUE                            23211399
060110             SET PS-ERROR      TO TRUE                            23211499
060110         END-IF                                                   23211599
060110     END-IF.                                                      23211699
           IF ASC-XFER-TYPE NOT > SPACE                                 23211797
               SET DP020-MSG-FATAL   TO TRUE                            23211897
      *        -- REQUIRED FIELD --                                     23211997
               MOVE DP015-UNP-ALP-BRT-OFF                               23212097
                                     TO MR-SEL-XFER-TYPEA               23212197
               MOVE DP015-RED        TO MR-SEL-XFER-TYPEC               23212297
               MOVE DP015-REVERSE    TO MR-SEL-XFER-TYPEH               23212397
               IF PS-NO-ERROR                                           23212497
                   MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER             23212597
                   MOVE -1           TO MR-SEL-XFER-TYPEL               23212697
                   SET DP030-SET-CURSOR-APPL-1                          23212797
                                     TO TRUE                            23212897
                   SET PS-ERROR      TO TRUE                            23212997
               END-IF                                                   23213097
           ELSE                                                         23213197
               IF ASC-XFER-TYPE NOT NUMERIC                             23213297
                   SET DP020-MSG-FATAL   TO TRUE                        23213397
      *        -- MUST BE NUMERIC --                                    23213497
                   MOVE DP015-UNP-ALP-BRT-OFF                           23213597
                                     TO MR-SEL-XFER-TYPEA               23213697
                   MOVE DP015-RED        TO MR-SEL-XFER-TYPEC           23213797
                   MOVE DP015-REVERSE    TO MR-SEL-XFER-TYPEH           23214082
                   IF PS-NO-ERROR                                       23215082
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         23216082
                       MOVE -1           TO MR-SEL-XFER-TYPEL           23216182
                       SET DP030-SET-CURSOR-APPL-1                      23216282
                                         TO TRUE                        23216382
                       SET PS-ERROR      TO TRUE                        23216482
                   END-IF                                               23216582
               ELSE                                                     23216682
                   SET PS-TYPE-NOT-FOUND TO TRUE                        23216782
                   PERFORM 3100-SEARCH-XFER-TYPE                        23216882
                   IF PS-TYPE-NOT-FOUND                                 23216982
                       SET DP020-MSG-FATAL   TO TRUE                    23217082
      *        -- TRANSFER TYPE DOES NOT EXIST --                       23218082
                       MOVE DP015-UNP-ALP-BRT-OFF                       23219082
                                             TO MR-SEL-XFER-TYPEA       23220082
                       MOVE DP015-RED        TO MR-SEL-XFER-TYPEC       23230082
                       MOVE DP015-REVERSE    TO MR-SEL-XFER-TYPEH       23240082
                       IF PS-NO-ERROR                                   23250082
                           MOVE PC-TSYMSG-01412 TO DP020-MSG-NUMBER     23260082
                           MOVE -1           TO MR-SEL-XFER-TYPEL       23260182
                           SET DP030-SET-CURSOR-APPL-1                  23260282
                                             TO TRUE                    23260382
                           SET PS-ERROR      TO TRUE                    23260482
                       END-IF                                           23260582
                   ELSE                                                 23260682
                       IF ASC-XFER-TYPE > '6'                           23260782
                           SET DP020-MSG-FATAL   TO TRUE                23260882
      *        -- AN INVALID SELECTION WAS ENTERED --                   23260982
                           MOVE DP015-UNP-ALP-BRT-OFF                   23261082
                                                 TO MR-SEL-XFER-TYPEA   23262082
                           MOVE DP015-RED        TO MR-SEL-XFER-TYPEC   23263082
                           MOVE DP015-REVERSE    TO MR-SEL-XFER-TYPEH   23264082
                           IF PS-NO-ERROR                               23265082
                               MOVE PC-TSYMSG-99907 TO DP020-MSG-NUMBER 23266082
                               MOVE -1           TO MR-SEL-XFER-TYPEL   23266182
                               SET DP030-SET-CURSOR-APPL-1              23266282
                                                 TO TRUE                23266382
                               SET PS-ERROR      TO TRUE                23266482
                           END-IF                                       23266582
                       END-IF                                           23266682
                   END-IF                                               23266782
               END-IF                                                   23266882
           END-IF.                                                      23266982
                                                                        23267082
           IF ASC-CONTAINER-TYPE NOT > SPACE                            23267182
               SET DP020-MSG-FATAL   TO TRUE                            23267282
      *        -- REQUIRED FIELD --                                     23267382
               MOVE DP015-UNP-ALP-BRT-OFF                               23267482
                                     TO MR-SEL-CONT-TYPEA               23267582
               MOVE DP015-RED        TO MR-SEL-CONT-TYPEC               23267682
               MOVE DP015-REVERSE    TO MR-SEL-CONT-TYPEH               23267782
               IF PS-NO-ERROR                                           23267882
                   MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER             23267982
                   MOVE -1           TO MR-SEL-CONT-TYPEL               23268082
                   SET DP030-SET-CURSOR-APPL-1                          23268182
                                     TO TRUE                            23268282
                   SET PS-ERROR      TO TRUE                            23268382
               END-IF                                                   23268482
           ELSE                                                         23268582
               IF ASC-CONTAINER-TYPE NOT NUMERIC                        23268682
                   SET DP020-MSG-FATAL TO TRUE                          23268782
      *        -- MUST BE NUMERIC --                                    23268882
                   MOVE DP015-UNP-ALP-BRT-OFF                           23268982
                                       TO MR-SEL-CONT-TYPEA             23269082
                   MOVE DP015-RED      TO MR-SEL-CONT-TYPEC             23270082
                   MOVE DP015-REVERSE  TO MR-SEL-CONT-TYPEH             23280082
                   IF PS-NO-ERROR                                       23290082
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         23300082
                       MOVE -1           TO MR-SEL-CONT-TYPEL           23300182
                       SET DP030-SET-CURSOR-APPL-1                      23300282
                                         TO TRUE                        23300382
                       SET PS-ERROR      TO TRUE                        23300482
                   END-IF                                               23300582
               ELSE                                                     23300682
                   SET PS-TYPE-NOT-FOUND TO TRUE                        23300782
                   PERFORM 3150-SEARCH-CONT-TYPE                        23300882
                   IF PS-TYPE-NOT-FOUND                                 23300982
                       SET DP020-MSG-FATAL   TO TRUE                    23301082
      *        -- CONTAINER TYPE DOES NOT EXIST --                      23302082
                       MOVE DP015-UNP-ALP-BRT-OFF                       23303082
                                             TO MR-SEL-CONT-TYPEA       23304082
                       MOVE DP015-RED        TO MR-SEL-CONT-TYPEC       23305082
                       MOVE DP015-REVERSE    TO MR-SEL-CONT-TYPEH       23306082
                       IF PS-NO-ERROR                                   23307082
                           MOVE PC-TSYMSG-01482 TO DP020-MSG-NUMBER     23308082
                           MOVE -1           TO MR-SEL-CONT-TYPEL       23308182
                           SET DP030-SET-CURSOR-APPL-1                  23308282
                                             TO TRUE                    23308382
                           SET PS-ERROR      TO TRUE                    23308482
                       END-IF                                           23308582
                   END-IF                                               23308682
               END-IF                                                   23308782
           END-IF.                                                      23308882
051705*    INITIALIZE DCLTTFCNTL.                                       23308992
051705*    PERFORM 4520-READ-CONTROL-TABLE.                             23309092
051705*    IF ASC-CONTAINER-TYPE = PC-HAND-CARRY                        23310092
051705*        IF PV-PHY-INV-PERD-IND = PC-YES            AND           23320092
051705*           PV-CURRENT-DATE > PV-XFER-INV-CTOFF-DTE               23330092
051705*            PERFORM 3010-INVENTORY-CUTOFF                        23340092
051705*        END-IF                                                   23350092
051705*    END-IF.                                                      23360092
051705*    IF (ASC-XFER-TYPE = PC-STOCK-BAL-CORP-1CHAR   OR             23370092
051705*                        PC-STOCK-BAL-STORE-1CHAR) OR             23380092
051705*       (ASC-XFER-TYPE = PC-CUSTOMER         AND                  23390092
051705*        ASC-CONTAINER-TYPE NOT = PC-HAND-CARRY)                  23400092
051705*            IF PV-PHY-INV-PERD-IND = PC-YES            AND       23410092
051705*               PV-CURRENT-DATE > PV-XFER-INV-CTOFF-DTE           23420092
051705*                   PERFORM 3015-NON-HANDCARRY-INV-CTOFF          23430092
051705*            END-IF                                               23440092
051705*    END-IF.                                                      23450092
051705*    IF  PS-NO-ERROR                                              23460092
051705*        IF ASC-XFER-TYPE = PC-STOCK-BAL-CORP-1CHAR   OR          23470092
051705*                           PC-STOCK-BAL-STORE-1CHAR  OR          23480092
051705*           ASC-XFER-TYPE = PC-CUSTOMER                           23490092
051705*            IF PV-CURRENT-DATE >= PV-COUNT-BEG-DTE    AND        23500092
051705*               PV-CURRENT-DATE <= PV-COUNT-END-DTE               23500192
051705*                SET ASC-WARNING          TO TRUE                 23500892
051705*            END-IF                                               23501592
051705*        END-IF                                                   23501692
051705*    END-IF.                                                      23501792
           IF  PS-NO-ERROR                                              23502082
               MOVE -1                   TO MR-SEL-XFER-TYPEL           23503082
               SET DP030-SET-CURSOR-APPL-1                              23504082
                                         TO TRUE                        23505082
           END-IF.                                                      23506082
      *                                                                 23507082
051705*3010-INVENTORY-CUTOFF.                                           23508092
051705*    MOVE ASC-FR-STR-NBR     TO DK-STORE-NBR-9.                   23509092
051705*    PERFORM 4540-GET-PLND-INV-DTE.                               23510092
051705*    MOVE INVPAR-PLND-INV-DTE   TO PV-FR-STR-INV-DTE.             23520092
051705*    IF PV-CURRENT-DATE <= PV-FR-STR-INV-DTE          AND         23530092
051705*       ASC-XFER-TYPE NOT = PC-CUSTOMER               AND         23540092
051705*       ASC-XFER-TYPE NOT = PC-NONRETAIL                          23540192
051705*        SET DP020-MSG-FATAL   TO TRUE                            23540292
051705*   TRANSFER TYPE FOR HAND CARRY MUST BE CUSTOMER FOR BEFORE INV  23540392
051705*        MOVE DP015-UNP-ALP-BRT-OFF                               23540492
051705*                              TO MR-SEL-XFER-TYPEA               23540592
051705*        MOVE DP015-RED        TO MR-SEL-XFER-TYPEC               23540692
051705*        MOVE DP015-REVERSE    TO MR-SEL-XFER-TYPEH               23540792
051705*        IF PS-NO-ERROR                                           23540892
051705*            MOVE PC-TSYMSG-01675 TO DP020-MSG-NUMBER             23540992
051705*            MOVE -1           TO MR-SEL-XFER-TYPEL               23541092
051705*            SET DP030-SET-CURSOR-APPL-1                          23541192
051705*                              TO TRUE                            23541292
051705*            SET PS-ERROR      TO TRUE                            23541392
051705*        END-IF                                                   23541492
051705*    END-IF.                                                      23541592
051705*                                                                 23541692
051705*3015-NON-HANDCARRY-INV-CTOFF.                                    23541792
051705*    MOVE ASC-FR-STR-NBR     TO DK-STORE-NBR-9.                   23541892
051705*    PERFORM 4540-GET-PLND-INV-DTE.                               23541992
051705*    MOVE INVPAR-PLND-INV-DTE   TO PV-FR-STR-INV-DTE.             23542092
051705*    IF PV-CURRENT-DATE <= PV-FR-STR-INV-DTE                      23542192
051705*        SET DP020-MSG-FATAL   TO TRUE                            23542292
051705***************************************************************** 23542392
051705*   DO NOT ALLOW STORE TO COMPLETE STOCK BALANCE (STORE OR CORP)  23542492
051705*   OR CUSTOMER NON-HANDCARRY TRANSFERS BETWEEN TRANSFER CUTOFF   23542592
051705*   DATE AND THE DAY AFTER THE 'FROM' STORE COMPLETED INVENTORY   23542692
051705***************************************************************** 23542792
051705*        MOVE DP015-UNP-ALP-BRT-OFF                               23542892
051705*                              TO MR-SEL-XFER-TYPEA               23542992
051705*        MOVE DP015-RED        TO MR-SEL-XFER-TYPEC               23543092
051705*        MOVE DP015-REVERSE    TO MR-SEL-XFER-TYPEH               23544092
051705*        IF PS-NO-ERROR                                           23545092
051705*            MOVE PC-TSYMSG-02002 TO DP020-MSG-NUMBER             23546092
051705*            IF (ASC-XFER-TYPE = PC-STOCK-BAL-CORP-1CHAR  OR      23547092
051705*                                PC-STOCK-BAL-STORE-1CHAR)        23548092
051705*                MOVE PC-STOCK-BALANCE-MSG TO DP020-MSG-TEXT      23549092
051705*            ELSE                                                 23550092
051705*                MOVE PC-CUST-NON-HANDCARRY-MSG TO DP020-MSG-TEXT 23560092
051705*            END-IF                                               23570092
051705*            MOVE -1           TO MR-SEL-XFER-TYPEL               23570192
051705*            SET DP030-SET-CURSOR-APPL-1                          23570292
051705*                              TO TRUE                            23570392
051705*            SET PS-ERROR      TO TRUE                            23570492
051705*        END-IF                                                   23570592
051705*    END-IF.                                                      23570692
       3100-SEARCH-XFER-TYPE.                                           23570782
           SEARCH ASC-XFER-TYPE-FIELD                                   23570882
               VARYING XFER-TYPE-INDX                                   23570982
                   WHEN ASC-XFER-TYPE =                                 23571082
                                ASC-XFER-TYPE-CDE (XFER-TYPE-INDX)      23572082
                     SET PS-TYPE-FOUND   TO TRUE                        23573082
           END-SEARCH.                                                  23574082
       3150-SEARCH-CONT-TYPE.                                           23575082
           SEARCH ASC-CONT-TYPE-FIELD                                   23576082
               VARYING CONT-TYPE-INDX                                   23577082
                   WHEN ASC-CONTAINER-TYPE =                            23578082
                                ASC-CONT-TYPE-CDE (CONT-TYPE-INDX)      23579082
                     SET PS-TYPE-FOUND   TO TRUE                        23580082
           END-SEARCH.                                                  23590082
      ******************************************************************23600082
      ** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **23610082
      ** MAP.                                                         **23620082
      ******************************************************************23630082
       3200-RESET-ATTRIBUTES.                                           23640082
           MOVE DP015-UNP-ALP-NOR-OFF    TO MR-SEL-XFER-TYPEA           23650082
                                            MR-SEL-CONT-TYPEA.          23660082
           MOVE DP015-GREEN              TO MR-SEL-XFER-TYPEC           23670082
                                            MR-SEL-CONT-TYPEC.          23680082
           MOVE DP015-UNDERLINE          TO MR-SEL-XFER-TYPEH           23690082
                                            MR-SEL-CONT-TYPEH.          23700082
       EJECT                                                            23710082
      *                                                                 23720082
      *----------------------------------------------------------------*23730082
      *  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *23740082
      *  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *23750082
      *  IT HERE.                                                      *23760082
      *----------------------------------------------------------------*23770082
       4000-BUILD-INITIAL-PANEL.                                        23780082
           PERFORM 4500-READ-STORE.                                     23790082
           MOVE ZERO                   TO ASC-TYPE-TBL-SUB.             23800082
                                                                        23810082
           PERFORM 4010-OPEN-XFER-TYPE-CURSOR.                          23820082
                                                                        23830082
           PERFORM 4020-READ-TRANSFER-TYPES.                            23840082
                                                                        23850082
           PERFORM 4030-CLOSE-XFER-TYPE-CURSOR.                         23860082
                                                                        23870082
           MOVE ZERO                   TO ASC-TYPE-TBL-SUB.             23880082
                                                                        23890082
           PERFORM 4110-OPEN-CONT-TYPE-CURSOR.                          23900082
                                                                        23910082
           PERFORM 4120-READ-CONTAINER-TYPES.                           23920082
                                                                        23930082
           PERFORM 4130-CLOSE-CONT-TYPE-CURSOR.                         23940082
                                                                        23950082
           SET DP030-SET-CURSOR-APPL-1   TO TRUE                        23960082
           MOVE -1                       TO MR-SEL-XFER-TYPEL.          23970082
           PERFORM 3200-RESET-ATTRIBUTES.                               23980082
           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        23990082
      *----------------------------------------------------------------*24000082
      * OPENS THE TRANSFER TYPE CURSOR                                 *24010082
      *----------------------------------------------------------------*24020082
                                                                        24030082
       4010-OPEN-XFER-TYPE-CURSOR.                                      24040082
                                                                        24050082
           EXEC SQL                                                     24060082
               OPEN XFER-TYPE-CSR                                       24070082
           END-EXEC.                                                    24080082
                                                                        24090082
           EVALUATE TRUE                                                24100082
               WHEN SQLCODE = +0                                        24110082
                   CONTINUE                                             24120082
               WHEN OTHER                                               24130082
                    MOVE '4010-OPEN-XFER-TYPE-CURSOR'                   24140082
                                     TO DP013-PARAGRAPH                 24150082
                    MOVE 'OPEN XFER-TYPE-CSR CURSOR'                    24160082
                                     TO DP013-MESSAGE-TEXT (1)          24170082
                    MOVE SQLCA           TO DP013-SQLCA                 24180082
                    SET DP013-DB2-ABEND                                 24190082
                                     TO TRUE                            24200082
                    PERFORM DP013-0000-PROCESS-ABEND                    24210082
           END-EVALUATE.                                                24220082
                                                                        24230082
       EJECT                                                            24240082
      *----------------------------------------------------------------*24250082
      *    READ THE TRANSFER TYPES AND DESCRIPTIONS AND PROCESS THEM   *24260082
      *----------------------------------------------------------------*24270082
                                                                        24280082
       4020-READ-TRANSFER-TYPES.                                        24290082
                                                                        24300082
           SET PS-ITEMS-LEFT-ON-DB       TO TRUE.                       24310082
           PERFORM                                                      24320082
               VARYING PV-READ-COUNT                                    24330082
               FROM 1 BY 1                                              24340082
               UNTIL ((PV-READ-COUNT > PC-MAX-TYPES)                    24350082
                  OR (PS-NO-ITEMS-LEFT-ON-DB))                          24360082
                                                                        24370082
               PERFORM 4025-FETCH-TRANSFER-TYPE                         24380082
                                                                        24390082
               IF  PS-ITEMS-LEFT-ON-DB                                  24400082
      *  DO NOT ALLOW OFFSITE STORAGE TRANSFERS                         24410082
                 IF TFTYCD-XFER-TYP-CDE NOT = PC-OFFSITE-STORAGE AND    24420082
      *  RTV IS ALLOWED TO COMPLETE ONLY STOCK-BAL-STORE & NON-RETAIL   24430082
                   NOT (ASC-TYPE-CODE = PC-RTV-TYPE AND                 24440082
                     (TFTYCD-XFER-TYP-CDE NOT = PC-STOCK-BAL-STORE AND  24450082
                      TFTYCD-XFER-TYP-CDE NOT = PC-NON-RETAIL)) AND     24460082
      *  CORPORATE IS ALLOWED TO COMPLETE ONLY NON-RETAIL               24470082
                   NOT (ASC-TYPE-CODE = PC-CORPORATE AND                24480082
                       TFTYCD-XFER-TYP-CDE NOT = PC-NON-RETAIL)         24490082
                   ADD +1                TO ASC-TYPE-TBL-SUB            24500082
                   MOVE TFTYCD-XFER-TYP-CDE(2:1)                        24510082
                                         TO ASC-XFER-TYPE-CDE           24520082
                                                  (ASC-TYPE-TBL-SUB)    24530082
                   MOVE '-'              TO ASC-XFER-TYPE-DASH          24540082
                                                  (ASC-TYPE-TBL-SUB)    24550082
                   IF TFTYCD-TYP-2ND-LNE-DESC = SPACES                  24560082
                       MOVE TFTYCD-TYP-1ST-LNE-DESC                     24570082
                                         TO ASC-XFER-TYPE-DESC          24580082
                                                  (ASC-TYPE-TBL-SUB)    24590082
                   ELSE                                                 24600082
                       STRING TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  ' 24610082
                              TFTYCD-TYP-2ND-LNE-DESC DELIMITED BY '  ' 24620082
                                         INTO ASC-XFER-TYPE-DESC        24630082
                                                  (ASC-TYPE-TBL-SUB)    24640082
                   END-IF                                               24650082
                 END-IF                                                 24660082
               END-IF                                                   24670082
           END-PERFORM.                                                 24680082
                                                                        24690082
       EJECT                                                            24700082
      *----------------------------------------------------------------*24710082
      *    FETCH THE TRANSFER TYPES AND DESCRIPTIONS                   *24720082
      *----------------------------------------------------------------*24730082
                                                                        24740082
       4025-FETCH-TRANSFER-TYPE.                                        24750082
                                                                        24760082
           EXEC SQL                                                     24770082
               FETCH XFER-TYPE-CSR                                      24780082
                   INTO                                                 24790082
                       :TFTYCD-XFER-TYP-CDE                             24800082
                     , :TFTYCD-TYP-1ST-LNE-DESC                         24810082
                     , :TFTYCD-TYP-2ND-LNE-DESC                         24820082
           END-EXEC.                                                    24830082
                                                                        24840082
           EVALUATE TRUE                                                24850082
               WHEN SQLCODE = ZERO                                      24860082
                    CONTINUE                                            24870082
               WHEN SQLCODE = +100                                      24880082
                    SET PS-NO-ITEMS-LEFT-ON-DB                          24890082
                                       TO TRUE                          24900082
               WHEN OTHER                                               24910089
                    MOVE '4025-FETCH-TRANSFER-TYPE'                     24930082
                                     TO DP013-PARAGRAPH                 24940082
                    MOVE 'FETCH XFER-TYPE-CSR CURSOR'                   24950082
                                     TO DP013-MESSAGE-TEXT (1)          24960082
                    MOVE SQLCA           TO DP013-SQLCA                 24970082
                    SET DP013-DB2-ABEND                                 24980082
                                     TO TRUE                            24990082
                    PERFORM DP013-0000-PROCESS-ABEND                    25000082
           END-EVALUATE.                                                25010082
                                                                        25020082
       EJECT                                                            25030082
      *----------------------------------------------------------------*25040082
      * CLOSE THE TRANSFER TYPE CURSOR                                 *25050082
      *----------------------------------------------------------------*25060082
                                                                        25070082
       4030-CLOSE-XFER-TYPE-CURSOR.                                     25080082
                                                                        25090082
           EXEC SQL                                                     25100082
               CLOSE XFER-TYPE-CSR                                      25110082
           END-EXEC.                                                    25120082
                                                                        25120182
           EVALUATE TRUE                                                25120282
               WHEN SQLCODE = ZERO                                      25120382
                    CONTINUE                                            25120482
               WHEN OTHER                                               25120582
                    MOVE '4030-CLOSE-XFER-TYPE-CURSOR'                  25120682
                                 TO  DP013-PARAGRAPH                    25120782
                    MOVE 'CLOSE XFER-TYPE-CSR CURSOR'                   25120882
                                 TO  DP013-MESSAGE-TEXT (1)             25120982
                    MOVE SQLCA   TO  DP013-SQLCA                        25121082
                    SET DP013-DB2-ABEND                                 25121182
                                 TO  TRUE                               25121282
                    PERFORM DP013-0000-PROCESS-ABEND                    25121382
           END-EVALUATE.                                                25121482
                                                                        25121582
       EJECT                                                            25121682
      *----------------------------------------------------------------*25121782
      * OPENS THE TRANSFER STATUS CURSOR                               *25121882
      *----------------------------------------------------------------*25121982
                                                                        25122082
       4110-OPEN-CONT-TYPE-CURSOR.                                      25123082
                                                                        25124082
           EXEC SQL                                                     25125082
               OPEN CONT-TYPE-CSR                                       25126082
           END-EXEC.                                                    25127082
                                                                        25128082
           EVALUATE TRUE                                                25129082
               WHEN SQLCODE = +0                                        25130082
                   CONTINUE                                             25140082
               WHEN OTHER                                               25150082
                    MOVE '4110-OPEN-CONT-TYPE-CURSOR'                   25160082
                                     TO DP013-PARAGRAPH                 25170082
                    MOVE 'OPEN CONT-TYPE-CSR CURSOR'                    25180082
                                     TO DP013-MESSAGE-TEXT (1)          25190082
                    MOVE SQLCA           TO DP013-SQLCA                 25200082
                    SET DP013-DB2-ABEND                                 25210082
                                     TO TRUE                            25220082
                    PERFORM DP013-0000-PROCESS-ABEND                    25230082
           END-EVALUATE.                                                25240082
                                                                        25250082
       EJECT                                                            25260082
      *----------------------------------------------------------------*25270082
      *    READ THE CONTAINER TYPES AND DESCRIPTIONS AND PROCESS THEM   25280082
      *----------------------------------------------------------------*25290082
                                                                        25300082
       4120-READ-CONTAINER-TYPES.                                       25310082
                                                                        25320082
           SET PS-ITEMS-LEFT-ON-DB       TO TRUE.                       25330082
           PERFORM                                                      25340082
               VARYING PV-READ-COUNT                                    25350082
               FROM 1 BY 1                                              25360082
               UNTIL ((PV-READ-COUNT > PC-MAX-TYPES)                    25370082
                  OR (PS-NO-ITEMS-LEFT-ON-DB))                          25380082
                                                                        25390082
               PERFORM 4125-FETCH-CONTAINER-TYPES                       25400082
                                                                        25410082
               IF  PS-ITEMS-LEFT-ON-DB                                  25420082
                   ADD +1                TO ASC-TYPE-TBL-SUB            25430082
                   MOVE TFSHCT-CONTNR-TYP-CDE(2:1)                      25440082
                                         TO ASC-CONT-TYPE-CDE           25450082
                                                  (ASC-TYPE-TBL-SUB)    25460082
                   MOVE '-'              TO ASC-CONT-TYPE-DASH          25470082
                                                  (ASC-TYPE-TBL-SUB)    25480082
                   MOVE TFSHCT-CONTNR-TYP-DESC                          25490082
                                         TO ASC-CONT-TYPE-DESC          25500082
                                                  (ASC-TYPE-TBL-SUB)    25510082
               END-IF                                                   25520082
           END-PERFORM.                                                 25530082
                                                                        25540082
       EJECT                                                            25550082
      *----------------------------------------------------------------*25560082
      *    FETCH THE CONTAINER TYPE AND DESCRIPTION                    *25570082
      *----------------------------------------------------------------*25580082
                                                                        25590082
       4125-FETCH-CONTAINER-TYPES.                                      25600082
                                                                        25610082
           EXEC SQL                                                     25620082
               FETCH CONT-TYPE-CSR                                      25630082
                   INTO                                                 25640082
                       :TFSHCT-CONTNR-TYP-CDE                           25650082
                     , :TFSHCT-CONTNR-TYP-DESC                          25660082
           END-EXEC.                                                    25670082
                                                                        25680082
           EVALUATE TRUE                                                25690082
               WHEN SQLCODE = ZERO                                      25700082
                    CONTINUE                                            25710082
               WHEN SQLCODE = +100                                      25720082
                    SET PS-NO-ITEMS-LEFT-ON-DB                          25730082
                                       TO TRUE                          25740082
               WHEN OTHER                                               25750089
                    MOVE '4125-FETCH-CONTAINER-TYPES'                   25770082
                                     TO DP013-PARAGRAPH                 25780082
                    MOVE 'FETCH CONT-TYPE-CSR CURSOR'                   25790082
                                     TO DP013-MESSAGE-TEXT (1)          25800082
                    MOVE SQLCA           TO DP013-SQLCA                 25810082
                    SET DP013-DB2-ABEND                                 25820082
                                     TO TRUE                            25830082
                    PERFORM DP013-0000-PROCESS-ABEND                    25840082
           END-EVALUATE.                                                25850082
                                                                        25860082
       EJECT                                                            25870082
      *----------------------------------------------------------------*25880082
      * CLOSE THE CONTAINER TYPE  CURSOR                               *25890082
      *----------------------------------------------------------------*25900082
                                                                        25910082
       4130-CLOSE-CONT-TYPE-CURSOR.                                     25920082
                                                                        25930082
           EXEC SQL                                                     25940082
               CLOSE CONT-TYPE-CSR                                      25950082
           END-EXEC.                                                    25960082
                                                                        25960182
           EVALUATE TRUE                                                25960282
               WHEN SQLCODE = ZERO                                      25960382
                    CONTINUE                                            25960482
               WHEN OTHER                                               25960582
                    MOVE '4130-CLOSE-CONT-TYPE-CURSOR'                  25960682
                                 TO  DP013-PARAGRAPH                    25960782
                    MOVE 'CLOSE CONT-TYPE-CSR CURSOR'                   25960882
                                 TO  DP013-MESSAGE-TEXT (1)             25960982
                    MOVE SQLCA   TO  DP013-SQLCA                        25961082
                    SET DP013-DB2-ABEND                                 25961182
                                 TO  TRUE                               25961282
                    PERFORM DP013-0000-PROCESS-ABEND                    25961382
           END-EVALUATE.                                                25961482
                                                                        25961582
      *                                                                 25961682
      *----------------------------------------------------------------*25961782
      *    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *25961882
      *----------------------------------------------------------------*25961982
       4400-MOVE-COMMAREA-TO-SCREEN.                                    25962082
           MOVE ASC-XFER-TYPE            TO MR-SEL-XFER-TYPE.           25963082
           MOVE ASC-CONTAINER-TYPE       TO MR-SEL-CONT-TYPE.           25964082
           MOVE ASC-FR-STR-NBR-X         TO MR-FR-STORE-NBR.            25965082
           MOVE ASC-FR-STR-NAM           TO MR-FR-STORE-NAM.            25966082
           PERFORM                                                      25967082
             VARYING PV-READ-COUNT                                      25968082
               FROM 1 BY 1                                              25969082
               UNTIL (PV-READ-COUNT > PC-MAX-TYPES)                     25970082
                 MOVE ASC-XFER-TYPE-FIELD (PV-READ-COUNT)               25980082
                                       TO MR-XFER-TYPE (PV-READ-COUNT)  25990082
                 MOVE ASC-CONT-TYPE-FIELD (PV-READ-COUNT)               26000082
                                       TO MR-CONT-TYPE (PV-READ-COUNT)  26010082
           END-PERFORM.                                                 26020082
       EJECT                                                            26030082
      *----------------------------------------------------------------*30310082
      *    GET THE 10 CHARACTER ABBREVIATED STORE NAME.                *30320082
      *----------------------------------------------------------------*30330082
       4500-READ-STORE.                                                 30340082
           MOVE ASC-FR-STR-NBR           TO DK-STORE-NBR.               30341082
           PERFORM WITH TEST AFTER                                      30350082
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       30360082
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  30370082
                    OR SQLCODE = ZERO                                   30380082
                    OR SQLCODE = +100                                   30390082
               EXEC SQL                                                 30400082
100404             SELECT LOC_10_ABBR_NM                                30410089
100404                   ,LOC_TYP_CDE                                   30420089
100404                 INTO :XST00001-LOC-10-ABBR-NM                    30420189
100404                   ,  :XST00001-LOC-TYP-CDE                       30420289
100404                 FROM XST_LOC                                     30430089
100404                 WHERE LOC_NBR     = :DK-STORE-NBR                30440089
               END-EXEC                                                 30450082
               EVALUATE TRUE                                            30460082
                   WHEN SQLCODE = ZERO                                  30461089
100404                 MOVE XST00001-LOC-10-ABBR-NM   TO                30462089
                                       ASC-FR-STR-NAM                   30463089
100404                 MOVE XST00001-LOC-TYP-CDE  TO ASC-TYPE-CODE      30464089
                       SET PS-STORE-FOUND  TO TRUE                      30465089
                   WHEN SQLCODE = +100                                  30466089
                       MOVE SPACES                TO ASC-TYPE-CODE      30467089
                   WHEN SQLCODE = -904                                  30470082
                   WHEN SQLCODE = -913                                  30480082
                       CONTINUE                                         30490082
                   WHEN OTHER                                           30550089
                        MOVE '4500-READ-STORE'                          30580082
                                          TO DP013-PARAGRAPH            30590082
                        MOVE 'READ A ROW FROM THE STORE TABLE'          30600082
                                          TO DP013-MESSAGE-TEXT(1)      30610082
                        MOVE SQLCA        TO DP013-SQLCA                30620082
100404                  MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (1)   30630089
                        SET DP013-DB2-ABEND                             30640082
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          30650082
                        PERFORM DP013-0000-PROCESS-ABEND                30660082
               END-EVALUATE                                             30670082
           END-PERFORM.                                                 30680082
                                                                        30690082
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           30700082
               MOVE '4500-READ-STORE' TO DP013-PARAGRAPH                30720082
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO READ'       30730082
                                          TO DP013-MESSAGE-TEXT (1)     30740082
               MOVE 'THE STORE TABLE'     TO DP013-MESSAGE-TEXT (2)     30750082
               MOVE SQLCA                 TO DP013-SQLCA                30760082
100404         MOVE 'XST_LOC'             TO DP013-DB2-TABLE-NAME (1)   30770089
               SET DP013-DB2-ABEND                                      30780082
                   DP013-XCTL-DISPLAY-RESTART                           30790082
                                          TO TRUE                       30800082
               PERFORM DP013-0000-PROCESS-ABEND                         30810082
           END-IF.                                                      30820082
       EJECT                                                            30830082
051705*----------------------------------------------------------------*30840092
051705*    GET THE PHYSICAL INVENTORY PERIOD INDICATOR FROM TTFCNTL    *30850092
051705*----------------------------------------------------------------*30860092
051705*4520-READ-CONTROL-TABLE.                                         30870092
051705*    EXEC SQL                                                     30880092
051705*        SET  :PV-CURRENT-DATE       =  CURRENT DATE              30890092
051705*    END-EXEC.                                                    30900092
051705*                                                                 30910092
051705*    EVALUATE TRUE                                                30920092
051705*        WHEN SQLCODE = +0                                        30921092
051705*            CONTINUE                                             30922092
051705*        WHEN OTHER                                               30930092
051705*            MOVE '4520-READ-CONTROL-TABLE'                       30960092
051705*                                      TO DP013-PARAGRAPH         30970092
051705*            MOVE 'SELECT THE CURRENT DATE'                       30980092
051705*                                      TO DP013-MESSAGE-TEXT (1)  30990092
051705*            MOVE SQLCA                TO DP013-SQLCA             31000092
051705*            SET DP013-DB2-ABEND                                  31010092
051705*                DP013-NO-ROLLBACK     TO TRUE                    31020092
051705*            PERFORM DP013-0000-PROCESS-ABEND                     31030092
051705*    END-EVALUATE.                                                31040092
051705*    PERFORM                                                      31050092
051705*        WITH TEST AFTER                                          31060092
051705*        VARYING PV-RETRY-COUNT                                   31070092
051705*        FROM 1 BY 1                                              31080092
051705*        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 31090092
051705*            OR (SQLCODE = +0))                                   31100092
051705*        EXEC SQL                                                 31110092
051705*            SELECT PHY_INV_PERD_IND                              31120092
051705*                  ,XFER_INV_CTOFF_DTE                            31130092
051705*                  ,SCHD_CNT_BEG_DTE                              31131092
051705*                  ,SCHD_CNT_END_DTE                              31132092
051705*             INTO :TFCNTL-PHY-INV-PERD-IND                       31140092
051705*                 ,:TFCNTL-XFER-INV-CTOFF-DTE                     31150092
051705*                 ,:TFCNTL-SCHD-CNT-BEG-DTE                       31151092
051705*                 ,:TFCNTL-SCHD-CNT-END-DTE                       31152092
051705*             FROM TTFCNTL                                        31160092
051705*        END-EXEC                                                 31170092
051705*        EVALUATE TRUE                                            31180092
051705*            WHEN SQLCODE = ZERO                                  31190092
051705*                  MOVE TFCNTL-PHY-INV-PERD-IND                   31200092
051705*                                    TO PV-PHY-INV-PERD-IND       31210092
051705*                  MOVE TFCNTL-XFER-INV-CTOFF-DTE                 31220092
051705*                                    TO PV-XFER-INV-CTOFF-DTE     31230092
051705*                  MOVE TFCNTL-SCHD-CNT-BEG-DTE                   31230192
051705*                                    TO PV-COUNT-BEG-DTE          31230292
051705*                  MOVE TFCNTL-SCHD-CNT-END-DTE                   31230392
051705*                                    TO PV-COUNT-END-DTE          31231092
051705*            WHEN SQLCODE = -904                                  31240092
051705*            WHEN SQLCODE = -913                                  31250092
051705*                CONTINUE                                         31260092
051705*            WHEN OTHER                                           31270092
051705*                MOVE '4520-READ-CONTROL-TABLE'                   31300092
051705*                                  TO DP013-PARAGRAPH             31310092
051705*                MOVE 'GET THE PHYSICAL INV. PERIOD INDICATOR'    31320092
051705*                                      TO DP013-MESSAGE-TEXT (1)  31330092
051705*                MOVE SQLCA            TO DP013-SQLCA             31340092
051705*                MOVE 'TTFCNTL'        TO DP013-DB2-TABLE-NAME (1)31350092
051705*                SET DP013-DB2-ABEND                              31360092
051705*                DP013-XCTL-DISPLAY-RESTART                       31370092
051705*                                     TO TRUE                     31380092
051705*                PERFORM DP013-0000-PROCESS-ABEND                 31390092
051705*        END-EVALUATE                                             31400092
051705*    END-PERFORM.                                                 31410092
051705*                                                                 31420092
051705*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          31430092
051705*                MOVE '4520-READ-CONTROL-TABLE'                   31440092
051705*                                  TO DP013-PARAGRAPH             31450092
051705*                MOVE 'MAX RETRIES EXCEEDED READING '             31460092
051705*                                      TO DP013-MESSAGE-TEXT (1)  31470092
051705*                MOVE SQLCA            TO DP013-SQLCA             31480092
051705*                MOVE 'TTFCNTL'        TO DP013-DB2-TABLE-NAME (1)31490092
051705*                SET DP013-DB2-ABEND                              31500092
051705*                DP013-XCTL-DISPLAY-RESTART                       31510092
051705*                                     TO TRUE                     31520092
051705*                PERFORM DP013-0000-PROCESS-ABEND                 31530092
051705*    END-IF.                                                      31540092
051705*EJECT                                                            31550092
051705*----------------------------------------------------------------*31560092
051705*    GET THE MAX PLANNED INVENTORY DATE FOR THIS STORE           *31570092
051705*----------------------------------------------------------------*31580092
051705*4540-GET-PLND-INV-DTE.                                           31590092
051705*    PERFORM                                                      31600092
051705*        WITH TEST AFTER                                          31610092
051705*        VARYING PV-RETRY-COUNT                                   31620092
051705*        FROM 1 BY 1                                              31630092
051705*        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 31640092
051705*            OR (SQLCODE = +100)                                  31650092
051705*            OR (SQLCODE = +0))                                   31660092
051705*        EXEC SQL                                                 31670092
051705*            SELECT MAX(PLND_INV_DTE)                             31680092
051705*                INTO :INVPAR-PLND-INV-DTE                        31690092
051705*                     :PV-NULL-IND                                31700092
051705*                FROM TINVPAR                                     31710092
051705*                WHERE  LOC_NBR      = :DK-STORE-NBR-9     AND    31720092
051705*                       PLND_INV_DTE < :PC-MAX-DATE               31730092
051705*        END-EXEC                                                 31740092
051705*        EVALUATE TRUE                                            31750092
051705*            WHEN SQLCODE = ZERO                                  31760092
051705*            WHEN SQLCODE = -904                                  31770092
051705*            WHEN SQLCODE = -913                                  31780092
051705*                CONTINUE                                         31790092
051705*            WHEN SQLCODE = +100                                  31800092
051705*                MOVE PC-MIN-DATE     TO INVPAR-PLND-INV-DTE      31810092
051705*            WHEN OTHER                                           31820092
051705*                MOVE '4540-GET-PLND-INV-DTE'                     31850092
051705*                                  TO DP013-PARAGRAPH             31860092
051705*                MOVE 'GET THE PLANNED INVENTORY DATE FOR STORE:' 31870092
051705*                                      TO DP013-MESSAGE-TEXT (1)  31880092
051705*                MOVE DK-STORE-NBR-9   TO DP013-MESSAGE-TEXT (2)  31890092
051705*                MOVE SQLCA            TO DP013-SQLCA             31910092
051705*                MOVE 'TINVPAR'        TO DP013-DB2-TABLE-NAME (1)31920092
051705*                SET DP013-DB2-ABEND                              31930092
051705*                DP013-XCTL-DISPLAY-RESTART                       31940092
051705*                                     TO TRUE                     31950092
051705*                PERFORM DP013-0000-PROCESS-ABEND                 31960092
051705*        END-EVALUATE                                             31970092
051705*    END-PERFORM.                                                 31980092
051705*                                                                 31990092
051705*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          32000092
051705*                MOVE '4540-GET-PLND-INV-DTE'                     32010092
051705*                                  TO DP013-PARAGRAPH             32020092
051705*                MOVE 'MAX RETRIES EXCEEDED READING FOR STORE:'   32030092
051705*                                      TO DP013-MESSAGE-TEXT (1)  32040092
051705*                MOVE DK-STORE-NBR-9   TO DP013-MESSAGE-TEXT (2)  32050092
051705*                MOVE SQLCA            TO DP013-SQLCA             32070092
051705*                MOVE 'TINVPAR'        TO DP013-DB2-TABLE-NAME (1)32080092
051705*                SET DP013-DB2-ABEND                              32090092
051705*                DP013-XCTL-DISPLAY-RESTART                       32100092
051705*                                     TO TRUE                     32110092
051705*                PERFORM DP013-0000-PROCESS-ABEND                 32120092
051705*    END-IF.                                                      32130092
051705*    IF PV-NULL-IND < 0                                           32140092
051705*        MOVE PC-MIN-DATE     TO INVPAR-PLND-INV-DTE              32150092
051705*    END-IF.                                                      32160092
051705*EJECT                                                            32170092
      *----------------------------------------------------------------*32180082
      *    ABEND PROCESSOR MODULE                                      *32190082
      *----------------------------------------------------------------*32200082
                                                                        32210082
           COPY DPPD013.                                                32220082
