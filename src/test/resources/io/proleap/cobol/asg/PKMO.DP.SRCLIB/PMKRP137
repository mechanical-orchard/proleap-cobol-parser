       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.             PMKRP137.                                00020000
       AUTHOR.                 KELLY LARUM.                             00030000
       INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040000
       DATE-WRITTEN.           APRIL 2004.                              00050000
       DATE-COMPILED.                                                   00060000
      *-----------------------------------------------------------      00070000
      *  PMKRP137 -- SKU EARLY RECEIPT NOTIFICATION REPORT              00080000
      *-----------------------------------------------------------      00090000
      *  THIS PROGRAM READS IN A FILE CREATED BY PMKUT127.              00100000
      *  IT ALSO TAKES IN A CONTROL CARD WITH 2 DATES IN IT -           00110000
      *  CURRENT RUNDATE AND CURRENT RUNDATE + 10 DAYS.                 00120000
      *  THE PROGRAM FIGURES OUT WHICH ADEVENTS FALL IN THAT            00130000
      *  DATE RANGE OFF OF THE PMT_PROMO TABLE AND USES THOSE           00140000
      *  PROMOTIONS WHEN LOOKING AT PMT_SKU_LVL_PRICG_BY_LOC            00150000
      *  TABLE - IF A SKU IS NOT ON THIS TABLE FOR A PROMOTION          00160000
      *  IT IS REPORTED ON.  THE PURPOSE OF THIS REPORT IS TO           00170000
      *  HELP THE MERCHANTS TO SEE THAT THEIR MERCHANDISE CAME          00180000
      *  IN EARLIER THAN EXPECTED AND HERE ARE SOME PROMOTIONS          00190000
      *  THAT YOU MIGHT WANT TO CONSIDER PROMOTING THE PRODUCTS         00200000
      *  IN NOW THAT YOU HAVE THEM EARLY.                               00210000
      *----------------------------------------------------------       00220000
      * HISTORY LOG:                                                    00230000
      *----------------------------------------------------------       00240000
      *----------------------------------------------------------       00250000
      * DATE:         12/07/2009                                        00260000
      * WR/IR#:                                                         00270000
      * PROGRAMMER:   PRITHIVIRAJ S.- COGNIZANT                         00280000
      * DESCRIPTION:  INCLUDED HINT TO THE SQL IN D200 PARA TO          00290000
      *               MAKE THE JOB RUN FASTER.                          00300000
      *----------------------------------------------------------       00310000
      *                                                                 00320000
      * DATE:        07/23/2010                                         00330000
      * WR/IR#:      WR37986                                            00340000
      * PROGRAMMER:  PATTY JAEGER                                       00350000
      * DESCRIPTION: CHANGES MADE TO EXCLUDE WEB STORE DATA FROM        00360000
      *              THE REPORT                                         00370000
      *----------------------------------------------------------       00370108
      * DATE:        07/30/2018                                         00372008
      * WR/IR#:      CHG0204126                                         00373008
      * PROGRAMMER:  COGNIZANT                                          00374008
      * DESCRIPTION: ORACLE LOGON STANDARDS PROGRAM CHANGE              00375008
      *----------------------------------------------------------       00380000
       ENVIRONMENT DIVISION.                                            00390000
       CONFIGURATION SECTION.                                           00400000
       SOURCE-COMPUTER. IBM-3090.                                       00410000
       OBJECT-COMPUTER. IBM-3090.                                       00420000
                                                                        00430000
       INPUT-OUTPUT SECTION.                                            00440000
       FILE-CONTROL.                                                    00450000
                                                                        00460000
           SELECT CONTROL-CARD-FILE                                     00470000
              ASSIGN                     TO INP01.                      00480000
                                                                        00490000
           SELECT EARLY-REC-IN-FILE                                     00500000
              ASSIGN                     TO INP02.                      00510000
                                                                        00520000
W37986     SELECT SMPL-STR-INFILE                                       00530000
W37986        ASSIGN                     TO INP03.                      00540000
W37986                                                                  00550000
070941     SELECT ORACLE-LOGON-FILE                                     00551004
070941         ASSIGN                    TO ORALOGON.                   00552006
           SELECT PR-EARLY-REC-RPT                                      00569000
               ASSIGN                    TO RPT01.                      00570000
                                                                        00580000
       DATA DIVISION.                                                   00590000
                                                                        00600000
       FILE SECTION.                                                    00610000
                                                                        00620000
       FD  CONTROL-CARD-FILE                                            00630000
           RECORDING MODE F                                             00640000
           BLOCK CONTAINS 0 RECORDS                                     00650000
           LABEL RECORDS ARE OMITTED                                    00660000
           DATA RECORD IS CONTROL-CARD-REC.                             00670000
       01  CONTROL-CARD-REC                PIC X(80).                   00680000
                                                                        00690000
       FD  EARLY-REC-IN-FILE                                            00700000
           RECORDING MODE F                                             00710000
           BLOCK CONTAINS 0 RECORDS                                     00720000
           LABEL RECORDS ARE OMITTED                                    00730000
           DATA RECORD IS EARLY-REC-IN-REC.                             00740000
       01  EARLY-REC-IN-REC                PIC X(300).                  00750000
                                                                        00760000
W37986 FD  SMPL-STR-INFILE                                              00770000
W37986     RECORDING MODE F                                             00780000
W37986     BLOCK CONTAINS 0 RECORDS                                     00790000
W37986     LABEL RECORDS ARE OMITTED                                    00800000
W37986     DATA RECORD IS SMPL-STR-INFILE-REC.                          00810000
W37986 01  SMPL-STR-INFILE-REC           PIC X(80).                     00820000
W37986                                                                  00830000
070941 FD  ORACLE-LOGON-FILE                                            00831004
070941     RECORDING MODE IS F                                          00832004
070941     LABEL RECORDS ARE STANDARD                                   00833004
070941     BLOCK CONTAINS 0 RECORDS                                     00834004
070941     RECORD CONTAINS 80 CHARACTERS                                00835004
070941     DATA RECORDS IS OL-ORACLE-LOGON-RECORD.                      00836004
070941 01  OL-ORACLE-LOGON-RECORD           PIC X(80).                  00837004
070941                                                                  00838006
       FD  PR-EARLY-REC-RPT                                             00840000
           RECORDING MODE F                                             00850000
           BLOCK CONTAINS 0 RECORDS                                     00860000
           LABEL RECORDS ARE OMITTED.                                   00870000
       01  PR-EARLY-REC-RPT-LINE         PIC X(200).                    00880000
                                                                        00890000
       WORKING-STORAGE SECTION.                                         00900000
                                                                        00910000
       01  ABEND-CODE                    PIC S9(04) COMP VALUE +0.      00920000
           88  ABEND-4001-WRITE-ERROR               VALUE +4001.        00930000
           88  ABEND-4002-READ-ERROR                VALUE +4002.        00940000
           88  ABEND-4003-CTRL-CARD-ERROR           VALUE +4003.        00950000
           88  ABEND-4004-TABLE-ERROR               VALUE +4004.        00960000
           88  ABEND-4005-OPEN-ERROR                VALUE +4005.        00970000
           88  ABEND-4006-CLOSE-ERROR               VALUE +4006.        00980000
           88  ABEND-4007-SEQUENCE-ERROR            VALUE +4007.        00990000
           88  ABEND-4008-DATA-ERROR                VALUE +4008.        01000000
           88  ABEND-4009-KEY-DATA-ERROR            VALUE +4009.        01010000
           88  ABEND-4013-SQL-ERROR                 VALUE +4013.        01020000
           88  ABEND-4014-ORACLE-LOGON-ERROR        VALUE +4014.        01030000
           88  ABEND-4019-DATE-ROUTINE-ERROR        VALUE +4019.        01040000
           88  ABEND-4444-FORCED-ABEND              VALUE +4444.        01050000
                                                                        01060000
       01  CD-CPU-DATE.                                                 01070000
           05  CD-CPU-YR                  PIC 9(02) VALUE ZERO.         01080000
           05  CD-CPU-MO                  PIC 9(02) VALUE ZERO.         01090000
           05  CD-CPU-DY                  PIC 9(02) VALUE ZERO.         01100000
                                                                        01110000
       01  CD-CPU-DATE-GREG.                                            01120000
           05  CD-CPU-MM                  PIC 9(02) VALUE ZERO.         01130000
           05  CD-CPU-DD                  PIC 9(02) VALUE ZERO.         01140000
           05  CD-CPU-YY                  PIC 9(02) VALUE ZERO.         01150000
                                                                        01160000
       01  CT-CPU-TIME.                                                 01170000
           05  CT-CPU-HR                  PIC 9(02) VALUE ZERO.         01180000
           05  CT-CPU-MIN                 PIC 9(02) VALUE ZERO.         01190000
           05  CT-CPU-SEC                 PIC 9(02) VALUE ZERO.         01200000
           05  CT-CPU-HSEC                PIC 9(02) VALUE ZERO.         01210000
                                                                        01220000
       01  END-OF-REPORT-LINE.                                          01230000
           05  FILLER                     PIC X(90) VALUE SPACES.       01240000
           05  FILLER                     PIC X(20) VALUE               01250000
               ' ** END OF REPORT **'.                                  01260000
           05  FILLER                     PIC X(90) VALUE SPACES.       01270000
                                                                        01280000
       01  NOTHING-TO-REPORT-LINE.                                      01290000
           05  FILLER                     PIC X(88) VALUE SPACES.       01300000
           05  FILLER                     PIC X(24) VALUE               01310000
               ' ** NOTHING TO REPORT **'.                              01320000
           05  FILLER                     PIC X(88) VALUE SPACES.       01330000
                                                                        01340000
       01  HEADER-01.                                                   01350000
           05  FILLER                     PIC X(81) VALUE SPACES.       01360000
           05  HDR-01-TITLE               PIC X(39) VALUE SPACES.       01370000
           05  FILLER                     PIC X(80) VALUE SPACES.       01380000
                                                                        01390000
       01  HEADER-01A.                                                  01400000
           05  FILLER                     PIC X(83) VALUE SPACES.       01410000
           05  FILLER                     PIC X(27) VALUE               01420000
               'FOR ACTUAL RECEIPT DATE OF '.                           01430000
           05  HDR-ACTUAL-REC-DATE        PIC X(8)  VALUE SPACES.       01440000
           05  FILLER                     PIC X(82) VALUE SPACES.       01450000
                                                                        01460000
       01  HEADER-PA.                                                   01470000
           05  FILLER                     PIC X(117) VALUE SPACES.      01480000
           05  FILLER                     PIC X(19)  VALUE              01490000
               'PROMOTIONS ANALYZED'.                                   01500000
           05  FILLER                     PIC X(23) VALUE SPACES.       01510000
           05  FILLER                     PIC X(19) VALUE               01520000
               'PROMOTIONS ANALYZED'.                                   01530000
           05  FILLER                     PIC X(30) VALUE SPACES.       01540000
                                                                        01550000
       01  HEADER-PA-DASH.                                              01560000
           05  FILLER                     PIC X(117) VALUE SPACES.      01570000
           05  FILLER                     PIC X(19)  VALUE              01580000
               '-------------------'.                                   01590000
           05  FILLER                     PIC X(23) VALUE SPACES.       01600000
           05  FILLER                     PIC X(19) VALUE               01610000
               '-------------------'.                                   01620000
           05  FILLER                     PIC X(30) VALUE SPACES.       01630000
                                                                        01640000
       01  HEADER-GMM.                                                  01650000
           05  FILLER                     PIC X(10) VALUE               01660000
               'GMM:    00'.                                            01670000
           05  HDR-GMM-NBR                PIC X(02).                    01680000
           05  FILLER                     PIC X(01) VALUE SPACES.       01690000
           05  HDR-GMM-NAME               PIC X(37).                    01700000
           05  FILLER                     PIC X(67) VALUE SPACES.       01710000
           05  HDR-AD-EVNT-NBR-TXT1       PIC X(8).                     01720000
           05  FILLER                     PIC X(01) VALUE SPACES.       01730000
           05  HDR-AD-EVNT-NM1            PIC X(13).                    01740000
           05  FILLER                     PIC X(01) VALUE SPACES.       01750000
           05  HDR-PROMO-ABBR-NM1         PIC X(05).                    01760000
           05  FILLER                     PIC X(01) VALUE SPACES.       01770000
           05  HDR-PROMO-STRT-DATE1       PIC X(05).                    01780000
           05  HDR-DASH1                  PIC X(01).                    01790000
           05  HDR-PROMO-END-DATE1        PIC X(05).                    01800000
           05  FILLER                     PIC X(02) VALUE SPACES.       01810000
           05  HDR-AD-EVNT-NBR-TXT9       PIC X(8).                     01820000
           05  FILLER                     PIC X(01) VALUE SPACES.       01830000
           05  HDR-AD-EVNT-NM9            PIC X(13).                    01840000
           05  FILLER                     PIC X(01) VALUE SPACES.       01850000
           05  HDR-PROMO-ABBR-NM9         PIC X(05).                    01860000
           05  FILLER                     PIC X(01) VALUE SPACES.       01870000
           05  HDR-PROMO-STRT-DATE9       PIC X(05).                    01880000
           05  HDR-DASH9                  PIC X(01).                    01890000
           05  HDR-PROMO-END-DATE9        PIC X(05).                    01900000
                                                                        01910000
       01  HEADER-DMM.                                                  01920000
           05  FILLER                     PIC X(10) VALUE               01930000
               'DMM:    00'.                                            01940000
           05  HDR-DMM-NBR                PIC X(02).                    01950000
           05  FILLER                     PIC X(01) VALUE SPACES.       01960000
           05  HDR-DMM-NAME               PIC X(37).                    01970000
           05  FILLER                     PIC X(67) VALUE SPACES.       01980000
           05  HDR-AD-EVNT-NBR-TXT2       PIC X(8).                     01990000
           05  FILLER                     PIC X(01) VALUE SPACES.       02000000
           05  HDR-AD-EVNT-NM2            PIC X(13).                    02010000
           05  FILLER                     PIC X(01) VALUE SPACES.       02020000
           05  HDR-PROMO-ABBR-NM2         PIC X(05).                    02030000
           05  FILLER                     PIC X(01) VALUE SPACES.       02040000
           05  HDR-PROMO-STRT-DATE2       PIC X(05).                    02050000
           05  HDR-DASH2                  PIC X(01).                    02060000
           05  HDR-PROMO-END-DATE2        PIC X(05).                    02070000
           05  FILLER                     PIC X(02) VALUE SPACES.       02080000
           05  HDR-AD-EVNT-NBR-TXT10      PIC X(8).                     02090000
           05  FILLER                     PIC X(01) VALUE SPACES.       02100000
           05  HDR-AD-EVNT-NM10           PIC X(13).                    02110000
           05  FILLER                     PIC X(01) VALUE SPACES.       02120000
           05  HDR-PROMO-ABBR-NM10        PIC X(05).                    02130000
           05  FILLER                     PIC X(01) VALUE SPACES.       02140000
           05  HDR-PROMO-STRT-DATE10      PIC X(05).                    02150000
           05  HDR-DASH10                 PIC X(01).                    02160000
           05  HDR-PROMO-END-DATE10       PIC X(05).                    02170000
                                                                        02180000
       01  HEADER-BUYER.                                                02190000
           05  FILLER                     PIC X(09) VALUE               02200000
               'BUYER:  0'.                                             02210000
           05  HDR-BYR-NBR                PIC X(03).                    02220000
           05  FILLER                     PIC X(01) VALUE SPACES.       02230000
           05  HDR-BYR-NAME               PIC X(37).                    02240000
           05  FILLER                     PIC X(67) VALUE SPACES.       02250000
           05  HDR-AD-EVNT-NBR-TXT3       PIC X(8).                     02260000
           05  FILLER                     PIC X(01) VALUE SPACES.       02270000
           05  HDR-AD-EVNT-NM3            PIC X(13).                    02280000
           05  FILLER                     PIC X(01) VALUE SPACES.       02290000
           05  HDR-PROMO-ABBR-NM3         PIC X(05).                    02300000
           05  FILLER                     PIC X(01) VALUE SPACES.       02310000
           05  HDR-PROMO-STRT-DATE3       PIC X(05).                    02320000
           05  HDR-DASH3                  PIC X(01).                    02330000
           05  HDR-PROMO-END-DATE3        PIC X(05).                    02340000
           05  FILLER                     PIC X(02) VALUE SPACES.       02350000
           05  HDR-AD-EVNT-NBR-TXT11      PIC X(8).                     02360000
           05  FILLER                     PIC X(01) VALUE SPACES.       02370000
           05  HDR-AD-EVNT-NM11           PIC X(13).                    02380000
           05  FILLER                     PIC X(01) VALUE SPACES.       02390000
           05  HDR-PROMO-ABBR-NM11        PIC X(05).                    02400000
           05  FILLER                     PIC X(01) VALUE SPACES.       02410000
           05  HDR-PROMO-STRT-DATE11      PIC X(05).                    02420000
           05  HDR-DASH11                 PIC X(01).                    02430000
           05  HDR-PROMO-END-DATE11       PIC X(05).                    02440000
                                                                        02450000
       01  HEADER-DEPT.                                                 02460000
           05  FILLER                     PIC X(08) VALUE               02470000
               'DEPT:   '.                                              02480000
           05  HDR-DEPT-NBR               PIC X(04).                    02490000
           05  FILLER                     PIC X(01) VALUE SPACES.       02500000
           05  HDR-DEPT-NAME              PIC X(37).                    02510000
           05  FILLER                     PIC X(67) VALUE SPACES.       02520000
           05  HDR-AD-EVNT-NBR-TXT4       PIC X(8).                     02530000
           05  FILLER                     PIC X(01) VALUE SPACES.       02540000
           05  HDR-AD-EVNT-NM4            PIC X(13).                    02550000
           05  FILLER                     PIC X(01) VALUE SPACES.       02560000
           05  HDR-PROMO-ABBR-NM4         PIC X(05).                    02570000
           05  FILLER                     PIC X(01) VALUE SPACES.       02580000
           05  HDR-PROMO-STRT-DATE4       PIC X(05).                    02590000
           05  HDR-DASH4                  PIC X(01).                    02600000
           05  HDR-PROMO-END-DATE4        PIC X(05).                    02610000
           05  FILLER                     PIC X(02) VALUE SPACES.       02620000
           05  HDR-AD-EVNT-NBR-TXT12      PIC X(8).                     02630000
           05  FILLER                     PIC X(01) VALUE SPACES.       02640000
           05  HDR-AD-EVNT-NM12           PIC X(13).                    02650000
           05  FILLER                     PIC X(01) VALUE SPACES.       02660000
           05  HDR-PROMO-ABBR-NM12        PIC X(05).                    02670000
           05  FILLER                     PIC X(01) VALUE SPACES.       02680000
           05  HDR-PROMO-STRT-DATE12      PIC X(05).                    02690000
           05  HDR-DASH12                 PIC X(01).                    02700000
           05  HDR-PROMO-END-DATE12       PIC X(05).                    02710000
                                                                        02720000
       01  HEADER-ADDITIONAL1.                                          02730000
           05  FILLER                     PIC X(117) VALUE SPACES.      02740000
           05  HDR-AD-EVNT-NBR-TXT5       PIC X(8).                     02750000
           05  FILLER                     PIC X(01) VALUE SPACES.       02760000
           05  HDR-AD-EVNT-NM5            PIC X(13).                    02770000
           05  FILLER                     PIC X(01) VALUE SPACES.       02780000
           05  HDR-PROMO-ABBR-NM5         PIC X(05).                    02790000
           05  FILLER                     PIC X(01) VALUE SPACES.       02800000
           05  HDR-PROMO-STRT-DATE5       PIC X(05).                    02810000
           05  HDR-DASH5                  PIC X(01).                    02820000
           05  HDR-PROMO-END-DATE5        PIC X(05).                    02830000
           05  FILLER                     PIC X(02) VALUE SPACES.       02840000
           05  HDR-AD-EVNT-NBR-TXT13      PIC X(8).                     02850000
           05  FILLER                     PIC X(01) VALUE SPACES.       02860000
           05  HDR-AD-EVNT-NM13           PIC X(13).                    02870000
           05  FILLER                     PIC X(01) VALUE SPACES.       02880000
           05  HDR-PROMO-ABBR-NM13        PIC X(05).                    02890000
           05  FILLER                     PIC X(01) VALUE SPACES.       02900000
           05  HDR-PROMO-STRT-DATE13      PIC X(05).                    02910000
           05  HDR-DASH13                 PIC X(01).                    02920000
           05  HDR-PROMO-END-DATE13       PIC X(05).                    02930000
                                                                        02940000
       01  HEADER-ADDITIONAL2.                                          02950000
           05  FILLER                     PIC X(117) VALUE SPACES.      02960000
           05  HDR-AD-EVNT-NBR-TXT6       PIC X(8).                     02970000
           05  FILLER                     PIC X(01) VALUE SPACES.       02980000
           05  HDR-AD-EVNT-NM6            PIC X(13).                    02990000
           05  FILLER                     PIC X(01) VALUE SPACES.       03000000
           05  HDR-PROMO-ABBR-NM6         PIC X(05).                    03010000
           05  FILLER                     PIC X(01) VALUE SPACES.       03020000
           05  HDR-PROMO-STRT-DATE6       PIC X(05).                    03030000
           05  HDR-DASH6                  PIC X(01).                    03040000
           05  HDR-PROMO-END-DATE6        PIC X(05).                    03050000
           05  FILLER                     PIC X(02) VALUE SPACES.       03060000
           05  HDR-AD-EVNT-NBR-TXT14      PIC X(8).                     03070000
           05  FILLER                     PIC X(01) VALUE SPACES.       03080000
           05  HDR-AD-EVNT-NM14           PIC X(13).                    03090000
           05  FILLER                     PIC X(01) VALUE SPACES.       03100000
           05  HDR-PROMO-ABBR-NM14        PIC X(05).                    03110000
           05  FILLER                     PIC X(01) VALUE SPACES.       03120000
           05  HDR-PROMO-STRT-DATE14      PIC X(05).                    03130000
           05  HDR-DASH14                 PIC X(01).                    03140000
           05  HDR-PROMO-END-DATE14       PIC X(05).                    03150000
                                                                        03160000
       01  HEADER-ADDITIONAL3.                                          03170000
           05  FILLER                     PIC X(117) VALUE SPACES.      03180000
           05  HDR-AD-EVNT-NBR-TXT7       PIC X(8).                     03190000
           05  FILLER                     PIC X(01) VALUE SPACES.       03200000
           05  HDR-AD-EVNT-NM7            PIC X(13).                    03210000
           05  FILLER                     PIC X(01) VALUE SPACES.       03220000
           05  HDR-PROMO-ABBR-NM7         PIC X(05).                    03230000
           05  FILLER                     PIC X(01) VALUE SPACES.       03240000
           05  HDR-PROMO-STRT-DATE7       PIC X(05).                    03250000
           05  HDR-DASH7                  PIC X(01).                    03260000
           05  HDR-PROMO-END-DATE7        PIC X(05).                    03270000
           05  FILLER                     PIC X(02) VALUE SPACES.       03280000
           05  HDR-AD-EVNT-NBR-TXT15      PIC X(8).                     03290000
           05  FILLER                     PIC X(01) VALUE SPACES.       03300000
           05  HDR-AD-EVNT-NM15           PIC X(13).                    03310000
           05  FILLER                     PIC X(01) VALUE SPACES.       03320000
           05  HDR-PROMO-ABBR-NM15        PIC X(05).                    03330000
           05  FILLER                     PIC X(01) VALUE SPACES.       03340000
           05  HDR-PROMO-STRT-DATE15      PIC X(05).                    03350000
           05  HDR-DASH15                 PIC X(01).                    03360000
           05  HDR-PROMO-END-DATE15       PIC X(05).                    03370000
                                                                        03380000
       01  HEADER-ADDITIONAL4.                                          03390000
           05  FILLER                     PIC X(117) VALUE SPACES.      03400000
           05  HDR-AD-EVNT-NBR-TXT8       PIC X(8).                     03410000
           05  FILLER                     PIC X(01) VALUE SPACES.       03420000
           05  HDR-AD-EVNT-NM8            PIC X(13).                    03430000
           05  FILLER                     PIC X(01) VALUE SPACES.       03440000
           05  HDR-PROMO-ABBR-NM8         PIC X(05).                    03450000
           05  FILLER                     PIC X(01) VALUE SPACES.       03460000
           05  HDR-PROMO-STRT-DATE8       PIC X(05).                    03470000
           05  HDR-DASH8                  PIC X(01).                    03480000
           05  HDR-PROMO-END-DATE8        PIC X(05).                    03490000
           05  FILLER                     PIC X(02) VALUE SPACES.       03500000
           05  HDR-AD-EVNT-NBR-TXT16      PIC X(8).                     03510000
           05  FILLER                     PIC X(01) VALUE SPACES.       03520000
           05  HDR-AD-EVNT-NM16           PIC X(13).                    03530000
           05  FILLER                     PIC X(01) VALUE SPACES.       03540000
           05  HDR-PROMO-ABBR-NM16        PIC X(05).                    03550000
           05  FILLER                     PIC X(01) VALUE SPACES.       03560000
           05  HDR-PROMO-STRT-DATE16      PIC X(05).                    03570000
           05  HDR-DASH16                 PIC X(01).                    03580000
           05  HDR-PROMO-END-DATE16       PIC X(05).                    03590000
                                                                        03600000
                                                                        03610000
                                                                        03620000
       01  HEADER-03.                                                   03630000
           05  FILLER                     PIC X(62) VALUE SPACES.       03640000
           05  FILLER                     PIC X(08) VALUE               03650000
               'CURRENT'.                                               03660000
           05  FILLER                     PIC X(12) VALUE SPACES.       03670000
           05  FILLER                     PIC X(03) VALUE               03680000
               'GRP'.                                                   03690000
           05  FILLER                     PIC X(05) VALUE SPACES.       03700000
           05  FILLER                     PIC X(08) VALUE               03710000
               'EXPECTED'.                                              03720000
           05  FILLER                     PIC X(10) VALUE SPACES.       03730000
           05  FILLER                     PIC X(02) VALUE               03740000
               'AD'.                                                    03750000
           05  FILLER                     PIC X(12) VALUE SPACES.       03760000
           05  FILLER                     PIC X(02) VALUE               03770000
               'AD'.                                                    03780000
           05  FILLER                     PIC X(50) VALUE SPACES.       03790000
           05  FILLER                     PIC X(05) VALUE               03800000
               'PROMO'.                                                 03810000
           05  FILLER                     PIC X(10) VALUE SPACES.       03820000
           05  FILLER                     PIC X(05) VALUE               03830000
               'PROMO'.                                                 03840000
                                                                        03850000
       01  HEADER-04.                                                   03860000
           05  FILLER                     PIC X(01) VALUE SPACES.       03870000
           05  FILLER                     PIC X(03) VALUE               03880000
               'DPT'.                                                   03890000
           05  FILLER                     PIC X(05) VALUE SPACES.       03900000
           05  FILLER                     PIC X(03) VALUE               03910000
               'SCL'.                                                   03920000
           05  FILLER                     PIC X(05) VALUE SPACES.       03930000
           05  FILLER                     PIC X(07) VALUE               03940000
               'SKU NBR'.                                               03950000
           05  FILLER                     PIC X(05) VALUE SPACES.       03960000
           05  FILLER                     PIC X(15) VALUE               03970000
               'SKU DESCRIPTION'.                                       03980000
           05  FILLER                     PIC X(18) VALUE SPACES.       03990000
           05  FILLER                     PIC X(12) VALUE               04000000
               'RETAIL PRICE'.                                          04010000
           05  FILLER                     PIC X(08) VALUE SPACES.       04020000
           05  FILLER                     PIC X(03) VALUE               04030000
               'CDE'.                                                   04040000
           05  FILLER                     PIC X(05) VALUE SPACES.       04050000
           05  FILLER                     PIC X(12) VALUE               04060000
               'RECEIPT DATE'.                                          04070000
           05  FILLER                     PIC X(06) VALUE SPACES.       04080000
           05  FILLER                     PIC X(08) VALUE               04090000
               'EVENT ID'.                                              04100000
           05  FILLER                     PIC X(06) VALUE SPACES.       04110000
           05  FILLER                     PIC X(10) VALUE               04120000
               'EVENT NAME'.                                            04130000
           05  FILLER                     PIC X(16) VALUE SPACES.       04140000
           05  FILLER                     PIC X(14) VALUE               04150000
               'PROMOTION NAME'.                                        04160000
           05  FILLER                     PIC X(12) VALUE SPACES.       04170000
           05  FILLER                     PIC X(10) VALUE               04180000
               'START DATE'.                                            04190000
           05  FILLER                     PIC X(05) VALUE SPACES.       04200000
           05  FILLER                     PIC X(08) VALUE               04210000
               'END DATE'.                                              04220000
                                                                        04230000
       01  HEADER-05.                                                   04240000
           05  FILLER                     PIC X(01) VALUE SPACES.       04250000
           05  FILLER                     PIC X(03) VALUE               04260000
               '---'.                                                   04270000
           05  FILLER                     PIC X(05) VALUE SPACES.       04280000
           05  FILLER                     PIC X(03) VALUE               04290000
               '---'.                                                   04300000
           05  FILLER                     PIC X(05) VALUE SPACES.       04310000
           05  FILLER                     PIC X(07) VALUE               04320000
               '-------'.                                               04330000
           05  FILLER                     PIC X(05) VALUE SPACES.       04340000
           05  FILLER                     PIC X(15) VALUE               04350000
               '---------------'.                                       04360000
           05  FILLER                     PIC X(18) VALUE SPACES.       04370000
           05  FILLER                     PIC X(12) VALUE               04380000
               '------------'.                                          04390000
           05  FILLER                     PIC X(08) VALUE SPACES.       04400000
           05  FILLER                     PIC X(03) VALUE               04410000
               '---'.                                                   04420000
           05  FILLER                     PIC X(05) VALUE SPACES.       04430000
           05  FILLER                     PIC X(12) VALUE               04440000
               '------------'.                                          04450000
           05  FILLER                     PIC X(06) VALUE SPACES.       04460000
           05  FILLER                     PIC X(08) VALUE               04470000
               '--------'.                                              04480000
           05  FILLER                     PIC X(06) VALUE SPACES.       04490000
           05  FILLER                     PIC X(10) VALUE               04500000
               '----------'.                                            04510000
           05  FILLER                     PIC X(16) VALUE SPACES.       04520000
           05  FILLER                     PIC X(14) VALUE               04530000
               '--------------'.                                        04540000
           05  FILLER                     PIC X(12) VALUE SPACES.       04550000
           05  FILLER                     PIC X(10) VALUE               04560000
               '----------'.                                            04570000
           05  FILLER                     PIC X(05) VALUE SPACES.       04580000
           05  FILLER                     PIC X(08) VALUE               04590000
               '--------'.                                              04600000
                                                                        04610000
       01  BLANK-PAGE-NOTE.                                             04620000
           05  FILLER                     PIC X(64) VALUE SPACES.       04630000
           05  FILLER                     PIC X(46) VALUE               04640000
               '***** THIS PAGE INTENTIONALLY LEFT BLANK *****'.        04650000
           05  FILLER                     PIC X(65) VALUE SPACES.       04660000
                                                                        04670000
       01  DETAIL-01.                                                   04680000
           05  FILLER                     PIC X(01) VALUE SPACES.       04690000
           05  DTL-01-DEPT-NBR            PIC X(04).                    04700000
           05  FILLER                     PIC X(04) VALUE SPACES.       04710000
           05  DTL-01-CL-NBR              PIC X(04).                    04720000
           05  FILLER                     PIC X(04) VALUE SPACES.       04730000
           05  DTL-01-SKU-NBR             PIC X(08).                    04740000
           05  FILLER                     PIC X(04) VALUE SPACES.       04750000
           05  DTL-01-SKU-DESC            PIC X(30).                    04760000
           05  FILLER                     PIC X(05) VALUE SPACES.       04770000
           05  DTL-01-RETAIL-PRICE        PIC ZZ,ZZZ.99.                04780000
           05  FILLER                     PIC X(09) VALUE SPACES.       04790000
           05  DTL-01-GP-CDE              PIC X(03).                    04800000
           05  FILLER                     PIC X(05) VALUE SPACES.       04810000
           05  DTL-01-EXP-REC-DATE        PIC X(08).                    04820000
           05  FILLER                     PIC X(10) VALUE SPACES.       04830000
           05  DTL-01-AD-EVNT-ID          PIC X(08).                    04840000
           05  FILLER                     PIC X(06) VALUE SPACES.       04850000
           05  DTL-01-AD-EVNT-NAME        PIC X(18).                    04860000
           05  FILLER                     PIC X(08) VALUE SPACES.       04870000
           05  DTL-01-PROMO-NAME          PIC X(17).                    04880000
           05  FILLER                     PIC X(09) VALUE SPACES.       04890000
           05  DTL-01-PROMO-BEG-DATE      PIC X(08).                    04900000
           05  FILLER                     PIC X(07) VALUE SPACES.       04910000
           05  DTL-01-PROMO-END-DATE      PIC X(08).                    04920000
                                                                        04930000
       01  DETAIL-02.                                                   04940000
           05  FILLER                     PIC X(108) VALUE SPACES.      04950000
           05  DTL-02-AD-EVNT-ID          PIC X(08).                    04960000
           05  FILLER                     PIC X(06) VALUE SPACES.       04970000
           05  DTL-02-AD-EVNT-NAME        PIC X(18).                    04980000
           05  FILLER                     PIC X(08) VALUE SPACES.       04990000
           05  DTL-02-PROMO-NAME          PIC X(17).                    05000000
           05  FILLER                     PIC X(09) VALUE SPACES.       05010000
           05  DTL-02-PROMO-BEG-DATE      PIC X(08).                    05020000
           05  FILLER                     PIC X(07) VALUE SPACES.       05030000
           05  DTL-02-PROMO-END-DATE      PIC X(08).                    05040000
                                                                        05050000
       01  DETAIL-PRINT-01                PIC X(200) VALUE SPACES.      05060000
       01  DETAIL-PRINT-02                PIC X(200) VALUE SPACES.      05070000
                                                                        05080000
                                                                        05090000
       01  CC-CONTROL-CARD-REC.                                         05100000
           05 CC-RUN-DATE.                                              05110000
              10 CC-RUN-DATE-CC           PIC X(02).                    05120000
              10 CC-RUN-DATE-YY           PIC X(02).                    05130000
              10 CC-RUN-DATE-MM           PIC X(02).                    05140000
              10 CC-RUN-DATE-DD           PIC X(02).                    05150000
           05  FILLER                     PIC X(01).                    05160000
           05 CC-RUN-DATE2.                                             05170000
              10 CC-RUN-DATE-CC2          PIC X(02).                    05180000
              10 CC-RUN-DATE-YY2          PIC X(02).                    05190000
              10 CC-RUN-DATE-MM2          PIC X(02).                    05200000
              10 CC-RUN-DATE-DD2          PIC X(02).                    05210000
           05  FILLER                     PIC X(63).                    05220000
                                                                        05230000
       01  PV-RUN-DATE.                                                 05240000
              10 PV-RUN-DATE-CC           PIC X(02).                    05250000
              10 PV-RUN-DATE-YY           PIC X(02).                    05260000
              10 FILLER                   PIC X(01) VALUE '-'.          05270000
              10 PV-RUN-DATE-MM           PIC X(02).                    05280000
              10 FILLER                   PIC X(01) VALUE '-'.          05290000
              10 PV-RUN-DATE-DD           PIC X(02).                    05300000
                                                                        05310000
       01  PV-RUN-DATE-FORMATTED          PIC X(10).                    05320000
                                                                        05330000
       01  PV-RUN-DATE2.                                                05340000
              10 PV-RUN-DATE-CC2          PIC X(02).                    05350000
              10 PV-RUN-DATE-YY2          PIC X(02).                    05360000
              10 FILLER                   PIC X(01) VALUE '-'.          05370000
              10 PV-RUN-DATE-MM2          PIC X(02).                    05380000
              10 FILLER                   PIC X(01) VALUE '-'.          05390000
              10 PV-RUN-DATE-DD2          PIC X(02).                    05400000
                                                                        05410000
       01  PV-RUN-DATE2-FORMATTED          PIC X(10).                   05420000
                                                                        05430000
       01  PC-PROGRAM-CONSTANTS.                                        05440000
           05  PC-MAX-LINES               PIC S9(04) COMP VALUE +60.    05450000
           05  PC-CURRENT-PROGRAM-NAME    PIC  X(08) VALUE 'PMKRP137'.  05460000
           05  PC-RDS-REPORT-NAME         PIC  X(02) VALUE SPACES.      05470000
           05  PC-ONE                     PIC  9(02)  VALUE 01.         05480000
           05  PC-HDR1-TITLE1             PIC  X(39) VALUE              05490000
               ' SKU EARLY RECEIPT NOTIFICATION REPORT '.               05500000
           05  PA-CNT-PROMOS              PIC 9(09) VALUE ZEROES.       05510000
           05  PC-INDEX                   PIC S9(04)  VALUE ZEROS.      05520000
                                                                        05530000
      *-----------------------------------------------------------      05540000
      * PS PROGRAM SWITCHES                                             05550000
      *-----------------------------------------------------------      05560000
       01  PS-PROGRAM-SWITCHES.                                         05570000
           05  PS-INPUT-FILE-SW             PIC X(01) VALUE 'N'.        05580000
               88  PS-INPUT-FILE-EOF                  VALUE 'Y'.        05590000
               88  PS-INPUT-FILE-NOT-EOF              VALUE 'N'.        05600000
           05  PS-CC-FILE-SW                PIC X(01) VALUE 'N'.        05610000
               88  PS-CC-FILE-EOF                     VALUE 'Y'.        05620000
               88  PS-CC-FILE-NOT-EOF                 VALUE 'N'.        05630000
           05  PS-FIRST-TIME-IN-SW          PIC X(01) VALUE 'N'.        05640000
               88  PS-NOT-FIRST-TIME-IN               VALUE 'Y'.        05650000
               88  PS-FIRST-TIME-IN                   VALUE 'N'.        05660000
           05  PS-END-OF-PROMO-SR-SW        PIC X(01) VALUE 'N'.        05670000
               88  PS-END-OF-PROMO-CSR                VALUE 'Y'.        05680000
               88  PS-NOT-END-OF-PROMO-CSR            VALUE 'N'.        05690000
W37986     05  PS-CONTROL-CARD-STR-SW       PIC X(01) VALUE 'N'.        05700000
W37986         88  PS-END-OF-CC-FILE-STR              VALUE 'Y'.        05710000
W37986         88  PS-NOT-END-OF-CC-FILE-STR          VALUE 'N'.        05720000
070941     05  PS-END-OF-LOGON-FILE-SW      PIC X(1)  VALUE 'N'.        05721006
070941         88  PS-END-OF-LOGON-FILE               VALUE 'Y'.        05722006
070941     05  PS-ORA-SRC-CTL-DONE-SW       PIC X(1)  VALUE 'N'.        05723006
070941         88  PS-ORA-SRC-EMPTY                   VALUE 'Y'.        05724006
                                                                        05725004
070941 01  CC-ORACLE-CONNECTION.                                        05726004
070941     05  CC-ORACLE-USERID             PIC X(40).                  05727006
070941         88 CC-AUTO-LOGON                       VALUE '/'.        05728006
070941     05  CC-ORACLE-PASSWORD           PIC X(40).                  05729006
                                                                        05730000
       01  PV-PROGRAM-VARIABLES.                                        05740000
070941     05 PV-ORACLE-USERID-LEN        PIC S9(4) VALUE ZEROS         05741006
070941                                               COMP SYNC.         05742006
070941     05 PV-ORACLE-PASSWORD-LEN      PIC S9(4) VALUE ZEROS         05743006
070941                                               COMP SYNC.         05744006
           05 PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACES.       05750000
           05 PV-TABLE-NAME               PIC X(30) VALUE SPACES.       05760000
           05 PV-OPERATION-MSG-1          PIC X(40) VALUE SPACES.       05770000
           05 PV-OPERATION-MSG-2          PIC X(40) VALUE SPACES.       05780000
           05 PV-CPU-TIME                 PIC 9(08) VALUE ZERO.         05790000
           05 PV-PAGE-CNT                 PIC 9(05) VALUE ZERO.         05800000
           05 PV-ADVANCE-LINES            PIC S9(04) COMP VALUE +1.     05810000
           05 PV-ADVANCE-CNT              PIC S9(04) COMP VALUE +0.     05820000
           05 PV-LINE-CNT                 PIC S9(04) COMP VALUE +0.     05830000
           05 PV-PAGE-DIV                 PIC S9(05) VALUE +0.          05840000
           05 PV-PAGE-REM                 PIC S9(03) VALUE +0.          05850000
           05 PV-DUAL-ONE                 PIC S9(02) COMP-3 VALUE 0.    05860000
           05 PV-DUAL-TWO                 PIC S9(02) COMP-3 VALUE 0.    05870000
           05 PV-PROMOTION-TABLE          OCCURS 100 TIMES.             05880000
              10 PV-TABLE-AD-EVNT-NBR-TXT PIC X(15) VALUE SPACES.       05890000
              10 PV-TABLE-AD-EVNT-NM      PIC X(25) VALUE SPACES.       05900000
              10 PV-TABLE-PROMO-ID        PIC S9(10) COMP-3 VALUE +0.   05910000
              10 PV-TABLE-PROMO-ABBR-NM   PIC X(05) VALUE SPACES.       05920000
              10 PV-TABLE-PROMO-STRT-DATE PIC X(08) VALUE SPACES.       05930000
              10 PV-TABLE-PROMO-END-DATE  PIC X(08) VALUE SPACES.       05940000
              10 PV-TABLE-PROMO-NM        PIC X(25) VALUE SPACES.       05950000
              10 PV-TABLE-DASH            PIC X(01) VALUE SPACES.       05960000
                                                                        05970000
           05 PV-PROMO-NBR                PIC S9(3)V COMP-3.            05980000
           05 PV-AD-EVNT-NM               PIC X(25) VALUE SPACES.       05990000
           05 PV-AD-EVNT-NBR-TXT          PIC X(15) VALUE SPACES.       06000000
           05 PV-AD-EVNT-NBR-TXT-SV       PIC X(15) VALUE SPACES.       06010000
           05 PV-AD-EVNT-ID               PIC S9(10) COMP-3 VALUE +0.   06020000
           05 PV-REPORT-TYPE              PIC X(02) VALUE SPACES.       06030000
           05 PV-PROMO-ID                 PIC S9(10) COMP-3 VALUE +0.   06040000
           05 PV-PROMO-NM                 PIC X(25) VALUE SPACES.       06050000
           05 PV-PROMO-ID-TO-USE          PIC S9(10) COMP-3 VALUE +0.   06060000
           05 PV-PROMO-ABBR-NM            PIC X(05) VALUE SPACES.       06070000
           05 PV-PROMO-STRT-DATE          PIC X(08) VALUE SPACES.       06080000
           05 PV-PROMO-END-DATE           PIC X(08) VALUE SPACES.       06090000
           05 PV-PROMO-ITM-ID             PIC S9(10) COMP-3 VALUE +0.   06100000
           05 PV-DEPT-NBR                 PIC S9(04) COMP-3 VALUE +0.   06110000
           05 PV-DEPT-NBR-SAVED           PIC S9(04) COMP-3 VALUE +0.   06120000
           05 PV-MAJ-CL-NBR               PIC S9(04) COMP-3 VALUE +0.   06130000
           05 PV-SUB-CL-NBR               PIC S9(04) COMP-3 VALUE +0.   06140000
           05 PV-SKU-NBR                  PIC S9(08) COMP-3 VALUE +0.   06150000
           05 PV-SKU-NBR-SAVED            PIC S9(08) COMP-3 VALUE +0.   06160000
           05 PV-SKU-DESC                 PIC X(30) VALUE SPACES.       06170000
           05 PV-GP-CDE                   PIC X(03) VALUE SPACES.       06180000
           05 PV-UNT-RTL-AMT              PIC S9(7)V99 COMP-3 VALUE +0. 06190000
           05 PV-DEPT-NM                  PIC X(20) VALUE SPACES.       06200000
           05 PV-GMA-NBR                  PIC X(02) VALUE SPACES.       06210000
           05 PV-GMA-NBR-SAVED            PIC X(02) VALUE SPACES.       06220000
           05 PV-DMA-NBR                  PIC X(02) VALUE SPACES.       06230000
           05 PV-DMA-NBR-SAVED            PIC X(02) VALUE SPACES.       06240000
           05 PV-BYR-NBR                  PIC X(04) VALUE SPACES.       06250000
           05 PV-BYR-NBR-SAVED            PIC X(04) VALUE SPACES.       06260000
           05 PV-GMM-FIRST-NM             PIC X(20).                    06270000
           05 PV-GMM-LAST-NM              PIC X(30).                    06280000
           05 PV-DMM-FIRST-NM             PIC X(20).                    06290000
           05 PV-DMM-LAST-NM              PIC X(30).                    06300000
           05 PV-BYR-FIRST-NM             PIC X(20).                    06310000
           05 PV-BYR-LAST-NM              PIC X(30).                    06320000
           05 PV-FIRST-RCVD-DATE.                                       06330000
              10 PV-FIRST-RCVD-DATE-CC    PIC X(02) VALUE SPACES.       06340000
              10 PV-FIRST-RCVD-DATE-YY    PIC X(02) VALUE SPACES.       06350000
              10 FILLER                   PIC X(01) VALUE SPACES.       06360000
              10 PV-FIRST-RCVD-DATE-MM    PIC X(02) VALUE SPACES.       06370000
              10 FILLER                   PIC X(01) VALUE SPACES.       06380000
              10 PV-FIRST-RCVD-DATE-DD    PIC X(02) VALUE SPACES.       06390000
           05 PV-FIRST-RCVD-DATE-PRINT.                                 06400000
              10 PV-FIRST-RCVD-DATE-MM-P  PIC X(02) VALUE SPACES.       06410000
              10 FILLER                   PIC X(01) VALUE '/'.          06420000
              10 PV-FIRST-RCVD-DATE-DD-P  PIC X(02) VALUE SPACES.       06430000
              10 FILLER                   PIC X(01) VALUE '/'.          06440000
              10 PV-FIRST-RCVD-DATE-YY-P  PIC X(02) VALUE SPACES.       06450000
           05 PV-DONT-SHIP-BEF-PLS8.                                    06460000
              10 PV-DONT-SHIP-BEF-CC      PIC X(02) VALUE SPACES.       06470000
              10 PV-DONT-SHIP-BEF-YY      PIC X(02) VALUE SPACES.       06480000
              10 FILLER                   PIC X(01) VALUE SPACES.       06490000
              10 PV-DONT-SHIP-BEF-MM      PIC X(02) VALUE SPACES.       06500000
              10 FILLER                   PIC X(01) VALUE SPACES.       06510000
              10 PV-DONT-SHIP-BEF-DD      PIC X(02) VALUE SPACES.       06520000
           05 PV-DONT-SHIP-BEF-PRINT.                                   06530000
              10 PV-DONT-SHIP-BEF-MM-P    PIC X(02) VALUE SPACES.       06540000
              10 FILLER                   PIC X(01) VALUE '/'.          06550000
              10 PV-DONT-SHIP-BEF-DD-P    PIC X(02) VALUE SPACES.       06560000
              10 FILLER                   PIC X(01) VALUE '/'.          06570000
              10 PV-DONT-SHIP-BEF-YY-P    PIC X(02) VALUE SPACES.       06580000
W37986     05 PV-CNT-STRS                 PIC 9(02)  VALUE ZEROES.      06590000
W37986     05 PV-HOST-STRS.                                             06600000
W37986        10  PV-HOST-STR-1           PIC S9(04) VALUE +0 COMP-3.   06610000
W37986        10  PV-HOST-STR-2           PIC S9(04) VALUE +0 COMP-3.   06620000
W37986        10  PV-HOST-STR-3           PIC S9(04) VALUE +0 COMP-3.   06630000
W37986        10  PV-HOST-STR-4           PIC S9(04) VALUE +0 COMP-3.   06640000
W37986        10  PV-HOST-STR-5           PIC S9(04) VALUE +0 COMP-3.   06650000
W37986        10  PV-HOST-STR-6           PIC S9(04) VALUE +0 COMP-3.   06660000
W37986        10  PV-HOST-STR-7           PIC S9(04) VALUE +0 COMP-3.   06670000
W37986        10  PV-HOST-STR-8           PIC S9(04) VALUE +0 COMP-3.   06680000
W37986        10  PV-HOST-STR-9           PIC S9(04) VALUE +0 COMP-3.   06690000
W37986        10  PV-HOST-STR-10          PIC S9(04) VALUE +0 COMP-3.   06700000
W37986        10  PV-HOST-STR-11          PIC S9(04) VALUE +0 COMP-3.   06710000
W37986        10  PV-HOST-STR-12          PIC S9(04) VALUE +0 COMP-3.   06720000
W37986        10  PV-HOST-STR-13          PIC S9(04) VALUE +0 COMP-3.   06730000
W37986        10  PV-HOST-STR-14          PIC S9(04) VALUE +0 COMP-3.   06740000
W37986        10  PV-HOST-STR-15          PIC S9(04) VALUE +0 COMP-3.   06750000
                                                                        06760000
      ***************************************************************** 06770000
      *    THE LAYOUT FOR THE EARLY RECEIPT INPUT FILE                * 06780000
      ***************************************************************** 06790000
           COPY PMRD123.                                                06800000
                                                                        06810000
      ***************************************************************** 06820000
      *  STANDARD HEADER LINE - KOHLS 200 COL                           06830000
      ***************************************************************** 06840000
           COPY DPWS200O.                                               06850000
                                                                        06860000
W37986***************************************************************** 06870000
W37986*    THE LAYOUT FOR INPUT FILE - SMPL-STR-INFILE                * 06880000
W37986***************************************************************** 06890000
W37986 01  CC-SMPL-STR-INFILE-REC.                                      06900000
W37986     05  CC-STR-NBR                     PIC 9(04) VALUE 0.        06910000
W37986     05  FILLER                         PIC X(76) VALUE SPACES.   06920000
W37986                                                                  06930000
      ***************************************************************** 06940000
      *                      O  R  A  C  L  E                           06950000
      *----------------------------------------------------------------*06960000
      *    ORACLE DECLARE SECTION                                       06970000
      *----------------------------------------------------------------*06980000
           EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     06990000
                                                                        07000000
      *---------------------------------------------------------------* 07010000
      * ORACLE LOGON WORKING STORAGE COPYBOOK                           07020000
      *---------------------------------------------------------------* 07030000
       01      PC-ENT01-TYPE-CDE          PIC X(02)      VALUE '01'.    07040000
       01      PV-ORACLE-ID               PIC X(1)       VALUE '/'.     07050000
                                                                        07060000
       01      USERNAME                   PIC X(10)      VARYING.       07070000
       01      PASSWD                     PIC X(10)      VARYING.       07080000
                                                                        07090000
       01      ORACLE-RETURN              PIC X(200)     VALUE SPACES.  07100000
                                                                        07110000
           EXEC SQL END DECLARE SECTION END-EXEC.                       07120000
           EXEC SQL INCLUDE SQLCACOB    END-EXEC.                       07130000
                                                                        07140000
       PROCEDURE DIVISION.                                              07150000
      ***************************************************************** 07160000
      * MAINLINE ROUTINE                                                07170000
      ***************************************************************** 07180000
       A100-MAINLINE.                                                   07190000
                                                                        07200000
           PERFORM B100-INITIALIZE.                                     07210000
                                                                        07220000
           IF NOT PS-INPUT-FILE-EOF                                     07230000
              PERFORM B200-READ-RPT-IN-FILE                             07240000
                      UNTIL PS-INPUT-FILE-EOF                           07250000
           END-IF.                                                      07260000
                                                                        07270000
           PERFORM B900-CLOSE-FILES.                                    07280000
           STOP RUN.                                                    07290000
                                                                        07300000
      ***************************************************************** 07310000
      * INITIALIZE ROUTINE                                              07320000
      ***************************************************************** 07330000
       B100-INITIALIZE.                                                 07340000
                                                                        07350000
           OPEN INPUT  EARLY-REC-IN-FILE                                07360000
                       CONTROL-CARD-FILE                                07370000
W37986                 SMPL-STR-INFILE                                  07380000
                OUTPUT PR-EARLY-REC-RPT.                                07390000
                                                                        07400000
           MOVE ZEROES                   TO PV-GMA-NBR-SAVED.           07410000
           MOVE ZEROES                   TO PV-SKU-NBR-SAVED.           07420000
                                                                        07430000
070941*    PERFORM PM700-A000-ORACLE-SETUP.                             07440007
070941     PERFORM B110-ORACLE-SETUP.                                   07441004
                                                                        07450000
      * SETS THE CURRENT DATE AND TIME ON THE TITLE OF THE REPORT.      07460000
           ACCEPT CD-CPU-DATE FROM DATE.                                07470000
           MOVE CD-CPU-YR                TO CD-CPU-YY.                  07480000
           MOVE CD-CPU-MO                TO CD-CPU-MM                   07490000
           MOVE CD-CPU-DY                TO CD-CPU-DD.                  07500000
                                                                        07510000
           ACCEPT CT-CPU-TIME FROM TIME.                                07520000
           MOVE CT-CPU-HR                TO DP200O-RUN-HOUR.            07530000
           MOVE CT-CPU-MIN               TO DP200O-RUN-MINUTE.          07540000
           MOVE CD-CPU-MO                TO DP200O-RUN-MONTH.           07550000
           MOVE CD-CPU-DY                TO DP200O-RUN-DAY.             07560000
           MOVE CD-CPU-YR                TO DP200O-RUN-YEAR.            07570000
           MOVE PC-CURRENT-PROGRAM-NAME  TO DP200O-PROGRAM-NAME.        07580000
           MOVE 1                        TO DP200O-REPORT-NUMBER.       07590000
                                                                        07600000
070941 B110-ORACLE-SETUP.                                               07602004
070941                                                                  07603004
070941     OPEN INPUT ORACLE-LOGON-FILE.                                07604004
070941                                                                  07605004
070941     PERFORM B120-READ-ORACLE-LOGON.                              07606004
070941                                                                  07607004
070941     CLOSE ORACLE-LOGON-FILE.                                     07608004
070941                                                                  07609004
070941     IF ((PS-END-OF-LOGON-FILE)                                   07609104
070941             OR (CC-ORACLE-CONNECTION = SPACES))                  07609204
070941         DISPLAY '** ABEND **'                                    07609304
070941         DISPLAY PC-CURRENT-PROGRAM-NAME                          07609404
070941                 ' - ORACLE LOGON CONTROL CARD '                  07609504
070941                   'NOT PROVIDED'                                 07609604
070941         SET PS-ORA-SRC-EMPTY TO TRUE                             07609704
070941         CALL 'ILBOABN0' USING ABEND-CODE                         07609804
070941     END-IF.                                                      07609904
070941                                                                  07610004
070941     IF CC-AUTO-LOGON                                             07610104
070941         DISPLAY PC-CURRENT-PROGRAM-NAME ' - AUTO LOGON TO ORACLE'07610204
070941         EXEC SQL                                                 07610304
070941              CONNECT :USERNAME                                   07610404
070941         END-EXEC                                                 07610504
070941     ELSE                                                         07610604
070941         INITIALIZE PV-ORACLE-USERID-LEN                          07610704
070941                    PV-ORACLE-PASSWORD-LEN                        07610804
070941         INSPECT CC-ORACLE-USERID                                 07610904
070941             TALLYING PV-ORACLE-USERID-LEN                        07611004
070941          FOR CHARACTERS BEFORE INITIAL SPACE                     07611104
070941      INSPECT CC-ORACLE-PASSWORD                                  07611204
070941          TALLYING PV-ORACLE-PASSWORD-LEN                         07611304
070941          FOR CHARACTERS BEFORE INITIAL SPACE                     07611404
070941      MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN) TO           07611504
070941                USERNAME-ARR                                      07611604
070941      MOVE PV-ORACLE-USERID-LEN TO USERNAME-LEN                   07611704
070941      MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO       07611804
070941                PASSWD-ARR                                        07611904
070941      MOVE PV-ORACLE-PASSWORD-LEN TO PASSWD-LEN                   07612004
070941      DISPLAY PC-CURRENT-PROGRAM-NAME                             07612104
070941              ' - LOGON TO ORACLE AS USER '                       07612204
070941                USERNAME-ARR                                      07612304
070941      EXEC SQL                                                    07612404
070941        CONNECT :USERNAME IDENTIFIED BY :PASSWD                   07612504
070941      END-EXEC                                                    07612604
070941      INITIALIZE CC-ORACLE-PASSWORD                               07612704
070941                 PASSWD                                           07612804
070941      END-IF.                                                     07612904
070941                                                                  07613004
070941     IF (SQLCODE NOT = 0)                                         07613104
070941         DISPLAY PV-PARAGRAPH-NAME                                07613204
070941         DISPLAY PC-CURRENT-PROGRAM-NAME                          07613304
070941                 ' - ERROR LOGGING ON TO ORACLE'                  07613404
070941         PERFORM Z100-ABEND                                       07613504
070941     END-IF.                                                      07613604
070941                                                                  07613704
070941******************************************************************07613804
070941* NEEDS TO BE IN FOR NOW TIL KURT FIXES CURSOR SHARING BUG        07613904
070941* OTHERWISE GET AN ORACLE ERROR (IE: 3113).                       07614004
070941******************************************************************07614104
070941     EXEC SQL                                                     07614204
070941      ALTER SESSION                                               07614304
070941            SET CURSOR_SHARING = 'EXACT'                          07614404
070941     END-EXEC.                                                    07614504
070941                                                                  07614604
070941                                                                  07614704
070941***************************************************************** 07614804
070941*  B120-READ-ORACLE-LOGON.                                      * 07614904
070941* ==> PROCESSES:                                                * 07615004
070941*   - READ ORCALE CONTROL CARD                                  * 07615104
070941* ==> PERFORMED FROM:  B110-ORACLE-SETUP                        * 07615204
070941***************************************************************** 07615304
070941 B120-READ-ORACLE-LOGON.                                          07615404
070941                                                                  07615504
070941     READ ORACLE-LOGON-FILE                                       07615604
070941         INTO CC-ORACLE-CONNECTION                                07615704
070941         AT END                                                   07615804
070941             SET PS-END-OF-LOGON-FILE TO TRUE                     07615904
070941     END-READ.                                                    07616004
070941                                                                  07616106
      ****************************************************************  07617000
      * B200-READ-RPT-IN-FILE.                                          07620000
      ****************************************************************  07630000
       B200-READ-RPT-IN-FILE.                                           07640000
                                                                        07650000
           READ EARLY-REC-IN-FILE INTO PM123-EARLY-REC-FILE             07660000
              AT END                                                    07670000
                 SET PS-INPUT-FILE-EOF TO TRUE                          07680000
           END-READ.                                                    07690000
                                                                        07700000
           IF PS-INPUT-FILE-EOF                                         07710000
               IF PS-FIRST-TIME-IN                                      07720000
                   DISPLAY ' '                                          07730000
                   DISPLAY 'INPUT FILE FOR REPORT WAS EMPTY:   '        07740000
                   DISPLAY 'NOTHING TO REPORT ON'                       07750000
                   DISPLAY ' '                                          07760000
               ELSE                                                     07770000
                   PERFORM W400-WRITE-END-OF-RPT-LINE                   07780000
               END-IF                                                   07790000
           ELSE                                                         07800000
               IF PS-FIRST-TIME-IN                                      07810000
W37986             PERFORM UNTIL PS-END-OF-CC-FILE-STR                  07820000
W37986                PERFORM B240-READ-SMPL-STR-FILE                   07830000
W37986             END-PERFORM                                          07840000
                   PERFORM C000-READ-CONTROL-CARD-FILE                  07850000
                   IF PS-CC-FILE-NOT-EOF                                07860000
                     PERFORM C100-GET-PROMOTIONS-FOR-LEGEND             07870000
                     MOVE PM123-FIRST-RCVD-DATE    TO PV-FIRST-RCVD-DATE07880000
                     MOVE PV-FIRST-RCVD-DATE-MM    TO                   07890000
                                                 PV-FIRST-RCVD-DATE-MM-P07900000
                     MOVE PV-FIRST-RCVD-DATE-DD    TO                   07910000
                                                 PV-FIRST-RCVD-DATE-DD-P07920000
                     MOVE PV-FIRST-RCVD-DATE-YY    TO                   07930000
                                                 PV-FIRST-RCVD-DATE-YY-P07940000
                     MOVE PV-FIRST-RCVD-DATE-PRINT TO                   07950000
                                                 HDR-ACTUAL-REC-DATE    07960000
                     SET PS-NOT-FIRST-TIME-IN      TO TRUE              07970000
                   ELSE                                                 07980000
                     DISPLAY ' '                                        07990000
                     DISPLAY '********** CC ERROR ***************'      08000000
                     DISPLAY 'CONTROL CARD FORMAT SHOULD BE:     '      08010000
                     DISPLAY 'YYYYMMDD YYYYMMDD   '                     08020000
                     DISPLAY 'TODAY    TODAY +10  '                     08030000
                     DISPLAY ' '                                        08040000
                     MOVE 'B200-READ-RPT-IN'      TO PV-PARAGRAPH-NAME  08050000
                     MOVE 'ERROR ON READING CC'   TO PV-OPERATION-MSG-1 08060000
                     PERFORM Z000-ABEND                                 08070000
                   END-IF                                               08080000
               END-IF                                                   08090000
                                                                        08100000
               MOVE PM123-GMA-NBR          TO PV-GMA-NBR                08110000
               MOVE PM123-GMM-FIRST-NAME   TO PV-GMM-FIRST-NM           08120000
               MOVE PM123-GMM-LAST-NAME    TO PV-GMM-LAST-NM            08130000
               MOVE PM123-DMA-NBR          TO PV-DMA-NBR                08140000
               MOVE PM123-DMM-FIRST-NAME   TO PV-DMM-FIRST-NM           08150000
               MOVE PM123-DMM-LAST-NAME    TO PV-DMM-LAST-NM            08160000
               MOVE PM123-BYR-NBR          TO PV-BYR-NBR                08170000
               MOVE PM123-BUYER-FIRST-NAME TO PV-BYR-FIRST-NM           08180000
               MOVE PM123-BUYER-LAST-NAME  TO PV-BYR-LAST-NM            08190000
               MOVE PM123-DEPT-NBR         TO PV-DEPT-NBR               08200000
               MOVE PM123-DEPT-DESC        TO PV-DEPT-NM                08210000
               MOVE PM123-MAJ-CL-NBR       TO PV-MAJ-CL-NBR             08220000
               MOVE PM123-SUB-CL-NBR       TO PV-SUB-CL-NBR             08230000
               MOVE PM123-SKU              TO PV-SKU-NBR                08240000
               MOVE PM123-SKU-DESC         TO PV-SKU-DESC               08250000
               MOVE PM123-DONT-SHIP-BEF-PLS8 TO PV-DONT-SHIP-BEF-PLS8   08260000
               MOVE PV-DONT-SHIP-BEF-MM      TO PV-DONT-SHIP-BEF-MM-P   08270000
               MOVE PV-DONT-SHIP-BEF-DD      TO PV-DONT-SHIP-BEF-DD-P   08280000
               MOVE PV-DONT-SHIP-BEF-YY      TO PV-DONT-SHIP-BEF-YY-P   08290000
               MOVE PM123-GP-CDE           TO PV-GP-CDE                 08300000
               MOVE PM123-UNT-RTL-AMT      TO PV-UNT-RTL-AMT            08310000
                                                                        08320000
               MOVE 0 TO PC-INDEX                                       08330000
               PERFORM D100-GET-PROMOS-FOR-SKU                          08340000
                                                                        08350000
           END-IF.                                                      08360000
                                                                        08370000
W37986****************************************************************  08380000
W37986* B240-READ-SMPL-STR-FILE.                                        08390000
W37986*     READ IN SAMPLE STORE INFO FROM SMPL-STR-INFILE              08400000
W37986****************************************************************  08410000
W37986 B240-READ-SMPL-STR-FILE.                                         08420000
W37986                                                                  08430000
W37986     READ SMPL-STR-INFILE INTO CC-SMPL-STR-INFILE-REC             08440000
W37986       AT END                                                     08450000
W37986          SET PS-END-OF-CC-FILE-STR        TO TRUE                08460000
W37986     END-READ.                                                    08470000
W37986                                                                  08480000
W37986     ADD 1                                 TO PV-CNT-STRS.        08490000
W37986     IF  PS-END-OF-CC-FILE-STR                                    08500000
W37986     AND PV-CNT-STRS = 1                                          08510000
W37986         MOVE 'B240-READ-SMPL-STR-FILE'    TO PV-PARAGRAPH-NAME   08520000
W37986         MOVE 'CONTROL CARD IS EMPTY'      TO PV-OPERATION-MSG-1  08530000
W37986         SET ABEND-4003-CTRL-CARD-ERROR    TO TRUE                08540000
W37986         PERFORM Z200-ABEND                                       08550000
W37986     END-IF                                                       08560000
W37986                                                                  08570000
W37986     IF PS-END-OF-CC-FILE-STR                                     08580000
W37986        CONTINUE                                                  08590000
W37986     ELSE                                                         08600000
W37986        EVALUATE TRUE                                             08610000
W37986          WHEN PV-CNT-STRS = 1                                    08620000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-1       08630000
W37986          WHEN PV-CNT-STRS = 2                                    08640000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-2       08650000
W37986          WHEN PV-CNT-STRS = 3                                    08660000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-3       08670000
W37986          WHEN PV-CNT-STRS = 4                                    08680000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-4       08690000
W37986          WHEN PV-CNT-STRS = 5                                    08700000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-5       08710000
W37986          WHEN PV-CNT-STRS = 6                                    08720000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-6       08730000
W37986          WHEN PV-CNT-STRS = 7                                    08740000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-7       08750000
W37986          WHEN PV-CNT-STRS = 8                                    08760000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-8       08770000
W37986          WHEN PV-CNT-STRS = 9                                    08780000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-9       08790000
W37986          WHEN PV-CNT-STRS = 10                                   08800000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-10      08810000
W37986          WHEN PV-CNT-STRS = 11                                   08820000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-11      08830000
W37986          WHEN PV-CNT-STRS = 12                                   08840000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-12      08850000
W37986          WHEN PV-CNT-STRS = 13                                   08860000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-13      08870000
W37986          WHEN PV-CNT-STRS = 14                                   08880000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-14      08890000
W37986          WHEN PV-CNT-STRS = 15                                   08900000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-15      08910000
W37986        END-EVALUATE                                              08920000
W37986     END-IF.                                                      08930000
                                                                        08940000
      ***************************************************************** 08950000
      *    CLOSE FILES                                                  08960000
      ***************************************************************** 08970000
       B900-CLOSE-FILES.                                                08980000
                                                                        08990000
           CLOSE  EARLY-REC-IN-FILE                                     09000000
                  CONTROL-CARD-FILE                                     09010000
W37986            SMPL-STR-INFILE                                       09020000
                  PR-EARLY-REC-RPT.                                     09030000
                                                                        09040000
      ****************************************************************  09050000
      * C000-READ-CONTROL-CARD.FILE.                                    09060000
      ****************************************************************  09070000
       C000-READ-CONTROL-CARD-FILE.                                     09080000
                                                                        09090000
           READ CONTROL-CARD-FILE INTO CC-CONTROL-CARD-REC              09100000
              AT END                                                    09110000
                 SET PS-CC-FILE-EOF TO TRUE                             09120000
           END-READ.                                                    09130000
                                                                        09140000
           MOVE CC-RUN-DATE-CC  TO PV-RUN-DATE-CC.                      09150000
           MOVE CC-RUN-DATE-YY  TO PV-RUN-DATE-YY.                      09160000
           MOVE CC-RUN-DATE-MM  TO PV-RUN-DATE-MM.                      09170000
           MOVE CC-RUN-DATE-DD  TO PV-RUN-DATE-DD.                      09180000
                                                                        09190000
           MOVE CC-RUN-DATE-CC2 TO PV-RUN-DATE-CC2.                     09200000
           MOVE CC-RUN-DATE-YY2 TO PV-RUN-DATE-YY2.                     09210000
           MOVE CC-RUN-DATE-MM2 TO PV-RUN-DATE-MM2.                     09220000
           MOVE CC-RUN-DATE-DD2 TO PV-RUN-DATE-DD2.                     09230000
                                                                        09240000
           MOVE PV-RUN-DATE TO PV-RUN-DATE-FORMATTED.                   09250000
           MOVE PV-RUN-DATE2 TO PV-RUN-DATE2-FORMATTED.                 09260000
           DISPLAY 'PV-RUN-DATE-FORMATTED: ' PV-RUN-DATE-FORMATTED.     09270000
           DISPLAY 'PV-RUN-DATE2-FORMATTED: ' PV-RUN-DATE2-FORMATTED.   09280000
                                                                        09290000
      ***********************************************************       09300000
      * C100-GET-PROMOTIONS-FOR-LEGEND.                                 09310000
      ***********************************************************       09320000
       C100-GET-PROMOTIONS-FOR-LEGEND.                                  09330000
                                                                        09340000
           PERFORM C200-DECLARE-PROMO-CSR.                              09350000
           PERFORM C300-OPEN-PROMO-CSR.                                 09360000
                                                                        09370000
           IF NOT PS-END-OF-PROMO-CSR                                   09380000
              PERFORM C400-FETCH-PROMO-CSR                              09390000
                      UNTIL PS-END-OF-PROMO-CSR                         09400000
           END-IF.                                                      09410000
                                                                        09420000
           PERFORM C500-CLOSE-PROMO-CSR.                                09430000
                                                                        09440000
      ***********************************************************       09450000
      * C200-DECLARE-PROMO-CSR.                                         09460000
      ***********************************************************       09470000
       C200-DECLARE-PROMO-CSR.                                          09480000
                                                                        09490000
           EXEC SQL                                                     09500000
                DECLARE PROMOCSR CURSOR FOR                             09510000
                SELECT DISTINCT                                         09520000
                      D.AD_EVNT_ID,                                     09530000
                      D.PROMO_ID,                                       09540000
                      TO_CHAR(D.PROMO_DFLT_STRT_TMST, 'MM/DD/YY'),      09550000
                      TO_CHAR(D.PROMO_DFLT_END_TMST, 'MM/DD/YY'),       09560000
                      D.AD_EVNT_NM,                                     09570000
                      D.AD_EVNT_NBR_TXT,                                09580000
                      D.PROMO_ABBR_NM,                                  09590000
                      D.PROMO_NM                                        09600000
                 FROM PMV_PROMO_DIM D                                   09610000
                WHERE REG_PROMO_TYP_CDE = 'A'                           09620000
                  AND PROMO_STAT_CDE    = 'S'                           09630000
                  AND ((D.AD_EVNT_STRT_DTE                              09640000
                       BETWEEN :PV-RUN-DATE-FORMATTED                   09650000
                                AND :PV-RUN-DATE2-FORMATTED)            09660000
                      OR                                                09670000
                      (D.AD_EVNT_END_DTE                                09680000
                       BETWEEN :PV-RUN-DATE-FORMATTED                   09690000
                                AND :PV-RUN-DATE2-FORMATTED))           09700000
             ORDER BY TO_CHAR(D.PROMO_DFLT_STRT_TMST, 'MM/DD/YY')       09710000
                     ,TO_CHAR(D.PROMO_DFLT_END_TMST, 'MM/DD/YY')        09720000
           END-EXEC.                                                    09730000
                                                                        09740000
      ***********************************************************       09750000
      * C300-OPEN-PROMO-CSR.                                            09760000
      ***********************************************************       09770000
       C300-OPEN-PROMO-CSR.                                             09780000
                                                                        09790000
           ACCEPT PV-CPU-TIME FROM TIME.                                09800000
           DISPLAY ' '.                                                 09810000
           DISPLAY 'START PROMO CSR OPEN: ' PV-CPU-TIME.                09820000
           SET PS-NOT-END-OF-PROMO-CSR TO TRUE.                         09830000
                                                                        09840000
           EXEC SQL                                                     09850000
               OPEN PROMOCSR                                            09860000
           END-EXEC.                                                    09870000
                                                                        09880000
           EVALUATE TRUE                                                09890000
               WHEN SQLCODE = ZERO                                      09900000
               WHEN SQLCODE = 1403                                      09910000
                   CONTINUE                                             09920000
               WHEN SQLCODE = 8103                                      09930000
                   DISPLAY '*** NO PROMOTIONS FOR REPORT ***'           09940000
                   DISPLAY 'C300-OPEN-PROMO-CSR'                        09950000
                   PERFORM H100-WRITE-PAGE-HEADER                       09960000
                   PERFORM W401-WRITE-NOTHING-TO-RPT-LINE               09970000
                   SET PS-END-OF-PROMO-CSR       TO TRUE                09980000
               WHEN OTHER                                               09990000
                   MOVE 'C300-OPEN-PROMO-CSR'    TO PV-PARAGRAPH-NAME   10000000
                   DISPLAY PV-PARAGRAPH-NAME                            10010000
                   PERFORM Z100-ABEND                                   10020000
           END-EVALUATE.                                                10030000
                                                                        10040000
      ***********************************************************       10050000
      * C400-FETCH-PROMO-CSR.                                           10060000
      ***********************************************************       10070000
       C400-FETCH-PROMO-CSR.                                            10080000
                                                                        10090000
           EXEC SQL                                                     10100000
               FETCH PROMOCSR                                           10110000
                 INTO :PV-AD-EVNT-ID                                    10120000
                     ,:PV-PROMO-ID                                      10130000
                     ,:PV-PROMO-STRT-DATE                               10140000
                     ,:PV-PROMO-END-DATE                                10150000
                     ,:PV-AD-EVNT-NM                                    10160000
                     ,:PV-AD-EVNT-NBR-TXT                               10170000
                     ,:PV-PROMO-ABBR-NM                                 10180000
                     ,:PV-PROMO-NM                                      10190000
           END-EXEC.                                                    10200000
                                                                        10210000
           EVALUATE TRUE                                                10220000
               WHEN SQLCODE = ZERO                                      10230000
               WHEN SQLCODE = -1405                                     10240000
                  DISPLAY 'PV-PROMO-NM: ' PV-PROMO-NM                   10250000
                  DISPLAY 'PV-PROMO-ID: ' PV-PROMO-ID                   10260000
                  ADD 1             TO PA-CNT-PROMOS                    10270000
                  MOVE PV-PROMO-ID  TO  PV-TABLE-PROMO-ID(PA-CNT-PROMOS)10280000
                  MOVE PV-PROMO-NM  TO  PV-TABLE-PROMO-NM(PA-CNT-PROMOS)10290000
                  EVALUATE TRUE                                         10300000
                     WHEN PA-CNT-PROMOS = 1                             10310000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT1 10320000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  10330000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM1      10340000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       10350000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM1   10360000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  10370000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE1 10380000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)10390000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE1  10400000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 10410000
                        MOVE '-'                TO HDR-DASH1            10420000
                     WHEN PA-CNT-PROMOS = 2                             10430000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT2 10440000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  10450000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM2      10460000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       10470000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM2   10480000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  10490000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE2 10500000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)10510000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE2  10520000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 10530000
                        MOVE '-'                TO HDR-DASH2            10540000
                     WHEN PA-CNT-PROMOS = 3                             10550000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT3 10560000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  10570000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM3      10580000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       10590000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM3   10600000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  10610000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE3 10620000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)10630000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE3  10640000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 10650000
                        MOVE '-'                TO HDR-DASH3            10660000
                     WHEN PA-CNT-PROMOS = 4                             10670000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT4 10680000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  10690000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM4      10700000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       10710000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM4   10720000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  10730000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE4 10740000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)10750000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE4  10760000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 10770000
                        MOVE '-'                TO HDR-DASH4            10780000
                     WHEN PA-CNT-PROMOS = 5                             10790000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT5 10800000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  10810000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM5      10820000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       10830000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM5   10840000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  10850000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE5 10860000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)10870000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE5  10880000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 10890000
                        MOVE '-'                TO HDR-DASH5            10900000
                     WHEN PA-CNT-PROMOS = 6                             10910000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT6 10920000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  10930000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM6      10940000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       10950000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM6   10960000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  10970000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE6 10980000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)10990000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE6  11000000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 11010000
                        MOVE '-'                TO HDR-DASH6            11020000
                     WHEN PA-CNT-PROMOS = 7                             11030000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT7 11040000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  11050000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM7      11060000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       11070000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM7   11080000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  11090000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE7 11100000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)11110000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE7  11120000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 11130000
                        MOVE '-'                TO HDR-DASH7            11140000
                     WHEN PA-CNT-PROMOS = 8                             11150000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT8 11160000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  11170000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM8      11180000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       11190000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM8   11200000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  11210000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE8 11220000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)11230000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE8  11240000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 11250000
                        MOVE '-'                TO HDR-DASH8            11260000
                     WHEN PA-CNT-PROMOS = 9                             11270000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT9 11280000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  11290000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM9      11300000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       11310000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM9   11320000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  11330000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE9 11340000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)11350000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE9  11360000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 11370000
                        MOVE '-'                TO HDR-DASH9            11380000
                     WHEN PA-CNT-PROMOS = 10                            11390000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT1011400000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  11410000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM10     11420000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       11430000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM10  11440000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  11450000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE1011460000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)11470000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE10 11480000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 11490000
                        MOVE '-'                TO HDR-DASH10           11500000
                     WHEN PA-CNT-PROMOS = 11                            11510000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT1111520000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  11530000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM11     11540000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       11550000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM11  11560000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  11570000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE1111580000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)11590000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE11 11600000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 11610000
                        MOVE '-'                TO HDR-DASH11           11620000
                     WHEN PA-CNT-PROMOS = 12                            11630000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT1211640000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  11650000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM12     11660000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       11670000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM12  11680000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  11690000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE1211700000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)11710000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE12 11720000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 11730000
                        MOVE '-'                TO HDR-DASH12           11740000
                     WHEN PA-CNT-PROMOS = 13                            11750000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT1311760000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  11770000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM13     11780000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       11790000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM13  11800000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  11810000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE1311820000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)11830000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE13 11840000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 11850000
                        MOVE '-'                TO HDR-DASH13           11860000
                     WHEN PA-CNT-PROMOS = 14                            11870000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT1411880000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  11890000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM14     11900000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       11910000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM14  11920000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  11930000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE1411940000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)11950000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE14 11960000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 11970000
                        MOVE '-'                TO HDR-DASH14           11980000
                     WHEN PA-CNT-PROMOS = 15                            11990000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT1512000000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  12010000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM15     12020000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       12030000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM15  12040000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  12050000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE1512060000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)12070000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE15 12080000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 12090000
                        MOVE '-'                TO HDR-DASH15           12100000
                     WHEN PA-CNT-PROMOS = 16                            12110000
                        MOVE PV-AD-EVNT-NBR-TXT TO HDR-AD-EVNT-NBR-TXT1612120000
                               PV-TABLE-AD-EVNT-NBR-TXT(PA-CNT-PROMOS)  12130000
                        MOVE PV-AD-EVNT-NM      TO HDR-AD-EVNT-NM16     12140000
                               PV-TABLE-AD-EVNT-NM(PA-CNT-PROMOS)       12150000
                        MOVE PV-PROMO-ABBR-NM   TO HDR-PROMO-ABBR-NM16  12160000
                                 PV-TABLE-PROMO-ABBR-NM(PA-CNT-PROMOS)  12170000
                        MOVE PV-PROMO-STRT-DATE TO HDR-PROMO-STRT-DATE1612180000
                                 PV-TABLE-PROMO-STRT-DATE(PA-CNT-PROMOS)12190000
                        MOVE PV-PROMO-END-DATE  TO HDR-PROMO-END-DATE16 12200000
                                 PV-TABLE-PROMO-END-DATE(PA-CNT-PROMOS) 12210000
                        MOVE '-'                TO HDR-DASH16           12220000
                  END-EVALUATE                                          12230000
                                                                        12240000
               WHEN SQLCODE = 1403                                      12250000
                   SET PS-END-OF-PROMO-CSR TO TRUE                      12260000
                                                                        12270000
               WHEN OTHER                                               12280000
                   MOVE 'C400-FETCH-PROMO-CSR'                          12290000
                                           TO PV-PARAGRAPH-NAME         12300000
                   DISPLAY PV-PARAGRAPH-NAME                            12310000
                   PERFORM Z100-ABEND                                   12320000
           END-EVALUATE.                                                12330000
                                                                        12340000
                                                                        12350000
      ***********************************************************       12360000
      * C500-CLOSE-PROMO-CSR.                                           12370000
      ***********************************************************       12380000
       C500-CLOSE-PROMO-CSR.                                            12390000
                                                                        12400000
           EXEC SQL                                                     12410000
               CLOSE PROMOCSR                                           12420000
           END-EXEC.                                                    12430000
                                                                        12440000
           EVALUATE TRUE                                                12450000
               WHEN SQLCODE = ZERO                                      12460000
               WHEN SQLCODE = 1403                                      12470000
                   CONTINUE                                             12480000
               WHEN OTHER                                               12490000
                   MOVE 'C500-CLOSE-PROMO-CSR'  TO PV-PARAGRAPH-NAME    12500000
                   DISPLAY PV-PARAGRAPH-NAME                            12510000
                   PERFORM Z100-ABEND                                   12520000
           END-EVALUATE.                                                12530000
                                                                        12540000
      ***********************************************************       12550000
      * D100-GET-PROMOS-FOR-SKU.                                        12560000
      ***********************************************************       12570000
       D100-GET-PROMOS-FOR-SKU.                                         12580000
                                                                        12590000
           IF PA-CNT-PROMOS    GREATER ZERO                             12600000
             MOVE PC-ONE TO PC-INDEX                                    12610000
             PERFORM D200-SELECT-INFO                                   12620000
                  UNTIL PC-INDEX > PA-CNT-PROMOS                        12630000
           END-IF.                                                      12640000
                                                                        12650000
      ***********************************************************       12660000
      * D200-SELECT-INFO.                                               12670000
      ***********************************************************       12680000
       D200-SELECT-INFO.                                                12690000
                                                                        12700000
           IF PC-INDEX > PA-CNT-PROMOS                                  12710000
              DISPLAY "PC-INDEX OVER FLOW. INDEX IS AT " PC-INDEX       12720000
              MOVE 'D200-SELECT-INFO'      TO PV-PARAGRAPH-NAME         12730000
              MOVE 'INDEX OVER FLOW'       TO PV-OPERATION-MSG-1        12740000
              PERFORM Z000-ABEND                                        12750000
           ELSE                                                         12760000
              MOVE PV-TABLE-PROMO-ID(PC-INDEX) TO PV-PROMO-ID-TO-USE    12770000
           END-IF.                                                      12780000
                                                                        12790000
           EXEC SQL                                                     12800000
           SELECT 1                                                     12810000
              INTO :PV-DUAL-ONE                                         12820000
              FROM DUAL                                                 12830000
            WHERE EXISTS                                                12840000
           (SELECT /*+ INDEX(A PMI_SKU_LVL_PRICG_BY_LOC0) */ 1          12850000
              FROM PMT_SKU_LVL_PRICG_BY_LOC A,                          12860000
                   PMT_PROMO_ITM B,                                     12870000
                   PMV_PROMO_DIM C                                      12880000
             WHERE C.PROMO_STAT_CDE    = 'S'                            12890000
               AND A.SKU_NBR           = :PV-SKU-NBR                    12900000
W37986         AND A.LOC_NBR                                            12910000
W37986            NOT IN ( SELECT LOC_NBR                               12920000
W37986                FROM XKT_LOC                                      12930000
W37986                WHERE E_BUS_IND = 'Y'                             12940000
W37986                AND LOC_NBR IN ( :PV-HOST-STR-1                   12950000
W37986                                ,:PV-HOST-STR-2                   12960000
W37986                                ,:PV-HOST-STR-3                   12970000
W37986                                ,:PV-HOST-STR-4                   12980000
W37986                                ,:PV-HOST-STR-5                   12990000
W37986                                ,:PV-HOST-STR-6                   13000000
W37986                                ,:PV-HOST-STR-7                   13010000
W37986                                ,:PV-HOST-STR-8                   13020000
W37986                                ,:PV-HOST-STR-9                   13030000
W37986                                ,:PV-HOST-STR-10                  13040000
W37986                                ,:PV-HOST-STR-11                  13050000
W37986                                ,:PV-HOST-STR-12                  13060000
W37986                                ,:PV-HOST-STR-13                  13070000
W37986                                ,:PV-HOST-STR-14                  13080000
W37986                                ,:PV-HOST-STR-15                  13090000
W37986                                       )                          13100000
W37986                   )                                              13110000
               AND A.PROMO_ID          = C.PROMO_ID                     13120000
               AND A.PROMO_ID          = :PV-PROMO-ID-TO-USE            13130000
               AND A.AD_EVNT_ID        = C.AD_EVNT_ID                   13140000
               AND A.PROMO_ITM_ID      = B.PROMO_ITM_ID                 13150000
               AND A.PROMO_PRICG_TYP_CDE  <> 'UNS')                     13160000
           END-EXEC.                                                    13170000
                                                                        13180000
                                                                        13190000
           EVALUATE TRUE                                                13200000
               WHEN SQLCODE = ZEROES                                    13210000
               WHEN SQLCODE = 2112                                      13220000
               WHEN SQLCODE = -2112                                     13230000
                   CONTINUE                                             13240000
               WHEN SQLCODE = 1403                                      13250000
                   PERFORM E100-PROCESS-BREAKS                          13260000
                   PERFORM E200-FILL-IN-REPORT-FIELDS                   13270000
                   PERFORM W200-WRITE-RPT-DETAIL-LINE1                  13280000
               WHEN OTHER                                               13290000
                  SET ABEND-4013-SQL-ERROR        TO TRUE               13300000
                  MOVE 'PMT_SKU_LVL_PRICG_BY_LOC' TO PV-TABLE-NAME      13310000
                  MOVE 'D200-SELECT-INFO'         TO PV-PARAGRAPH-NAME  13320000
                  MOVE 'ERROR ON SELECT SKUS'     TO PV-OPERATION-MSG-1 13330000
                  PERFORM Z100-ABEND                                    13340000
           END-EVALUATE.                                                13350000
                                                                        13360000
           ADD PC-ONE TO PC-INDEX.                                      13370000
                                                                        13380000
      ***************************************************************** 13390000
      * PROCESS BREAKS                                                  13400000
      * CHECK TO SEE IF PROCESSING NEW GMM, NEW DMM, NEW BUYER OR       13410000
      * NEW DEPT - WRITE OUT NEW PAGE HEADER IF ANY OF THESE ARE TRUE.  13420000
      ***************************************************************** 13430000
       E100-PROCESS-BREAKS.                                             13440000
                                                                        13450000
           IF (PV-GMA-NBR     NOT = PV-GMA-NBR-SAVED) OR                13460000
              (PV-DMA-NBR     NOT = PV-DMA-NBR-SAVED) OR                13470000
              (PV-BYR-NBR     NOT = PV-BYR-NBR-SAVED) OR                13480000
              (PV-DEPT-NBR    NOT = PV-DEPT-NBR-SAVED)                  13490000
                                                                        13500000
               IF PV-GMA-NBR-SAVED NOT = ZEROES                         13510000
                   PERFORM H010-WRITE-BLANK-PAGE-IF-NEED                13520000
               END-IF                                                   13530000
                                                                        13540000
              PERFORM H100-WRITE-PAGE-HEADER                            13550000
              MOVE ZEROES      TO PV-SKU-NBR-SAVED                      13560000
                                                                        13570000
           END-IF.                                                      13580000
                                                                        13590000
           MOVE PV-TABLE-AD-EVNT-NBR-TXT(PC-INDEX)   TO                 13600000
                                                  PV-AD-EVNT-NBR-TXT-SV.13610000
           MOVE PV-GMA-NBR              TO PV-GMA-NBR-SAVED.            13620000
           MOVE PV-DMA-NBR              TO PV-DMA-NBR-SAVED.            13630000
           MOVE PV-BYR-NBR              TO PV-BYR-NBR-SAVED.            13640000
           MOVE PV-DEPT-NBR             TO PV-DEPT-NBR-SAVED.           13650000
                                                                        13660000
      ***************************************************************** 13670000
      * E200-FILL-IN-REPORT-FIELDS                                      13680000
      ***************************************************************** 13690000
       E200-FILL-IN-REPORT-FIELDS.                                      13700000
           MOVE PV-DEPT-NBR           TO DTL-01-DEPT-NBR.               13710000
           MOVE PV-SUB-CL-NBR         TO DTL-01-CL-NBR.                 13720000
           MOVE PV-SKU-NBR            TO DTL-01-SKU-NBR.                13730000
           MOVE PV-SKU-DESC           TO DTL-01-SKU-DESC.               13740000
           MOVE PV-GP-CDE             TO DTL-01-GP-CDE.                 13750000
           MOVE PV-UNT-RTL-AMT        TO DTL-01-RETAIL-PRICE.           13760000
           MOVE PV-DONT-SHIP-BEF-PRINT TO DTL-01-EXP-REC-DATE.          13770000
           MOVE PV-TABLE-AD-EVNT-NBR-TXT(PC-INDEX)                      13780000
                                      TO DTL-01-AD-EVNT-ID              13790000
                                         DTL-02-AD-EVNT-ID.             13800000
           MOVE PV-TABLE-AD-EVNT-NM(PC-INDEX)                           13810000
                                      TO DTL-01-AD-EVNT-NAME            13820000
                                         DTL-02-AD-EVNT-NAME.           13830000
           MOVE PV-TABLE-PROMO-NM(PC-INDEX)                             13840000
                                      TO DTL-01-PROMO-NAME              13850000
                                         DTL-02-PROMO-NAME.             13860000
           MOVE PV-TABLE-PROMO-STRT-DATE(PC-INDEX)                      13870000
                                      TO DTL-01-PROMO-BEG-DATE          13880000
                                         DTL-02-PROMO-BEG-DATE.         13890000
           MOVE PV-TABLE-PROMO-END-DATE(PC-INDEX)                       13900000
                                      TO DTL-01-PROMO-END-DATE          13910000
                                         DTL-02-PROMO-END-DATE.         13920000
                                                                        13930000
      ***************************************************************** 13940000
      *   WRITES A BLANK PAGE SO NEW BUYER STARTS ON NEW SHEET.         13950000
      ***************************************************************** 13960000
       H010-WRITE-BLANK-PAGE-IF-NEED.                                   13970000
                                                                        13980000
           DIVIDE PV-PAGE-CNT BY 2                                      13990000
               GIVING PV-PAGE-DIV                                       14000000
               REMAINDER PV-PAGE-REM.                                   14010000
                                                                        14020000
           IF PV-PAGE-REM > 0                                           14030000
                PERFORM H030-WRITE-ONE-BLANK-PAGE                       14040000
           END-IF.                                                      14050000
                                                                        14060000
      ***************************************************************** 14070000
      *   WRITES THE HEADER LINES TO THE REPORT.                        14080000
      ***************************************************************** 14090000
       H030-WRITE-ONE-BLANK-PAGE.                                       14100000
                                                                        14110000
           ADD 1                         TO PV-PAGE-CNT.                14120000
           MOVE PV-PAGE-CNT              TO DP200O-PAGE-NUMBER.         14130000
                                                                        14140000
           MOVE 1                        TO DP200O-REPORT-NUMBER.       14150000
           MOVE DP200O-STANDRD-HEADER-200-COLS TO PR-EARLY-REC-RPT-LINE.14160000
           PERFORM W100-WRITE-RPT-NEW-PAGE.                             14170000
                                                                        14180000
           MOVE HEADER-01                TO PR-EARLY-REC-RPT-LINE.      14190000
           MOVE 1                        TO PV-ADVANCE-LINES.           14200000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14210000
                                                                        14220000
           MOVE HEADER-01A               TO PR-EARLY-REC-RPT-LINE.      14230000
           MOVE 1                        TO PV-ADVANCE-LINES.           14240000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14250000
                                                                        14260000
           PERFORM W700-WRITE-BLANK-LINE.                               14270000
           PERFORM W700-WRITE-BLANK-LINE.                               14280000
                                                                        14290000
           MOVE HEADER-PA                TO PR-EARLY-REC-RPT-LINE.      14300000
           MOVE 1                        TO PV-ADVANCE-LINES.           14310000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14320000
                                                                        14330000
           MOVE HEADER-PA-DASH           TO PR-EARLY-REC-RPT-LINE.      14340000
           MOVE 1                        TO PV-ADVANCE-LINES.           14350000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14360000
                                                                        14370000
           MOVE HEADER-GMM               TO PR-EARLY-REC-RPT-LINE.      14380000
           MOVE 1                        TO PV-ADVANCE-LINES.           14390000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14400000
                                                                        14410000
           MOVE HEADER-DMM               TO PR-EARLY-REC-RPT-LINE.      14420000
           MOVE 1                        TO PV-ADVANCE-LINES.           14430000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14440000
                                                                        14450000
           MOVE HEADER-BUYER             TO PR-EARLY-REC-RPT-LINE.      14460000
           MOVE 1                        TO PV-ADVANCE-LINES.           14470000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14480000
                                                                        14490000
           MOVE HEADER-DEPT              TO PR-EARLY-REC-RPT-LINE.      14500000
           MOVE 1                        TO PV-ADVANCE-LINES.           14510000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14520000
                                                                        14530000
           MOVE HEADER-ADDITIONAL1       TO PR-EARLY-REC-RPT-LINE.      14540000
           MOVE 1                        TO PV-ADVANCE-LINES.           14550000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14560000
                                                                        14570000
           MOVE HEADER-ADDITIONAL2       TO PR-EARLY-REC-RPT-LINE.      14580000
           MOVE 1                        TO PV-ADVANCE-LINES.           14590000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14600000
                                                                        14610000
           MOVE HEADER-ADDITIONAL3       TO PR-EARLY-REC-RPT-LINE.      14620000
           MOVE 1                        TO PV-ADVANCE-LINES.           14630000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14640000
                                                                        14650000
           MOVE HEADER-ADDITIONAL4       TO PR-EARLY-REC-RPT-LINE.      14660000
           MOVE 1                        TO PV-ADVANCE-LINES.           14670000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14680000
                                                                        14690000
           MOVE BLANK-PAGE-NOTE          TO PR-EARLY-REC-RPT-LINE.      14700000
           MOVE 10                       TO PV-ADVANCE-LINES.           14710000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14720000
                                                                        14730000
           PERFORM W700-WRITE-BLANK-LINE.                               14740000
                                                                        14750000
      ***************************************************************** 14760000
      *   WRITES THE HEADER LINES TO THE REPORT.                        14770000
      ***************************************************************** 14780000
       H100-WRITE-PAGE-HEADER.                                          14790000
                                                                        14800000
           ADD 1                         TO PV-PAGE-CNT.                14810000
           MOVE PV-PAGE-CNT              TO DP200O-PAGE-NUMBER.         14820000
                                                                        14830000
           MOVE 1                        TO DP200O-REPORT-NUMBER.       14840000
           MOVE DP200O-STANDRD-HEADER-200-COLS TO PR-EARLY-REC-RPT-LINE.14850000
           PERFORM W100-WRITE-RPT-NEW-PAGE.                             14860000
                                                                        14870000
           MOVE PC-HDR1-TITLE1           TO HDR-01-TITLE.               14880000
           MOVE HEADER-01                TO PR-EARLY-REC-RPT-LINE.      14890000
           MOVE 1                        TO PV-ADVANCE-LINES.           14900000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14910000
                                                                        14920000
           PERFORM W700-WRITE-BLANK-LINE.                               14930000
                                                                        14940000
           MOVE HEADER-01A               TO PR-EARLY-REC-RPT-LINE.      14950000
           MOVE 1                        TO PV-ADVANCE-LINES.           14960000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14970000
                                                                        14980000
           PERFORM W700-WRITE-BLANK-LINE.                               14990000
           PERFORM W700-WRITE-BLANK-LINE.                               15000000
                                                                        15010000
           MOVE HEADER-PA                TO PR-EARLY-REC-RPT-LINE.      15020000
           MOVE 1                        TO PV-ADVANCE-LINES.           15030000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15040000
                                                                        15050000
           MOVE HEADER-PA-DASH           TO PR-EARLY-REC-RPT-LINE.      15060000
           MOVE 1                        TO PV-ADVANCE-LINES.           15070000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15080000
                                                                        15090000
           MOVE PV-GMA-NBR               TO HDR-GMM-NBR.                15100000
           MOVE SPACES                   TO HDR-GMM-NAME.               15110000
           STRING PV-GMM-FIRST-NM DELIMITED BY SPACE                    15120000
                  ' '            DELIMITED BY SIZE                      15130000
                  PV-GMM-LAST-NM DELIMITED BY SPACE                     15140000
                                       INTO HDR-GMM-NAME.               15150000
           MOVE HEADER-GMM               TO PR-EARLY-REC-RPT-LINE.      15160000
           MOVE 1                        TO PV-ADVANCE-LINES.           15170000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15180000
                                                                        15190000
           MOVE PV-DMA-NBR               TO HDR-DMM-NBR.                15200000
           MOVE SPACES                   TO HDR-DMM-NAME.               15210000
           STRING PV-DMM-FIRST-NM DELIMITED BY SPACE                    15220000
                  ' '            DELIMITED BY SIZE                      15230000
                  PV-DMM-LAST-NM DELIMITED BY SPACE                     15240000
                                       INTO HDR-DMM-NAME.               15250000
           MOVE HEADER-DMM               TO PR-EARLY-REC-RPT-LINE.      15260000
           MOVE 1                        TO PV-ADVANCE-LINES.           15270000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15280000
                                                                        15290000
           MOVE PV-BYR-NBR               TO HDR-BYR-NBR.                15300000
           MOVE SPACES                   TO HDR-BYR-NAME.               15310000
           STRING PV-BYR-FIRST-NM DELIMITED BY SPACE                    15320000
                  ' '            DELIMITED BY SIZE                      15330000
                  PV-BYR-LAST-NM DELIMITED BY SPACE                     15340000
                                       INTO HDR-BYR-NAME.               15350000
           MOVE HEADER-BUYER             TO PR-EARLY-REC-RPT-LINE.      15360000
           MOVE 1                        TO PV-ADVANCE-LINES.           15370000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15380000
                                                                        15390000
           MOVE PV-DEPT-NBR              TO HDR-DEPT-NBR.               15400000
           MOVE PV-DEPT-NM               TO HDR-DEPT-NAME.              15410000
           MOVE HEADER-DEPT              TO PR-EARLY-REC-RPT-LINE.      15420000
           MOVE 1                        TO PV-ADVANCE-LINES.           15430000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15440000
                                                                        15450000
           MOVE HEADER-ADDITIONAL1       TO PR-EARLY-REC-RPT-LINE.      15460000
           MOVE 1                        TO PV-ADVANCE-LINES.           15470000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15480000
                                                                        15490000
           MOVE HEADER-ADDITIONAL2       TO PR-EARLY-REC-RPT-LINE.      15500000
           MOVE 1                        TO PV-ADVANCE-LINES.           15510000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15520000
                                                                        15530000
           MOVE HEADER-ADDITIONAL3       TO PR-EARLY-REC-RPT-LINE.      15540000
           MOVE 1                        TO PV-ADVANCE-LINES.           15550000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15560000
                                                                        15570000
           MOVE HEADER-ADDITIONAL4       TO PR-EARLY-REC-RPT-LINE.      15580000
           MOVE 1                        TO PV-ADVANCE-LINES.           15590000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15600000
                                                                        15610000
           PERFORM W700-WRITE-BLANK-LINE.                               15620000
                                                                        15630000
           MOVE HEADER-03                TO PR-EARLY-REC-RPT-LINE.      15640000
           MOVE 1                        TO PV-ADVANCE-LINES.           15650000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15660000
                                                                        15670000
           MOVE HEADER-04                TO PR-EARLY-REC-RPT-LINE.      15680000
           MOVE 1                        TO PV-ADVANCE-LINES.           15690000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15700000
                                                                        15710000
           MOVE HEADER-05                TO PR-EARLY-REC-RPT-LINE.      15720000
           MOVE 1                        TO PV-ADVANCE-LINES.           15730000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15740000
                                                                        15750000
           PERFORM W700-WRITE-BLANK-LINE.                               15760000
                                                                        15770000
      ***************************************************************** 15780000
      *     WRITE NEW PAGE                                              15790000
      ***************************************************************** 15800000
       W100-WRITE-RPT-NEW-PAGE.                                         15810000
                                                                        15820000
           WRITE PR-EARLY-REC-RPT-LINE AFTER ADVANCING PAGE.            15830000
           MOVE 1                        TO PV-LINE-CNT.                15840000
                                                                        15850000
      ***************************************************************** 15860000
      *     WRITE HEADER LINE                                           15870000
      ***************************************************************** 15880000
       W150-WRITE-RPT-HEADER-LINE.                                      15890000
                                                                        15900000
           WRITE PR-EARLY-REC-RPT-LINE AFTER ADVANCING                  15910000
                                       PV-ADVANCE-LINES.                15920000
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                15930000
                                                                        15940000
      ***************************************************************** 15950000
      *     WRITE DETAIL LINE1                                          15960000
      ***************************************************************** 15970000
       W200-WRITE-RPT-DETAIL-LINE1.                                     15980000
                                                                        15990000
           IF PV-LINE-CNT >=  PC-MAX-LINES                              16000000
               PERFORM H100-WRITE-PAGE-HEADER                           16010000
               MOVE ZEROES                   TO PV-SKU-NBR-SAVED        16020000
           END-IF.                                                      16030000
                                                                        16040000
           MOVE 1                        TO PV-ADVANCE-LINES.           16050000
                                                                        16060000
           IF PV-SKU-NBR NOT EQUAL PV-SKU-NBR-SAVED                     16070000
             MOVE DETAIL-01                TO DETAIL-PRINT-01           16080000
             MOVE DETAIL-PRINT-01          TO PR-EARLY-REC-RPT-LINE     16090000
           ELSE                                                         16100000
             MOVE DETAIL-02                TO DETAIL-PRINT-02           16110000
             MOVE DETAIL-PRINT-02          TO PR-EARLY-REC-RPT-LINE     16120000
           END-IF.                                                      16130000
                                                                        16140000
           WRITE PR-EARLY-REC-RPT-LINE AFTER ADVANCING                  16150000
                                            PV-ADVANCE-LINES.           16160000
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                16170000
                                                                        16180000
           MOVE SPACES                   TO DETAIL-01.                  16190000
           MOVE SPACES                   TO DETAIL-02.                  16200000
                                                                        16210000
           MOVE PV-SKU-NBR               TO PV-SKU-NBR-SAVED.           16220000
                                                                        16230000
      ***************************************************************** 16240000
      *     WRITE END OF REPORT LINE                                    16250000
      ***************************************************************** 16260000
       W400-WRITE-END-OF-RPT-LINE.                                      16270000
                                                                        16280000
           SUBTRACT PV-LINE-CNT FROM PC-MAX-LINES                       16290000
             GIVING PV-ADVANCE-CNT.                                     16300000
           MOVE PV-ADVANCE-CNT           TO PV-ADVANCE-LINES.           16310000
                                                                        16320000
           MOVE END-OF-REPORT-LINE       TO PR-EARLY-REC-RPT-LINE.      16330000
           WRITE PR-EARLY-REC-RPT-LINE AFTER ADVANCING                  16340000
                                        PV-ADVANCE-LINES.               16350000
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                16360000
                                                                        16370000
      ***************************************************************** 16380000
      *     WRITE NOTHING TO REPORT LINE                                16390000
      ***************************************************************** 16400000
       W401-WRITE-NOTHING-TO-RPT-LINE.                                  16410000
                                                                        16420000
           SUBTRACT PV-LINE-CNT FROM PC-MAX-LINES                       16430000
             GIVING PV-ADVANCE-CNT.                                     16440000
           MOVE PV-ADVANCE-CNT           TO PV-ADVANCE-LINES.           16450000
                                                                        16460000
           MOVE NOTHING-TO-REPORT-LINE   TO PR-EARLY-REC-RPT-LINE.      16470000
           WRITE PR-EARLY-REC-RPT-LINE AFTER ADVANCING                  16480000
                                        PV-ADVANCE-LINES.               16490000
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                16500000
      ***************************************************************** 16510000
      *     WRITE BLANK LINE                                            16520000
      ***************************************************************** 16530000
       W700-WRITE-BLANK-LINE.                                           16540000
                                                                        16550000
           MOVE SPACES                   TO PR-EARLY-REC-RPT-LINE.      16560000
           WRITE PR-EARLY-REC-RPT-LINE AFTER ADVANCING 1.               16570000
           ADD 1                         TO PV-LINE-CNT.                16580000
                                                                        16590000
      ******************************************************************16600000
      * THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION THAT     *16610000
      * LOGONS TO ORACLE.                                              *16620000
      ******************************************************************16630000
070941*    COPY PMPD700.                                                16640007
                                                                        16650000
      ************************************************************      16660000
      * Z000-ABEND.                                                     16670000
      *     PERFORMS A NON-ORACLE-ABEND.                                16680000
      ************************************************************      16690000
       Z000-ABEND.                                                      16700000
                                                                        16710000
           DISPLAY '** ABEND           **'.                             16720000
           DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  16730000
           DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        16740000
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       16750000
                                                                        16760000
           CALL 'ILBOABN0' USING ABEND-CODE.                            16770000
      ***************************************************************** 16780000
      * Z100-ABEND.                                                   * 16790000
      *  - PERFORM AN ABEND THAT OCCURED RELATED TO ORACLE            * 16800000
      ***************************************************************** 16810000
       Z100-ABEND.                                                      16820000
                                                                        16830000
           DISPLAY '                       '.                           16840000
           DISPLAY '** ABEND **       ** = SQLERROR'.                   16850000
           DISPLAY '** PROGRAM        ** = ' PC-CURRENT-PROGRAM-NAME.   16860000
           DISPLAY '** SQLCODE        ** = ' SQLCODE.                   16870000
           DISPLAY '** ABEND CODE     ** = ' ABEND-CODE.                16880000
           DISPLAY '** SQLERRM        ** = ' SQLERRM.                   16890000
           DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  16900000
           DISPLAY '** SQLERRD(5)     ** = ' SQLERRD(5).                16910000
           DISPLAY '** PARAGRAPH      ** = ' PV-PARAGRAPH-NAME.         16920000
           DISPLAY '** TABLE          ** = ' PV-TABLE-NAME.             16930000
           DISPLAY '** OPERATION      ** = ' PV-OPERATION-MSG-1.        16940000
           DISPLAY '                       '.                           16950000
                                                                        16960000
                                                                        16961000
           CALL 'ILBOABN0' USING ABEND-CODE.                            16970000
                                                                        16980000
W37986************************************************************      16990000
W37986* Z200-ABEND.                                                     17000000
W37986*     PERFORMS A NON-SQL-ABEND.                                   17010000
W37986************************************************************      17020000
W37986 Z200-ABEND.                                                      17030000
W37986                                                                  17040000
W37986     DISPLAY '** ABEND           **'.                             17050000
W37986     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  17060000
W37986     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        17070000
W37986     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       17080000
W37986     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       17090000
W37986                                                                  17100000
W37986     CALL 'ILBOABN0' USING ABEND-CODE.                            17110000
W37986                                                                  17120000
W37986                                                                  17130000
