000100*-----------------------*                                         00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300*-----------------------*                                         00030002
000400 PROGRAM-ID.    PCKCS750.                                         00040002
000500 AUTHOR.        DEANNA BRANTNER.                                  00050002
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060002
000700 DATE-WRITTEN.  NOVEMER, 2001.                                    00070002
000800 DATE-COMPILED.                                                   00080002
000900*---------------------------------------------------------------* 00090002
001000*    E750 - UNITS WORKED - UNITS BY PROCESS AREA LIST SCREEN      00100002
001100*---------------------------------------------------------------* 00110088
001110* DATE  11/04/2021                                                00111099
001120*            - CHANGE CALL OF 'DPKUT100' TO                     * 00112099
001130*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00113099
001140*              MAKING THE CALL DYNAMIC VS STATIC                * 00114099
001150*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00115099
001160*-----------------------------------------------------------------00116099
1122RM* DATE  11/07/2022                                              * 00117099
1122RM*            - ADD COPYBOOK DPWS930                             * 00118099
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00119099
1122RM*              DYNAMIC.                                         * 00119199
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00119299
1122RM*-----------------------------------------------------------------00119399
001200 ENVIRONMENT DIVISION.                                            00120089
001300 DATA DIVISION.                                                   00130089
001400                                                                  00140089
001500 WORKING-STORAGE SECTION.                                         00150089
001600 01  DK-DB2-KEYS.                                                 00160089
001700     05  DK-OPER-UNT-ID                PIC S9(04) COMP VALUE ZERO.00170089
001800     05  DK-OPER-DESC                  PIC X(05) VALUE SPACES.    00180089
001900     05  DK-PROCESS-AREA               PIC X(06) VALUE SPACES.    00190089
001910     05  DK-PROCESS-GROUP              PIC X(06) VALUE SPACES.    00191089
001920     05  DK-FROM-DATE                  PIC X(10) VALUE SPACES.    00192089
001930     05  DK-FROM-DATE-X.                                          00193089
001940         10  DK-FROM-YY                PIC X(04) VALUE SPACES.    00194089
001950         10  FILLER                    PIC X(01) VALUE '-'.       00195089
001960         10  DK-FROM-MM                PIC X(02) VALUE SPACES.    00196089
001970         10  FILLER                    PIC X(01) VALUE '-'.       00197089
001980         10  DK-FROM-DD                PIC X(02) VALUE SPACES.    00198089
001990     05  DK-TO-DATE                    PIC X(10).                 00199089
002000     05  DK-TO-DATE-X.                                            00200089
002100         10  DK-TO-YY                  PIC X(04) VALUE SPACES.    00210089
002200         10  FILLER                    PIC X(01) VALUE '-'.       00220089
002300         10  DK-TO-MM                  PIC X(02) VALUE SPACES.    00230089
002400         10  FILLER                    PIC X(01) VALUE '-'.       00240089
002500         10  DK-TO-DD                  PIC X(02) VALUE SPACES.    00250089
002600     05  DK-FISCAL-WEEK.                                          00260089
002700         10  DK-FISCAL-YEAR            PIC X(04) VALUE SPACES.    00270089
002800         10  DK-FISCAL-WK              PIC X(02) VALUE SPACES.    00280089
002900     05  DK-FISCAL-MONTH.                                         00290089
003000         10  DK-FISCAL-YR              PIC X(04) VALUE SPACES.    00300089
003100         10  DK-FISCAL-MN              PIC X(02) VALUE SPACES.    00310089
003110     05  DK-NUMBER-FORMAT              PIC ZZZZZZ,ZZZ,ZZ9-.       00311099
003200     05  DK-PERCENT-FORMAT.                                       00320089
003300         10  DK-NUMBER                 PIC ZZ9.9 VALUE ZEROES.    00330099
003400         10  DK-PERCENT                PIC X(01) VALUE '%'.       00340089
003500                                                                  00350089
003600 01  PC-PROGRAM-CONSTANTS.                                        00360089
003700     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'PC750A  '.  00370089
003800     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'PCKM750'.   00380089
003900     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'PCKCS750'.  00390089
004000     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00400089
004100     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00410089
004200     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00420089
004300     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00430089
004400     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +10          00440089
004500                                               COMP SYNC.         00450089
004600     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00460089
004700                                               COMP SYNC.         00470089
004800     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00480089
004900                                               COMP-3.            00490089
005000     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00500089
005100                                               COMP SYNC.         00510089
005200     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00520089
005300                                               COMP-3.            00530089
005400     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00540089
005500     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00550089
005600     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00560089
005700     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00570089
005800     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00580089
005900     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00590089
006000                                               COMP.              00600089
006100     05  PC-01                     PIC  X(02)  VALUE '01'.        00610089
006200     05  PC-1                      PIC  S9(4) COMP VALUE 1.       00620089
006300     05  PC-2                      PIC  S9(4) COMP VALUE 2.       00630089
006400     05  PC-3                      PIC  S9(4) COMP VALUE 3.       00640089
006500     05  PC-A                      PIC  X(01)  VALUE 'A'.         00650089
006600*                                                                 00660089
006700*----------------------------------------------------------------*00670089
006800*  SYSTEM MESSAGES                                               *00680089
006900*----------------------------------------------------------------*00690089
007000*   00005 = INVALID VALUE                                        *00700089
007100*   00007 = REQUIRED ENTRY                                        00710089
007200*   00008 = MUST BE NUMERIC                                      *00720089
007300*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00730089
007400*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00740089
007500*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00750089
007600*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00760089
007700*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00770089
007800*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00780089
007900*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00790089
008000*   00069 - TOP OF LIST                                          *00800089
008100*   00070 - BOTTOM OF LIST                                       *00810089
008200*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00820089
008300*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*00830089
008400*   00279 - MORE ITEMS TO DISPLAY                                *00840089
008500*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS INFORMATION      *00850089
008600*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *00860089
008700*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *00870089
008800*   02378 = YOU CANNOT USE A DATE RANGE FOR THIS SEARCH          *00880089
008900*   02873 = F-KEY NOT FUNCTIONAL-CAN ONLY VIEW PO LVL FOR SPFC DC*00890089
009000*   02874 = PO LEVEL DATA NOT AVAILABLE - DATA RETAINED ONLY THRO*00900089
009100*   99901 = INVALID COMMAND WAS ENTERED                          *00910089
009200*----------------------------------------------------------------*00920089
009300     05  PC-TSYMSG-NUMBERS.                                       00930089
009400         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00940089
009500         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  00950089
009600         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00960089
009700         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00970089
009800         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00980089
009900         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00990089
010000         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01000089
010100         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01010089
010200         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01020089
010300         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01030089
010400         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01040089
010500         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01050089
010600         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01060089
010700         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01070089
010800         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01080089
010900         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01090089
011000         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  01100089
011100         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01110089
011200         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01120089
011300         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01130089
011400         10  PC-TSYMSG-02378            PIC  9(05)  VALUE 02378.  01140089
011500         10  PC-TSYMSG-02873            PIC  9(05)  VALUE 02873.  01150089
011600         10  PC-TSYMSG-02874            PIC  9(05)  VALUE 02874.  01160089
011700         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01170089
011800                                                                  01180089
011900 01  PS-PROGRAM-SWITCHES.                                         01190089
012000     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01200089
012100         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01210089
012200         88  PS-BLOCK-ERROR                         VALUE 'N'.    01220089
012300     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01230089
012400         88  PS-NO-ERROR                            VALUE 'Y'.    01240089
012500         88  PS-ERROR                               VALUE 'N'.    01250089
012600     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   01260089
012700         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   01270089
012800         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   01280089
012900     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01290089
013000         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01300089
013100         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01310089
013200     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01320089
013300         88  PS-DONE                                VALUE 'Y'.    01330089
013400         88  PS-NOT-DONE                            VALUE 'N'.    01340089
013500     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01350089
013600         88  PS-LIST-END                            VALUE  'Y'.   01360089
013700         88  PS-NO-LIST-END                         VALUE  'N'.   01370089
013800     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   01380002
013900         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   01390002
014000         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   01400002
014100     05  PS-CURSOR-SW                   PIC  X(01)  VALUE  ' '.   01410089
014200         88  PS-PROCESS-AREA-CSR                    VALUE  'A'.   01420089
014300         88  PS-UK-OPER-AREA-CSR                    VALUE  'B'.   01430089
014301         88  PS-PROCESS-GROUP-CSR                   VALUE  'C'.   01430189
014302         88  PS-UK-OPER-GROUP-CSR                   VALUE  'D'.   01430289
014303         88  PS-PRCSS-GRP-MSC-CSR                   VALUE  'E'.   01430389
014304         88  PS-UK-OPR-GRP-MSC-CSR                  VALUE  'F'.   01430489
014305     05  PS-CURSOR-SW2                  PIC  X(01)  VALUE  ' '.   01430589
014306         88  PS-UNITS-BY-OPER-CSR                   VALUE  'G'.   01430689
014307         88  PS-UNITS-BY-AREA-CSR                   VALUE  'H'.   01430789
014308         88  PS-UNT-BY-AREA-GRP-CR                  VALUE  'I'.   01430899
014309         88  PS-UNT-BY-AREA-MSC-CR                  VALUE  'J'.   01430990
014310         88  PS-UNT-BY-AREA-GRP-OP                  VALUE  'K'.   01431090
014320         88  PS-UNT-BY-AREA-MSC-OP                  VALUE  'L'.   01432090
014510     05  PS-VALID-POHIST-DATE-SW        PIC  X(01)  VALUE  ' '.   01451062
014520         88  PS-VALID-POHIST-DATE                   VALUE  'Y'.   01452062
014530         88  PS-INVALID-POHIST-DATE                 VALUE  'N'.   01453062
014600*                                                                 01460002
014700 01  PV-PROGRAM-VARIABLES.                                        01470002
014800     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     01480002
014900                                                     COMP SYNC.   01490002
015000     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      01500002
015100     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      01510002
015200     05  PV-RACF-ERROR-CODE             PIC  9(04)  VALUE ZEROES. 01520002
015300     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01530002
015400                                        COMP SYNC.                01540002
015500     05  PV-SUB                         PIC S9(04)  VALUE +0      01550002
015600                                                    COMP SYNC.    01560002
015700     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01570002
015800                                                    COMP SYNC.    01580002
015900     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01590002
016000                                                    COMP-3.       01600002
016100     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01610002
016200                                                    COMP-3.       01620002
016300     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01630002
016400                                                    COMP-3.       01640002
016500     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01650002
016600                                                    COMP-3.       01660002
016700     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01670002
016800                                                    COMP-3.       01680002
016900     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01690002
017000                                                    COMP-3.       01700002
017100     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01710002
017200                                                    COMP-3.       01720002
017300     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01730002
017400                                                    COMP SYNC.    01740002
017500     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01750002
017600                                                    COMP SYNC.    01760002
017700     05  PV-ITEM                        PIC S9(04)  VALUE +0      01770002
017800                                                    COMP SYNC.    01780002
017900     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01790002
018000                                                    COMP SYNC.    01800002
018100     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01810002
018200                                                    COMP SYNC.    01820002
018300     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01830002
018400                                                    COMP SYNC.    01840002
018500     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01850002
018600                                                    COMP SYNC.    01860002
018700     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01870002
018800                                                    COMP SYNC.    01880002
018900     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01890002
019000                                                    COMP SYNC.    01900002
019100     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01910002
019200                                                    COMP SYNC.    01920002
019300     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01930002
019400                                                    COMP SYNC.    01940002
019500     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01950002
019600                                                    COMP SYNC.    01960002
019700     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01970002
019800                                                    COMP SYNC.    01980002
019900     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01990002
020000                                                    COMP SYNC.    02000002
020100     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02010002
020200                                                    COMP SYNC.    02020002
020300     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02030002
020400                                                    COMP SYNC.    02040002
020500     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02050002
020600                                                    COMP.         02060002
020700     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02070002
020800                                                    COMP.         02080002
020900     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02090002
021000                                                    COMP.         02100002
021100     05  PV-SOFT-ABORT-MSG.                                       02110002
021200         10  FILLER            PIC X(12) VALUE ' PCKCS750 - '.    02120002
021300         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02130002
021400         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02140002
021500         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02150002
021600         10  PV-SOFT-PARAGRAPH PIC X(30).                         02160002
021700     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02170002
021800                                                     COMP SYNC.   02180002
021900     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02190002
022000     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02200002
022100     05  PV-CICS-MSG-HOLD.                                        02210002
022200         10  FILLER                      PIC  X(01)  VALUE SPACE. 02220002
022300         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02230002
022400     05  PV-CICS-MSG-HOLD2.                                       02240002
022500         10  FILLER                      PIC  X(01)  VALUE SPACE. 02250002
022600         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02260002
022700                                                                  02270002
022710     05  PV-POHIST-DATE          PIC X(10)   VALUE SPACES.        02271062
022720     05  PV-COMPARE-DATE.                                         02272062
022730         10   PV-CMPR-YY                PIC  X(04).               02273062
022740         10   FILLER                    PIC  X(01) VALUE '-'.     02274063
022750         10   PV-CMPR-MM                PIC  X(02).               02275062
022760         10   FILLER                    PIC  X(01) VALUE '-'.     02276063
022770         10   PV-CMPR-DD                PIC  X(02).               02277062
022800     05  PV-TMST                 PIC X(26)   VALUE SPACES.        02280002
022900     05  PV-TMST-R REDEFINES  PV-TMST.                            02290002
023000         10   PV-TMST-CCYY              PIC X(04).                02300002
023100         10   FILLER                    PIC X(01).                02310002
023200         10   PV-TMST-MM                PIC X(02).                02320002
023300         10   FILLER                    PIC X(01).                02330002
023400         10   PV-TMST-DD                PIC X(02).                02340002
023500         10   FILLER                    PIC X(01).                02350002
023600         10   PV-TMST-HRS               PIC X(02).                02360002
023700         10   FILLER                    PIC X(01).                02370002
023800         10   PV-TMST-MIN               PIC X(02).                02380002
023900         10   FILLER                    PIC X(01).                02390002
024000         10   PV-TMST-SEC               PIC X(02).                02400002
024100         10   FILLER                    PIC X(07).                02410002
024200     05  PV-DISPLAY-DATE                PIC  X(45) VALUE SPACES.  02420012
024300     05  PV-SELECT-LIST-SEQ             PIC  X(01) VALUE SPACES.  02430005
024400     05  PV-NBR-ITEMS                   PIC  9(05) VALUE ZEROES.  02440005
024500     05  PV-SEL-TERM-ID                 PIC  X(04).               02450005
024600     05  PV-SEL-TASK-NUMBER             PIC  9(05).               02460005
024700     05  PV-SEL-SEQ                     PIC  9(01).               02470005
024800     05  PV-TOT-UNITS              PIC S9(11) COMP-3 VALUE ZEROS. 02480018
024900     05  PV-3RD-UNITS              PIC S9(11) COMP-3 VALUE ZEROS. 02490018
025000     05  PV-1ST-UNITS              PIC S9(11) COMP-3 VALUE ZEROS. 02500018
025100     05  PV-2ND-UNITS              PIC S9(11) COMP-3 VALUE ZEROS. 02510018
025200     05  PV-3RD-PCT                     PIC S9(05)V9 VALUE ZEROS. 02520099
025300     05  PV-1ST-PCT                     PIC S9(05)V9 VALUE ZEROS. 02530099
025400     05  PV-2ND-PCT                     PIC S9(05)V9 VALUE ZEROS. 02540099
025500     05  PV-TOT-PCT                     PIC S9(05)V9 VALUE ZEROS. 02550099
025600     05  PV-DIVIDEND                    PIC S9(03)V9999.          02560069
025700                                                                  02570005
025800******************************************************************02580002
025900**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02590002
026000**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02600002
026100**  APPLICATION-SPECIFIC COMMAREA.                              **02610002
026200******************************************************************02620002
026300 01  LQW-LIST-QUEUE-WORK-AREA.                                    02630002
026400     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02640002
026500     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           02650002
026600                                        INDEXED BY LQW-IDX.       02660002
026700         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02670002
026800         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02680002
026900         10  LQW-SELECTED-SW            PIC  X(01).               02690002
027000             88  LQW-SELECT                         VALUE 'S'.    02700002
027100             88  LQW-DESELECT                       VALUE ' '.    02710002
027200         10  LQW-ACTION                 PIC  X(03).               02720002
027300             88  LQW-DEL                            VALUE 'DEL'.  02730002
027400             88  LQW-INQ                            VALUE 'INQ'.  02740002
027500             88  LQW-UPD                            VALUE 'UPD'.  02750002
027600             88  LQW-ERR                            VALUE 'ERR'.  02760002
027700         10  LQW-AREA                   PIC  X(06).               02770002
027800         10  LQW-3RD-UNITS              PIC S9(10)  VALUE ZEROS.  02780099
027900         10  LQW-3RD-PCT                PIC S9(5)V9 VALUE ZEROS.  02790099
028000         10  LQW-1ST-UNITS              PIC S9(10)  VALUE ZEROS.  02800099
028100         10  LQW-1ST-PCT                PIC S9(5)V9 VALUE ZEROS.  02810099
028200         10  LQW-2ND-UNITS              PIC S9(10)  VALUE ZEROS.  02820099
028300         10  LQW-2ND-PCT                PIC S9(5)V9 VALUE ZEROS.  02830099
028400         10  LQW-TOT-UNITS              PIC S9(11)  VALUE ZEROS.  02840099
028500         10  LQW-TOT-PCT                PIC S9(5)V9 VALUE ZEROS.  02850099
028600                                                                  02860002
028700*---------------------------------------------------------------* 02870002
028800* SELECTON QUEUE LAYOUT                                         * 02880002
028900*---------------------------------------------------------------* 02890002
029000     COPY PCWS215.                                                02900002
029100                                                                  02910002
029200*---------------------------------------------------------------* 02920002
029300*    MAP LAYOUT                                                 * 02930002
029400*---------------------------------------------------------------* 02940002
029500     COPY PCKM750.                                                02950002
029600*                                                                 02960002
029700 01  MR-OCCURS-LAYOUT                   REDEFINES  PC750AO.       02970002
029800     05  FILLER                         PIC X(244).               02980099
029900     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          02990002
030000         10  MR-SELECTL                 PIC S9(04) COMP.          03000002
030100         10  MR-SELECTA                 PIC  X(01).               03010002
030200         10  MR-SELECTC                 PIC  X(01).               03020002
030300         10  MR-SELECTH                 PIC  X(01).               03030002
030400         10  MR-SELECTI                 PIC  X(01).               03040002
030500                                                                  03050002
030600*        10  MR-ACTIONL                 PIC S9(04) COMP.          03060002
030700*        10  MR-ACTIONA                 PIC  X(01).               03070002
030800*        10  MR-ACTIONC                 PIC  X(01).               03080002
030900*        10  MR-ACTIONH                 PIC  X(01).               03090002
031000*        10  MR-ACTION                  PIC  X(03).               03100002
031100                                                                  03110002
031200         10  MR-AREAL                   PIC S9(04) COMP.          03120002
031300         10  MR-AREAA                   PIC  X(01).               03130002
031400         10  MR-AREAC                   PIC  X(01).               03140002
031500         10  MR-AREAH                   PIC  X(01).               03150002
031600         10  MR-AREA                    PIC  X(06).               03160002
031700                                                                  03170002
031800         10  MR-3RD-UNITSL              PIC S9(04) COMP.          03180002
031900         10  MR-3RD-UNITSA              PIC  X(01).               03190002
032000         10  MR-3RD-UNITSC              PIC  X(01).               03200002
032100         10  MR-3RD-UNITSH              PIC  X(01).               03210002
032200         10  MR-3RD-UNITS               PIC  X(10).               03220002
032300         10  MR-3RD-UNIT-X REDEFINES MR-3RD-UNITS.                03230002
032400             15  MR-3RD-UNITS-N            PIC ZZ,ZZZ,ZZ9.        03240002
032410         10  MR-3RD-UNIT-Y REDEFINES MR-3RD-UNITS.                03241096
032420             15  MR-3RD-UNITS-O            PIC ZZZZZZ,ZZ9.        03242096
032430         10  MR-3RD-UNIT-Z REDEFINES MR-3RD-UNITS.                03243099
032440             15  MR-3RD-UNITS-P            PIC ZZZZZZZZ9-.        03244099
032500                                                                  03250002
032600         10  MR-3RD-PCTL                PIC S9(04) COMP.          03260002
032700         10  MR-3RD-PCTA                PIC  X(01).               03270002
032800         10  MR-3RD-PCTC                PIC  X(01).               03280002
032900         10  MR-3RD-PCTH                PIC  X(01).               03290002
033000         10  MR-3RD-PCT                 PIC  X(05).               03300002
033100         10  MR-3RD-PCT-X REDEFINES MR-3RD-PCT.                   03310002
033200             15  MR-3RD-PCT-N              PIC  ZZ9.9.            03320002
033300                                                                  03330002
033400         10  MR-1ST-UNITSL              PIC S9(04) COMP.          03340002
033500         10  MR-1ST-UNITSA              PIC  X(01).               03350002
033600         10  MR-1ST-UNITSC              PIC  X(01).               03360002
033700         10  MR-1ST-UNITSH              PIC  X(01).               03370002
033800         10  MR-1ST-UNITS               PIC  X(10).               03380002
033900         10  MR-1ST-UNIT-X REDEFINES MR-1ST-UNITS.                03390002
034000             15  MR-1ST-UNITS-N            PIC ZZ,ZZZ,ZZ9.        03400002
034010         10  MR-1ST-UNIT-Y REDEFINES MR-1ST-UNITS.                03401096
034020             15  MR-1ST-UNITS-O            PIC ZZZZZZ,ZZ9.        03402096
034030         10  MR-1ST-UNIT-Z REDEFINES MR-1ST-UNITS.                03403099
034040             15  MR-1ST-UNITS-P            PIC ZZZZZZZZ9-.        03404099
034100                                                                  03410002
034200         10  MR-1ST-PCTL                PIC S9(04) COMP.          03420002
034300         10  MR-1ST-PCTA                PIC  X(01).               03430002
034400         10  MR-1ST-PCTC                PIC  X(01).               03440002
034500         10  MR-1ST-PCTH                PIC  X(01).               03450002
034600         10  MR-1ST-PCT                 PIC  X(05).               03460002
034700         10  MR-1ST-PCT-X REDEFINES MR-1ST-PCT.                   03470002
034800             15  MR-1ST-PCT-N              PIC  ZZ9.9.            03480002
034900                                                                  03490002
035000         10  MR-2ND-UNITSL              PIC S9(04) COMP.          03500002
035100         10  MR-2ND-UNITSA              PIC  X(01).               03510002
035200         10  MR-2ND-UNITSC              PIC  X(01).               03520002
035300         10  MR-2ND-UNITSH              PIC  X(01).               03530002
035400         10  MR-2ND-UNITS               PIC  X(10).               03540002
035500         10  MR-2ND-UNIT-X REDEFINES MR-2ND-UNITS.                03550002
035600             15  MR-2ND-UNITS-N            PIC ZZ,ZZZ,ZZ9.        03560002
035610         10  MR-2ND-UNIT-Y REDEFINES MR-2ND-UNITS.                03561096
035620             15  MR-2ND-UNITS-O            PIC ZZZZZZ,ZZ9.        03562096
035630         10  MR-2ND-UNIT-Z REDEFINES MR-2ND-UNITS.                03563099
035640             15  MR-2ND-UNITS-P            PIC ZZZZZZZZ9-.        03564099
035700                                                                  03570002
035800         10  MR-2ND-PCTL                PIC S9(04) COMP.          03580002
035900         10  MR-2ND-PCTA                PIC  X(01).               03590002
036000         10  MR-2ND-PCTC                PIC  X(01).               03600002
036100         10  MR-2ND-PCTH                PIC  X(01).               03610002
036200         10  MR-2ND-PCT                 PIC  X(05).               03620002
036300         10  MR-2ND-PCT-X REDEFINES MR-2ND-PCT.                   03630002
036400             15  MR-2ND-PCT-N              PIC  ZZ9.9.            03640002
036500                                                                  03650002
036600         10  MR-TOT-UNITSL              PIC S9(04) COMP.          03660002
036700         10  MR-TOT-UNITSA              PIC  X(01).               03670002
036800         10  MR-TOT-UNITSC              PIC  X(01).               03680002
036900         10  MR-TOT-UNITSH              PIC  X(01).               03690002
037000         10  MR-TOT-UNITS               PIC  X(11).               03700033
037100         10  MR-TOT-UNIT-X REDEFINES MR-TOT-UNITS.                03710002
037200             15  MR-TOT-UNITS-N            PIC ZZZ,ZZZ,ZZ9.       03720033
037210         10  MR-TOT-UNIT-Y REDEFINES MR-TOT-UNITS.                03721096
037220             15  MR-TOT-UNITS-O            PIC ZZZZZZZ,ZZ9.       03722096
037230         10  MR-TOT-UNIT-Z REDEFINES MR-TOT-UNITS.                03723099
037240             15  MR-TOT-UNITS-P            PIC ZZZZZZZZZ9-.       03724099
037300                                                                  03730002
037400         10  MR-TOT-PCTL                PIC S9(04) COMP.          03740002
037500         10  MR-TOT-PCTA                PIC  X(01).               03750002
037600         10  MR-TOT-PCTC                PIC  X(01).               03760002
037700         10  MR-TOT-PCTH                PIC  X(01).               03770002
037800         10  MR-TOT-PCT                 PIC  X(05).               03780002
037900         10  MR-TOT-PCT-X REDEFINES MR-TOT-PCT.                   03790002
038000             15  MR-TOT-PCT-N              PIC  ZZ9.9.            03800002
038100                                                                  03810002
038200*---------------------------------------------------------------* 03820002
038300*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03830002
038400*---------------------------------------------------------------* 03840002
038500     COPY DPWS015.                                                03850002
038600                                                                  03860002
038700*---------------------------------------------------------------* 03870002
038800*    FUNCTION KEYS COPYBOOK.                                    * 03880002
038900*---------------------------------------------------------------* 03890002
039000     COPY DPWS016.                                                03900002
039100                                                                  03910002
039200*---------------------------------------------------------------* 03920002
039300*    NUMERIC EDIT LAYOUT.                                       * 03930002
039400*---------------------------------------------------------------* 03940002
039500     COPY DPWS010I.                                               03950002
039600                                                                  03960002
039700*---------------------------------------------------------------* 03970002
039800*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 03980002
039900*---------------------------------------------------------------* 03990002
040000     COPY DPWS030.                                                04000002
1122RM     COPY DPWS930.                                                04001099
040100                                                                  04010002
040200*---------------------------------------------------------------* 04020002
040300*    STANDARD COMMAREA.                                         * 04030002
040400*---------------------------------------------------------------* 04040002
040500     COPY DPWS020.                                                04050002
040600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04060002
040700                                                                  04070002
040800*---------------------------------------------------------------* 04080002
040900* INTER-APPLICATION COMMAREA.                                   * 04090002
041000*   PCWS213 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04100002
041100*             SPEC SCREEN.                                      * 04110002
041200*   PCWS214 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04120002
041300*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04130002
041400*---------------------------------------------------------------* 04140002
041500                                                                  04150002
041600         10  INTER-APPL-COMM-AREA       PIC X(200).               04160002
041700     COPY PCWS213.                                                04170002
041800     COPY PCWS214.                                                04180002
041900*---------------------------------------------------------------* 04190002
042000*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04200002
042100*---------------------------------------------------------------* 04210007
042200         10  ASC-SPECIFIC-COMMAREA.                               04220002
042300             15  ASC-OPER-NBR-X              PIC  X(04).          04230002
042400             15  ASC-OPER-NBR-N REDEFINES ASC-OPER-NBR-X.         04240002
042500                 20  ASC-OPER-NBR            PIC  9(04).          04250002
042600             15  ASC-OPER-DESC               PIC  X(25).          04260008
042700             15  ASC-DISPLAY-DATE            PIC  X(45).          04270028
042800             15  ASC-BUSN-DATE.                                   04280013
042900                 20  ASC-BUSN-YY             PIC  X(04).          04290002
043000                 20  ASC-BUSN-MM             PIC  X(02).          04300002
043100                 20  ASC-BUSN-DD             PIC  X(02).          04310002
043200             15  ASC-FROM-DATE.                                   04320002
043300                 20  ASC-FROM-MN             PIC  X(02).          04330002
043400                 20  ASC-FROM-DY             PIC  X(02).          04340002
043500                 20  ASC-FROM-YR             PIC  X(04).          04350002
043600             15  ASC-TO-DATE.                                     04360002
043700                 20  ASC-TO-MN               PIC  X(02).          04370002
043800                 20  ASC-TO-DY               PIC  X(02).          04380002
043900                 20  ASC-TO-YR               PIC  X(04).          04390002
044000             15  ASC-FISCAL-WEEK             PIC  X(06).          04400002
044100             15  ASC-FISCAL-MONTH            PIC  X(06).          04410002
044200             15  ASC-PRINTER-ID              PIC  X(08).          04420002
044300             15  ASC-PROCESS-GROUP           PIC  X(06).          04430002
044400             15  ASC-PROCESS-AREA            PIC  X(06).          04440002
044500             15  ASC-TOT-UNITS               PIC S9(15).          04450098
044600             15  ASC-3RD-UNITS               PIC S9(15).          04460098
044700             15  ASC-1ST-UNITS               PIC S9(15).          04470098
044800             15  ASC-2ND-UNITS               PIC S9(15).          04480098
044900             15  ASC-3RD-PCT                 PIC S9(05)V9.        04490098
045000             15  ASC-1ST-PCT                 PIC S9(05)V9.        04500098
045100             15  ASC-2ND-PCT                 PIC S9(05)V9.        04510098
045200             15  ASC-TOT-PCT                 PIC S9(05)V9.        04520098
045300             15  FILLER                      PIC  X(025).         04530002
045400*-----------------------------------------------------------------04540002
045500             15  ASC-BLK-SUB                  PIC S9(04) COMP     04550002
045600                                                         SYNC.    04560002
045700             15  ASC-ITEM-SUB                 PIC S9(04) COMP     04570002
045800                                                         SYNC.    04580002
045900             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  04590002
046000             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  04600002
046100             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  04610002
046200             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  04620002
046300             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  04630002
046400             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     04640002
046500                                                         SYNC.    04650002
046600             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  04660002
046700             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  04670002
046800             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         04680002
046900                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     04690002
047000                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     04700002
047100             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         04710002
047200                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     04720002
047300                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     04730002
047400             15  ASC-LIST-QUEUE-NAME.                             04740002
047500                 20  ASC-LIST-TERM-ID         PIC  X(04).         04750002
047600                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  04760002
047700                 20  ASC-LIST-SEQ             PIC  9(01).         04770002
047800                                                                  04780002
047900             15  ASC-START-ITEM-REQUEST.                          04790002
048000                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         04800002
048100                                                                  04810002
048200             15  ASC-SEL-SUB                  PIC S9(4) COMP.     04820002
048300             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     04830002
048400             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          04840002
048500                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 04850002
048600             15  ASC-SEL-QUEUE-NAME.                              04860002
048700                 20  ASC-SEL-TERM-ID          PIC  X(04).         04870002
048800                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  04880002
048900                 20  ASC-SEL-SEQ              PIC  9(01).         04890002
049000             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  04900002
049100                                                                  04910002
049200*-----------------------------------------------------------------04920002
049300             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                04930002
049400                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  04940002
049500                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04950002
049600                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04960002
049700                                                                  04970002
049800                 20  ASC-ITEM-ARRAY.                              04980002
049900                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        04990002
050000                         30  ASC-LIST-ITEM-NUMBER                 05000002
050100                                                     PIC S9(09)   05010002
050200                                                     COMP-3.      05020002
050300                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05030002
050400                             88  ASC-VALID-SELECT    VALUE ' '    05040002
050500                                                           'S'    05050002
050600                                                           'B'    05060002
050700                                                           'E'.   05070002
050800                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05080002
050900                             88  ASC-TEMP-SELECT     VALUE 'S'.   05090002
051000                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05100002
051100                             88  ASC-TEMP-END        VALUE 'E'.   05110002
051200                         30  ASC-SELECTED-SW         PIC  X(01).  05120002
051300                             88  ASC-NO-SELECT       VALUE ' '.   05130002
051400                             88  ASC-SELECT          VALUE 'S'.   05140002
051500                             88  ASC-BEGIN           VALUE 'B'.   05150002
051600                             88  ASC-END             VALUE 'E'.   05160002
051700                         30  ASC-ACTION             PIC  X(03).   05170017
051800                         30  ASC-AREA               PIC  X(06).   05180002
051900                         30  ASC-3RDUNITS           PIC S9(10).   05190099
052000                         30  ASC-3RDPCT             PIC S9(5)V9.  05200099
052100                         30  ASC-1STUNITS           PIC S9(10).   05210099
052200                         30  ASC-1STPCT             PIC S9(5)V9.  05220099
052300                         30  ASC-2NDUNITS           PIC S9(10).   05230099
052400                         30  ASC-2NDPCT             PIC S9(5)V9.  05240099
052500                         30  ASC-TOTUNITS           PIC S9(11).   05250099
052600                         30  ASC-TOTPCT             PIC S9(5)V9.  05260099
052700                                                                  05270002
052800*---------------------------------------------------------------* 05280002
052900*    ABEND PROCESSING COPYBOOK.                                 * 05290002
053000*---------------------------------------------------------------* 05300002
053100     COPY DPWS013.                                                05310002
053200                                                                  05320002
053210*-----------------------------------------------------------------05321062
053220*  PARM TABLE                                                     05322062
053230*-----------------------------------------------------------------05323062
053240     EXEC SQL                                                     05324062
053250          INCLUDE TKRPRPM                                         05325062
053260     END-EXEC.                                                    05326062
053270                                                                  05327062
053300*---------------------------------------------------------------* 05330002
053400*    PCT_PRC_AREA_ASSN - PROCESS AREA ASSOCIATION TABLE           05340011
053500*---------------------------------------------------------------* 05350002
053600     EXEC SQL                                                     05360002
053700          INCLUDE PCT00003                                        05370011
053800     END-EXEC.                                                    05380002
053900                                                                  05390002
054000*---------------------------------------------------------------* 05400002
054100*    PCT_SUM_WRKD - SUMMARY OF UNITS WORKED                       05410003
054200*---------------------------------------------------------------* 05420002
054300     EXEC SQL                                                     05430002
054400          INCLUDE PCT00005                                        05440003
054500     END-EXEC.                                                    05450002
054600                                                                  05460002
054700*---------------------------------------------------------------* 05470002
054800*    TDTATTR - DATE TABLE                                         05480011
054900*---------------------------------------------------------------* 05490002
055000     EXEC SQL                                                     05500002
055100          INCLUDE TDTATTR                                         05510011
055200     END-EXEC.                                                    05520002
055300                                                                  05530002
055400*---------------------------------------------------------------* 05540011
055500*    XLT_LOC - LOCATION TABLE                                     05550099
055600*---------------------------------------------------------------* 05560011
055700     EXEC SQL                                                     05570011
055800          INCLUDE XLT00010                                        05580099
055900     END-EXEC.                                                    05590011
056000                                                                  05600011
056100*---------------------------------------------------------------* 05610010
056200*    PROCESS AREA CURSOR                                          05620010
056300*---------------------------------------------------------------* 05630010
056400     EXEC SQL                                                     05640010
056500          DECLARE PROCESS-AREA-CSR CURSOR FOR                     05650010
056600              SELECT  DISTINCT(PRCG_AREA_CDE)                     05660078
056700                FROM  PCT_SUM_WRKD                                05670078
056710*               FROM  PCT_PRC_AREA_ASSN                           05671078
056800               WHERE  OPER_UNT_ID   =  :DK-OPER-UNT-ID            05680010
056900     END-EXEC.                                                    05690010
057000                                                                  05700010
057100*---------------------------------------------------------------* 05710035
057200*    UNKNOWN OPER UNIT PROCESS AREA CURSOR                        05720035
057300*---------------------------------------------------------------* 05730035
057400     EXEC SQL                                                     05740035
057500          DECLARE UK-OPER-AREA-CSR CURSOR FOR                     05750035
057600              SELECT  DISTINCT(PRCG_AREA_CDE)                     05760036
057700                FROM  PCT_SUM_WRKD                                05770078
057710*               FROM  PCT_PRC_AREA_ASSN                           05771078
057800     END-EXEC.                                                    05780035
057900                                                                  05790035
057910*---------------------------------------------------------------* 05791046
057920*    PROCESS GROUP CURSOR                                         05792046
057930*---------------------------------------------------------------* 05793046
057940     EXEC SQL                                                     05794046
057950          DECLARE PROCESS-GROUP-CSR CURSOR FOR                    05795046
057960              SELECT  PRCG_AREA_CDE                               05796046
057970                FROM  PCT_PRC_AREA_ASSN                           05797046
057980               WHERE  OPER_UNT_ID     =  :DK-OPER-UNT-ID          05798046
057981                 AND  PRC_AREA_GP_CDE =  :DK-PROCESS-GROUP        05798146
057990     END-EXEC.                                                    05799046
057991                                                                  05799146
057992*---------------------------------------------------------------* 05799246
057993*    UNKNOWN OPER UNIT PROCESS GROUP CURSOR                       05799346
057994*---------------------------------------------------------------* 05799446
057995     EXEC SQL                                                     05799546
057996          DECLARE UK-OPER-GROUP-CSR CURSOR FOR                    05799646
057997              SELECT  DISTINCT(PRCG_AREA_CDE)                     05799793
057999                FROM  PCT_PRC_AREA_ASSN                           05799985
058000               WHERE  PRC_AREA_GP_CDE =  :DK-PROCESS-GROUP        05800085
058001     END-EXEC.                                                    05800185
058002                                                                  05800285
058003*---------------------------------------------------------------* 05800385
058004*    PROCESS GROUP MISC CURSOR                                    05800485
058005*---------------------------------------------------------------* 05800585
058006     EXEC SQL                                                     05800685
058007          DECLARE PRCSS-GRP-MSC-CSR CURSOR FOR                    05800785
058008              SELECT  DISTINCT(A.PRCG_AREA_CDE)                   05800885
058009                FROM  PCT_SUM_WRKD A                              05800985
058010               WHERE  OPER_UNT_ID     =  :DK-OPER-UNT-ID          05801085
058011                 AND  NOT EXISTS                                  05801185
058012                      (SELECT *                                   05801285
058013                FROM PCT_PRC_AREA_ASSN B                          05801385
058014               WHERE B.OPER_UNT_ID = A.OPER_UNT_ID                05801485
058015                AND  B.PRCG_AREA_CDE = A.PRCG_AREA_CDE)           05801585
058016     END-EXEC.                                                    05801685
058017                                                                  05801785
058018*---------------------------------------------------------------* 05801885
058019*    UNKNOWN OPER UNIT PROCESS GROUP MISC CURSOR                  05801985
058020*---------------------------------------------------------------* 05802085
058021     EXEC SQL                                                     05802185
058022          DECLARE UK-OPR-GRP-MSC-CSR CURSOR FOR                   05802285
058023              SELECT  DISTINCT(A.PRCG_AREA_CDE)                   05802385
058025                FROM  PCT_SUM_WRKD A                              05802585
058026               WHERE  NOT EXISTS                                  05802685
058027                      (SELECT *                                   05802785
058028                FROM PCT_PRC_AREA_ASSN B                          05802885
058029               WHERE B.OPER_UNT_ID = A.OPER_UNT_ID                05802985
058030                AND  B.PRCG_AREA_CDE = A.PRCG_AREA_CDE)           05803085
058033     END-EXEC.                                                    05803382
058034                                                                  05803482
058040*---------------------------------------------------------------* 05804082
058100*    UNITS BY OPER CURSOR                                         05810003
058200*---------------------------------------------------------------* 05820003
058300     EXEC SQL                                                     05830003
058400          DECLARE UNITS-BY-OPER-CSR CURSOR FOR                    05840003
058500              SELECT  SUM(UNT_WRKD_QTY)                           05850003
058600                     ,SHFT_NBR                                    05860003
058700                     ,PRCG_AREA_CDE                               05870003
058800                FROM  PCT_SUM_WRKD                                05880003
058900               WHERE  BUS_DTE        >=  :DK-FROM-DATE            05890003
059000                 AND  BUS_DTE        <=  :DK-TO-DATE              05900003
059100                 AND  OPER_UNT_ID     =  :DK-OPER-UNT-ID          05910003
059200                 AND  PRCG_AREA_CDE   =  :DK-PROCESS-AREA         05920020
059300                 GROUP BY SHFT_NBR, PRCG_AREA_CDE                 05930003
059400     END-EXEC.                                                    05940003
059500                                                                  05950010
059600*---------------------------------------------------------------* 05960036
059700*    UNITS BY AREA CURSOR                                         05970036
059800*---------------------------------------------------------------* 05980036
059900     EXEC SQL                                                     05990036
060000          DECLARE UNITS-BY-AREA-CSR CURSOR FOR                    06000036
060100              SELECT  SUM(UNT_WRKD_QTY)                           06010036
060200                     ,SHFT_NBR                                    06020036
060300                     ,PRCG_AREA_CDE                               06030036
060400                FROM  PCT_SUM_WRKD                                06040036
060500               WHERE  BUS_DTE        >=  :DK-FROM-DATE            06050036
060600                 AND  BUS_DTE        <=  :DK-TO-DATE              06060036
060700                 AND  PRCG_AREA_CDE   =  :DK-PROCESS-AREA         06070036
060800                 GROUP BY SHFT_NBR, PRCG_AREA_CDE                 06080036
060900     END-EXEC.                                                    06090036
061000                                                                  06100036
061010*---------------------------------------------------------------* 06101089
061020*    UNITS BY AREA CURSOR FOR A SELECTED GROUP BY OPER            06102089
061030*---------------------------------------------------------------* 06103089
061040     EXEC SQL                                                     06104089
061050          DECLARE UNT-BY-AREA-GRP-OP CURSOR FOR                   06105090
061051              SELECT  SUM(A.UNT_WRKD_QTY)                         06105189
061052                     ,A.SHFT_NBR                                  06105289
061053                     ,A.PRCG_AREA_CDE                             06105389
061054                FROM  PCT_SUM_WRKD A                              06105489
061055                     ,PCT_PRC_AREA_ASSN B                         06105589
061057               WHERE  A.BUS_DTE        >=  :DK-FROM-DATE          06105790
061058                 AND  A.BUS_DTE        <=  :DK-TO-DATE            06105890
061059                 AND  A.PRCG_AREA_CDE   =  :DK-PROCESS-AREA       06105990
061060                 AND  A.OPER_UNT_ID     =  :DK-OPER-UNT-ID        06106090
061061                 AND  B.PRCG_AREA_CDE   =  A.PRCG_AREA_CDE        06106189
061062                 AND  B.OPER_UNT_ID     =  A.OPER_UNT_ID          06106289
061063                 AND  B.PRC_AREA_GP_CDE = :DK-PROCESS-GROUP       06106389
061064                 GROUP BY A.SHFT_NBR, A.PRCG_AREA_CDE             06106489
061095     END-EXEC.                                                    06109589
061096                                                                  06109689
061097*---------------------------------------------------------------* 06109790
061098*    UNITS BY AREA CURSOR FOR A SELECTED GROUP WITHOUT OPER       06109890
061099*---------------------------------------------------------------* 06109990
061100     EXEC SQL                                                     06110090
061101          DECLARE UNT-BY-AREA-GRP-CR CURSOR FOR                   06110190
061102              SELECT  SUM(A.UNT_WRKD_QTY)                         06110290
061103                     ,A.SHFT_NBR                                  06110390
061104                     ,A.PRCG_AREA_CDE                             06110490
061105                FROM  PCT_SUM_WRKD A                              06110590
061106                     ,PCT_PRC_AREA_ASSN B                         06110690
061107               WHERE  A.BUS_DTE        >=  :DK-FROM-DATE          06110790
061108                 AND  A.BUS_DTE        <=  :DK-TO-DATE            06110890
061109                 AND  A.PRCG_AREA_CDE   =  :DK-PROCESS-AREA       06110990
061111                 AND  B.PRCG_AREA_CDE   =  A.PRCG_AREA_CDE        06111190
061112                 AND  B.OPER_UNT_ID     =  A.OPER_UNT_ID          06111290
061113                 AND  B.PRC_AREA_GP_CDE = :DK-PROCESS-GROUP       06111390
061114                 GROUP BY A.SHFT_NBR, A.PRCG_AREA_CDE             06111490
061115     END-EXEC.                                                    06111590
061116                                                                  06111690
061117*---------------------------------------------------------------* 06111790
061118*    UNITS BY AREA CURSOR FOR THE MISC GROUP                      06111890
061119*---------------------------------------------------------------* 06111990
061120     EXEC SQL                                                     06112090
061121          DECLARE UNT-BY-AREA-MSC-CR CURSOR FOR                   06112190
061122              SELECT  SUM(A.UNT_WRKD_QTY)                         06112290
061123                     ,A.SHFT_NBR                                  06112390
061124                     ,A.PRCG_AREA_CDE                             06112490
061125                FROM  PCT_SUM_WRKD A                              06112590
061126               WHERE  A.BUS_DTE        >=  :DK-FROM-DATE          06112690
061127                 AND  A.BUS_DTE        <=  :DK-TO-DATE            06112790
061128                 AND  A.PRCG_AREA_CDE   =  :DK-PROCESS-AREA       06112890
061129                 AND  NOT EXISTS                                  06112990
061130                        (SELECT *                                 06113090
061131                  FROM PCT_PRC_AREA_ASSN B                        06113190
061132                 WHERE B.OPER_UNT_ID = A.OPER_UNT_ID              06113290
061133                  AND  B.PRCG_AREA_CDE = A.PRCG_AREA_CDE)         06113390
061134                 GROUP BY A.SHFT_NBR, A.PRCG_AREA_CDE             06113490
061135     END-EXEC.                                                    06113590
061136                                                                  06113690
061137*---------------------------------------------------------------* 06113790
061138*    UNITS BY AREA CURSOR FOR THE MISC GROUP BY OPER              06113890
061139*---------------------------------------------------------------* 06113990
061140     EXEC SQL                                                     06114090
061141          DECLARE UNT-BY-AREA-MSC-OP CURSOR FOR                   06114190
061142              SELECT  SUM(A.UNT_WRKD_QTY)                         06114290
061143                     ,A.SHFT_NBR                                  06114390
061144                     ,A.PRCG_AREA_CDE                             06114490
061145                FROM  PCT_SUM_WRKD A                              06114590
061146               WHERE  A.BUS_DTE        >=  :DK-FROM-DATE          06114690
061147                 AND  A.BUS_DTE        <=  :DK-TO-DATE            06114790
061148                 AND  A.PRCG_AREA_CDE   =  :DK-PROCESS-AREA       06114890
061149                 AND  A.OPER_UNT_ID     =  :DK-OPER-UNT-ID        06114990
061150                 AND  NOT EXISTS                                  06115090
061151                        (SELECT *                                 06115190
061152                  FROM PCT_PRC_AREA_ASSN B                        06115290
061153                 WHERE B.OPER_UNT_ID = A.OPER_UNT_ID              06115390
061154                  AND  B.PRCG_AREA_CDE = A.PRCG_AREA_CDE)         06115490
061155                 GROUP BY A.SHFT_NBR, A.PRCG_AREA_CDE             06115590
061156     END-EXEC.                                                    06115690
061157                                                                  06115790
061160*---------------------------------------------------------------* 06116090
061200*    DB2 AREA FOR COMMUNICATIONS                                * 06120002
061300*---------------------------------------------------------------* 06130002
061400     EXEC SQL                                                     06140002
061500          INCLUDE SQLCA                                           06150002
061600     END-EXEC.                                                    06160002
061700                                                                  06170002
061800*-----------------------------------------------------------------06180002
061900 LINKAGE SECTION.                                                 06190002
062000                                                                  06200002
062100 01  DFHCOMMAREA.                                                 06210002
062200     05  FILLER                         OCCURS  1 TO 4072 TIMES   06220002
062300                                        DEPENDING ON EIBCALEN.    06230002
062400         10  FILLER                     PIC X.                    06240002
062500                                                                  06250002
062600                                                                  06260002
062700 PROCEDURE DIVISION.                                              06270002
062800******************************************************************06280002
062900**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **06290002
063000**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **06300002
063100**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **06310002
063200******************************************************************06320002
063300 0000-MAIN-MODULE.                                                06330002
063400     INITIALIZE DP030-CICS-API-FIELDS.                            06340002
063500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06350002
063600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06360002
063700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06370002
063800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06380002
063900     MOVE LENGTH OF PC750AI        TO DP030-MAP-LENGTH (1).       06390002
064000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06400002
064100     PERFORM 0001-CALL-CICS-ARCH-API.                             06410002
064200*                                                                 06420002
064300     PERFORM 1000-CONTROL-PROCESSING                              06430002
064400*                                                                 06440002
064500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06450002
064600     PERFORM 0001-CALL-CICS-ARCH-API.                             06460002
064700                                                                  06470002
064800******************************************************************06480002
064900**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **06490002
065000**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **06500002
065100******************************************************************06510002
065200 0001-CALL-CICS-ARCH-API.                                         06520002
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               06530099
1122RM     CALL DP930-CICS-ARCH-API                                     06531099
1122RM                     USING DFHEIBLK                               06532099
065400                           DFHCOMMAREA                            06540002
065500                           DP030-CICS-API-FIELDS                  06550002
065600                           DP020-STANDARD-COMMAREA                06560002
065700                           PC750AI.                               06570002
065800*                                                                 06580002
065900     IF  DP030-RC-CALL-SUCCESSFUL                                 06590002
066000         CONTINUE                                                 06600002
066100     ELSE                                                         06610002
066200         SET DP013-NO-ROLLBACK                                    06620002
066300             DP013-XCTL-DISPLAY-RESTART                           06630002
066400             DP013-CICS-ABEND      TO TRUE                        06640002
066500         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        06650002
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX06660099
1122RM*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      06670099
1122rm         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O06671099
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06672099
066800         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      06680002
066900         PERFORM DP013-0000-PROCESS-ABEND                         06690002
067000     END-IF.                                                      06700002
067100                                                                  06710002
067200*----------------------------------------------------------------*06720002
067300* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *06730002
067400* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *06740002
067500*                                                                *06750002
067600* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *06760002
067700*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *06770002
067800*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *06780002
067900*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *06790002
068000*----------------------------------------------------------------*06800002
068100 1000-CONTROL-PROCESSING.                                         06810002
068200                                                                  06820002
068300     EVALUATE TRUE                                                06830002
068400         WHEN DP020-NEXT-ACT-INITIAL                              06840002
068500             INITIALIZE ASC-SPECIFIC-COMMAREA                     06850002
068600             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            06860002
068700                                      ASC-SEL-TERM-ID             06870002
068800             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   06880002
068900                                           ASC-SEL-TASK-NUMBER    06890002
069000             MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ              06900002
069100             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 06910002
069200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 06920002
069300             PERFORM 4000-BUILD-INITIAL-PANEL                     06930002
069400                                                                  06940002
069500         WHEN DP020-NEXT-ACT-READ-MAP                             06950002
069600             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         06960002
069700             PERFORM 2000-PROCESS-PANEL                           06970002
069800                                                                  06980002
069900         WHEN DP020-NEXT-ACT-RETURN                               06990002
070000             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         07000002
070100             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               07010002
070200             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 07020002
070300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07030002
070400                                                                  07040002
070500         WHEN OTHER                                               07050002
070600             SET DP013-LOGIC-ABEND TO TRUE                        07060002
070700             SET DP013-NO-ROLLBACK TO TRUE                        07070002
070800             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    07080002
070900             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    07090002
071000                                   TO DP013-MESSAGE-TEXT(1)       07100002
071100             PERFORM DP013-0000-PROCESS-ABEND                     07110002
071200     END-EVALUATE.                                                07120002
071300                                                                  07130002
071400*----------------------------------------------------------------*07140002
071500* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *07150002
071600* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *07160002
071700*----------------------------------------------------------------*07170002
071800 1100-PROCESS-INTER-APPL-COMM.                                    07180054
071900                                                                  07190002
072000     SET PS-COMMAREA-VALID         TO TRUE.                       07200002
072100     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     07210002
072200                                                                  07220002
072300     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          07230002
072400         MOVE PC213-OPER-UNT-ID       TO ASC-OPER-NBR             07240007
072500         MOVE PC213-CRNT-BUS-DTE      TO ASC-BUSN-DATE            07250013
072600         MOVE PC213-FROM-DATE         TO ASC-FROM-DATE            07260003
072700         MOVE PC213-TO-DATE           TO ASC-TO-DATE              07270003
072800         MOVE PC213-FISCAL-WEEK       TO ASC-FISCAL-WEEK          07280003
072900         MOVE PC213-FISCAL-MONTH      TO ASC-FISCAL-MONTH         07290003
073000         MOVE PC213-PRINTER-ID        TO ASC-PRINTER-ID           07300003
073100     ELSE                                                         07310002
073200         SET ASC-USE-SELECTION-QUEUE TO TRUE                      07320002
073300         MOVE PC214-NUMBER-OF-SELECTED-ITEMS TO                   07330002
073400                                      ASC-NUMBER-OF-SELECTED-ITEMS07340002
073500         MOVE PC214-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  07350002
073600         MOVE PC214-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      07360002
073700         MOVE PC214-OPER-UNT-ID        TO ASC-OPER-NBR            07370053
073710         MOVE PC214-BUSN-DATE          TO ASC-BUSN-DATE           07371053
073800         MOVE PC214-FROM-DATE          TO ASC-FROM-DATE           07380013
073900         MOVE PC214-TO-DATE            TO ASC-TO-DATE             07390013
074000         MOVE PC214-FISCAL-WEEK        TO ASC-FISCAL-WEEK         07400013
074100         MOVE PC214-FISCAL-MONTH       TO ASC-FISCAL-MONTH        07410013
074200         MOVE PC214-PROCESS-GROUP      TO ASC-PROCESS-GROUP       07420003
074300         MOVE PC214-PROCESS-AREA       TO ASC-PROCESS-AREA        07430003
074400         MOVE PC214-PRINTER-ID         TO ASC-PRINTER-ID          07440013
074500         PERFORM 1120-PREPARE-LIST-ENTRY                          07450002
074600     END-IF.                                                      07460002
074700                                                                  07470002
074800*-----------------------------------------------------------------07480002
074900*  PREPARE LIST ENTRY                                             07490002
075000*-----------------------------------------------------------------07500002
075100 1120-PREPARE-LIST-ENTRY.                                         07510002
075200                                                                  07520002
075300     MOVE PC215-MAX-ITEMS          TO ASC-SEL-SUB.                07530002
075400     MOVE ZERO                     TO ASC-SEL-ITEM.               07540002
075500     PERFORM 1130-GET-NEXT-RECORD.                                07550002
075600                                                                  07560002
075700*-----------------------------------------------------------------07570002
075800*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*07580002
075900*-----------------------------------------------------------------07590002
076000 1130-GET-NEXT-RECORD.                                            07600002
076100     ADD +1                       TO ASC-SEL-SUB.                 07610002
076200                                                                  07620002
076300     IF  ASC-SEL-SUB > PC215-MAX-ITEMS                            07630002
076400         ADD +1                   TO ASC-SEL-ITEM                 07640002
076500         MOVE +1                  TO ASC-SEL-SUB                  07650002
076600     END-IF.                                                      07660002
076700                                                                  07670002
076800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                07680002
076900         PERFORM 9100-READ-SEL-QUEUE                              07690002
077000         IF  PC215-ITEM (ASC-SEL-SUB) > ZERO                      07700002
077100             MOVE PC215-OPER-DESC(ASC-SEL-SUB) TO ASC-OPER-DESC   07710014
077110             MOVE PC215-AREA  (ASC-SEL-SUB) TO ASC-PROCESS-AREA   07711055
077120             MOVE PC215-GROUP (ASC-SEL-SUB) TO ASC-PROCESS-GROUP  07712055
077200             MOVE PC215-3RD-UNITS (ASC-SEL-SUB) TO ASC-3RD-UNITS  07720003
077300             MOVE PC215-3RD-PCT (ASC-SEL-SUB)   TO ASC-3RD-PCT    07730003
077400             MOVE PC215-1ST-UNITS (ASC-SEL-SUB) TO ASC-1ST-UNITS  07740003
077500             MOVE PC215-1ST-PCT (ASC-SEL-SUB)   TO ASC-1ST-PCT    07750003
077600             MOVE PC215-2ND-UNITS (ASC-SEL-SUB) TO ASC-2ND-UNITS  07760003
077700             MOVE PC215-2ND-PCT (ASC-SEL-SUB)   TO ASC-2ND-PCT    07770003
077800             MOVE PC215-TOT-UNITS (ASC-SEL-SUB) TO ASC-TOT-UNITS  07780003
077900             MOVE PC215-TOT-PCT (ASC-SEL-SUB)   TO ASC-TOT-PCT    07790003
078000             SET PC215-INQ (ASC-SEL-SUB) TO TRUE                  07800002
078100             PERFORM 9200-REWRITE-SEL-QUEUE                       07810002
078200         ELSE                                                     07820002
078300             SUBTRACT +1 FROM ASC-SEL-SUB                         07830002
078400             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             07840002
078500             SET DP020-MSG-INFORMATIONAL                          07850002
078600                 PS-LIST-END             TO TRUE                  07860002
078700         END-IF                                                   07870002
078800     ELSE                                                         07880002
078900         SUBTRACT +1 FROM ASC-SEL-ITEM                            07890002
079000         MOVE PC215-MAX-ITEMS     TO ASC-SEL-SUB                  07900002
079100         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             07910002
079200         SET DP020-MSG-INFORMATIONAL                              07920002
079300             PS-LIST-END             TO TRUE                      07930002
079400     END-IF.                                                      07940002
079500                                                                  07950002
079600*----------------------------------------------------------------*07960002
079700*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *07970002
079800*    PROCESSED.                                                  *07980002
079900*----------------------------------------------------------------*07990002
080000 1140-GET-PREV-RECORD.                                            08000002
080100     SUBTRACT +1 FROM ASC-SEL-SUB.                                08010002
080200                                                                  08020002
080300     IF  ASC-SEL-SUB < +1                                         08030002
080400         SUBTRACT +1 FROM ASC-SEL-ITEM                            08040002
080500         MOVE PC215-MAX-ITEMS     TO ASC-SEL-SUB                  08050002
080600     END-IF.                                                      08060002
080700                                                                  08070002
080800     IF  ASC-SEL-ITEM > ZERO                                      08080002
080900         PERFORM 9100-READ-SEL-QUEUE                              08090002
081000         MOVE PC215-OPER-DESC (ASC-SEL-SUB) TO ASC-OPER-DESC      08100014
081001         MOVE PC215-AREA  (ASC-SEL-SUB) TO ASC-PROCESS-AREA       08100155
081010         MOVE PC215-GROUP (ASC-SEL-SUB) TO ASC-PROCESS-GROUP      08101046
081100         MOVE PC215-3RD-UNITS (ASC-SEL-SUB) TO ASC-3RD-UNITS      08110003
081200         MOVE PC215-3RD-PCT (ASC-SEL-SUB)   TO ASC-3RD-PCT        08120003
081300         MOVE PC215-1ST-UNITS (ASC-SEL-SUB) TO ASC-1ST-UNITS      08130003
081400         MOVE PC215-1ST-PCT (ASC-SEL-SUB)   TO ASC-1ST-PCT        08140003
081500         MOVE PC215-2ND-UNITS (ASC-SEL-SUB) TO ASC-2ND-UNITS      08150003
081600         MOVE PC215-2ND-PCT (ASC-SEL-SUB)   TO ASC-2ND-PCT        08160003
081700         MOVE PC215-TOT-UNITS (ASC-SEL-SUB) TO ASC-TOT-UNITS      08170003
081800         MOVE PC215-TOT-PCT (ASC-SEL-SUB)   TO ASC-TOT-PCT        08180003
081900         SET PC215-INQ (ASC-SEL-SUB) TO TRUE                      08190002
082000         PERFORM 9200-REWRITE-SEL-QUEUE                           08200002
082100     ELSE                                                         08210002
082200         MOVE +1                  TO ASC-SEL-ITEM                 08220002
082300                                     ASC-SEL-SUB                  08230002
082400         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             08240002
082500         SET DP020-MSG-INFORMATIONAL                              08250002
082600             PS-LIST-END             TO TRUE                      08260002
082700     END-IF.                                                      08270002
082800                                                                  08280002
082900*----------------------------------------------------------------*08290002
083000* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *08300002
083100* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *08310002
083200* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *08320002
083300* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *08330002
083400* FUNCTION KEYS CAN GET THIS FAR.                                *08340002
083500*----------------------------------------------------------------*08350002
083600 2000-PROCESS-PANEL.                                              08360002
083700     EVALUATE TRUE                                                08370002
083800         WHEN DP020-SRC-AID = DP016-CLEAR                         08380002
083900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08390002
084000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08400002
084100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08410002
084200                                                                  08420002
084300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08430002
084400             PERFORM 2050-DELETE-LIST-QUEUE                       08440073
084600             PERFORM 4000-BUILD-INITIAL-PANEL                     08460072
084610             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08461088
084700                                                                  08470002
084710         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    08471061
084720             PERFORM 2140-DESELECT-ALL-ITEMS                      08472061
084730             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08473061
084740                                                                  08474061
084750         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  08475061
084760             PERFORM 2150-SELECT-ALL-ITEMS                        08476061
084770             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08477061
084780                                                                  08478061
084800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             08480002
084900             IF  ASC-USE-SELECTION-QUEUE                          08490002
085000                 PERFORM 1130-GET-NEXT-RECORD                     08500002
085100                 IF PS-LIST-END                                   08510002
085200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08520002
085300                     SET PS-NO-LIST-END TO TRUE                   08530002
085400                 ELSE                                             08540002
085500                     PERFORM 2050-DELETE-LIST-QUEUE               08550002
085600                     PERFORM 3200-RESET-ATTRIBUTES                08560002
085700                     MOVE ZEROS TO ASC-OPER-NBR                   08570042
085710                     PERFORM 4000-BUILD-INITIAL-PANEL             08571042
085800                 END-IF                                           08580002
085900              ELSE                                                08590002
086000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08600002
086100*                --- BOTTOM OF LIST ---                           08610002
086200                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         08620002
086300                 SET DP020-MSG-INFORMATIONAL TO TRUE              08630002
086400             END-IF                                               08640002
086500                                                                  08650002
086600         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             08660002
086700             IF  ASC-USE-SELECTION-QUEUE                          08670002
086800                 PERFORM 1140-GET-PREV-RECORD                     08680002
086900                 IF PS-LIST-END                                   08690002
087000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08700002
087100                     SET PS-NO-LIST-END TO TRUE                   08710002
087200                 ELSE                                             08720002
087300                     PERFORM 2050-DELETE-LIST-QUEUE               08730002
087400                     PERFORM 3200-RESET-ATTRIBUTES                08740002
087410                     MOVE ZEROS TO ASC-OPER-NBR                   08741042
087500                     PERFORM 4000-BUILD-INITIAL-PANEL             08750002
087600                 END-IF                                           08760002
087700             ELSE                                                 08770002
087800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08780002
087900                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         08790002
088000                 SET DP020-MSG-INFORMATIONAL TO TRUE              08800002
088100             END-IF                                               08810002
088200                                                                  08820002
088300         WHEN OTHER                                               08830002
088400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08840002
088500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08850002
088600                                                                  08860002
088700             IF  PS-NO-ERROR                                      08870002
088800                 SET DP030-CONTINUE-GO TO TRUE                    08880002
088900                 PERFORM 2100-CHECK-FUNCTION-KEY                  08890002
089000             ELSE                                                 08900002
089100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08910002
089200                 SET DP030-OVERRIDE-GO TO TRUE                    08920002
089300             END-IF                                               08930002
089400     END-EVALUATE.                                                08940002
089500                                                                  08950002
089600*----------------------------------------------------------------*08960002
089700*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *08970002
089800*----------------------------------------------------------------*08980002
089900 2050-DELETE-LIST-QUEUE.                                          08990002
090000                                                                  09000002
090100     EXEC CICS                                                    09010002
090200         DELETEQ TS                                               09020002
090300             QUEUE (ASC-LIST-QUEUE-NAME)                          09030002
090400             RESP  (PV-CICS-RESP)                                 09040002
090500     END-EXEC.                                                    09050002
090600                                                                  09060002
090700     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       09070002
090800        (PV-CICS-RESP = DFHRESP(QIDERR))                          09080002
090900         CONTINUE                                                 09090002
091000     ELSE                                                         09100002
091100         SET DP013-CICS-ABEND      TO TRUE                        09110002
091200         SET DP013-NO-ROLLBACK     TO TRUE                        09120002
091300                                                                  09130002
091400         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         09140002
091500         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    09150002
091600                                   TO DP013-MESSAGE-TEXT (1)      09160002
091700         PERFORM DP013-0000-PROCESS-ABEND                         09170002
091800     END-IF.                                                      09180002
091900                                                                  09190002
092000     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  09200002
092100                                                                  09210002
092200*----------------------------------------------------------------*09220002
092300* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*09230002
092400* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *09240002
092500* CICS ARCHITECTURE API.                                         *09250002
092600*----------------------------------------------------------------*09260002
092700 2100-CHECK-FUNCTION-KEY.                                         09270002
092800                                                                  09280002
092900     EVALUATE TRUE                                                09290002
093000*                                                                 09300003
093100* F17 - UNITS WORKED BY PO                                        09310003
093200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09320003
093210             IF ASC-OPER-NBR-X  = SPACES OR ZEROES                09321059
093220                 SET PS-ERROR                                     09322057
093230                     DP020-MSG-FATAL         TO TRUE              09323057
093240                 MOVE PC-TSYMSG-02873    TO DP020-MSG-NUMBER      09324057
093280                 MOVE -1                 TO MR-SELECTL (1)        09328057
093290                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09329057
093291                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09329159
093292                 SET DP030-OVERRIDE-GO TO TRUE                    09329259
093293             END-IF                                               09329357
093294             IF PS-NO-ERROR                                       09329459
093302                 IF ASC-BUSN-DATE = SPACES                        09330259
093304                     SET PS-ERROR                                 09330459
093305                         DP020-MSG-FATAL         TO TRUE          09330559
093306                     MOVE PC-TSYMSG-02378    TO DP020-MSG-NUMBER  09330659
093307                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          09330759
093312                     MOVE -1                 TO MR-SELECTL (1)    09331259
093313                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09331359
093314                     SET DP030-OVERRIDE-GO TO TRUE                09331459
093328                 END-IF                                           09332859
093329             END-IF                                               09332959
093330             IF PS-NO-ERROR                                       09333003
093331                 PERFORM 2300-CHECK-PO-HISTORY-DATE               09333163
093340                 IF PS-VALID-POHIST-DATE                          09334062
093400                     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO      09340062
093500                         SET ASC-USE-SELECTION-QUEUE TO TRUE      09350062
093600                         INITIALIZE PC214-INTER-APPL-COMMAREA     09360062
093700                         MOVE ASC-NUMBER-OF-SELECTED-ITEMS        09370062
093800                                TO PC214-NUMBER-OF-SELECTED-ITEMS 09380059
093900                         MOVE ASC-NUMBER-OF-TS-ITEMS              09390062
094000                                      TO PC214-NUMBER-OF-TS-ITEMS 09400003
094100                         MOVE ASC-SEL-QUEUE-NAME                  09410062
094200                                           TO PC214-SEL-QUEUE-NAME09420003
094300                         MOVE ASC-OPER-NBR  TO PC214-OPER-UNT-ID  09430062
094400                         MOVE ASC-BUSN-DATE    TO PC214-BUSN-DATE 09440062
094500                         MOVE ASC-PROCESS-AREA TO                 09450062
094600                                               PC214-PROCESS-AREA 09460062
094900                         MOVE ASC-PRINTER-ID  TO PC214-PRINTER-ID 09490062
095000                         PERFORM 5000-PREPARE-SEL-QUEUE           09500062
095100                     ELSE                                         09510062
095110                         MOVE -1         TO MR-SELECTL (1)        09511076
095120                         SET DP030-SET-CURSOR-APPL-1 TO TRUE      09512076
095200                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     09520062
095300                         SET DP030-OVERRIDE-GO TO TRUE            09530062
095400                         MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER 09540062
095500                         SET DP020-MSG-WARNING TO TRUE            09550062
095600                     END-IF                                       09560062
095610                 ELSE                                             09561062
095620                     SET PS-ERROR                                 09562062
095630                         DP020-MSG-FATAL         TO TRUE          09563062
095640                     MOVE PV-POHIST-DATE     TO DP020-MSG-TEXT    09564068
095641                     MOVE PC-TSYMSG-02874    TO DP020-MSG-NUMBER  09564168
095650                     MOVE -1                 TO MR-SELECTL (1)    09565062
095660                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          09566062
095670                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09567062
095680                     SET DP030-OVERRIDE-GO TO TRUE                09568062
095700                 END-IF                                           09570062
095710             END-IF                                               09571062
095800                                                                  09580014
095900                                                                  09590003
096000* F22 - COMPARE PREVIOUS YEAR TO CURRENT YEAR                     09600003
096100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09610043
096200             IF PS-NO-ERROR                                       09620003
096300                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          09630003
096400                     SET ASC-USE-SELECTION-QUEUE TO TRUE          09640003
096500                     INITIALIZE PC214-INTER-APPL-COMMAREA         09650003
096600                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            09660003
096700                                TO PC214-NUMBER-OF-SELECTED-ITEMS 09670003
096800                     MOVE ASC-NUMBER-OF-TS-ITEMS                  09680003
096900                                      TO PC214-NUMBER-OF-TS-ITEMS 09690003
097000                     MOVE ASC-SEL-QUEUE-NAME                      09700003
097100                                           TO PC214-SEL-QUEUE-NAME09710003
097200                     MOVE ASC-OPER-NBR     TO PC214-OPER-UNT-ID   09720014
097300                     MOVE ASC-BUSN-DATE    TO PC214-BUSN-DATE     09730014
097400                     MOVE ASC-FROM-DATE    TO PC214-FROM-DATE     09740014
097500                     MOVE ASC-TO-DATE      TO PC214-TO-DATE       09750014
097600                     MOVE ASC-FISCAL-WEEK  TO PC214-FISCAL-WEEK   09760014
097700                     MOVE ASC-FISCAL-MONTH TO PC214-FISCAL-MONTH  09770014
097800                     MOVE ASC-PRINTER-ID   TO PC214-PRINTER-ID    09780014
097900                     PERFORM 5000-PREPARE-SEL-QUEUE               09790003
098000                 ELSE                                             09800003
098010                     MOVE -1                 TO MR-SELECTL (1)    09801076
098020                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          09802076
098100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09810003
098200                     SET DP030-OVERRIDE-GO TO TRUE                09820003
098300                     MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER     09830003
098400                     SET DP020-MSG-WARNING TO TRUE                09840003
098500                 END-IF                                           09850003
098600             END-IF                                               09860003
098700                                                                  09870003
098800* F23 - UNITS WORKED BY PROCESS GROUP                             09880003
098900         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09890043
099000             IF PS-NO-ERROR                                       09900003
100000                 MOVE ASC-OPER-NBR     TO PC214-OPER-UNT-ID       10000095
100100                 MOVE ASC-BUSN-DATE    TO PC214-BUSN-DATE         10010095
100200                 MOVE ASC-FROM-DATE    TO PC214-FROM-DATE         10020095
100300                 MOVE ASC-TO-DATE      TO PC214-TO-DATE           10030095
100400                 MOVE ASC-FISCAL-WEEK  TO PC214-FISCAL-WEEK       10040095
100500                 MOVE ASC-FISCAL-MONTH TO PC214-FISCAL-MONTH      10050095
100600                 MOVE ASC-PRINTER-ID   TO PC214-PRINTER-ID        10060095
101400             END-IF                                               10140003
101500                                                                  10150003
101600* F24 - PRINT A REPORT                                            10160003
101700         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              10170043
101800             IF PS-NO-ERROR                                       10180003
102800                 MOVE ASC-OPER-NBR     TO PC214-OPER-UNT-ID       10280074
102900                 MOVE ASC-BUSN-DATE    TO PC214-BUSN-DATE         10290074
103000                 MOVE ASC-FROM-DATE    TO PC214-FROM-DATE         10300074
103100                 MOVE ASC-TO-DATE      TO PC214-TO-DATE           10310074
103200                 MOVE ASC-FISCAL-WEEK  TO PC214-FISCAL-WEEK       10320074
103300                 MOVE ASC-FISCAL-MONTH TO PC214-FISCAL-MONTH      10330074
103400                 MOVE ASC-PRINTER-ID   TO PC214-PRINTER-ID        10340074
104100             END-IF                                               10410074
104300                                                                  10430003
104500* F6 - FIRST PAGE                                                 10450002
104600         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  10460002
104700             MOVE +1               TO PV-TOP-ITEM                 10470002
104800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10480002
104900*                                                                 10490002
105000* F7 - PREVIOUS PAGE                                              10500002
105100         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   10510002
105200             PERFORM 2110-BROWSE-BACKWARD                         10520002
105300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10530002
105400*                                                                 10540002
105500* F8 - NEXT PAGE                                                  10550002
105600         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   10560002
105700             PERFORM 2120-BROWSE-FORWARD                          10570002
105800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10580002
105900*                                                                 10590002
106000* ENTER KEY                                                       10600002
106100         WHEN DP020-SRC-AID = DP016-ENTER                         10610002
106200             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   10620002
106300             IF  PS-ERROR                                         10630002
106400                 CONTINUE                                         10640002
106500             ELSE                                                 10650002
106600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10660002
106700             END-IF                                               10670002
106800                                                                  10680002
106900         WHEN OTHER                                               10690002
107000             SET DP013-NO-ROLLBACK                                10700002
107100                 DP013-XCTL-DISPLAY-RESTART                       10710002
107200                 DP013-CICS-ABEND  TO TRUE                        10720002
107300             MOVE '2100-CHECK-FUNCTION-KEY'                       10730002
107400                                   TO DP013-PARAGRAPH             10740002
107500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10750002
107600                                   TO DP013-MESSAGE-TEXT (1)      10760002
107700             PERFORM DP013-0000-PROCESS-ABEND                     10770002
107800     END-EVALUATE.                                                10780002
107900*                                                                 10790002
108000*----------------------------------------------------------------*10800002
108100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *10810002
108200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *10820002
108300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *10830002
108400*    MESSAGE.                                                    *10840002
108500*----------------------------------------------------------------*10850002
108600 2110-BROWSE-BACKWARD.                                            10860002
108700     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    10870002
108800         GIVING PV-TOP-ITEM.                                      10880002
108900*                                                                 10890002
109000     IF  ((PV-TOP-ITEM < +1)                                      10900002
109100       OR (PV-TOP-ITEM = +1))                                     10910002
109200         MOVE +1                   TO PV-TOP-ITEM                 10920002
109300*        -- TOP OF LIST --                                        10930002
109400         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            10940002
109500         SET DP020-MSG-INFORMATIONAL TO TRUE                      10950002
109600     END-IF.                                                      10960002
109700                                                                  10970002
109800*----------------------------------------------------------------*10980002
109900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *10990002
110000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *11000002
110100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *11010002
110200*----------------------------------------------------------------*11020002
110300 2120-BROWSE-FORWARD.                                             11030002
110400                                                                  11040002
110500     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              11050002
110600         GIVING PV-TOP-ITEM.                                      11060002
110700     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   11070002
110800         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             11080002
110900*        -- BOTTOM OF LIST --                                     11090002
111000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11100002
111100         SET DP020-MSG-INFORMATIONAL  TO TRUE                     11110002
111200     ELSE                                                         11120002
111300         COMPUTE PV-BOTTOM-ITEM =                                 11130002
111400             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11140002
111500         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            11150002
111600*            -- BOTTOM OF LIST --                                 11160002
111700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11170002
111800             SET DP020-MSG-INFORMATIONAL TO TRUE                  11180002
111900         END-IF                                                   11190002
112000     END-IF.                                                      11200002
112100                                                                  11210002
112200*----------------------------------------------------------------*11220002
112300*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *11230002
112400*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *11240002
112500*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *11250002
112600*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *11260002
112700*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *11270002
112800*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *11280002
112900*----------------------------------------------------------------*11290002
113000 2130-CHECK-FOR-JUMP-BROWSE.                                      11300002
113100     SET PS-NO-ERROR               TO TRUE.                       11310002
113200     IF (ASC-START-ITEM-REQUEST = SPACE)                          11320002
113300         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             11330002
113400     ELSE                                                         11340002
113500         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     11350002
113600         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       11360002
113700         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     11370002
113800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11380002
113910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11391099
113920                         USING DP010I-NUMERIC-EDIT-AREA           11392099
114000                                                                  11400002
114100         IF  NOT DP010I-ERROR-DETECTED                            11410002
114200             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N11420002
114300             IF  ASC-START-ITEM-REQUEST-N > ZERO                  11430002
114400                 IF  ASC-START-ITEM-REQUEST-N >                   11440002
114500                                          ASC-NUMBER-OF-ITEMS-READ11450002
114600                     MOVE SPACE TO ASC-START-ITEM-REQUEST         11460002
114700                     COMPUTE PV-TOP-ITEM =                        11470002
114800                             ASC-NUMBER-OF-ITEMS-READ             11480002
114900                             - PC-ITEMS-PER-PANEL + 1             11490002
115000                     IF  PV-TOP-ITEM < +1                         11500002
115100                         MOVE +1   TO PV-TOP-ITEM                 11510002
115200                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 11520002
115300                         SET DP020-MSG-INFORMATIONAL TO TRUE      11530002
115400                     END-IF                                       11540002
115500                 ELSE                                             11550002
115600                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 11560002
115700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      11570002
115800                     COMPUTE PV-BOTTOM-ITEM =                     11580002
115900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     11590002
116000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ11600002
116100*                        -- BOTTOM OF LIST --                     11610002
116200                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 11620002
116300                         SET DP020-MSG-INFORMATIONAL TO TRUE      11630002
116400                     END-IF                                       11640002
116500                 END-IF                                           11650002
116600             ELSE                                                 11660002
116700*                --- VALUE OUT OF RANGE ----                      11670002
116800                 MOVE PC-TSYMSG-00101  TO DP020-MSG-NUMBER        11680002
116900                 MOVE -1           TO ASTRTITL                    11690002
117000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              11700002
117100                 MOVE DP015-REVERSE TO ASTRTITH                   11710002
117200                 MOVE DP015-RED    TO ASTRTITC                    11720002
117300                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           11730002
117400                 SET DP020-MSG-FATAL                              11740002
117500                     PS-ERROR        TO TRUE                      11750002
117600             END-IF                                               11760002
117700         ELSE                                                     11770002
117800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            11780002
117900             MOVE -1               TO ASTRTITL                    11790002
118000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11800002
118100             MOVE DP015-REVERSE    TO ASTRTITH                    11810002
118200             MOVE DP015-RED        TO ASTRTITC                    11820002
118300             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               11830002
118400             SET DP020-MSG-FATAL   TO TRUE                        11840002
118500             SET PS-ERROR          TO TRUE                        11850002
118600         END-IF                                                   11860002
118700     END-IF.                                                      11870002
118800                                                                  11880002
118810*----------------------------------------------------------------*11881061
118820*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *11882061
118830*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *11883061
118840*----------------------------------------------------------------*11884061
118850 2140-DESELECT-ALL-ITEMS.                                         11885061
118860     MOVE +1                       TO ASC-BLK-SUB.                11886061
118870                                                                  11887061
118880     PERFORM 2141-CLEAR-SELECTED-INDS                             11888061
118890         VARYING ASC-ITEM-SUB                                     11889061
118891         FROM 1 BY 1                                              11889161
118892         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11889261
118893                                                                  11889361
118894     ADD +1                        TO ASC-BLK-SUB.                11889461
118895                                                                  11889561
118896     PERFORM 2141-CLEAR-SELECTED-INDS                             11889661
118897         VARYING ASC-ITEM-SUB                                     11889761
118898         FROM 1 BY 1                                              11889861
118899         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11889961
118900                                                                  11890061
118901     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               11890161
118902                                   TO PV-LIST-ITEM-NUMBER.        11890261
118903                                                                  11890361
118904     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            11890461
118905         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    11890561
118906                                                                  11890661
118907     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     11890761
118908        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      11890861
118909         MOVE +1                   TO ASC-BLK-SUB                 11890961
118910                                                                  11891061
118911         PERFORM 5100-WRITE-TEMP-STORAGE                          11891161
118912         MOVE +2                   TO ASC-BLK-SUB                 11891261
118913         PERFORM 5100-WRITE-TEMP-STORAGE                          11891361
118914         MOVE +1                   TO ASC-BLK-SUB                 11891461
118915                                                                  11891561
118916         MOVE +1                   TO PV-BLOCK-NUMBER             11891661
118917                                                                  11891761
118918         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         11891861
118919             PV-FIRST-BLOCK-IN-ARRAY - 1                          11891961
118920                                                                  11892061
118921         PERFORM                                                  11892161
118922             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       11892261
118923                                                                  11892361
118924             PERFORM 4410-READ-TEMP-STORAGE                       11892461
118925                                                                  11892561
118926             PERFORM 2141-CLEAR-SELECTED-INDS                     11892661
118927                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 11892761
118928                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          11892861
118929                                                                  11892961
118930             PERFORM 5100-WRITE-TEMP-STORAGE                      11893061
118931                                                                  11893161
118932             ADD +1                TO PV-BLOCK-NUMBER             11893261
118933                                                                  11893361
118934         END-PERFORM                                              11893461
118935                                                                  11893561
118936         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         11893661
118937             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     11893761
118938                                                                  11893861
118939         PERFORM                                                  11893961
118940             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       11894061
118941                   ASC-HIGHEST-BLOCK-WRITTEN                      11894161
118942                                                                  11894261
118943             MOVE PV-NEXT-BLOCK-IN-ARRAY                          11894361
118944                                   TO PV-BLOCK-NUMBER             11894461
118945                                                                  11894561
118946             PERFORM 4410-READ-TEMP-STORAGE                       11894661
118947                                                                  11894761
118948             PERFORM 2141-CLEAR-SELECTED-INDS                     11894861
118949                 VARYING ASC-ITEM-SUB                             11894961
118950                 FROM 1 BY 1                                      11895061
118951                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          11895161
118952                                                                  11895261
118953             PERFORM 5100-WRITE-TEMP-STORAGE                      11895361
118954                                                                  11895461
118955             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      11895561
118956         END-PERFORM                                              11895661
118957                                                                  11895761
118958         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          11895861
118959         PERFORM 4410-READ-TEMP-STORAGE                           11895961
118960     END-IF.                                                      11896061
118961                                                                  11896161
118962                                                                  11896261
118963     MOVE +0                      TO ASC-NUMBER-OF-SELECTED-ITEMS.11896361
118964     MOVE +0                      TO ASC-START-OF-SELECTED-RANGE. 11896461
118965     MOVE +0                      TO ASC-END-OF-SELECTED-RANGE.   11896561
118966                                                                  11896661
118967     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        11896761
118968                                                                  11896861
118969*----------------------------------------------------------------*11896961
118970*    MARK EACH ITEM AS BEING NOT SELECTED.                       *11897061
118971*----------------------------------------------------------------*11897161
118972 2141-CLEAR-SELECTED-INDS.                                        11897261
118973                                                                  11897361
118974     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           11897461
118975             NOT EQUAL ZERO                                       11897561
118976         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          11897661
118977             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          11897761
118978                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    11897861
118979                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  11897961
118980                                   TO TRUE                        11898061
118981         END-IF                                                   11898161
118982     END-IF.                                                      11898261
118983                                                                  11898361
118984*----------------------------------------------------------------*11898461
118985*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *11898561
118986*  FOR ALL ITEMS.                                                *11898661
118987*----------------------------------------------------------------*11898761
118988 2150-SELECT-ALL-ITEMS.                                           11898861
118989                                                                  11898961
118990     MOVE +1                       TO ASC-BLK-SUB.                11899061
118991                                                                  11899161
118992     PERFORM 2151-SET-SELECTED-INDS                               11899261
118993         VARYING ASC-ITEM-SUB                                     11899361
118994         FROM 1 BY 1                                              11899461
118995         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11899561
118996                                                                  11899661
118997     ADD +1                        TO ASC-BLK-SUB.                11899761
118998                                                                  11899861
118999     PERFORM 2151-SET-SELECTED-INDS                               11899961
119000         VARYING ASC-ITEM-SUB                                     11900061
119001         FROM 1 BY 1                                              11900161
119002         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11900261
119003                                                                  11900361
119004     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER.       11900461
119005                                                                  11900561
119006     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            11900661
119007         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    11900761
119008                                                                  11900861
119009     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            11900961
119010         MOVE +1                   TO ASC-BLK-SUB                 11901061
119011                                                                  11901161
119012         PERFORM 5100-WRITE-TEMP-STORAGE                          11901261
119013         MOVE +2                   TO ASC-BLK-SUB                 11901361
119014         PERFORM 5100-WRITE-TEMP-STORAGE                          11901461
119015         MOVE +1                   TO ASC-BLK-SUB                 11901561
119016         MOVE +1                   TO PV-BLOCK-NUMBER             11901661
119017     END-IF.                                                      11901761
119018*                                                                 11901861
119019     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     11901961
119020        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    11902061
119021         MOVE +1                   TO ASC-BLK-SUB                 11902161
119022                                                                  11902261
119023         PERFORM 5100-WRITE-TEMP-STORAGE                          11902361
119024         MOVE +2                   TO ASC-BLK-SUB                 11902461
119025         PERFORM 5100-WRITE-TEMP-STORAGE                          11902561
119026         MOVE +1                   TO ASC-BLK-SUB                 11902661
119027         MOVE +1                   TO PV-BLOCK-NUMBER             11902761
119028                                                                  11902861
119029         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         11902961
119030             PV-FIRST-BLOCK-IN-ARRAY - 1                          11903061
119031                                                                  11903161
119032         PERFORM                                                  11903261
119033             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       11903361
119034                                                                  11903461
119035             PERFORM 4410-READ-TEMP-STORAGE                       11903561
119036                                                                  11903661
119037             PERFORM 2151-SET-SELECTED-INDS                       11903761
119038                 VARYING ASC-ITEM-SUB                             11903861
119039                 FROM 1 BY 1                                      11903961
119040                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          11904061
119041                                                                  11904161
119042             PERFORM 5100-WRITE-TEMP-STORAGE                      11904261
119043                                                                  11904361
119044             ADD +1                TO PV-BLOCK-NUMBER             11904461
119045                                                                  11904561
119046         END-PERFORM                                              11904661
119047                                                                  11904761
119048         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         11904861
119049             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     11904961
119050                                                                  11905061
119051         PERFORM                                                  11905161
119052             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       11905261
119053                   ASC-HIGHEST-BLOCK-WRITTEN                      11905361
119054                                                                  11905461
119055             MOVE PV-NEXT-BLOCK-IN-ARRAY                          11905561
119056                                   TO PV-BLOCK-NUMBER             11905661
119057                                                                  11905761
119058             PERFORM 4410-READ-TEMP-STORAGE                       11905861
119059                                                                  11905961
119060             PERFORM 2151-SET-SELECTED-INDS                       11906061
119061                 VARYING ASC-ITEM-SUB                             11906161
119062                 FROM 1 BY 1                                      11906261
119063                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          11906361
119064                                                                  11906461
119065             PERFORM 5100-WRITE-TEMP-STORAGE                      11906561
119066                                                                  11906661
119067             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      11906761
119068                                                                  11906861
119069         END-PERFORM                                              11906961
119070                                                                  11907061
119071         MOVE PV-FIRST-BLOCK-IN-ARRAY                             11907161
119072                                   TO PV-BLOCK-NUMBER             11907261
119073                                                                  11907361
119074         PERFORM 4410-READ-TEMP-STORAGE                           11907461
119075     END-IF.                                                      11907561
119076                                                                  11907661
119077                                                                  11907761
119078     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             11907861
119079                       ASC-NUMBER-OF-SELECTED-ITEMS.              11907961
119080                                                                  11908061
119081     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        11908161
119082                                                                  11908261
119083*----------------------------------------------------------------*11908361
119084*    MARK EACH ITEM AS BEING SELECTED.                           *11908461
119085*----------------------------------------------------------------*11908561
119086 2151-SET-SELECTED-INDS.                                          11908661
119087                                                                  11908761
119088     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           11908861
119089             NOT EQUAL ZERO                                       11908961
119090         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             11909061
119091             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             11909161
119092                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        11909261
119093                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  11909361
119094                               TO  TRUE                           11909461
119095         END-IF                                                   11909561
119096     END-IF.                                                      11909661
119097                                                                  11909761
119098******************************************************************11909802
119099** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **11909902
119100** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **11910002
119200******************************************************************11920002
119300 2200-MOVE-SCREEN-TO-COMMAREA.                                    11930002
119400                                                                  11940002
119500     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             11950002
119600     MOVE +1                       TO PV-SUB.                     11960002
119700*                                                                 11970002
119800     PERFORM 3100-SET-SUBSCRIPTS.                                 11980002
119900     IF  ASTRTITL > ZERO                                          11990002
120000         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          12000002
120100     ELSE                                                         12010002
120200         IF  ASTRTITF = DP015-ERASE-EOF                           12020002
120300             INITIALIZE ASC-START-ITEM-REQUEST                    12030002
120400         END-IF                                                   12040002
120500     END-IF.                                                      12050002
120600                                                                  12060002
120700     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          12070002
120800         VARYING PV-SUB                                           12080002
120900         FROM 1 BY 1                                              12090002
121000         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      12100002
121100******************************************************************12110002
121200** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**12120002
121300******************************************************************12130002
121400 2210-MOVE-LINES-TO-COMMAREA.                                     12140002
121500     IF  MR-SELECTL (PV-SUB) > ZERO                               12150051
121600         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             12160048
121700         MOVE MR-SELECTI (PV-SUB)                                 12170048
121800                                   TO ASC-TEMP-SELECTED-SW        12180048
121900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      12190048
122000     ELSE                                                         12200051
122100         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                12210051
122200                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     12220051
122300                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        12230051
122400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      12240051
122410         END-IF                                                   12241051
122420     END-IF.                                                      12242051
122430     ADD +1                        TO ASC-ITEM-SUB.               12243048
122440     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        12244048
122450         ADD +1                    TO ASC-BLK-SUB                 12245048
122460         MOVE +1                   TO ASC-ITEM-SUB                12246048
122470     END-IF.                                                      12247048
122480                                                                  12248063
122490******************************************************************12249063
122491** MAKE SURE THERE IS PO DATA FOR THE DATE REQUESTED              12249163
122492******************************************************************12249263
122493 2300-CHECK-PO-HISTORY-DATE.                                      12249363
122494     MOVE ASC-BUSN-YY  TO  PV-CMPR-YY.                            12249463
122495     MOVE ASC-BUSN-MM  TO  PV-CMPR-MM.                            12249563
122496     MOVE ASC-BUSN-DD  TO  PV-CMPR-DD.                            12249663
122497     EXEC SQL                                                     12249763
122498         SELECT CURRENT DATE - FUNC_QTY DAYS                      12249863
122499           INTO   :PV-POHIST-DATE                                 12249963
122500           FROM  TKRPRPM                                          12250063
122501          WHERE SYS_PRC_FUNC_CDE = 'POHIST'                       12250163
122502      END-EXEC.                                                   12250263
122503                                                                  12250363
122504       EVALUATE TRUE                                              12250463
122505          WHEN SQLCODE = +0                                       12250563
122506              IF PV-COMPARE-DATE >= PV-POHIST-DATE                12250663
122507                 SET PS-VALID-POHIST-DATE TO TRUE                 12250763
122508             ELSE                                                 12250863
122509                 SET PS-INVALID-POHIST-DATE TO TRUE               12250963
122510             END-IF                                               12251063
122511          WHEN OTHER                                              12251163
122512              MOVE '2300-CHECK-PO-HISTORY-DAT' TO DP013-PARAGRAPH 12251263
122513              MOVE 'CHECKING PARM TABLE' TO DP013-MESSAGE-TEXT (1)12251363
122514              MOVE SQLCA   TO DP013-SQLCA                         12251463
122515              MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)         12251563
122516              SET DP013-DB2-ABEND                                 12251663
122517                  DP013-XCTL-DISPLAY-RESTART TO TRUE              12251763
122518              PERFORM DP013-0000-PROCESS-ABEND                    12251863
122519      END-EVALUATE.                                               12251963
122520                                                                  12252063
122530******************************************************************12253002
122600** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **12260002
122700** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **12270002
122800******************************************************************12280002
122900 3000-EDIT-DATA-IN-COMMAREA.                                      12290002
123000     SET PS-NO-ERROR               TO TRUE.                       12300002
123100     PERFORM 3200-RESET-ATTRIBUTES.                               12310002
123200     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     12320002
123300                                                                  12330002
123400**                                                                12340002
123500* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              12350002
123600* EDITTING IS DONE FROM THE BOTTOM UP.                            12360002
123700**                                                                12370002
123800     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       12380002
123900         ASC-ITEMS-DISPLAYED - 1.                                 12390002
124000     PERFORM 3100-SET-SUBSCRIPTS.                                 12400002
124100*                                                                 12410002
124200     IF  PS-NO-ERROR                                              12420002
124300         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        12430002
124400     END-IF.                                                      12440002
124500                                                                  12450002
124600     IF  PS-NO-ERROR                                              12460002
124700         PERFORM 3400-CHECK-RANGE-SEQUENCE                        12470002
124800     END-IF.                                                      12480002
124900*                                                                 12490002
125000     IF  ((PS-NO-ERROR)                                           12500002
125100       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   12510002
125200       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    12520002
125300             PERFORM 3500-MARK-RANGE-AS-SELECTED                  12530002
125400     END-IF.                                                      12540002
125500                                                                  12550002
125600*----------------------------------------------------------------*12560002
125700*   3005-EDIT-COMMAREA-BLOCKS                                    *12570002
125800*----------------------------------------------------------------*12580002
125900 3005-EDIT-COMMAREA-BLOCKS.                                       12590002
126000     MOVE +1                       TO PV-BLOCK-NUMBER.            12600002
126100     MOVE +1                       TO ASC-BLK-SUB.                12610002
126200     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               12620002
126300                                                                  12630002
126400     COMPUTE PV-BLOCK-NUMBER  =                                   12640002
126500        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 12650002
126600            PC-ITEMS-PER-PANEL.                                   12660002
126700                                                                  12670002
126800     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          12680002
126900                                                                  12690002
127000     PERFORM                                                      12700002
127100       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          12710002
127200          OR PS-ERROR                                             12720002
127300          OR PS-BLOCK-ERROR                                       12730002
127400                                                                  12740002
127500             COMPUTE PV-ITEMS-HOLD  =                             12750002
127600                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        12760002
127700                     PC-ITEMS-PER-PANEL - 1                       12770002
127800                                                                  12780002
127900             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       12790002
128000                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               12800002
128100                     FROM  PV-ITEMS-HOLD                          12810002
128200                   GIVING  PV-ITEMS-DIFF                          12820002
128300                 SUBTRACT  PV-ITEMS-DIFF                          12830002
128400                     FROM  PC-ITEMS-PER-PANEL                     12840002
128500                   GIVING  PV-ITEMS-HOLD                          12850002
128600                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              12860002
128700                                              ASC-ITEM-SUB        12870002
128800                                              ASC-ITEMS-DISPLAYED 12880002
128900             ELSE                                                 12890002
129000                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              12900002
129100                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        12910002
129200             END-IF                                               12920002
129300                                                                  12930002
129400             PERFORM 3300-EDIT-SELECTIONS                         12940002
129500                     VARYING PV-SUB                               12950002
129600                        FROM PV-SUB BY -1                         12960002
129700                       UNTIL PV-SUB < +1                          12970002
129800                                                                  12980002
129900             MOVE +1               TO ASC-BLK-SUB                 12990002
130000                                                                  13000002
130100             PERFORM 5105-REWRITE-ASC-LISTQ                       13010002
130200                                                                  13020002
130300             MOVE +1                TO ASC-BLK-SUB                13030002
130400                                                                  13040002
130500             IF  PS-BLOCK-ERROR                                   13050002
130600                 SET  PS-ERROR     TO TRUE                        13060002
130700                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        13070002
130800                                   TO PV-TOP-ITEM                 13080002
130900             ELSE                                                 13090002
131000                 ADD  +1           TO PV-BLOCK-NUMBER             13100002
131100                 IF  PV-BLOCK-NUMBER >                            13110002
131200                     ASC-HIGHEST-BLOCK-WRITTEN                    13120002
131300                     MOVE +2       TO ASC-BLK-SUB                 13130002
131400                     PERFORM 4410-READ-TEMP-STORAGE               13140002
131500                     MOVE +1       TO ASC-BLK-SUB                 13150002
131600                 ELSE                                             13160002
131700                     PERFORM 4410-READ-TEMP-STORAGE               13170002
131800                     ADD  +1        TO PV-BLOCK-NUMBER            13180002
131900                     MOVE +2        TO ASC-BLK-SUB                13190002
132000                     PERFORM 4410-READ-TEMP-STORAGE               13200002
132100                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            13210002
132200                     MOVE +1        TO ASC-BLK-SUB                13220002
132300                 END-IF                                           13230002
132400             END-IF                                               13240002
132500     END-PERFORM.                                                 13250002
132600                                                                  13260002
132700     IF  PV-ORIGINAL-BLOCK  = +1    OR                            13270002
132800         PS-ERROR                   OR                            13280002
132900         PS-BLOCK-ERROR                                           13290002
133000         CONTINUE                                                 13300002
133100     ELSE                                                         13310002
133200         MOVE +1                 TO PV-BLOCK-NUMBER               13320002
133300         MOVE +1                 TO ASC-BLK-SUB                   13330002
133400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  13340002
133500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           13350002
133600         PERFORM 4410-READ-TEMP-STORAGE                           13360002
133700                                                                  13370002
133800         PERFORM                                                  13380002
133900           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              13390002
134000              OR PS-ERROR                                         13400002
134100              OR PS-BLOCK-ERROR                                   13410002
134200                                                                  13420002
134300                 COMPUTE PV-ITEMS-HOLD  =                         13430002
134400                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    13440002
134500                         PC-ITEMS-PER-PANEL - 1                   13450002
134600                                                                  13460002
134700                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     13470002
134800                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           13480002
134900                         FROM  PV-ITEMS-HOLD                      13490002
135000                       GIVING  PV-ITEMS-DIFF                      13500002
135100                     SUBTRACT  PV-ITEMS-DIFF                      13510002
135200                         FROM  PC-ITEMS-PER-PANEL                 13520002
135300                       GIVING  PV-ITEMS-HOLD                      13530002
135400                         MOVE  PV-ITEMS-HOLD TO PV-SUB            13540002
135500                                                ASC-ITEM-SUB      13550002
135600                                               ASC-ITEMS-DISPLAYED13560002
135700                 ELSE                                             13570002
135800                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          13580002
135900                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    13590002
136000                 END-IF                                           13600002
136100                                                                  13610002
136200                 PERFORM 3300-EDIT-SELECTIONS                     13620002
136300                         VARYING PV-SUB                           13630002
136400                            FROM PV-SUB BY -1                     13640002
136500                           UNTIL PV-SUB < +1                      13650002
136600                                                                  13660002
136700                 MOVE +1               TO ASC-BLK-SUB             13670002
136800                                                                  13680002
136900                 PERFORM 5105-REWRITE-ASC-LISTQ                   13690002
137000                                                                  13700002
137100                 MOVE +1                TO ASC-BLK-SUB            13710002
137200                                                                  13720002
137300                 IF  PS-BLOCK-ERROR                               13730002
137400                     SET  PS-ERROR     TO TRUE                    13740002
137500                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    13750002
137600                                       TO PV-TOP-ITEM             13760002
137700                 ELSE                                             13770002
137800                     ADD  +1            TO PV-BLOCK-NUMBER        13780002
137900                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      13790002
138000                         MOVE +2        TO ASC-BLK-SUB            13800002
138100                         PERFORM 4410-READ-TEMP-STORAGE           13810002
138200                         MOVE +1        TO ASC-BLK-SUB            13820002
138300                     ELSE                                         13830002
138400                         PERFORM 4410-READ-TEMP-STORAGE           13840002
138500                         ADD  +1        TO PV-BLOCK-NUMBER        13850002
138600                         MOVE +2        TO ASC-BLK-SUB            13860002
138700                         PERFORM 4410-READ-TEMP-STORAGE           13870002
138800                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        13880002
138900                         MOVE +1        TO ASC-BLK-SUB            13890002
139000                     END-IF                                       13900002
139100                 END-IF                                           13910002
139200     END-PERFORM.                                                 13920002
139300                                                                  13930002
139400*----------------------------------------------------------------*13940002
139500*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *13950002
139600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*13960002
139700*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *13970002
139800*                                                                *13980002
139900*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *13990002
140000*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *14000002
140100*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *14010002
140200*    US IN THE 2ND BLOCK OF THE ARRAY.                           *14020002
140300*----------------------------------------------------------------*14030002
140400 3100-SET-SUBSCRIPTS.                                             14040002
140500                                                                  14050002
140600     COMPUTE ASC-ITEM-SUB =                                       14060002
140700         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        14070002
140800                                                                  14080002
140900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         14090002
141000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            14100002
141100         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               14110002
141200     ELSE                                                         14120002
141300         MOVE +1                     TO ASC-BLK-SUB               14130002
141400     END-IF.                                                      14140002
141500******************************************************************14150002
141600** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **14160002
141700******************************************************************14170002
141800 3200-RESET-ATTRIBUTES.                                           14180002
141900     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   14190002
142000     MOVE DP015-GREEN              TO ASTRTITC.                   14200002
142100     MOVE DP015-UNDERLINE          TO ASTRTITH.                   14210002
142200                                                                  14220002
142300     PERFORM                                                      14230024
142400         VARYING PV-SUB                                           14240024
142500         FROM 1 BY 1                                              14250024
142600         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        14260024
142700         MOVE DP015-UNP-ALP-NOR-OFF                               14270024
142800                                   TO MR-SELECTA (PV-SUB)         14280024
142900         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         14290024
143000         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         14300024
143100     END-PERFORM.                                                 14310024
143200******************************************************************14320002
143300** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **14330002
143400** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **14340002
143500** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **14350002
143600** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **14360002
143700******************************************************************14370002
143800 3300-EDIT-SELECTIONS.                                            14380002
143900     EVALUATE TRUE                                                14390002
144000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     14400002
144100             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         14410002
144200                 CONTINUE                                         14420002
144300         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         14430002
144400             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        14440002
144500                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   14450002
144600                 MOVE ASC-TEMP-SELECTED-SW                        14460002
144700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14470002
144800                                TO ASC-SELECTED-SW                14480002
144900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14490002
145000             END-IF                                               14500002
145100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     14510002
145200                 = SPACE                                          14520002
145300             EVALUATE TRUE                                        14530002
145400                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       14540002
145500                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS14550002
145600                     MOVE SPACE TO ASC-SELECTED-SW                14560002
145700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14570002
145800                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        14580002
145900                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    14590002
146000                     MOVE SPACE TO ASC-SELECTED-SW                14600002
146100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14610002
146200                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          14620002
146300                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      14630002
146400                     MOVE SPACE TO ASC-SELECTED-SW                14640002
146500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14650002
146600             END-EVALUATE                                         14660002
146700         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           14670002
146800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14680002
146900                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14690002
147000             END-IF                                               14700002
147100             PERFORM 3310-EDIT-RANGE                              14710002
147200         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             14720002
147300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14730002
147400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14740002
147500             END-IF                                               14750002
147600             PERFORM 3310-EDIT-RANGE                              14760002
147700         WHEN OTHER                                               14770002
147800             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           14780002
147900             SET DP020-MSG-FATAL    TO TRUE                       14790002
148000             MOVE -1                TO MR-SELECTL (PV-SUB)        14800024
148100             SET DP030-SET-CURSOR-APPL-1                          14810024
148200                                    TO TRUE                       14820024
148300             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        14830024
148400             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        14840024
148500             SET PS-ERROR TO TRUE                                 14850002
148600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14860002
148700                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     14870002
148800                 MOVE SPACE         TO ASC-SELECTED-SW            14880002
148900                                        (ASC-BLK-SUB ASC-ITEM-SUB)14890002
149000             END-IF                                               14900002
149100     END-EVALUATE.                                                14910002
149200                                                                  14920002
149300     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 14930002
149400     SUBTRACT +1 FROM ASC-ITEM-SUB.                               14940002
149500     IF  ASC-ITEM-SUB < 1                                         14950002
149600         SUBTRACT +1 FROM ASC-BLK-SUB                             14960002
149700         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                14970002
149800     END-IF.                                                      14980002
149900                                                                  14990002
150000******************************************************************15000002
150100** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **15010002
150200** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **15020002
150300** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**15030002
150400** THE ENDING.                                                  **15040002
150500******************************************************************15050002
150600 3310-EDIT-RANGE.                                                 15060002
150700     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                15070002
150800         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   15080002
150900             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)15090002
151000                                   TO ASC-SELECTED-SW             15100002
151100                                        (ASC-BLK-SUB ASC-ITEM-SUB)15110002
151200             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 15120002
151300         ELSE                                                     15130002
151400             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     15140002
151500                 CONTINUE                                         15150002
151600             ELSE                                                 15160002
151700*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        15170002
151800                 MOVE PC-TSYMSG-00054                             15180002
151900                                       TO DP020-MSG-NUMBER        15190002
152000                 MOVE -1               TO ASTRTITL                15200002
152100                 SET DP020-MSG-FATAL                              15210002
152200                     DP030-SET-CURSOR-APPL-1                      15220002
152300                     PS-ERROR          TO TRUE                    15230002
152400             END-IF                                               15240002
152500         END-IF                                                   15250002
152600     ELSE                                                         15260002
152700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     15270002
152800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 15280002
152900                                   TO ASC-SELECTED-SW             15290002
153000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15300002
153100             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   15310002
153200         ELSE                                                     15320002
153300             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       15330002
153400                 CONTINUE                                         15340002
153500             ELSE                                                 15350002
153600*                -- ONLY ONE END-OF-RANGE ALLOWED --              15360002
153700                 MOVE PC-TSYMSG-00055                             15370002
153800                                        TO DP020-MSG-NUMBER       15380002
153900                 MOVE -1                TO ASTRTITL               15390002
154000                 SET DP020-MSG-FATAL                              15400002
154100                     DP030-SET-CURSOR-APPL-1                      15410002
154200                     PS-ERROR           TO TRUE                   15420002
154300             END-IF                                               15430002
154400         END-IF                                                   15440002
154500     END-IF.                                                      15450002
154600*                                                                 15460002
154700******************************************************************15470002
154800** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **15480002
154900** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **15490002
155000******************************************************************15500002
155100 3400-CHECK-RANGE-SEQUENCE.                                       15510002
155200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       15520002
155300       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      15530002
155400       AND  ASC-START-OF-SELECTED-RANGE >                         15540002
155500                                         ASC-END-OF-SELECTED-RANGE15550002
155600*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                15560002
155700         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 15570002
155800         SET DP020-MSG-FATAL TO TRUE                              15580002
155900         SET PS-ERROR TO TRUE                                     15590002
156000         PERFORM 3410-POSITION-AT-ERROR                           15600002
156100     END-IF.                                                      15610002
156200******************************************************************15620002
156300** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **15630002
156400** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **15640002
156500** SHOULD BE POSITIONED ON A RANGE ERROR.                       **15650002
156600******************************************************************15660002
156700 3410-POSITION-AT-ERROR.                                          15670002
156800     SET DP030-SET-CURSOR-APPL-1                                  15680002
156900                                   TO TRUE.                       15690002
157000     MOVE -1                       TO ASTRTITL                    15700002
157100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 15710002
157200                    - PV-TOP-ITEM + 1.                            15720002
157300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      15730002
157400         CONTINUE                                                 15740002
157500     END-IF.                                                      15750002
157600*                                                                 15760002
157700     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   15770002
157800                    - PV-TOP-ITEM + 1.                            15780002
157900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      15790002
158000         CONTINUE                                                 15800002
158100     END-IF.                                                      15810002
158200                                                                  15820002
158300*----------------------------------------------------------------*15830002
158400*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *15840002
158500*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *15850002
158600*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *15860002
158700*----------------------------------------------------------------*15870002
158800 3500-MARK-RANGE-AS-SELECTED.                                     15880002
158900     MOVE +1                       TO  ASC-BLK-SUB.               15890002
159000     PERFORM 3510-MARK-SELECTED-INDS                              15900002
159100         VARYING ASC-ITEM-SUB                                     15910002
159200         FROM 1 BY 1                                              15920002
159300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15930002
159400                                                                  15940002
159500     ADD +1                        TO ASC-BLK-SUB.                15950002
159600     PERFORM 3510-MARK-SELECTED-INDS                              15960002
159700         VARYING ASC-ITEM-SUB                                     15970002
159800         FROM 1 BY 1                                              15980002
159900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15990002
160000                                                                  16000002
160100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16010002
160200                                   TO  PV-LIST-ITEM-NUMBER.       16020002
160300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16030002
160400         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         16040002
160500               PC-ITEMS-PER-PANEL).                               16050002
160600                                                                  16060002
160700     MOVE ASC-START-OF-SELECTED-RANGE                             16070002
160800                                   TO PV-START-OF-SELECTED-RANGE. 16080002
160900     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            16090002
161000         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  16100002
161100               PC-ITEMS-PER-PANEL).                               16110002
161200                                                                  16120002
161300     MOVE ASC-END-OF-SELECTED-RANGE                               16130002
161400                                   TO  PV-END-OF-SELECTED-RANGE.  16140002
161500     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             16150002
161600         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    16160002
161700               PC-ITEMS-PER-PANEL).                               16170002
161800     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             16180002
161900         PV-FIRST-BLOCK-IN-ARRAY + 1.                             16190002
162000                                                                  16200002
162100     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    16210002
162200        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        16220002
162300         MOVE +1                   TO ASC-BLK-SUB                 16230002
162400         PERFORM 5100-WRITE-TEMP-STORAGE                          16240002
162500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16250002
162600             PV-FIRST-BLOCK-IN-ARRAY - 1                          16260002
162700                                                                  16270002
162800         PERFORM                                                  16280002
162900             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      16290002
163000                   PV-PREV-BLOCK-IN-ARRAY                         16300002
163100             MOVE PV-FIRST-BLOCK-IN-RANGE                         16310002
163200                                   TO PV-BLOCK-NUMBER             16320002
163300             PERFORM 4410-READ-TEMP-STORAGE                       16330002
163400             PERFORM 3510-MARK-SELECTED-INDS                      16340002
163500                 VARYING ASC-ITEM-SUB                             16350002
163600                 FROM 1 BY 1                                      16360002
163700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16370002
163800             PERFORM 5100-WRITE-TEMP-STORAGE                      16380002
163900             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     16390002
164000         END-PERFORM                                              16400002
164100                                                                  16410002
164200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16420002
164300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16430002
164400         PERFORM                                                  16440002
164500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16450002
164600                   PV-LAST-BLOCK-IN-RANGE                         16460002
164700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16470002
164800                                   TO PV-BLOCK-NUMBER             16480002
164900             PERFORM 4410-READ-TEMP-STORAGE                       16490002
165000             PERFORM 3510-MARK-SELECTED-INDS                      16500002
165100                 VARYING ASC-ITEM-SUB                             16510002
165200                 FROM 1 BY 1                                      16520002
165300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16530002
165400             PERFORM 5100-WRITE-TEMP-STORAGE                      16540002
165500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16550002
165600         END-PERFORM                                              16560002
165700                                                                  16570002
165800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16580002
165900                                   TO PV-BLOCK-NUMBER             16590002
166000         PERFORM 4410-READ-TEMP-STORAGE                           16600002
166100     END-IF.                                                      16610002
166200                                                                  16620002
166300     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 16630002
166400                                      ASC-END-OF-SELECTED-RANGE.  16640002
166500                                                                  16650002
166600*----------------------------------------------------------------*16660002
166700* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *16670002
166800*----------------------------------------------------------------*16680002
166900 3510-MARK-SELECTED-INDS.                                         16690002
167000                                                                  16700002
167100     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         16710002
167200                                ASC-ITEM-SUB) >                   16720002
167300         ASC-START-OF-SELECTED-RANGE)                             16730002
167400     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         16740002
167500                                ASC-ITEM-SUB) =                   16750002
167600         ASC-START-OF-SELECTED-RANGE)                             16760002
167700                                                                  16770002
167800         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     16780002
167900                                    ASC-ITEM-SUB) <               16790002
168000             ASC-END-OF-SELECTED-RANGE)                           16800002
168100         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     16810002
168200                                    ASC-ITEM-SUB) =               16820002
168300             ASC-END-OF-SELECTED-RANGE)                           16830002
168400                                                                  16840002
168500             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16850002
168600                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   16860002
168700                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   16870002
168800                               TO TRUE                            16880002
168900                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              16890002
169000                               TO TRUE                            16900002
169100                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    16910002
169200             END-IF                                               16920002
169300         END-IF                                                   16930002
169400     END-IF.                                                      16940002
169500                                                                  16950002
169600*----------------------------------------------------------------*16960002
169700*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *16970002
169800*    INITIALIZE ALL COUNTERS AND FLAGS.                          *16980002
169900*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *16990002
170000*    DISPLAY THE PANEL TO USER.                                  *17000002
170100*----------------------------------------------------------------*17010002
170200 4000-BUILD-INITIAL-PANEL.                                        17020002
170300                                                                  17030002
170400     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            17040002
170500                                 ASC-BLOCK-ENTRIES (2).           17050002
170600     MOVE +1                 TO ASC-BLK-SUB.                      17060002
170700     SET ASC-ITEMS-LEFT-ON-DB                                     17070002
170800                             TO TRUE.                             17080002
170900                                                                  17090002
171000     MOVE +0                 TO ASC-ITEM-SUB                      17100002
171100                                ASC-NUMBER-OF-ITEMS-READ          17110002
171200                                ASC-NUMBER-OF-SELECTED-ITEMS      17120002
171300                                ASC-HIGHEST-BLOCK-WRITTEN         17130002
171400                                ASC-START-OF-SELECTED-RANGE       17140002
171500                                ASC-END-OF-SELECTED-RANGE         17150002
171600                                ASC-ITEM-AT-TOP-OF-PANEL.         17160002
171700                                                                  17170002
173900                                                                  17390015
173910     PERFORM 4004-FIND-DATE-INFO.                                 17391036
173920     IF ASC-OPER-NBR > ZEROES                                     17392036
173930         MOVE ASC-OPER-NBR TO DK-OPER-UNT-ID                      17393036
173931         PERFORM 4005-CALC-TOTAL-AMTS-BY-OPER                     17393136
173940     ELSE                                                         17394036
173941         IF PC215-OPER-DESC (ASC-SEL-SUB) > SPACES                17394138
173950             MOVE PC215-OPER-DESC (ASC-SEL-SUB) TO DK-OPER-DESC   17395036
173960             EXEC SQL                                             17396036
173970                  SELECT  LOC_NBR                                 17397099
173980                    INTO  :XLT00010-LOC-NBR                       17398099
173990                    FROM  XLT_LOC                                 17399099
173991                   WHERE  LOC_5_ABBR_NM =  :DK-OPER-DESC          17399199
173992             END-EXEC                                             17399236
173994             EVALUATE TRUE                                        17399436
173995                 WHEN SQLCODE = +0                                17399536
173996                     MOVE XLT00010-LOC-NM TO ASC-OPER-NBR         17399699
173997                                             DK-OPER-UNT-ID       17399736
173998                 WHEN OTHER                                       17399836
173999                     MOVE ZEROES          TO ASC-OPER-NBR         17399936
174000                                             DK-OPER-UNT-ID       17400036
174002             END-EVALUATE                                         17400236
174003             PERFORM 4005-CALC-TOTAL-AMTS-BY-OPER                 17400336
174004         ELSE                                                     17400436
174005             PERFORM 4006-CALC-TOTAL-AMTS                         17400536
174006         END-IF                                                   17400636
174007     END-IF.                                                      17400736
174100     PERFORM 4100-PREPARE-CURSOR.                                 17410036
174200     PERFORM 4010-OPEN-CURSOR.                                    17420002
174300     PERFORM 4300-READ-ITEMS-FROM-DB.                             17430002
174400     PERFORM 4020-CLOSE-CURSOR.                                   17440002
174500                                                                  17450002
174600     MOVE +1                   TO  PV-TOP-ITEM.                   17460002
174700*    IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          17470002
174800*        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    17480002
174900*        SET DP020-MSG-FATAL   TO  TRUE                           17490002
175000*        MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               17500002
175100*    ELSE                                                         17510002
175200         MOVE -1               TO MR-SELECTL (1)                  17520045
175300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      17530002
175400         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                    17540002
175500*    END-IF.                                                      17550002
175600                                                                  17560002
175700*----------------------------------------------------------------*17570010
175800*    DETERMINE DATE PARAMETERS                                    17580036
175900*----------------------------------------------------------------*17590010
176000 4004-FIND-DATE-INFO.                                             17600036
176100                                                                  17610010
176200     IF ASC-FISCAL-WEEK > SPACES                                  17620010
176300         MOVE ASC-FISCAL-WEEK    TO DK-FISCAL-WEEK                17630010
176400         PERFORM 4007-GET-WEEK-INFO                               17640010
176410         MOVE DK-FROM-YY        TO ASC-FROM-YR                    17641081
176420         MOVE DK-FROM-MM        TO ASC-FROM-MN                    17642081
176430         MOVE DK-FROM-DD        TO ASC-FROM-DY                    17643081
176500         STRING 'WTD INCL ' DELIMITED BY SIZE                     17650010
176600                DK-TO-DATE  DELIMITED BY SIZE                     17660010
176700                    INTO PV-DISPLAY-DATE                          17670010
176800     ELSE                                                         17680010
176900         IF ASC-FISCAL-MONTH > SPACES                             17690010
177000             MOVE ASC-FISCAL-MONTH   TO DK-FISCAL-MONTH           17700010
177100             PERFORM 4008-GET-MONTH-INFO                          17710010
177110             MOVE DK-FROM-YY        TO ASC-FROM-YR                17711081
177120             MOVE DK-FROM-MM        TO ASC-FROM-MN                17712081
177130             MOVE DK-FROM-DD        TO ASC-FROM-DY                17713081
177200             STRING 'MTD INCL ' DELIMITED BY SIZE                 17720010
177300                    DK-TO-DATE  DELIMITED BY SIZE                 17730010
177400                        INTO PV-DISPLAY-DATE                      17740010
177500         ELSE                                                     17750010
177600             IF ASC-FROM-DATE > SPACES                            17760010
177700                 MOVE ASC-FROM-YR        TO DK-FROM-YY            17770010
177800                 MOVE ASC-FROM-MN        TO DK-FROM-MM            17780010
177900                 MOVE ASC-FROM-DY        TO DK-FROM-DD            17790010
178000                 MOVE DK-FROM-DATE-X     TO DK-FROM-DATE          17800010
178100                 MOVE ASC-TO-YR          TO DK-TO-YY              17810010
178200                 MOVE ASC-TO-MN          TO DK-TO-MM              17820010
178300                 MOVE ASC-TO-DY          TO DK-TO-DD              17830010
178400                 MOVE DK-TO-DATE-X       TO DK-TO-DATE            17840010
178500                 STRING 'BUSINESS DATE RANGE: ' DELIMITED BY SIZE 17850010
178600                        DK-FROM-DATE  DELIMITED BY SIZE           17860010
178700                        ' '           DELIMITED BY SIZE           17870010
178800                        'TO '         DELIMITED BY SIZE           17880010
178900                        DK-TO-DATE    DELIMITED BY SIZE           17890010
179000                            INTO PV-DISPLAY-DATE                  17900010
179100             ELSE                                                 17910010
179200                 MOVE ASC-BUSN-YY        TO DK-FROM-YY            17920010
179300                 MOVE ASC-BUSN-MM        TO DK-FROM-MM            17930010
179400                 MOVE ASC-BUSN-DD        TO DK-FROM-DD            17940010
179500                 MOVE DK-FROM-DATE-X     TO DK-FROM-DATE          17950010
179600                 MOVE DK-FROM-DATE       TO DK-TO-DATE            17960010
179700                     STRING 'BUSINESS DATE: ' DELIMITED BY SIZE   17970010
179800                             DK-TO-DATE       DELIMITED BY SIZE   17980010
179900                                INTO PV-DISPLAY-DATE              17990010
180000             END-IF                                               18000010
180100         END-IF                                                   18010010
180200     END-IF.                                                      18020010
180300     MOVE PV-DISPLAY-DATE TO ASC-DISPLAY-DATE.                    18030028
180301                                                                  18030136
180310*----------------------------------------------------------------*18031036
180320*    CALCULATE TOTALS BY OPER FOR SCREEN HEADER FIELDS.           18032041
180330*----------------------------------------------------------------*18033036
180340 4005-CALC-TOTAL-AMTS-BY-OPER.                                    18034036
180350                                                                  18035036
180400     EXEC SQL                                                     18040028
180500          SELECT  DECIMAL(SUM(UNT_WRKD_QTY),11,0)                 18050028
180600            INTO  :PV-TOT-UNITS                                   18060028
180700            FROM  PCT_SUM_WRKD                                    18070028
180800           WHERE  BUS_DTE        >=  :DK-FROM-DATE                18080028
180900             AND  BUS_DTE        <=  :DK-TO-DATE                  18090028
181000             AND  OPER_UNT_ID     =  :DK-OPER-UNT-ID              18100028
181100     END-EXEC.                                                    18110028
181200                                                                  18120028
181300     EVALUATE TRUE                                                18130028
181400         WHEN SQLCODE = +0                                        18140028
181500             MOVE PV-TOT-UNITS  TO  ASC-TOT-UNITS                 18150028
181600         WHEN OTHER                                               18160028
181700             MOVE ZEROES        TO  ASC-TOT-UNITS                 18170028
181800     END-EVALUATE.                                                18180028
181900                                                                  18190028
182000     EXEC SQL                                                     18200028
182100          SELECT  FLOAT (SUM(UNT_WRKD_QTY))                       18210028
182200            INTO  :PV-1ST-UNITS                                   18220028
182300            FROM  PCT_SUM_WRKD                                    18230028
182400           WHERE  BUS_DTE        >=  :DK-FROM-DATE                18240028
182500             AND  BUS_DTE        <=  :DK-TO-DATE                  18250028
182600             AND  SHFT_NBR        =  :PC-1                        18260028
182700             AND  OPER_UNT_ID     =  :DK-OPER-UNT-ID              18270028
182800     END-EXEC.                                                    18280028
182900                                                                  18290028
183000     EVALUATE TRUE                                                18300028
183100         WHEN SQLCODE = +0                                        18310028
183200             MOVE PV-1ST-UNITS  TO  ASC-1ST-UNITS                 18320028
183300         WHEN OTHER                                               18330028
183400             MOVE ZEROES        TO  ASC-1ST-UNITS                 18340028
183500     END-EVALUATE.                                                18350028
183600                                                                  18360028
183700     EXEC SQL                                                     18370028
183800          SELECT  FLOAT (SUM(UNT_WRKD_QTY))                       18380028
183900            INTO  :PV-2ND-UNITS                                   18390028
184000            FROM  PCT_SUM_WRKD                                    18400028
184100           WHERE  BUS_DTE        >=  :DK-FROM-DATE                18410028
184200             AND  BUS_DTE        <=  :DK-TO-DATE                  18420028
184300             AND  SHFT_NBR        =  :PC-2                        18430028
184400             AND  OPER_UNT_ID     =  :DK-OPER-UNT-ID              18440028
184500     END-EXEC.                                                    18450028
184600                                                                  18460028
184700     EVALUATE TRUE                                                18470028
184800         WHEN SQLCODE = +0                                        18480028
184900             MOVE PV-2ND-UNITS  TO  ASC-2ND-UNITS                 18490028
185000         WHEN OTHER                                               18500028
185100             MOVE ZEROES        TO  ASC-2ND-UNITS                 18510028
185200     END-EVALUATE.                                                18520028
185300                                                                  18530028
185400     EXEC SQL                                                     18540028
185500          SELECT  FLOAT (SUM(UNT_WRKD_QTY))                       18550028
185600            INTO  :PV-3RD-UNITS                                   18560028
185700            FROM  PCT_SUM_WRKD                                    18570028
185800           WHERE  BUS_DTE        >=  :DK-FROM-DATE                18580028
185900             AND  BUS_DTE        <=  :DK-TO-DATE                  18590028
186000             AND  SHFT_NBR        =  :PC-3                        18600028
186100             AND  OPER_UNT_ID     =  :DK-OPER-UNT-ID              18610028
186200     END-EXEC.                                                    18620028
186300                                                                  18630028
186400     EVALUATE TRUE                                                18640028
186500         WHEN SQLCODE = +0                                        18650028
186600             MOVE PV-3RD-UNITS  TO  ASC-3RD-UNITS                 18660028
186700         WHEN OTHER                                               18670028
186800             MOVE ZEROES        TO  ASC-3RD-UNITS                 18680028
186900     END-EVALUATE.                                                18690028
187000                                                                  18700028
187100     INITIALIZE  PV-TOT-UNITS                                     18710028
187200                 PV-1ST-UNITS                                     18720028
187300                 PV-2ND-UNITS                                     18730028
187400                 PV-3RD-UNITS.                                    18740028
187500                                                                  18750028
187600     IF ASC-1ST-UNITS > ZERO AND ASC-TOT-UNITS > ZERO             18760097
187700         DIVIDE ASC-1ST-UNITS BY ASC-TOT-UNITS                    18770028
187800             GIVING PV-DIVIDEND ROUNDED                           18780077
187900         MULTIPLY PV-DIVIDEND BY 100                              18790028
188000             GIVING ASC-1ST-PCT                                   18800028
188100         IF ASC-1ST-PCT = ZERO                                    18810028
188200             MOVE .1    TO  ASC-1ST-PCT                           18820028
188300         END-IF                                                   18830028
188400     ELSE                                                         18840028
188500         MOVE ZEROS TO  ASC-1ST-PCT                               18850028
188600     END-IF.                                                      18860028
188700     IF ASC-2ND-UNITS > ZERO AND ASC-TOT-UNITS > ZERO             18870097
188800         DIVIDE ASC-2ND-UNITS BY ASC-TOT-UNITS                    18880028
188900             GIVING PV-DIVIDEND ROUNDED                           18890077
189000         MULTIPLY PV-DIVIDEND BY 100                              18900028
189100             GIVING ASC-2ND-PCT                                   18910028
189200         IF ASC-2ND-PCT = ZERO                                    18920028
189300             MOVE .1    TO  ASC-2ND-PCT                           18930028
189400         END-IF                                                   18940028
189500     ELSE                                                         18950028
189600         MOVE ZEROS TO  ASC-2ND-PCT                               18960028
189700     END-IF.                                                      18970028
189800     IF ASC-3RD-UNITS > ZERO AND ASC-TOT-UNITS > ZERO             18980099
189900         DIVIDE ASC-3RD-UNITS BY ASC-TOT-UNITS                    18990028
190000             GIVING PV-DIVIDEND ROUNDED                           19000077
190100         MULTIPLY PV-DIVIDEND BY 100                              19010028
190200             GIVING ASC-3RD-PCT                                   19020028
190300         IF ASC-3RD-PCT = ZERO                                    19030028
190400             MOVE .1 TO  ASC-3RD-PCT                              19040028
190500         END-IF                                                   19050028
190600     ELSE                                                         19060028
190700         MOVE ZEROS TO  ASC-3RD-PCT                               19070028
190800     END-IF.                                                      19080028
190900                                                                  19090028
190910*----------------------------------------------------------------*19091036
190920*    CALCULATE COMPANY TOTALS FOR SCREEN HEADER FIELDS.           19092036
190930*----------------------------------------------------------------*19093036
190940 4006-CALC-TOTAL-AMTS.                                            19094036
190950                                                                  19095036
190960     EXEC SQL                                                     19096036
190970          SELECT  DECIMAL(SUM(UNT_WRKD_QTY),11,0)                 19097036
190980            INTO  :PV-TOT-UNITS                                   19098036
190990            FROM  PCT_SUM_WRKD                                    19099036
190991           WHERE  BUS_DTE        >=  :DK-FROM-DATE                19099136
190992             AND  BUS_DTE        <=  :DK-TO-DATE                  19099236
190994     END-EXEC.                                                    19099436
190995                                                                  19099536
190996     EVALUATE TRUE                                                19099636
190997         WHEN SQLCODE = +0                                        19099736
190998             MOVE PV-TOT-UNITS  TO  ASC-TOT-UNITS                 19099836
190999         WHEN OTHER                                               19099936
191000             MOVE ZEROES        TO  ASC-TOT-UNITS                 19100036
191001     END-EVALUATE.                                                19100136
191002                                                                  19100236
191003     EXEC SQL                                                     19100336
191004          SELECT  FLOAT (SUM(UNT_WRKD_QTY))                       19100436
191005            INTO  :PV-1ST-UNITS                                   19100536
191006            FROM  PCT_SUM_WRKD                                    19100636
191007           WHERE  BUS_DTE        >=  :DK-FROM-DATE                19100736
191008             AND  BUS_DTE        <=  :DK-TO-DATE                  19100836
191009             AND  SHFT_NBR        =  :PC-1                        19100936
191011     END-EXEC.                                                    19101136
191012                                                                  19101236
191013     EVALUATE TRUE                                                19101336
191014         WHEN SQLCODE = +0                                        19101436
191015             MOVE PV-1ST-UNITS  TO  ASC-1ST-UNITS                 19101536
191016         WHEN OTHER                                               19101636
191017             MOVE ZEROES        TO  ASC-1ST-UNITS                 19101736
191018     END-EVALUATE.                                                19101836
191019                                                                  19101936
191020     EXEC SQL                                                     19102036
191021          SELECT  FLOAT (SUM(UNT_WRKD_QTY))                       19102136
191022            INTO  :PV-2ND-UNITS                                   19102236
191023            FROM  PCT_SUM_WRKD                                    19102336
191024           WHERE  BUS_DTE        >=  :DK-FROM-DATE                19102436
191025             AND  BUS_DTE        <=  :DK-TO-DATE                  19102536
191026             AND  SHFT_NBR        =  :PC-2                        19102636
191028     END-EXEC.                                                    19102836
191029                                                                  19102936
191030     EVALUATE TRUE                                                19103036
191031         WHEN SQLCODE = +0                                        19103136
191032             MOVE PV-2ND-UNITS  TO  ASC-2ND-UNITS                 19103236
191033         WHEN OTHER                                               19103336
191034             MOVE ZEROES        TO  ASC-2ND-UNITS                 19103436
191035     END-EVALUATE.                                                19103536
191036                                                                  19103636
191037     EXEC SQL                                                     19103736
191038          SELECT  FLOAT (SUM(UNT_WRKD_QTY))                       19103836
191039            INTO  :PV-3RD-UNITS                                   19103936
191040            FROM  PCT_SUM_WRKD                                    19104036
191041           WHERE  BUS_DTE        >=  :DK-FROM-DATE                19104136
191042             AND  BUS_DTE        <=  :DK-TO-DATE                  19104236
191043             AND  SHFT_NBR        =  :PC-3                        19104336
191045     END-EXEC.                                                    19104536
191046                                                                  19104636
191047     EVALUATE TRUE                                                19104736
191048         WHEN SQLCODE = +0                                        19104836
191049             MOVE PV-3RD-UNITS  TO  ASC-3RD-UNITS                 19104936
191050         WHEN OTHER                                               19105036
191051             MOVE ZEROES        TO  ASC-3RD-UNITS                 19105136
191052     END-EVALUATE.                                                19105236
191053                                                                  19105336
191054     INITIALIZE  PV-TOT-UNITS                                     19105436
191055                 PV-1ST-UNITS                                     19105536
191056                 PV-2ND-UNITS                                     19105636
191057                 PV-3RD-UNITS.                                    19105736
191058                                                                  19105836
191059     IF ASC-1ST-UNITS > ZERO AND ASC-TOT-UNITS > ZERO             19105997
191060         DIVIDE ASC-1ST-UNITS BY ASC-TOT-UNITS                    19106036
191061             GIVING PV-DIVIDEND ROUNDED                           19106177
191062         MULTIPLY PV-DIVIDEND BY 100                              19106236
191063             GIVING ASC-1ST-PCT                                   19106336
191064         IF ASC-1ST-PCT = ZERO                                    19106436
191065             MOVE .1    TO  ASC-1ST-PCT                           19106536
191066         END-IF                                                   19106636
191067     ELSE                                                         19106736
191068         MOVE ZEROS TO  ASC-1ST-PCT                               19106836
191069     END-IF.                                                      19106936
191070     IF ASC-2ND-UNITS > ZERO AND ASC-TOT-UNITS > ZERO             19107097
191071         DIVIDE ASC-2ND-UNITS BY ASC-TOT-UNITS                    19107136
191072             GIVING PV-DIVIDEND ROUNDED                           19107277
191073         MULTIPLY PV-DIVIDEND BY 100                              19107336
191074             GIVING ASC-2ND-PCT                                   19107436
191075         IF ASC-2ND-PCT = ZERO                                    19107536
191076             MOVE .1    TO  ASC-2ND-PCT                           19107636
191077         END-IF                                                   19107736
191078     ELSE                                                         19107836
191079         MOVE ZEROS TO  ASC-2ND-PCT                               19107936
191080     END-IF.                                                      19108036
191081     IF ASC-3RD-UNITS > ZERO AND ASC-TOT-UNITS > ZERO             19108197
191082         DIVIDE ASC-3RD-UNITS BY ASC-TOT-UNITS                    19108236
191083             GIVING PV-DIVIDEND ROUNDED                           19108377
191084         MULTIPLY PV-DIVIDEND BY 100                              19108436
191085             GIVING ASC-3RD-PCT                                   19108536
191086         IF ASC-3RD-PCT = ZERO                                    19108636
191087             MOVE .1 TO  ASC-3RD-PCT                              19108736
191088         END-IF                                                   19108836
191089     ELSE                                                         19108936
191090         MOVE ZEROS TO  ASC-3RD-PCT                               19109036
191091     END-IF.                                                      19109136
191092                                                                  19109236
191093*----------------------------------------------------------------*19109336
191100*   GET WEEK INFORMATION FROM TDTATTR                             19110028
191200*----------------------------------------------------------------*19120028
191300 4007-GET-WEEK-INFO.                                              19130028
191400     EXEC SQL                                                     19140028
191500          SELECT DISTINCT (FSCL_WK_BEG_DTE)                       19150028
191600                 ,FSCL_WK_END_DTE                                 19160028
191700            INTO  :DTATTR-FSCL-WK-BEG-DTE                         19170028
191800                 ,:DTATTR-FSCL-WK-END-DTE                         19180028
191900            FROM  TDTATTR                                         19190028
192000           WHERE  FSCL_YR_NBR   =  :DK-FISCAL-YEAR                19200028
192100             AND  FSCL_WK_NBR   =  :DK-FISCAL-WK                  19210028
192200     END-EXEC.                                                    19220028
192300                                                                  19230028
192400     EVALUATE TRUE                                                19240028
192500         WHEN SQLCODE = +0                                        19250028
192600             MOVE DTATTR-FSCL-WK-BEG-DTE TO  DK-FROM-DATE         19260081
192800             MOVE DTATTR-FSCL-WK-END-DTE TO  DK-TO-DATE           19280081
193000         WHEN OTHER                                               19300028
193100             MOVE SPACES                 TO  ASC-FROM-DATE        19310028
193200                                             ASC-TO-DATE          19320028
193300                                             DK-FROM-DATE         19330028
193400                                             DK-TO-DATE           19340028
193500     END-EVALUATE.                                                19350028
193600                                                                  19360028
193700*----------------------------------------------------------------*19370028
193800*   GET MONTH INFORMATION FROM TDTATTR                            19380028
193900*----------------------------------------------------------------*19390028
194000 4008-GET-MONTH-INFO.                                             19400028
194100     EXEC SQL                                                     19410028
194200          SELECT DISTINCT (FSCL_MN_BEG_DTE)                       19420028
194300                 ,FSCL_MN_END_DTE                                 19430028
194400            INTO  :DTATTR-FSCL-MN-BEG-DTE                         19440028
194500                 ,:DTATTR-FSCL-MN-END-DTE                         19450028
194600            FROM  TDTATTR                                         19460028
194700           WHERE  FSCL_YR_NBR   =  :DK-FISCAL-YR                  19470028
194800             AND  FSCL_MN_NBR   =  :DK-FISCAL-MN                  19480028
194900     END-EXEC.                                                    19490028
195000                                                                  19500028
195100     EVALUATE TRUE                                                19510028
195200         WHEN SQLCODE = +0                                        19520028
195300             MOVE DTATTR-FSCL-MN-BEG-DTE TO  DK-FROM-DATE         19530081
195500             MOVE DTATTR-FSCL-MN-END-DTE TO  DK-TO-DATE           19550081
195700         WHEN OTHER                                               19570028
195800             MOVE SPACES                 TO  ASC-FROM-DATE        19580028
195900                                             ASC-TO-DATE          19590028
196000                                             DK-FROM-DATE         19600028
196100                                             DK-TO-DATE           19610028
196200     END-EVALUATE.                                                19620028
196300                                                                  19630028
196400*----------------------------------------------------------------*19640028
196500* OPEN THE CURSOR                                                 19650002
196600*----------------------------------------------------------------*19660002
196700 4010-OPEN-CURSOR.                                                19670002
196800     PERFORM                                                      19680002
196900         WITH TEST AFTER                                          19690002
197000         VARYING PV-RETRY-COUNTER                                 19700002
197100         FROM 1 BY 1                                              19710002
197200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19720002
197300                   OR (SQLCODE = ZERO))                           19730002
197400                                                                  19740002
197500         EVALUATE TRUE                                            19750036
197600             WHEN PS-PROCESS-AREA-CSR                             19760036
197700                 EXEC SQL                                         19770036
197800                      OPEN PROCESS-AREA-CSR                       19780036
197900                 END-EXEC                                         19790036
198000             WHEN PS-UK-OPER-AREA-CSR                             19800036
198100                 EXEC SQL                                         19810036
198200                      OPEN UK-OPER-AREA-CSR                       19820036
198300                 END-EXEC                                         19830036
198310             WHEN PS-PROCESS-GROUP-CSR                            19831046
198320                 EXEC SQL                                         19832046
198330                      OPEN PROCESS-GROUP-CSR                      19833046
198340                 END-EXEC                                         19834046
198350             WHEN PS-UK-OPER-GROUP-CSR                            19835046
198360                 EXEC SQL                                         19836046
198370                      OPEN UK-OPER-GROUP-CSR                      19837046
198380                 END-EXEC                                         19838046
198390             WHEN PS-PRCSS-GRP-MSC-CSR                            19839082
198391                 EXEC SQL                                         19839182
198392                      OPEN PRCSS-GRP-MSC-CSR                      19839282
198393                 END-EXEC                                         19839382
198394             WHEN PS-UK-OPR-GRP-MSC-CSR                           19839482
198395                 EXEC SQL                                         19839582
198396                      OPEN UK-OPR-GRP-MSC-CSR                     19839682
198397                 END-EXEC                                         19839782
198400         END-EVALUATE                                             19840036
198500                                                                  19850036
198600         EVALUATE TRUE                                            19860002
198700             WHEN SQLCODE = ZERO                                  19870002
198800             WHEN SQLCODE = -904                                  19880002
198900             WHEN SQLCODE = -913                                  19890002
199000                 CONTINUE                                         19900002
199100             WHEN SQLWARN0 NOT = SPACES                           19910002
199200             WHEN SQLCODE < ZERO                                  19920002
199300             WHEN SQLCODE > ZERO                                  19930002
199400                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       19940002
199500                 MOVE 'OPEN CURSOR PROBLEM    - '                 19950002
199600                                   TO DP013-MESSAGE-TEXT (1)      19960002
199700                 MOVE SQLCA        TO DP013-SQLCA                 19970002
199800                 MOVE 'PCT_PRC_AREA_ASSN' TO                      19980010
199900                                    DP013-DB2-TABLE-NAME (1)      19990010
200000                 SET DP013-DB2-ABEND                              20000002
200100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           20010002
200200                 PERFORM DP013-0000-PROCESS-ABEND                 20020002
200300         END-EVALUATE                                             20030002
200400     END-PERFORM.                                                 20040002
200500*                                                                 20050002
200600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20060002
200700         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             20070002
200800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   20080002
200900                                   TO DP013-MESSAGE-TEXT (1)      20090002
201000         MOVE SQLCA                TO DP013-SQLCA                 20100002
201100         MOVE 'PCT_PRC_AREA_ASSN'  TO DP013-DB2-TABLE-NAME (1)    20110010
201200         SET DP013-DB2-ABEND                                      20120002
201300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   20130002
201400         PERFORM DP013-0000-PROCESS-ABEND                         20140002
201500     END-IF.                                                      20150002
201600                                                                  20160002
201700*----------------------------------------------------------------*20170002
201800* CLOSE THE CURSOR.                                               20180002
201900*----------------------------------------------------------------*20190002
202000 4020-CLOSE-CURSOR.                                               20200002
202100                                                                  20210002
202200     EVALUATE TRUE                                                20220036
202300         WHEN PS-PROCESS-AREA-CSR                                 20230036
202400             EXEC SQL                                             20240036
202500                CLOSE PROCESS-AREA-CSR                            20250036
202600             END-EXEC                                             20260036
202700         WHEN PS-UK-OPER-AREA-CSR                                 20270036
202800             EXEC SQL                                             20280036
202900                CLOSE UK-OPER-AREA-CSR                            20290036
203000             END-EXEC                                             20300036
203010         WHEN PS-PROCESS-GROUP-CSR                                20301046
203020             EXEC SQL                                             20302046
203030                CLOSE PROCESS-GROUP-CSR                           20303046
203040             END-EXEC                                             20304046
203050         WHEN PS-UK-OPER-GROUP-CSR                                20305046
203060             EXEC SQL                                             20306046
203070                CLOSE UK-OPER-GROUP-CSR                           20307046
203080             END-EXEC                                             20308046
203090         WHEN PS-PRCSS-GRP-MSC-CSR                                20309082
203091             EXEC SQL                                             20309182
203092                CLOSE PRCSS-GRP-MSC-CSR                           20309282
203093             END-EXEC                                             20309382
203094         WHEN PS-UK-OPR-GRP-MSC-CSR                               20309482
203095             EXEC SQL                                             20309582
203096                CLOSE UK-OPR-GRP-MSC-CSR                          20309682
203097             END-EXEC                                             20309782
203100     END-EVALUATE                                                 20310036
203300                                                                  20330002
203400     EVALUATE TRUE                                                20340002
203500         WHEN SQLCODE = ZERO                                      20350002
203600         WHEN SQLCODE = +100                                      20360002
203700             CONTINUE                                             20370002
203800         WHEN SQLWARN0 NOT = SPACES                               20380002
203900         WHEN SQLCODE < ZERO                                      20390002
204000         WHEN SQLCODE > ZERO                                      20400002
204100             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          20410002
204200             MOVE 'CLOSE CURSOR PROBLEM   '                       20420002
204300                               TO DP013-MESSAGE-TEXT (1)          20430002
204400             MOVE SQLCA        TO DP013-SQLCA                     20440002
204500             MOVE 'PCT_PRC_AREA_ASSN' TO DP013-DB2-TABLE-NAME (1) 20450010
204600             SET DP013-DB2-ABEND                                  20460002
204700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20470002
204800             PERFORM DP013-0000-PROCESS-ABEND                     20480002
204900     END-EVALUATE.                                                20490002
205000                                                                  20500002
205100*----------------------------------------------------------------*20510036
205200*    PICK CORRECT CURSOR                                         *20520036
205300*----------------------------------------------------------------*20530036
205400 4100-PREPARE-CURSOR.                                             20540036
205500     MOVE SPACE TO PS-CURSOR-SW.                                  20550036
205600     IF PC215-GROUP (PC215-IDX) > SPACES                          20560050
205601         MOVE PC215-GROUP (PC215-IDX) TO DK-PROCESS-GROUP         20560150
205610         IF DK-PROCESS-GROUP = 'MISC  '                           20561082
205810             IF ASC-OPER-NBR > ZERO                               20581082
205820                 SET PS-PRCSS-GRP-MSC-CSR TO TRUE                 20582082
205821             ELSE                                                 20582182
205822                 SET PS-UK-OPR-GRP-MSC-CSR TO TRUE                20582282
205823             END-IF                                               20582382
205824         ELSE                                                     20582482
205825             IF ASC-OPER-NBR > ZERO                               20582583
205826                 SET PS-PROCESS-GROUP-CSR TO TRUE                 20582683
205830             ELSE                                                 20583083
205900                 SET PS-UK-OPER-GROUP-CSR TO TRUE                 20590083
206000             END-IF                                               20600083
206001         END-IF                                                   20600183
206002     ELSE                                                         20600283
206010         IF ASC-OPER-NBR > ZERO                                   20601046
206020             SET PS-PROCESS-AREA-CSR TO TRUE                      20602046
206030         ELSE                                                     20603046
206040             SET PS-UK-OPER-AREA-CSR TO TRUE                      20604046
206050         END-IF                                                   20605046
206060     END-IF.                                                      20606046
206100                                                                  20610036
206200*----------------------------------------------------------------*20620010
206300* RETRIEVE REMAINING INFORMATION FROM PCT_SUM_WRKD                20630010
206400*----------------------------------------------------------------*20640010
206500 4200-GET-NEXT-CSR.                                               20650010
206600     INITIALIZE  PV-TOT-UNITS                                     20660092
206700                 PV-1ST-UNITS                                     20670092
206800                 PV-2ND-UNITS                                     20680092
206900                 PV-3RD-UNITS.                                    20690092
206910                                                                  20691092
207000     PERFORM 4205-PREPARE-CURSOR.                                 20700036
207100     PERFORM 4210-OPEN-CURSOR.                                    20710010
207200     PERFORM 4220-READ-ITEMS-FROM-DB.                             20720010
207300     SET ASC-ITEMS-LEFT-ON-DB TO TRUE.                            20730010
207400     PERFORM 4230-CLOSE-CURSOR.                                   20740010
207500                                                                  20750010
207600*----------------------------------------------------------------*20760036
207700*    SET UP THE CORRECT CURSOR.                                   20770036
207800*----------------------------------------------------------------*20780036
207900 4205-PREPARE-CURSOR.                                             20790036
208000     MOVE SPACE TO PS-CURSOR-SW2.                                 20800039
208100     EVALUATE TRUE                                                20810091
208110         WHEN PS-PROCESS-AREA-CSR                                 20811090
208200             SET PS-UNITS-BY-OPER-CSR TO TRUE                     20820090
208310         WHEN PS-UK-OPER-AREA-CSR                                 20831090
208400             SET PS-UNITS-BY-AREA-CSR TO TRUE                     20840090
208501          WHEN PS-PROCESS-GROUP-CSR                               20850190
208502             SET PS-UNT-BY-AREA-GRP-OP TO TRUE                    20850290
208505          WHEN PS-UK-OPER-GROUP-CSR                               20850590
208506             SET PS-UNT-BY-AREA-GRP-CR TO TRUE                    20850690
208507          WHEN PS-PRCSS-GRP-MSC-CSR                               20850790
208508             SET PS-UNT-BY-AREA-MSC-OP TO TRUE                    20850890
208509          WHEN PS-UK-OPR-GRP-MSC-CSR                              20850990
208510             SET PS-UNT-BY-AREA-MSC-CR TO TRUE                    20851090
208520     END-EVALUATE.                                                20852090
208600                                                                  20860036
208700*----------------------------------------------------------------*20870010
208800* OPEN THE CURSOR                                                 20880010
208900*   IN THIS PARTICULAR PARAGRAPH TWO CURSORS WILL BE              20890036
209000*   OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE             20900010
209100*   USER.                                                        *20910010
209200*----------------------------------------------------------------*20920010
209300 4210-OPEN-CURSOR.                                                20930010
209400     EVALUATE TRUE                                                20940036
209500         WHEN PS-UNITS-BY-OPER-CSR                                20950036
209600             EXEC SQL                                             20960036
209700                  OPEN UNITS-BY-OPER-CSR                          20970036
209800             END-EXEC                                             20980036
209900         WHEN PS-UNITS-BY-AREA-CSR                                20990036
210000             EXEC SQL                                             21000036
210100                  OPEN UNITS-BY-AREA-CSR                          21010036
210200             END-EXEC                                             21020036
210210         WHEN PS-UNT-BY-AREA-GRP-OP                               21021090
210220             EXEC SQL                                             21022090
210230                  OPEN UNT-BY-AREA-GRP-OP                         21023090
210240             END-EXEC                                             21024090
210250         WHEN PS-UNT-BY-AREA-GRP-CR                               21025090
210260             EXEC SQL                                             21026090
210270                  OPEN UNT-BY-AREA-GRP-CR                         21027090
210280             END-EXEC                                             21028090
210290         WHEN PS-UNT-BY-AREA-MSC-OP                               21029090
210291             EXEC SQL                                             21029190
210292                  OPEN UNT-BY-AREA-MSC-OP                         21029290
210293             END-EXEC                                             21029390
210294         WHEN PS-UNT-BY-AREA-MSC-CR                               21029490
210295             EXEC SQL                                             21029590
210296                  OPEN UNT-BY-AREA-MSC-CR                         21029690
210297             END-EXEC                                             21029790
210300     END-EVALUATE.                                                21030036
210500                                                                  21050010
210600     EVALUATE TRUE                                                21060010
210700         WHEN SQLCODE = ZERO                                      21070010
210800         WHEN SQLCODE = -904                                      21080010
210900         WHEN SQLCODE = -913                                      21090010
211000             CONTINUE                                             21100010
211100         WHEN SQLWARN0 NOT = SPACES                               21110010
211200         WHEN SQLCODE < ZERO                                      21120010
211300         WHEN SQLCODE > ZERO                                      21130010
211400             MOVE '4210-OPEN-CURSOR' TO DP013-PARAGRAPH           21140010
211500             MOVE 'OPEN CURSOR PROBLEM - '                        21150010
211600                               TO DP013-MESSAGE-TEXT (1)          21160010
211700             MOVE SQLCA        TO DP013-SQLCA                     21170010
211800             MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1)      21180010
211900             SET DP013-DB2-ABEND                                  21190010
212000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21200010
212100             PERFORM DP013-0000-PROCESS-ABEND                     21210010
212200     END-EVALUATE.                                                21220010
212300*                                                                 21230010
212400*----------------------------------------------------------------*21240010
212500*    READ ITEMS FROM THE PCT_SUM_WRKD TABLE                       21250010
212600*----------------------------------------------------------------*21260010
212700 4220-READ-ITEMS-FROM-DB.                                         21270010
212800                                                                  21280010
212900     PERFORM                                                      21290010
213000         VARYING PV-READ-COUNT                                    21300010
213100         FROM 1 BY 1                                              21310010
213200         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    21320010
213300            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         21330010
213400                                                                  21340010
213500         PERFORM 4225-FETCH                                       21350010
213600                                                                  21360010
213700         IF  ASC-ITEMS-LEFT-ON-DB                                 21370010
213800             EVALUATE PCT00005-SHFT-NBR                           21380086
213900                 WHEN 1                                           21390086
214000                    MOVE PCT00005-UNT-WRKD-QTY TO PV-1ST-UNITS    21400086
214100                 WHEN 2                                           21410086
214200                    MOVE PCT00005-UNT-WRKD-QTY TO PV-2ND-UNITS    21420086
214300                 WHEN 3                                           21430086
214400                    MOVE PCT00005-UNT-WRKD-QTY TO PV-3RD-UNITS    21440086
214500             END-EVALUATE                                         21450086
214600             ADD  PCT00005-UNT-WRKD-QTY  TO  PV-TOT-UNITS         21460086
214710         END-IF                                                   21471086
214800     END-PERFORM.                                                 21480010
214900                                                                  21490010
215000*----------------------------------------------------------------*21500010
215100*    FETCH THE CURSOR                                             21510010
215200*----------------------------------------------------------------*21520010
215300 4225-FETCH.                                                      21530010
215310     EVALUATE TRUE                                                21531036
215320         WHEN PS-UNITS-BY-OPER-CSR                                21532036
215330             EXEC SQL                                             21533036
215340                 FETCH UNITS-BY-OPER-CSR                          21534036
215341                 INTO  :PCT00005-UNT-WRKD-QTY                     21534136
215342                      ,:PCT00005-SHFT-NBR                         21534236
215344                      ,:PCT00005-PRCG-AREA-CDE                    21534436
215350             END-EXEC                                             21535036
215360         WHEN PS-UNITS-BY-AREA-CSR                                21536036
215370             EXEC SQL                                             21537036
215371                 FETCH UNITS-BY-AREA-CSR                          21537136
215372                 INTO  :PCT00005-UNT-WRKD-QTY                     21537236
215373                      ,:PCT00005-SHFT-NBR                         21537336
215374                      ,:PCT00005-PRCG-AREA-CDE                    21537436
215390             END-EXEC                                             21539036
215391         WHEN PS-UNT-BY-AREA-GRP-OP                               21539190
215392             EXEC SQL                                             21539290
215393                 FETCH UNT-BY-AREA-GRP-OP                         21539390
215394                 INTO  :PCT00005-UNT-WRKD-QTY                     21539490
215395                      ,:PCT00005-SHFT-NBR                         21539590
215396                      ,:PCT00005-PRCG-AREA-CDE                    21539690
215397             END-EXEC                                             21539790
215398         WHEN PS-UNT-BY-AREA-GRP-CR                               21539890
215399             EXEC SQL                                             21539990
215400                 FETCH UNT-BY-AREA-GRP-CR                         21540090
215410                 INTO  :PCT00005-UNT-WRKD-QTY                     21541090
215420                      ,:PCT00005-SHFT-NBR                         21542090
215430                      ,:PCT00005-PRCG-AREA-CDE                    21543090
215440             END-EXEC                                             21544090
215450         WHEN PS-UNT-BY-AREA-MSC-OP                               21545090
215460             EXEC SQL                                             21546090
215470                 FETCH UNT-BY-AREA-MSC-OP                         21547090
215480                 INTO  :PCT00005-UNT-WRKD-QTY                     21548090
215490                      ,:PCT00005-SHFT-NBR                         21549090
215491                      ,:PCT00005-PRCG-AREA-CDE                    21549190
215492             END-EXEC                                             21549290
215493         WHEN PS-UNT-BY-AREA-MSC-CR                               21549390
215494             EXEC SQL                                             21549490
215495                 FETCH UNT-BY-AREA-MSC-CR                         21549590
215496                 INTO  :PCT00005-UNT-WRKD-QTY                     21549690
215497                      ,:PCT00005-SHFT-NBR                         21549790
215498                      ,:PCT00005-PRCG-AREA-CDE                    21549890
215499             END-EXEC                                             21549990
215500     END-EVALUATE.                                                21550090
216000                                                                  21600010
216100     EVALUATE TRUE                                                21610010
216200         WHEN SQLCODE = ZERO                                      21620010
216300         WHEN SQLCODE = +100                                      21630010
216410             CONTINUE                                             21641087
216500         WHEN SQLWARN0 NOT = SPACE                                21650010
216600         WHEN SQLCODE NOT = ZERO                                  21660010
216700              MOVE '4225-FETCH-CURSOR' TO DP013-PARAGRAPH         21670010
216800              MOVE 'FETCH CURSOR PROBLEM '                        21680010
216900                               TO DP013-MESSAGE-TEXT (1)          21690010
217000              MOVE SQLCA       TO DP013-SQLCA                     21700010
217100              MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1)     21710010
217200              SET DP013-DB2-ABEND TO TRUE                         21720010
217300              PERFORM DP013-0000-PROCESS-ABEND                    21730010
217400     END-EVALUATE.                                                21740010
217500                                                                  21750010
217600     IF  SQLCODE EQUAL +100                                       21760010
217700         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      21770010
217800     END-IF.                                                      21780010
217900                                                                  21790010
218000*----------------------------------------------------------------*21800010
218100* CLOSE THE CURSOR.                                               21810010
218200*   IN THIS PARTICULAR APPLICATION ONE OF 2 DIFFERENT CURSORS    *21820010
218300*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *21830010
218400*   USER.                                                        *21840010
218500*----------------------------------------------------------------*21850010
218600 4230-CLOSE-CURSOR.                                               21860010
218610     EVALUATE TRUE                                                21861037
218620         WHEN PS-UNITS-BY-OPER-CSR                                21862037
218630             EXEC SQL                                             21863037
218640                 CLOSE UNITS-BY-OPER-CSR                          21864037
218650             END-EXEC                                             21865037
218660         WHEN PS-UNITS-BY-AREA-CSR                                21866037
218670             EXEC SQL                                             21867037
218680                 CLOSE UNITS-BY-AREA-CSR                          21868079
218690             END-EXEC                                             21869037
218691         WHEN PS-UNT-BY-AREA-GRP-OP                               21869190
218692             EXEC SQL                                             21869290
218693                 CLOSE UNT-BY-AREA-GRP-OP                         21869390
218694             END-EXEC                                             21869490
218695         WHEN PS-UNT-BY-AREA-GRP-CR                               21869590
218696             EXEC SQL                                             21869690
218697                 CLOSE UNT-BY-AREA-GRP-CR                         21869790
218698             END-EXEC                                             21869890
218699         WHEN PS-UNT-BY-AREA-MSC-OP                               21869990
218700             EXEC SQL                                             21870090
218710                 CLOSE UNT-BY-AREA-MSC-OP                         21871090
218720             END-EXEC                                             21872090
218730         WHEN PS-UNT-BY-AREA-MSC-CR                               21873090
218740             EXEC SQL                                             21874090
218750                 CLOSE UNT-BY-AREA-MSC-CR                         21875090
218760             END-EXEC                                             21876090
218800     END-EVALUATE.                                                21880090
219000                                                                  21900010
219100     EVALUATE TRUE                                                21910010
219200         WHEN SQLCODE = ZERO                                      21920010
219300         WHEN SQLCODE = +100                                      21930010
219400             CONTINUE                                             21940010
219500         WHEN SQLWARN0 NOT = SPACES                               21950010
219600         WHEN SQLCODE < ZERO                                      21960010
219700         WHEN SQLCODE > ZERO                                      21970010
219800             MOVE '4230-CLOSE-CURSOR' TO DP013-PARAGRAPH          21980010
219900             MOVE 'CLOSE CURSOR PROBLEM   '                       21990010
220000                               TO DP013-MESSAGE-TEXT (1)          22000010
220100             MOVE SQLCA        TO DP013-SQLCA                     22010010
220200             MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1)      22020010
220300             SET DP013-DB2-ABEND                                  22030010
220400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               22040010
220500             PERFORM DP013-0000-PROCESS-ABEND                     22050010
220600     END-EVALUATE.                                                22060010
220700                                                                  22070010
220800*----------------------------------------------------------------*22080010
220900*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *22090002
221000*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *22100002
221100*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *22110002
221200*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *22120002
221300*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *22130002
221400*                                                                *22140002
221500*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *22150002
221600*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *22160002
221700*    UPON INITIALIZATION.                                        *22170002
221800*----------------------------------------------------------------*22180002
221900 4300-READ-ITEMS-FROM-DB.                                         22190002
222000                                                                  22200002
222100     PERFORM                                                      22210002
222200         VARYING PV-READ-COUNT                                    22220002
222300         FROM 1 BY 1                                              22230002
222400         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    22240002
222500            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         22250002
222600                                                                  22260002
222700         PERFORM 4310-FETCH                                       22270002
222800                                                                  22280002
222900         IF  PV-TOT-UNITS NOT = ZEROS                             22290071
223000             IF  ASC-ITEMS-LEFT-ON-DB                             22300027
223100                 IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL            22310027
223200                     ADD +1            TO ASC-ITEM-SUB            22320027
223300                 ELSE                                             22330027
223400                     ADD +1            TO ASC-BLK-SUB             22340027
223500                     MOVE +1           TO ASC-ITEM-SUB            22350027
223600                                                                  22360002
223700                     IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY     22370027
223800                         MOVE +1       TO ASC-BLK-SUB             22380027
223900                         SET ASC-BLOCK-MODIFIED (1) TO TRUE       22390027
224000                         PERFORM 5100-WRITE-TEMP-STORAGE          22400027
224100                         MOVE ASC-BLOCK-ENTRIES                   22410027
224200                                         (PC-MAX-BLOCKS-IN-ARRAY) 22420027
224300                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 22430002
224400                         ADD +1        TO ASC-BLK-SUB             22440027
224500                       INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB) 22450027
224600                         SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)  22460027
224700                                                          TO TRUE 22470002
224800                     END-IF                                       22480027
224900                 END-IF                                           22490027
225000                 ADD +1   TO ASC-NUMBER-OF-ITEMS-READ             22500026
225100                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE      22510026
225200                 MOVE ASC-NUMBER-OF-ITEMS-READ                    22520026
225300                                   TO ASC-LIST-ITEM-NUMBER        22530026
225400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22540026
225500                 MOVE PCT00005-PRCG-AREA-CDE TO                   22550026
225600                             ASC-AREA (ASC-BLK-SUB ASC-ITEM-SUB)  22560026
225700                 MOVE PV-1ST-UNITS                                22570026
225800                        TO ASC-1STUNITS (ASC-BLK-SUB ASC-ITEM-SUB)22580010
225900                 MOVE PV-2ND-UNITS                                22590026
226000                        TO ASC-2NDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)22600010
226100                 MOVE PV-3RD-UNITS                                22610026
226200                        TO ASC-3RDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)22620010
226300                 MOVE PV-TOT-UNITS                                22630026
226400                        TO ASC-TOTUNITS (ASC-BLK-SUB ASC-ITEM-SUB)22640010
226500                 IF PV-1ST-UNITS > ZERO AND PV-TOT-UNITS > ZERO   22650097
226600                     DIVIDE PV-1ST-UNITS BY PV-TOT-UNITS          22660026
226700                         GIVING PV-DIVIDEND ROUNDED               22670077
226800                     MULTIPLY PV-DIVIDEND BY 100                  22680026
226900                         GIVING PV-1ST-PCT                        22690026
227000                     IF PV-1ST-PCT = ZERO                         22700026
227100                         MOVE .1     TO PV-1ST-PCT                22710026
227200                     END-IF                                       22720026
227300                 ELSE                                             22730026
227400                     MOVE ZEROES TO PV-1ST-UNITS                  22740026
227500                                    PV-1ST-PCT                    22750026
227600                 END-IF                                           22760026
227700                 IF PV-2ND-UNITS > ZERO AND PV-TOT-UNITS > ZERO   22770097
227800                     DIVIDE PV-2ND-UNITS BY PV-TOT-UNITS          22780026
227900                         GIVING PV-DIVIDEND ROUNDED               22790077
228000                     MULTIPLY PV-DIVIDEND BY 100                  22800026
228100                         GIVING PV-2ND-PCT                        22810026
228200                     IF PV-2ND-PCT = ZERO                         22820026
228300                         MOVE .1     TO PV-2ND-PCT                22830026
228400                     END-IF                                       22840026
228500                 ELSE                                             22850026
228600                     MOVE ZEROES TO PV-2ND-UNITS                  22860026
228700                                    PV-2ND-PCT                    22870026
228800                 END-IF                                           22880026
228900                 IF PV-3RD-UNITS > ZERO AND PV-TOT-UNITS > ZERO   22890097
229000                     DIVIDE PV-3RD-UNITS BY PV-TOT-UNITS          22900026
229100                         GIVING PV-DIVIDEND ROUNDED               22910077
229200                     MULTIPLY PV-DIVIDEND BY 100                  22920026
229300                         GIVING PV-3RD-PCT                        22930026
229400                     IF PV-3RD-PCT = ZERO                         22940026
229500                         MOVE .1     TO PV-3RD-PCT                22950026
229600                     END-IF                                       22960026
229700                 ELSE                                             22970026
229800                     MOVE ZEROES TO PV-3RD-UNITS                  22980026
229900                                    PV-3RD-PCT                    22990026
230000                 END-IF                                           23000026
230100                 IF PV-TOT-UNITS > ZERO AND ASC-TOT-UNITS > ZERO  23010097
230200                     DIVIDE PV-TOT-UNITS BY ASC-TOT-UNITS         23020026
230300                         GIVING PV-DIVIDEND ROUNDED               23030077
230400                     MULTIPLY PV-DIVIDEND BY 100                  23040026
230500                         GIVING PV-TOT-PCT                        23050026
230600                     IF PV-TOT-PCT = ZERO                         23060026
230700                         MOVE .1     TO PV-TOT-PCT                23070026
230800                     END-IF                                       23080026
230900                 ELSE                                             23090026
231000                     MOVE ZEROES TO PV-TOT-PCT                    23100026
231100                                    PV-TOT-UNITS                  23110026
231200                 END-IF                                           23120026
231300                 MOVE PV-1ST-PCT                                  23130026
231400                          TO ASC-1STPCT (ASC-BLK-SUB ASC-ITEM-SUB)23140010
231500                 MOVE PV-2ND-PCT                                  23150026
231600                          TO ASC-2NDPCT (ASC-BLK-SUB ASC-ITEM-SUB)23160010
231700                 MOVE PV-3RD-PCT                                  23170026
231800                          TO ASC-3RDPCT (ASC-BLK-SUB ASC-ITEM-SUB)23180010
231900                 MOVE PV-TOT-PCT                                  23190026
232000                          TO ASC-TOTPCT (ASC-BLK-SUB ASC-ITEM-SUB)23200010
232100             END-IF                                               23210026
232200         END-IF                                                   23220026
232300     END-PERFORM.                                                 23230026
232400                                                                  23240026
232500     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          23250002
232600         MOVE +1               TO ASC-BLK-SUB                     23260002
232700         PERFORM 5100-WRITE-TEMP-STORAGE                          23270002
232800         ADD +1                TO ASC-BLK-SUB                     23280002
232900         PERFORM 5100-WRITE-TEMP-STORAGE                          23290002
233000                                                                  23300002
233100         MOVE 1                TO ASC-BLK-SUB                     23310002
233200                                  PV-BLOCK-NUMBER                 23320002
233300         PERFORM 4410-READ-TEMP-STORAGE                           23330002
233400         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             23340002
233500             MOVE 2            TO ASC-BLK-SUB                     23350002
233600                                  PV-BLOCK-NUMBER                 23360002
233700             PERFORM 4410-READ-TEMP-STORAGE                       23370002
233800         END-IF                                                   23380002
233900     END-IF.                                                      23390002
234000                                                                  23400002
234100*----------------------------------------------------------------*23410002
234200*    FETCH THE CURSOR                                             23420002
234300*----------------------------------------------------------------*23430002
234400 4310-FETCH.                                                      23440002
234500     EVALUATE TRUE                                                23450036
234600         WHEN PS-PROCESS-AREA-CSR                                 23460036
234700             EXEC SQL                                             23470036
234800                 FETCH PROCESS-AREA-CSR                           23480036
234900                 INTO  :PCT00005-PRCG-AREA-CDE                    23490078
235000             END-EXEC                                             23500036
235100         WHEN PS-UK-OPER-AREA-CSR                                 23510036
235200             EXEC SQL                                             23520036
235300                 FETCH UK-OPER-AREA-CSR                           23530036
235400                 INTO  :PCT00005-PRCG-AREA-CDE                    23540078
235500             END-EXEC                                             23550036
235510         WHEN PS-PROCESS-GROUP-CSR                                23551046
235520             EXEC SQL                                             23552046
235530                 FETCH PROCESS-GROUP-CSR                          23553046
235540                 INTO  :PCT00005-PRCG-AREA-CDE                    23554083
235550             END-EXEC                                             23555046
235560         WHEN PS-UK-OPER-GROUP-CSR                                23556046
235570             EXEC SQL                                             23557046
235580                 FETCH UK-OPER-GROUP-CSR                          23558046
235590                 INTO  :PCT00005-PRCG-AREA-CDE                    23559083
235592             END-EXEC                                             23559285
235593         WHEN PS-PRCSS-GRP-MSC-CSR                                23559385
235594             EXEC SQL                                             23559485
235595                 FETCH PRCSS-GRP-MSC-CSR                          23559585
235596                 INTO  :PCT00005-PRCG-AREA-CDE                    23559685
235597             END-EXEC                                             23559785
235598         WHEN PS-UK-OPR-GRP-MSC-CSR                               23559885
235599             EXEC SQL                                             23559985
235600                 FETCH UK-OPR-GRP-MSC-CSR                         23560085
235601                 INTO  :PCT00005-PRCG-AREA-CDE                    23560185
235603             END-EXEC                                             23560385
235610     END-EVALUATE.                                                23561083
235700                                                                  23570002
235800     EVALUATE TRUE                                                23580002
235900         WHEN SQLCODE = ZERO                                      23590002
236020              MOVE PCT00005-PRCG-AREA-CDE TO DK-PROCESS-AREA      23602083
236100              PERFORM 4200-GET-NEXT-CSR                           23610020
236200         WHEN SQLCODE = +100                                      23620002
236300              CONTINUE                                            23630002
236400         WHEN SQLWARN0 NOT = SPACE                                23640085
236500         WHEN SQLCODE NOT = ZERO                                  23650002
236600              MOVE '4310-FETCH-CURSOR' TO DP013-PARAGRAPH         23660002
236700              MOVE 'FETCH CURSOR PROBLEM '                        23670002
236800                               TO DP013-MESSAGE-TEXT (1)          23680002
236900              MOVE SQLCA       TO DP013-SQLCA                     23690002
237000              MOVE 'PCT_PRC_AREA_ASSN' TO DP013-DB2-TABLE-NAME (1)23700010
237100              SET DP013-DB2-ABEND TO TRUE                         23710002
237200              PERFORM DP013-0000-PROCESS-ABEND                    23720002
237300     END-EVALUATE.                                                23730002
237400                                                                  23740002
237500     IF  SQLCODE EQUAL +100                                       23750002
237600         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      23760002
237700     END-IF.                                                      23770002
237800                                                                  23780002
237900*----------------------------------------------------------------*23790002
238000* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *23800002
238100*----------------------------------------------------------------*23810002
238200 4400-MOVE-COMMAREA-TO-SCREEN.                                    23820002
238300     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             23830002
238400         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          23840002
238500         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          23850002
238600             MOVE +1    TO ASC-BLK-SUB                            23860002
238700             PERFORM 5100-WRITE-TEMP-STORAGE                      23870002
238800             ADD +1     TO ASC-BLK-SUB                            23880002
238900             PERFORM 5100-WRITE-TEMP-STORAGE                      23890002
239000             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             23900002
239100                 GIVING PV-BLOCK-NUMBER                           23910002
239200                 REMAINDER PV-REMAINDER                           23920002
239300             IF  PV-REMAINDER > ZERO                              23930002
239400                 ADD +1 TO PV-BLOCK-NUMBER                        23940002
239500             END-IF                                               23950002
239600             MOVE +1    TO ASC-BLK-SUB                            23960002
239700             PERFORM 4410-READ-TEMP-STORAGE                       23970002
239800             ADD +1     TO ASC-BLK-SUB                            23980002
239900                           PV-BLOCK-NUMBER                        23990002
240000             PERFORM 4410-READ-TEMP-STORAGE                       24000002
240100     END-IF.                                                      24010002
240200     MOVE +1            TO ASC-BLK-SUB.                           24020002
240300     COMPUTE ASC-ITEM-SUB =                                       24030002
240400         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              24040002
240500         + PC-ITEMS-PER-PANEL).                                   24050002
240600*                                                                 24060002
240700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        24070002
240800         ADD +1         TO ASC-BLK-SUB                            24080002
240900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            24090002
241000     END-IF.                                                      24100002
241100*                                                                 24110002
241200     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           24120002
241300         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                24130002
241400     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        24140002
241500     PERFORM 4420-FORMAT-LIST-LINES                               24150002
241600         VARYING PV-SUB                                           24160002
241700         FROM PC-ITEMS-PER-PANEL BY -1                            24170002
241800         UNTIL PV-SUB < +1.                                       24180002
241900*                                                                 24190002
242000     COMPUTE ASC-ITEMS-DISPLAYED =                                24200002
242100         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          24210002
242200     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    24220002
242300                                      ASTRTITO.                   24230002
242400     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    24240002
242500     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    24250002
242600                                                                  24260002
242700     MOVE  ASC-OPER-NBR TO     DK-OPER-UNT-ID.                    24270007
242800     EXEC SQL                                                     24280002
242900          SELECT LOC_NM                                           24290099
243000            INTO :XLT00010-LOC-NM                                 24300099
243100            FROM XLT_LOC                                          24310099
243200          WHERE LOC_NBR  =  :DK-OPER-UNT-ID                       24320099
243300      END-EXEC.                                                   24330002
243400                                                                  24340002
243500      EVALUATE TRUE                                               24350002
243600          WHEN SQLCODE = +0                                       24360002
243700               MOVE XLT00010-LOC-NM    TO ASC-OPER-DESC           24370099
243800          WHEN OTHER                                              24380002
243900               MOVE SPACES             TO ASC-OPER-DESC           24390008
244000      END-EVALUATE.                                               24400002
244100                                                                  24410002
244200     MOVE ASC-OPER-NBR         TO  AOPERO.                        24420008
244210     IF ASC-OPER-NBR = ZEROS OR ASC-OPER-NBR-X = SPACES           24421052
244300         MOVE 'CORPORATE SUMMARY'  TO  ADESCO                     24430040
244301     ELSE                                                         24430140
244310         MOVE ASC-OPER-DESC        TO  ADESCO                     24431040
244320     END-IF.                                                      24432040
244400     MOVE ASC-3RD-UNITS        TO  DK-NUMBER-FORMAT.              24440099
244410     MOVE DK-NUMBER-FORMAT     TO  A3TOTLO.                       24441099
244500     MOVE ASC-3RD-PCT          TO  DK-NUMBER.                     24450008
244600     MOVE DK-PERCENT-FORMAT    TO  A3PRCTO.                       24460008
244700     MOVE ASC-1ST-UNITS        TO  DK-NUMBER-FORMAT.              24470099
244710     MOVE DK-NUMBER-FORMAT     TO  A1TOTLO.                       24471099
244800     MOVE ASC-1ST-PCT          TO  DK-NUMBER.                     24480008
244900     MOVE DK-PERCENT-FORMAT    TO  A1PRCTO.                       24490008
245000     MOVE ASC-2ND-UNITS        TO  DK-NUMBER-FORMAT.              24500099
245010     MOVE DK-NUMBER-FORMAT     TO  A2TOTLO.                       24501099
245100     MOVE ASC-2ND-PCT          TO  DK-NUMBER.                     24510008
245200     MOVE DK-PERCENT-FORMAT    TO  A2PRCTO.                       24520008
245300     MOVE ASC-TOT-UNITS        TO  DK-NUMBER-FORMAT.              24530099
245310     MOVE DK-NUMBER-FORMAT     TO  ATTOTLO.                       24531099
245400     MOVE ASC-DISPLAY-DATE     TO  ADATEO.                        24540028
245500                                                                  24550003
245600     IF  DP020-MSG-NUMBER-X = SPACE                               24560002
245700         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  24570002
245800*            --- MORE ITEMS TO DISPLAY ----                       24580002
245900             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            24590002
246000             SET DP020-MSG-INFORMATIONAL TO TRUE                  24600002
246100         END-IF                                                   24610002
246200     END-IF.                                                      24620002
246300                                                                  24630002
246400*----------------------------------------------------------------*24640002
246500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *24650002
246600*----------------------------------------------------------------*24660002
246700 4410-READ-TEMP-STORAGE.                                          24670002
246800                                                                  24680002
246900     EXEC CICS                                                    24690002
247000         READQ TS                                                 24700002
247100             QUEUE (ASC-LIST-QUEUE-NAME)                          24710002
247200             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               24720002
247300             ITEM  (PV-BLOCK-NUMBER)                              24730002
247400             RESP  (PV-CICS-RESP)                                 24740002
247500     END-EXEC.                                                    24750002
247600                                                                  24760002
247700     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       24770002
247800       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     24780002
247900         CONTINUE                                                 24790002
248000     ELSE                                                         24800002
248100         SET DP013-CICS-ABEND     TO TRUE                         24810002
248200         SET DP013-NO-ROLLBACK    TO TRUE                         24820002
248300         MOVE '4410-READ-TEMP-STORAGE'                            24830002
248400                                  TO DP013-PARAGRAPH              24840002
248500         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      24850002
248600                                  TO DP013-MESSAGE-TEXT(1)        24860002
248700         PERFORM DP013-0000-PROCESS-ABEND                         24870002
248800     END-IF.                                                      24880002
248900                                                                  24890002
249000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             24900002
249100*                                                                 24910002
249200     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         24920002
249300         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               24930002
249400     END-IF.                                                      24940002
249500                                                                  24950002
249600*----------------------------------------------------------------*24960002
249700*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *24970002
249800*----------------------------------------------------------------*24980002
249900 4420-FORMAT-LIST-LINES.                                          24990002
250000     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      25000002
250100         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                25010002
250200         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           25020003
250300         MOVE DP015-HL-OFF       TO MR-SELECTH  (PV-SUB)          25030003
250400         MOVE SPACE              TO MR-SELECTI  (PV-SUB)          25040003
250500                                    MR-AREA     (PV-SUB)          25050003
250600                                    MR-3RD-UNITS(PV-SUB)          25060003
250700                                    MR-3RD-PCT  (PV-SUB)          25070003
250800                                    MR-1ST-UNITS(PV-SUB)          25080003
250900                                    MR-1ST-PCT  (PV-SUB)          25090003
251000                                    MR-2ND-UNITS(PV-SUB)          25100003
251100                                    MR-2ND-PCT  (PV-SUB)          25110003
251200                                    MR-TOT-UNITS(PV-SUB)          25120003
251300                                    MR-TOT-PCT  (PV-SUB)          25130003
251400     ELSE                                                         25140002
251500         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      25150004
251600                                                   > SPACE        25160004
251700             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 25170004
251800                                 TO MR-SELECTI (PV-SUB)           25180004
251900         ELSE                                                     25190004
252000             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      25200004
252100                                 TO MR-SELECTI (PV-SUB)           25210004
252200         END-IF                                                   25220004
252300         IF  DP030-SET-CURSOR-TRAILER                             25230002
252400             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)25240002
252500                 > SPACE)                                         25250002
252600               OR (PV-SUB = 1))                                   25260002
252700                SET DP030-SET-CURSOR-APPL-1 TO TRUE               25270002
252800                MOVE -1               TO ASTRTITL                 25280002
252900             END-IF                                               25290002
253000         END-IF                                                   25300002
253100*                                                                 25310002
253200         MOVE ASC-AREA (ASC-BLK-SUB ASC-ITEM-SUB)                 25320004
253300                                              TO MR-AREA (PV-SUB) 25330004
253400         IF ASC-3RDUNITS (ASC-BLK-SUB ASC-ITEM-SUB) < 0           25340099
253410             MOVE ASC-3RDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)         25341096
253500                                         TO MR-3RD-UNITS-P(PV-SUB)25350099
253501         ELSE                                                     25350196
253502             IF ASC-3RDUNITS (ASC-BLK-SUB ASC-ITEM-SUB) > 9999999925350299
253503                 MOVE ASC-3RDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     25350399
253504                                         TO MR-3RD-UNITS-O(PV-SUB)25350499
253505             ELSE                                                 25350599
253510                 MOVE ASC-3RDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     25351099
253520                                         TO MR-3RD-UNITS-N(PV-SUB)25352096
253530             END-IF                                               25353099
253540         END-IF                                                   25354099
253600         MOVE ASC-3RDPCT (ASC-BLK-SUB ASC-ITEM-SUB)               25360004
253700                                          TO MR-3RD-PCT-N (PV-SUB)25370019
253710         IF ASC-1STUNITS (ASC-BLK-SUB ASC-ITEM-SUB) < 0           25371099
253720             MOVE ASC-1STUNITS (ASC-BLK-SUB ASC-ITEM-SUB)         25372099
253730                                         TO MR-1ST-UNITS-P(PV-SUB)25373099
253740         ELSE                                                     25374099
253800             IF ASC-1STUNITS (ASC-BLK-SUB ASC-ITEM-SUB) > 9999999925380099
253810                 MOVE ASC-1STUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     25381099
253900                                         TO MR-1ST-UNITS-O(PV-SUB)25390096
253901             ELSE                                                 25390199
253910                 MOVE ASC-1STUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     25391099
253920                                         TO MR-1ST-UNITS-N(PV-SUB)25392096
253930             END-IF                                               25393099
253940         END-IF                                                   25394099
254000         MOVE ASC-1STPCT (ASC-BLK-SUB ASC-ITEM-SUB)               25400004
254100                                         TO MR-1ST-PCT-N  (PV-SUB)25410019
254110         IF ASC-2NDUNITS (ASC-BLK-SUB ASC-ITEM-SUB) < 0           25411099
254120             MOVE ASC-2NDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)         25412099
254130                                         TO MR-2ND-UNITS-P(PV-SUB)25413099
254140         ELSE                                                     25414099
254200             IF ASC-2NDUNITS (ASC-BLK-SUB ASC-ITEM-SUB) > 9999999925420099
254210                 MOVE ASC-2NDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     25421099
254300                                         TO MR-2ND-UNITS-O(PV-SUB)25430096
254301             ELSE                                                 25430199
254310                 MOVE ASC-2NDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     25431099
254320                                         TO MR-2ND-UNITS-N(PV-SUB)25432096
254330             END-IF                                               25433099
254340         END-IF                                                   25434099
254400         MOVE ASC-2NDPCT (ASC-BLK-SUB ASC-ITEM-SUB)               25440004
254500                                         TO MR-2ND-PCT-N  (PV-SUB)25450019
254510         IF ASC-TOTUNITS (ASC-BLK-SUB ASC-ITEM-SUB) < 0           25451099
254520             MOVE ASC-TOTUNITS (ASC-BLK-SUB ASC-ITEM-SUB)         25452099
254530                                         TO MR-TOT-UNITS-P(PV-SUB)25453099
254540         ELSE                                                     25454099
254600            IF ASC-TOTUNITS (ASC-BLK-SUB ASC-ITEM-SUB) > 99999999925460099
254610                 MOVE ASC-TOTUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     25461099
254700                                         TO MR-TOT-UNITS-O(PV-SUB)25470096
254701             ELSE                                                 25470199
254710                 MOVE ASC-TOTUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     25471099
254720                                         TO MR-TOT-UNITS-N(PV-SUB)25472096
254730             END-IF                                               25473099
254740         END-IF                                                   25474099
254800         MOVE ASC-TOTPCT (ASC-BLK-SUB ASC-ITEM-SUB)               25480004
254900                                         TO MR-TOT-PCT-N  (PV-SUB)25490019
255000     END-IF.                                                      25500002
255100     SUBTRACT +1 FROM ASC-ITEM-SUB                                25510002
255200     IF  ASC-ITEM-SUB < + 1                                       25520002
255300         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  25530002
255400         MOVE +1                 TO ASC-BLK-SUB                   25540002
255500     END-IF.                                                      25550002
255600                                                                  25560002
255700******************************************************************25570002
255800** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **25580002
255900** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **25590002
256000** ISSUE A WARNING.                                             **25600002
256100******************************************************************25610002
256200 4430-CHECK-FOR-BEGIN-AND-END.                                    25620002
256300     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       25630002
256400         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     25640002
256500*            -- NO END-OF-RANGE SPECFIED ---                      25650002
256600             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            25660002
256700             SET DP020-MSG-WARNING TO TRUE                        25670002
256800             PERFORM 4431-POSITION-AT-WARNING                     25680002
256900         END-IF                                                   25690002
257000     ELSE                                                         25700002
257100         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     25710002
257200*            -- NO BEGINNING-OF-RANGE SPECFIED ---                25720002
257300             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            25730002
257400             SET DP020-MSG-WARNING TO TRUE                        25740002
257500             PERFORM 4431-POSITION-AT-WARNING                     25750002
257600         END-IF                                                   25760002
257700     END-IF.                                                      25770002
257800******************************************************************25780002
257900** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **25790002
258000** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **25800002
258100** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **25810002
258200** POSITION THE CURSOR THERE.                                   **25820002
258300******************************************************************25830002
258400 4431-POSITION-AT-WARNING.                                        25840002
258500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 25850002
258600                    - PV-TOP-ITEM + 1.                            25860002
258700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25870002
258800         CONTINUE                                                 25880002
258900     ELSE                                                         25890002
259000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      25900002
259100         MOVE -1                    TO ASTRTITL                   25910002
259200     END-IF.                                                      25920002
259300*                                                                 25930002
259400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   25940002
259500                    - PV-TOP-ITEM + 1.                            25950002
259600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25960002
259700         CONTINUE                                                 25970002
259800     ELSE                                                         25980002
259900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      25990002
260000         MOVE -1                   TO ASTRTITL                    26000002
260100     END-IF.                                                      26010002
260200                                                                  26020002
260300*----------------------------------------------------------------*26030002
260400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *26040002
260500* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *26050002
260600* FOR THE SELECTED ITEMS QUEUE.                                  *26060002
260700*                                                                *26070002
260800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *26080002
260900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *26090002
261000* THE ARRAY IS FULL.                                             *26100002
261100*----------------------------------------------------------------*26110002
261200 5000-PREPARE-SEL-QUEUE.                                          26120002
261300                                                                  26130002
261400     MOVE +1                   TO  ASC-BLK-SUB.                   26140002
261500     PERFORM 5100-WRITE-TEMP-STORAGE.                             26150002
261600     ADD +1                    TO  ASC-BLK-SUB.                   26160002
261700     PERFORM 5100-WRITE-TEMP-STORAGE.                             26170002
261800                                                                  26180002
261900     MOVE ASC-SEL-QUEUE-NAME   TO  PC214-SEL-QUEUE-NAME.          26190002
262000     PERFORM 6010-DELETE-SEL-QUEUE.                               26200002
262100                                                                  26210002
262200     SET ASC-UPDATE-TSQ        TO  TRUE.                          26220002
262300                                                                  26230002
262400     SET PC215-IDX             TO  1.                             26240002
262500     MOVE ZERO                 TO PC214-NUMBER-OF-TS-ITEMS.       26250002
262600     INITIALIZE PC215-SELECTED-ITEM-ARRAY.                        26260002
262700                                                                  26270002
262800     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           26280002
262900             VARYING PV-ITEM                                      26290002
263000             FROM 1 BY 1                                          26300002
263100             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     26310002
263200                                                                  26320002
263300     IF  PC215-IDX > 1                                            26330002
263400         PERFORM 5205-WRITE-SEL-QUEUE                             26340002
263500         ADD +1                TO PC214-NUMBER-OF-TS-ITEMS        26350002
263600     END-IF.                                                      26360002
263700*----------------------------------------------------------------*26370002
263800*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *26380002
263900*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *26390002
264000*----------------------------------------------------------------*26400002
264100 5100-WRITE-TEMP-STORAGE.                                         26410002
264200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     26420002
264300                                   TO PV-LIST-ITEM-NUMBER.        26430002
264400     COMPUTE PV-BLOCK-NUMBER =                                    26440002
264500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    26450002
264600                                                                  26460002
264700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             26470002
264800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             26480002
264900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      26490002
265000             PERFORM 5105-REWRITE-ASC-LISTQ                       26500002
265100         END-IF                                                   26510002
265200     ELSE                                                         26520002
265300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       26530002
265400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            26540002
265500         PERFORM 5110-WRITE-ASC-LISTQ                             26550002
265600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   26560002
265700     END-IF.                                                      26570002
265800                                                                  26580002
265900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             26590002
266000                                                                  26600002
266100******************************************************************26610002
266200** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **26620002
266300** SPECIFIC COMMAREA.                                           **26630002
266400******************************************************************26640002
266500 5105-REWRITE-ASC-LISTQ.                                          26650002
266600     EXEC CICS                                                    26660002
266700         WRITEQ TS                                                26670002
266800             QUEUE (ASC-LIST-QUEUE-NAME)                          26680002
266900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26690002
267000             ITEM  (PV-BLOCK-NUMBER)                              26700002
267100             REWRITE                                              26710002
267200             RESP  (PV-CICS-RESP)                                 26720002
267300     END-EXEC.                                                    26730002
267400                                                                  26740002
267500     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           26750002
267600         CONTINUE                                                 26760002
267700     ELSE                                                         26770002
267800         SET DP013-CICS-ABEND            TO TRUE                  26780002
267900         SET DP013-NO-ROLLBACK           TO TRUE                  26790002
268000         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       26800002
268100         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     26810002
268200                                         TO DP013-MESSAGE-TEXT(1) 26820002
268300         PERFORM DP013-0000-PROCESS-ABEND                         26830002
268400     END-IF.                                                      26840002
268500                                                                  26850002
268600******************************************************************26860002
268700** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **26870002
268800** SPECIFIC COMMAREA.                                           **26880002
268900******************************************************************26890002
269000 5110-WRITE-ASC-LISTQ.                                            26900002
269100     EXEC CICS                                                    26910002
269200         WRITEQ TS                                                26920002
269300             QUEUE (ASC-LIST-QUEUE-NAME)                          26930002
269400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26940002
269500             ITEM  (PV-BLOCK-NUMBER)                              26950002
269600             RESP  (PV-CICS-RESP)                                 26960002
269700     END-EXEC.                                                    26970002
269800     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      26980002
269900         SET DP013-CICS-ABEND      TO TRUE                        26990002
270000         SET DP013-NO-ROLLBACK     TO TRUE                        27000002
270100         MOVE '5110-WRITE-ASC-LISTQ'                              27010002
270200                                   TO DP013-PARAGRAPH             27020002
270300         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           27030002
270400                                   TO DP013-MESSAGE-TEXT(1)       27040002
270500         PERFORM DP013-0000-PROCESS-ABEND                         27050002
270600     END-IF.                                                      27060002
270700                                                                  27070002
270800*----------------------------------------------------------------*27080002
270900* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *27090002
271000* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *27100002
271100*----------------------------------------------------------------*27110002
271200 5200-FILL-SEL-QUEUE-RECORD.                                      27120002
271300                                                                  27130002
271400     PERFORM 6112-READ-LIST-QUEUE.                                27140002
271500                                                                  27150002
271600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       27160002
271700         PERFORM                                                  27170002
271800         VARYING LQW-IDX                                          27180002
271900         FROM 1 BY 1                                              27190002
272000         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            27200002
272100           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          27210002
272200                                                                  27220002
272300             IF  LQW-SELECT (LQW-IDX)                             27230002
272400                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              27240002
272500                                   TO PC215-ITEM (PC215-IDX)      27250002
272600                 MOVE SPACE        TO PC215-ACTION-SW (PC215-IDX) 27260002
272700                                                                  27270002
272800                 MOVE LQW-AREA (LQW-IDX)                          27280002
272900                                        TO PC215-AREA (PC215-IDX) 27290023
273000                 MOVE LQW-3RD-UNITS (LQW-IDX)                     27300023
273100                                   TO PC215-3RD-UNITS (PC215-IDX) 27310023
273200                 MOVE LQW-3RD-PCT (LQW-IDX)                       27320023
273300                                     TO PC215-3RD-PCT (PC215-IDX) 27330023
273400                 MOVE LQW-1ST-UNITS (LQW-IDX)                     27340023
273500                                   TO PC215-1ST-UNITS (PC215-IDX) 27350023
273600                 MOVE LQW-1ST-PCT (LQW-IDX)                       27360023
273700                                     TO PC215-1ST-PCT (PC215-IDX) 27370023
273800                 MOVE LQW-2ND-UNITS (LQW-IDX)                     27380023
273900                                   TO PC215-2ND-UNITS (PC215-IDX) 27390023
274000                 MOVE LQW-2ND-PCT (LQW-IDX)                       27400023
274100                                     TO PC215-2ND-PCT (PC215-IDX) 27410023
274200                 MOVE LQW-TOT-UNITS (LQW-IDX)                     27420023
274300                                   TO PC215-TOT-UNITS (PC215-IDX) 27430023
274400                 MOVE LQW-TOT-PCT (LQW-IDX)                       27440023
274500                                     TO PC215-TOT-PCT (PC215-IDX) 27450023
274600                 SET PC215-IDX UP BY 1                            27460002
274700                 IF  PC215-IDX > PC215-MAX-ITEMS                  27470002
274800                     PERFORM 5205-WRITE-SEL-QUEUE                 27480002
274900                     ADD +1        TO PC214-NUMBER-OF-TS-ITEMS    27490002
275000                     INITIALIZE PC215-SELECTED-ITEM-ARRAY         27500002
275100                     SET PC215-IDX TO  1                          27510002
275200                 END-IF                                           27520002
275300             END-IF                                               27530002
275400         END-PERFORM                                              27540002
275500     END-IF.                                                      27550002
275600                                                                  27560002
275700*----------------------------------------------------------------*27570002
275800*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *27580002
275900*----------------------------------------------------------------*27590002
276000 5205-WRITE-SEL-QUEUE.                                            27600002
276100                                                                  27610002
276200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27620002
276300                                   TO PC215-SELECTED-ITEMS.       27630002
276400                                                                  27640002
276500     EXEC CICS                                                    27650002
276600          WRITEQ TS                                               27660002
276700              QUEUE (ASC-SEL-QUEUE-NAME)                          27670002
276800              FROM  (PC215-SELECT-RECORD)                         27680002
276900              ITEM  (PV-SEL-QUEUE-ITEM)                           27690002
277000              RESP  (PV-CICS-RESP)                                27700002
277100     END-EXEC.                                                    27710002
277200                                                                  27720002
277300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27730002
277400         CONTINUE                                                 27740002
277500     ELSE                                                         27750002
277600         SET DP013-CICS-ABEND      TO TRUE                        27760002
277700         SET DP013-NO-ROLLBACK     TO TRUE                        27770002
277800         MOVE '5205-WRITE-SEL-QUEUE'                              27780002
277900                                   TO DP013-PARAGRAPH             27790002
278000         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          27800002
278100                                   TO DP013-MESSAGE-TEXT(1)       27810002
278200         PERFORM DP013-0000-PROCESS-ABEND                         27820002
278300     END-IF.                                                      27830002
278400******************************************************************27840002
278500** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **27850002
278600** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **27860002
278700** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **27870002
278800** THE USER.                                                    **27880002
278900******************************************************************27890002
279000 6000-REFRESH-PANEL-FROM-TEMP.                                    27900002
279100     IF  ASC-UPDATE-TSQ                                           27910002
279200         SET ASC-NO-TSQ-UPDATE TO TRUE                            27920002
279300         MOVE ZERO                 TO PV-SAVE-ITEM                27930002
279400                                      PV-SEL-QUEUE-ITEM           27940002
279500         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        27950002
279600                                   TO PV-HOLD-SELECTED-ITEMS      27960002
279700         MOVE +1                   TO PV-ITEMS-PROCESSED          27970002
279800         PERFORM 6100-UPDATE-TSQ                                  27980002
279900             UNTIL PV-ITEMS-PROCESSED >                           27990002
280000                                     PV-HOLD-SELECTED-ITEMS       28000002
280100         PERFORM 6010-DELETE-SEL-QUEUE                            28010034
280200         INITIALIZE ASC-BLOCK-ENTRIES (1)                         28020002
280300                    ASC-BLOCK-ENTRIES (2)                         28030002
280400     END-IF.                                                      28040002
280500                                                                  28050002
280600*----------------------------------------------------------------*28060002
280700*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *28070002
280800*----------------------------------------------------------------*28080002
280900 6010-DELETE-SEL-QUEUE.                                           28090002
281000                                                                  28100002
281100     EXEC CICS                                                    28110002
281200         DELETEQ TS                                               28120002
281300             QUEUE (ASC-SEL-QUEUE-NAME)                           28130002
281400             RESP  (PV-CICS-RESP)                                 28140002
281500     END-EXEC.                                                    28150002
281600*                                                                 28160002
281700     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      28170002
281800        (PV-CICS-RESP = DFHRESP(QIDERR)))                         28180002
281900         CONTINUE                                                 28190002
282000     ELSE                                                         28200002
282100         SET DP013-CICS-ABEND TO TRUE                             28210002
282200         SET DP013-NO-ROLLBACK TO TRUE                            28220002
282300         MOVE '6010-DELETE-SEL-QUEUE'                             28230002
282400                        TO DP013-PARAGRAPH                        28240002
282500         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         28250002
282600                        TO DP013-MESSAGE-TEXT (1)                 28260002
282700         PERFORM DP013-0000-PROCESS-ABEND                         28270002
282800     END-IF.                                                      28280002
282900                                                                  28290002
283000*----------------------------------------------------------------*28300002
283100*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *28310002
283200*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *28320002
283300*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *28330002
283400*    THE TEMP QUEUE.                                             *28340002
283500*----------------------------------------------------------------*28350002
283600 6100-UPDATE-TSQ.                                                 28360002
283700                                                                  28370002
283800     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             28380002
283900     PERFORM 6150-READ-SEL-QUEUE.                                 28390002
284000     PERFORM                                                      28400002
284100         VARYING PC215-IDX                                        28410002
284200         FROM 1 BY 1                                              28420002
284300         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     28430002
284400         OR (PC215-IDX GREATER THAN PC215-MAX-ITEMS))             28440002
284500         IF  PC215-ACTION-SW (PC215-IDX) > SPACE                  28450002
284600             PERFORM 6110-PROCESS-ITEMS                           28460002
284700         END-IF                                                   28470002
284800         ADD +1                TO PV-ITEMS-PROCESSED              28480002
284900     END-PERFORM.                                                 28490002
285000     PERFORM 6111-WRITE-LIST-QUEUE.                               28500002
285100                                                                  28510002
285200*----------------------------------------------------------------*28520002
285300*    READ THE LIST QUEUE RECORD.                                 *28530002
285400*----------------------------------------------------------------*28540002
285500 6150-READ-SEL-QUEUE.                                             28550002
285600                                                                  28560002
285700     EXEC CICS                                                    28570002
285800          READQ TS                                                28580002
285900              QUEUE (ASC-SEL-QUEUE-NAME)                          28590002
286000              INTO  (PC215-SELECT-RECORD)                         28600002
286100              ITEM  (PV-SEL-QUEUE-ITEM)                           28610002
286200              RESP  (PV-CICS-RESP)                                28620002
286300     END-EXEC.                                                    28630002
286400*                                                                 28640002
286500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28650002
286600         CONTINUE                                                 28660002
286700     ELSE                                                         28670002
286800         SET DP013-CICS-ABEND      TO  TRUE                       28680002
286900         SET DP013-NO-ROLLBACK     TO  TRUE                       28690002
287000         MOVE '6150-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           28700002
287100         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           28710002
287200                                   TO  DP013-MESSAGE-TEXT(1)      28720002
287300         PERFORM DP013-0000-PROCESS-ABEND                         28730002
287400     END-IF.                                                      28740002
287500                                                                  28750002
287600*----------------------------------------------------------------*28760002
287700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*28770002
287800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*28780002
287900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *28790002
288000*----------------------------------------------------------------*28800002
288100 6110-PROCESS-ITEMS.                                              28810002
288200                                                                  28820002
288300     COMPUTE PV-ITEM = 1 + ((PC215-ITEM (PC215-IDX) - 1)          28830002
288400                     / PC-ITEMS-PER-PANEL).                       28840002
288500                                                                  28850002
288600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           28860002
288700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          28870002
288800             PERFORM 6111-WRITE-LIST-QUEUE                        28880002
288900         END-IF                                                   28890002
289000         MOVE PV-ITEM          TO PV-SAVE-ITEM                    28900002
289100                                                                  28910002
289200         PERFORM 6112-READ-LIST-QUEUE                             28920002
289300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               28930002
289400             CONTINUE                                             28940002
289500         END-IF                                                   28950002
289600     END-IF.                                                      28960002
289700                                                                  28970002
289800     COMPUTE PV-SUB = (PC215-ITEM (PC215-IDX)                     28980002
289900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              28990002
290000     SET LQW-DESELECT (PV-SUB) TO    TRUE                         29000002
290100     MOVE LQW-SELECTED-SW (PV-SUB)                                29010002
290200                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  29020002
290300                                                                  29030002
290400     EVALUATE TRUE                                                29040002
290500         WHEN PC215-INQ (PC215-IDX)                               29050002
290600              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             29060002
290700                                                                  29070002
290800         WHEN PC215-UPD (PC215-IDX)                               29080002
290900              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             29090002
291000                                                                  29100002
291100         WHEN PC215-DEL (PC215-IDX)                               29110002
291200              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             29120002
291300                                                                  29130002
291400         WHEN PC215-ERR (PC215-IDX)                               29140002
291500              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             29150002
291600     END-EVALUATE.                                                29160002
291700                                                                  29170002
291800     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                29180002
291900                                                                  29190002
292000*----------------------------------------------------------------*29200002
292100*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *29210002
292200*----------------------------------------------------------------*29220002
292300 6111-WRITE-LIST-QUEUE.                                           29230002
292400                                                                  29240002
292500     EXEC CICS                                                    29250002
292600         WRITEQ TS                                                29260002
292700             QUEUE (ASC-LIST-QUEUE-NAME)                          29270002
292800             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     29280002
292900             ITEM  (PV-SAVE-ITEM)                                 29290002
293000             REWRITE                                              29300002
293100             RESP  (PV-CICS-RESP)                                 29310002
293200     END-EXEC.                                                    29320002
293300*                                                                 29330002
293400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29340002
293500         CONTINUE                                                 29350002
293600     ELSE                                                         29360002
293700         SET DP013-CICS-ABEND  TO  TRUE                           29370002
293800         SET DP013-NO-ROLLBACK TO  TRUE                           29380002
293900         MOVE '6111-WRITE-LIST-QUEUE'                             29390002
294000                               TO  DP013-PARAGRAPH                29400002
294100         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  29410002
294200                               TO  DP013-MESSAGE-TEXT(1)          29420002
294300         PERFORM DP013-0000-PROCESS-ABEND                         29430002
294400     END-IF.                                                      29440002
294500                                                                  29450002
294600*----------------------------------------------------------------*29460002
294700*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*29470002
294800*----------------------------------------------------------------*29480002
294900 6112-READ-LIST-QUEUE.                                            29490002
295000                                                                  29500002
295100     EXEC CICS                                                    29510002
295200         READQ TS                                                 29520002
295300             QUEUE (ASC-LIST-QUEUE-NAME)                          29530002
295400             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     29540002
295500             ITEM  (PV-ITEM)                                      29550002
295600             RESP  (PV-CICS-RESP)                                 29560002
295700     END-EXEC.                                                    29570002
295800*                                                                 29580002
295900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29590002
296000         CONTINUE                                                 29600002
296100     ELSE                                                         29610002
296200         SET DP013-CICS-ABEND        TO TRUE                      29620002
296300         SET DP013-NO-ROLLBACK       TO TRUE                      29630002
296400         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           29640002
296500         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    29650002
296600                                     TO DP013-MESSAGE-TEXT(1)     29660002
296700         PERFORM DP013-0000-PROCESS-ABEND                         29670002
296800     END-IF.                                                      29680002
296900                                                                  29690002
297000*-----------------------------------------------------------------29700002
297100*  READ THE LIST QUEUE RECORD                                     29710002
297200*-----------------------------------------------------------------29720002
297300 9100-READ-SEL-QUEUE.                                             29730002
297400                                                                  29740002
297500     EXEC CICS                                                    29750002
297600         READQ TS                                                 29760002
297700             QUEUE (ASC-SEL-QUEUE-NAME)                           29770002
297800             INTO  (PC215-SELECT-RECORD)                          29780002
297900             ITEM  (ASC-SEL-ITEM)                                 29790002
298000             RESP  (PV-CICS-RESP)                                 29800002
298100     END-EXEC.                                                    29810002
298200     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        29820002
298300         CONTINUE                                                 29830002
298400     ELSE                                                         29840002
298500         SET DP013-LOGIC-ABEND                                    29850002
298600             DP013-NO-ROLLBACK   TO   TRUE                        29860002
298700         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          29870002
298800         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   29880002
298900                                 TO   DP013-MESSAGE-TEXT (1)      29890002
299000         PERFORM DP013-0000-PROCESS-ABEND                         29900002
299100     END-IF.                                                      29910002
299200                                                                  29920002
299300*-----------------------------------------------------------------29930002
299400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *29940002
299500*-----------------------------------------------------------------29950002
299600 9200-REWRITE-SEL-QUEUE.                                          29960002
299700                                                                  29970002
299800     EXEC CICS                                                    29980002
299900          WRITEQ TS                                               29990002
300000              QUEUE  (ASC-SEL-QUEUE-NAME)                         30000002
300100              FROM   (PC215-SELECT-RECORD)                        30010002
300200              ITEM   (ASC-SEL-ITEM)                               30020002
300300              RESP   (PV-CICS-RESP)                               30030002
300400              REWRITE                                             30040002
300500     END-EXEC.                                                    30050002
300600                                                                  30060002
300700     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   30070002
300800         SET DP013-CICS-ABEND                                     30080002
300900             DP013-NO-ROLLBACK     TO TRUE                        30090002
301000         MOVE '9200-REWRITE-SEL-QUEUE'                            30100002
301100                                   TO DP013-PARAGRAPH             30110002
301200         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   30120002
301300                                   TO DP013-MESSAGE-TEXT (1)      30130002
301400         PERFORM DP013-0000-PROCESS-ABEND                         30140002
301500     END-IF.                                                      30150002
301600                                                                  30160002
301700*----------------------------------------------------------------*30170002
301800*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *30180002
301900*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *30190002
302000*----------------------------------------------------------------*30200002
302100 9900-SOFT-ABORT.                                                 30210002
302200                                                                  30220002
302300     EXEC CICS SYNCPOINT                                          30230002
302400          ROLLBACK                                                30240002
302500     END-EXEC.                                                    30250002
302600                                                                  30260002
302700     SET  PS-ERROR                                                30270002
302800          PS-SOFT-ABORT-ERROR                                     30280002
302900          DP020-MSG-FATAL       TO  TRUE.                         30290002
303000                                                                  30300002
303100*----------------------------------------------------------------*30310002
303200*    ABEND PROCESSOR MODULE                                      *30320002
303300*----------------------------------------------------------------*30330002
303400                                                                  30340002
303500     COPY DPPD013.                                                30350002
