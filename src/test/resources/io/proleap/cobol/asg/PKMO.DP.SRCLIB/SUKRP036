000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400*                                                                 00040000
000500 PROGRAM-ID.             SUKRP036.                                00050000
000600 AUTHOR.                 PATRICK BURKE.                           00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN.           MAY 2002.                                00080000
000900 DATE-COMPILED.                                                   00090000
001000*                                                                 00100000
001100***************************************************************** 00110000
001200*  THIS PROGRAM WILL BE USED TO CREATE A REPORT LISTING ALL OF THE00120000
001300*  UPLOAD ERRORS FOUND DURING VARIOUS PROCESSING.                 00130000
001400***************************************************************** 00140000
001500 ENVIRONMENT DIVISION.                                            00150000
001600***************************************************************** 00160000
001700 CONFIGURATION SECTION.                                           00170000
001800 SOURCE-COMPUTER.                        IBM-3090.                00180000
001900 OBJECT-COMPUTER.                        IBM-3090.                00190000
002000 INPUT-OUTPUT SECTION.                                            00200000
002100 FILE-CONTROL.                                                    00210000
002200                                                                  00220000
002300     SELECT EXTRACT-FILE                                          00230000
002400         ASSIGN TO INP01.                                         00240000
002500                                                                  00250000
002600     SELECT REPORT-FILE-1                                         00260000
002700         ASSIGN TO RPT01.                                         00270000
002800                                                                  00280000
002900     SELECT SCAN-ON-EXTRACT-FILE                                  00290000
003000         ASSIGN TO OUT01.                                         00300000
003100                                                                  00310000
003200     SELECT P2L-CARTON-EXTRACT-FILE                               00320000
003300         ASSIGN TO OUT02.                                         00330000
003400                                                                  00340000
003500     SELECT INACTIVE-DIVERT-FILE                                  00350000
003600         ASSIGN TO OUT03.                                         00360003
003700                                                                  00370004
003800     SELECT UNKNOWN-DIVERT-FILE                                   00380004
003900         ASSIGN TO OUT04.                                         00390004
004000                                                                  00400000
004100***************************************************************** 00410000
004200 DATA DIVISION.                                                   00420000
004300***************************************************************** 00430000
004400 FILE SECTION.                                                    00440000
004500                                                                  00450000
004600 FD  EXTRACT-FILE                                                 00460000
004700     RECORDING MODE IS F                                          00470000
004800     LABEL RECORDS ARE STANDARD                                   00480000
004900     BLOCK CONTAINS 0 RECORDS.                                    00490000
005000 01  EXTRACT-RECORD                   PIC X(136).                 00500000
005100                                                                  00510000
005200 FD  REPORT-FILE-1                                                00520000
005300     RECORDING MODE IS F                                          00530000
005400     BLOCK CONTAINS 0 RECORDS.                                    00540000
005500 01  REPORT-RECORD-1                  PIC X(132).                 00550000
005600                                                                  00560000
005700 FD  SCAN-ON-EXTRACT-FILE                                         00570000
005800     RECORDING MODE IS F                                          00580000
005900     BLOCK CONTAINS 0 RECORDS.                                    00590000
006000 01  SCAN-ON-EXTRACT-RECORD           PIC X(100).                 00600000
006100                                                                  00610000
006200 FD  P2L-CARTON-EXTRACT-FILE                                      00620000
006300     RECORDING MODE IS F                                          00630000
006400     BLOCK CONTAINS 0 RECORDS.                                    00640000
006500 01  P2L-CARTON-EXTRACT-RECORD        PIC X(150).                 00650001
006600                                                                  00660000
006700 FD  INACTIVE-DIVERT-FILE                                         00670000
006800     RECORDING MODE IS F                                          00680000
006900     BLOCK CONTAINS 0 RECORDS.                                    00690000
007000 01  INACTIVE-DIVERT-RECORD           PIC X(150).                 00700001
007100                                                                  00710000
007200 FD  UNKNOWN-DIVERT-FILE                                          00720004
007300     RECORDING MODE IS F                                          00730004
007400     BLOCK CONTAINS 0 RECORDS.                                    00740004
007500 01  UNKNOWN-DIVERT-RECORD            PIC X(150).                 00750004
007600                                                                  00760004
007700/                                                                 00770000
007800***************************************************************** 00780000
007900 WORKING-STORAGE SECTION.                                         00790000
008000***************************************************************** 00800000
008100                                                                  00810000
008200 01  PS-SWITCHES.                                                 00820000
008300     05  PS-PRINT-DETAILS-SW          PIC X(01) VALUE 'N'.        00830000
008400         88  PS-PRINT-DETAILS                   VALUE 'Y'.        00840000
008500         88  PS-NOT-PRINT-DETAILS               VALUE 'N'.        00850000
008600     05  PS-END-OF-INPUT-FILE-SW      PIC X(01) VALUE 'N'.        00860000
008700         88  PS-END-OF-INPUT                    VALUE 'Y'.        00870000
008800         88  PS-NOT-END-OF-INPUT                VALUE 'N'.        00880000
008900     05  PS-PAGE-SW                   PIC X(01) VALUE 'N'.        00890000
009000         88  PS-NEW-PAGE                        VALUE 'Y'.        00900000
009100         88  PS-SAME-PAGE                       VALUE 'N'.        00910000
009200     05  PS-SAME-KEY-SW               PIC X(01) VALUE 'N'.        00920000
009300         88  PS-SAME-KEY                        VALUE 'Y'.        00930000
009400         88  PS-NOT-SAME-KEY                    VALUE 'N'.        00940000
009500     05  PS-END-OF-TSUCRDV-CSR-SW     PIC X(01) VALUE 'N'.        00950000
009600         88  PS-NOT-END-OF-TSUCRDV-CSR          VALUE 'N'.        00960000
009700         88  PS-END-OF-TSUCRDV-CSR              VALUE 'Y'.        00970000
009800                                                                  00980000
009900 01  DK-DB2-KEYS.                                                 00990000
010000     05  DK-RUN-DATE                  PIC X(10).                  01000000
010100     05  DK-WEEK-END-DATE             PIC X(10).                  01010000
010200     05  DK-OPER-ID                   PIC S9(4) COMP.             01020000
010300     05  DK-DB2-TMST-1                PIC X(26).                  01030000
010400     05  DK-DB2-TMST-2                PIC X(26).                  01040000
010500                                                                  01050000
010600 01  DN-NULL-INDICATORS.                                          01060000
010700     05  DN-LOC-NULL                  PIC S9(04) COMP VALUE ZERO. 01070000
010800     05  DN-CART-NULL                 PIC S9(04) COMP VALUE ZERO. 01080000
010900     05  DN-DTE-NULL                  PIC S9(04) COMP VALUE ZERO. 01090001
011000     05  DN-TM-NULL                   PIC S9(04) COMP VALUE ZERO. 01100001
011100     05  DN-USR-NULL                  PIC S9(04) COMP VALUE ZERO. 01110001
011200     05  DN-DOOR-NULL                 PIC S9(04) COMP VALUE ZERO. 01120000
011300                                                                  01130000
011400 01  PV-DATE-RECORD.                                              01140000
011500     05  PV-FROM-DATE                 PIC X(10) VALUE SPACES.     01150000
011600     05  FILLER                       PIC X(01) VALUE SPACES.     01160000
011700     05  PV-TO-DATE                   PIC X(10) VALUE SPACES.     01170000
011800                                                                  01180000
011900 01  SD-SYSTEM-DATE.                                              01190000
012000     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      01200000
012100     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      01210000
012200     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      01220000
012300                                                                  01230000
012400 01  ST-SYSTEM-TIME.                                              01240000
012500     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      01250000
012600     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      01260000
012700     05  FILLER                     PIC  9(04)   VALUE ZERO.      01270000
012800                                                                  01280000
012900 01  PV-VARIABLES.                                                01290000
013000     05  PV-SCAN-OFF-TMST             PIC X(26).                  01300000
013100     05  PV-READ-COUNT                PIC S9(7) COMP-3            01310000
013200                                                VALUE ZERO.       01320000
013300     05  PV-FETCH-COUNT               PIC S9(7) COMP-3            01330000
013400                                                VALUE ZERO.       01340000
013500     05  PV-REC-READ-QTY              PIC S9(7) COMP-3            01350000
013600                                                VALUE ZERO.       01360000
013700     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            01370000
013800                                                VALUE ZERO.       01380000
013900     05  PV-PAGE-COUNT                PIC S9(3) COMP-3            01390000
014000                                                VALUE ZERO.       01400000
014100     05  PV-LINE-COUNT                PIC S9(04) VALUE ZERO       01410000
014200                                                 COMP SYNC.       01420000
014300     05  PV-TRANS-QTY                 PIC S9(07) VALUE ZERO       01430000
014400                                                 COMP SYNC.       01440000
014500     05  PV-DC-TRANS-QTY              PIC S9(07) VALUE ZERO       01450000
014600                                                 COMP SYNC.       01460000
014700     05  PV-SCAN-ON-WRITTEN           PIC S9(09) VALUE ZERO       01470000
014800                                                 COMP SYNC.       01480000
014900     05  PV-EMPTY-WRITTEN             PIC S9(09) VALUE ZERO       01490001
015000                                                 COMP SYNC.       01500001
015100     05  PV-INACTIVE-WRITTEN          PIC S9(09) VALUE ZERO       01510001
015200                                                 COMP SYNC.       01520001
015300     05  PV-UNKNOWN-WRITTEN           PIC S9(09) VALUE ZERO       01530004
015400                                                 COMP SYNC.       01540004
015500                                                                  01550000
015600***************************************************************   01560000
015700     05  PV-TOTAL-DIVERTS            PIC S9(07) VALUE ZERO        01570000
015800                                                 COMP SYNC.       01580000
015900     05  PV-SHIPPING-DOOR             PIC S9(07) VALUE ZERO       01590000
016000                                                 COMP SYNC.       01600000
016100     05  PV-STORAGE-DOOR              PIC S9(07) VALUE ZERO       01610000
016200                                                 COMP SYNC.       01620000
016300     05  PV-SHUTTLE-DOOR              PIC S9(07) VALUE ZERO       01630000
016400                                                 COMP SYNC.       01640000
016500     05  PV-OTHER                     PIC S9(07) VALUE ZERO       01650000
016600                                                 COMP SYNC.       01660000
016700     05  PV-DUPLICATE-DIVERTS         PIC S9(07) VALUE ZERO       01670000
016800                                                 COMP SYNC.       01680000
016900     05  PV-NO-INFO-DIVERTS           PIC S9(07) VALUE ZERO       01690000
017000                                                 COMP SYNC.       01700000
017100     05  PV-INACTIVE-DIVERTS          PIC S9(07) VALUE ZERO       01710000
017200                                                 COMP SYNC.       01720000
017300                                                                  01730000
017400***************************************************************   01740000
017500     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZ9.            01750000
017600     05  PV-STORE-NBR                 PIC S9(4) COMP.             01760000
017700     05  PV-STORE-NAME                PIC X(25) VALUE SPACES.     01770000
017800     05  PV-LOCATION-NBR              PIC 9(04) VALUE ZEROS.      01780000
017900     05  PV-OPER-ID                   PIC S9(4) COMP.             01790000
018000     05  PV-PREV-OPER-ID              PIC 9(04) VALUE ZEROS.      01800000
018100     05  PV-UPLD-TRN-CDE              PIC X(01) VALUE SPACES.     01810000
018200     05  PV-PREV-UPLD-TRN-CDE         PIC X(01) VALUE SPACES.     01820000
018300     05  PV-ERR-CDE                   PIC X(03) VALUE SPACES.     01830000
018400     05  PV-PREV-SHIPT-UNT-ID         PIC S9(18) COMP-3           01840000
018500                                                VALUE ZERO.       01850000
018600     05  PV-SHIPT-UNT-ID              PIC S9(18) COMP-3           01860000
018700                                                VALUE ZERO.       01870000
018800     05  PV-DISP-SHIPT-UNT-ID.                                    01880000
018900         10  PV-DISP-SHIPT-UNT-ID-N   PIC 9(18) VALUE ZERO.       01890000
019000     05  PV-PREV-ERR-CDE              PIC X(03) VALUE SPACES.     01900000
019100     05  PV-DOOR-ID                   PIC X(04) VALUE SPACES.     01910000
019200                                                                  01920000
019300     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     01930000
019400     05  PV-DB2-TABLE-NAME            PIC X(30) VALUE SPACES.     01940000
019500     05  PV-DB2-TABLE-NAME-1          PIC X(30) VALUE SPACES.     01950000
019600     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     01960000
019700     05  PV-DISPLAY-HOST-VAR          PIC X(18) VALUE SPACES.     01970000
019800     05  PV-DISP-NUMBER               PIC Z,ZZZ,ZZ9.              01980000
019900     05  PV-DISP-OPER-ID              PIC  9(4).                  01990000
020000                                                                  02000000
020100     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     02010000
020200     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     02020000
020300     05  PV-ERROR-MESSAGE-1           PIC X(60)  VALUE SPACES.    02030000
020400     05  PV-ERROR-MESSAGE-2           PIC X(60)  VALUE SPACES.    02040000
020500     05  PV-DB2-YEAR                  PIC S9(08) COMP             02050000
020600                                          VALUE ZERO.             02060000
020700     05  PV-DB2-MONTH                 PIC S9(08) COMP             02070000
020800                                          VALUE ZERO.             02080000
020900     05  PV-DB2-DAY                   PIC S9(08) COMP             02090000
021000                                          VALUE ZERO.             02100000
021100     05  PV-DB2-HOUR                  PIC S9(08) COMP             02110000
021200                                          VALUE ZERO.             02120000
021300     05  PV-DB2-MINUTE                PIC S9(08) COMP             02130000
021400                                          VALUE ZERO.             02140000
021500     05  PV-DB2-SECOND                PIC S9(08) COMP             02150000
021600                                          VALUE ZERO.             02160000
021700                                                                  02170000
021800     05  PV-DIVIDEND                  PIC 9(03)V9999.             02180000
021900                                                                  02190000
022000******************************************************************02200000
022100 01  PV-DATE-FIELD.                                               02210000
022200     05  PV-DB2-TMST.                                             02220000
022300         10 PV-DB2-TMST-CCYY          PIC  9(04).                 02230000
022400         10 FILLER                    PIC  X(01).                 02240000
022500         10 PV-DB2-TMST-MM            PIC  9(02).                 02250000
022600         10 FILLER                    PIC  X(01).                 02260000
022700         10 PV-DB2-TMST-DD            PIC  9(02).                 02270000
022800         10 FILLER                    PIC  X(01).                 02280000
022900         10 PV-DB2-TMST-HH            PIC  9(02).                 02290000
023000         10 FILLER                    PIC  X(01).                 02300000
023100         10 PV-DB2-TMST-MN            PIC  9(02).                 02310000
023200         10 FILLER                    PIC  X(01).                 02320000
023300         10 PV-DB2-TMST-SS            PIC  9(02).                 02330000
023400         10 FILLER                    PIC  X(07).                 02340000
023500     05  PV-FORMAT-DATE.                                          02350000
023600         10 PV-FORMAT-DATE-MM         PIC  9(02).                 02360000
023700         10 FILLER                    PIC  X(01) VALUE '/'.       02370000
023800         10 PV-FORMAT-DATE-DD         PIC  9(02).                 02380000
023900         10 FILLER                    PIC  X(01) VALUE '/'.       02390000
024000         10 PV-FORMAT-DATE-CCYY       PIC  9(04).                 02400000
024100                                                                  02410000
024200     05  PV-DB2-TMST-1.                                           02420000
024300         10  PV-DB2-DATE-1                PIC X(10) VALUE SPACES. 02430000
024400         10  FILLER                       PIC X(16) VALUE         02440000
024500                              '-00.00.00.000000'.                 02450000
024600     05  PV-DB2-TMST-2.                                           02460000
024700         10  PV-DB2-DATE-2                PIC X(10) VALUE SPACES. 02470000
024800         10  FILLER                       PIC X(16) VALUE         02480000
024900                              '-23.59.59.999999'.                 02490000
025000                                                                  02500000
025010 01  PV-WORK-SML.                                                         
025011     05  FILLER                       PIC  X(05).                         
025012     05  PV-WORK-SML-STR              PIC  9(04).                         
025013     05  PV-WORK-SML-OPER             PIC  9(04).                         
025014     05  FILLER                       PIC  X(07).                         
025017 01  PV-WORK-DATE.                                                        
025018     05  PV-WORK-DATE-MO              PIC  9(02).                         
025019     05  PV-WORK-DATE-DD              PIC  9(02).                         
025020     05  PV-WORK-DATE-CCYY            PIC  9(04).                         
025021     05  PV-WORK-DATE-HH              PIC  9(02).                         
025022     05  PV-WORK-DATE-MM              PIC  9(02).                         
025023     05  PV-WORK-DATE-SS              PIC  9(02).                         
025024 01  PV-DATE-EDIT.                                                        
025030     10 PV-DATE-EDIT-CCYY             PIC  9(04).                         
025040     10 PV-DATE-EDIT-DASH-1           PIC  X(01).                         
025050     10 PV-DATE-EDIT-MO               PIC  9(02).                         
025060     10 PV-DATE-EDIT-DASH-2           PIC  X(01).                         
025070     10 PV-DATE-EDIT-DD               PIC  9(02).                         
025071 01  PV-TIME-EDIT.                                                        
025072     10 PV-TIME-EDIT-HH               PIC  9(02).                         
025073     10 PV-TIME-EDIT-COLON-1          PIC  X(01).                         
025074     10 PV-TIME-EDIT-MM               PIC  9(02).                         
025075     10 PV-TIME-EDIT-COLON-2          PIC  X(01).                         
025076     10 PV-TIME-EDIT-SS               PIC  9(02).                         
025080                                                                          
025100*    SCAN-ON EXTRACT RECORD                                       02510000
025200     COPY SURD057.                                                02520000
025300                                                                  02530000
025400*    INACTIVE OR EMPTY CARTONS                                    02540001
025500     COPY SURD067.                                                02550001
025600                                                                  02560001
025700     COPY PCWS185.                                                02570003
025800                                                                  02580003
025900                                                                  02590001
026000 01  PV-ABEND-FIELDS.                                             02600001
026100     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         02610001
026200                                                 COMP SYNC.       02620001
026300     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'RCKRP035'.02630001
026400     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    02640001
026500     05  PV-ABEND-OPERATION           PIC  X(51) VALUE SPACES.    02650001
026600     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    02660000
026700     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    02670000
026800     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    02680000
026900     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    02690000
027000     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    02700000
027100     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    02710000
027200     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30)  VALUE SPACE.    02720000
027300/                                                                 02730000
027400 01  PC-CONSTANTS.                                                02740000
027500     05  PC-SUKRP036                  PIC X(08) VALUE 'SUKRP036'. 02750000
027600     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'SUKRP036'. 02760000
027700     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE +60. 02770000
027800     05  PC-MAX-LINE-COUNT            PIC S9(3) VALUE +60         02780000
027900                                                COMP-3.           02790000
028000/                                                                 02800000
028100******************************************************************02810000
028200*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02820000
028300******************************************************************02830000
028400     COPY DPWS132O.                                               02840000
028500*                                                                 02850000
028600 01  HL-HEADING-LINE-1.                                           02860000
028700     05  FILLER                      PIC  X(51).                  02870000
028800     05  FILLER                      PIC  X(18)  VALUE            02880000
028900      'UPLOAD ERRORS FOR '.                                       02890000
029000     05  HL1-FROM-DATE.                                           02900000
029100         10  HL1-FROM-MM             PIC 99.                      02910000
029200         10  FILLER                  PIC X VALUE '/'.             02920000
029300         10  HL1-FROM-DD             PIC 99.                      02930000
029400         10  FILLER                  PIC X VALUE '/'.             02940000
029500         10  HL1-FROM-CCYY           PIC 9(04).                   02950000
029600                                                                  02960000
029700 01  HL-HEADING-LINE-2.                                           02970000
029800     05  FILLER                      PIC  X(14)  VALUE            02980000
029900            'DC LOCATION:  '.                                     02990000
030000     05  HL2-LOCATION.                                            03000000
030100         10  HL2-OPER-ID             PIC  X(04) VALUE SPACES.     03010000
030200         10  FILLER                  PIC  X(01) VALUE SPACES.     03020000
030300         10  FILLER                  PIC  X(01) VALUE '-'.        03030000
030400         10  FILLER                  PIC  X(01) VALUE SPACES.     03040000
030500         10  HL2-LOC-DESC            PIC  X(25) VALUE SPACES.     03050000
030600                                                                  03060000
030700 01  HL-HEADING-LINE-3.                                           03070000
030800     05  FILLER                      PIC  X(44)  VALUE            03080000
030900      'TRANSACTION TYPE     ERROR CODE             '.             03090000
031000     05  FILLER                      PIC  X(39)  VALUE            03100000
031100      '                                       '.                  03110000
031200     05  FILLER                      PIC  X(49)  VALUE            03120000
031300      'TRANS QTY                                      '.          03130000
031400                                                                  03140000
031500 01  DL-DETAIL-LINE-1.                                            03150000
031600     05  DL1-TRAN-TYPE                PIC X(16).                  03160000
031700     05  FILLER                       PIC X(05) VALUE SPACES.     03170000
031800     05  DL1-ERR-CDE                  PIC 9(03).                  03180000
031900     05  FILLER                       PIC X(01) VALUE SPACES.     03190000
032000     05  FILLER                       PIC X(01) VALUE '-'.        03200000
032100     05  FILLER                       PIC X(01) VALUE SPACES.     03210000
032200     05  DL1-ERR-DESC                 PIC X(50).                  03220000
032300     05  FILLER                       PIC X(06) VALUE SPACES.     03230000
032400     05  DL1-TRANS-QTY                PIC ZZZ,ZZ9-.               03240000
032500     05  FILLER                       PIC X(02) VALUE SPACES.     03250000
032600                                                                  03260000
032700 01  TL1-DC-TOTAL-LINE.                                           03270000
032800     05  FILLER                       PIC X(69) VALUE SPACES.     03280000
032900     05  FILLER                       PIC X(10) VALUE             03290000
033000         'DC TOTAL  '.                                            03300000
033100     05  TL1-TRANS-QTY                PIC ZZZ,ZZZ,ZZ9-.           03310000
033200     05  FILLER                       PIC X(1) VALUE SPACES.      03320000
033300                                                                  03330000
033400 01  RC1-RECAP-LINE.                                              03340000
033500     05  FILLER                       PIC X(44) VALUE             03350000
033600      'DIVERT INFORMATION RECAP                    '.             03360000
033700     05  FILLER                       PIC X(44)  VALUE            03370000
033800      '                                            '.             03380000
033900     05  FILLER                       PIC X(44)  VALUE            03390000
034000      '                                            '.             03400000
034100                                                                  03410000
034200 01  RC2-RECAP-LINE.                                              03420000
034300     05  FILLER                       PIC X(44) VALUE             03430000
034400      '  NUMBER OF LOGGED DOOR DIVERTS.............'.             03440000
034500     05  FILLER                       PIC X(22)  VALUE            03450000
034600      '...............:  '.                                       03460000
034700     05  RC2-TOTAL-DIVERTS            PIC ZZZ,ZZ9.                03470000
034800     05  FILLER                       PIC X(15)  VALUE            03480000
034900      '              '.                                           03490000
035000     05  FILLER                       PIC X(44)  VALUE            03500000
035100      '                                            '.             03510000
035200                                                                  03520000
035300 01  RC3-RECAP-LINE.                                              03530000
035400     05  FILLER                       PIC X(43) VALUE             03540000
035500      '                               TO SHIPPING '.              03550000
035600     05  FILLER                       PIC X(23)  VALUE            03560000
035700      'DOOR............:  '.                                      03570000
035800     05  RC3-SHIPPING-DOOR            PIC ZZZ,ZZZ.                03580000
035900     05  FILLER                       PIC X(02)  VALUE            03590000
036000      ' ('.                                                       03600000
036100     05  RC3-SHIPPING-PERCENT         PIC ZZZ.ZZZ.                03610000
036200     05  FILLER                       PIC X(02)  VALUE            03620000
036300      '%)'.                                                       03630000
036400     05  FILLER                       PIC X(15)  VALUE            03640000
036500      '              '.                                           03650000
036600     05  FILLER                       PIC X(44)  VALUE            03660000
036700      '                                            '.             03670000
036800                                                                  03680000
036900 01  RC4-RECAP-LINE.                                              03690000
037000     05  FILLER                       PIC X(42) VALUE             03700000
037100      '                               TO STORAGE '.               03710000
037200     05  FILLER                       PIC X(24)  VALUE            03720000
037300      'DOOR.............:  '.                                     03730000
037400     05  RC4-STORAGE-DOOR             PIC ZZZ,ZZ9.                03740000
037500     05  FILLER                       PIC X(02)  VALUE            03750000
037600      ' ('.                                                       03760000
037700     05  RC4-STORAGE-PERCENT          PIC ZZZ.ZZZ.                03770000
037800     05  FILLER                       PIC X(02)  VALUE            03780000
037900      '%)'.                                                       03790000
038000     05  FILLER                       PIC X(15)  VALUE            03800000
038100      '              '.                                           03810000
038200     05  FILLER                       PIC X(44)  VALUE            03820000
038300      '                                            '.             03830000
038400                                                                  03840000
038500 01  RC5-RECAP-LINE.                                              03850000
038600     05  FILLER                       PIC X(42) VALUE             03860000
038700      '                               TO SHUTTLE '.               03870000
038800     05  FILLER                       PIC X(24)  VALUE            03880000
038900      'DOOR.............:  '.                                     03890000
039000     05  RC5-SHUTTLE-DOOR             PIC ZZZ,ZZ9.                03900000
039100     05  FILLER                       PIC X(02)  VALUE            03910000
039200      ' ('.                                                       03920000
039300     05  RC5-SHUTTLE-PERCENT          PIC ZZZ.ZZZ.                03930000
039400     05  FILLER                       PIC X(02)  VALUE            03940000
039500      '%)'.                                                       03950000
039600     05  FILLER                       PIC X(15)  VALUE            03960000
039700      '              '.                                           03970000
039800     05  FILLER                       PIC X(44)  VALUE            03980000
039900      '                                            '.             03990000
040000                                                                  04000000
040100 01  RC6-RECAP-LINE.                                              04010000
040200     05  FILLER                       PIC X(42) VALUE             04020000
040300      '                               OTHER......'.               04030000
040400     05  FILLER                       PIC X(24)  VALUE            04040000
040500      '.................:  '.                                     04050000
040600     05  RC6-OTHER                    PIC ZZZ,ZZ9.                04060000
040700     05  FILLER                       PIC X(02)  VALUE            04070000
040800      ' ('.                                                       04080000
040900     05  RC6-OTHER-PERCENT            PIC ZZZ.ZZZ.                04090000
041000     05  FILLER                       PIC X(02)  VALUE            04100000
041100      '%)'.                                                       04110000
041200     05  FILLER                       PIC X(15)  VALUE            04120000
041300      '              '.                                           04130000
041400     05  FILLER                       PIC X(44)  VALUE            04140000
041500      '                                            '.             04150000
041600                                                                  04160000
041700 01  RC7-RECAP-LINE.                                              04170000
041800     05  FILLER                       PIC X(42) VALUE             04180000
041900      '  NUMBER OF DUPLICATE LOGGED DOOR DIVERTS.'.               04190000
042000     05  FILLER                       PIC X(24)  VALUE            04200000
042100      '.................:  '.                                     04210000
042200     05  RC7-DUPLICATE-DIVERTS        PIC ZZZ,ZZ9.                04220000
042300     05  FILLER                       PIC X(02)  VALUE            04230000
042400      ' ('.                                                       04240000
042500     05  RC7-DUPLICATE-PERCENT        PIC ZZZ.ZZZ.                04250000
042600     05  FILLER                       PIC X(02)  VALUE            04260000
042700      '%)'.                                                       04270000
042800     05  FILLER                       PIC X(15)  VALUE            04280000
042900      '              '.                                           04290000
043000     05  FILLER                       PIC X(44)  VALUE            04300000
043100      '                                            '.             04310000
043200                                                                  04320000
043300 01  RC8-RECAP-LINE.                                              04330000
043400     05  FILLER                       PIC X(42) VALUE             04340000
043500      '  NUMBER OF LOGGED DOOR DIVERTS W/O CARTON'.               04350000
043600     05  FILLER                       PIC X(24)  VALUE            04360000
043700      ' INFO............:  '.                                     04370000
043800     05  RC8-NO-INFO-DIVERTS          PIC ZZZ,ZZ9.                04380000
043900     05  FILLER                       PIC X(02)  VALUE            04390000
044000      ' ('.                                                       04400000
044100     05  RC8-NO-INFO-PERCENT          PIC ZZZ.ZZZ.                04410000
044200     05  FILLER                       PIC X(02)  VALUE            04420000
044300      '%)'.                                                       04430000
044400     05  FILLER                       PIC X(15)  VALUE            04440000
044500      '              '.                                           04450000
044600     05  FILLER                       PIC X(44)  VALUE            04460000
044700      '                                            '.             04470000
044800                                                                  04480000
044900 01  RC9-RECAP-LINE.                                              04490000
045000     05  FILLER                       PIC X(45) VALUE             04500000
045100      '  NUMBER OF LOGGED DOOR DIVERTS WITH INACTIVE'.            04510000
045200     05  FILLER                       PIC X(21)  VALUE            04520000
045300      ' CARTON INFO..:  '.                                        04530000
045400     05  RC9-INACTIVE-DIVERTS         PIC ZZZ,ZZ9.                04540000
045500     05  FILLER                       PIC X(02)  VALUE            04550000
045600      ' ('.                                                       04560000
045700     05  RC9-INACTIVE-PERCENT         PIC ZZZ.ZZZ.                04570000
045800     05  FILLER                       PIC X(02)  VALUE            04580000
045900      '%)'.                                                       04590000
046000     05  FILLER                       PIC X(15)  VALUE            04600000
046100      '              '.                                           04610000
046200     05  FILLER                       PIC X(44)  VALUE            04620000
046300      '                                            '.             04630000
046400                                                                  04640000
046500 01  ER-END-OF-REPORT-LINE.                                       04650000
046600     05  FILLER                       PIC X(19)  VALUE            04660000
046700         '** END OF REPORT **'.                                   04670000
046800     05  FILLER                       PIC X(113)  VALUE SPACES.   04680000
046900                                                                  04690000
047000 01  EP-EMPTY-REPORT-LINE.                                        04700000
047100     05  FILLER                       PIC X(34)  VALUE SPACES.    04710000
047200     05  FILLER                       PIC X(52)  VALUE            04720000
047300      '*************** EMPTY INPUT FILE *******************'.     04730000
047400     05  FILLER                       PIC X(49)  VALUE SPACES.    04740000
047500                                                                  04750000
047600 01  DL-BLANK-LINE                    PIC X(132) VALUE SPACES.    04760000
047700                                                                  04770000
047800 01  EL1-ERROR-LINE-1P.                                           04780000
047900     05  FILLER                      PIC  X(02)     VALUE SPACES. 04790000
048000     05  FILLER                      PIC  X(48)     VALUE         04800000
048100         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      04810000
048200     05  FILLER                      PIC  X(49)     VALUE         04820000
048300         'CREATING YOUR REPORT.   THIS REPORT COULD NOT BE '.     04830000
048400     05  FILLER                      PIC  X(33)     VALUE         04840000
048500         'COMPLETED.                       '.                     04850000
048600                                                                  04860000
048700 01  EL2-ERROR-LINE-2F.                                           04870000
048800     05  FILLER                      PIC  X(02)     VALUE SPACES. 04880000
048900     05  FILLER                      PIC  X(36)     VALUE         04890000
049000         'NONE OF YOUR REPORTS WERE CREATED.  '.                  04900000
049100     05  FILLER                      PIC  X(36)     VALUE         04910000
049200         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  04920000
049300     05  FILLER                      PIC  X(58)     VALUE SPACES. 04930000
049400                                                                  04940000
049500 01  EL3-ERROR-LINE-3.                                            04950000
049600     05  FILLER                      PIC  X(02)     VALUE SPACES. 04960000
049700     05  FILLER                      PIC  X(50)     VALUE         04970000
049800         'YOUR REQUEST WAS AS FOLLOWS:                      '.    04980000
049900     05  FILLER                      PIC  X(81)     VALUE SPACES. 04990000
050000                                                                  05000000
050100 01  EL4-ERROR-LINE-4.                                            05010000
050200     05  FILLER                      PIC  X(02)     VALUE SPACES. 05020000
050300     05  FILLER                      PIC  X(18)     VALUE         05030000
050400         'REQUESTOR       : '.                                    05040000
050500     05  EL4-REQUESTOR-ID            PIC  X(10)     VALUE SPACES. 05050000
050600     05  FILLER                      PIC  X(07)     VALUE SPACES. 05060000
050700     05  FILLER                      PIC  X(21)     VALUE         05070000
050800         'PRINTER DESTINATION: '.                                 05080000
050900     05  EL4-PRINTER-ID              PIC  X(10)     VALUE SPACES. 05090000
051000     05  FILLER                      PIC  X(65)     VALUE SPACES. 05100000
051100                                                                  05110000
051200 01  EL5-ERROR-LINE-5B.                                           05120000
051300     05  FILLER                      PIC  X(02)     VALUE SPACES. 05130000
051400     05  FILLER                      PIC  X(18)     VALUE         05140000
051500         'START DATE RANGE: '.                                    05150000
051600     05  EL5-START-DATE-RANGE        PIC  X(10).                  05160000
051700     05  FILLER                      PIC  X(07)     VALUE SPACES. 05170000
051800     05  FILLER                      PIC  X(21)     VALUE         05180000
051900         'END DATE RANGE     : '.                                 05190000
052000     05  EL5-END-DATE-RANGE          PIC  X(10).                  05200000
052100     05  FILLER                      PIC  X(20)     VALUE SPACES. 05210000
052200/                                                                 05220000
052300******************************************************************05230000
052400*  RECORD LAYOUT FOR INPUT FILE                                   05240000
052500******************************************************************05250000
052600*    COPY DCLTUPLDER.                                             05260000
052700/                                                                 05270000
052800******************************************************************05280000
052900*  COPYBOOK FOR UPLOAD TRANSACTION CODES AND ERROR CODES.         05290000
053000******************************************************************05300000
053100     COPY PCWS208.                                                05310000
053200*                                                                 05320000
053600******************************************************************05360000
053700*  COPYBOOK USED BY MBS SYSTEM                                    05370000
053800******************************************************************05380000
053900     COPY DPWS003.                                                05390000
054000*                                                                 05400000
054100******************************************************************05410000
054200*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 05420000
054300******************************************************************05430000
054400     COPY DPWS024.                                                05440000
054500/                                                                 05450000
054600******************************************************************05460000
054700*  DB2 FORMATTED MESSAGE AREA                                     05470000
054800******************************************************************05480000
054900     COPY DPWS004.                                                05490000
055000/                                                                 05500000
055100******************************************************************05510000
055200* CORPORATE DATE ROUTINES                                         05520000
055300******************************************************************05530000
055400     COPY DPWS500.                                                05540000
055500/                                                                 05550000
055600******************************************************************05560000
055700*   DB2 SQL COMMUNICATION AREA                                    05570000
055800******************************************************************05580000
055900     EXEC SQL                                                     05590000
056000         INCLUDE SQLCA                                            05600000
056100     END-EXEC.                                                    05610000
056200*                                                                 05620000
056300     COPY SQLCA2.                                                 05630000
056400*                                                                 05640000
056500******************************************************************05650000
056600*   UPLOAD ERROR TABLE                                            05660000
056700******************************************************************05670000
056800*                                                                 05680000
056900     EXEC SQL                                                     05690000
057000         INCLUDE TUPLDER                                          05700000
057100     END-EXEC.                                                    05710000
057200*                                                                 05720000
057300******************************************************************05730000
057400*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE COMPANY CONTROL    05740000
057500*  TABLE                                                          05750000
057600******************************************************************05760000
057700     EXEC SQL                                                     05770000
057800          INCLUDE TCOCNTL                                         05780000
057900     END-EXEC.                                                    05790000
058000*                                                                 05800000
058100******************************************************************05810000
058200*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE COMPANY DC DOOR    05820000
058300*  TABLE                                                          05830000
058400******************************************************************05840000
058500     EXEC SQL                                                     05850000
058600          INCLUDE TCNDCDR                                         05860000
058700     END-EXEC.                                                    05870000
058800*                                                                 05880000
058900******************************************************************05890000
059000*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE OUTBOUND CARTON    05900000
059100*  TABLE                                                          05910000
059200******************************************************************05920000
059300     EXEC SQL                                                     05930000
059400          INCLUDE SUT00024                                        05940000
059500     END-EXEC.                                                    05950000
059600*                                                                 05960000
059700******************************************************************05970000
059800*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE CARTON DIVERT      05980000
059900*  TABLE                                                          05990000
060000******************************************************************06000000
060100*                                                                 06010000
060200     EXEC SQL                                                     06020000
060300          INCLUDE TSUCRDV                                         06030000
060400     END-EXEC.                                                    06040000
060500*                                                                 06050000
060600*  OUTBOUND LOCATION                                              06060000
060700     EXEC SQL                                                     06070000
060800          INCLUDE SUT00027                                        06080000
060900     END-EXEC.                                                    06090000
061000*                                                                 06100000
061001***************************************************************** 06100000
061010*  XLT_LOC                                                        06060000
061020     EXEC SQL                                                     06070000
061030          INCLUDE XLT00010                                        06080000
061040     END-EXEC.                                                    06090000
061050*                                                                 06100000
061100******************************************************************06110000
061200*  TSUCRDV CURSOR                                                *06120000
061300*  LEFT OUTER JOINS BRING BACK DATA FROM SPECIFIED TABLES - IF   *06130000
061400*  NO DATA IS RETIEVED FROM THESE TABLES FROM THE FETCH - THE    *06140000
061500*  NULL INDICATORS FOR THE APPROPRIATE FIELDS WILL BE SET - THE  *06150000
061600*  PROGRAM NEEDS TO EVALUATE THE NULL INDICATORS AFTER EACH      *06160000
061700*  FETCH                                                         *06170000
061800******************************************************************06180000
061900     EXEC SQL                                                     06190000
062000          DECLARE TSUCRDV-CSR CURSOR FOR                          06200000
062100           SELECT                                                 06210000
062200                  RV.SHIPT_UNT_ID                                 06220000
062300                , RV.OPER_UNT_ID                                  06230007
062400                , RV.DIVERT_NBR                                   06240000
062500                , RV.DIVERT_LOC_ID                                06250000
062600                , RV.DOOR_ID                                      06260000
062700                , RV.ACTV_CDE                                     06270000
062800                , RV.DIVERT_TMST                                  06280000
062900                                                                  06290000
063000                , LC.SHIPT_UNT_ID                                 06300000
063100                , LC.CRE_TMST                                     06310000
063200                , LC.OTBND_TRIP_ID                                06320000
063300                , LC.LOC_NBR                                      06330000
063400                , LC.SCN_CDE                                      06340000
063500                , LC.ACTV_CDE                                     06350000
063600                , TIMESTAMP(LC.CRE_TMST + 1 MICROSECOND)          06360000
063700                                                                  06370000
063800                , DR.DOOR_TYP_CDE                                 06380000
063900                                                                  06390000
064000                , CT.ACTV_IND                                     06400000
064100                , CT.CART_SRC_CDE                                 06410000
064200                , CT.CRE_DTE                                      06420001
064300                , CT.CRE_TM                                       06430001
064400                , CT.CRE_USR_ID                                   06440001
064500                                                                  06450000
064600             FROM TSUCRDV              RV                         06460000
064700                                                                  06470000
064800             LEFT OUTER JOIN                                      06480000
064900                 SUT_OTBND_LOC         LC                         06490000
065000             ON  RV.SHIPT_UNT_ID       = LC.SHIPT_UNT_ID          06500000
065100              AND LC.SCN_CDE           = 'SHON'                   06510000
065200              AND LC.ACTV_CDE          = 'A'                      06520000
065300              AND LC.CRE_TMST          < RV.DIVERT_TMST           06530000
065400                                                                  06540000
065500             LEFT OUTER JOIN                                      06550000
065600                 SUT_OTBND_CART        CT                         06560000
065700             ON  RV.SHIPT_UNT_ID       = CT.SHIPT_UNT_ID          06570000
065800                                                                  06580000
065900             LEFT OUTER JOIN                                      06590000
066000                 TCNDCDR               DR                         06600000
066100             ON  RV.OPER_UNT_ID        = DR.OPER_UNT_ID           06610000
066200             AND RV.DOOR_ID            = DR.DOOR_ID               06620000
066300                                                                  06630000
066400            WHERE RV.OPER_UNT_ID       =  :DK-OPER-ID             06640000
066500              AND RV.DIVERT_TMST       >  :DK-DB2-TMST-1          06650000
066600              AND RV.DIVERT_TMST       <  :DK-DB2-TMST-2          06660000
066700                                                                  06670000
066800                                                                  06680000
066900            ORDER BY RV.SHIPT_UNT_ID                              06690000
067000            WITH UR                                               06700000
067100     END-EXEC.                                                    06710000
067200/                                                                 06720000
067300******************************************************************06730000
067400 PROCEDURE DIVISION.                                              06740000
067500******************************************************************06750000
067600 0000-MAINLINE.                                                   06760000
067700                                                                  06770000
067800     OPEN INPUT  EXTRACT-FILE                                     06780000
067900     OPEN OUTPUT REPORT-FILE-1                                    06790000
068000                 SCAN-ON-EXTRACT-FILE                             06800000
068100                 INACTIVE-DIVERT-FILE                             06810003
068200                 UNKNOWN-DIVERT-FILE                              06820005
068300                 P2L-CARTON-EXTRACT-FILE.                         06830000
068400                                                                  06840000
068500     PERFORM 2100-READ-EXTRACT.                                   06850000
068600     PERFORM 1000-INITIALIZE.                                     06860000
068700     IF PS-END-OF-INPUT                                           06870000
068800         PERFORM 1300-NO-DETAIL-LINE                              06880000
068900     ELSE                                                         06890000
069000         MOVE PV-OPER-ID  TO DK-OPER-ID                           06900000
069100         PERFORM 8000-WRITE-MAIN-HEADINGS                         06910000
069200         PERFORM 2000-PROCESS-EXTRACT                             06920000
069300             UNTIL PS-END-OF-INPUT                                06930000
069400         PERFORM 1600-TRAN-TYPE                                   06940000
069500         PERFORM 3000-PRINT-DETAILS                               06950000
069600         PERFORM 1550-DC-TRANS-TOTAL                              06960000
069700         PERFORM 1350-DIVERT-INFO-RECAP                           06970000
069800         PERFORM 5000-DETERMINE-PERCENTS                          06980000
069900         PERFORM 5500-BUILD-RECAP                                 06990000
070000         PERFORM 5600-PRINT-RECAP                                 07000000
070100     END-IF.                                                      07010000
070200                                                                  07020000
070300     PERFORM 9000-EOJ.                                            07030000
070400                                                                  07040000
070500     GOBACK.                                                      07050000
070600                                                                  07060000
070700******************************************************************07070000
070800 1000-INITIALIZE.                                                 07080000
070900******************************************************************07090000
071000*                                                                 07100000
071100* LOAD SYSTEM DATE INTO HEADINGS                                  07110000
071200     ACCEPT SD-SYSTEM-DATE FROM DATE.                             07120000
071300     ACCEPT ST-SYSTEM-TIME FROM TIME.                             07130000
071400                                                                  07140000
071500     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              07150000
071600     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             07160000
071700     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               07170000
071800     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              07180000
071900     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            07190000
072000                                                                  07200000
072100     MOVE PC-CURRENT-PROGRAM-NAME                                 07210000
072200                                 TO DP132O-PROGRAM-NAME.          07220000
072300     MOVE 1                      TO DP132O-REPORT-NUMBER          07230000
072400                                    DP132O-PAGE-NUMBER.           07240000
072500                                                                  07250000
072600     MOVE UPLDER-PRC-TMST     TO PV-DB2-TMST                      07260000
072700                                 PV-DB2-DATE-1                    07270000
072800                                 PV-DB2-DATE-2.                   07280000
072900     MOVE PV-DB2-TMST-1       TO DK-DB2-TMST-1.                   07290000
073000     MOVE PV-DB2-TMST-2       TO DK-DB2-TMST-2.                   07300000
073100     MOVE PV-DB2-TMST-MM      TO PV-FORMAT-DATE-MM.               07310000
073200     MOVE PV-DB2-TMST-DD      TO PV-FORMAT-DATE-DD.               07320000
073300     MOVE PV-DB2-TMST-CCYY    TO PV-FORMAT-DATE-CCYY.             07330000
073400     MOVE PV-OPER-ID          TO PV-PREV-OPER-ID.                 07340000
073500     MOVE PV-UPLD-TRN-CDE     TO PV-PREV-UPLD-TRN-CDE.            07350000
073600     MOVE PV-ERR-CDE          TO PV-PREV-ERR-CDE.                 07360000
073700*                                                                 07370000
073800***************************************************************** 07380000
073900 1200-SELECT-OPER-DESC.                                           07390000
074000***************************************************************** 07400000
074100*                                                                 07410000
074300     MOVE DK-OPER-ID            TO XLT00010-LOC-NBR                       
074400     EXEC SQL                                                             
074500         SELECT                                                           
074600             LOC_NM                                                       
074850         INTO                                                             
074860             :XLT00010-LOC-NM                                             
074894         FROM                                                             
074895             XLT_LOC                                                      
074896         WHERE                                                            
074897             LOC_NBR  = :XLT00010-LOC-NBR                                 
074898          WITH UR                                                         
074910     END-EXEC.                                                            
074920                                                                          
074930     EVALUATE TRUE                                                        
074940         WHEN SQLCODE = ZERO                                              
074941         MOVE XLT00010-LOC-NM       TO PV-STORE-NAME                      
074970                                                                          
074980         WHEN SQLWARN0 NOT = SPACES                                       
074990         WHEN SQLCODE < ZERO                                              
074991         WHEN SQLCODE > ZERO                                              
074992             MOVE 'UNKNOWN'         TO PV-STORE-NAME                      
074997     END-EVALUATE.                                                        
074998                                                                          
074999                                                                          
076000*                                                                         
076100******************************************************************07610000
076200*  PRINT A 'NO INPUT' REPORT LINE.                                07620000
076300******************************************************************07630000
076400 1300-NO-DETAIL-LINE.                                             07640000
076500*                                                                 07650000
076600     PERFORM 8000-WRITE-MAIN-HEADINGS.                            07660000
076700                                                                  07670000
076800     WRITE REPORT-RECORD-1                                        07680000
076900       FROM EP-EMPTY-REPORT-LINE                                  07690000
077000         AFTER ADVANCING 3 LINES.                                 07700000
077100*                                                                 07710000
077200******************************************************************07720000
077300*  CONVEYOR DIVERT RECAP INFORMATION FOR THE DAY JUST COMPLETED.  07730000
077400******************************************************************07740000
077500 1350-DIVERT-INFO-RECAP.                                          07750000
077600*                                                                 07760000
077700     MOVE 0          TO PV-DUPLICATE-DIVERTS                      07770000
077800                        PV-NO-INFO-DIVERTS                        07780000
077900                        PV-INACTIVE-DIVERTS.                      07790000
078000     PERFORM 7050-OPEN-TSUCRDV-CSR.                               07800000
078100                                                                  07810000
078200     PERFORM 7070-FETCH-TSUCRDV-CSR.                              07820000
078300                                                                  07830000
078400     PERFORM 7060-PROCESS-TSUCRDV-CSR                             07840000
078500         UNTIL PS-END-OF-TSUCRDV-CSR.                             07850000
078600                                                                  07860000
078700     PERFORM 7080-CLOSE-TSUCRDV-CSR.                              07870000
078800*                                                                 07880000
078900******************************************************************07890000
079000 1400-SELECT-TCOCNTL.                                             07900000
079100******************************************************************07910000
079200*                                                                 07920000
079300     EXEC SQL                                                     07930000
079400         SELECT                                                   07940000
079500                (BTCH_PRC_DTE - 1 DAYS)                           07950000
079600         INTO  :COCNTL-BTCH-PRC-DTE                               07960000
079700         FROM TCOCNTL                                             07970000
079800         WHERE OPER_UNT_ID = 90                                   07980000
079900     END-EXEC.                                                    07990000
080000                                                                  08000000
080100*    TEST                                                         08010000
080200*    MOVE '2005-02-27'    TO COCNTL-BTCH-PRC-DTE                  08020000
080300*    TEST                                                         08030000
080400                                                                  08040000
080500     EVALUATE TRUE                                                08050000
080600         WHEN SQLCODE = +0                                        08060000
080700         WHEN SQLCODE = +100                                      08070000
080800         WHEN SQLCODE = -811                                      08080000
080900             MOVE COCNTL-BTCH-PRC-DTE TO PV-DB2-TMST              08090000
081000                                         PV-DB2-DATE-1            08100000
081100                                         PV-DB2-DATE-2            08110000
081200             MOVE PV-DB2-TMST-MM      TO PV-FORMAT-DATE-MM        08120000
081300             MOVE PV-DB2-TMST-DD      TO PV-FORMAT-DATE-DD        08130000
081400             MOVE PV-DB2-TMST-CCYY    TO PV-FORMAT-DATE-CCYY      08140000
081500         WHEN SQLCODE < ZERO                                      08150000
081600             MOVE '1400-SELECT-TCOCNTL'                           08160000
081700                                        TO PV-ABEND-PARAGRAPH     08170000
081800             MOVE 'SELECT'         TO PV-DB2-FUNCTION             08180000
081900             MOVE 'TCOCNTL        '   TO PV-DB2-TABLE-NAME        08190000
082000             PERFORM 9200-SQL-ABEND                               08200000
082100         WHEN SQLCODE > ZERO                                      08210000
082200         WHEN SQLWARN0 NOT = SPACES                               08220000
082300             MOVE '1400-SELECT-TCOCNTL'                           08230000
082400                                      TO PV-ABEND-PARAGRAPH       08240000
082500             MOVE 'SELECT'         TO PV-DB2-FUNCTION             08250000
082600             PERFORM 9300-SQL-WARNING                             08260000
082700     END-EVALUATE.                                                08270000
082800/                                                                 08280000
082900******************************************************************08290000
083000*  CHECK FOR CHANGE IN UPLD-TRN-CDE AND ERR-CDE.                  08300000
083100******************************************************************08310000
083200 1500-CHECK-KEY.                                                  08320000
083300*                                                                 08330000
083400     IF PV-UPLD-TRN-CDE  =  PV-PREV-UPLD-TRN-CDE AND              08340000
083500        PV-ERR-CDE       =  PV-PREV-ERR-CDE                       08350000
083600        SET PS-SAME-KEY     TO TRUE                               08360000
083700     ELSE                                                         08370000
083800        SET PS-NOT-SAME-KEY TO TRUE.                              08380000
083900*                                                                 08390000
084000******************************************************************08400000
084100*  WRITE TRANS QUANTITY FOR DC.                                   08410000
084200******************************************************************08420000
084300 1550-DC-TRANS-TOTAL.                                             08430000
084400*                                                                 08440000
084500     MOVE PV-DC-TRANS-QTY    TO TL1-TRANS-QTY.                    08450000
084600                                                                  08460000
084700     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     08470000
084800         AFTER ADVANCING 1 LINE.                                  08480000
084900                                                                  08490000
085000     WRITE REPORT-RECORD-1 FROM TL1-DC-TOTAL-LINE                 08500000
085100         AFTER ADVANCING 1 LINE.                                  08510000
085200                                                                  08520000
085300     ADD 2                   TO PV-LINE-COUNT.                    08530000
085400/                                                                 08540000
085500******************************************************************08550000
085600*  DETERMINE THE UPLOAD TRANSACTION TYPE.                         08560000
085700******************************************************************08570000
085800 1600-TRAN-TYPE.                                                  08580000
085900*                                                                 08590000
086000     EVALUATE TRUE                                                08600000
086100        WHEN PV-PREV-UPLD-TRN-CDE  = 'A'                          08610000
086200            MOVE 'PCC SML UPLOAD'     TO DL1-TRAN-TYPE            08620000
086300            PERFORM 1700-ERR-CDE-DESC                             08630000
086400                                                                  08640000
086500        WHEN PV-PREV-UPLD-TRN-CDE  = 'B'                          08650000
086600            MOVE 'CONVEYOR DIVERT'    TO DL1-TRAN-TYPE            08660000
086700            PERFORM 1800-ERR-CDE-DESC                             08670000
086800                                                                  08680000
086900        WHEN PV-PREV-UPLD-TRN-CDE  = 'C'                          08690000
087000            MOVE 'AL SML UPLOAD'      TO DL1-TRAN-TYPE            08700000
087100            PERFORM 1900-ERR-CDE-DESC                             08710000
087200                                                                  08720000
087210        WHEN PV-PREV-UPLD-TRN-CDE  = 'D'                          08690000
087220            MOVE 'P2L LABOR-PCKUT071' TO DL1-TRAN-TYPE            08700000
087230            PERFORM 1910-ERR-CDE-DESC                             08710000
087240                                                                  08720000
087250        WHEN PV-PREV-UPLD-TRN-CDE  = 'E'                          08690000
087260            MOVE 'TRLR INVALID STATUS' TO DL1-TRAN-TYPE                   
087270            PERFORM 1920-ERR-CDE-DESC                             08710000
087280                                                                  08720000
087290        WHEN PV-PREV-UPLD-TRN-CDE  = 'F'                          08690000
087291            MOVE 'LABOR EVENT ERRORS ' TO DL1-TRAN-TYPE                   
087292            PERFORM 1930-ERR-CDE-DESC                             08710000
087293                                                                  08720000
087294        WHEN PV-PREV-UPLD-TRN-CDE  = 'G'                          08690000
087295            MOVE 'TRACK MFST NBR     ' TO DL1-TRAN-TYPE                   
087296            PERFORM 1940-ERR-CDE-DESC                             08710000
087297                                                                  08720000
087298        WHEN PV-PREV-UPLD-TRN-CDE  = 'I'                          08690000
087299            MOVE 'BAD CASE RCPTS-EFC ' TO DL1-TRAN-TYPE                   
087300            PERFORM 1960-ERR-CDE-DESC                             08710000
087301                                                                  08720000
087302        WHEN PV-PREV-UPLD-TRN-CDE  = 'F'                          08690000
087303            MOVE 'LABOR EVENT ERRORS ' TO DL1-TRAN-TYPE                   
087304            PERFORM 1930-ERR-CDE-DESC                             08710000
087305                                                                  08720000
087310        WHEN OTHER                                                08730000
087400            MOVE '**UNKNOWN**'        TO DL1-TRAN-TYPE            08740000
087500            PERFORM 1690-UNKNOWN-TRAN-CDE                         08750000
087600                                                                  08760000
087700     END-EVALUATE.                                                08770000
087800*                                                                 08780000
087900******************************************************************08790000
088000*  UNKNOWN TRANSACTION CODE                                       08800000
088100******************************************************************08810000
088200 1690-UNKNOWN-TRAN-CDE.                                           08820000
088300*                                                                 08830000
088400     MOVE '**UNKNOWN**'        TO DL1-ERR-DESC.                   08840000
088500*                                                                 08850000
088600******************************************************************08860000
088700*  DETERMINE THE ERROR CODE DESCRIPTION WHEN                      08870000
088800*   UPLDER-UPLD-TRN-CDE = 'A'.                                    08880000
088900******************************************************************08890000
089000 1700-ERR-CDE-DESC.                                               08900000
089100*                                                                 08910000
089200     EVALUATE TRUE                                                08920000
089300       WHEN PV-PREV-ERR-CDE     =   '001'                         08930000
089400         MOVE                                                     08940000
089500           'TOTAL RECORDS NOT EQUAL QTY PASSED FROM P2L       '   08950000
089600                                       TO DL1-ERR-DESC            08960000
089700       WHEN PV-PREV-ERR-CDE     =   '002'                         08970000
089800         MOVE                                                     08980000
089900           'STORE NUMBER IS NOT NUMERIC                       '   08990000
090000                                       TO DL1-ERR-DESC            09000000
090100                                                                  09010000
090200       WHEN PV-PREV-ERR-CDE     =   '003'                         09020000
090300         MOVE                                                     09030000
090400           'REVISION NUMBER IS NOT NUMERIC                    '   09040000
090500                                       TO DL1-ERR-DESC            09050000
090600                                                                  09060000
090700       WHEN PV-PREV-ERR-CDE     =   '004'                         09070000
090800         MOVE                                                     09080000
090900           'FIRST 20 BYTES OF HEADER SML IS NOT NUMERIC       '   09090000
091000                                       TO DL1-ERR-DESC            09100000
091100                                                                  09110000
091200       WHEN PV-PREV-ERR-CDE     =   '005'                         09120000
091300         MOVE                                                     09130000
091400           'SML IS NOT A CODE-4 KOHLS LICENSE PLATE           '   09140000
091500                                       TO DL1-ERR-DESC            09150000
091600                                                                  09160000
091700       WHEN PV-PREV-ERR-CDE     =   '006'                         09170000
091800         MOVE                                                     09180000
091900           'CARTON DOES NOT HAVE P2L SOURCE CODE ON TSHPUNT   '   09190000
092000                                       TO DL1-ERR-DESC            09200000
092100                                                                  09210000
092200       WHEN PV-PREV-ERR-CDE     =   '007'                         09220000
092300         MOVE                                                     09230000
092400           'TRANSMITTED REVISION NBR LESS THAN ONE ON FILE    '   09240000
092500                                       TO DL1-ERR-DESC            09250000
092600                                                                  09260000
092700       WHEN PV-PREV-ERR-CDE     =   '008'                         09270000
092800         MOVE                                                     09280000
092900           'CARTON FOUND IN TSULBXF BUT NOT IN TSHPUNT        '   09290000
093000                                       TO DL1-ERR-DESC            09300000
093100                                                                  09310000
093200       WHEN PV-PREV-ERR-CDE     =   '009'                         09320000
093300         MOVE                                                     09330000
093400           'PACKED QTY NOT NUMERIC                            '   09340000
093500                                       TO DL1-ERR-DESC            09350000
093600                                                                  09360000
093700       WHEN PV-PREV-ERR-CDE     =   '010'                         09370000
093800         MOVE                                                     09380000
093900           'DISTRO NUMBER IS NOT NUMERIC                      '   09390000
094000                                       TO DL1-ERR-DESC            09400000
094100                                                                  09410000
094200       WHEN PV-PREV-ERR-CDE     =   '011'                         09420000
094300         MOVE                                                     09430000
094400           'UPLOADED CARTON FROM P2L HAD RE-USED SML NUMBER   '   09440000
094500                                       TO DL1-ERR-DESC            09450000
094600                                                                  09460000
094700       WHEN PV-PREV-ERR-CDE     =   '102'                         09470000
094800         MOVE                                                     09480000
094900           'UPLOADED CARTON FROM P2L HAS NO UNITS ASSOCIATED  '   09490000
095000                                       TO DL1-ERR-DESC            09500000
095100                                                                  09510000
095200       WHEN PV-PREV-ERR-CDE  > '011' AND < '046'                  09520000
095300         MOVE                                                     09530000
095400           'DB2 ERRORS                                        '   09540000
095500                                       TO DL1-ERR-DESC            09550000
095600                                                                  09560000
095700       WHEN PV-PREV-ERR-CDE  > '047' AND < '050'                  09570000
095800         MOVE                                                     09580000
095900           'SOCKET ERRORS                                     '   09590000
096000                                       TO DL1-ERR-DESC            09600000
096100                                                                  09610000
096200       WHEN PV-PREV-ERR-CDE  > '058' AND < '100'                  09620000
096300         MOVE                                                     09630000
096400           'MORE DB2 ERRORS                                   '   09640000
096500                                       TO DL1-ERR-DESC            09650000
096600                                                                  09660000
096610       WHEN PV-PREV-ERR-CDE  = '102'                                      
096620         MOVE                                                     09630000
096630           'UPLOADED CARTON FROM P2L DOES NOT HAVE ANY UNITS  '   09640000
096640                                       TO DL1-ERR-DESC            09650000
096650                                                                  09660000
096700       WHEN OTHER                                                 09670000
096800         MOVE '**UNKNOWN**'            TO DL1-ERR-DESC            09680000
096900                                                                  09690000
097000     END-EVALUATE.                                                09700000
097100*                                                                 09710000
097200******************************************************************09720000
097300*  DETERMINE THE ERROR CODE DESCRIPTION WHEN                      09730000
097400*   UPLDER-UPLD-TRN-CDE = 'B'.                                    09740000
097500******************************************************************09750000
097600 1800-ERR-CDE-DESC.                                               09760000
097700*                                                                 09770000
097800     EVALUATE TRUE                                                09780000
097900       WHEN PV-PREV-ERR-CDE     =   '100'                         09790000
098000         MOVE                                                     09800000
098100           'SML IS NOT A CODE-4 KOHLS LICENSE PLATE           '   09810000
098200                                       TO DL1-ERR-DESC            09820000
098300                                                                  09830000
098400       WHEN PV-PREV-ERR-CDE     =   '101'                         09840000
098500         MOVE                                                     09850000
098600           'DOOR AND DIVERTER NOT DEFINED IN THIS DC          '   09860000
098700                                       TO DL1-ERR-DESC            09870000
098800                                                                  09880000
098900       WHEN PV-PREV-ERR-CDE     =   '102'                         09890000
099000         MOVE                                                     09900000
099100           'SHIPT-UNT-ID ,DC-NBR OR DIVERT NBR NOT NUMERIC    '   09910000
099200                                       TO DL1-ERR-DESC            09920000
099300                                                                  09930000
099400       WHEN PV-PREV-ERR-CDE     =   '103'                         09940000
099500         MOVE                                                     09950000
099600           'DUPLICATE CARTON                                  '   09960000
099700                                       TO DL1-ERR-DESC            09970000
099800                                                                  09980000
099900       WHEN PV-PREV-ERR-CDE     =   '104'                         09990000
100000         MOVE                                                     10000000
100100           'TROUBLE SHOOTING LOGGING                          '   10010000
100200                                       TO DL1-ERR-DESC            10020000
100300                                                                  10030000
100400       WHEN PV-PREV-ERR-CDE     =   '105'                         10040000
100500         MOVE                                                     10050000
100600           'NO READ                                           '   10060000
100700                                       TO DL1-ERR-DESC            10070000
100800                                                                  10080000
100900       WHEN PV-PREV-ERR-CDE     =   '106'                         10090000
101000         MOVE                                                     10100000
101100           'CONVEYOR TO CONVEYOR                              '   10110000
101200                                       TO DL1-ERR-DESC            10120000
101300                                                                  10130000
101400       WHEN PV-PREV-ERR-CDE     =   '107'                         10140000
101500         MOVE                                                     10150000
101600           'INVALID STORE NUMBER                              '   10160000
101700                                       TO DL1-ERR-DESC            10170000
101800                                                                  10180000
101900       WHEN PV-PREV-ERR-CDE     =   '108'                         10190000
102000         MOVE                                                     10200000
102100           'DUPLICATE CARTON BUT DIFFERENT DC                 '   10210000
102200                                       TO DL1-ERR-DESC            10220000
102300                                                                  10230000
102400       WHEN PV-PREV-ERR-CDE     =   '109'                         10240000
102500         MOVE                                                     10250000
102600           'DUPLICATE CARTON WITH SAME DATE AND TIME          '   10260000
102700                                       TO DL1-ERR-DESC            10270000
102800                                                                  10280000
102900       WHEN OTHER                                                 10290000
103000         MOVE '**UNKNOWN**'            TO DL1-ERR-DESC            10300000
103100                                                                  10310000
103200     END-EVALUATE.                                                10320000
103300*                                                                 10330000
103400******************************************************************10340000
103500*  DETERMINE THE ERROR CODE DESCRIPTION WHEN                      10350000
103600*   UPLDER-UPLD-TRN-CDE = 'C'.                                    10360000
103700******************************************************************10370000
103800 1900-ERR-CDE-DESC.                                               10380000
103900*                                                                 10390000
104000     EVALUATE TRUE                                                10400000
104100       WHEN PV-PREV-ERR-CDE     =   '001'                         10410000
104200         MOVE                                                     10420000
104300           'TOTAL RECORDS NOT EQUAL QTY PASSED FROM P2L       '   10430000
104400                                       TO DL1-ERR-DESC            10440000
104500                                                                  10450000
104600       WHEN PV-PREV-ERR-CDE     =   '002'                         10460000
104700         MOVE                                                     10470000
104800           'STORE NUMBER IS NOT NUMERIC                       '   10480000
104900                                       TO DL1-ERR-DESC            10490000
105000                                                                  10500000
105100       WHEN PV-PREV-ERR-CDE     =   '003'                         10510000
105200         MOVE                                                     10520000
105300           'REVISION NUMBER IS NOT NUMERIC                    '   10530000
105400                                       TO DL1-ERR-DESC            10540000
105500                                                                  10550000
105600       WHEN PV-PREV-ERR-CDE     =   '004'                         10560000
105700         MOVE                                                     10570000
105800           'FIRST 20 BYTES OF HEADER SML IS NOT NUMERIC       '   10580000
105900                                       TO DL1-ERR-DESC            10590000
106000                                                                  10600000
106100       WHEN PV-PREV-ERR-CDE     =   '005'                         10610000
106200         MOVE                                                     10620000
106300           'SML IS NOT A CODE-4 KOHLS LICENSE PLATE           '   10630000
106400                                       TO DL1-ERR-DESC            10640000
106500                                                                  10650000
106600       WHEN PV-PREV-ERR-CDE     =   '006'                         10660000
106700         MOVE                                                     10670000
106800           'CARTON DOES NOT HAVE P2L SOURCE CODE ON TSHPUNT   '   10680000
106900                                       TO DL1-ERR-DESC            10690000
107000                                                                  10700000
107100       WHEN PV-PREV-ERR-CDE     =   '007'                         10710000
107200         MOVE                                                     10720000
107300           'TRANSMITTED REVISION NBR LESS THAN ONE ON FILE    '   10730000
107400                                       TO DL1-ERR-DESC            10740000
107500                                                                  10750000
107600       WHEN PV-PREV-ERR-CDE     =   '008'                         10760000
107700         MOVE                                                     10770000
107800           'CARTON FOUND IN TSULBXF BUT NOT IN TSHPUNT        '   10780000
107900                                       TO DL1-ERR-DESC            10790000
108000                                                                  10800000
108100       WHEN PV-PREV-ERR-CDE     =   '009'                         10810000
108200         MOVE                                                     10820000
108300           'PACKED QTY NOT NUMERIC                            '   10830000
108400                                       TO DL1-ERR-DESC            10840000
108500                                                                  10850000
108600       WHEN PV-PREV-ERR-CDE     =   '010'                         10860000
108700         MOVE                                                     10870000
108800           'DISTRO NUMBER IS NOT NUMERIC                      '   10880000
108900                                       TO DL1-ERR-DESC            10890000
109000                                                                  10900000
109100       WHEN PV-PREV-ERR-CDE     =   '011'                         10910000
109200         MOVE                                                     10920000
109300           'UPLOADED CARTON FROM P2L HAD RE-USED SML NUMBER   '   10930000
109400                                       TO DL1-ERR-DESC            10940000
109500                                                                  10950000
109600       WHEN PV-PREV-ERR-CDE     =   '101'                         10960000
109700         MOVE                                                     10970000
109800           '22 DIGIT SML NBR UPLOADED                         '   10980000
109900                                       TO DL1-ERR-DESC            10990000
110000                                                                  11000000
110100       WHEN PV-PREV-ERR-CDE     =   '102'                         11010000
110200         MOVE                                                     11020000
110300           'UPLOADED CARTON FROM P2L HAS NO UNITS ASSOCIATED  '   11030000
110400                                       TO DL1-ERR-DESC            11040000
110500                                                                  11050000
110600       WHEN PV-PREV-ERR-CDE  > '011' AND < '051'                  11060000
110700         MOVE                                                     11070000
110800           'DB2 ERRORS                                        '   11080000
110900                                       TO DL1-ERR-DESC            11090000
111000                                                                  11100000
111100       WHEN PV-PREV-ERR-CDE  > '052' AND < '057'                  11110000
111200         MOVE                                                     11120000
111300           'SOCKET ERRORS                                     '   11130000
111400                                       TO DL1-ERR-DESC            11140000
111500                                                                  11150000
111600       WHEN PV-PREV-ERR-CDE  > '058' AND < '100'                  11160000
111700         MOVE                                                     11170000
111800           'MORE DB2 ERRORS                                   '   11180000
111900                                       TO DL1-ERR-DESC            11190000
112000                                                                  11200000
112100       WHEN OTHER                                                 11210000
112200         MOVE '**UNKNOWN**'            TO DL1-ERR-DESC            11220000
112300                                                                  11230000
112400     END-EVALUATE.                                                11240000
112500*                                                                 11250000
112510******************************************************************10340000
112520*  DETERMINE THE ERROR CODE DESCRIPTION WHEN                      10350000
112530*   UPLDER-UPLD-TRN-CDE = 'D'.                                    10360000
112540******************************************************************10370000
112550 1910-ERR-CDE-DESC.                                               10380000
112560*                                                                 10390000
112570     EVALUATE TRUE                                                10400000
112580       WHEN PV-PREV-ERR-CDE     =   '001'                         10410000
112590         MOVE                                                     10420000
112591           'ERROR FROM COMMUNICATION AREA                     '   10430000
112592                                       TO DL1-ERR-DESC            10440000
112593                                                                  10450000
112594       WHEN PV-PREV-ERR-CDE     =   '002'                         10460000
112595         MOVE                                                     10470000
112596           'SQL ERROR                                         '   10480000
112597                                       TO DL1-ERR-DESC            10490000
112598                                                                  10500000
112599       WHEN PV-PREV-ERR-CDE     =   '003'                         10510000
112600         MOVE                                                     10520000
112601           'INVALID DATA                                      '   10530000
112602                                       TO DL1-ERR-DESC            10540000
112603                                                                  10550000
112604       WHEN PV-PREV-ERR-CDE     =   '101'                         10560000
112605         MOVE                                                     10570000
112606           'INVALID MESSAGE TYPE                              '   10580000
112607                                       TO DL1-ERR-DESC            10590000
112608                                                                  10600000
112609       WHEN PV-PREV-ERR-CDE     =   '102'                         10610000
112610         MOVE                                                     10620000
112611           'DATA ELEMENT EXCEPTION                            '   10630000
112612                                       TO DL1-ERR-DESC            10640000
112613                                                                  10650000
112614       WHEN PV-PREV-ERR-CDE     =   '103'                         10660000
112615         MOVE                                                     10670000
112616           'NO LABOR MODULE TO CALL FOR MESSAGE TYPE          '   10680000
112617                                       TO DL1-ERR-DESC            10690000
112618                                                                  10700000
112619       WHEN PV-PREV-ERR-CDE     =   '104'                         10710000
112620         MOVE                                                     10720000
112621           'MQ OPEN ERRORGE TYPE                              '   10730000
112622                                       TO DL1-ERR-DESC            10740000
112623                                                                  10750000
112624       WHEN PV-PREV-ERR-CDE     =   '105'                         10760000
112625         MOVE                                                     10770000
112626           'MQ GET MESSAGE ERROR                            - '   10780000
112627                                       TO DL1-ERR-DESC            10790000
112628                                                                  10800000
112629       WHEN PV-PREV-ERR-CDE     =   '106'                         10810000
112630         MOVE                                                     10820000
112631           'WSV_CNSMR_QUE SQL ERROR                           '   10830000
112632                                       TO DL1-ERR-DESC            10840000
112633                                                                  10850000
112634       WHEN PV-PREV-ERR-CDE     =   '107'                         10860000
112635         MOVE                                                     10870000
112636           'MQ CONNECT ERROR                                  '   10880000
112637                                       TO DL1-ERR-DESC            10890000
112638                                                                  10900000
112639       WHEN PV-PREV-ERR-CDE     =   '108'                         10910000
112640         MOVE                                                     10920000
112641           'MESSAGE TRUNCATED ERROR                           '   10930000
112642                                       TO DL1-ERR-DESC            10940000
112643                                                                  10950000
112644       WHEN PV-PREV-ERR-CDE     =   '109'                         10960000
112645         MOVE                                                     10970000
112646           'MQ CLOSE ERROR                                    '   10980000
112647                                       TO DL1-ERR-DESC            10990000
112648                                                                  11000000
112649       WHEN PV-PREV-ERR-CDE     =   '110'                         11010000
112650         MOVE                                                     11020000
112651           'MQ DISCONNECT ERROR                               '   11030000
112652                                       TO DL1-ERR-DESC            11040000
112653                                                                  11050000
112654       WHEN PV-PREV-ERR-CDE  = '111'                                      
112655         MOVE                                                     11070000
112656           'MQ COMMIT ERROR                                   '   11080000
112657                                       TO DL1-ERR-DESC            11090000
112658                                                                  11100000
112659       WHEN PV-PREV-ERR-CDE  = '112'                                      
112660         MOVE                                                     11120000
112661           'UNSUCCESSFUL CALL TO LABOR MODULE                 '   11130000
112662                                       TO DL1-ERR-DESC            11140000
112663                                                                  11150000
112664       WHEN PV-PREV-ERR-CDE  = '113'                                      
112665         MOVE                                                     11170000
112666           'INVALID USER ID                                   '   11180000
112667                                       TO DL1-ERR-DESC            11190000
112668                                                                  11200000
112669       WHEN OTHER                                                 11210000
112670         MOVE '**UNKNOWN**'            TO DL1-ERR-DESC            11220000
112671                                                                  11230000
112672     END-EVALUATE.                                                11240000
112673*                                                                 11250000
112674******************************************************************10340000
112675*  DETERMINE THE ERROR CODE DESCRIPTION WHEN                      10350000
112676*   UPLDER-UPLD-TRN-CDE = 'E'.                                    10360000
112677******************************************************************10370000
112678 1920-ERR-CDE-DESC.                                               10380000
112679*                                                                 10390000
112680     EVALUATE TRUE                                                10400000
112681       WHEN PV-PREV-ERR-CDE     =   '101'                         10410000
112682         MOVE                                                     10420000
112683           'MAIL SENT TO DC LP TO UPDATE TRIP STATUS - SH TRLR'   10430000
112684                                       TO DL1-ERR-DESC            10440000
112685                                                                  10450000
112686       WHEN PV-PREV-ERR-CDE     =   '102'                         10460000
112687         MOVE                                                     10470000
112688           'STR ENTERED SEAL FOR NON SH TRLR - NO EMAIL SENT  '   10480000
112689                                       TO DL1-ERR-DESC            10490000
112690                                                                          
112761       WHEN OTHER                                                 11210000
112762         MOVE '**UNKNOWN**'            TO DL1-ERR-DESC            11220000
112763                                                                  11230000
112764     END-EVALUATE.                                                11240000
112765*                                                                 11250000
112766******************************************************************10340000
112767*  DETERMINE THE ERROR CODE DESCRIPTION WHEN                      10350000
112768*   UPLDER-UPLD-TRN-CDE = 'F'.                                    10360000
112769******************************************************************10370000
112770 1930-ERR-CDE-DESC.                                               10380000
112771*                                                                 10390000
112772     EVALUATE TRUE                                                10400000
112773       WHEN PV-PREV-ERR-CDE     =   '101'                         10410000
112774         MOVE                                                     10420000
112775           'ASSOCIATE WAS ON MULTIPLE ASSIGNMENTS             '   10430000
112776                                       TO DL1-ERR-DESC            10440000
112777                                                                  10450000
112778       WHEN PV-PREV-ERR-CDE     =   '102'                         10460000
112779         MOVE                                                     10470000
112780           'MULT ASSIGNMENTS FOR DC/WORK TYPE/WORK AREA       '   10480000
112781                                       TO DL1-ERR-DESC            10490000
112782                                                                          
112783       WHEN OTHER                                                 11210000
112784         MOVE '**UNKNOWN**'            TO DL1-ERR-DESC            11220000
112785                                                                  11230000
112786     END-EVALUATE.                                                11240000
112787*                                                                 11250000
112788******************************************************************10340000
112789*  DETERMINE THE ERROR CODE DESCRIPTION WHEN                      10350000
112790*   UPLDER-UPLD-TRN-CDE = 'G'.                                    10360000
112791******************************************************************10370000
112792 1940-ERR-CDE-DESC.                                               10380000
112793*                                                                 10390000
112794     EVALUATE TRUE                                                10400000
112795       WHEN PV-PREV-ERR-CDE     =   '101'                         10410000
112796         MOVE                                                     10420000
112797           'TRACK CARTON MANIFEST                             '   10430000
112798                                       TO DL1-ERR-DESC            10440000
112799                                                                  10450000
112800       WHEN PV-PREV-ERR-CDE     =   '102'                         10460000
112801         MOVE                                                     10470000
112802           'TRACKING SML MANIFEST NUMBER                      '   10480000
112803                                       TO DL1-ERR-DESC            10490000
112804                                                                  10450000
112805       WHEN PV-PREV-ERR-CDE     =   '103'                         10460000
112806         MOVE                                                     10470000
112807           'TRACK LABEL REQUEST                               '   10480000
112808                                       TO DL1-ERR-DESC            10490000
112809                                                                          
112810       WHEN OTHER                                                 11210000
112811         MOVE '**UNKNOWN**'            TO DL1-ERR-DESC            11220000
112812                                                                  11230000
112813     END-EVALUATE.                                                11240000
112814*                                                                 11250000
112815******************************************************************10340000
112816*  DETERMINE THE ERROR CODE DESCRIPTION WHEN                      10350000
112817*   UPLDER-UPLD-TRN-CDE = 'I'.                                    10360000
112818******************************************************************10370000
112819 1960-ERR-CDE-DESC.                                               10380000
112820*                                                                 10390000
112821     EVALUATE TRUE                                                10400000
112822       WHEN PV-PREV-ERR-CDE     =   '001'                         10410000
112823         MOVE                                                     10420000
112824           'CASE RECEIPT CAME THRU WITH INCORRECT PO          '   10430000
112825                                       TO DL1-ERR-DESC            10440000
112826                                                                  10450000
112827       WHEN PV-PREV-ERR-CDE     =   '002'                         10460000
112828         MOVE                                                     10470000
112829           'CASE RECEIPT RECEIVED - RECEIVER ALREADY VERIFIED '   10480000
112830                                       TO DL1-ERR-DESC            10490000
112831                                                                  10450000
112832       WHEN PV-PREV-ERR-CDE     =   '003'                         10460000
112833         MOVE                                                     10470000
112834           'CASE RECEIPT PREVIOUSLY RECEIVED - WMU            '   10480000
112835                                       TO DL1-ERR-DESC            10490000
112836                                                                          
112837       WHEN OTHER                                                 11210000
112838         MOVE '**UNKNOWN**'            TO DL1-ERR-DESC            11220000
112839                                                                  11230000
112840     END-EVALUATE.                                                11240000
112841*                                                                 11250000
112842******************************************************************11260000
112843 2000-PROCESS-EXTRACT.                                            11270000
112850******************************************************************11280000
112900*                                                                 11290000
113000     IF PV-OPER-ID  = PV-PREV-OPER-ID                             11300000
113100        PERFORM 1500-CHECK-KEY                                    11310000
113200           IF PS-SAME-KEY                                         11320000
113300              CONTINUE                                            11330000
113400           ELSE                                                   11340000
113500              PERFORM 1600-TRAN-TYPE                              11350000
113600              PERFORM 3000-PRINT-DETAILS                          11360000
113700              MOVE PV-UPLD-TRN-CDE  TO PV-PREV-UPLD-TRN-CDE       11370000
113800              MOVE PV-ERR-CDE       TO PV-PREV-ERR-CDE            11380000
113900              INITIALIZE  PV-TRANS-QTY                            11390000
114000           END-IF                                                 11400000
114100     ELSE                                                         11410000
114200        PERFORM 1600-TRAN-TYPE                                    11420000
114300        PERFORM 3000-PRINT-DETAILS                                11430000
114400        PERFORM 1550-DC-TRANS-TOTAL                               11440000
114500        PERFORM 1350-DIVERT-INFO-RECAP                            11450000
114600        PERFORM 5000-DETERMINE-PERCENTS                           11460000
114700        PERFORM 5500-BUILD-RECAP                                  11470000
114800        PERFORM 5600-PRINT-RECAP                                  11480000
114900        MOVE PV-OPER-ID  TO PV-PREV-OPER-ID                       11490000
115000                            DK-OPER-ID                            11500000
115100        PERFORM 1200-SELECT-OPER-DESC                             11510000
115200        PERFORM 8000-WRITE-MAIN-HEADINGS                          11520000
115300        INITIALIZE  PV-DC-TRANS-QTY                               11530000
115400        MOVE PV-UPLD-TRN-CDE  TO PV-PREV-UPLD-TRN-CDE             11540000
115500        MOVE PV-ERR-CDE       TO PV-PREV-ERR-CDE                  11550000
115600        INITIALIZE  PV-TRANS-QTY                                  11560000
115700        MOVE 0                TO PV-TOTAL-DIVERTS                 11570000
115800                                 PV-SHIPPING-DOOR                 11580000
115900                                 PV-SHUTTLE-DOOR                  11590000
116000                                 PV-STORAGE-DOOR                  11600000
116100     END-IF.                                                      11610000
116200                                                                  11620000
116300     ADD 1                  TO PV-TRANS-QTY                       11630000
116400                               PV-DC-TRANS-QTY.                   11640000
116500     PERFORM 2100-READ-EXTRACT.                                   11650000
116600*                                                                 11660000
116700******************************************************************11670000
116800*  READ NEXT INPUT FILE RECORD.                                   11680000
116900******************************************************************11690000
117000 2100-READ-EXTRACT.                                               11700000
117100                                                                  11710000
117200     READ EXTRACT-FILE INTO DCLTUPLDER                            11720000
117300        AT END                                                    11730000
117400           SET PS-END-OF-INPUT TO TRUE                            11740000
117500        NOT AT END                                                11750000
117600           ADD +1                   TO PV-READ-COUNT              11760000
117700           MOVE UPLDER-OPER-UNT-ID  TO PV-OPER-ID                 11770000
117800           MOVE UPLDER-UPLD-TRN-CDE TO PV-UPLD-TRN-CDE            11780000
117900           MOVE UPLDER-ERR-CDE      TO PV-ERR-CDE                 11790000
118000           IF UPLDER-UPLD-TRN-CDE = 'A' AND                       11800000
118100              UPLDER-ERR-CDE      = '102'                         11810000
118200               PERFORM 7100-WRITE-P2L-EMPTY                       11820001
118300           ELSE                                                   11830000
118400               IF UPLDER-UPLD-TRN-CDE = 'C' AND                   11840000
118500                  UPLDER-ERR-CDE      = '102'                     11850000
118600                   PERFORM 7100-WRITE-P2L-EMPTY                   11860001
118700               END-IF                                             11870000
118800           END-IF                                                 11880000
118900     END-READ.                                                    11890000
119000*                                                                 11900000
119100******************************************************************11910000
119200*  FILL AND PRINT DETAIL REPORT LINE.                             11920000
119300******************************************************************11930000
119400 3000-PRINT-DETAILS.                                              11940000
119500*                                                                 11950000
119600     MOVE PV-PREV-ERR-CDE         TO DL1-ERR-CDE.                 11960000
119700     MOVE PV-TRANS-QTY            TO DL1-TRANS-QTY.               11970000
119800                                                                  11980000
119900                                                                  11990000
120000*CHECK FOR OVERFLOW.                                              12000000
120100     ADD 1 TO PV-LINE-COUNT.                                      12010000
120200     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         12020000
120300         SET PS-NEW-PAGE TO TRUE                                  12030000
120400         PERFORM 8000-WRITE-MAIN-HEADINGS                         12040000
120500     END-IF.                                                      12050000
120600                                                                  12060000
120700*IF NEW PAGE, DISPLAY WEEK-END DATE.                              12070000
120800     IF PS-NEW-PAGE                                               12080000
120900         SET PS-SAME-PAGE             TO TRUE                     12090000
121000     END-IF.                                                      12100000
121100                                                                  12110000
121200*WRITE DETAIL LINE.                                               12120000
121300             WRITE REPORT-RECORD-1                                12130000
121400               FROM DL-DETAIL-LINE-1                              12140000
121500                 AFTER ADVANCING 1 LINES                          12150000
121600                                                                  12160000
121700             WRITE REPORT-RECORD-1                                12170000
121800               FROM DL-BLANK-LINE                                 12180000
121900                 AFTER ADVANCING 1 LINE                           12190000
122000             ADD 2                   TO PV-LINE-COUNT.            12200000
122100*                                                                 12210000
122200***************************************************************** 12220000
122300*  FIGURE PECENTAGES.                                             12230000
122400***************************************************************** 12240000
122500 5000-DETERMINE-PERCENTS.                                         12250000
122600*                                                                 12260000
122700        IF PV-TOTAL-DIVERTS   > ZERO                              12270000
122800          DIVIDE PV-SHIPPING-DOOR BY  PV-TOTAL-DIVERTS            12280000
122900            GIVING PV-DIVIDEND ROUNDED                            12290000
123000          MULTIPLY PV-DIVIDEND BY 100                             12300000
123100            GIVING RC3-SHIPPING-PERCENT                           12310000
123200        ELSE                                                      12320000
123300              MOVE ZEROES  TO  PV-DIVIDEND                        12330000
123400                               RC3-SHIPPING-PERCENT               12340000
123500        END-IF.                                                   12350000
123600                                                                  12360000
123700        IF PV-TOTAL-DIVERTS   > ZERO                              12370000
123800          DIVIDE PV-STORAGE-DOOR BY  PV-TOTAL-DIVERTS             12380000
123900            GIVING PV-DIVIDEND ROUNDED                            12390000
124000          MULTIPLY PV-DIVIDEND BY 100                             12400000
124100            GIVING RC4-STORAGE-PERCENT                            12410000
124200        ELSE                                                      12420000
124300              MOVE ZEROES  TO  PV-DIVIDEND                        12430000
124400                               RC4-STORAGE-PERCENT                12440000
124500        END-IF.                                                   12450000
124600                                                                  12460000
124700        IF PV-TOTAL-DIVERTS   > ZERO                              12470000
124800          DIVIDE PV-SHUTTLE-DOOR BY  PV-TOTAL-DIVERTS             12480000
124900            GIVING PV-DIVIDEND ROUNDED                            12490000
125000          MULTIPLY PV-DIVIDEND BY 100                             12500000
125100            GIVING RC5-SHUTTLE-PERCENT                            12510000
125200        ELSE                                                      12520000
125300              MOVE ZEROES  TO  PV-DIVIDEND                        12530000
125400                               RC5-SHUTTLE-PERCENT                12540000
125500        END-IF.                                                   12550000
125600                                                                  12560000
125700        IF PV-TOTAL-DIVERTS   > ZERO                              12570000
125800          DIVIDE PV-OTHER         BY  PV-TOTAL-DIVERTS            12580000
125900            GIVING PV-DIVIDEND ROUNDED                            12590000
126000          MULTIPLY PV-DIVIDEND BY 100                             12600000
126100            GIVING RC6-OTHER-PERCENT                              12610000
126200        ELSE                                                      12620000
126300              MOVE ZEROES  TO  PV-DIVIDEND                        12630000
126400                               RC6-OTHER-PERCENT                  12640000
126500        END-IF.                                                   12650000
126600                                                                  12660000
126700        IF PV-TOTAL-DIVERTS   > ZERO                              12670000
126800          DIVIDE PV-DUPLICATE-DIVERTS BY  PV-TOTAL-DIVERTS        12680000
126900            GIVING PV-DIVIDEND ROUNDED                            12690000
127000          MULTIPLY PV-DIVIDEND BY 100                             12700000
127100            GIVING RC7-DUPLICATE-PERCENT                          12710000
127200        ELSE                                                      12720000
127300              MOVE ZEROES  TO  PV-DIVIDEND                        12730000
127400                               RC7-DUPLICATE-PERCENT              12740000
127500        END-IF.                                                   12750000
127600                                                                  12760000
127700        IF PV-TOTAL-DIVERTS   > ZERO                              12770000
127800          DIVIDE PV-NO-INFO-DIVERTS BY  PV-TOTAL-DIVERTS          12780000
127900            GIVING PV-DIVIDEND ROUNDED                            12790000
128000          MULTIPLY PV-DIVIDEND BY 100                             12800000
128100            GIVING RC8-NO-INFO-PERCENT                            12810000
128200        ELSE                                                      12820000
128300              MOVE ZEROES  TO  PV-DIVIDEND                        12830000
128400                               RC8-NO-INFO-PERCENT                12840000
128500        END-IF.                                                   12850000
128600                                                                  12860000
128700        IF PV-TOTAL-DIVERTS   > ZERO                              12870000
128800          DIVIDE PV-INACTIVE-DIVERTS BY  PV-TOTAL-DIVERTS         12880000
128900            GIVING PV-DIVIDEND ROUNDED                            12890000
129000          MULTIPLY PV-DIVIDEND BY 100                             12900000
129100            GIVING RC9-INACTIVE-PERCENT                           12910000
129200        ELSE                                                      12920000
129300              MOVE ZEROES  TO  PV-DIVIDEND                        12930000
129400                               RC9-INACTIVE-PERCENT               12940000
129500        END-IF.                                                   12950000
129600/                                                                 12960000
129700******************************************************************12970000
129800*  BUILD RECAP TOTALS.                                            12980000
129900******************************************************************12990000
130000 5500-BUILD-RECAP.                                                13000000
130100*                                                                 13010000
130200     MOVE PV-TOTAL-DIVERTS          TO RC2-TOTAL-DIVERTS.         13020000
130300     MOVE PV-SHIPPING-DOOR          TO RC3-SHIPPING-DOOR.         13030000
130400     MOVE PV-STORAGE-DOOR           TO RC4-STORAGE-DOOR.          13040000
130500     MOVE PV-SHUTTLE-DOOR           TO RC5-SHUTTLE-DOOR.          13050000
130600     MOVE PV-OTHER                  TO RC6-OTHER.                 13060000
130700                                                                  13070000
130800     MOVE PV-DUPLICATE-DIVERTS      TO RC7-DUPLICATE-DIVERTS.     13080000
130900     MOVE PV-NO-INFO-DIVERTS        TO RC8-NO-INFO-DIVERTS.       13090000
131000     MOVE PV-INACTIVE-DIVERTS       TO RC9-INACTIVE-DIVERTS.      13100000
131100*                                                                 13110000
131200******************************************************************13120000
131300*  PRINT RECAP TOTALS.                                            13130000
131400******************************************************************13140000
131500 5600-PRINT-RECAP.                                                13150000
131600*                                                                 13160000
131700     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     13170000
131800         AFTER ADVANCING 1 LINE.                                  13180000
131900                                                                  13190000
132000     WRITE REPORT-RECORD-1 FROM RC1-RECAP-LINE                    13200000
132100         AFTER ADVANCING 1 LINE.                                  13210000
132200                                                                  13220000
132300     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     13230000
132400         AFTER ADVANCING 1 LINE.                                  13240000
132500                                                                  13250000
132600     WRITE REPORT-RECORD-1 FROM RC2-RECAP-LINE                    13260000
132700         AFTER ADVANCING 1 LINE.                                  13270000
132800                                                                  13280000
132900     WRITE REPORT-RECORD-1 FROM RC3-RECAP-LINE                    13290000
133000         AFTER ADVANCING 1 LINE.                                  13300000
133100                                                                  13310000
133200     WRITE REPORT-RECORD-1 FROM RC4-RECAP-LINE                    13320000
133300         AFTER ADVANCING 1 LINE.                                  13330000
133400                                                                  13340000
133500     WRITE REPORT-RECORD-1 FROM RC5-RECAP-LINE                    13350000
133600         AFTER ADVANCING 1 LINE.                                  13360000
133700                                                                  13370000
133800     WRITE REPORT-RECORD-1 FROM RC6-RECAP-LINE                    13380000
133900         AFTER ADVANCING 1 LINE.                                  13390000
134000                                                                  13400000
134100     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     13410000
134200         AFTER ADVANCING 1 LINE.                                  13420000
134300                                                                  13430000
134400     WRITE REPORT-RECORD-1 FROM RC7-RECAP-LINE                    13440000
134500         AFTER ADVANCING 1 LINE.                                  13450000
134600                                                                  13460000
134700     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     13470000
134800         AFTER ADVANCING 1 LINE.                                  13480000
134900                                                                  13490000
135000     WRITE REPORT-RECORD-1 FROM RC8-RECAP-LINE                    13500000
135100         AFTER ADVANCING 1 LINE.                                  13510000
135200                                                                  13520000
135300     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     13530000
135400         AFTER ADVANCING 1 LINE.                                  13540000
135500                                                                  13550000
135600     WRITE REPORT-RECORD-1 FROM RC9-RECAP-LINE                    13560000
135700         AFTER ADVANCING 1 LINE.                                  13570000
135800                                                                  13580000
135900     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     13590000
136000         AFTER ADVANCING 1 LINE.                                  13600000
136100     ADD 14                  TO PV-LINE-COUNT.                    13610000
136200/                                                                 13620000
136300******************************************************************13630000
136400*  SELECT DOOR TYPE CODE FROM DC DOOR TABLE (TCNDCDR).            13640000
136500******************************************************************13650000
136600 6000-DOOR-TYPE.                                                  13660000
136700*                                                                 13670000
136800     IF DN-DOOR-NULL = -1                                         13680000
136900         ADD 1                        TO PV-OTHER                 13690000
137000     ELSE                                                         13700000
137100         EVALUATE TRUE                                            13710000
137200            WHEN CNDCDR-DOOR-TYP-CDE   = 'SH'                     13720000
137300                ADD +1                TO PV-SHIPPING-DOOR         13730000
137400                                                                  13740000
137500            WHEN CNDCDR-DOOR-TYP-CDE   = 'DS'                     13750000
137600                ADD +1                TO PV-SHUTTLE-DOOR          13760000
137700                                                                  13770000
137800            WHEN CNDCDR-DOOR-TYP-CDE   = 'ST'                     13780000
137900                ADD +1                TO PV-STORAGE-DOOR          13790000
138000                                                                  13800000
138100            WHEN OTHER                                            13810000
138200                ADD +1                TO PV-OTHER                 13820000
138300                                                                  13830000
138400         END-EVALUATE                                             13840000
138500     END-IF.                                                      13850000
138600                                                                  13860000
138700*                                                                 13870000
138800******************************************************************13880000
138900*  DETERMINE IF THE DIVERTED SHIP UNIT ID IS ON THE OUTBOUND      13890000
139000*  CARTON TABLE.                                                  13900000
139100*  IF NOT ON TABLE INCREMENT COUNTER (PV-NO-INFO-DIVERT).         13910000
139200*  IF SQL RETURNS DATA, CHECK IF STAT_CDE = 'I' AND ADD TO NUMBER 13920000
139300*    OF CARTONS WITH INACTIVE CARTON INFORMATION.                 13930000
139400******************************************************************13940000
139500 6100-SELECT-OUTBOUND-CART.                                       13950000
139600*                                                                 13960000
139700     IF  DN-CART-NULL = -1                                        13970000
139800         ADD +1                       TO PV-NO-INFO-DIVERTS       13980000
139900         PERFORM 6200-WRITE-UNKNOWN-DIVERT                        13990001
140000     ELSE                                                         14000000
140100         IF  SUT00024-ACTV-IND = 'N'                              14010000
140200             IF  SUT00024-CART-SRC-CDE = 'MST'                    14020000
140300                 CONTINUE                                         14030000
140400             ELSE                                                 14040000
140500                 ADD +1                TO PV-INACTIVE-DIVERTS     14050000
140600                 PERFORM 6200-WRITE-UNKNOWN-DIVERT                14060001
140700             END-IF                                               14070000
140800         END-IF                                                   14080000
140900     END-IF.                                                      14090000
141000*                                                                 14100000
141100 6200-WRITE-UNKNOWN-DIVERT.                                       14110001
141200     INITIALIZE SU067-EXTRACT-RECORD.                             14120001
141300     MOVE SUCRDV-SHIPT-UNT-ID      TO SU067-SHIPT-UNT-ID.         14130001
141400     MOVE SUCRDV-OPER-UNT-ID        TO SU067-LOC-NBR.             14140006
141500     MOVE SUCRDV-DIVERT-TMST (1:10) TO SU067-DIVERT-DATE.         14150004
141600     MOVE SUCRDV-DIVERT-TMST (12:8) TO SU067-DIVERT-TIME.         14160004
141700     MOVE SUCRDV-ACTV-CDE           TO SU067-DIVERT-STATUS.       14170004
141800     MOVE SUCRDV-DOOR-ID            TO SU067-DIVERT-DOOR.         14180004
141900                                                                  14190008
142000     MOVE SUT00024-CRE-DTE        TO SU067-CREATE-DATE.           14200008
142100     MOVE SUT00024-CRE-TM         TO SU067-CREATE-TIME.           14210008
142200                                                                  14220008
142300     IF  DN-CART-NULL = -1                                        14230001
142400         SET SU067-UNKNOWN-CARTON  TO TRUE                        14240001
142500         MOVE SPACES               TO SU067-CARTON-STATUS         14250001
142600         PERFORM 8400-WRITE-UNKNOWN-EXTRACT                       14260004
142700     ELSE                                                         14270001
142800         SET SU067-INACTIVE-CARTON TO TRUE                        14280001
142900         MOVE SUT00024-ACTV-IND    TO SU067-CARTON-STATUS         14290001
143000         IF DN-DTE-NULL NOT = -1                                  14300001
143100             MOVE SUT00024-CRE-DTE     TO SU067-CREATE-DATE       14310008
143200         END-IF                                                   14320001
143300         IF DN-TM-NULL NOT = -1                                   14330001
143400             MOVE SUT00024-CRE-TM      TO SU067-CREATE-TIME       14340008
143500         END-IF                                                   14350001
143600         IF DN-USR-NULL NOT = -1                                  14360001
143700             MOVE SUT00024-CRE-USR-ID  TO SU067-CREATE-USERID     14370001
143800         END-IF                                                   14380001
143900         IF DN-CART-NULL NOT = -1                                 14390001
144000             MOVE SUT00024-CART-SRC-CDE                           14400001
144100                                       TO SU067-CREATE-SRC        14410001
144200         END-IF                                                   14420001
144300         PERFORM 8300-WRITE-INACTIVE-EXTRACT                      14430004
144400     END-IF.                                                      14440001
144500******************************************************************14450001
144600*  OPEN THE TSUCRDV CURSOR.                                       14460001
144700******************************************************************14470001
144800 7050-OPEN-TSUCRDV-CSR.                                           14480000
144900     MOVE '7050-OPEN-TSUCRDV-CSR'                                 14490000
145000         TO PV-ABEND-PARAGRAPH.                                   14500000
145100     MOVE 'OPEN TSUCRDV-CURSOR'                                   14510000
145200         TO PV-DB2-OPERATION-ATTEMPTED.                           14520000
145300                                                                  14530000
145400     EXEC SQL                                                     14540000
145500          OPEN TSUCRDV-CSR                                        14550000
145600     END-EXEC.                                                    14560000
145700                                                                  14570000
145800     EVALUATE TRUE                                                14580000
145900         WHEN SQLCODE = ZERO                                      14590000
146000              DISPLAY ' OPER= ' DK-OPER-ID                        14600000
146100                  ' / BEGIN = ' DK-DB2-TMST-1                     14610000
146200                  ' / END = ' DK-DB2-TMST-2                       14620000
146300                                                                  14630000
146400             SET PS-NOT-END-OF-TSUCRDV-CSR TO TRUE                14640000
146500         WHEN SQLWARN0 NOT = SPACES                               14650000
146600         WHEN SQLCODE < ZERO                                      14660000
146700         WHEN SQLCODE > ZERO                                      14670000
146800             MOVE '7050-OPEN-TSUCRDV-CSR'                         14680000
146900                           TO PV-ABEND-PARAGRAPH                  14690009
147000             MOVE 'OPEN CURSOR'    TO PV-DB2-FUNCTION             14700000
147100             MOVE 'TSUCRDV        '   TO PV-DB2-TABLE-NAME        14710000
147200             PERFORM 9200-SQL-ABEND                               14720000
147300     END-EVALUATE.                                                14730000
147400*                                                                 14740000
147500******************************************************************14750000
147600*  PROCESS ALL OF THE ROWS FETCHED FROM TSUCRDV.                  14760000
147700*  - DETERMINE THE TOTAL NUMBER OF LOGGED DIVERTS.                14770000
147800*  - DETERMINE THE DOOR TYPE DIVERTED TO.                         14780000
147900*  - DETERMINE NUMBER OF DUPLICATE DIVERTS.                       14790000
148000*  - DETERMINE IF DIVERT IS ON CROSS REFERENCE TABLE(TSULBXF).    14800000
148100******************************************************************14810000
148200 7060-PROCESS-TSUCRDV-CSR.                                        14820000
148300*                                                                 14830000
148400     PERFORM 6000-DOOR-TYPE.                                      14840000
148500     IF  SUCRDV-SHIPT-UNT-ID = PV-PREV-SHIPT-UNT-ID               14850000
148600         ADD +1          TO PV-DUPLICATE-DIVERTS                  14860000
148700     ELSE                                                         14870000
148800         PERFORM 6100-SELECT-OUTBOUND-CART                        14880000
148900     END-IF.                                                      14890000
149000                                                                  14900000
149100     PERFORM 7063-CHECK-ACTIVE-SCAN-ON.                           14910000
149200                                                                  14920000
149300     MOVE SUCRDV-SHIPT-UNT-ID TO PV-PREV-SHIPT-UNT-ID.            14930000
149400     PERFORM 7070-FETCH-TSUCRDV-CSR.                              14940000
149500                                                                  14950000
149600 7063-CHECK-ACTIVE-SCAN-ON.                                       14960000
149700*    PERFORM 7065-SELECT-OTBND-LOC.                               14970000
149800     IF DN-LOC-NULL = -1                                          14980000
149900         CONTINUE                                                 14990000
150000     ELSE                                                         15000000
150100         INITIALIZE SU057-EXTRACT-RECORD                          15010000
150200         MOVE SUT00027-SHIPT-UNT-ID   TO SU057-SHIPT-UNT-ID       15020000
150300         MOVE SUT00027-CRE-TMST       TO SU057-CRE-TMST           15030000
150400         MOVE PV-SCAN-OFF-TMST        TO SU057-SCAN-OFF-TMST      15040000
150500         MOVE SUT00027-OTBND-TRIP-ID  TO SU057-OTBND-TRIP-ID      15050000
150600         MOVE SUT00027-LOC-NBR        TO SU057-LOC-NBR            15060000
150700         MOVE SUT00027-SCN-CDE        TO SU057-SCAN-CDE           15070000
150800         MOVE SUT00027-ACTV-CDE       TO SU057-ACTIVE-CDE         15080000
150900                                                                  15090000
151000         PERFORM 8100-WRITE-SCAN-ON                               15100000
151100     END-IF.                                                      15110000
151200                                                                  15120000
151300                                                                  15130000
151400 7065-SELECT-OTBND-LOC.                                           15140000
151500     EXEC SQL                                                     15150000
151600         SELECT                                                   15160000
151700             SHIPT_UNT_ID                                         15170000
151800         ,   CRE_TMST                                             15180000
151900         ,   OTBND_TRIP_ID                                        15190000
152000         ,   LOC_NBR                                              15200000
152100         ,   SCN_CDE                                              15210000
152200         ,   ACTV_CDE                                             15220000
152300         ,   TIMESTAMP(CRE_TMST + 1 MICROSECOND)                  15230000
152400         INTO                                                     15240000
152500             :SUT00027-SHIPT-UNT-ID                               15250000
152600         ,   :SUT00027-CRE-TMST                                   15260000
152700         ,   :SUT00027-OTBND-TRIP-ID                              15270000
152800         ,   :SUT00027-LOC-NBR                                    15280000
152900         ,   :SUT00027-SCN-CDE                                    15290000
153000         ,   :SUT00027-ACTV-CDE                                   15300000
153100         ,   :PV-SCAN-OFF-TMST                                    15310000
153200         FROM                                                     15320000
153300             SUT_OTBND_LOC                                        15330000
153400         WHERE                                                    15340000
153500             SHIPT_UNT_ID             = :SUCRDV-SHIPT-UNT-ID      15350000
153600         AND SCN_CDE                  = 'SHON'                    15360000
153700         AND ACTV_CDE                 = 'A'                       15370000
153800         AND CRE_TMST                 < :SUCRDV-DIVERT-TMST       15380000
153900     END-EXEC.                                                    15390000
154000                                                                  15400000
154100     EVALUATE TRUE                                                15410000
154200         WHEN SQLCODE = ZERO                                      15420000
154300         WHEN SQLCODE = +100                                      15430000
154400             CONTINUE                                             15440000
154500                                                                  15450000
154600         WHEN SQLWARN0 NOT = SPACES                               15460000
154700         WHEN SQLCODE < ZERO                                      15470000
154800         WHEN SQLCODE > ZERO                                      15480000
154900             MOVE '7065-SELECT-OTBND-LOC'                         15490000
155000                           TO PV-ABEND-PARAGRAPH                  15500009
155100             MOVE 'SELECT'            TO PV-DB2-FUNCTION          15510000
155200             MOVE 'SUT_OTBND_LOC  '   TO PV-DB2-TABLE-NAME        15520000
155300             PERFORM 9200-SQL-ABEND                               15530000
155400     END-EVALUATE.                                                15540000
155500                                                                  15550000
155600                                                                  15560000
155700******************************************************************15570000
155800*  FETCH THE ROW FROM THE RESULTS TABLE USING THE CURSOR.        *15580000
155900******************************************************************15590000
156000 7070-FETCH-TSUCRDV-CSR.                                          15600000
156100     MOVE '7070-FETCH-TSUCRDV-CSR'                                15610000
156200         TO PV-ABEND-PARAGRAPH.                                   15620000
156300     MOVE 'FETCH A ROW FROM THE TSUCRDV-CURSOR'                   15630000
156400         TO PV-DB2-OPERATION-ATTEMPTED.                           15640000
156500                                                                  15650000
156600     INITIALIZE DCLTSUCRDV                                        15660000
156700                DCLSUT00024                                       15670000
156800                DCLSUT00027                                       15680000
156900                DCLTCNDCDR                                        15690000
157000                DN-LOC-NULL                                       15700000
157100                DN-CART-NULL                                      15710000
157200                DN-DTE-NULL                                       15720001
157300                DN-TM-NULL                                        15730001
157400                DN-USR-NULL                                       15740001
157500                DN-DOOR-NULL                                      15750000
157600                                                                  15760000
157700     EXEC SQL                                                     15770000
157800          FETCH TSUCRDV-CSR                                       15780000
157900           INTO :SUCRDV-SHIPT-UNT-ID                              15790000
158000             ,  :SUCRDV-OPER-UNT-ID                               15800007
158100             ,  :SUCRDV-DIVERT-NBR                                15810007
158200             ,  :SUCRDV-DIVERT-LOC-ID                             15820000
158300             ,  :SUCRDV-DOOR-ID                                   15830000
158400             ,  :SUCRDV-ACTV-CDE                                  15840000
158500             ,  :SUCRDV-DIVERT-TMST                               15850000
158600                                                                  15860000
158700             ,  :SUT00027-SHIPT-UNT-ID                            15870000
158800                      :DN-LOC-NULL                                15880000
158900             ,  :SUT00027-CRE-TMST                                15890000
159000                      :DN-LOC-NULL                                15900000
159100             ,  :SUT00027-OTBND-TRIP-ID                           15910000
159200                      :DN-LOC-NULL                                15920000
159300             ,  :SUT00027-LOC-NBR                                 15930000
159400                      :DN-LOC-NULL                                15940000
159500             ,  :SUT00027-SCN-CDE                                 15950000
159600                      :DN-LOC-NULL                                15960000
159700             ,  :SUT00027-ACTV-CDE                                15970000
159800                      :DN-LOC-NULL                                15980000
159900             ,  :PV-SCAN-OFF-TMST                                 15990000
160000                      :DN-LOC-NULL                                16000000
160100                                                                  16010000
160200             ,  :CNDCDR-DOOR-TYP-CDE                              16020000
160300                     :DN-DOOR-NULL                                16030000
160400                                                                  16040000
160500             ,  :SUT00024-ACTV-IND                                16050000
160600                     :DN-CART-NULL                                16060000
160700                                                                  16070000
160800             ,  :SUT00024-CART-SRC-CDE                            16080000
160900                     :DN-CART-NULL                                16090000
161000             ,  :SUT00024-CRE-DTE                                 16100001
161100                     :DN-DTE-NULL                                 16110001
161200             ,  :SUT00024-CRE-TM                                  16120001
161300                     :DN-TM-NULL                                  16130001
161400             ,  :SUT00024-CRE-USR-ID                              16140001
161500                     :DN-USR-NULL                                 16150001
161600                                                                  16160000
161700     END-EXEC.                                                    16170000
161800                                                                  16180000
161900     EVALUATE TRUE                                                16190000
162000         WHEN SQLCODE = ZERO                                      16200000
162100             ADD +1                    TO PV-TOTAL-DIVERTS        16210000
162200                                          PV-FETCH-COUNT          16220000
162300             MOVE SUCRDV-SHIPT-UNT-ID  TO PV-SHIPT-UNT-ID         16230000
162400             MOVE SUCRDV-DOOR-ID       TO PV-DOOR-ID              16240000
162500         WHEN SQLCODE = +100                                      16250000
162600             SET PS-END-OF-TSUCRDV-CSR TO TRUE                    16260000
162700         WHEN SQLWARN0 NOT = SPACES                               16270000
162800         WHEN SQLCODE < ZERO                                      16280000
162900         WHEN SQLCODE > ZERO                                      16290000
163000             MOVE '7070-FETCH-TSUCRDV-CSR'                        16300000
163100                           TO PV-ABEND-PARAGRAPH                  16310009
163200             MOVE 'FETCH '            TO PV-DB2-FUNCTION          16320000
163300             MOVE 'TSUCRDV        '   TO PV-DB2-TABLE-NAME        16330000
163400             PERFORM 9200-SQL-ABEND                               16340000
163500     END-EVALUATE.                                                16350000
163600                                                                  16360000
163700******************************************************************16370000
163800*  CLOSE THE TSUCRDV-CSR CURSOR.                                  16380000
163900******************************************************************16390000
164000 7080-CLOSE-TSUCRDV-CSR.                                          16400000
164100     MOVE '7080-CLOSE-TSUCRDV-CSR'                                16410000
164200         TO PV-ABEND-PARAGRAPH.                                   16420000
164300     MOVE 'CLOSE THE TSUCRDV CURSOR'                              16430000
164400         TO PV-DB2-OPERATION-ATTEMPTED.                           16440000
164500                                                                  16450000
164600     EXEC SQL                                                     16460000
164700          CLOSE TSUCRDV-CSR                                       16470000
164800     END-EXEC.                                                    16480000
164900                                                                  16490000
165000     EVALUATE TRUE                                                16500000
165100         WHEN SQLCODE = ZERO                                      16510000
165200             CONTINUE                                             16520000
165300         WHEN SQLWARN0 NOT = SPACES                               16530000
165400         WHEN SQLCODE < ZERO                                      16540000
165500         WHEN SQLCODE > ZERO                                      16550000
165600             MOVE '7080-CLOSE-TSUCRDV-CSR'                        16560000
165700                           TO PV-ABEND-PARAGRAPH                  16570009
165800             MOVE 'CLOSE '            TO PV-DB2-FUNCTION          16580000
165900             MOVE 'TSUCRDV        '   TO PV-DB2-TABLE-NAME        16590000
166000             PERFORM 9200-SQL-ABEND                               16600000
166100     END-EVALUATE.                                                16610000
166200                                                                  16620000
166300 7100-WRITE-P2L-EMPTY.                                            16630001
166400     INITIALIZE SU067-EXTRACT-RECORD.                             16640001
166500     MOVE UPLDER-PKT-TXT          TO PC185-SML-UPLOAD-RECORD.     16650000
166600     MOVE PC185-HDR-SML-NBR       TO PV-SHIPT-UNT-ID              16660000
166700     MOVE PV-SHIPT-UNT-ID         TO SUT00024-SHIPT-UNT-ID.       16670000
166800     IF UPLDER-UPLD-TRN-CDE = 'A'                                 16680003
166900         PERFORM 7150-SELECT-OUTBOUND                             16690001
167000     ELSE                                                         16700001
167100         PERFORM 7170-SELECT-OUTBOUND                             16710001
167200     END-IF.                                                      16720001
167300     MOVE SUT00024-SHIPT-UNT-ID   TO SU067-SHIPT-UNT-ID.          16730001
167400     MOVE SUT00024-ORGN-LOC-NBR   TO SU067-LOC-NBR.               16740001
167500     MOVE SUT00024-CART-SRC-CDE   TO SU067-CREATE-SRC.            16750001
167600     MOVE SUT00024-CRE-DTE        TO SU067-CREATE-DATE.           16760001
167700     MOVE SUT00024-CRE-TM         TO SU067-CREATE-TIME.           16770001
167800     IF SUT00024-ACTV-IND = 'Y'                                   16780001
167900         SET SU067-CRTN-ACTIVE   TO TRUE                          16790001
168000     ELSE                                                         16800001
168100         SET SU067-CRTN-INACTIVE TO TRUE                          16810001
168200     END-IF.                                                      16820001
168300                                                                  16830000
168400     PERFORM 8200-WRITE-P2L-CARTON-EXTRACT.                       16840001
168500                                                                  16850000
168600 7150-SELECT-OUTBOUND.                                            16860000
168700                                                                  16870000
168800     EXEC SQL                                                     16950000
168900         SELECT  A.SHIPT_UNT_ID                                   16960000
169000                ,A.ORGN_LOC_NBR                                   16970000
169100                ,A.CART_SRC_CDE                                   16980000
169200                ,A.CRE_DTE                                        16990000
169300                ,A.CRE_TM                                         17000000
169400                ,A.ACTV_IND                                       17010000
169500                ,DATE(B.CRE_TMST)                                 17020000
169600                ,TIME(B.CRE_TMST)                                 17030000
169700         INTO  :SUT00024-SHIPT-UNT-ID                             17040000
169800            ,  :SUT00024-ORGN-LOC-NBR                             17050000
169900            ,  :SUT00024-CART-SRC-CDE                             17060000
170000            ,  :SUT00024-CRE-DTE                                  17070000
170100            ,  :SUT00024-CRE-TM                                   17080000
170200            ,  :SUT00024-ACTV-IND                                 17090000
170300            ,  :SU067-P2L-UPLOAD-DATE                             17100000
170400            ,  :SU067-P2L-UPLOAD-TIME                             17110000
170500         FROM SUT_OTBND_CART A                                    17120000
170600            , SUT_OTBND_LOC B                                     17130001
170700         WHERE A.SHIPT_UNT_ID       = :SUT00024-SHIPT-UNT-ID      17140000
170800           AND A.SHIPT_UNT_ID       = B.SHIPT_UNT_ID              17150000
170900           AND B.SCN_CDE            = 'LTP'                       17160000
171000           AND B.ACTV_CDE           = 'A'                         17170000
171100     END-EXEC.                                                    17180000
171200                                                                  17190000
171300     EVALUATE TRUE                                                17200000
171400         WHEN SQLCODE = +0                                        17210000
171500             CONTINUE                                             17220000
171510         WHEN SQLCODE = -811                                      17210000
171520             PERFORM  7155-SELECT-OUTBOUND-MAX                    17220000
171530         WHEN SQLCODE = +100                                      17210000
171531                                                                          
171532              MOVE PV-SHIPT-UNT-ID                                        
171533                TO SUT00024-SHIPT-UNT-ID                                  
171534                                                                          
171535              MOVE PC185-HDR-SML-NBR TO  PV-WORK-SML                      
171539              MOVE PV-WORK-SML-OPER  TO  SUT00024-ORGN-LOC-NBR            
171542              MOVE SPACES            TO  SUT00024-CART-SRC-CDE            
171543                                                                          
171544              MOVE PC185-OPEN-DATE-TIME TO PV-WORK-DATE                   
171545              MOVE PV-WORK-DATE-MO    TO  PV-DATE-EDIT-CCYY               
171546              MOVE '-'                TO  PV-DATE-EDIT-DASH-1             
171547              MOVE PV-WORK-DATE-DD    TO  PV-DATE-EDIT-MO                 
171548              MOVE '-'                TO  PV-DATE-EDIT-DASH-2             
171549              MOVE PV-WORK-DATE-CCYY  TO  PV-DATE-EDIT-DD                 
171550              MOVE PV-WORK-DATE-HH    TO  PV-TIME-EDIT-HH                 
171551              MOVE ':'                TO  PV-TIME-EDIT-COLON-1            
171552              MOVE PV-WORK-DATE-MM    TO  PV-TIME-EDIT-MM                 
171553              MOVE ':'                TO  PV-TIME-EDIT-COLON-2            
171560              MOVE PV-WORK-DATE-SS    TO  PV-TIME-EDIT-SS                 
171567                                                                          
171568              MOVE PV-DATE-EDIT       TO  SUT00024-CRE-DTE                
171569              MOVE PV-TIME-EDIT       TO  SUT00024-CRE-TM                 
171570              MOVE 'N'                TO  SUT00024-ACTV-IND               
171571                                                                          
171572              MOVE PC185-CLOSE-DATE-TIME TO PV-WORK-DATE                  
171573              MOVE PV-WORK-DATE-MO    TO  PV-DATE-EDIT-CCYY               
171574              MOVE '-'                TO  PV-DATE-EDIT-DASH-1             
171575              MOVE PV-WORK-DATE-DD    TO  PV-DATE-EDIT-MO                 
171576              MOVE '-'                TO  PV-DATE-EDIT-DASH-2             
171577              MOVE PV-WORK-DATE-CCYY  TO  PV-DATE-EDIT-DD                 
171578              MOVE PV-WORK-DATE-HH    TO  PV-TIME-EDIT-HH                 
171579              MOVE ':'                TO  PV-TIME-EDIT-COLON-1            
171580              MOVE PV-WORK-DATE-MM    TO  PV-TIME-EDIT-MM                 
171581              MOVE ':'                TO  PV-TIME-EDIT-COLON-2            
171582              MOVE PV-WORK-DATE-SS    TO  PV-TIME-EDIT-SS                 
171583                                                                          
171584              MOVE PV-DATE-EDIT       TO  SU067-P2L-UPLOAD-DATE           
171586              MOVE PV-TIME-EDIT       TO  SU067-P2L-UPLOAD-TIME           
171592                                                                          
171600         WHEN SQLCODE < ZERO                                      17230000
171700         WHEN SQLCODE > ZERO                                      17240000
171800         WHEN SQLWARN0 NOT = SPACES                               17250000
171900             MOVE '7150-SELECT-OUTBOUND'                          17260000
172000                                        TO PV-ABEND-PARAGRAPH     17270000
172100             MOVE 'SELECT'         TO PV-DB2-FUNCTION             17280000
172200             MOVE 'SUT_OTBND_CART'    TO PV-DB2-TABLE-NAME        17290002
172300             MOVE 'SUT_OTBND_LOC'     TO PV-DB2-TABLE-NAME-1      17300002
172400             MOVE SUT00024-SHIPT-UNT-ID                           17310000
172500                                      TO PV-DISP-SHIPT-UNT-ID-N   17320000
172600             MOVE PV-DISP-SHIPT-UNT-ID-N                          17330000
172700                                      TO PV-DISPLAY-HOST-VAR      17340000
172800             PERFORM 9200-SQL-ABEND                               17350000
172900     END-EVALUATE.                                                17360000
173000                                                                  17370000
173001                                                                  17370000
173010 7155-SELECT-OUTBOUND-MAX.                                        16860000
173020                                                                  16870000
173030     EXEC SQL                                                     16950000
173040         SELECT  A.SHIPT_UNT_ID                                   16960000
173050                ,A.ORGN_LOC_NBR                                   16970000
173060                ,A.CART_SRC_CDE                                   16980000
173070                ,A.CRE_DTE                                        16990000
173080                ,A.CRE_TM                                         17000000
173090                ,A.ACTV_IND                                       17010000
173091                ,DATE(B.CRE_TMST)                                 17020000
173092                ,TIME(B.CRE_TMST)                                 17030000
173093         INTO  :SUT00024-SHIPT-UNT-ID                             17040000
173094            ,  :SUT00024-ORGN-LOC-NBR                             17050000
173095            ,  :SUT00024-CART-SRC-CDE                             17060000
173096            ,  :SUT00024-CRE-DTE                                  17070000
173097            ,  :SUT00024-CRE-TM                                   17080000
173098            ,  :SUT00024-ACTV-IND                                 17090000
173099            ,  :SU067-P2L-UPLOAD-DATE                             17100000
173100            ,  :SU067-P2L-UPLOAD-TIME                             17110000
173101         FROM SUT_OTBND_CART A                                    17120000
173102            , SUT_OTBND_LOC B                                     17130001
173103         WHERE A.SHIPT_UNT_ID       = :SUT00024-SHIPT-UNT-ID      17140000
173104           AND A.SHIPT_UNT_ID       = B.SHIPT_UNT_ID              17150000
173105           AND B.SCN_CDE            = 'LTP'                       17160000
173106           AND B.ACTV_CDE           = 'A'                         17170000
173107           AND B.CRE_TMST  IN                                             
173108               (SELECT MAX(C.CRE_TMST)                                    
173109                  FROM SUT_OTBND_LOC C                                    
173110                 WHERE A.SHIPT_UNT_ID  =  C.SHIPT_UNT_ID                  
173111                   AND C.SCN_CDE            = 'LTP'                       
173112                   AND C.ACTV_CDE           = 'A')                        
173113                                                                          
173114     END-EXEC.                                                    17180000
173115                                                                  17190000
173116     EVALUATE TRUE                                                17200000
173117         WHEN SQLCODE = +0                                        17210000
173118         WHEN SQLCODE = -811                                      17210000
173119             CONTINUE                                             17220000
173120         WHEN SQLCODE < ZERO                                      17230000
173121         WHEN SQLCODE > ZERO                                      17240000
173122         WHEN SQLWARN0 NOT = SPACES                               17250000
173123             MOVE '7155-SELECT-OUTBOUND-MAX'                      17260000
173124                                        TO PV-ABEND-PARAGRAPH     17270000
173125             MOVE 'SELECT'         TO PV-DB2-FUNCTION             17280000
173126             MOVE 'SUT_OTBND_CART'    TO PV-DB2-TABLE-NAME        17290002
173127             MOVE 'SUT_OTBND_LOC'     TO PV-DB2-TABLE-NAME-1      17300002
173128             MOVE SUT00024-SHIPT-UNT-ID                           17310000
173129                                      TO PV-DISP-SHIPT-UNT-ID-N   17320000
173130             MOVE PV-DISP-SHIPT-UNT-ID-N                          17330000
173131                                      TO PV-DISPLAY-HOST-VAR      17340000
173132             PERFORM 9200-SQL-ABEND                               17350000
173133     END-EVALUATE.                                                17360000
173134                                                                  17370000
173135                                                                  17370000
173140 7170-SELECT-OUTBOUND.                                            17380001
173200                                                                  17390001
173300     EXEC SQL                                                     17400001
173400         SELECT  A.SHIPT_UNT_ID                                   17410001
173500                ,A.ORGN_LOC_NBR                                   17420001
173600                ,A.CART_SRC_CDE                                   17430001
173700                ,A.CRE_DTE                                        17440001
173800                ,A.CRE_TM                                         17450001
173900                ,A.ACTV_IND                                       17460001
174000                ,DATE(B.CRE_TMST)                                 17470001
174100                ,TIME(B.CRE_TMST)                                 17480001
174200         INTO  :SUT00024-SHIPT-UNT-ID                             17490001
174300            ,  :SUT00024-ORGN-LOC-NBR                             17500001
174400            ,  :SUT00024-CART-SRC-CDE                             17510001
174500            ,  :SUT00024-CRE-DTE                                  17520001
174600            ,  :SUT00024-CRE-TM                                   17530001
174700            ,  :SUT00024-ACTV-IND                                 17540001
174800            ,  :SU067-P2L-UPLOAD-DATE                             17550001
174900            ,  :SU067-P2L-UPLOAD-TIME                             17560001
175000         FROM SUT_OTBND_CART A                                    17570001
175100            , SUT_OTBND_LOC B                                     17580001
175200         WHERE A.SHIPT_UNT_ID       = :SUT00024-SHIPT-UNT-ID      17590001
175300           AND A.SHIPT_UNT_ID       = B.SHIPT_UNT_ID              17600001
175400           AND B.SCN_CDE            = 'DNP'                       17610001
175500           AND B.ACTV_CDE           = 'A'                         17620001
175600     END-EXEC.                                                    17630001
175700                                                                  17640001
175800     EVALUATE TRUE                                                17650001
175900         WHEN SQLCODE = +0                                        17660001
176000             CONTINUE                                             17670001
176100         WHEN SQLCODE < ZERO                                      17680001
176200         WHEN SQLCODE > ZERO                                      17690001
176300         WHEN SQLWARN0 NOT = SPACES                               17700001
176400             MOVE '7170-SELECT-OUTBOUND'                          17710001
176500                                        TO PV-ABEND-PARAGRAPH     17720001
176600             MOVE 'SELECT'         TO PV-DB2-FUNCTION             17730001
176700             MOVE 'SUT_OTBND_LOC'     TO PV-DB2-TABLE-NAME        17740002
176800             MOVE 'SUT_OTBND_LOC'     TO PV-DB2-TABLE-NAME-1      17750002
176900             MOVE SUT00024-SHIPT-UNT-ID                           17760001
177000                                      TO PV-DISP-SHIPT-UNT-ID-N   17770001
177100             MOVE PV-DISP-SHIPT-UNT-ID-N                          17780001
177200                                      TO PV-DISPLAY-HOST-VAR      17790001
177300             PERFORM 9200-SQL-ABEND                               17800001
177400     END-EVALUATE.                                                17810001
177500/                                                                 17820001
177600******************************************************************17830000
177700 8000-WRITE-MAIN-HEADINGS.                                        17840000
177800******************************************************************17850000
177900*                                                                 17860000
178000     IF PS-END-OF-INPUT                                           17870000
178100         PERFORM 1400-SELECT-TCOCNTL                              17880000
178200     ELSE                                                         17890000
178300         PERFORM 1200-SELECT-OPER-DESC                            17900000
178400         MOVE PV-STORE-NAME            TO HL2-LOC-DESC            17910000
178500         MOVE PV-OPER-ID               TO HL2-OPER-ID.            17920000
178600                                                                  17930000
178700     MOVE PV-FORMAT-DATE           TO HL1-FROM-DATE.              17940000
178800     ADD 1                         TO PV-PAGE-COUNT.              17950000
178900     MOVE PV-PAGE-COUNT            TO DP132O-PAGE-NUMBER.         17960000
179000     MOVE ZERO                     TO PV-LINE-COUNT.              17970000
179100                                                                  17980000
179200     WRITE REPORT-RECORD-1 FROM                                   17990000
179300         DP132O-STANDRD-HEADER-132-COLS                           18000000
179400         AFTER ADVANCING PAGE.                                    18010000
179500                                                                  18020000
179600     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     18030000
179700         AFTER ADVANCING 1 LINE                                   18040000
179800                                                                  18050000
179900     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-1                 18060000
180000        AFTER ADVANCING 1 LINES.                                  18070000
180100                                                                  18080000
180200     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     18090000
180300         AFTER ADVANCING 1 LINE                                   18100000
180400                                                                  18110000
180500     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-2                 18120000
180600        AFTER ADVANCING 1 LINES.                                  18130000
180700                                                                  18140000
180800     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     18150000
180900         AFTER ADVANCING 1 LINE                                   18160000
181000                                                                  18170000
181100     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-3                 18180000
181200        AFTER ADVANCING 1 LINES.                                  18190000
181300                                                                  18200000
181400     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     18210000
181500         AFTER ADVANCING 1 LINE                                   18220000
181600                                                                  18230000
181700     ADD 7                            TO PV-LINE-COUNT.           18240000
181800*                                                                 18250000
181900 8100-WRITE-SCAN-ON.                                              18260000
182000     WRITE SCAN-ON-EXTRACT-RECORD                                 18270000
182100         FROM SU057-EXTRACT-RECORD.                               18280000
182200     ADD 1                            TO PV-SCAN-ON-WRITTEN.      18290000
182300*                                                                 18300000
182400 8200-WRITE-P2L-CARTON-EXTRACT.                                   18310000
182500     WRITE P2L-CARTON-EXTRACT-RECORD                              18320000
182600         FROM SU067-EXTRACT-RECORD.                               18330000
182700     ADD 1                            TO PV-EMPTY-WRITTEN.        18340001
182800*                                                                 18350000
182900 8300-WRITE-INACTIVE-EXTRACT.                                     18360001
183000     WRITE INACTIVE-DIVERT-RECORD                                 18370005
183100         FROM SU067-EXTRACT-RECORD.                               18380001
183200     ADD 1                            TO PV-INACTIVE-WRITTEN.     18390001
183300                                                                  18400000
183400 8400-WRITE-UNKNOWN-EXTRACT.                                      18410004
183500     WRITE UNKNOWN-DIVERT-RECORD                                  18420005
183600         FROM SU067-EXTRACT-RECORD.                               18430004
183700     ADD 1                            TO PV-UNKNOWN-WRITTEN.      18440004
183800                                                                  18450004
183900******************************************************************18460000
184000 9000-EOJ.                                                        18470000
184100******************************************************************18480000
184200*                                                                 18490000
184300     WRITE REPORT-RECORD-1 FROM ER-END-OF-REPORT-LINE             18500000
184400        AFTER ADVANCING 2 LINES                                   18510000
184500                                                                  18520000
184600*CLOSE FILES.                                                     18530000
184700     CLOSE EXTRACT-FILE                                           18540000
184800                                                                  18550000
184900     CLOSE REPORT-FILE-1                                          18560000
185000           SCAN-ON-EXTRACT-FILE                                   18570000
185100           INACTIVE-DIVERT-FILE                                   18580003
185200           UNKNOWN-DIVERT-FILE                                    18590005
185300           P2L-CARTON-EXTRACT-FILE.                               18600000
185400                                                                  18610000
185500     MOVE PV-READ-COUNT      TO PV-DISPLAY-COUNT.                 18620000
185600     DISPLAY 'TOTAL INPUT RECORDS READ ' PV-DISPLAY-COUNT.        18630000
185700                                                                  18640000
185800     MOVE PV-FETCH-COUNT     TO PV-DISPLAY-COUNT                  18650000
185900     DISPLAY 'TOTAL DIVERTS FETCHED    ' PV-DISPLAY-COUNT.        18660000
186000                                                                  18670000
186100     MOVE PV-SCAN-ON-WRITTEN  TO PV-DISPLAY-COUNT                 18680001
186200     DISPLAY 'SCAN ON EXTRACTS WRITTEN  ' PV-DISPLAY-COUNT.       18690004
186300     MOVE PV-EMPTY-WRITTEN    TO PV-DISPLAY-COUNT                 18700001
186400     DISPLAY 'EMPTY EXTRACTS WRITTEN    ' PV-DISPLAY-COUNT.       18710004
186500     MOVE PV-INACTIVE-WRITTEN TO PV-DISPLAY-COUNT                 18720001
186600     DISPLAY 'INACTIVE EXTRACTS WRITTEN ' PV-DISPLAY-COUNT.       18730004
186700     MOVE PV-UNKNOWN-WRITTEN  TO PV-DISPLAY-COUNT                 18740004
186800     DISPLAY 'UNKNOWN EXTRACTS WRITTEN  ' PV-DISPLAY-COUNT.       18750004
186900/                                                                 18760001
187000******************************************************************18770001
187100 9200-SQL-ABEND.                                                  18780001
187200******************************************************************18790001
187300                                                                  18800001
187400     DISPLAY SPACES                                                       
187500     MOVE PV-READ-COUNT      TO PV-DISPLAY-COUNT.                 18620000
187600     DISPLAY ' ABEND ERROR RECORD NBR ' PV-DISPLAY-COUNT                  
187700     DISPLAY SPACES                                                       
187800     DISPLAY DCLTUPLDER                                                   
187900     DISPLAY SPACES                                                       
188000                                                                          
188100     MOVE SQLCODE                     TO SQLCODE2.                18810001
188200     MOVE SQLERRD(3)                  TO SQLERRD3.                18820001
188300                                                                  18830000
188400     DISPLAY '** ABEND **         ** = SQLERROR'.                 18840000
188500     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        18850000
188600     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             18860009
188700     DISPLAY '** TABLE NAME * = ' PV-DB2-TABLE-NAME.              18870000
188800     DISPLAY '** TABLE NAME * = ' PV-DB2-TABLE-NAME-1.            18880000
188900     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                18890000
189000     DISPLAY '*** MESSAGE     = ' PV-DB2-OPERATION-MESSAGE-1.     18900000
189100     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-2.     18910000
189200     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-3.     18920000
189300     DISPLAY '** HOST VARIABLE= ' PV-DISPLAY-HOST-VAR             18930000
189400                                                                  18940000
189500     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                18950000
189600     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                18960000
189700     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 18970000
189800     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                18980000
189900                                                                  18990000
190000                                                                  19000000
190100     MOVE +4013                       TO PV-ABEND-CODE.           19010000
190200     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         19020000
190300                                                                  19030000
190400******************************************************************19040000
190500 9300-SQL-WARNING.                                                19050000
190600******************************************************************19060000
190700                                                                  19070000
190800     DISPLAY SPACES                                                       
190900     MOVE PV-READ-COUNT      TO PV-DISPLAY-COUNT.                 18620000
191000     DISPLAY ' ABEND ERROR RECORD NBR ' PV-DISPLAY-COUNT                  
191100     DISPLAY SPACES                                                       
191200     DISPLAY DCLTUPLDER                                                   
191300     DISPLAY SPACES                                                       
191400                                                                          
191500     DISPLAY '9300-SQL-WARNING'.                                  19080000
191600     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        19090000
191700     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             19100009
191800     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                19110000
191900                                                                  19120000
192000     MOVE SQLCODE                     TO SQLCODE2.                19130000
192100     MOVE SQLERRD(3)                  TO SQLERRD3.                19140000
192200     DISPLAY '** ABEND **       ** = SQLWARNING'.                 19150000
192300     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  19160000
192400     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  19170000
192500     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  19180000
192600     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  19190000
192700     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  19200000
192800     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  19210000
192900     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  19220000
193000     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  19230000
193100     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  19240000
193200     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  19250000
193300                                                                  19260000
193400     MOVE +4013                       TO PV-ABEND-CODE.           19270000
193500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         19280000
193600*                                                                 19290000
