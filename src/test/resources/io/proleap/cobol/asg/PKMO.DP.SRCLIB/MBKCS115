00001 *                                                                 02/05/92
00002 *                                                                 MBKCS115
00003 *                                                                    LV197
00004  IDENTIFICATION DIVISION.                                         MBKCS115
00005                                                                   MBKCS115
00006  PROGRAM-ID.    MBKCS115.                                            CL137
00007  AUTHOR.        BOB LOOS - STRATAGEM.                                CL*28
00008  INSTALLATION.  KOHLS DEPARTMENT STORES.                          MBKCS115
00009  DATE-WRITTEN.  08-08-91.                                            CL137
00010  DATE-COMPILED.                                                   MBKCS115
00011                                                                   MBKCS115
00012 ***************************************************************** MBKCS115
00013 *    R115 - APPLICATION SYSTEM AVAILABILITY SELECTION                CL161
00014 *                                                                    CL**3
00015 *    THIS PROGRAM ALLOWS THE USER TO CHOOSE THE TYPE OF              CL*23
00016 *    CRITERIA THAT HE OR SHE WANTS TO USE TO GENERATE THE APPLICA-   CL140
00017 *    TION SYSTEM AVAIL LIST.  THE CRITERIA IS SELECTED BY ENTERING   CL137
00018 *    THE APPROPRIATE VALUES ON THE APPLICATION SYSTEM AVAIL SELECT   CL140
00019 ***************************************************************** MBKCS115
00020                                                                   MBKCS115
00021 *                                                                 MBKCS115
00022 *                                                                 MBKCS115
00023 *                                                                 MBKCS115
00024  ENVIRONMENT DIVISION.                                            MBKCS115
00025 *                                                                 MBKCS115
00026 *                                                                 MBKCS115
00027 *                                                                 MBKCS115
00028  DATA DIVISION.                                                   MBKCS115
00029 *                                                                 MBKCS115
00030 *                                                                 MBKCS115
00031  WORKING-STORAGE SECTION.                                         MBKCS115
00032                                                                      CL**5
00033  01  PC-PROGRAM-CONSTANTS.                                           CL**5
00034      05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.MBKCS115
00035      05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  MBKCS115
00036                                                      COMP SYNC.   MBKCS115
00037      05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        MBKCS115
00038      'MB115A  '.                                                     CL137
00039      05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        MBKCS115
00040      'MBKM115 '.                                                     CL137
00041      05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        MBKCS115
00042      'MBKCS115'.                                                     CL137
00043      05  PC-MAX-RETRIES                 PIC S9(04)   VALUE +3        CL169
00044                                                      COMP SYNC.   MBKCS115
00045      05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128      CL169
00046                                                      COMP SYNC.      CL169
00047      05  FILLER REDEFINES PC-ERASE-EOF-COMP.                      MBKCS115
00048          10  FILLER                     PIC X(01).                MBKCS115
00049          10  PC-ERASE-EOF               PIC X(01).                MBKCS115
00050      05  PC-MBLAPLAV                    PIC X(08)    VALUE           CL137
00051      'MBLAPLAV'.                                                     CL137
00052      05  PC-GMA-LIT                     PIC X(03)    VALUE 'GMA'.    CL188
00053      05  PC-DMA-LIT                     PIC X(03)    VALUE 'DMA'.    CL188
00054      05  PC-DPT-LIT                     PIC X(03)    VALUE 'DPT'.    CL188
00055      05  PC-MCL-LIT                     PIC X(03)    VALUE 'MCL'.    CL188
00056      05  PC-SCL-LIT                     PIC X(03)    VALUE 'SCL'.    CL188
00057      05  PC-N                           PIC X(01)    VALUE 'N'.      CL188
00058      05  PC-Y                           PIC X(01)    VALUE 'Y'.      CL175
00059      05  PC-ZERO-VALUE                  PIC X(01)    VALUE '0'.      CL162
00060      05  PC-OPER-COMPANY                PIC X(02)    VALUE '03'.     CL*66
00061      05  PC-TSYMSG-NUMBERS.                                          CL102
00062          10 PC-TSYMSG-00005             PIC 9(05)    VALUE 00005.    CL102
00063          10 PC-TSYMSG-00010             PIC 9(05)    VALUE 00010.    CL160
00064          10 PC-TSYMSG-00030             PIC 9(05)    VALUE 00030.    CL109
00065          10 PC-TSYMSG-00032             PIC 9(05)    VALUE 00032.    CL109
00066          10 PC-TSYMSG-00045             PIC 9(05)    VALUE 00045.    CL104
00067          10 PC-TSYMSG-00062             PIC 9(05)    VALUE 00062.    CL124
00068          10 PC-TSYMSG-00076             PIC 9(05)    VALUE 00076.    CL104
00069          10 PC-TSYMSG-00077             PIC 9(05)    VALUE 00077.    CL104
00070          10 PC-TSYMSG-00078             PIC 9(05)    VALUE 00078.    CL104
00071          10 PC-TSYMSG-00079             PIC 9(05)    VALUE 00079.    CL104
00072          10 PC-TSYMSG-00080             PIC 9(05)    VALUE 00080.    CL104
00073          10 PC-TSYMSG-00081             PIC 9(05)    VALUE 00081.    CL105
00074          10 PC-TSYMSG-00082             PIC 9(05)    VALUE 00082.    CL112
00075          10 PC-TSYMSG-00148             PIC 9(05)    VALUE 00148.    CL169
00076                                                                      CL102
00077  01  PM-PROGRAM-MESSAGES.                                         MBKCS115
00078      05  PM-PROGRAM-MESSAGE-1           PIC X(78)    VALUE           CL**3
00079      'INVALID NEXT APLSICATION ACTIVITY RECEIVED'.                   CL140
00080                                                                      CL**5
00081  01  PS-PROGRAM-SWITCHES.                                         MBKCS115
00082      05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   MBKCS115
00083          88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   MBKCS115
00084          88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   MBKCS115
00085          88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   MBKCS115
00086          88  PS-SEND-DATA-ONLY                       VALUE '4'.   MBKCS115
00087          88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   MBKCS115
00088          88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   MBKCS115
00089      05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   MBKCS115
00090          88  PS-ERROR                                VALUE 'Y'.   MBKCS115
00091          88  PS-NO-ERROR                             VALUE 'N'.   MBKCS115
00092      05  PS-2-CHAR-EDIT-SW              PIC X(01)    VALUE 'N'.      CL*39
00093          88  PS-2-CHAR-ERROR                         VALUE 'Y'.      CL*39
00094          88  PS-NO-2-CHAR-ERROR                      VALUE 'N'.      CL*39
00095      05  PS-3-CHAR-EDIT-SW              PIC X(01)    VALUE 'N'.      CL*39
00096          88  PS-3-CHAR-ERROR                         VALUE 'Y'.      CL*39
00097          88  PS-NO-3-CHAR-ERROR                      VALUE 'N'.      CL*39
00098      05  PS-SPECIF-TRAN-SW              PIC X(01)    VALUE 'N'.      CL110
00099          88  PS-SPECIF-TRAN                          VALUE 'Y'.      CL110
00100          88  PS-NO-SPECIF-TRAN                       VALUE 'N'.      CL110
00101      05  PS-SPECIF-APLS-SW              PIC X(01)    VALUE 'N'.      CL149
00102          88  PS-SPECIF-APLS                          VALUE 'Y'.      CL149
00103          88  PS-NO-SPECIF-APLS                       VALUE 'N'.      CL149
00104      05  PS-SPECIF-GMA-SW               PIC X(01)    VALUE 'N'.      CL149
00105          88  PS-SPECIF-GMA                           VALUE 'Y'.      CL149
00106          88  PS-NO-SPECIF-GMA                        VALUE 'N'.      CL149
00107      05  PS-SPECIF-DMA-SW               PIC X(01)    VALUE 'N'.      CL110
00108          88  PS-SPECIF-DMA                           VALUE 'Y'.      CL110
00109          88  PS-NO-SPECIF-DMA                        VALUE 'N'.      CL110
00110      05  PS-SPECIF-DPT-SW               PIC X(01)    VALUE 'N'.      CL110
00111          88  PS-SPECIF-DPT                           VALUE 'Y'.      CL110
00112          88  PS-NO-SPECIF-DPT                        VALUE 'N'.      CL110
00113      05  PS-SPECIF-MCL-SW               PIC X(01)    VALUE 'N'.      CL110
00114          88  PS-SPECIF-MCL                           VALUE 'Y'.      CL110
00115          88  PS-NO-SPECIF-MCL                        VALUE 'N'.      CL110
00116      05  PS-SPECIF-SCL-SW               PIC X(01)    VALUE 'N'.      CL110
00117          88  PS-SPECIF-SCL                           VALUE 'Y'.      CL110
00118          88  PS-NO-SPECIF-SCL                        VALUE 'N'.      CL110
00119      05  PS-DATA-SW                     PIC X(01)    VALUE 'N'.      CL169
00120          88  PS-DATA-ERROR                           VALUE 'Y'.      CL169
00121          88  PS-NO-DATA-ERROR                        VALUE 'N'.      CL169
00122                                                                   MBKCS115
00123  01  PV-PROGRAM-VARIABLES.                                        MBKCS115
00124      05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     MBKCS115
00125                                                      COMP SYNC.   MBKCS115
00126      05  PV-NAV-MNEMONIC                PIC X(08)    VALUE SPACES.   CL**5
00127      05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.   CL*21
00128      05  PV-SQL-SUB                     PIC S9(04)   VALUE ZERO      CL170
00129                                                      COMP SYNC.      CL169
00130      05  PV-DB2-COUNT                   PIC S9(09)   VALUE ZERO      CL171
00131                                                      COMP-3.         CL171
00132      05  PV-SQL-SWITCH                  PIC X        VALUE ' '.      CL188
00133          88  PV-NO-READ                              VALUE ' '.      CL188
00134          88  PV-GMA-READ                             VALUE 'G'.      CL188
00135          88  PV-DMA-READ                             VALUE 'D'.      CL188
00136          88  PV-DPT-READ                             VALUE 'T'.      CL188
00137          88  PV-MCL-READ                             VALUE 'M'.      CL188
00138          88  PV-SCL-READ                             VALUE 'S'.      CL188
00139          88  PV-MERCH-READ                           VALUE 'H'.      CL188
00140  EJECT                                                            MBKCS115
00141 ***************************************************************** MBKCS115
00142 *    STANDARD COMMAREA.                                           MBKCS115
00143 ***************************************************************** MBKCS115
00144                                                                   MBKCS115
00145      COPY DPWS020.                                                   CL197
00146      05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                MBKCS115
00147                                                                   MBKCS115
00148 ***************************************************************** MBKCS115
00149 *    INTER-APPLICATION COMMAREA.                                     CL140
00150 ***************************************************************** MBKCS115
00151                                                                   MBKCS115
00152          10  INTER-APPL-COMM-AREA       PIC X(200).                  CL140
00153                                                                      CL*32
00154      COPY MBWS005.                                                   CL197
00155                                                                   MBKCS115
00156 ***************************************************************** MBKCS115
00157 *    SPECIFIC COMMMAREA FOR MBKCS115.                                CL137
00158 ***************************************************************** MBKCS115
00159                                                                   MBKCS115
00160      COPY MBWS014.                                                   CL197
00161                                                                   MBKCS115
00162 ***************************************************************** MBKCS115
00163 *    ABEND PROCESSING COPYBOOK.                                   MBKCS115
00164 ***************************************************************** MBKCS115
00165                                                                   MBKCS115
00166      COPY DPWS013.                                                   CL197
00167                                                                   MBKCS115
00168 ***************************************************************** MBKCS115
00169 *    ATTRIBUTE SETTINGS COPYBOOK.                                 MBKCS115
00170 ***************************************************************** MBKCS115
00171                                                                   MBKCS115
00172      COPY DPWS015.                                                MBKCS115
00173                                                                   MBKCS115
00174 ***************************************************************** MBKCS115
00175 *    CURRENT DATE AND TIME COPYBOOK.                              MBKCS115
00176 ***************************************************************** MBKCS115
00177                                                                   MBKCS115
00178      COPY DPWS017.                                                   CL*14
00179                                                                   MBKCS115
00180 ***************************************************************** MBKCS115
00181 *    TOGGLE FUNCTION KEY LINES COPYBOOK.                          MBKCS115
00182 ***************************************************************** MBKCS115
00183                                                                   MBKCS115
00184      COPY DPWS009.                                                   CL*14
                                                                        MBKCS101
      *****************************************************************         
      *    SYSTEM MESSAGE FIELDS                                                
      *****************************************************************         
                                                                                
           COPY DPWS006.                                                        
                                                                                
00186 ***************************************************************** MBKCS115
00187 *    FUNCTION KEYS COPYBOOK.                                      MBKCS115
00188 ***************************************************************** MBKCS115
00189                                                                   MBKCS115
00190      COPY DPWS016.                                                   CL*14
00191                                                                   MBKCS115
00192 ***************************************************************** MBKCS115
00193 *    DPKUT045 COPYBOOK.                                           MBKCS115
00194 ***************************************************************** MBKCS115
00195                                                                   MBKCS115
00196      COPY DPWS045.                                                   CL*14
00197                                                                      CL*75
00198      COPY DPRD507I.                                                  CL*76
00199  EJECT                                                               CL*50
00200                                                                   MBKCS115
00201 ***************************************************************** MBKCS115
00202 *    STANDARD ATTENTION IDENTIFIER LIST                           MBKCS115
00203 ***************************************************************** MBKCS115
00204                                                                   MBKCS115
00205      COPY DFHAID.                                                 MBKCS115
00206                                                                   MBKCS115
00207 ***************************************************************** MBKCS115
00208 *    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST        MBKCS115
00209 ***************************************************************** MBKCS115
00210                                                                   MBKCS115
00211      COPY DFHBMSCA.                                               MBKCS115
00212                                                                   MBKCS115
00213 ***************************************************************** MBKCS115
00214 *    MAP LAYOUT                                                   MBKCS115
00215 ***************************************************************** MBKCS115
00216                                                                   MBKCS115
00217      COPY MBKM115.                                                   CL138
00218                                                                      CL**6
00219  01  MD-MAP-DATA-AREA REDEFINES MB115AO.                             CL139
00220      05  FILLER                         PIC X(446).                  CL163
00221  01  WK-CONDITION-CHECKS.                                            CL*26
00222      05  WK-TWO-CHAR-EDIT.                                           CL145
00223          10  WK-TWO-CHAR-EDIT-1         PIC X(01) VALUE SPACE.       CL145
00224          10  WK-TWO-CHAR-EDIT-2         PIC X(01) VALUE SPACE.       CL145
00225      05  WK-THREE-CHAR-EDIT.                                         CL*26
00226          10  WK-THREE-CHAR-EDIT-1       PIC X(01) VALUE SPACE.       CL*26
00227          10  WK-THREE-CHAR-EDIT-2       PIC X(01) VALUE SPACE.       CL*26
00228          10  WK-THREE-CHAR-EDIT-3       PIC X(01) VALUE SPACE.       CL*26
00229  EJECT                                                            MBKCS115
00230 *                                                                    CL166
00231 *    DECLARE FOR TABLE MDSEAR                                        CL166
00232 *                                                                    CL166
00233      EXEC SQL                                                        CL166
00234           INCLUDE TMDSEAR                                            CL166
00235      END-EXEC.                                                       CL166
00236 *                                                                    CL166
00237 *    DECLARE FOR TABLE APLAVL                                        CL166
00238 *                                                                    CL166
00239      EXEC SQL                                                        CL166
00240           INCLUDE TAPLAVL                                            CL166
00241      END-EXEC.                                                       CL167
00242 *                                                                    CL166
00243 *    DECLARE FOR DB2 COMMUNICATIONS                                  CL166
00244 *                                                                    CL166
00245      EXEC SQL                                                        CL166
00246           INCLUDE SQLCA                                              CL166
00247      END-EXEC.                                                       CL166
00248 *                                                                    CL166
00249  EJECT                                                               CL166
00250  LINKAGE SECTION.                                                 MBKCS115
00251                                                                   MBKCS115
00252  01  DFHCOMMAREA.                                                    CL*27
00253      05  FILLER                         OCCURS  1 TO 4072 TIMES      CL*27
00254                                         DEPENDING ON EIBCALEN.       CL*27
00255          10  FILLER                     PIC X.                       CL*27
00256                                                                      CL*27
00257 *                                                                 MBKCS115
00258 *                                                                 MBKCS115
00259 *                                                                 MBKCS115
00260  PROCEDURE DIVISION.                                              MBKCS115
00261                                                                   MBKCS115
00262  0000-MAIN-MODULE.                                                   CL**8
00263                                                                   MBKCS115
00264 ******************************************************************MBKCS115
00265 *    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.           MBKCS115
00266 ******************************************************************MBKCS115
00267                                                                   MBKCS115
00268      PERFORM DP015-0000-CHECK-COMMAREA.                           MBKCS115
00269                                                                   MBKCS115
00270 ******************************************************************   CL**8
00271 *    DP020-SRC-RETURN-W-TRAN-ID WILL BE TRUE IF THIS PROGRAM WAS     CL**8
00272 *    SENT A STANDARD COMMAREA. IF NOT SET TRUE (MEANING OTHER        CL**8
00273 *    THAN A STANDARD COMMAREA WAS SENT TO THIS PROGRAM, THIS         CL**8
00274 *    PROGRAM WILL RETURN TO CISS.                                    CL**8
00275 ******************************************************************   CL**8
00276      IF DP020-SRC-RETURN-W-TRAN-ID                                MBKCS115
00277          PERFORM 1000-CONTROL-PROCESSING                             CL*11
00278      END-IF.                                                      MBKCS115
00279                                                                   MBKCS115
00280      PERFORM DP003-0000-RETURN-TO-CICS.                           MBKCS115
00281  EJECT                                                            MBKCS115
00282  1000-CONTROL-PROCESSING.                                            CL**8
00283                                                                   MBKCS115
00284 ******************************************************************MBKCS115
00285 *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    MBKCS115
00286 *    COURSE OF ACTION IS FOR THIS TRANSACTION.                    MBKCS115
00287 *                                                                 MBKCS115
00288 *    PERFORMED BY 0000-MAIN-MODULE.                                  CL**8
00289 ******************************************************************MBKCS115
00290                                                                      CL**3
00291      EVALUATE TRUE                                                MBKCS115
00292                                                                   MBKCS115
00293          WHEN DP020-NEXT-ACT-INITIAL                              MBKCS115
00294              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                    CL**3
00295                                                                   MBKCS115
00296              PERFORM 1100-INITIALIZE-COMMAREA                        CL**8
00297              PERFORM 5100-SAVE-INITIAL-INTERAPPL                     CL140
00298              PERFORM 2000-BUILD-INITIAL-PANEL                        CL*37
00299                                                                   MBKCS115
00300          WHEN DP020-NEXT-ACT-READ-MAP                             MBKCS115
00301              PERFORM 3000-PROCESS-PANEL                              CL*10
00302                                                                      CL**3
00303          WHEN DP020-NEXT-ACT-RETURN                                  CL**3
00304              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                    CL**3
00305              PERFORM 4000-DISPLAY-PANEL                              CL*20
00306                                                                      CL**3
00307          WHEN DP020-NEXT-ACT-ERROR                                MBKCS115
00308              MOVE DP020-MSG-MESSAGE       TO PV-MESSAGE              CL*42
00309                                                                      CL*21
00310              IF DP020-NAV-MNEMONIC = SPACES                          CL*15
00311                  MOVE SPACES              TO ANAVCMDO                CL*34
00312                  MOVE DP015-GREEN         TO ANAVCMDC                CL*34
00313                  MOVE DP015-UNDERLINE     TO ANAVCMDH                CL*34
00314              ELSE                                                    CL*15
00315                  MOVE DP015-RED           TO ANAVCMDC                CL*34
00316                  MOVE DP015-REVERSE       TO ANAVCMDH                CL*34
00317              END-IF                                                  CL*16
00318                                                                      CL**4
00319              SET PS-ERROR                 TO TRUE                    CL*38
00320              SET PS-SEND-DATA-ONLY-FRSET  TO TRUE                    CL*38
00321                                                                      CL*38
00322              MOVE PV-MESSAGE              TO DP020-MSG-MESSAGE       CL**4
00323              MOVE -1                      TO ANAVCMDL                CL**4
00324                                                                      CL151
00325              MOVE LOW-VALUES TO DP020-INTER-APPL-DATA-AREA           CL151
00326              PERFORM 3300-EDIT-DATA-IN-COMMAREA                      CL151
00327                                                                      CL**4
00328              PERFORM 4000-DISPLAY-PANEL                              CL*20
00329                                                                      CL**4
00330          WHEN OTHER                                               MBKCS115
00331              SET DP013-LOGIC-ABEND        TO TRUE                    CL*34
00332              SET DP013-NO-ROLLBACK        TO TRUE                    CL*34
00333                                                                   MBKCS115
00334              MOVE 'B100-CONTROL-PROCESSING' TO                    MBKCS115
00335                   DP013-PARAGRAPH                                 MBKCS115
00336                                                                      CL**4
00337              MOVE PM-PROGRAM-MESSAGE-1      TO                       CL**3
00338                   DP013-MESSAGE-TEXT(1)                           MBKCS115
00339                                                                   MBKCS115
00340              PERFORM DP013-0000-PROCESS-ABEND                     MBKCS115
00341                                                                   MBKCS115
00342      END-EVALUATE.                                                MBKCS115
00343  EJECT                                                            MBKCS115
00344  1100-INITIALIZE-COMMAREA.                                           CL*20
00345                                                                      CL*20
00346 ******************************************************************   CL*20
00347 *    INITIALIZE THE INTER APPLICATION COMMAREA AND THE               CL140
00348 *    APPLICATION SPECIFIC COMMAREA.                                  CL140
00349 *                                                                    CL*20
00350 *    PERFORMED BY 1000-CONTROL-PROCESSING.                           CL*20
00351 *    PERFORMED BY D200-CHECK-FUNCTION-KEY.                           CL*20
00352 ******************************************************************   CL*20
00353                                                                      CL*20
00354      MOVE LOW-VALUES            TO DP020-INTER-APPL-DATA-AREA.       CL140
00355      MOVE PC-OPER-COMPANY       TO MB014-CO-NUMBER-X.                CL137
00356      MOVE SPACES                TO MB014-APLS-NUMBER-X               CL140
00357                                    MB014-GMA-NUMBER-X                CL138
00358                                    MB014-DMA-NUMBER-X                CL137
00359                                    MB014-DEPT-NUMBER-X               CL137
00360                                    MB014-MCLASS-NUMBER-X             CL137
00361                                    MB014-SCLASS-NUMBER-X.            CL137
00362      MOVE PC-N                  TO MB014-HISTORY-INDICATOR.          CL163
00363                                                                      CL*20
00364  EJECT                                                               CL*20
00365  2000-BUILD-INITIAL-PANEL.                                           CL*37
00366                                                                   MBKCS115
00367 ******************************************************************MBKCS115
00368 *    PERFORMED ON THE FIRST PASS IF THIS PROGRAM                     CL*38
00369 *                                                                 MBKCS115
00370 *    PERFORMED BY B100-CONTROL-PROCESSING.                        MBKCS115
00371 ******************************************************************MBKCS115
00372                                                                      CL*53
00373      MOVE DP015-GREEN     TO AAPLSC                                  CL140
00374                              AGMAC                                   CL138
00375                              ADMAC                                   CL*62
00376                              ADEPTC                                  CL*62
00377                              AMCLASSC                                CL*62
00378                              ASCLASSC                                CL161
00379                              AHISTC.                                 CL161
00380                                                                      CL*38
00381      MOVE DP015-UNDERLINE TO AAPLSH                                  CL140
00382                              AGMAH                                   CL138
00383                              ADMAH                                   CL*42
00384                              ADEPTH                                  CL*42
00385                              AMCLASSH                                CL*42
00386                              ASCLASSH                                CL161
00387                              AHISTH.                                 CL161
00388                                                                      CL161
00389      MOVE PC-N            TO AHISTO.                                 CL161
00390                                                                      CL*38
00391      PERFORM 4000-DISPLAY-PANEL.                                     CL*38
00392  EJECT                                                               CL*37
00393  3000-PROCESS-PANEL.                                                 CL*37
00394                                                                      CL*37
00395 ******************************************************************   CL*37
00396 *    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED     CL*37
00397 *    ON WHAT FUNCTION KEY WAS SELECTED.                              CL*37
00398 *                                                                    CL*37
00399 *    PERFORMED BY B100-CONTROL-PROCESSING.                           CL*37
00400 ******************************************************************   CL*37
00401                                                                      CL*37
00402      SET PS-SEND-DATA-ONLY-FRSET TO TRUE                          MBKCS115
00403                                                                   MBKCS115
00404      PERFORM DP007-0000-GET-PANEL.                                   CL**5
00405                                                                      CL**5
00406      IF (DP020-SRC-AID NOT = DP016-PF5)  AND                         CL**5
00407         (DP020-SRC-AID NOT = DP016-CLEAR)                            CL**5
00408          PERFORM 3200-MOVE-SCREEN-TO-COMMAREA                        CL*10
00409      END-IF.                                                         CL**5
00410                                                                      CL**5
00411      PERFORM 3100-CHECK-LOCAL-FKEYS.                                 CL*10
00412  EJECT                                                            MBKCS115
00413  3100-CHECK-LOCAL-FKEYS.                                             CL*20
00414                                                                      CL*10
00415 ******************************************************************   CL*10
00416 *    PERFORM THE APPROPRIATE PARAGRAPH BASED ON WHICH FUNCTION       CL*10
00417 *    KEY THE USER HIT.                                               CL*10
00418 *                                                                    CL*10
00419 *    PERFORMED BY 3000-PROCESS-PANEL.                                CL*10
00420 ******************************************************************   CL*10
00421                                                                      CL*10
00422      EVALUATE TRUE                                                   CL*10
00423                                                                      CL*10
00424          WHEN DP020-FK-GO-TO-TRAN(DP020-SRC-AID) OR                  CL*98
00425               DP020-FK-RETURN(DP020-SRC-AID)                         CL*99
00426               PERFORM 5000-SETUP-INTER-APPL                          CL140
00427               PERFORM DP015-1000-START-NAVIGATOR                     CL*60
00428                                                                      CL*60
00429          WHEN  DP020-FK-EDIT-GOTO(DP020-SRC-AID)                     CL*98
00430                PERFORM 3300-EDIT-DATA-IN-COMMAREA                    CL*92
00431                IF PS-NO-ERROR                                        CL*92
00432                    PERFORM 5000-SETUP-INTER-APPL                     CL140
00433                    PERFORM DP015-1000-START-NAVIGATOR                CL*92
00434                ELSE                                                  CL*92
00435                    PERFORM 4100-MOVE-COMMAREA-TO-SCREEN              CL100
00436                    PERFORM 4000-DISPLAY-PANEL                        CL*92
00437                END-IF                                                CL*92
00438                                                                      CL*32
00439          WHEN DP020-FK-REFRESH(DP020-SRC-AID)                        CL*32
00440              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                    CL*35
00441              INITIALIZE ANAVKEYO ANAVCMDO                            CL153
00442              PERFORM 1100-INITIALIZE-COMMAREA                        CL*32
00443              MOVE SPACES TO DP020-NAV-KEY-DATA                       CL151
00444              PERFORM 2000-BUILD-INITIAL-PANEL                        CL*58
00445                                                                      CL*32
00446          WHEN DP020-SRC-AID = DP016-ENTER                            CL*10
00447              IF (DP020-NAV-MNEMONIC = SPACES)     OR                 CL*10
00448                 (DP020-NAV-MNEMONIC = LOW-VALUES)                    CL*10
00449                  PERFORM 3300-EDIT-DATA-IN-COMMAREA                  CL*81
00450                  PERFORM 4100-MOVE-COMMAREA-TO-SCREEN                CL*83
00451                  PERFORM 4000-DISPLAY-PANEL                          CL*52
00452              ELSE                                                    CL*10
00453                  PERFORM 5000-SETUP-INTER-APPL                       CL144
00454                  PERFORM DP015-1000-START-NAVIGATOR                  CL125
00455              END-IF                                                  CL*10
00456                                                                      CL*10
00457          WHEN DP020-SRC-AID = DP016-PA2                              CL*33
00458              SET PS-SEND-DATA-ONLY TO TRUE                           CL*33
00459              MOVE -1               TO ANAVCMDL                       CL*33
00460              PERFORM DP017-0000-GET-CURR-DATE-TIME                   CL*79
00461              PERFORM DP009-0000-LOAD-FK-LINES                        CL*79
00462              PERFORM DP008-0000-WRITE-PANEL                          CL*79
00463                                                                      CL*33
00464          WHEN DP020-SRC-AID = DP016-CLEAR                            CL*33
00465              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                    CL*35
00466              PERFORM 3300-EDIT-DATA-IN-COMMAREA                      CL*33
00467              PERFORM 4000-DISPLAY-PANEL                              CL*33
00468                                                                      CL*33
00469          WHEN OTHER                                                  CL*33
00470              PERFORM 3300-EDIT-DATA-IN-COMMAREA                      CL*37
00471              MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER                CL102
00472              SET DP020-MSG-FATAL TO TRUE                             CL*37
00473              PERFORM 4000-DISPLAY-PANEL                              CL*37
00474                                                                      CL*10
00475      END-EVALUATE.                                                   CL*10
00476  EJECT                                                               CL*10
00477  3200-MOVE-SCREEN-TO-COMMAREA.                                       CL*20
00478                                                                   MBKCS115
00479 ******************************************************************MBKCS115
00480 *    MOVE THE FIELDS FROM THE MAP TO THE COMMAREA IF ANYTHING        CL*20
00481 *    WAS ENTERED IN THAT FIELD.                                      CL*20
00482 *                                                                    CL*20
00483 *    PERFORMED BY 3000-PROCESS-PANEL.                                CL*11
00484 ******************************************************************MBKCS115
00485                                                                   MBKCS115
00486      IF AAPLSL > 0                                                   CL140
00487         MOVE AAPLSI                 TO MB014-APLS-NUMBER-X           CL140
00488      ELSE                                                            CL**5
00489         IF AAPLSA = PC-ERASE-EOF                                     CL140
00490            MOVE SPACES              TO MB014-APLS-NUMBER-X           CL140
00491         END-IF                                                       CL*30
00492      END-IF.                                                         CL**5
00493                                                                      CL*33
00494      IF AGMAL > 0                                                    CL138
00495         MOVE AGMAI                  TO MB014-GMA-NUMBER-X            CL138
00496      ELSE                                                            CL138
00497         IF AGMAA = PC-ERASE-EOF                                      CL138
00498            MOVE SPACES              TO MB014-GMA-NUMBER-X            CL138
00499         END-IF                                                       CL138
00500      END-IF.                                                         CL138
00501                                                                      CL138
00502      IF ADMAL > 0                                                    CL*33
00503         MOVE ADMAI                  TO MB014-DMA-NUMBER-X            CL137
00504      ELSE                                                            CL*33
00505         IF ADMAA = PC-ERASE-EOF                                      CL*30
00506            MOVE SPACES              TO MB014-DMA-NUMBER-X            CL137
00507         END-IF                                                       CL102
00508      END-IF.                                                         CL*33
00509                                                                      CL*33
00510      IF ADEPTL > 0                                                   CL*33
00511         MOVE ADEPTI                  TO MB014-DEPT-NUMBER-X          CL137
00512      ELSE                                                            CL*30
00513         IF ADEPTA = PC-ERASE-EOF                                     CL*30
00514            MOVE SPACES               TO MB014-DEPT-NUMBER-X          CL137
00515         END-IF                                                       CL*30
00516      END-IF.                                                         CL*33
00517                                                                      CL*33
00518      IF AMCLASSL > 0                                                 CL*33
00519         MOVE AMCLASSI                TO MB014-MCLASS-NUMBER-X        CL137
00520      ELSE                                                            CL*30
00521         IF AMCLASSA = PC-ERASE-EOF                                   CL*30
00522            MOVE SPACES               TO MB014-MCLASS-NUMBER-X        CL137
00523         END-IF                                                       CL*30
00524      END-IF.                                                         CL*33
00525                                                                      CL*33
00526      IF ASCLASSL > 0                                                 CL*33
00527         MOVE ASCLASSI                TO MB014-SCLASS-NUMBER-X        CL137
00528      ELSE                                                            CL*30
00529         IF ASCLASSA = PC-ERASE-EOF                                   CL*30
00530            MOVE SPACES               TO MB014-SCLASS-NUMBER-X        CL137
00531         END-IF                                                       CL*30
00532                                                                      CL*33
00533      END-IF.                                                         CL*33
00534                                                                      CL161
00535      IF (AHISTL GREATER THAN ZERO                                    CL161
00536      OR  AHISTA EQUAL PC-ERASE-EOF)                                  CL161
00537          MOVE AHISTI                 TO MB014-HISTORY-INDICATOR      CL161
00538      END-IF.                                                         CL161
00539                                                                      CL*33
00540  EJECT                                                            MBKCS115
00541  3300-EDIT-DATA-IN-COMMAREA.                                         CL*10
00542                                                                      CL**5
00543 ******************************************************************   CL**5
00544 *    EDIT THE GMA, DMA, DEPARTMENT, MAJOR CLASS AND SUBCLASS.        CL*38
00545 *    IN ORDER TO BE VALID, ANY AND OR ALL OF THE ABOVE MUST          CL**3
00546 *    CONTAIN NUMERIC VALUES, AN '*', OR BE SPACES.                   CL*38
00547 *                                                                    CL*20
00548 *    PERFORMED BY 1000-CONTROL-PROCESSING.                           CL*10
00549 *    PERFORMED BY 3000-PROCESS-PANEL.                                CL*10
00550 *    PERFORMED BY 3100-CHECK-LOCAL-FKEYS.                            CL*10
00551 ******************************************************************   CL**5
00552                                                                      CL**5
00553      IF NOT DP020-NEXT-ACT-ERROR                                     CL*59
00554         SET PS-NO-ERROR TO TRUE                                      CL*62
00555         MOVE DP015-GREEN     TO ANAVKEYC                             CL153
00556                                 ANAVCMDC                             CL153
00557         MOVE DP015-UNDERLINE TO ANAVKEYH                             CL153
00558                                 ANAVCMDH                             CL153
00559      END-IF.                                                         CL*59
00560                                                                      CL*26
00561      MOVE DP015-GREEN     TO AAPLSC                                  CL140
00562                              AGMAC                                   CL138
00563                              ADMAC                                   CL*62
00564                              ADEPTC                                  CL*62
00565                              AMCLASSC                                CL*62
00566                              ASCLASSC                                CL161
00567                              AHISTC.                                 CL161
00568                                                                      CL*59
00569      MOVE DP015-UNDERLINE TO AAPLSH                                  CL140
00570                              AGMAH                                   CL138
00571                              ADMAH                                   CL*59
00572                              ADEPTH                                  CL*59
00573                              AMCLASSH                                CL*59
00574                              ASCLASSH                                CL161
00575                              AHISTH.                                 CL161
00576                                                                      CL*59
00577      SET PS-NO-SPECIF-TRAN TO TRUE.                                  CL110
00578                                                                      CL110
00579      IF MB014-APLS-NUMBER-X = SPACES                                 CL147
00580         CONTINUE                                                     CL*48
00581      ELSE                                                            CL*38
00582         IF MB014-ALL-APLS                                            CL166
00583            MOVE '**'                  TO MB014-APLS-NUMBER-X         CL166
00584         ELSE                                                         CL166
00585             MOVE MB014-APLS-NUMBER-X   TO WK-TWO-CHAR-EDIT           CL166
00586             PERFORM 3800-ALPHA-CHARACTER-EDIT                        CL166
00587             IF PS-2-CHAR-ERROR                                       CL166
00588                MOVE DP015-RED          TO AAPLSC                     CL166
00589                MOVE DP015-REVERSE      TO AAPLSH                     CL166
00590                IF PS-NO-ERROR                                        CL166
00591                   MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER      CL166
00592                   MOVE -1                   TO AAPLSL                CL166
00593                   SET DP020-MSG-FATAL       TO TRUE                  CL166
00594                   SET PS-ERROR              TO TRUE                  CL166
00595                END-IF                                                CL166
00596             ELSE                                                     CL166
00597                MOVE WK-TWO-CHAR-EDIT        TO MB014-APLS-NUMBER-X   CL166
00598                SET PS-SPECIF-APLS           TO TRUE                  CL166
00599             END-IF                                                   CL166
00600         END-IF                                                       CL166
00601      END-IF.                                                         CL*38
00602                                                                      CL*38
00603      IF MB014-GMA-NUMBER-X = SPACES                                  CL138
00604         CONTINUE                                                     CL138
00605      ELSE                                                            CL138
00606         IF MB014-ALL-GMAS                                            CL138
00607            MOVE '**'                  TO MB014-GMA-NUMBER-X          CL138
00608         ELSE                                                         CL138
00609            MOVE MB014-GMA-NUMBER-X    TO WK-TWO-CHAR-EDIT            CL138
00610            PERFORM 3400-TWO-CHARACTER-EDIT                           CL138
00611            IF PS-2-CHAR-ERROR                                        CL138
00612               MOVE DP015-RED          TO AGMAC                       CL138
00613               MOVE DP015-REVERSE      TO AGMAH                       CL138
00614               IF PS-NO-ERROR                                         CL138
00615                  MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER       CL138
00616                  MOVE -1                   TO AGMAL                  CL138
00617                  SET DP020-MSG-FATAL       TO TRUE                   CL138
00618                  SET PS-ERROR              TO TRUE                   CL138
00619               END-IF                                                 CL138
00620            ELSE                                                      CL138
00621               MOVE WK-TWO-CHAR-EDIT        TO MB014-GMA-NUMBER-X     CL138
00622               SET PS-SPECIF-GMA            TO TRUE                   CL138
00623               IF MB014-GMA-NUMBER-X = '00'                           CL157
00624                   MOVE DP015-RED      TO AGMAC                       CL157
00625                   MOVE DP015-REVERSE  TO AGMAH                       CL157
00626                   IF PS-NO-ERROR                                     CL157
00627                      MOVE PC-TSYMSG-00010  TO DP020-MSG-NUMBER       CL157
00628                      MOVE -1               TO AGMAL                  CL157
00629                      SET DP020-MSG-FATAL   TO TRUE                   CL157
00630                      SET PS-ERROR          TO TRUE                   CL157
00631                   END-IF                                             CL157
00632               END-IF                                                 CL157
00633            END-IF                                                    CL138
00634         END-IF                                                       CL138
00635      END-IF.                                                         CL138
00636                                                                      CL138
00637      IF MB014-DMA-NUMBER-X = SPACES                                  CL137
00638         CONTINUE                                                     CL*48
00639      ELSE                                                            CL*26
00640         IF MB014-ALL-DMAS                                            CL137
00641            MOVE '**'                       TO MB014-DMA-NUMBER-X     CL137
00642         ELSE                                                         CL*59
00643            MOVE MB014-DMA-NUMBER-X         TO WK-TWO-CHAR-EDIT       CL137
00644            PERFORM 3400-TWO-CHARACTER-EDIT                           CL*59
00645            IF PS-2-CHAR-ERROR                                        CL*59
00646               MOVE DP015-RED               TO ADMAC                  CL*88
00647               MOVE DP015-REVERSE           TO ADMAH                  CL*88
00648               IF PS-NO-ERROR                                         CL*59
00649                  MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER       CL102
00650                  MOVE -1                   TO ADMAL                  CL*88
00651                  SET DP020-MSG-FATAL       TO TRUE                   CL*88
00652                  SET PS-ERROR              TO TRUE                   CL*88
00653               END-IF                                                 CL*59
00654            ELSE                                                      CL*59
00655               MOVE WK-TWO-CHAR-EDIT   TO MB014-DMA-NUMBER-X          CL137
00656               SET PS-SPECIF-DMA            TO TRUE                   CL110
00657               IF MB014-DMA-NUMBER-X = '00'                           CL157
00658                   MOVE DP015-RED           TO ADMAC                  CL157
00659                   MOVE DP015-REVERSE       TO ADMAH                  CL157
00660                   IF PS-NO-ERROR                                     CL157
00661                      MOVE PC-TSYMSG-00010  TO DP020-MSG-NUMBER       CL157
00662                      MOVE -1               TO ADMAL                  CL157
00663                      SET DP020-MSG-FATAL   TO TRUE                   CL157
00664                      SET PS-ERROR          TO TRUE                   CL157
00665                   END-IF                                             CL157
00666               END-IF                                                 CL157
00667            END-IF                                                    CL*59
00668         END-IF                                                       CL*59
00669      END-IF.                                                         CL*26
00670                                                                      CL*26
00671      IF MB014-DEPT-NUMBER-X = SPACES                                 CL137
00672         CONTINUE                                                     CL*48
00673      ELSE                                                            CL*26
00674         IF MB014-ALL-DEPARTMENTS                                     CL137
00675            MOVE '***'                 TO MB014-DEPT-NUMBER-X         CL137
00676         ELSE                                                         CL*59
00677            MOVE MB014-DEPT-NUMBER-X   TO WK-THREE-CHAR-EDIT          CL137
00678            PERFORM 3500-THREE-CHARACTER-EDIT                         CL*59
00679            IF PS-3-CHAR-ERROR                                        CL*59
00680               MOVE DP015-RED          TO ADEPTC                      CL*59
00681               MOVE DP015-REVERSE      TO ADEPTH                      CL*59
00682               IF PS-NO-ERROR                                         CL*59
00683                  MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER       CL102
00684                  MOVE -1                   TO ADEPTL                 CL*88
00685                  SET DP020-MSG-FATAL       TO TRUE                   CL*88
00686                  SET PS-ERROR              TO TRUE                   CL*88
00687               END-IF                                                 CL*59
00688            ELSE                                                      CL*59
00689               MOVE WK-THREE-CHAR-EDIT      TO MB014-DEPT-NUMBER-X    CL137
00690               SET PS-SPECIF-DPT            TO TRUE                   CL110
00691               IF MB014-DEPT-NUMBER-X = '000'                         CL157
00692                   MOVE DP015-RED      TO ADEPTC                      CL157
00693                   MOVE DP015-REVERSE  TO ADEPTH                      CL157
00694                   IF PS-NO-ERROR                                     CL157
00695                      MOVE PC-TSYMSG-00010  TO DP020-MSG-NUMBER       CL157
00696                      MOVE -1               TO ADEPTL                 CL157
00697                      SET DP020-MSG-FATAL   TO TRUE                   CL157
00698                      SET PS-ERROR          TO TRUE                   CL157
00699                   END-IF                                             CL157
00700               END-IF                                                 CL157
00701            END-IF                                                    CL*59
00702         END-IF                                                       CL*59
00703      END-IF.                                                         CL*26
00704                                                                      CL*26
00705      IF MB014-MCLASS-NUMBER-X = SPACES                               CL137
00706         CONTINUE                                                     CL*48
00707      ELSE                                                            CL*26
00708         IF MB014-ALL-MCLASSES                                        CL137
00709            MOVE '**'                       TO                        CL*88
00710                 MB014-MCLASS-NUMBER-X                                CL137
00711         ELSE                                                         CL*59
00712            MOVE MB014-MCLASS-NUMBER-X      TO WK-TWO-CHAR-EDIT       CL137
00713            PERFORM 3400-TWO-CHARACTER-EDIT                           CL*59
00714            IF PS-2-CHAR-ERROR                                        CL*59
00715               MOVE DP015-RED               TO AMCLASSC               CL*88
00716               MOVE DP015-REVERSE           TO AMCLASSH               CL*88
00717               IF PS-NO-ERROR                                         CL*59
00718                  MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER       CL102
00719                  MOVE -1                   TO AMCLASSL               CL*88
00720                  SET DP020-MSG-FATAL       TO TRUE                   CL*88
00721                  SET PS-ERROR              TO TRUE                   CL*88
00722               END-IF                                                 CL*59
00723            ELSE                                                      CL*59
00724               MOVE WK-TWO-CHAR-EDIT        TO                        CL*88
00725                    MB014-MCLASS-NUMBER-X                             CL137
00726               SET PS-SPECIF-MCL            TO TRUE                   CL110
00727               IF MB014-MCLASS-NUMBER-X = '00'                        CL158
00728                   MOVE DP015-RED           TO AMCLASSC               CL158
00729                   MOVE DP015-REVERSE       TO AMCLASSH               CL158
00730                   IF PS-NO-ERROR                                     CL158
00731                      MOVE PC-TSYMSG-00010  TO DP020-MSG-NUMBER       CL158
00732                      MOVE -1               TO AMCLASSL               CL158
00733                      SET DP020-MSG-FATAL   TO TRUE                   CL158
00734                      SET PS-ERROR          TO TRUE                   CL158
00735                   END-IF                                             CL158
00736               END-IF                                                 CL158
00737            END-IF                                                    CL*59
00738         END-IF                                                       CL*59
00739      END-IF.                                                         CL*26
00740                                                                      CL*26
00741      IF MB014-SCLASS-NUMBER-X = SPACES                               CL137
00742         CONTINUE                                                     CL*48
00743      ELSE                                                            CL*26
00744         IF MB014-ALL-SCLASSES                                        CL137
00745            MOVE '***'                      TO                        CL*88
00746                 MB014-SCLASS-NUMBER-X                                CL137
00747         ELSE                                                         CL*28
00748            MOVE MB014-SCLASS-NUMBER-X      TO WK-THREE-CHAR-EDIT     CL137
00749            PERFORM 3500-THREE-CHARACTER-EDIT                         CL*48
00750            IF PS-3-CHAR-ERROR                                        CL*41
00751               MOVE DP015-RED               TO ASCLASSC               CL*88
00752               MOVE DP015-REVERSE           TO ASCLASSH               CL*88
00753               IF PS-NO-ERROR                                         CL*28
00754                  MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER       CL102
00755                  MOVE -1                   TO ASCLASSL               CL*88
00756                  SET DP020-MSG-FATAL       TO TRUE                   CL*88
00757                  SET PS-ERROR              TO TRUE                   CL*88
00758               END-IF                                                 CL*28
00759            ELSE                                                      CL*28
00760               MOVE WK-THREE-CHAR-EDIT      TO                        CL*88
00761                    MB014-SCLASS-NUMBER-X                             CL137
00762               SET PS-SPECIF-SCL            TO TRUE                   CL110
00763               IF MB014-SCLASS-NUMBER-X = '000'                       CL159
00764                   MOVE DP015-RED           TO ASCLASSC               CL159
00765                   MOVE DP015-REVERSE       TO ASCLASSH               CL159
00766                   IF PS-NO-ERROR                                     CL159
00767                      MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER       CL159
00768                      MOVE -1               TO ASCLASSL               CL159
00769                      SET DP020-MSG-FATAL   TO TRUE                   CL159
00770                      SET PS-ERROR          TO TRUE                   CL159
00771                   END-IF                                             CL159
00772               END-IF                                                 CL159
00773            END-IF                                                    CL*35
00774         END-IF                                                       CL*35
00775      END-IF.                                                         CL*28
00776                                                                      CL**5
00777      IF (PS-SPECIF-GMA AND                                           CL110
00778          PS-SPECIF-DMA AND                                           CL110
00779          PS-SPECIF-DPT AND                                           CL110
00780          PS-SPECIF-MCL AND                                           CL110
00781          PS-SPECIF-SCL AND                                           CL149
00782          PS-SPECIF-APLS)                                             CL149
00783          SET PS-SPECIF-TRAN TO TRUE                                  CL110
00784      END-IF.                                                         CL110
00785      PERFORM 3600-EDIT-FOR-SPACES.                                   CL166
00786 *                                                                    CL166
00787      IF  MB014-ALL-APLS                                              CL181
00788          IF (DP020-SRC-AID EQUAL DP016-ENTER                         CL181
00789          OR  DP020-SRC-AID EQUAL DP016-PF20)                         CL181
00790              CONTINUE                                                CL181
00791          ELSE                                                        CL181
00792              SET DP020-MSG-FATAL   TO  TRUE                          CL181
00793              MOVE -1               TO  AAPLSL                        CL181
00794              MOVE DP015-RED        TO  AAPLSC                        CL181
00795              MOVE DP015-REVERSE    TO  AAPLSH                        CL181
00796              SET PS-ERROR          TO  TRUE                          CL181
00797              MOVE PC-TSYMSG-00082  TO  DP020-MSG-NUMBER              CL194
00798          END-IF                                                      CL181
00799      END-IF.                                                         CL181
00800 *                                                                    CL181
00801      IF ((DP020-SRC-AID EQUAL DP016-PF15)                            CL185
00802      OR (MB014-ALL-APLS                                              CL183
00803      AND DP020-SRC-AID EQUAL DP016-PF20))                            CL183
00804          PERFORM 3700-HILIGHT-ERRORS                                 CL181
00805      END-IF.                                                         CL181
00806 *                                                                    CL181
00807      IF  PS-NO-ERROR                                                 CL184
00808          IF ((DP020-SRC-AID EQUAL DP016-PF13                         CL184
00809          OR  DP020-SRC-AID EQUAL DP016-PF15)                         CL185
00810          AND NOT MB014-ALL-APLS)                                     CL187
00811              PERFORM 3710-READ-APLAVL                                CL184
00812              PERFORM 3720-READ-MDSEAR                                CL184
00813          END-IF                                                      CL184
00814      END-IF.                                                         CL184
00815 *                                                                    CL184
00816      IF  MB014-VALID-HISTORY                                         CL161
00817          IF (DP020-SRC-AID EQUAL DP016-PF20                          CL176
00818          OR  DP020-SRC-AID EQUAL DP016-ENTER)                        CL176
00819              CONTINUE                                                CL174
00820          ELSE                                                        CL174
00821              IF  MB014-HISTORY-INDICATOR EQUAL PC-Y                  CL174
00822                  MOVE DP015-RED           TO AHISTC                  CL174
00823                  MOVE DP015-REVERSE       TO AHISTH                  CL174
00824                  IF  PS-NO-ERROR                                     CL174
00825                      MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER        CL174
00826                      MOVE -1              TO AHISTL                  CL174
00827                      SET PS-ERROR                                    CL174
00828                          DP020-MSG-FATAL  TO TRUE                    CL174
00829                  END-IF                                              CL174
00830              END-IF                                                  CL174
00831          END-IF                                                      CL174
00832      ELSE                                                            CL161
00833          MOVE DP015-RED           TO AHISTC                          CL163
00834          MOVE DP015-REVERSE       TO AHISTH                          CL163
00835          IF  PS-NO-ERROR                                             CL163
00836              MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                CL163
00837              MOVE -1              TO AHISTL                          CL163
00838              SET PS-ERROR                                            CL161
00839                  DP020-MSG-FATAL  TO TRUE                            CL161
00840          END-IF                                                      CL161
00841      END-IF.                                                         CL161
00842                                                                      CL*70
00843      IF (DP020-NAV-MNEMONIC = SPACES OR                              CL154
00844          DP020-NAV-MNEMONIC = LOW-VALUES) AND                        CL154
00845         (DP020-NAV-KEY-DATA > SPACES)                                CL155
00846          MOVE DP015-RED       TO ANAVKEYC                            CL152
00847          MOVE DP015-REVERSE   TO ANAVKEYH                            CL152
00848          IF PS-NO-ERROR                                              CL152
00849              MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                CL152
00850              MOVE -1              TO ANAVKEYL                        CL152
00851              SET PS-ERROR                                            CL154
00852                  DP020-MSG-FATAL  TO TRUE                            CL154
00853          END-IF                                                      CL152
00854      END-IF.                                                         CL152
00855  EJECT                                                               CL**5
00856  3400-TWO-CHARACTER-EDIT.                                            CL*40
00857                                                                      CL*40
00858 ******************************************************************   CL*40
00859 *    EDIT EACH CHARACTER IN THE TWO CHARACTER WORK FIELD             CL*40
00860 *    FOR VALID NUMERIC DATA.                                         CL*40
00861 *                                                                    CL*44
00862 *    PERFORMED BY 3300-EDIT-DATA-IN-COMMAREA                         CL*44
00863 ******************************************************************   CL*40
00864                                                                      CL*40
00865      SET PS-NO-2-CHAR-ERROR TO TRUE.                                 CL*40
00866                                                                      CL*40
00867      EVALUATE  TRUE                                                  CL*40
00868                                                                      CL*66
00869          WHEN WK-TWO-CHAR-EDIT NUMERIC                               CL*68
00870               CONTINUE                                               CL*68
00871                                                                      CL*68
00872          WHEN (WK-TWO-CHAR-EDIT-1 NUMERIC AND                        CL*66
00873                WK-TWO-CHAR-EDIT-2 = SPACES)                          CL*66
00874                MOVE WK-TWO-CHAR-EDIT-1 TO WK-TWO-CHAR-EDIT-2         CL*65
00875                MOVE PC-ZERO-VALUE      TO WK-TWO-CHAR-EDIT-1         CL*66
00876                                                                      CL*40
00877          WHEN (WK-TWO-CHAR-EDIT-1 = SPACES AND                       CL*40
00878                WK-TWO-CHAR-EDIT-2 NUMERIC)                           CL*40
00879                MOVE PC-ZERO-VALUE      TO WK-TWO-CHAR-EDIT-1         CL*66
00880                                                                      CL*40
00881          WHEN OTHER                                                  CL*40
00882               SET PS-2-CHAR-ERROR TO TRUE                            CL*40
00883                                                                      CL*66
00884      END-EVALUATE.                                                   CL*40
00885                                                                      CL*40
00886  EJECT                                                               CL*40
00887  3500-THREE-CHARACTER-EDIT.                                          CL*48
00888                                                                      CL*40
00889 ******************************************************************   CL*40
00890 *    EDIT EACH CHARACTER IN THE THREE CHARACTER WORK FIELD           CL*44
00891 *    FOR VALID NUMERIC DATA.                                         CL*40
00892 *                                                                    CL*44
00893 *    PERFORMED BY 3300-EDIT-DATA-IN-COMMAREA                         CL*44
00894 ******************************************************************   CL*40
00895                                                                      CL*40
00896      SET PS-NO-3-CHAR-ERROR TO TRUE                                  CL*40
00897                                                                      CL*40
00898      EVALUATE  TRUE                                                  CL*41
00899                                                                      CL*66
00900          WHEN WK-THREE-CHAR-EDIT NUMERIC                             CL*68
00901               CONTINUE                                               CL*68
00902                                                                      CL*68
00903          WHEN (WK-THREE-CHAR-EDIT-1 NUMERIC AND                      CL*41
00904                WK-THREE-CHAR-EDIT-2 = SPACES AND                     CL*41
00905                WK-THREE-CHAR-EDIT-3 = SPACES)                        CL*41
00906                MOVE WK-THREE-CHAR-EDIT-1 TO WK-THREE-CHAR-EDIT-3     CL*41
00907                MOVE PC-ZERO-VALUE        TO WK-THREE-CHAR-EDIT-1     CL*66
00908                                             WK-THREE-CHAR-EDIT-2     CL*41
00909                                                                      CL*41
00910          WHEN (WK-THREE-CHAR-EDIT-1  NUMERIC AND                     CL*66
00911                WK-THREE-CHAR-EDIT-2  NUMERIC AND                     CL*66
00912                WK-THREE-CHAR-EDIT-3 = SPACES)                        CL*41
00913                MOVE WK-THREE-CHAR-EDIT-2 TO WK-THREE-CHAR-EDIT-3     CL*41
00914                MOVE WK-THREE-CHAR-EDIT-1 TO WK-THREE-CHAR-EDIT-2     CL*86
00915                MOVE PC-ZERO-VALUE        TO WK-THREE-CHAR-EDIT-1     CL*66
00916                                                                      CL*41
00917          WHEN (WK-THREE-CHAR-EDIT-1 = SPACES AND                     CL*41
00918                WK-THREE-CHAR-EDIT-2 = SPACES AND                     CL*41
00919                WK-THREE-CHAR-EDIT-3 NUMERIC)                         CL*41
00920                MOVE PC-ZERO-VALUE TO WK-THREE-CHAR-EDIT-1            CL*66
00921                                      WK-THREE-CHAR-EDIT-2            CL*66
00922                                                                      CL*41
00923          WHEN (WK-THREE-CHAR-EDIT-1 = SPACES AND                     CL*66
00924                WK-THREE-CHAR-EDIT-2 NUMERIC AND                      CL*66
00925                WK-THREE-CHAR-EDIT-3 NUMERIC)                         CL*41
00926                MOVE PC-ZERO-VALUE TO WK-THREE-CHAR-EDIT-1            CL*66
00927                                                                      CL*41
00928          WHEN OTHER                                                  CL*41
00929               SET PS-3-CHAR-ERROR TO TRUE                            CL*41
00930                                                                      CL*66
00931      END-EVALUATE.                                                   CL*41
00932  EJECT                                                               CL*40
00933  3600-EDIT-FOR-SPACES.                                               CL*71
00934                                                                      CL*70
00935 ******************************************************************   CL*70
00936 *    EDIT EACH SCREEN FIELD FOR SPACES. ENTRIES ARE NOT ALLOWED      CL*70
00937 *    IF A PREVIOUS FIELD IS SPACES.                                  CL*70
00938 *                                                                    CL*70
00939 *    PERFORMED BY 3300-EDIT-DATA-IN-COMMAREA                         CL*70
00940 ******************************************************************   CL*70
00941                                                                      CL*70
00942      EVALUATE TRUE                                                   CL*70
00943                                                                      CL*70
00944          WHEN MB014-APLS-NUMBER-X = SPACES                           CL143
00945               MOVE DP015-RED            TO AAPLSC                    CL143
00946               MOVE DP015-REVERSE        TO AAPLSH                    CL143
00947               MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER          CL138
00948               MOVE -1                   TO AAPLSL                    CL143
00949               SET DP020-MSG-FATAL       TO TRUE                      CL138
00950               SET PS-ERROR              TO TRUE                      CL138
00951                                                                      CL138
00952          WHEN MB014-GMA-NUMBER-X = SPACES                            CL143
00953               MOVE DP015-RED            TO AGMAC                     CL143
00954               MOVE DP015-REVERSE        TO AGMAH                     CL143
00955               MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER          CL143
00956               MOVE -1                   TO AGMAL                     CL143
00957               SET DP020-MSG-FATAL       TO TRUE                      CL143
00958               SET PS-ERROR              TO TRUE                      CL143
00959                                                                      CL143
00960          WHEN (MB014-DEPT-NUMBER-X NOT = SPACES AND                  CL137
00961                MB014-DMA-NUMBER-X = SPACES)                          CL137
00962               MOVE DP015-RED            TO ADEPTC                    CL*88
00963               MOVE DP015-REVERSE        TO ADEPTH                    CL*88
00964               IF PS-NO-ERROR                                         CL*77
00965                  MOVE PC-TSYMSG-00080   TO DP020-MSG-NUMBER          CL102
00966                  MOVE -1                TO ADEPTL                    CL*88
00967                  SET DP020-MSG-FATAL    TO TRUE                      CL*88
00968                  SET PS-ERROR           TO TRUE                      CL*88
00969               END-IF                                                 CL*77
00970                                                                      CL*77
00971          WHEN (MB014-MCLASS-NUMBER-X NOT = SPACES AND                CL137
00972                MB014-DEPT-NUMBER-X = SPACES)                         CL137
00973               MOVE DP015-RED          TO AMCLASSC                    CL102
00974               MOVE DP015-REVERSE      TO AMCLASSH                    CL102
00975               IF PS-NO-ERROR                                         CL*70
00976                  MOVE PC-TSYMSG-00080 TO DP020-MSG-NUMBER            CL102
00977                  MOVE -1              TO AMCLASSL                    CL102
00978                  SET DP020-MSG-FATAL  TO TRUE                        CL102
00979                  SET PS-ERROR         TO TRUE                        CL102
00980               END-IF                                                 CL*70
00981                                                                      CL*70
00982          WHEN (MB014-SCLASS-NUMBER-X NOT = SPACES AND                CL137
00983                MB014-MCLASS-NUMBER-X = SPACES)                       CL137
00984               MOVE DP015-RED         TO ASCLASSC                     CL*72
00985               MOVE DP015-REVERSE     TO ASCLASSH                     CL*72
00986               IF PS-NO-ERROR                                         CL*70
00987                  MOVE PC-TSYMSG-00080 TO DP020-MSG-NUMBER            CL102
00988                  MOVE -1              TO ASCLASSL                    CL102
00989                  SET DP020-MSG-FATAL  TO TRUE                        CL102
00990                  SET PS-ERROR         TO TRUE                        CL102
00991               END-IF                                                 CL*70
00992                                                                      CL*70
00993      END-EVALUATE.                                                   CL*70
00994 *                                                                    CL191
00995 *    NOW, ENSURE NO ASTERISKS BEFORE A NUMERIC VALUE.                CL191
00996 *                                                                    CL191
00997      IF  PS-NO-ERROR                                                 CL191
00998                                                                      CL191
00999          IF (MB014-ALL-MCLASSES                                      CL191
01000          AND MB014-SCLASS-NUMBER NUMERIC)                            CL192
01001              MOVE DP015-RED     TO AMCLASSC                          CL191
01002              MOVE DP015-REVERSE TO AMCLASSH                          CL191
01003              MOVE -1            TO AMCLASSL                          CL191
01004              SET PS-DATA-ERROR TO TRUE                               CL191
01005          END-IF                                                      CL191
01006 *                                                                    CL191
01007          IF (MB014-ALL-DEPARTMENTS                                   CL191
01008          AND (MB014-SCLASS-NUMBER NUMERIC                            CL191
01009          OR  MB014-MCLASS-NUMBER NUMERIC))                           CL191
01010              MOVE DP015-RED     TO ADEPTC                            CL191
01011              MOVE DP015-REVERSE TO ADEPTH                            CL191
01012              MOVE -1            TO ADEPTL                            CL191
01013              SET PS-DATA-ERROR TO TRUE                               CL191
01014          END-IF                                                      CL191
01015 *                                                                    CL191
01016 *        IF (MB014-ALL-DMAS                                          CL195
01017 *        AND (MB014-DEPT-NUMBER  NUMERIC                             CL195
01018 *        OR  MB014-SCLASS-NUMBER NUMERIC                             CL195
01019 *        OR  MB014-MCLASS-NUMBER NUMERIC))                           CL195
01020 *            MOVE DP015-RED     TO ADMAC                             CL195
01021 *            MOVE DP015-REVERSE TO ADMAH                             CL195
01022 *            MOVE -1            TO ADMAL                             CL195
01023 *            SET PS-DATA-ERROR TO TRUE                               CL195
01024 *        END-IF                                                      CL195
01025 *                                                                    CL191
01026 *        IF (MB014-ALL-GMAS                                          CL195
01027 *        AND (MB014-DMA-NUMBER   NUMERIC                             CL195
01028 *        OR  MB014-DEPT-NUMBER   NUMERIC                             CL195
01029 *        OR  MB014-SCLASS-NUMBER NUMERIC                             CL195
01030 *        OR  MB014-MCLASS-NUMBER NUMERIC))                           CL195
01031 *            MOVE DP015-RED     TO AGMAC                             CL195
01032 *            MOVE DP015-REVERSE TO AGMAH                             CL195
01033 *            MOVE -1            TO AGMAL                             CL195
01034 *            SET PS-DATA-ERROR TO TRUE                               CL195
01035 *        END-IF                                                      CL195
01036 *                                                                    CL191
01037          IF  PS-DATA-ERROR                                           CL191
01038              MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                CL191
01039              SET DP020-MSG-FATAL  TO TRUE                            CL191
01040              SET PS-ERROR         TO TRUE                            CL191
01041          END-IF                                                      CL191
01042      END-IF.                                                         CL191
01043 *                                                                    CL191
01044  EJECT                                                               CL173
01045 ******************************************************************   CL173
01046 *    EDIT EACH SCREEN FIELD FOR ASTERISKS.  NONE ARE ALLOWED IF      CL177
01047 *    ALL APPL SYS IS REQUESTED.                                      CL177
01048 *                                                                    CL173
01049 *    PERFORMED BY 3300-EDIT-DATA-IN-COMMAREA                         CL173
01050 ******************************************************************   CL173
01051  3700-HILIGHT-ERRORS.                                                CL166
01052                                                                      CL166
01053      SET PS-NO-DATA-ERROR TO TRUE.                                   CL169
01054      IF MB014-ALL-SCLASSES                                           CL166
01055          MOVE DP015-RED     TO ASCLASSC                              CL166
01056          MOVE DP015-REVERSE TO ASCLASSH                              CL166
01057          MOVE -1            TO ASCLASSL                              CL166
01058          SET PS-DATA-ERROR TO TRUE                                   CL169
01059      END-IF.                                                         CL166
01060                                                                      CL166
01061      IF MB014-ALL-MCLASSES                                           CL166
01062          MOVE DP015-RED     TO AMCLASSC                              CL166
01063          MOVE DP015-REVERSE TO AMCLASSH                              CL166
01064          MOVE -1            TO AMCLASSL                              CL166
01065          SET PS-DATA-ERROR TO TRUE                                   CL169
01066      END-IF.                                                         CL166
01067                                                                      CL166
01068      IF MB014-ALL-DEPARTMENTS                                        CL166
01069          MOVE DP015-RED     TO ADEPTC                                CL166
01070          MOVE DP015-REVERSE TO ADEPTH                                CL166
01071          MOVE -1            TO ADEPTL                                CL166
01072          SET PS-DATA-ERROR TO TRUE                                   CL169
01073      END-IF.                                                         CL166
01074                                                                      CL166
01075      IF MB014-ALL-DMAS                                               CL166
01076          MOVE DP015-RED     TO ADMAC                                 CL166
01077          MOVE DP015-REVERSE TO ADMAH                                 CL166
01078          MOVE -1            TO ADMAL                                 CL166
01079          SET PS-DATA-ERROR TO TRUE                                   CL169
01080      END-IF.                                                         CL166
01081                                                                      CL166
01082      IF MB014-ALL-GMAS                                               CL166
01083          MOVE DP015-RED     TO AGMAC                                 CL166
01084          MOVE DP015-REVERSE TO AGMAH                                 CL166
01085          MOVE -1            TO AGMAL                                 CL166
01086          SET PS-DATA-ERROR TO TRUE                                   CL169
01087      END-IF.                                                         CL166
01088                                                                      CL166
01089      IF PS-DATA-ERROR                                                CL169
01090          MOVE PC-TSYMSG-00082 TO DP020-MSG-NUMBER                    CL166
01091          SET DP020-MSG-FATAL  TO TRUE                                CL166
01092          SET PS-ERROR         TO TRUE                                CL166
01093      END-IF.                                                         CL166
01094 *                                                                    CL166
01095  EJECT                                                               CL166
01096 ******************************************************************   CL166
01097 *    VERIFY THAT THE APLALV ROW EXISTS BEFORE INVOKING THE UPDATE.   CL166
01098 *                                                                    CL166
01099 *    PERFORMED BY 3300                                               CL166
01100 ******************************************************************   CL166
01101 *                                                                    CL166
01102  3710-READ-APLAVL.                                                   CL166
01103 *                                                                    CL166
01104      MOVE ZERO                 TO  PV-DB2-COUNT.                     CL172
01105      PERFORM                                                         CL166
01106          WITH TEST AFTER                                             CL166
01107          VARYING PV-SQL-SUB                                          CL166
01108          FROM 1 BY 1                                                 CL166
01109          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                CL166
01110             OR SQLCODE = 0                                           CL166
01111             OR SQLCODE = +100                                        CL166
01112 *                                                                    CL166
01113          EXEC SQL                                                    CL166
01114               SELECT                                                 CL172
01115                      COUNT(DISTINCT APLSYS_CDE)                      CL172
01116               INTO                                                   CL172
01117                      :PV-DB2-COUNT                                   CL172
01118               FROM                                                   CL166
01119                      TAPLAVL                                         CL168
01120               WHERE                                                  CL166
01121                      OPERCO_NBR       = :PC-OPER-COMPANY             CL167
01122                 AND  APLSYS_CDE       = :MB014-APLS-NUMBER-X         CL167
01123          END-EXEC                                                    CL166
01124 *                                                                    CL166
01125          EVALUATE TRUE                                               CL166
01126              WHEN SQLCODE = -904                                     CL166
01127              WHEN SQLCODE = -913                                     CL166
01128              WHEN SQLCODE = +100                                     CL166
01129              WHEN SQLCODE = ZERO                                     CL166
01130                   CONTINUE                                           CL166
01131              WHEN SQLWARN0 NOT EQUAL SPACE                           CL166
01132              WHEN SQLCODE NOT EQUAL ZERO                             CL166
01133                   MOVE '3710-READ-APLAVL'                            CL166
01134                                TO  DP013-PARAGRAPH                   CL166
01135                   MOVE 'READ APLSYS'                                 CL166
01136                                TO  DP013-MESSAGE-TEXT (1)            CL166
01137                   MOVE SQLCA   TO  DP013-SQLCA                       CL166
01138                   SET DP013-DB2-ABEND                                CL166
01139                                TO  TRUE                              CL166
01140                   PERFORM DP013-0000-PROCESS-ABEND                   CL166
01141          END-EVALUATE                                                CL166
01142      END-PERFORM.                                                    CL166
01143 *                                                                    CL166
01144      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                      CL166
01145          MOVE '3710-READ-APLAVL'                                     CL166
01146                                TO  DP013-PARAGRAPH                   CL166
01147          MOVE 'MAX RETRIES EXCEEDED FOR READ APLAVL'                 CL166
01148                                TO  DP013-MESSAGE-TEXT (1)            CL166
01149          MOVE SQLCA            TO  DP013-SQLCA                       CL166
01150          SET DP013-DB2-ABEND   TO  TRUE                              CL166
01151          PERFORM DP013-0000-PROCESS-ABEND                            CL166
01152      END-IF.                                                         CL166
01153 *                                                                    CL166
01154      IF  PV-DB2-COUNT EQUAL ZERO                                     CL179
01155          MOVE PC-TSYMSG-00148  TO  DP020-MSG-NUMBER                  CL166
01156          SET DP020-MSG-FATAL   TO  TRUE                              CL166
01157          MOVE -1               TO  AAPLSL                            CL166
01158          MOVE DP015-RED        TO  AAPLSC                            CL166
01159          MOVE DP015-REVERSE    TO  AAPLSH                            CL166
01160          SET PS-ERROR          TO  TRUE                              CL166
01161      END-IF.                                                         CL166
01162 *                                                                    CL166
01163  EJECT                                                               CL166
01164 ******************************************************************   CL166
01165 *    DETERMINE WHICH PARAGRAPH TO EXECUTE.  BASED UPON THE DATA      CL188
01166 *    ENTERED ON THE SCREEN.                                          CL188
01167 *                                                                    CL188
01168 *    PERFORMED BY 3300.                                              CL166
01169 ******************************************************************   CL166
01170 *                                                                    CL166
01171  3720-READ-MDSEAR.                                                   CL166
01172 *                                                                    CL166
01173      MOVE ZERO                 TO  PV-DB2-COUNT.                     CL172
01174 *                                                                    CL188
01175      IF  MB014-SCLASS-NUMBER-X GREATER THAN ZERO                     CL188
01176          SET PV-SCL-READ       TO  TRUE                              CL188
01177      END-IF.                                                         CL188
01178 *                                                                    CL188
01179      IF  MB014-MCLASS-NUMBER-X GREATER THAN ZERO                     CL188
01180          IF  PV-NO-READ                                              CL188
01181              SET PV-MCL-READ   TO  TRUE                              CL188
01182          END-IF                                                      CL188
01183      END-IF.                                                         CL188
01184 *                                                                    CL188
01185      IF  MB014-DEPT-NUMBER-X GREATER THAN ZERO                       CL188
01186          IF  PV-NO-READ                                              CL188
01187              SET PV-DPT-READ   TO  TRUE                              CL188
01188          END-IF                                                      CL188
01189      END-IF.                                                         CL188
01190 *                                                                    CL188
01191      IF  MB014-DMA-NUMBER-X GREATER THAN ZERO                        CL188
01192          IF  PV-NO-READ                                              CL188
01193              SET PV-DMA-READ   TO  TRUE                              CL188
01194          END-IF                                                      CL188
01195      END-IF.                                                         CL188
01196 *                                                                    CL188
01197      IF  MB014-GMA-NUMBER-X GREATER THAN ZERO                        CL188
01198          IF  PV-NO-READ                                              CL188
01199              SET PV-GMA-READ   TO  TRUE                              CL188
01200          END-IF                                                      CL188
01201      END-IF.                                                         CL188
01202 *                                                                    CL188
01203      IF (MB014-ALL-GMAS                                              CL188
01204      AND MB014-ALL-DMAS                                              CL188
01205      AND MB014-ALL-DEPARTMENTS                                       CL188
01206      AND MB014-ALL-MCLASSES                                          CL188
01207      AND MB014-ALL-SCLASSES)                                         CL188
01208          SET PV-MERCH-READ     TO  TRUE                              CL188
01209      END-IF.                                                         CL188
01210 *                                                                    CL188
01211      IF (MB014-ALL-GMAS                                              CL188
01212      AND MB014-DMA-NUMBER-X NOT GREATER THAN ZERO                    CL188
01213      AND MB014-DEPT-NUMBER-X NOT GREATER THAN ZERO                   CL188
01214      AND MB014-MCLASS-NUMBER-X NOT GREATER THAN ZERO                 CL188
01215      AND MB014-SCLASS-NUMBER-X NOT GREATER THAN ZERO)                CL190
01216          SET PV-MERCH-READ     TO  TRUE                              CL188
01217      END-IF.                                                         CL188
01218 *                                                                    CL188
01219      IF (MB014-ALL-GMAS                                              CL188
01220      AND MB014-ALL-DMAS                                              CL188
01221      AND MB014-DEPT-NUMBER-X NOT GREATER THAN ZERO                   CL188
01222      AND MB014-MCLASS-NUMBER-X NOT GREATER THAN ZERO                 CL188
01223      AND MB014-SCLASS-NUMBER-X NOT GREATER THAN ZERO)                CL190
01224          SET PV-MERCH-READ     TO  TRUE                              CL188
01225      END-IF.                                                         CL188
01226 *                                                                    CL188
01227      IF (MB014-ALL-GMAS                                              CL188
01228      AND MB014-ALL-DMAS                                              CL188
01229      AND MB014-ALL-DEPARTMENTS                                       CL188
01230      AND MB014-MCLASS-NUMBER-X NOT GREATER THAN ZERO                 CL188
01231      AND MB014-SCLASS-NUMBER-X NOT GREATER THAN ZERO)                CL190
01232          SET PV-MERCH-READ     TO  TRUE                              CL188
01233      END-IF.                                                         CL188
01234 *                                                                    CL188
01235      IF (MB014-ALL-GMAS                                              CL188
01236      AND MB014-ALL-DMAS                                              CL188
01237      AND MB014-ALL-DEPARTMENTS                                       CL188
01238      AND MB014-ALL-MCLASSES                                          CL188
01239      AND MB014-SCLASS-NUMBER-X NOT GREATER THAN ZERO)                CL190
01240          SET PV-MERCH-READ     TO  TRUE                              CL188
01241      END-IF.                                                         CL188
01242 *                                                                    CL188
01243      IF  PV-MERCH-READ                                               CL188
01244          PERFORM 3721-MERCH-READ                                     CL188
01245      ELSE                                                            CL188
01246          IF  PV-GMA-READ                                             CL188
01247              PERFORM 3722-GMA-READ                                   CL188
01248          ELSE                                                        CL188
01249              IF  PV-DMA-READ                                         CL188
01250                  PERFORM 3723-DMA-READ                               CL188
01251              ELSE                                                    CL188
01252                  IF  PV-DPT-READ                                     CL188
01253                      PERFORM 3724-DEPARTMENT-READ                    CL188
01254                  ELSE                                                CL188
01255                      IF  PV-MCL-READ                                 CL188
01256                          PERFORM 3725-MCLASS-READ                    CL188
01257                      ELSE                                            CL188
01258                          PERFORM 3726-SCLASS-READ                    CL188
01259                      END-IF                                          CL188
01260                  END-IF                                              CL188
01261              END-IF                                                  CL188
01262          END-IF                                                      CL188
01263      END-IF.                                                         CL188
01264 *                                                                    CL188
01265      IF  PV-DB2-COUNT EQUAL ZERO                                     CL188
01266          MOVE PC-TSYMSG-00148  TO  DP020-MSG-NUMBER                  CL188
01267          SET DP020-MSG-FATAL   TO  TRUE                              CL188
01268          MOVE DP015-RED        TO  AGMAC                             CL188
01269          MOVE DP015-REVERSE    TO  AGMAH                             CL188
01270          MOVE -1               TO  AGMAL                             CL188
01271          SET PS-ERROR          TO  TRUE                              CL188
01272      END-IF.                                                         CL188
01273 *                                                                    CL188
01274  EJECT                                                               CL188
01275 ******************************************************************   CL188
01276 *    NOW, DETERMINE WHETHER ANY ROWS EXIST TO SATISFY THE SCREEN     CL188
01277 *    VARIABLES ENTERED.                                              CL188
01278 *                                                                    CL188
01279 *    PERFORMED BY 3720.                                              CL188
01280 ******************************************************************   CL188
01281 *                                                                    CL188
01282  3721-MERCH-READ.                                                    CL188
01283 *                                                                    CL188
01284      PERFORM                                                         CL166
01285          WITH TEST AFTER                                             CL166
01286          VARYING PV-SQL-SUB                                          CL166
01287          FROM 1 BY 1                                                 CL166
01288          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                CL166
01289             OR SQLCODE = 0                                           CL166
01290             OR SQLCODE = +100                                        CL166
01291 *                                                                    CL166
01292          EXEC SQL                                                    CL166
01293               SELECT                                                 CL166
01294                      COUNT(DISTINCT GMA_NBR)                         CL171
01295               INTO                                                   CL166
01296                      :PV-DB2-COUNT                                   CL171
01297               FROM                                                   CL166
01298                      TMDSEAR A,                                      CL178
01299                      TAPLAVL B                                       CL178
01300               WHERE                                                  CL166
01301                      A.OPERCO_NBR   = :PC-OPER-COMPANY               CL178
01302                 AND  B.OPERCO_NBR   = :PC-OPER-COMPANY               CL178
01303                 AND (A.MDSELV_CDE   = :PC-GMA-LIT                    CL188
01304                  OR  A.MDSELV_CDE   = :PC-DMA-LIT                    CL188
01305                  OR  A.MDSELV_CDE   = :PC-DPT-LIT                    CL188
01306                  OR  A.MDSELV_CDE   = :PC-MCL-LIT                    CL188
01307                  OR  A.MDSELV_CDE   = :PC-SCL-LIT)                   CL188
01308                 AND  A.MDSEAR_DKEY  = B.MDSEAR_DKEY                  CL178
01309                 AND  B.APLSYS_CDE   = :MB014-APLS-NUMBER-X           CL178
01310          END-EXEC                                                    CL166
01311 *                                                                    CL166
01312          EVALUATE TRUE                                               CL166
01313              WHEN SQLCODE = -904                                     CL166
01314              WHEN SQLCODE = -913                                     CL166
01315              WHEN SQLCODE = +100                                     CL166
01316              WHEN SQLCODE = ZERO                                     CL166
01317                   CONTINUE                                           CL166
01318              WHEN SQLWARN0 NOT EQUAL SPACE                           CL166
01319              WHEN SQLCODE NOT EQUAL ZERO                             CL166
01320                   MOVE '3721-MERCH-READ'                             CL188
01321                                TO  DP013-PARAGRAPH                   CL166
01322                   MOVE 'READ MDSEAR'                                 CL166
01323                                TO  DP013-MESSAGE-TEXT (1)            CL166
01324                   MOVE SQLCA   TO  DP013-SQLCA                       CL166
01325                   SET DP013-DB2-ABEND                                CL166
01326                                TO  TRUE                              CL166
01327                   PERFORM DP013-0000-PROCESS-ABEND                   CL166
01328          END-EVALUATE                                                CL166
01329      END-PERFORM.                                                    CL166
01330 *                                                                    CL166
01331      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                      CL166
01332          MOVE '3721-MERCH-READ'                                      CL188
01333                                TO  DP013-PARAGRAPH                   CL166
01334          MOVE 'MAX RETRIES EXCEEDED FOR READ MDSEAR'                 CL166
01335                                TO  DP013-MESSAGE-TEXT (1)            CL166
01336          MOVE SQLCA            TO  DP013-SQLCA                       CL166
01337          SET DP013-DB2-ABEND   TO  TRUE                              CL166
01338          PERFORM DP013-0000-PROCESS-ABEND                            CL166
01339      END-IF.                                                         CL166
01340 *                                                                    CL188
01341  EJECT                                                               CL188
01342 ******************************************************************   CL188
01343 *    NOW, DETERMINE WHETHER ANY ROWS EXIST TO SATISFY THE SCREEN     CL188
01344 *    VARIABLES ENTERED.                                              CL188
01345 *                                                                    CL188
01346 *    PERFORMED BY 3720.                                              CL188
01347 ******************************************************************   CL188
01348 *                                                                    CL188
01349  3722-GMA-READ.                                                      CL188
01350 *                                                                    CL188
01351      PERFORM                                                         CL188
01352          WITH TEST AFTER                                             CL188
01353          VARYING PV-SQL-SUB                                          CL188
01354          FROM 1 BY 1                                                 CL188
01355          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                CL188
01356             OR SQLCODE = 0                                           CL188
01357             OR SQLCODE = +100                                        CL188
01358 *                                                                    CL188
01359          EXEC SQL                                                    CL188
01360               SELECT                                                 CL188
01361                      COUNT(DISTINCT GMA_NBR)                         CL188
01362               INTO                                                   CL188
01363                      :PV-DB2-COUNT                                   CL188
01364               FROM                                                   CL188
01365                      TMDSEAR A,                                      CL188
01366                      TAPLAVL B                                       CL188
01367               WHERE                                                  CL188
01368                      A.OPERCO_NBR   = :PC-OPER-COMPANY               CL188
01369                 AND  B.OPERCO_NBR   = :PC-OPER-COMPANY               CL188
01370                 AND  A.GMA_NBR      = :MB014-GMA-NUMBER-X            CL188
01371                 AND  A.MDSEAR_DKEY  = B.MDSEAR_DKEY                  CL188
01372                 AND  B.APLSYS_CDE   = :MB014-APLS-NUMBER-X           CL188
01373                 AND (A.MDSELV_CDE   = :PC-GMA-LIT                    CL188
01374                  OR  A.MDSELV_CDE   = :PC-DMA-LIT                    CL188
01375                  OR  A.MDSELV_CDE   = :PC-DPT-LIT                    CL188
01376                  OR  A.MDSELV_CDE   = :PC-MCL-LIT                    CL188
01377                  OR  A.MDSELV_CDE   = :PC-SCL-LIT)                   CL188
01378                 AND  B.MDSEAR_END_DTE                                CL188
01379                                     > (CURRENT DATE)                 CL188
01380          END-EXEC                                                    CL188
01381 *                                                                    CL188
01382          EVALUATE TRUE                                               CL188
01383              WHEN SQLCODE = -904                                     CL188
01384              WHEN SQLCODE = -913                                     CL188
01385              WHEN SQLCODE = +100                                     CL188
01386              WHEN SQLCODE = ZERO                                     CL188
01387                   CONTINUE                                           CL188
01388              WHEN SQLWARN0 NOT EQUAL SPACE                           CL188
01389              WHEN SQLCODE NOT EQUAL ZERO                             CL188
01390                   MOVE '3722-GMA-READ'                               CL188
01391                                TO  DP013-PARAGRAPH                   CL188
01392                   MOVE 'READ MDSEAR'                                 CL188
01393                                TO  DP013-MESSAGE-TEXT (1)            CL188
01394                   MOVE SQLCA   TO  DP013-SQLCA                       CL188
01395                   SET DP013-DB2-ABEND                                CL188
01396                                TO  TRUE                              CL188
01397                   PERFORM DP013-0000-PROCESS-ABEND                   CL188
01398          END-EVALUATE                                                CL188
01399      END-PERFORM.                                                    CL188
01400 *                                                                    CL188
01401      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                      CL188
01402          MOVE '3722-GMA-READ'                                        CL188
01403                                TO  DP013-PARAGRAPH                   CL188
01404          MOVE 'MAX RETRIES EXCEEDED FOR READ MDSEAR'                 CL188
01405                                TO  DP013-MESSAGE-TEXT (1)            CL188
01406          MOVE SQLCA            TO  DP013-SQLCA                       CL188
01407          SET DP013-DB2-ABEND   TO  TRUE                              CL188
01408          PERFORM DP013-0000-PROCESS-ABEND                            CL188
01409      END-IF.                                                         CL188
01410 *                                                                    CL188
01411  EJECT                                                               CL188
01412 ******************************************************************   CL188
01413 *    NOW, DETERMINE WHETHER ANY ROWS EXIST TO SATISFY THE SCREEN     CL188
01414 *    VARIABLES ENTERED.                                              CL188
01415 *                                                                    CL188
01416 *    PERFORMED BY 3720.                                              CL188
01417 ******************************************************************   CL188
01418 *                                                                    CL188
01419  3723-DMA-READ.                                                      CL188
01420 *                                                                    CL188
01421      PERFORM                                                         CL188
01422          WITH TEST AFTER                                             CL188
01423          VARYING PV-SQL-SUB                                          CL188
01424          FROM 1 BY 1                                                 CL188
01425          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                CL188
01426             OR SQLCODE = 0                                           CL188
01427             OR SQLCODE = +100                                        CL188
01428 *                                                                    CL188
01429          EXEC SQL                                                    CL188
01430               SELECT                                                 CL188
01431                      COUNT(DISTINCT DMA_NBR)                         CL188
01432               INTO                                                   CL188
01433                      :PV-DB2-COUNT                                   CL188
01434               FROM                                                   CL188
01435                      TMDSEAR A,                                      CL188
01436                      TAPLAVL B                                       CL188
01437               WHERE                                                  CL188
01438                      A.OPERCO_NBR   = :PC-OPER-COMPANY               CL188
01439                 AND  B.OPERCO_NBR   = :PC-OPER-COMPANY               CL188
01440                 AND  A.DMA_NBR      = :MB014-DMA-NUMBER-X            CL188
01441                 AND  A.MDSEAR_DKEY  = B.MDSEAR_DKEY                  CL188
01442                 AND  B.APLSYS_CDE   = :MB014-APLS-NUMBER-X           CL188
01443                 AND (A.MDSELV_CDE   = :PC-DMA-LIT                    CL188
01444                  OR  A.MDSELV_CDE   = :PC-DPT-LIT                    CL188
01445                  OR  A.MDSELV_CDE   = :PC-MCL-LIT                    CL188
01446                  OR  A.MDSELV_CDE   = :PC-SCL-LIT)                   CL188
01447                 AND  B.MDSEAR_END_DTE                                CL188
01448                                     > (CURRENT DATE)                 CL188
01449          END-EXEC                                                    CL188
01450 *                                                                    CL188
01451          EVALUATE TRUE                                               CL188
01452              WHEN SQLCODE = -904                                     CL188
01453              WHEN SQLCODE = -913                                     CL188
01454              WHEN SQLCODE = +100                                     CL188
01455              WHEN SQLCODE = ZERO                                     CL188
01456                   CONTINUE                                           CL188
01457              WHEN SQLWARN0 NOT EQUAL SPACE                           CL188
01458              WHEN SQLCODE NOT EQUAL ZERO                             CL188
01459                   MOVE '3723-DMA-READ'                               CL188
01460                                TO  DP013-PARAGRAPH                   CL188
01461                   MOVE 'READ MDSEAR'                                 CL188
01462                                TO  DP013-MESSAGE-TEXT (1)            CL188
01463                   MOVE SQLCA   TO  DP013-SQLCA                       CL188
01464                   SET DP013-DB2-ABEND                                CL188
01465                                TO  TRUE                              CL188
01466                   PERFORM DP013-0000-PROCESS-ABEND                   CL188
01467          END-EVALUATE                                                CL188
01468      END-PERFORM.                                                    CL188
01469 *                                                                    CL188
01470      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                      CL188
01471          MOVE '3723-DMA-READ'                                        CL188
01472                                TO  DP013-PARAGRAPH                   CL188
01473          MOVE 'MAX RETRIES EXCEEDED FOR READ MDSEAR'                 CL188
01474                                TO  DP013-MESSAGE-TEXT (1)            CL188
01475          MOVE SQLCA            TO  DP013-SQLCA                       CL188
01476          SET DP013-DB2-ABEND   TO  TRUE                              CL188
01477          PERFORM DP013-0000-PROCESS-ABEND                            CL188
01478      END-IF.                                                         CL188
01479 *                                                                    CL188
01480  EJECT                                                               CL188
01481 ******************************************************************   CL188
01482 *    NOW, DETERMINE WHETHER ANY ROWS EXIST TO SATISFY THE SCREEN     CL188
01483 *    VARIABLES ENTERED.                                              CL188
01484 *                                                                    CL188
01485 *    PERFORMED BY 3720.                                              CL188
01486 ******************************************************************   CL188
01487 *                                                                    CL188
01488  3724-DEPARTMENT-READ.                                               CL188
01489 *                                                                    CL188
01490      PERFORM                                                         CL188
01491          WITH TEST AFTER                                             CL188
01492          VARYING PV-SQL-SUB                                          CL188
01493          FROM 1 BY 1                                                 CL188
01494          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                CL188
01495             OR SQLCODE = 0                                           CL188
01496             OR SQLCODE = +100                                        CL188
01497 *                                                                    CL188
01498          EXEC SQL                                                    CL188
01499               SELECT                                                 CL188
01500                      COUNT(DISTINCT DMA_NBR)                         CL188
01501               INTO                                                   CL188
01502                      :PV-DB2-COUNT                                   CL188
01503               FROM                                                   CL188
01504                      TMDSEAR A,                                      CL188
01505                      TAPLAVL B                                       CL188
01506               WHERE                                                  CL188
01507                      A.OPERCO_NBR   = :PC-OPER-COMPANY               CL188
01508                 AND  B.OPERCO_NBR   = :PC-OPER-COMPANY               CL188
01509                 AND  A.DEPT_NBR     = :MB014-DEPT-NUMBER-X           CL189
01510                 AND  A.MDSEAR_DKEY  = B.MDSEAR_DKEY                  CL188
01511                 AND  B.APLSYS_CDE   = :MB014-APLS-NUMBER-X           CL188
01512                 AND (A.MDSELV_CDE   = :PC-DPT-LIT                    CL188
01513                  OR  A.MDSELV_CDE   = :PC-MCL-LIT                    CL188
01514                  OR  A.MDSELV_CDE   = :PC-SCL-LIT)                   CL188
01515                 AND  B.MDSEAR_END_DTE                                CL188
01516                                     > (CURRENT DATE)                 CL188
01517          END-EXEC                                                    CL188
01518 *                                                                    CL188
01519          EVALUATE TRUE                                               CL188
01520              WHEN SQLCODE = -904                                     CL188
01521              WHEN SQLCODE = -913                                     CL188
01522              WHEN SQLCODE = +100                                     CL188
01523              WHEN SQLCODE = ZERO                                     CL188
01524                   CONTINUE                                           CL188
01525              WHEN SQLWARN0 NOT EQUAL SPACE                           CL188
01526              WHEN SQLCODE NOT EQUAL ZERO                             CL188
01527                   MOVE '3724-DEPARTMENT-READ'                        CL188
01528                                TO  DP013-PARAGRAPH                   CL188
01529                   MOVE 'READ MDSEAR'                                 CL188
01530                                TO  DP013-MESSAGE-TEXT (1)            CL188
01531                   MOVE SQLCA   TO  DP013-SQLCA                       CL188
01532                   SET DP013-DB2-ABEND                                CL188
01533                                TO  TRUE                              CL188
01534                   PERFORM DP013-0000-PROCESS-ABEND                   CL188
01535          END-EVALUATE                                                CL188
01536      END-PERFORM.                                                    CL188
01537 *                                                                    CL188
01538      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                      CL188
01539          MOVE '3724-DEPARTMENT-READ'                                 CL188
01540                                TO  DP013-PARAGRAPH                   CL188
01541          MOVE 'MAX RETRIES EXCEEDED FOR READ MDSEAR'                 CL188
01542                                TO  DP013-MESSAGE-TEXT (1)            CL188
01543          MOVE SQLCA            TO  DP013-SQLCA                       CL188
01544          SET DP013-DB2-ABEND   TO  TRUE                              CL188
01545          PERFORM DP013-0000-PROCESS-ABEND                            CL188
01546      END-IF.                                                         CL188
01547 *                                                                    CL188
01548  EJECT                                                               CL188
01549 ******************************************************************   CL188
01550 *    NOW, DETERMINE WHETHER ANY ROWS EXIST TO SATISFY THE SCREEN     CL188
01551 *    VARIABLES ENTERED.                                              CL188
01552 *                                                                    CL188
01553 *    PERFORMED BY 3720.                                              CL188
01554 ******************************************************************   CL188
01555 *                                                                    CL188
01556  3725-MCLASS-READ.                                                   CL188
01557 *                                                                    CL188
01558      PERFORM                                                         CL188
01559          WITH TEST AFTER                                             CL188
01560          VARYING PV-SQL-SUB                                          CL188
01561          FROM 1 BY 1                                                 CL188
01562          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                CL188
01563             OR SQLCODE = 0                                           CL188
01564             OR SQLCODE = +100                                        CL188
01565 *                                                                    CL188
01566          EXEC SQL                                                    CL188
01567               SELECT                                                 CL188
01568                      COUNT(DISTINCT DMA_NBR)                         CL188
01569               INTO                                                   CL188
01570                      :PV-DB2-COUNT                                   CL188
01571               FROM                                                   CL188
01572                      TMDSEAR A,                                      CL188
01573                      TAPLAVL B                                       CL188
01574               WHERE                                                  CL188
01575                      A.OPERCO_NBR   = :PC-OPER-COMPANY               CL188
01576                 AND  B.OPERCO_NBR   = :PC-OPER-COMPANY               CL188
01577                 AND  A.MDSEAR_DKEY  = B.MDSEAR_DKEY                  CL188
01578                 AND  B.APLSYS_CDE   = :MB014-APLS-NUMBER-X           CL188
01579                 AND  A.DEPT_NBR     = :MB014-DEPT-NUMBER-X           CL189
01580                 AND ((A.MAJ_CL_NBR  = :MB014-MCLASS-NUMBER-X         CL188
01581                 AND (A.MDSELV_CDE   = :PC-MCL-LIT                    CL188
01582                  OR  A.MDSELV_CDE   = :PC-SCL-LIT))                  CL188
01583                  OR (A.MDSELV_CDE   = :PC-DPT-LIT))                  CL188
01584                 AND  B.MDSEAR_END_DTE                                CL188
01585                                     > (CURRENT DATE)                 CL188
01586          END-EXEC                                                    CL188
01587 *                                                                    CL188
01588          EVALUATE TRUE                                               CL188
01589              WHEN SQLCODE = -904                                     CL188
01590              WHEN SQLCODE = -913                                     CL188
01591              WHEN SQLCODE = +100                                     CL188
01592              WHEN SQLCODE = ZERO                                     CL188
01593                   CONTINUE                                           CL188
01594              WHEN SQLWARN0 NOT EQUAL SPACE                           CL188
01595              WHEN SQLCODE NOT EQUAL ZERO                             CL188
01596                   MOVE '3725-MCLASS-READ'                            CL188
01597                                TO  DP013-PARAGRAPH                   CL188
01598                   MOVE 'READ MDSEAR'                                 CL188
01599                                TO  DP013-MESSAGE-TEXT (1)            CL188
01600                   MOVE SQLCA   TO  DP013-SQLCA                       CL188
01601                   SET DP013-DB2-ABEND                                CL188
01602                                TO  TRUE                              CL188
01603                   PERFORM DP013-0000-PROCESS-ABEND                   CL188
01604          END-EVALUATE                                                CL188
01605      END-PERFORM.                                                    CL188
01606 *                                                                    CL188
01607      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                      CL188
01608          MOVE '3725-MCLASS-READ'                                     CL188
01609                                TO  DP013-PARAGRAPH                   CL188
01610          MOVE 'MAX RETRIES EXCEEDED FOR READ MDSEAR'                 CL188
01611                                TO  DP013-MESSAGE-TEXT (1)            CL188
01612          MOVE SQLCA            TO  DP013-SQLCA                       CL188
01613          SET DP013-DB2-ABEND   TO  TRUE                              CL188
01614          PERFORM DP013-0000-PROCESS-ABEND                            CL188
01615      END-IF.                                                         CL188
01616 *                                                                    CL188
01617  EJECT                                                               CL188
01618 ******************************************************************   CL188
01619 *    NOW, DETERMINE WHETHER ANY ROWS EXIST TO SATISFY THE SCREEN     CL188
01620 *    VARIABLES ENTERED.                                              CL188
01621 *                                                                    CL188
01622 *    PERFORMED BY 3720.                                              CL188
01623 ******************************************************************   CL188
01624 *                                                                    CL188
01625  3726-SCLASS-READ.                                                   CL188
01626 *                                                                    CL188
01627      PERFORM                                                         CL188
01628          WITH TEST AFTER                                             CL188
01629          VARYING PV-SQL-SUB                                          CL188
01630          FROM 1 BY 1                                                 CL188
01631          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                CL188
01632             OR SQLCODE = 0                                           CL188
01633             OR SQLCODE = +100                                        CL188
01634 *                                                                    CL188
01635          EXEC SQL                                                    CL188
01636               SELECT                                                 CL188
01637                      COUNT(DISTINCT DMA_NBR)                         CL188
01638               INTO                                                   CL188
01639                      :PV-DB2-COUNT                                   CL188
01640               FROM                                                   CL188
01641                      TMDSEAR A,                                      CL188
01642                      TAPLAVL B                                       CL188
01643               WHERE                                                  CL188
01644                      A.OPERCO_NBR   = :PC-OPER-COMPANY               CL188
01645                 AND  B.OPERCO_NBR   = :PC-OPER-COMPANY               CL188
01646                 AND  A.MDSEAR_DKEY  = B.MDSEAR_DKEY                  CL188
01647                 AND  B.APLSYS_CDE   = :MB014-APLS-NUMBER-X           CL188
01648                 AND  A.DEPT_NBR     = :MB014-DEPT-NUMBER-X           CL189
01649                 AND  A.MAJ_CL_NBR   = :MB014-MCLASS-NUMBER-X         CL188
01650                 AND  A.SUB_CL_NBR   = :MB014-SCLASS-NUMBER-X         CL188
01651                 AND  A.MDSELV_CDE   = :PC-SCL-LIT                    CL188
01652                 AND  B.MDSEAR_END_DTE                                CL188
01653                                     > (CURRENT DATE)                 CL188
01654          END-EXEC                                                    CL188
01655 *                                                                    CL188
01656          EVALUATE TRUE                                               CL188
01657              WHEN SQLCODE = -904                                     CL188
01658              WHEN SQLCODE = -913                                     CL188
01659              WHEN SQLCODE = +100                                     CL188
01660              WHEN SQLCODE = ZERO                                     CL188
01661                   CONTINUE                                           CL188
01662              WHEN SQLWARN0 NOT EQUAL SPACE                           CL188
01663              WHEN SQLCODE NOT EQUAL ZERO                             CL188
01664                   MOVE '3726-SCLASS-READ'                            CL188
01665                                TO  DP013-PARAGRAPH                   CL188
01666                   MOVE 'READ MDSEAR'                                 CL188
01667                                TO  DP013-MESSAGE-TEXT (1)            CL188
01668                   MOVE SQLCA   TO  DP013-SQLCA                       CL188
01669                   SET DP013-DB2-ABEND                                CL188
01670                                TO  TRUE                              CL188
01671                   PERFORM DP013-0000-PROCESS-ABEND                   CL188
01672          END-EVALUATE                                                CL188
01673      END-PERFORM.                                                    CL188
01674 *                                                                    CL188
01675      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                      CL188
01676          MOVE '3726-SCLASS-READ'                                     CL188
01677                                TO  DP013-PARAGRAPH                   CL188
01678          MOVE 'MAX RETRIES EXCEEDED FOR READ MDSEAR'                 CL188
01679                                TO  DP013-MESSAGE-TEXT (1)            CL188
01680          MOVE SQLCA            TO  DP013-SQLCA                       CL188
01681          SET DP013-DB2-ABEND   TO  TRUE                              CL188
01682          PERFORM DP013-0000-PROCESS-ABEND                            CL188
01683      END-IF.                                                         CL188
01684  EJECT                                                               CL111
01685 *****************************************************************    CL188
01686  3800-ALPHA-CHARACTER-EDIT.                                          CL166
01687                                                                      CL145
01688      SET PS-NO-2-CHAR-ERROR TO TRUE.                                 CL145
01689                                                                      CL145
01690      EVALUATE  TRUE                                                  CL145
01691                                                                      CL145
01692                                                                      CL145
01693          WHEN ((WK-TWO-CHAR-EDIT-1 ALPHABETIC  AND                   CL150
01694                 WK-TWO-CHAR-EDIT-1 NOT = SPACES) AND                 CL150
01695                 WK-TWO-CHAR-EDIT-2 NOT = SPACES)                     CL196
01696               CONTINUE                                               CL150
01697                                                                      CL150
01698          WHEN ((WK-TWO-CHAR-EDIT-1 ALPHABETIC) AND                   CL150
01699                (WK-TWO-CHAR-EDIT-2 = SPACES OR                       CL150
01700                 WK-TWO-CHAR-EDIT-2 NOT ALPHABETIC))                  CL150
01701               SET PS-2-CHAR-ERROR TO TRUE                            CL150
01702                                                                      CL145
01703          WHEN ((WK-TWO-CHAR-EDIT-2 ALPHABETIC) AND                   CL145
01704                (WK-TWO-CHAR-EDIT-1 = SPACES OR                       CL145
01705                 WK-TWO-CHAR-EDIT-1 NOT ALPHABETIC))                  CL145
01706               SET PS-2-CHAR-ERROR TO TRUE                            CL145
01707                                                                      CL145
01708          WHEN OTHER                                                  CL148
01709               SET PS-2-CHAR-ERROR TO TRUE                            CL148
01710                                                                      CL148
01711      END-EVALUATE.                                                   CL145
01712                                                                      CL145
01713  EJECT                                                               CL145
01714  4000-DISPLAY-PANEL.                                                 CL111
01715                                                                      CL**3
01716 ******************************************************************   CL**3
01717 *    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.          CL**3
01718 *                                                                    CL**3
01719 *    PERFORMED BY 1000-CONTROL-PROCESSING.                           CL*10
01720 *    PERFORMED BY 3000-PROCESS-PANEL.                                CL*10
01721 *    PERFORMED BY 3100-CHECK-LOCAL-FKEYS.                            CL*10
01722 ******************************************************************   CL**3
01723                                                                      CL**3
01724      PERFORM DP017-0000-GET-CURR-DATE-TIME.                          CL**3
01725      MOVE DP017-EDITED-TIME-HMS TO ATIMEO.                           CL163
01726                                                                      CL**3
01727      IF PS-SEND-MAP-N-DATA-FRSET                                     CL**3
01728          PERFORM DP002-0000-FORMAT-TITLE-LINES                       CL**3
01729          PERFORM 4100-MOVE-COMMAREA-TO-SCREEN                        CL*82
01730      END-IF.                                                         CL**3
01731                                                                      CL**4
01732      PERFORM DP005-0000-FORMAT-MSG-LINES.                            CL**4
01733                                                                      CL**3
01734 *    PERFORM 4200-CHECK-ERROR-FROM-LIST.                             CL165
01735                                                                      CL107
01736      IF (DP020-SRC-AID = DP016-PA2) OR                               CL**4
01737         (PS-SEND-MAP-N-DATA-FRSET)                                   CL**4
01738          PERFORM DP009-0000-LOAD-FK-LINES                            CL**3
01739      END-IF.                                                         CL**3
01740                                                                      CL**3
01741      IF PS-NO-ERROR                                                  CL**3
01742          MOVE -1 TO AAPLSL                                           CL142
01743      END-IF                                                          CL**3
01744                                                                      CL136
01745 *    MOVE SPACES TO DP020-NAV-KEY-DATA.                              CL156
01746                                                                      CL**3
01747      PERFORM DP008-0000-WRITE-PANEL.                                 CL156
01748                                                                      CL**3
01749  EJECT                                                               CL**3
01750  4100-MOVE-COMMAREA-TO-SCREEN.                                       CL*20
01751                                                                      CL**4
01752 ******************************************************************   CL**4
01753 *    MOVE THE FIELDS FROM THE COMMAREA TO THE SCREEN.                CL**4
01754 *                                                                    CL**4
01755 *    PERFORMED BY 4000-DISPLAY-PANEL.                                CL*20
01756 ******************************************************************   CL**4
01757                                                                      CL**4
01758      MOVE MB014-CO-NUMBER-X     TO ACOO.                             CL137
01759      MOVE MB014-APLS-NUMBER-X   TO AAPLSO.                           CL140
01760      MOVE MB014-GMA-NUMBER-X    TO AGMAO.                            CL138
01761      MOVE MB014-DMA-NUMBER-X    TO ADMAO.                            CL137
01762      MOVE MB014-DEPT-NUMBER-X   TO ADEPTO.                           CL137
01763      MOVE MB014-MCLASS-NUMBER-X TO AMCLASSO.                         CL137
01764      MOVE MB014-SCLASS-NUMBER-X TO ASCLASSO.                         CL137
01765      MOVE MB014-HISTORY-INDICATOR                                    CL161
01766                                 TO AHISTO.                           CL161
01767                                                                      CL*87
01768      IF PS-NO-ERROR                                                  CL*95
01769          MOVE DP015-GREEN       TO AAPLSC                            CL140
01770                                    AGMAC                             CL138
01771                                    ADMAC                             CL*87
01772                                    ADEPTC                            CL*87
01773                                    AMCLASSC                          CL*87
01774                                    ASCLASSC                          CL*95
01775                                    AHISTC                            CL161
01776                                                                      CL*87
01777          MOVE DP015-UNDERLINE   TO AAPLSH                            CL140
01778                                    AGMAH                             CL138
01779                                    ADMAH                             CL*87
01780                                    ADEPTH                            CL*87
01781                                    AMCLASSH                          CL*87
01782                                    ASCLASSH                          CL*95
01783                                    AHISTH                            CL161
01784      END-IF.                                                         CL*95
01785                                                                      CL108
01786      MOVE DP020-MSG-MESSAGE     TO PV-MESSAGE.                       CL108
01787  EJECT                                                               CL**4
01788 *4200-CHECK-ERROR-FROM-LIST.                                         CL165
01789 *                                                                    CL165
01790 ******************************************************************   CL109
01791 *    IF AN ERROR WAS DETECTED IN THE LIST PROGRAM, THIS              CL109
01792 *    PARAGRAPH WILL CHECK DP020-MSG-MUMBER AND SET THE               CL109
01793 *    PROPER ATTRIBUTES.                                              CL109
01794 *                                                                    CL109
01795 *    PERFORMED BY 4000-DISPLAY-PANEL.                                CL109
01796 ******************************************************************   CL109
01797 *                                                                    CL165
01798 *    MOVE PV-MESSAGE            TO DP020-MSG-MESSAGE.                CL165
01799 *                                                                    CL165
01800 *    EVALUATE TRUE                                                   CL165
01801 *                                                                    CL165
01802 *         WHEN (DP020-MSG-NUMBER = PC-TSYMSG-00032 OR                CL165
01803 *               DP020-MSG-NUMBER = PC-TSYMSG-00077 OR                CL165
01804 *               DP020-MSG-NUMBER = PC-TSYMSG-00081)                  CL165
01805 *              MOVE DP015-RED           TO ADEPTC                    CL165
01806 *              MOVE DP015-REVERSE       TO ADEPTH                    CL165
01807 *              MOVE -1                  TO ADEPTL                    CL165
01808 *              SET PS-ERROR             TO TRUE                      CL165
01809 *                                                                    CL165
01810 *         WHEN DP020-MSG-NUMBER = PC-TSYMSG-00030                    CL165
01811 *              MOVE DP015-RED           TO AGMAC                     CL165
01812 *              MOVE DP015-REVERSE       TO AGMAH                     CL165
01813 *              MOVE -1                  TO AGMAL                     CL165
01814 *              SET PS-ERROR             TO TRUE                      CL165
01815 *                                                                    CL165
01816 *         WHEN DP020-MSG-NUMBER = PC-TSYMSG-00076                    CL165
01817 *              MOVE DP015-RED           TO ADMAC                     CL165
01818 *              MOVE DP015-REVERSE       TO ADMAH                     CL165
01819 *              MOVE -1                  TO ADMAL                     CL165
01820 *              SET PS-ERROR             TO TRUE                      CL165
01821 *                                                                    CL165
01822 *         WHEN DP020-MSG-NUMBER = PC-TSYMSG-00076                    CL165
01823 *              MOVE DP015-RED           TO ADMAC                     CL165
01824 *              MOVE DP015-REVERSE       TO ADMAH                     CL165
01825 *              MOVE -1                  TO ADMAL                     CL165
01826 *              SET PS-ERROR             TO TRUE                      CL165
01827 *                                                                    CL165
01828 *         WHEN DP020-MSG-NUMBER = PC-TSYMSG-00078                    CL165
01829 *              MOVE DP015-RED           TO AMCLASSC                  CL165
01830 *              MOVE DP015-REVERSE       TO AMCLASSH                  CL165
01831 *              MOVE -1                  TO AMCLASSL                  CL165
01832 *              SET PS-ERROR             TO TRUE                      CL165
01833 *                                                                    CL165
01834 *         WHEN DP020-MSG-NUMBER = PC-TSYMSG-00079                    CL165
01835 *              MOVE DP015-RED           TO ASCLASSC                  CL165
01836 *              MOVE DP015-REVERSE       TO ASCLASSH                  CL165
01837 *              MOVE -1                  TO ASCLASSL                  CL165
01838 *              SET PS-ERROR             TO TRUE                      CL165
01839 *                                                                    CL165
01840 *    END-EVALUATE.                                                   CL165
01841 *                                                                    CL165
01842 *    MOVE SPACES    TO DP020-MSG-MESSAGE                             CL165
01843 *                      PV-MESSAGE.                                   CL165
01844  EJECT                                                               CL107
01845  5000-SETUP-INTER-APPL.                                              CL140
01846                                                                      CL*31
01847 ******************************************************************   CL*31
01848 *    SETUP THE INTER APPLICATION COMMAREA WITH DATA FROM THE         CL140
01849 *    SPECIFIC COMMAREA AND SET THE INTER APPLICATION FORMAT CODE.    CL140
01850 *                                                                    CL*31
01851 *    PERFORMED BY 3100-CHECK-LOCAL-FKEYS                             CL*31
01852 ******************************************************************   CL*31
01853                                                                      CL*31
01854      MOVE MB014-CO-NUMBER-X         TO MB005-CO-NUMBER.              CL161
01855      MOVE MB014-APLS-NUMBER-X       TO MB005-APPL-SYS-CODE.          CL161
01856      MOVE MB014-GMA-NUMBER-X        TO MB005-GMA-NUMBER.             CL161
01857      MOVE MB014-DMA-NUMBER-X        TO MB005-DMA-NUMBER.             CL161
01858      MOVE MB014-DEPT-NUMBER-X       TO MB005-DEPT-NUMBER.            CL161
01859      MOVE MB014-MCLASS-NUMBER-X     TO MB005-MCLASS-NUMBER.          CL161
01860      MOVE MB014-SCLASS-NUMBER-X     TO MB005-SCLASS-NUMBER.          CL161
01861      MOVE MB014-HISTORY-INDICATOR   TO MB005-HISTORY-INDICATOR.      CL161
01862                                                                      CL*31
01863      SET DP020-MB-APPL-AVAIL-SELECT TO TRUE.                         CL151
01864  EJECT                                                               CL*31
01865  5100-SAVE-INITIAL-INTERAPPL.                                        CL140
01866                                                                      CL*41
01867 ******************************************************************   CL*41
01868 *    SAVE THE INTER-APPLICATION COMMAREA ON THE FIRST CYCLE          CL140
01869 *    OF THIS TRANSACTION.                                            CL*41
01870 *                                                                    CL*41
01871 *    PERFORMED BY 1000-CONTROL-PROCESSING                            CL*41
01872 ******************************************************************   CL*41
01873                                                                      CL*41
01874      MOVE LOW-VALUES TO INTER-APPL-COMM-AREA.                        CL140
01875                                                                      CL*41
01876  EJECT                                                               CL*41
01877  5100-UPDATE-INTER-APPL.                                             CL140
01878                                                                      CL*34
01879 ******************************************************************   CL*34
01880 *    WHEN RETURNING FROM ANOTHER TRANSACTION, SAVE THE FIELDS        CL*34
01881 *    PASSED IN THE INTER APPLICATION COMMAREA, ONLY IF THE           CL140
01882 *    INTER APPLICATION FORMAT CODE IS VALID FOR THIS TRANSACTION.    CL140
01883 *                                                                    CL*34
01884 *    PERFORMED BY 1000-CONTROL-PROCESSING                            CL*34
01885 ******************************************************************   CL*34
01886                                                                      CL*34
01887      IF DP020-MB-APPL-AVAIL-LIST                                     CL152
01888         MOVE MB005-CO-NUMBER       TO MB014-CO-NUMBER-X              CL161
01889         MOVE MB005-APPL-SYS-CODE   TO MB014-APLS-NUMBER-X            CL162
01890         MOVE MB005-GMA-NUMBER      TO MB014-GMA-NUMBER-X             CL161
01891         MOVE MB005-DMA-NUMBER      TO MB014-DMA-NUMBER-X             CL161
01892         MOVE MB005-DEPT-NUMBER     TO MB014-DEPT-NUMBER-X            CL161
01893         MOVE MB005-MCLASS-NUMBER   TO MB014-MCLASS-NUMBER-X          CL161
01894         MOVE MB005-SCLASS-NUMBER   TO MB014-SCLASS-NUMBER-X          CL161
01895         MOVE MB005-HISTORY-INDICATOR                                 CL161
01896                                    TO MB014-HISTORY-INDICATOR        CL161
01897      ELSE                                                            CL128
01898         INITIALIZE MB005-INTER-APPL-COMMAREA                         CL161
01899         INITIALIZE MB014-SPECIFIC-COMMAREA                           CL137
01900      END-IF.                                                         CL128
01901                                                                      CL*34
01902  EJECT                                                               CL*34
01903 ******************************************************************MBKCS115
01904 *    FILL IN SCREEN HEADER MODULE                                 MBKCS115
01905 ******************************************************************MBKCS115
01906                                                                   MBKCS115
01907      COPY DPPD002.                                                   CL*14
01908  EJECT                                                            MBKCS115
01909 ******************************************************************MBKCS115
01910 *    RETURN TO CICS MODULE                                        MBKCS115
01911 ******************************************************************MBKCS115
01912                                                                   MBKCS115
01913      COPY DPPD003.                                                   CL*14
01914  EJECT                                                            MBKCS115
01915 ******************************************************************MBKCS115
01916 *    FORMAT MESSAGE LINES MODULE                                  MBKCS115
01917 ******************************************************************MBKCS115
01918                                                                   MBKCS115
01919      COPY DPPD005.                                                   CL114
01920  EJECT                                                            MBKCS115
01921 ******************************************************************MBKCS115
01922 *    GET PANEL MODULE                                             MBKCS115
01923 ******************************************************************MBKCS115
01924                                                                   MBKCS115
01925      COPY DPPD007.                                                   CL*14
01926  EJECT                                                            MBKCS115
01927 ******************************************************************MBKCS115
01928 *    WRITE PANEL MODULE                                           MBKCS115
01929 ******************************************************************MBKCS115
01930                                                                   MBKCS115
01931      COPY DPPD008.                                                   CL*14
01932  EJECT                                                            MBKCS115
01933 ******************************************************************MBKCS115
01934 *    TOGGLE THE FUNCTION KEY LINE MODULE                          MBKCS115
01935 ******************************************************************MBKCS115
01936                                                                   MBKCS115
01937      COPY DPPD009.                                                   CL*14
01938  EJECT                                                            MBKCS115
01939 ******************************************************************MBKCS115
01940 *    ABEND PROCESSOR MODULE                                       MBKCS115
01941 ******************************************************************MBKCS115
01942                                                                   MBKCS115
01943      COPY DPPD013.                                                   CL*14
01944  EJECT                                                            MBKCS115
01945 ******************************************************************MBKCS115
01946 *    CHECK COMMUNICATION AREA MODULE                              MBKCS115
01947 ******************************************************************MBKCS115
01948                                                                   MBKCS115
01949      COPY DPPD015.                                                   CL*14
01950  EJECT                                                            MBKCS115
01951 ******************************************************************MBKCS115
01952 *    UPDATE TIME AND DATE MODULE                                  MBKCS115
01953 ******************************************************************MBKCS115
01954                                                                   MBKCS115
01955      COPY DPPD017.                                                   CL*14
01956  EJECT                                                            MBKCS115
